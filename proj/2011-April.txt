From bartvde at osgis.nl  Thu Apr  7 00:18:22 2011
From: bartvde at osgis.nl (Bart van den Eijnden (OSGIS))
Date: Thu, 7 Apr 2011 09:18:22 +0200 (CEST)
Subject: [Proj] Dutch correction grid
Message-ID: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>

Hi,

did anybody ever attempt to transform the information from the Dutch
correction grid into a format for a datum shift grid file that PROJ.4 can
read?

http://www.rdnap.nl/images/Landelijk%20correctiegrid%20nieuwe%20NAP-publicatie_tcm174-280038.xls

Best regards,
Bart



From j.l.h.hartmann at uva.nl  Thu Apr  7 01:14:04 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 07 Apr 2011 10:14:04 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <4D9D724C.9020003@uva.nl>

If someone could give me some pointers to the grid shift format and the 
way it is used in PROJ, I will have a go at producing a grid shift file 
from this spreadsheet. Where did you get it from, Bart?

Jan

On 7-4-2011 9:18, Bart van den Eijnden (OSGIS) wrote:
> Hi,
>
> did anybody ever attempt to transform the information from the Dutch
> correction grid into a format for a datum shift grid file that PROJ.4 can
> read?
>
> http://www.rdnap.nl/images/Landelijk%20correctiegrid%20nieuwe%20NAP-publicatie_tcm174-280038.xls
>
> Best regards,
> Bart
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From paul-grass at stjohnspoint.co.uk  Thu Apr  7 01:52:21 2011
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Thu, 7 Apr 2011 09:52:21 +0100 (BST)
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9D724C.9020003@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl>
Message-ID: <Pine.LNX.4.62.1104070950490.25446@vortex.ukshells.co.uk>

On Thu, 7 Apr 2011, Jan Hartmann wrote:

> If someone could give me some pointers to the grid shift format and the
> way it is used in PROJ, I will have a go at producing a grid shift file
> from this spreadsheet.

Some information here (my experiences of a similar project with the French 
grid): http://www.stjohnspoint.co.uk/gis/france.htm


From j.l.h.hartmann at uva.nl  Thu Apr  7 01:59:35 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 07 Apr 2011 10:59:35 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <Pine.LNX.4.62.1104070950490.25446@vortex.ukshells.co.uk>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>	<4D9D724C.9020003@uva.nl>
	<Pine.LNX.4.62.1104070950490.25446@vortex.ukshells.co.uk>
Message-ID: <4D9D7CF7.8060303@uva.nl>

Thanks Paul. Exactly what I was looking for.

Jan

On 7-4-2011 10:52, Paul Kelly wrote:
> On Thu, 7 Apr 2011, Jan Hartmann wrote:
>
>> If someone could give me some pointers to the grid shift format and the
>> way it is used in PROJ, I will have a go at producing a grid shift file
>> from this spreadsheet.
> Some information here (my experiences of a similar project with the French
> grid): http://www.stjohnspoint.co.uk/gis/france.htm
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From bartvde at osgis.nl  Thu Apr  7 02:03:18 2011
From: bartvde at osgis.nl (Bart van den Eijnden (OSGIS))
Date: Thu, 7 Apr 2011 11:03:18 +0200 (CEST)
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9D724C.9020003@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl>
Message-ID: <30999.145.50.39.11.1302166998.squirrel@webmail.hostingdiscounter.nl>

Hi Jan,

great! Thanks in advance.

I got the spreadsheet from:

http://www.rdnap.nl/kenniscentrum/databestanden/normaal_amsterdams_peil/documenten/index.aspx

Best regards,
Bart

> If someone could give me some pointers to the grid shift format and the
> way it is used in PROJ, I will have a go at producing a grid shift file
> from this spreadsheet. Where did you get it from, Bart?
>
> Jan
>
> On 7-4-2011 9:18, Bart van den Eijnden (OSGIS) wrote:
>> Hi,
>>
>> did anybody ever attempt to transform the information from the Dutch
>> correction grid into a format for a datum shift grid file that PROJ.4
>> can
>> read?
>>
>> http://www.rdnap.nl/images/Landelijk%20correctiegrid%20nieuwe%20NAP-publicatie_tcm174-280038.xls
>>
>> Best regards,
>> Bart
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>




From j.l.h.hartmann at uva.nl  Thu Apr  7 02:57:24 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 07 Apr 2011 11:57:24 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <30999.145.50.39.11.1302166998.squirrel@webmail.hostingdiscounter.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl>
	<30999.145.50.39.11.1302166998.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <4D9D8A84.6020409@uva.nl>

Ah, that's where they hid it! Almost all information on that site has to 
be bought, they only give pointers to what they have and where you can 
buy it. Even the grid coordinates themselves are not public, I believe. 
They probably thought the correction grid data were so useless they 
could put them safely on the Internet without losing any mony on it. 
Well, that's what Open Source people live from, don't you think so? :-)

BTW This indirectly solves one of the major problem I have been 
struggling with for years, the exact georeferencing of the Topographical 
Maps of the Netherlands from 1850 to 1930. They are in a different 
projection (Bonne), and when you use the official transformation 
formulas, the resulting maps are about 60 meters off. No one seems to 
have noticed it before; it has to do with the slightly smaller ellipsoid 
the used for that projection, and you can't see it really on maps at 
scale 1:50000, unless you scan them at the very high resolutions 
available only since a few years. The problem is that the latitude value 
of the zero-coordinate (near Breda) (51.30 degrees north, the middle of 
the Kingdom of the Netherlands as it then was, together with Belgium and 
Luxemburg) was computed not from stellar measurements on the spot, but 
from measurements taken from the Westertoren in Amsterdam (52°22472). 
 From that point they computed the sperical distance to 51.30 degrees, 
but using a small ellipsoid, expecially computed for the Netherlands by 
an engineer called Ackermans. This was before Bessel computed his 
ellipsoid for Germany that was afterwards also used for the new Dutch 
projection. So they got about 60 meters too far to the south, and the 
PROJ-string for the Bonne projection has to be adapted with a slightly 
different central latitude.

This takes away most of the errors, but not all of them. There remains a 
small residual error of about 10 meters, some of it random, but some of 
it systematic in the east-west direction: the farther east or west from 
the zero-point, the greater the error. I haven't found the reason for 
this (did they use a slightly smaller meter, specially adapted for the 
Netherlands? Dutch bureaucracies have been known to think up stranger 
things). It isn't difficult to correct this with some GCP-based rubber 
sheeting with gdalwarp, since I do have the coordinates for about 1000 
trinagulation points (mostly church towers) both in the old and the new 
coordinate systems in 1850 and 1929, but it remains a makeshift solution 
(both literally and figurative).

But there remained a major difficulty: to get an exact georeferenced old 
map, e.g. over Google Satellite, I had to take a few steps that I 
couldn't base on a mathematical or systematic rule. I just used two 
rules of hand (translate 60 meters and stretch a bit). Sixty meters is a 
big distance when you try to locate old parcel boundaries or building 
foundations, and the problem is that there is a lot of money going round 
in this country on that scale (protected buildings, environmental 
protection, heritage subsidies, agrarian reconstruction etc). When those 
old boundaries are not reconstructed on a completely objective basis, 
and without completely reproducible means, you can expect lots and lots  
of judicial procedures, and I would not like to be caught in the middle 
of that mess, being, as far as I know, the only one to have some 
expertise in the problem.

Now, however, I can create a correction grid file from the two series of 
church towers coordinates, and use that with the official transformation 
formula to correct the 60 meters error. Perhaps there will be 
discussions even about that (church towers that have been translated a 
few meters or so, etc.), but the method itself is unambiguous, and can 
be understood be judges and lawyers alike, without the need to explain 
much about ellipsoids and PROJ parameters. Takes really a load off my mind.

So in the long term it pays to give some attention to an Open Source 
mailing list, even if the subjects are not directly relevant to what you 
doing or paid for at the moment.

Cheers,

Jan

On 7-4-2011 11:03, Bart van den Eijnden (OSGIS) wrote:
> Hi Jan,
>
> great! Thanks in advance.
>
> I got the spreadsheet from:
>
> http://www.rdnap.nl/kenniscentrum/databestanden/normaal_amsterdams_peil/documenten/index.aspx
>
> Best regards,
> Bart
>
>> If someone could give me some pointers to the grid shift format and the
>> way it is used in PROJ, I will have a go at producing a grid shift file
>> from this spreadsheet. Where did you get it from, Bart?
>>
>> Jan
>>
>> On 7-4-2011 9:18, Bart van den Eijnden (OSGIS) wrote:
>>> Hi,
>>>
>>> did anybody ever attempt to transform the information from the Dutch
>>> correction grid into a format for a datum shift grid file that PROJ.4
>>> can
>>> read?
>>>
>>> http://www.rdnap.nl/images/Landelijk%20correctiegrid%20nieuwe%20NAP-publicatie_tcm174-280038.xls
>>>
>>> Best regards,
>>> Bart
>>>
>>> _______________________________________________
>>> Proj mailing list
>>> Proj at lists.maptools.org
>>> http://lists.maptools.org/mailman/listinfo/proj
>


From warmerdam at pobox.com  Fri Apr  8 08:19:08 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 08 Apr 2011 11:19:08 -0400
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9D724C.9020003@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl>
Message-ID: <4D9F276C.2050002@pobox.com>

On 11-04-07 04:14 AM, Jan Hartmann wrote:
> If someone could give me some pointers to the grid shift format and the
> way it is used in PROJ, I will have a go at producing a grid shift file
> from this spreadsheet. Where did you get it from, Bart?

Jan,

I will note that the NTv2 file format used for grid shifts in PROJ.4 is now
supported as a raster format by GDAL. So if you can get your grid shift
information into a suitable form, you can translate it to NTv2 with GDAL.

Hmm, I really need to provide more information on this.

You can also use GDAL based applications to examine NTv2 files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From j.l.h.hartmann at uva.nl  Fri Apr  8 08:28:18 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 08 Apr 2011 17:28:18 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F276C.2050002@pobox.com>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>	<4D9D724C.9020003@uva.nl>
	<4D9F276C.2050002@pobox.com>
Message-ID: <4D9F2992.6010506@uva.nl>

I don't quite understand, Frank. I have a spreadsheet with four columns: 
x, y, correction for x and correction for y. What kind of raster file do 
I need to create with these data?

Jan

On 8-4-2011 17:19, Frank Warmerdam wrote:
> On 11-04-07 04:14 AM, Jan Hartmann wrote:
>> If someone could give me some pointers to the grid shift format and the
>> way it is used in PROJ, I will have a go at producing a grid shift file
>> from this spreadsheet. Where did you get it from, Bart?
> Jan,
>
> I will note that the NTv2 file format used for grid shifts in PROJ.4 is now
> supported as a raster format by GDAL. So if you can get your grid shift
> information into a suitable form, you can translate it to NTv2 with GDAL.
>
> Hmm, I really need to provide more information on this.
>
> You can also use GDAL based applications to examine NTv2 files.
>
> Best regards,


From warmerdam at pobox.com  Fri Apr  8 09:29:53 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 08 Apr 2011 12:29:53 -0400
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F2992.6010506@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl>
Message-ID: <4D9F3801.8060108@pobox.com>

On 11-04-08 11:28 AM, Jan Hartmann wrote:
> I don't quite understand, Frank. I have a spreadsheet with four columns: x, y,
> correction for x and correction for y. What kind of raster file do I need to
> create with these data?

Jan,

As input we would require an input raster with two "bands" representing the
offset in longitude and latitude.   I'm not sure off hand what the units
are - possibly arcseconds?   The input file would need to be georeferenced
in latitude and longitude.

If your input points are sparse and irregular you could likely use
gdal_grid to interpolate a grid from the point data.

My point was mainly that you don't necessarily have to write an NTv2
"writer" - it is sufficient to get the datum shift data into any GDAL
support grid format.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From j.l.h.hartmann at uva.nl  Fri Apr  8 09:54:26 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 08 Apr 2011 18:54:26 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F3801.8060108@pobox.com>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
Message-ID: <4D9F3DC2.6040004@uva.nl>

I see. So this would be a floating point grid with two bands, the first 
for the x (lon) offset, the second for the y (lat) offset. All 
measurements in arcseconds.

It's not meant for a datum shift, I've got two targets:

- maps in epgs:28992 (Dutch coordinates, with corrections on a regular 
grid  up to 25 cm)

- maps in the 19th century Bonne-based projection, with corrections for 
about 1000 triangulation points (mostly church towers), up to 60 meters. 
These should have to be gridded.

Am I correct that I can create NTv2 files this way and use them in the 
PROJ-parameter list as @nadgrids=...NTV2?

Jan






On 8-4-2011 18:29, Frank Warmerdam wrote:
> On 11-04-08 11:28 AM, Jan Hartmann wrote:
>> I don't quite understand, Frank. I have a spreadsheet with four 
>> columns: x, y,
>> correction for x and correction for y. What kind of raster file do I 
>> need to
>> create with these data?
>
> Jan,
>
> As input we would require an input raster with two "bands" 
> representing the
> offset in longitude and latitude.   I'm not sure off hand what the units
> are - possibly arcseconds?   The input file would need to be 
> georeferenced
> in latitude and longitude.
>
> If your input points are sparse and irregular you could likely use
> gdal_grid to interpolate a grid from the point data.
>
> My point was mainly that you don't necessarily have to write an NTv2
> "writer" - it is sufficient to get the datum shift data into any GDAL
> support grid format.
>
> Best regards,
>


From maxime.seguin at ensg.eu  Fri Apr  8 10:03:02 2011
From: maxime.seguin at ensg.eu (Maxime SEGUIN)
Date: Fri, 8 Apr 2011 19:03:02 +0200 (CEST)
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F3801.8060108@pobox.com>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
Message-ID: <49255.90.40.110.81.1302282182.squirrel@webmail.ensg.eu>

Hi,

You can look at this spreadsheet :
http://lambert93.ign.fr/fileadmin/files/ntf_r93.pdf

Best regards,

Maxime SEGUIN


> On 11-04-08 11:28 AM, Jan Hartmann wrote:
>> I don't quite understand, Frank. I have a spreadsheet with four columns:
>> x, y,
>> correction for x and correction for y. What kind of raster file do I
>> need to
>> create with these data?
>
> Jan,
>
> As input we would require an input raster with two "bands" representing
> the
> offset in longitude and latitude.   I'm not sure off hand what the units
> are - possibly arcseconds?   The input file would need to be georeferenced
> in latitude and longitude.
>
> If your input points are sparse and irregular you could likely use
> gdal_grid to interpolate a grid from the point data.
>
> My point was mainly that you don't necessarily have to write an NTv2
> "writer" - it is sufficient to get the datum shift data into any GDAL
> support grid format.
>
> Best regards,
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>




From warmerdam at pobox.com  Fri Apr  8 10:09:30 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 08 Apr 2011 13:09:30 -0400
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F3DC2.6040004@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
	<4D9F3DC2.6040004@uva.nl>
Message-ID: <4D9F414A.3020104@pobox.com>

On 11-04-08 12:54 PM, Jan Hartmann wrote:
> I see. So this would be a floating point grid with two bands, the first for the
> x (lon) offset, the second for the y (lat) offset. All measurements in arcseconds.
>
> It's not meant for a datum shift, I've got two targets:
>
> - maps in epgs:28992 (Dutch coordinates, with corrections on a regular grid up
> to 25 cm)
>
> - maps in the 19th century Bonne-based projection, with corrections for about
> 1000 triangulation points (mostly church towers), up to 60 meters. These should
> have to be gridded.
>
> Am I correct that I can create NTv2 files this way and use them in the
> PROJ-parameter list as @nadgrids=...NTV2?

Jan,

Ah, I had not paid close enough attention to realize the above.  I think
it can still work if you convert the shifts into arcseconds.  Note that
the shifts will be applied in PROJ.4 by converting to lat/long, applying
the shift, and shifting back.  There may be some subtleties to how you
setup your coordinate system definitions to trigger proper use of the
NTv2 file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From j.l.h.hartmann at uva.nl  Fri Apr  8 10:23:27 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 08 Apr 2011 19:23:27 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <49255.90.40.110.81.1302282182.squirrel@webmail.ensg.eu>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>	<4D9D724C.9020003@uva.nl>
	<4D9F276C.2050002@pobox.com>	<4D9F2992.6010506@uva.nl>
	<4D9F3801.8060108@pobox.com>
	<49255.90.40.110.81.1302282182.squirrel@webmail.ensg.eu>
Message-ID: <4D9F448F.7090309@uva.nl>

Yes, this looks like a detailed description of the NTV2 format. Do you 
know a program to do the conversion, Maxime?

Jan

On 8-4-2011 19:03, Maxime SEGUIN wrote:
> Hi,
>
> You can look at this spreadsheet :
> http://lambert93.ign.fr/fileadmin/files/ntf_r93.pdf
>
> Best regards,
>
> Maxime SEGUIN
>
>
>> On 11-04-08 11:28 AM, Jan Hartmann wrote:
>>> I don't quite understand, Frank. I have a spreadsheet with four columns:
>>> x, y,
>>> correction for x and correction for y. What kind of raster file do I
>>> need to
>>> create with these data?
>> Jan,
>>
>> As input we would require an input raster with two "bands" representing
>> the
>> offset in longitude and latitude.   I'm not sure off hand what the units
>> are - possibly arcseconds?   The input file would need to be georeferenced
>> in latitude and longitude.
>>
>> If your input points are sparse and irregular you could likely use
>> gdal_grid to interpolate a grid from the point data.
>>
>> My point was mainly that you don't necessarily have to write an NTv2
>> "writer" - it is sufficient to get the datum shift data into any GDAL
>> support grid format.
>>
>> Best regards,
>>
>> --
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam at pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> Proj mailing list
>> Proj at lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/proj
>>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From j.l.h.hartmann at uva.nl  Fri Apr  8 10:26:58 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 08 Apr 2011 19:26:58 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F414A.3020104@pobox.com>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
	<4D9F3DC2.6040004@uva.nl> <4D9F414A.3020104@pobox.com>
Message-ID: <4D9F4562.1030901@uva.nl>



On 8-4-2011 19:09, Frank Warmerdam wrote:
>
> Jan,
>
> Ah, I had not paid close enough attention to realize the above.  I think
> it can still work if you convert the shifts into arcseconds.  Note that
> the shifts will be applied in PROJ.4 by converting to lat/long, applying
> the shift, and shifting back.  There may be some subtleties to how you
> setup your coordinate system definitions to trigger proper use of the
> NTv2 file.
>
This agrees with the previous message by Maxime Sequin. Just to be sure: 
can I use either "@nadgrids=ntv2 binary file" or "@nadgrids=GDAL raster 
file" interchangeably?

Jan


From warmerdam at pobox.com  Fri Apr  8 12:34:19 2011
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 08 Apr 2011 15:34:19 -0400
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F4562.1030901@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
	<4D9F3DC2.6040004@uva.nl> <4D9F414A.3020104@pobox.com>
	<4D9F4562.1030901@uva.nl>
Message-ID: <4D9F633B.7040603@pobox.com>

> On 8-4-2011 19:09, Frank Warmerdam wrote:
>>
>> Jan,
>>
>> Ah, I had not paid close enough attention to realize the above. I think
>> it can still work if you convert the shifts into arcseconds. Note that
>> the shifts will be applied in PROJ.4 by converting to lat/long, applying
>> the shift, and shifting back. There may be some subtleties to how you
>> setup your coordinate system definitions to trigger proper use of the
>> NTv2 file.
>>
> This agrees with the previous message by Maxime Sequin. Just to be sure: can I
> use either "@nadgrids=ntv2 binary file" or "@nadgrids=GDAL raster file"
> interchangeably?

Jan,

PROJ.4 does not support other GDAL formats for the @nadgrids, but...


On 11-04-08 01:23 PM, Jan Hartmann wrote:
 > Yes, this looks like a detailed description of the NTV2 format. Do you
 > know a program to do the conversion, Maxime?
 >
 > Jan

gdal_translate can be used to convert other grid formats into NTv2 format.
That was the point I've been trying to make!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From hilmyh at gmail.com  Sat Apr  9 04:54:40 2011
From: hilmyh at gmail.com (Hilmy Hashim)
Date: Sat, 9 Apr 2011 19:54:40 +0800
Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A
Message-ID: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>

Hi,

This issue has been discussed many times before, so I'm trying to assess the
current situation.

I'm a new user of Quantum GIS and Postgis which I understand uses Proj.4 for
projections. I'm working with the RSO projection for Peninsular Malaysia
both old and new definitions (EPSG:3168 and EPSG:3375). From my readings
on various lists, RSO for Malaysia requires the +gamma parameter and the
projection method is now classified by epsg-registry.org as EPSG:9812 Hotine
Oblique Mercator (Variant A). This means that the final rotation applied is
at the natural origin as opposed to the center of projection which is
Variant B (EPSG:9815)

In QGis, versions 1.6 and up in OSGeo4W, the default proj.4 string for
EPSG:3168 and EPSG:3375 is without the +gamma parameter, so the projection
is not correct. Looking at the OSGeo4W\share\proj\epsg file, gamma is indeed
defined in there. So I'm confused where QGis srs.db is getting it's
information from.

Creating a custom CRS in QGis with +gamma seems to have an effect, so the
latest omerc.c does take into account the gamma parameter. However, the
projection is still not quite correct. It looks like it is
correctly aligned to north, but the x and y translation is off and I
surmised that this has to do with the final center of rotation. I did an
empirical correction with x_0 = false_easting + Uc sin(gc) and y_0 =
false_northing + Uc cos(gc) approximately I think. Attached is a diagram of
a comparison I did with different parameters. C is approximately the correct
projection with a cadaster layer in EPSG:3384 overlayed at the bottom.

As proj.4 is used by many applications, my question is how and where can I
get the projection parameters for RSO Malaysia corrected and how can the
omerc projection be made to use variant A. I am advising a state government
to standardize on QGis and PostGIS so there will be many users.

Thank you for any help  and my apologies for bringing up this Malayan
Monster again.


*Hilmy*
*Hilmy*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110409/e4d512b2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: rsoparametercomparison.jpg
Type: image/jpeg
Size: 24266 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110409/e4d512b2/attachment.jpg>

From molnar at sas.elte.hu  Sat Apr  9 06:25:45 2011
From: molnar at sas.elte.hu (molnar at sas.elte.hu)
Date: Sat, 9 Apr 2011 15:25:45 +0200 (CEST)
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F3DC2.6040004@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
	<4D9F3DC2.6040004@uva.nl>
Message-ID: <55ed00fdb6f53fffd1fb115207d1481e.squirrel@sas.elte.hu>

Dear Jan,

> I see. So this would be a floating point grid with two bands, the first
> for the x (lon) offset, the second for the y (lat) offset. All
> measurements in arcseconds.
>

I can share my experiences creating a grid shift binary (gsb) file for
Hungary (between "Hungarian Datum 1972 (HD72)" and WGS84). As NTv2
standard was invented on the Western Hemisphere, some parameters might
seem strange for those, who learned geodesy east from Greenwich.
1: You should create a four column table. First and second columns should
be the latitude and longitude shift on the first datum grid points,
starting from the bottom right (!) corner of the grid in westward
direction.
Third and fourth column should be the standard deviation of the latitude
and longitude shift value
2: As longitude grows westward for the standard, longitude shifts should
be opposite sign as calculated (not lon(2nd datum)-lon(1st datum) but the
opposit).
3: the delimitation character for this table in ascii format should not be
'tab' but 'white space'. (At least it worked for me...)
4: you should add an ascii header and a one line footer to your table. The
header should you like this: (see my comments after # signs)

NUM_OREC 11
NUM_SREC 11
NUM_FILE  1
GS_TYPE SECONDS
VERSION NTv2.0
DATUM_F HD72
DATUM_T WGS84
MAJOR_F 6378160.000
MINOR_F 6356774.516
MAJOR_T 6378137.000
MINOR_T 6356752.314
SUB_NAMEGGPSH95
PARENT  NONE
CREATED 04-10-10
UPDATED 04-10-10
S_LAT     164520.000000
N_LAT     174960.000000
E_LONG    -82800.000000
W_LONG    -57600.000000
LAT_INC      360.000000
LONG_INC     360.000000
GS_COUNT 2130



> It's not meant for a datum shift, I've got two targets:
>
> - maps in epgs:28992 (Dutch coordinates, with corrections on a regular
> grid  up to 25 cm)
>
> - maps in the 19th century Bonne-based projection, with corrections for
> about 1000 triangulation points (mostly church towers), up to 60 meters.
> These should have to be gridded.
>
> Am I correct that I can create NTv2 files this way and use them in the
> PROJ-parameter list as @nadgrids=...NTV2?
>
> Jan
>
>
>
>
>
>
> On 8-4-2011 18:29, Frank Warmerdam wrote:
>> On 11-04-08 11:28 AM, Jan Hartmann wrote:
>>> I don't quite understand, Frank. I have a spreadsheet with four
>>> columns: x, y,
>>> correction for x and correction for y. What kind of raster file do I
>>> need to
>>> create with these data?
>>
>> Jan,
>>
>> As input we would require an input raster with two "bands"
>> representing the
>> offset in longitude and latitude.   I'm not sure off hand what the units
>> are - possibly arcseconds?   The input file would need to be
>> georeferenced
>> in latitude and longitude.
>>
>> If your input points are sparse and irregular you could likely use
>> gdal_grid to interpolate a grid from the point data.
>>
>> My point was mainly that you don't necessarily have to write an NTv2
>> "writer" - it is sufficient to get the datum shift data into any GDAL
>> support grid format.
>>
>> Best regards,
>>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>



From molnar at sas.elte.hu  Sat Apr  9 07:36:54 2011
From: molnar at sas.elte.hu (molnar at sas.elte.hu)
Date: Sat, 9 Apr 2011 16:36:54 +0200 (CEST)
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F2992.6010506@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl>
Message-ID: <d87129e939e8fbbc9fd9bb50921fed98.squirrel@sas.elte.hu>


Dear Jan,

> I see. So this would be a floating point grid with two bands, the first
> for the x (lon) offset, the second for the y (lat) offset. All
> measurements in arcseconds.
>

I can share my experiences creating a grid shift binary (gsb) file for
Hungary (between "Hungarian Datum 1972 (HD72)" and WGS84). As NTv2
standard was invented on the Western Hemisphere, some parameters might
seem strange for those, who learned geodesy east from Greenwich...

0: If you have a list of coordinates of the identical points in your
starting and target geodetic systems in ellipsoid coordinates, you should
create two grids from this pointcloud.
(I used surfer for this) First grid should contain the latitude shifts,
and the second should contain the longitude shifts. I save my results in
.dat format. (Use an interpolation method, which calculates grid
node-point values outside the convex hull of your listed coordinates, or
add some virtual points near the corners of the created grid to ensure,
that you should have a valid transformation outside the web of your
control points, but inside the border your country.)
1: You should create a four column table. First and second columns should
be the latitude and longitude shift on the first datum grid points,
starting from the bottom right (!) corner of the grid in westward
direction. (I used excel to sort the list of points in the .dat files)
Third and fourth column should be the standard deviation of the latitude
and longitude shift value. (I think these values are never ever used in
the calculations. I used dummy values like 0.001000)
2: As longitude grows westward for the standard, longitude shifts should
be opposite sign as calculated (not lon(2nd datum)-lon(1st datum) but the
opposite).
3: the delimitation character for this table should not be 'tab' but
'white space'. (At least it worked for me...)
4: you should add a header and a one line footer to your table in a text
editor. The final ascii file should look like this: (see my comments after
# signs!)

NUM_OREC 11        # number of lines for the general header
NUM_SREC 11        # number of lines for the sub-header
NUM_FILE  1        #I had only one dataset (so only 1 sub-header is expected)
GS_TYPE SECONDS    #all angels are in arcseconds
VERSION NTv2.0     #
DATUM_F HD72        #name of your local datum, 1st datum
DATUM_T WGS84       #name of your 2nd datum
MAJOR_F 6378160.000  #1st datum ellipsoid half major axis in meter
MINOR_F 6356774.516  #1st ... minor axis
MAJOR_T 6378137.000  #2nd ... major ...
MINOR_T 6356752.314  #2nd ... minor ...
SUB_NAMEGGPSH95      #sub header begins: name of grid shift sub-dataset
PARENT  NONE         # ??? (do not change)
CREATED 04-10-10     #
UPDATED 04-10-10     #
S_LAT     164520.000000  # southernmost latitude in seconds
N_LAT     174960.000000  #northernmost ...
E_LONG    -82800.000000  #easternmost longitude in seconds. Mind the sign!
W_LONG    -57600.000000  #westernmost ... Mind the sign!
LAT_INC      360.000000  #latitude increment in seconds
LONG_INC     360.000000  #longitude increment in seconds
GS_COUNT 2130   #number of samples in the grid shift sub-dataset

# her come the data like:
-0.864000	 4.032000	0.001000	0.001000
-0.866400	 4.029600	0.001000	0.001000
-0.868800	 4.027200	0.001000	0.001000
-0.871200	 4.024800	0.001000	0.001000
...
...
# end line:
END  .33E+33

5. Save the file as something.asc
6. Use GDAit for converting the ascii file above to and .gsb file.
Download GDAit, install it, start it, and File->Import Grid file choose
Files of type: NTv2 ASCII grid (*.asc). Make this file as the default grid
shift file.
6. Create a .gsb grid using GDAit: File->Export Grid file and choose the
.gsb type.
7. Now you can copy and use this .gsb file for conversion in gdal
environment with nadgrids=... option.

> It's not meant for a datum shift, I've got two targets:
>
> - maps in epgs:28992 (Dutch coordinates, with corrections on a regular
> grid  up to 25 cm)
>
> - maps in the 19th century Bonne-based projection, with corrections for
> about 1000 triangulation points (mostly church towers), up to 60 meters.
> These should have to be gridded.

I suggest to create two separate .gsb files. One between the epsg:28992
system and WGS84 (or ETRS89) and one another file between the old dutch
grid and the WGS84 (or ETRS89) system.

Good luck!

Gabor Molnar






From j.l.h.hartmann at uva.nl  Sat Apr  9 08:35:59 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Sat, 09 Apr 2011 17:35:59 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <d87129e939e8fbbc9fd9bb50921fed98.squirrel@sas.elte.hu>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>	<4D9D724C.9020003@uva.nl>
	<4D9F276C.2050002@pobox.com>	<4D9F2992.6010506@uva.nl>
	<d87129e939e8fbbc9fd9bb50921fed98.squirrel@sas.elte.hu>
Message-ID: <4DA07CDF.5060103@uva.nl>

Thanks Gabor, this will certainly save me hours of work!

Jan

On 9-4-2011 16:36, molnar at sas.elte.hu wrote:
> Dear Jan,
>
>> I see. So this would be a floating point grid with two bands, the first
>> for the x (lon) offset, the second for the y (lat) offset. All
>> measurements in arcseconds.
>>
> I can share my experiences creating a grid shift binary (gsb) file for
> Hungary (between "Hungarian Datum 1972 (HD72)" and WGS84). As NTv2
> standard was invented on the Western Hemisphere, some parameters might
> seem strange for those, who learned geodesy east from Greenwich...
>
> 0: If you have a list of coordinates of the identical points in your
> starting and target geodetic systems in ellipsoid coordinates, you should
> create two grids from this pointcloud.
> (I used surfer for this) First grid should contain the latitude shifts,
> and the second should contain the longitude shifts. I save my results in
> .dat format. (Use an interpolation method, which calculates grid
> node-point values outside the convex hull of your listed coordinates, or
> add some virtual points near the corners of the created grid to ensure,
> that you should have a valid transformation outside the web of your
> control points, but inside the border your country.)
> 1: You should create a four column table. First and second columns should
> be the latitude and longitude shift on the first datum grid points,
> starting from the bottom right (!) corner of the grid in westward
> direction. (I used excel to sort the list of points in the .dat files)
> Third and fourth column should be the standard deviation of the latitude
> and longitude shift value. (I think these values are never ever used in
> the calculations. I used dummy values like 0.001000)
> 2: As longitude grows westward for the standard, longitude shifts should
> be opposite sign as calculated (not lon(2nd datum)-lon(1st datum) but the
> opposite).
> 3: the delimitation character for this table should not be 'tab' but
> 'white space'. (At least it worked for me...)
> 4: you should add a header and a one line footer to your table in a text
> editor. The final ascii file should look like this: (see my comments after
> # signs!)
>
> NUM_OREC 11        # number of lines for the general header
> NUM_SREC 11        # number of lines for the sub-header
> NUM_FILE  1        #I had only one dataset (so only 1 sub-header is expected)
> GS_TYPE SECONDS    #all angels are in arcseconds
> VERSION NTv2.0     #
> DATUM_F HD72        #name of your local datum, 1st datum
> DATUM_T WGS84       #name of your 2nd datum
> MAJOR_F 6378160.000  #1st datum ellipsoid half major axis in meter
> MINOR_F 6356774.516  #1st ... minor axis
> MAJOR_T 6378137.000  #2nd ... major ...
> MINOR_T 6356752.314  #2nd ... minor ...
> SUB_NAMEGGPSH95      #sub header begins: name of grid shift sub-dataset
> PARENT  NONE         # ??? (do not change)
> CREATED 04-10-10     #
> UPDATED 04-10-10     #
> S_LAT     164520.000000  # southernmost latitude in seconds
> N_LAT     174960.000000  #northernmost ...
> E_LONG    -82800.000000  #easternmost longitude in seconds. Mind the sign!
> W_LONG    -57600.000000  #westernmost ... Mind the sign!
> LAT_INC      360.000000  #latitude increment in seconds
> LONG_INC     360.000000  #longitude increment in seconds
> GS_COUNT 2130   #number of samples in the grid shift sub-dataset
>
> # her come the data like:
> -0.864000	 4.032000	0.001000	0.001000
> -0.866400	 4.029600	0.001000	0.001000
> -0.868800	 4.027200	0.001000	0.001000
> -0.871200	 4.024800	0.001000	0.001000
> ...
> ...
> # end line:
> END  .33E+33
>
> 5. Save the file as something.asc
> 6. Use GDAit for converting the ascii file above to and .gsb file.
> Download GDAit, install it, start it, and File->Import Grid file choose
> Files of type: NTv2 ASCII grid (*.asc). Make this file as the default grid
> shift file.
> 6. Create a .gsb grid using GDAit: File->Export Grid file and choose the
> .gsb type.
> 7. Now you can copy and use this .gsb file for conversion in gdal
> environment with nadgrids=... option.
>
>> It's not meant for a datum shift, I've got two targets:
>>
>> - maps in epgs:28992 (Dutch coordinates, with corrections on a regular
>> grid  up to 25 cm)
>>
>> - maps in the 19th century Bonne-based projection, with corrections for
>> about 1000 triangulation points (mostly church towers), up to 60 meters.
>> These should have to be gridded.
> I suggest to create two separate .gsb files. One between the epsg:28992
> system and WGS84 (or ETRS89) and one another file between the old dutch
> grid and the WGS84 (or ETRS89) system.
>
> Good luck!
>
> Gabor Molnar
>
>
>
>
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From uwe.schmitz at bezreg-koeln.nrw.de  Mon Apr 11 00:49:41 2011
From: uwe.schmitz at bezreg-koeln.nrw.de (Schmitz, Uwe)
Date: Mon, 11 Apr 2011 09:49:41 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <4DA07CDF.5060103@uva.nl>
Message-ID: <240EE7C956B2CB439C613DF6CEC8A32D037BBBD1@sebulba.bezreg-koeln.nrw.de>

Jan,

I don't know if it was already mentioned, but there is a
program called GDAy from an Australian governmental
authority. It can be downloaded for Windows from
here:

http://www.derm.qld.gov.au/property/surveying/files/gday21iex.exe

The parent page with docuemntation is here:

http://www.derm.qld.gov.au/property/surveying/gdasoftware.html

Beside transforming coordinates it is able to convert
NTv2-ASCII to NTv2-Binary. So if you can produce an ASCII
file of your data, conforming to the description, you
can use the prog to convert it to binary.
This feature is a little bit hidden:

Load the grid file with menu point:
File/Distortion Grid Settings/Select New Grid File...
(attention: the extension has to be ".asc"!)

After that save the grid with menu point:
File/Distortion Grid Settings/Export Grid File/...to Binary

That's it.

good luck
uwe


From j.l.h.hartmann at uva.nl  Mon Apr 11 01:12:31 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Mon, 11 Apr 2011 10:12:31 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <240EE7C956B2CB439C613DF6CEC8A32D037BBBD1@sebulba.bezreg-koeln.nrw.de>
References: <240EE7C956B2CB439C613DF6CEC8A32D037BBBD1@sebulba.bezreg-koeln.nrw.de>
Message-ID: <4DA2B7EF.3000407@uva.nl>

Thanks Uwe, that was the missing link. If all works as I hope, I have a 
general approach for rubbersheeting old maps with the GDAL utilities, 
starting with the triangulated maps of 1850 and proceeding with the 
cadastral maps of 1832, for which the national triangulation mesh wasn't 
yet available.  It would really solve my most basic problem: how to get 
a historical reference map of the Netherlands at scale 1:2500 with 
maximum georeferential accuracy.

Cheers,

Jan

Dr. J. Hartmann
Department of Geography
University of Amsterdam

On 11-4-2011 9:49, Schmitz, Uwe wrote:
> Jan,
>
> I don't know if it was already mentioned, but there is a
> program called GDAy from an Australian governmental
> authority. It can be downloaded for Windows from
> here:
>
> http://www.derm.qld.gov.au/property/surveying/files/gday21iex.exe
>
> The parent page with docuemntation is here:
>
> http://www.derm.qld.gov.au/property/surveying/gdasoftware.html
>
> Beside transforming coordinates it is able to convert
> NTv2-ASCII to NTv2-Binary. So if you can produce an ASCII
> file of your data, conforming to the description, you
> can use the prog to convert it to binary.
> This feature is a little bit hidden:
>
> Load the grid file with menu point:
> File/Distortion Grid Settings/Select New Grid File...
> (attention: the extension has to be ".asc"!)
>
> After that save the grid with menu point:
> File/Distortion Grid Settings/Export Grid File/...to Binary
>
> That's it.
>
> good luck
> uwe
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj


From noorcs22 at gmail.com  Mon Apr 18 01:50:37 2011
From: noorcs22 at gmail.com (Mustafa646)
Date: Mon, 18 Apr 2011 01:50:37 -0700 (PDT)
Subject: [Proj] Which Coordinate system/Projection should i assign to
	shapefile ?
Message-ID: <1303116637854-6282842.post@n2.nabble.com>

hello all,

I digitize a tiff image file in Map Window. I assign three Lat-lon points
based on wgs84 to this tiff image before digitizing. The sample points are
(59.350067,18.208219), These are lat-lon points of Lidingö Area in sweden.
After completing the digitizing, i get to know that there is no projection
defined to my newly generated shapefile. Then i assign following projection
to shapefile by using Map Window GIS tools-> assign projection to
shapefiles.

Category: Geographic Coordinate System
Group: World
Name: WGS1984

WGS 1984 (+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs )  

Actually i want to display this shapefile over Google map, but when i tried
to display it over Google map, it displayed on wrong place in ocean
somewhere, So, where i am wrong ? How can i fix it ? Please give some useful
suggestion.



--
View this message in context: http://osgeo-org.1803224.n2.nabble.com/Which-Coordinate-system-Projection-should-i-assign-to-shapefile-tp6282842p6282842.html
Sent from the PROJ.4 mailing list archive at Nabble.com.


From jagoncal at gmail.com  Mon Apr 18 02:59:05 2011
From: jagoncal at gmail.com (=?ISO-8859-1?Q?Jose_Gon=E7alves?=)
Date: Mon, 18 Apr 2011 10:59:05 +0100
Subject: [Proj] Which Coordinate system/Projection should i assign to
 shapefile ?
In-Reply-To: <1303116637854-6282842.post@n2.nabble.com>
References: <1303116637854-6282842.post@n2.nabble.com>
Message-ID: <BANLkTinA7yOri8-KFgFDyfVhyP7xgZbScQ@mail.gmail.com>

Probably the order of your coordinates is wrong. When you georeference in a
geographic coordinate system x is longitude and y is latitude.

Regards

José A. Gonçalves



2011/4/18 Mustafa646 <noorcs22 at gmail.com>

> hello all,
>
> I digitize a tiff image file in Map Window. I assign three Lat-lon points
> based on wgs84 to this tiff image before digitizing. The sample points are
> (59.350067,18.208219), These are lat-lon points of Lidingö Area in sweden.
> After completing the digitizing, i get to know that there is no projection
> defined to my newly generated shapefile. Then i assign following projection
> to shapefile by using Map Window GIS tools-> assign projection to
> shapefiles.
>
> Category: Geographic Coordinate System
> Group: World
> Name: WGS1984
>
> WGS 1984 (+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs )
>
> Actually i want to display this shapefile over Google map, but when i tried
> to display it over Google map, it displayed on wrong place in ocean
> somewhere, So, where i am wrong ? How can i fix it ? Please give some
> useful
> suggestion.
>
>
>
> --
> View this message in context:
> http://osgeo-org.1803224.n2.nabble.com/Which-Coordinate-system-Projection-should-i-assign-to-shapefile-tp6282842p6282842.html
> Sent from the PROJ.4 mailing list archive at Nabble.com.
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110418/73220fa8/attachment.html>

From adrian_gh.popa at romtelecom.ro  Fri Apr 22 01:57:54 2011
From: adrian_gh.popa at romtelecom.ro (Adrian Popa)
Date: Fri, 22 Apr 2011 11:57:54 +0300
Subject: [Proj] Offset when converting coordinates from ESRI:31700 to
	EPSG:4326
Message-ID: <4DB14312.7050804@romtelecom.ro>

Hello everyone,

I have a problem when converting coordinates from ESRI:31700 (Stereo 70)
to WGS84 (EPSG:4326). The coordinates I get from the conversion have an
offset from the original coordinate of about 50m. Here's an example:

Original coordinates (Stereo 70):  587486.770, 326878.452
Converted coordinates (WGS84): 26.099032,44.436575
Real coordinates (converted from Stereo 70 with Global Mapper and
checked with a GPS unit): 26.097414, 44.436335

For the conversion I'm using cs2cs Rel. 4.7.1, 23 September 2009 on
Ubuntu 10.04.

My ESRI/EPSG definitions are as follows:

EPSG:
# Dealul Piscului 1970/ Stereo 70 (deprecated)
<31700> +proj=sterea +lat_0=46 +lon_0=25 +k=0.99975 +x_0=500000
+y_0=500000 +ellps=krass +units=m +no_defs <>
# WGS 84
<4326> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs <>

ESRI:
# Dealul Piscului 1970/ Stereo 70
<31700> +proj=stere +lat_0=46 +lon_0=25 +k=0.999750 +x_0=500000
+y_0=500000 +ellps=krass +units=m +no_defs  no_defs <>

The command line I'm using is:
$ echo 587486.770 326878.452 | cs2cs +init=esri:31700 +to
+init=epsg:4326 -f '%0.6f'
26.099032    44.436575 0.000000
$ echo 587486.770 326878.452 | cs2cs +init=epsg:31700 +to
+init=epsg:4326 -f '%0.6f'
26.098934    44.436629 0.000000

I've read that there is a small difference between stere and sterea
projections, and sterea should give a better approximation, but I've
tried with both projections and I still get the ~50m offset.

Can anybody clue me in as to what I'm doing wrong? I must be missing
something, but I don't know what (I'm somewhat of a noob when it comes
to map projections).

P.S. The definition for Stereo 70 that I received with my data looks
consistent with the definition inside proj4:

PROJCS["Stereo_70",GEOGCS["GCS_Dealul_Piscului_1970",DATUM["D_Dealul_Piscului_1970",SPHEROID["Krasovsky_1940",6378245,298.3]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Double_Stereographic"],PARAMETER["False_Easting",500000],PARAMETER["False_Northing",500000],PARAMETER["Longitude_Of_Origin",25],PARAMETER["Scale_Factor",0.99975],PARAMETER["Latitude_Of_Origin",46],UNIT["Meter",1]]


Thanks,
Adrian
Acest mesaj si orice fisiere sau documente atasate contin informatii confidentiale, clasificate conform regulilor interne ROMTELECOM. Mesajul este destinat doar persoanei sau entitatii adresate si altora autorizati sa-l primeasca. Daca dvs. nu sunteti in aceasta situatie, prin aceasta va informam ca orice dezvaluire, copiere, distribuire sau orice alta actiune bazata pe continutul acestor informatii este strict interzisa si pot fi aplicate sanctiuni, potrivit legii. Daca ati primit acest mesaj din greseala, va rugam sa ne informati imediat si sa stergeti mesajul din sistemul dvs. De asemenea, va rugam sa tineti cont ca transmisia nu poate fi garantata ca fiind sigura sau fara erori. Va multumim!


From jrepetto at free.fr  Fri Apr 22 02:57:10 2011
From: jrepetto at free.fr (Jean-Claude Repetto)
Date: Fri, 22 Apr 2011 11:57:10 +0200
Subject: [Proj] Offset when converting coordinates from ESRI:31700 to
 EPSG:4326
In-Reply-To: <4DB14312.7050804@romtelecom.ro>
References: <4DB14312.7050804@romtelecom.ro>
Message-ID: <4DB150F6.3020800@free.fr>

Le 22/04/2011 10:57, Adrian Popa a écrit :
> I have a problem when converting coordinates from ESRI:31700 (Stereo 70)
> to WGS84 (EPSG:4326). The coordinates I get from the conversion have an
> offset from the original coordinate of about 50m.
>
> My ESRI/EPSG definitions are as follows:
>
> EPSG:
> # Dealul Piscului 1970/ Stereo 70 (deprecated)
> <31700>  +proj=sterea +lat_0=46 +lon_0=25 +k=0.99975 +x_0=500000
> +y_0=500000 +ellps=krass +units=m +no_defs<>
> # WGS 84
> <4326>  +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs<>
>
> ESRI:
> # Dealul Piscului 1970/ Stereo 70
> <31700>  +proj=stere +lat_0=46 +lon_0=25 +k=0.999750 +x_0=500000
> +y_0=500000 +ellps=krass +units=m +no_defs  no_defs<>
>
> Can anybody clue me in as to what I'm doing wrong?

Both definitions are missing the +towgs84 parameters.

Jean-Claude


From jagoncal at gmail.com  Fri Apr 22 03:50:02 2011
From: jagoncal at gmail.com (=?ISO-8859-1?Q?Jose_Gon=E7alves?=)
Date: Fri, 22 Apr 2011 11:50:02 +0100
Subject: [Proj] Offset when converting coordinates from ESRI:31700 to
	EPSG:4326
In-Reply-To: <4DB14312.7050804@romtelecom.ro>
References: <4DB14312.7050804@romtelecom.ro>
Message-ID: <BANLkTinFt_uoVTyyg=bNFBjbvmoaD4eX-g@mail.gmail.com>

Adrian

The problem is that datum transformation is not being done. The coordinate
system definition esri:31700 only considers the projection and not a datum
transformation (e.g. +towgs84=...). There are different sets of datum shift
parameters for datum Dealul_Piscului_1970. In the ArcGIS documentation I
found the following:

dX=44.107 dY=-116.150 dZ=-54.648
dX=28.000 dY=-121.000 dZ=-77.000

You must include one of them it in the cs2cs command:

cs2cs +init=esri:31700 +towgs84=28,-121,-77 +to +init=epsg:4326 -f '%0.6f'


Regards

José A. Gonçalves



2011/4/22 Adrian Popa <adrian_gh.popa at romtelecom.ro>

> Hello everyone,
>
> I have a problem when converting coordinates from ESRI:31700 (Stereo 70)
> to WGS84 (EPSG:4326). The coordinates I get from the conversion have an
> offset from the original coordinate of about 50m. Here's an example:
>
> Original coordinates (Stereo 70):  587486.770, 326878.452
> Converted coordinates (WGS84): 26.099032,44.436575
> Real coordinates (converted from Stereo 70 with Global Mapper and
> checked with a GPS unit): 26.097414, 44.436335
>
> For the conversion I'm using cs2cs Rel. 4.7.1, 23 September 2009 on
> Ubuntu 10.04.
>
> My ESRI/EPSG definitions are as follows:
>
> EPSG:
> # Dealul Piscului 1970/ Stereo 70 (deprecated)
> <31700> +proj=sterea +lat_0=46 +lon_0=25 +k=0.99975 +x_0=500000
> +y_0=500000 +ellps=krass +units=m +no_defs <>
> # WGS 84
> <4326> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs <>
>
> ESRI:
> # Dealul Piscului 1970/ Stereo 70
> <31700> +proj=stere +lat_0=46 +lon_0=25 +k=0.999750 +x_0=500000
> +y_0=500000 +ellps=krass +units=m +no_defs  no_defs <>
>
> The command line I'm using is:
> $ echo 587486.770 326878.452 | cs2cs +init=esri:31700 +to
> +init=epsg:4326 -f '%0.6f'
> 26.099032    44.436575 0.000000
> $ echo 587486.770 326878.452 | cs2cs +init=epsg:31700 +to
> +init=epsg:4326 -f '%0.6f'
> 26.098934    44.436629 0.000000
>
> I've read that there is a small difference between stere and sterea
> projections, and sterea should give a better approximation, but I've
> tried with both projections and I still get the ~50m offset.
>
> Can anybody clue me in as to what I'm doing wrong? I must be missing
> something, but I don't know what (I'm somewhat of a noob when it comes
> to map projections).
>
> P.S. The definition for Stereo 70 that I received with my data looks
> consistent with the definition inside proj4:
>
>
> PROJCS["Stereo_70",GEOGCS["GCS_Dealul_Piscului_1970",DATUM["D_Dealul_Piscului_1970",SPHEROID["Krasovsky_1940",6378245,298.3]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Double_Stereographic"],PARAMETER["False_Easting",500000],PARAMETER["False_Northing",500000],PARAMETER["Longitude_Of_Origin",25],PARAMETER["Scale_Factor",0.99975],PARAMETER["Latitude_Of_Origin",46],UNIT["Meter",1]]
>
>
> Thanks,
> Adrian
> Acest mesaj si orice fisiere sau documente atasate contin informatii
> confidentiale, clasificate conform regulilor interne ROMTELECOM. Mesajul
> este destinat doar persoanei sau entitatii adresate si altora autorizati
> sa-l primeasca. Daca dvs. nu sunteti in aceasta situatie, prin aceasta va
> informam ca orice dezvaluire, copiere, distribuire sau orice alta actiune
> bazata pe continutul acestor informatii este strict interzisa si pot fi
> aplicate sanctiuni, potrivit legii. Daca ati primit acest mesaj din
> greseala, va rugam sa ne informati imediat si sa stergeti mesajul din
> sistemul dvs. De asemenea, va rugam sa tineti cont ca transmisia nu poate fi
> garantata ca fiind sigura sau fara erori. Va multumim!
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110422/ec1bd86e/attachment.html>

From Mikael.Rittri at carmenta.com  Tue Apr 26 07:54:56 2011
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Tue, 26 Apr 2011 14:54:56 +0000
Subject: [Proj] Offset when converting coordinates from ESRI:31700
	to	EPSG:4326
In-Reply-To: <BANLkTinFt_uoVTyyg=bNFBjbvmoaD4eX-g@mail.gmail.com>
References: <4DB14312.7050804@romtelecom.ro>
	<BANLkTinFt_uoVTyyg=bNFBjbvmoaD4eX-g@mail.gmail.com>
Message-ID: <E4AB3DD44D22854B819908379DE4AD4938845458@SETHNWS023.carmenta.se>

Hello Adrian,

I agree with Jean-Claude and José, but I would like to add
something:

The datum Dealul Piscului 1970 used to have EPSG code 6317,
but it was deprecated by EPSG in September 2008. Reason:

    "Datum does not exist but is an alias for S-42 in Romania."

The replacement datum has code 6179, and is actually called
Pulkovo 1942(58), not S-42. 

For the same reason, the projected CRS 

    Dealul Piscului 1970 / Stereo 70 (EPSG code 31700) 

has been deprecated and replaced by 

    Pulkovo 1942(58) / Stereo70 (EPSG code 3844)

(although both "S-42 / Stereo 70" and "Dealul Piscului 1970/ Stereo 70" are aliases.)

Anyway, with this background knowledge, I found a better
(I think) datum shift to use: 

   +towgs84=2.329,-147.042,-92.08,-0.309,0.325,0.497,5.69  

which EPSG calls "Pulkovo 1942(58) to WGS 84 (19)", with code 15995.
The horizontal accuracy is supposed to be 1.5 to 3 meters.
(I have negated the three rotations to fit the cs2cs rotation sign convention.)

Warning: I haven't tried this on any real data. 

Best regards,
Mikael Rittri
Carmenta
Sweden 
http://www.carmenta.com

________________________________

From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Jose Gonçalves
Sent: den 22 april 2011 12:50
To: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] Offset when converting coordinates from ESRI:31700 to EPSG:4326


Adrian

The problem is that datum transformation is not being done. The coordinate system definition esri:31700 only considers the projection and not a datum transformation (e.g. +towgs84=...). There are different sets of datum shift parameters for datum Dealul_Piscului_1970. In the ArcGIS documentation I found the following:

dX=44.107 dY=-116.150 dZ=-54.648
dX=28.000 dY=-121.000 dZ=-77.000

You must include one of them it in the cs2cs command:

cs2cs +init=esri:31700 +towgs84=28,-121,-77 +to +init=epsg:4326 -f '%0.6f'


Regards

José A. Gonçalves




2011/4/22 Adrian Popa <adrian_gh.popa at romtelecom.ro>


	Hello everyone,
	
	I have a problem when converting coordinates from ESRI:31700 (Stereo 70)
	to WGS84 (EPSG:4326). The coordinates I get from the conversion have an
	offset from the original coordinate of about 50m. Here's an example:
	
	Original coordinates (Stereo 70):  587486.770, 326878.452
	Converted coordinates (WGS84): 26.099032,44.436575
	Real coordinates (converted from Stereo 70 with Global Mapper and
	checked with a GPS unit): 26.097414, 44.436335
	
	For the conversion I'm using cs2cs Rel. 4.7.1, 23 September 2009 on
	Ubuntu 10.04.
	
	My ESRI/EPSG definitions are as follows:
	
	EPSG:
	# Dealul Piscului 1970/ Stereo 70 (deprecated)
	<31700> +proj=sterea +lat_0=46 +lon_0=25 +k=0.99975 +x_0=500000
	+y_0=500000 +ellps=krass +units=m +no_defs <>
	# WGS 84
	<4326> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs <>
	
	ESRI:
	# Dealul Piscului 1970/ Stereo 70
	<31700> +proj=stere +lat_0=46 +lon_0=25 +k=0.999750 +x_0=500000
	+y_0=500000 +ellps=krass +units=m +no_defs  no_defs <>
	
	The command line I'm using is:
	$ echo 587486.770 326878.452 | cs2cs +init=esri:31700 +to
	+init=epsg:4326 -f '%0.6f'
	26.099032    44.436575 0.000000
	$ echo 587486.770 326878.452 | cs2cs +init=epsg:31700 +to
	+init=epsg:4326 -f '%0.6f'
	26.098934    44.436629 0.000000
	
	I've read that there is a small difference between stere and sterea
	projections, and sterea should give a better approximation, but I've
	tried with both projections and I still get the ~50m offset.
	
	Can anybody clue me in as to what I'm doing wrong? I must be missing
	something, but I don't know what (I'm somewhat of a noob when it comes
	to map projections).
	
	P.S. The definition for Stereo 70 that I received with my data looks
	consistent with the definition inside proj4:
	
	PROJCS["Stereo_70",GEOGCS["GCS_Dealul_Piscului_1970",DATUM["D_Dealul_Piscului_1970",SPHEROID["Krasovsky_1940",6378245,298.3]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Double_Stereographic"],PARAMETER["False_Easting",500000],PARAMETER["False_Northing",500000],PARAMETER["Longitude_Of_Origin",25],PARAMETER["Scale_Factor",0.99975],PARAMETER["Latitude_Of_Origin",46],UNIT["Meter",1]]
	
	
	Thanks,
	Adrian
	Acest mesaj si orice fisiere sau documente atasate contin informatii confidentiale, clasificate conform regulilor interne ROMTELECOM. Mesajul este destinat doar persoanei sau entitatii adresate si altora autorizati sa-l primeasca. Daca dvs. nu sunteti in aceasta situatie, prin aceasta va informam ca orice dezvaluire, copiere, distribuire sau orice alta actiune bazata pe continutul acestor informatii este strict interzisa si pot fi aplicate sanctiuni, potrivit legii. Daca ati primit acest mesaj din greseala, va rugam sa ne informati imediat si sa stergeti mesajul din sistemul dvs. De asemenea, va rugam sa tineti cont ca transmisia nu poate fi garantata ca fiind sigura sau fara erori. Va multumim!
	_______________________________________________
	Proj mailing list
	Proj at lists.maptools.org
	http://lists.maptools.org/mailman/listinfo/proj
	




From moquet.julien at gmail.com  Wed Apr 27 14:28:45 2011
From: moquet.julien at gmail.com (Julien Moquet)
Date: Wed, 27 Apr 2011 23:28:45 +0200
Subject: [Proj] proj4Php
In-Reply-To: <BANLkTinYVNj3JZk6fXfit0+3Hi3gjKaEtw@mail.gmail.com>
References: <BANLkTinYVNj3JZk6fXfit0+3Hi3gjKaEtw@mail.gmail.com>
Message-ID: <BANLkTinCiB6qDSWiPakcKpfi8U-a-Of95g@mail.gmail.com>

Hi,


I was looking for a PHP API to convert from WGS84 to Lambert 93 (I'm French)
with PHP. So I translate Proj4JS to PHP.

Now it works for my own case (from WGS84 to L93 and reverse for PHP 4 and
PHP 5 - trunk and branches).


 The sources still have bugs for the other conversions, but as it was a
simple translation, it will be easy to fix.

There will be also problems with the REST access, and the heritage mecanism
does not like good to me.

It is available here : https://sourceforge.net/scm/?type=svn&group_id=539158

LGPL


Because it is not a good idea to remain the only guy to fix it, I can easily
add a few new developpers.


Julien2512
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110427/d891ab7e/attachment.html>

From Mikael.Rittri at carmenta.com  Thu Apr 28 01:03:58 2011
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Thu, 28 Apr 2011 08:03:58 +0000
Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A
In-Reply-To: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>

Hello Hilmy!

> my apologies for bringing up this Malayan Monster again.

The Malayan Monster has at least three heads, and sometimes
they grow back after they have been chopped off. ;-) 

1) To get variant A of Hotine Oblique Mercator, the 
   proj.4 omerc definition must include the +no_uoff flag. 
   This flag is missing from the epsg file in proj 4.7.0
   and the trunk, but I think it was present in proj 4.6.1.
   This should explain the large offset along the initial
   line that you observed. I have now opened a ticket on 
   this: http://trac.osgeo.org/proj/ticket/104

2) The +gamma parameter was added to proj.4 fairly 
   recently, in March 2010, so I don't think it is 
   supported in proj 4.7.0, only in the trunk.  
   But I don't know what version of proj.4 is 
   used by Quantum GIS and Postgis.  
       I think the difference between supported 
   and unsupported +gamma could be hard to see on
   the small-scale maps you attached, but it may 
   be visible if you zoom in on the area where 
   you also have cadastral data in Cassini-Soldner. 

   You wrote:
   > In QGis, versions 1.6 and up in OSGeo4W, the 
   > default proj.4 string for EPSG:3168 and EPSG:3375 
   > is without the +gamma parameter, so the projection
   > is not correct.
   
   Not necessarily. With older versions of proj.4, 
   you can implement the Malaysian instances of Hotine 
   Oblique Mercator by adding the +rot_conv flag. This 
   flag does not take a numerical value as +gamma does, 
   it just says:
       "The +gamma differs from +alpha, and +gamma 
        cannot be specified, but I know that this 
        projection is designed for a part of Malaysia."
   (I am not sure what happens if you would specify 
    both +rot_conv and a value for +gamma.)

3) You will need a datum shift as well, in the form
   of +towgs84 parameters.  These are often missing
   in proj's epsg file, for various reasons.  

   - For the new datum, GDM2000, use 

       +towgs84=0,0,0

   This datum shift is missing from EPSG for some reason 
   (and therefore missing in proj's epsg file), but it 
   follows from the Anchor Definition of the datum,
   which EPSG describes as "ITRF 2000, epoch 2000.0",
   meaning the datum is equivalent to WGS84 except for 
   the tectonic motions since 2000.

   - For the datum Kertau(RSO) for West Malaysia, use 

       +towgs84=-11,851,5

   which can be derived from the EPSG datum shift 
   "Kertau (RSO) to WGS 84 (1)", EPSG:8659. The EPSG
   represents this as a concatenated shift via "Kertau 1968",
   which explains why it is missing in proj's epsg file.
   (Well, in the proj.4 trunk, this shift is used for the
    "Kertau 1968" datum, but not for the "Kertau(RSO)" datum;
    I must say I don't quite understand the reasons for
    distinguishing these two datums.) 
   (In fact, the EPSG Remarks for the concatenated shift
    seem to imply that it cannot be represented as a single
    datum shift, but I think that's just wrong. 
    See also http://trac.osgeo.org/proj/ticket/38 ) 
   But note that the accuracy of this datum shift is said
   to be only about 15 meters.  I suspect Malaysian authorities
   know better datum shifts, but maybe they are classified
   or proprietary.

   - For the datum Timbalai 1948 for East Malaysia, use 

       +towgs84=-533.4,669.2,-52.5,0,0,4.28,9.4

   This is the shift "Timbalai 1948 to WGS 84 (4)", EPSG:1852,
   which is said to have accuracy of 5 meters, at least offshore.
   It also occurs in proj's epsg file in the trunk, but not
   in 4.7.0 I think. 

Hope this helps,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com

________________________________

From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Hilmy Hashim
Sent: den 9 april 2011 13:55
To: proj at lists.maptools.org
Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A


Hi, 

This issue has been discussed many times before, so I'm trying to assess the current situation.

I'm a new user of Quantum GIS and Postgis which I understand uses Proj.4 for projections. I'm working with the RSO projection for Peninsular Malaysia both old and new definitions (EPSG:3168 and EPSG:3375). From my readings on various lists, RSO for Malaysia requires the +gamma parameter and the projection method is now classified by epsg-registry.org <http://epsg-registry.org/>  as EPSG:9812 Hotine Oblique Mercator (Variant A). This means that the final rotation applied is at the natural origin as opposed to the center of projection which is Variant B (EPSG:9815)

In QGis, versions 1.6 and up in OSGeo4W, the default proj.4 string for EPSG:3168 and EPSG:3375 is without the +gamma parameter, so the projection is not correct. Looking at the OSGeo4W\share\proj\epsg file, gamma is indeed defined in there. So I'm confused where QGis srs.db is getting it's information from.

Creating a custom CRS in QGis with +gamma seems to have an effect, so the latest omerc.c does take into account the gamma parameter. However, the projection is still not quite correct. It looks like it is correctly aligned to north, but the x and y translation is off and I surmised that this has to do with the final center of rotation. I did an empirical correction with x_0 = false_easting + Uc sin(gc) and y_0 = false_northing + Uc cos(gc) approximately I think. Attached is a diagram of a comparison I did with different parameters. C is approximately the correct projection with a cadaster layer in EPSG:3384 overlayed at the bottom.

As proj.4 is used by many applications, my question is how and where can I get the projection parameters for RSO Malaysia corrected and how can the omerc projection be made to use variant A. I am advising a state government to standardize on QGis and PostGIS so there will be many users.

Thank you for any help  and my apologies for bringing up this Malayan Monster again.


Hilmy
Hilmy



From hilmyh at gmail.com  Thu Apr 28 02:35:15 2011
From: hilmyh at gmail.com (Hilmy Hashim)
Date: Thu, 28 Apr 2011 17:35:15 +0800
Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
Message-ID: <BANLkTikOqyrVbFr3Cb07k5K8EHqb-9Vghg@mail.gmail.com>

Mikael,

Thanks very much for a very clear definition of the problem. Indeed, the
Malayan Monster has many heads! And thank you for submitting the ticket. I
hope Frank can do something about it.

I have seen the  +no_uoff flag mentioned but I didn't see it used in omerc.c
trunk. I started using qgis from 1.6 for my current project but I now prefer
to use 1.7-dev.

In qgis 1.7, the +gamma parameter is absent from the main projections list,
but if I add it in as a custom crs, it does have an effect. see my diagram
B previously. So I assume qgis 1.7 on OSGeo4W uses the latest proj4 build,
whatever that is - the shell say Rel. 4.7.1, 23 September 2009. This is
another head of the monster, qgis srs.db which holds the proj4 strings, is
not synced to the latest gdal espg database, which has the gamma parameter
included.

Again, thanks for responding.

Regards

*Hilmy*


On Thu, Apr 28, 2011 at 4:03 PM, Mikael Rittri
<Mikael.Rittri at carmenta.com>wrote:

> Hello Hilmy!
>
> > my apologies for bringing up this Malayan Monster again.
>
> The Malayan Monster has at least three heads, and sometimes
> they grow back after they have been chopped off. ;-)
>
> 1) To get variant A of Hotine Oblique Mercator, the
>   proj.4 omerc definition must include the +no_uoff flag.
>   This flag is missing from the epsg file in proj 4.7.0
>   and the trunk, but I think it was present in proj 4.6.1.
>   This should explain the large offset along the initial
>   line that you observed. I have now opened a ticket on
>   this: http://trac.osgeo.org/proj/ticket/104
>
> 2) The +gamma parameter was added to proj.4 fairly
>   recently, in March 2010, so I don't think it is
>   supported in proj 4.7.0, only in the trunk.
>   But I don't know what version of proj.4 is
>   used by Quantum GIS and Postgis.
>       I think the difference between supported
>   and unsupported +gamma could be hard to see on
>   the small-scale maps you attached, but it may
>   be visible if you zoom in on the area where
>   you also have cadastral data in Cassini-Soldner.
>
>   You wrote:
>   > In QGis, versions 1.6 and up in OSGeo4W, the
>   > default proj.4 string for EPSG:3168 and EPSG:3375
>   > is without the +gamma parameter, so the projection
>   > is not correct.
>
>    Not necessarily. With older versions of proj.4,
>   you can implement the Malaysian instances of Hotine
>   Oblique Mercator by adding the +rot_conv flag. This
>   flag does not take a numerical value as +gamma does,
>   it just says:
>       "The +gamma differs from +alpha, and +gamma
>        cannot be specified, but I know that this
>        projection is designed for a part of Malaysia."
>   (I am not sure what happens if you would specify
>    both +rot_conv and a value for +gamma.)
>
> 3) You will need a datum shift as well, in the form
>   of +towgs84 parameters.  These are often missing
>   in proj's epsg file, for various reasons.
>
>   - For the new datum, GDM2000, use
>
>       +towgs84=0,0,0
>
>   This datum shift is missing from EPSG for some reason
>   (and therefore missing in proj's epsg file), but it
>   follows from the Anchor Definition of the datum,
>   which EPSG describes as "ITRF 2000, epoch 2000.0",
>   meaning the datum is equivalent to WGS84 except for
>   the tectonic motions since 2000.
>
>   - For the datum Kertau(RSO) for West Malaysia, use
>
>       +towgs84=-11,851,5
>
>   which can be derived from the EPSG datum shift
>   "Kertau (RSO) to WGS 84 (1)", EPSG:8659. The EPSG
>   represents this as a concatenated shift via "Kertau 1968",
>   which explains why it is missing in proj's epsg file.
>   (Well, in the proj.4 trunk, this shift is used for the
>    "Kertau 1968" datum, but not for the "Kertau(RSO)" datum;
>    I must say I don't quite understand the reasons for
>    distinguishing these two datums.)
>   (In fact, the EPSG Remarks for the concatenated shift
>    seem to imply that it cannot be represented as a single
>    datum shift, but I think that's just wrong.
>    See also http://trac.osgeo.org/proj/ticket/38 )
>   But note that the accuracy of this datum shift is said
>   to be only about 15 meters.  I suspect Malaysian authorities
>   know better datum shifts, but maybe they are classified
>   or proprietary.
>
>   - For the datum Timbalai 1948 for East Malaysia, use
>
>       +towgs84=-533.4,669.2,-52.5,0,0,4.28,9.4
>
>   This is the shift "Timbalai 1948 to WGS 84 (4)", EPSG:1852,
>   which is said to have accuracy of 5 meters, at least offshore.
>   It also occurs in proj's epsg file in the trunk, but not
>   in 4.7.0 I think.
>
> Hope this helps,
>
> Mikael Rittri
> Carmenta
> Sweden
> http://www.carmenta.com
>
> ________________________________
>
> From: proj-bounces at lists.maptools.org [mailto:
> proj-bounces at lists.maptools.org] On Behalf Of Hilmy Hashim
> Sent: den 9 april 2011 13:55
> To: proj at lists.maptools.org
> Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A
>
>
> Hi,
>
> This issue has been discussed many times before, so I'm trying to assess
> the current situation.
>
> I'm a new user of Quantum GIS and Postgis which I understand uses Proj.4
> for projections. I'm working with the RSO projection for Peninsular Malaysia
> both old and new definitions (EPSG:3168 and EPSG:3375). From my readings on
> various lists, RSO for Malaysia requires the +gamma parameter and the
> projection method is now classified by epsg-registry.org <
> http://epsg-registry.org/>  as EPSG:9812 Hotine Oblique Mercator (Variant
> A). This means that the final rotation applied is at the natural origin as
> opposed to the center of projection which is Variant B (EPSG:9815)
>
> In QGis, versions 1.6 and up in OSGeo4W, the default proj.4 string for
> EPSG:3168 and EPSG:3375 is without the +gamma parameter, so the projection
> is not correct. Looking at the OSGeo4W\share\proj\epsg file, gamma is indeed
> defined in there. So I'm confused where QGis srs.db is getting it's
> information from.
>
> Creating a custom CRS in QGis with +gamma seems to have an effect, so the
> latest omerc.c does take into account the gamma parameter. However, the
> projection is still not quite correct. It looks like it is correctly aligned
> to north, but the x and y translation is off and I surmised that this has to
> do with the final center of rotation. I did an empirical correction with x_0
> = false_easting + Uc sin(gc) and y_0 = false_northing + Uc cos(gc)
> approximately I think. Attached is a diagram of a comparison I did with
> different parameters. C is approximately the correct projection with a
> cadaster layer in EPSG:3384 overlayed at the bottom.
>
> As proj.4 is used by many applications, my question is how and where can I
> get the projection parameters for RSO Malaysia corrected and how can the
> omerc projection be made to use variant A. I am advising a state government
> to standardize on QGis and PostGIS so there will be many users.
>
> Thank you for any help  and my apologies for bringing up this Malayan
> Monster again.
>
>
> Hilmy
> Hilmy
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110428/5db5e41e/attachment.html>

From hilmyh at gmail.com  Thu Apr 28 02:48:19 2011
From: hilmyh at gmail.com (Hilmy Hashim)
Date: Thu, 28 Apr 2011 17:48:19 +0800
Subject: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
Message-ID: <BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>

Mikael,


In http://trac.osgeo.org/proj/ticket/104, you said

A +no_uoff ("no u-offset") means that the origin is at the so-called natural
origin, on the central oblique line of the projection, and near the ordinary
equator (on the "aposphere equator", but I've never understood what an
aposphere is).
>From my simplistic understanding of Hotine's method, during the first part
of the forward projection, the coordinates from the ellipsoid are projected
onto a sphere of "constant total curvature" or an aposphere. I suppose this
makes the maths simpler? So the equator on this aposphere is slightly offset
from the equator on the ellipsoid.

Regards

*Hilmy*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110428/cb42c8be/attachment.html>

From roger at opq.se  Thu Apr 28 03:10:02 2011
From: roger at opq.se (Roger Oberholtzer)
Date: Thu, 28 Apr 2011 12:10:02 +0200
Subject: [Proj] Russia and "System 74" [OFF TOPIC]
Message-ID: <1303985402.14793.69.camel@acme.pacific>

I'm asking on this list because there is lots of knowledge beyond proj4.
Hope no one minds.

I have had a request to provide coordinates to folk in St. Petersburg
Russia in "System 74". I have not been able to get any details beyond
that. I have googled a bit to see what this might be, and it looks more
like a satellite description than a projection. Did I miss anything?


Yours sincerely,

Roger Oberholtzer

OPQ Systems / Ramböll RST

Office: Int +46 10-615 60 20
Mobile: Int +46 70-815 1696
roger.oberholtzer at ramboll.se
________________________________________

Ramböll Sverige AB
Krukmakargatan 21
P.O. Box 17009
SE-104 62 Stockholm, Sweden
www.rambollrst.se




From Mikael.Rittri at carmenta.com  Thu Apr 28 04:20:16 2011
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Thu, 28 Apr 2011 11:20:16 +0000
Subject: [Proj] Meaning of aposphere (was: RE:  RSO,
 +gamma and Hotine Oblique Mercator Variant A)
In-Reply-To: <BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
	<BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>
Message-ID: <E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>

Yes, I understand that the aposphere is some kind 
of intermediate surface. 

But it's the phrase "sphere of constant total curvature" 
that bothers me.  Most people who describes the Hotine cites
this phrase; I think it's from Snyder.  I tried to look up 
"total curvature", and if I remember rightly, it has at least
two meanings: 
  In one meaning, every surface that is topologically equivalent
to a sphere has the same total curvature (4*pi or something like
that). That's probably not what Snyder meant...  
  In another meaning, total curvature refers to Gaussian curvature
at a point of a surface.  But in this meaning, every sphere has
constant total curvature, so the aposphere seems to be a sphere,
no more and no less.  So, how does it differ from the Gaussian
sphere that is used in some other projections, like Swiss Oblique
Mercator, Krovak, and Oblique Sterographic?
  Or are there other surfaces than spheres that can have a constant
Gaussian curvature at every point? (I think there is some trumpet-shaped
surface that has constant Gaussian curvature, but curvature like a saddle;
is that positive or negative curvature? But apart from that.) 

Well, I shouldn't complain but try to read Hotine's original paper,
but rumors say it's very dense and difficult to follow. I suspect
I wouldn't understand it. 

But if someone knows a snappy explanation of the aposphere...? 
Just curious,

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com 

________________________________

From: Hilmy Hashim [mailto:hilmyh at gmail.com] 
Sent: den 28 april 2011 11:48
To: Mikael Rittri
Cc: PROJ.4 and general Projections Discussions
Subject: Re: [Proj] RSO, +gamma and Hotine Oblique Mercator Variant A


Mikael,


In http://trac.osgeo.org/proj/ticket/104, you said

A +no_uoff ("no u-offset") means that the origin is at the so-called natural origin, on the central oblique line of the projection, and near the ordinary equator (on the "aposphere equator", but I've never understood what an aposphere is).

>From my simplistic understanding of Hotine's method, during the first part of the forward projection, the coordinates from the ellipsoid are projected onto a sphere of "constant total curvature" or an aposphere. I suppose this makes the maths simpler? So the equator on this aposphere is slightly offset from the equator on the ellipsoid.

Regards

Hilmy






From charles.karney at sri.com  Thu Apr 28 04:35:32 2011
From: charles.karney at sri.com (Charles Karney)
Date: Thu, 28 Apr 2011 07:35:32 -0400
Subject: [Proj] Meaning of aposphere
In-Reply-To: <E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
	<BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
Message-ID: <4DB95104.7090005@sri.com>

Well, I puzzled by how an aposphere could be different from a sphere.
However there are surfaces with constant curvature which are not
spheres.  I think if you impose additional conditions, e.g., that the
surface is closed and nowhere singular you end up with a sphere.  A
simple example of a non-spherical surface is what you get if you
partially folded up a swimming cap.  A tractrix rotated about its
aymptote gives you a surface of constant negative curvature.  I'm
uncertain whether any of these are really needed to develop map
projections.

For pictures see Eisenhardt (1909), Chap 8, Figs. 26-30:

   http://books.google.com/books?id=hkENAAAAYAAJ&pg=PA270

On 04/28/11 07:20, Mikael Rittri wrote:
> Yes, I understand that the aposphere is some kind
> of intermediate surface.
>
> But it's the phrase "sphere of constant total curvature"
> that bothers me.  Most people who describes the Hotine cites
> this phrase; I think it's from Snyder.  I tried to look up
> "total curvature", and if I remember rightly, it has at least
> two meanings:
>    In one meaning, every surface that is topologically equivalent
> to a sphere has the same total curvature (4*pi or something like
> that). That's probably not what Snyder meant...
>    In another meaning, total curvature refers to Gaussian curvature
> at a point of a surface.  But in this meaning, every sphere has
> constant total curvature, so the aposphere seems to be a sphere,
> no more and no less.  So, how does it differ from the Gaussian
> sphere that is used in some other projections, like Swiss Oblique
> Mercator, Krovak, and Oblique Sterographic?
>    Or are there other surfaces than spheres that can have a constant
> Gaussian curvature at every point? (I think there is some trumpet-shaped
> surface that has constant Gaussian curvature, but curvature like a saddle;
> is that positive or negative curvature? But apart from that.)
>
> Well, I shouldn't complain but try to read Hotine's original paper,
> but rumors say it's very dense and difficult to follow. I suspect
> I wouldn't understand it.
>
> But if someone knows a snappy explanation of the aposphere...?
> Just curious,
>
> Mikael Rittri

-- 
Charles Karney <charles.karney at sri.com>
SRI International, Princeton, NJ 08543-5300
Tel: +1 609 734 2312


From ndzinn at comcast.net  Thu Apr 28 05:52:48 2011
From: ndzinn at comcast.net (Noel Zinn (cc))
Date: Thu, 28 Apr 2011 07:52:48 -0500
Subject: [Proj] Meaning of aposphere
In-Reply-To: <4DB95104.7090005@sri.com>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se><BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
	<4DB95104.7090005@sri.com>
Message-ID: <4F8B3D2EAACC48E9B54AB651AE9DB947@NoelHmPC>

For what it's worth, the Geodetic Glossary published by the (US) National
Geodetic Survey in September 1986 has a definition of aposphere:

"A surface of rotation whose meridional section is defined by the equation:
r = a sech [b (tau + c)], where a, b and c are constants, tau is the
isometric latitude, and r is the perpendicular distance from the axis of
rotation to the surface."

Also, "The constants are chosen so that the aposphere touches the ellipsoid
with which it has a common axis of rotation along some parallel that passes
through the center of the area for which the transformation is required"

Noel Zinn, Principal, Hydrometronics LLC
+1-832-539-1472 (office), +1-281-221-0051 (cell)
noel.zinn at hydrometronics.com (email)
http://www.hydrometronics.com (website)

-----Original Message----- 
From: Charles Karney
Sent: Thursday, April 28, 2011 6:35 AM
To: PROJ.4 and general Projections Discussions
Cc: Hilmy Hashim
Subject: Re: [Proj] Meaning of aposphere

Well, I puzzled by how an aposphere could be different from a sphere.
However there are surfaces with constant curvature which are not
spheres.  I think if you impose additional conditions, e.g., that the
surface is closed and nowhere singular you end up with a sphere.  A
simple example of a non-spherical surface is what you get if you
partially folded up a swimming cap.  A tractrix rotated about its
aymptote gives you a surface of constant negative curvature.  I'm
uncertain whether any of these are really needed to develop map
projections.

For pictures see Eisenhardt (1909), Chap 8, Figs. 26-30:

   http://books.google.com/books?id=hkENAAAAYAAJ&pg=PA270

On 04/28/11 07:20, Mikael Rittri wrote:
> Yes, I understand that the aposphere is some kind
> of intermediate surface.
>
> But it's the phrase "sphere of constant total curvature"
> that bothers me.  Most people who describes the Hotine cites
> this phrase; I think it's from Snyder.  I tried to look up
> "total curvature", and if I remember rightly, it has at least
> two meanings:
>    In one meaning, every surface that is topologically equivalent
> to a sphere has the same total curvature (4*pi or something like
> that). That's probably not what Snyder meant...
>    In another meaning, total curvature refers to Gaussian curvature
> at a point of a surface.  But in this meaning, every sphere has
> constant total curvature, so the aposphere seems to be a sphere,
> no more and no less.  So, how does it differ from the Gaussian
> sphere that is used in some other projections, like Swiss Oblique
> Mercator, Krovak, and Oblique Sterographic?
>    Or are there other surfaces than spheres that can have a constant
> Gaussian curvature at every point? (I think there is some trumpet-shaped
> surface that has constant Gaussian curvature, but curvature like a saddle;
> is that positive or negative curvature? But apart from that.)
>
> Well, I shouldn't complain but try to read Hotine's original paper,
> but rumors say it's very dense and difficult to follow. I suspect
> I wouldn't understand it.
>
> But if someone knows a snappy explanation of the aposphere...?
> Just curious,
>
> Mikael Rittri

-- 
Charles Karney <charles.karney at sri.com>
SRI International, Princeton, NJ 08543-5300
Tel: +1 609 734 2312
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj 




From cjmce at lsu.edu  Thu Apr 28 07:02:33 2011
From: cjmce at lsu.edu (Clifford J Mugnier)
Date: Thu, 28 Apr 2011 09:02:33 -0500
Subject: [Proj] Meaning of aposphere
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se><BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
	<4DB95104.7090005@sri.com>
Message-ID: <B597ADFC46B67741B18EA6AA13613FF7026A691C@email002.lsu.edu>

I've read Hotine's series in Empire Survey Review.  I tell my students that his Aposphere is shaped like a turnip.
 
Clifford J. Mugnier, C.P., C.M.S.
Chief of Geodesy,
Center for GeoInformatics
Department of Civil Engineering 
Patrick F. Taylor Hall 3223A
LOUISIANA STATE UNIVERSITY 
Baton Rouge, LA  70803
Voice and Facsimile:  (225) 578-8536 [Academic] 
Voice and Facsimile:  (225) 578-4578 [Research] 
Cell: (225) 328-8975 [Academic & Research]
Honorary Life Member of the 
Louisiana Society of Professional Surveyors 
Fellow Emeritus of the ASPRS 
Member of the Americas Petroleum Survey Group


________________________________

From: proj-bounces at lists.maptools.org on behalf of Charles Karney
Sent: Thu 28-Apr-11 06:35
To: PROJ.4 and general Projections Discussions
Cc: Hilmy Hashim
Subject: Re: [Proj] Meaning of aposphere



Well, I puzzled by how an aposphere could be different from a sphere.
However there are surfaces with constant curvature which are not
spheres.  I think if you impose additional conditions, e.g., that the
surface is closed and nowhere singular you end up with a sphere.  A
simple example of a non-spherical surface is what you get if you
partially folded up a swimming cap.  A tractrix rotated about its
aymptote gives you a surface of constant negative curvature.  I'm
uncertain whether any of these are really needed to develop map
projections.

For pictures see Eisenhardt (1909), Chap 8, Figs. 26-30:

   http://books.google.com/books?id=hkENAAAAYAAJ&pg=PA270

On 04/28/11 07:20, Mikael Rittri wrote:
> Yes, I understand that the aposphere is some kind
> of intermediate surface.
>
> But it's the phrase "sphere of constant total curvature"
> that bothers me.  Most people who describes the Hotine cites
> this phrase; I think it's from Snyder.  I tried to look up
> "total curvature", and if I remember rightly, it has at least
> two meanings:
>    In one meaning, every surface that is topologically equivalent
> to a sphere has the same total curvature (4*pi or something like
> that). That's probably not what Snyder meant...
>    In another meaning, total curvature refers to Gaussian curvature
> at a point of a surface.  But in this meaning, every sphere has
> constant total curvature, so the aposphere seems to be a sphere,
> no more and no less.  So, how does it differ from the Gaussian
> sphere that is used in some other projections, like Swiss Oblique
> Mercator, Krovak, and Oblique Sterographic?
>    Or are there other surfaces than spheres that can have a constant
> Gaussian curvature at every point? (I think there is some trumpet-shaped
> surface that has constant Gaussian curvature, but curvature like a saddle;
> is that positive or negative curvature? But apart from that.)
>
> Well, I shouldn't complain but try to read Hotine's original paper,
> but rumors say it's very dense and difficult to follow. I suspect
> I wouldn't understand it.
>
> But if someone knows a snappy explanation of the aposphere...?
> Just curious,
>
> Mikael Rittri

--
Charles Karney <charles.karney at sri.com>
SRI International, Princeton, NJ 08543-5300
Tel: +1 609 734 2312
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110428/fc299b09/attachment.html>

From hilmyh at gmail.com  Thu Apr 28 08:29:50 2011
From: hilmyh at gmail.com (Hilmy Hashim)
Date: Thu, 28 Apr 2011 23:29:50 +0800
Subject: [Proj] Meaning of aposphere
In-Reply-To: <B597ADFC46B67741B18EA6AA13613FF7026A691C@email002.lsu.edu>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se>
	<BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com>
	<E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
	<4DB95104.7090005@sri.com>
	<B597ADFC46B67741B18EA6AA13613FF7026A691C@email002.lsu.edu>
Message-ID: <BANLkTik-9UD6N724ABrQqX6yQjWiRgy8bg@mail.gmail.com>

So Monster meets Turnip - who wins?

*Hilmy*


On Thu, Apr 28, 2011 at 10:02 PM, Clifford J Mugnier <cjmce at lsu.edu> wrote:

>  I've read Hotine's series in *Empire Survey Review*.  I tell my students
> that his Aposphere is shaped like a turnip.
>
>  Clifford J. Mugnier, C.P., C.M.S.
> Chief of Geodesy,
> *Center for GeoInformatics*
> Department of Civil Engineering
> Patrick F. Taylor Hall 3223A
> *LOUISIANA STATE UNIVERSITY *
> Baton Rouge, LA  70803
> Voice and Facsimile:  (225) 578-8536 [Academic]
> Voice and Facsimile:  (225) 578-4578 [Research]
> Cell: (225) 328-8975 [Academic & Research]
> Honorary Life Member of the
> Louisiana Society of Professional Surveyors
> Fellow Emeritus of the ASPRS
> Member of the Americas Petroleum Survey Group
>
>
> ------------------------------
> *From:* proj-bounces at lists.maptools.org on behalf of Charles Karney
> *Sent:* Thu 28-Apr-11 06:35
> *To:* PROJ.4 and general Projections Discussions
> *Cc:* Hilmy Hashim
> *Subject:* Re: [Proj] Meaning of aposphere
>
>  Well, I puzzled by how an aposphere could be different from a sphere.
> However there are surfaces with constant curvature which are not
> spheres.  I think if you impose additional conditions, e.g., that the
> surface is closed and nowhere singular you end up with a sphere.  A
> simple example of a non-spherical surface is what you get if you
> partially folded up a swimming cap.  A tractrix rotated about its
> aymptote gives you a surface of constant negative curvature.  I'm
> uncertain whether any of these are really needed to develop map
> projections.
>
> For pictures see Eisenhardt (1909), Chap 8, Figs. 26-30:
>
>    http://books.google.com/books?id=hkENAAAAYAAJ&pg=PA270
>
> On 04/28/11 07:20, Mikael Rittri wrote:
> > Yes, I understand that the aposphere is some kind
> > of intermediate surface.
> >
> > But it's the phrase "sphere of constant total curvature"
> > that bothers me.  Most people who describes the Hotine cites
> > this phrase; I think it's from Snyder.  I tried to look up
> > "total curvature", and if I remember rightly, it has at least
> > two meanings:
> >    In one meaning, every surface that is topologically equivalent
> > to a sphere has the same total curvature (4*pi or something like
> > that). That's probably not what Snyder meant...
> >    In another meaning, total curvature refers to Gaussian curvature
> > at a point of a surface.  But in this meaning, every sphere has
> > constant total curvature, so the aposphere seems to be a sphere,
> > no more and no less.  So, how does it differ from the Gaussian
> > sphere that is used in some other projections, like Swiss Oblique
> > Mercator, Krovak, and Oblique Sterographic?
> >    Or are there other surfaces than spheres that can have a constant
> > Gaussian curvature at every point? (I think there is some trumpet-shaped
> > surface that has constant Gaussian curvature, but curvature like a
> saddle;
> > is that positive or negative curvature? But apart from that.)
> >
> > Well, I shouldn't complain but try to read Hotine's original paper,
> > but rumors say it's very dense and difficult to follow. I suspect
> > I wouldn't understand it.
> >
> > But if someone knows a snappy explanation of the aposphere...?
> > Just curious,
> >
> > Mikael Rittri
>
> --
> Charles Karney <charles.karney at sri.com>
> SRI International, Princeton, NJ 08543-5300
> Tel: +1 609 734 2312
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110428/979a81e1/attachment.html>

From greenberg at ucdavis.edu  Thu Apr 28 13:33:47 2011
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Thu, 28 Apr 2011 13:33:47 -0700
Subject: [Proj] Different lat/lon projections
Message-ID: <BANLkTi=Wn8iS8LMbNoKorZtdFLtvP6kMzg@mail.gmail.com>

Folks:

What is the correct CRS projection string for dealing with the following two
lat/long projections (say, WGS84 datum):

1) (xmin, xmax, ymin, ymax)= -180,180, -90, 90
2) 0, 360, -90, 90

Thanks!

--j

-- 
Jonathan A. Greenberg, PhD
Assistant Project Scientist
Center for Spatial Technologies and Remote Sensing (CSTARS)
Department of Land, Air and Water Resources
University of California, Davis
One Shields Avenue
Davis, CA 95616
Phone: 415-763-5476
AIM: jgrn307, MSN: jgrn307 at hotmail.com, Gchat: jgrn307
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110428/541896e8/attachment.html>

From Mikael.Rittri at carmenta.com  Fri Apr 29 05:22:01 2011
From: Mikael.Rittri at carmenta.com (Mikael Rittri)
Date: Fri, 29 Apr 2011 12:22:01 +0000
Subject: [Proj] Meaning of aposphere
In-Reply-To: <B597ADFC46B67741B18EA6AA13613FF7026A691C@email002.lsu.edu>
References: <BANLkTikLmr7rr+jJwi3RRFQOMaRFV6M_XA@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455BD@SETHNWS023.carmenta.se><BANLkTinmUyp1vSekosy4MvTxY2b1EPkh_A@mail.gmail.com><E4AB3DD44D22854B819908379DE4AD49388455F4@SETHNWS023.carmenta.se>
	<4DB95104.7090005@sri.com>
	<B597ADFC46B67741B18EA6AA13613FF7026A691C@email002.lsu.edu>
Message-ID: <E4AB3DD44D22854B819908379DE4AD493885409C@SETHNWS023.carmenta.se>


> his Aposphere is shaped like a turnip.

Like a swede, you mean? I'm flattered. 
(If the pun doesn't work in America, never mind.)

So, rotational symmetry, nearly like a sphere, but
perhaps somewhat pointy poles?  I suppose that makes
sense.  Thanks, all who answered.

Mikael Rittri
Carmenta
Sweden
http://www.carmenta.com
________________________________

From: proj-bounces at lists.maptools.org [mailto:proj-bounces at lists.maptools.org] On Behalf Of Clifford J Mugnier
Sent: den 28 april 2011 16:03
To: PROJ.4 and general Projections Discussions; PROJ.4 and general Projections Discussions
Cc: Hilmy Hashim
Subject: Re: [Proj] Meaning of aposphere


I've read Hotine's series in Empire Survey Review.  I tell my students that his Aposphere is shaped like a turnip.
 
Clifford J. Mugnier, C.P., C.M.S.
Chief of Geodesy,
Center for GeoInformatics
Department of Civil Engineering 
Patrick F. Taylor Hall 3223A
LOUISIANA STATE UNIVERSITY 
Baton Rouge, LA  70803
Voice and Facsimile:  (225) 578-8536 [Academic] 
Voice and Facsimile:  (225) 578-4578 [Research] 
Cell: (225) 328-8975 [Academic & Research]
Honorary Life Member of the 
Louisiana Society of Professional Surveyors 
Fellow Emeritus of the ASPRS 
Member of the Americas Petroleum Survey Group


________________________________

From: proj-bounces at lists.maptools.org on behalf of Charles Karney
Sent: Thu 28-Apr-11 06:35
To: PROJ.4 and general Projections Discussions
Cc: Hilmy Hashim
Subject: Re: [Proj] Meaning of aposphere



Well, I puzzled by how an aposphere could be different from a sphere.
However there are surfaces with constant curvature which are not
spheres.  I think if you impose additional conditions, e.g., that the
surface is closed and nowhere singular you end up with a sphere.  A
simple example of a non-spherical surface is what you get if you
partially folded up a swimming cap.  A tractrix rotated about its
aymptote gives you a surface of constant negative curvature.  I'm
uncertain whether any of these are really needed to develop map
projections.

For pictures see Eisenhardt (1909), Chap 8, Figs. 26-30:

   http://books.google.com/books?id=hkENAAAAYAAJ&pg=PA270

On 04/28/11 07:20, Mikael Rittri wrote:
> Yes, I understand that the aposphere is some kind
> of intermediate surface.
>
> But it's the phrase "sphere of constant total curvature"
> that bothers me.  Most people who describes the Hotine cites
> this phrase; I think it's from Snyder.  I tried to look up
> "total curvature", and if I remember rightly, it has at least
> two meanings:
>    In one meaning, every surface that is topologically equivalent
> to a sphere has the same total curvature (4*pi or something like
> that). That's probably not what Snyder meant...
>    In another meaning, total curvature refers to Gaussian curvature
> at a point of a surface.  But in this meaning, every sphere has
> constant total curvature, so the aposphere seems to be a sphere,
> no more and no less.  So, how does it differ from the Gaussian
> sphere that is used in some other projections, like Swiss Oblique
> Mercator, Krovak, and Oblique Sterographic?
>    Or are there other surfaces than spheres that can have a constant
> Gaussian curvature at every point? (I think there is some trumpet-shaped
> surface that has constant Gaussian curvature, but curvature like a saddle;
> is that positive or negative curvature? But apart from that.)
>
> Well, I shouldn't complain but try to read Hotine's original paper,
> but rumors say it's very dense and difficult to follow. I suspect
> I wouldn't understand it.
>
> But if someone knows a snappy explanation of the aposphere...?
> Just curious,
>
> Mikael Rittri

--
Charles Karney <charles.karney at sri.com>
SRI International, Princeton, NJ 08543-5300
Tel: +1 609 734 2312
_______________________________________________
Proj mailing list
Proj at lists.maptools.org
http://lists.maptools.org/mailman/listinfo/proj




From j.l.h.hartmann at uva.nl  Fri Apr 29 13:10:50 2011
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri, 29 Apr 2011 22:10:50 +0200
Subject: [Proj] Dutch correction grid
In-Reply-To: <4D9F3801.8060108@pobox.com>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
Message-ID: <4DBB1B4A.40809@uva.nl>


(About creating a grid shift file for the Dutch RD projection):

On 04/08/11 18:29, Frank Warmerdam wrote:
> As input we would require an input raster with two "bands" 
> representing the
> offset in longitude and latitude.   I'm not sure off hand what the units
> are - possibly arcseconds?   The input file would need to be 
> georeferenced
> in latitude and longitude.
>
> If your input points are sparse and irregular you could likely use
> gdal_grid to interpolate a grid from the point data.
>
> My point was mainly that you don't necessarily have to write an NTv2
> "writer" - it is sufficient to get the datum shift data into any GDAL
> support grid format.
>
> Best regards,
>
I made a 400*400 gdal raster called dxy.tif with two bands, the first 
with offsets for longitude, the second for latitude, all in arcseconds. 
If I use this file in the +nadgrids clause of cs2cs, I don't see any 
difference in the output. If I change the filename into something 
non-existing, I don 't see any differences either and do not get an 
error message. Any idea how I can test this further?

Jan

Driver: GTiff/GeoTIFF
Files: dxy.tif
Size is 400, 400
Coordinate System is:
GEOGCS["RT38",
     DATUM["Stockholm_1938",
         SPHEROID["Bessel 1841",6377397.155,299.1528128000008,
             AUTHORITY["EPSG","7004"]],
         AUTHORITY["EPSG","6308"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4308"]]
Origin = (3.386235000000000,50.762069400000001)
Pixel Size = (0.009627452750000,0.007066402750000)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (   3.3862350,  50.7620694) (  3d23'10.45"E, 50d45'43.45"N)
Lower Left  (   3.3862350,  53.5886305) (  3d23'10.45"E, 53d35'19.07"N)
Upper Right (   7.2372161,  50.7620694) (  7d14'13.98"E, 50d45'43.45"N)
Lower Right (   7.2372161,  53.5886305) (  7d14'13.98"E, 53d35'19.07"N)
Center      (   5.3117256,  52.1753499) (  5d18'42.21"E, 52d10'31.26"N)
Band 1 Block=400x1 Type=Float64, ColorInterp=Gray
Band 2 Block=400x1 Type=Float64, ColorInterp=Undefined


From jagoncal at gmail.com  Fri Apr 29 14:39:08 2011
From: jagoncal at gmail.com (=?ISO-8859-1?Q?Jose_Gon=E7alves?=)
Date: Fri, 29 Apr 2011 22:39:08 +0100
Subject: [Proj] Dutch correction grid
In-Reply-To: <4DBB1B4A.40809@uva.nl>
References: <40955.145.50.39.11.1302160702.squirrel@webmail.hostingdiscounter.nl>
	<4D9D724C.9020003@uva.nl> <4D9F276C.2050002@pobox.com>
	<4D9F2992.6010506@uva.nl> <4D9F3801.8060108@pobox.com>
	<4DBB1B4A.40809@uva.nl>
Message-ID: <BANLkTikRkG0+9Q4U8GRovKj5Xxj0sRPmvg@mail.gmail.com>

The +nadgrid command expects a NTv2 file, with extension gsb, not a tiff
file. You must use gdal_translate to convert it to the NTv2 format. I think
that's what Frank Warmerdam referred in a previous email.

Regards

Jose' A. Gonçalves




2011/4/29 Jan Hartmann <j.l.h.hartmann at uva.nl>

>
> (About creating a grid shift file for the Dutch RD projection):
>
> On 04/08/11 18:29, Frank Warmerdam wrote:
> > As input we would require an input raster with two "bands"
> > representing the
> > offset in longitude and latitude.   I'm not sure off hand what the units
> > are - possibly arcseconds?   The input file would need to be
> > georeferenced
> > in latitude and longitude.
> >
> > If your input points are sparse and irregular you could likely use
> > gdal_grid to interpolate a grid from the point data.
> >
> > My point was mainly that you don't necessarily have to write an NTv2
> > "writer" - it is sufficient to get the datum shift data into any GDAL
> > support grid format.
> >
> > Best regards,
> >
> I made a 400*400 gdal raster called dxy.tif with two bands, the first
> with offsets for longitude, the second for latitude, all in arcseconds.
> If I use this file in the +nadgrids clause of cs2cs, I don't see any
> difference in the output. If I change the filename into something
> non-existing, I don 't see any differences either and do not get an
> error message. Any idea how I can test this further?
>
> Jan
>
> Driver: GTiff/GeoTIFF
> Files: dxy.tif
> Size is 400, 400
> Coordinate System is:
> GEOGCS["RT38",
>     DATUM["Stockholm_1938",
>         SPHEROID["Bessel 1841",6377397.155,299.1528128000008,
>             AUTHORITY["EPSG","7004"]],
>         AUTHORITY["EPSG","6308"]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433],
>     AUTHORITY["EPSG","4308"]]
> Origin = (3.386235000000000,50.762069400000001)
> Pixel Size = (0.009627452750000,0.007066402750000)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (   3.3862350,  50.7620694) (  3d23'10.45"E, 50d45'43.45"N)
> Lower Left  (   3.3862350,  53.5886305) (  3d23'10.45"E, 53d35'19.07"N)
> Upper Right (   7.2372161,  50.7620694) (  7d14'13.98"E, 50d45'43.45"N)
> Lower Right (   7.2372161,  53.5886305) (  7d14'13.98"E, 53d35'19.07"N)
> Center      (   5.3117256,  52.1753499) (  5d18'42.21"E, 52d10'31.26"N)
> Band 1 Block=400x1 Type=Float64, ColorInterp=Gray
> Band 2 Block=400x1 Type=Float64, ColorInterp=Undefined
> _______________________________________________
> Proj mailing list
> Proj at lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20110429/c3ae082a/attachment.html>

