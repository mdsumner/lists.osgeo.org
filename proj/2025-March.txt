From nyall.dawson at gmail.com  Fri Mar  7 22:30:24 2025
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Sat, 8 Mar 2025 16:30:24 +1000
Subject: [PROJ] Determine "cut line" for arbitrary projection
Message-ID: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>

Hi list,

A question: given an arbitrary projection/CRS, is it possible to determine
the latitude (or projected x coordinate) at which features would need to be
"cut" in order to avoid artifacts when those features wrap around the
projection extremes.

Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But if
it's another projection... say mercator or spilhaus or ... is there any way
to reliably determine this cutting line?

Nyall
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250308/086f3da9/attachment.htm>

From kristianevers at gmail.com  Sat Mar  8 07:39:05 2025
From: kristianevers at gmail.com (Kristian Evers)
Date: Sat, 8 Mar 2025 16:39:05 +0100
Subject: [PROJ] PROJ 9.6.0RC1 & PROJ-data 1.21RC1
Message-ID: <7F0572DE-DA60-4FFA-B9E3-8E1BAD525683@gmail.com>

All,

in preparation for a new round of PROJ and PROJ-data release I have uploaded release candidates for both packages.

Download the archives here: 

https://download.osgeo.org/proj/proj-9.6.0RC1.tar.gz
https://download.osgeo.org/proj/proj-9.6.0RC1.zip

https://download.osgeo.org/proj/proj-data-1.21RC1.tar.gz
https://download.osgeo.org/proj/proj-data-1.21RC1.zip

The PROJ release includes various updates and bug fixes. See the release notes below.

The PROJ-data package adds

* Finish geoid models
* French grid fr_ign_RGM04versRGM23.tif for RGM04 -> RGM23 datum shift (Mayotte)
* Latvian LGIA geoid grid

Please test the release candidates and report any issues you may find with them.
Either here on the mailing list or on GitHub.

/Kristian

???????????????????????????????????

# PROJ Release Notes

## 9.6.0

### Updates

* `projinfo`: display whether an operation is time-dependent (#4255)

* Add CMake options `EMBED_RESOURCE_FILES` and `USE_ONLY_EMBEDDED_RESOURCE_FILES` for `proj.db` and `proj.ini` embedding (#4265, #4274)

* Database: ingest deprecated ESRI names to be able to better import old WKT ESRI (#4282)

* `proj_factors()`: enhance speed when called repeatedly on same compound or projected CRS (#4289)

* Add Airocean projection (formerly Dymaxion) (#4303)

* `createOperations()`: Optimization by avoiding database lookups for CRS (typically PROJ strings) using unknown datums (#4320)

* PROJJSON export: for a Projected CRS, add an explicit type=GeographicCRS/GeodeticCRS members to the base_crs member (#4331)

* `proj_trans_bounds()`: make it work when target CRS is a CompoundCRS (#4333)

* `createOperations()`: do Helmert transformation in 2D when one of source or target CRS is compound (#4337)

* Map EPSG method 'Vertical Offset by Grid Interpolation (asc)' to +proj=vgridshift (#4344)

* Add support for 'Coordinate Frame rotation full matrix (geocen)' and Coordinate Frame rotation full matrix (geog2D)' methods (#4348)

* Add a CMake `EMBED_RESOURCE_DIRECTORY` option to embed .tif/.json files in to libproj (#4349, #4373)

* Take into account new EPSG methods 'Cartesian Grid Offsets by TIN Interpolation (JSON)' and 'Vertical Offset by TIN Interpolation (JSON)' (#4353)

* Added an option `native_ca` to `proj.ini` and an environment variable `PROJ_NATIVE_CA` to be able to configure curl to use the operating system CA store. (#4356)

* Database: add an optional step_direction column to the concatenated_operation_step table (#4357)

* Database: replicate EGM2008 grid transformation record to WGS 84 realizations (#4363)

* Improve ETRFxxx to ETRFyyy, and WGS 84 (xxx) to WGS 84 (yyy) (#4364)

* Build: Update to C++17 version (#4366, #4369)

* Add bash completion script for projinfo (#4371)

* Dispatch content of `4D_api.cpp` into multiple .cpp files (#4393)

* Add `proj_trans_bounds_3D()` (#4394)

* Database: add a engineering_datum and engineering_crs tables; import few related EPSG records (#4396)

* NKG transformations: Add support for EUREF-FIN in Finish transformations (#4399)

* Add Spilhaus projection (#4401)

* Export ESRI:54099 `WGS_1984_Spilhaus_Ocean_Map_in_Square` as PROJ string (#4402)

* Database: update to EPSG v12.004 (#4413)

* `proj_download_file()`: invalidate in-memory caches related to downloaded file (for the current context) (#4414)


### Bug Fixes

* `createObjectsFromName()`: be more tolerant about N/S vs North/South, absence of zone or height (#4318)

* `createFromPROJString`: avoid repeated openings of proj.db and proj.ini and lookup of 'epsg' (#4334)

* Debugging/internals: append sub-grid index to grid name when opening a multi-grid TIFF file (#4381)

* `createOperations()`: use more appropriate operation when using a 'PROJ {grid_name}' geoid model, based on matching the vertical datum (#4379)

* `proj_clone()`: properly propagate `errorIfBestTransformationNotAvailable` and other flags from source object (#4382)

* Inverse +proj=cass: fix non-convergence on inputs where easting=false_easting or northing=false_northing (#4386)

* Fix typo in parameter for ITRF97 in ITRF2014 file (#4408)



From j1 at jimenezshaw.com  Sat Mar  8 10:05:42 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Sat, 8 Mar 2025 19:05:42 +0100
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
Message-ID: <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>

If you mean in a generic way, I think the answer is no.
Each projection has its own peculiarities and behaviours. Spilhaus (by the
way, not yet in PROJ, but coming in 9.6.0) is a good example.

"... latitude (or projected x coordinate) " Do you mean longitude? See that
the longitude you are looking for may depend on the latitude.


On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <proj at lists.osgeo.org>
wrote:

> Hi list,
>
> A question: given an arbitrary projection/CRS, is it possible to determine
> the latitude (or projected x coordinate) at which features would need to be
> "cut" in order to avoid artifacts when those features wrap around the
> projection extremes.
>
> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But if
> it's another projection... say mercator or spilhaus or ... is there any way
> to reliably determine this cutting line?
>
> Nyall
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250308/acd55c58/attachment.htm>

From nyall.dawson at gmail.com  Sat Mar  8 13:03:32 2025
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Sun, 9 Mar 2025 07:03:32 +1000
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
Message-ID: <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>

On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com> wrote:
>
> If you mean in a generic way, I think the answer is no.
> Each projection has its own peculiarities and behaviours. Spilhaus (by the way, not yet in PROJ, but coming in 9.6.0) is a good example.

Testing Spilhaus in QGIS was actually the motivation for this
question. It works fine for rasters, but for vectors there's extreme
artifacts caused by rendering features crossing the boundaries of this
projection.

>
> "... latitude (or projected x coordinate) " Do you mean longitude? See that the longitude you are looking for may depend on the latitude.

? of course! (*although for the above mentioned Spilhaus projection I
guess we'd need something more complex than a single line longitude
line anyway!)

Nyall

>
>
> On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <proj at lists.osgeo.org> wrote:
>>
>> Hi list,
>>
>> A question: given an arbitrary projection/CRS, is it possible to determine the latitude (or projected x coordinate) at which features would need to be "cut" in order to avoid artifacts when those features wrap around the projection extremes.
>>
>> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But if it's another projection... say mercator or spilhaus or ... is there any way to reliably determine this cutting line?
>>
>> Nyall
>>
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj

From j1 at jimenezshaw.com  Sat Mar  8 13:18:00 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Sat, 8 Mar 2025 22:18:00 +0100
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
Message-ID: <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>

Implementing the Spilhaus projection I learned how the images in the
documentation are generated, like the one in
https://proj.org/en/latest/operations/projections/spilhaus.html
if you have a look at docs/plot/plotdefs.json you will see that the
workaround is to not plot very long lines, that are usually crossing from
one border of the projection to another.

On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com> wrote:

> On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com>
> wrote:
> >
> > If you mean in a generic way, I think the answer is no.
> > Each projection has its own peculiarities and behaviours. Spilhaus (by
> the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>
> Testing Spilhaus in QGIS was actually the motivation for this
> question. It works fine for rasters, but for vectors there's extreme
> artifacts caused by rendering features crossing the boundaries of this
> projection.
>
> >
> > "... latitude (or projected x coordinate) " Do you mean longitude? See
> that the longitude you are looking for may depend on the latitude.
>
> ? of course! (*although for the above mentioned Spilhaus projection I
> guess we'd need something more complex than a single line longitude
> line anyway!)
>
> Nyall
>
> >
> >
> > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <proj at lists.osgeo.org>
> wrote:
> >>
> >> Hi list,
> >>
> >> A question: given an arbitrary projection/CRS, is it possible to
> determine the latitude (or projected x coordinate) at which features would
> need to be "cut" in order to avoid artifacts when those features wrap
> around the projection extremes.
> >>
> >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But
> if it's another projection... say mercator or spilhaus or ... is there any
> way to reliably determine this cutting line?
> >>
> >> Nyall
> >>
> >> _______________________________________________
> >> PROJ mailing list
> >> PROJ at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250308/9f20888c/attachment.htm>

From mdsumner at gmail.com  Sat Mar  8 15:13:26 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 9 Mar 2025 10:13:26 +1100
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
Message-ID: <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>

In the past I've had success filtering out bad segments that are "long" (in
native CRS), for example with omerc. I guess we could generate spanning
segments across the grid domain (maybe with a rectangle or triangle grid
from longlat)and analytically find that boundary (endpoint pixels that have
segments that are "too long).

I think this would work for omerc and spilhaus, not sure about generally.
Certainly repointing polygons back together is much harder and probably
needs mesh decomposition.

Will try, very interested in this discussion.

Cheers, Mike

On Sun, Mar 9, 2025, 08:27 Javier Jimenez Shaw via PROJ <
proj at lists.osgeo.org> wrote:

> Implementing the Spilhaus projection I learned how the images in the
> documentation are generated, like the one in
> https://proj.org/en/latest/operations/projections/spilhaus.html
> if you have a look at docs/plot/plotdefs.json you will see that the
> workaround is to not plot very long lines, that are usually crossing from
> one border of the projection to another.
>
> On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com> wrote:
>
>> On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com>
>> wrote:
>> >
>> > If you mean in a generic way, I think the answer is no.
>> > Each projection has its own peculiarities and behaviours. Spilhaus (by
>> the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>>
>> Testing Spilhaus in QGIS was actually the motivation for this
>> question. It works fine for rasters, but for vectors there's extreme
>> artifacts caused by rendering features crossing the boundaries of this
>> projection.
>>
>> >
>> > "... latitude (or projected x coordinate) " Do you mean longitude? See
>> that the longitude you are looking for may depend on the latitude.
>>
>> ? of course! (*although for the above mentioned Spilhaus projection I
>> guess we'd need something more complex than a single line longitude
>> line anyway!)
>>
>> Nyall
>>
>> >
>> >
>> > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <
>> proj at lists.osgeo.org> wrote:
>> >>
>> >> Hi list,
>> >>
>> >> A question: given an arbitrary projection/CRS, is it possible to
>> determine the latitude (or projected x coordinate) at which features would
>> need to be "cut" in order to avoid artifacts when those features wrap
>> around the projection extremes.
>> >>
>> >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But
>> if it's another projection... say mercator or spilhaus or ... is there any
>> way to reliably determine this cutting line?
>> >>
>> >> Nyall
>> >>
>> >> _______________________________________________
>> >> PROJ mailing list
>> >> PROJ at lists.osgeo.org
>> >> https://lists.osgeo.org/mailman/listinfo/proj
>>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250309/250900be/attachment.htm>

From j1 at jimenezshaw.com  Sat Mar  8 15:18:36 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Sun, 9 Mar 2025 00:18:36 +0100
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
Message-ID: <CADRrdKvXDgsjcLYSNaR5HqBqQ4Jar0eeoChAXcd1hBSNTMEUow@mail.gmail.com>

This question moved me to implement an easy idea I had on mind
https://github.com/OSGeo/PROJ/pull/4418

 The result is here:

https://osgeo-proj--4418.org.readthedocs.build/en/4418/operations/projections/all_images.html

(This is not solving your problem. It is just collecting a bunch of images)

On Sun, 9 Mar 2025, 00:13 Michael Sumner, <mdsumner at gmail.com> wrote:

> In the past I've had success filtering out bad segments that are "long"
> (in native CRS), for example with omerc. I guess we could generate spanning
> segments across the grid domain (maybe with a rectangle or triangle grid
> from longlat)and analytically find that boundary (endpoint pixels that have
> segments that are "too long).
>
> I think this would work for omerc and spilhaus, not sure about generally.
> Certainly repointing polygons back together is much harder and probably
> needs mesh decomposition.
>
> Will try, very interested in this discussion.
>
> Cheers, Mike
>
> On Sun, Mar 9, 2025, 08:27 Javier Jimenez Shaw via PROJ <
> proj at lists.osgeo.org> wrote:
>
>> Implementing the Spilhaus projection I learned how the images in the
>> documentation are generated, like the one in
>> https://proj.org/en/latest/operations/projections/spilhaus.html
>> if you have a look at docs/plot/plotdefs.json you will see that the
>> workaround is to not plot very long lines, that are usually crossing from
>> one border of the projection to another.
>>
>> On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com> wrote:
>>
>>> On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com>
>>> wrote:
>>> >
>>> > If you mean in a generic way, I think the answer is no.
>>> > Each projection has its own peculiarities and behaviours. Spilhaus (by
>>> the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>>>
>>> Testing Spilhaus in QGIS was actually the motivation for this
>>> question. It works fine for rasters, but for vectors there's extreme
>>> artifacts caused by rendering features crossing the boundaries of this
>>> projection.
>>>
>>> >
>>> > "... latitude (or projected x coordinate) " Do you mean longitude? See
>>> that the longitude you are looking for may depend on the latitude.
>>>
>>> ? of course! (*although for the above mentioned Spilhaus projection I
>>> guess we'd need something more complex than a single line longitude
>>> line anyway!)
>>>
>>> Nyall
>>>
>>> >
>>> >
>>> > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <
>>> proj at lists.osgeo.org> wrote:
>>> >>
>>> >> Hi list,
>>> >>
>>> >> A question: given an arbitrary projection/CRS, is it possible to
>>> determine the latitude (or projected x coordinate) at which features would
>>> need to be "cut" in order to avoid artifacts when those features wrap
>>> around the projection extremes.
>>> >>
>>> >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But
>>> if it's another projection... say mercator or spilhaus or ... is there any
>>> way to reliably determine this cutting line?
>>> >>
>>> >> Nyall
>>> >>
>>> >> _______________________________________________
>>> >> PROJ mailing list
>>> >> PROJ at lists.osgeo.org
>>> >> https://lists.osgeo.org/mailman/listinfo/proj
>>>
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250309/2b59a1bf/attachment-0001.htm>

From david.osullivan at auckland.ac.nz  Sat Mar  8 16:57:57 2025
From: david.osullivan at auckland.ac.nz (David O'Sullivan)
Date: Sun, 9 Mar 2025 13:57:57 +1300
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
Message-ID: <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>

This is something a colleague (Luke Bergmann) and I have explored intermittently 
at various times. Here's a picture of a 'projected coordinate surface' for the x 
coordinate of the Briesemeister projection (an oblique Hammer), plotted against 
longitude and latitude.

https://southosullivan.com/misc/briesemeister-cut.png

You can clearly see the 'cut' as a discontinuity in the values of the x 
coordinate of the projection.

Of course this is only a small aspect of any complete solution and as Mike 
points out it's all very well handling points, dealing with polygons is a lot 
harder. There are likely projections with cut lines that don't show up quite so 
obviously as discontinuities, and this kind of stuff is never far from floating 
point and NaN errors.

We've had some qualified success generating tinshift JSONs to 'simulate' known 
projections, by excluding triangles that overlap any part of the cut in a 
projection and only projecting points that are inside 'valid' triangles as part 
of an ongoing attempt to allow for arbitrary numerical projections in platforms 
that use PROJ. Kind of messy though and support for tinshift seems a bit uneven 
even in tools that incorporate PROJ.

Best

David

--

David O'Sullivan

Geospatial Stuff dosull.github.io
Hon Prof University of Auckland




On 09/03/2025 12:13, Michael Sumner via PROJ wrote:
>
> 	
> You don't often get email from proj at lists.osgeo.org. Learn why this is 
> important <https://aka.ms/LearnAboutSenderIdentification>
> 	
>
> In the past I've had success filtering out bad segments that are "long" (in 
> native CRS), for example with omerc. I guess we could generate spanning 
> segments across the grid domain (maybe with a rectangle or triangle grid from 
> longlat)and analytically find that boundary (endpoint pixels that have 
> segments that are "too long).
>
> I think this would work for omerc and spilhaus, not sure about generally. 
> Certainly repointing polygons back together is much harder and probably needs 
> mesh decomposition.
>
> Will try, very interested in this discussion.
>
> Cheers, Mike
>
>
> On Sun, Mar 9, 2025, 08:27 Javier Jimenez Shaw via PROJ <proj at lists.osgeo.org> 
> wrote:
>
>     Implementing the Spilhaus projection I learned how the images in the
>     documentation are generated, like the one in
>     https://proj.org/en/latest/operations/projections/spilhaus.html
>     if you have a look at docs/plot/plotdefs.json you will see that the
>     workaround is to not plot very long lines, that are usually crossing from
>     one border of the projection to another.
>
>     On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com> wrote:
>
>         On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com>
>         wrote:
>         >
>         > If you mean in a generic way, I think the answer is no.
>         > Each projection has its own peculiarities and behaviours. Spilhaus
>         (by the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>
>         Testing Spilhaus in QGIS was actually the motivation for this
>         question. It works fine for rasters, but for vectors there's extreme
>         artifacts caused by rendering features crossing the boundaries of this
>         projection.
>
>         >
>         > "... latitude (or projected x coordinate) " Do you mean longitude?
>         See that the longitude you are looking for may depend on the latitude.
>
>         ? of course! (*although for the above mentioned Spilhaus projection I
>         guess we'd need something more complex than a single line longitude
>         line anyway!)
>
>         Nyall
>
>         >
>         >
>         > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ
>         <proj at lists.osgeo.org> wrote:
>         >>
>         >> Hi list,
>         >>
>         >> A question: given an arbitrary projection/CRS, is it possible to
>         determine the latitude (or projected x coordinate) at which features
>         would need to be "cut" in order to avoid artifacts when those features
>         wrap around the projection extremes.
>         >>
>         >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180.
>         But if it's another projection... say mercator or spilhaus or ... is
>         there any way to reliably determine this cutting line?
>         >>
>         >> Nyall
>         >>
>         >> _______________________________________________
>         >> PROJ mailing list
>         >> PROJ at lists.osgeo.org
>         >> https://lists.osgeo.org/mailman/listinfo/proj
>
>     _______________________________________________
>     PROJ mailing list
>     PROJ at lists.osgeo.org
>     https://lists.osgeo.org/mailman/listinfo/proj
>
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250309/64e40c60/attachment-0001.htm>

From kristianevers at gmail.com  Sun Mar  9 00:55:48 2025
From: kristianevers at gmail.com (Kristian Evers)
Date: Sun, 9 Mar 2025 09:55:48 +0100
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
 <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>
Message-ID: <0207A79C-C7AC-4DBA-8DDF-4E156AFD8E85@gmail.com>

In general I think this is just a tough problem to solve. I laid the foundation for the projection images in the PROJ docs and learned along the way that it?s complicated to do generically. During my initial work I did some research to see if there was a good solution I could borrow. The most promising idea I found was the concept of ?adaptive resampling? as presented by Mike Bostock at https://observablehq.com/@d3/adaptive-sampling. The basic idea is to densify the vertices in areas with high distortion and possibly removing ones in areas with low distortion. For visualisation purposes I think this is neat solution but it may not be desirable in a GIS where you want the user to have full control over the vertices in a geometry.

/Kristian

> On 9 Mar 2025, at 01.57, David O'Sullivan via PROJ <proj at lists.osgeo.org> wrote:
> 
> This is something a colleague (Luke Bergmann) and I have explored intermittently at various times. Here's a picture of a 'projected coordinate surface' for the x coordinate of the Briesemeister projection (an oblique Hammer), plotted against longitude and latitude.
> 
> https://southosullivan.com/misc/briesemeister-cut.png
> 
> You can clearly see the 'cut' as a discontinuity in the values of the x coordinate of the projection.
> 
> Of course this is only a small aspect of any complete solution and as Mike points out it's all very well handling points, dealing with polygons is a lot harder. There are likely projections with cut lines that don't show up quite so obviously as discontinuities, and this kind of stuff is never far from floating point and NaN errors.
> 
> We've had some qualified success generating tinshift JSONs to 'simulate' known projections, by excluding triangles that overlap any part of the cut in a projection and only projecting points that are inside 'valid' triangles as part of an ongoing attempt to allow for arbitrary numerical projections in platforms that use PROJ. Kind of messy though and support for tinshift seems a bit uneven even in tools that incorporate PROJ.
> 
> Best
> 
> David
> 
> --
> 
> David O'Sullivan
> 
> Geospatial Stuff dosull.github.io
> Hon Prof University of Auckland
> 
> 
> 
> 
> 
> 
> 
> On 09/03/2025 12:13, Michael Sumner via PROJ wrote:
>> 
>> 
>> You don't often get email from proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>. Learn why this is important <https://aka.ms/LearnAboutSenderIdentification>	
>> In the past I've had success filtering out bad segments that are "long" (in native CRS), for example with omerc. I guess we could generate spanning segments across the grid domain (maybe with a rectangle or triangle grid from longlat)and analytically find that boundary (endpoint pixels that have segments that are "too long).
>> 
>> I think this would work for omerc and spilhaus, not sure about generally. Certainly repointing polygons back together is much harder and probably needs mesh decomposition.
>> 
>> Will try, very interested in this discussion.
>> 
>> Cheers, Mike
>> 
>> 
>> On Sun, Mar 9, 2025, 08:27 Javier Jimenez Shaw via PROJ <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>> wrote:
>>> Implementing the Spilhaus projection I learned how the images in the documentation are generated, like the one in https://proj.org/en/latest/operations/projections/spilhaus.html
>>> if you have a look at docs/plot/plotdefs.json you will see that the workaround is to not plot very long lines, that are usually crossing from one border of the projection to another.
>>> 
>>> On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com <mailto:nyall.dawson at gmail.com>> wrote:
>>>> On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com <mailto:j1 at jimenezshaw.com>> wrote:
>>>> >
>>>> > If you mean in a generic way, I think the answer is no.
>>>> > Each projection has its own peculiarities and behaviours. Spilhaus (by the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>>>> 
>>>> Testing Spilhaus in QGIS was actually the motivation for this
>>>> question. It works fine for rasters, but for vectors there's extreme
>>>> artifacts caused by rendering features crossing the boundaries of this
>>>> projection.
>>>> 
>>>> >
>>>> > "... latitude (or projected x coordinate) " Do you mean longitude? See that the longitude you are looking for may depend on the latitude.
>>>> 
>>>> ? of course! (*although for the above mentioned Spilhaus projection I
>>>> guess we'd need something more complex than a single line longitude
>>>> line anyway!)
>>>> 
>>>> Nyall
>>>> 
>>>> >
>>>> >
>>>> > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <proj at lists.osgeo.org <mailto:proj at lists.osgeo.org>> wrote:
>>>> >>
>>>> >> Hi list,
>>>> >>
>>>> >> A question: given an arbitrary projection/CRS, is it possible to determine the latitude (or projected x coordinate) at which features would need to be "cut" in order to avoid artifacts when those features wrap around the projection extremes.
>>>> >>
>>>> >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But if it's another projection... say mercator or spilhaus or ... is there any way to reliably determine this cutting line?
>>>> >>
>>>> >> Nyall
>>>> >>
>>>> >> _______________________________________________
>>>> >> PROJ mailing list
>>>> >> PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>>>> >> https://lists.osgeo.org/mailman/listinfo/proj
>>> _______________________________________________
>>> PROJ mailing list
>>> PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>>> https://lists.osgeo.org/mailman/listinfo/proj
>> 
>> 
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org <mailto:PROJ at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/proj
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250309/7225ec66/attachment-0001.htm>

From willtemperley at gmail.com  Mon Mar 10 02:33:08 2025
From: willtemperley at gmail.com (William Temperley)
Date: Mon, 10 Mar 2025 17:33:08 +0800
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <0207A79C-C7AC-4DBA-8DDF-4E156AFD8E85@gmail.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
 <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>
 <0207A79C-C7AC-4DBA-8DDF-4E156AFD8E85@gmail.com>
Message-ID: <CAMegOAQzQv1N-N+8yQwHOYQPneGMH9v+f7uRNPuXBZtEd93cvw@mail.gmail.com>

I'm very interested in this question as I'm in need of end-of-the-world
lines for cartographic purposes.

I suppose there is no single solution for all projections, but the
solutions can probably be categorised into those that:

1. Are mathematically derivable, e.g. azimuthal projections covering a
hemisphere or global projections like Mollweide.
2. Require editorial decisions such as cut-off at +/- 85 degrees, e.g.
Mercator
3. Interrupted projections for which the cutlines would need to be
retrieved from a datasource, or user-defined.
4. Those with known limited extents, e.g Ordnance Survey National Grid.

Couldn't the cutlines be reasonably easily generated in geographic
coordinates from either user-supplied or default projection
parameters, using one of the above methods?
An example for a derivable extent would be an orthographic projection where
the cutline is just 90 degrees in spherical distance from the centre point.

Best,

Will

On Sun, 9 Mar 2025 at 17:07, Kristian Evers via PROJ <proj at lists.osgeo.org>
wrote:

> In general I think this is just a tough problem to solve. I laid the
> foundation for the projection images in the PROJ docs and learned along the
> way that it?s complicated to do generically. During my initial work I did
> some research to see if there was a good solution I could borrow. The most
> promising idea I found was the concept of ?adaptive resampling? as
> presented by Mike Bostock at
> https://observablehq.com/@d3/adaptive-sampling. The basic idea is to
> densify the vertices in areas with high distortion and possibly removing
> ones in areas with low distortion. For visualisation purposes I think this
> is neat solution but it may not be desirable in a GIS where you want the
> user to have full control over the vertices in a geometry.
>
> /Kristian
>
> On 9 Mar 2025, at 01.57, David O'Sullivan via PROJ <proj at lists.osgeo.org>
> wrote:
>
> This is something a colleague (Luke Bergmann) and I have explored
> intermittently at various times. Here's a picture of a 'projected
> coordinate surface' for the x coordinate of the Briesemeister projection
> (an oblique Hammer), plotted against longitude and latitude.
>
> https://southosullivan.com/misc/briesemeister-cut.png
>
> You can clearly see the 'cut' as a discontinuity in the values of the x
> coordinate of the projection.
>
> Of course this is only a small aspect of any complete solution and as Mike
> points out it's all very well handling points, dealing with polygons is a
> lot harder. There are likely projections with cut lines that don't show up
> quite so obviously as discontinuities, and this kind of stuff is never far
> from floating point and NaN errors.
>
> We've had some qualified success generating tinshift JSONs to 'simulate'
> known projections, by excluding triangles that overlap any part of the cut
> in a projection and only projecting points that are inside 'valid'
> triangles as part of an ongoing attempt to allow for arbitrary numerical
> projections in platforms that use PROJ. Kind of messy though and support
> for tinshift seems a bit uneven even in tools that incorporate PROJ.
>
> Best
>
> David
>
> --
>
> David O'Sullivan
>
> Geospatial Stuff dosull.github.io
> Hon Prof University of Auckland
>
>
>
>
> On 09/03/2025 12:13, Michael Sumner via PROJ wrote:
>
>
> You don't often get email from proj at lists.osgeo.org. Learn why this is
> important <https://aka.ms/LearnAboutSenderIdentification>
>
> In the past I've had success filtering out bad segments that are "long"
> (in native CRS), for example with omerc. I guess we could generate spanning
> segments across the grid domain (maybe with a rectangle or triangle grid
> from longlat)and analytically find that boundary (endpoint pixels that have
> segments that are "too long).
>
> I think this would work for omerc and spilhaus, not sure about generally.
> Certainly repointing polygons back together is much harder and probably
> needs mesh decomposition.
>
> Will try, very interested in this discussion.
>
> Cheers, Mike
>
> On Sun, Mar 9, 2025, 08:27 Javier Jimenez Shaw via PROJ <
> proj at lists.osgeo.org> wrote:
>
>> Implementing the Spilhaus projection I learned how the images in the
>> documentation are generated, like the one in
>> https://proj.org/en/latest/operations/projections/spilhaus.html
>> if you have a look at docs/plot/plotdefs.json you will see that the
>> workaround is to not plot very long lines, that are usually crossing from
>> one border of the projection to another.
>>
>> On Sat, 8 Mar 2025 at 22:03, Nyall Dawson <nyall.dawson at gmail.com> wrote:
>>
>>> On Sun, 9 Mar 2025 at 04:06, Javier Jimenez Shaw <j1 at jimenezshaw.com>
>>> wrote:
>>> >
>>> > If you mean in a generic way, I think the answer is no.
>>> > Each projection has its own peculiarities and behaviours. Spilhaus (by
>>> the way, not yet in PROJ, but coming in 9.6.0) is a good example.
>>>
>>> Testing Spilhaus in QGIS was actually the motivation for this
>>> question. It works fine for rasters, but for vectors there's extreme
>>> artifacts caused by rendering features crossing the boundaries of this
>>> projection.
>>>
>>> >
>>> > "... latitude (or projected x coordinate) " Do you mean longitude? See
>>> that the longitude you are looking for may depend on the latitude.
>>>
>>> ? of course! (*although for the above mentioned Spilhaus projection I
>>> guess we'd need something more complex than a single line longitude
>>> line anyway!)
>>>
>>> Nyall
>>>
>>> >
>>> >
>>> > On Sat, 8 Mar 2025 at 07:30, Nyall Dawson via PROJ <
>>> proj at lists.osgeo.org> wrote:
>>> >>
>>> >> Hi list,
>>> >>
>>> >> A question: given an arbitrary projection/CRS, is it possible to
>>> determine the latitude (or projected x coordinate) at which features would
>>> need to be "cut" in order to avoid artifacts when those features wrap
>>> around the projection extremes.
>>> >>
>>> >> Eg if it was EPSG:4326, we'd need to cut the features at +/- 180. But
>>> if it's another projection... say mercator or spilhaus or ... is there any
>>> way to reliably determine this cutting line?
>>> >>
>>> >> Nyall
>>> >>
>>> >> _______________________________________________
>>> >> PROJ mailing list
>>> >> PROJ at lists.osgeo.org
>>> >> https://lists.osgeo.org/mailman/listinfo/proj
>>>
>> _______________________________________________
>> PROJ mailing list
>> PROJ at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/proj
>>
>
> _______________________________________________
> PROJ mailing listPROJ at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/proj
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250310/de32fdab/attachment.htm>

From gdt at lexort.com  Mon Mar 10 05:32:02 2025
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 10 Mar 2025 08:32:02 -0400
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <CAMegOAQzQv1N-N+8yQwHOYQPneGMH9v+f7uRNPuXBZtEd93cvw@mail.gmail.com>
 (William Temperley via PROJ's message of "Mon, 10 Mar 2025 17:33:08
 +0800")
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
 <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>
 <0207A79C-C7AC-4DBA-8DDF-4E156AFD8E85@gmail.com>
 <CAMegOAQzQv1N-N+8yQwHOYQPneGMH9v+f7uRNPuXBZtEd93cvw@mail.gmail.com>
Message-ID: <rmizfht5anx.fsf@s1.lexort.com>

William Temperley via PROJ <proj at lists.osgeo.org> writes:

> Couldn't the cutlines be reasonably easily generated in geographic
> coordinates from either user-supplied or default projection
> parameters, using one of the above methods?
> An example for a derivable extent would be an orthographic projection where
> the cutline is just 90 degrees in spherical distance from the centre point.

A further question might be how the cutlines relate to the 'area of use'
in the EPSG database, but I'm afraid the answer is that the area of use
is a geodetic bounding box.  It does seem that a projection database
ideally would have this information.

But, as you point out with Mercator, that leads to Mercator-80 and
Mercator-85 entries, and that doesn't seem good.

Not sure this ended up being helpful, but wanted to mention the possible
relationship.


From willtemperley at gmail.com  Tue Mar 11 06:02:52 2025
From: willtemperley at gmail.com (William Temperley)
Date: Tue, 11 Mar 2025 21:02:52 +0800
Subject: [PROJ] Determine "cut line" for arbitrary projection
In-Reply-To: <rmizfht5anx.fsf@s1.lexort.com>
References: <CAB28Asig=WaF6bBhB3pHBWBVo7RgdWqw-=m4n_A1+6+d5YSL9A@mail.gmail.com>
 <CADRrdKv3nGAbwzLtgbHaL7ttstzARk2Jdpd5OVtFJ3h-Upu=+g@mail.gmail.com>
 <CAB28AsiKq7o85nXgtzf_b9SDKXx8vY_0Z7xyALkh6zWm=BqBBg@mail.gmail.com>
 <CADRrdKvbgZwnwJ-BPKmtjGB7Wpko6+mRX4FLxmVWt_fnUJbcUg@mail.gmail.com>
 <CAAcGz9_xC=5qrA-uyx=dp=L+s-NC5teGxTE948xw5HnTG0XX=Q@mail.gmail.com>
 <19e38aa4-6bae-4faa-a455-564aa1ae6508@auckland.ac.nz>
 <0207A79C-C7AC-4DBA-8DDF-4E156AFD8E85@gmail.com>
 <CAMegOAQzQv1N-N+8yQwHOYQPneGMH9v+f7uRNPuXBZtEd93cvw@mail.gmail.com>
 <rmizfht5anx.fsf@s1.lexort.com>
Message-ID: <CAMegOASHsuq0ugJJ-W40SWiMA-v2-2Dt=aCEkeR0tVONvd=4Og@mail.gmail.com>

Yes, that was helpful, thanks. It has been reasonably easy to use
 "proj_get_area_of_use" in the C++ API
This is probably all that's needed for projected coordinate reference
systems like EPSG:27700 where parameters are fixed (AFAIK).

In the end, I think the rest is probably a user or application-space
problem.
Mercator can probably be dealt with by just throwing away any
coordinates outside of what "proj_get_area_of_use" returns.

Seems the zones are hard-coded in the interrupted projections.
For cartographic purposes it'll probably be sufficient to build a clip mask
from the projected nodes defined the source.
e.g. imoll.cpp:

/*

  Zones:


    -180            -40                       180

      +--------------+-------------------------+

      |1             |2                        |

      |              |                         |

      |              |                         |

      |              |                         |

      |              |                         |

    0 +-------+------+-+-----------+-----------+

      |3      |4       |5          |6          |

      |       |        |           |           |

      |       |        |           |           |

      |       |        |           |           |

      |       |        |           |           |

      +-------+--------+-----------+-----------+

    -180    -100      -20         80          180

*/


On Mon, 10 Mar 2025 at 20:47, Greg Troxel via PROJ <proj at lists.osgeo.org>
wrote:

> William Temperley via PROJ <proj at lists.osgeo.org> writes:
>
> > Couldn't the cutlines be reasonably easily generated in geographic
> > coordinates from either user-supplied or default projection
> > parameters, using one of the above methods?
> > An example for a derivable extent would be an orthographic projection
> where
> > the cutline is just 90 degrees in spherical distance from the centre
> point.
>
> A further question might be how the cutlines relate to the 'area of use'
> in the EPSG database, but I'm afraid the answer is that the area of use
> is a geodetic bounding box.  It does seem that a projection database
> ideally would have this information.
>
> But, as you point out with Mercator, that leads to Mercator-80 and
> Mercator-85 entries, and that doesn't seem good.
>
> Not sure this ended up being helpful, but wanted to mention the possible
> relationship.
>
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250311/9c3910c4/attachment.htm>

From kristianevers at gmail.com  Tue Mar 11 07:28:37 2025
From: kristianevers at gmail.com (Kristian Evers)
Date: Tue, 11 Mar 2025 15:28:37 +0100
Subject: [PROJ] PROJ 9.6.0RC2
Message-ID: <88D0F6E6-5C62-43F0-ABBD-1A1E993046AC@gmail.com>

A few issues were found in 9.6.0RC1. They have been corrected and a new release candidate is ready.
Get it here:

https://download.osgeo.org/proj/proj-9.6.0RC2.tar.gz
https://download.osgeo.org/proj/proj-9.6.0RC2.zip

Hopefully there are no problems with the release candidate but in case there are, please report them
here or as issues on GitHub.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250311/49baec88/attachment.htm>

From j1 at jimenezshaw.com  Wed Mar 12 06:11:53 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 12 Mar 2025 14:11:53 +0100
Subject: [PROJ] Geoid model in projected CRS
Message-ID: <CADRrdKvDEo_c9qA7mzam58G3CQmv7SRfb3tnk9RjkLf1sTytkA@mail.gmail.com>

Hi

Is there already a way to define a geoid model interpolated in projected
coordinates?
(some "small" countries, with just one projection, define their geoid
models in that projected CRS. Recreating the grid in a geographic one adds
some error)

I see that
https://proj.org/en/stable/operations/transformations/gridshift.html was
added in 9.2.0, but I only see these options:
HORIZONTAL_OFFSET,
GEOGRAPHIC_3D_OFFSET,
ELLIPSOIDAL_HEIGHT_OFFSET,
VERTICAL_OFFSET_GEOGRAPHIC_TO_VERTICAL,
VERTICAL_OFFSET_VERTICAL_TO_VERTICAL.

I am not sure if any of those apply as
"VERTICAL_OFFSET_PROJECTED_TO_VERTICAL".
In case it is possible, how would be the insertion of the transformation in
proj.db? (something like
https://github.com/OSGeo/PROJ/blob/master/data/sql/grid_transformation_custom.sql#L71
)

Thanks.
Javier.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250312/1b09b4c4/attachment.htm>

From even.rouault at spatialys.com  Wed Mar 12 06:36:39 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 14:36:39 +0100
Subject: [PROJ] Geoid model in projected CRS
In-Reply-To: <CADRrdKvDEo_c9qA7mzam58G3CQmv7SRfb3tnk9RjkLf1sTytkA@mail.gmail.com>
References: <CADRrdKvDEo_c9qA7mzam58G3CQmv7SRfb3tnk9RjkLf1sTytkA@mail.gmail.com>
Message-ID: <aec40219-e6a5-46b4-a410-4e407979d8a5@spatialys.com>

Javier,


> Is there already a way to define a geoid model interpolated in 
> projected coordinates?
> (some "small" countries, with just one projection, define their geoid 
> models in that projected CRS. Recreating the grid in a geographic one 
> adds some error)
>
> I see that 
> https://proj.org/en/stable/operations/transformations/gridshift.html 
> was added in 9.2.0, but I only see these options:
> HORIZONTAL_OFFSET,
> GEOGRAPHIC_3D_OFFSET,
> ELLIPSOIDAL_HEIGHT_OFFSET,
> VERTICAL_OFFSET_GEOGRAPHIC_TO_VERTICAL, 
> VERTICAL_OFFSET_VERTICAL_TO_VERTICAL.
>
> I am not sure if any of those apply as 
> "VERTICAL_OFFSET_PROJECTED_TO_VERTICAL".

This is a bit untested area. VERTICAL_OFFSET_GEOGRAPHIC_TO_VERTICAL 
should be the one to use I believe.

> In case it is possible, how would be the insertion of the 
> transformation in proj.db? (something like 
> https://github.com/OSGeo/PROJ/blob/master/data/sql/grid_transformation_custom.sql#L71)

You likely need to use a PROJString with +proj=gridshift +grids=...

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250312/d906a699/attachment.htm>

From Roger.Bivand at nhh.no  Wed Mar 12 07:53:49 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 14:53:49 +0000
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
Message-ID: <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>

With RC2 and GDAL 3.10.2, when running ctest in the GDAL build directory, I'm seeing (updated Fedora 41):

The following tests FAILED:
         35 - test-osr-set-proj-search-paths (Failed)
         40 - autotest_gdrivers (Failed)
         43 - autotest_osr (Failed)
Errors while running CTest

RC1 had these problems too, but I waited to try ctest from GDAL 3.10.2 on my desktop todat rather than my laptop when RC1 was posted as more tests are active on the desktop. Should this cause concern? The failures include:

[ RUN      ] test_osr_set_proj_search_paths.test
/home/rsb/topics/gdal/gdal-3.10.2/autotest/cpp/test_osr_set_proj_search_paths.cpp:35: Failure
Expected: (ret) != (0), actual: 0 vs 0

    def test_jp2metadata_1():

        ds = gdal.Open("data/jpeg2000/erdas_foo.jp2")
        wkt = ds.GetProjectionRef()
        gt = ds.GetGeoTransform()
>       assert wkt.startswith('PROJCS["ETRS89')
E       assert False
E        +  where False = <built-in method startswith of str object at 0x55cf18512d90>('PROJCS["ETRS89')
E        +    where <built-in method startswith of str object at 0x55cf18512d90> = 'PROJCS["EUREF-FIN / TM35FIN(E,N)",GEOGCS["EUREF-FIN",DATUM["EUREF-FIN",SPHEROID["GRS 1980",6378137,298.257222101,AUTH...ing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","3067"]]'.startswith

/home/rsb/topics/gdal/gdal-3.10.2/build/autotest/gdrivers/jp2metadata.py:44: AssertionError
FAILED gdrivers/jp2metadata.py::test_jp2metadata_1 - assert False

/home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1773: AssertionError
/home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1806: AssertionError
/home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:2027: AssertionError
FAILED osr/osr_basic.py::test_SetPROJSearchPath - assert True == False
FAILED osr/osr_basic.py::test_Set_PROJ_DATA_config_option - assert True == False
FAILED osr/osr_basic.py::test_Set_PROJ_DATA_config_option_sub_proccess_config_option_ko
FAILED osr/osr_basic.py::test_osr_basic_is_dynamic - AssertionError: assert n...

Please indicate whether the full output of ctest --rerun-failed --output-on-failure would be useful.

Roger

--
Roger Bivand
Emeritus Professor
Norwegian School of Economics
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
Roger.Bivand at nhh.no

From even.rouault at spatialys.com  Wed Mar 12 08:15:24 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 16:15:24 +0100
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
Message-ID: <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>

Roger,

I could reproduce the jp2metadata.py:44 and osr_basic.py:2027 errors, 
and I've fixed them with 
https://github.com/OSGeo/gdal/commit/49ef64108b6875e5b90a4fb6cadd089e84fe53c1

I don't know why you get the other errors. They all seem to be related 
to setting PROJ data. Isn't there some ghost PROJ_LIB variable set in 
your environment ?

Even

Le 12/03/2025 ? 15:53, Roger Bivand via PROJ a ?crit?:
> With RC2 and GDAL 3.10.2, when running ctest in the GDAL build directory, I'm seeing (updated Fedora 41):
>
> The following tests FAILED:
>           35 - test-osr-set-proj-search-paths (Failed)
>           40 - autotest_gdrivers (Failed)
>           43 - autotest_osr (Failed)
> Errors while running CTest
>
> RC1 had these problems too, but I waited to try ctest from GDAL 3.10.2 on my desktop todat rather than my laptop when RC1 was posted as more tests are active on the desktop. Should this cause concern? The failures include:
>
> [ RUN      ] test_osr_set_proj_search_paths.test
> /home/rsb/topics/gdal/gdal-3.10.2/autotest/cpp/test_osr_set_proj_search_paths.cpp:35: Failure
> Expected: (ret) != (0), actual: 0 vs 0
>
>      def test_jp2metadata_1():
>
>          ds = gdal.Open("data/jpeg2000/erdas_foo.jp2")
>          wkt = ds.GetProjectionRef()
>          gt = ds.GetGeoTransform()
>>        assert wkt.startswith('PROJCS["ETRS89')
> E       assert False
> E        +  where False = <built-in method startswith of str object at 0x55cf18512d90>('PROJCS["ETRS89')
> E        +    where <built-in method startswith of str object at 0x55cf18512d90> = 'PROJCS["EUREF-FIN / TM35FIN(E,N)",GEOGCS["EUREF-FIN",DATUM["EUREF-FIN",SPHEROID["GRS 1980",6378137,298.257222101,AUTH...ing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","3067"]]'.startswith
>
> /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/gdrivers/jp2metadata.py:44: AssertionError
> FAILED gdrivers/jp2metadata.py::test_jp2metadata_1 - assert False
>
> /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1773: AssertionError
> /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1806: AssertionError
> /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:2027: AssertionError
> FAILED osr/osr_basic.py::test_SetPROJSearchPath - assert True == False
> FAILED osr/osr_basic.py::test_Set_PROJ_DATA_config_option - assert True == False
> FAILED osr/osr_basic.py::test_Set_PROJ_DATA_config_option_sub_proccess_config_option_ko
> FAILED osr/osr_basic.py::test_osr_basic_is_dynamic - AssertionError: assert n...
>
> Please indicate whether the full output of ctest --rerun-failed --output-on-failure would be useful.
>
> Roger
>
> --
> Roger Bivand
> Emeritus Professor
> Norwegian School of Economics
> Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
> Roger.Bivand at nhh.no
> _______________________________________________
> PROJ mailing list
> PROJ at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/proj

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Roger.Bivand at nhh.no  Wed Mar 12 09:56:35 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 17:56:35 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
Message-ID: <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>

Even,

On Wed, 12 Mar 2025, Even Rouault wrote:

> Roger,
>
> I could reproduce the jp2metadata.py:44 and osr_basic.py:2027 errors, and 
> I've fixed them with 
> https://github.com/OSGeo/gdal/commit/49ef64108b6875e5b90a4fb6cadd089e84fe53c1
>
> I don't know why you get the other errors. They all seem to be related to 
> setting PROJ data. Isn't there some ghost PROJ_LIB variable set in your 
> environment ?
>

None that echo $PROJ_LIB or echo $PROJ_DATA show, or
unset PROJ_LIB ; ctest for example. Should I add the complete output of 
running ctest to this thread (490 lines)?

Roger

> Even
>
> Le 12/03/2025 ? 15:53, Roger Bivand via PROJ a ?crit?:
>>  With RC2 and GDAL 3.10.2, when running ctest in the GDAL build directory,
>>  I'm seeing (updated Fedora 41):
>>
>>  The following tests FAILED:
>>            35 - test-osr-set-proj-search-paths (Failed)
>>            40 - autotest_gdrivers (Failed)
>>            43 - autotest_osr (Failed)
>>  Errors while running CTest
>>
>>  RC1 had these problems too, but I waited to try ctest from GDAL 3.10.2 on
>>  my desktop todat rather than my laptop when RC1 was posted as more tests
>>  are active on the desktop. Should this cause concern? The failures
>>  include:
>>
>>  [ RUN      ] test_osr_set_proj_search_paths.test
>>  /home/rsb/topics/gdal/gdal-3.10.2/autotest/cpp/test_osr_set_proj_search_paths.cpp:35:
>>  Failure
>>  Expected: (ret) != (0), actual: 0 vs 0
>>
>>       def test_jp2metadata_1():
>>
>>           ds = gdal.Open("data/jpeg2000/erdas_foo.jp2")
>>           wkt = ds.GetProjectionRef()
>>           gt = ds.GetGeoTransform()
>>>         assert wkt.startswith('PROJCS["ETRS89')
>>  E       assert False
>>  E        +  where False = <built-in method startswith of str object at
>>  0x55cf18512d90>('PROJCS["ETRS89')
>>  E        +    where <built-in method startswith of str object at
>>  0x55cf18512d90> = 'PROJCS["EUREF-FIN /
>>  TM35FIN(E,N)",GEOGCS["EUREF-FIN",DATUM["EUREF-FIN",SPHEROID["GRS
>>  1980",6378137,298.257222101,AUTH...ing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","3067"]]'.startswith
>>
>>  /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/gdrivers/jp2metadata.py:44:
>>  AssertionError
>>  FAILED gdrivers/jp2metadata.py::test_jp2metadata_1 - assert False
>>
>>  /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1773:
>>  AssertionError
>>  /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:1806:
>>  AssertionError
>>  /home/rsb/topics/gdal/gdal-3.10.2/build/autotest/osr/osr_basic.py:2027:
>>  AssertionError
>>  FAILED osr/osr_basic.py::test_SetPROJSearchPath - assert True == False
>>  FAILED osr/osr_basic.py::test_Set_PROJ_DATA_config_option - assert True ==
>>  False
>>  FAILED
>>  osr/osr_basic.py::test_Set_PROJ_DATA_config_option_sub_proccess_config_option_ko
>>  FAILED osr/osr_basic.py::test_osr_basic_is_dynamic - AssertionError:
>>  assert n...
>>
>>  Please indicate whether the full output of ctest --rerun-failed
>>  --output-on-failure would be useful.
>>
>>  Roger
>>
>>  --
>>  Roger Bivand
>>  Emeritus Professor
>>  Norwegian School of Economics
>>  Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway
>>  Roger.Bivand at nhh.no
>>  _______________________________________________
>>  PROJ mailing list
>>  PROJ at lists.osgeo.org
>>  https://lists.osgeo.org/mailman/listinfo/proj
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From even.rouault at spatialys.com  Wed Mar 12 10:01:09 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 18:01:09 +0100
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
Message-ID: <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>


> unset PROJ_LIB ; ctest for example. Should I add the complete output 
> of running ctest to this thread (490 lines)?

maybe paste it some paste service (github gist, etc) and link it to it.


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Roger.Bivand at nhh.no  Wed Mar 12 10:07:07 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 18:07:07 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
Message-ID: <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>

On Wed, 12 Mar 2025, Even Rouault wrote:

>
>>  unset PROJ_LIB ; ctest for example. Should I add the complete output of
>>  running ctest to this thread (490 lines)?
>
> maybe paste it some paste service (github gist, etc) and link it to it.
>

https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168

>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no


From even.rouault at spatialys.com  Wed Mar 12 10:15:59 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 18:15:59 +0100
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
Message-ID: <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>


Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
> On Wed, 12 Mar 2025, Even Rouault wrote:
>
>>
>>> ?unset PROJ_LIB ; ctest for example. Should I add the complete 
>>> output of
>>> ?running ctest to this thread (490 lines)?
>>
>> maybe paste it some paste service (github gist, etc) and link it to it.
>>
>
> https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
sorry, no clue. I doubt this is 9.6.0 related
>
>>
>>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Roger.Bivand at nhh.no  Wed Mar 12 10:53:52 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 18:53:52 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
Message-ID: <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>

On Wed, 12 Mar 2025, Even Rouault wrote:

>
> Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>  On Wed, 12 Mar 2025, Even Rouault wrote:
>> 
>>>
>>>>  ?unset PROJ_LIB ; ctest for example. Should I add the complete output of
>>>>  ?running ctest to this thread (490 lines)?
>>>
>>>  maybe paste it some paste service (github gist, etc) and link it to it.
>>> 
>>
>>  https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
> sorry, no clue. I doubt this is 9.6.0 related

There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same 
platform, so the only obvious change is building GDAL with 9.5.1 or 
9.6.0RC2. That is why I waited, as the airport internet I was depending on 
before I got to my desktop could have been a factor. For 9.5.1:

       Start 35: test-osr-set-proj-search-paths
35/46 Test #35: test-osr-set-proj-search-paths ...   Passed    0.12 sec
       Start 40: autotest_gdrivers
40/46 Test #40: autotest_gdrivers ................   Passed  125.56 sec
       Start 43: autotest_osr
43/46 Test #43: autotest_osr .....................   Passed    4.14 sec


Roger

>> 
>>> 
>>> 
>> 
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From even.rouault at spatialys.com  Wed Mar 12 11:05:16 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 19:05:16 +0100
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
Message-ID: <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>

ok, on second thought, I figured the issue. I assume you have statically 
linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when 
building it (cf 
https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES). 
At least I can reproduce those test failures with 
EMBED_RESOURCE_FILES=ON. Those tests aren't compatible with that 
configuration of PROJ. Ideally we should have some mechanism to skip 
them, but that would require that PROJ exposes how it has been built. In 
any case, this isn't something to worry about, just a testing issue.

Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
> On Wed, 12 Mar 2025, Even Rouault wrote:
>
>>
>> Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>> ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>
>>>>
>>>>> ??unset PROJ_LIB ; ctest for example. Should I add the complete 
>>>>> output of
>>>>> ??running ctest to this thread (490 lines)?
>>>>
>>>> ?maybe paste it some paste service (github gist, etc) and link it 
>>>> to it.
>>>>
>>>
>>> ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>> sorry, no clue. I doubt this is 9.6.0 related
>
> There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same 
> platform, so the only obvious change is building GDAL with 9.5.1 or 
> 9.6.0RC2. That is why I waited, as the airport internet I was 
> depending on before I got to my desktop could have been a factor. For 
> 9.5.1:
>
> ????? Start 35: test-osr-set-proj-search-paths
> 35/46 Test #35: test-osr-set-proj-search-paths ...?? Passed 0.12 sec
> ????? Start 40: autotest_gdrivers
> 40/46 Test #40: autotest_gdrivers ................?? Passed 125.56 sec
> ????? Start 43: autotest_osr
> 43/46 Test #43: autotest_osr .....................?? Passed 4.14 sec
>
>
> Roger
>
>>>
>>>>
>>>>
>>>
>>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Roger.Bivand at nhh.no  Wed Mar 12 12:28:09 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 20:28:09 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
 <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
Message-ID: <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>

On Wed, 12 Mar 2025, Even Rouault wrote:

> ok, on second thought, I figured the issue. I assume you have statically 
> linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when building 
> it (cf 
> https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES). 
> At least I can reproduce those test failures with EMBED_RESOURCE_FILES=ON.

In proj-9.6.0/build/CMakeCache.txt created by naked cmake .., I see:

//Whether resource files (limited to proj.db) should be embedded
// into the PROJ library
EMBED_RESOURCE_FILES:BOOL=ON

//Whether the PROJ_DATA_PATH should be embedded
EMBED_PROJ_DATA_PATH:BOOL=ON

//Directory that contains .tif, .json or .pol files to embed into
// libproj
EMBED_RESOURCE_DIRECTORY:PATH=

//Whether embedded resource files (limited to proj.db) should be
// used (should nominally be used together with EMBED_RESOURCE_FILES=ON,
// otherwise this will result in non-functional builds)
USE_ONLY_EMBEDDED_RESOURCE_FILES:BOOL=OFF

and lib contains only libproj.so.25.9.6.0 and its links, so not a static 
build. How did EMBED_RESOURCE_FILES get turned on by default, but with 
USE_ONLY_EMBEDDED_RESOURCE_FILES off?

but no EMBED_RESOURCE_FILES entry at all in 9.5.1, which only has

//Whether the PROJ_DATA_PATH should be embedded
EMBED_PROJ_DATA_PATH:BOOL=ON

Trying again with 9.6.0 and

cmake -DEMBED_RESOURCE_FILES=OFF ..

gives

//Whether resource files (limited to proj.db) should be embedded
// into the PROJ library
EMBED_RESOURCE_FILES:BOOL=OFF

so trying to re-build everything - I don't use ccache, and am using 
separate build directories, it'll take a little while.

Roger



> Those tests aren't compatible with that configuration of PROJ. Ideally we 
> should have some mechanism to skip them, but that would require that PROJ 
> exposes how it has been built. In any case, this isn't something to worry 
> about, just a testing issue.
>
> Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
>>  On Wed, 12 Mar 2025, Even Rouault wrote:
>> 
>>>
>>>  Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>>>  ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>> 
>>>>>
>>>>>>  ??unset PROJ_LIB ; ctest for example. Should I add the complete output
>>>>>>  of
>>>>>>  ??running ctest to this thread (490 lines)?
>>>>>
>>>>>  ?maybe paste it some paste service (github gist, etc) and link it to
>>>>>  it.
>>>>> 
>>>>
>>>>  ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>>>  sorry, no clue. I doubt this is 9.6.0 related
>>
>>  There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same
>>  platform, so the only obvious change is building GDAL with 9.5.1 or
>>  9.6.0RC2. That is why I waited, as the airport internet I was depending on
>>  before I got to my desktop could have been a factor. For 9.5.1:
>>
>>  ????? Start 35: test-osr-set-proj-search-paths
>>  35/46 Test #35: test-osr-set-proj-search-paths ...?? Passed 0.12 sec
>>  ????? Start 40: autotest_gdrivers
>>  40/46 Test #40: autotest_gdrivers ................?? Passed 125.56 sec
>>  ????? Start 43: autotest_osr
>>  43/46 Test #43: autotest_osr .....................?? Passed 4.14 sec
>> 
>>
>>  Roger
>> 
>>>> 
>>>>> 
>>>>> 
>>>> 
>>> 
>> 
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Wed Mar 12 12:36:32 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 20:36:32 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
 <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
 <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>
Message-ID: <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>

On Wed, 12 Mar 2025, Roger Bivand wrote:

> On Wed, 12 Mar 2025, Even Rouault wrote:
>
>>  ok, on second thought, I figured the issue. I assume you have statically
>>  linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when
>>  building it (cf
>>  https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES).
>>  At least I can reproduce those test failures with EMBED_RESOURCE_FILES=ON.
>
> In proj-9.6.0/build/CMakeCache.txt created by naked cmake .., I see:
>
> //Whether resource files (limited to proj.db) should be embedded
> // into the PROJ library
> EMBED_RESOURCE_FILES:BOOL=ON
>
> //Whether the PROJ_DATA_PATH should be embedded
> EMBED_PROJ_DATA_PATH:BOOL=ON
>
> //Directory that contains .tif, .json or .pol files to embed into
> // libproj
> EMBED_RESOURCE_DIRECTORY:PATH=
>
> //Whether embedded resource files (limited to proj.db) should be
> // used (should nominally be used together with EMBED_RESOURCE_FILES=ON,
> // otherwise this will result in non-functional builds)
> USE_ONLY_EMBEDDED_RESOURCE_FILES:BOOL=OFF
>
> and lib contains only libproj.so.25.9.6.0 and its links, so not a static 
> build.

lib/libproj.so.25.9.6.0 is 14.9 MB

> How did EMBED_RESOURCE_FILES get turned on by default, but with 
> USE_ONLY_EMBEDDED_RESOURCE_FILES off?
>
> but no EMBED_RESOURCE_FILES entry at all in 9.5.1, which only has
>
> //Whether the PROJ_DATA_PATH should be embedded
> EMBED_PROJ_DATA_PATH:BOOL=ON
>
> Trying again with 9.6.0 and
>
> cmake -DEMBED_RESOURCE_FILES=OFF ..
>
> gives
>
> //Whether resource files (limited to proj.db) should be embedded
> // into the PROJ library
> EMBED_RESOURCE_FILES:BOOL=OFF
>
> so trying to re-build everything - I don't use ccache, and am using separate 
> build directories, it'll take a little while.
>

lib/libproj.so.25.9.6.0 is 5.4 MB

Now rebuilding GDAL ...

> Roger
>
>
>
>>  Those tests aren't compatible with that configuration of PROJ. Ideally we
>>  should have some mechanism to skip them, but that would require that PROJ
>>  exposes how it has been built. In any case, this isn't something to worry
>>  about, just a testing issue.
>>
>>  Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
>>>   On Wed, 12 Mar 2025, Even Rouault wrote:
>>> 
>>>>
>>>>   Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>>>>   ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>> 
>>>>>>
>>>>>>>   ??unset PROJ_LIB ; ctest for example. Should I add the complete
>>>>>>>   output
>>>>>>>   of
>>>>>>>   ??running ctest to this thread (490 lines)?
>>>>>>
>>>>>>   ?maybe paste it some paste service (github gist, etc) and link it to
>>>>>>   it.
>>>>>> 
>>>>>
>>>>>   ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>>>>   sorry, no clue. I doubt this is 9.6.0 related
>>>
>>>   There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same
>>>   platform, so the only obvious change is building GDAL with 9.5.1 or
>>>   9.6.0RC2. That is why I waited, as the airport internet I was depending
>>>   on
>>>   before I got to my desktop could have been a factor. For 9.5.1:
>>>
>>>   ????? Start 35: test-osr-set-proj-search-paths
>>>   35/46 Test #35: test-osr-set-proj-search-paths ...?? Passed 0.12 sec
>>>   ????? Start 40: autotest_gdrivers
>>>   40/46 Test #40: autotest_gdrivers ................?? Passed 125.56 sec
>>>   ????? Start 43: autotest_osr
>>>   43/46 Test #43: autotest_osr .....................?? Passed 4.14 sec
>>> 
>>>
>>>   Roger
>>>
>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>> 
>> 
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From Roger.Bivand at nhh.no  Wed Mar 12 13:27:22 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed, 12 Mar 2025 21:27:22 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
 <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
 <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>
 <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>
Message-ID: <4a1595ad-6329-4311-12bf-f0e2dc4c7234@reclus2.nhh.no>

On Wed, 12 Mar 2025, Roger Bivand wrote:

> On Wed, 12 Mar 2025, Roger Bivand wrote:
>
>>  On Wed, 12 Mar 2025, Even Rouault wrote:
>>
>>>   ok, on second thought, I figured the issue. I assume you have statically
>>>   linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when
>>>   building it (cf
>>>   https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES).
>>>   At least I can reproduce those test failures with
>>>   EMBED_RESOURCE_FILES=ON.
>>
>>  In proj-9.6.0/build/CMakeCache.txt created by naked cmake .., I see:
>>
>>  //Whether resource files (limited to proj.db) should be embedded
>>  // into the PROJ library
>>  EMBED_RESOURCE_FILES:BOOL=ON
>>
>>  //Whether the PROJ_DATA_PATH should be embedded
>>  EMBED_PROJ_DATA_PATH:BOOL=ON
>>
>>  //Directory that contains .tif, .json or .pol files to embed into
>>  // libproj
>>  EMBED_RESOURCE_DIRECTORY:PATH=
>>
>>  //Whether embedded resource files (limited to proj.db) should be
>>  // used (should nominally be used together with EMBED_RESOURCE_FILES=ON,
>>  // otherwise this will result in non-functional builds)
>>  USE_ONLY_EMBEDDED_RESOURCE_FILES:BOOL=OFF
>>
>>  and lib contains only libproj.so.25.9.6.0 and its links, so not a static
>>  build.
>
> lib/libproj.so.25.9.6.0 is 14.9 MB
>
>>  How did EMBED_RESOURCE_FILES get turned on by default, but with
>>  USE_ONLY_EMBEDDED_RESOURCE_FILES off?
>>
>>  but no EMBED_RESOURCE_FILES entry at all in 9.5.1, which only has
>>
>>  //Whether the PROJ_DATA_PATH should be embedded
>>  EMBED_PROJ_DATA_PATH:BOOL=ON
>>
>>  Trying again with 9.6.0 and
>>
>>  cmake -DEMBED_RESOURCE_FILES=OFF ..
>>
>>  gives
>>
>>  //Whether resource files (limited to proj.db) should be embedded
>>  // into the PROJ library
>>  EMBED_RESOURCE_FILES:BOOL=OFF
>>
>>  so trying to re-build everything - I don't use ccache, and am using
>>  separate build directories, it'll take a little while.
>> 
>
> lib/libproj.so.25.9.6.0 is 5.4 MB
>
> Now rebuilding GDAL ...

The following tests FAILED:
 	 40 - autotest_gdrivers (Failed)
 	 43 - autotest_osr (Failed)
Errors while running CTest

and these are the tests patched in 
https://github.com/OSGeo/gdal/commit/49ef64108b6875e5b90a4fb6cadd089e84fe53c1 
- details added to gist.

The logic in CMakeLists.txt at line 371 looks OK:

if (NOT BUILD_SHARED_LIBS)
     set(DEFAULT_EMBED_RESOURCE_FILES ON)
else()
     set(DEFAULT_EMBED_RESOURCE_FILES OFF)
endif()

but in the default shared library case turns the embedding option on 
silently.


>
>>  Roger
>> 
>> 
>>
>>>   Those tests aren't compatible with that configuration of PROJ. Ideally
>>>   we
>>>   should have some mechanism to skip them, but that would require that
>>>   PROJ
>>>   exposes how it has been built. In any case, this isn't something to
>>>   worry
>>>   about, just a testing issue.
>>>
>>>   Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
>>>>    On Wed, 12 Mar 2025, Even Rouault wrote:
>>>> 
>>>>>
>>>>>    Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>>>>>    ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>>> 
>>>>>>>
>>>>>>>>    ??unset PROJ_LIB ; ctest for example. Should I add the complete
>>>>>>>>    output
>>>>>>>>    of
>>>>>>>>    ??running ctest to this thread (490 lines)?
>>>>>>>
>>>>>>>    ?maybe paste it some paste service (github gist, etc) and link it
>>>>>>>    to
>>>>>>>    it.
>>>>>>> 
>>>>>>
>>>>>>    ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>>>>>    sorry, no clue. I doubt this is 9.6.0 related
>>>>
>>>>    There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same
>>>>    platform, so the only obvious change is building GDAL with 9.5.1 or
>>>>    9.6.0RC2. That is why I waited, as the airport internet I was
>>>>    depending
>>>>    on
>>>>    before I got to my desktop could have been a factor. For 9.5.1:
>>>>
>>>>    ????? Start 35: test-osr-set-proj-search-paths
>>>>    35/46 Test #35: test-osr-set-proj-search-paths ...?? Passed 0.12 sec
>>>>    ????? Start 40: autotest_gdrivers
>>>>    40/46 Test #40: autotest_gdrivers ................?? Passed 125.56 sec
>>>>    ????? Start 43: autotest_osr
>>>>    43/46 Test #43: autotest_osr .....................?? Passed 4.14 sec
>>>> 
>>>>
>>>>    Roger
>>>> 
>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>> 
>>>>>
>>>>
>>> 
>> 
>> 
>
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From even.rouault at spatialys.com  Wed Mar 12 13:28:39 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 12 Mar 2025 21:28:39 +0100
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
 <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
 <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>
 <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>
Message-ID: <3976126d-1bab-4402-a7fa-e4049fe8a5a2@spatialys.com>

Roger,

good catch. Thanks for your patient testing. I could reproduce on a 
fresh build directory when BUILD_SHARED_LIBS was not set at all. There 
was an ordering issue between setting the default value of 
BUILD_SHARED_LIBS and EMBED_RESOURCE_FILES that led EMBED_RESOURCE_FILES 
to be set to ON in that situation.

Fixed per https://github.com/OSGeo/PROJ/pull/4422

Even

Le 12/03/2025 ? 20:36, Roger Bivand a ?crit?:
> On Wed, 12 Mar 2025, Roger Bivand wrote:
>
>> On Wed, 12 Mar 2025, Even Rouault wrote:
>>
>>> ?ok, on second thought, I figured the issue. I assume you have 
>>> statically
>>> ?linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when
>>> ?building it (cf
>>> ?https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES). 
>>>
>>> ?At least I can reproduce those test failures with 
>>> EMBED_RESOURCE_FILES=ON.
>>
>> In proj-9.6.0/build/CMakeCache.txt created by naked cmake .., I see:
>>
>> //Whether resource files (limited to proj.db) should be embedded
>> // into the PROJ library
>> EMBED_RESOURCE_FILES:BOOL=ON
>>
>> //Whether the PROJ_DATA_PATH should be embedded
>> EMBED_PROJ_DATA_PATH:BOOL=ON
>>
>> //Directory that contains .tif, .json or .pol files to embed into
>> // libproj
>> EMBED_RESOURCE_DIRECTORY:PATH=
>>
>> //Whether embedded resource files (limited to proj.db) should be
>> // used (should nominally be used together with EMBED_RESOURCE_FILES=ON,
>> // otherwise this will result in non-functional builds)
>> USE_ONLY_EMBEDDED_RESOURCE_FILES:BOOL=OFF
>>
>> and lib contains only libproj.so.25.9.6.0 and its links, so not a 
>> static build.
>
> lib/libproj.so.25.9.6.0 is 14.9 MB
>
>> How did EMBED_RESOURCE_FILES get turned on by default, but with 
>> USE_ONLY_EMBEDDED_RESOURCE_FILES off?
>>
>> but no EMBED_RESOURCE_FILES entry at all in 9.5.1, which only has
>>
>> //Whether the PROJ_DATA_PATH should be embedded
>> EMBED_PROJ_DATA_PATH:BOOL=ON
>>
>> Trying again with 9.6.0 and
>>
>> cmake -DEMBED_RESOURCE_FILES=OFF ..
>>
>> gives
>>
>> //Whether resource files (limited to proj.db) should be embedded
>> // into the PROJ library
>> EMBED_RESOURCE_FILES:BOOL=OFF
>>
>> so trying to re-build everything - I don't use ccache, and am using 
>> separate build directories, it'll take a little while.
>>
>
> lib/libproj.so.25.9.6.0 is 5.4 MB
>
> Now rebuilding GDAL ...
>
>> Roger
>>
>>
>>
>>> ?Those tests aren't compatible with that configuration of PROJ. 
>>> Ideally we
>>> ?should have some mechanism to skip them, but that would require 
>>> that PROJ
>>> ?exposes how it has been built. In any case, this isn't something to 
>>> worry
>>> ?about, just a testing issue.
>>>
>>> ?Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
>>>> ? On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>
>>>>>
>>>>> ? Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>>>>> ? ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>>>
>>>>>>>
>>>>>>>> ? ??unset PROJ_LIB ; ctest for example. Should I add the complete
>>>>>>>> ? output
>>>>>>>> ? of
>>>>>>>> ? ??running ctest to this thread (490 lines)?
>>>>>>>
>>>>>>> ? ?maybe paste it some paste service (github gist, etc) and link 
>>>>>>> it to
>>>>>>> ? it.
>>>>>>>
>>>>>>
>>>>>> ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>>>>> ? sorry, no clue. I doubt this is 9.6.0 related
>>>>
>>>> ? There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same
>>>> ? platform, so the only obvious change is building GDAL with 9.5.1 or
>>>> ? 9.6.0RC2. That is why I waited, as the airport internet I was 
>>>> depending
>>>> ? on
>>>> ? before I got to my desktop could have been a factor. For 9.5.1:
>>>>
>>>> ? ????? Start 35: test-osr-set-proj-search-paths
>>>> ? 35/46 Test #35: test-osr-set-proj-search-paths ... Passed 0.12 sec
>>>> ? ????? Start 40: autotest_gdrivers
>>>> ? 40/46 Test #40: autotest_gdrivers ................ Passed 125.56 sec
>>>> ? ????? Start 43: autotest_osr
>>>> ? 43/46 Test #43: autotest_osr ..................... Passed 4.14 sec
>>>>
>>>>
>>>> ? Roger
>>>>
>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>
>>>
>>
>>
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From Roger.Bivand at nhh.no  Thu Mar 13 02:51:24 2025
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 13 Mar 2025 10:51:24 +0100 (CET)
Subject: [PROJ] PROJ 9.6.0RC2
In-Reply-To: <3976126d-1bab-4402-a7fa-e4049fe8a5a2@spatialys.com>
References: <SV0P279MB04753304D238660D78FDA091EED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <SV0P279MB047501020597640FF4DB85AEEED02@SV0P279MB0475.NORP279.PROD.OUTLOOK.COM>
 <d8e3db46-855d-4813-888c-87926b43ef4f@spatialys.com>
 <f9a224ae-1687-cd2-db7c-2c3abfc5262@reclus2.nhh.no>
 <29110078-e690-404a-a1bf-2c1ed75433cb@spatialys.com>
 <b0b4a28a-46f9-f68a-529b-fa3e3fb31891@reclus2.nhh.no>
 <0ed82c43-2608-4c53-9c58-823df219d316@spatialys.com>
 <e18d4460-2640-8f3d-9a9-727ce7dfd6cb@reclus2.nhh.no>
 <b644dc14-945d-4244-8793-2d9cd987d552@spatialys.com>
 <4cb4d090-b94c-d99a-2f76-45f1b2567460@reclus2.nhh.no>
 <e7d61147-a829-4ba3-9ec9-11cbd89634d@reclus2.nhh.no>
 <3976126d-1bab-4402-a7fa-e4049fe8a5a2@spatialys.com>
Message-ID: <9db11dd-a7cb-f587-affe-6e2b3e6c6f1@reclus2.nhh.no>

On Wed, 12 Mar 2025, Even Rouault wrote:

> Roger,
>
> good catch. Thanks for your patient testing. I could reproduce on a fresh 
> build directory when BUILD_SHARED_LIBS was not set at all. There was an 
> ordering issue between setting the default value of BUILD_SHARED_LIBS and 
> EMBED_RESOURCE_FILES that led EMBED_RESOURCE_FILES to be set to ON in that 
> situation.
>
> Fixed per 
> https://github.com/OSGeo/PROJ/pull/4422

Thanks! Will try when RC3 is available.

Might the build-time embedded status of resource files perhaps be noted in 
proj.pc?

Roger

>
> Even
>
> Le 12/03/2025 ? 20:36, Roger Bivand a ?crit?:
>>  On Wed, 12 Mar 2025, Roger Bivand wrote:
>>
>>>  On Wed, 12 Mar 2025, Even Rouault wrote:
>>>
>>>>  ?ok, on second thought, I figured the issue. I assume you have
>>>>  statically
>>>>  ?linked PROJ or have explicitly enabled EMBED_RESOURCE_FILES=ON when
>>>>  ?building it (cf
>>>>  ?https://proj.org/en/latest/install.html#cmdoption-arg-EMBED_RESOURCE_FILES). 
>>>>
>>>>  ?At least I can reproduce those test failures with
>>>>  EMBED_RESOURCE_FILES=ON.
>>>
>>>  In proj-9.6.0/build/CMakeCache.txt created by naked cmake .., I see:
>>>
>>>  //Whether resource files (limited to proj.db) should be embedded
>>>  // into the PROJ library
>>>  EMBED_RESOURCE_FILES:BOOL=ON
>>>
>>>  //Whether the PROJ_DATA_PATH should be embedded
>>>  EMBED_PROJ_DATA_PATH:BOOL=ON
>>>
>>>  //Directory that contains .tif, .json or .pol files to embed into
>>>  // libproj
>>>  EMBED_RESOURCE_DIRECTORY:PATH=
>>>
>>>  //Whether embedded resource files (limited to proj.db) should be
>>>  // used (should nominally be used together with EMBED_RESOURCE_FILES=ON,
>>>  // otherwise this will result in non-functional builds)
>>>  USE_ONLY_EMBEDDED_RESOURCE_FILES:BOOL=OFF
>>>
>>>  and lib contains only libproj.so.25.9.6.0 and its links, so not a static
>>>  build.
>>
>>  lib/libproj.so.25.9.6.0 is 14.9 MB
>>
>>>  How did EMBED_RESOURCE_FILES get turned on by default, but with
>>>  USE_ONLY_EMBEDDED_RESOURCE_FILES off?
>>>
>>>  but no EMBED_RESOURCE_FILES entry at all in 9.5.1, which only has
>>>
>>>  //Whether the PROJ_DATA_PATH should be embedded
>>>  EMBED_PROJ_DATA_PATH:BOOL=ON
>>>
>>>  Trying again with 9.6.0 and
>>>
>>>  cmake -DEMBED_RESOURCE_FILES=OFF ..
>>>
>>>  gives
>>>
>>>  //Whether resource files (limited to proj.db) should be embedded
>>>  // into the PROJ library
>>>  EMBED_RESOURCE_FILES:BOOL=OFF
>>>
>>>  so trying to re-build everything - I don't use ccache, and am using
>>>  separate build directories, it'll take a little while.
>>> 
>>
>>  lib/libproj.so.25.9.6.0 is 5.4 MB
>>
>>  Now rebuilding GDAL ...
>>
>>>  Roger
>>> 
>>> 
>>>
>>>>  ?Those tests aren't compatible with that configuration of PROJ. Ideally
>>>>  we
>>>>  ?should have some mechanism to skip them, but that would require that
>>>>  PROJ
>>>>  ?exposes how it has been built. In any case, this isn't something to
>>>>  worry
>>>>  ?about, just a testing issue.
>>>>
>>>>  ?Le 12/03/2025 ? 18:53, Roger Bivand a ?crit?:
>>>>>  ? On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>> 
>>>>>>
>>>>>>  ? Le 12/03/2025 ? 18:07, Roger Bivand a ?crit?:
>>>>>>>  ? ?On Wed, 12 Mar 2025, Even Rouault wrote:
>>>>>>> 
>>>>>>>>
>>>>>>>>>  ? ??unset PROJ_LIB ; ctest for example. Should I add the complete
>>>>>>>>>  ? output
>>>>>>>>>  ? of
>>>>>>>>>  ? ??running ctest to this thread (490 lines)?
>>>>>>>>
>>>>>>>>  ? ?maybe paste it some paste service (github gist, etc) and link it
>>>>>>>>  to
>>>>>>>>  ? it.
>>>>>>>> 
>>>>>>>
>>>>>>>  ?https://gist.github.com/rsbivand/09bd9e998889a44d2eecbb842c1a5168
>>>>>>  ? sorry, no clue. I doubt this is 9.6.0 related
>>>>>
>>>>>  ? There are no such errors with PROJ 9.5.1 and GDAL 3.10.2 on the same
>>>>>  ? platform, so the only obvious change is building GDAL with 9.5.1 or
>>>>>  ? 9.6.0RC2. That is why I waited, as the airport internet I was
>>>>>  depending
>>>>>  ? on
>>>>>  ? before I got to my desktop could have been a factor. For 9.5.1:
>>>>>
>>>>>  ? ????? Start 35: test-osr-set-proj-search-paths
>>>>>  ? 35/46 Test #35: test-osr-set-proj-search-paths ... Passed 0.12 sec
>>>>>  ? ????? Start 40: autotest_gdrivers
>>>>>  ? 40/46 Test #40: autotest_gdrivers ................ Passed 125.56 sec
>>>>>  ? ????? Start 43: autotest_osr
>>>>>  ? 43/46 Test #43: autotest_osr ..................... Passed 4.14 sec
>>>>> 
>>>>>
>>>>>  ? Roger
>>>>> 
>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>> 
>>>>>> 
>>>>> 
>>>> 
>>> 
>>> 
>> 
>

-- 
Roger Bivand
Emeritus Professor
Department of Economics, Norwegian School of Economics,
Postboks 3490 Ytre Sandviken, 5045 Bergen, Norway.
e-mail: Roger.Bivand at nhh.no

From kristianevers at gmail.com  Thu Mar 13 07:50:43 2025
From: kristianevers at gmail.com (Kristian Evers)
Date: Thu, 13 Mar 2025 15:50:43 +0100
Subject: [PROJ] PROJ 9.6.0RC3
Message-ID: <68ABBB85-EE20-4377-AF53-FE2DC3A7D77F@gmail.com>

An issues regarding embedding of resource files was found in 9.6.0RC2. It's been corrected and a new release candidate is ready.
Get it here:

https://download.osgeo.org/proj/proj-9.6.0RC3.tar.gz
https://download.osgeo.org/proj/proj-9.6.0RC3.zip

Hopefully this resolves all know issues. 

/Kristian

From kristianevers at gmail.com  Fri Mar 14 03:25:45 2025
From: kristianevers at gmail.com (Kristian Evers)
Date: Fri, 14 Mar 2025 11:25:45 +0100
Subject: [PROJ] Fwd: PROJ 9.6.0RC3
In-Reply-To: <68ABBB85-EE20-4377-AF53-FE2DC3A7D77F@gmail.com>
References: <68ABBB85-EE20-4377-AF53-FE2DC3A7D77F@gmail.com>
Message-ID: <CALECs+cFH99zE9b15W1k1cF9vCDA0N8+T0A+Rv0H93q562HahQ@mail.gmail.com>

PSC members,

I'd very much like to push out the final release tomorrow. RC3 has been
available for a very limited time but as far as I
can tell the reported issues in previous RC's are all dealt with. So, I
motion that it be promoted to the final release.

I'll start with my provisional* +1

/Kristian

* If the latest fix is proved not to be sufficient I'll hold the release. I
am quite confident that the problem has been resolved though.


---------- Forwarded message ---------
From: Kristian Evers <kristianevers at gmail.com>
Date: Thu, 13 Mar 2025 at 15:50
Subject: PROJ 9.6.0RC3
To: PROJ <proj at lists.osgeo.org>


An issues regarding embedding of resource files was found in 9.6.0RC2. It's
been corrected and a new release candidate is ready.
Get it here:

https://download.osgeo.org/proj/proj-9.6.0RC3.tar.gz
https://download.osgeo.org/proj/proj-9.6.0RC3.zip

Hopefully this resolves all know issues.

/Kristian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/proj/attachments/20250314/64468a2e/attachment.htm>

