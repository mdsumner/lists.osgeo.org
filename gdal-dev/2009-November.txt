From davidstaveley at gmail.com  Mon Nov  2 09:36:39 2009
From: davidstaveley at gmail.com (David Staveley)
Date: Mon Nov  2 09:36:43 2009
Subject: [gdal-dev] Shapefiles & AVL files
Message-ID: <b691c5160911020636v2263325cx83dc27167d096680@mail.gmail.com>

Hi there,

I'm new to gdal/ogr, so please be kind.

I was using ogr2ogr to convert some geological shapefiles to kml, and found
I was just getting the geological areas outlined in red as a result, in
other words, it wasn't reading the ArcView Legend (AVL) files. Undeterred, I
wrote some code to read the AVL files and modify the resulting KML directly,
which worked fine.

I was wondering if it would be considered useful to have this functionality
in ogr2ogr, or whether AVL files are considered old hat now the files
formats have changed for later versions of ArcView? Is anyone working on
this already? My code only picks out the colours so far, but I could expand
it to read the other AVL codes.

I was reading through the code and the documentation for the "Feature Style"
classes, but they seem little used so far. Is this because it is new, or
because styles are seen as not important for the software?

I also saw some developer guidelines that say this :

"GDAL strives to be widely portable to 32bit and 64bit computing
environments. It accomplishes this in a number of ways - avoid compiler
specific directives, avoiding new, but perhaps not widely available aspects
of C++, and most importantly by abstracting platform specific operations in
CPL functions in the gdal/port directory."

Whilst it doesn't say it explicitely, does this mean that the use of the STL
is frowned upon? Would I have to convert my code from using STL for it to be
useful to the project?

That's a lot of questions for one post, so I'll stop there.

David Staveley
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091102/fff9109a/attachment.html
From tappenbeck at widemann.de  Mon Nov  2 11:01:25 2009
From: tappenbeck at widemann.de (Jan Tappenbeck)
Date: Mon Nov  2 11:01:42 2009
Subject: [gdal-dev] Help by merge jpg-files - gdal_merge
Message-ID: <4AEF0255.3070801@widemann.de>

Hallo !

in my secound post for this mail a had a secound question about gdal_merge.

using following command:

gdal_merge -v -o c:\temp\outputfile.tif --optfile c:\temp\sfilelist.txt

and 16 jpg-filenames (size 4-5 mb) in sfilelist.txt i create a new file 
outputfile.tif with 2.3 gb !!!! a size unpractical to open in a viewer.

my job is to merge 500 files - is there a mistake i do in prinziple ????

i found the new file-size very big - because the resolution of the 
source jpg-files is 72 dpi !

can anybody help me ??

regards Jan :-)


From hobu.inc at gmail.com  Mon Nov  2 11:07:30 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Mon Nov  2 11:10:51 2009
Subject: [gdal-dev] Shapefiles & AVL files
In-Reply-To: <b691c5160911020636v2263325cx83dc27167d096680@mail.gmail.com>
References: <b691c5160911020636v2263325cx83dc27167d096680@mail.gmail.com>
Message-ID: <46ECD3DF-05BD-4693-85A2-B053E6F5799A@gmail.com>


On Nov 2, 2009, at 8:36 AM, David Staveley wrote:

> Hi there,
>
> I'm new to gdal/ogr, so please be kind.
>
> I was using ogr2ogr to convert some geological shapefiles to kml,  
> and found I was just getting the geological areas outlined in red as  
> a result, in other words, it wasn't reading the ArcView Legend (AVL)  
> files. Undeterred, I wrote some code to read the AVL files and  
> modify the resulting KML directly, which worked fine.
>
> I was wondering if it would be considered useful to have this  
> functionality in ogr2ogr, or whether AVL files are considered old  
> hat now the files formats have changed for later versions of  
> ArcView? Is anyone working on this already? My code only picks out  
> the colours so far, but I could expand it to read the other AVL codes.
>
> I was reading through the code and the documentation for the  
> "Feature Style" classes, but they seem little used so far. Is this  
> because it is new, or because styles are seen as not important for  
> the software?

I think it would be interesting to be able to ingest the AVL files  
into the Feature Styling stuff where it's applicable.  Specific code  
for taking AVL to KML probably doesn't fit all that well within OGR  
unless it was first going up to the generic Feature Styling APIs.   
Also, it is very likely that the Feature Styling APIs need to be  
expanded upon to support more of the things you would want to carry  
forward from AVL.


>
> I also saw some developer guidelines that say this :
>
> "GDAL strives to be widely portable to 32bit and 64bit computing  
> environments. It accomplishes this in a number of ways - avoid  
> compiler specific directives, avoiding new, but perhaps not widely  
> available aspects of C++, and most importantly by abstracting  
> platform specific operations in CPL functions in the gdal/port  
> directory."
>
> Whilst it doesn't say it explicitely, does this mean that the use of  
> the STL is frowned upon? Would I have to convert my code from using  
> STL for it to be useful to the project?

I would say that STL is somewhat frown upon in "public" areas of the  
code, which means areas of the code that aren't self-contained  
drivers.  A patch written in STL still isn't precluded from being  
applied, however, especially if it is doing simple and well-supported  
stuff.

From warmerdam at pobox.com  Mon Nov  2 11:31:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Nov  2 11:31:47 2009
Subject: [gdal-dev] Help by merge jpg-files - gdal_merge
In-Reply-To: <4AEF0255.3070801@widemann.de>
References: <4AEF0255.3070801@widemann.de>
Message-ID: <4AEF095F.7010901@pobox.com>

Jan Tappenbeck wrote:
> Hallo !
> 
> in my secound post for this mail a had a secound question about gdal_merge.
> 
> using following command:
> 
> gdal_merge -v -o c:\temp\outputfile.tif --optfile c:\temp\sfilelist.txt
> 
> and 16 jpg-filenames (size 4-5 mb) in sfilelist.txt i create a new file 
> outputfile.tif with 2.3 gb !!!! a size unpractical to open in a viewer.
> 
> my job is to merge 500 files - is there a mistake i do in prinziple ????
> 
> i found the new file-size very big - because the resolution of the 
> source jpg-files is 72 dpi !

Jan,

There are various reasons this could be happening.

1) The input files could be highly compressed and the result file is
uncompressed.  JPEG compression is often on the order of 5:1 so a
5MB jpeg might well be 25MB uncompressed.  Depending on options it
is possible to achieve substantially more than 5:1 compression.

2) The input files could be spatially distant such that the resulting
uncompressed output file has large areas of no data (ie. an airphoto
in Canada and another one in Germany).

I would note that 2.3 GB is not too large a file to open in a viewer
application intended to work with large files.  However, it is generally
impractical to work with large geospatial mosaics in "camera photo"
oriented image viewers.

Your process does not seem unreasonable, but if you are going to produce
a large mosaic image you will need software intended to work with such a
large file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From BCassanova at weather.com  Mon Nov  2 16:13:39 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Nov  2 16:28:49 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected data.. Major
	confusion and help requested.
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>

Hi all,

I am looking to gain a better understanding of how I can use GDAL to
build a Mercator Image from un-projected data.

The data I have is contained in proprietary format.  For all intensive
purposes it is a grid consisting of 2464 rows by 5796 columns of data.
The origin of the data is in the upper left hand corner of the grid with
grid lat-lon dimensions of -125.99, 49.7186 for the upper left and
-65.656, 24.0938 for the lower right.

I have tried several things but not sure I get the connection well
enough to complete the project. So...Here is my sample program with
Excerpts for comments. 

std::pair< double, double > upper_left = std::make_pair( -125.99,
49.7186 );
std::pair< double, double > upper_right = std::make_pair( -65.656,
49.7186 );
std::pair< double, double > lower_left = std::make_pair( -125.99,
24.0938 );
std::pair< double, double > lower_right = std::make_pair( -65.656,
49.7186 );

int my_points = 1;
int result = 0;

double x, y;

OGRSpatialReferenceH mercator_proj = OSRNewSpatialReference( "" );
OSRSetProjCS( mercator_proj, "Mercator Projection" );
OSRImportFromProj4( mercator_proj, "+proj=merc" );

OGRSpatialReferenceH wgs84_proj = OSRNewSpatialReference( "" );
OSRSetWellKnownGeogCS( wgs84_proj,  "WGS84" );


OGRCoordinateTransformationH my_transformation =
OCTNewCoordinateTransformation( wgs84_proj, mercator_proj );

x = upper_left.first;
y = upper_left.second;

OCTTransform( my_transformation, my_points, &x, &y, NULL );

std::cout << std::fixed;

std::cout << result << " " << upper_left.first << ", " <<
upper_left.second << " = " << x << ", " << y << std::endl;

The output for my example is:
0 -125.990000, 49.718600 = -14025142.645045, 6365068.664114

The values output in meters and are exactly what I would expect and are
similar to proj4 output.  
My question is how do I convert this into actual i-j coordinates for the
image...And even more so how do I convert these to i-j coordinates
For the data since it is un-projected?

Another Method is using GDALCreateGenImgProfTransformer:

char *pszDstWKT = NULL;
char *pszSrcWKT = NULL;

OSRExportToWkt( mercator_proj, &pszDstWKT );
OSRExportToWkt( wgs84_proj, &pszSrcWKT );


void *hTransformArg;

hTransformArg = GDALCreateGenImgProjTransformer( NULL, pszSrcWKT, NULL,
pszDstWKT, FALSE, 0, 1 );


x = upper_left.first;
y = upper_left.second;

int success;

result = GDALGenImgProjTransform(hTransformArg, TRUE, 1, &x, &y,
                              NULL, &success);


std::cout << std::fixed;

td::cout << result << " " << upper_left.first << ", " <<
upper_left.second << " = " << x << ", " << y << std::endl;
// 1 -125.990000, 49.718600 = -0.001132, 0.000450
// OK, this seems sensible but is this the i-j offset into the data or
the image or both

x = lower_right.first;
y = lower_right.second;


result = GDALGenImgProjTransform(hTransformArg, TRUE, 1, &x, &y,
                              NULL, &success);


std::cout << std::fixed;
std::cout << result << " " << lower_right.first << ", " <<
lower_right.second << " = " << x << ", " << y << std::endl;
// 1 -65.656000, 49.718600 = -0.000590, 0.000450
// This is NOT Right so apparently I am doing something wrong or not
understanding the concept here

Thanks,
Bill

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091102/7af4931e/attachment.html
From Chris.Barker at noaa.gov  Mon Nov  2 16:38:45 2009
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Mon Nov  2 16:37:12 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected data..
	Major	confusion and help requested.
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
Message-ID: <4AEF5165.50605@noaa.gov>

Cassanova, Bill wrote:
> I am looking to gain a better understanding of how I can use GDAL to 
> build a Mercator Image from un-projected data.

Do you need to write your own code for this?, or could you just use the 
  gdalwarp utility? (maybe after converting to a format gdal knows).

If you do need your own code, you might look at the gdalwarp code.

Which brings up a question I could answer by reading the source, but 
since I'm here:

Is the core warping functionality in the GDAL API (and wrapped for 
Python?), or in the gdalwarp code -- I may need to do some warping in 
code as well.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From BCassanova at weather.com  Mon Nov  2 16:47:19 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Nov  2 16:48:11 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected
	data..Major	confusion and help requested.
In-Reply-To: <4AEF5165.50605@noaa.gov>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
	<4AEF5165.50605@noaa.gov>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80B999EBE@ATLMAIL01.corp.weather.com>

 

Well, I sorta tried that:

 

gdalwarp -s_src '+proj=WGS84' -t_srs '+proj=merc'
hiradff_200910121800_f180_weather_radar.tiff foo.tiff

 

And the reply is:

 

Usage: gdalwarp [--help-general] [--formats]

    [-s_srs srs_def] [-t_srs srs_def] [-to "NAME=VALUE"]

    [-order n] [-tps] [-rpc] [-geoloc] [-et err_threshold]

    [-te xmin ymin xmax ymax] [-tr xres yres] [-ts width height]

    [-wo "NAME=VALUE"] [-ot Byte/Int16/...] [-wt Byte/Int16]

    [-srcnodata "value [value...]"] [-dstnodata "value [value...]"]
-dstalpha

    [-r resampling_method] [-wm memory_in_mb] [-multi] [-q]

    [-cutline datasource] [-cl layer] [-cwhere expression]

    [-csql statement] [-cblend dist_in_pixels]

    [-of format] [-co "NAME=VALUE"]*

    srcfile* dstfile

 

Available resampling methods:

    near (default), bilinear, cubic, cubicspline, lanczos.

 

The file is something GDAL should understand:

 

[vizuser@vizintqa exploded_visualizer]$ gdalinfo
hiradff_200910121800_f180_weather_radar.tiff

Driver: GTiff/GeoTIFF

Files: hiradff_200910121800_f180_weather_radar.tiff

Size is 5796, 2464

Coordinate System is:

GEOGCS["Coordinate System imported from GRIB file",

    DATUM["unknown",

        SPHEROID["unnamed",6367470,0]],

    PRIMEM["Greenwich",0],

    UNIT["degree",0.0174532925199433]]

Origin = (234.010419999999982,49.706487000000003)

Pixel Size = (0.010399000000000,-0.010399000000000)

Metadata:

  AREA_OR_POINT=Area

Image Structure Metadata:

  INTERLEAVE=PIXEL

Corner Coordinates:

Upper Left  (     234.010,      49.706) (234d 0'37.51"E, 49d42'23.35"N)

Lower Left  (     234.010,      24.083) (234d 0'37.51"E, 24d 5'0.06"N)

Upper Right (     294.283,      49.706) (294d16'58.89"E, 49d42'23.35"N)

Lower Right (     294.283,      24.083) (294d16'58.89"E, 24d 5'0.06"N)

Center      (     264.147,      36.895) (264d 8'48.20"E, 36d53'41.71"N)

Band 1 Block=5796x1 Type=Byte, ColorInterp=Red

  Mask Flags: PER_DATASET ALPHA

Band 2 Block=5796x1 Type=Byte, ColorInterp=Green

  Mask Flags: PER_DATASET ALPHA

Band 3 Block=5796x1 Type=Byte, ColorInterp=Blue

  Mask Flags: PER_DATASET ALPHA

Band 4 Block=5796x1 Type=Byte, ColorInterp=Alpha

 

 

Am I missing something here?  I would however prefer to do it with code
so that I can go directly from my data to an image without the
intermediate step

Of using gdalwarp.

 

-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Christopher
Barker
Sent: Monday, November 02, 2009 4:39 PM
To: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Building a Mercator Image from Un-projected
data..Major confusion and help requested.

 

Cassanova, Bill wrote:

> I am looking to gain a better understanding of how I can use GDAL to 

> build a Mercator Image from un-projected data.

 

Do you need to write your own code for this?, or could you just use the 

  gdalwarp utility? (maybe after converting to a format gdal knows).

 

If you do need your own code, you might look at the gdalwarp code.

 

Which brings up a question I could answer by reading the source, but 

since I'm here:

 

Is the core warping functionality in the GDAL API (and wrapped for 

Python?), or in the gdalwarp code -- I may need to do some warping in 

code as well.

 

-Chris

 

 

 

-- 

Christopher Barker, Ph.D.

Oceanographer

 

Emergency Response Division

NOAA/NOS/OR&R            (206) 526-6959   voice

7600 Sand Point Way NE   (206) 526-6329   fax

Seattle, WA  98115       (206) 526-6317   main reception

 

Chris.Barker@noaa.gov

_______________________________________________

gdal-dev mailing list

gdal-dev@lists.osgeo.org

http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091102/2bfcb0bc/attachment-0001.html
From nowak at xpam.de  Mon Nov  2 16:49:55 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Mon Nov  2 16:49:43 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected data..
	Major	confusion and help requested.
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
Message-ID: <4AEF5403.4080701@xpam.de>

Cassanova, Bill wrote:
> result = GDALGenImgProjTransform(hTransformArg, TRUE, 1, &x, &y,
>                               NULL, &success);
> std::cout << std::fixed;
> std::cout << result << " " << lower_right.first << ", " << 
> lower_right.second << " = " << x << ", " << y << std::endl;
> 
> *//** 1 -65.656000, 49.718600 = -0.000590, 0.000450***
> 
> *// This is NOT Right** so apparently I am doing something wrong or not 
> understanding the concept here*

2nd argument to GDALGenImgProjTransform is TRUE so you are reprojecting 
from, not to mercator
From nowak at xpam.de  Mon Nov  2 16:51:52 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Mon Nov  2 16:51:41 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected	data..Major
	confusion and help requested.
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80B999EBE@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>	<4AEF5165.50605@noaa.gov>
	<1D5F4E64B8C04F4C868B94AC9A532AF80B999EBE@ATLMAIL01.corp.weather.com>
Message-ID: <4AEF5478.1070000@xpam.de>

Cassanova, Bill wrote:
> *Well, I sorta tried that:*
> gdalwarp -s_src '+proj=WGS84' -t_srs '+proj=merc' 
> hiradff_200910121800_f180_weather_radar.tiff foo.tiff

-s_srs not -s_src
Please, before posting on this list, at least check for typos!
From BCassanova at weather.com  Mon Nov  2 21:22:34 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Nov  2 21:22:41 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected
	data..Major	confusion and help requested.
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
	<4AEF5403.4080701@xpam.de>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF809B1A0FB@ATLMAIL01.corp.weather.com>

Thanks for the guidance.    The results are correct in the sense that the transformations are correct in terms of the meters values being returned.  My question is how does this convert to pixel location FROM the data set and then INTO the image.
In the below code example the bolded values are my output.  My lack of understanding comes from how do I use this information returned in Meters to navigate into my dataset and then navigate into the image?  Is it as simple of determining the meters 
for the upper left and then meters for the lower right and then setting up a ratio based on the rows and columns in the input data set and corresponding output image?  This doesn't seem like a linear problem but perhaps GDAL is taking this out of the equation.
The output image will be the same number of rows and columns as the source data so no interpolation of data is needed.  My presumption is that the difference will be WHERE a particular pixel is located in the image.  Doing a straight Platte Carre
image is simple because the origin in the datasource is the same as the origin in the image.  The lowest right data element in the datasource will have the same i-j as the lowest right pixel.  My presumption and perhaps this is where I need clarification
is this will NOT be the case with Mercator or any other projection.
std::pair< double, double > upper_left = std::make_pair( -125.99, 49.7186 );

std::pair< double, double > upper_right = std::make_pair( -65.656, 49.7186 );

std::pair< double, double > lower_left = std::make_pair( -125.99, 24.0938 );

std::pair< double, double > lower_right = std::make_pair( -65.656, 24.0938 );

int my_points = 1;

int result = 0;

double x, y;

x = lower_right.first;

y = lower_right.second;

OCTTransform( my_transformation, my_points, &x, &y, NULL );

std::cout << std::fixed;

std::cout << result << " " << lower_right.first << ", " << lower_right.second << " = " << x << ", " << y << std::endl;

// 0 -65.656000, 24.093800 = -7308792.487523, 2747405.191359  --> These are correct


char *pszDstWKT = NULL;

char *pszSrcWKT = NULL;

OSRExportToWkt( mercator_proj, &pszDstWKT );

OSRExportToWkt( wgs84_proj, &pszSrcWKT );

void *hTransformArg;

hTransformArg = GDALCreateGenImgProjTransformer( NULL, pszSrcWKT, NULL, pszDstWKT, FALSE, 0, 1 );

x = upper_right.first;

y = upper_right.second;

int success;

result = GDALGenImgProjTransform(hTransformArg, FALSE, 1, &x, &y,  NULL, &success);

std::cout << result << " " << upper_right.first << ", " << upper_right.second << " = " << x << ", " << y << std::endl;

// 1 -65.656000, 49.718600 = -7308792.487523, 6365068.664114 --> This is now correct as well


x = lower_right.first;

y = lower_right.second;

result = GDALGenImgProjTransform(hTransformArg, FALSE, 1, &x, &y, NULL, &success);

std::cout << result << " " << lower_right.first << ", " << lower_right.second << " = " << x << ", " << y << std::endl;

//  1 -65.656000, 24.093800 = -7308792.487523, 2747405.191359 --> These are correct


________________________________

From: gdal-dev-bounces@lists.osgeo.org on behalf of Adam Nowacki
Sent: Mon 11/2/2009 4:49 PM
To: gdal-dev@lists.osgeo.org >> Gdal-Dev
Subject: Re: [gdal-dev] Building a Mercator Image from Un-projected data..Major confusion and help requested.



Cassanova, Bill wrote:
> result = GDALGenImgProjTransform(hTransformArg, TRUE, 1, &x, &y,
>                               NULL, &success);
> std::cout << std::fixed;
> std::cout << result << " " << lower_right.first << ", " <<
> lower_right.second << " = " << x << ", " << y << std::endl;
>
> *//** 1 -65.656000, 49.718600 = -0.000590, 0.000450***
>
> *// This is NOT Right** so apparently I am doing something wrong or not
> understanding the concept here*

2nd argument to GDALGenImgProjTransform is TRUE so you are reprojecting
from, not to mercator
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091102/624838b5/attachment.html
From webmaster at spaceyes.fr  Tue Nov  3 08:47:03 2009
From: webmaster at spaceyes.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Tue Nov  3 08:46:57 2009
Subject: [gdal-dev] GUI front end for gdal_del and gdal_contour
Message-ID: <0a1c01ca5c8c$21a04990$64e0dcb0$@fr>

Hi all. 

 

For those of you using gdal_dem or gdal_countour, the new version of our
free 3D visualization software ?SpacEyes 3D Viewer? ( for windows ) includes
an utility providing an easy to use interface for these two command line
tools. 

 

More information is available on our web site :
<http://www.spaceyes.com/index.php?option=com_content&task=view&id=196&Itemi
d=81&lang=en_GB>
http://www.spaceyes.com/index.php?option=com_content&task=view&id=196&Itemid
=81&lang=en_GB. 

 

Comments  are welcome.

 

Best regards,

 

Fr?d?ric.

_________________________________________________________________________

 <http://www.spaceyes.com> www.spaceyes.com

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091103/dc253998/attachment.html
From peifer at gmx.eu  Tue Nov  3 09:11:56 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue Nov  3 09:12:30 2009
Subject: [gdal-dev] Corner Coordinates for a PixelisPoint type GeoTIFF
Message-ID: <hcpdnd$dau$1@ger.gmane.org>

Hi All,

I am somewhat puzzled by the different sets of corner coordinates that 
gdalinfo and listgeo report for the same PixelisPoint GeoTIFF, see [1] 
and [2]. Can both be true at the same time?

Thanks, Hermann


[1]

$ gdalinfo cdda100.tif
Driver: GTiff/GeoTIFF
Files: cdda100.tif
Size is 56392, 44743
Coordinate System is:
PROJCS["ETRS_1989_LAEA",
     GEOGCS["GCS_ETRS_1989",
         DATUM["European_Terrestrial_Reference_System_1989",
             SPHEROID["GRS_1980",6378137.0,298.257222101]],
         PRIMEM["Greenwich",0.0],
         UNIT["Degree",0.0174532925199433]],
     PROJECTION["Lambert_Azimuthal_Equal_Area"],
     PARAMETER["False_Easting",4321000.0],
     PARAMETER["False_Northing",3210000.0],
     PARAMETER["longitude_of_center",10.0],
     PARAMETER["latitude_of_center",52.0],
     UNIT["Meter",1.0]]
Origin = (1547200.000000000000000,5416000.000000000000000)
Pixel Size = (100.000000000000000,-100.000000000000000)
Metadata:
   AREA_OR_POINT=Point
   TIFFTAG_SOFTWARE=Arc/Info
   TIFFTAG_XRESOLUTION=0.0099999998
   TIFFTAG_YRESOLUTION=0.0099999998
   TIFFTAG_RESOLUTIONUNIT=1 (unitless)
Image Structure Metadata:
   COMPRESSION=LZW
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 1547200.000, 5416000.000) ( 48d 6'29.49"W, 60d36'53.91"N)
Lower Left  ( 1547200.000,  941700.000) ( 17d54'14.25"W, 26d55'37.74"N)
Upper Right ( 7186400.000, 5416000.000) ( 69d13'59.10"E, 59d59'56.41"N)
Lower Right ( 7186400.000,  941700.000) ( 38d46'25.90"E, 26d37'44.54"N)
Center      ( 4366800.000, 3178850.000) ( 10d39'45.86"E, 51d43'5.40"N)
Band 1 Block=56392x2 Type=Byte, ColorInterp=Palette

(...)


[2]

$ listgeo cdda100.tif
Geotiff_Information:
    Version: 1
    Key_Revision: 1.0
    Tagged_Information:
       ModelTiepointTag (2,3):
          0                0                0
          1547250          5415950          0
       ModelPixelScaleTag (1,3):
          100              100              0
       End_Of_Tags.
    Keyed_Information:
       GTModelTypeGeoKey (Short,1): Undefined
       GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
       GTCitationGeoKey (Ascii,304): "IMAGINE GeoTIFF Support\nCopyright 
1991 - 2005 by Leica Geosystems Geospatial Imaging, LLC. All Rights 
Reserved\n@(#)$RCSfile: egtf.c $ IMAGINE 9.0 $Revision: 10.0 $ $Date: 
2005/07/26 15:10:00 EST $\nGeocoding information not 
available\nProjection Name = ETRS_1989_LAEA\nUnits = meters\nGeoTIFF 
Units = meters"
       ProjLinearUnitsGeoKey (Short,1): Linear_Meter
       End_Of_Keys.
    End_Of_Geotiff.

Projection Linear Units: 9001/metre (1.000000m)

Corner Coordinates:
Upper Left    ( 1547250.000, 5415950.000)
Lower Left    ( 1547250.000,  941650.000)
Upper Right   ( 7186450.000, 5415950.000)
Lower Right   ( 7186450.000,  941650.000)
Center        ( 4366850.000, 3178800.000)


[3]

$ cat  cdda100.tfw
                  100.00000000000000
                    0.00000000000000
                    0.00000000000000
                 -100.00000000000000
              1547250.00000000000000
              5415950.00000000000000

From mathieu at inventis.ca  Tue Nov  3 09:17:22 2009
From: mathieu at inventis.ca (Mathieu Lahaye)
Date: Tue Nov  3 09:18:24 2009
Subject: [gdal-dev] ogr2gui v0.6 release announcement
Message-ID: <85cokl$cfapc@fipsb04.cogeco.net>

Inventis today announced the release of OGR2GUI version 0.6, the graphical
user interface used to convert and manipulate geospatial data based on
ogr2ogr.

What's new in this version?

- The migration of the GUI code to Nokia's QT platform
- Now supports database formats such as Oracle Spatial, PostgreSQL, MySQL,
SQLite and ODBC connections.
- Added support for GPX, GMT, GeoJSON, Geoconcept and FME Objects Gateway
formats
- A new website for downloading and exchanging between users: ogr2gui.ca 

Few bugs still remain in the application. You're invited to test it and send
us your feedback: dev[at]ogr2gui.ca

Compiling under Linux works great but we're not able to include databases
libraries under Windows (that's why you'll find a package containing needed
dlls). If anyone has any ideas or solution...let us know! Your help would be
much appreciated.

Regards,
The dev team ;)

From dany.geotools at gmail.com  Tue Nov  3 10:39:22 2009
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Tue Nov  3 10:39:26 2009
Subject: [gdal-dev] Corner Coordinates for a PixelisPoint type GeoTIFF
In-Reply-To: <hcpdnd$dau$1@ger.gmane.org>
References: <hcpdnd$dau$1@ger.gmane.org>
Message-ID: <7221db410911030739u12998baeo1a239532ebe3198c@mail.gmail.com>

Hi Hermann,
as far as I know, GDAL always returns coordinates in the pixel_corner
convention.
Take a look here about conventions:
http://www.vterrain.org/Misc/cellreg.html

Therefore, I guess from gdalinfo you see the AREA_OR_POINT = POINT
(Center_extent) metadata whilst the coordinates are exposed in Corner_extent
(instead of center_extent).

I don't know how listgeo works but I guess it shows AREA_OR_POINT=POINT and
it produces coordinates in that convention (center_extent).
This will explain why you see a 50 meters (half pixel) difference between
the 2 outputs which seem coherent.

Gdal shows the coordinate of the corner of the pixel whilst listgeo shows
the coordinate of the center of the pixel. Also note that world files should
always be in pixel is center (indeed, your world file contains 1547250 and
5415950 grid origin).

Hope this helps.

Best Regards,
Daniele

-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------


On Tue, Nov 3, 2009 at 3:11 PM, Hermann Peifer <peifer@gmx.eu> wrote:

> Hi All,
>
> I am somewhat puzzled by the different sets of corner coordinates that
> gdalinfo and listgeo report for the same PixelisPoint GeoTIFF, see [1] and
> [2]. Can both be true at the same time?
>
> Thanks, Hermann
>
>
> [1]
>
> $ gdalinfo cdda100.tif
> Driver: GTiff/GeoTIFF
> Files: cdda100.tif
> Size is 56392, 44743
> Coordinate System is:
> PROJCS["ETRS_1989_LAEA",
>    GEOGCS["GCS_ETRS_1989",
>        DATUM["European_Terrestrial_Reference_System_1989",
>            SPHEROID["GRS_1980",6378137.0,298.257222101]],
>        PRIMEM["Greenwich",0.0],
>        UNIT["Degree",0.0174532925199433]],
>    PROJECTION["Lambert_Azimuthal_Equal_Area"],
>    PARAMETER["False_Easting",4321000.0],
>    PARAMETER["False_Northing",3210000.0],
>    PARAMETER["longitude_of_center",10.0],
>    PARAMETER["latitude_of_center",52.0],
>    UNIT["Meter",1.0]]
> Origin = (1547200.000000000000000,5416000.000000000000000)
> Pixel Size = (100.000000000000000,-100.000000000000000)
> Metadata:
>  AREA_OR_POINT=Point
>  TIFFTAG_SOFTWARE=Arc/Info
>  TIFFTAG_XRESOLUTION=0.0099999998
>  TIFFTAG_YRESOLUTION=0.0099999998
>  TIFFTAG_RESOLUTIONUNIT=1 (unitless)
> Image Structure Metadata:
>  COMPRESSION=LZW
>  INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( 1547200.000, 5416000.000) ( 48d 6'29.49"W, 60d36'53.91"N)
> Lower Left  ( 1547200.000,  941700.000) ( 17d54'14.25"W, 26d55'37.74"N)
> Upper Right ( 7186400.000, 5416000.000) ( 69d13'59.10"E, 59d59'56.41"N)
> Lower Right ( 7186400.000,  941700.000) ( 38d46'25.90"E, 26d37'44.54"N)
> Center      ( 4366800.000, 3178850.000) ( 10d39'45.86"E, 51d43'5.40"N)
> Band 1 Block=56392x2 Type=Byte, ColorInterp=Palette
>
> (...)
>
>
> [2]
>
> $ listgeo cdda100.tif
> Geotiff_Information:
>   Version: 1
>   Key_Revision: 1.0
>   Tagged_Information:
>      ModelTiepointTag (2,3):
>         0                0                0
>         1547250          5415950          0
>      ModelPixelScaleTag (1,3):
>         100              100              0
>      End_Of_Tags.
>   Keyed_Information:
>      GTModelTypeGeoKey (Short,1): Undefined
>      GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>      GTCitationGeoKey (Ascii,304): "IMAGINE GeoTIFF Support\nCopyright 1991
> - 2005 by Leica Geosystems Geospatial Imaging, LLC. All Rights Reserved\n@(#)$RCSfile:
> egtf.c $ IMAGINE 9.0 $Revision: 10.0 $ $Date: 2005/07/26 15:10:00 EST
> $\nGeocoding information not available\nProjection Name =
> ETRS_1989_LAEA\nUnits = meters\nGeoTIFF Units = meters"
>      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>      End_Of_Keys.
>   End_Of_Geotiff.
>
> Projection Linear Units: 9001/metre (1.000000m)
>
> Corner Coordinates:
> Upper Left    ( 1547250.000, 5415950.000)
> Lower Left    ( 1547250.000,  941650.000)
> Upper Right   ( 7186450.000, 5415950.000)
> Lower Right   ( 7186450.000,  941650.000)
> Center        ( 4366850.000, 3178800.000)
>
>
> [3]
>
> $ cat  cdda100.tfw
>                 100.00000000000000
>                   0.00000000000000
>                   0.00000000000000
>                -100.00000000000000
>             1547250.00000000000000
>             5415950.00000000000000
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091103/69c0d68e/attachment.html
From daniele.romagnoli at geo-solutions.it  Tue Nov  3 10:40:06 2009
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue Nov  3 10:40:10 2009
Subject: [gdal-dev] Corner Coordinates for a PixelisPoint type GeoTIFF
In-Reply-To: <hcpdnd$dau$1@ger.gmane.org>
References: <hcpdnd$dau$1@ger.gmane.org>
Message-ID: <7221db410911030740q4b5647c8m77608347ac88fe2c@mail.gmail.com>

Hi Hermann,
as far as I know, GDAL always returns coordinates in the pixel_corner
convention.
Take a look here about conventions:
http://www.vterrain.org/Misc/cellreg.html

Therefore, I guess from gdalinfo you see the AREA_OR_POINT = POINT
(Center_extent) metadata whilst the coordinates are exposed in Corner_extent
(instead of center_extent).

I don't know how listgeo works but I guess it shows AREA_OR_POINT=POINT and
it produces coordinates in that convention (center_extent).
This will explain why you see a 50 meters (half pixel) difference between
the 2 outputs which seem coherent.

Gdal shows the coordinate of the corner of the pixel whilst listgeo shows
the coordinate of the center of the pixel. Also note that world files should
always be in pixel is center (indeed, your world file contains 1547250 and
5415950 grid origin).

Hope this helps.

Best Regards,
Daniele

-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it


On Tue, Nov 3, 2009 at 3:11 PM, Hermann Peifer <peifer@gmx.eu> wrote:

> Hi All,
>
> I am somewhat puzzled by the different sets of corner coordinates that
> gdalinfo and listgeo report for the same PixelisPoint GeoTIFF, see [1] and
> [2]. Can both be true at the same time?
>
> Thanks, Hermann
>
>
> [1]
>
> $ gdalinfo cdda100.tif
> Driver: GTiff/GeoTIFF
> Files: cdda100.tif
> Size is 56392, 44743
> Coordinate System is:
> PROJCS["ETRS_1989_LAEA",
>    GEOGCS["GCS_ETRS_1989",
>        DATUM["European_Terrestrial_Reference_System_1989",
>            SPHEROID["GRS_1980",6378137.0,298.257222101]],
>        PRIMEM["Greenwich",0.0],
>        UNIT["Degree",0.0174532925199433]],
>    PROJECTION["Lambert_Azimuthal_Equal_Area"],
>    PARAMETER["False_Easting",4321000.0],
>    PARAMETER["False_Northing",3210000.0],
>    PARAMETER["longitude_of_center",10.0],
>    PARAMETER["latitude_of_center",52.0],
>    UNIT["Meter",1.0]]
> Origin = (1547200.000000000000000,5416000.000000000000000)
> Pixel Size = (100.000000000000000,-100.000000000000000)
> Metadata:
>  AREA_OR_POINT=Point
>  TIFFTAG_SOFTWARE=Arc/Info
>  TIFFTAG_XRESOLUTION=0.0099999998
>  TIFFTAG_YRESOLUTION=0.0099999998
>  TIFFTAG_RESOLUTIONUNIT=1 (unitless)
> Image Structure Metadata:
>  COMPRESSION=LZW
>  INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( 1547200.000, 5416000.000) ( 48d 6'29.49"W, 60d36'53.91"N)
> Lower Left  ( 1547200.000,  941700.000) ( 17d54'14.25"W, 26d55'37.74"N)
> Upper Right ( 7186400.000, 5416000.000) ( 69d13'59.10"E, 59d59'56.41"N)
> Lower Right ( 7186400.000,  941700.000) ( 38d46'25.90"E, 26d37'44.54"N)
> Center      ( 4366800.000, 3178850.000) ( 10d39'45.86"E, 51d43'5.40"N)
> Band 1 Block=56392x2 Type=Byte, ColorInterp=Palette
>
> (...)
>
>
> [2]
>
> $ listgeo cdda100.tif
> Geotiff_Information:
>   Version: 1
>   Key_Revision: 1.0
>   Tagged_Information:
>      ModelTiepointTag (2,3):
>         0                0                0
>         1547250          5415950          0
>      ModelPixelScaleTag (1,3):
>         100              100              0
>      End_Of_Tags.
>   Keyed_Information:
>      GTModelTypeGeoKey (Short,1): Undefined
>      GTRasterTypeGeoKey (Short,1): RasterPixelIsPoint
>      GTCitationGeoKey (Ascii,304): "IMAGINE GeoTIFF Support\nCopyright 1991
> - 2005 by Leica Geosystems Geospatial Imaging, LLC. All Rights Reserved\n@(#)$RCSfile:
> egtf.c $ IMAGINE 9.0 $Revision: 10.0 $ $Date: 2005/07/26 15:10:00 EST
> $\nGeocoding information not available\nProjection Name =
> ETRS_1989_LAEA\nUnits = meters\nGeoTIFF Units = meters"
>      ProjLinearUnitsGeoKey (Short,1): Linear_Meter
>      End_Of_Keys.
>   End_Of_Geotiff.
>
> Projection Linear Units: 9001/metre (1.000000m)
>
> Corner Coordinates:
> Upper Left    ( 1547250.000, 5415950.000)
> Lower Left    ( 1547250.000,  941650.000)
> Upper Right   ( 7186450.000, 5415950.000)
> Lower Right   ( 7186450.000,  941650.000)
> Center        ( 4366850.000, 3178800.000)
>
>
> [3]
>
> $ cat  cdda100.tfw
>                 100.00000000000000
>                   0.00000000000000
>                   0.00000000000000
>                -100.00000000000000
>             1547250.00000000000000
>             5415950.00000000000000
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091103/ac516f30/attachment.html
From Chris.Barker at noaa.gov  Tue Nov  3 12:25:29 2009
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Tue Nov  3 12:23:51 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected	data..Major
	confusion and help requested.
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF809B1A0FB@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
	<4AEF5403.4080701@xpam.de>
	<1D5F4E64B8C04F4C868B94AC9A532AF809B1A0FB@ATLMAIL01.corp.weather.com>
Message-ID: <4AF06789.5090801@noaa.gov>

Cassanova, Bill wrote:
> My question is how does this convert to pixel location FROM 
> the data set and then INTO the image.

Each pixel center is at a given lat-long in each image, but with 
different projections, these are different. So you need to do:

pixel1 -> lat-long

lat-long -> meters_in_new_projection

meters_in_new_projection -> pixel2

This is going to take a bit of arithmetic.

However, a pixel in one image is not going to map exactly to one pixel 
in the other -- so you need to do some type of interpolation. nearest 
neighbor is easy, but not very pretty. Other methods are more complicated.

gdalwarp does all this for you, and does it well, so I'd either call out 
to the command line program (easiest), or look at the gdalwarp source 
code, and see if you can wrap it up in your app. No need to start from 
scratch.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From jmp at geosys.com  Tue Nov  3 13:28:18 2009
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Tue Nov  3 13:35:16 2009
Subject: [gdal-dev] Problem with OSR projection on "+init=IGNF:LAMBE +wktext"
Message-ID: <007601ca5cb3$6a7033c0$3f509b40$@com>

Hi,

 

                I'm using OSR (on GDAL 1.6.1) bindings in C# to project
points, and I have problem with the projection "+init=IGNF:LAMBE +wktext" to
"+init=IGNF:LAMB93"

At the first execution, I have one result and on all the others I have
another results. 

 

An exemple :

 

 

                SpatialReference _srin = null;

                SpatialReference _srout = null;

                CoordinateTransformation _ct = null;

 

                double[] x, y;

 

                _srin = new SpatialReference("");

                _srin.ImportFromProj4("+init=IGNF:LAMBE +wktext");

 

                _srout = new SpatialReference("");

                _srout.ImportFromProj4("+init=IGNF:LAMB93");

 

                _ct = new CoordinateTransformation(_srin, _srout);

 

                x = new double[] { 540000 };

                y = new double[] { 1820000 };

 

                _ct.TransformPoints(1, x, y, null);

 

                Console.WriteLine(x[0] + " - " + y[0]); 

                // Return : 586336,591390395 - 6254404,95793043

 

                x = new double[] { 540000 };

                y = new double[] { 1820000 };

 

                _ct.TransformPoints(1, x, y, null);

 

                Console.WriteLine(x[0] + " - " + y[0]);

                //Return : 586281,605619939 - 6254404,35662961

 

                _ct.Dispose();

                _srin.Dispose();

                _srout.Dispose();

 

Thanks for your Help.

 

Jean michel Pierret

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091103/faf45227/attachment.html
From donald.e.bitner at us.army.mil  Tue Nov  3 14:13:06 2009
From: donald.e.bitner at us.army.mil (dbitner)
Date: Tue Nov  3 14:13:10 2009
Subject: [Gdal-dev] Getting Single Band (grayscale) GeoTiff to pass through
	C# wrapper into bitmap (or othe manipulation of raster data)
Message-ID: <1257275586657-3940618.post@n2.nabble.com>


Hello, 
  I normally try to figure this out, but I've spent two days on it: 

I'm currently attempting to get the GeoTIFF raster information which is my
elevation data for a given dataset.  I'm basically attempting to use GDAL to
drape a bitmap over my GeoTIFF (which will generate a 3d geometry).  I can't
seem to pull in the GeoTIFF information through the C# GDAL wrapper
utilizing ReadRaster() method (which is utilized in the
GDALDatasetRasterIO.cs application). 

I'm using the same exact code to troubleshoot at the moment, and the
single-band grayscale TIF I'm pulling in is simply being clamped to all 255s
when I look at the buffer or I output to a bitmap.  OpenEV pulls and
displays the TIFF perfectly...I get the feeling this might be a little more
complicated than I'm hoping... 


Input file info: 
Driver: GTiff/GeoTIFF 
Files: d:\test\test_tif.tif 
Size is 1024, 1024 
Coordinate System is: 
GEOGCS["WGS 84", 
    DATUM["WGS_1984", 
        SPHEROID["WGS 84",6378137,298.257223563, 
            AUTHORITY["EPSG","7030"]], 
        AUTHORITY["EPSG","6326"]], 
    PRIMEM["Greenwich",0], 
    UNIT["degree",0.0174532925199433], 
    AUTHORITY["EPSG","4326"]] 
Origin = (-105.000000000000000,39.000000000000000) 
Pixel Size = (0.000976562500000,-0.000976562500000) 
Metadata: 
  AREA_OR_POINT=Point 
Image Structure Metadata: 
  INTERLEAVE=BAND 
Corner Coordinates: 
Upper Left  (-105.0000000,  39.0000000) (105d 0'0.00"W, 39d 0'0.00"N) 
Lower Left  (-105.0000000,  38.0000000) (105d 0'0.00"W, 38d 0'0.00"N) 
Upper Right (-104.0000000,  39.0000000) (104d 0'0.00"W, 39d 0'0.00"N) 
Lower Right (-104.0000000,  38.0000000) (104d 0'0.00"W, 38d 0'0.00"N) 
Center      (-104.5000000,  38.5000000) (104d30'0.00"W, 38d30'0.00"N) 
Band 1 Block=1024x2 Type=Float32, ColorInterp=Gray 

output file info: 
C:\Program Files\FWTools2.4.6\bin>gdalinfo d:\test\out_test.bmp 
Driver: PNG/Portable Network Graphics 
Files: d:\test\out_test.bmp 
Size is 1024, 1024 
Coordinate System is `' 
Corner Coordinates: 
Upper Left  (    0.0,    0.0) 
Lower Left  (    0.0, 1024.0) 
Upper Right ( 1024.0,    0.0) 
Lower Right ( 1024.0, 1024.0) 
Center      (  512.0,  512.0) 
Band 1 Block=1024x1 Type=Byte, ColorInterp=Palette 
  Color Table (RGB with 256 entries) 
    0: 0,0,0,255 
    1: 1,1,1,255 
    2: 2,2,2,255 
    3: 3,3,3,255 
    4: 4,4,4,255 
    5: 5,5,5,255 
    6: 6,6,6,255 
    7: 7,7,7,255 
    8: 8,8,8,255 
    9: 9,9,9,255 
   10: 10,10,10,255 
   11: 11,11,11,255 
   12: 12,12,12,255 
   13: 13,13,13,255 
   14: 14,14,14,255 
   15: 15,15,15,255 
   16: 16,16,16,255 
   17: 17,17,17,255 
   18: 18,18,18,255 
   19: 19,19,19,255 
   20: 20,20,20,255 
   21: 21,21,21,255 
   22: 22,22,22,255 
   23: 23,23,23,255 
   24: 24,24,24,255 
   25: 25,25,25,255 
   26: 26,26,26,255 
   27: 27,27,27,255 
   28: 28,28,28,255 
   29: 29,29,29,255 
   30: 30,30,30,255 
   31: 31,31,31,255 
   32: 32,32,32,255 
   33: 33,33,33,255 
   34: 34,34,34,255 
   35: 35,35,35,255 
   36: 36,36,36,255 
   37: 37,37,37,255 
   38: 38,38,38,255 
   39: 39,39,39,255 
   40: 40,40,40,255 
   41: 41,41,41,255 
   42: 42,42,42,255 
   43: 43,43,43,255 
   44: 44,44,44,255 
   45: 45,45,45,255 
   46: 46,46,46,255 
   47: 47,47,47,255 
   48: 48,48,48,255 
   49: 49,49,49,255 
   50: 50,50,50,255 
   51: 51,51,51,255 
   52: 52,52,52,255 
   53: 53,53,53,255 
   54: 54,54,54,255 
   55: 55,55,55,255 
   56: 56,56,56,255 
   57: 57,57,57,255 
   58: 58,58,58,255 
   59: 59,59,59,255 
   60: 60,60,60,255 
   61: 61,61,61,255 
   62: 62,62,62,255 
   63: 63,63,63,255 
   64: 64,64,64,255 
   65: 65,65,65,255 
   66: 66,66,66,255 
   67: 67,67,67,255 
   68: 68,68,68,255 
   69: 69,69,69,255 
   70: 70,70,70,255 
   71: 71,71,71,255 
   72: 72,72,72,255 
   73: 73,73,73,255 
   74: 74,74,74,255 
   75: 75,75,75,255 
   76: 76,76,76,255 
   77: 77,77,77,255 
   78: 78,78,78,255 
   79: 79,79,79,255 
   80: 80,80,80,255 
   81: 81,81,81,255 
   82: 82,82,82,255 
   83: 83,83,83,255 
   84: 84,84,84,255 
   85: 85,85,85,255 
   86: 86,86,86,255 
   87: 87,87,87,255 
   88: 88,88,88,255 
   89: 89,89,89,255 
   90: 90,90,90,255 
   91: 91,91,91,255 
   92: 92,92,92,255 
   93: 93,93,93,255 
   94: 94,94,94,255 
   95: 95,95,95,255 
   96: 96,96,96,255 
   97: 97,97,97,255 
   98: 98,98,98,255 
   99: 99,99,99,255 
  100: 100,100,100,255 
  101: 101,101,101,255 
  102: 102,102,102,255 
  103: 103,103,103,255 
  104: 104,104,104,255 
  105: 105,105,105,255 
  106: 106,106,106,255 
  107: 107,107,107,255 
  108: 108,108,108,255 
  109: 109,109,109,255 
  110: 110,110,110,255 
  111: 111,111,111,255 
  112: 112,112,112,255 
  113: 113,113,113,255 
  114: 114,114,114,255 
  115: 115,115,115,255 
  116: 116,116,116,255 
  117: 117,117,117,255 
  118: 118,118,118,255 
  119: 119,119,119,255 
  120: 120,120,120,255 
  121: 121,121,121,255 
  122: 122,122,122,255 
  123: 123,123,123,255 
  124: 124,124,124,255 
  125: 125,125,125,255 
  126: 126,126,126,255 
  127: 127,127,127,255 
  128: 128,128,128,255 
  129: 129,129,129,255 
  130: 130,130,130,255 
  131: 131,131,131,255 
  132: 132,132,132,255 
  133: 133,133,133,255 
  134: 134,134,134,255 
  135: 135,135,135,255 
  136: 136,136,136,255 
  137: 137,137,137,255 
  138: 138,138,138,255 
  139: 139,139,139,255 
  140: 140,140,140,255 
  141: 141,141,141,255 
  142: 142,142,142,255 
  143: 143,143,143,255 
  144: 144,144,144,255 
  145: 145,145,145,255 
  146: 146,146,146,255 
  147: 147,147,147,255 
  148: 148,148,148,255 
  149: 149,149,149,255 
  150: 150,150,150,255 
  151: 151,151,151,255 
  152: 152,152,152,255 
  153: 153,153,153,255 
  154: 154,154,154,255 
  155: 155,155,155,255 
  156: 156,156,156,255 
  157: 157,157,157,255 
  158: 158,158,158,255 
  159: 159,159,159,255 
  160: 160,160,160,255 
  161: 161,161,161,255 
  162: 162,162,162,255 
  163: 163,163,163,255 
  164: 164,164,164,255 
  165: 165,165,165,255 
  166: 166,166,166,255 
  167: 167,167,167,255 
  168: 168,168,168,255 
  169: 169,169,169,255 
  170: 170,170,170,255 
  171: 171,171,171,255 
  172: 172,172,172,255 
  173: 173,173,173,255 
  174: 174,174,174,255 
  175: 175,175,175,255 
  176: 176,176,176,255 
  177: 177,177,177,255 
  178: 178,178,178,255 
  179: 179,179,179,255 
  180: 180,180,180,255 
  181: 181,181,181,255 
  182: 182,182,182,255 
  183: 183,183,183,255 
  184: 184,184,184,255 
  185: 185,185,185,255 
  186: 186,186,186,255 
  187: 187,187,187,255 
  188: 188,188,188,255 
  189: 189,189,189,255 
  190: 190,190,190,255 
  191: 191,191,191,255 
  192: 192,192,192,255 
  193: 193,193,193,255 
  194: 194,194,194,255 
  195: 195,195,195,255 
  196: 196,196,196,255 
  197: 197,197,197,255 
  198: 198,198,198,255 
  199: 199,199,199,255 
  200: 200,200,200,255 
  201: 201,201,201,255 
  202: 202,202,202,255 
  203: 203,203,203,255 
  204: 204,204,204,255 
  205: 205,205,205,255 
  206: 206,206,206,255 
  207: 207,207,207,255 
  208: 208,208,208,255 
  209: 209,209,209,255 
  210: 210,210,210,255 
  211: 211,211,211,255 
  212: 212,212,212,255 
  213: 213,213,213,255 
  214: 214,214,214,255 
  215: 215,215,215,255 
  216: 216,216,216,255 
  217: 217,217,217,255 
  218: 218,218,218,255 
  219: 219,219,219,255 
  220: 220,220,220,255 
  221: 221,221,221,255 
  222: 222,222,222,255 
  223: 223,223,223,255 
  224: 224,224,224,255 
  225: 225,225,225,255 
  226: 226,226,226,255 
  227: 227,227,227,255 
  228: 228,228,228,255 
  229: 229,229,229,255 
  230: 230,230,230,255 
  231: 231,231,231,255 
  232: 232,232,232,255 
  233: 233,233,233,255 
  234: 234,234,234,255 
  235: 235,235,235,255 
  236: 236,236,236,255 
  237: 237,237,237,255 
  238: 238,238,238,255 
  239: 239,239,239,255 
  240: 240,240,240,255 
  241: 241,241,241,255 
  242: 242,242,242,255 
  243: 243,243,243,255 
  244: 244,244,244,255 
  245: 245,245,245,255 
  246: 246,246,246,255 
  247: 247,247,247,255 
  248: 248,248,248,255 
  249: 249,249,249,255 
  250: 250,250,250,255 
  251: 251,251,251,255 
  252: 252,252,252,255 
  253: 253,253,253,255 
  254: 254,254,254,255 
  255: 255,255,255,255 


Is there not an easy way to get these GeoTIFFs out through the C# wrapper? 
It would be infinitely easier for me to keep everything into C#, but I'm
getting the feeling I'm going to have to modify the wrapper.  That said, if
I knew I was getting the correct data from my buffer from readraster() I can
certainly forgo saving it as a bitmap.  However, getting all 255s is not my
idea of an accurate depiction. 

Let me know if you need anymore information. 

-- 
View this message in context: http://n2.nabble.com/Getting-Single-Band-grayscale-GeoTiff-to-pass-through-C-wrapper-into-bitmap-or-othe-manipulation-of--tp3940618p3940618.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From szekerest at gmail.com  Tue Nov  3 14:33:42 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue Nov  3 14:33:45 2009
Subject: [Gdal-dev] Getting Single Band (grayscale) GeoTiff to pass 
	through C# wrapper into bitmap (or othe manipulation of raster data)
In-Reply-To: <1257275586657-3940618.post@n2.nabble.com>
References: <1257275586657-3940618.post@n2.nabble.com>
Message-ID: <f3b73b7d0911031133h36fe7137sfc6211834bd2b4be@mail.gmail.com>

Since you have a single band image the GDALRead.cs would be a better
example how to do this
(http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALRead.cs)

However all the examples out there use byte data type, and you might
have to modify the examples to pass an array of floats instead of
bytes, something like:

Band band = ds.GetRasterBand(1);
float[] data = new float[width * height];
band.ReadRaster(0, 0, width, height, data, width, height, 0, 0);


Best regards,

Tamas



2009/11/3 dbitner <donald.e.bitner@us.army.mil>:
>
> Hello,
> ?I normally try to figure this out, but I've spent two days on it:
>
> I'm currently attempting to get the GeoTIFF raster information which is my
> elevation data for a given dataset. ?I'm basically attempting to use GDAL to
> drape a bitmap over my GeoTIFF (which will generate a 3d geometry). ?I can't
> seem to pull in the GeoTIFF information through the C# GDAL wrapper
> utilizing ReadRaster() method (which is utilized in the
> GDALDatasetRasterIO.cs application).
>
> I'm using the same exact code to troubleshoot at the moment, and the
> single-band grayscale TIF I'm pulling in is simply being clamped to all 255s
> when I look at the buffer or I output to a bitmap. ?OpenEV pulls and
> displays the TIFF perfectly...I get the feeling this might be a little more
> complicated than I'm hoping...
>
>
> Input file info:
> Driver: GTiff/GeoTIFF
> Files: d:\test\test_tif.tif
> Size is 1024, 1024
> Coordinate System is:
> GEOGCS["WGS 84",
> ? ?DATUM["WGS_1984",
> ? ? ? ?SPHEROID["WGS 84",6378137,298.257223563,
> ? ? ? ? ? ?AUTHORITY["EPSG","7030"]],
> ? ? ? ?AUTHORITY["EPSG","6326"]],
> ? ?PRIMEM["Greenwich",0],
> ? ?UNIT["degree",0.0174532925199433],
> ? ?AUTHORITY["EPSG","4326"]]
> Origin = (-105.000000000000000,39.000000000000000)
> Pixel Size = (0.000976562500000,-0.000976562500000)
> Metadata:
> ?AREA_OR_POINT=Point
> Image Structure Metadata:
> ?INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left ?(-105.0000000, ?39.0000000) (105d 0'0.00"W, 39d 0'0.00"N)
> Lower Left ?(-105.0000000, ?38.0000000) (105d 0'0.00"W, 38d 0'0.00"N)
> Upper Right (-104.0000000, ?39.0000000) (104d 0'0.00"W, 39d 0'0.00"N)
> Lower Right (-104.0000000, ?38.0000000) (104d 0'0.00"W, 38d 0'0.00"N)
> Center ? ? ?(-104.5000000, ?38.5000000) (104d30'0.00"W, 38d30'0.00"N)
> Band 1 Block=1024x2 Type=Float32, ColorInterp=Gray
>
> output file info:
> C:\Program Files\FWTools2.4.6\bin>gdalinfo d:\test\out_test.bmp
> Driver: PNG/Portable Network Graphics
> Files: d:\test\out_test.bmp
> Size is 1024, 1024
> Coordinate System is `'
> Corner Coordinates:
> Upper Left ?( ? ?0.0, ? ?0.0)
> Lower Left ?( ? ?0.0, 1024.0)
> Upper Right ( 1024.0, ? ?0.0)
> Lower Right ( 1024.0, 1024.0)
> Center ? ? ?( ?512.0, ?512.0)
> Band 1 Block=1024x1 Type=Byte, ColorInterp=Palette
> ?Color Table (RGB with 256 entries)
> ? ?0: 0,0,0,255
> ? ?1: 1,1,1,255
> ? ?2: 2,2,2,255
> ? ?3: 3,3,3,255
> ? ?4: 4,4,4,255
> ? ?5: 5,5,5,255
> ? ?6: 6,6,6,255
> ? ?7: 7,7,7,255
> ? ?8: 8,8,8,255
> ? ?9: 9,9,9,255
> ? 10: 10,10,10,255
> ? 11: 11,11,11,255
> ? 12: 12,12,12,255
> ? 13: 13,13,13,255
> ? 14: 14,14,14,255
> ? 15: 15,15,15,255
> ? 16: 16,16,16,255
> ? 17: 17,17,17,255
> ? 18: 18,18,18,255
> ? 19: 19,19,19,255
> ? 20: 20,20,20,255
> ? 21: 21,21,21,255
> ? 22: 22,22,22,255
> ? 23: 23,23,23,255
> ? 24: 24,24,24,255
> ? 25: 25,25,25,255
> ? 26: 26,26,26,255
> ? 27: 27,27,27,255
> ? 28: 28,28,28,255
> ? 29: 29,29,29,255
> ? 30: 30,30,30,255
> ? 31: 31,31,31,255
> ? 32: 32,32,32,255
> ? 33: 33,33,33,255
> ? 34: 34,34,34,255
> ? 35: 35,35,35,255
> ? 36: 36,36,36,255
> ? 37: 37,37,37,255
> ? 38: 38,38,38,255
> ? 39: 39,39,39,255
> ? 40: 40,40,40,255
> ? 41: 41,41,41,255
> ? 42: 42,42,42,255
> ? 43: 43,43,43,255
> ? 44: 44,44,44,255
> ? 45: 45,45,45,255
> ? 46: 46,46,46,255
> ? 47: 47,47,47,255
> ? 48: 48,48,48,255
> ? 49: 49,49,49,255
> ? 50: 50,50,50,255
> ? 51: 51,51,51,255
> ? 52: 52,52,52,255
> ? 53: 53,53,53,255
> ? 54: 54,54,54,255
> ? 55: 55,55,55,255
> ? 56: 56,56,56,255
> ? 57: 57,57,57,255
> ? 58: 58,58,58,255
> ? 59: 59,59,59,255
> ? 60: 60,60,60,255
> ? 61: 61,61,61,255
> ? 62: 62,62,62,255
> ? 63: 63,63,63,255
> ? 64: 64,64,64,255
> ? 65: 65,65,65,255
> ? 66: 66,66,66,255
> ? 67: 67,67,67,255
> ? 68: 68,68,68,255
> ? 69: 69,69,69,255
> ? 70: 70,70,70,255
> ? 71: 71,71,71,255
> ? 72: 72,72,72,255
> ? 73: 73,73,73,255
> ? 74: 74,74,74,255
> ? 75: 75,75,75,255
> ? 76: 76,76,76,255
> ? 77: 77,77,77,255
> ? 78: 78,78,78,255
> ? 79: 79,79,79,255
> ? 80: 80,80,80,255
> ? 81: 81,81,81,255
> ? 82: 82,82,82,255
> ? 83: 83,83,83,255
> ? 84: 84,84,84,255
> ? 85: 85,85,85,255
> ? 86: 86,86,86,255
> ? 87: 87,87,87,255
> ? 88: 88,88,88,255
> ? 89: 89,89,89,255
> ? 90: 90,90,90,255
> ? 91: 91,91,91,255
> ? 92: 92,92,92,255
> ? 93: 93,93,93,255
> ? 94: 94,94,94,255
> ? 95: 95,95,95,255
> ? 96: 96,96,96,255
> ? 97: 97,97,97,255
> ? 98: 98,98,98,255
> ? 99: 99,99,99,255
> ?100: 100,100,100,255
> ?101: 101,101,101,255
> ?102: 102,102,102,255
> ?103: 103,103,103,255
> ?104: 104,104,104,255
> ?105: 105,105,105,255
> ?106: 106,106,106,255
> ?107: 107,107,107,255
> ?108: 108,108,108,255
> ?109: 109,109,109,255
> ?110: 110,110,110,255
> ?111: 111,111,111,255
> ?112: 112,112,112,255
> ?113: 113,113,113,255
> ?114: 114,114,114,255
> ?115: 115,115,115,255
> ?116: 116,116,116,255
> ?117: 117,117,117,255
> ?118: 118,118,118,255
> ?119: 119,119,119,255
> ?120: 120,120,120,255
> ?121: 121,121,121,255
> ?122: 122,122,122,255
> ?123: 123,123,123,255
> ?124: 124,124,124,255
> ?125: 125,125,125,255
> ?126: 126,126,126,255
> ?127: 127,127,127,255
> ?128: 128,128,128,255
> ?129: 129,129,129,255
> ?130: 130,130,130,255
> ?131: 131,131,131,255
> ?132: 132,132,132,255
> ?133: 133,133,133,255
> ?134: 134,134,134,255
> ?135: 135,135,135,255
> ?136: 136,136,136,255
> ?137: 137,137,137,255
> ?138: 138,138,138,255
> ?139: 139,139,139,255
> ?140: 140,140,140,255
> ?141: 141,141,141,255
> ?142: 142,142,142,255
> ?143: 143,143,143,255
> ?144: 144,144,144,255
> ?145: 145,145,145,255
> ?146: 146,146,146,255
> ?147: 147,147,147,255
> ?148: 148,148,148,255
> ?149: 149,149,149,255
> ?150: 150,150,150,255
> ?151: 151,151,151,255
> ?152: 152,152,152,255
> ?153: 153,153,153,255
> ?154: 154,154,154,255
> ?155: 155,155,155,255
> ?156: 156,156,156,255
> ?157: 157,157,157,255
> ?158: 158,158,158,255
> ?159: 159,159,159,255
> ?160: 160,160,160,255
> ?161: 161,161,161,255
> ?162: 162,162,162,255
> ?163: 163,163,163,255
> ?164: 164,164,164,255
> ?165: 165,165,165,255
> ?166: 166,166,166,255
> ?167: 167,167,167,255
> ?168: 168,168,168,255
> ?169: 169,169,169,255
> ?170: 170,170,170,255
> ?171: 171,171,171,255
> ?172: 172,172,172,255
> ?173: 173,173,173,255
> ?174: 174,174,174,255
> ?175: 175,175,175,255
> ?176: 176,176,176,255
> ?177: 177,177,177,255
> ?178: 178,178,178,255
> ?179: 179,179,179,255
> ?180: 180,180,180,255
> ?181: 181,181,181,255
> ?182: 182,182,182,255
> ?183: 183,183,183,255
> ?184: 184,184,184,255
> ?185: 185,185,185,255
> ?186: 186,186,186,255
> ?187: 187,187,187,255
> ?188: 188,188,188,255
> ?189: 189,189,189,255
> ?190: 190,190,190,255
> ?191: 191,191,191,255
> ?192: 192,192,192,255
> ?193: 193,193,193,255
> ?194: 194,194,194,255
> ?195: 195,195,195,255
> ?196: 196,196,196,255
> ?197: 197,197,197,255
> ?198: 198,198,198,255
> ?199: 199,199,199,255
> ?200: 200,200,200,255
> ?201: 201,201,201,255
> ?202: 202,202,202,255
> ?203: 203,203,203,255
> ?204: 204,204,204,255
> ?205: 205,205,205,255
> ?206: 206,206,206,255
> ?207: 207,207,207,255
> ?208: 208,208,208,255
> ?209: 209,209,209,255
> ?210: 210,210,210,255
> ?211: 211,211,211,255
> ?212: 212,212,212,255
> ?213: 213,213,213,255
> ?214: 214,214,214,255
> ?215: 215,215,215,255
> ?216: 216,216,216,255
> ?217: 217,217,217,255
> ?218: 218,218,218,255
> ?219: 219,219,219,255
> ?220: 220,220,220,255
> ?221: 221,221,221,255
> ?222: 222,222,222,255
> ?223: 223,223,223,255
> ?224: 224,224,224,255
> ?225: 225,225,225,255
> ?226: 226,226,226,255
> ?227: 227,227,227,255
> ?228: 228,228,228,255
> ?229: 229,229,229,255
> ?230: 230,230,230,255
> ?231: 231,231,231,255
> ?232: 232,232,232,255
> ?233: 233,233,233,255
> ?234: 234,234,234,255
> ?235: 235,235,235,255
> ?236: 236,236,236,255
> ?237: 237,237,237,255
> ?238: 238,238,238,255
> ?239: 239,239,239,255
> ?240: 240,240,240,255
> ?241: 241,241,241,255
> ?242: 242,242,242,255
> ?243: 243,243,243,255
> ?244: 244,244,244,255
> ?245: 245,245,245,255
> ?246: 246,246,246,255
> ?247: 247,247,247,255
> ?248: 248,248,248,255
> ?249: 249,249,249,255
> ?250: 250,250,250,255
> ?251: 251,251,251,255
> ?252: 252,252,252,255
> ?253: 253,253,253,255
> ?254: 254,254,254,255
> ?255: 255,255,255,255
>
>
> Is there not an easy way to get these GeoTIFFs out through the C# wrapper?
> It would be infinitely easier for me to keep everything into C#, but I'm
> getting the feeling I'm going to have to modify the wrapper. ?That said, if
> I knew I was getting the correct data from my buffer from readraster() I can
> certainly forgo saving it as a bitmap. ?However, getting all 255s is not my
> idea of an accurate depiction.
>
> Let me know if you need anymore information.
>
> --
> View this message in context: http://n2.nabble.com/Getting-Single-Band-grayscale-GeoTiff-to-pass-through-C-wrapper-into-bitmap-or-othe-manipulation-of--tp3940618p3940618.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From donald.e.bitner at us.army.mil  Tue Nov  3 16:51:14 2009
From: donald.e.bitner at us.army.mil (dbitner)
Date: Tue Nov  3 16:51:16 2009
Subject: [Gdal-dev] Getting Single Band (grayscale) GeoTiff to pass
	through C# wrapper into bitmap (or othe manipulation of raster data)
In-Reply-To: <f3b73b7d0911031133h36fe7137sfc6211834bd2b4be@mail.gmail.com>
References: <1257275586657-3940618.post@n2.nabble.com>
	<f3b73b7d0911031133h36fe7137sfc6211834bd2b4be@mail.gmail.com>
Message-ID: <1257285074496-3941529.post@n2.nabble.com>


That was insanely easy, I feel like a total idiot...I seriously contemplated
going the 1 for 1 route, but decided that I wasn't getting the correct data
into my buffer.  I guess I wasn't fiddling with the correct datatype (which
I thought I did try to force it to float).

To get the bitmap image I did have to scale the floats to be RGB compliant
(0 to 255).  Is this a correct way to display an elevation geotiff??  Also,
are there any plans in utilizing a raster image (IE this geotiff I have) as
a DEM in OGR, specifically for C#?


This library is a lifesaver fyi...Thanks!




Tamas Szekeres wrote:
> 
> Since you have a single band image the GDALRead.cs would be a better
> example how to do this
> (http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALRead.cs)
> 
> However all the examples out there use byte data type, and you might
> have to modify the examples to pass an array of floats instead of
> bytes, something like:
> 
> Band band = ds.GetRasterBand(1);
> float[] data = new float[width * height];
> band.ReadRaster(0, 0, width, height, data, width, height, 0, 0);
> 
> 
> Best regards,
> 
> Tamas
> 
> 
> <snip>
> 

-- 
View this message in context: http://n2.nabble.com/Getting-Single-Band-grayscale-GeoTiff-to-pass-through-C-wrapper-into-bitmap-or-othe-manipulation-of--tp3940618p3941529.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From ivan.lucena at pmldnet.com  Tue Nov  3 16:57:39 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Tue Nov  3 16:57:41 2009
Subject: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
Message-ID: <20091103215739.14549.qmail@s466.sureserver.com>

Hi,

Does anybody know how to write a FloatBuffer, IntBuffer or ShotBuffer using the Java API?

Thanks,

Ivan
From even.rouault at mines-paris.org  Tue Nov  3 17:18:37 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Nov  3 17:18:39 2009
Subject: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
In-Reply-To: <20091103215739.14549.qmail@s466.sureserver.com>
References: <20091103215739.14549.qmail@s466.sureserver.com>
Message-ID: <1257286717.4af0ac3d0c112@imp.free.fr>

Selon Ivan <ivan.lucena@pmldnet.com>:

The Java API only uses ByteBuffer. But you can use the asDoubleBuffer(),
asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create views of the
byte buffer as double, float, int or short buffer.

For example :

ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize * buf_ysize);
band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
gdal.GDT_Float64, byteBuffer);
DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();

> Hi,
>
> Does anybody know how to write a FloatBuffer, IntBuffer or ShotBuffer using
> the Java API?
>
> Thanks,
>
> Ivan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From szekerest at gmail.com  Tue Nov  3 17:19:27 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue Nov  3 17:19:30 2009
Subject: [Gdal-dev] Getting Single Band (grayscale) GeoTiff to pass 
	through C# wrapper into bitmap (or othe manipulation of raster data)
In-Reply-To: <1257285074496-3941529.post@n2.nabble.com>
References: <1257275586657-3940618.post@n2.nabble.com>
	<f3b73b7d0911031133h36fe7137sfc6211834bd2b4be@mail.gmail.com>
	<1257285074496-3941529.post@n2.nabble.com>
Message-ID: <f3b73b7d0911031419n4183d036g3f6a26c0a10d17bf@mail.gmail.com>

2009/11/3 dbitner <donald.e.bitner@us.army.mil>:
>
> That was insanely easy, I feel like a total idiot...I seriously contemplated
> going the 1 for 1 route, but decided that I wasn't getting the correct data
> into my buffer. ?I guess I wasn't fiddling with the correct datatype (which
> I thought I did try to force it to float).
>
> To get the bitmap image I did have to scale the floats to be RGB compliant
> (0 to 255). ?Is this a correct way to display an elevation geotiff?? ?Also,
> are there any plans in utilizing a raster image (IE this geotiff I have) as
> a DEM in OGR, specifically for C#?
>

You might want to convert your data into a coloured RGB raster for
displaying purposes. As an option you could wrap your data within a
GDAL VRT (virtual) data source (by defining the bands as
ComplexSource-s) and apply a LUT for each band for scaling the data.
For more information see: http://www.gdal.org/gdal_vrttut.html

Alternatively you could also do the same suff with C# in a pixel-to-pixel basis.


I'm not totally sure what you mean by utilizing your raster image in
OGR, could you clarify this?


Best regards,

Tamas
From ivan.lucena at pmldnet.com  Tue Nov  3 19:00:47 2009
From: ivan.lucena at pmldnet.com (Ivan)
Date: Tue Nov  3 19:00:49 2009
Subject: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
In-Reply-To: <1257286717.4af0ac3d0c112@imp.free.fr>
References: <20091103215739.14549.qmail@s466.sureserver.com>
	<1257286717.4af0ac3d0c112@imp.free.fr>
Message-ID: <4AF0C42F.6010702@pmldnet.com>

Hi Even,

D'accord. I am already using this technique for reading and it seams to be working correctly.

But I am not sure that I am doing the right thing when writing. See, if I have that buffer:

{{{
    ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
    FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();

    band.WriteRaster_Direct(0, row, xsize, 1, (4 * xsize), 1, gdal.GDT_Float32, byteBuffer);
}}}

I got the wrong impression that the wrapper is taking "byteBuffer" to the C API as it is, byte, not 
as a Float32. Therefore it is wrongly converting every byte to float, one by one. Note that "band" 
was created as Float32. But I might be wrong.

I will keep trying.

Thanks,

Ivan

Even Rouault wrote:
> Selon Ivan <ivan.lucena@pmldnet.com>:
> 
> The Java API only uses ByteBuffer. But you can use the asDoubleBuffer(),
> asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create views of the
> byte buffer as double, float, int or short buffer.
> 
> For example :
> 
> ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize * buf_ysize);
> band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
> gdal.GDT_Float64, byteBuffer);
> DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();
> 
>> Hi,
>>
>> Does anybody know how to write a FloatBuffer, IntBuffer or ShotBuffer using
>> the Java API?
>>
>> Thanks,
>>
>> Ivan
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> 
> 

From Chris.Barker at noaa.gov  Tue Nov  3 19:07:07 2009
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Tue Nov  3 19:05:28 2009
Subject: [gdal-dev] Building a Mercator Image from Un-projected
	data..Majorconfusion and help requested.
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80BA48FCF@ATLMAIL01.corp.weather.com>
References: <1D5F4E64B8C04F4C868B94AC9A532AF80B999E6E@ATLMAIL01.corp.weather.com>
	<4AEF5403.4080701@xpam.de>
	<1D5F4E64B8C04F4C868B94AC9A532AF809B1A0FB@ATLMAIL01.corp.weather.com>
	<4AF06789.5090801@noaa.gov>
	<1D5F4E64B8C04F4C868B94AC9A532AF80BA48FCF@ATLMAIL01.corp.weather.com>
Message-ID: <4AF0C5AB.3020900@noaa.gov>

Cassanova, Bill wrote:
> Thank you for your response.

> Your email motivated me to try something.  Not sure it's quite right but
> it does seem closer:

It looks right at a quick glance, but note that you are essentially 
re-writing gdalwarp -- is that code too opaque to make use of?

> I ran the gdalwarp process on an unprojected image and as far as I can
> tell the image produced by this code and the image produced from that
> code are exactly the same.

right -- by default, gdalwarp uses nearest neighbor interpolation, which 
is pretty much what you've done. You might try one of the other 
interpolation methods, and see if the results look nicer:

$ gdalwarp
Usage: gdalwarp [--help-general] [--formats]
     [-s_srs srs_def] [-t_srs srs_def] [-to "NAME=VALUE"]
     [-order n] [-tps] [-rpc] [-geoloc] [-et err_threshold]
     [-te xmin ymin xmax ymax] [-tr xres yres] [-ts width height]
     [-wo "NAME=VALUE"] [-ot Byte/Int16/...] [-wt Byte/Int16]
     [-srcnodata "value [value...]"] [-dstnodata "value [value...]"] 
-dstalpha
     [-r resampling_method] [-wm memory_in_mb] [-multi] [-q]
     [-cutline datasource] [-cl layer] [-cwhere expression]
     [-csql statement] [-cblend dist_in_pixels]
     [-of format] [-co "NAME=VALUE"]*
     srcfile* dstfile

Available resampling methods:
     near (default), bilinear, cubic, cubicspline, lanczos.


so you should be abel to do (untested):

gdalwarp -s_srs '+proj=merc' -r cubic 
hiradff_200910121800_f180_weather_wx.tiff
warped.tiff

It depends some on your image, but it could look quite a bit nicer.

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From rjoslyn at etg-sadi.com  Wed Nov  4 09:52:58 2009
From: rjoslyn at etg-sadi.com (Ray Joslyn)
Date: Wed Nov  4 09:53:31 2009
Subject: [gdal-dev] tile artifacts in YCBCR compressed JPEG in TIFF
Message-ID: <loom.20091104T155203-837@post.gmane.org>

Hello,
I have noticed tile artifacts that corespond to the tile sizes when 
compressing color images with the PHOTOMETRIC=YCBCR option for JPEG compressed 
Tiff images.  I do not see this if I use PHOTOMETRIC=RGB.  Are there any 
options that may prevent this?

Thanks
Ray



From warmerdam at pobox.com  Wed Nov  4 10:18:18 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov  4 10:18:28 2009
Subject: [gdal-dev] tile artifacts in YCBCR compressed JPEG in TIFF
In-Reply-To: <loom.20091104T155203-837@post.gmane.org>
References: <loom.20091104T155203-837@post.gmane.org>
Message-ID: <4AF19B3A.3030302@pobox.com>

Ray Joslyn wrote:
> Hello,
> I have noticed tile artifacts that corespond to the tile sizes when 
> compressing color images with the PHOTOMETRIC=YCBCR option for JPEG compressed 
> Tiff images.  I do not see this if I use PHOTOMETRIC=RGB.  Are there any 
> options that may prevent this?

Ray,

What is your tile size?  If it is a multiple of eight I don't see why there
would be any tile boundary issues.  Perhaps you could provide a visual sample
to show us what you mean.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ivan.lucena at pmldnet.com  Wed Nov  4 11:44:53 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Wed Nov  4 11:44:56 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gR0RBTC1KYXZhOiBIb3cgdG8gd3JpdGUgRmxvdDMyLCBJbnQxNj8=?=
Message-ID: <20091104164453.13570.qmail@s466.sureserver.com>

Even,

Thanks for you reply.

I wrote this piece of code to demonstrate what is happening:

{{{
public static void main(String[] args) {

	Dataset dataset = null;
	Driver driver = null;
	Band band = null;
	
	int xsize = 4;
	int ysize = 4;

	gdal.AllRegister();
	
	driver = gdal.GetDriverByName("GTIFF");
	dataset = driver.Create("D:\\temp\\checkit.tif", xsize, ysize, 1, gdalconstConstants.GDT_Float32);
	band = dataset.GetRasterBand(1);
	
	ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
	FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
	
	for( int i = 0; i < ysize; i++) {
		for( int j = 0; j < xsize; j++) {
			floatBuffer.put(j, (float) (i + j));		
		}
		band.WriteRaster_Direct(0, i, xsize, 1, gdalconstConstants.GDT_Float32, byteBuffer);
	}
	
	band.FlushCache();
	dataset.FlushCache();
	dataset.delete();

	System.out.println("Done!");
}
}}}

And that is the output image dumped in Python:

array([[  0.00000000e+00,   4.60060299e-41,   8.96831017e-44,  2.30485571e-41],
       [  4.60060299e-41,   8.96831017e-44,   2.30485571e-41,  4.60074312e-41],
       [  8.96831017e-44,   2.30485571e-41,   4.60074312e-41,  5.74868682e-41],
       [  2.30485571e-41,   4.60074312e-41,   5.74868682e-41,  6.89663052e-41]], dtype=float32))

If I change the code to produce Byte output:

{{{
public static void main(String[] args) {

	Dataset dataset = null;
	Driver driver = null;
	Band band = null;
	
	int xsize = 4;
	int ysize = 4;

	gdal.AllRegister();
	
	driver = gdal.GetDriverByName("GTIFF");
	dataset = driver.Create("D:\\temp\\checkit2.tif", xsize, ysize, 1, gdalconstConstants.GDT_Byte);
	band = dataset.GetRasterBand(1);
	
	ByteBuffer byteBuffer = ByteBuffer.allocateDirect(xsize);
	
	for( int i = 0; i < ysize; i++) {
		for( int j = 0; j < xsize; j++) {
			byteBuffer.put(j, (byte) (i + j));		
		}
		band.WriteRaster_Direct(0, i, xsize, 1, gdalconstConstants.GDT_Byte, byteBuffer);
	}
	
	band.FlushCache();
	dataset.FlushCache();
	dataset.delete();

	System.out.println("Done!");
}
}}}

That is what I got:

array([[0, 1, 2, 3],
       [1, 2, 3, 4],
       [2, 3, 4, 5],
       [3, 4, 5, 6]], dtype=uint8)

That is correct but I need Float32 output on my real application.

Can you see if I am missing something? 

When [1] says "It automatically takes care of data type translation if the data type" it means exactly like the others GDAL APIs?

My best regards,

Ivan

[1] http://gdal.org/java/org/gdal/gdal/Band.html#WriteRaster_Direct%28int,%20int,%20int,%20int,%20int,%20int,%20int,%20java.nio.ByteBuffer,%20int,%20int%29


>  -------Original Message-------
>  From: Even Rouault <even.rouault@mines-paris.org>
>  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
>  Sent: Nov 03 '09 17:18
>  
>  Selon Ivan <ivan.lucena@pmldnet.com>:
>  
>  The Java API only uses ByteBuffer. But you can use the asDoubleBuffer(),
>  asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create views of the
>  byte buffer as double, float, int or short buffer.
>  
>  For example :
>  
>  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize * buf_ysize);
>  band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
>  gdal.GDT_Float64, byteBuffer);
>  DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();
>  
>  > Hi,
>  >
>  > Does anybody know how to write a FloatBuffer, IntBuffer or ShotBuffer using
>  > the Java API?
>  >
>  > Thanks,
>  >
>  > Ivan
>  > _______________________________________________
>  > gdal-dev mailing list
>  > gdal-dev@lists.osgeo.org
>  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  >
>  
>  
>  
From simonf at simonf.com  Wed Nov  4 11:48:07 2009
From: simonf at simonf.com (Simon (Vsevolod) Ilyushchenko)
Date: Wed Nov  4 11:48:09 2009
Subject: [gdal-dev] gdal_rasterize problems
Message-ID: <8c23faa70911040848h1391c73bj6fdb2e07a8df78c8@mail.gmail.com>

Hi,

I'm trying to use gdal_rasterize to draw polygons, then draw their borders
in a different color, and can't figure out how to do it. Drawing a polyline
produces no output - and I don't see a way to specify the pixel width.
Drawing a polygon with a hole inside produces a black instead of a
transparent hole.  See http://www.simonf.com/test/blackhole.tif.

Thanks,
Simon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091104/5e2f971c/attachment.html
From bclay at ball.com  Wed Nov  4 12:25:13 2009
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov  4 12:25:23 2009
Subject: [gdal-dev] SQL results truncated
Message-ID: <C482FF98AE985A47B8C982FD429C9E34027EBDB0@daytonmsg2k3.AERO.BALL.COM>

It seems like I encountered this problem before but I can not find any
information about it now.

 

If I run a SQ script like the following

 

Select * from

 (Select MIN_LAT - (round((MIN_LAT - LATITUDE) / (MAX_LAT - MIN_LAT) *
1728.497600)) * 0.000579 LAT2,

         MAX_LON - (round((LONGITUDE - MAX_LON) / (MIN_LON - MAX_LON) *
1814.921600)) * 0.000551 LON2,

         Round(sum(TRACK_SIZE) / 1.000000) CONFIDENCE,

         max(B_TEMP) Intensity,

         min(TO_CHAR(DATE_TIME, 'MM-DD-YYYY HH24:MI:SS')) DATE_TIME 

    FROM

       WACDS.MODIS_ACTIVE_FIRE WHERE

          LATITUDE BETWEEN MIN_LAT AND MAX_LAT AND

          LONGITUDE BETWEEN MIN_LON AND MAX_LON AND

          DATE_TIME BETWEEN TO_DATE('03/01/2007 00:00:00' , 'MM-DD-YYYY
HH24:MI:SS') AND

                            TO_DATE('04/30/2007 23:59:59' , 'MM-DD-YYYY
HH24:MI:SS') AND

          CONFIDENCE > 1.000000

    GROUP BY

        round((MIN_LAT - LATITUDE) / (MAX_LAT - MIN_LAT) * 1728.497600),

        round((LONGITUDE - MAX_LON) / (MIN_LON - MAX_LON) *
1814.921600))

  where 

    (CONFIDENCE * 1.000000) > 1.000000

  ORDER BY DATE_TIME

 

From sqlPal I get LAT2 and LON2 data back as doubles

 

If I run it through OGR ExecuteSql the LAT2 and LON2 data comes back as
integers and can not be used to plot the data

 

OGRFieldDefn *fieldDef = featureDef->GetFieldDefn(fieldIndex);

if (fieldDef != NULL)

{

      fieldType = fieldDef->GetType();

}

 

Returns type integer

 

And both

 

 const char *latStr = (char *)feature->GetFieldAsString("LAT2");

 

  double latitude = feature->GetFieldAsDouble("LAT2");

 

 

return(only the whole portion of what I see in sqlPal.

 

 

Does anyone see / know what might be going wrong?

 

Bruce

 




This message and any enclosures are intended only for the addressee.  Please  
notify the sender by email if you are not the intended recipient.  If you are  
not the intended recipient, you may not use, copy, disclose, or distribute this  
message or its contents or enclosures to any other person and any such actions  
may be unlawful.  Ball reserves the right to monitor and review all messages  
and enclosures sent to or from this email address.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091104/777ad99a/attachment.html
From daniele.romagnoli at geo-solutions.it  Wed Nov  4 12:36:10 2009
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed Nov  4 12:36:18 2009
Subject: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
In-Reply-To: <20091104164453.13570.qmail@s466.sureserver.com>
References: <20091104164453.13570.qmail@s466.sureserver.com>
Message-ID: <7221db410911040936t27f58972maa5be7a478b9efb@mail.gmail.com>

Hi Ivan,

Try adding this:
byteBuffer.order(ByteOrder.nativeOrder());

after the allocateDirect and before the asFloatBuffer calls.

That is:
-------------------------------
ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
byteBuffer.order(ByteOrder.nativeOrder());
FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
-------------------------------

Let me know whether this does work.
Best Regards,
Daniele


On Wed, Nov 4, 2009 at 5:44 PM, Ivan <ivan.lucena@pmldnet.com> wrote:

> Even,
>
> Thanks for you reply.
>
> I wrote this piece of code to demonstrate what is happening:
>
> {{{
> public static void main(String[] args) {
>
>        Dataset dataset = null;
>        Driver driver = null;
>        Band band = null;
>
>        int xsize = 4;
>        int ysize = 4;
>
>        gdal.AllRegister();
>
>        driver = gdal.GetDriverByName("GTIFF");
>        dataset = driver.Create("D:\\temp\\checkit.tif", xsize, ysize, 1,
> gdalconstConstants.GDT_Float32);
>        band = dataset.GetRasterBand(1);
>
>        ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
>        FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
>
>         for( int i = 0; i < ysize; i++) {
>                for( int j = 0; j < xsize; j++) {
>                        floatBuffer.put(j, (float) (i + j));
>                }
>                band.WriteRaster_Direct(0, i, xsize, 1,
> gdalconstConstants.GDT_Float32, byteBuffer);
>        }
>
>        band.FlushCache();
>        dataset.FlushCache();
>        dataset.delete();
>
>        System.out.println("Done!");
> }
> }}}
>
> And that is the output image dumped in Python:
>
> array([[  0.00000000e+00,   4.60060299e-41,   8.96831017e-44,
>  2.30485571e-41],
>       [  4.60060299e-41,   8.96831017e-44,   2.30485571e-41,
>  4.60074312e-41],
>       [  8.96831017e-44,   2.30485571e-41,   4.60074312e-41,
>  5.74868682e-41],
>       [  2.30485571e-41,   4.60074312e-41,   5.74868682e-41,
>  6.89663052e-41]], dtype=float32))
>
> If I change the code to produce Byte output:
>
> {{{
> public static void main(String[] args) {
>
>        Dataset dataset = null;
>        Driver driver = null;
>        Band band = null;
>
>        int xsize = 4;
>        int ysize = 4;
>
>        gdal.AllRegister();
>
>        driver = gdal.GetDriverByName("GTIFF");
>        dataset = driver.Create("D:\\temp\\checkit2.tif", xsize, ysize, 1,
> gdalconstConstants.GDT_Byte);
>        band = dataset.GetRasterBand(1);
>
>        ByteBuffer byteBuffer = ByteBuffer.allocateDirect(xsize);
>
>        for( int i = 0; i < ysize; i++) {
>                for( int j = 0; j < xsize; j++) {
>                        byteBuffer.put(j, (byte) (i + j));
>                }
>                band.WriteRaster_Direct(0, i, xsize, 1,
> gdalconstConstants.GDT_Byte, byteBuffer);
>        }
>
>        band.FlushCache();
>        dataset.FlushCache();
>        dataset.delete();
>
>        System.out.println("Done!");
> }
> }}}
>
> That is what I got:
>
> array([[0, 1, 2, 3],
>       [1, 2, 3, 4],
>       [2, 3, 4, 5],
>       [3, 4, 5, 6]], dtype=uint8)
>
> That is correct but I need Float32 output on my real application.
>
> Can you see if I am missing something?
>
> When [1] says "It automatically takes care of data type translation if the
> data type" it means exactly like the others GDAL APIs?
>
> My best regards,
>
> Ivan
>
> [1]
> http://gdal.org/java/org/gdal/gdal/Band.html#WriteRaster_Direct%28int,%20int,%20int,%20int,%20int,%20int,%20int,%20java.nio.ByteBuffer,%20int,%20int%29
>
>
> >  -------Original Message-------
> >  From: Even Rouault <even.rouault@mines-paris.org>
> >  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
> >  Sent: Nov 03 '09 17:18
> >
> >  Selon Ivan <ivan.lucena@pmldnet.com>:
> >
> >  The Java API only uses ByteBuffer. But you can use the asDoubleBuffer(),
> >  asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create
> views of the
> >  byte buffer as double, float, int or short buffer.
> >
> >  For example :
> >
> >  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize *
> buf_ysize);
> >  band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
> >  gdal.GDT_Float64, byteBuffer);
> >  DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();
> >
> >  > Hi,
> >  >
> >  > Does anybody know how to write a FloatBuffer, IntBuffer or ShotBuffer
> using
> >  > the Java API?
> >  >
> >  > Thanks,
> >  >
> >  > Ivan
> >  > _______________________________________________
> >  > gdal-dev mailing list
> >  > gdal-dev@lists.osgeo.org
> >  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >  >
> >
> >
> >
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091104/f7d77a55/attachment-0001.html
From ivan.lucena at pmldnet.com  Wed Nov  4 13:58:50 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Wed Nov  4 13:58:53 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gR0RBTC1KYXZhOiBIb3cgdG8gd3JpdGUgRmxvdDMyLCBJbnQxNj8=?=
Message-ID: <20091104185850.2994.qmail@s466.sureserver.com>

Thanks Daniele. That takes care of the problem.


>  -------Original Message-------
>  From: Daniele Romagnoli <daniele.romagnoli@geo-solutions.it>
>  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
>  Sent: Nov 04 '09 12:36
>  
>  Hi Ivan,
>  
>  Try adding this:
>  byteBuffer.order(ByteOrder.nativeOrder());
>  
>  after the allocateDirect and before the asFloatBuffer calls.
>  
>  That is:
>  -------------------------------
>  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
>  byteBuffer.order(ByteOrder.nativeOrder());
>  FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
>  -------------------------------
>  
>  Let me know whether this does work.
>  Best Regards,
>  Daniele
>  
>  
>  On Wed, Nov 4, 2009 at 5:44 PM, Ivan <[LINK:
>  mailto:ivan.lucena@pmldnet.com] ivan.lucena@pmldnet.com> wrote:
>  Even,
>  
>  Thanks for you reply.
>  
>  I wrote this piece of code to demonstrate what is happening:
>  
>  {{{
>  public static void main(String[] args) {
>  
>         Dataset dataset = null;
>         Driver driver = null;
>         Band band = null;
>  
>         int xsize = 4;
>         int ysize = 4;
>  
>         gdal.AllRegister();
>  
>         driver = gdal.GetDriverByName("GTIFF");
>         dataset = driver.Create("D:\\temp\\checkit.tif", xsize,
>  ysize, 1, gdalconstConstants.GDT_Float32);
>         band = dataset.GetRasterBand(1);
>  
>  
>         ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
>         FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
>  
>         for( int i = 0; i < ysize; i++) {
>                 for( int j = 0; j < xsize; j++) {
>                         floatBuffer.put(j, (float) (i + j));
>                 }
>                 band.WriteRaster_Direct(0, i, xsize, 1,
>  gdalconstConstants.GDT_Float32, byteBuffer);
>         }
>  
>         band.FlushCache();
>         dataset.FlushCache();
>         dataset.delete();
>  
>         System.out.println("Done!");
>  }
>  }}}
>  
>  And that is the output image dumped in Python:
>  
>  array([[  0.00000000e+00,   4.60060299e-41,   8.96831017e-44,
>   2.30485571e-41],
>        [  4.60060299e-41,   8.96831017e-44,   2.30485571e-41,
>   4.60074312e-41],
>        [  8.96831017e-44,   2.30485571e-41,   4.60074312e-41,
>   5.74868682e-41],
>        [  2.30485571e-41,   4.60074312e-41,   5.74868682e-41,
>   6.89663052e-41]], dtype=float32))
>  
>  If I change the code to produce Byte output:
>  
>  {{{
>  public static void main(String[] args) {
>  
>         Dataset dataset = null;
>         Driver driver = null;
>         Band band = null;
>  
>         int xsize = 4;
>         int ysize = 4;
>  
>         gdal.AllRegister();
>  
>         driver = gdal.GetDriverByName("GTIFF");
>         dataset = driver.Create("D:\\temp\\checkit2.tif", xsize,
>  ysize, 1, gdalconstConstants.GDT_Byte);
>         band = dataset.GetRasterBand(1);
>  
>         ByteBuffer byteBuffer = ByteBuffer.allocateDirect(xsize);
>  
>         for( int i = 0; i < ysize; i++) {
>                 for( int j = 0; j < xsize; j++) {
>                         byteBuffer.put(j, (byte) (i + j));
>                 }
>                 band.WriteRaster_Direct(0, i, xsize, 1,
>  gdalconstConstants.GDT_Byte, byteBuffer);
>         }
>  
>         band.FlushCache();
>         dataset.FlushCache();
>         dataset.delete();
>  
>         System.out.println("Done!");
>  }
>  }}}
>  
>  That is what I got:
>  
>  array([[0, 1, 2, 3],
>        [1, 2, 3, 4],
>        [2, 3, 4, 5],
>        [3, 4, 5, 6]], dtype=uint8)
>  
>  That is correct but I need Float32 output on my real application.
>  
>  Can you see if I am missing something?
>  
>  When [1] says "It automatically takes care of data type translation if
>  the data type" it means exactly like the others GDAL APIs?
>  
>  My best regards,
>  
>  Ivan
>  
>  [1] [LINK: http://gdal.org/java/org/gdal/gdal/Band.html]
>  http://gdal.org/java/org/gdal/gdal/Band.html#WriteRaster_Direct%28int,%20int,%20int,%20int,%20int,%20int,%20int,%20java.nio.ByteBuffer,%20int,%20int%29
>  
>  
>  >  -------Original Message-------
>  >  From: Even Rouault <[LINK: mailto:even.rouault@mines-paris.org]
>  even.rouault@mines-paris.org>
>  >  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
>  >  Sent: Nov 03 '09 17:18
>  >
>  >  Selon Ivan <[LINK: mailto:ivan.lucena@pmldnet.com]
>  ivan.lucena@pmldnet.com>:
>  >
>  >  The Java API only uses ByteBuffer. But you can use the
>  asDoubleBuffer(),
>  >  asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create
>  views of the
>  >  byte buffer as double, float, int or short buffer.
>  >
>  >  For example :
>  >
>  >  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize *
>  buf_ysize);
>  >  band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
>  >  gdal.GDT_Float64, byteBuffer);
>  >  DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();
>  >
>  >  > Hi,
>  >  >
>  >  > Does anybody know how to write a FloatBuffer, IntBuffer or
>  ShotBuffer using
>  >  > the Java API?
>  >  >
>  >  > Thanks,
>  >  >
>  >  > Ivan
>  >  > _______________________________________________
>  >  > gdal-dev mailing list
>  >  > [LINK: mailto:gdal-dev@lists.osgeo.org] gdal-dev@lists.osgeo.org
>  >  > [LINK: http://lists.osgeo.org/mailman/listinfo/gdal-dev]
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  >  >
>  >
>  >
>  >
>  _______________________________________________
>  gdal-dev mailing list
>  [LINK: mailto:gdal-dev@lists.osgeo.org] gdal-dev@lists.osgeo.org
>  [LINK: http://lists.osgeo.org/mailman/listinfo/gdal-dev]
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
>  
>  --
>  -------------------------------------------------------
>  Eng. Daniele Romagnoli
>  Software Engineer
>  
>  GeoSolutions S.A.S.
>  Via Carignoni 51
>  55041 Camaiore (LU)
>  Italy
>  
>  phone: +39 0584983027
>  fax:     +39 0584983027
>  mob:   +39 328 0559267
>  
>  
>  [LINK: http://www.geo-solutions.it] http://www.geo-solutions.it
>  
>  -------------------------------------------------------
From even.rouault at mines-paris.org  Wed Nov  4 14:24:53 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Nov  4 14:24:56 2009
Subject: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
In-Reply-To: <20091104185850.2994.qmail@s466.sureserver.com>
References: <20091104185850.2994.qmail@s466.sureserver.com>
Message-ID: <1257362693.4af1d5056d165@imp.free.fr>

Selon Ivan <ivan.lucena@pmldnet.com>:

I realize I hadn't yet tested with multibyte data types.
I've improved the javadoc of the ReadRaster_Direct and WriteRaster_Direct
methods to mention the byte ordering issue.

> Thanks Daniele. That takes care of the problem.
>
>
> >  -------Original Message-------
> >  From: Daniele Romagnoli <daniele.romagnoli@geo-solutions.it>
> >  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
> >  Sent: Nov 04 '09 12:36
> >
> >  Hi Ivan,
> >
> >  Try adding this:
> >  byteBuffer.order(ByteOrder.nativeOrder());
> >
> >  after the allocateDirect and before the asFloatBuffer calls.
> >
> >  That is:
> >  -------------------------------
> >  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
> >  byteBuffer.order(ByteOrder.nativeOrder());
> >  FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
> >  -------------------------------
> >
> >  Let me know whether this does work.
> >  Best Regards,
> >  Daniele
> >
> >
> >  On Wed, Nov 4, 2009 at 5:44 PM, Ivan <[LINK:
> >  mailto:ivan.lucena@pmldnet.com] ivan.lucena@pmldnet.com> wrote:
> >  Even,
> >
> >  Thanks for you reply.
> >
> >  I wrote this piece of code to demonstrate what is happening:
> >
> >  {{{
> >  public static void main(String[] args) {
> >
> >         Dataset dataset = null;
> >         Driver driver = null;
> >         Band band = null;
> >
> >         int xsize = 4;
> >         int ysize = 4;
> >
> >         gdal.AllRegister();
> >
> >         driver = gdal.GetDriverByName("GTIFF");
> >         dataset = driver.Create("D:\\temp\\checkit.tif", xsize,
> >  ysize, 1, gdalconstConstants.GDT_Float32);
> >         band = dataset.GetRasterBand(1);
> >
> >
> >         ByteBuffer byteBuffer = ByteBuffer.allocateDirect(4 * xsize);
> >         FloatBuffer floatBuffer = byteBuffer.asFloatBuffer();
> >
> >         for( int i = 0; i < ysize; i++) {
> >                 for( int j = 0; j < xsize; j++) {
> >                         floatBuffer.put(j, (float) (i + j));
> >                 }
> >                 band.WriteRaster_Direct(0, i, xsize, 1,
> >  gdalconstConstants.GDT_Float32, byteBuffer);
> >         }
> >
> >         band.FlushCache();
> >         dataset.FlushCache();
> >         dataset.delete();
> >
> >         System.out.println("Done!");
> >  }
> >  }}}
> >
> >  And that is the output image dumped in Python:
> >
> >  array([[  0.00000000e+00,   4.60060299e-41,   8.96831017e-44,
> >   2.30485571e-41],
> >        [  4.60060299e-41,   8.96831017e-44,   2.30485571e-41,
> >   4.60074312e-41],
> >        [  8.96831017e-44,   2.30485571e-41,   4.60074312e-41,
> >   5.74868682e-41],
> >        [  2.30485571e-41,   4.60074312e-41,   5.74868682e-41,
> >   6.89663052e-41]], dtype=float32))
> >
> >  If I change the code to produce Byte output:
> >
> >  {{{
> >  public static void main(String[] args) {
> >
> >         Dataset dataset = null;
> >         Driver driver = null;
> >         Band band = null;
> >
> >         int xsize = 4;
> >         int ysize = 4;
> >
> >         gdal.AllRegister();
> >
> >         driver = gdal.GetDriverByName("GTIFF");
> >         dataset = driver.Create("D:\\temp\\checkit2.tif", xsize,
> >  ysize, 1, gdalconstConstants.GDT_Byte);
> >         band = dataset.GetRasterBand(1);
> >
> >         ByteBuffer byteBuffer = ByteBuffer.allocateDirect(xsize);
> >
> >         for( int i = 0; i < ysize; i++) {
> >                 for( int j = 0; j < xsize; j++) {
> >                         byteBuffer.put(j, (byte) (i + j));
> >                 }
> >                 band.WriteRaster_Direct(0, i, xsize, 1,
> >  gdalconstConstants.GDT_Byte, byteBuffer);
> >         }
> >
> >         band.FlushCache();
> >         dataset.FlushCache();
> >         dataset.delete();
> >
> >         System.out.println("Done!");
> >  }
> >  }}}
> >
> >  That is what I got:
> >
> >  array([[0, 1, 2, 3],
> >        [1, 2, 3, 4],
> >        [2, 3, 4, 5],
> >        [3, 4, 5, 6]], dtype=uint8)
> >
> >  That is correct but I need Float32 output on my real application.
> >
> >  Can you see if I am missing something?
> >
> >  When [1] says "It automatically takes care of data type translation if
> >  the data type" it means exactly like the others GDAL APIs?
> >
> >  My best regards,
> >
> >  Ivan
> >
> >  [1] [LINK: http://gdal.org/java/org/gdal/gdal/Band.html]
> >
>
http://gdal.org/java/org/gdal/gdal/Band.html#WriteRaster_Direct%28int,%20int,%20int,%20int,%20int,%20int,%20int,%20java.nio.ByteBuffer,%20int,%20int%29
> >
> >
> >  >  -------Original Message-------
> >  >  From: Even Rouault <[LINK: mailto:even.rouault@mines-paris.org]
> >  even.rouault@mines-paris.org>
> >  >  Subject: Re: [gdal-dev] GDAL-Java: How to write Flot32, Int16?
> >  >  Sent: Nov 03 '09 17:18
> >  >
> >  >  Selon Ivan <[LINK: mailto:ivan.lucena@pmldnet.com]
> >  ivan.lucena@pmldnet.com>:
> >  >
> >  >  The Java API only uses ByteBuffer. But you can use the
> >  asDoubleBuffer(),
> >  >  asFloatBuffer(), asIntBuffer() or asShortBuffer() methods to create
> >  views of the
> >  >  byte buffer as double, float, int or short buffer.
> >  >
> >  >  For example :
> >  >
> >  >  ByteBuffer byteBuffer = ByteBuffer.allocateDirect(8 * buf_xsize *
> >  buf_ysize);
> >  >  band.ReadRaster_Direct(0, 0, xsize, ysize, buf_xsize, buf_ysize,
> >  >  gdal.GDT_Float64, byteBuffer);
> >  >  DoubleBuffer doubleBuffer = byteBuffer.asDoubleBuffer();
> >  >
> >  >  > Hi,
> >  >  >
> >  >  > Does anybody know how to write a FloatBuffer, IntBuffer or
> >  ShotBuffer using
> >  >  > the Java API?
> >  >  >
> >  >  > Thanks,
> >  >  >
> >  >  > Ivan
> >  >  > _______________________________________________
> >  >  > gdal-dev mailing list
> >  >  > [LINK: mailto:gdal-dev@lists.osgeo.org] gdal-dev@lists.osgeo.org
> >  >  > [LINK: http://lists.osgeo.org/mailman/listinfo/gdal-dev]
> >  http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >  >  >
> >  >
> >  >
> >  >
> >  _______________________________________________
> >  gdal-dev mailing list
> >  [LINK: mailto:gdal-dev@lists.osgeo.org] gdal-dev@lists.osgeo.org
> >  [LINK: http://lists.osgeo.org/mailman/listinfo/gdal-dev]
> >  http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
> >  --
> >  -------------------------------------------------------
> >  Eng. Daniele Romagnoli
> >  Software Engineer
> >
> >  GeoSolutions S.A.S.
> >  Via Carignoni 51
> >  55041 Camaiore (LU)
> >  Italy
> >
> >  phone: +39 0584983027
> >  fax:     +39 0584983027
> >  mob:   +39 328 0559267
> >
> >
> >  [LINK: http://www.geo-solutions.it] http://www.geo-solutions.it
> >
> >  -------------------------------------------------------
>


From warmerdam at pobox.com  Wed Nov  4 14:51:03 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov  4 14:51:11 2009
Subject: [gdal-dev] tile artifacts in YCBCR compressed JPEG in TIFF
In-Reply-To: <loom.20091104T155203-837@post.gmane.org>
References: <loom.20091104T155203-837@post.gmane.org>
Message-ID: <4AF1DB27.9050504@pobox.com>

Ray Joslyn wrote:
> Hello,
> I have noticed tile artifacts that corespond to the tile sizes when 
> compressing color images with the PHOTOMETRIC=YCBCR option for JPEG compressed 
> Tiff images.  I do not see this if I use PHOTOMETRIC=RGB.  Are there any 
> options that may prevent this?

Folks,

I followed up on this privately with Ray, and after some analysis I wrote:

"""
Ray,

I have looked up and down the software chain, and I've come to the conclusion
that the YCbCr 2x2 downsampling for Cb and Cr are not strictly local to the
2x2 area but instead take into account the neighbouring image data.  In
libjpeg/jcprepct.c I see this comment:

/*
  * For the simple (no-context-row) case, we just need to buffer one
  * row group's worth of pixels for the downsampling step.  At the bottom of
  * the image, we pad to a full row group by replicating the last pixel row.
  * The downsampler's last output row is then replicated if needed to pad
  * out to a full iMCU row.
  *
  * When providing context rows, we must buffer three row groups' worth of
  * pixels.  Three row groups are physically allocated, but the row pointer
  * arrays are made five row groups high, with the extra pointers above and
  * below "wrapping around" to point to the last and first real row groups.
  * This allows the downsampler to access the proper context rows.
  * At the top and bottom of the image, we create dummy context rows by
  * copying the first or last real pixel row.  This copying could be avoided
  * by pointer hacking as is done in jdmainct.c, but it doesn't seem worth the
  * trouble on the compression side.
  */

I tried using 32x32 blocks instead of the default 256x256 and I see the
anomaly every 32 pixels.

I conclude that because the 2x2 subsampling is done deep in libjpeg it
is not practical to provide cross-tile boundary context to avoid the
anomaly.  It does therefore mean largish tiles will reduce the issue.

I *think* that the reduction in the quality of the image due to the
lack of tile boundary context is minor in comparison to the information
lost in the YCbCr downsampling, and JPEG compression and it just shows
as noticable in the fiducial marks because they have a very regular form
so any alteration in the pattern of horizontal or vertical anti-aliasing
is quite noticable.

I have no real fix to propose.  The only real fix would be to do the
RGB -> YCbCr conversion and YCbCr downsampling in GDAL before the imagery is
sent down through libtiff and libjpeg.  This is theoretically possible, but
would require quite a lot of work and risk.
"""

Hopefully this information - somewhat surprising to me - will also be
helpful to others.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mongoose_riki at mail.ru  Wed Nov  4 15:07:26 2009
From: mongoose_riki at mail.ru (Riki Tiki)
Date: Wed Nov  4 15:07:30 2009
Subject: [gdal-dev] getting TINs out of 3D points using qhull
Message-ID: <E1N5m8c-0006sS-00.mongoose_riki-mail-ru@f144.mail.ru>



hi,

i wanted to ask qhull to give me the TINs (Triangulated Irregular Networks) of 3D points from Lidar LAS files... can anyone show me the command how to get this done (by any chance if you have used the qhull tool)?

thanks!
From ian.durkan at gmail.com  Wed Nov  4 17:10:01 2009
From: ian.durkan at gmail.com (Ian Durkan)
Date: Wed Nov  4 17:10:23 2009
Subject: [gdal-dev] Use string/stream as OGR datasource?
Message-ID: <f5b9e6000911041410v21ee631fq3ff0d8d485f2f3e6@mail.gmail.com>

Greetings,

I?m new to ogr/gdal, so perhaps this is a silly question-regardless:

Using the C/C++ APIs for OGR, is there a way to use either text in a string
(char*, std::string, etc) or a C++ stream object as a data source for OGR?
I have GML documents in string format, and need to store the info they
contain in a PostGIS db.  I realize I can store the GML into a file and then
use the file as a data source but this seems relatively slow.

I?ve done some searching and turned up nothing so far.  Any help is
appreciated.

Ian Durkan ( ian.durkan <at> gmail.com )
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091104/92cca90f/attachment.html
From bclay at ball.com  Wed Nov  4 17:07:44 2009
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov  4 17:12:22 2009
Subject: [gdal-dev] SQL results truncated
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34027EBDB0@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34027EBDB0@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <C482FF98AE985A47B8C982FD429C9E34027EBDB3@daytonmsg2k3.AERO.BALL.COM>

I found a work around to the problem - posting here in case someone else
runs into the problem

 

I changed the initial select * to separate the attributes and cast them
as real

 

Example: Select cast(LAT2 as real), cast(lon2 as real), cast(confidence
as real), cast(intensity as real), date_time from (

 

I don't know where in the overall package the attributes were converted
to integer but this method at least lets the SQL code work

 

GetField as string does not work in this case but that does not really
surprise me since the resulting data does not come from a table rather
it is processed data.

It just means we have to be very careful of the fieldIndex alignment

 

Bruce

________________________________

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Clay, Bruce
Sent: Wednesday, November 04, 2009 12:25 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] SQL results truncated

 

It seems like I encountered this problem before but I can not find any
information about it now.

 

If I run a SQ script like the following

 

Select * from

 (Select MIN_LAT - (round((MIN_LAT - LATITUDE) / (MAX_LAT - MIN_LAT) *
1728.497600)) * 0.000579 LAT2,

         MAX_LON - (round((LONGITUDE - MAX_LON) / (MIN_LON - MAX_LON) *
1814.921600)) * 0.000551 LON2,

         Round(sum(TRACK_SIZE) / 1.000000) CONFIDENCE,

         max(B_TEMP) Intensity,

         min(TO_CHAR(DATE_TIME, 'MM-DD-YYYY HH24:MI:SS')) DATE_TIME 

    FROM

       WACDS.MODIS_ACTIVE_FIRE WHERE

          LATITUDE BETWEEN MIN_LAT AND MAX_LAT AND

          LONGITUDE BETWEEN MIN_LON AND MAX_LON AND

          DATE_TIME BETWEEN TO_DATE('03/01/2007 00:00:00' , 'MM-DD-YYYY
HH24:MI:SS') AND

                            TO_DATE('04/30/2007 23:59:59' , 'MM-DD-YYYY
HH24:MI:SS') AND

          CONFIDENCE > 1.000000

    GROUP BY

        round((MIN_LAT - LATITUDE) / (MAX_LAT - MIN_LAT) * 1728.497600),

        round((LONGITUDE - MAX_LON) / (MIN_LON - MAX_LON) *
1814.921600))

  where 

    (CONFIDENCE * 1.000000) > 1.000000

  ORDER BY DATE_TIME

 

From sqlPal I get LAT2 and LON2 data back as doubles

 

If I run it through OGR ExecuteSql the LAT2 and LON2 data comes back as
integers and can not be used to plot the data

 

OGRFieldDefn *fieldDef = featureDef->GetFieldDefn(fieldIndex);

if (fieldDef != NULL)

{

      fieldType = fieldDef->GetType();

}

 

Returns type integer

 

And both

 

 const char *latStr = (char *)feature->GetFieldAsString("LAT2");

 

  double latitude = feature->GetFieldAsDouble("LAT2");

 

 

return(only the whole portion of what I see in sqlPal.

 

 

Does anyone see / know what might be going wrong?

 

Bruce

 



This message and any enclosures are intended only for the addressee.
Please  
notify the sender by email if you are not the intended recipient.  If
you are  
not the intended recipient, you may not use, copy, disclose, or
distribute this  
message or its contents or enclosures to any other person and any such
actions  
may be unlawful.  Ball reserves the right to monitor and review all
messages  
and enclosures sent to or from this email address.



This message and any enclosures are intended only for the addressee.  Please  
notify the sender by email if you are not the intended recipient.  If you are  
not the intended recipient, you may not use, copy, disclose, or distribute this  
message or its contents or enclosures to any other person and any such actions  
may be unlawful.  Ball reserves the right to monitor and review all messages  
and enclosures sent to or from this email address.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091104/0b8ec62d/attachment-0001.html
From spluque at gmail.com  Wed Nov  4 17:36:27 2009
From: spluque at gmail.com (Seb)
Date: Wed Nov  4 17:36:59 2009
Subject: [gdal-dev] increment in GMT output
Message-ID: <87r5sdj4t0.fsf@kolob.sebmags.homelinux.org>

Hi,

I translated a HDF image:

$ gdalinfo asi-n6250-20020619-v5i.hdf 
Driver: HDF4Image/HDF4 Dataset
Files: asi-n6250-20020619-v5i.hdf
Size is 1216, 1792
Coordinate System is `'
Metadata:
  valid_range=0, 1
  long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1792.0)
Upper Right ( 1216.0,    0.0)
Lower Right ( 1216.0, 1792.0)
Center      (  608.0,  896.0)
Band 1 Block=1216x82 Type=Float32, ColorInterp=Gray


to GMT format with:

$ gdal_translate -of 'GMT' -a_srs 'EPSG:3411' asi-n6250-20020619-v5i.hdf asi-n6250-20020619-v5i.grd
Warning 6: A dataset opened by GDALOpenShared should have the same filename (asi-n6250-20020619-v5i.hdf) and description (HDF4_SDS:UNKNOWN:"asi-n6250-20020619-v5i.hdf":0)
Input file size is 1216, 1792

What is the warning about and how can I address it?

The output GMT grid is not valid because it has incorrect y spacing:

$ grdinfo asi-n6250-20020619-v5i.grd 
grdinfo: GMT ERROR: grid y increment <= 0.0
grdinfo: Use grdedit -A on your grid file to make region and increments compatible [asi-n6250-20020619-v5i.grd]
asi-n6250-20020619-v5i.grd: Title: 
asi-n6250-20020619-v5i.grd: Command: 
asi-n6250-20020619-v5i.grd: Remark: 
asi-n6250-20020619-v5i.grd: Pixel node registration used
asi-n6250-20020619-v5i.grd: Grid file format: cf (# 10) GMT netCDF format (float) (deprecated)                  
asi-n6250-20020619-v5i.grd: x_min: 0 x_max: 1216 x_inc: 1 name: meters nx: 1216
asi-n6250-20020619-v5i.grd: y_min: 1792 y_max: 0 y_inc: -1 name: meters ny: 1792
asi-n6250-20020619-v5i.grd: z_min: 0 z_max: 1 name: meters
asi-n6250-20020619-v5i.grd: scale_factor: 1 add_offset: 0

However, running `grdedit' as suggested didn't correct the problem, and
the program kept the -1 y increment.

Any pointers would be appreciated.  Thanks.

Cheers,

-- 
Seb

From jluis at ualg.pt  Wed Nov  4 20:19:58 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov  4 20:20:16 2009
Subject: [gdal-dev] increment in GMT output
In-Reply-To: <87r5sdj4t0.fsf@kolob.sebmags.homelinux.org>
References: <87r5sdj4t0.fsf@kolob.sebmags.homelinux.org>
Message-ID: <4AF2283E.50401@ualg.pt>

Sebastian,

There is actually more than one error here. Besides the negative y_inc 
the row/columns info is also wrong.
Note for instances the X info

x_min: 0 x_max: 1216 x_inc: 1 name: meters nx: 1216

Either x_min should be 1 OR x_max = 1215.

Joaquim Luis


> Hi,
>
> I translated a HDF image:
>
> $ gdalinfo asi-n6250-20020619-v5i.hdf 
> Driver: HDF4Image/HDF4 Dataset
> Files: asi-n6250-20020619-v5i.hdf
> Size is 1216, 1792
> Coordinate System is `'
> Metadata:
>   valid_range=0, 1
>   long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 1792.0)
> Upper Right ( 1216.0,    0.0)
> Lower Right ( 1216.0, 1792.0)
> Center      (  608.0,  896.0)
> Band 1 Block=1216x82 Type=Float32, ColorInterp=Gray
>
>
> to GMT format with:
>
> $ gdal_translate -of 'GMT' -a_srs 'EPSG:3411' asi-n6250-20020619-v5i.hdf asi-n6250-20020619-v5i.grd
> Warning 6: A dataset opened by GDALOpenShared should have the same filename (asi-n6250-20020619-v5i.hdf) and description (HDF4_SDS:UNKNOWN:"asi-n6250-20020619-v5i.hdf":0)
> Input file size is 1216, 1792
>
> What is the warning about and how can I address it?
>
> The output GMT grid is not valid because it has incorrect y spacing:
>
> $ grdinfo asi-n6250-20020619-v5i.grd 
> grdinfo: GMT ERROR: grid y increment <= 0.0
> grdinfo: Use grdedit -A on your grid file to make region and increments compatible [asi-n6250-20020619-v5i.grd]
> asi-n6250-20020619-v5i.grd: Title: 
> asi-n6250-20020619-v5i.grd: Command: 
> asi-n6250-20020619-v5i.grd: Remark: 
> asi-n6250-20020619-v5i.grd: Pixel node registration used
> asi-n6250-20020619-v5i.grd: Grid file format: cf (# 10) GMT netCDF format (float) (deprecated)                  
> asi-n6250-20020619-v5i.grd: x_min: 0 x_max: 1216 x_inc: 1 name: meters nx: 1216
> asi-n6250-20020619-v5i.grd: y_min: 1792 y_max: 0 y_inc: -1 name: meters ny: 1792
> asi-n6250-20020619-v5i.grd: z_min: 0 z_max: 1 name: meters
> asi-n6250-20020619-v5i.grd: scale_factor: 1 add_offset: 0
>
> However, running `grdedit' as suggested didn't correct the problem, and
> the program kept the -1 y increment.
>
> Any pointers would be appreciated.  Thanks.
>
> Cheers,
>
>   

From spluque at gmail.com  Wed Nov  4 22:04:22 2009
From: spluque at gmail.com (Sebastian P. Luque)
Date: Wed Nov  4 22:04:46 2009
Subject: [gdal-dev] Re: increment in GMT output
References: <87r5sdj4t0.fsf@kolob.sebmags.homelinux.org>
	<4AF2283E.50401@ualg.pt>
Message-ID: <87k4y5iseh.fsf@kolob.sebmags.homelinux.org>

On Thu, 05 Nov 2009 01:19:58 +0000,
Joaquim Luis <jluis@ualg.pt> wrote:

> Sebastian, There is actually more than one error here. Besides the
> negative y_inc the row/columns info is also wrong.  Note for instances
> the X info

> x_min: 0 x_max: 1216 x_inc: 1 name: meters nx: 1216

> Either x_min should be 1 OR x_max = 1215.

Thanks for the heads-up!  I've struggled with this all afternoon, and at
this point I'm thinking it will be easier to work with the geotiff
alternative they offer, although it uses a datum that is inappropriate:

ftp://ftp-projects.zmaw.de/seaice/AMSR-E_ASI_IceConc/geotiff


-- 
Seb

From weixj2003ld at 163.com  Thu Nov  5 01:16:53 2009
From: weixj2003ld at 163.com (weixj2003ld)
Date: Thu Nov  5 01:32:01 2009
Subject: [gdal-dev] VC++(msvc2005) and GDAL
Message-ID: <30703292.244731257401813946.JavaMail.coremail@bj163app17.163.com>

Hi,
I am a newer to GDAL.
How to embed GDAL into VC++,that is,I want to create frame with MFC,and GDAL only read/write Raster data?Thank you in advance.
Wei
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091105/b97e82d1/attachment.html
From vvvjjj0 at yahoo.co.in  Thu Nov  5 06:02:33 2009
From: vvvjjj0 at yahoo.co.in (vvv jjj)
Date: Thu Nov  5 06:02:38 2009
Subject: [gdal-dev] gdalwrap support for non geo referenced images
Message-ID: <943009.44329.qm@web95201.mail.in2.yahoo.com>

Hello

   Im trying to resample a simple tiff file which do not contain any georeference data using gdalwrap. The gdalwrap is showing the following message.

ERROR 1: Unable to compute a transformation between pixel/line
and georeferenced coordinates for myfile.tif.
There is no affine transformation and no GCPs.

What does it mean? Does it mean gdalwrap do not support images with no geo reference details or anything else. Or did I missed anything in using gdalwrap.

Thanks in advance.

J.Viswanath



      Connect more, do more and share more with Yahoo! India Mail. Learn more. http://in.overview.mail.yahoo.com/
From chaitanya.ch at gmail.com  Thu Nov  5 06:45:46 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu Nov  5 06:45:48 2009
Subject: [gdal-dev] gdalwrap support for non geo referenced images
In-Reply-To: <943009.44329.qm@web95201.mail.in2.yahoo.com>
References: <943009.44329.qm@web95201.mail.in2.yahoo.com>
Message-ID: <eb502d880911050345p6631d2f9tc245a003478bba42@mail.gmail.com>

Viswanath,

gdalwarp is used to reproject an image from one projection to another.
With no projection information or GCPs with your tiff there is no way it can
do that.

Perhaps you are looking for gdal_translate (
http://www.gdal.org/gdal_translate.html )

On Thu, Nov 5, 2009 at 4:32 PM, vvv jjj <vvvjjj0@yahoo.co.in> wrote:

> Hello
>
>   Im trying to resample a simple tiff file which do not contain any
> georeference data using gdalwrap. The gdalwrap is showing the following
> message.
>
> ERROR 1: Unable to compute a transformation between pixel/line
> and georeferenced coordinates for myfile.tif.
> There is no affine transformation and no GCPs.
>
> What does it mean? Does it mean gdalwrap do not support images with no geo
> reference details or anything else. Or did I missed anything in using
> gdalwrap.
>
> Thanks in advance.
>
> J.Viswanath
>
>
>
>      Connect more, do more and share more with Yahoo! India Mail. Learn
> more. http://in.overview.mail.yahoo.com/
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091105/cd47cff6/attachment.html
From ivan.lucena at pmldnet.com  Thu Nov  5 09:00:49 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Thu Nov  5 09:00:50 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gVkMrKyhtc3ZjMjAwNSkgYW5kIEdEQUw=?=
Message-ID: <20091105140049.27917.qmail@s466.sureserver.com>

Wei,

Your VC++ project would need to see the GDAL include and GDAL lib folder; it should need to link with the "gdal_i.lib"; and at run time it will requires GDAL bin folder to be on the Windows path variable. 

You can get the GDAL Dev distribution by compiling GDAL from the source code, from OSGeo4w or downloading the zip package. But if you compile from the source code, remember to run "nmake -f makefile.vc *devinstall*". That will setup all the folders that I mentioned before.

Regards,

Ivan

>  -------Original Message-------
>  From: weixj2003ld <weixj2003ld@163.com>
>  Subject: [gdal-dev] VC++(msvc2005) and GDAL
>  Sent: Nov 05 '09 01:16
>  
>  Hi,
>  I am a newer to GDAL.
>  How to embed GDAL into VC++,that is,I want to create frame with MFC,and
>  GDAL only read/write Raster data?Thank you in advance.
>  Wei
>  
>  
>  [LINK:
>  http://allyes.nie.163.com/main/adfclick?db=afanie&bid=1256,612,23&cid=146,4,1&sid=1353&show=ignore&url=http://tx2.163.com/fab.html]
>   3D
>  
>  --------------------
>  _______________________________________________
>  gdal-dev mailing list
>  [LINK: compose.php?to=gdal-dev@lists.osgeo.org] gdal-dev@lists.osgeo.org
>  [LINK: http://lists.osgeo.org/mailman/listinfo/gdal-dev]
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
From jorge.arevalo at gmail.com  Thu Nov  5 10:07:37 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Thu Nov  5 10:08:01 2009
Subject: [gdal-dev] Re: Question about gdal2tiles
In-Reply-To: <loom.20091029T130620-312@post.gmane.org>
References: <cb4457700910280931y41da5d2ape6ea39c569b491c@mail.gmail.com> 
	<loom.20091029T130620-312@post.gmane.org>
Message-ID: <cb4457700911050707r73050f66ia60b3a94ec43a282@mail.gmail.com>

On Thu, Oct 29, 2009 at 1:12 PM, Jukka Rahkonen
<jukka.rahkonen@mmmtike.fi> wrote:
> Jorge Ar?valo <jorge.arevalo <at> gmail.com> writes:
>
>>
>> Hello,
>>
>> I've a problem with gdal2tiles. I need to create tiles from an image
>> of 5 GB, more or less. The image has been created rasterizing a
>> shapefile. The shapefile's original projection was epsg:23028, but I
>> had to reproject it to epsg:23030 (because I had to cross this
>> shapefile with other ones in epsg:23030). To reproject, I used this:
>>
>> ogr2ogr -s_srs epsg:23028 -t_srs epsg:23030 -f "Mapinfo File" dst.mif src.mif
>>
>> Then, I rasterized the shapefile reprojected.
>>
>> After this, I execute gdal2tiles, using resampling method 'near', but
>> it takes a loooooooooong time to complete the process. With other non
>> reprojected shapefiles (in epsg 23030 originally), the process is much
>> faster. What am I doing wrong?
>>
>> Thanks in advance, and best regards
>
> Hi,
>
> Have a look at gdalinfo reports about the slow image and about one of the fast
> ones. ?Check if there are considerable differences in image sizes in pixels. If
> images are about as big then look at the file formats and see if they are
> somehow different.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

Hello,

Sorry, I forgot to answer. Many thanks for your suggestion. I got some
shapefiles with epsg:23028 original projection and everything worked
fine.

I'll look for information about mathematical projections, I think. I
need to know...

Best regards,
Jorge
From gregcoats at mac.com  Thu Nov  5 10:48:39 2009
From: gregcoats at mac.com (Greg Coats)
Date: Thu Nov  5 10:49:01 2009
Subject: [gdal-dev] TIFF tag 33723 IPTC metadata
Message-ID: <01E6FAA8-09E2-40E6-A6C3-D25A3FB33F74@mac.com>

When Photoshop writes a .tif file, it automatically includes TIFF tag  
700 XMP metadata, and TIFF tag 33723 IPTC metadata. The TIFF utilities  
tiffcp and geotifcp copy these Photoshop created .tif files. For  
example, the commands below read in image1.tif, and then write  
image2.tif, arranged into tiles 256x256, and include the XMP and IPTC  
metadata.
$ tiffcp   -t -w 256 -l 256 image1.tif image2.tif
$ geotifcp -t -w 256 -l 256 image1.tif image2.tif

The (unofficial ?) web page
http://www.awaresystems.be/imaging/tiff/tifftags/iptc.html
identifies TIFF tag 33723 IPTC as Type=UNDEFINED or 7, and yet  
tiffinfo shows that the Photoshop created .tif files have TIFF tag  
33723 IPTC written as Type=LONG or 4. Why this difference?

The Kakadu version 6.3.0 supports reading and writing TIFF tag 700 XMP  
metadata, and TIFF tag 33723 IPTC metadata. There is no problem with  
XMP metadata, but when writing IPTC metadata, kdu_expand writes TIFF  
tag 33723 IPTC as Type=UNDEFINED or 7, in compliance with the  
awaresystems web page.

But then I observe that tiffcp and geotifcp both report the Kakadu  
written .tif has an "Incompatible type" for its TIFF tag 33723 IPTC  
metadata, even though the type conforms to the awaresystems web page,  
although that is different from what Adobe uses in Photoshop, and as a  
result the IPTC metadata is lost, and not included in the output .tif  
file.

$ geotifcp -t -w 256 -l 256 image01_v6_3_x86_03_64.tif  
image01_v6_3_x86_03_64_kduV630_1.tif
TIFFFetchNormalTag: Warning, Incompatible type for "RichTIFFIPTC"; tag  
ignored.

Should I change the Kakadu source code so that it makes the same  
mistake Photoshop makes, and identifies TIFF tag 33723 IPTC metadata  
as Type=LONG or 4?
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091105/08bcb6e3/attachment.html
From vvvjjj0 at yahoo.co.in  Fri Nov  6 05:56:06 2009
From: vvvjjj0 at yahoo.co.in (vvv jjj)
Date: Fri Nov  6 05:56:11 2009
Subject: [gdal-dev] gdalwrap support for non geo referenced images
Message-ID: <762448.32414.qm@web95206.mail.in2.yahoo.com>

Thanks Chaitanya.
One more doubt.
I would like to know whether any GDAL application supports resizing an image (with no projection details) using lanscoz resampling method. I looked at gdal translate but could not find the option to change the resampling method. Kindly let me know if there is any option.

Thanks and Regards
J.Viswanath

--- On Thu, 5/11/09, Chaitanya kumar CH <chaitanya.ch@gmail.com> wrote:

> From: Chaitanya kumar CH <chaitanya.ch@gmail.com>
> Subject: Re: [gdal-dev] gdalwrap support for non geo referenced images
> To: "vvv jjj" <vvvjjj0@yahoo.co.in>
> Cc: gdal-dev@lists.osgeo.org
> Date: Thursday, 5 November, 2009, 5:15 PM
> Viswanath,
> 
> gdalwarp is used to reproject an image from one projection
> to another.
> With no projection information or GCPs with your tiff there
> is no way it can do that.
> 
> Perhaps you are looking for gdal_translate ( http://www.gdal.org/gdal_translate.html
> )
> 
> 
> On Thu, Nov 5, 2009 at 4:32 PM,
> vvv jjj <vvvjjj0@yahoo.co.in>
> wrote:
> 
> Hello
> 
> 
> 
>    Im trying to resample a simple tiff file which do not
> contain any georeference data using gdalwrap. The gdalwrap
> is showing the following message.
> 
> 
> 
> ERROR 1: Unable to compute a transformation between
> pixel/line
> 
> and georeferenced coordinates for myfile.tif.
> 
> There is no affine transformation and no GCPs.
> 
> 
> 
> What does it mean? Does it mean gdalwrap do not support
> images with no geo reference details or anything else. Or
> did I missed anything in using gdalwrap.
> 
> 
> 
> Thanks in advance.
> 
> 
> 
> J.Viswanath
> 
> 
> 
> 
> 
> 
> 
>       Connect more, do more and share more with Yahoo!
> India Mail. Learn more. http://in.overview.mail.yahoo.com/
> 
> _______________________________________________
> 
> gdal-dev mailing list
> 
> gdal-dev@lists.osgeo.org
> 
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> 
> -- 
> Best regards,
> Chaitanya kumar CH.
> 
> 


      Connect more, do more and share more with Yahoo! India Mail. Learn more. http://in.overview.mail.yahoo.com/



      The INTERNET now has a personality. YOURS! See your Yahoo! Homepage. http://in.yahoo.com/
From chaitanya.ch at gmail.com  Fri Nov  6 07:04:36 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Nov  6 07:04:39 2009
Subject: [gdal-dev] gdalwrap support for non geo referenced images
In-Reply-To: <762448.32414.qm@web95206.mail.in2.yahoo.com>
References: <762448.32414.qm@web95206.mail.in2.yahoo.com>
Message-ID: <eb502d880911060404p6db90669s1d7418b1a566ad4@mail.gmail.com>

Viswanath,

With no projection details to handle, any good image processing application,
like GIMP, should be able to do the job.

On Fri, Nov 6, 2009 at 4:26 PM, vvv jjj <vvvjjj0@yahoo.co.in> wrote:

> Thanks Chaitanya.
> One more doubt.
> I would like to know whether any GDAL application supports resizing an
> image (with no projection details) using lanscoz resampling method. I looked
> at gdal translate but could not find the option to change the resampling
> method. Kindly let me know if there is any option.
>
> Thanks and Regards
> J.Viswanath
>
> --- On Thu, 5/11/09, Chaitanya kumar CH <chaitanya.ch@gmail.com> wrote:
>
> > From: Chaitanya kumar CH <chaitanya.ch@gmail.com>
> > Subject: Re: [gdal-dev] gdalwrap support for non geo referenced images
> > To: "vvv jjj" <vvvjjj0@yahoo.co.in>
> > Cc: gdal-dev@lists.osgeo.org
> > Date: Thursday, 5 November, 2009, 5:15 PM
> > Viswanath,
> >
> > gdalwarp is used to reproject an image from one projection
> > to another.
> > With no projection information or GCPs with your tiff there
> > is no way it can do that.
> >
> > Perhaps you are looking for gdal_translate (
> http://www.gdal.org/gdal_translate.html
> > )
> >
> >
> > On Thu, Nov 5, 2009 at 4:32 PM,
> > vvv jjj <vvvjjj0@yahoo.co.in>
> > wrote:
> >
> > Hello
> >
> >
> >
> >    Im trying to resample a simple tiff file which do not
> > contain any georeference data using gdalwrap. The gdalwrap
> > is showing the following message.
> >
> >
> >
> > ERROR 1: Unable to compute a transformation between
> > pixel/line
> >
> > and georeferenced coordinates for myfile.tif.
> >
> > There is no affine transformation and no GCPs.
> >
> >
> >
> > What does it mean? Does it mean gdalwrap do not support
> > images with no geo reference details or anything else. Or
> > did I missed anything in using gdalwrap.
> >
> >
> >
> > Thanks in advance.
> >
> >
> >
> > J.Viswanath
> >
> >
> >
> >
> >
> >
> >
> >       Connect more, do more and share more with Yahoo!
> > India Mail. Learn more. http://in.overview.mail.yahoo.com/
> >
> > _______________________________________________
> >
> > gdal-dev mailing list
> >
> > gdal-dev@lists.osgeo.org
> >
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
> >
> >
> > --
> > Best regards,
> > Chaitanya kumar CH.
> >
> >
>
>
>      Connect more, do more and share more with Yahoo! India Mail. Learn
> more. http://in.overview.mail.yahoo.com/
>
>
>
>       The INTERNET now has a personality. YOURS! See your Yahoo! Homepage.
> http://in.yahoo.com/
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091106/5c76cdcd/attachment.html
From weixj2003ld at 163.com  Sun Nov  8 20:39:26 2009
From: weixj2003ld at 163.com (weixj2003ld)
Date: Sun Nov  8 20:54:46 2009
Subject: [gdal-dev] display picture
Message-ID: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>

Hi,
Thank you for your answer.
I want to know how to display the picture file which GDAL generates,that is,Does GDAL only generate RASTER or VECTOR file and not display it? 
Kind regards. 




3D
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091109/96656ae7/attachment.html
From gregcoats at mac.com  Mon Nov  9 00:27:49 2009
From: gregcoats at mac.com (Greg Coats)
Date: Mon Nov  9 00:28:30 2009
Subject: [gdal-dev] Size of GeoTIFF stripes
In-Reply-To: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
References: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
Message-ID: <2F967CF4-CA21-425B-B254-BC722A6C1673@mac.com>

According to http://www.gdal.org/frmt_gtiff.html , for a .tif  
composed of stripes, rather than tiles, GeoTIFF defaults to setting  
the size of a strip to be 8K bytes. This default can be over ridden  
by using BLOCKYSIZE=n. When working with images > 200MB, 8K seems to  
be particularly small. On a computer with at least 2 GB RAM, is there  
any good reason not the set the size of the TIFF stripes to be 64 MB?  
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091109/12d1f305/attachment.html
From even.rouault at mines-paris.org  Mon Nov  9 05:05:02 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Nov  9 05:05:12 2009
Subject: [gdal-dev] display picture
In-Reply-To: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
References: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
Message-ID: <1257761102.4af7e94ee1863@imp.free.fr>

Selon weixj2003ld <weixj2003ld@163.com>:

> Hi,
> Thank you for your answer.
> I want to know how to display the picture file which GDAL generates,that
> is,Does GDAL only generate RASTER or VECTOR file and not display it?
> Kind regards.
>

GDAL itself has no graphical interface to display data. It's the job of other
software relying on GDAL, like QGIS, OpenEV, etc... See
http://trac.osgeo.org/gdal/wiki/SoftwareUsingGdal

>
>
>
> ??????????????????????3D??????????????????????????????


From even.rouault at mines-paris.org  Mon Nov  9 05:20:08 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Nov  9 05:20:10 2009
Subject: [gdal-dev] Size of GeoTIFF stripes
In-Reply-To: <2F967CF4-CA21-425B-B254-BC722A6C1673@mac.com>
References: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
	<2F967CF4-CA21-425B-B254-BC722A6C1673@mac.com>
Message-ID: <1257762008.4af7ecd83b1a3@imp.free.fr>

Selon Greg Coats <gregcoats@mac.com>:

> According to http://www.gdal.org/frmt_gtiff.html , for a .tif
> composed of stripes, rather than tiles, GeoTIFF defaults to setting
> the size of a strip to be 8K bytes. This default can be over ridden
> by using BLOCKYSIZE=n. When working with images > 200MB, 8K seems to
> be particularly small. On a computer with at least 2 GB RAM, is there
> any good reason not the set the size of the TIFF stripes to be 64 MB?
> Greg
>

A good reason I see for not setting too big TIFF stripes is fast access to small
samples in the file. If you just want to read one single pixel, reading 64 MB
can still take around 2 or 3 seconds depending on the storage medium, file
system, etc...
From h.c.winsemius at gmail.com  Mon Nov  9 07:28:59 2009
From: h.c.winsemius at gmail.com (Hessel Winsemius)
Date: Mon Nov  9 07:29:02 2009
Subject: [gdal-dev] python bindings, no netcdf support
Message-ID: <98d77e480911090428i54e88b6evde487e9694a648ba@mail.gmail.com>

Dear all,

Recently I've started working with the python bindings of gdal on my windows
XP box at work. I have managed to install them and they work like a charm,
except one thing. I have bee trying to generate some maps in different
formats. I have tried Ascii/Arc grids, Geotiff, erdas imagine, with
gdal.CreateCopy. it all works, but not when I use NetCDF. In fact the whole
driver is not loaded when I use the commands listed below.

import gdal
from gdalconst import *
gdal.AllRegister()
a = gdal.GetDriverByName('NetCDF')

I have a Mac os x box at home. There, NetCDF works perfectly!!

Does anyone know how to let the python bindings know that it should work
with the NetCDF driver as well? I have netcdf4-python installed by the way.

Hope anyone can help out. It is quite important that this works.

Cheers
Hessel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091109/55ffbeac/attachment.html
From scott.sinclair.za at gmail.com  Mon Nov  9 07:46:47 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Mon Nov  9 07:46:51 2009
Subject: [gdal-dev] python bindings, no netcdf support
In-Reply-To: <98d77e480911090428i54e88b6evde487e9694a648ba@mail.gmail.com>
References: <98d77e480911090428i54e88b6evde487e9694a648ba@mail.gmail.com>
Message-ID: <6a17e9ee0911090446q2b57fca5vce9852fb27003304@mail.gmail.com>

>2009/11/9 Hessel Winsemius <h.c.winsemius@gmail.com>:
> Does anyone know how to let the python bindings know that it should work
> with the NetCDF driver as well? I have netcdf4-python installed by the way.

The installation of netcdf4-python doesn't interact with GDAL. You'll
need to build GDAL yourself with NetCDF support. I've never tried this
on Windows, but you can take a look at
http://trac.osgeo.org/gdal/wiki/BuildHints to get started.

I'm also not sure if GDAL supports NetCDF4 directly. It looks like the
NetCDF driver is for NetCDF3. If you're lucky, NetCDF4 files might be
accessible in GDAL using the HDF5 driver...

Cheers,
Scott
From randyqiuxy at hotmail.com  Mon Nov  9 20:42:35 2009
From: randyqiuxy at hotmail.com (Randyqiu)
Date: Mon Nov  9 20:43:00 2009
Subject: [gdal-dev] display picture
In-Reply-To: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
References: <6347297.85661257730766640.JavaMail.coremail@bj163app123.163.com>
Message-ID: <BLU0-SMTP25A717FFBFF4F1CF60940FC3AB0@phx.gbl>

? 2009-11-09?? 09:39 +0800?weixj2003ld???
> Hi,
> Thank you for your answer.
> I want to know how to display the picture file which GDAL
> generates,that is,Does GDAL only generate RASTER or VECTOR file and
> not display it? 
> Kind regards. 
Hi Wei,
You are right.But if you want to display it,do something with openev.
Best regards,
Randy
> 
> 
> 
> 
> ______________________________________________________________________
> ???????????3D??????????????? 
> 
> 
> ______________________________________________________________________
> 09???3D??????????????????
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
From even.rouault at mines-paris.org  Tue Nov 10 06:00:18 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Nov 10 06:00:21 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <20091109233607.2877.qmail@s466.sureserver.com>
References: <20091109233607.2877.qmail@s466.sureserver.com>
Message-ID: <1257850818.4af947c20752a@imp.free.fr>

Selon Ivan <ivan.lucena@pmldnet.com>:

Ivan,

thanks for your testing (CC'ing the list as it is of general interest).
Actually, I also read on some sites that using ByteBuffer object versus regular
Java arrays is not always a win. Plus the fact that we must use a direct buffer
that has an extra allocation cost according to the Javadoc. So ByteBuffer might
be interesting if you just want to pass big arrays between native code, for
example if you read an array from a dataset and then write it to another one
without accessing it from the Java side. When you mention that accessing through
the byte[] array was faster, did you get it with the array() method instead ?
I'm wondering what the performance overhead of this call is.

As ByteBuffer is not at all a requirement for the interface with the native
code, it would be technically possible to add an alternative API that would use
the regular Java array types.

Would you mind opening an enhancement ticket about that ? Thanks

Even

> Even,
>
> I did some test with the GDAL Java API and some simple raster operations
> like the GDAL Proximity algorthm and I noticed that the performance while
> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is not
> as good as if you copy then to (or from) a "regular" array, like float[],
> double[], integer[] and byte[].
>
> The reason for that is obvious, get() and put() are funtion calls and
> contains a lot of code for range check.
>
> If I understand it correctly, ByteBuffer is the ideal or maybe the only
> way to get access to Buffers from C libraries thought a Java wrapper. But
> do you it would be possible to incapsulate the buffer conversion at the
> wrapper code so that users would be able to read and write direct to
> regular Java arrays?
>
> Just a suggestion,
>
> Ivan
>


From Jennings.Jay at geoeye.com  Tue Nov 10 11:34:39 2009
From: Jennings.Jay at geoeye.com (Jennings Jay)
Date: Tue Nov 10 11:35:47 2009
Subject: [gdal-dev] gdalwarp: output too big?
Message-ID: <44EADB1AC2F19449B528A17643F417B92ED1F2FE0C@MS1.geoeye.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 3626 bytes
Desc: image001.png
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091110/a86cc17d/image001.png
From simone.giannecchini at geo-solutions.it  Tue Nov 10 12:36:19 2009
From: simone.giannecchini at geo-solutions.it (Simone Giannecchini)
Date: Tue Nov 10 12:36:22 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <1257850818.4af947c20752a@imp.free.fr>
References: <20091109233607.2877.qmail@s466.sureserver.com>
	<1257850818.4af947c20752a@imp.free.fr>
Message-ID: <961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>

Ciao Even,
just wanted to add my 2 cents.

As you know for the imageio-ext project we have been using the
GDAL-JNI bindings (actually a modified version of them) for a while in
order to allow Java users to leverage on GDAL using the ImageIO
framework which standard in Java.
This way we also enabled GeoTools and GeoServer to use GDAL as a datasource.

In the past I have done quite some performance tests to add some
new/different methods to them and I can summarise our findings as
follows:

- DirectByteBuffer vs regular arrays -
DBB is expensive to allocate but prevent the VM from performing copies
when having to move data to and from java and native code since they
live on the native space not on the java heap; On the other side the
regular arrays are fast to allocate but they are "usually" copied when
moved across from/to java and native code since the JVM cannot leave
the native code mess with the java heap space since the garbage
collector would not be very happy about that. I said "usually" since
there is a technique called array pinning that we can suggest the JVM
to use to avoid the copy of regular array; however this mechanism is
not guaranteed to be implemented and/or to work on each call (same
reason as above, GC is not happy about this technique).

If you can pool the DBB  and/or use a few large DBB, where the cost of
the copy would overcome the cost of its creation then DBB are much
better than regular arrays. As an instance I noticed that using when
reading striped tiff files regular arrays where faster, but as the
tile size increases (and therefore the cost of a copy overcomes the
cost of a DBB creation) the DBB performs much better

- DirectByteBuffer and the impact on some JVM -
Now in the past we decided to stick with DBB and give
GeoServer/GeoTools users the capability to retile data on the fly.
However lately, during the WMS performance shootout we noticed on some
linux machines JVm soldi crashed, not nice (means restarting the
GeoServer!!!).
We investigated a bit in depth and the problem was that somehow the
JVM was failing to allocate some internal images during the rendering
process and then dying with a NullPointerException (apparently the SUN
Java2D engineers did not use to check for out of memory errors in the
java native space). Well, what happens is that if you use too much of
the Java native space for your own objects, it is likely that the JVM
itself will start to malfunction (you can find articles on the web on
the memory model of a Java process, I don't think I am good enough to
explain it ) since it cannot allocate its own objects.

In the end we decide to leave DBB and go back to regular arrays with
array pinning. This ensured us robustness and we did not see much
performance degradation (which means that array pinning in the end
works). This has been implemented by modifying the SWIG bindings for
GDAL in order to use a byte array instead of a DBB and then use
ByteArray utils to convert between different native type (short, int,
etc..).

- Conclusion -
We might want to spend some time in the mid term to contribute some of
this work back (or probably provide funding), but anyway, it would be
great to have the capability to switch between DBB and regular arrays
since both have flaws.
However atm if I were asked I would say to go with regular arrays as
we do in the imageio-ext project.

Ciao,
Simone.
-------------------------------------------------------
Ing. Simone Giannecchini
GeoSolutions S.A.S.
Founder - Software Engineer
Via Carignoni 51
55041  Camaiore (LU)
Italy

phone: +39 0584983027
fax:      +39 0584983027
mob:    +39 333 8128928


http://www.geo-solutions.it
http://geo-solutions.blogspot.com/
http://simboss.blogspot.com/
http://www.linkedin.com/in/simonegiannecchini

-------------------------------------------------------



On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
<even.rouault@mines-paris.org> wrote:
> Selon Ivan <ivan.lucena@pmldnet.com>:
>
> Ivan,
>
> thanks for your testing (CC'ing the list as it is of general interest).
> Actually, I also read on some sites that using ByteBuffer object versus regular
> Java arrays is not always a win. Plus the fact that we must use a direct buffer
> that has an extra allocation cost according to the Javadoc. So ByteBuffer might
> be interesting if you just want to pass big arrays between native code, for
> example if you read an array from a dataset and then write it to another one
> without accessing it from the Java side. When you mention that accessing through
> the byte[] array was faster, did you get it with the array() method instead ?
> I'm wondering what the performance overhead of this call is.
>
> As ByteBuffer is not at all a requirement for the interface with the native
> code, it would be technically possible to add an alternative API that would use
> the regular Java array types.
>
> Would you mind opening an enhancement ticket about that ? Thanks
>
> Even
>
>> Even,
>>
>> I did some test with the GDAL Java API and some simple raster operations
>> like the GDAL Proximity algorthm and I noticed that the performance while
>> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is not
>> as good as if you copy then to (or from) a "regular" array, like float[],
>> double[], integer[] and byte[].
>>
>> The reason for that is obvious, get() and put() are funtion calls and
>> contains a lot of code for range check.
>>
>> If I understand it correctly, ByteBuffer is the ideal or maybe the only
>> way to get access to Buffers from C libraries thought a Java wrapper. But
>> do you it would be possible to incapsulate the buffer conversion at the
>> wrapper code so that users would be able to read and write direct to
>> regular Java arrays?
>>
>> Just a suggestion,
>>
>> Ivan
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From gregcoats at mac.com  Tue Nov 10 14:24:41 2009
From: gregcoats at mac.com (Greg Coats)
Date: Tue Nov 10 14:25:01 2009
Subject: [gdal-dev] gdalwarp: output too big?
In-Reply-To: <44EADB1AC2F19449B528A17643F417B92ED1F2FE0C@MS1.geoeye.com>
References: <44EADB1AC2F19449B528A17643F417B92ED1F2FE0C@MS1.geoeye.com>
Message-ID: <EF6D254A-D9B5-4451-BA28-06FBCC739318@mac.com>

The tiffinfo utility reports the number of columns and rows in TIFF  
images, including BigTIFF images.

$ ls -lh dcua_00.30m_BostonBlvd_8x8_BigTiff=YES.tif
-rw-r--r--  1 gregcoats  staff   4.2G Sep 12 16:54  
dcua_00.30m_BostonBlvd_8x8_BigTiff=YES.tif

$ tiffinfo dcua_00.30m_BostonBlvd_8x8_BigTiff=YES.tif | grep Image
   Image Width: 40000 Image Length: 36000

Greg Coats
Reston, Virginia, USA

On Nov 10, 2009, at 11:34 AM, Jennings Jay wrote:

> PS I?d like to query the output file to learn the pixel sizes, but  
> gdalinfo doesn?t give that for some reason.  Can anyone suggest a  
> means to query that info in a BigTIFF ?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091110/9751c1c1/attachment.html
From john.callahan at UDel.Edu  Tue Nov 10 15:00:58 2009
From: john.callahan at UDel.Edu (John Callahan)
Date: Tue Nov 10 15:02:03 2009
Subject: [gdal-dev] gdal to define projection, EPSG:3412
Message-ID: <4AF9C67A.1050307@udel.edu>

Is it possible to define/set a coordinate system using GDAL?   I 
downloaded some data (from NSIDC) I know is in EPSG:3412.  
(http://spatialreference.org/ref/epsg/3412/, 
http://nsidc.org/data/atlas/epsg_3412.html)

The data is in bsq format, therefore requires a hdr file that I've been 
piecing together manually.  The hdr file has a "projection info" line 
that defines the projection parameters.   Here is the hdr file I've been 
using, unsuccessfully:

ENVI
description = {
  File Imported into ENVI.}
samples = 316
lines   = 332
bands   = 1
header offset = 300
file type = ENVI Standard
data type = 1
interleave = bsq
sensor type = Unknown
byte order = 0
map info = {NSIDC Sea Ice Polar Stereographic South, 1.0000, 1.0000, 
-3950000.0000, 4350000.0000, 2.5000000000e+004, 2.5000000000e+004, 
Hughes 1980, units=Meters}
projection info = {31, 6378273.0, 6356889.4, -70.000000, 0.000000, 0.0, 
0.0, Hughes1980, NSIDC Sea Ice Polar Stereographic South, units=Meters}
wavelength units = Unknown
pixel size = {2.50000000e+004, 2.50000000e+004, units=Meters}



The data displays properly with other vector data in EPSG:3412, say in 
QGIS.  To me, this simply means the "map info" line of correct.  
However, when I try to project the data (gdal_translate, gdalwarp), the 
output is nonsense (nearly all null or nodata).  I believe my 
"projection info" line is wrong, and may have something to do with 
denoting the lat of origin as -90 and standard parallel as -70.   Thanks 
for any help.

- John

**************************************************
John Callahan, Geospatial Application Developer
Delaware Geological Survey, University of Delaware
URL: http://www.dgs.udel.edu
**************************************************

From ivan.lucena at pmldnet.com  Tue Nov 10 15:54:06 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Tue Nov 10 15:54:08 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gUmU6IEpBVkEgQVBJIC0gUGVyZm9ybWFuY2U=?=
Message-ID: <20091110205406.14591.qmail@s466.sureserver.com>

Caio Simone,

I just downloaded imageio-ext to check how it does that but it looks like I don't need to do that now, I can take you report instead. Thank you very much. I will take a look on array pinning for a start.

I translated the GDAL Proximity [1] code to Java and I timed both of then with the same input, a 1024x1024 byte image with just one pixel as feature at the center of the image.

It took 0.3 seconds in C++ and 1.5 seconds in Java!

I then translated the buffers to regular arrays and it went down a little bit, 1.3 seconds. 

It is still a big disadvantage. I believe that the buffer-to-buffer translation is the guilt time waster in that case.

[1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
 
My best regards,

Ivan

>  -------Original Message-------
>  From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
>  Subject: Re: [gdal-dev] Re: JAVA API - Performance
>  Sent: Nov 10 '09 12:36
>  
>  Ciao Even,
>  just wanted to add my 2 cents.
>  
>  As you know for the imageio-ext project we have been using the
>  GDAL-JNI bindings (actually a modified version of them) for a while in
>  order to allow Java users to leverage on GDAL using the ImageIO
>  framework which standard in Java.
>  This way we also enabled GeoTools and GeoServer to use GDAL as a datasource.
>  
>  In the past I have done quite some performance tests to add some
>  new/different methods to them and I can summarise our findings as
>  follows:
>  
>  - DirectByteBuffer vs regular arrays -
>  DBB is expensive to allocate but prevent the VM from performing copies
>  when having to move data to and from java and native code since they
>  live on the native space not on the java heap; On the other side the
>  regular arrays are fast to allocate but they are "usually" copied when
>  moved across from/to java and native code since the JVM cannot leave
>  the native code mess with the java heap space since the garbage
>  collector would not be very happy about that. I said "usually" since
>  there is a technique called array pinning that we can suggest the JVM
>  to use to avoid the copy of regular array; however this mechanism is
>  not guaranteed to be implemented and/or to work on each call (same
>  reason as above, GC is not happy about this technique).
>  
>  If you can pool the DBB??and/or use a few large DBB, where the cost of
>  the copy would overcome the cost of its creation then DBB are much
>  better than regular arrays. As an instance I noticed that using when
>  reading striped tiff files regular arrays where faster, but as the
>  tile size increases (and therefore the cost of a copy overcomes the
>  cost of a DBB creation) the DBB performs much better
>  
>  - DirectByteBuffer and the impact on some JVM -
>  Now in the past we decided to stick with DBB and give
>  GeoServer/GeoTools users the capability to retile data on the fly.
>  However lately, during the WMS performance shootout we noticed on some
>  linux machines JVm soldi crashed, not nice (means restarting the
>  GeoServer!!!).
>  We investigated a bit in depth and the problem was that somehow the
>  JVM was failing to allocate some internal images during the rendering
>  process and then dying with a NullPointerException (apparently the SUN
>  Java2D engineers did not use to check for out of memory errors in the
>  java native space). Well, what happens is that if you use too much of
>  the Java native space for your own objects, it is likely that the JVM
>  itself will start to malfunction (you can find articles on the web on
>  the memory model of a Java process, I don't think I am good enough to
>  explain it ) since it cannot allocate its own objects.
>  
>  In the end we decide to leave DBB and go back to regular arrays with
>  array pinning. This ensured us robustness and we did not see much
>  performance degradation (which means that array pinning in the end
>  works). This has been implemented by modifying the SWIG bindings for
>  GDAL in order to use a byte array instead of a DBB and then use
>  ByteArray utils to convert between different native type (short, int,
>  etc..).
>  
>  - Conclusion -
>  We might want to spend some time in the mid term to contribute some of
>  this work back (or probably provide funding), but anyway, it would be
>  great to have the capability to switch between DBB and regular arrays
>  since both have flaws.
>  However atm if I were asked I would say to go with regular arrays as
>  we do in the imageio-ext project.
>  
>  Ciao,
>  Simone.
>  -------------------------------------------------------
>  Ing. Simone Giannecchini
>  GeoSolutions S.A.S.
>  Founder - Software Engineer
>  Via Carignoni 51
>  55041??Camaiore (LU)
>  Italy
>  
>  phone: +39 0584983027
>  fax:??????+39 0584983027
>  mob:????+39 333 8128928
>  
>  
>  http://www.geo-solutions.it
>  http://geo-solutions.blogspot.com/
>  http://simboss.blogspot.com/
>  http://www.linkedin.com/in/simonegiannecchini
>  
>  -------------------------------------------------------
>  
>  
>  
>  On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>  <even.rouault@mines-paris.org> wrote:
>  > Selon Ivan <ivan.lucena@pmldnet.com>:
>  >
>  > Ivan,
>  >
>  > thanks for your testing (CC'ing the list as it is of general interest).
>  > Actually, I also read on some sites that using ByteBuffer object versus regular
>  > Java arrays is not always a win. Plus the fact that we must use a direct buffer
>  > that has an extra allocation cost according to the Javadoc. So ByteBuffer might
>  > be interesting if you just want to pass big arrays between native code, for
>  > example if you read an array from a dataset and then write it to another one
>  > without accessing it from the Java side. When you mention that accessing through
>  > the byte[] array was faster, did you get it with the array() method instead ?
>  > I'm wondering what the performance overhead of this call is.
>  >
>  > As ByteBuffer is not at all a requirement for the interface with the native
>  > code, it would be technically possible to add an alternative API that would use
>  > the regular Java array types.
>  >
>  > Would you mind opening an enhancement ticket about that ? Thanks
>  >
>  > Even
>  >
>  >> Even,
>  >>
>  >> I did some test with the GDAL Java API and some simple raster operations
>  >> like the GDAL Proximity algorthm and I noticed that the performance while
>  >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is not
>  >> as good as if you copy then to (or from) a "regular" array, like float[],
>  >> double[], integer[] and byte[].
>  >>
>  >> The reason for that is obvious, get() and put() are funtion calls and
>  >> contains a lot of code for range check.
>  >>
>  >> If I understand it correctly, ByteBuffer is the ideal or maybe the only
>  >> way to get access to Buffers from C libraries thought a Java wrapper. But
>  >> do you it would be possible to incapsulate the buffer conversion at the
>  >> wrapper code so that users would be able to read and write direct to
>  >> regular Java arrays?
>  >>
>  >> Just a suggestion,
>  >>
>  >> Ivan
>  >>
>  >
>  >
>  > _______________________________________________
>  > gdal-dev mailing list
>  > gdal-dev@lists.osgeo.org
>  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  >
>  
From srikanth1947 at gmail.com  Wed Nov 11 01:22:06 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Wed Nov 11 01:22:28 2009
Subject: [gdal-dev] Image classification
Message-ID: <7a566dfe0911102222ta199706i256f478dc093c4b@mail.gmail.com>

Dear All ,

Is there any utility in gdal libary which provides Image classification (
Supervised and Unsupervised) ?
-- 
Regards,
Srikanth K.
www.servetheneedy.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091111/013efc06/attachment.html
From peifer at gmx.eu  Wed Nov 11 02:38:07 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Nov 11 02:39:22 2009
Subject: [gdal-dev] SPHEROID["unretrievable - using WGS84"...
Message-ID: <hddplu$ok4$1@ger.gmane.org>

Hi,

testepsg EPSG:3785 gives [1], whereas
gdalwarp -t_srs EPSG:3785 input.tif output.tif results into [2]


This looks like a bug, or not? I am using gdal 1.6.2

Hermann


[1]
Validate Succeeds.
WKT[EPSG:3785] =
PROJCS["Popular Visualisation CRS / Mercator",
     GEOGCS["Popular Visualisation CRS",
         DATUM["Popular_Visualisation_Datum",
             SPHEROID["Popular Visualisation Sphere",6378137,0,
                 AUTHORITY["EPSG","7059"]],
             TOWGS84[0,0,0,0,0,0,0],
             AUTHORITY["EPSG","6055"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.01745329251994328,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4055"]],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     PROJECTION["Mercator_1SP"],
     PARAMETER["central_meridian",0],
     PARAMETER["scale_factor",1],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     AUTHORITY["EPSG","3785"],
     AXIS["X",EAST],
     AXIS["Y",NORTH]]

[2]
Files: output.tif
Size is 868, 580
Coordinate System is:
PROJCS["Popular Visualisation CRS / Mercator",
     GEOGCS["Popular Visualisation CRS",
         DATUM["unknown",
             SPHEROID["unretrievable - using WGS84",6378137,298.257223563,
                 AUTHORITY["EPSG","0"]],
             AUTHORITY["EPSG","6055"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4055"]],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AUTHORITY["EPSG","3785"]]
Origin = (-5555588.989365539513528,11996289.038382656872272)
Pixel Size = (15457.180606961637750,-15457.180606961637750)
Metadata:
(snip)

From peifer at gmx.eu  Wed Nov 11 03:16:41 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Nov 11 03:22:48 2009
Subject: [gdal-dev] Re: gdalwarp: output too big?
In-Reply-To: <44EADB1AC2F19449B528A17643F417B92ED1F2FE0C@MS1.geoeye.com>
References: <44EADB1AC2F19449B528A17643F417B92ED1F2FE0C@MS1.geoeye.com>
Message-ID: <hddru9$u2h$1@ger.gmane.org>

Jennings Jay wrote:

> I expected outputsize-pixels to 
> be [inputsize-pixels * 0.50/0.2986] in both directions, but it is a good 
> bit bigger than that.  Can anybody see why ?
> 
> Input size X, Y (pixels) : 45974,  39526
> Output size X, Y (pixels) : 83468,  72894
> 

This looks reasonable. EPSG:3785 uses Mercator projection, which in 
return has quite some distortion for areas far away from the equator.

http://en.wikipedia.org/wiki/Mercator_projection#Uses

> 
> Can anyone suggest a means 
> to query that info in a BigTIFF ?
> 

I used the gdal configure option:

./configure --with-libtiff=internal

This gave me: "LIBTIFF support: internal (BigTIFF=yes)"

Hermann

From jrepetto at free.fr  Wed Nov 11 03:07:50 2009
From: jrepetto at free.fr (Jean-Claude REPETTO)
Date: Wed Nov 11 03:34:58 2009
Subject: [gdal-dev] SPHEROID["unretrievable - using WGS84"...
In-Reply-To: <hddplu$ok4$1@ger.gmane.org>
References: <hddplu$ok4$1@ger.gmane.org>
Message-ID: <4AFA70D6.90904@free.fr>

Hermann Peifer a ?crit :
> Hi,
> 
> testepsg EPSG:3785 gives [1], whereas
> gdalwarp -t_srs EPSG:3785 input.tif output.tif results into [2]
> 

Hi,
I don't know if it will solve your problem, but EPSG:3785 is now 
obsolete, replaced by EPSG:3857

From h.c.winsemius at gmail.com  Wed Nov 11 05:12:30 2009
From: h.c.winsemius at gmail.com (HesselWinsemius)
Date: Wed Nov 11 05:12:46 2009
Subject: [Gdal-dev] python bindings, no netcdf support
In-Reply-To: <6a17e9ee0911090446q2b57fca5vce9852fb27003304@mail.gmail.com>
References: <98d77e480911090428i54e88b6evde487e9694a648ba@mail.gmail.com>
	<6a17e9ee0911090446q2b57fca5vce9852fb27003304@mail.gmail.com>
Message-ID: <1257934350937-3985482.post@n2.nabble.com>


>I'm also not sure if GDAL supports NetCDF4 directly. It looks like the
>NetCDF driver is for NetCDF3. If you're lucky, NetCDF4 files might be
>accessible in GDAL using the HDF5 driver...

I will try to write files directly with the netcdf4-python module instead of
through gdal. Building from scratch looks too complicated to me.
-- 
View this message in context: http://n2.nabble.com/python-bindings-no-netcdf-support-tp3972664p3985482.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From even.rouault at mines-paris.org  Wed Nov 11 05:15:01 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Nov 11 05:15:06 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <20091110205406.14591.qmail@s466.sureserver.com>
References: <20091110205406.14591.qmail@s466.sureserver.com>
Message-ID: <1257934501.4afa8ea572fb2@imp.free.fr>

Selon Ivan <ivan.lucena@pmldnet.com>:

Ivan,

I'm not sure what you are really measuring if you compare a C++ code versus its
translation to Java code. I think it just reflects the known slowdown of Java
when doing intensive computations in comparison to native code. The 0.2 second
difference between the regular array version and the ByteBuffer one is the
interesting result, not the 1.2/1.0 second difference between C++ and Java.

> Caio Simone,
>
> I just downloaded imageio-ext to check how it does that but it looks like I
> don't need to do that now, I can take you report instead. Thank you very
> much. I will take a look on array pinning for a start.
>
> I translated the GDAL Proximity [1] code to Java and I timed both of then
> with the same input, a 1024x1024 byte image with just one pixel as feature at
> the center of the image.
>
> It took 0.3 seconds in C++ and 1.5 seconds in Java!
>
> I then translated the buffers to regular arrays and it went down a little
> bit, 1.3 seconds.
>
> It is still a big disadvantage. I believe that the buffer-to-buffer
> translation is the guilt time waster in that case.
>
> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
>
> My best regards,
>
> Ivan
>
> >  -------Original Message-------
> >  From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
> >  Subject: Re: [gdal-dev] Re: JAVA API - Performance
> >  Sent: Nov 10 '09 12:36
> >
> >  Ciao Even,
> >  just wanted to add my 2 cents.
> >
> >  As you know for the imageio-ext project we have been using the
> >  GDAL-JNI bindings (actually a modified version of them) for a while in
> >  order to allow Java users to leverage on GDAL using the ImageIO
> >  framework which standard in Java.
> >  This way we also enabled GeoTools and GeoServer to use GDAL as a
> datasource.
> >
> >  In the past I have done quite some performance tests to add some
> >  new/different methods to them and I can summarise our findings as
> >  follows:
> >
> >  - DirectByteBuffer vs regular arrays -
> >  DBB is expensive to allocate but prevent the VM from performing copies
> >  when having to move data to and from java and native code since they
> >  live on the native space not on the java heap; On the other side the
> >  regular arrays are fast to allocate but they are "usually" copied when
> >  moved across from/to java and native code since the JVM cannot leave
> >  the native code mess with the java heap space since the garbage
> >  collector would not be very happy about that. I said "usually" since
> >  there is a technique called array pinning that we can suggest the JVM
> >  to use to avoid the copy of regular array; however this mechanism is
> >  not guaranteed to be implemented and/or to work on each call (same
> >  reason as above, GC is not happy about this technique).
> >
> >  If you can pool the DBB??and/or use a few large DBB, where the cost of
> >  the copy would overcome the cost of its creation then DBB are much
> >  better than regular arrays. As an instance I noticed that using when
> >  reading striped tiff files regular arrays where faster, but as the
> >  tile size increases (and therefore the cost of a copy overcomes the
> >  cost of a DBB creation) the DBB performs much better
> >
> >  - DirectByteBuffer and the impact on some JVM -
> >  Now in the past we decided to stick with DBB and give
> >  GeoServer/GeoTools users the capability to retile data on the fly.
> >  However lately, during the WMS performance shootout we noticed on some
> >  linux machines JVm soldi crashed, not nice (means restarting the
> >  GeoServer!!!).
> >  We investigated a bit in depth and the problem was that somehow the
> >  JVM was failing to allocate some internal images during the rendering
> >  process and then dying with a NullPointerException (apparently the SUN
> >  Java2D engineers did not use to check for out of memory errors in the
> >  java native space). Well, what happens is that if you use too much of
> >  the Java native space for your own objects, it is likely that the JVM
> >  itself will start to malfunction (you can find articles on the web on
> >  the memory model of a Java process, I don't think I am good enough to
> >  explain it ) since it cannot allocate its own objects.
> >
> >  In the end we decide to leave DBB and go back to regular arrays with
> >  array pinning. This ensured us robustness and we did not see much
> >  performance degradation (which means that array pinning in the end
> >  works). This has been implemented by modifying the SWIG bindings for
> >  GDAL in order to use a byte array instead of a DBB and then use
> >  ByteArray utils to convert between different native type (short, int,
> >  etc..).
> >
> >  - Conclusion -
> >  We might want to spend some time in the mid term to contribute some of
> >  this work back (or probably provide funding), but anyway, it would be
> >  great to have the capability to switch between DBB and regular arrays
> >  since both have flaws.
> >  However atm if I were asked I would say to go with regular arrays as
> >  we do in the imageio-ext project.
> >
> >  Ciao,
> >  Simone.
> >  -------------------------------------------------------
> >  Ing. Simone Giannecchini
> >  GeoSolutions S.A.S.
> >  Founder - Software Engineer
> >  Via Carignoni 51
> >  55041??Camaiore (LU)
> >  Italy
> >
> >  phone: +39 0584983027
> >  fax:??????+39 0584983027
> >  mob:????+39 333 8128928
> >
> >
> >  http://www.geo-solutions.it
> >  http://geo-solutions.blogspot.com/
> >  http://simboss.blogspot.com/
> >  http://www.linkedin.com/in/simonegiannecchini
> >
> >  -------------------------------------------------------
> >
> >
> >
> >  On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
> >  <even.rouault@mines-paris.org> wrote:
> >  > Selon Ivan <ivan.lucena@pmldnet.com>:
> >  >
> >  > Ivan,
> >  >
> >  > thanks for your testing (CC'ing the list as it is of general interest).
> >  > Actually, I also read on some sites that using ByteBuffer object versus
> regular
> >  > Java arrays is not always a win. Plus the fact that we must use a direct
> buffer
> >  > that has an extra allocation cost according to the Javadoc. So
> ByteBuffer might
> >  > be interesting if you just want to pass big arrays between native code,
> for
> >  > example if you read an array from a dataset and then write it to another
> one
> >  > without accessing it from the Java side. When you mention that accessing
> through
> >  > the byte[] array was faster, did you get it with the array() method
> instead ?
> >  > I'm wondering what the performance overhead of this call is.
> >  >
> >  > As ByteBuffer is not at all a requirement for the interface with the
> native
> >  > code, it would be technically possible to add an alternative API that
> would use
> >  > the regular Java array types.
> >  >
> >  > Would you mind opening an enhancement ticket about that ? Thanks
> >  >
> >  > Even
> >  >
> >  >> Even,
> >  >>
> >  >> I did some test with the GDAL Java API and some simple raster
> operations
> >  >> like the GDAL Proximity algorthm and I noticed that the performance
> while
> >  >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is
> not
> >  >> as good as if you copy then to (or from) a "regular" array, like
> float[],
> >  >> double[], integer[] and byte[].
> >  >>
> >  >> The reason for that is obvious, get() and put() are funtion calls and
> >  >> contains a lot of code for range check.
> >  >>
> >  >> If I understand it correctly, ByteBuffer is the ideal or maybe the only
> >  >> way to get access to Buffers from C libraries thought a Java wrapper.
> But
> >  >> do you it would be possible to incapsulate the buffer conversion at the
> >  >> wrapper code so that users would be able to read and write direct to
> >  >> regular Java arrays?
> >  >>
> >  >> Just a suggestion,
> >  >>
> >  >> Ivan
> >  >>
> >  >
> >  >
> >  > _______________________________________________
> >  > gdal-dev mailing list
> >  > gdal-dev@lists.osgeo.org
> >  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >  >
> >
>


From peifer at gmx.eu  Wed Nov 11 06:06:25 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Nov 11 06:06:54 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AF9C67A.1050307@udel.edu>
References: <4AF9C67A.1050307@udel.edu>
Message-ID: <hde5ri$668$1@ger.gmane.org>

Did you try: gdalwarp -s_srs EPSG:3412 ?

Hermann

John Callahan wrote:
> Is it possible to define/set a coordinate system using GDAL?   I 
> downloaded some data (from NSIDC) I know is in EPSG:3412.  
> (http://spatialreference.org/ref/epsg/3412/, 
> http://nsidc.org/data/atlas/epsg_3412.html)
> 
> The data is in bsq format, therefore requires a hdr file that I've been 
> piecing together manually.  The hdr file has a "projection info" line 
> that defines the projection parameters.   Here is the hdr file I've been 
> using, unsuccessfully:
> 
> ENVI
> description = {
>  File Imported into ENVI.}
> samples = 316
> lines   = 332
> bands   = 1
> header offset = 300
> file type = ENVI Standard
> data type = 1
> interleave = bsq
> sensor type = Unknown
> byte order = 0
> map info = {NSIDC Sea Ice Polar Stereographic South, 1.0000, 1.0000, 
> -3950000.0000, 4350000.0000, 2.5000000000e+004, 2.5000000000e+004, 
> Hughes 1980, units=Meters}
> projection info = {31, 6378273.0, 6356889.4, -70.000000, 0.000000, 0.0, 
> 0.0, Hughes1980, NSIDC Sea Ice Polar Stereographic South, units=Meters}
> wavelength units = Unknown
> pixel size = {2.50000000e+004, 2.50000000e+004, units=Meters}
> 
> 
> 
> The data displays properly with other vector data in EPSG:3412, say in 
> QGIS.  To me, this simply means the "map info" line of correct.  
> However, when I try to project the data (gdal_translate, gdalwarp), the 
> output is nonsense (nearly all null or nodata).  I believe my 
> "projection info" line is wrong, and may have something to do with 
> denoting the lat of origin as -90 and standard parallel as -70.   Thanks 
> for any help.
> 
> - John
> 
> **************************************************
> John Callahan, Geospatial Application Developer
> Delaware Geological Survey, University of Delaware
> URL: http://www.dgs.udel.edu
> **************************************************

From even.rouault at mines-paris.org  Wed Nov 11 06:33:26 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Nov 11 06:33:30 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>
References: <20091109233607.2877.qmail@s466.sureserver.com>
	<1257850818.4af947c20752a@imp.free.fr>
	<961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>
Message-ID: <1257939206.4afaa106743c6@imp.free.fr>

Selon Simone Giannecchini <simone.giannecchini@geo-solutions.it>:

Simone,

thanks for all this interesting information. I'm doing some experiment with Sun
JRE 1.6 and I observe that array pinning doesn't really work. I mean that the
jenv->GetByteArrayElements($input, &isCopy) call always return isCopy ==
JNI_TRUE, which seems to be confirmed by
http://elliotth.blogspot.com/2007/03/optimizing-jni-array-access.html (although
it is a bit outdated now) : "[...] current Sun JVMs never give you a direct
pointer. They always copy".

I've tried GetPrimitiveArrayCritical() / ReleasePrimitiveArrayCritical() and
I've observed they return non-copy pointers, which make them good candidates.
Looking at
http://java.sun.com/j2se/1.3/docs/guide/jni/jni-12.html#GetPrimitiveArrayCritical,
it appears that there are restrictions to use them. But this is probably OK as
we don't callback Java code in the RasterIO operations. But I'm not sure if the
native operation can be considered to be fast enough to use those primitives. It
depends on the query size and the driver. Perhaps it is not worth the risk and
that the copy made by the JVM when calling GetByteArrayElements() is not that
significant for modest size arrays.

Another possibility is that in the ReadRaster() case, we don't care about the
initial values of the array. We just want to update it in fact, so we could
allocate a working buffer in the JNI code, call the native RasterIO() on it and
upload its content into the Java array with SetByteArrayRegion(). This would
save one copy.

Have you also observed this ? Which JNI calls do you use ?

Best regards,
Even

> Ciao Even,
> just wanted to add my 2 cents.
>
> As you know for the imageio-ext project we have been using the
> GDAL-JNI bindings (actually a modified version of them) for a while in
> order to allow Java users to leverage on GDAL using the ImageIO
> framework which standard in Java.
> This way we also enabled GeoTools and GeoServer to use GDAL as a datasource.
>
> In the past I have done quite some performance tests to add some
> new/different methods to them and I can summarise our findings as
> follows:
>
> - DirectByteBuffer vs regular arrays -
> DBB is expensive to allocate but prevent the VM from performing copies
> when having to move data to and from java and native code since they
> live on the native space not on the java heap; On the other side the
> regular arrays are fast to allocate but they are "usually" copied when
> moved across from/to java and native code since the JVM cannot leave
> the native code mess with the java heap space since the garbage
> collector would not be very happy about that. I said "usually" since
> there is a technique called array pinning that we can suggest the JVM
> to use to avoid the copy of regular array; however this mechanism is
> not guaranteed to be implemented and/or to work on each call (same
> reason as above, GC is not happy about this technique).
>
> If you can pool the DBB  and/or use a few large DBB, where the cost of
> the copy would overcome the cost of its creation then DBB are much
> better than regular arrays. As an instance I noticed that using when
> reading striped tiff files regular arrays where faster, but as the
> tile size increases (and therefore the cost of a copy overcomes the
> cost of a DBB creation) the DBB performs much better
>
> - DirectByteBuffer and the impact on some JVM -
> Now in the past we decided to stick with DBB and give
> GeoServer/GeoTools users the capability to retile data on the fly.
> However lately, during the WMS performance shootout we noticed on some
> linux machines JVm soldi crashed, not nice (means restarting the
> GeoServer!!!).
> We investigated a bit in depth and the problem was that somehow the
> JVM was failing to allocate some internal images during the rendering
> process and then dying with a NullPointerException (apparently the SUN
> Java2D engineers did not use to check for out of memory errors in the
> java native space). Well, what happens is that if you use too much of
> the Java native space for your own objects, it is likely that the JVM
> itself will start to malfunction (you can find articles on the web on
> the memory model of a Java process, I don't think I am good enough to
> explain it ) since it cannot allocate its own objects.
>
> In the end we decide to leave DBB and go back to regular arrays with
> array pinning. This ensured us robustness and we did not see much
> performance degradation (which means that array pinning in the end
> works). This has been implemented by modifying the SWIG bindings for
> GDAL in order to use a byte array instead of a DBB and then use
> ByteArray utils to convert between different native type (short, int,
> etc..).
>
> - Conclusion -
> We might want to spend some time in the mid term to contribute some of
> this work back (or probably provide funding), but anyway, it would be
> great to have the capability to switch between DBB and regular arrays
> since both have flaws.
> However atm if I were asked I would say to go with regular arrays as
> we do in the imageio-ext project.
>
> Ciao,
> Simone.
> -------------------------------------------------------
> Ing. Simone Giannecchini
> GeoSolutions S.A.S.
> Founder - Software Engineer
> Via Carignoni 51
> 55041  Camaiore (LU)
> Italy
>
> phone: +39 0584983027
> fax:      +39 0584983027
> mob:    +39 333 8128928
>
>
> http://www.geo-solutions.it
> http://geo-solutions.blogspot.com/
> http://simboss.blogspot.com/
> http://www.linkedin.com/in/simonegiannecchini
>
> -------------------------------------------------------
>
>
>
> On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
> <even.rouault@mines-paris.org> wrote:
> > Selon Ivan <ivan.lucena@pmldnet.com>:
> >
> > Ivan,
> >
> > thanks for your testing (CC'ing the list as it is of general interest).
> > Actually, I also read on some sites that using ByteBuffer object versus
> regular
> > Java arrays is not always a win. Plus the fact that we must use a direct
> buffer
> > that has an extra allocation cost according to the Javadoc. So ByteBuffer
> might
> > be interesting if you just want to pass big arrays between native code, for
> > example if you read an array from a dataset and then write it to another
> one
> > without accessing it from the Java side. When you mention that accessing
> through
> > the byte[] array was faster, did you get it with the array() method instead
> ?
> > I'm wondering what the performance overhead of this call is.
> >
> > As ByteBuffer is not at all a requirement for the interface with the native
> > code, it would be technically possible to add an alternative API that would
> use
> > the regular Java array types.
> >
> > Would you mind opening an enhancement ticket about that ? Thanks
> >
> > Even
> >
> >> Even,
> >>
> >> I did some test with the GDAL Java API and some simple raster operations
> >> like the GDAL Proximity algorthm and I noticed that the performance while
> >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is
> not
> >> as good as if you copy then to (or from) a "regular" array, like float[],
> >> double[], integer[] and byte[].
> >>
> >> The reason for that is obvious, get() and put() are funtion calls and
> >> contains a lot of code for range check.
> >>
> >> If I understand it correctly, ByteBuffer is the ideal or maybe the only
> >> way to get access to Buffers from C libraries thought a Java wrapper. But
> >> do you it would be possible to incapsulate the buffer conversion at the
> >> wrapper code so that users would be able to read and write direct to
> >> regular Java arrays?
> >>
> >> Just a suggestion,
> >>
> >> Ivan
> >>
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>


From even.rouault at mines-paris.org  Wed Nov 11 07:00:32 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Nov 11 07:00:38 2009
Subject: [gdal-dev] SPHEROID["unretrievable - using WGS84"...
In-Reply-To: <hddplu$ok4$1@ger.gmane.org>
References: <hddplu$ok4$1@ger.gmane.org>
Message-ID: <1257940832.4afaa760bba40@imp.free.fr>

Selon Hermann Peifer <peifer@gmx.eu>:

Hermann,

I've reproduced what you observe with trunk too and created ticket
http://trac.osgeo.org/gdal/ticket/3217 with 2 patches that solve the issue. One
must be applied in libgeotiff, the other one in the GTiff driver.

> Hi,
>
> testepsg EPSG:3785 gives [1], whereas
> gdalwarp -t_srs EPSG:3785 input.tif output.tif results into [2]
>
>
> This looks like a bug, or not? I am using gdal 1.6.2
>
> Hermann
>
>
> [1]
> Validate Succeeds.
> WKT[EPSG:3785] =
> PROJCS["Popular Visualisation CRS / Mercator",
>      GEOGCS["Popular Visualisation CRS",
>          DATUM["Popular_Visualisation_Datum",
>              SPHEROID["Popular Visualisation Sphere",6378137,0,
>                  AUTHORITY["EPSG","7059"]],
>              TOWGS84[0,0,0,0,0,0,0],
>              AUTHORITY["EPSG","6055"]],
>          PRIMEM["Greenwich",0,
>              AUTHORITY["EPSG","8901"]],
>          UNIT["degree",0.01745329251994328,
>              AUTHORITY["EPSG","9122"]],
>          AUTHORITY["EPSG","4055"]],
>      UNIT["metre",1,
>          AUTHORITY["EPSG","9001"]],
>      PROJECTION["Mercator_1SP"],
>      PARAMETER["central_meridian",0],
>      PARAMETER["scale_factor",1],
>      PARAMETER["false_easting",0],
>      PARAMETER["false_northing",0],
>      AUTHORITY["EPSG","3785"],
>      AXIS["X",EAST],
>      AXIS["Y",NORTH]]
>
> [2]
> Files: output.tif
> Size is 868, 580
> Coordinate System is:
> PROJCS["Popular Visualisation CRS / Mercator",
>      GEOGCS["Popular Visualisation CRS",
>          DATUM["unknown",
>              SPHEROID["unretrievable - using WGS84",6378137,298.257223563,
>                  AUTHORITY["EPSG","0"]],
>              AUTHORITY["EPSG","6055"]],
>          PRIMEM["Greenwich",0],
>          UNIT["degree",0.0174532925199433],
>          AUTHORITY["EPSG","4055"]],
>      UNIT["metre",1,
>          AUTHORITY["EPSG","9001"]],
>      AUTHORITY["EPSG","3785"]]
> Origin = (-5555588.989365539513528,11996289.038382656872272)
> Pixel Size = (15457.180606961637750,-15457.180606961637750)
> Metadata:
> (snip)
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From ivan.lucena at pmldnet.com  Wed Nov 11 08:11:51 2009
From: ivan.lucena at pmldnet.com (Ivan)
Date: Wed Nov 11 08:11:55 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <1257934501.4afa8ea572fb2@imp.free.fr>
References: <20091110205406.14591.qmail@s466.sureserver.com>
	<1257934501.4afa8ea572fb2@imp.free.fr>
Message-ID: <4AFAB817.6020801@pmldnet.com>

Even,

You are right. The point is how to take full advantage of the GDAL Java API choosing the right 
approach to deal with the raster buffer on the client side.

Best regards,

Ivan

Even Rouault wrote:
> Selon Ivan <ivan.lucena@pmldnet.com>:
> 
> Ivan,
> 
> I'm not sure what you are really measuring if you compare a C++ code versus its
> translation to Java code. I think it just reflects the known slowdown of Java
> when doing intensive computations in comparison to native code. The 0.2 second
> difference between the regular array version and the ByteBuffer one is the
> interesting result, not the 1.2/1.0 second difference between C++ and Java.
> 
>> Caio Simone,
>>
>> I just downloaded imageio-ext to check how it does that but it looks like I
>> don't need to do that now, I can take you report instead. Thank you very
>> much. I will take a look on array pinning for a start.
>>
>> I translated the GDAL Proximity [1] code to Java and I timed both of then
>> with the same input, a 1024x1024 byte image with just one pixel as feature at
>> the center of the image.
>>
>> It took 0.3 seconds in C++ and 1.5 seconds in Java!
>>
>> I then translated the buffers to regular arrays and it went down a little
>> bit, 1.3 seconds.
>>
>> It is still a big disadvantage. I believe that the buffer-to-buffer
>> translation is the guilt time waster in that case.
>>
>> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
>>
>> My best regards,
>>
>> Ivan
>>
>>>  -------Original Message-------
>>>  From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
>>>  Subject: Re: [gdal-dev] Re: JAVA API - Performance
>>>  Sent: Nov 10 '09 12:36
>>>
>>>  Ciao Even,
>>>  just wanted to add my 2 cents.
>>>
>>>  As you know for the imageio-ext project we have been using the
>>>  GDAL-JNI bindings (actually a modified version of them) for a while in
>>>  order to allow Java users to leverage on GDAL using the ImageIO
>>>  framework which standard in Java.
>>>  This way we also enabled GeoTools and GeoServer to use GDAL as a
>> datasource.
>>>  In the past I have done quite some performance tests to add some
>>>  new/different methods to them and I can summarise our findings as
>>>  follows:
>>>
>>>  - DirectByteBuffer vs regular arrays -
>>>  DBB is expensive to allocate but prevent the VM from performing copies
>>>  when having to move data to and from java and native code since they
>>>  live on the native space not on the java heap; On the other side the
>>>  regular arrays are fast to allocate but they are "usually" copied when
>>>  moved across from/to java and native code since the JVM cannot leave
>>>  the native code mess with the java heap space since the garbage
>>>  collector would not be very happy about that. I said "usually" since
>>>  there is a technique called array pinning that we can suggest the JVM
>>>  to use to avoid the copy of regular array; however this mechanism is
>>>  not guaranteed to be implemented and/or to work on each call (same
>>>  reason as above, GC is not happy about this technique).
>>>
>>>  If you can pool the DBB  and/or use a few large DBB, where the cost of
>>>  the copy would overcome the cost of its creation then DBB are much
>>>  better than regular arrays. As an instance I noticed that using when
>>>  reading striped tiff files regular arrays where faster, but as the
>>>  tile size increases (and therefore the cost of a copy overcomes the
>>>  cost of a DBB creation) the DBB performs much better
>>>
>>>  - DirectByteBuffer and the impact on some JVM -
>>>  Now in the past we decided to stick with DBB and give
>>>  GeoServer/GeoTools users the capability to retile data on the fly.
>>>  However lately, during the WMS performance shootout we noticed on some
>>>  linux machines JVm soldi crashed, not nice (means restarting the
>>>  GeoServer!!!).
>>>  We investigated a bit in depth and the problem was that somehow the
>>>  JVM was failing to allocate some internal images during the rendering
>>>  process and then dying with a NullPointerException (apparently the SUN
>>>  Java2D engineers did not use to check for out of memory errors in the
>>>  java native space). Well, what happens is that if you use too much of
>>>  the Java native space for your own objects, it is likely that the JVM
>>>  itself will start to malfunction (you can find articles on the web on
>>>  the memory model of a Java process, I don't think I am good enough to
>>>  explain it ) since it cannot allocate its own objects.
>>>
>>>  In the end we decide to leave DBB and go back to regular arrays with
>>>  array pinning. This ensured us robustness and we did not see much
>>>  performance degradation (which means that array pinning in the end
>>>  works). This has been implemented by modifying the SWIG bindings for
>>>  GDAL in order to use a byte array instead of a DBB and then use
>>>  ByteArray utils to convert between different native type (short, int,
>>>  etc..).
>>>
>>>  - Conclusion -
>>>  We might want to spend some time in the mid term to contribute some of
>>>  this work back (or probably provide funding), but anyway, it would be
>>>  great to have the capability to switch between DBB and regular arrays
>>>  since both have flaws.
>>>  However atm if I were asked I would say to go with regular arrays as
>>>  we do in the imageio-ext project.
>>>
>>>  Ciao,
>>>  Simone.
>>>  -------------------------------------------------------
>>>  Ing. Simone Giannecchini
>>>  GeoSolutions S.A.S.
>>>  Founder - Software Engineer
>>>  Via Carignoni 51
>>>  55041  Camaiore (LU)
>>>  Italy
>>>
>>>  phone: +39 0584983027
>>>  fax:      +39 0584983027
>>>  mob:    +39 333 8128928
>>>
>>>
>>>  http://www.geo-solutions.it
>>>  http://geo-solutions.blogspot.com/
>>>  http://simboss.blogspot.com/
>>>  http://www.linkedin.com/in/simonegiannecchini
>>>
>>>  -------------------------------------------------------
>>>
>>>
>>>
>>>  On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>>>  <even.rouault@mines-paris.org> wrote:
>>>  > Selon Ivan <ivan.lucena@pmldnet.com>:
>>>  >
>>>  > Ivan,
>>>  >
>>>  > thanks for your testing (CC'ing the list as it is of general interest).
>>>  > Actually, I also read on some sites that using ByteBuffer object versus
>> regular
>>>  > Java arrays is not always a win. Plus the fact that we must use a direct
>> buffer
>>>  > that has an extra allocation cost according to the Javadoc. So
>> ByteBuffer might
>>>  > be interesting if you just want to pass big arrays between native code,
>> for
>>>  > example if you read an array from a dataset and then write it to another
>> one
>>>  > without accessing it from the Java side. When you mention that accessing
>> through
>>>  > the byte[] array was faster, did you get it with the array() method
>> instead ?
>>>  > I'm wondering what the performance overhead of this call is.
>>>  >
>>>  > As ByteBuffer is not at all a requirement for the interface with the
>> native
>>>  > code, it would be technically possible to add an alternative API that
>> would use
>>>  > the regular Java array types.
>>>  >
>>>  > Would you mind opening an enhancement ticket about that ? Thanks
>>>  >
>>>  > Even
>>>  >
>>>  >> Even,
>>>  >>
>>>  >> I did some test with the GDAL Java API and some simple raster
>> operations
>>>  >> like the GDAL Proximity algorthm and I noticed that the performance
>> while
>>>  >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is
>> not
>>>  >> as good as if you copy then to (or from) a "regular" array, like
>> float[],
>>>  >> double[], integer[] and byte[].
>>>  >>
>>>  >> The reason for that is obvious, get() and put() are funtion calls and
>>>  >> contains a lot of code for range check.
>>>  >>
>>>  >> If I understand it correctly, ByteBuffer is the ideal or maybe the only
>>>  >> way to get access to Buffers from C libraries thought a Java wrapper.
>> But
>>>  >> do you it would be possible to incapsulate the buffer conversion at the
>>>  >> wrapper code so that users would be able to read and write direct to
>>>  >> regular Java arrays?
>>>  >>
>>>  >> Just a suggestion,
>>>  >>
>>>  >> Ivan
>>>  >>
>>>  >
>>>  >
>>>  > _______________________________________________
>>>  > gdal-dev mailing list
>>>  > gdal-dev@lists.osgeo.org
>>>  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>  >
>>>
> 
> 
> 

From john.callahan at UDel.Edu  Wed Nov 11 09:06:43 2009
From: john.callahan at UDel.Edu (John Callahan)
Date: Wed Nov 11 09:06:47 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <hde5ri$668$1@ger.gmane.org>
References: <4AF9C67A.1050307@udel.edu> <hde5ri$668$1@ger.gmane.org>
Message-ID: <4AFAC4F3.4090604@udel.edu>

Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 as 
well as the full PROJ4 string with the same result. When specifying 
-s_srs, does gdalwarp ignore (override) the project information in the 
hdr file?

If I include the Hughes 1980 ellipsoid in the hdr file (projection info 
line as described below), then gdalwarp returns that this ellipsoid is 
unrecognized and defaults to WGS84.  It then uses the WGS84 a,b 
parameters and not what I have set through -s_srs.   Well, at least 
that's what returned to the screen with --debug on.  Can I edit some 
config files to allow Hughes 1980 to be there?   (I'm using FWTools 
2.4.6, GDAL 1.7.0dev) 


So, I definitely would like to get my data projected correctly, but I 
also want to make sure my hdr file is correct.  I emailed NSIDC (where I 
obtained the data) to ask for a n appropriate header file.  If I know 
that is correct, then I can focus on the software doing the projecting. 

- John

**************************************************
John Callahan, Geospatial Application Developer
Delaware Geological Survey, University of Delaware
URL: http://www.dgs.udel.edu
**************************************************



Hermann Peifer wrote:
> Did you try: gdalwarp -s_srs EPSG:3412 ?
>
> Hermann
>
> John Callahan wrote:
>> Is it possible to define/set a coordinate system using GDAL?   I 
>> downloaded some data (from NSIDC) I know is in EPSG:3412.  
>> (http://spatialreference.org/ref/epsg/3412/, 
>> http://nsidc.org/data/atlas/epsg_3412.html)
>>
>> The data is in bsq format, therefore requires a hdr file that I've 
>> been piecing together manually.  The hdr file has a "projection info" 
>> line that defines the projection parameters.   Here is the hdr file 
>> I've been using, unsuccessfully:
>>
>> ENVI
>> description = {
>>  File Imported into ENVI.}
>> samples = 316
>> lines   = 332
>> bands   = 1
>> header offset = 300
>> file type = ENVI Standard
>> data type = 1
>> interleave = bsq
>> sensor type = Unknown
>> byte order = 0
>> map info = {NSIDC Sea Ice Polar Stereographic South, 1.0000, 1.0000, 
>> -3950000.0000, 4350000.0000, 2.5000000000e+004, 2.5000000000e+004, 
>> Hughes 1980, units=Meters}
>> projection info = {31, 6378273.0, 6356889.4, -70.000000, 0.000000, 
>> 0.0, 0.0, Hughes1980, NSIDC Sea Ice Polar Stereographic South, 
>> units=Meters}
>> wavelength units = Unknown
>> pixel size = {2.50000000e+004, 2.50000000e+004, units=Meters}
>>
>>
>>
>> The data displays properly with other vector data in EPSG:3412, say 
>> in QGIS.  To me, this simply means the "map info" line of correct.  
>> However, when I try to project the data (gdal_translate, gdalwarp), 
>> the output is nonsense (nearly all null or nodata).  I believe my 
>> "projection info" line is wrong, and may have something to do with 
>> denoting the lat of origin as -90 and standard parallel as -70.   
>> Thanks for any help.
>>
>> - John
>>
>> **************************************************
>> John Callahan, Geospatial Application Developer
>> Delaware Geological Survey, University of Delaware
>> URL: http://www.dgs.udel.edu
>> **************************************************
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
From spluque at gmail.com  Thu Nov  5 13:27:10 2009
From: spluque at gmail.com (Seb)
Date: Wed Nov 11 11:22:35 2009
Subject: [gdal-dev] importing HDF sea ice grid with unusual projection
Message-ID: <87zl6tvxox.fsf@kolob.sebmags.homelinux.org>

Hi,

I originally posted to the GRASS list, but it was suggested that it
would be more appropriate here, given that GRASS uses GDAL for this
particular problem.

I'm in the process of importing sea ice concentration data from:

ftp://ftp-projects.zmaw.de/seaice/AMSR-E_ASI_IceConc

I have chosen to use their HDF product because their Geotiff uses a
WGS84 datum that results in up to 500 m error at the borders, according
to their info files at the root of each subdirectory.

The grids are not georeferenced, but they use the same grid that NSIDC
does with the specifications given here:

http://nsidc.org/data/docs/daac/nsidc0002_ssmi_seaice.gd.html

Fortunately, there's an EPSG code (3411, for the northern hemisphere)
for that projection.

gdalinfo on the HDF file:

---<--------------------cut here---------------start------------------->---
$ gdalinfo asi-n6250-20020619-v5i.hdf 
Driver: HDF4Image/HDF4 Dataset
Files: asi-n6250-20020619-v5i.hdf
Size is 1216, 1792
Coordinate System is `'
Metadata:
  valid_range=0, 1
  long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1792.0)
Upper Right ( 1216.0,    0.0)
Lower Right ( 1216.0, 1792.0)
Center      (  608.0,  896.0)
Band 1 Block=1216x82 Type=Float32, ColorInterp=Gray
---<--------------------cut here---------------end--------------------->---

Converting to GTiff for importing into GRASS, using the EPSG code and
bounds in the NSIDC's info:

---<--------------------cut here---------------start------------------->---
$ gdal_translate -of GTiff -a_srs EPSG:3411 -a_ullr -3800000 5600000 3800000 -5600000 asi-n6250-20020619-v5i.hdf asi-n6250-20020619-v5i.tif 
Warning 6: A dataset opened by GDALOpenShared should have the same filename (asi-n6250-20020619-v5i.hdf) and description (HDF4_SDS:UNKNOWN:"asi-n6250-20020619-v5i.hdf":0)
Input file size is 1216, 1792
0...10...20...30...40...50...60...70...80...90...100 - done.

$ gdalinfo asi-n6250-20020619-v5i.tif 
Driver: GTiff/GeoTIFF
Files: asi-n6250-20020619-v5i.tif
Size is 1216, 1792
Coordinate System is:
PROJCS["NSIDC Sea Ice Polar Stereographic North",
    GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
        DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
            SPHEROID["Hughes 1980",6378273,298.279411123061,
                AUTHORITY["EPSG","7058"]],
            AUTHORITY["EPSG","6054"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4054"]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","3411"]]
Origin = (-3800000.000000000000000,5600000.000000000000000)
Pixel Size = (6250.000000000000000,-6250.000000000000000)
Metadata:
  AREA_OR_POINT=Area
  valid_range=0, 1
  long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-3800000.000, 5600000.000) 
Lower Left  (-3800000.000,-5600000.000) 
Upper Right ( 3800000.000, 5600000.000) 
Lower Right ( 3800000.000,-5600000.000) 
Center      (   0.0000000,   0.0000000) 
Band 1 Block=1216x1 Type=Float32, ColorInterp=Gray
---<--------------------cut here---------------end--------------------->---

So far so good, but when importing into a GRASS location:

---<--------------------cut here---------------start------------------->---
r.in.gdal in=/home/sluque/tmp/asi-n6250-20020619-v5i.tif out=test location=Test
WARNING: No projection name! Projection parameters likely to be
         meaningless.
WARNING: Datum <Not_specified_based_on_Hughes_1980_ellipsoid> not
         recognised by GRASS and no parameters found
Location <Test> created
 100%
r.in.gdal complete. Raster map <test> created.
---<--------------------cut here---------------end--------------------->---

What is missing here?  I've also tried using the proj4 strings offered
for that EPSG, but the results are the same.  Any tips would be appreciated.


Cheers,

-- 
Seb

From warmerdam at pobox.com  Wed Nov 11 12:16:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 11 12:16:38 2009
Subject: [gdal-dev] Re: UTM zones exceptions
In-Reply-To: <SNT123-W14840219FDB2D1C0B9786484AA0@phx.gbl>
References: <SNT123-W14840219FDB2D1C0B9786484AA0@phx.gbl>
Message-ID: <4AFAF16B.7020906@pobox.com>

G? G? wrote:
> Hi all and Franck,
> 
> I use OGR and GDAL in a software that has to manipulate and convert UTM 
> and WGS84 coordinates and maps.
> OGR/GDAL is very powerful and I'm very happy with it.
> 
> Nevertheless I have a (maybe stupid) question concerning UTM zones 
> exceptions, for instance for Norway where the 32V is a bit wider as
> it should be:
> http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system#Exceptions
> http://en.wikipedia.org/wiki/File:LA2-Europe-UTM-zones.png
> 
> Do I have to take this exceptions into account when I indicate an UTM 
> zone to OGR&GDAL (for instance with OSRSetUTM() or SetUTM() functions)
>  or do I have to work with OGR & GDAL as if there was no exception ?

G?rard,

GDAL/OGR/PROJ.4 does not currently have a function which can be used to
suggest the most appropriate UTM zone for a particular lat/long location,
so the exceptions are not relevant.

 >
 > (more pragmatically, if I'm on Norway west coast, do I indicate 31V or
 > 32V zone to OGR/GDAL?)

If you need to match a local map, then read the map to determine what it
uses.  If you just want to pick the most appropriate zone to minimize
distortion then using the normal six degree wide zone boundaries should
be fine.

I presume the exceptions exist to avoid having small slices of a country
mapped in a different zone than the rest and so they are effectively just
conventions about what zone to use for local mapping projects.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ekkehart at gmx.de  Wed Nov 11 14:00:16 2009
From: ekkehart at gmx.de (NopMap)
Date: Wed Nov 11 14:00:19 2009
Subject: [Gdal-dev] gdal_contour crashing
Message-ID: <1257966016996-3988183.post@n2.nabble.com>


Hi!

I have sudden problem with gdal_contour after using ist successfully many
times. There seems to be a problem with a certain area. When I tried it
first, gdal_contour quit with an out-of-memory message, exceeding 2GB of
virtual memory. When I reduced the area and called


gdal_merge.py -o M:\srtm\Hillshading_srtm.tif -ul_lr 6.3 45.4 9.2 43.5
M:\srtm\ 
gdal_contour -i 10 -snodata 32767 -a height M:\srtm\Hillshading_srtm.tif
M:\srtm\Hillshading_shape.shp 

it just hung at about 80% completion, no more CPU activity. It worked on a
neighboring area before.

The data was merged from downloaded CGIAR 5x5 data. Hillshading_srtm.tif
looks good in a viewer and in gdal_info and the perrygeo hillshade.exe was
able to produce nice shadings from the same data.

GDAL Version is 160, binaries on Windows XP.

What can I do to track down this problem, except for making the area smaller
and smaller? I have not found a verbose setting on gdal_contour. Any ideas
what could cause this behaviour?

thanks

          Nop

-- 
View this message in context: http://n2.nabble.com/gdal-contour-crashing-tp3988183p3988183.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From warmerdam at pobox.com  Wed Nov 11 14:05:28 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 11 14:05:39 2009
Subject: [Gdal-dev] gdal_contour crashing
In-Reply-To: <1257966016996-3988183.post@n2.nabble.com>
References: <1257966016996-3988183.post@n2.nabble.com>
Message-ID: <4AFB0AF8.5060305@pobox.com>

NopMap wrote:
> Hi!
> 
> I have sudden problem with gdal_contour after using ist successfully many
> times. There seems to be a problem with a certain area. When I tried it
> first, gdal_contour quit with an out-of-memory message, exceeding 2GB of
> virtual memory. When I reduced the area and called
> 
> 
> gdal_merge.py -o M:\srtm\Hillshading_srtm.tif -ul_lr 6.3 45.4 9.2 43.5
> M:\srtm\ 
> gdal_contour -i 10 -snodata 32767 -a height M:\srtm\Hillshading_srtm.tif
> M:\srtm\Hillshading_shape.shp 
> 
> it just hung at about 80% completion, no more CPU activity. It worked on a
> neighboring area before.
> 
> The data was merged from downloaded CGIAR 5x5 data. Hillshading_srtm.tif
> looks good in a viewer and in gdal_info and the perrygeo hillshade.exe was
> able to produce nice shadings from the same data.
> 
> GDAL Version is 160, binaries on Windows XP.
> 
> What can I do to track down this problem, except for making the area smaller
> and smaller? I have not found a verbose setting on gdal_contour. Any ideas
> what could cause this behaviour?

Nop,

I'm not sure why this is happening.  I will note that gdal_contour holds
contours in memory as it proceeds through the image until it has passed the
contour at which point it is emitted to disk.  This can results in high memory
use if there are lots of long (vertically) contours. Also, high contour density
can occur if there are crazy no-data values in the raster (ie. -1e7 in a
floating point raster) which can trigger a huge "pile" of contours around
the bad data value.

If you can isolate the problem to a reasonably transportable sized raster,
you could file a ticket and myself or someone else could look into the
poor performance more closely.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ekkehart at gmx.de  Wed Nov 11 14:45:17 2009
From: ekkehart at gmx.de (NopMap)
Date: Wed Nov 11 14:45:19 2009
Subject: [Gdal-dev] gdal_contour crashing
In-Reply-To: <4AFB0AF8.5060305@pobox.com>
References: <1257966016996-3988183.post@n2.nabble.com>
	<4AFB0AF8.5060305@pobox.com>
Message-ID: <1257968717199-3988439.post@n2.nabble.com>



Hi!


Frank Warmerdam wrote:
> 
> Also, high contour density
> can occur if there are crazy no-data values in the raster (ie. -1e7 in a
> floating point raster) which can trigger a huge "pile" of contours around
> the bad data value.
> 

I think you are right. After another subdivision, both halves did process
properly.

Looking for artefacts in the data, I noted that there is a very unnatural
drop at the coastline that also produced a bunch of contours where there
should be none. Probably the coastline is some kind of "cliff" in the data.
Do you think this could be responsible?

Being a GIS amateur: Is there a way to get the sea level to 0 and eliminate
this weird "cliff" along the coastline?

thanks
            Nop

-- 
View this message in context: http://n2.nabble.com/gdal-contour-crashing-tp3988183p3988439.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From peifer at gmx.eu  Thu Nov 12 03:33:23 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Thu Nov 12 03:34:01 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFAC4F3.4090604@udel.edu>
References: <4AF9C67A.1050307@udel.edu> <hde5ri$668$1@ger.gmane.org>
	<4AFAC4F3.4090604@udel.edu>
Message-ID: <4AFBC853.7050306@gmx.eu>

John Callahan wrote:
> Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 as 
> well as the full PROJ4 string with the same result. When specifying 
> -s_srs, does gdalwarp ignore (override) the project information in the 
> hdr file?
> 

Hmm. AFAIK: gdal_translate -a_srs does override the file's projection 
information. I have a random.tif in LAEA projection (EPSG:3035), so I 
tried the following with gdal 1.6.2:

gdal_translate random.tif out1.tif -a_srs EPSG:3412  # this results in [1]

gdal_translate random.tif out2.tif -a_srs "+proj=stere +lat_0=-90 
+lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 
+units=m +no_defs"  # this gives [2]

To me as an innocent GDAL user, this behaviour looks similar to 
http://trac.osgeo.org/gdal/ticket/3016. I might be wrong, though, in 
particular as you wrote that using the PROJ.4 string didn't help (and 
your source file isn't a GeoTIFF in the first place).

Hermann


[1]
$ gdalinfo out1.tif
Driver: GTiff/GeoTIFF
Files: out1.tif
Size is 570, 460
Coordinate System is:
PROJCS["NSIDC Sea Ice Polar Stereographic South",
     GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
         DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
             SPHEROID["Hughes 1980",6378273,298.279411123064,
                 AUTHORITY["EPSG","7058"]],
             AUTHORITY["EPSG","6054"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4054"]],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AUTHORITY["EPSG","3412"]]
Origin = (1500000.000000000000000,5500000.000000000000000)
Pixel Size = (10000.000000000000000,-10000.000000000000000)
(...)


[2]
gdalinfo out2.tif
Driver: GTiff/GeoTIFF
Files: out2.tif
Size is 570, 460
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["unnamed ellipse",
         DATUM["unknown",
             SPHEROID["unnamed",6378273,298.279411123064]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Polar_Stereographic"],
     PARAMETER["latitude_of_origin",-70],
     PARAMETER["central_meridian",0],
     PARAMETER["scale_factor",1],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (1500000.000000000000000,5500000.000000000000000)
Pixel Size = (10000.000000000000000,-10000.000000000000000)
(...)
From warmerdam at pobox.com  Thu Nov 12 08:49:24 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Nov 12 08:49:35 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFBC853.7050306@gmx.eu>
References: <4AF9C67A.1050307@udel.edu> <hde5ri$668$1@ger.gmane.org>
	<4AFAC4F3.4090604@udel.edu> <4AFBC853.7050306@gmx.eu>
Message-ID: <4AFC1264.5060401@pobox.com>

Hermann Peifer wrote:
> John Callahan wrote:
>> Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 as 
>> well as the full PROJ4 string with the same result. When specifying 
>> -s_srs, does gdalwarp ignore (override) the project information in the 
>> hdr file?
>>
> 
> Hmm. AFAIK: gdal_translate -a_srs does override the file's projection 
> information. I have a random.tif in LAEA projection (EPSG:3035), so I 
> tried the following with gdal 1.6.2:
> 
> gdal_translate random.tif out1.tif -a_srs EPSG:3412  # this results in [1]
> 
> gdal_translate random.tif out2.tif -a_srs "+proj=stere +lat_0=-90 
> +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 
> +units=m +no_defs"  # this gives [2]
> 
> To me as an innocent GDAL user, this behaviour looks similar to 
> http://trac.osgeo.org/gdal/ticket/3016. I might be wrong, though, in 
> particular as you wrote that using the PROJ.4 string didn't help (and 
> your source file isn't a GeoTIFF in the first place).

Hermann,

I have confirmed this problem and filed it as:

   http://trac.osgeo.org/gdal/ticket/3220

It is presumably a problem with translation of a specific projection method,
possibly in libgeotiff itself.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From peifer at gmx.eu  Thu Nov 12 09:44:41 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Thu Nov 12 09:45:20 2009
Subject: [gdal-dev] Re: importing HDF sea ice grid with unusual projection
In-Reply-To: <87zl6tvxox.fsf@kolob.sebmags.homelinux.org>
References: <87zl6tvxox.fsf@kolob.sebmags.homelinux.org>
Message-ID: <4AFC1F59.8080504@gmx.eu>

 > I've also tried using the proj4 strings offered
 > for that EPSG, but the results are the same.

Hmm. It it looks to me that this should work:

gdal_translate -a_srs "+proj=stere +lat_0=90 +lat_ts=70 +lon_0=-45 +k=1 
+x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -a_ullr ...

See [1] for gdalinfo's output from the resulting GeoTIFF.

Your case seems to be related to the recently opened ticket 
http://trac.osgeo.org/gdal/ticket/3220

Hermann


[1]

$ gdalinfo  asi-n6250-20020619-v5i_proj4.tif
Driver: GTiff/GeoTIFF
Files: asi-n6250-20020619-v5i_proj4.tif
Size is 1216, 1792
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["GCS Name = unnamed ellipse|Datum = unknown|Ellipsoid = 
unnamed|Primem = Greenwich|",
         DATUM["unknown",
             SPHEROID["unnamed",6378273,298.279411123064]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Polar_Stereographic"],
     PARAMETER["latitude_of_origin",70],
     PARAMETER["central_meridian",-45],
     PARAMETER["scale_factor",1],
     PARAMETER["false_easting",0],
     PARAMETER["false_northing",0],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (-3800000.000000000000000,5600000.000000000000000)
Pixel Size = (6250.000000000000000,-6250.000000000000000)
Metadata:
(...)


Seb wrote:
> Hi,
> 
> I originally posted to the GRASS list, but it was suggested that it
> would be more appropriate here, given that GRASS uses GDAL for this
> particular problem.
> 
> I'm in the process of importing sea ice concentration data from:
> 
> ftp://ftp-projects.zmaw.de/seaice/AMSR-E_ASI_IceConc
> 
> I have chosen to use their HDF product because their Geotiff uses a
> WGS84 datum that results in up to 500 m error at the borders, according
> to their info files at the root of each subdirectory.
> 
> The grids are not georeferenced, but they use the same grid that NSIDC
> does with the specifications given here:
> 
> http://nsidc.org/data/docs/daac/nsidc0002_ssmi_seaice.gd.html
> 
> Fortunately, there's an EPSG code (3411, for the northern hemisphere)
> for that projection.
> 
> gdalinfo on the HDF file:
> 
> ---<--------------------cut here---------------start------------------->---
> $ gdalinfo asi-n6250-20020619-v5i.hdf 
> Driver: HDF4Image/HDF4 Dataset
> Files: asi-n6250-20020619-v5i.hdf
> Size is 1216, 1792
> Coordinate System is `'
> Metadata:
>   valid_range=0, 1
>   long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 1792.0)
> Upper Right ( 1216.0,    0.0)
> Lower Right ( 1216.0, 1792.0)
> Center      (  608.0,  896.0)
> Band 1 Block=1216x82 Type=Float32, ColorInterp=Gray
> ---<--------------------cut here---------------end--------------------->---
> 
> Converting to GTiff for importing into GRASS, using the EPSG code and
> bounds in the NSIDC's info:
> 
> ---<--------------------cut here---------------start------------------->---
> $ gdal_translate -of GTiff -a_srs EPSG:3411 -a_ullr -3800000 5600000 3800000 -5600000 asi-n6250-20020619-v5i.hdf asi-n6250-20020619-v5i.tif 
> Warning 6: A dataset opened by GDALOpenShared should have the same filename (asi-n6250-20020619-v5i.hdf) and description (HDF4_SDS:UNKNOWN:"asi-n6250-20020619-v5i.hdf":0)
> Input file size is 1216, 1792
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> 
> $ gdalinfo asi-n6250-20020619-v5i.tif 
> Driver: GTiff/GeoTIFF
> Files: asi-n6250-20020619-v5i.tif
> Size is 1216, 1792
> Coordinate System is:
> PROJCS["NSIDC Sea Ice Polar Stereographic North",
>     GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
>         DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
>             SPHEROID["Hughes 1980",6378273,298.279411123061,
>                 AUTHORITY["EPSG","7058"]],
>             AUTHORITY["EPSG","6054"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4054"]],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","3411"]]
> Origin = (-3800000.000000000000000,5600000.000000000000000)
> Pixel Size = (6250.000000000000000,-6250.000000000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   valid_range=0, 1
>   long_name=ASI Ice Concentration, 20020619, res: 6.25000, AMSR-E, ASI Version: 5.5i, missing data interpolated.
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-3800000.000, 5600000.000) 
> Lower Left  (-3800000.000,-5600000.000) 
> Upper Right ( 3800000.000, 5600000.000) 
> Lower Right ( 3800000.000,-5600000.000) 
> Center      (   0.0000000,   0.0000000) 
> Band 1 Block=1216x1 Type=Float32, ColorInterp=Gray
> ---<--------------------cut here---------------end--------------------->---
> 
> So far so good, but when importing into a GRASS location:
> 
> ---<--------------------cut here---------------start------------------->---
> r.in.gdal in=/home/sluque/tmp/asi-n6250-20020619-v5i.tif out=test location=Test
> WARNING: No projection name! Projection parameters likely to be
>          meaningless.
> WARNING: Datum <Not_specified_based_on_Hughes_1980_ellipsoid> not
>          recognised by GRASS and no parameters found
> Location <Test> created
>  100%
> r.in.gdal complete. Raster map <test> created.
> ---<--------------------cut here---------------end--------------------->---
> 
> What is missing here?  I've also tried using the proj4 strings offered
> for that EPSG, but the results are the same.  Any tips would be appreciated.
> 
> 
> Cheers,
> 

From john.callahan at UDel.Edu  Thu Nov 12 11:02:31 2009
From: john.callahan at UDel.Edu (John Callahan)
Date: Thu Nov 12 11:02:42 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFC1264.5060401@pobox.com>
References: <4AF9C67A.1050307@udel.edu>
	<hde5ri$668$1@ger.gmane.org>	<4AFAC4F3.4090604@udel.edu>
	<4AFBC853.7050306@gmx.eu> <4AFC1264.5060401@pobox.com>
Message-ID: <4AFC3197.40608@udel.edu>

Thanks Frank/Hermann for your responses.  However, something odd seems 
to be going on here. I feel like I'm missing something on how GDAL 
handles coordinate system information.

Using the same input data set, and converting to different formats, the 
description of the output coordinate systems are different. Is this 
expected?   Here are the gdal_translate commands and their respective 
output files gdalinfo descriptions below.

[1] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
+k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of 
GTiff nt_200712_f13_v01_s.bsq nsidc_test.tif

[2] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
+k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of HFA 
nt_200712_f13_v01_s.bsq nsidc_test.img

[3] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
+k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of 
HDF4Image nt_200712_f13_v01_s.bsq nsidc_test.hdf

[4] gdal_translate -a_srs EPSG:3412 -of GTiff nt_200712_f13_v01_s.bsq 
nsidc_test_epsg.tif

[5] gdal_translate -a_srs EPSG:3412 -of HFA nt_200712_f13_v01_s.bsq 
nsidc_test_epsg.img


Fortunately, I can display these images fine.  They overlay nicely in 
QGIS with some vector data I have.   However, the problem occurs when 
projecting to EPSG:4326 (or similar) coordinate system; the output files 
are incorrect/missing data.  (It displays data from roughly lat -39.25 
only down to roughly -54.75 when data exists all the way down to -90.)

One possible cause could be that gdalinfo reports (for all of these 
datasets) latitude_of_origin as -70.  From 
http://nsidc.org/data/atlas/epsg_3412.html, the latitude of origin 
should be -90 and the latitude of standard parallel should be -70.  Or 
the problem could be somewhere in gdalwarp, or specifically with the 
Hughes 1980 ellipsoid.  I have no idea.  Thanks.

- John



[1] Driver: GTiff/GeoTIFF
Files: nsidc_test.tif
Size is 316, 332
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",6378273,298.279411123061]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-70],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-3950000.000000000000000,4350000.000000000000000)
Pixel Size = (25000.000000000000000,-25000.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
Band 1 Block=316x25 Type=Byte, ColorInterp=Gray


[2] Driver: HFA/Erdas Imagine Images (.img)
Files: nsidc_test.img
Size is 316, 332
Coordinate System is:
PROJCS["Stereographic_South_Pole",
    GEOGCS["GCS_unnamed ellipse",
        DATUM["unknown",
            SPHEROID["Unknown",6378273,298.279411123061]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-70],
    PARAMETER["central_meridian",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (-3950000.000000000000000,4350000.000000000000000)
Pixel Size = (25000.000000000000000,-25000.000000000000000)
Corner Coordinates:
Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
  Metadata:
    LAYER_TYPE=athematic


[3] Driver: HDF4Image/HDF4 Dataset
Files: nsidc_test.hdf
Size is 316, 332
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",6378273,298.279411123061]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-70],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (-3950000.000000000000000,4350000.000000000000000)
Pixel Size = (25000.000000000000000,-25000.000000000000000)
Metadata:
  Signature=Created with GDAL (http://www.remotesensing.org/gdal/)
  TransformationMatrix=-3950000.000000, 25000.000000, 0.000000, 
4350000.000000, 0.000000, -25000.000000
  Projection=PROJCS["unnamed",GEOGCS["unnamed 
ellipse",DATUM["unknown",SPHEROID["unnamed",6378273,298.279411123061]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Polar_Stereographic"],PARAMETER["latitude_of_origin",-70],PARAMETER["central_meridian",0],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]]
Corner Coordinates:
Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
Band 1 Block=316x316 Type=Byte, ColorInterp=Gray


[4] Driver: GTiff/GeoTIFF
Files: nsidc_test_epsg.tif
Size is 316, 332
Coordinate System is:
PROJCS["NSIDC Sea Ice Polar Stereographic South",
    GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
        DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
            SPHEROID["Hughes 1980",6378273,298.279411123061,
                AUTHORITY["EPSG","7058"]],
            AUTHORITY["EPSG","6054"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4054"]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","3412"]]
Origin = (-3950000.000000000000000,4350000.000000000000000)
Pixel Size = (25000.000000000000000,-25000.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (-3950000.000, 4350000.000)
Lower Left  (-3950000.000,-3950000.000)
Upper Right ( 3950000.000, 4350000.000)
Lower Right ( 3950000.000,-3950000.000)
Center      (       0.000,  200000.000)
Band 1 Block=316x25 Type=Byte, ColorInterp=Gray


[5] Driver: HFA/Erdas Imagine Images (.img)
Files: nsidc_test_epsg.img
Size is 316, 332
Coordinate System is:
PROJCS["NSIDC_Sea_Ice_Polar_Stereographic_South",
    GEOGCS["GCS_Unspecified datum based upon the Hughes 1980 ellipsoid",
        DATUM["Hungarian_Datum_1909",
            SPHEROID["Hughes_1980",6378273,298.279411123061]],
        PRIMEM["Greenwich",0],
        UNIT["Degree",0.017453292519943295]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-70],
    PARAMETER["central_meridian",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (-3950000.000000000000000,4350000.000000000000000)
Pixel Size = (25000.000000000000000,-25000.000000000000000)
Corner Coordinates:
Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
  Metadata:
    LAYER_TYPE=athematic




Frank Warmerdam wrote:
> Hermann Peifer wrote:
>> John Callahan wrote:
>>> Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 
>>> as well as the full PROJ4 string with the same result. When 
>>> specifying -s_srs, does gdalwarp ignore (override) the project 
>>> information in the hdr file?
>>>
>>
>> Hmm. AFAIK: gdal_translate -a_srs does override the file's projection 
>> information. I have a random.tif in LAEA projection (EPSG:3035), so I 
>> tried the following with gdal 1.6.2:
>>
>> gdal_translate random.tif out1.tif -a_srs EPSG:3412  # this results 
>> in [1]
>>
>> gdal_translate random.tif out2.tif -a_srs "+proj=stere +lat_0=-90 
>> +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 
>> +units=m +no_defs"  # this gives [2]
>>
>> To me as an innocent GDAL user, this behaviour looks similar to 
>> http://trac.osgeo.org/gdal/ticket/3016. I might be wrong, though, in 
>> particular as you wrote that using the PROJ.4 string didn't help (and 
>> your source file isn't a GeoTIFF in the first place).
>
> Hermann,
>
> I have confirmed this problem and filed it as:
>
>   http://trac.osgeo.org/gdal/ticket/3220
>
> It is presumably a problem with translation of a specific projection 
> method,
> possibly in libgeotiff itself.
>
> Best regards,
From warmerdam at pobox.com  Thu Nov 12 12:38:46 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Nov 12 12:38:52 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFC3197.40608@udel.edu>
References: <4AF9C67A.1050307@udel.edu> <hde5ri$668$1@ger.gmane.org>
	<4AFAC4F3.4090604@udel.edu> <4AFBC853.7050306@gmx.eu>
	<4AFC1264.5060401@pobox.com> <4AFC3197.40608@udel.edu>
Message-ID: <4AFC4826.200@pobox.com>

John Callahan wrote:
> Thanks Frank/Hermann for your responses.  However, something odd seems 
> to be going on here. I feel like I'm missing something on how GDAL 
> handles coordinate system information.
 >
> Using the same input data set, and converting to different formats, the 
> description of the output coordinate systems are different. Is this 
> expected?   Here are the gdal_translate commands and their respective 
> output files gdalinfo descriptions below.

John,

I think the key thing is that coordinate system encoding mechanisms
tend to vary from file format to file format.  A few points of note:

  o GeoTIFF has two general ways of encoding - one is to just embed
    the EPSG PCS code for a whole coordinate system.  The other is
    to encode the projection method along with the parameters.  You
    will tend to get the first when specifying the coordinate system
    with EPSG:n and the second when using PROJ.4 strings.

  o Many geospatial formats have a particular way of representing
    projections, and may not support all projection methods, preserving
    datums, preserving names, etc.

> [1] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
> +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of 
> GTiff nt_200712_f13_v01_s.bsq nsidc_test.tif
> 
> [2] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
> +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of HFA 
> nt_200712_f13_v01_s.bsq nsidc_test.img
...
> Fortunately, I can display these images fine.  They overlay nicely in 
> QGIS with some vector data I have.   However, the problem occurs when 
> projecting to EPSG:4326 (or similar) coordinate system; the output files 
> are incorrect/missing data.  (It displays data from roughly lat -39.25 
> only down to roughly -54.75 when data exists all the way down to -90.)
> 
> One possible cause could be that gdalinfo reports (for all of these 
> datasets) latitude_of_origin as -70.  From 
> http://nsidc.org/data/atlas/epsg_3412.html, the latitude of origin 
> should be -90 and the latitude of standard parallel should be -70.  Or 
> the problem could be somewhere in gdalwarp, or specifically with the 
> Hughes 1980 ellipsoid.  I have no idea.  Thanks.

It sounds like there may be another issues with regard to the latitude
of origin in addition to the issue with GeoTIFF not working properly with
3412.  If you can isolate and file a ticket that might be helpful.

I'm sorry I haven't been following some of the recent srs threads very
closely.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From peifer at gmx.eu  Thu Nov 12 12:43:23 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Thu Nov 12 12:44:10 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFC3197.40608@udel.edu>
References: <4AF9C67A.1050307@udel.edu>	<hde5ri$668$1@ger.gmane.org>	<4AFAC4F3.4090604@udel.edu>	<4AFBC853.7050306@gmx.eu>
	<4AFC1264.5060401@pobox.com> <4AFC3197.40608@udel.edu>
Message-ID: <4AFC493B.9090405@gmx.eu>

John,

I guess you are right:  "+lat_0=-90" shouldn't result into 
"PARAMETER["latitude_of_origin",-70]". There seems to be some parameter 
confusion.

It also looks like
http://spatialreference.org/ref/epsg/3412/prettywkt/ would be wrong in 
this case.

EPSG guidance notes 7.2 describe polar stereographic projection with 
variants A, B and C... I am not the ultimate expert here. It might be 
worth to ask for clarification in the proj mailing list.

Hermann


John Callahan wrote:
> Thanks Frank/Hermann for your responses.  However, something odd seems 
> to be going on here. I feel like I'm missing something on how GDAL 
> handles coordinate system information.
> 
> Using the same input data set, and converting to different formats, the 
> description of the output coordinate systems are different. Is this 
> expected?   Here are the gdal_translate commands and their respective 
> output files gdalinfo descriptions below.
> 
> [1] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
> +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of 
> GTiff nt_200712_f13_v01_s.bsq nsidc_test.tif
> 
> [2] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
> +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of HFA 
> nt_200712_f13_v01_s.bsq nsidc_test.img
> 
> [3] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 +lon_0=0 
> +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m +no_defs" -of 
> HDF4Image nt_200712_f13_v01_s.bsq nsidc_test.hdf
> 
> [4] gdal_translate -a_srs EPSG:3412 -of GTiff nt_200712_f13_v01_s.bsq 
> nsidc_test_epsg.tif
> 
> [5] gdal_translate -a_srs EPSG:3412 -of HFA nt_200712_f13_v01_s.bsq 
> nsidc_test_epsg.img
> 
> 
> Fortunately, I can display these images fine.  They overlay nicely in 
> QGIS with some vector data I have.   However, the problem occurs when 
> projecting to EPSG:4326 (or similar) coordinate system; the output files 
> are incorrect/missing data.  (It displays data from roughly lat -39.25 
> only down to roughly -54.75 when data exists all the way down to -90.)
> 
> One possible cause could be that gdalinfo reports (for all of these 
> datasets) latitude_of_origin as -70.  From 
> http://nsidc.org/data/atlas/epsg_3412.html, the latitude of origin 
> should be -90 and the latitude of standard parallel should be -70.  Or 
> the problem could be somewhere in gdalwarp, or specifically with the 
> Hughes 1980 ellipsoid.  I have no idea.  Thanks.
> 
> - John
> 
> 
> 
> [1] Driver: GTiff/GeoTIFF
> Files: nsidc_test.tif
> Size is 316, 332
> Coordinate System is:
> PROJCS["unnamed",
>    GEOGCS["unnamed ellipse",
>        DATUM["unknown",
>            SPHEROID["unnamed",6378273,298.279411123061]],
>        PRIMEM["Greenwich",0],
>        UNIT["degree",0.0174532925199433]],
>    PROJECTION["Polar_Stereographic"],
>    PARAMETER["latitude_of_origin",-70],
>    PARAMETER["central_meridian",0],
>    PARAMETER["scale_factor",1],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["metre",1,
>        AUTHORITY["EPSG","9001"]]]
> Origin = (-3950000.000000000000000,4350000.000000000000000)
> Pixel Size = (25000.000000000000000,-25000.000000000000000)
> Metadata:
>  AREA_OR_POINT=Area
> Image Structure Metadata:
>  INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
> Band 1 Block=316x25 Type=Byte, ColorInterp=Gray
> 
> 
> [2] Driver: HFA/Erdas Imagine Images (.img)
> Files: nsidc_test.img
> Size is 316, 332
> Coordinate System is:
> PROJCS["Stereographic_South_Pole",
>    GEOGCS["GCS_unnamed ellipse",
>        DATUM["unknown",
>            SPHEROID["Unknown",6378273,298.279411123061]],
>        PRIMEM["Greenwich",0],
>        UNIT["Degree",0.017453292519943295]],
>    PROJECTION["Polar_Stereographic"],
>    PARAMETER["latitude_of_origin",-70],
>    PARAMETER["central_meridian",0],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["Meter",1]]
> Origin = (-3950000.000000000000000,4350000.000000000000000)
> Pixel Size = (25000.000000000000000,-25000.000000000000000)
> Corner Coordinates:
> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
> Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
>  Metadata:
>    LAYER_TYPE=athematic
> 
> 
> [3] Driver: HDF4Image/HDF4 Dataset
> Files: nsidc_test.hdf
> Size is 316, 332
> Coordinate System is:
> PROJCS["unnamed",
>    GEOGCS["unnamed ellipse",
>        DATUM["unknown",
>            SPHEROID["unnamed",6378273,298.279411123061]],
>        PRIMEM["Greenwich",0],
>        UNIT["degree",0.0174532925199433]],
>    PROJECTION["Polar_Stereographic"],
>    PARAMETER["latitude_of_origin",-70],
>    PARAMETER["central_meridian",0],
>    PARAMETER["scale_factor",1],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["Meter",1]]
> Origin = (-3950000.000000000000000,4350000.000000000000000)
> Pixel Size = (25000.000000000000000,-25000.000000000000000)
> Metadata:
>  Signature=Created with GDAL (http://www.remotesensing.org/gdal/)
>  TransformationMatrix=-3950000.000000, 25000.000000, 0.000000, 
> 4350000.000000, 0.000000, -25000.000000
>  Projection=PROJCS["unnamed",GEOGCS["unnamed 
> ellipse",DATUM["unknown",SPHEROID["unnamed",6378273,298.279411123061]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Polar_Stereographic"],PARAMETER["latitude_of_origin",-70],PARAMETER["central_meridian",0],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]] 
> 
> Corner Coordinates:
> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
> Band 1 Block=316x316 Type=Byte, ColorInterp=Gray
> 
> 
> [4] Driver: GTiff/GeoTIFF
> Files: nsidc_test_epsg.tif
> Size is 316, 332
> Coordinate System is:
> PROJCS["NSIDC Sea Ice Polar Stereographic South",
>    GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
>        DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
>            SPHEROID["Hughes 1980",6378273,298.279411123061,
>                AUTHORITY["EPSG","7058"]],
>            AUTHORITY["EPSG","6054"]],
>        PRIMEM["Greenwich",0],
>        UNIT["degree",0.0174532925199433],
>        AUTHORITY["EPSG","4054"]],
>    UNIT["metre",1,
>        AUTHORITY["EPSG","9001"]],
>    AUTHORITY["EPSG","3412"]]
> Origin = (-3950000.000000000000000,4350000.000000000000000)
> Pixel Size = (25000.000000000000000,-25000.000000000000000)
> Metadata:
>  AREA_OR_POINT=Area
> Image Structure Metadata:
>  INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (-3950000.000, 4350000.000)
> Lower Left  (-3950000.000,-3950000.000)
> Upper Right ( 3950000.000, 4350000.000)
> Lower Right ( 3950000.000,-3950000.000)
> Center      (       0.000,  200000.000)
> Band 1 Block=316x25 Type=Byte, ColorInterp=Gray
> 
> 
> [5] Driver: HFA/Erdas Imagine Images (.img)
> Files: nsidc_test_epsg.img
> Size is 316, 332
> Coordinate System is:
> PROJCS["NSIDC_Sea_Ice_Polar_Stereographic_South",
>    GEOGCS["GCS_Unspecified datum based upon the Hughes 1980 ellipsoid",
>        DATUM["Hungarian_Datum_1909",
>            SPHEROID["Hughes_1980",6378273,298.279411123061]],
>        PRIMEM["Greenwich",0],
>        UNIT["Degree",0.017453292519943295]],
>    PROJECTION["Polar_Stereographic"],
>    PARAMETER["latitude_of_origin",-70],
>    PARAMETER["central_meridian",0],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    UNIT["Meter",1]]
> Origin = (-3950000.000000000000000,4350000.000000000000000)
> Pixel Size = (25000.000000000000000,-25000.000000000000000)
> Corner Coordinates:
> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
> Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
>  Metadata:
>    LAYER_TYPE=athematic
> 
> 
> 
> 
> Frank Warmerdam wrote:
>> Hermann Peifer wrote:
>>> John Callahan wrote:
>>>> Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 
>>>> as well as the full PROJ4 string with the same result. When 
>>>> specifying -s_srs, does gdalwarp ignore (override) the project 
>>>> information in the hdr file?
>>>>
>>>
>>> Hmm. AFAIK: gdal_translate -a_srs does override the file's projection 
>>> information. I have a random.tif in LAEA projection (EPSG:3035), so I 
>>> tried the following with gdal 1.6.2:
>>>
>>> gdal_translate random.tif out1.tif -a_srs EPSG:3412  # this results 
>>> in [1]
>>>
>>> gdal_translate random.tif out2.tif -a_srs "+proj=stere +lat_0=-90 
>>> +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 
>>> +units=m +no_defs"  # this gives [2]
>>>
>>> To me as an innocent GDAL user, this behaviour looks similar to 
>>> http://trac.osgeo.org/gdal/ticket/3016. I might be wrong, though, in 
>>> particular as you wrote that using the PROJ.4 string didn't help (and 
>>> your source file isn't a GeoTIFF in the first place).
>>
>> Hermann,
>>
>> I have confirmed this problem and filed it as:
>>
>>   http://trac.osgeo.org/gdal/ticket/3220
>>
>> It is presumably a problem with translation of a specific projection 
>> method,
>> possibly in libgeotiff itself.
>>
>> Best regards,

From brodzik at nsidc.org  Thu Nov 12 14:32:55 2009
From: brodzik at nsidc.org (Mary Jo Brodzik)
Date: Thu Nov 12 15:00:02 2009
Subject: [gdal-dev] trying to change regionator image resampling to
	nearest-neighbor
Message-ID: <alpine.LNX.1.10.0911121102170.20251@wuzzles.colorado.edu>


Dear gdal-dev list members,

I'm using a python tool called the regionator 
(http://code.google.com/p/regionator/wiki/ Welcome) on a large 
(14352x7440) png image.  The regionator uses the GDAL library to resample 
subsets of the original image into much smaller chunk images.  These 
images are set up at increasing levels of detail in a kml file that make 
the download of this information into a googleEarth client much more 
efficient.

The png is color and includes transparency; its approximate resolution is 
500 meters. I basically have 4 colors in the original image, black, white, 
blue and yellow. The output images that regionator is producing are great, 
but when I zoom in to distances where the original pixel sizes are 
visible, it looks like the resampling did some averaging across the 4 
colors, so I'm getting blue sections surrounded by a blue halo that bleeds 
into white, and yellow and blue values bleeding into each other, etc.

I'd like to control the resampling, and force it to do nearest-neighbor 
rather than averaging to eliminate the halos.  It looks to me like the 
regionator is doing the resampling with calls to ReadRaster and 
WriteRaster in in a class called extractor.py, but I don't know enough 
about the GDAL libraries to know how to change them. Is it possible to 
force the resampling to be nearest neighbor?  extractor.py isn't terribly 
large or complicated, so I'm including it here (below).

I've already tried the googleearth forum and the kml-developers forum, no 
help from those communities.  Python's new to me, and I've only used the 
GDAL command-line utilities up to now.

Thanks in advance for any tips.

Mary Jo

Here's the regionator's extractor.py:

"""
Copyright (C) 2006 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
"""

"""
$URL: http://regionator.googlecode.com/svn/trunk/kml/extractor.py $
$Revision: 200 $
$Date: 2007-01-12 09:12:48 -0700 (Fri, 12 Jan 2007) $
"""

""" class Extractor

Phase 3 of SuperOverlay creation.

Extract tiles from an image

Front-ends GDAL.  Input file and output driver must be
some format known to GDAL.

"""

import gdal
import tempfile
import os


class Extractor:

   """ class Extractor

   Create for Extractor the image file.
   Each tile is resampled to the specified size and written
   to a file of the given format.

   """

   def __init__(self,imgfile,twid,tht,fmt,verbose=False):

     """

     Args:
       imgfile: a gtiff
       twid,tht: extracted tile resample pixel width/height
       fmt: GDAL output driver name ('PNG','JPEG')
     """

     self.__in_ds = gdal.Open(imgfile)
     self.__twid = twid
     self.__tht = tht
     self.__fmt = fmt
     self.__verbose = verbose

     self.__bands = self.__in_ds.RasterCount

     if self.__verbose:
       print 'Extractor %s %d bands' % (imgfile,self.__bands)

     # Intermediate work must be in GTiff (?)
     self.__gtiff_driver = gdal.GetDriverByName('GTiff')

     # Output driver/format is whatever the user specifies
     # XXX handle bad/wrong fmt's less gracelessly
     self.__o_driver = gdal.GetDriverByName(fmt)

   def Extract(self,x,y,wid,ht,basename):

     """ Extract a tile into a file

     The given tile is extracted, resampled and saved
     according to the tile pixel dimensions and format
     specified at object __init__().

     Args:
       x,y: pixel offset
       wid,ht: pixel dimensions

     Returns:
       True: complete success
       False: any failure

     """

     # Get the tile's pixels resampled
     twid = self.__twid
     tht = self.__tht
     i_data = self.__in_ds.ReadRaster(x,y,wid,ht,buf_xsize=twid,buf_ysize=tht)

     # Have to Create out to GTiff first (?)
     (fd, tmpfile) = tempfile.mkstemp(suffix='GTiff')
     os.close(fd)
     o_ds = self.__gtiff_driver.Create(tmpfile,twid,tht,bands=self.__bands)
     o_ds.WriteRaster(0,0,twid,tht,i_data)

     # Save off using the specified driver
     filename = '%s.%s' % (basename, self.__fmt)
     options = []
     if self.__fmt == 'JPEG':
       options.append('QUALITY=90') # Default of 75 is low quality
     self.__o_driver.CreateCopy(filename, o_ds, options=options)

     if self.__verbose:
       print filename

     # Delete the tmp file
     self.__gtiff_driver.Delete(tmpfile)

From warmerdam at pobox.com  Thu Nov 12 15:17:19 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Nov 12 15:17:18 2009
Subject: [gdal-dev] trying to change regionator image resampling to
	nearest-neighbor
In-Reply-To: <alpine.LNX.1.10.0911121102170.20251@wuzzles.colorado.edu>
References: <alpine.LNX.1.10.0911121102170.20251@wuzzles.colorado.edu>
Message-ID: <4AFC6D4F.50308@pobox.com>

Mary Jo Brodzik wrote:
> 
> Dear gdal-dev list members,
> 
> I'm using a python tool called the regionator 
> (http://code.google.com/p/regionator/wiki/ Welcome) on a large 
> (14352x7440) png image.  The regionator uses the GDAL library to 
> resample subsets of the original image into much smaller chunk images.  
> These images are set up at increasing levels of detail in a kml file 
> that make the download of this information into a googleEarth client 
> much more efficient.
> 
> The png is color and includes transparency; its approximate resolution 
> is 500 meters. I basically have 4 colors in the original image, black, 
> white, blue and yellow. The output images that regionator is producing 
> are great, but when I zoom in to distances where the original pixel 
> sizes are visible, it looks like the resampling did some averaging 
> across the 4 colors, so I'm getting blue sections surrounded by a blue 
> halo that bleeds into white, and yellow and blue values bleeding into 
> each other, etc.
> 
> I'd like to control the resampling, and force it to do nearest-neighbor 
> rather than averaging to eliminate the halos.  It looks to me like the 
> regionator is doing the resampling with calls to ReadRaster and 
> WriteRaster in in a class called extractor.py, but I don't know enough 
> about the GDAL libraries to know how to change them. Is it possible to 
> force the resampling to be nearest neighbor?  extractor.py isn't 
> terribly large or complicated, so I'm including it here (below).

Mary Jo,

ReadRaster() cannot itself be modified to do bilinear resampling.

I would suggest you try out gdal2tiles.py which does something similar
to regionator but with many more options.

   http://www.gdal.org/gdal2tiles.html

You might also find MapTiler of interest:

   http://www.maptiler.org/

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From john.callahan at UDel.Edu  Thu Nov 12 16:18:10 2009
From: john.callahan at UDel.Edu (John Callahan)
Date: Thu Nov 12 16:18:12 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFC4826.200@pobox.com>
References: <4AF9C67A.1050307@udel.edu>
	<hde5ri$668$1@ger.gmane.org>	<4AFAC4F3.4090604@udel.edu>
	<4AFBC853.7050306@gmx.eu>	<4AFC1264.5060401@pobox.com>
	<4AFC3197.40608@udel.edu> <4AFC4826.200@pobox.com>
Message-ID: <4AFC7B92.8070701@udel.edu>

Thank you Frank.  I hadn't thought about file formats supporting 
projections or not.  Typically, you think about the software or 
algorithm not supporting a projection or coordinate system, not the 
format itself. 

- John



Frank Warmerdam wrote:
> John Callahan wrote:
>> Thanks Frank/Hermann for your responses.  However, something odd 
>> seems to be going on here. I feel like I'm missing something on how 
>> GDAL handles coordinate system information.
> >
>> Using the same input data set, and converting to different formats, 
>> the description of the output coordinate systems are different. Is 
>> this expected?   Here are the gdal_translate commands and their 
>> respective output files gdalinfo descriptions below.
>
> John,
>
> I think the key thing is that coordinate system encoding mechanisms
> tend to vary from file format to file format.  A few points of note:
>
>  o GeoTIFF has two general ways of encoding - one is to just embed
>    the EPSG PCS code for a whole coordinate system.  The other is
>    to encode the projection method along with the parameters.  You
>    will tend to get the first when specifying the coordinate system
>    with EPSG:n and the second when using PROJ.4 strings.
>
>  o Many geospatial formats have a particular way of representing
>    projections, and may not support all projection methods, preserving
>    datums, preserving names, etc.
>
>> [1] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 
>> +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m 
>> +no_defs" -of GTiff nt_200712_f13_v01_s.bsq nsidc_test.tif
>>
>> [2] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 
>> +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m 
>> +no_defs" -of HFA nt_200712_f13_v01_s.bsq nsidc_test.img
> ...
>> Fortunately, I can display these images fine.  They overlay nicely in 
>> QGIS with some vector data I have.   However, the problem occurs when 
>> projecting to EPSG:4326 (or similar) coordinate system; the output 
>> files are incorrect/missing data.  (It displays data from roughly lat 
>> -39.25 only down to roughly -54.75 when data exists all the way down 
>> to -90.)
>>
>> One possible cause could be that gdalinfo reports (for all of these 
>> datasets) latitude_of_origin as -70.  From 
>> http://nsidc.org/data/atlas/epsg_3412.html, the latitude of origin 
>> should be -90 and the latitude of standard parallel should be -70.  
>> Or the problem could be somewhere in gdalwarp, or specifically with 
>> the Hughes 1980 ellipsoid.  I have no idea.  Thanks.
>
> It sounds like there may be another issues with regard to the latitude
> of origin in addition to the issue with GeoTIFF not working properly with
> 3412.  If you can isolate and file a ticket that might be helpful.
>
> I'm sorry I haven't been following some of the recent srs threads very
> closely.
>
> Best regards,
From john.callahan at UDel.Edu  Thu Nov 12 16:28:07 2009
From: john.callahan at UDel.Edu (John Callahan)
Date: Thu Nov 12 16:28:09 2009
Subject: [gdal-dev] Re: gdal to define projection, EPSG:3412
In-Reply-To: <4AFC493B.9090405@gmx.eu>
References: <4AF9C67A.1050307@udel.edu>	<hde5ri$668$1@ger.gmane.org>	<4AFAC4F3.4090604@udel.edu>	<4AFBC853.7050306@gmx.eu>	<4AFC1264.5060401@pobox.com>
	<4AFC3197.40608@udel.edu> <4AFC493B.9090405@gmx.eu>
Message-ID: <4AFC7DE7.7010500@udel.edu>

I just received word back from NSIDC.  They mentioned this is a known 
issue when projecting from polar to cylindrical coordinate systems. 
http://trac.osgeo.org/gdal/ticket/2729

The work around is to specify the output extents in the command.  For my 
data, the proper command is:

gdalwarp -of GTiff -s_srs EPSG:3412 -t_srs EPSG:4326 -te -180.0 -90 180.0 -39.2308884002772 nt_200712_f13_v01_s.bsq out.tif


Using -s_srs EPSG:3412 or the full PROJ.4 string didn't matter.  Both 
worked great.


This still doesn't explain why "+lat_0=-90" results into 
"PARAMETER["latitude_of_origin",-70]" in the description.  Since 
gdalwarp does indeed work (with specifying the output extents), maybe 
the error is in how gdalinfo returns the srs info (differently in 
different formats, as Frank explained) and not somewhere inside gdalwarp 
projection algorithms. 

- John



Hermann Peifer wrote:
> John,
>
> I guess you are right:  "+lat_0=-90" shouldn't result into 
> "PARAMETER["latitude_of_origin",-70]". There seems to be some 
> parameter confusion.
>
> It also looks like
> http://spatialreference.org/ref/epsg/3412/prettywkt/ would be wrong in 
> this case.
>
> EPSG guidance notes 7.2 describe polar stereographic projection with 
> variants A, B and C... I am not the ultimate expert here. It might be 
> worth to ask for clarification in the proj mailing list.
>
> Hermann
>
>
> John Callahan wrote:
>> Thanks Frank/Hermann for your responses.  However, something odd 
>> seems to be going on here. I feel like I'm missing something on how 
>> GDAL handles coordinate system information.
>>
>> Using the same input data set, and converting to different formats, 
>> the description of the output coordinate systems are different. Is 
>> this expected?   Here are the gdal_translate commands and their 
>> respective output files gdalinfo descriptions below.
>>
>> [1] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 
>> +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m 
>> +no_defs" -of GTiff nt_200712_f13_v01_s.bsq nsidc_test.tif
>>
>> [2] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 
>> +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m 
>> +no_defs" -of HFA nt_200712_f13_v01_s.bsq nsidc_test.img
>>
>> [3] gdal_translate -a_srs "+proj=stere +lat_0=-90 +lat_ts=-70 
>> +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 +units=m 
>> +no_defs" -of HDF4Image nt_200712_f13_v01_s.bsq nsidc_test.hdf
>>
>> [4] gdal_translate -a_srs EPSG:3412 -of GTiff nt_200712_f13_v01_s.bsq 
>> nsidc_test_epsg.tif
>>
>> [5] gdal_translate -a_srs EPSG:3412 -of HFA nt_200712_f13_v01_s.bsq 
>> nsidc_test_epsg.img
>>
>>
>> Fortunately, I can display these images fine.  They overlay nicely in 
>> QGIS with some vector data I have.   However, the problem occurs when 
>> projecting to EPSG:4326 (or similar) coordinate system; the output 
>> files are incorrect/missing data.  (It displays data from roughly lat 
>> -39.25 only down to roughly -54.75 when data exists all the way down 
>> to -90.)
>>
>> One possible cause could be that gdalinfo reports (for all of these 
>> datasets) latitude_of_origin as -70.  From 
>> http://nsidc.org/data/atlas/epsg_3412.html, the latitude of origin 
>> should be -90 and the latitude of standard parallel should be -70.  
>> Or the problem could be somewhere in gdalwarp, or specifically with 
>> the Hughes 1980 ellipsoid.  I have no idea.  Thanks.
>>
>> - John
>>
>>
>>
>> [1] Driver: GTiff/GeoTIFF
>> Files: nsidc_test.tif
>> Size is 316, 332
>> Coordinate System is:
>> PROJCS["unnamed",
>>    GEOGCS["unnamed ellipse",
>>        DATUM["unknown",
>>            SPHEROID["unnamed",6378273,298.279411123061]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["degree",0.0174532925199433]],
>>    PROJECTION["Polar_Stereographic"],
>>    PARAMETER["latitude_of_origin",-70],
>>    PARAMETER["central_meridian",0],
>>    PARAMETER["scale_factor",1],
>>    PARAMETER["false_easting",0],
>>    PARAMETER["false_northing",0],
>>    UNIT["metre",1,
>>        AUTHORITY["EPSG","9001"]]]
>> Origin = (-3950000.000000000000000,4350000.000000000000000)
>> Pixel Size = (25000.000000000000000,-25000.000000000000000)
>> Metadata:
>>  AREA_OR_POINT=Area
>> Image Structure Metadata:
>>  INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
>> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
>> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
>> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
>> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
>> Band 1 Block=316x25 Type=Byte, ColorInterp=Gray
>>
>>
>> [2] Driver: HFA/Erdas Imagine Images (.img)
>> Files: nsidc_test.img
>> Size is 316, 332
>> Coordinate System is:
>> PROJCS["Stereographic_South_Pole",
>>    GEOGCS["GCS_unnamed ellipse",
>>        DATUM["unknown",
>>            SPHEROID["Unknown",6378273,298.279411123061]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["Degree",0.017453292519943295]],
>>    PROJECTION["Polar_Stereographic"],
>>    PARAMETER["latitude_of_origin",-70],
>>    PARAMETER["central_meridian",0],
>>    PARAMETER["false_easting",0],
>>    PARAMETER["false_northing",0],
>>    UNIT["Meter",1]]
>> Origin = (-3950000.000000000000000,4350000.000000000000000)
>> Pixel Size = (25000.000000000000000,-25000.000000000000000)
>> Corner Coordinates:
>> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
>> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
>> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
>> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
>> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
>> Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
>>  Metadata:
>>    LAYER_TYPE=athematic
>>
>>
>> [3] Driver: HDF4Image/HDF4 Dataset
>> Files: nsidc_test.hdf
>> Size is 316, 332
>> Coordinate System is:
>> PROJCS["unnamed",
>>    GEOGCS["unnamed ellipse",
>>        DATUM["unknown",
>>            SPHEROID["unnamed",6378273,298.279411123061]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["degree",0.0174532925199433]],
>>    PROJECTION["Polar_Stereographic"],
>>    PARAMETER["latitude_of_origin",-70],
>>    PARAMETER["central_meridian",0],
>>    PARAMETER["scale_factor",1],
>>    PARAMETER["false_easting",0],
>>    PARAMETER["false_northing",0],
>>    UNIT["Meter",1]]
>> Origin = (-3950000.000000000000000,4350000.000000000000000)
>> Pixel Size = (25000.000000000000000,-25000.000000000000000)
>> Metadata:
>>  Signature=Created with GDAL (http://www.remotesensing.org/gdal/)
>>  TransformationMatrix=-3950000.000000, 25000.000000, 0.000000, 
>> 4350000.000000, 0.000000, -25000.000000
>>  Projection=PROJCS["unnamed",GEOGCS["unnamed 
>> ellipse",DATUM["unknown",SPHEROID["unnamed",6378273,298.279411123061]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Polar_Stereographic"],PARAMETER["latitude_of_origin",-70],PARAMETER["central_meridian",0],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1]] 
>>
>> Corner Coordinates:
>> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
>> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
>> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
>> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
>> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
>> Band 1 Block=316x316 Type=Byte, ColorInterp=Gray
>>
>>
>> [4] Driver: GTiff/GeoTIFF
>> Files: nsidc_test_epsg.tif
>> Size is 316, 332
>> Coordinate System is:
>> PROJCS["NSIDC Sea Ice Polar Stereographic South",
>>    GEOGCS["Unspecified datum based upon the Hughes 1980 ellipsoid",
>>        DATUM["Not_specified_based_on_Hughes_1980_ellipsoid",
>>            SPHEROID["Hughes 1980",6378273,298.279411123061,
>>                AUTHORITY["EPSG","7058"]],
>>            AUTHORITY["EPSG","6054"]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["degree",0.0174532925199433],
>>        AUTHORITY["EPSG","4054"]],
>>    UNIT["metre",1,
>>        AUTHORITY["EPSG","9001"]],
>>    AUTHORITY["EPSG","3412"]]
>> Origin = (-3950000.000000000000000,4350000.000000000000000)
>> Pixel Size = (25000.000000000000000,-25000.000000000000000)
>> Metadata:
>>  AREA_OR_POINT=Area
>> Image Structure Metadata:
>>  INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (-3950000.000, 4350000.000)
>> Lower Left  (-3950000.000,-3950000.000)
>> Upper Right ( 3950000.000, 4350000.000)
>> Lower Right ( 3950000.000,-3950000.000)
>> Center      (       0.000,  200000.000)
>> Band 1 Block=316x25 Type=Byte, ColorInterp=Gray
>>
>>
>> [5] Driver: HFA/Erdas Imagine Images (.img)
>> Files: nsidc_test_epsg.img
>> Size is 316, 332
>> Coordinate System is:
>> PROJCS["NSIDC_Sea_Ice_Polar_Stereographic_South",
>>    GEOGCS["GCS_Unspecified datum based upon the Hughes 1980 ellipsoid",
>>        DATUM["Hungarian_Datum_1909",
>>            SPHEROID["Hughes_1980",6378273,298.279411123061]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["Degree",0.017453292519943295]],
>>    PROJECTION["Polar_Stereographic"],
>>    PARAMETER["latitude_of_origin",-70],
>>    PARAMETER["central_meridian",0],
>>    PARAMETER["false_easting",0],
>>    PARAMETER["false_northing",0],
>>    UNIT["Meter",1]]
>> Origin = (-3950000.000000000000000,4350000.000000000000000)
>> Pixel Size = (25000.000000000000000,-25000.000000000000000)
>> Corner Coordinates:
>> Upper Left  (-3950000.000, 4350000.000) ( 42d14'27.21"W, 39d13'51.20"S)
>> Lower Left  (-3950000.000,-3950000.000) (135d 0'0.00"W, 41d26'49.04"S)
>> Upper Right ( 3950000.000, 4350000.000) ( 42d14'27.21"E, 39d13'51.20"S)
>> Lower Right ( 3950000.000,-3950000.000) (135d 0'0.00"E, 41d26'49.04"S)
>> Center      (       0.000,  200000.000) (  0d 0'0.01"E, 88d 9'14.17"S)
>> Band 1 Block=64x64 Type=Byte, ColorInterp=Undefined
>>  Metadata:
>>    LAYER_TYPE=athematic
>>
>>
>>
>>
>> Frank Warmerdam wrote:
>>> Hermann Peifer wrote:
>>>> John Callahan wrote:
>>>>> Thanks for responding Hermann. Yes, I tried using -s_srs EPSG:3412 
>>>>> as well as the full PROJ4 string with the same result. When 
>>>>> specifying -s_srs, does gdalwarp ignore (override) the project 
>>>>> information in the hdr file?
>>>>>
>>>>
>>>> Hmm. AFAIK: gdal_translate -a_srs does override the file's 
>>>> projection information. I have a random.tif in LAEA projection 
>>>> (EPSG:3035), so I tried the following with gdal 1.6.2:
>>>>
>>>> gdal_translate random.tif out1.tif -a_srs EPSG:3412  # this results 
>>>> in [1]
>>>>
>>>> gdal_translate random.tif out2.tif -a_srs "+proj=stere +lat_0=-90 
>>>> +lat_ts=-70 +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378273 +b=6356889.449 
>>>> +units=m +no_defs"  # this gives [2]
>>>>
>>>> To me as an innocent GDAL user, this behaviour looks similar to 
>>>> http://trac.osgeo.org/gdal/ticket/3016. I might be wrong, though, 
>>>> in particular as you wrote that using the PROJ.4 string didn't help 
>>>> (and your source file isn't a GeoTIFF in the first place).
>>>
>>> Hermann,
>>>
>>> I have confirmed this problem and filed it as:
>>>
>>>   http://trac.osgeo.org/gdal/ticket/3220
>>>
>>> It is presumably a problem with translation of a specific projection 
>>> method,
>>> possibly in libgeotiff itself.
>>>
>>> Best regards,
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
From tasmith3 at rockwellcollins.com  Thu Nov 12 16:19:47 2009
From: tasmith3 at rockwellcollins.com (tasmith3@rockwellcollins.com)
Date: Thu Nov 12 16:48:28 2009
Subject: [gdal-dev] Todd A Smith is out of the office.
Message-ID: <OF3A38E20D.275C143C-ON8625766C.00752B2D-8625766C.00752B2D@rockwellcollins.com>


I will be out of the office starting  11/12/2009 and will not return until
11/16/2009.

I just became a father!  I'm the proud parent of a little girl.  I will
respond to your message when I return.

From szekerest at gmail.com  Thu Nov 12 17:49:34 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu Nov 12 17:49:38 2009
Subject: [gdal-dev] Problems with large raster sizes (WMS/TMS)
Message-ID: <f3b73b7d0911121449sd6c9cbby9945e78173510776@mail.gmail.com>

Folks,

I've been testing with the WMS/TMS driver at large zoom levels
according to the following WMS XML file:

<GDAL_WMS>
    <Service name="TMS">
        <ServerUrl>http://web0.nearmap.com/maps/hl=en&x=${x}&y=${y}&z=${z}&nml=Vert</ServerUrl>
    </Service>
    <DataWindow>
        <UpperLeftX>-20037508.34</UpperLeftX>
        <UpperLeftY>20037508.34</UpperLeftY>
        <LowerRightX>20037508.34</LowerRightX>
        <LowerRightY>-20037508.34</LowerRightY>
        <TileLevel>20</TileLevel>
	<TileCountX>1</TileCountX>
	<TileCountY>1</TileCountY>
        <YOrigin>top</YOrigin>
    </DataWindow>
    <Projection>EPSG:900913</Projection>
    <BlockSizeX>256</BlockSizeX>
    <BlockSizeY>256</BlockSizeY>
    <BandsCount>3</BandsCount>
    <Cache />
</GDAL_WMS>

By setting the TileLevel to 19 everything is working fine. However
when I increase the TileLevel to 20 I always get the following error :
"Out of memory in InitBlockInfo()". This is beacause gdal tries to
pre-allocate the pointers for all tiles in the internal memory cache.

When I switch off the gdal internal memory cache (not too
straightforward but it could be done by overriding
TryGetLockedBlockRef an creating the blocks on the fly from the file
cache) then I can get TileLevel = 20 working. However when I set
TileLevel  to 23 I get : 'Invalid dataset dimensions : -2147483648 x
-2147483648'

IMO this issue is not only related to the GDAL WMS driver itself, it
seems like gdal is not much prepared to handle these large raster
sizes.

Any workaround, opinions?


Best regards,


Tamas
From even.rouault at mines-paris.org  Thu Nov 12 19:19:45 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Nov 12 19:19:48 2009
Subject: [gdal-dev] (no subject)
Message-ID: <1258071585.4afca6215bd47@imp.free.fr>

Hi Tamas,

2 issues directly related to the big raster dimensions :

* Currently GDAL allocates an array of pointer to raster blocks of size
nBlocksPerRow x nBlocksPerColumn where nBlocksPerRow =
(nRasterXSize+nBlockXSize-1) / nBlockXSize and nBlocksPerColumn =
(nRasterYSize+nBlockYSize-1) / nBlockYSize.
When TileLevel = 20, nBlocksPerRow = nBlocksPerColumn = 1 048 576. This is too
big. Currently, we then try to use a second level of block array
("sub-blocking") as soon as nBlocksPerRow > SUBBLOCK_SIZE/2 (SUBBLOCK_SIZE=64).
This leads to allocating nSubBlocksPerRow x nSubBlocksPerColumn where
nSubBlocksPerRow = (nBlocksPerRow + SUBBLOCK_SIZE + 1)/SUBBLOCK_SIZE and 
nSubBlocksPerColumn = (nBlocksPerColumn + SUBBLOCK_SIZE + 1)/SUBBLOCK_SIZE.
In that case, nSubBlocksPerRow = nSubBlocksPerColumn = 16384, and
nSubBlocksPerRow x nSubBlocksPerColumn = 268 435 456 pointers, so 1 GB on a
32bit machine or 2 GB on a 64bit machine.

--> So we would need a three-level block cache. This would be feasable
(implementation "detail" of gdalrasterband.cpp).

Or I'm thinking that we could completely remove the array and use instead a hash
map that would map a block number to its raster block. Could cause a (small?)
slowdown of course but would be simpler to implement and maintain than a 3 level
array.

* At TileLevel = 23, nRasterXSize = 2 147 483 648, which is ahem just one byte
more than the largest signed int, so = -2147483648
--> The proper solution would be to promote nRasterXSize/nRasterYSize to be of
type GIntBig (64bit). We would also need to update the IReadBlock(),
IWriteBlock(), IRasterIO() interfaces (and probably many others) to use GIntBig.
So this is both a large API and ABI breakage, that IMHO looks more like a GDAL
2.0 project... An alternative would be to have both the existing 'int'
variables/interfaces and introduce new GIntBIG variables/interfaces, and migrate
GDAL internals (gcore/* alg/*) and the relevant drivers such as WMS to use the
GIntBig version. Could easily turn to be very messy in the end...

I cannot think of an easy workaround. An idea would be to split the WMS extent
into 4 pieces to go under the 2 147 486 647 pixel limit, but this is not really
doable without a small hack in the TMS minidriver as you would need to add an
offset to the x and y tile number requested to the server.

Best regards,

Even
From jason.roberts at duke.edu  Thu Nov 12 19:33:39 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu Nov 12 19:37:44 2009
Subject: [gdal-dev] Setting the spatial reference of an existing shapefile
	with OGR
Message-ID: <001e01ca63f8$f2d9a6f0$d88cf4d0$@roberts@duke.edu>

Greetings OGR experts,

 

I have a shapefile for which no spatial reference was defined when the
shapefile was created, but I know the spatial reference and would like to
set it on this existing shapefile. Is this possible with the OGR Python API?

 

It looks like the only place that takes an OGRSpatialReference instance is
OGRDataSource::CreateLayer. This suggests that the only way to do it is to
call CreateLayer with the appropriate OGRSpatialReference instance and then
write all of the code to create the fields and copy all of the features from
the existing layer to the new one. Is this correct?

 

Thanks very much for any suggestions you can provide,

 

Jason

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091112/fa9d1f85/attachment.html
From even.rouault at mines-paris.org  Thu Nov 12 19:43:28 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Nov 12 19:43:31 2009
Subject: [gdal-dev] Setting the spatial reference of an existing shapefile
	with OGR
In-Reply-To: <001e01ca63f8$f2d9a6f0$d88cf4d0$@roberts@duke.edu>
References: <001e01ca63f8$f2d9a6f0$d88cf4d0$@roberts@duke.edu>
Message-ID: <1258073008.4afcabb0a8d6d@imp.free.fr>

Selon Jason Roberts <jason.roberts@duke.edu>:

> Greetings OGR experts,
>
>
>
> I have a shapefile for which no spatial reference was defined when the
> shapefile was created, but I know the spatial reference and would like to
> set it on this existing shapefile. Is this possible with the OGR Python API?
>

You're correct. There's no direct (Python or C) API for this.

>
> It looks like the only place that takes an OGRSpatialReference instance is
> OGRDataSource::CreateLayer. This suggests that the only way to do it is to
> call CreateLayer with the appropriate OGRSpatialReference instance and then
> write all of the code to create the fields and copy all of the features from
> the existing layer to the new one. Is this correct?
>

Yes. Or... you could cheat a bit. In the case of a shapefile, the spatial
reference is written in a .prj file. So technically you can create a fake empty
shapefile with the right spatial reference, close it, rename the .prj to have
the same basename as your shapefile of interes and re-open it.

>
>
> Thanks very much for any suggestions you can provide,
>
>
>
> Jason
>
>
>
>


From jason.roberts at duke.edu  Thu Nov 12 19:53:53 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu Nov 12 19:53:59 2009
Subject: [gdal-dev] Setting the spatial reference of an existing shapefile
	with OGR
In-Reply-To: <1258073008.4afcabb0a8d6d@imp.free.fr>
References: <001e01ca63f8$f2d9a6f0$d88cf4d0$%roberts@duke.edu>
	<1258073008.4afcabb0a8d6d@imp.free.fr>
Message-ID: <003201ca63fb$c64df7a0$52e9e6e0$@roberts@duke.edu>

> Yes. Or... you could cheat a bit. In the case of a shapefile, the spatial
> reference is written in a .prj file. So technically you can create a fake
empty
> shapefile with the right spatial reference, close it, rename the .prj to
have
> the same basename as your shapefile of interes and re-open it.

Ah, excellent. Thanks for this suggestion!

It looks like the .prj file simply contains the WKT. Would it be sufficient
to just call OGRSpatialReference::exportToWKT and write the string to the
.prj file directly? In my situation that would be slightly cleaner. If this
is a good approach, should I also call morphToESRI first, if I know the
coordinate system has not already been morphed to ESRI?

Thanks,
Jason

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Thursday, November 12, 2009 7:43 PM
To: Jason Roberts
Cc: 'gdal-dev'
Subject: Re: [gdal-dev] Setting the spatial reference of an existing
shapefile with OGR

Selon Jason Roberts <jason.roberts@duke.edu>:

> Greetings OGR experts,
>
>
>
> I have a shapefile for which no spatial reference was defined when the
> shapefile was created, but I know the spatial reference and would like to
> set it on this existing shapefile. Is this possible with the OGR Python
API?
>

You're correct. There's no direct (Python or C) API for this.

>
> It looks like the only place that takes an OGRSpatialReference instance is
> OGRDataSource::CreateLayer. This suggests that the only way to do it is to
> call CreateLayer with the appropriate OGRSpatialReference instance and
then
> write all of the code to create the fields and copy all of the features
from
> the existing layer to the new one. Is this correct?
>

Yes. Or... you could cheat a bit. In the case of a shapefile, the spatial
reference is written in a .prj file. So technically you can create a fake
empty
shapefile with the right spatial reference, close it, rename the .prj to
have
the same basename as your shapefile of interes and re-open it.

>
>
> Thanks very much for any suggestions you can provide,
>
>
>
> Jason
>
>
>
>



From warmerdam at pobox.com  Thu Nov 12 20:02:13 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Nov 12 20:02:15 2009
Subject: [gdal-dev] Setting the spatial reference of an existing
	shapefile with OGR
In-Reply-To: <003201ca63fb$c64df7a0$52e9e6e0$@roberts@duke.edu>
References: <001e01ca63f8$f2d9a6f0$d88cf4d0$%roberts@duke.edu>
	<1258073008.4afcabb0a8d6d@imp.free.fr>
	<003201ca63fb$c64df7a0$52e9e6e0$@roberts@duke.edu>
Message-ID: <4AFCB015.5060201@pobox.com>

Jason Roberts wrote:
>> Yes. Or... you could cheat a bit. In the case of a shapefile, the spatial
>> reference is written in a .prj file. So technically you can create a fake
> empty
>> shapefile with the right spatial reference, close it, rename the .prj to
> have
>> the same basename as your shapefile of interes and re-open it.
> 
> Ah, excellent. Thanks for this suggestion!
> 
> It looks like the .prj file simply contains the WKT. Would it be sufficient
> to just call OGRSpatialReference::exportToWKT and write the string to the
> .prj file directly? In my situation that would be slightly cleaner. If this
> is a good approach, should I also call morphToESRI first, if I know the
> coordinate system has not already been morphed to ESRI?

Jason,

Yes, this would be appropriate.  Note that in all but exceptional circumstances
the OGRSpatialReference is *not* in ESRI format, so you should expect to
call morphToESRI() before exporting to WKT.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From hobu.inc at gmail.com  Thu Nov 12 22:53:58 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Thu Nov 12 22:57:18 2009
Subject: [gdal-dev] GDAL 1.6.3 release candidate due Nov 14th
Message-ID: <C0CD885B-811A-4D4B-9899-56881AB598EA@gmail.com>

All,

Continuing my release manager role from the 1.6.2 release, I would like to produce a 1.6.3RC1 on November 14th (this Sunday).  Consider this your notice to complete any bugs or backports for the 1.6 branch lest they be pushed forward to 1.6.4 (which is likely to be released after or along with 1.7.0).

http://trac.osgeo.org/gdal/milestone/1.6.3

Howard
From mike at stamen.com  Fri Nov 13 02:28:23 2009
From: mike at stamen.com (Michal Migurski)
Date: Fri Nov 13 02:45:59 2009
Subject: [gdal-dev] Return codes in gdalwarp
Message-ID: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>

Hello,

I think this is a bug report, or maybe a feature request.

I'm writing a script that shells out to gdalwarp. The GTiff files that  
I might see as input to this script include palette and non-palette  
images, and I'd like to be able to reliably compress the output  
without human intervention.

Initially, I tried -co COMPRESS=JPEG on everything in the hopes that  
gdalwarp would perform the necessary internal conversions to beat the  
output into a JPEG. This didn't work with palette images, for which I  
got an error like: "ERROR 1: JPEGSetupEncode:PhotometricInterpretation  
3 not allowed for JPEG"

Then I tried setting up a loop that tries JPEG first followed by LZW,  
but here I ran into difficulty recognizing a failure. The return code  
for the palette images with all the errors is still 0, just like the  
return code for a successful warp. The destination image is also  
populated, so it's not possible to check for existence to determine  
success.

What I'd love to see is a modification to the command-line behavior of  
gdalwarp so it can be better used in a scripted setting, where  
automated ways of detecting failure that don't require reading the  
error output strings would be incredibly helpful. Ideally, choosing an  
incompatible creation option would cause a non-zero exit and wouldn't  
create the destination file.

-mike.

----------------------------------------------------------------
michal migurski- mike@stamen.com
                  415.558.1610



From yanbohe at cma.gov.cn  Fri Nov 13 03:08:00 2009
From: yanbohe at cma.gov.cn (yanbohe@cma.gov.cn)
Date: Fri Nov 13 03:26:12 2009
Subject: [gdal-dev] GDAL C# interface
Message-ID: <000601ca6438$7c5ff4d0$751fde70$@gov.cn>

Dear All,

 

Who have GDAL binary DLL libs for C#? I download the source code and did not
successes to compile them for C# interface.

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091113/38fd227a/attachment.html
From bertelli at charta.acme.com  Fri Nov 13 05:23:46 2009
From: bertelli at charta.acme.com (Carlo A. Bertelli (Charta s.r.l.))
Date: Fri Nov 13 05:23:49 2009
Subject: [gdal-dev] pre-rectifying to georeference old maps
Message-ID: <303ea9510911130223lfe74237r1477ef8521c1541a@mail.gmail.com>

Hello,
dealing with old maps which have to be georeferenced we are not able
to solve a problem: sometimes old (very old, 18th or even 17th century
maps) cannot be scanned flat or may only be photographed. This leads
to bending, shading and so on. The margins of the map become curved
and the light uneven, not to talk about maps which were conservated in
albums: the center fold is deeply shaded and aroud it the curved paper
shines.
Researchers developed image recognition techniques to solve this
problems for book reproductions (I have refereces, if someone is
interested) but those need to have informations on light directions
and so on (they use shade to detect shape); this technique is mainly
useful for scanned images.
In the old times, I remember using Bentley's IRAS/C to solve a simpler
issue (a curved map), by now I think gdalwarp would possibly solve
deformation problems -- but how to set data to make it run properly in
this case, I cannot imagine how to use it without a GUI to set points,
maybe a vector polygon to set the deformation. An this would only be
good for shape, not for shade (surely useful but not perfect).
Any suggestion is gratefully accepted.
c

-- 
--------------------------------------------------------------------------
Carlo A. Bertelli
   Charta servizi e sistemi per il territorio e la storia ambientale srl
          Dipendenze del palazzo Doria,
          vc. alla Chiesa della Maddalena 9/2 16124      Genova (Italy)
          tel. +39(0)10 2475439  fax +39(0)10 2475439  gsm:+39 393 1590711
   e-mail: bertelli@charta.acme.com      http://www.charta.acme.com
--------------------------------------------------------------------------
From vincent.honnet at external.thalesgroup.com  Fri Nov 13 07:56:30 2009
From: vincent.honnet at external.thalesgroup.com (Vincent Honnet)
Date: Fri Nov 13 07:58:52 2009
Subject: [gdal-dev] Problem to implement a new format
Message-ID: <4AFD577E.7080808@external.thalesgroup.com>

Hi,

I'm trying to implement a new format for my GDal and I have some 
problems. For now I don't want to integrate it to the GDal source code 
but only in gdal_translate. I call the registering method just after the 
call to GDALAllRegister.
I implemented the Dataset methods Open, the RasterBand methods 
IReadBlock and IWriteBlock, the method GDalRegister_format where Open is 
given to poDriver->pfnOpen, CreateCopy to poDriver->pfnCreateCopy and 
Create to  and poDriver->pfnCreate and the driver is registered.
A request on the available formats on this version of GDal_Translate 
shows that the format is registered.
A convertion request from a GeoTiff to this format crashes in my method 
Open because the object GDALOpenInfo is wrong (pszFilename is a bad 
pointer for example). Moreover, my method CreateCopy is never called 
even if GDALCreateCopy is called.
The platform is Windows XP with GDal 1.6 and visual studio 2005 pro.

Did I forget something ?

Thanks a lot in advance,

Vincent


From warmerdam at pobox.com  Fri Nov 13 09:12:01 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 13 09:11:55 2009
Subject: [gdal-dev] Return codes in gdalwarp
In-Reply-To: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
References: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
Message-ID: <4AFD6931.7010500@pobox.com>

Michal Migurski wrote:
> Hello,
> 
> I think this is a bug report, or maybe a feature request.
> 
> I'm writing a script that shells out to gdalwarp. The GTiff files that I 
> might see as input to this script include palette and non-palette 
> images, and I'd like to be able to reliably compress the output without 
> human intervention.
> 
> Initially, I tried -co COMPRESS=JPEG on everything in the hopes that 
> gdalwarp would perform the necessary internal conversions to beat the 
> output into a JPEG. This didn't work with palette images, for which I 
> got an error like: "ERROR 1: JPEGSetupEncode:PhotometricInterpretation 3 
> not allowed for JPEG"
> 
> Then I tried setting up a loop that tries JPEG first followed by LZW, 
> but here I ran into difficulty recognizing a failure. The return code 
> for the palette images with all the errors is still 0, just like the 
> return code for a successful warp. The destination image is also 
> populated, so it's not possible to check for existence to determine 
> success.
> 
> What I'd love to see is a modification to the command-line behavior of 
> gdalwarp so it can be better used in a scripted setting, where automated 
> ways of detecting failure that don't require reading the error output 
> strings would be incredibly helpful. Ideally, choosing an incompatible 
> creation option would cause a non-zero exit and wouldn't create the 
> destination file.

Mike,

gdalwarp attempts to exit() with a non-zero result on failure in cases where
a problem is detected.  I imagine there are some failures to propagate some
kinds of errors back from the underlying layers - possibly even specific to
particular image drivers, or to the warp algorithm itself.

I would suggest filing a ticket with the particular case you encountered,
and enough information for us to easily reproduce the problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From graziano.giuliani at poste.it  Fri Nov 13 09:02:20 2009
From: graziano.giuliani at poste.it (Graziano Giuliani)
Date: Fri Nov 13 09:22:30 2009
Subject: [gdal-dev] GRIB format GeoTransform error
Message-ID: <4AFD66EC.2020109@poste.it>

Hi,

I am playing in this days with the GRIB IO layer, using the API for reading GRIB
into my application.

I have find a possible bug (I am referring to V 1.6.2, but is still there in
SVN) on the Metadata read from file in SetGribMetaData, at lines 604-605 of the
gribdataset.cpp source file.

           if (meta->gds.scan == GRIB2BIT_2) // Y is minY, GDAL wants maxY
             rMaxY += (meta->gds.Ny - 1) * meta->gds.Dy; // -1 because we GDAL
needs the coordinates of the centre of the pixel

If I do not comment those two lines, I have GeoTransform wrong. Seems rotating
what is already rotated.... commenting the two lines I get correct number for
rMaxY. If I want to reverse again from South to North, shouldn't that equality
check be changed to check if different?

I have no time now to correctly investigate this, but please note that the
following code can be used to test.

GDALDataset *Dataset;
Dataset = (GDALDataset *) GDALOpen( filename, GA_ReadOnly );

static const char llpjwks[] = "GEOGCS[\"WGS 84\", DATUM[\"WGS_1984\",
SPHEROID[\"WGS 84\",6378137,298.257223563, AUTHORITY[\"EPSG\",\"7030\"]],
TOWGS84[0,0,0,0,0,0,0], AUTHORITY[\"EPSG\",\"6326\"]], PRIMEM[\"Greenwich\",0,
AUTHORITY[\"EPSG\",\"8901\"]], UNIT[\"degree\",0.0174532925199433,
AUTHORITY[\"EPSG\",\"9108\"]], AXIS[\"Lat\",NORTH], AXIS[\"Long\",EAST],
AUTHORITY[\"EPSG\",\"4326\"]]";

char *lpjinfo = strdup(llpjwks);
OGRSpatialReference LLSRS;
LLSRS.importFromWkt(&lpjinfo);

OGRSpatialReference INSRS;
char *ipjinfo = strdup(Dataset->GetProjectionRef());
INSRS.importFromWkt(&ipjinfo);
OGRCoordinateTransformation *LLIJ = OGRCreateCoordinateTransformation(&LLSRS,
&INSRS);
OGRCoordinateTransformation *IJLL = OGRCreateCoordinateTransformation(&INSRS,
&LLSRS);

double adfGeoTransform[6];
double fdaGeoTransform[6];
Dataset->GetGeoTransform(adfGeoTransform);
GDALInvGeoTransform(adfGeoTransform, fdaGeoTransform);

x = lon;
y = lat;
LLIJ->Transform(1, &x, &y);
i = fdaGeoTransform[0] + x*fdaGeoTransform[1] + y*fdaGeoTransform[2];
j = fdaGeoTransform[3] + x*fdaGeoTransform[4] + y*fdaGeoTransform[5];

On a GFS regular lat/lon grid 0.5 as from NOMADS
(http://nomads.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/gfs.2009111300/gfs.t00z.pgrb2bf00
for example), I have adfGeoTransform[3] (rMaxY) at 270. Should be 90, and
commenting out the two lines in gribdataset.cpp I have the correct answer (and
everything works as expected, i.e. for example for latitude 45, longitude 45 I
have I = 90, J = 90.

Thanks.

Graziano.
From ekanegae at gmail.com  Fri Nov 13 09:33:04 2009
From: ekanegae at gmail.com (Eduardo Kanegae)
Date: Fri Nov 13 09:33:08 2009
Subject: [gdal-dev] FOSS4G tools - dependency map
Message-ID: <ce13c0ca0911130633m37a25830qbf74d475f4e6ed6e@mail.gmail.com>

Source: http://anthologis.com/2009/11/13/foss4g-tools-dependency-map/

In 2008 after some GIS setup tasks, I decided to map package
dependencies in order to help me on future setup tasks.
So, after discovering the great GraphViz tool
(http://www.graphviz.org/), I created some scripts to map these deps.
Now, after some revisions, the diagram is finally published at
http://www.webmapit.com.br/wiki/index.php/FOSS4G_tools_-_dependency_map

Note: due to corporate restrictions, I?m not able to publish its
source yet. But if you need a higher resolution or report bugs at the
diagram, feel free to contact me.

-- 
Eduardo Patto Kanegae
http://anthologis.com
http://blogdopatto.webmapit.com.br
From warmerdam at pobox.com  Fri Nov 13 09:59:16 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 13 09:59:11 2009
Subject: [gdal-dev] GRIB format GeoTransform error
In-Reply-To: <4AFD66EC.2020109@poste.it>
References: <4AFD66EC.2020109@poste.it>
Message-ID: <4AFD7444.4080608@pobox.com>

Graziano Giuliani wrote:
> Hi,
> 
> I am playing in this days with the GRIB IO layer, using the API for reading GRIB
> into my application.
> 
> I have find a possible bug (I am referring to V 1.6.2, but is still there in
> SVN) on the Metadata read from file in SetGribMetaData, at lines 604-605 of the
> gribdataset.cpp source file.
> 
>            if (meta->gds.scan == GRIB2BIT_2) // Y is minY, GDAL wants maxY
>              rMaxY += (meta->gds.Ny - 1) * meta->gds.Dy; // -1 because we GDAL
> needs the coordinates of the centre of the pixel
...

Graziano,

This looks to be the same problem reported by Erick Jones within:

   http://trac.osgeo.org/gdal/ticket/2550

It would be helpful if you could add your notes there as well.  I have been
hesitant to act without knowing if I'm just breaking things for most files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Nov 13 10:01:20 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 13 10:01:16 2009
Subject: [gdal-dev] Problem to implement a new format
In-Reply-To: <4AFD577E.7080808@external.thalesgroup.com>
References: <4AFD577E.7080808@external.thalesgroup.com>
Message-ID: <4AFD74C0.6030608@pobox.com>

Vincent Honnet wrote:
> Hi,
> 
> I'm trying to implement a new format for my GDal and I have some 
> problems. For now I don't want to integrate it to the GDal source code 
> but only in gdal_translate. I call the registering method just after the 
> call to GDALAllRegister.
> I implemented the Dataset methods Open, the RasterBand methods 
> IReadBlock and IWriteBlock, the method GDalRegister_format where Open is 
> given to poDriver->pfnOpen, CreateCopy to poDriver->pfnCreateCopy and 
> Create to  and poDriver->pfnCreate and the driver is registered.
> A request on the available formats on this version of GDal_Translate 
> shows that the format is registered.
> A convertion request from a GeoTiff to this format crashes in my method 
> Open because the object GDALOpenInfo is wrong (pszFilename is a bad 
> pointer for example). 

Vincent,

I'm surprised your open method is being called for a geotiff if your
driver was registered after the geotiff driver.

 > Moreover, my method CreateCopy is never called
> even if GDALCreateCopy is called.

It it possible you assigned your Open method to the pfnCreateCopy
function?

> The platform is Windows XP with GDal 1.6 and visual studio 2005 pro.
> 
> Did I forget something ?

It is really hard to provide advice without the source code.  I'm basically
guessing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From szekerest at gmail.com  Fri Nov 13 10:10:38 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 10:10:41 2009
Subject: [gdal-dev] GDAL C# interface
In-Reply-To: <000601ca6438$7c5ff4d0$751fde70$@gov.cn>
References: <000601ca6438$7c5ff4d0$751fde70$@gov.cn>
Message-ID: <f3b73b7d0911130710g1e03ec38ke39449dba4b8683c@mail.gmail.com>

Hi,

You could try one of the packages available from here for example:
http://vbkto.dyndns.org/sdk/

Best regards,

Tamas


2009/11/13  <yanbohe@cma.gov.cn>:
> Dear All,
>
>
>
> Who have GDAL binary DLL libs for C#? I download the source code and did not
> successes to compile them for C# interface.
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From szekerest at gmail.com  Fri Nov 13 10:32:54 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 10:32:57 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
Message-ID: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>

Hi Even,

Yes, I thought it was a bit complicated issue. I would also support
replacing the array of pointers with a hashtable to eliminate the
unnecessary memory requirement. I've been looking at the code and
found a hashset implementation in CPL which could probably be utilized
here, however this one doesn't support to auto-grow and it should also
store all the items with the same hash value (along with the key) in a
linked list instead replacing each other. I don't think it would
significantly slow down the lookup process since only the list of the
same hash should be iterated.

The problem of the nRasterXSize limitation is more significant IMO,
however I think it would be enough to change the type from integer to
float or double and some type casts should be added in the related
expressions. But it would indeed be a significant change in gdal,
however I think we should start thinking about it in order to support
the (virtually) large raster dimensions.


Best regards,

Tamas



2009/11/13 Even Rouault <even.rouault@mines-paris.org>:
> Hi Tamas,
>
> 2 issues directly related to the big raster dimensions :
>
> * Currently GDAL allocates an array of pointer to raster blocks of size
> nBlocksPerRow x nBlocksPerColumn where nBlocksPerRow =
> (nRasterXSize+nBlockXSize-1) / nBlockXSize and nBlocksPerColumn =
> (nRasterYSize+nBlockYSize-1) / nBlockYSize.
> When TileLevel = 20, nBlocksPerRow = nBlocksPerColumn = 1 048 576. This is too
> big. Currently, we then try to use a second level of block array
> ("sub-blocking") as soon as nBlocksPerRow > SUBBLOCK_SIZE/2 (SUBBLOCK_SIZE=64).
> This leads to allocating nSubBlocksPerRow x nSubBlocksPerColumn where
> nSubBlocksPerRow = (nBlocksPerRow + SUBBLOCK_SIZE + 1)/SUBBLOCK_SIZE and
> nSubBlocksPerColumn = (nBlocksPerColumn + SUBBLOCK_SIZE + 1)/SUBBLOCK_SIZE.
> In that case, nSubBlocksPerRow = nSubBlocksPerColumn = 16384, and
> nSubBlocksPerRow x nSubBlocksPerColumn = 268 435 456 pointers, so 1 GB on a
> 32bit machine or 2 GB on a 64bit machine.
>
> --> So we would need a three-level block cache. This would be feasable
> (implementation "detail" of gdalrasterband.cpp).
>
> Or I'm thinking that we could completely remove the array and use instead a hash
> map that would map a block number to its raster block. Could cause a (small?)
> slowdown of course but would be simpler to implement and maintain than a 3 level
> array.
>
> * At TileLevel = 23, nRasterXSize = 2 147 483 648, which is ahem just one byte
> more than the largest signed int, so = -2147483648
> --> The proper solution would be to promote nRasterXSize/nRasterYSize to be of
> type GIntBig (64bit). We would also need to update the IReadBlock(),
> IWriteBlock(), IRasterIO() interfaces (and probably many others) to use GIntBig.
> So this is both a large API and ABI breakage, that IMHO looks more like a GDAL
> 2.0 project... An alternative would be to have both the existing 'int'
> variables/interfaces and introduce new GIntBIG variables/interfaces, and migrate
> GDAL internals (gcore/* alg/*) and the relevant drivers such as WMS to use the
> GIntBig version. Could easily turn to be very messy in the end...
>
> I cannot think of an easy workaround. An idea would be to split the WMS extent
> into 4 pieces to go under the 2 147 486 647 pixel limit, but this is not really
> doable without a small hack in the TMS minidriver as you would need to add an
> offset to the x and y tile number requested to the server.
>
> Best regards,
>
> Even
>
From yanbohe at cma.gov.cn  Fri Nov 13 10:38:07 2009
From: yanbohe at cma.gov.cn (yanbohe@cma.gov.cn)
Date: Fri Nov 13 10:38:03 2009
Subject: =?gb2312?B?tPC4tDogW2dkYWwtZGV2XSBHREFMIEMjIGludGVyZmFjZQ==?=
In-Reply-To: <f3b73b7d0911130710g1e03ec38ke39449dba4b8683c@mail.gmail.com>
References: <000601ca6438$7c5ff4d0$751fde70$@gov.cn>
	<f3b73b7d0911130710g1e03ec38ke39449dba4b8683c@mail.gmail.com>
Message-ID: <000001ca6477$4bf9d330$e3ed7990$@gov.cn>

Dear Tamas=A3=AC=20

Thanks for your reply and I checked the URLS in your email. Yes there =
are
some binary packages supporting C#. But I checked the supporting raster
formats, I found the one I will to use, HDF4 format is not included. Is
there any ideas or good suggestions?=20

Thanks a lot

Yanbo   =20

-----=D3=CA=BC=FE=D4=AD=BC=FE-----
=B7=A2=BC=FE=C8=CB: Tamas Szekeres [mailto:szekerest@gmail.com]=20
=B7=A2=CB=CD=CA=B1=BC=E4: 2009=C4=EA11=D4=C213=C8=D5 23:11
=CA=D5=BC=FE=C8=CB: yanbohe@cma.gov.cn
=B3=AD=CB=CD: gdal-dev@lists.osgeo.org
=D6=F7=CC=E2: Re: [gdal-dev] GDAL C# interface

Hi,

You could try one of the packages available from here for example:
http://vbkto.dyndns.org/sdk/

Best regards,

Tamas


2009/11/13  <yanbohe@cma.gov.cn>:
> Dear All,
>
>
>
> Who have GDAL binary DLL libs for C#? I download the source code and =
did
not
> successes to compile them for C# interface.
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From szekerest at gmail.com  Fri Nov 13 10:57:51 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 10:57:53 2009
Subject: =?GB2312?B?UmU6ILTwuLQ6IFtnZGFsLWRldl0gR0RBTCBDIyBpbnRlcmZhY2U=?=
In-Reply-To: <000001ca6477$4bf9d330$e3ed7990$@gov.cn>
References: <000601ca6438$7c5ff4d0$751fde70$@gov.cn>
	<f3b73b7d0911130710g1e03ec38ke39449dba4b8683c@mail.gmail.com>
	<000001ca6477$4bf9d330$e3ed7990$@gov.cn>
Message-ID: <f3b73b7d0911130757y770bb16ftddd03af03172bd6d@mail.gmail.com>

Probaly FWTools or osgeo4w would support hdf4 packages.

Best regards,

Tamas



2009/11/13  <yanbohe@cma.gov.cn>:
> Dear Tamas=A3=AC
>
> Thanks for your reply and I checked the URLS in your email. Yes there are
> some binary packages supporting C#. But I checked the supporting raster
> formats, I found the one I will to use, HDF4 format is not included. Is
> there any ideas or good suggestions?
>
> Thanks a lot
>
> Yanbo
>
> -----=D3=CA=BC=FE=D4=AD=BC=FE-----
> =B7=A2=BC=FE=C8=CB: Tamas Szekeres [mailto:szekerest@gmail.com]
> =B7=A2=CB=CD=CA=B1=BC=E4: 2009=C4=EA11=D4=C213=C8=D5 23:11
> =CA=D5=BC=FE=C8=CB: yanbohe@cma.gov.cn
> =B3=AD=CB=CD: gdal-dev@lists.osgeo.org
> =D6=F7=CC=E2: Re: [gdal-dev] GDAL C# interface
>
> Hi,
>
> You could try one of the packages available from here for example:
> http://vbkto.dyndns.org/sdk/
>
> Best regards,
>
> Tamas
>
>
> 2009/11/13  <yanbohe@cma.gov.cn>:
>> Dear All,
>>
>>
>>
>> Who have GDAL binary DLL libs for C#? I download the source code and did
> not
>> successes to compile them for C# interface.
>>
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
From warmerdam at pobox.com  Fri Nov 13 11:05:11 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 13 11:05:12 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
Message-ID: <4AFD83B7.8080002@pobox.com>

Tamas Szekeres wrote:
> Hi Even,
> 
> Yes, I thought it was a bit complicated issue. I would also support
> replacing the array of pointers with a hashtable to eliminate the
> unnecessary memory requirement. I've been looking at the code and
> found a hashset implementation in CPL which could probably be utilized
> here, however this one doesn't support to auto-grow and it should also
> store all the items with the same hash value (along with the key) in a
> linked list instead replacing each other. I don't think it would
> significantly slow down the lookup process since only the list of the
> same hash should be iterated.

Tamas / Even,

I would like any transition in this area to include some performance
analysis with large and modest sized images.

> The problem of the nRasterXSize limitation is more significant IMO,
> however I think it would be enough to change the type from integer to
> float or double and some type casts should be added in the related
> expressions. But it would indeed be a significant change in gdal,
> however I think we should start thinking about it in order to support
> the (virtually) large raster dimensions.

I would prefer to limit ourselves to 2 gigapixels by 2 gigapixels images
for the time being.  I just can't yet see that larger images are of
sufficient interest to justify the complexity involved in properly
supporting larger images throughout GDAL.

If we were to do so, I'd want it handled via an RFC.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Chris.Barker at noaa.gov  Fri Nov 13 11:23:56 2009
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Fri Nov 13 11:21:44 2009
Subject: [gdal-dev] Return codes in gdalwarp
In-Reply-To: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
References: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
Message-ID: <4AFD881C.2090101@noaa.gov>

Michal Migurski wrote:
> The GTiff files that I 
> might see as input to this script include palette and non-palette 
> images,

> This didn't work with palette images, for which I 
> got an error like: "ERROR 1: JPEGSetupEncode:PhotometricInterpretation 3 
> not allowed for JPEG"

Enhanced error reporting would be great, but this particular issue could 
(should) be addressed in another way.

It's a pretty common case that visual images can be stored either as 
palette or RGB(A). However, when you want to re-size, or warp an image, 
palette often doesn't work well -- you'll generally get a better image 
if you allow interpolated (anti-aliased) colors.

In your case, I'd probably convert all the palette images to RGB, then 
do your warping, which would solve your compression issue, as well as 
give you better results.

It would be nice if GDAL could (optionally) do this on-the0fly 
internally, when  re-scaling or warping images, but I don't think it can 
(am I wrong?)

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From acomer at digitalglobe.com  Fri Nov 13 12:31:15 2009
From: acomer at digitalglobe.com (Alex Comer)
Date: Fri Nov 13 12:31:15 2009
Subject: [gdal-dev] GDAL WMS Timeout
Message-ID: <776D8D3D76D94B448BEDCAC5D41AF6DF03F4995D@COMAIL01.digitalglobe.com>

I am working on a software project which must load data from a WMS
server. To accomplish this, I am planning to use GDALOpen() to open a
GDAL_WMS XML file (by way of the GDAL WMS client driver - see
http://www.gdal.org/frmt_wms.html). In prototypes, this was seen to work
pretty well, however in my project I have a very strict requirement
around the maximum amount of time that may be spent fetching the image
from the WMS. If the fetching process takes any longer than the timeout,
the operation must immediately fail. 

 

I noticed that the GDAL WMS driver supports a "Timeout" tag in the XML
input parameters which is documented as the "Connection timeout in
seconds. (optional, defaults to 300)". I was hopeful that this parameter
will help me solve the problem, so I examined how this value is used in
the WMS driver and found that it is effectively passed to CURL via the
CURLOPT_TIMEOUT option in gdalhttp.cpp (see
http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/wms/gdalhttp.cpp).
The CURL documentation states that CURLOPT_TIMEOUT specifies the
"maximum time in seconds that you allow the libcurl transfer operation
to take" (see
http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTTIMEOUT
<http://curl.haxx.se/libcurl/c/curl_easy_setopt.html%23CURLOPTTIMEOUT>
). 

 

In the function CPLHTTPFetchMulti() in gdalhttp.cpp, the call is made to
curl_multi_perform(), which appears to do the bulk of the transfer work.
According to my understanding of curl_multi_perform(), if the timeout is
reached then curl_multi_perform() will return, however I don't see any
logic in CPLHTTPFetchMulti() which then aborts the transfer on the
timeout condition. Instead, it appears that the loop will just keep
retrying to download the file. 

 

As I stated, in my project the operation must abort if the timeout is
reached. Yet based on my analysis of the code in CPLHTTPFetchMulti() it
seems that setting the "Timeout" option is not going to abort the
operation as I require. Am I missing something? Can anyone verify what
kind of semantics we can expect when we set the "Timeout" option? If I
am mistaken, and the GDALOpen() operation is aborted on a timeout
condition, then how can I determine whether the operation failed as a
result of a timeout?

 

Thanks very much in advance,

Alex Comer

 

 


This electronic communication and any attachments may contain confidential and proprietary 
information of DigitalGlobe, Inc. If you are not the intended recipient, or an agent or employee 
responsible for delivering this communication to the intended recipient, or if you have received 
this communication in error, please do not print, copy, retransmit, disseminate or 
otherwise use the information. Please indicate to the sender that you have received this 
communication in error, and delete the copy you received. DigitalGlobe reserves the 
right to monitor any electronic communication sent or received by its employees, agents 
or representatives.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091113/a52d0990/attachment.html
From even.rouault at mines-paris.org  Fri Nov 13 13:27:47 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Nov 13 13:27:50 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
Message-ID: <1258136867.4afda523dd2f3@imp.free.fr>

Selon Tamas Szekeres <szekerest@gmail.com>:

> Hi Even,
>
> Yes, I thought it was a bit complicated issue. I would also support
> replacing the array of pointers with a hashtable to eliminate the
> unnecessary memory requirement. I've been looking at the code and
> found a hashset implementation in CPL which could probably be utilized
> here, however this one doesn't support to auto-grow and it should also
> store all the items with the same hash value (along with the key) in a
> linked list instead replacing each other. I don't think it would
> significantly slow down the lookup process since only the list of the
> same hash should be iterated.
>

Tamas,

Yes, I was exactly thinking at CPLHashSet. This can be used as a hashmap (and is
already used in gdaldataset.cpp for example to maintain the 'list' of opened
datasets) if you insert in it elements of a structure that has both the key and
value, and your hash and equal functions only hash and compare on the key part
of the structure.

But I'm surprised you claim it doesn't support auto-grow and cannot store items
with the same hash value : those both features are already implemented and
unless you prove me wrong, they work ;-)

Best regards,

Even


From szekerest at gmail.com  Fri Nov 13 13:35:56 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 13:35:59 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <4AFD83B7.8080002@pobox.com>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
	<4AFD83B7.8080002@pobox.com>
Message-ID: <f3b73b7d0911131035u455ae3cake2082ef4b9240e6c@mail.gmail.com>

2009/11/13 Frank Warmerdam <warmerdam@pobox.com>:
> Tamas Szekeres wrote:
>>
>> Hi Even,
>>
>> Yes, I thought it was a bit complicated issue. I would also support
>> replacing the array of pointers with a hashtable to eliminate the
>> unnecessary memory requirement. I've been looking at the code and
>> found a hashset implementation in CPL which could probably be utilized
>> here, however this one doesn't support to auto-grow and it should also
>> store all the items with the same hash value (along with the key) in a
>> linked list instead replacing each other. I don't think it would
>> significantly slow down the lookup process since only the list of the
>> same hash should be iterated.
>
> Tamas / Even,
>
> I would like any transition in this area to include some performance
> analysis with large and modest sized images.
>

Frank,

I guess mostly the tile-based raster data sources would suffer from
this memory issue. In this regard it would only be reasonable to have
those alternative implementations added to those drivers only. We
should probably consider which functions have to be made 'virtual' to
be able to modify the generic block cache implementation by the
driver.

>> The problem of the nRasterXSize limitation is more significant IMO,
>> however I think it would be enough to change the type from integer to
>> float or double and some type casts should be added in the related
>> expressions. But it would indeed be a significant change in gdal,
>> however I think we should start thinking about it in order to support
>> the (virtually) large raster dimensions.
>
> I would prefer to limit ourselves to 2 gigapixels by 2 gigapixels images
> for the time being. ?I just can't yet see that larger images are of
> sufficient interest to justify the complexity involved in properly
> supporting larger images throughout GDAL.
>
> If we were to do so, I'd want it handled via an RFC.
>

This is true probably for most of the existing drivers. However for
the server based raster data sources can have no such limit in the
size when the supported level of the detail is increasing, may be
earlier than we can expect.

Best regards,

Tamas
From szekerest at gmail.com  Fri Nov 13 13:51:25 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 13:51:29 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <1258136867.4afda523dd2f3@imp.free.fr>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
	<1258136867.4afda523dd2f3@imp.free.fr>
Message-ID: <f3b73b7d0911131051p7c041063i95f036cc8b4e5bef@mail.gmail.com>

2009/11/13 Even Rouault <even.rouault@mines-paris.org>:

>
> But I'm surprised you claim it doesn't support auto-grow and cannot store items
> with the same hash value : those both features are already implemented and
> unless you prove me wrong, they work ;-)
>

Even,

Yes, you're right!  By looking into the code again it looks pretty
customizable with those function pointers. I'll be trying to test it
with the WMS driver to implement an alternative block cache within
that. I hope it will work well at least up to TileLevel 22.


Best regards,

Tamas
From seth at pricepages.org  Fri Nov 13 15:21:44 2009
From: seth at pricepages.org (Seth Price)
Date: Fri Nov 13 17:19:49 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <f3b73b7d0911131035u455ae3cake2082ef4b9240e6c@mail.gmail.com>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
	<4AFD83B7.8080002@pobox.com>
	<f3b73b7d0911131035u455ae3cake2082ef4b9240e6c@mail.gmail.com>
Message-ID: <56509.129.123.22.14.1258143704.squirrel@pricepages.org>

Jumping in here, and I may be misunderstanding, but I don't see how we
would have greater than 2 gigapixel images in the foreseeable future.
Doing the math: if we represent the entire earth as a single image, each
pixel would be 2 cm at the equator, and the whole image would be 6291456
TB in size (24-bit image).

I'm not even sure if it's physically possible to image the globe at better
than 2 cm.
~Seth

On Fri, November 13, 2009 11:35 am, Tamas Szekeres wrote:
> 2009/11/13 Frank Warmerdam <warmerdam@pobox.com>:
>> I would prefer to limit ourselves to 2 gigapixels by 2 gigapixels images
>> for the time being. ?I just can't yet see that larger images are of
>> sufficient interest to justify the complexity involved in properly
>> supporting larger images throughout GDAL.
>>
>> If we were to do so, I'd want it handled via an RFC.
>>
>
> This is true probably for most of the existing drivers. However for
> the server based raster data sources can have no such limit in the
> size when the supported level of the detail is increasing, may be
> earlier than we can expect.
>
> Best regards,
>
> Tamas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From szekerest at gmail.com  Fri Nov 13 17:51:03 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Nov 13 17:51:06 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <56509.129.123.22.14.1258143704.squirrel@pricepages.org>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
	<4AFD83B7.8080002@pobox.com>
	<f3b73b7d0911131035u455ae3cake2082ef4b9240e6c@mail.gmail.com>
	<56509.129.123.22.14.1258143704.squirrel@pricepages.org>
Message-ID: <f3b73b7d0911131451i1d60c1b2iab899f0de267c2de@mail.gmail.com>

2009/11/13 Seth Price <seth@pricepages.org>:
> Jumping in here, and I may be misunderstanding, but I don't see how we
> would have greater than 2 gigapixel images in the foreseeable future.
> Doing the math: if we represent the entire earth as a single image, each
> pixel would be 2 cm at the equator, and the whole image would be 6291456
> TB in size (24-bit image).
>
> I'm not even sure if it's physically possible to image the globe at better
> than 2 cm.
> ~Seth
>

Seth,

Actually no one would maintain the whole area at the same level of
detail, it would be supported only for some areas at the moment. As an
example see:

http://web0.nearmap.com/?ll=-31.955048,115.849349&z=23&t=h


However we would virtually address the whole image within the domain
of RasterXSize and RasterYSize at tile level 23 in the example above.
And you could pan through the whole world at the same zoom level and
obtain the tiles (at different resolutions of course)


Best regards,

Tamas
From =?UTF-8?Q?=CE=9D=CE=AF=CE=BA=CE=BF=CF=82_?=  Fri Nov 13 19:58:34 2009
From: =?UTF-8?Q?=CE=9D=CE=AF=CE=BA=CE=BF=CF=82_?= (=?UTF-8?Q?=CE=9D=CE=AF=CE=BA=CE=BF=CF=82_?=)
Date: Fri Nov 13 19:58:28 2009
Subject: [gdal-dev] FOSS4G tools - dependency map
In-Reply-To: <ce13c0ca0911130633m37a25830qbf74d475f4e6ed6e@mail.gmail.com>
References: <ce13c0ca0911130633m37a25830qbf74d475f4e6ed6e@mail.gmail.com>
Message-ID: <1258160314.2384.1.camel@vertical>

Eduardo Kanegae wrote:
> Source: http://anthologis.com/2009/11/13/foss4g-tools-dependency-map/
> 
> In 2008 after some GIS setup tasks, I decided to map package
> dependencies in order to help me on future setup tasks.
> So, after discovering the great GraphViz tool
> (http://www.graphviz.org/), I created some scripts to map these deps.

...

Nice idea!
Nikos


From mike at stamen.com  Sat Nov 14 01:47:58 2009
From: mike at stamen.com (Michal Migurski)
Date: Sat Nov 14 01:48:01 2009
Subject: [gdal-dev] Return codes in gdalwarp
In-Reply-To: <14437505.1258129411125.JavaMail.root@n12>
References: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
	<14437505.1258129411125.JavaMail.root@n12>
Message-ID: <D612E0EB-71A6-4C13-B361-325F1FE53E97@stamen.com>

On Nov 13, 2009, at 8:23 AM, Christopher Barker wrote:

> Michal Migurski wrote:
>> The GTiff files that I might see as input to this script include  
>> palette and non-palette images,
>
>> This didn't work with palette images, for which I got an error  
>> like: "ERROR 1: JPEGSetupEncode:PhotometricInterpretation 3 not  
>> allowed for JPEG"
>
> Enhanced error reporting would be great, but this particular issue  
> could (should) be addressed in another way.
>
> It's a pretty common case that visual images can be stored either as  
> palette or RGB(A). However, when you want to re-size, or warp an  
> image, palette often doesn't work well -- you'll generally get a  
> better image if you allow interpolated (anti-aliased) colors.
>
> In your case, I'd probably convert all the palette images to RGB,  
> then do your warping, which would solve your compression issue, as  
> well as give you better results.
>
> It would be nice if GDAL could (optionally) do this on-the0fly  
> internally, when  re-scaling or warping images, but I don't think it  
> can (am I wrong?)

Thanks for the suggestion. It makes sense, though it seems that  
gdal_translate can't do this natively, is that true? I'm looking at  
resources like http://w3.cs.jmu.edu/arch/schol/software/gdal-sup/All.html 
  and they seem to indicate that there's no native palette-to-RGB  
conversion offered in gdal_translate, and I can't find any in the docs.

-mike.

----------------------------------------------------------------
michal migurski- mike@stamen.com
                  415.558.1610


From even.rouault at mines-paris.org  Sat Nov 14 05:14:56 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Nov 14 05:15:02 2009
Subject: [gdal-dev] Return codes in gdalwarp
In-Reply-To: <D612E0EB-71A6-4C13-B361-325F1FE53E97@stamen.com>
References: <A321E65E-24BA-4D2D-B9E4-8FFF5AA8D411@stamen.com>
	<14437505.1258129411125.JavaMail.root@n12>
	<D612E0EB-71A6-4C13-B361-325F1FE53E97@stamen.com>
Message-ID: <1258193696.4afe832040f33@imp.free.fr>

Selon Michal Migurski <mike@stamen.com>:

> Thanks for the suggestion. It makes sense, though it seems that
> gdal_translate can't do this natively, is that true? I'm looking at
> resources like http://w3.cs.jmu.edu/arch/schol/software/gdal-sup/All.html
>   and they seem to indicate that there's no native palette-to-RGB
> conversion offered in gdal_translate, and I can't find any in the docs.
>

http://www.gdal.org/gdal_translate.html mentions the -expand rgb option.

e.g. : gdal_translate -expand rgb src_palette.tif dst_rgb.tif
From ajc200 at maths.leeds.ac.uk  Sat Nov 14 13:10:55 2009
From: ajc200 at maths.leeds.ac.uk (A.J. Carter)
Date: Sat Nov 14 13:25:01 2009
Subject: [gdal-dev] New user query about OGR library NTF import
Message-ID: <Pine.GSO.4.64.0911141749360.15677@amsta>

Hello,

I was hoping someone might be able to help me with a query about using the 
OGR library to read an Ordnance Survey Landform Profile file in NTf format:

http://www.ordnancesurvey.co.uk/oswebsite/products/landformprofile/techinfo.html

The file contains a 501 X 501 grid with height values at each point. From 
the technical reference on the OS web page it lists this as being stored 
within a field called Z_COORD. Manually inspecting the NTF file (which is 
plain text) I can see values like 00159 meaning 15.9m AOD. If I run the 
NTF through OGRINFO -al on the file produces a feature for this point:

OGRFeature)DTM_SD19SW):1
   HEIGHT (Integer) = 15
   POINT (310000.0 490000.0 15.899999618530273)

At the moment I can't understand why it's writing out the height as an 
integer, and also where the many decimal places in the z coordinate of the 
point have come from.

Any help would be much appreciated.

I'm relatively new to GIS software; sorry if this is a silly question!

Many thanks,
Alex
From warmerdam at pobox.com  Sat Nov 14 13:27:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Nov 14 13:27:39 2009
Subject: [gdal-dev] New user query about OGR library NTF import
In-Reply-To: <Pine.GSO.4.64.0911141749360.15677@amsta>
References: <Pine.GSO.4.64.0911141749360.15677@amsta>
Message-ID: <931f8ea90911141027w3596d731k43d8e6f50e55417a@mail.gmail.com>

Alex,

Can you provide access to an example file?  If
distribution is an issue, you can make it available just
to me.

Best regards,

On Sat, Nov 14, 2009 at 1:10 PM, A.J. Carter <ajc200@maths.leeds.ac.uk> wrote:
> Hello,
>
> I was hoping someone might be able to help me with a query about using the
> OGR library to read an Ordnance Survey Landform Profile file in NTf format:
>
> http://www.ordnancesurvey.co.uk/oswebsite/products/landformprofile/techinfo.html
>
> The file contains a 501 X 501 grid with height values at each point. From
> the technical reference on the OS web page it lists this as being stored
> within a field called Z_COORD. Manually inspecting the NTF file (which is
> plain text) I can see values like 00159 meaning 15.9m AOD. If I run the NTF
> through OGRINFO -al on the file produces a feature for this point:
>
> OGRFeature)DTM_SD19SW):1
> ?HEIGHT (Integer) = 15
> ?POINT (310000.0 490000.0 15.899999618530273)
>
> At the moment I can't understand why it's writing out the height as an
> integer, and also where the many decimal places in the z coordinate of the
> point have come from.
>
> Any help would be much appreciated.
>
> I'm relatively new to GIS software; sorry if this is a silly question!
>
> Many thanks,
> Alex
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From ajc200 at maths.leeds.ac.uk  Sat Nov 14 13:49:22 2009
From: ajc200 at maths.leeds.ac.uk (A.J. Carter)
Date: Sat Nov 14 13:49:29 2009
Subject: [gdal-dev] New user query about OGR library NTF import
In-Reply-To: <931f8ea90911141027w3596d731k43d8e6f50e55417a@mail.gmail.com>
References: <Pine.GSO.4.64.0911141749360.15677@amsta>
	<931f8ea90911141027w3596d731k43d8e6f50e55417a@mail.gmail.com>
Message-ID: <Pine.GSO.4.64.0911141836470.22801@amsta>

Dear Frank,

Many thanks for your e-mail and such a rapid reply!

I don't want to suggest that there is necessarily a problem with the OGR 
library, it could well be that I simply don't understand what it is doing 
of course.

An example file is available on the OS web-site:

http://www.ordnancesurvey.co.uk/oswebsite/products/landformprofile/sampledata/lfprdntf.exe

(self extracting zip file)

and the technical reference which describes the format at

http://www.ordnancesurvey.co.uk/oswebsite/products/landformprofile/pdf/D05300_23%20Land-Form%20PROFILE%20UG%20TS.pdf

(see pdf page 29 onward).

In the NTF file the first record of 'type' 50 (i.e. data) starts

"510000000100000501-0030-0033..."

which I think means the first two grid point have heights -3.0m and -3.3m 
respectively (Z_MULT=0.1 hence X by 0.1).

In the OGRINFO -la output for the file (produced using FWtools246 under 
windows XP pro within a 32 bit virtual machine) the first two features 
are:

OGRFeature(DTM_SS78NE):1
   HEIGHT (Integer) = -3
   POINT (275000 185000 -3)

OGRFeature(DTM_SS78NE):2
   HEIGHT (Integer) = -3
   POINT (275000.0 185010.0 -3.299999952316284)

What I can't understand is why the height is reported as an integer and 
also where the figures after the decimal point in the z coordinate are 
coming from.

Overall what I am hoping to achive is a simple text file listing X, Y, Z 
(one per line of the file) coordinates for the land surface which can be 
fed into a surface generation program (surfer).

Any help in understanding the OGR output would be appreciated.

Best Wishes,
Alex


On Sat, 14 Nov 2009, Frank Warmerdam wrote:

> Alex,
>
> Can you provide access to an example file?  If
> distribution is an issue, you can make it available just
> to me.
>
> Best regards,
>
> On Sat, Nov 14, 2009 at 1:10 PM, A.J. Carter <ajc200@maths.leeds.ac.uk> wrote:
>> Hello,
>>
>> I was hoping someone might be able to help me with a query about using the
>> OGR library to read an Ordnance Survey Landform Profile file in NTf format:
>>
>> http://www.ordnancesurvey.co.uk/oswebsite/products/landformprofile/techinfo.html
>>
>> The file contains a 501 X 501 grid with height values at each point. From
>> the technical reference on the OS web page it lists this as being stored
>> within a field called Z_COORD. Manually inspecting the NTF file (which is
>> plain text) I can see values like 00159 meaning 15.9m AOD. If I run the NTF
>> through OGRINFO -al on the file produces a feature for this point:
>>
>> OGRFeature)DTM_SD19SW):1
>> HEIGHT (Integer) = 15
>> POINT (310000.0 490000.0 15.899999618530273)
>>
>> At the moment I can't understand why it's writing out the height as an
>> integer, and also where the many decimal places in the z coordinate of the
>> point have come from.
>>
>> Any help would be much appreciated.
>>
>> I'm relatively new to GIS software; sorry if this is a silly question!
>>
>> Many thanks,
>> Alex
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
From even.rouault at mines-paris.org  Sat Nov 14 17:32:28 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Nov 14 17:32:32 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <4AFAB817.6020801@pmldnet.com>
References: <20091110205406.14591.qmail@s466.sureserver.com>
	<1257934501.4afa8ea572fb2@imp.free.fr>
	<4AFAB817.6020801@pmldnet.com>
Message-ID: <1258237948.4aff2ffcd7d0c@imp.free.fr>

Selon Ivan <ivan.lucena@pmldnet.com>:

I've commited new API that adds ReadRaster() and WriteRaster() methods that use
the regular Java arrays (byte[], short[], int[], float[], double[]). See
http://gdal.org/java

On my PC,
http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/java/apps/GDALTestIO.java
runs in about 20.3s for the ReadRaster()/WriteRaster() case, and in about 24.7s
for the ReadRaster_Direct()/WriteRaster_Direct() case. Not a big advantage
(which tends to not any advantage at all when run with the -server flag, as both
run in about 21.3 s !), but regular Java arrays are a bit easier to use than
ByteBuffer (especially that with Sun JVM 1.6, the array() method on ByteBuffer
is not implemented).

> Even,
>
> You are right. The point is how to take full advantage of the GDAL Java API
> choosing the right
> approach to deal with the raster buffer on the client side.
>
> Best regards,
>
> Ivan
>
> Even Rouault wrote:
> > Selon Ivan <ivan.lucena@pmldnet.com>:
> >
> > Ivan,
> >
> > I'm not sure what you are really measuring if you compare a C++ code versus
> its
> > translation to Java code. I think it just reflects the known slowdown of
> Java
> > when doing intensive computations in comparison to native code. The 0.2
> second
> > difference between the regular array version and the ByteBuffer one is the
> > interesting result, not the 1.2/1.0 second difference between C++ and Java.
> >
> >> Caio Simone,
> >>
> >> I just downloaded imageio-ext to check how it does that but it looks like
> I
> >> don't need to do that now, I can take you report instead. Thank you very
> >> much. I will take a look on array pinning for a start.
> >>
> >> I translated the GDAL Proximity [1] code to Java and I timed both of then
> >> with the same input, a 1024x1024 byte image with just one pixel as feature
> at
> >> the center of the image.
> >>
> >> It took 0.3 seconds in C++ and 1.5 seconds in Java!
> >>
> >> I then translated the buffers to regular arrays and it went down a little
> >> bit, 1.3 seconds.
> >>
> >> It is still a big disadvantage. I believe that the buffer-to-buffer
> >> translation is the guilt time waster in that case.
> >>
> >> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
> >>
> >> My best regards,
> >>
> >> Ivan
> >>
> >>>  -------Original Message-------
> >>>  From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
> >>>  Subject: Re: [gdal-dev] Re: JAVA API - Performance
> >>>  Sent: Nov 10 '09 12:36
> >>>
> >>>  Ciao Even,
> >>>  just wanted to add my 2 cents.
> >>>
> >>>  As you know for the imageio-ext project we have been using the
> >>>  GDAL-JNI bindings (actually a modified version of them) for a while in
> >>>  order to allow Java users to leverage on GDAL using the ImageIO
> >>>  framework which standard in Java.
> >>>  This way we also enabled GeoTools and GeoServer to use GDAL as a
> >> datasource.
> >>>  In the past I have done quite some performance tests to add some
> >>>  new/different methods to them and I can summarise our findings as
> >>>  follows:
> >>>
> >>>  - DirectByteBuffer vs regular arrays -
> >>>  DBB is expensive to allocate but prevent the VM from performing copies
> >>>  when having to move data to and from java and native code since they
> >>>  live on the native space not on the java heap; On the other side the
> >>>  regular arrays are fast to allocate but they are "usually" copied when
> >>>  moved across from/to java and native code since the JVM cannot leave
> >>>  the native code mess with the java heap space since the garbage
> >>>  collector would not be very happy about that. I said "usually" since
> >>>  there is a technique called array pinning that we can suggest the JVM
> >>>  to use to avoid the copy of regular array; however this mechanism is
> >>>  not guaranteed to be implemented and/or to work on each call (same
> >>>  reason as above, GC is not happy about this technique).
> >>>
> >>>  If you can pool the DBB  and/or use a few large DBB, where the cost of
> >>>  the copy would overcome the cost of its creation then DBB are much
> >>>  better than regular arrays. As an instance I noticed that using when
> >>>  reading striped tiff files regular arrays where faster, but as the
> >>>  tile size increases (and therefore the cost of a copy overcomes the
> >>>  cost of a DBB creation) the DBB performs much better
> >>>
> >>>  - DirectByteBuffer and the impact on some JVM -
> >>>  Now in the past we decided to stick with DBB and give
> >>>  GeoServer/GeoTools users the capability to retile data on the fly.
> >>>  However lately, during the WMS performance shootout we noticed on some
> >>>  linux machines JVm soldi crashed, not nice (means restarting the
> >>>  GeoServer!!!).
> >>>  We investigated a bit in depth and the problem was that somehow the
> >>>  JVM was failing to allocate some internal images during the rendering
> >>>  process and then dying with a NullPointerException (apparently the SUN
> >>>  Java2D engineers did not use to check for out of memory errors in the
> >>>  java native space). Well, what happens is that if you use too much of
> >>>  the Java native space for your own objects, it is likely that the JVM
> >>>  itself will start to malfunction (you can find articles on the web on
> >>>  the memory model of a Java process, I don't think I am good enough to
> >>>  explain it ) since it cannot allocate its own objects.
> >>>
> >>>  In the end we decide to leave DBB and go back to regular arrays with
> >>>  array pinning. This ensured us robustness and we did not see much
> >>>  performance degradation (which means that array pinning in the end
> >>>  works). This has been implemented by modifying the SWIG bindings for
> >>>  GDAL in order to use a byte array instead of a DBB and then use
> >>>  ByteArray utils to convert between different native type (short, int,
> >>>  etc..).
> >>>
> >>>  - Conclusion -
> >>>  We might want to spend some time in the mid term to contribute some of
> >>>  this work back (or probably provide funding), but anyway, it would be
> >>>  great to have the capability to switch between DBB and regular arrays
> >>>  since both have flaws.
> >>>  However atm if I were asked I would say to go with regular arrays as
> >>>  we do in the imageio-ext project.
> >>>
> >>>  Ciao,
> >>>  Simone.
> >>>  -------------------------------------------------------
> >>>  Ing. Simone Giannecchini
> >>>  GeoSolutions S.A.S.
> >>>  Founder - Software Engineer
> >>>  Via Carignoni 51
> >>>  55041  Camaiore (LU)
> >>>  Italy
> >>>
> >>>  phone: +39 0584983027
> >>>  fax:      +39 0584983027
> >>>  mob:    +39 333 8128928
> >>>
> >>>
> >>>  http://www.geo-solutions.it
> >>>  http://geo-solutions.blogspot.com/
> >>>  http://simboss.blogspot.com/
> >>>  http://www.linkedin.com/in/simonegiannecchini
> >>>
> >>>  -------------------------------------------------------
> >>>
> >>>
> >>>
> >>>  On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
> >>>  <even.rouault@mines-paris.org> wrote:
> >>>  > Selon Ivan <ivan.lucena@pmldnet.com>:
> >>>  >
> >>>  > Ivan,
> >>>  >
> >>>  > thanks for your testing (CC'ing the list as it is of general
> interest).
> >>>  > Actually, I also read on some sites that using ByteBuffer object
> versus
> >> regular
> >>>  > Java arrays is not always a win. Plus the fact that we must use a
> direct
> >> buffer
> >>>  > that has an extra allocation cost according to the Javadoc. So
> >> ByteBuffer might
> >>>  > be interesting if you just want to pass big arrays between native
> code,
> >> for
> >>>  > example if you read an array from a dataset and then write it to
> another
> >> one
> >>>  > without accessing it from the Java side. When you mention that
> accessing
> >> through
> >>>  > the byte[] array was faster, did you get it with the array() method
> >> instead ?
> >>>  > I'm wondering what the performance overhead of this call is.
> >>>  >
> >>>  > As ByteBuffer is not at all a requirement for the interface with the
> >> native
> >>>  > code, it would be technically possible to add an alternative API that
> >> would use
> >>>  > the regular Java array types.
> >>>  >
> >>>  > Would you mind opening an enhancement ticket about that ? Thanks
> >>>  >
> >>>  > Even
> >>>  >
> >>>  >> Even,
> >>>  >>
> >>>  >> I did some test with the GDAL Java API and some simple raster
> >> operations
> >>>  >> like the GDAL Proximity algorthm and I noticed that the performance
> >> while
> >>>  >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value)
> is
> >> not
> >>>  >> as good as if you copy then to (or from) a "regular" array, like
> >> float[],
> >>>  >> double[], integer[] and byte[].
> >>>  >>
> >>>  >> The reason for that is obvious, get() and put() are funtion calls and
> >>>  >> contains a lot of code for range check.
> >>>  >>
> >>>  >> If I understand it correctly, ByteBuffer is the ideal or maybe the
> only
> >>>  >> way to get access to Buffers from C libraries thought a Java wrapper.
> >> But
> >>>  >> do you it would be possible to incapsulate the buffer conversion at
> the
> >>>  >> wrapper code so that users would be able to read and write direct to
> >>>  >> regular Java arrays?
> >>>  >>
> >>>  >> Just a suggestion,
> >>>  >>
> >>>  >> Ivan
> >>>  >>
> >>>  >
> >>>  >
> >>>  > _______________________________________________
> >>>  > gdal-dev mailing list
> >>>  > gdal-dev@lists.osgeo.org
> >>>  > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>>  >
> >>>
> >
> >
> >
>
>


From szekerest at gmail.com  Sat Nov 14 18:33:48 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Nov 14 18:33:52 2009
Subject: [gdal-dev] Re: Problems with large raster sizes (WMS/TMS)
In-Reply-To: <f3b73b7d0911131051p7c041063i95f036cc8b4e5bef@mail.gmail.com>
References: <f3b73b7d0911130732j1056bb72k6f12daee8ca3f8f@mail.gmail.com>
	<1258136867.4afda523dd2f3@imp.free.fr>
	<f3b73b7d0911131051p7c041063i95f036cc8b4e5bef@mail.gmail.com>
Message-ID: <f3b73b7d0911141533p29327ce5s6b7fadbcc504c1a@mail.gmail.com>

Folks,

I've created a ticket with this issue and attached the patch trying to
handle both issues.
http://trac.osgeo.org/gdal/ticket/3224

According to the changes the gdal default block cache implementation
have been replaced with a hashtable based approach for the WMS driver,
and the raster sizes have been limited to INT_MAX with the driver.

I would be happy if someone could review the patch, it seems working
well in my test cases with block_size=256 and up to tile level: 23.


Best regards,

Tamas



2009/11/13 Tamas Szekeres <szekerest@gmail.com>:
> 2009/11/13 Even Rouault <even.rouault@mines-paris.org>:
>
>>
>> But I'm surprised you claim it doesn't support auto-grow and cannot store items
>> with the same hash value : those both features are already implemented and
>> unless you prove me wrong, they work ;-)
>>
>
> Even,
>
> Yes, you're right! ?By looking into the code again it looks pretty
> customizable with those function pointers. I'll be trying to test it
> with the WMS driver to implement an alternative block cache within
> that. I hope it will work well at least up to TileLevel 22.
>
>
> Best regards,
>
> Tamas
>
From randyqiuxy at hotmail.com  Sun Nov 15 01:45:09 2009
From: randyqiuxy at hotmail.com (Randy)
Date: Sun Nov 15 01:45:17 2009
Subject: [gdal-dev] GDAL installing about building openev
Message-ID: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>

Hi list,
when I "./configure..." the OpenEv,the error is as follows:

configure: Using requested GDAL_HOME
of /home/randyqiu/run-time/gdal-1.6.2
checking for GDALOpen in -lgdal... no
checking for GDALOpen in -lgdal... (cached) no
checking for GDALOpen in -lgdal... (cached) no
configure: error: 
OpenEV requires GDAL library, but it was not found.  Please download
and install it.  See http://www.remotesensing.org/gdal

But I have install GDAL successfully and there are four files(bin
include lib share)in the path "/home/randyqiu/run-time/gdal-1.6.2".

I found Vali Poncos once had the same problem, but I haven't found the
solution.Anyone could help me?
Best regards,
Randy

From warmerdam at pobox.com  Sun Nov 15 10:39:37 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Nov 15 10:39:41 2009
Subject: [gdal-dev] GDAL installing about building openev
In-Reply-To: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>
References: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>
Message-ID: <931f8ea90911150739g6b629c72s3da58e42d0f2476a@mail.gmail.com>

On Sun, Nov 15, 2009 at 1:45 AM, Randy <randyqiuxy@hotmail.com> wrote:
> Hi list,
> when I "./configure..." the OpenEv,the error is as follows:
>
> configure: Using requested GDAL_HOME
> of /home/randyqiu/run-time/gdal-1.6.2
> checking for GDALOpen in -lgdal... no
> checking for GDALOpen in -lgdal... (cached) no
> checking for GDALOpen in -lgdal... (cached) no
> configure: error:
> OpenEV requires GDAL library, but it was not found. ?Please download
> and install it. ?See http://www.remotesensing.org/gdal
>
> But I have install GDAL successfully and there are four files(bin
> include lib share)in the path "/home/randyqiu/run-time/gdal-1.6.2".

Randy,

I'm not clear on what GDAL related options you passed to
configure.  You may find it helpful to open config.log in an
editor and look for GDALOpen, then examine that area
of the log for a more specific idea of why things failed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From srikanth1947 at gmail.com  Mon Nov 16 04:57:08 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Mon Nov 16 05:07:16 2009
Subject: [gdal-dev] reg GDALPolygonize
Message-ID: <7a566dfe0911160157x433c312cp947504fcaa208874@mail.gmail.com>

Dear All ,

I am trying to convert a raster to vector using GDALPolygonize function .
Below is the code I am using
GDALAllRegister();

String pszFilename = "C:\\Images\\image.tiff";

poDataset = (GDALDataset *) GDALOpen( pszFilename , GA_ReadOnly );

GDALRasterBand *poBandR,*poBandG,*poBandB;

poBandR = poDataset->GetRasterBand(1);

OGRLayer* poLayer;

GDALPolygonize(poBandR , NULL , poLayer ,1,NULL,NULL,NULL);


The process is crashed in the polygonize function. I wonder what might be
wrong with the above. (or should I assign memory to OGRLayer ?)

Any suggestions/examples regarding the same are appreciated.


-- 
Regards,
Srikanth K.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091116/00b3988a/attachment.html
From jason.roberts at duke.edu  Mon Nov 16 11:37:24 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Mon Nov 16 11:37:34 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for Windows to
	work around Xerces binary conflicts?
Message-ID: <001d01ca66db$14614370$3d23ca50$@roberts@duke.edu>

Greetings GDAL team,

 

The main GDAL download page
http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries contains a link to
"minimalist" Windows executables for GDAL 1.6.0, built by Frank W when GDAL
1.6.0 was released. Is there any possibility you could offer similar
binaries of 1.6.2 or the upcoming 1.6.3?

 

The only other source of up-to-date GDAL Windows binaries I know of is
http://vbkto.dyndns.org/sdk/, maintained by Tamas S. These are great, but
unfortunately I cannot use them because they compile a GDAL driver or
plug-in that links with xerces-c, and my application loads GDAL in ArcGIS
and MATLAB processes that also link with xerces-c and there is a DLL
conflict. This issue came up at GDAL 1.6.0 release time and Frank agreed to
rerelease the minimalist 1.6.0 binaries without the Xerces dependency. See
http://trac.osgeo.org/osgeo4w/ticket/31 for more information about that.

 

It would be very helpful to me if you could release these minimalist Windows
executables with every GDAL bugfix release. I have been limping along on
1.6.0, waiting for 1.7.0 (when, presumably, minimalist binaries will be
released again), but I just hit a SWIG issue that causes parts of OGR in
1.6.0 to be incompatible with ArcGIS 9.3. This issue was fixed in SWIG
1.3.39. Using Tamas's 1.6.2 binaries built with SWIG 1.3.39, I verified that
the problem is resolved, but I can't use Tamas's binaries in my production
code due to the Xerces problem.

 

So, I am at the point that I will either have to start building minimalist
binaries 1.6.x myself or delay some new OGR-dependent functionality in my
app until 1.7.0 minimalist binaries are released (assuming they will be). I
can figure out how to build myself but I'm hoping that by raising this
Xerces issue again, you might be convinced that minimalist binaries are
important enough to release them with every bugfix release. What do you
think?

 

Thanks very much for your consideration,

 

Jason

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091116/c91c976b/attachment.html
From szekerest at gmail.com  Mon Nov 16 14:25:15 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon Nov 16 14:25:18 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for Windows 
	to work around Xerces binary conflicts?
In-Reply-To: <-329514582488746425@unknownmsgid>
References: <-329514582488746425@unknownmsgid>
Message-ID: <f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>

Jason,

It's quite difficult to find out what combination of the dependencies
would be demanding for the users, by taking out the significant
components it would be unusable for most of the users.

I just wanted to mention it's quite straightforward exclude xerces
support and recompile gdal, by using the following steps:

1. Download the SDK package for your compiler/architecture from
http://vbkto.dyndns.org/sdk/ and extract it into a directory
2. Check out the current version of gdal from SVN into the SDK root dir.
3. Open Makefile and remove (or comment out) 'GDAL_XERCES = YES' and
set up 'GDAL_DIR = [gdal directory name]'
4. Open a Visual Studio Command Prompt and type:  'nmake gdal'

Best regards,

Tamas





2009/11/16 Jason Roberts <jason.roberts@duke.edu>:
> Greetings GDAL team,
>
>
>
> The main GDAL download page
> http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries contains a link to
> "minimalist" Windows executables for GDAL 1.6.0, built by Frank W when GDAL
> 1.6.0 was released. Is there any possibility you could offer similar
> binaries of 1.6.2 or the upcoming 1.6.3?
>
>
>
> The only other source of up-to-date GDAL Windows binaries I know of is
> http://vbkto.dyndns.org/sdk/, maintained by Tamas S. These are great, but
> unfortunately I cannot use them because they compile a GDAL driver or
> plug-in that links with xerces-c, and my application loads GDAL in ArcGIS
> and MATLAB processes that also link with xerces-c and there is a DLL
> conflict. This issue came up at GDAL 1.6.0 release time and Frank agreed to
> rerelease the minimalist 1.6.0 binaries without the Xerces dependency. See
> http://trac.osgeo.org/osgeo4w/ticket/31 for more information about that.
>
>
>
> It would be very helpful to me if you could release these minimalist Windows
> executables with every GDAL bugfix release. I have been limping along on
> 1.6.0, waiting for 1.7.0 (when, presumably, minimalist binaries will be
> released again), but I just hit a SWIG issue that causes parts of OGR in
> 1.6.0 to be incompatible with ArcGIS 9.3. This issue was fixed in SWIG
> 1.3.39. Using Tamas's 1.6.2 binaries built with SWIG 1.3.39, I verified that
> the problem is resolved, but I can't use Tamas's binaries in my production
> code due to the Xerces problem.
>
>
>
> So, I am at the point that I will either have to start building minimalist
> binaries 1.6.x myself or delay some new OGR-dependent functionality in my
> app until 1.7.0 minimalist binaries are released (assuming they will be). I
> can figure out how to build myself but I'm hoping that by raising this
> Xerces issue again, you might be convinced that minimalist binaries are
> important enough to release them with every bugfix release. What do you
> think?
>
>
>
> Thanks very much for your consideration,
>
>
>
> Jason
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From kevin.chiou at progeny.net  Mon Nov 16 15:14:49 2009
From: kevin.chiou at progeny.net (Chiou, Kevin)
Date: Mon Nov 16 15:15:00 2009
Subject: [gdal-dev] NITF CGM Parsing solution
Message-ID: <3F87AA6367687C43A854B8E7073CDF8C0BD92E@es-108a.paxriver.progeny.net>

Hi,
I would like to share how I was able to use "Uniconvertor" library to
parse NITF CGM data.

For those of you who worked with NITF images, you probably know NITF
specification supports graphics with CGM.  There are libraries out there
that will read out CGM data (GDAL being one of them), but none of them
translates raw CGM data into a useful form.  And it has being very
difficult to find any open source library that would actually parses
CGM.  

However, I have found the Uniconvertor, which is an open source
universal vector graphics translator in Python.  Since the program
supports CGM, we were able to use Uniconvertor to parse CGM into the
Uniconvertor format (they called it document).  At that point you can
read graphics data from the Uniconvertor "documents" and in each of the
"document" you can retrieve information for individual geometry as well
as properties.  

I was able to successfully read and render NITF official sample image
U_1092c.NTF, which contains around 100 different CGM shapes including
lines, texts, rectangles, polygons, circles and ellipses.

Here are some of the Pros and Cons of Uniconvertor:
Pros:
1)	It parse multiple vector formats: CDR, CDRX, CDT, CMX, AI, CGM,
WMF, XFIG, SVG, SK, SK1, AFF,etc.  You can use Uniconvertor to convert
other vector data into GDAL/OGR formats.
2)	It's open source (LGPL)

Cons:
1)	Written in Python.  You cannot use this in another languages.
2)	No interface documentation or tutorial.
3)	In the CGM case, Uniconvertor did some coordinate transformation
after it read in the data. I had to look through the source code and
worked out the inverse transformation to get the original coordinate.

Uniconvertor:
http://sk1project.org/modules.php?name=Products&product=uniconvertor

In conclusion, it's possible to use Uniconvertor to parse CGM data into
a usable form.  Moreover, since Uniconvertor supports multiple vector
formats, you can use the approach I described to convert other vector
graphics formats into an OGR dataset.

-Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091116/0cdfdeea/attachment.html
From jason.roberts at duke.edu  Mon Nov 16 15:18:32 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Mon Nov 16 15:18:43 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for
	Windows	to work around Xerces binary conflicts?
In-Reply-To: <f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>
References: <-329514582488746425@unknownmsgid>
	<f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>
Message-ID: <004701ca66f9$f889c9f0$e99d5dd0$@roberts@duke.edu>

Tamas,

Thank you for the specific instructions on that. It sounds very easy. I will
try it out this afternoon.

I know what you mean, that it is difficult to decide on a combination of
dependencies that meets the needs of everyone. I thought that maybe the
presence of a "minimalist" Windows binary on the main download page
indicated that the GDAL team thought that the minimalist combination was
worthwhile to produce on a regular basis. But I can see how choosing things
will be a slippery slope that the team would not want to go down.

As it stands, even with your helpful instructions and SDK, it is not
possible to use GDAL with Xerces support in conjunction with MATLAB, ArcGIS,
or other projects that also leverage Xerces and do the same thing that GDAL
does: compile Xerces with dynamic linking and retain the default name of the
DLL. The ultimate solution to this problem is to have the various projects
that use Xerces adopt a naming or binding convention that prevents the
problem from occurring. Ideally the Xerces team would recognize this problem
and provide guidance. (I have not tried to raise it with them.) Absent that,
perhaps statically linking with Xerces, or changing the DLL name to
something specific to GDAL, would be appropriate.

Of course, this is a classic game theory problem: all the players (GDAL,
ESRI, MathWorks, and others) would prefer that the *other* players take the
effort to compile Xerces in the non-default manner, so that they can
continue to use the default compilation. I am hoping that eventually the
GDAL team would take an interest in this and make a change; getting through
the corporate development processes of ESRI and MathWorks is very hard.
Nonetheless, those organizations are just as much "responsible" for the
problem as GDAL, and I am not offering a negative critique of anyone. I very
much appreciate the efforts of the GDAL team, who save me countless hours in
various ways, even if you don't ever fix this problem. It is just sad when
the dreams of efficient modularity and reuse do not fully deliver, despite
everyone's best efforts, and one finds oneself the loser by reaching for too
much interoperability. (Sorry for the dramatic statement.)

Jason

-----Original Message-----
From: Tamas Szekeres [mailto:szekerest@gmail.com] 
Sent: Monday, November 16, 2009 2:25 PM
To: Jason Roberts
Cc: gdal-dev
Subject: Re: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for Windows
to work around Xerces binary conflicts?

Jason,

It's quite difficult to find out what combination of the dependencies
would be demanding for the users, by taking out the significant
components it would be unusable for most of the users.

I just wanted to mention it's quite straightforward exclude xerces
support and recompile gdal, by using the following steps:

1. Download the SDK package for your compiler/architecture from
http://vbkto.dyndns.org/sdk/ and extract it into a directory
2. Check out the current version of gdal from SVN into the SDK root dir.
3. Open Makefile and remove (or comment out) 'GDAL_XERCES = YES' and
set up 'GDAL_DIR = [gdal directory name]'
4. Open a Visual Studio Command Prompt and type:  'nmake gdal'

Best regards,

Tamas





2009/11/16 Jason Roberts <jason.roberts@duke.edu>:
> Greetings GDAL team,
>
>
>
> The main GDAL download page
> http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries contains a link to
> "minimalist" Windows executables for GDAL 1.6.0, built by Frank W when
GDAL
> 1.6.0 was released. Is there any possibility you could offer similar
> binaries of 1.6.2 or the upcoming 1.6.3?
>
>
>
> The only other source of up-to-date GDAL Windows binaries I know of is
> http://vbkto.dyndns.org/sdk/, maintained by Tamas S. These are great, but
> unfortunately I cannot use them because they compile a GDAL driver or
> plug-in that links with xerces-c, and my application loads GDAL in ArcGIS
> and MATLAB processes that also link with xerces-c and there is a DLL
> conflict. This issue came up at GDAL 1.6.0 release time and Frank agreed
to
> rerelease the minimalist 1.6.0 binaries without the Xerces dependency. See
> http://trac.osgeo.org/osgeo4w/ticket/31 for more information about that.
>
>
>
> It would be very helpful to me if you could release these minimalist
Windows
> executables with every GDAL bugfix release. I have been limping along on
> 1.6.0, waiting for 1.7.0 (when, presumably, minimalist binaries will be
> released again), but I just hit a SWIG issue that causes parts of OGR in
> 1.6.0 to be incompatible with ArcGIS 9.3. This issue was fixed in SWIG
> 1.3.39. Using Tamas's 1.6.2 binaries built with SWIG 1.3.39, I verified
that
> the problem is resolved, but I can't use Tamas's binaries in my production
> code due to the Xerces problem.
>
>
>
> So, I am at the point that I will either have to start building minimalist
> binaries 1.6.x myself or delay some new OGR-dependent functionality in my
> app until 1.7.0 minimalist binaries are released (assuming they will be).
I
> can figure out how to build myself but I'm hoping that by raising this
> Xerces issue again, you might be convinced that minimalist binaries are
> important enough to release them with every bugfix release. What do you
> think?
>
>
>
> Thanks very much for your consideration,
>
>
>
> Jason
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From jluis at ualg.pt  Mon Nov 16 15:38:23 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon Nov 16 15:38:31 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for	Windows
	to work around Xerces binary conflicts?
In-Reply-To: <004701ca66f9$f889c9f0$e99d5dd0$@roberts@duke.edu>
References: <-329514582488746425@unknownmsgid>	<f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>
	<004701ca66f9$f889c9f0$e99d5dd0$@roberts@duke.edu>
Message-ID: <4B01B83F.4040702@ualg.pt>

Jason,

In what concerns TheMathWorks (Matlab), it's not only xercers that you 
must worry about but also netCDF, zlib1 and very likely some others. For 
example many ML releases used an old, or not compatible, zlib1.dll that 
simply got in the way and screwed everything. Now they are more modern 
and use manifest, which potentially screw you in the same way.
I solved that by creating (recompiling) zlib1, netcdf, libjpeg, ... with 
different names so that they be called and used peacefully from my GDAL 
based mexs (which don't link against Xerces).

Joaquim Luis

> Tamas,
>
> Thank you for the specific instructions on that. It sounds very easy. I will
> try it out this afternoon.
>
> I know what you mean, that it is difficult to decide on a combination of
> dependencies that meets the needs of everyone. I thought that maybe the
> presence of a "minimalist" Windows binary on the main download page
> indicated that the GDAL team thought that the minimalist combination was
> worthwhile to produce on a regular basis. But I can see how choosing things
> will be a slippery slope that the team would not want to go down.
>
> As it stands, even with your helpful instructions and SDK, it is not
> possible to use GDAL with Xerces support in conjunction with MATLAB, ArcGIS,
> or other projects that also leverage Xerces and do the same thing that GDAL
> does: compile Xerces with dynamic linking and retain the default name of the
> DLL. The ultimate solution to this problem is to have the various projects
> that use Xerces adopt a naming or binding convention that prevents the
> problem from occurring. Ideally the Xerces team would recognize this problem
> and provide guidance. (I have not tried to raise it with them.) Absent that,
> perhaps statically linking with Xerces, or changing the DLL name to
> something specific to GDAL, would be appropriate.
>
> Of course, this is a classic game theory problem: all the players (GDAL,
> ESRI, MathWorks, and others) would prefer that the *other* players take the
> effort to compile Xerces in the non-default manner, so that they can
> continue to use the default compilation. I am hoping that eventually the
> GDAL team would take an interest in this and make a change; getting through
> the corporate development processes of ESRI and MathWorks is very hard.
> Nonetheless, those organizations are just as much "responsible" for the
> problem as GDAL, and I am not offering a negative critique of anyone. I very
> much appreciate the efforts of the GDAL team, who save me countless hours in
> various ways, even if you don't ever fix this problem. It is just sad when
> the dreams of efficient modularity and reuse do not fully deliver, despite
> everyone's best efforts, and one finds oneself the loser by reaching for too
> much interoperability. (Sorry for the dramatic statement.)
>   

From jason.roberts at duke.edu  Mon Nov 16 17:26:39 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Mon Nov 16 17:26:50 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for	Windows
	to work around Xerces binary conflicts?
In-Reply-To: <4B01B83F.4040702@ualg.pt>
References: <-329514582488746425@unknownmsgid>
	<f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>
	<004701ca66f9$f889c9f0$e99d5dd0$%roberts@duke.edu>
	<4B01B83F.4040702@ualg.pt>
Message-ID: <005e01ca670b$de9ca730$9bd5f590$@roberts@duke.edu>

Hi Joaquim,

Thanks for sharing your experience with that. Fortunately I have not hit the
compatibility problem with other libraries. Perhaps it is because I'm using
the MATLAB Compiler / MATLAB Component Runtime (MCR, not mex, and only
referencing a very limited number of MATLAB functions and toolboxes. My
guess is that those other libraries are delay loaded or explicitly loaded,
and that I'm just getting lucky by not using MATLAB to read netCDFs, for
example.

The approach you recommend, renaming those common libraries, seems like a
good way to deal with it.

Frank W mentioned in a private email that he thought that GDAL is using
binaries provided by the Xerces team. If that is indeed the case, then this
Xerces compatibility issue may arise from ESRI or MathWorks compiling their
own Xerces, rather than using the one provided by the Xerces team. In that
case, I would say that ESRI and MathWorks are breaking interoperability, and
I'd have a hard time making a case that GDAL should do anything different...


Jason

-----Original Message-----
From: Joaquim Luis [mailto:jluis@ualg.pt] 
Sent: Monday, November 16, 2009 3:38 PM
To: Jason Roberts
Cc: 'Tamas Szekeres'; 'gdal-dev'
Subject: Re: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for Windows
to work around Xerces binary conflicts?

Jason,

In what concerns TheMathWorks (Matlab), it's not only xercers that you 
must worry about but also netCDF, zlib1 and very likely some others. For 
example many ML releases used an old, or not compatible, zlib1.dll that 
simply got in the way and screwed everything. Now they are more modern 
and use manifest, which potentially screw you in the same way.
I solved that by creating (recompiling) zlib1, netcdf, libjpeg, ... with 
different names so that they be called and used peacefully from my GDAL 
based mexs (which don't link against Xerces).

Joaquim Luis

> Tamas,
>
> Thank you for the specific instructions on that. It sounds very easy. I
will
> try it out this afternoon.
>
> I know what you mean, that it is difficult to decide on a combination of
> dependencies that meets the needs of everyone. I thought that maybe the
> presence of a "minimalist" Windows binary on the main download page
> indicated that the GDAL team thought that the minimalist combination was
> worthwhile to produce on a regular basis. But I can see how choosing
things
> will be a slippery slope that the team would not want to go down.
>
> As it stands, even with your helpful instructions and SDK, it is not
> possible to use GDAL with Xerces support in conjunction with MATLAB,
ArcGIS,
> or other projects that also leverage Xerces and do the same thing that
GDAL
> does: compile Xerces with dynamic linking and retain the default name of
the
> DLL. The ultimate solution to this problem is to have the various projects
> that use Xerces adopt a naming or binding convention that prevents the
> problem from occurring. Ideally the Xerces team would recognize this
problem
> and provide guidance. (I have not tried to raise it with them.) Absent
that,
> perhaps statically linking with Xerces, or changing the DLL name to
> something specific to GDAL, would be appropriate.
>
> Of course, this is a classic game theory problem: all the players (GDAL,
> ESRI, MathWorks, and others) would prefer that the *other* players take
the
> effort to compile Xerces in the non-default manner, so that they can
> continue to use the default compilation. I am hoping that eventually the
> GDAL team would take an interest in this and make a change; getting
through
> the corporate development processes of ESRI and MathWorks is very hard.
> Nonetheless, those organizations are just as much "responsible" for the
> problem as GDAL, and I am not offering a negative critique of anyone. I
very
> much appreciate the efforts of the GDAL team, who save me countless hours
in
> various ways, even if you don't ever fix this problem. It is just sad when
> the dreams of efficient modularity and reuse do not fully deliver, despite
> everyone's best efforts, and one finds oneself the loser by reaching for
too
> much interoperability. (Sorry for the dramatic statement.)
>   


From jluis at ualg.pt  Mon Nov 16 18:01:10 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon Nov 16 18:01:18 2009
Subject: [gdal-dev] "Minimalist" GDAL 1.6.2 / 1.6.3 binaries for	Windows
	to work around Xerces binary conflicts?
In-Reply-To: <005e01ca670b$de9ca730$9bd5f590$@roberts@duke.edu>
References: <-329514582488746425@unknownmsgid>
	<f3b73b7d0911161125u7ab2a741o8546ca130d04d7a5@mail.gmail.com>
	<004701ca66f9$f889c9f0$e99d5dd0$%roberts@duke.edu>
	<4B01B83F.4040702@ualg.pt>
	<005e01ca670b$de9ca730$9bd5f590$@roberts@duke.edu>
Message-ID: <4B01D9B6.6010405@ualg.pt>

Jason Roberts wrote:
> Hi Joaquim,
>
> Thanks for sharing your experience with that. Fortunately I have not hit the
> compatibility problem with other libraries. Perhaps it is because I'm using
> the MATLAB Compiler / MATLAB Component Runtime (MCR, not mex, and only
> referencing a very limited number of MATLAB functions and toolboxes. My
> guess is that those other libraries are delay loaded or explicitly loaded,
> and that I'm just getting lucky by not using MATLAB to read netCDFs, for
> example.
>   

Hmm, I use the compiler as well, but not that 
pretend-to-be-a-compiler-one.  I use the good old one 6.5 true compiler.

> The approach you recommend, renaming those common libraries, seems like a
> good way to deal with it.
>   

Actually, I'm afraid it's not that simple. We can't just rename the 
dlls, we have to rebuild them with a different name.

> Frank W mentioned in a private email that he thought that GDAL is using
> binaries provided by the Xerces team. If that is indeed the case, then this
> Xerces compatibility issue may arise from ESRI or MathWorks compiling their
> own Xerces, rather than using the one provided by the Xerces team. In that
> case, I would say that ESRI and MathWorks are breaking interoperability, and
> I'd have a hard time making a case that GDAL should do anything different...
>   

Absolutely true according to my experience. TMW, which I know better, 
behaves like it has the "King in the belly" (a Portuguese saying). They 
just don't give a shit for the official libraries and ship their own 
ones, which wouldn't be a problem if it didn't interfere with the 
outside world, but they do.
I had also troubles with ArcGis that installed old incompatible 
zlib1.dll under Windows/system32. Just imagine the chaos that it 
produced on the classroom machines (for that one I'm free, since by 
principle I don't get nearer than 5 m to a computer with Arcs in it).



From randyqiuxy at hotmail.com  Tue Nov 17 00:46:28 2009
From: randyqiuxy at hotmail.com (Randy)
Date: Tue Nov 17 00:46:41 2009
Subject: [gdal-dev] GDAL installing about building openev
In-Reply-To: <931f8ea90911150739g6b629c72s3da58e42d0f2476a@mail.gmail.com>
References: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>
	<931f8ea90911150739g6b629c72s3da58e42d0f2476a@mail.gmail.com>
Message-ID: <BLU0-SMTP2760AF694D14A77E8BBAAFC3A40@phx.gbl>

Hi Frank and list,
I haven't solved this problem yet.I have checked config.log and just
found the info:
"configure:5590: Using requested GDAL_HOME
of /home/randyqiu/run-time/gdal-1.6.2
configure:5605: checking for GDALOpen in -lgdal
configure:5640: gcc -o conftest   -O2 -I/usr/local/include
-I/usr/local/include  conftest.c -lgdal  -lgdal
-L/home/randyqiu/run-time/gdal-1.6.2/lib  -lgtkgl    -ldl
-L/usr/local/lib >&5
/usr/bin/ld: cannot find -lgtkgl
collect2: ld returned 1 exit status
configure:5647: $? = 1
configure: failed program was:
| /* confdefs.h.  */
| #define PACKAGE_NAME ""
| #define PACKAGE_TARNAME ""
| #define PACKAGE_VERSION ""
| #define PACKAGE_STRING ""
| #define PACKAGE_BUGREPORT ""
| #define HAVE_LIBDL 1
| #define STDC_HEADERS 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_SYS_STAT_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_INTTYPES_H 1
| #define HAVE_STDINT_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_FCNTL_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_DLFCN_H 1
| #define HAVE_STRING_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_VPRINTF 1
| #define USE_GNUCC 1
| #define USE_GNUCC 1
| /* end confdefs.h.  */
| 
| /* Override any GCC internal prototype to avoid an error.
|    Use char because int might match the return type of a GCC
|    builtin and then its argument prototype would still apply.  */
| #ifdef __cplusplus
| extern "C"
| #endif
| char GDALOpen ();
| int
| main ()
| {
| return GDALOpen ();
|   ;
|   return 0;
| }
configure:5668: result: no
configure:5679: checking for GDALOpen in -lgdal
configure:5742: result: no
configure:5754: checking for GDALOpen in -lgdal
configure:5817: result: no
configure:5832: error: 
OpenEV requires GDAL library, but it was not found.  Please download
and install it.  See http://www.remotesensing.org/gdal "

But I don't have any idea about the info.I thought there is something
wrong with building GDAL since there is error info as follows although
"configure: exit 0" and applications in GDAL/bin work very well:

"conftest.cpp:19:28: error: ac_nonexistent.h: No such file or directory"
"conftest.c:67:20: error: direct.h: No such file or directory"
"conftest.c: In function 'main':
conftest.c:41: error: 'not' undeclared (first use in this function)
conftest.c:41: error: (Each undeclared identifier is reported only once
conftest.c:41: error: for each function it appears in.)
conftest.c:41: error: expected ';' before 'big'
configure:16000: $? = 1
configure: failed program was:
| /* confdefs.h.  */
| #define PACKAGE_NAME """

Any suggestion? Thanks!
Best regards,
Randy

? 2009-11-15?? 10:39 -0500?Frank Warmerdam???
> On Sun, Nov 15, 2009 at 1:45 AM, Randy <randyqiuxy@hotmail.com> wrote:
> > Hi list,
> > when I "./configure..." the OpenEv,the error is as follows:
> >
> > configure: Using requested GDAL_HOME
> > of /home/randyqiu/run-time/gdal-1.6.2
> > checking for GDALOpen in -lgdal... no
> > checking for GDALOpen in -lgdal... (cached) no
> > checking for GDALOpen in -lgdal... (cached) no
> > configure: error:
> > OpenEV requires GDAL library, but it was not found.  Please download
> > and install it.  See http://www.remotesensing.org/gdal
> >
> > But I have install GDAL successfully and there are four files(bin
> > include lib share)in the path "/home/randyqiu/run-time/gdal-1.6.2".
> 
> Randy,
> 
> I'm not clear on what GDAL related options you passed to
> configure.  You may find it helpful to open config.log in an
> editor and look for GDALOpen, then examine that area
> of the log for a more specific idea of why things failed.
> 
> Best regards,

From vvvjjj0 at yahoo.co.in  Tue Nov 17 01:01:25 2009
From: vvvjjj0 at yahoo.co.in (vvv jjj)
Date: Tue Nov 17 01:01:30 2009
Subject: [gdal-dev] Saving changed raster data
Message-ID: <197312.6675.qm@web95208.mail.in2.yahoo.com>

Hello

Im trying to save large image whose raster data is mostly changed and projection details are not altered. That is I'm trying to save the raster image with changed raster data using RasterIO to a new file. Im able to save the updated data correctly, but the time it took for changing is quite large when the input image format and output image format are different. That is when I tried to save an input img file to output img file it took far less time compared to saving input img file to output tif file (with raster data updated). Is this the expected behavior or did I missed anything. Kindly suggest me the better method to save the updated raster data to another file.

Thanks in advance.

J.Viswanath


      The INTERNET now has a personality. YOURS! See your Yahoo! Homepage. http://in.yahoo.com/
From martin.raspaud at smhi.se  Tue Nov 17 02:07:59 2009
From: martin.raspaud at smhi.se (Raspaud Martin)
Date: Tue Nov 17 02:08:48 2009
Subject: [gdal-dev] Lat/Lon projection from satellite swath
Message-ID: <783F32138ED65D4A9CF016980481B6BF01CB5808@CORRE.ad.smhi.se>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: martin_raspaud.vcf
Type: text/x-vcard
Size: 260 bytes
Desc: martin_raspaud.vcf
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091117/7ceca20c/martin_raspaud.vcf
From no-reply at neogeo-online.net  Tue Nov 17 04:57:18 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Tue Nov 17 04:57:26 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
Message-ID: <1258451838.2329.8.camel@guillaume-desktop>

Hi,

Don't want to bother you guys, but I'm running into an unsupported SRS
problem I haven't been able to solve on my own for  the past hours...
I'm running geodjango on a legacy server, which is said to be running
Fedora 9, with standard packages for this distro :
gdal-1.5.3-1.fc9.i386
proj-4.5.0-4.fc9.i386
epsg file is located in /usr/share/proj/epsg
I have added to that file the famous 900913 definition, in a proper way,
like I always do :
# Google Spherical Mercator definition
<900913> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0
+x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs <>

When I try to create a SpatialReference with 900913 code, I run into a
SRSException: Unsupported SRS

Same if I run ogr2ogr on a shapefile to project it to Spherical
Mercator :
ogr2ogr -f 'ESRI Shapefile' -t_srs 'EPSG:900913' test.shp
carto_region.shp
ERROR 6: EPSG PCS/GCS code 900913 not found in EPSG support files.  Is
this a valid
EPSG coordinate system?
Failed to process SRS definition: EPSG:900913

I have browse the disk trying to find another epsg file which could
conflict, without result. 

Any hint would be appreciated ! 

Best regards

Guillaume

From jrepetto at free.fr  Tue Nov 17 05:33:52 2009
From: jrepetto at free.fr (Jean-Claude REPETTO)
Date: Tue Nov 17 05:42:31 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
In-Reply-To: <1258451838.2329.8.camel@guillaume-desktop>
References: <1258451838.2329.8.camel@guillaume-desktop>
Message-ID: <4B027C10.7050105@free.fr>

Guillaume Sueur a ?crit :
> I have added to that file the famous 900913 definition
> 
> When I try to create a SpatialReference with 900913 code, I run into a
> SRSException: Unsupported SRS
> 
> Any hint would be appreciated ! 
> 

Hi Guillaume,

Have you tried EPSG:3857, which is the official EPSG number for this 
projection ?

Jean-Claude


From no-reply at neogeo-online.net  Tue Nov 17 08:35:57 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Tue Nov 17 08:36:10 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
In-Reply-To: <4B027C10.7050105@free.fr>
References: <1258451838.2329.8.camel@guillaume-desktop>
	<4B027C10.7050105@free.fr>
Message-ID: <1258464957.19298.1.camel@guillaume-desktop>

I know it's the official one,  but since it has been introduced in proj
4.7 (the server is running 4.5) and OpenLayers still defines it as
900913, no chance to get it work with 3857 !



Le mardi 17 novembre 2009 ? 11:33 +0100, Jean-Claude REPETTO a ?crit :
> Guillaume Sueur a ?crit :
> > I have added to that file the famous 900913 definition
> > 
> > When I try to create a SpatialReference with 900913 code, I run into a
> > SRSException: Unsupported SRS
> > 
> > Any hint would be appreciated ! 
> > 
> 
> Hi Guillaume,
> 
> Have you tried EPSG:3857, which is the official EPSG number for this 
> projection ?
> 
> Jean-Claude
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


From even.rouault at mines-paris.org  Tue Nov 17 08:48:50 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Nov 17 08:48:53 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
In-Reply-To: <1258464957.19298.1.camel@guillaume-desktop>
References: <1258451838.2329.8.camel@guillaume-desktop>
	<4B027C10.7050105@free.fr>
	<1258464957.19298.1.camel@guillaume-desktop>
Message-ID: <1258465730.4b02a9c2d9bbc@imp.free.fr>

Selon Guillaume Sueur <no-reply@neogeo-online.net>:

Guillaume,

I agree that understanding what is the OGR responsibility and what is proj.4
responsability is not always obvious ;-)

When you use "EPSG:xxxx" or "+init=EPSG:xxxxx" as a SRS definition, OGR will try
to resolve the EPSG code from its own CSV data files, and thus will not use
/usr/share/epsg/proj for this. This is normally done with the
$(gdal_data)/gcs.csv or $(gdal_data)/pcs.csv files derived from the EPSG
database. But the simplest way is to add the following line
to $(gdal_data)/cubewerx_extra.wkt

900913,PROJCS["Google Maps Global Mercator",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],EXTENSION["PROJ4","+proj=merc
+a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
+nadgrids=@null +wktext  +no_defs"]]

Well, at least, that's the way it works for trunk. No guarantee this works with
GDAL 1.5.X (I think it should be OK though)

Hum, actually while reviewing SVN history, this should be done in 1.5.3
according to http://trac.osgeo.org/gdal/browser/tags/1.5.3/gdal/data. So check
if the GDAL_DATA environnement variable is well defined.

If it still not works, one workaround is to quote the full PROJ4 string
"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0
+units=m +nadgrids=@null +no_defs" on the ogr2ogr command line.

Even

> I know it's the official one,  but since it has been introduced in proj
> 4.7 (the server is running 4.5) and OpenLayers still defines it as
> 900913, no chance to get it work with 3857 !
>
>
>
> Le mardi 17 novembre 2009 ?? 11:33 +0100, Jean-Claude REPETTO a ??crit :
> > Guillaume Sueur a ??crit :
> > > I have added to that file the famous 900913 definition
> > >
> > > When I try to create a SpatialReference with 900913 code, I run into a
> > > SRSException: Unsupported SRS
> > >
> > > Any hint would be appreciated !
> > >
> >
> > Hi Guillaume,
> >
> > Have you tried EPSG:3857, which is the official EPSG number for this
> > projection ?
> >
> > Jean-Claude
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From no-reply at neogeo-online.net  Tue Nov 17 09:02:45 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Tue Nov 17 09:04:49 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
In-Reply-To: <1258465730.4b02a9c2d9bbc@imp.free.fr>
References: <1258451838.2329.8.camel@guillaume-desktop>
	<4B027C10.7050105@free.fr> <1258464957.19298.1.camel@guillaume-desktop>
	<1258465730.4b02a9c2d9bbc@imp.free.fr>
Message-ID: <1258466565.19298.4.camel@guillaume-desktop>

Le mardi 17 novembre 2009 ? 14:48 +0100, Even Rouault a ?crit :
> Selon Guillaume Sueur <no-reply@neogeo-online.net>:
> 
> Guillaume,
> 
> I agree that understanding what is the OGR responsibility and what is proj.4
> responsability is not always obvious ;-)
> 
> When you use "EPSG:xxxx" or "+init=EPSG:xxxxx" as a SRS definition, OGR will try
> to resolve the EPSG code from its own CSV data files, and thus will not use
> /usr/share/epsg/proj for this. This is normally done with the
> $(gdal_data)/gcs.csv or $(gdal_data)/pcs.csv files derived from the EPSG
> database. But the simplest way is to add the following line
> to $(gdal_data)/cubewerx_extra.wkt

I had the feeling that there was something funny here !
> 
> 900913,PROJCS["Google Maps Global Mercator",GEOGCS["WGS
> 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Mercator_2SP"],PARAMETER["standard_parallel_1",0],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",0],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["Meter",1],EXTENSION["PROJ4","+proj=merc
> +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m
> +nadgrids=@null +wktext  +no_defs"]]
> 
> Well, at least, that's the way it works for trunk. No guarantee this works with
> GDAL 1.5.X (I think it should be OK though)

I'm gonna try it right away. Thanks a lot Even !

> 
> Hum, actually while reviewing SVN history, this should be done in 1.5.3
> according to http://trac.osgeo.org/gdal/browser/tags/1.5.3/gdal/data. So check
> if the GDAL_DATA environnement variable is well defined.
> 
> If it still not works, one workaround is to quote the full PROJ4 string
> "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0
> +units=m +nadgrids=@null +no_defs" on the ogr2ogr command line.
> 
> Even
> 
> > I know it's the official one,  but since it has been introduced in proj
> > 4.7 (the server is running 4.5) and OpenLayers still defines it as
> > 900913, no chance to get it work with 3857 !
> >
> >
> >
> > Le mardi 17 novembre 2009 ?  11:33 +0100, Jean-Claude REPETTO a ??crit :
> > > Guillaume Sueur a ??crit :
> > > > I have added to that file the famous 900913 definition
> > > >
> > > > When I try to create a SpatialReference with 900913 code, I run into a
> > > > SRSException: Unsupported SRS
> > > >
> > > > Any hint would be appreciated !
> > > >
> > >
> > > Hi Guillaume,
> > >
> > > Have you tried EPSG:3857, which is the official EPSG number for this
> > > projection ?
> > >
> > > Jean-Claude
> > >
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> 
> 
> 


From randyqiuxy at hotmail.com  Wed Nov 18 02:02:41 2009
From: randyqiuxy at hotmail.com (Randy)
Date: Wed Nov 18 02:02:52 2009
Subject: [gdal-dev] GDAL installing about building openev
In-Reply-To: <4B02DE9A.9050406@pobox.com>
References: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>
	<931f8ea90911150739g6b629c72s3da58e42d0f2476a@mail.gmail.com>
	<BLU0-SMTP2760AF694D14A77E8BBAAFC3A40@phx.gbl>
	<4B02DE9A.9050406@pobox.com>
Message-ID: <BLU0-SMTP91E7DB39BB0F5677F14B5FC3A30@phx.gbl>


> Randy,
> 
> I think you already received other replies, but I think the problem is
> that an earlier step select gtkgl as a library but without actually
> checking properly if it was available and now the GDAL test fails because
> it also tries to include previous dependencies like gtkgl.
> 
> So the problem isn't GDAL at all, but how gtkgl is found.
> 
> Best regards,

Hi Frank,
Right, you're so right! Thank you so so much!
The reason is that I forgot set some dependencies their proper
environment path.
But I have a question:How do you find the reason of my failure according
to the information in config.log I gave you on last E_mail? 
Thanks again!
Best regards,
Randy

From srikanth1947 at gmail.com  Wed Nov 18 04:11:05 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Wed Nov 18 04:11:27 2009
Subject: [gdal-dev] Re: reg GDALPolygonize
In-Reply-To: <7a566dfe0911160157x433c312cp947504fcaa208874@mail.gmail.com>
References: <7a566dfe0911160157x433c312cp947504fcaa208874@mail.gmail.com>
Message-ID: <7a566dfe0911180111n195c73f6x4ae6741f34d36dec@mail.gmail.com>

Hi ,

I have found the solution myself.
Below is the piece of code for polygonizing the raster.

Yet there is another problem i am facing. I am unable to create a mask band
for a particular pixel value.I understand that could be done using
thresholding. But I did not find any method for that in GDAL.

Any help/suggestions are appreciated.


GDALAllRegister();

OGRRegisterAll();

String pszFilename = "C:\\Images\\s3dImages\\geo_liss.tif";

poDataset = (GDALDataset *) GDALOpen( pszFilename, GA_ReadOnly );

GDALRasterBand *poBandR,*poBandMask ;

poBandR = poDataset->GetRasterBand(1);

poBandR->CreateMaskBand(GMF_PER_DATASET);

poBandMask = poBandR->GetMaskBand() ;

poBandMask->Fill(10,0);

 const char *pszDriverName = "ESRI Shapefile";

OGRSFDriver *poDriver;

poDriver =
OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName);

OGRDataSource* ds = poDriver->CreateDataSource("Shape", NULL );

OGRLayer* poLayer = ds->CreateLayer("myfile",NULL,wkbMultiPolygon,NULL);

CPLErr er = GDALPolygonize(poBandR , poBandMask , poLayer
,1,NULL,NULL,NULL);

 poLayer->SyncToDisk();

OGRDataSource::DestroyDataSource(ds);



On Mon, Nov 16, 2009 at 3:27 PM, Srikanth <srikanth1947@gmail.com> wrote:

> Dear All ,
>
> I am trying to convert a raster to vector using GDALPolygonize function .
> Below is the code I am using
> GDALAllRegister();
>
> String pszFilename = "C:\\Images\\image.tiff";
>
> poDataset = (GDALDataset *) GDALOpen( pszFilename , GA_ReadOnly );
>
> GDALRasterBand *poBandR,*poBandG,*poBandB;
>
> poBandR = poDataset->GetRasterBand(1);
>
> OGRLayer* poLayer;
>
> GDALPolygonize(poBandR , NULL , poLayer ,1,NULL,NULL,NULL);
>
>
> The process is crashed in the polygonize function. I wonder what might be
> wrong with the above. (or should I assign memory to OGRLayer ?)
>
> Any suggestions/examples regarding the same are appreciated.
>
>
> --
> Regards,
> Srikanth K.
>
>
>


-- 
Regards,
Srikanth K.
www.servetheneedy.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/6aeeb88d/attachment.html
From no-reply at neogeo-online.net  Wed Nov 18 04:27:48 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Wed Nov 18 04:27:57 2009
Subject: [gdal-dev] Unsupported SRS but available in epsg file
In-Reply-To: <1258465730.4b02a9c2d9bbc@imp.free.fr>
References: <1258451838.2329.8.camel@guillaume-desktop>
	<4B027C10.7050105@free.fr> <1258464957.19298.1.camel@guillaume-desktop>
	<1258465730.4b02a9c2d9bbc@imp.free.fr>
Message-ID: <1258536468.2690.6.camel@guillaume-desktop>


> When you use "EPSG:xxxx" or "+init=EPSG:xxxxx" as a SRS definition, OGR will try
> to resolve the EPSG code from its own CSV data files, and thus will not use
> /usr/share/epsg/proj for this. This is normally done with the
> $(gdal_data)/gcs.csv or $(gdal_data)/pcs.csv files derived from the EPSG
> database. But the simplest way is to add the following line
> to $(gdal_data)/cubewerx_extra.wkt

It appears that I don't have any "extra" file on the system. If I create
it, will gdal magically use it ?
If not, in which file could I add the 900913 definition above ? I've
tried to put it in pcs.csv, without success.

Regards,

Guillaume


From no-reply at neogeo-online.net  Wed Nov 18 04:54:51 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Wed Nov 18 04:54:56 2009
Subject: [gdal-dev] Gdal and Proj GCS/PCS
Message-ID: <1258538091.2690.25.camel@guillaume-desktop>

Having just realised that gdal doesn't use proj EPSG file for
reprojection (see my previous post on "Unsupported SRS but available in
epsg file"), I have a few questions to clarify the reprojection
processes both in gdal and mapserver :
- where do the gdal gcs/pcs definitions come from ? Is it a separate
repository or proj source files ? 
- Doesn't ogr2ogr use proj definition files at all ? Does this mean that
an ogr2ogr reprojected file can be different than a mapserver
reprojection result if proj/epsg definition and gdal pcs defs are
slightly different ? 
- If I say "GDAL/OGR uses its own definition files to retrieve proj4
definitions and lets proj4 engine do the reprojection job", am I true ? 

Thanks for these clarifications ! 

Regards,

Guillaume

From arb at sat.dundee.ac.uk  Wed Nov 18 06:17:28 2009
From: arb at sat.dundee.ac.uk (Andrew Brooks)
Date: Wed Nov 18 06:19:28 2009
Subject: [gdal-dev] Lat/Lon projection from satellite swath
In-Reply-To: <783F32138ED65D4A9CF016980481B6BF01CB5808@CORRE.ad.smhi.se>
References: <783F32138ED65D4A9CF016980481B6BF01CB5808@CORRE.ad.smhi.se>
Message-ID: <op.u3k8bey5qw3wu1@titan>

On Tue, 17 Nov 2009 07:07:59 -0000, Raspaud Martin <martin.raspaud@smhi.se> wrote:
>
> Now I would like to project satellite data for which I have the 2d lat
> and lon grids onto, say, a polar stereographic projection for example.

GDAL can do this using VRT files.

First create a VRT file to represent your raw data set, eg.
<VRTDataset rasterXSize="2048" rasterYSize="100">
  <VRTRasterBand dataType="UInt16" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativetoVRT="1">input.dat</SourceFilename>
    <ByteOrder>LSB</ByteOrder>
    <other stuff like ImageOffset, PixelOffset, LineOffset, ...>
  </VRTRasterBand>
  <other bands...>
</VRTDataset>

Then do similar for each of your latitude and longitude files, eg.
<VRTDataset rasterXSize="2048" rasterYSize="100">
  <VRTRasterBand dataType="Float32" band="1" subClass="VRTRawRasterBand">
    <SourceFilename relativetoVRT="1">latitude.dat</SourceFilename>
    <ByteOrder>LSB</ByteOrder>
    <other stuff like ImageOffset, PixelOffset, LineOffset, ...>
  </VRTRasterBand>
  <other bands...>
</VRTDataset>
and similarly for longitude.dat

Finally add pointers to the lat/lon VRT files into your data VRT
  <Metadata domain="GEOLOCATION">
    <MDI key="X_DATASET">longitude.vrt</MDI>
    <MDI key="X_BAND">1</MDI>
    <MDI key="Y_DATASET">latitude.vrt</MDI>
    <MDI key="Y_BAND">1</MDI>
    <MDI key="PIXEL_OFFSET">0</MDI>
    <MDI key="LINE_OFFSET">0</MDI>
    <MDI key="PIXEL_STEP">1</MDI>
    <MDI key="LINE_STEP">1</MDI>
  </Metadata>

Then use the data VRT as input to the gdalwarp program.  You may need to
use the -tps option, see the manual page.

That's the general idea; let us know if you have any success or problems.

Andrew

From srikanth1947 at gmail.com  Wed Nov 18 06:53:21 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Wed Nov 18 06:53:43 2009
Subject: [gdal-dev] Re: reg GDALPolygonize
In-Reply-To: <4B03D4F1.5020402@ext.jrc.ec.europa.eu>
References: <7a566dfe0911160157x433c312cp947504fcaa208874@mail.gmail.com> 
	<7a566dfe0911180111n195c73f6x4ae6741f34d36dec@mail.gmail.com> 
	<4B03D4F1.5020402@ext.jrc.ec.europa.eu>
Message-ID: <7a566dfe0911180353uf9987e7l150d54a3d4139d9@mail.gmail.com>

Thanks for the mail Alan.

I am programming it in Cpp and using Qt architechture . I will try with a
new raster band and try to make it as a mask with forecfully assiging a
value to it.




 data = (uchar *) CPLMalloc(sizeof(uchar)*width*height*bytesPerPixel);



poBandR->RasterIO(GF_Read, xOff, yOff, width, height, data, width, height,
(GDALDataType)dataType,bytesPerPixel, 0);



for(int k = 0 ; k < width*height; k++)

{

     if(((uchar*)data)[k] != 255)

       ((uchar*)data)[k] = 0 ;

        else

       ((uchar*)data)[k] = 1 ;



poBandR->RasterIO(GF_Write, xOff, yOff, width, height, data, width, height,
(GDALDataType)dataType,bytesPerPixel, 0);



if(data != NULL)

{

delete data ;

data = NULL ;

}



const char *pszDriverName = "ESRI Shapefile";



OGRSFDriver *poDriver;



poDriver =
OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName);



OGRDataSource* ds = poDriver->CreateDataSource("Shape", NULL );



OGRLayer* poLayer = ds->CreateLayer("myfile",NULL,wkbMultiPolygon,NULL);



CPLErr er = GDALPolygonize(poBandR , NULL , poLayer ,1,NULL,NULL,NULL);

Regards,

Srikanth
On Wed, Nov 18, 2009 at 4:35 PM, Alan Steel <alan.steel@ext.jrc.ec.europa.eu
> wrote:

> Hi Srikanth,
>
> I have used gdal_polygonize.py, which is based on GDALpolygonize(). I think
> you know the algorithm better than I do, as you see that the 2nd argument is
> the mask band, which masks output values that are zero in the mask band.
>
> Ok, that doesn't answer your question, and I don't know what is available
> in GDAL to write custom masks. I only write to suggest that you try learning
> a bit of C (or other programming language), which will alow you to write
> simple routines quickly.
> It does take time to learn, but can be very rewarding - and you can also
> eventually incorporate GDAL libraries into your programs. Not a short-tem
> solution, I know, but good in the long term. A C compiler comes with linux
> (gcc) and there are free IDEs that you can install on any platform.
>
> The following is a loop that would (as part of a C program) write an output
> raster file that masks input pixel integer values with a value of 25 as 0.
>
>        for(b = 0; b < bands; b++){               for(i = 0; i < rows; i++){
>               //read a row of data from input file
>              fread(dataRow, sizeof(int), cols, fp_in1);
>              for(d=dataRow, o=dataRowOut; d < dataRow+cols; d++, o++){
>                  if(*d == 25)
>                      *o = 0;
>              }
>              fwrite(dataRowOut, sizeof(int), cols, fp_out);
>           }                              }
>
> Regards,
>
> Alan
>
>
> Srikanth wrote:
>
>> Hi ,
>>  I have found the solution myself.
>> Below is the piece of code for polygonizing the raster.
>>  Yet there is another problem i am facing. I am unable to create a mask
>> band for a particular pixel value.I understand that could be done using
>> thresholding. But I did not find any method for that in GDAL.
>>  Any help/suggestions are appreciated.
>>
>> GDALAllRegister();
>>
>> OGRRegisterAll();
>>
>> String pszFilename = "C:\\Images\\s3dImages\\geo_liss.tif";
>>
>> poDataset = (GDALDataset *) GDALOpen( pszFilename, GA_ReadOnly );
>>
>> GDALRasterBand *poBandR,*poBandMask ;
>>
>> poBandR = poDataset->GetRasterBand(1);
>>
>> poBandR->CreateMaskBand(GMF_PER_DATASET);
>>
>> poBandMask = poBandR->GetMaskBand() ;
>>
>> poBandMask->Fill(10,0);
>>
>> const char *pszDriverName = "ESRI Shapefile";
>>
>> OGRSFDriver *poDriver;
>>
>> poDriver =
>> OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName);
>>
>> OGRDataSource* ds = poDriver->CreateDataSource("Shape", NULL );
>>
>> OGRLayer* poLayer = ds->CreateLayer("myfile",NULL,wkbMultiPolygon,NULL);
>>
>> CPLErr er = GDALPolygonize(poBandR , poBandMask , poLayer
>> ,1,NULL,NULL,NULL);
>>
>> poLayer->SyncToDisk();
>>
>> OGRDataSource::DestroyDataSource(ds);
>>
>>
>>
>
>


-- 
Regards,
Srikanth K.
www.servetheneedy.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/2484d309/attachment-0001.html
From jukka.rahkonen at mmmtike.fi  Wed Nov 18 09:15:59 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed Nov 18 09:16:24 2009
Subject: [gdal-dev] Is epsg text file read at all when re-projecting with
	FWTools?
Message-ID: <loom.20091118T144630-774@post.gmane.org>

Hi,

With Mapserver I am used to correct projection parameters, if needed, by editing
directly the projection file which is in MS4W package located at
\ms4w\proj\nad\epsg. 
Now I tried to do the same with FWTools 2.4.2.  There is a file with promising
name at \FWTools2.4.2\proj_lib\epsg.  However, I am pretty sure that editing
this file does not change the behaviour of ogr2ogr in any way. Is FWTools taking
the projection definitions from some other place or am I doing something wrong?

What I tried to do was to add +towgs84 parameters. Original line is this 
3067> +proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs  <> 
and I modified it to this:
3067> +proj=utm +zone=35 +ellps=GRS80
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs  <>

FWTools epsg file is having correct parameters for EPSG:2393 projection, but it
seems to me but they are not used either in real use. Only way to get correct
results when reprojecting from epsg:3067 to epsg:2393 is to give both
projections as +proj strings this way

ogr2ogr -f "ESRI Shapefile" output.shp input.shp
-t_srs "+proj=tmerc +lat_0=0 +lon_0=27 +k=1 +x_0=3500000 +y_0=0 
+ellps=intl +towgs84=-96.0617,-82.4278,-121.743,4.80107,0.34543,
-1.37646,1.4964 +units=m"
-s_srs "+proj=utm +zone=35 +ellps=GRS80 
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs"

Giving -t_srs or s_srs as epsg:2393 epsg:3067, respectively, gives a faulty
result which means that +towgs84 parameters are not used at all.

-Jukka Rahkonen-

From simonqlewis at gmail.com  Wed Nov 18 09:45:42 2009
From: simonqlewis at gmail.com (Simon Lewis)
Date: Wed Nov 18 09:45:45 2009
Subject: [gdal-dev] gdal_fillnodata.py only generating zeros
Message-ID: <590d681e0911180645t1c6fae39t453361dac9964b79@mail.gmail.com>

I'm trying to fill nodata values (32767) in some SRTM elevation data using
gdal_fillnodata.py.

But the output file has interpolated pixels all set to zero rather than an
average of the surrounding pixels.
A new output file is created, (surprisingly quickly) so I assume the script
is working OK.

Any pointers/assistance much appreciated.

Simon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/17454d99/attachment.html
From warmerdam at pobox.com  Wed Nov 18 10:15:34 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 18 10:15:40 2009
Subject: [gdal-dev] Is epsg text file read at all when re-projecting with
	FWTools?
In-Reply-To: <loom.20091118T144630-774@post.gmane.org>
References: <loom.20091118T144630-774@post.gmane.org>
Message-ID: <4B040F96.6070400@pobox.com>

Jukka Rahkonen wrote:
> Hi,
> 
> With Mapserver I am used to correct projection parameters, if needed, by editing
> directly the projection file which is in MS4W package located at
> \ms4w\proj\nad\epsg. 
> Now I tried to do the same with FWTools 2.4.2.  There is a file with promising
> name at \FWTools2.4.2\proj_lib\epsg.  However, I am pretty sure that editing
> this file does not change the behaviour of ogr2ogr in any way. Is FWTools taking
> the projection definitions from some other place or am I doing something wrong?
> 
> What I tried to do was to add +towgs84 parameters. Original line is this 
> 3067> +proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs  <> 
> and I modified it to this:
> 3067> +proj=utm +zone=35 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs  <>
> 
> FWTools epsg file is having correct parameters for EPSG:2393 projection, but it
> seems to me but they are not used either in real use. Only way to get correct
> results when reprojecting from epsg:3067 to epsg:2393 is to give both
> projections as +proj strings this way
> 
> ogr2ogr -f "ESRI Shapefile" output.shp input.shp
> -t_srs "+proj=tmerc +lat_0=0 +lon_0=27 +k=1 +x_0=3500000 +y_0=0 
> +ellps=intl +towgs84=-96.0617,-82.4278,-121.743,4.80107,0.34543,
> -1.37646,1.4964 +units=m"
> -s_srs "+proj=utm +zone=35 +ellps=GRS80 
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
> 
> Giving -t_srs or s_srs as epsg:2393 epsg:3067, respectively, gives a faulty
> result which means that +towgs84 parameters are not used at all.

Jukka,

The primary source for EPSG lookups for GDAL utilities is the
gdal/data/pcs.csv and gdal/data/gcs.csv files.  There is logic to
look in a few other places too if a srs is not found in those locations.

In order to introduce a towgs84 parameter for a gcs the normal procedure
is to copy the definition from gcs.csv into gcs.override.csv and add
the towgs84 parameters.  There should be sufficient examples to see how
that might work.

These csv files are found in FWTools\data I believe.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bclay at ball.com  Wed Nov 18 11:09:57 2009
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 18 11:10:35 2009
Subject: [gdal-dev] tab delimited to shapefile
Message-ID: <C482FF98AE985A47B8C982FD429C9E34027EBDD1@daytonmsg2k3.AERO.BALL.COM>

Is there any way to use ogr2ogr to convert tab-delimited data such as
the geoname dot org files into shapefiles short of converting all tabs
to commas?

 

I created a VRT file that works with CSV files but I can not find any
way to convert tab-delimited data.

 

Bruce

 




This message and any enclosures are intended only for the addressee.  Please  
notify the sender by email if you are not the intended recipient.  If you are  
not the intended recipient, you may not use, copy, disclose, or distribute this  
message or its contents or enclosures to any other person and any such actions  
may be unlawful.  Ball reserves the right to monitor and review all messages  
and enclosures sent to or from this email address.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/ae1e7c19/attachment.html
From Jukka.Rahkonen at mmmtike.fi  Wed Nov 18 11:02:15 2009
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 18 11:16:01 2009
Subject: [gdal-dev] Is epsg text file read at all when re-projecting with
	FWTools?
References: <loom.20091118T144630-774@post.gmane.org>
	<4B040F96.6070400@pobox.com>
Message-ID: <CC197224AC75CE4DB23F739B16891B86E3453B@tikka.haapa.mmm.fi>

Hi,

Thanks, that makes things more understandable. Is there some good reason to keep delivering "epsg" text file with FWTools if it is not used for anything? Is it perhaps included for Mapserver that ships with FWTools?

Both my codes, 2393 and 3067 are included in pcs.csv thus I believe I must edit pcs.override.csv.

-Jukka-


-----Alkuper?inen viesti-----
L?hett?j?: Frank Warmerdam [mailto:warmerdam@pobox.com]
L?hetetty: ke 18.11.2009 17:15
Vastaanottaja: Rahkonen Jukka
Kopio: gdal-dev@lists.osgeo.org
Aihe: Re: [gdal-dev] Is epsg text file read at all when re-projecting with FWTools?
 
Jukka Rahkonen wrote:
> Hi,
> 
> With Mapserver I am used to correct projection parameters, if needed, by editing
> directly the projection file which is in MS4W package located at
> \ms4w\proj\nad\epsg. 
> Now I tried to do the same with FWTools 2.4.2.  There is a file with promising
> name at \FWTools2.4.2\proj_lib\epsg.  However, I am pretty sure that editing
> this file does not change the behaviour of ogr2ogr in any way. Is FWTools taking
> the projection definitions from some other place or am I doing something wrong?
> 
> What I tried to do was to add +towgs84 parameters. Original line is this 
> 3067> +proj=utm +zone=35 +ellps=GRS80 +units=m +no_defs  <> 
> and I modified it to this:
> 3067> +proj=utm +zone=35 +ellps=GRS80
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs  <>
> 
> FWTools epsg file is having correct parameters for EPSG:2393 projection, but it
> seems to me but they are not used either in real use. Only way to get correct
> results when reprojecting from epsg:3067 to epsg:2393 is to give both
> projections as +proj strings this way
> 
> ogr2ogr -f "ESRI Shapefile" output.shp input.shp
> -t_srs "+proj=tmerc +lat_0=0 +lon_0=27 +k=1 +x_0=3500000 +y_0=0 
> +ellps=intl +towgs84=-96.0617,-82.4278,-121.743,4.80107,0.34543,
> -1.37646,1.4964 +units=m"
> -s_srs "+proj=utm +zone=35 +ellps=GRS80 
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"
> 
> Giving -t_srs or s_srs as epsg:2393 epsg:3067, respectively, gives a faulty
> result which means that +towgs84 parameters are not used at all.

Jukka,

The primary source for EPSG lookups for GDAL utilities is the
gdal/data/pcs.csv and gdal/data/gcs.csv files.  There is logic to
look in a few other places too if a srs is not found in those locations.

In order to introduce a towgs84 parameter for a gcs the normal procedure
is to copy the definition from gcs.csv into gcs.override.csv and add
the towgs84 parameters.  There should be sufficient examples to see how
that might work.

These csv files are found in FWTools\data I believe.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Nov 18 11:17:53 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 18 11:17:52 2009
Subject: [gdal-dev] Is epsg text file read at all when re-projecting with
	FWTools?
In-Reply-To: <CC197224AC75CE4DB23F739B16891B86E3453B@tikka.haapa.mmm.fi>
References: <loom.20091118T144630-774@post.gmane.org>
	<4B040F96.6070400@pobox.com>
	<CC197224AC75CE4DB23F739B16891B86E3453B@tikka.haapa.mmm.fi>
Message-ID: <4B041E31.2020609@pobox.com>

Rahkonen Jukka wrote:
> Hi,
> 
> Thanks, that makes things more understandable. Is there some good reason to
> keep delivering "epsg" text file with FWTools if it is not used for
> anything? Is it perhaps included for Mapserver that ships with FWTools?

Jukka,

It is used for MapServer, and PROJ.4.  I would add that the 'epsg' file is
actually generated from the GDAL .csv files on a periodic basis.

> Both my codes, 2393 and 3067 are included in pcs.csv thus I believe I must
> edit pcs.override.csv.

Essentially yes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Nov 18 11:41:29 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 18 11:43:35 2009
Subject: [gdal-dev] Gdal and Proj GCS/PCS
In-Reply-To: <1258538091.2690.25.camel@guillaume-desktop>
References: <1258538091.2690.25.camel@guillaume-desktop>
Message-ID: <4B0423B9.7050004@pobox.com>

Guillaume Sueur wrote:
> Having just realised that gdal doesn't use proj EPSG file for
> reprojection (see my previous post on "Unsupported SRS but available in
> epsg file"), I have a few questions to clarify the reprojection
> processes both in gdal and mapserver :
> - where do the gdal gcs/pcs definitions come from ? Is it a separate
> repository or proj source files ? 

Guillaume,

Yes, the gdal/data/{pcs,gcs}.csv files.

> - Doesn't ogr2ogr use proj definition files at all ? 

There are special circumstances when the proj.4 epsg init file is
consulted (if no definition is found in the pcs/gcs csv files).
But normally ogr2ogr does not use the proj.4 init files at all.

 > Does this mean that
> an ogr2ogr reprojected file can be different than a mapserver
> reprojection result if proj/epsg definition and gdal pcs defs are
> slightly different ? 

Yes, this is possible, particularly if someone has hand modified
one or the other.

> - If I say "GDAL/OGR uses its own definition files to retrieve proj4
> definitions and lets proj4 engine do the reprojection job", am I true ? 

Yes.

The last point of note is that the PROJ.4 epsg init file is periodically
generated from the GDAL pcs/gcs.csv files and so they do normally
match quite exactly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From no-reply at neogeo-online.net  Wed Nov 18 11:51:12 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Wed Nov 18 11:52:15 2009
Subject: [gdal-dev] Gdal and Proj GCS/PCS
In-Reply-To: <4B0423B9.7050004@pobox.com>
References: <1258538091.2690.25.camel@guillaume-desktop>
	<4B0423B9.7050004@pobox.com>
Message-ID: <1258563072.30099.0.camel@guillaume-desktop>

Thanks for these precious informations Frank, it seems clearer to me
now. 

Best regards

Guillaume

Le mercredi 18 novembre 2009 ? 11:41 -0500, Frank Warmerdam a ?crit :
> Guillaume Sueur wrote:
> > Having just realised that gdal doesn't use proj EPSG file for
> > reprojection (see my previous post on "Unsupported SRS but available in
> > epsg file"), I have a few questions to clarify the reprojection
> > processes both in gdal and mapserver :
> > - where do the gdal gcs/pcs definitions come from ? Is it a separate
> > repository or proj source files ? 
> 
> Guillaume,
> 
> Yes, the gdal/data/{pcs,gcs}.csv files.
> 
> > - Doesn't ogr2ogr use proj definition files at all ? 
> 
> There are special circumstances when the proj.4 epsg init file is
> consulted (if no definition is found in the pcs/gcs csv files).
> But normally ogr2ogr does not use the proj.4 init files at all.
> 
>  > Does this mean that
> > an ogr2ogr reprojected file can be different than a mapserver
> > reprojection result if proj/epsg definition and gdal pcs defs are
> > slightly different ? 
> 
> Yes, this is possible, particularly if someone has hand modified
> one or the other.
> 
> > - If I say "GDAL/OGR uses its own definition files to retrieve proj4
> > definitions and lets proj4 engine do the reprojection job", am I true ? 
> 
> Yes.
> 
> The last point of note is that the PROJ.4 epsg init file is periodically
> generated from the GDAL pcs/gcs.csv files and so they do normally
> match quite exactly.
> 
> Best regards,


From jason.roberts at duke.edu  Wed Nov 18 12:55:41 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Wed Nov 18 12:55:55 2009
Subject: [gdal-dev] tab delimited to shapefile
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34027EBDD1@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34027EBDD1@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <019601ca6878$58833b00$0989b100$@roberts@duke.edu>

Hi Bruce,

 

A while ago I wrote a little utility to convert delimited text files to
shapefiles, based on an old version of shapelib. (This is before I knew
about the OGR project.) You can download a copy from ESRI's ArcScripts site
at http://arcscripts.esri.com/details.asp?dbid=14268. It does work on
tab-delimited data, although I don't know whether it will work on the
geonames.org files.

 

Best,

Jason

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Clay, Bruce
Sent: Wednesday, November 18, 2009 11:10 AM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] tab delimited to shapefile

 

Is there any way to use ogr2ogr to convert tab-delimited data such as the
geoname dot org files into shapefiles short of converting all tabs to
commas?

 

I created a VRT file that works with CSV files but I can not find any way to
convert tab-delimited data.

 

Bruce

 

 
 
This message and any enclosures are intended only for the addressee.  Please

notify the sender by email if you are not the intended recipient.  If you
are  
not the intended recipient, you may not use, copy, disclose, or distribute
this  
message or its contents or enclosures to any other person and any such
actions  
may be unlawful.  Ball reserves the right to monitor and review all messages

and enclosures sent to or from this email address.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/f70586dc/attachment.html
From Doug_Newcomb at fws.gov  Wed Nov 18 13:41:12 2009
From: Doug_Newcomb at fws.gov (Doug_Newcomb@fws.gov)
Date: Wed Nov 18 13:47:29 2009
Subject: [gdal-dev] tab delimited to shapefile
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34027EBDD1@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <OF36A7E46B.79152D5F-ON85257672.006605D9-85257672.0066A65F@fws.gov>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: graycol.gif
Type: image/gif
Size: 105 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/332ff307/graycol.gif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pic00292.gif
Type: image/gif
Size: 1255 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/332ff307/pic00292.gif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ecblank.gif
Type: image/gif
Size: 45 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/332ff307/ecblank.gif
From Tom.Kralidis at ec.gc.ca  Wed Nov 18 14:08:39 2009
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Ontario])
Date: Wed Nov 18 14:08:47 2009
Subject: [gdal-dev] tab delimited to shapefile
In-Reply-To: <OF36A7E46B.79152D5F-ON85257672.006605D9-85257672.0066A65F@fws.gov>
References: <C482FF98AE985A47B8C982FD429C9E34027EBDD1@daytonmsg2k3.AERO.BALL.COM>
	<OF36A7E46B.79152D5F-ON85257672.006605D9-85257672.0066A65F@fws.gov>
Message-ID: <23842457308FD64AA88A8EE62F2A7D5B01C5A1B6@OntExch3.ontario.int.ec.gc.ca>


I think you can also use the SEPARATOR layer creation option, per
http://www.gdal.org/ogr/drv_csv.html? 

> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org 
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of 
> Doug_Newcomb@fws.gov
> Sent: Wednesday, 18 November 2009 13:41
> To: Clay, Bruce
> Cc: gdal-dev@lists.osgeo.org; gdal-dev-bounces@lists.osgeo.org
> Subject: Re: [gdal-dev] tab delimited to shapefile
> 
> Bruce,
> If you're on a linux system with perl:
> 
> perl -pi -e 's/\t/,/g' filename
> 
> is a perl one-liner that should replace all of the tabs with 
> commas in the file, working on the file in place. I've used 
> similar commands on text files up to 379 GB in size, although 
> it does take a while for files that size.
> 
> It does alter the file in place, which can be dangerous. It's 
> best to test on a sample of the file :
> 
> head filename> testfile ( take the first 10 lines of the file 
> and write it to a separate file) perl -pi -e 's/\t/,/' testfile
> 
> If the testfile works fine, use it on the main file.
> 
> 
> Doug
> 
> 
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb@fws.gov
> --------------------------------------------------------------
> -------------------------------------------
> The opinions I express are my own and are not representative 
> of the official policy of the U.S.Fish and Wildlife Service 
> or Dept. of the Interior. Life is too short for undocumented, 
> proprietary data formats.
> Inactive hide details for "Clay, Bruce" 
> <bclay@ball.com>"Clay, Bruce" <bclay@ball.com>
> 
> 
> 
> 
> 				"Clay, Bruce" <bclay@ball.com> 
> 				Sent by: 
> gdal-dev-bounces@lists.osgeo.org 
> 
> 				11/18/2009 11:09 AM
> 
> 
> 
> To
> 
> <gdal-dev@lists.osgeo.org>	
> 
> 
> cc
> 
> 	
> 
> 
> Subject
> 
> [gdal-dev] tab delimited to shapefile	
> 		
> 
> Is there any way to use ogr2ogr to convert tab-delimited data 
> such as the geoname dot org files into shapefiles short of 
> converting all tabs to commas?
> 
> I created a VRT file that works with CSV files but I can not 
> find any way to convert tab-delimited data.
> 
> Bruce
> 
> 
> 
> 
> This message and any enclosures are intended only for the 
> addressee.  Please  
> notify the sender by email if you are not the intended 
> recipient.  If you are  
> not the intended recipient, you may not use, copy, disclose, 
> or distribute this  
> message or its contents or enclosures to any other person and 
> any such actions  
> may be unlawful.  Ball reserves the right to monitor and 
> review all messages  
> and enclosures sent to or from this email 
> address._______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
> 
> 
From ivan.lucena at pmldnet.com  Wed Nov 18 16:05:24 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Wed Nov 18 16:05:30 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gUmU6IEpBVkEgQVBJIC0gUGVyZm9ybWFuY2U=?=
Message-ID: <20091118210524.21100.qmail@s466.sureserver.com>

Even,

I just got it to work with the new API today. That is great!

And just liike you said, the advantage is in usability not performance.

Thanks,

Ivan

>  -------Original Message-------
>  From: Even Rouault <even.rouault@mines-paris.org>
>  Subject: Re: [gdal-dev] Re: JAVA API - Performance
>  Sent: Nov 14 '09 17:32
>  
>  Selon Ivan <ivan.lucena@pmldnet.com>:
>  
>  I've commited new API that adds ReadRaster() and WriteRaster() methods that use
>  the regular Java arrays (byte[], short[], int[], float[], double[]). See
>  http://gdal.org/java
>  
>  On my PC,
>  http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/java/apps/GDALTestIO.java
>  runs in about 20.3s for the ReadRaster()/WriteRaster() case, and in about 24.7s
>  for the ReadRaster_Direct()/WriteRaster_Direct() case. Not a big advantage
>  (which tends to not any advantage at all when run with the -server flag, as both
>  run in about 21.3 s !), but regular Java arrays are a bit easier to use than
>  ByteBuffer (especially that with Sun JVM 1.6, the array() method on ByteBuffer
>  is not implemented).
>  
>  > Even,
>  >
>  > You are right. The point is how to take full advantage of the GDAL Java API
>  > choosing the right
>  > approach to deal with the raster buffer on the client side.
>  >
>  > Best regards,
>  >
>  > Ivan
>  >
>  > Even Rouault wrote:
>  > > Selon Ivan <ivan.lucena@pmldnet.com>:
>  > >
>  > > Ivan,
>  > >
>  > > I'm not sure what you are really measuring if you compare a C++ code versus
>  > its
>  > > translation to Java code. I think it just reflects the known slowdown of
>  > Java
>  > > when doing intensive computations in comparison to native code. The 0.2
>  > second
>  > > difference between the regular array version and the ByteBuffer one is the
>  > > interesting result, not the 1.2/1.0 second difference between C++ and Java.
>  > >
>  > >> Caio Simone,
>  > >>
>  > >> I just downloaded imageio-ext to check how it does that but it looks like
>  > I
>  > >> don't need to do that now, I can take you report instead. Thank you very
>  > >> much. I will take a look on array pinning for a start.
>  > >>
>  > >> I translated the GDAL Proximity [1] code to Java and I timed both of then
>  > >> with the same input, a 1024x1024 byte image with just one pixel as feature
>  > at
>  > >> the center of the image.
>  > >>
>  > >> It took 0.3 seconds in C++ and 1.5 seconds in Java!
>  > >>
>  > >> I then translated the buffers to regular arrays and it went down a little
>  > >> bit, 1.3 seconds.
>  > >>
>  > >> It is still a big disadvantage. I believe that the buffer-to-buffer
>  > >> translation is the guilt time waster in that case.
>  > >>
>  > >> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
>  > >>
>  > >> My best regards,
>  > >>
>  > >> Ivan
>  > >>
>  > >>>??-------Original Message-------
>  > >>>??From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
>  > >>>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>  > >>>??Sent: Nov 10 '09 12:36
>  > >>>
>  > >>>??Ciao Even,
>  > >>>??just wanted to add my 2 cents.
>  > >>>
>  > >>>??As you know for the imageio-ext project we have been using the
>  > >>>??GDAL-JNI bindings (actually a modified version of them) for a while in
>  > >>>??order to allow Java users to leverage on GDAL using the ImageIO
>  > >>>??framework which standard in Java.
>  > >>>??This way we also enabled GeoTools and GeoServer to use GDAL as a
>  > >> datasource.
>  > >>>??In the past I have done quite some performance tests to add some
>  > >>>??new/different methods to them and I can summarise our findings as
>  > >>>??follows:
>  > >>>
>  > >>>??- DirectByteBuffer vs regular arrays -
>  > >>>??DBB is expensive to allocate but prevent the VM from performing copies
>  > >>>??when having to move data to and from java and native code since they
>  > >>>??live on the native space not on the java heap; On the other side the
>  > >>>??regular arrays are fast to allocate but they are "usually" copied when
>  > >>>??moved across from/to java and native code since the JVM cannot leave
>  > >>>??the native code mess with the java heap space since the garbage
>  > >>>??collector would not be very happy about that. I said "usually" since
>  > >>>??there is a technique called array pinning that we can suggest the JVM
>  > >>>??to use to avoid the copy of regular array; however this mechanism is
>  > >>>??not guaranteed to be implemented and/or to work on each call (same
>  > >>>??reason as above, GC is not happy about this technique).
>  > >>>
>  > >>>??If you can pool the DBB??and/or use a few large DBB, where the cost of
>  > >>>??the copy would overcome the cost of its creation then DBB are much
>  > >>>??better than regular arrays. As an instance I noticed that using when
>  > >>>??reading striped tiff files regular arrays where faster, but as the
>  > >>>??tile size increases (and therefore the cost of a copy overcomes the
>  > >>>??cost of a DBB creation) the DBB performs much better
>  > >>>
>  > >>>??- DirectByteBuffer and the impact on some JVM -
>  > >>>??Now in the past we decided to stick with DBB and give
>  > >>>??GeoServer/GeoTools users the capability to retile data on the fly.
>  > >>>??However lately, during the WMS performance shootout we noticed on some
>  > >>>??linux machines JVm soldi crashed, not nice (means restarting the
>  > >>>??GeoServer!!!).
>  > >>>??We investigated a bit in depth and the problem was that somehow the
>  > >>>??JVM was failing to allocate some internal images during the rendering
>  > >>>??process and then dying with a NullPointerException (apparently the SUN
>  > >>>??Java2D engineers did not use to check for out of memory errors in the
>  > >>>??java native space). Well, what happens is that if you use too much of
>  > >>>??the Java native space for your own objects, it is likely that the JVM
>  > >>>??itself will start to malfunction (you can find articles on the web on
>  > >>>??the memory model of a Java process, I don't think I am good enough to
>  > >>>??explain it ) since it cannot allocate its own objects.
>  > >>>
>  > >>>??In the end we decide to leave DBB and go back to regular arrays with
>  > >>>??array pinning. This ensured us robustness and we did not see much
>  > >>>??performance degradation (which means that array pinning in the end
>  > >>>??works). This has been implemented by modifying the SWIG bindings for
>  > >>>??GDAL in order to use a byte array instead of a DBB and then use
>  > >>>??ByteArray utils to convert between different native type (short, int,
>  > >>>??etc..).
>  > >>>
>  > >>>??- Conclusion -
>  > >>>??We might want to spend some time in the mid term to contribute some of
>  > >>>??this work back (or probably provide funding), but anyway, it would be
>  > >>>??great to have the capability to switch between DBB and regular arrays
>  > >>>??since both have flaws.
>  > >>>??However atm if I were asked I would say to go with regular arrays as
>  > >>>??we do in the imageio-ext project.
>  > >>>
>  > >>>??Ciao,
>  > >>>??Simone.
>  > >>>??-------------------------------------------------------
>  > >>>??Ing. Simone Giannecchini
>  > >>>??GeoSolutions S.A.S.
>  > >>>??Founder - Software Engineer
>  > >>>??Via Carignoni 51
>  > >>>??55041??Camaiore (LU)
>  > >>>??Italy
>  > >>>
>  > >>>??phone: +39 0584983027
>  > >>>??fax:??????+39 0584983027
>  > >>>??mob:????+39 333 8128928
>  > >>>
>  > >>>
>  > >>>??http://www.geo-solutions.it
>  > >>>??http://geo-solutions.blogspot.com/
>  > >>>??http://simboss.blogspot.com/
>  > >>>??http://www.linkedin.com/in/simonegiannecchini
>  > >>>
>  > >>>??-------------------------------------------------------
>  > >>>
>  > >>>
>  > >>>
>  > >>>??On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>  > >>>??<even.rouault@mines-paris.org> wrote:
>  > >>>??> Selon Ivan <ivan.lucena@pmldnet.com>:
>  > >>>??>
>  > >>>??> Ivan,
>  > >>>??>
>  > >>>??> thanks for your testing (CC'ing the list as it is of general
>  > interest).
>  > >>>??> Actually, I also read on some sites that using ByteBuffer object
>  > versus
>  > >> regular
>  > >>>??> Java arrays is not always a win. Plus the fact that we must use a
>  > direct
>  > >> buffer
>  > >>>??> that has an extra allocation cost according to the Javadoc. So
>  > >> ByteBuffer might
>  > >>>??> be interesting if you just want to pass big arrays between native
>  > code,
>  > >> for
>  > >>>??> example if you read an array from a dataset and then write it to
>  > another
>  > >> one
>  > >>>??> without accessing it from the Java side. When you mention that
>  > accessing
>  > >> through
>  > >>>??> the byte[] array was faster, did you get it with the array() method
>  > >> instead ?
>  > >>>??> I'm wondering what the performance overhead of this call is.
>  > >>>??>
>  > >>>??> As ByteBuffer is not at all a requirement for the interface with the
>  > >> native
>  > >>>??> code, it would be technically possible to add an alternative API that
>  > >> would use
>  > >>>??> the regular Java array types.
>  > >>>??>
>  > >>>??> Would you mind opening an enhancement ticket about that ? Thanks
>  > >>>??>
>  > >>>??> Even
>  > >>>??>
>  > >>>??>> Even,
>  > >>>??>>
>  > >>>??>> I did some test with the GDAL Java API and some simple raster
>  > >> operations
>  > >>>??>> like the GDAL Proximity algorthm and I noticed that the performance
>  > >> while
>  > >>>??>> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value)
>  > is
>  > >> not
>  > >>>??>> as good as if you copy then to (or from) a "regular" array, like
>  > >> float[],
>  > >>>??>> double[], integer[] and byte[].
>  > >>>??>>
>  > >>>??>> The reason for that is obvious, get() and put() are funtion calls and
>  > >>>??>> contains a lot of code for range check.
>  > >>>??>>
>  > >>>??>> If I understand it correctly, ByteBuffer is the ideal or maybe the
>  > only
>  > >>>??>> way to get access to Buffers from C libraries thought a Java wrapper.
>  > >> But
>  > >>>??>> do you it would be possible to incapsulate the buffer conversion at
>  > the
>  > >>>??>> wrapper code so that users would be able to read and write direct to
>  > >>>??>> regular Java arrays?
>  > >>>??>>
>  > >>>??>> Just a suggestion,
>  > >>>??>>
>  > >>>??>> Ivan
>  > >>>??>>
>  > >>>??>
>  > >>>??>
>  > >>>??> _______________________________________________
>  > >>>??> gdal-dev mailing list
>  > >>>??> gdal-dev@lists.osgeo.org
>  > >>>??> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  > >>>??>
>  > >>>
>  > >
>  > >
>  > >
>  >
>  >
>  
>  
>  
From shaun.kolomeitz at derm.qld.gov.au  Wed Nov 18 16:46:15 2009
From: shaun.kolomeitz at derm.qld.gov.au (Shaun Kolomeitz)
Date: Wed Nov 18 16:46:24 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
Message-ID: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E576D@BNEXVS02.prod.ad.internal>

I've heard a lot about the power of NVidia CUDA and am curious about
ways in which we could leverage off this to increase the performance of
1) Image Mosaics 2) Translates and 3) Image Reading/rendering
(especially highly compressed images).
I also see that there is pyCUDA as well. Both of which I am unsure how
(or if) you could use them to run (even portions of) GDAL ?

If anyone has any pointers it would be nice to know.

Many thanks,
Shaun Kolomeitz
Principal Project Officer
Business and Asset Services
Queensland Parks and Wildlife Service


As of 26 March 2009 the Department of Natural Resources and
Water/Environmental Protection Agency integrated to form the Department
of Environment and Resource Management 

+----------------------------------------------------------------+
Think B4U Print
1 ream of paper = 6% of a tree and 5.4kg CO2 in the atmosphere
3 sheets of A4 paper = 1 litre of water
+----------------------------------------------------------------+


From seth at pricepages.org  Wed Nov 18 17:07:05 2009
From: seth at pricepages.org (Seth Price)
Date: Wed Nov 18 17:07:10 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
In-Reply-To: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E576D@BNEXVS02.prod.ad.internal>
References: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E576D@BNEXVS02.prod.ad.internal>
Message-ID: <58624.129.123.22.14.1258582025.squirrel@pricepages.org>

I've been intending for a while to work on either CUDA or OpenCL with GDAL
& GRASS. I applied to do this for the Google Summer of  Code, but wasn't
accepted this past summer. I'll probably work on it someday just to make
sure my thesis work gets finished within budget.

However, I'm mostly interested in speeding up the resampling routines.
They should be able to get close to the theoretical maximum on CUDA. I
don't know about the routines which you mention without looking closer at
the code. For example, image reading is probably limited by the disk
speed, so it wouldn't be faster in CUDA. Translates are another operation
which doesn't involve much CPU time compared to disk time, so it would
also be difficult to speed it with CUDA. For these operations your best
option might be to replace your hard drive with a SSD.

I'm not familiar with image mosaics in GDAL, but I would guess that they
are heavy on the resampling when generating a quality final image. This is
something where each output pixel depends on the nearest ~16 input pixels.
It takes a lot of CPU time to process all those pixels, and it would
benefit from CUDA.

If you want, I could hunt down my GSoC application which would go into a
bit more detail.
~Seth

On Wed, November 18, 2009 2:46 pm, Shaun Kolomeitz wrote:
> I've heard a lot about the power of NVidia CUDA and am curious about
> ways in which we could leverage off this to increase the performance of
> 1) Image Mosaics 2) Translates and 3) Image Reading/rendering
> (especially highly compressed images).
> I also see that there is pyCUDA as well. Both of which I am unsure how
> (or if) you could use them to run (even portions of) GDAL ?
>
> If anyone has any pointers it would be nice to know.
>
> Many thanks,
> Shaun Kolomeitz
> Principal Project Officer
> Business and Asset Services
> Queensland Parks and Wildlife Service
>
>
> As of 26 March 2009 the Department of Natural Resources and
> Water/Environmental Protection Agency integrated to form the Department
> of Environment and Resource Management
>
> +----------------------------------------------------------------+
> Think B4U Print
> 1 ream of paper = 6% of a tree and 5.4kg CO2 in the atmosphere
> 3 sheets of A4 paper = 1 litre of water
> +----------------------------------------------------------------+
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From shaun.kolomeitz at derm.qld.gov.au  Wed Nov 18 17:25:26 2009
From: shaun.kolomeitz at derm.qld.gov.au (Shaun Kolomeitz)
Date: Wed Nov 18 17:25:31 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
Message-ID: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E57D0@BNEXVS02.prod.ad.internal>

Thanks Seth,

It makes sense that the slowest part of the whole equation would be the
disk operations, and there must be quite a number of disk reads/writes
when processing imagery. Currently we use Raid Arrays that push data
through at a rate of 300MB/s, granted if these were SSDs in Raid0 we
could push beyond 1GB/s. Currently to process (mosaic) an 80GB image it
takes several days to complete. This is also on 32bit hardware, and I
suspect is only single threaded so we're limited to 3GB RAM. From what I
understood the most optimal caching size in GDAL is 500MB, using a 512M
window (unless that has changed).
If you can easily lay your hands on your GSoC application than that
would be great. We are discussing what might be possible with a very
talented coder, who eats these types of "challenges" for breakfast !
Perhaps a better approach would be to use something like a grid
computing approach then like Condor to break up the processing ?

Cheers,
Shaun

-----Original Message-----
From: Seth Price [mailto:seth@pricepages.org] 
Sent: Thursday, 19 November 2009 8:07 AM
To: Shaun Kolomeitz
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] CUDA PyCUDA and GDAL

I've been intending for a while to work on either CUDA or OpenCL with
GDAL
& GRASS. I applied to do this for the Google Summer of  Code, but wasn't
accepted this past summer. I'll probably work on it someday just to make
sure my thesis work gets finished within budget.

However, I'm mostly interested in speeding up the resampling routines.
They should be able to get close to the theoretical maximum on CUDA. I
don't know about the routines which you mention without looking closer
at
the code. For example, image reading is probably limited by the disk
speed, so it wouldn't be faster in CUDA. Translates are another
operation
which doesn't involve much CPU time compared to disk time, so it would
also be difficult to speed it with CUDA. For these operations your best
option might be to replace your hard drive with a SSD.

I'm not familiar with image mosaics in GDAL, but I would guess that they
are heavy on the resampling when generating a quality final image. This
is
something where each output pixel depends on the nearest ~16 input
pixels.
It takes a lot of CPU time to process all those pixels, and it would
benefit from CUDA.

If you want, I could hunt down my GSoC application which would go into a
bit more detail.
~Seth

On Wed, November 18, 2009 2:46 pm, Shaun Kolomeitz wrote:
> I've heard a lot about the power of NVidia CUDA and am curious about
> ways in which we could leverage off this to increase the performance
of
> 1) Image Mosaics 2) Translates and 3) Image Reading/rendering
> (especially highly compressed images).
> I also see that there is pyCUDA as well. Both of which I am unsure how
> (or if) you could use them to run (even portions of) GDAL ?
>
> If anyone has any pointers it would be nice to know.
>
> Many thanks,
> Shaun Kolomeitz
> Principal Project Officer
> Business and Asset Services
> Queensland Parks and Wildlife Service
>
>
> As of 26 March 2009 the Department of Natural Resources and
> Water/Environmental Protection Agency integrated to form the
Department
> of Environment and Resource Management
>
> +----------------------------------------------------------------+
> Think B4U Print
> 1 ream of paper = 6% of a tree and 5.4kg CO2 in the atmosphere
> 3 sheets of A4 paper = 1 litre of water
> +----------------------------------------------------------------+
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From warmerdam at pobox.com  Wed Nov 18 20:19:52 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 18 20:19:59 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
In-Reply-To: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E57D0@BNEXVS02.prod.ad.internal>
References: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E57D0@BNEXVS02.prod.ad.internal>
Message-ID: <4B049D38.6020205@pobox.com>

Shaun Kolomeitz wrote:
> Thanks Seth,
> 
> It makes sense that the slowest part of the whole equation would be the
> disk operations, and there must be quite a number of disk reads/writes
> when processing imagery. Currently we use Raid Arrays that push data
> through at a rate of 300MB/s, granted if these were SSDs in Raid0 we
> could push beyond 1GB/s. Currently to process (mosaic) an 80GB image it
> takes several days to complete. This is also on 32bit hardware, and I
> suspect is only single threaded so we're limited to 3GB RAM. From what I
> understood the most optimal caching size in GDAL is 500MB, using a 512M
> window (unless that has changed).
> If you can easily lay your hands on your GSoC application than that
> would be great. We are discussing what might be possible with a very
> talented coder, who eats these types of "challenges" for breakfast !
> Perhaps a better approach would be to use something like a grid
> computing approach then like Condor to break up the processing ?

Shaun,

I suspect that there is a gross issue with how the warping is being done,
and that it could be sped up substantially. On my two year old consumer
grade desktop I'm able to warp/reproject around 30GB/hour with gdalwarp.

I don't want to dissuade you from investigating CUDA options, but
you might be able to get ten fold improvement by hiring an experienced
gdalwarp developer for a few hours to investigate your particular
situation.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mseanhills at villagis.com  Wed Nov 18 20:35:42 2009
From: mseanhills at villagis.com (Sean Hills)
Date: Wed Nov 18 20:35:45 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
In-Reply-To: <4B049D38.6020205@pobox.com>
References: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E57D0@BNEXVS02.prod.ad.internal>
	<4B049D38.6020205@pobox.com>
Message-ID: <d3957af00911181735o1ec3b72cy3fabd166bc85441a@mail.gmail.com>

On Wed, Nov 18, 2009 at 7:19 PM, Frank Warmerdam <warmerdam@pobox.com>wrote:

> Shaun Kolomeitz wrote:
>
>> Thanks Seth,
>>
>> It makes sense that the slowest part of the whole equation would be the
>> disk operations, and there must be quite a number of disk reads/writes
>> when processing imagery. Currently we use Raid Arrays that push data
>> through at a rate of 300MB/s, granted if these were SSDs in Raid0 we
>> could push beyond 1GB/s. Currently to process (mosaic) an 80GB image it
>> takes several days to complete. This is also on 32bit hardware, and I
>> suspect is only single threaded so we're limited to 3GB RAM. From what I
>> understood the most optimal caching size in GDAL is 500MB, using a 512M
>> window (unless that has changed).
>> If you can easily lay your hands on your GSoC application than that
>> would be great. We are discussing what might be possible with a very
>> talented coder, who eats these types of "challenges" for breakfast !
>> Perhaps a better approach would be to use something like a grid
>> computing approach then like Condor to break up the processing ?
>>
>
> Shaun,
>
> I suspect that there is a gross issue with how the warping is being done,
> and that it could be sped up substantially. On my two year old consumer
> grade desktop I'm able to warp/reproject around 30GB/hour with gdalwarp.
>
> I don't want to dissuade you from investigating CUDA options, but
> you might be able to get ten fold improvement by hiring an experienced
> gdalwarp developer for a few hours to investigate your particular
> situation.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

Along these same lines,  I'm looking to CUDA or Condor cluster to aid in
gdal_retile.  Current projects are taking from 3 weeks to 2 months to
process.  Will this process lend itself well to the parallel processing
environment?

-- 
Sean
Villagis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091118/af8a1de1/attachment.html
From ivan.lucena at pmldnet.com  Wed Nov 18 22:35:03 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan?=)
Date: Wed Nov 18 22:35:04 2009
Subject: [gdal-dev] Can't read subdatasets list from SeaWiFS HDF4
Message-ID: <20091119033503.29346.qmail@s466.sureserver.com>

Hi there,

I tried to read HDF4 files downloaded from this website:

http://oceancolor.gsfc.nasa.gov/

More specifically, the SeaWiFS L3 BIN:

http://oceandata.sci.gsfc.nasa.gov/SeaWiFS/L3BIN/2009/312/S2009312.L3b_DAY_CHL.main.bz2

But running gdalinfo on that file doesn't show any SUBDATASET:

% gdalinfo S2009312.L3b_DAY_CHL.main
Driver: HDF4/Hierarchical Data Format Release 4
Files: S2009312.L3b_DAY_CHL.main
Size is 512, 512
Coordinate System is `'
Metadata:
  Product Name=S2009312.L3b_DAY_CHL.main
  Title=SeaWiFS Level-3 Binned Data
  Sensor Name=SeaWiFS
  Data Center=NASA/GSFC SeaWiFS Data Processing Center
  Mission=SeaStar SeaWiFS
  Mission Characteristics=Nominal orbit: inclination = 98.2 (Sun-synchronous); node = 12 noon local (descending); eccentricity = <0.002; altitude = 705 km; ground speed = 6.75 km/sec
  Sensor=Sea-viewing Wide Field-of-view Sensor (SeaWiFS)
  Sensor Characteristics=Number of bands = 8; number of active bands = 8; wavelengths per band (nm) = 412, 443, 490, 510, 555, 670, 765, 865; bits per pixel = 10; instantaneous field-of-view = 1.5835 mrad; pixels per scan = 1285; scan rate = 6/sec; sample rate = 7710/sec
  Product Type=D
  Processing Version=2009.1
  Software Name=l2bin
  Software Version=2.3.3
  Orbit=65360
  Start Orbit=65340
  End Orbit=65360
  Processing Time=2009322051028000
  Processing Control=l2bin par=S2009312.L3b_DAY_CHL.param
  Input Parameters=INFILE = /data1/sdpsoper/vdc/vpu0/workbuf/l2inlist.dat|OFILE = S2009312.L3b_DAY_CHL.main|FILEUSE = S2009312.L3b_DAY_CHL.contrib|SDAY = 2009312|EDAY = 2009312|RESOLVE = 9|ROWGROUP = 2700|FLAGUSE = ATMFAIL,LAND,HILT,HISATZEN,STRAYLIGHT,CLDICE,COCCOLITH,LOWLW,CHLWARN,CHLFAIL,NAVWARN,MAXAERITER,ATMWARN,HISOLZEN,NAVFAIL,FILTER,HIGLINT|L3BPROD = chlor_a|PRODTYPE = D|PVERSION = 2009.1|SUITE = CHL|AVERAGE = standard|NIGHT = 0|VERBOSE = 0|MINOBS = 0|QUALPROD = NONE|QUAL MAX = N/A|
  Input Files=/data1/sdpsoper/vdc/vpu0/workbuf/S2009311192733.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009311193509.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009311210841.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009311224722.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312002604.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312020446.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312034327.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312052209.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312070053.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312083932.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312101814.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312115655.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312133537.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312151418.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312165300.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312183023.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312183706.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312201024.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312214906.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009312232747.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009313010819.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009313024700.L2_GAC_OC,/data1/sdpsoper/vdc/vpu0/workbuf/S2009313042542.L2_GAC_OC
  L2 Flag Names=ATMFAIL,LAND,HILT,HISATZEN,STRAYLIGHT,CLDICE,COCCOLITH,LOWLW,CHLWARN,CHLFAIL,NAVWARN,MAXAERITER,ATMWARN,HISOLZEN,NAVFAIL,FILTER,HIGLINT
  Period Start Year=2009
  Period Start Day=312
  Period End Year=2009
  Period End Day=312
  Start Time=2009311192732633
  End Time=2009313050540954
  Start Year=2009
  Start Day=311
  Start Millisec=70052633
  End Year=2009
  End Day=313
  End Millisec=18340954
  Latitude Units=degrees North
  Longitude Units=degrees East
  Northernmost Latitude=45.625
  Southernmost Latitude=-74.95834
  Easternmost Longitude=179.9583
  Westernmost Longitude=-179.9583
  Data Bins=384375
  Percent Data Bins=6.4705
  Station Name=GSFC HRPT, NASA, MD
  Station Latitude=38.9958
  Station Longitude=-76.8511
  Units=chlor_a:mg m^-3
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

Does anybody have any experience with this data provider and how to get raster images from that file?

My best regards,

Ivan

From randyqiuxy at hotmail.com  Wed Nov 18 23:21:26 2009
From: randyqiuxy at hotmail.com (Randy)
Date: Wed Nov 18 23:21:36 2009
Subject: [gdal-dev] GDAL installing about building openev
In-Reply-To: <4B042589.207@pobox.com>
References: <BLU0-SMTP8301DA5C3B07D7F8074872C3A60@phx.gbl>
	<931f8ea90911150739g6b629c72s3da58e42d0f2476a@mail.gmail.com>
	<BLU0-SMTP2760AF694D14A77E8BBAAFC3A40@phx.gbl>
	<4B02DE9A.9050406@pobox.com>
	<BLU0-SMTP91E7DB39BB0F5677F14B5FC3A30@phx.gbl> <4B042589.207@pobox.com>
Message-ID: <BLU0-SMTP1001F798259010D5ED976D5C3A20@phx.gbl>


> Randy,
> 
> I've taken this off the list since it isn't really a gdal issue.
> 
> This part of the log:
> 
> "configure:5590: Using requested GDAL_HOME
> of /home/randyqiu/run-time/gdal-1.6.2
> configure:5605: checking for GDALOpen in -lgdal
> configure:5640: gcc -o conftest   -O2 -I/usr/local/include
> -I/usr/local/include  conftest.c -lgdal  -lgdal
> -L/home/randyqiu/run-time/gdal-1.6.2/lib  -lgtkgl    -ldl
> -L/usr/local/lib >&5
> /usr/bin/ld: cannot find -lgtkgl
> 
> indicates that an attempt was made to link a test program with gdal but
> it failed.  However, the configure script is not smart enough to realize
> the failure had nothing to do with gdal, but is just that the linker
> could not find the gtkgl library ("/usr/bin/ld: cannot find -lgtkgl ").
> 
> This can happen easily when some configure steps just assume some
> libraries exist without checking them, which I presume is how the
> gtkgl library is handled.
> 
> Best regards,
Hi Frank,
Wow, You are so great! I've learned a lot from you! 
Thank you so much!
Best regards,
Randy

From jukka.rahkonen at mmmtike.fi  Thu Nov 19 03:08:38 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu Nov 19 03:09:32 2009
Subject: [gdal-dev] Re: CUDA PyCUDA and GDAL
References: <4F51CF02179D2247B9ED6AFA54E2DF6E0E7E57D0@BNEXVS02.prod.ad.internal>
	<4B049D38.6020205@pobox.com>
Message-ID: <loom.20091119T084158-818@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> Shaun Kolomeitz wrote:

> > could push beyond 1GB/s. Currently to process (mosaic) an 80GB image it
> > takes several days to complete. This is also on 32bit hardware, and I
> 
> Shaun,
> 
> I suspect that there is a gross issue with how the warping is being done,
> and that it could be sped up substantially. On my two year old consumer
> grade desktop I'm able to warp/reproject around 30GB/hour with gdalwarp.

My numbers for warping single images or small mosaics with cubic spline option
show about 12 GB/hour. However, I have tried sometimes to warp tens of gigabytes
of imagery through .vrt file to a BigTIFF and that process progressed very very
slow. I need to admit that I used ER Mapper and ERDAS Imagine and never bothered
to investigate further what was going wrong when building mosaic with gdal. I
have lot of imagery easily available and I volunteer for testing is somebody has
suggestions for better gdalwarp parameters or has new program versions to try. 

-Jukka Rahkonen-

From arnaud.sig at gmail.com  Thu Nov 19 04:20:59 2009
From: arnaud.sig at gmail.com (Arnaud Vandecasteele)
Date: Thu Nov 19 04:21:07 2009
Subject: [gdal-dev] OGR SetField() doesn't work
Message-ID: <166b86070911190120k2087870ey8a70f8634e605ec8@mail.gmail.com>

Hi all,


I'm trying to set a value on an existing field and existing Shapefile with
python-ogr but it doesn't seems to work.
Here is my works :

-------------------------
import ogr
import math
import os

layerNameF = os.path.join("myShape.shp")
driver = ogr.GetDriverByName("ESRI Shapefile")

Layer = driver.Open(layerNameF, True).GetLayer(0)

for i in range(Layer.GetFeatureCount()) :
    feat = Layer.GetFeature(i)
    u = feat.GetFieldAsDouble('u10m')
    v = feat.GetFieldAsDouble('v10m')
    vitesse = math.sqrt((u**2)+(v**2))
    feat.SetField('wspeed',vitesse)
    print type(feat.GetFieldAsDouble('wspeed'))
    print feat.GetFieldAsDouble('wspeed')
    feat.Destroy()

-------------------------

the print feat.GetFieldAsDouble('wspeed') show me the good values. But when
I open It again with Qgis or python the value is still 0.0.

Do you know what I'm doing wrong?

Thanks for any help


Regards

Arnaud
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/85dd5940/attachment.html
From nicolas.simon at spw.wallonie.be  Thu Nov 19 04:45:24 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Thu Nov 19 05:06:07 2009
Subject: [gdal-dev] OGR SetField() doesn't work
In-Reply-To: <166b86070911190120k2087870ey8a70f8634e605ec8@mail.gmail.com>
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B8A5@DGA-EXC01.mrw.wallonie.int>

Arnaud,
 
    You should use Layer.SetFeature(feat) to trigger the update in your shape file.
 
    Nicolas
 

-----Message d'origine-----
De : gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org]De la part de Arnaud Vandecasteele
Envoy? : jeudi 19 novembre 2009 10:21
? : gdal-dev@lists.osgeo.org
Objet : [gdal-dev] OGR SetField() doesn't work


Hi all,


I'm trying to set a value on an existing field and existing Shapefile with python-ogr but it doesn't seems to work.
Here is my works :

-------------------------
import ogr
import math
import os

layerNameF = os.path.join("myShape.shp")   
driver = ogr.GetDriverByName("ESRI Shapefile")                    

Layer = driver.Open(layerNameF, True).GetLayer(0)

for i in range(Layer.GetFeatureCount()) :
    feat = Layer.GetFeature(i)            
    u = feat.GetFieldAsDouble('u10m')
    v = feat.GetFieldAsDouble('v10m') 
    vitesse = math.sqrt((u**2)+(v**2))                      
    feat.SetField('wspeed',vitesse) 
    print type(feat.GetFieldAsDouble('wspeed'))
    print feat.GetFieldAsDouble('wspeed')
    feat.Destroy() 

-------------------------

the print feat.GetFieldAsDouble('wspeed') show me the good values. But when I open It again with Qgis or python the value is still 0.0.

Do you know what I'm doing wrong?

Thanks for any help


Regards

Arnaud



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/c6641768/attachment-0001.html
From christophe.mazo at external.thalesgroup.com  Thu Nov 19 06:23:47 2009
From: christophe.mazo at external.thalesgroup.com (Christophe MAZO- <Soc.Ext.>)
Date: Thu Nov 19 06:23:51 2009
Subject: [gdal-dev] gdalwarp of multiresolution vrt problem
Message-ID: <4B052AC3.3080406@external.thalesgroup.com>

Hi,

I am trying to use VRT files and gdalwarp to mosaic and tile 
multiresolution images.  I use two images at different resolutions which 
overlap and compute the mosaic using gdalbuildvrt.
The vrt produced has wrong "y  resolution and y size", so I first edit 
the y coordinates of the vrt (ticket 3198).  Then, I use gdalwarp with 
cubic interpolation to cut a portion of the mosaic where the input 
images overlap. 
The image produced shows a slight offset in position and scaling between 
the two input images in the mosaic and no cubic interpolation of the 
background image.

I run the following commands:
*gdalbuildvrt mosaic.vrt -resolution highest imageL00.jpg imageL06.jpg
gdalwarp mosaic.vrt -r CUBIC -te 0 0 0.03 0.03 cut_vrt.jpg*

The same calculation works perfectly when using directly gdalwarp 
without vrt:

*gdalwarp imageL00.jpg imageL06.jpg -r CUBIC -te 0 0 0.03 0.03 cut_warp.jpg*

Any idea of what I am doing wrong?

Many thanks,

Christophe.

More details on the images used:

D:\Geo_Images\multi_Resolution_Data\test\bug_report>gdalinfo imageL06.jpg
Driver: JPEG/JPEG JFIF
Files: imageL06.jpg
       imageL06.jpg.aux.xml
Size is 1024, 1024
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (0.000000000000000,0.015625000000000)
Pixel Size = (0.000015258789063,-0.000015258789063)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  SOURCE_COLOR_SPACE=YCbCr
  INTERLEAVE=PIXEL
  COMPRESSION=JPEG
Corner Coordinates:
Upper Left  (   0.0000000,   0.0156250) (  0d 0'0.01"E,  0d 0'56.25"N)
Lower Left  (   0.0000000,   0.0000000) (  0d 0'0.01"E,  0d 0'0.01"N)
Upper Right (   0.0156250,   0.0156250) (  0d 0'56.25"E,  0d 0'56.25"N)
Lower Right (   0.0156250,   0.0000000) (  0d 0'56.25"E,  0d 0'0.01"N)
Center      (   0.0078125,   0.0078125) (  0d 0'28.13"E,  0d 0'28.13"N)
Band 1 Block=1024x1 Type=Byte, ColorInterp=Red
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=1024x1 Type=Byte, ColorInterp=Green
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=1024x1 Type=Byte, ColorInterp=Blue
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG

D:\Geo_Images\multi_Resolution_Data\test\bug_report>gdalinfo imageL00.jpg
Driver: JPEG/JPEG JFIF
Files: imageL00.jpg
       imageL00.jpg.aux.xml
Size is 1024, 1024
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (0.000000000000000,1.000000000000000)
Pixel Size = (0.000976562500000,-0.000976562500000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  SOURCE_COLOR_SPACE=YCbCr
  INTERLEAVE=PIXEL
  COMPRESSION=JPEG
Corner Coordinates:
Upper Left  (   0.0000000,   1.0000000) (  0d 0'0.01"E,  1d 0'0.00"N)
Lower Left  (   0.0000000,   0.0000000) (  0d 0'0.01"E,  0d 0'0.01"N)
Upper Right (   1.0000000,   1.0000000) (  1d 0'0.00"E,  1d 0'0.00"N)
Lower Right (   1.0000000,   0.0000000) (  1d 0'0.00"E,  0d 0'0.01"N)
Center      (   0.5000000,   0.5000000) (  0d30'0.00"E,  0d30'0.00"N)
Band 1 Block=1024x1 Type=Byte, ColorInterp=Red
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=1024x1 Type=Byte, ColorInterp=Green
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=1024x1 Type=Byte, ColorInterp=Blue
  Metadata:
    LAYER_TYPE=athematic
  Image Structure Metadata:
    COMPRESSION=JPEG

D:\Geo_Images\multi_Resolution_Data\test\bug_report>gdalinfo mosaic.vrt
Driver: VRT/Virtual Raster
Files: mosaic.vrt
Size is 65536, 65536
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (0.000000000000000,1.000000000000000)
Pixel Size = (0.000015258789063,-0.000015258789063)
Corner Coordinates:
Upper Left  (   0.0000000,   1.0000000) (  0d 0'0.01"E,  1d 0'0.00"N)
Lower Left  (   0.0000000,   0.0000000) (  0d 0'0.01"E,  0d 0'0.01"N)
Upper Right (   1.0000000,   1.0000000) (  1d 0'0.00"E,  1d 0'0.00"N)
Lower Right (   1.0000000,   0.0000000) (  1d 0'0.00"E,  0d 0'0.01"N)
Center      (   0.5000000,   0.5000000) (  0d30'0.00"E,  0d30'0.00"N)
Band 1 Block=128x128 Type=Byte, ColorInterp=Red
Band 2 Block=128x128 Type=Byte, ColorInterp=Green
Band 3 Block=128x128 Type=Byte, ColorInterp=Blue


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/34a32f7a/attachment.html
From Doug_Newcomb at fws.gov  Thu Nov 19 08:16:38 2009
From: Doug_Newcomb at fws.gov (Doug_Newcomb@fws.gov)
Date: Thu Nov 19 08:17:22 2009
Subject: [gdal-dev] Re: CUDA PyCUDA and GDAL
In-Reply-To: <loom.20091119T084158-818@post.gmane.org>
Message-ID: <OF045AAAE7.FA384041-ON85257673.0047C9F9-85257673.0048EF37@fws.gov>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: graycol.gif
Type: image/gif
Size: 105 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/4815abe0/graycol-0001.gif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pic18467.gif
Type: image/gif
Size: 1255 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/4815abe0/pic18467-0001.gif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: ecblank.gif
Type: image/gif
Size: 45 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/4815abe0/ecblank-0001.gif
From tasmith3 at rockwellcollins.com  Thu Nov 19 14:01:29 2009
From: tasmith3 at rockwellcollins.com (tasmith3@rockwellcollins.com)
Date: Thu Nov 19 14:01:48 2009
Subject: [gdal-dev] Is there a way to determine if my bands are interleaved?
Message-ID: <OFE1B48462.8F4F0B57-ON87257673.00677A22-87257673.00688206@rockwellcollins.com>

TIFF is one type of data that I need to read in.  Some of the RGB images 
are pixel interleaved while others are planar (non-interleaved).  I was 
intending to use the GDALDataset::RasterIO function to read in my data, as 
I only need a buffer containing the entire image exactly as it exists on 
disk.  If I'm going to use GDALDataset::RasterIO, I need to know the 
offset between bands (it's the last parameter to the function).  That 
value is going to be different depending on whether or not the bands are 
interleaved.  If I was using libtiff, I could get the TIFF_TAG that told 
me how the data was organized, but how can I get that information with 
GDAL so I know how to fill in that last parameter to GDALDataset::RasterIO 
correctly?

Or... is there a better way to do this altogether? 

Thanks,

Todd
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/83233de7/attachment.html
From even.rouault at mines-paris.org  Thu Nov 19 16:48:45 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Nov 19 16:48:57 2009
Subject: [gdal-dev] Is there a way to determine if my bands are
	interleaved?
In-Reply-To: <OFE1B48462.8F4F0B57-ON87257673.00677A22-87257673.00688206@rockwellcollins.com>
References: <OFE1B48462.8F4F0B57-ON87257673.00677A22-87257673.00688206@rockwellcollins.com>
Message-ID: <4B05BD3D.7060403@mines-paris.org>

tasmith3@rockwellcollins.com a ?crit :

In fact, you don't need to know if the TIFF file is interleaved or not. 
It is abstracted by GDAL. The interleaving parameters of the RasterIO() 
call determine the interleaving parameters of the result buffer you 
wish. So they can be completely unrelated to the actual interleaving of 
the source file. By default, if you let the spacing parameters to 0, 
GDAL will return a planar buffer.

If you really want to get the interleaving or planar config of a GTiff 
file, you can query the "INTERLEAVE" metadata item of the 
"IMAGE_STRUCTURE" metadata domain. If it's "PIXEL", it's pixel 
interleaved, if it's "BAND" it's planar.

>
> TIFF is one type of data that I need to read in.  Some of the RGB 
> images are pixel interleaved while others are planar 
> (non-interleaved).  I was intending to use the GDALDataset::RasterIO 
> function to read in my data, as I only need a buffer containing the 
> entire image exactly as it exists on disk.  If I'm going to use 
> GDALDataset::RasterIO, I need to know the offset between bands (it's 
> the last parameter to the function).  That value is going to be 
> different depending on whether or not the bands are interleaved.  If I 
> was using libtiff, I could get the TIFF_TAG that told me how the data 
> was organized, but how can I get that information with GDAL so I know 
> how to fill in that last parameter to GDALDataset::RasterIO correctly?
>
> Or... is there a better way to do this altogether?  
>
> Thanks,
>
> Todd
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From brodzik at nsidc.org  Thu Nov 19 17:20:39 2009
From: brodzik at nsidc.org (Mary Jo Brodzik)
Date: Thu Nov 19 17:20:42 2009
Subject: [gdal-dev] trying to change regionator image resampling to
	nearest-neighbor
In-Reply-To: <4AFC6D4F.50308@pobox.com>
References: <alpine.LNX.1.10.0911121102170.20251@wuzzles.colorado.edu>
	<4AFC6D4F.50308@pobox.com>
Message-ID: <alpine.LNX.1.10.0911191513550.6270@wuzzles.colorado.edu>



> I would suggest you try out gdal2tiles.py which does something similar
> to regionator but with many more options.
>
>  http://www.gdal.org/gdal2tiles.html
>

Frank recommended that I try gdal2tiles.  I (think) I now have a working 
version of it, and I've looked at the man page to find this usage:

gdal2tiles.py [-title "Title"] [-publishurl http://yourserver/dir/]
                      [-nogooglemaps] [-noopenlayers] [-nokml]
                      [-googlemapskey KEY] [-forcekml] [-v]
                      input_file [output_dir]

Unfortunately, the man page has no description of the expected format for 
input_file.  My input file is a .png image of an area of the Himalayas in 
a lat/lon projection.  I have corner points, of course, but they're not in 
the .png (as far as I know!) My question now is how do I go about telling 
gdal2tiles how to georeference my image?  I want to generate the kml 
superoverlay information, so isn't it going to need that to produce the 
superoverlay?

Thanks,
Mary Jo

^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Mary Jo Brodzik, Manager of Science Programmers, 303-492-8263
NSIDC/CIRES, Univ. of Colo. at Boulder, 449 UCB, Boulder, CO 80309-0449
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

From ivan.lucena at pmldnet.com  Thu Nov 19 20:05:06 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Ivan=20Lucena?=)
Date: Thu Nov 19 20:05:09 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gUmU6IEpBVkEgQVBJIC0gUGVyZm9ybWFuY2UgLSBXb3ch?=
Message-ID: <20091120010507.8161.qmail@s466.sureserver.com>

Even,

As I said before, the new API is great but I need to report a correction on my performance analysis.

I found that an unnecessary float-to-string conversion was taking much of the processing time on my code. 

After I remove that from the code the performance of the Frank's proximity algorithm in C or in Java is basically *identical*. No kidding!

My best regards,

Ivan


>??-------Original Message-------
>??From: Ivan <ivan.lucena@pmldnet.com>
>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>??Sent: Nov 18 '09 16:05
>??
>??Even,
>??
>??I just got it to work with the new API today. That is great!
>??
>??And just liike you said, the advantage is in usability not performance.
>??
>??Thanks,
>??
>??Ivan
>??
>??>??-------Original Message-------
>??>??From: Even Rouault <even.rouault@mines-paris.org>
>??>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>??>??Sent: Nov 14 '09 17:32
>??>??
>??>??Selon Ivan <ivan.lucena@pmldnet.com>:
>??>??
>??>??I've commited new API that adds ReadRaster() and WriteRaster() methods that use
>??>??the regular Java arrays (byte[], short[], int[], float[], double[]). See
>??>??http://gdal.org/java
>??>??
>??>??On my PC,
>??>??http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/java/apps/GDALTestIO.java
>??>??runs in about 20.3s for the ReadRaster()/WriteRaster() case, and in about 24.7s
>??>??for the ReadRaster_Direct()/WriteRaster_Direct() case. Not a big advantage
>??>??(which tends to not any advantage at all when run with the -server flag, as both
>??>??run in about 21.3 s !), but regular Java arrays are a bit easier to use than
>??>??ByteBuffer (especially that with Sun JVM 1.6, the array() method on ByteBuffer
>??>??is not implemented).
>??>??
>??>??> Even,
>??>??>
>??>??> You are right. The point is how to take full advantage of the GDAL Java API
>??>??> choosing the right
>??>??> approach to deal with the raster buffer on the client side.
>??>??>
>??>??> Best regards,
>??>??>
>??>??> Ivan
>??>??>
>??>??> Even Rouault wrote:
>??>??> > Selon Ivan <ivan.lucena@pmldnet.com>:
>??>??> >
>??>??> > Ivan,
>??>??> >
>??>??> > I'm not sure what you are really measuring if you compare a C++ code versus
>??>??> its
>??>??> > translation to Java code. I think it just reflects the known slowdown of
>??>??> Java
>??>??> > when doing intensive computations in comparison to native code. The 0.2
>??>??> second
>??>??> > difference between the regular array version and the ByteBuffer one is the
>??>??> > interesting result, not the 1.2/1.0 second difference between C++ and Java.
>??>??> >
>??>??> >> Caio Simone,
>??>??> >>
>??>??> >> I just downloaded imageio-ext to check how it does that but it looks like
>??>??> I
>??>??> >> don't need to do that now, I can take you report instead. Thank you very
>??>??> >> much. I will take a look on array pinning for a start.
>??>??> >>
>??>??> >> I translated the GDAL Proximity [1] code to Java and I timed both of then
>??>??> >> with the same input, a 1024x1024 byte image with just one pixel as feature
>??>??> at
>??>??> >> the center of the image.
>??>??> >>
>??>??> >> It took 0.3 seconds in C++ and 1.5 seconds in Java!
>??>??> >>
>??>??> >> I then translated the buffers to regular arrays and it went down a little
>??>??> >> bit, 1.3 seconds.
>??>??> >>
>??>??> >> It is still a big disadvantage. I believe that the buffer-to-buffer
>??>??> >> translation is the guilt time waster in that case.
>??>??> >>
>??>??> >> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
>??>??> >>
>??>??> >> My best regards,
>??>??> >>
>??>??> >> Ivan
>??>??> >>
>??>??> >>>??-------Original Message-------
>??>??> >>>??From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
>??>??> >>>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>??>??> >>>??Sent: Nov 10 '09 12:36
>??>??> >>>
>??>??> >>>??Ciao Even,
>??>??> >>>??just wanted to add my 2 cents.
>??>??> >>>
>??>??> >>>??As you know for the imageio-ext project we have been using the
>??>??> >>>??GDAL-JNI bindings (actually a modified version of them) for a while in
>??>??> >>>??order to allow Java users to leverage on GDAL using the ImageIO
>??>??> >>>??framework which standard in Java.
>??>??> >>>??This way we also enabled GeoTools and GeoServer to use GDAL as a
>??>??> >> datasource.
>??>??> >>>??In the past I have done quite some performance tests to add some
>??>??> >>>??new/different methods to them and I can summarise our findings as
>??>??> >>>??follows:
>??>??> >>>
>??>??> >>>??- DirectByteBuffer vs regular arrays -
>??>??> >>>??DBB is expensive to allocate but prevent the VM from performing copies
>??>??> >>>??when having to move data to and from java and native code since they
>??>??> >>>??live on the native space not on the java heap; On the other side the
>??>??> >>>??regular arrays are fast to allocate but they are "usually" copied when
>??>??> >>>??moved across from/to java and native code since the JVM cannot leave
>??>??> >>>??the native code mess with the java heap space since the garbage
>??>??> >>>??collector would not be very happy about that. I said "usually" since
>??>??> >>>??there is a technique called array pinning that we can suggest the JVM
>??>??> >>>??to use to avoid the copy of regular array; however this mechanism is
>??>??> >>>??not guaranteed to be implemented and/or to work on each call (same
>??>??> >>>??reason as above, GC is not happy about this technique).
>??>??> >>>
>??>??> >>>??If you can pool the DBB??and/or use a few large DBB, where the cost of
>??>??> >>>??the copy would overcome the cost of its creation then DBB are much
>??>??> >>>??better than regular arrays. As an instance I noticed that using when
>??>??> >>>??reading striped tiff files regular arrays where faster, but as the
>??>??> >>>??tile size increases (and therefore the cost of a copy overcomes the
>??>??> >>>??cost of a DBB creation) the DBB performs much better
>??>??> >>>
>??>??> >>>??- DirectByteBuffer and the impact on some JVM -
>??>??> >>>??Now in the past we decided to stick with DBB and give
>??>??> >>>??GeoServer/GeoTools users the capability to retile data on the fly.
>??>??> >>>??However lately, during the WMS performance shootout we noticed on some
>??>??> >>>??linux machines JVm soldi crashed, not nice (means restarting the
>??>??> >>>??GeoServer!!!).
>??>??> >>>??We investigated a bit in depth and the problem was that somehow the
>??>??> >>>??JVM was failing to allocate some internal images during the rendering
>??>??> >>>??process and then dying with a NullPointerException (apparently the SUN
>??>??> >>>??Java2D engineers did not use to check for out of memory errors in the
>??>??> >>>??java native space). Well, what happens is that if you use too much of
>??>??> >>>??the Java native space for your own objects, it is likely that the JVM
>??>??> >>>??itself will start to malfunction (you can find articles on the web on
>??>??> >>>??the memory model of a Java process, I don't think I am good enough to
>??>??> >>>??explain it ) since it cannot allocate its own objects.
>??>??> >>>
>??>??> >>>??In the end we decide to leave DBB and go back to regular arrays with
>??>??> >>>??array pinning. This ensured us robustness and we did not see much
>??>??> >>>??performance degradation (which means that array pinning in the end
>??>??> >>>??works). This has been implemented by modifying the SWIG bindings for
>??>??> >>>??GDAL in order to use a byte array instead of a DBB and then use
>??>??> >>>??ByteArray utils to convert between different native type (short, int,
>??>??> >>>??etc..).
>??>??> >>>
>??>??> >>>??- Conclusion -
>??>??> >>>??We might want to spend some time in the mid term to contribute some of
>??>??> >>>??this work back (or probably provide funding), but anyway, it would be
>??>??> >>>??great to have the capability to switch between DBB and regular arrays
>??>??> >>>??since both have flaws.
>??>??> >>>??However atm if I were asked I would say to go with regular arrays as
>??>??> >>>??we do in the imageio-ext project.
>??>??> >>>
>??>??> >>>??Ciao,
>??>??> >>>??Simone.
>??>??> >>>??-------------------------------------------------------
>??>??> >>>??Ing. Simone Giannecchini
>??>??> >>>??GeoSolutions S.A.S.
>??>??> >>>??Founder - Software Engineer
>??>??> >>>??Via Carignoni 51
>??>??> >>>??55041??Camaiore (LU)
>??>??> >>>??Italy
>??>??> >>>
>??>??> >>>??phone: +39 0584983027
>??>??> >>>??fax:??????+39 0584983027
>??>??> >>>??mob:????+39 333 8128928
>??>??> >>>
>??>??> >>>
>??>??> >>>??http://www.geo-solutions.it
>??>??> >>>??http://geo-solutions.blogspot.com/
>??>??> >>>??http://simboss.blogspot.com/
>??>??> >>>??http://www.linkedin.com/in/simonegiannecchini
>??>??> >>>
>??>??> >>>??-------------------------------------------------------
>??>??> >>>
>??>??> >>>
>??>??> >>>
>??>??> >>>??On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>??>??> >>>??<even.rouault@mines-paris.org> wrote:
>??>??> >>>??> Selon Ivan <ivan.lucena@pmldnet.com>:
>??>??> >>>??>
>??>??> >>>??> Ivan,
>??>??> >>>??>
>??>??> >>>??> thanks for your testing (CC'ing the list as it is of general
>??>??> interest).
>??>??> >>>??> Actually, I also read on some sites that using ByteBuffer object
>??>??> versus
>??>??> >> regular
>??>??> >>>??> Java arrays is not always a win. Plus the fact that we must use a
>??>??> direct
>??>??> >> buffer
>??>??> >>>??> that has an extra allocation cost according to the Javadoc. So
>??>??> >> ByteBuffer might
>??>??> >>>??> be interesting if you just want to pass big arrays between native
>??>??> code,
>??>??> >> for
>??>??> >>>??> example if you read an array from a dataset and then write it to
>??>??> another
>??>??> >> one
>??>??> >>>??> without accessing it from the Java side. When you mention that
>??>??> accessing
>??>??> >> through
>??>??> >>>??> the byte[] array was faster, did you get it with the array() method
>??>??> >> instead ?
>??>??> >>>??> I'm wondering what the performance overhead of this call is.
>??>??> >>>??>
>??>??> >>>??> As ByteBuffer is not at all a requirement for the interface with the
>??>??> >> native
>??>??> >>>??> code, it would be technically possible to add an alternative API that
>??>??> >> would use
>??>??> >>>??> the regular Java array types.
>??>??> >>>??>
>??>??> >>>??> Would you mind opening an enhancement ticket about that ? Thanks
>??>??> >>>??>
>??>??> >>>??> Even
>??>??> >>>??>
>??>??> >>>??>> Even,
>??>??> >>>??>>
>??>??> >>>??>> I did some test with the GDAL Java API and some simple raster
>??>??> >> operations
>??>??> >>>??>> like the GDAL Proximity algorthm and I noticed that the performance
>??>??> >> while
>??>??> >>>??>> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value)
>??>??> is
>??>??> >> not
>??>??> >>>??>> as good as if you copy then to (or from) a "regular" array, like
>??>??> >> float[],
>??>??> >>>??>> double[], integer[] and byte[].
>??>??> >>>??>>
>??>??> >>>??>> The reason for that is obvious, get() and put() are funtion calls and
>??>??> >>>??>> contains a lot of code for range check.
>??>??> >>>??>>
>??>??> >>>??>> If I understand it correctly, ByteBuffer is the ideal or maybe the
>??>??> only
>??>??> >>>??>> way to get access to Buffers from C libraries thought a Java wrapper.
>??>??> >> But
>??>??> >>>??>> do you it would be possible to incapsulate the buffer conversion at
>??>??> the
>??>??> >>>??>> wrapper code so that users would be able to read and write direct to
>??>??> >>>??>> regular Java arrays?
>??>??> >>>??>>
>??>??> >>>??>> Just a suggestion,
>??>??> >>>??>>
>??>??> >>>??>> Ivan
>??>??> >>>??>>
>??>??> >>>??>
>??>??> >>>??>
>??>??> >>>??> _______________________________________________
>??>??> >>>??> gdal-dev mailing list
>??>??> >>>??> gdal-dev@lists.osgeo.org
>??>??> >>>??> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>??>??> >>>??>
>??>??> >>>
>??>??> >
>??>??> >
>??>??> >
>??>??>
>??>??>
>??>??
>??>??
>??>??
>??_______________________________________________
>??gdal-dev mailing list
>??gdal-dev@lists.osgeo.org
>??http://lists.osgeo.org/mailman/listinfo/gdal-dev
>??
From shaun.kolomeitz at derm.qld.gov.au  Thu Nov 19 21:27:14 2009
From: shaun.kolomeitz at derm.qld.gov.au (Shaun Kolomeitz)
Date: Thu Nov 19 21:27:20 2009
Subject: [gdal-dev] CUDA PyCUDA and GDAL
Message-ID: <4F51CF02179D2247B9ED6AFA54E2DF6E0E881931@BNEXVS02.prod.ad.internal>

Frank,

Can you expand of what you mean by a "gross issue" (non-optimised/user
ignorance/rtfm ???) ? Are there compounding issues in the process ?
Is there a "magic combination of switches" on a 32bit system (3Gb RAM,
Dual Xeons) that I should be using (does it depend muchly on the
source/destination image format - normally IMB or ECW/SID to TIF/PNG? I
currently use a window size of 500MB and GDAL_CACHEMAX of 512MB, and I
thought that was supposed to be optimal ? I also have a high-end
consumer 64bit Core i7 XE / 12Gb RAM with twin SSDs in Raid0 available
at home and am curious if the settings for optimising processing in
64bit (for gdal_retile, gdalwarp and gdal_translate) can be bumped up
significantly.
Its sounding like CUDA is perhaps not going to give us that great a
return for our investment. How does one go about locating a suitably
experienced GDAL developer ? (which of course you would have to be the
ultimate Guru here :-)

Many thanks,
Shaun

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Thursday, 19 November 2009 11:20 AM
To: Shaun Kolomeitz
Cc: Seth Price; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] CUDA PyCUDA and GDAL

Shaun Kolomeitz wrote:
> Thanks Seth,
> 
> It makes sense that the slowest part of the whole equation would be
the
> disk operations, and there must be quite a number of disk reads/writes
> when processing imagery. Currently we use Raid Arrays that push data
> through at a rate of 300MB/s, granted if these were SSDs in Raid0 we
> could push beyond 1GB/s. Currently to process (mosaic) an 80GB image
it
> takes several days to complete. This is also on 32bit hardware, and I
> suspect is only single threaded so we're limited to 3GB RAM. From what
I
> understood the most optimal caching size in GDAL is 500MB, using a
512M
> window (unless that has changed).
> If you can easily lay your hands on your GSoC application than that
> would be great. We are discussing what might be possible with a very
> talented coder, who eats these types of "challenges" for breakfast !
> Perhaps a better approach would be to use something like a grid
> computing approach then like Condor to break up the processing ?

Shaun,

I suspect that there is a gross issue with how the warping is being
done,
and that it could be sped up substantially. On my two year old consumer
grade desktop I'm able to warp/reproject around 30GB/hour with gdalwarp.

I don't want to dissuade you from investigating CUDA options, but
you might be able to get ten fold improvement by hiring an experienced
gdalwarp developer for a few hours to investigate your particular
situation.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



As of 26 March 2009 the Department of Natural Resources and Water/Environmental Protection Agency integrated to form the Department of Environment and Resource Management 

+----------------------------------------------------------------+
Think B4U Print
1 ream of paper = 6% of a tree and 5.4kg CO2 in the atmosphere
3 sheets of A4 paper = 1 litre of water
+----------------------------------------------------------------+


From fniles at mitre.org  Thu Nov 19 11:58:09 2009
From: fniles at mitre.org (Niles, Rick)
Date: Thu Nov 19 21:47:38 2009
Subject: [gdal-dev] Reading compressed GZIP files
Message-ID: <4FD125153A070D45BC87645D3B8802881EFDC59C@IMCMBX3.MITRE.ORG>

I'm sure this subject has come up before, but these terrain files get quite large and in some cases it would be nice to be able to  compress them and read them on the fly, such as, gzipped files.  Is there a standard accepted method to uncompress and read files on the fly.   I guess something like a GDALOpen_z () function.

As a side note, I'm sure this has come up before, but I couldn't find a search engine to for the entire e-mail archives.  Am I just missing it?

Thanks,
Rick Niles.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091119/28ecb903/attachment.html
From emmanuel.christophe at gmail.com  Thu Nov 19 22:17:51 2009
From: emmanuel.christophe at gmail.com (Emmanuel Christophe)
Date: Thu Nov 19 22:18:18 2009
Subject: [gdal-dev] Problems with TIFF internal symbols
In-Reply-To: <20090921084537.GC3748@mithrandir>
References: <20090918085503.2209277e@valentinows>
	<20090921084537.GC3748@mithrandir>
Message-ID: <dece71900911191917h1bfe71cctde0fce34b02aeae9@mail.gmail.com>

Hi,
I took a bit more time to investigate this and came out with a minimal
test case to reproduce that (using only gdal). The context is a
project using gdal AND some specific geotiff methods thus requiring
both for linking.

Since gdal 1.6 on Debian, the option with-hide-internal-symbols is
used which appears to cause segmentation fault when reading geotiff
files.

The test program (also attached):

#include "gdal.h"
int main(int argc, char * argv[])
{
  GDALAllRegister();
  GDALOpen(argv[1], GA_ReadOnly );
}

It is compiled using cmake with the following CMakeLists.txt:

FIND_PATH(GDAL_INCLUDE_DIR gdal.h /usr/include/gdal)
FIND_LIBRARY(GDAL_LIBRARY NAMES gdal)
FIND_LIBRARY(TIFF_LIBRARY NAMES tiff)
FIND_LIBRARY(GEOTIFF_LIBRARY NAMES geotiff)

INCLUDE_DIRECTORIES(${GDAL_INCLUDE_DIR})

ADD_EXECUTABLE(gdalHideSymbols gdalHideSymbols.cxx)
TARGET_LINK_LIBRARIES(gdalHideSymbols ${TIFF_LIBRARY}
${GEOTIFF_LIBRARY}  ${GDAL_LIBRARY})

I'm trying that using an updated debian testing with the official
packages for tiff, geotiff, gdal. Just 'cmake .', then 'make'

The segfault can be reproduced using a geotiff image, for example:
http://hg.orfeo-toolbox.org/OTB-Data/raw-file/51234ada686c/Input/ROI_QB_MUL_4.tif

It doesn't happen when the link to the geotiff library is removed.

Emmanuel


On Mon, Sep 21, 2009 at 4:45 PM, Francesco P. Lovergine
<frankie@debian.org> wrote:
> On Fri, Sep 18, 2009 at 08:55:03AM +0200, Antonio Valentino wrote:
>> Hi list,
>> I'm trying to use OTB (Orfeo ToolBox) on Debian Sid with GDAL 1.6.2 and
>> I get a lot of segmentation fault related to GDAL and TIFF files.
>>
>> A guy on the OTB mailing list suggested that it could depend on the
>> "with-hide-internal-symbols" flag used for Debian packages.
>>
>> See thread
>>
>> http groups dot google dot com /group/otb-users/browse_thread/thread/be8ad5e263aafe14
>>
>> (sorry the spam filter of my ISP keeps blocking this message)
>>
>> Is the above hypothesis correct?
>> How can we solve the issue in this case?
>>
>>
>> Best regards
>>
>
> The only problem found in the past with that option was:
>
> http://svn.debian.org/viewsvn/pkg-grass/packages/gdal/trunk/debian/patches/cpl_dll.dpatch?revision=2232&view=markup
>
> and it was detected at linking time. It seems OTB is misusing the original TIFF API or exploting
> some inner problems of the same library. Note that
> the geotiff internal gdal library has been used since 1.6.0 in debian, the old one used the same
> library you are now linking with the default configuration. So the objection seems pointless.
>
> --
> Francesco P. Lovergine
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
FIND_PATH(GDAL_INCLUDE_DIR gdal.h /usr/include/gdal)
FIND_LIBRARY(GDAL_LIBRARY NAMES gdal)
FIND_LIBRARY(TIFF_LIBRARY NAMES tiff)
FIND_LIBRARY(GEOTIFF_LIBRARY NAMES geotiff)

INCLUDE_DIRECTORIES(${GDAL_INCLUDE_DIR})

ADD_EXECUTABLE(gdalHideSymbols gdalHideSymbols.cxx)
TARGET_LINK_LIBRARIES(gdalHideSymbols ${TIFF_LIBRARY} ${GEOTIFF_LIBRARY}  ${GDAL_LIBRARY})
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdalHideSymbols.cxx
Type: text/x-c++src
Size: 112 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091120/4dd8cce7/gdalHideSymbols.bin
From hobu.inc at gmail.com  Thu Nov 19 23:09:13 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Thu Nov 19 23:12:35 2009
Subject: [gdal-dev] GDAL 1.6.3 RC1 Released
Message-ID: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>

All,

The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.

http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
http://download.osgeo.org/gdal/gdal163-RC1.zip

The following issues were addressed in this release:

General:
 * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
 * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>

GDAL:
 * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
 * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
 * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
 * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
 * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
 * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
 * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
 * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
 * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
 * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
 * Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
 * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
 * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
 * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
 * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
 * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
 * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
 * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
 * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>

Utilities:
 * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
 * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
 * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>

OGR:
 * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
 * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
 * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
 * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
 * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>

Configuration:
 * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
 * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>

Python:
 * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
 * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>

OGR Spatial References:
 * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
 * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>


From emmanuel.christophe at gmail.com  Fri Nov 20 01:46:45 2009
From: emmanuel.christophe at gmail.com (Emmanuel Christophe)
Date: Fri Nov 20 01:47:53 2009
Subject: [gdal-dev] Problems with TIFF internal symbols
In-Reply-To: <20091120062428.GA32356@ba.issia.cnr.it>
References: <20090918085503.2209277e@valentinows>
	<20090921084537.GC3748@mithrandir> 
	<dece71900911191917h1bfe71cctde0fce34b02aeae9@mail.gmail.com> 
	<20091120062428.GA32356@ba.issia.cnr.it>
Message-ID: <dece71900911192246t2a039198kdfe5ca1a3ef81ead@mail.gmail.com>

On Fri, Nov 20, 2009 at 2:24 PM, Francesco P. Lovergine
<frankie@debian.org> wrote:
> On Fri, Nov 20, 2009 at 11:17:51AM +0800, Emmanuel Christophe wrote:
>> Hi,
>> I took a bit more time to investigate this and came out with a minimal
>> test case to reproduce that (using only gdal). The context is a
>> project using gdal AND some specific geotiff methods thus requiring
>> both for linking.
>>
>> Since gdal 1.6 on Debian, the option with-hide-internal-symbols is
>> used which appears to cause segmentation fault when reading geotiff
>> files.
>>
>> The test program (also attached):
>>
>> #include "gdal.h"
>> int main(int argc, char * argv[])
>> {
>> ? GDALAllRegister();
>> ? GDALOpen(argv[1], GA_ReadOnly );
>> }
>>
>> It is compiled using cmake with the following CMakeLists.txt:
>>
>> FIND_PATH(GDAL_INCLUDE_DIR gdal.h /usr/include/gdal)
>> FIND_LIBRARY(GDAL_LIBRARY NAMES gdal)
>> FIND_LIBRARY(TIFF_LIBRARY NAMES tiff)
>> FIND_LIBRARY(GEOTIFF_LIBRARY NAMES geotiff)
>>
>> INCLUDE_DIRECTORIES(${GDAL_INCLUDE_DIR})
>>
>> ADD_EXECUTABLE(gdalHideSymbols gdalHideSymbols.cxx)
>> TARGET_LINK_LIBRARIES(gdalHideSymbols ${TIFF_LIBRARY}
>> ${GEOTIFF_LIBRARY} ?${GDAL_LIBRARY})
>>
>> I'm trying that using an updated debian testing with the official
>> packages for tiff, geotiff, gdal. Just 'cmake .', then 'make'
>>
>> The segfault can be reproduced using a geotiff image, for example:
>> http://hg.orfeo-toolbox.org/OTB-Data/raw-file/51234ada686c/Input/ROI_QB_MUL_4.tif
>>
>> It doesn't happen when the link to the geotiff library is removed.
>>
>> Emmanuel
>>
>
> Linking order does matter, I suspect. I wonder if gdal should use
> versioned symbols at linking time on Debian to avoid such breakages
> at all.
>
> --
> Francesco P. Lovergine
>

Yes, I can confirm that the order matters:

gcc -c gdalHideSymbols.cxx -I/usr/include/gdal
gcc gdalHideSymbols.o -lgeotiff -lgdal1.6.0 -o gdalHideSymbols-gtiffgdal
gcc gdalHideSymbols.o -lgdal1.6.0 -lgeotiff -o gdalHideSymbols-gdalgtiff
./gdalHideSymbols-gtiffgdal IMAGERY_ortho.tif
Segmentation fault
./gdalHideSymbols-gdalgtiff IMAGERY_ortho.tif
Ok

However, any order was working with the debian package for gdal 1.5

In a big project with a lot of dependencies, it's tricky to make sure
that the order is correct.

Emmanuel
From frankie at debian.org  Fri Nov 20 01:24:29 2009
From: frankie at debian.org (Francesco P. Lovergine)
Date: Fri Nov 20 02:05:53 2009
Subject: [gdal-dev] Problems with TIFF internal symbols
In-Reply-To: <dece71900911191917h1bfe71cctde0fce34b02aeae9@mail.gmail.com>
References: <20090918085503.2209277e@valentinows>
	<20090921084537.GC3748@mithrandir>
	<dece71900911191917h1bfe71cctde0fce34b02aeae9@mail.gmail.com>
Message-ID: <20091120062428.GA32356@ba.issia.cnr.it>

On Fri, Nov 20, 2009 at 11:17:51AM +0800, Emmanuel Christophe wrote:
> Hi,
> I took a bit more time to investigate this and came out with a minimal
> test case to reproduce that (using only gdal). The context is a
> project using gdal AND some specific geotiff methods thus requiring
> both for linking.
> 
> Since gdal 1.6 on Debian, the option with-hide-internal-symbols is
> used which appears to cause segmentation fault when reading geotiff
> files.
> 
> The test program (also attached):
> 
> #include "gdal.h"
> int main(int argc, char * argv[])
> {
>   GDALAllRegister();
>   GDALOpen(argv[1], GA_ReadOnly );
> }
> 
> It is compiled using cmake with the following CMakeLists.txt:
> 
> FIND_PATH(GDAL_INCLUDE_DIR gdal.h /usr/include/gdal)
> FIND_LIBRARY(GDAL_LIBRARY NAMES gdal)
> FIND_LIBRARY(TIFF_LIBRARY NAMES tiff)
> FIND_LIBRARY(GEOTIFF_LIBRARY NAMES geotiff)
> 
> INCLUDE_DIRECTORIES(${GDAL_INCLUDE_DIR})
> 
> ADD_EXECUTABLE(gdalHideSymbols gdalHideSymbols.cxx)
> TARGET_LINK_LIBRARIES(gdalHideSymbols ${TIFF_LIBRARY}
> ${GEOTIFF_LIBRARY}  ${GDAL_LIBRARY})
> 
> I'm trying that using an updated debian testing with the official
> packages for tiff, geotiff, gdal. Just 'cmake .', then 'make'
> 
> The segfault can be reproduced using a geotiff image, for example:
> http://hg.orfeo-toolbox.org/OTB-Data/raw-file/51234ada686c/Input/ROI_QB_MUL_4.tif
> 
> It doesn't happen when the link to the geotiff library is removed.
> 
> Emmanuel
> 

Linking order does matter, I suspect. I wonder if gdal should use 
versioned symbols at linking time on Debian to avoid such breakages
at all.

-- 
Francesco P. Lovergine
From jukka.rahkonen at mmmtike.fi  Fri Nov 20 03:07:08 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri Nov 20 03:08:35 2009
Subject: [gdal-dev] Gdaltindex without NODATA areas
Message-ID: <loom.20091120T081801-202@post.gmane.org>

Hi,

Gdaltindex creates simple rectangular polygons. When images are warped the
resulting tileindex polygons will overlap. This is ok when tileindex is used as
an image catalogue by Mapserver.  However, sometimes it would be useful to have
an image catalogue showing the real image data areas. Is there a tool for
creating such a catalogue, or relatively simple instructions about how that kind
of catalogue could be created? I imagine that taking the image extent rectangles
as a starting point but clipping away NODATA areas (perhaps dug out with a
system like gdal_polygonize using some "create_only_NODATA_polygons") might give
the desired result.

-Jukka Rahkonen-

From arnaud.sig at gmail.com  Fri Nov 20 03:32:49 2009
From: arnaud.sig at gmail.com (Arnaud Vandecasteele)
Date: Fri Nov 20 03:33:34 2009
Subject: [gdal-dev] Error glibc detected
Message-ID: <166b86070911200032l77889324rce5c3dec853ff468@mail.gmail.com>

Hi all,

In one of my application I want to create a Shapefile and populate it.
The aime is to read data from a netCDF file and transform them into Feature
of a ShapeFile.
It works fine for almost all fields but the script crash when I try to
calculate a field who depends of two others (like fields x = fields a +
fields b)
The error is :
*** glibc detected *** free(): invalid next size (fast): 0x0818a6b8 ***

So I must create the structure of the database, fill all the fields instead
the one who trow methe error and close the datasource.
After that I re-open my ShapeFile to fill the last fields. It works in that
way but it's not a clean way.

Did you already got this kind of error or do you know what I'm doing wrong?


Best Regards


Arnaud
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091120/55734745/attachment-0001.html
From simone.giannecchini at geo-solutions.it  Fri Nov 20 06:54:48 2009
From: simone.giannecchini at geo-solutions.it (Simone Giannecchini)
Date: Fri Nov 20 12:25:41 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <1257939206.4afaa106743c6@imp.free.fr>
References: <20091109233607.2877.qmail@s466.sureserver.com>
	<1257850818.4af947c20752a@imp.free.fr>
	<961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>
	<1257939206.4afaa106743c6@imp.free.fr>
Message-ID: <961f4d9e0911200354v5294bb46ye9ddc959b3ffa918@mail.gmail.com>

Ciao Even,
please read below...
-------------------------------------------------------
Ing. Simone Giannecchini
GeoSolutions S.A.S.
Founder - Software Engineer
Via Carignoni 51
55041  Camaiore (LU)
Italy

phone: +39 0584983027
fax:      +39 0584983027
mob:    +39 333 8128928


http://www.geo-solutions.it
http://geo-solutions.blogspot.com/
http://simboss.blogspot.com/
http://www.linkedin.com/in/simonegiannecchini

-------------------------------------------------------



On Wed, Nov 11, 2009 at 12:33 PM, Even Rouault
<even.rouault@mines-paris.org> wrote:
> Selon Simone Giannecchini <simone.giannecchini@geo-solutions.it>:
>
> Simone,
>
> thanks for all this interesting information. I'm doing some experiment with Sun
> JRE 1.6 and I observe that array pinning doesn't really work. I mean that the
> jenv->GetByteArrayElements($input, &isCopy) call always return isCopy ==
> JNI_TRUE, which seems to be confirmed by
> http://elliotth.blogspot.com/2007/03/optimizing-jni-array-access.html (although
> it is a bit outdated now) : "[...] current Sun JVMs never give you a direct
> pointer. They always copy".

I kind of remember that we tested this in the past, but I am not 100%
sure. What I can tell you is that I
did not test this with the modified GDAL bindings.


>
> I've tried GetPrimitiveArrayCritical() / ReleasePrimitiveArrayCritical() and
> I've observed they return non-copy pointers, which make them good candidates.
> Looking at
> http://java.sun.com/j2se/1.3/docs/guide/jni/jni-12.html#GetPrimitiveArrayCritical,
> it appears that there are restrictions to use them. But this is probably OK as
> we don't callback Java code in the RasterIO operations. But I'm not sure if the
> native operation can be considered to be fast enough to use those primitives. It
> depends on the query size and the driver. Perhaps it is not worth the risk and
> that the copy made by the JVM when calling GetByteArrayElements() is not that
> significant for modest size arrays.
>

I decide not to take the risk. The problem with that call is that It
should block the GarbageCollector and this is highly counterproductive
in server side application (you tend to prefer less pause times more
often than  a long pause time once ia while).


> Another possibility is that in the ReadRaster() case, we don't care about the
> initial values of the array. We just want to update it in fact, so we could
> allocate a working buffer in the JNI code, call the native RasterIO() on it and
> upload its content into the Java array with SetByteArrayRegion(). This would
> save one copy.

For the reasons I said in my previous email I would refrain from
allocating raster data inside the native code, the JVM seems to not
like that too much.
Moreover, the Java flag to control the native memory space is prefixed
XX which means that it might stop orking with no notice in a newer
java release.
I guess that the best thing, IMHO, is to stick with pinning and hope
for the best, however, it might be interesting to do kind of a testing
session having the geoserver hitting the gdal code for something like
ECW and see what happens with the different options in term of
stability/performance/robustness, what do you think?

Simone.
>
> Have you also observed this ? Which JNI calls do you use ?
>
> Best regards,
> Even
>
>> Ciao Even,
>> just wanted to add my 2 cents.
>>
>> As you know for the imageio-ext project we have been using the
>> GDAL-JNI bindings (actually a modified version of them) for a while in
>> order to allow Java users to leverage on GDAL using the ImageIO
>> framework which standard in Java.
>> This way we also enabled GeoTools and GeoServer to use GDAL as a datasource.
>>
>> In the past I have done quite some performance tests to add some
>> new/different methods to them and I can summarise our findings as
>> follows:
>>
>> - DirectByteBuffer vs regular arrays -
>> DBB is expensive to allocate but prevent the VM from performing copies
>> when having to move data to and from java and native code since they
>> live on the native space not on the java heap; On the other side the
>> regular arrays are fast to allocate but they are "usually" copied when
>> moved across from/to java and native code since the JVM cannot leave
>> the native code mess with the java heap space since the garbage
>> collector would not be very happy about that. I said "usually" since
>> there is a technique called array pinning that we can suggest the JVM
>> to use to avoid the copy of regular array; however this mechanism is
>> not guaranteed to be implemented and/or to work on each call (same
>> reason as above, GC is not happy about this technique).
>>
>> If you can pool the DBB ?and/or use a few large DBB, where the cost of
>> the copy would overcome the cost of its creation then DBB are much
>> better than regular arrays. As an instance I noticed that using when
>> reading striped tiff files regular arrays where faster, but as the
>> tile size increases (and therefore the cost of a copy overcomes the
>> cost of a DBB creation) the DBB performs much better
>>
>> - DirectByteBuffer and the impact on some JVM -
>> Now in the past we decided to stick with DBB and give
>> GeoServer/GeoTools users the capability to retile data on the fly.
>> However lately, during the WMS performance shootout we noticed on some
>> linux machines JVm soldi crashed, not nice (means restarting the
>> GeoServer!!!).
>> We investigated a bit in depth and the problem was that somehow the
>> JVM was failing to allocate some internal images during the rendering
>> process and then dying with a NullPointerException (apparently the SUN
>> Java2D engineers did not use to check for out of memory errors in the
>> java native space). Well, what happens is that if you use too much of
>> the Java native space for your own objects, it is likely that the JVM
>> itself will start to malfunction (you can find articles on the web on
>> the memory model of a Java process, I don't think I am good enough to
>> explain it ) since it cannot allocate its own objects.
>>
>> In the end we decide to leave DBB and go back to regular arrays with
>> array pinning. This ensured us robustness and we did not see much
>> performance degradation (which means that array pinning in the end
>> works). This has been implemented by modifying the SWIG bindings for
>> GDAL in order to use a byte array instead of a DBB and then use
>> ByteArray utils to convert between different native type (short, int,
>> etc..).
>>
>> - Conclusion -
>> We might want to spend some time in the mid term to contribute some of
>> this work back (or probably provide funding), but anyway, it would be
>> great to have the capability to switch between DBB and regular arrays
>> since both have flaws.
>> However atm if I were asked I would say to go with regular arrays as
>> we do in the imageio-ext project.
>>
>> Ciao,
>> Simone.
>> -------------------------------------------------------
>> Ing. Simone Giannecchini
>> GeoSolutions S.A.S.
>> Founder - Software Engineer
>> Via Carignoni 51
>> 55041 ?Camaiore (LU)
>> Italy
>>
>> phone: +39 0584983027
>> fax: ? ? ?+39 0584983027
>> mob: ? ?+39 333 8128928
>>
>>
>> http://www.geo-solutions.it
>> http://geo-solutions.blogspot.com/
>> http://simboss.blogspot.com/
>> http://www.linkedin.com/in/simonegiannecchini
>>
>> -------------------------------------------------------
>>
>>
>>
>> On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>> <even.rouault@mines-paris.org> wrote:
>> > Selon Ivan <ivan.lucena@pmldnet.com>:
>> >
>> > Ivan,
>> >
>> > thanks for your testing (CC'ing the list as it is of general interest).
>> > Actually, I also read on some sites that using ByteBuffer object versus
>> regular
>> > Java arrays is not always a win. Plus the fact that we must use a direct
>> buffer
>> > that has an extra allocation cost according to the Javadoc. So ByteBuffer
>> might
>> > be interesting if you just want to pass big arrays between native code, for
>> > example if you read an array from a dataset and then write it to another
>> one
>> > without accessing it from the Java side. When you mention that accessing
>> through
>> > the byte[] array was faster, did you get it with the array() method instead
>> ?
>> > I'm wondering what the performance overhead of this call is.
>> >
>> > As ByteBuffer is not at all a requirement for the interface with the native
>> > code, it would be technically possible to add an alternative API that would
>> use
>> > the regular Java array types.
>> >
>> > Would you mind opening an enhancement ticket about that ? Thanks
>> >
>> > Even
>> >
>> >> Even,
>> >>
>> >> I did some test with the GDAL Java API and some simple raster operations
>> >> like the GDAL Proximity algorthm and I noticed that the performance while
>> >> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value) is
>> not
>> >> as good as if you copy then to (or from) a "regular" array, like float[],
>> >> double[], integer[] and byte[].
>> >>
>> >> The reason for that is obvious, get() and put() are funtion calls and
>> >> contains a lot of code for range check.
>> >>
>> >> If I understand it correctly, ByteBuffer is the ideal or maybe the only
>> >> way to get access to Buffers from C libraries thought a Java wrapper. But
>> >> do you it would be possible to incapsulate the buffer conversion at the
>> >> wrapper code so that users would be able to read and write direct to
>> >> regular Java arrays?
>> >>
>> >> Just a suggestion,
>> >>
>> >> Ivan
>> >>
>> >
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From klokan at klokan.cz  Fri Nov 20 05:32:55 2009
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Fri Nov 20 12:27:13 2009
Subject: [gdal-dev] trying to change regionator image resampling to 
	nearest-neighbor
In-Reply-To: <alpine.LNX.1.10.0911191513550.6270@wuzzles.colorado.edu>
References: <alpine.LNX.1.10.0911121102170.20251@wuzzles.colorado.edu>
	<4AFC6D4F.50308@pobox.com>
	<alpine.LNX.1.10.0911191513550.6270@wuzzles.colorado.edu>
Message-ID: <6e41d95b0911200232h11164a5erc9c0291e9a7ce2f@mail.gmail.com>

Hi,

> Unfortunately, the man page has no description of the expected format for
> input_file. ?My input file is a .png image of an area of the Himalayas in a
> lat/lon projection. ?I have corner points, of course, but they're not in the
> .png (as far as I know!) My question now is how do I go about telling
> gdal2tiles how to georeference my image? ?I want to generate the kml
> superoverlay information, so isn't it going to need that to produce the
> superoverlay?

There are several ways how you can assign georeference with with the
gdal tools. If you are fine with command line then I recommend to
follow the tutorial created by Mano Marks (a Google employe):
http://code.google.com/apis/kml/articles/raster.html

Even easier is probably to use the MapTiler graphical user interface
where you are guided in a step by step wizard.
You can download installer for MapTiler application here:
http://code.google.com/p/maptiler/downloads/list

Regards,

Klokan Petr Pridal
-- 
http://blog.klokan.cz/
http://www.maptiler.org/
http://www.oldmapsonline.org/
From simone.giannecchini at geo-solutions.it  Fri Nov 20 06:24:34 2009
From: simone.giannecchini at geo-solutions.it (Simone Giannecchini)
Date: Fri Nov 20 12:28:26 2009
Subject: [gdal-dev] Re: JAVA API - Performance - Wow!
In-Reply-To: <20091120010507.8161.qmail@s466.sureserver.com>
References: <20091120010507.8161.qmail@s466.sureserver.com>
Message-ID: <961f4d9e0911200324w5100b8fvf7bdf200396992de@mail.gmail.com>

Ciao Ivan,
wasn't Java supposed to slow? :-)

Anyway, Even has done a good job lately to improve the Java bindings,
I am trying to spare some of our time to track his work closer and
give more feedback.

Ciao,
Simone
-------------------------------------------------------
Ing. Simone Giannecchini
GeoSolutions S.A.S.
Founder - Software Engineer
Via Carignoni 51
55041  Camaiore (LU)
Italy

phone: +39 0584983027
fax:      +39 0584983027
mob:    +39 333 8128928


http://www.geo-solutions.it
http://geo-solutions.blogspot.com/
http://simboss.blogspot.com/
http://www.linkedin.com/in/simonegiannecchini

-------------------------------------------------------



On Fri, Nov 20, 2009 at 2:05 AM, Ivan Lucena <ivan.lucena@pmldnet.com> wrote:
> Even,
>
> As I said before, the new API is great but I need to report a correction on my performance analysis.
>
> I found that an unnecessary float-to-string conversion was taking much of the processing time on my code.
>
> After I remove that from the code the performance of the Frank's proximity algorithm in C or in Java is basically *identical*. No kidding!
>
> My best regards,
>
> Ivan
>
>
>>??-------Original Message-------
>>??From: Ivan <ivan.lucena@pmldnet.com>
>>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>>??Sent: Nov 18 '09 16:05
>>
>>??Even,
>>
>>??I just got it to work with the new API today. That is great!
>>
>>??And just liike you said, the advantage is in usability not performance.
>>
>>??Thanks,
>>
>>??Ivan
>>
>>??>??-------Original Message-------
>>??>??From: Even Rouault <even.rouault@mines-paris.org>
>>??>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>>??>??Sent: Nov 14 '09 17:32
>>??>
>>??>??Selon Ivan <ivan.lucena@pmldnet.com>:
>>??>
>>??>??I've commited new API that adds ReadRaster() and WriteRaster() methods that use
>>??>??the regular Java arrays (byte[], short[], int[], float[], double[]). See
>>??>??http://gdal.org/java
>>??>
>>??>??On my PC,
>>??>??http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/java/apps/GDALTestIO.java
>>??>??runs in about 20.3s for the ReadRaster()/WriteRaster() case, and in about 24.7s
>>??>??for the ReadRaster_Direct()/WriteRaster_Direct() case. Not a big advantage
>>??>??(which tends to not any advantage at all when run with the -server flag, as both
>>??>??run in about 21.3 s !), but regular Java arrays are a bit easier to use than
>>??>??ByteBuffer (especially that with Sun JVM 1.6, the array() method on ByteBuffer
>>??>??is not implemented).
>>??>
>>??>??> Even,
>>??>??>
>>??>??> You are right. The point is how to take full advantage of the GDAL Java API
>>??>??> choosing the right
>>??>??> approach to deal with the raster buffer on the client side.
>>??>??>
>>??>??> Best regards,
>>??>??>
>>??>??> Ivan
>>??>??>
>>??>??> Even Rouault wrote:
>>??>??> > Selon Ivan <ivan.lucena@pmldnet.com>:
>>??>??> >
>>??>??> > Ivan,
>>??>??> >
>>??>??> > I'm not sure what you are really measuring if you compare a C++ code versus
>>??>??> its
>>??>??> > translation to Java code. I think it just reflects the known slowdown of
>>??>??> Java
>>??>??> > when doing intensive computations in comparison to native code. The 0.2
>>??>??> second
>>??>??> > difference between the regular array version and the ByteBuffer one is the
>>??>??> > interesting result, not the 1.2/1.0 second difference between C++ and Java.
>>??>??> >
>>??>??> >> Caio Simone,
>>??>??> >>
>>??>??> >> I just downloaded imageio-ext to check how it does that but it looks like
>>??>??> I
>>??>??> >> don't need to do that now, I can take you report instead. Thank you very
>>??>??> >> much. I will take a look on array pinning for a start.
>>??>??> >>
>>??>??> >> I translated the GDAL Proximity [1] code to Java and I timed both of then
>>??>??> >> with the same input, a 1024x1024 byte image with just one pixel as feature
>>??>??> at
>>??>??> >> the center of the image.
>>??>??> >>
>>??>??> >> It took 0.3 seconds in C++ and 1.5 seconds in Java!
>>??>??> >>
>>??>??> >> I then translated the buffers to regular arrays and it went down a little
>>??>??> >> bit, 1.3 seconds.
>>??>??> >>
>>??>??> >> It is still a big disadvantage. I believe that the buffer-to-buffer
>>??>??> >> translation is the guilt time waster in that case.
>>??>??> >>
>>??>??> >> [1] http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdalproximity.cpp
>>??>??> >>
>>??>??> >> My best regards,
>>??>??> >>
>>??>??> >> Ivan
>>??>??> >>
>>??>??> >>>??-------Original Message-------
>>??>??> >>>??From: Simone Giannecchini <simone.giannecchini@geo-solutions.it>
>>??>??> >>>??Subject: Re: [gdal-dev] Re: JAVA API - Performance
>>??>??> >>>??Sent: Nov 10 '09 12:36
>>??>??> >>>
>>??>??> >>>??Ciao Even,
>>??>??> >>>??just wanted to add my 2 cents.
>>??>??> >>>
>>??>??> >>>??As you know for the imageio-ext project we have been using the
>>??>??> >>>??GDAL-JNI bindings (actually a modified version of them) for a while in
>>??>??> >>>??order to allow Java users to leverage on GDAL using the ImageIO
>>??>??> >>>??framework which standard in Java.
>>??>??> >>>??This way we also enabled GeoTools and GeoServer to use GDAL as a
>>??>??> >> datasource.
>>??>??> >>>??In the past I have done quite some performance tests to add some
>>??>??> >>>??new/different methods to them and I can summarise our findings as
>>??>??> >>>??follows:
>>??>??> >>>
>>??>??> >>>??- DirectByteBuffer vs regular arrays -
>>??>??> >>>??DBB is expensive to allocate but prevent the VM from performing copies
>>??>??> >>>??when having to move data to and from java and native code since they
>>??>??> >>>??live on the native space not on the java heap; On the other side the
>>??>??> >>>??regular arrays are fast to allocate but they are "usually" copied when
>>??>??> >>>??moved across from/to java and native code since the JVM cannot leave
>>??>??> >>>??the native code mess with the java heap space since the garbage
>>??>??> >>>??collector would not be very happy about that. I said "usually" since
>>??>??> >>>??there is a technique called array pinning that we can suggest the JVM
>>??>??> >>>??to use to avoid the copy of regular array; however this mechanism is
>>??>??> >>>??not guaranteed to be implemented and/or to work on each call (same
>>??>??> >>>??reason as above, GC is not happy about this technique).
>>??>??> >>>
>>??>??> >>>??If you can pool the DBB??and/or use a few large DBB, where the cost of
>>??>??> >>>??the copy would overcome the cost of its creation then DBB are much
>>??>??> >>>??better than regular arrays. As an instance I noticed that using when
>>??>??> >>>??reading striped tiff files regular arrays where faster, but as the
>>??>??> >>>??tile size increases (and therefore the cost of a copy overcomes the
>>??>??> >>>??cost of a DBB creation) the DBB performs much better
>>??>??> >>>
>>??>??> >>>??- DirectByteBuffer and the impact on some JVM -
>>??>??> >>>??Now in the past we decided to stick with DBB and give
>>??>??> >>>??GeoServer/GeoTools users the capability to retile data on the fly.
>>??>??> >>>??However lately, during the WMS performance shootout we noticed on some
>>??>??> >>>??linux machines JVm soldi crashed, not nice (means restarting the
>>??>??> >>>??GeoServer!!!).
>>??>??> >>>??We investigated a bit in depth and the problem was that somehow the
>>??>??> >>>??JVM was failing to allocate some internal images during the rendering
>>??>??> >>>??process and then dying with a NullPointerException (apparently the SUN
>>??>??> >>>??Java2D engineers did not use to check for out of memory errors in the
>>??>??> >>>??java native space). Well, what happens is that if you use too much of
>>??>??> >>>??the Java native space for your own objects, it is likely that the JVM
>>??>??> >>>??itself will start to malfunction (you can find articles on the web on
>>??>??> >>>??the memory model of a Java process, I don't think I am good enough to
>>??>??> >>>??explain it ) since it cannot allocate its own objects.
>>??>??> >>>
>>??>??> >>>??In the end we decide to leave DBB and go back to regular arrays with
>>??>??> >>>??array pinning. This ensured us robustness and we did not see much
>>??>??> >>>??performance degradation (which means that array pinning in the end
>>??>??> >>>??works). This has been implemented by modifying the SWIG bindings for
>>??>??> >>>??GDAL in order to use a byte array instead of a DBB and then use
>>??>??> >>>??ByteArray utils to convert between different native type (short, int,
>>??>??> >>>??etc..).
>>??>??> >>>
>>??>??> >>>??- Conclusion -
>>??>??> >>>??We might want to spend some time in the mid term to contribute some of
>>??>??> >>>??this work back (or probably provide funding), but anyway, it would be
>>??>??> >>>??great to have the capability to switch between DBB and regular arrays
>>??>??> >>>??since both have flaws.
>>??>??> >>>??However atm if I were asked I would say to go with regular arrays as
>>??>??> >>>??we do in the imageio-ext project.
>>??>??> >>>
>>??>??> >>>??Ciao,
>>??>??> >>>??Simone.
>>??>??> >>>??-------------------------------------------------------
>>??>??> >>>??Ing. Simone Giannecchini
>>??>??> >>>??GeoSolutions S.A.S.
>>??>??> >>>??Founder - Software Engineer
>>??>??> >>>??Via Carignoni 51
>>??>??> >>>??55041??Camaiore (LU)
>>??>??> >>>??Italy
>>??>??> >>>
>>??>??> >>>??phone: +39 0584983027
>>??>??> >>>??fax:??????+39 0584983027
>>??>??> >>>??mob:????+39 333 8128928
>>??>??> >>>
>>??>??> >>>
>>??>??> >>>??http://www.geo-solutions.it
>>??>??> >>>??http://geo-solutions.blogspot.com/
>>??>??> >>>??http://simboss.blogspot.com/
>>??>??> >>>??http://www.linkedin.com/in/simonegiannecchini
>>??>??> >>>
>>??>??> >>>??-------------------------------------------------------
>>??>??> >>>
>>??>??> >>>
>>??>??> >>>
>>??>??> >>>??On Tue, Nov 10, 2009 at 12:00 PM, Even Rouault
>>??>??> >>>??<even.rouault@mines-paris.org> wrote:
>>??>??> >>>??> Selon Ivan <ivan.lucena@pmldnet.com>:
>>??>??> >>>??>
>>??>??> >>>??> Ivan,
>>??>??> >>>??>
>>??>??> >>>??> thanks for your testing (CC'ing the list as it is of general
>>??>??> interest).
>>??>??> >>>??> Actually, I also read on some sites that using ByteBuffer object
>>??>??> versus
>>??>??> >> regular
>>??>??> >>>??> Java arrays is not always a win. Plus the fact that we must use a
>>??>??> direct
>>??>??> >> buffer
>>??>??> >>>??> that has an extra allocation cost according to the Javadoc. So
>>??>??> >> ByteBuffer might
>>??>??> >>>??> be interesting if you just want to pass big arrays between native
>>??>??> code,
>>??>??> >> for
>>??>??> >>>??> example if you read an array from a dataset and then write it to
>>??>??> another
>>??>??> >> one
>>??>??> >>>??> without accessing it from the Java side. When you mention that
>>??>??> accessing
>>??>??> >> through
>>??>??> >>>??> the byte[] array was faster, did you get it with the array() method
>>??>??> >> instead ?
>>??>??> >>>??> I'm wondering what the performance overhead of this call is.
>>??>??> >>>??>
>>??>??> >>>??> As ByteBuffer is not at all a requirement for the interface with the
>>??>??> >> native
>>??>??> >>>??> code, it would be technically possible to add an alternative API that
>>??>??> >> would use
>>??>??> >>>??> the regular Java array types.
>>??>??> >>>??>
>>??>??> >>>??> Would you mind opening an enhancement ticket about that ? Thanks
>>??>??> >>>??>
>>??>??> >>>??> Even
>>??>??> >>>??>
>>??>??> >>>??>> Even,
>>??>??> >>>??>>
>>??>??> >>>??>> I did some test with the GDAL Java API and some simple raster
>>??>??> >> operations
>>??>??> >>>??>> like the GDAL Proximity algorthm and I noticed that the performance
>>??>??> >> while
>>??>??> >>>??>> accessing pixels with <type>Buffer.get(i), <type>Buffer.put(i,value)
>>??>??> is
>>??>??> >> not
>>??>??> >>>??>> as good as if you copy then to (or from) a "regular" array, like
>>??>??> >> float[],
>>??>??> >>>??>> double[], integer[] and byte[].
>>??>??> >>>??>>
>>??>??> >>>??>> The reason for that is obvious, get() and put() are funtion calls and
>>??>??> >>>??>> contains a lot of code for range check.
>>??>??> >>>??>>
>>??>??> >>>??>> If I understand it correctly, ByteBuffer is the ideal or maybe the
>>??>??> only
>>??>??> >>>??>> way to get access to Buffers from C libraries thought a Java wrapper.
>>??>??> >> But
>>??>??> >>>??>> do you it would be possible to incapsulate the buffer conversion at
>>??>??> the
>>??>??> >>>??>> wrapper code so that users would be able to read and write direct to
>>??>??> >>>??>> regular Java arrays?
>>??>??> >>>??>>
>>??>??> >>>??>> Just a suggestion,
>>??>??> >>>??>>
>>??>??> >>>??>> Ivan
>>??>??> >>>??>>
>>??>??> >>>??>
>>??>??> >>>??>
>>??>??> >>>??> _______________________________________________
>>??>??> >>>??> gdal-dev mailing list
>>??>??> >>>??> gdal-dev@lists.osgeo.org
>>??>??> >>>??> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>??>??> >>>??>
>>??>??> >>>
>>??>??> >
>>??>??> >
>>??>??> >
>>??>??>
>>??>??>
>>??>
>>??>
>>??>
>>??_______________________________________________
>>??gdal-dev mailing list
>>??gdal-dev@lists.osgeo.org
>>??http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From jukka.rahkonen at mmmtike.fi  Fri Nov 20 05:18:16 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri Nov 20 12:28:37 2009
Subject: [gdal-dev] Re: Is epsg text file read at all when re-projecting
	with	FWTools?
References: <loom.20091118T144630-774@post.gmane.org>
	<4B040F96.6070400@pobox.com>
	<CC197224AC75CE4DB23F739B16891B86E3453B@tikka.haapa.mmm.fi>
	<4B041E31.2020609@pobox.com>
Message-ID: <loom.20091120T110551-155@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

 > Both my codes, 2393 and 3067 are included in pcs.csv thus I believe I must
> > edit pcs.override.csv.
> 
> Essentially yes.
> 

I was fiddling with pcs.csv, gcs.csv and corresponding override files in and
managed to get the system into such state that piecewise reprojecting from
epsg:2393 to 3067 by making a temporary epsg:4326 version in between gives
correct result, while direct reprojecting from 2393->3067 gives a different and
faulty result. My conclusion is to forget the csv files and continue to use
+proj strings for giving projections to ogr2ogr. It is not handy but it is
reliable and I know for sure what is going to happen.

-Jukka-



From tasmith3 at rockwellcollins.com  Fri Nov 20 11:10:54 2009
From: tasmith3 at rockwellcollins.com (tasmith3@rockwellcollins.com)
Date: Fri Nov 20 12:28:50 2009
Subject: [gdal-dev] Reading the data 'backwards'
Message-ID: <OF767E3481.45627362-ON87257674.00578A01-87257674.0058E3E3@rockwellcollins.com>

I work with code that handles data in a particular way.  Instead of using 
the top-left corner as the origin, it uses the bottom left.  It treats the 
data as if it's sitting in quadrant 1 on an X-Y plane with the bottom left 
corner sitting on the origin.  The code expects me to read in the data 
from the file starting with the 'first' row (the bottom row) to the top 
row (the 'last' row) from left to right.  If my image has n rows and m 
columns, could I do something like this...?

RasterIO( GF_Read, 0, n, m, n, ...)

and would GDAL be smart enough to know that since I'm placing my origin at 
the bottom left corner, it needs to read backwards or 'up' the image?  If 
it can't, that's ok - I'll just have to do some post processing on the 
output buffer after the read.  Changing the code around so it treats the 
top left corner as the origin isn't an option.  I don't have that kind of 
authority and it'd be a massive change.

Thanks,

Todd
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091120/d362b39a/attachment.html
From even.rouault at mines-paris.org  Fri Nov 20 13:29:30 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Nov 20 13:29:37 2009
Subject: [gdal-dev] Reading the data 'backwards'
In-Reply-To: <OF767E3481.45627362-ON87257674.00578A01-87257674.0058E3E3@rockwellcollins.com>
References: <OF767E3481.45627362-ON87257674.00578A01-87257674.0058E3E3@rockwellcollins.com>
Message-ID: <4B06E00A.7040905@mines-paris.org>

tasmith3@rockwellcollins.com a ?crit :

Sometimes, it is desirable for GDAL not try to be too smart ;-)

However I think you can achieve what you want if you provide the buffer 
with the right offset and a negative nLineSpace parameter. Something 
like that (untested !) :

void* pBuffer = malloc(width * height);
poBand->RasterIO(GF_Read, 0, 0, width, height, pBuffer + width * (height 
- 1), width, height, GDT_Byte, 1, -width)

>
> I work with code that handles data in a particular way.  Instead of 
> using the top-left corner as the origin, it uses the bottom left.  It 
> treats the data as if it's sitting in quadrant 1 on an X-Y plane with 
> the bottom left corner sitting on the origin.  The code expects me to 
> read in the data from the file starting with the 'first' row (the 
> bottom row) to the top row (the 'last' row) from left to right.  If my 
> image has n rows and m columns, could I do something like this...?
>
> RasterIO( GF_Read, 0, n, m, n, ...)
>
> and would GDAL be smart enough to know that since I'm placing my 
> origin at the bottom left corner, it needs to read backwards or 'up' 
> the image?  If it can't, that's ok - I'll just have to do some post 
> processing on the output buffer after the read.  Changing the code 
> around so it treats the top left corner as the origin isn't an option. 
>  I don't have that kind of authority and it'd be a massive change.
>
> Thanks,
>
> Todd
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Fri Nov 20 13:46:23 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Nov 20 13:46:30 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <961f4d9e0911200354v5294bb46ye9ddc959b3ffa918@mail.gmail.com>
References: <20091109233607.2877.qmail@s466.sureserver.com>	
	<1257850818.4af947c20752a@imp.free.fr>	
	<961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>	
	<1257939206.4afaa106743c6@imp.free.fr>
	<961f4d9e0911200354v5294bb46ye9ddc959b3ffa918@mail.gmail.com>
Message-ID: <4B06E3FF.7050503@mines-paris.org>

Hi Simone,

Simone Giannecchini a ?crit :
>> I've tried GetPrimitiveArrayCritical() / ReleasePrimitiveArrayCritical() and
>> I've observed they return non-copy pointers, which make them good candidates.
>> Looking at
>> http://java.sun.com/j2se/1.3/docs/guide/jni/jni-12.html#GetPrimitiveArrayCritical,
>> it appears that there are restrictions to use them. But this is probably OK as
>> we don't callback Java code in the RasterIO operations. But I'm not sure if the
>> native operation can be considered to be fast enough to use those primitives. It
>> depends on the query size and the driver. Perhaps it is not worth the risk and
>> that the copy made by the JVM when calling GetByteArrayElements() is not that
>> significant for modest size arrays.
>
> I decide not to take the risk. The problem with that call is that It
> should block the GarbageCollector and this is highly counterproductive
> in server side application (you tend to prefer less pause times more
> often than  a long pause time once ia while).
>
>   

I didn't use it finally. Just regular 
Get(Byte|Short|Int|Float|Double)ArrayElements functions.

>> Another possibility is that in the ReadRaster() case, we don't care about the
>> initial values of the array. We just want to update it in fact, so we could
>> allocate a working buffer in the JNI code, call the native RasterIO() on it and
>> upload its content into the Java array with SetByteArrayRegion(). This would
>> save one copy.
>>     
>
> For the reasons I said in my previous email I would refrain from
> allocating raster data inside the native code, the JVM seems to not
> like that too much.
> Moreover, the Java flag to control the native memory space is prefixed
> XX which means that it might stop orking with no notice in a newer
> java release.
> I guess that the best thing, IMHO, is to stick with pinning and hope
> for the best, however, it might be interesting to do kind of a testing
> session having the geoserver hitting the gdal code for something like
> ECW and see what happens with the different options in term of
> stability/performance/robustness, what do you think?
>
>   
I did use the temporary allocation of a buffer before calling RasterIO() 
and then updating the Java array with
SetByteArrayRegion(). I'm not sure why the JVM wouldn't like that. It 
doesn't have to deal with memory
allocations done by third-party code and I'm working daily with a Java 
app that uses native DLLs that allocates
big amount of memory without any problems. If a JVM doesn't like that, I 
would consider it to be seriously broken
(that would imply that GDAL can't do its own memory allocations either 
and it must allocate temporary buffers for its
block cache for example...). However if you observe that it is a 
problem, you could try changing the typemaps to use
the regular array pinning (it's the /* %typemap(in, numinputs=1) (ctype 
*regularArrayOut, long nRegularArraySizeOut)  */
around line 1400 in swig/include/java/typemaps_java.i) to see if it 
changes things.

I'd be happy to hear about the results of your tests with Geoserver.

Even

From tasmith3 at rockwellcollins.com  Fri Nov 20 18:38:09 2009
From: tasmith3 at rockwellcollins.com (tasmith3@rockwellcollins.com)
Date: Fri Nov 20 18:38:15 2009
Subject: [gdal-dev] Reading the data 'backwards'
In-Reply-To: <4B06E00A.7040905@mines-paris.org>
Message-ID: <OFB9D58704.8EE01AF1-ON87257674.008195B4-87257674.0081D63B@rockwellcollins.com>

I tried your suggestion of using a modified buffer offset and a negative 
nLineSpace parameter, and it worked!  Very clever and well done!

Thanks,

Todd
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091120/dd39d2e8/attachment.html
From williams at csr.utexas.edu  Fri Nov 20 18:08:57 2009
From: williams at csr.utexas.edu (Steve Williams)
Date: Fri Nov 20 18:45:06 2009
Subject: [gdal-dev] /usr/lib/libexpat.so: could not read symbols: File in
	wrong format
Message-ID: <4B072189.5090006@csr.utexas.edu>

I am trying to compile gdal as per the instructions of the developer of 
specialized remote sensing software called gamma 
(http://www.gamma-rs.ch/).  The platform is a Dell T410 dual Xeon 
processor system with 8GB of memory, running Redhat Enterprise Linux 
(RHEL 5.4 x86_64).  The configure goes smoothly, but on the make I am 
getting the error on the subject line and the make fails.  The configure 
instructions are very specific from gamma:

./configure --without-python --without-php --without-ruby --without-perl 
--without-jasper \
--without-curl --without-odbc --with-png=internal 
--with-libtiff=internal --with-libgeotiff=internal \
--with-jpeg=internal --with-sqlite=no --with-libz=internal 
--without-cfitsio --with-gif=internal --without-netcdf \
--without-pg --without-hdf4 --without-hdf5 --without-geos  
--enable-shared --prefix=/usr/local/gdal

the last few lines on the failed make are:

make[1]: Entering directory `/usr/local/src/gdal-1.5.4'
/bin/sh /usr/local/src/gdal-1.5.4/libtool --mode=link   g++   
-I/usr/include -lsqlite3 -L/usr/lib -lexpat  -lm -lrt -ldl      -o 
libgdal.la /usr/local/src/gdal-1.5.4/frmts/o/*.lo 
/usr/local/src/gdal-1.5.4/gcore/*.lo /usr/local/src/gdal-1.5.4/port/*.lo 
/usr/local/src/gdal-1.5.4/alg/*.lo 
/usr/local/src/gdal-1.5.4/ogr/ogrsf_frmts/o/*.lo 
./ogr/ogrgeometryfactory.lo ./ogr/ogrpoint.lo ./ogr/ogrcurve.lo 
./ogr/ogrlinestring.lo ./ogr/ogrlinearring.lo ./ogr/ogrpolygon.lo 
./ogr/ogrutils.lo ./ogr/ogrgeometry.lo ./ogr/ogrgeometrycollection.lo 
./ogr/ogrmultipolygon.lo ./ogr/ogrsurface.lo ./ogr/ogrmultipoint.lo 
./ogr/ogrmultilinestring.lo ./ogr/ogr_api.lo ./ogr/ogrfeature.lo 
./ogr/ogrfeaturedefn.lo ./ogr/ogrfeaturequery.lo 
./ogr/ogrfeaturestyle.lo ./ogr/ogrfielddefn.lo 
./ogr/ogrspatialreference.lo ./ogr/ogr_srsnode.lo ./ogr/ogr_srs_proj4.lo 
./ogr/ogr_fromepsg.lo ./ogr/ogrct.lo ./ogr/ogr_opt.lo 
./ogr/ogr_srs_esri.lo ./ogr/ogr_srs_pci.lo ./ogr/ogr_srs_usgs.lo 
./ogr/ogr_srs_dict.lo ./ogr/ogr_srs_panorama.lo ./ogr/ogr_srs_erm.lo 
./ogr/swq.lo ./ogr/ogr_srs_validate.lo ./ogr/ogr_srs_xml.lo 
./ogr/ograssemblepolygon.lo ./ogr/ogr2gmlgeometry.lo 
./ogr/gml2ogrgeometry.lo \
            -rpath /usr/local/gdal/lib \
            -no-undefined \
            -version-info 13:4:12
libtool: link: rm -fr  .libs/libgdal.la.lnkscript
libtool: link: creating GNU ld script: .libs/libgdal.la.lnkscript
libtool: link: g++ -shared -nostdlib 
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crti.o 
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtbeginS.o 
.libs/libgdal.la.lnkscript  -lsqlite3 -L/usr/lib /usr/lib/libexpat.so 
-lrt -ldl -L/usr/lib/gcc/x86_64-redhat-linux/4.1.2 
-L/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64 
-L/lib/../lib64 -L/usr/lib/../lib64 -lstdc++ -lm -lc -lgcc_s 
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtendS.o 
/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crtn.o    
-Wl,-soname -Wl,libgdal.so.1 -o .libs/libgdal.so.1.12.4
/usr/lib/libexpat.so: could not read symbols: File in wrong format
collect2: ld returned 1 exit status
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/usr/local/src/gdal-1.5.4'
make: *** [check-lib] Error 2

anybody seen this before or have a suggested fix?

-- 


                     '''
                    (O O)
 ,-------------- oOO-(_)-OOo -------------,
 |            Stephen Williams            |
 |      Manager of Computer Services      |
 |       Center for Space Research        |
 |     University of Texas at Austin      |
 |     3925 W. Braker Ln., Suite 200      |
 |          Austin, TX 78759-5321         |
 |    512.471.7235  512.471.3570 (fax)    |
 |       williams@csr.utexas.edu          |
 |____________________ Oooo ______________|
                oooO   (   )
               (   )    ) /
                \ (    (_/
                 \_) 





From ksshannon at gmail.com  Fri Nov 20 18:55:16 2009
From: ksshannon at gmail.com (Kyle Shannon)
Date: Fri Nov 20 18:55:37 2009
Subject: [gdal-dev] /usr/lib/libexpat.so: could not read symbols: File in 
	wrong format
In-Reply-To: <4B072189.5090006@csr.utexas.edu>
References: <4B072189.5090006@csr.utexas.edu>
Message-ID: <c28f2e140911201555v27dff5c0k286648bc9c8d4de2@mail.gmail.com>

As Even wrote to me some time ago:

My guess is that /usr/lib/libexpat.so is a 32bit library. Maybe there's
a /usr/lib64/libexpat.so on your system ? I'm not sure of the filesystem
layout of RedHat's 64bit systems.

If that's the case, use the --with-expat-lib= option of the configure
script.

and I used --with-expat-lib=/usr/lib64 for the option.

# ===================
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)646-6577
kshannon@fs.fed.us
ksshannon@gmail.com
# ===================


On Fri, Nov 20, 2009 at 4:08 PM, Steve Williams <williams@csr.utexas.edu>wrote:

> I am trying to compile gdal as per the instructions of the developer of
> specialized remote sensing software called gamma (http://www.gamma-rs.ch/).
>  The platform is a Dell T410 dual Xeon processor system with 8GB of memory,
> running Redhat Enterprise Linux (RHEL 5.4 x86_64).  The configure goes
> smoothly, but on the make I am getting the error on the subject line and the
> make fails.  The configure instructions are very specific from gamma:
>
> ./configure --without-python --without-php --without-ruby --without-perl
> --without-jasper \
> --without-curl --without-odbc --with-png=internal --with-libtiff=internal
> --with-libgeotiff=internal \
> --with-jpeg=internal --with-sqlite=no --with-libz=internal
> --without-cfitsio --with-gif=internal --without-netcdf \
> --without-pg --without-hdf4 --without-hdf5 --without-geos  --enable-shared
> --prefix=/usr/local/gdal
>
> the last few lines on the failed make are:
>
> make[1]: Entering directory `/usr/local/src/gdal-1.5.4'
> /bin/sh /usr/local/src/gdal-1.5.4/libtool --mode=link   g++
> -I/usr/include -lsqlite3 -L/usr/lib -lexpat  -lm -lrt -ldl      -o
> libgdal.la /usr/local/src/gdal-1.5.4/frmts/o/*.lo
> /usr/local/src/gdal-1.5.4/gcore/*.lo /usr/local/src/gdal-1.5.4/port/*.lo
> /usr/local/src/gdal-1.5.4/alg/*.lo
> /usr/local/src/gdal-1.5.4/ogr/ogrsf_frmts/o/*.lo ./ogr/ogrgeometryfactory.lo
> ./ogr/ogrpoint.lo ./ogr/ogrcurve.lo ./ogr/ogrlinestring.lo
> ./ogr/ogrlinearring.lo ./ogr/ogrpolygon.lo ./ogr/ogrutils.lo
> ./ogr/ogrgeometry.lo ./ogr/ogrgeometrycollection.lo ./ogr/ogrmultipolygon.lo
> ./ogr/ogrsurface.lo ./ogr/ogrmultipoint.lo ./ogr/ogrmultilinestring.lo
> ./ogr/ogr_api.lo ./ogr/ogrfeature.lo ./ogr/ogrfeaturedefn.lo
> ./ogr/ogrfeaturequery.lo ./ogr/ogrfeaturestyle.lo ./ogr/ogrfielddefn.lo
> ./ogr/ogrspatialreference.lo ./ogr/ogr_srsnode.lo ./ogr/ogr_srs_proj4.lo
> ./ogr/ogr_fromepsg.lo ./ogr/ogrct.lo ./ogr/ogr_opt.lo ./ogr/ogr_srs_esri.lo
> ./ogr/ogr_srs_pci.lo ./ogr/ogr_srs_usgs.lo ./ogr/ogr_srs_dict.lo
> ./ogr/ogr_srs_panorama.lo ./ogr/ogr_srs_erm.lo ./ogr/swq.lo
> ./ogr/ogr_srs_validate.lo ./ogr/ogr_srs_xml.lo ./ogr/ograssemblepolygon.lo
> ./ogr/ogr2gmlgeometry.lo ./ogr/gml2ogrgeometry.lo \
>           -rpath /usr/local/gdal/lib \
>           -no-undefined \
>           -version-info 13:4:12
> libtool: link: rm -fr  .libs/libgdal.la.lnkscript
> libtool: link: creating GNU ld script: .libs/libgdal.la.lnkscript
> libtool: link: g++ -shared -nostdlib
> /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crti.o
> /usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtbeginS.o
> .libs/libgdal.la.lnkscript  -lsqlite3 -L/usr/lib /usr/lib/libexpat.so -lrt
> -ldl -L/usr/lib/gcc/x86_64-redhat-linux/4.1.2
> -L/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64 -L/lib/../lib64
> -L/usr/lib/../lib64 -lstdc++ -lm -lc -lgcc_s
> /usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtendS.o
> /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crtn.o
>  -Wl,-soname -Wl,libgdal.so.1 -o .libs/libgdal.so.1.12.4
> /usr/lib/libexpat.so: could not read symbols: File in wrong format
> collect2: ld returned 1 exit status
> make[1]: *** [libgdal.la] Error 1
> make[1]: Leaving directory `/usr/local/src/gdal-1.5.4'
> make: *** [check-lib] Error 2
>
> anybody seen this before or have a suggested fix?
>
> --
>
>
>                    '''
>                   (O O)
> ,-------------- oOO-(_)-OOo -------------,
> |            Stephen Williams            |
> |      Manager of Computer Services      |
> |       Center for Space Research        |
> |     University of Texas at Austin      |
> |     3925 W. Braker Ln., Suite 200      |
> |          Austin, TX 78759-5321         |
> |    512.471.7235  512.471.3570 (fax)    |
> |       williams@csr.utexas.edu          |
> |____________________ Oooo ______________|
>               oooO   (   )
>              (   )    ) /
>               \ (    (_/
>                \_)
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091120/23fe7ba2/attachment-0001.html
From matt.wilkie at gov.yk.ca  Fri Nov 20 19:31:28 2009
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Fri Nov 20 19:31:35 2009
Subject: [gdal-dev] Reading compressed GZIP files
In-Reply-To: <4FD125153A070D45BC87645D3B8802881EFDC59C@IMCMBX3.MITRE.ORG>
References: <4FD125153A070D45BC87645D3B8802881EFDC59C@IMCMBX3.MITRE.ORG>
Message-ID: <4B0734E0.3020306@gov.yk.ca>

> As a side note, I?m sure this has come up before, but I couldn?t find a 
> search engine to for the entire e-mail archives.  Am I just missing it?

Mail archive is nice and speedy, not sure of it's reach: 
http://www.mail-archive.com/gdal-dev@lists.osgeo.org/maillist.html

Nabble goes back to 2005-May-27, http://n2.nabble.com/GDAL-Dev-f2022644.html

Gmane is more complete, reaching back to 2003-Jun-05, 
http://dir.gmane.org/gmane.comp.gis.gdal.devel


cheers,

-matt
From williams at csr.utexas.edu  Fri Nov 20 20:56:00 2009
From: williams at csr.utexas.edu (Stephen Williams)
Date: Fri Nov 20 20:56:08 2009
Subject: [gdal-dev] /usr/lib/libexpat.so: could not read symbols: File
	in 	wrong format
In-Reply-To: <c28f2e140911201555v27dff5c0k286648bc9c8d4de2@mail.gmail.com>
References: <4B072189.5090006@csr.utexas.edu>
	<c28f2e140911201555v27dff5c0k286648bc9c8d4de2@mail.gmail.com>
Message-ID: <4B0748B0.40203@csr.utexas.edu>

yep, you are right.  which is what i thought too and did the same thing 
you suggested.  unfortunately the same thing happens.  same error at the 
same location during make.

Kyle Shannon wrote:
> As Even wrote to me some time ago:
>
>     My guess is that /usr/lib/libexpat.so is a 32bit library. Maybe
>     there's
>     a /usr/lib64/libexpat.so on your system ? I'm not sure of the
>     filesystem
>     layout of RedHat's 64bit systems.
>
>     If that's the case, use the --with-expat-lib= option of the
>     configure script.
>
> and I used --with-expat-lib=/usr/lib64 for the option.
>
> # ===================
> Kyle Shannon
> Physical Science Technician
> RMRS Fire Sciences Lab
> Fire, Fuels & Smoke - RWU 4405
> 5775 Highway 10 W.
> Missoula, MT 59808
> (406)646-6577
> kshannon@fs.fed.us <mailto:kshannon@fs.fed.us>
> ksshannon@gmail.com <mailto:ksshannon@gmail.com>
> # ===================
>
>
> On Fri, Nov 20, 2009 at 4:08 PM, Steve Williams 
> <williams@csr.utexas.edu <mailto:williams@csr.utexas.edu>> wrote:
>
>     I am trying to compile gdal as per the instructions of the
>     developer of specialized remote sensing software called gamma
>     (http://www.gamma-rs.ch/).  The platform is a Dell T410 dual Xeon
>     processor system with 8GB of memory, running Redhat Enterprise
>     Linux (RHEL 5.4 x86_64).  The configure goes smoothly, but on the
>     make I am getting the error on the subject line and the make
>     fails.  The configure instructions are very specific from gamma:
>
>     ./configure --without-python --without-php --without-ruby
>     --without-perl --without-jasper \
>     --without-curl --without-odbc --with-png=internal
>     --with-libtiff=internal --with-libgeotiff=internal \
>     --with-jpeg=internal --with-sqlite=no --with-libz=internal
>     --without-cfitsio --with-gif=internal --without-netcdf \
>     --without-pg --without-hdf4 --without-hdf5 --without-geos
>      --enable-shared --prefix=/usr/local/gdal
>
>     the last few lines on the failed make are:
>
>     make[1]: Entering directory `/usr/local/src/gdal-1.5.4'
>     /bin/sh /usr/local/src/gdal-1.5.4/libtool --mode=link   g++  
>     -I/usr/include -lsqlite3 -L/usr/lib -lexpat  -lm -lrt -ldl      -o
>     libgdal.la <http://libgdal.la>
>     /usr/local/src/gdal-1.5.4/frmts/o/*.lo
>     /usr/local/src/gdal-1.5.4/gcore/*.lo
>     /usr/local/src/gdal-1.5.4/port/*.lo
>     /usr/local/src/gdal-1.5.4/alg/*.lo
>     /usr/local/src/gdal-1.5.4/ogr/ogrsf_frmts/o/*.lo
>     ./ogr/ogrgeometryfactory.lo ./ogr/ogrpoint.lo ./ogr/ogrcurve.lo
>     ./ogr/ogrlinestring.lo ./ogr/ogrlinearring.lo ./ogr/ogrpolygon.lo
>     ./ogr/ogrutils.lo ./ogr/ogrgeometry.lo
>     ./ogr/ogrgeometrycollection.lo ./ogr/ogrmultipolygon.lo
>     ./ogr/ogrsurface.lo ./ogr/ogrmultipoint.lo
>     ./ogr/ogrmultilinestring.lo ./ogr/ogr_api.lo ./ogr/ogrfeature.lo
>     ./ogr/ogrfeaturedefn.lo ./ogr/ogrfeaturequery.lo
>     ./ogr/ogrfeaturestyle.lo ./ogr/ogrfielddefn.lo
>     ./ogr/ogrspatialreference.lo ./ogr/ogr_srsnode.lo
>     ./ogr/ogr_srs_proj4.lo ./ogr/ogr_fromepsg.lo ./ogr/ogrct.lo
>     ./ogr/ogr_opt.lo ./ogr/ogr_srs_esri.lo ./ogr/ogr_srs_pci.lo
>     ./ogr/ogr_srs_usgs.lo ./ogr/ogr_srs_dict.lo
>     ./ogr/ogr_srs_panorama.lo ./ogr/ogr_srs_erm.lo ./ogr/swq.lo
>     ./ogr/ogr_srs_validate.lo ./ogr/ogr_srs_xml.lo
>     ./ogr/ograssemblepolygon.lo ./ogr/ogr2gmlgeometry.lo
>     ./ogr/gml2ogrgeometry.lo \
>               -rpath /usr/local/gdal/lib \
>               -no-undefined \
>               -version-info 13:4:12
>     libtool: link: rm -fr  .libs/libgdal.la.lnkscript
>     libtool: link: creating GNU ld script: .libs/libgdal.la.lnkscript
>     libtool: link: g++ -shared -nostdlib
>     /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crti.o
>     /usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtbeginS.o
>     .libs/libgdal.la.lnkscript  -lsqlite3 -L/usr/lib
>     /usr/lib/libexpat.so -lrt -ldl
>     -L/usr/lib/gcc/x86_64-redhat-linux/4.1.2
>     -L/usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64
>     -L/lib/../lib64 -L/usr/lib/../lib64 -lstdc++ -lm -lc -lgcc_s
>     /usr/lib/gcc/x86_64-redhat-linux/4.1.2/crtendS.o
>     /usr/lib/gcc/x86_64-redhat-linux/4.1.2/../../../../lib64/crtn.o  
>      -Wl,-soname -Wl,libgdal.so.1 -o .libs/libgdal.so.1.12.4
>     /usr/lib/libexpat.so: could not read symbols: File in wrong format
>     collect2: ld returned 1 exit status
>     make[1]: *** [libgdal.la <http://libgdal.la>] Error 1
>     make[1]: Leaving directory `/usr/local/src/gdal-1.5.4'
>     make: *** [check-lib] Error 2
>
>     anybody seen this before or have a suggested fix?
>
>     -- 
>
>
>                        '''
>                       (O O)
>     ,-------------- oOO-(_)-OOo -------------,
>     |            Stephen Williams            |
>     |      Manager of Computer Services      |
>     |       Center for Space Research        |
>     |     University of Texas at Austin      |
>     |     3925 W. Braker Ln., Suite 200      |
>     |          Austin, TX 78759-5321         |
>     |    512.471.7235  512.471.3570 (fax)    |
>     |       williams@csr.utexas.edu <mailto:williams@csr.utexas.edu>  
>            |
>     |____________________ Oooo ______________|
>                   oooO   (   )
>                  (   )    ) /
>                   \ (    (_/
>                    \_)
>
>
>
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev@lists.osgeo.org <mailto:gdal-dev@lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


-- 


                     '''
                    (O O)
 ,-------------- oOO-(_)-OOo -------------,
 |            Stephen Williams            |
 |      Manager of Computer Services      |
 |       Center for Space Research        |
 |     University of Texas at Austin      |
 |     3925 W. Braker Ln., Suite 200      |
 |          Austin, TX 78759-5321         |
 |    512.471.7235  512.471.3570 (fax)    |
 |       williams@csr.utexas.edu          |
 |____________________ Oooo ______________|
                oooO   (   )
               (   )    ) /
                \ (    (_/
                 \_) 





From warmerdam at pobox.com  Fri Nov 20 21:01:30 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 20 21:01:19 2009
Subject: [gdal-dev] /usr/lib/libexpat.so: could not read symbols: File in
	wrong format
In-Reply-To: <4B072189.5090006@csr.utexas.edu>
References: <4B072189.5090006@csr.utexas.edu>
Message-ID: <4B0749FA.8040309@pobox.com>

Steve Williams wrote:
> I am trying to compile gdal as per the instructions of the developer of 
> specialized remote sensing software called gamma 
> (http://www.gamma-rs.ch/).  The platform is a Dell T410 dual Xeon 
> processor system with 8GB of memory, running Redhat Enterprise Linux 
> (RHEL 5.4 x86_64).  The configure goes smoothly, but on the make I am 
> getting the error on the subject line and the make fails.  The configure 
> instructions are very specific from gamma:
...
> -Wl,-soname -Wl,libgdal.so.1 -o .libs/libgdal.so.1.12.4
> /usr/lib/libexpat.so: could not read symbols: File in wrong format
> collect2: ld returned 1 exit status
> make[1]: *** [libgdal.la] Error 1
> make[1]: Leaving directory `/usr/local/src/gdal-1.5.4'
> make: *** [check-lib] Error 2
> 
> anybody seen this before or have a suggested fix?

Steve,

I would suggest adding --without-expat to the configure line.  I'm not what
sure is up with your /usr/lib/libexpat.so, but if you don't need it for
anything just avoid it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From williams at csr.utexas.edu  Fri Nov 20 21:23:55 2009
From: williams at csr.utexas.edu (Stephen Williams)
Date: Fri Nov 20 21:24:01 2009
Subject: [gdal-dev] /usr/lib/libexpat.so: could not read symbols: File
	in wrong format
In-Reply-To: <4B0749FA.8040309@pobox.com>
References: <4B072189.5090006@csr.utexas.edu> <4B0749FA.8040309@pobox.com>
Message-ID: <4B074F3B.2000205@csr.utexas.edu>

that is indeed one way to do it.  and it actually got the make to 
finally work.  many thanks.

i'll be checking with red hat on monday to see if there is something 
funky about libexpat libraries in 5.4.

also will be checking with the gamma software people to see if there is 
something in that library that is needed or not.

many thanks to all that replied.

Frank Warmerdam wrote:
> Steve Williams wrote:
>> I am trying to compile gdal as per the instructions of the developer 
>> of specialized remote sensing software called gamma 
>> (http://www.gamma-rs.ch/).  The platform is a Dell T410 dual Xeon 
>> processor system with 8GB of memory, running Redhat Enterprise Linux 
>> (RHEL 5.4 x86_64).  The configure goes smoothly, but on the make I am 
>> getting the error on the subject line and the make fails.  The 
>> configure instructions are very specific from gamma:
> ...
>> -Wl,-soname -Wl,libgdal.so.1 -o .libs/libgdal.so.1.12.4
>> /usr/lib/libexpat.so: could not read symbols: File in wrong format
>> collect2: ld returned 1 exit status
>> make[1]: *** [libgdal.la] Error 1
>> make[1]: Leaving directory `/usr/local/src/gdal-1.5.4'
>> make: *** [check-lib] Error 2
>>
>> anybody seen this before or have a suggested fix?
>
> Steve,
>
> I would suggest adding --without-expat to the configure line.  I'm not 
> what
> sure is up with your /usr/lib/libexpat.so, but if you don't need it for
> anything just avoid it.
>
> Best regards,


-- 


                     '''
                    (O O)
 ,-------------- oOO-(_)-OOo -------------,
 |            Stephen Williams            |
 |      Manager of Computer Services      |
 |       Center for Space Research        |
 |     University of Texas at Austin      |
 |     3925 W. Braker Ln., Suite 200      |
 |          Austin, TX 78759-5321         |
 |    512.471.7235  512.471.3570 (fax)    |
 |       williams@csr.utexas.edu          |
 |____________________ Oooo ______________|
                oooO   (   )
               (   )    ) /
                \ (    (_/
                 \_) 





From gispowerfan at gmail.com  Sun Nov 22 12:42:30 2009
From: gispowerfan at gmail.com (gispowerfan)
Date: Sun Nov 22 12:42:33 2009
Subject: [gdal-dev] driver question?
Message-ID: <200911230142271568123@gmail.com>

Hi

         I want to ask a question about how to implement the driver for gdal. Because the partner don't provide their driver source(driver A) for gdal, but we need it and we have our own drivers(driver b) for gdal. So the easy way is that we provide the source contain driver B to our partner, and out partner add their source, then compile it, give us the final dll. Now the question is that we need upate our source frequently, are there other method? is if feasible that our partner change their souce code and put the implement code into *.lib and *.dll, just interface of driver A in frmts driver source? 

Best regards

2009-11-23 



gispowerfan 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091123/aa6f4409/attachment.html
From even.rouault at mines-paris.org  Sun Nov 22 13:17:23 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Nov 22 13:17:27 2009
Subject: [gdal-dev] driver question?
In-Reply-To: <200911230142271568123@gmail.com>
References: <200911230142271568123@gmail.com>
Message-ID: <4B098033.8080505@mines-paris.org>

The best solution would be that your partner delivers to you its driver 
A compiled as a separate GDAL plugin (for example, if the driver 
shortname is FOO : gdal_FOO.dll with an entry point GDALRegister_FOO()). 
You then just have to define GDAL_DRIVER_PATH to point to the directory 
where gdal_FOO.dll is. Be careful : you and your partner must use use 
the same major GDAL version (identical X if GDAL version is 1.X.Y)  to 
compile & run against, otherwise there is a risk of C++ ABI 
incompatibility. As far as your driver B is concerned, compiling it as a 
plugin or fully integrated in your GDAL source tree is just a matter of 
conveniency.

See http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/hdf5/makefile.vc 
for an example of a makefile with a plugin target.

gispowerfan a ?crit :
> Hi
>  
>          I want to ask a question about how to implement the driver 
> for gdal. Because the partner don't provide their driver source(driver 
> A) for gdal, but we need it and we have our own drivers(driver b) for 
> gdal. So the easy way is that we provide the source contain driver B 
> to our partner, and out partner add their source, then compile it, 
> give us the final dll. Now the question is that we need upate our 
> source frequently, are there other method? is if feasible that our 
> partner change their souce code and put the implement code into *.lib 
> and *.dll, just interface of driver A in frmts driver source?
>  
> Best regards
>  
> 2009-11-23
> ------------------------------------------------------------------------
> gispowerfan
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From yilmaz.arslanoglu at gmail.com  Mon Nov 23 05:30:40 2009
From: yilmaz.arslanoglu at gmail.com (Yilmaz Arslanoglu)
Date: Mon Nov 23 05:30:42 2009
Subject: [gdal-dev] GDALFillNodata link error
Message-ID: <150158ad0911230230w3d6502ceoe46e931fe0c49312@mail.gmail.com>

Hi all;

In version 1.6.2 and 1.6.3, the usage of the function
"GDALFillNodata" gives a linker error, since "rasterfill.obj" is not
listed under OBJ
in "Makefile.vc" under "gdal\alg". However, it is listed in the
current development version ( 1.7 )

Does this mean that the function GDALFillNodata is not intended to be
used before 1.7 ?

As another question, is there a way to access somehow the iso8211
functionality ( DDFModule etc. )
via gdal library, or do we need to compile it as a seperate dll ? I
tried to build the makefile under
"gdal\frmts\iso8211" with "iso8211.dll" option, but it gives linker
errors with this option as follows:

Creating library iso8211_i.lib and object iso8211_i.exp
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_inflateEnd referenced in function "public: virtual __thiscall
VSIGZipHandle::~VSIGZipHandle(void)" (??1VSIGZipHandle@@UAE@XZ)
cpl.lib(cpl_minizip_unzip.obj) : error LNK2001: unresolved external
symbol _inflateEnd
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_inflateReset referenced in function "private: int __thiscall
VSIGZipHandle::gzrewind(void)" (?gzrewind@VSIGZipHandle@@AAEHXZ)
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_crc32 referenced in function "private: int __thiscall
VSIGZipHandle::gzrewind(void)" (?gzrewind@VSIGZipHandle@@AAEHXZ)
cpl.lib(cpl_minizip_unzip.obj) : error LNK2001: unresolved external
symbol _crc32
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_inflateCopy referenced in function "private: int __thiscall
VSIGZipHandle::gzseek(unsigned __int64,int)"
(?gzseek@VSIGZipHandle@@AAEH_KH@Z)
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_deflateInit2_ referenced in function "public: __thiscall
VSIGZipWriteHandle::VSIGZipWriteHandle(class VSIVirtualHandle *)"
(??0VSIGZipWriteHandle@@QAE@PAVVSIVirtualHandle@@@Z)
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_deflateEnd referenced in function "public: virtual int __thiscall
VSIGZipWriteHandle::Close(void)" (?Close@VSIGZipWriteHandle@@UAEHXZ)
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_deflate referenced in function "public: virtual int __thiscall
VSIGZipWriteHandle::Close(void)" (?Close@VSIGZipWriteHandle@@UAEHXZ)
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_inflate referenced in function "public: virtual unsigned int
__thiscall VSIGZipHandle::Read(void *,unsigned int,unsigned int)"
(?Read@VSIGZipHandle@@UAEIPAXII@Z)
cpl.lib(cpl_minizip_unzip.obj) : error LNK2001: unresolved external
symbol _inflate
cpl.lib(cpl_vsil_gzip.obj) : error LNK2019: unresolved external symbol
_inflateInit2_ referenced in function "public: __thiscall
VSIGZipHandle::VSIGZipHandle(class VSIVirtualHandle *,char const
*,unsigned __int64,unsigned __int64,unsigned __int64,unsigned
int,int)" (??0VSIGZipHandle@@QAE@PAVVSIVirtualHandle@@PBD_K22IH@Z)
cpl.lib(cpl_minizip_unzip.obj) : error LNK2001: unresolved external
symbol _inflateInit2_
iso8211.dll : fatal error LNK1120: 9 unresolved externals
From pfreimuth at arcor.de  Mon Nov 23 11:30:02 2009
From: pfreimuth at arcor.de (Peter Freimuth)
Date: Mon Nov 23 11:31:20 2009
Subject: [gdal-dev] problems using epsg:3785
Message-ID: <4B0AB88A.2020803@arcor.de>

Hi all,

i am struggling around with a projection problem. I want to harmonize
several hundreds of satellite images from different UTM Zones to the
Google Projection Spherical Mercator. I am using a python script which
handles the job for me using "gdalwarp" from the 1.6.1 and 1.7.0dev
release (same result).

Find attached the gdalinfo output of the original file
(gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.txt):

Upper Left  (  691500.000,-2471500.000) ( 49d 8'25.94"W, 22d20'19.37"S)
Lower Left  (  691500.000,-2496500.000) ( 49d 8'15.09"W, 22d33'52.01"S)
Upper Right (  716500.000,-2471500.000) ( 48d53'52.47"W, 22d20'8.69"S)
Lower Right (  716500.000,-2496500.000) ( 48d53'40.21"W, 22d33'41.21"S)

echo "warp giving a source epsg code"
gdalwarp -s_srs "EPSG:32622" -t_srs "EPSG:3785"
2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.pix
c:\tmp\2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_32622-pix-3785.tif
this results in
(gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_32622-pix-3785.txt)

Upper Left  (-5470299.856,-2535649.342)
Lower Left  (-5470299.856,-2563039.918)
Upper Right (-5442909.280,-2535649.342)
Lower Right (-5442909.280,-2563039.918)

echo "warp without giving a source epsg code"
gdalwarp -t_srs "EPSG:3785"
2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.pix
c:\tmp\2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_pix-3785.tif

This results in
(gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_pix-3785.txt)

Upper Left  (-5470299.856,-2551883.715)
Lower Left  (-5470299.856,-2579432.525)
Upper Right (-5442913.703,-2551883.715)
Lower Right (-5442913.703,-2579432.525)

Somehow i get big shift in the Y values of the images.

As a kind of reference i have a polygon layer in epsg:4326 stored in a
postgis 1.4.0 database table which contains the exact definitions of the
tiling grid which is used to create the satallite images.

The same shift can be reproduce in postgis when using a somehow
different epsg:3785 definition:
As you can see, there is a significant difference in the Y value.

select
astext(envelope(transform(GeomFromEWKT('SRID=4326;POLYGON((-49.1405410766602
-22.5644474029541,-49.1405410766602 -22.3357467651367,-48.8945007324219
-22.3357467651367,-48.8945007324219 -22.5644474029541,-49.1405410766602
-22.5644474029541))'::TEXT),3785)))
=>>"POLYGON((-5470300 -2579430.25,-5470300 -2551883.5,-5442911
-2551883.5,-5442911 -2579430.25,-5470300 -2579430.25))"

select
astext(envelope(transform(GeomFromEWKT('SRID=4326;POLYGON((-49.1405410766602
-22.5644474029541,-49.1405410766602 -22.3357467651367,-48.8945007324219
-22.3357467651367,-48.8945007324219 -22.5644474029541,-49.1405410766602
-22.5644474029541))'::TEXT),903785)))
=>>"POLYGON((-5470300 -2563038,-5470300 -2535649.25,-5442911
-2535649.25,-5442911 -2563038,-5470300 -2563038))"

Here are the two definitons as they are in my PostGIS spatial_ref_sys table.

"3785" as defined in postgis 1.4.0 and proj-4.7.0 epsg file
+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0
+units=m +k=1.0 +nadgrids=@null +no_defs
PROJCS["Popular Visualisation CRS / Mercator (deprecated)",
    GEOGCS["Popular Visualisation CRS",
        DATUM["Popular_Visualisation_Datum",
            SPHEROID["Popular Visualisation Sphere",6378137,0,
                AUTHORITY["EPSG","7059"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6055"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.01745329251994328,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4055"]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    AUTHORITY["EPSG","3785"],
    AXIS["X",EAST],
    AXIS["Y",NORTH]]"

I added a second definition which i took from spatialreference.org
(http://spatialreference.org/ref/epsg/3785) with the srid 903785
"903785"
+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137
+towgs84=0,0,0,0,0,0,0 +units=m +no_defs
PROJCS["Popular Visualisation CRS / Mercator",
    GEOGCS["Popular Visualisation CRS",
        DATUM["Popular_Visualisation_Datum",
            SPHEROID["Popular Visualisation Sphere",6378137,0,
                AUTHORITY["EPSG","7059"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6055"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.01745329251994328,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4055"]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    AUTHORITY["EPSG","3785"],
    AXIS["X",EAST],
    AXIS["Y",NORTH]]


Now the big questions:
Which of the above given definitions is the correct one?? So which of
the polygons is the correct result when i want epsg:3785?

How  can it be explained that gdalwarp seems to use two different
projections when warping the same file to the same output projection?

Any ideas or comments??

Thanks for any kind of help,
Peter

-- 
Peter Freimuth


-------------- next part --------------
Driver: GTiff/GeoTIFF
Files: 2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_pix-3785.tif
Size is 5051, 5081
Coordinate System is:
PROJCS["unnamed",
    GEOGCS[,
        DATUM["unknown",
            SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","3785"]]
Origin = (-5470299.855895809800000,-2551883.714705614400000)
Pixel Size = (5.421926883630149,-5.421926883630149)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-5470299.856,-2551883.715) 
Lower Left  (-5470299.856,-2579432.525) 
Upper Right (-5442913.703,-2551883.715) 
Lower Right (-5442913.703,-2579432.525) 
Center      (-5456606.780,-2565658.120) 
Band 1 Block=5051x1 Type=Byte, ColorInterp=Red
Band 2 Block=5051x1 Type=Byte, ColorInterp=Green
Band 3 Block=5051x1 Type=Byte, ColorInterp=Blue

-------------- next part --------------
Driver: GTiff/GeoTIFF
Files: 2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_32622-pix-3785.tif
Size is 5066, 5066
Coordinate System is:
PROJCS["unnamed",
    GEOGCS[,
        DATUM["unknown",
            SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","3785"]]
Origin = (-5470299.855895809800000,-2535649.341730865200000)
Pixel Size = (5.406746173490638,-5.406746173490638)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-5470299.856,-2535649.342) 
Lower Left  (-5470299.856,-2563039.918) 
Upper Right (-5442909.280,-2535649.342) 
Lower Right (-5442909.280,-2563039.918) 
Center      (-5456604.568,-2549344.630) 
Band 1 Block=5066x1 Type=Byte, ColorInterp=Red
Band 2 Block=5066x1 Type=Byte, ColorInterp=Green
Band 3 Block=5066x1 Type=Byte, ColorInterp=Blue

-------------- next part --------------
Driver: PCIDSK/PCIDSK Database File
Files: 2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.pix
Size is 5000, 5000
Coordinate System is:
PROJCS["UTM Zone 22, Northern Hemisphere",
    GEOGCS["Unknown datum based upon the WGS 84 ellipsoid",
        DATUM["Not specified (based on WGS 84 spheroid)",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-51],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (691500.000000000000000,-2471500.000000000000000)
Pixel Size = (5.000000000000000,-5.000000000000000)
Corner Coordinates:
Upper Left  (  691500.000,-2471500.000) ( 49d 8'25.94"W, 22d20'19.37"S)
Lower Left  (  691500.000,-2496500.000) ( 49d 8'15.09"W, 22d33'52.01"S)
Upper Right (  716500.000,-2471500.000) ( 48d53'52.47"W, 22d20'8.69"S)
Lower Right (  716500.000,-2496500.000) ( 48d53'40.21"W, 22d33'41.21"S)
Center      (  704000.000,-2484000.000) ( 49d 1'3.43"W, 22d27'0.49"S)
Band 1 Block=5000x1 Type=Byte, ColorInterp=Undefined
  Description = Contents Not Specified
...
Band 2 Block=5000x1 Type=Byte, ColorInterp=Undefined
  Description = Contents Not Specified
...
Band 3 Block=5000x1 Type=Byte, ColorInterp=Undefined
  Description = Contents Not Specified
...
From udadi at gmu.edu  Mon Nov 23 10:57:25 2009
From: udadi at gmu.edu (Upendra Dadi)
Date: Mon Nov 23 11:57:30 2009
Subject: [gdal-dev] GDALOpen not working with URLs
Message-ID: <f6d4e71396de.4b0a6a95@gmu.edu>

Hi,
  GDALOpen is unable to open URLs, it is giving the following error:

ERROR 4: `http://pubs.usgs.gov/of/1999/of99-396/data/imagery/utmd00/bathy1.tif' does not exist in the file system,
and is not recognised as a supported dataset name.

The following is the code snippet:

 GDALDriver         *hDriver;
 GDALDataset	    *hSrcDS;

 GDALAllRegister();

 hSrcDS = (GDALDataset *)GDALOpen("http://pubs.usgs.gov/of/1999/of99-396/data/imagery/utmd00/bathy1.tif",GA_ReadOnly );


If I remember correctly, I was earlier able to read directly from URLs. Am I missing some library here? Please help. thanks.

Upendra
From warmerdam at pobox.com  Mon Nov 23 12:19:20 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Nov 23 12:19:36 2009
Subject: [gdal-dev] GDALOpen not working with URLs
In-Reply-To: <f6d4e71396de.4b0a6a95@gmu.edu>
References: <f6d4e71396de.4b0a6a95@gmu.edu>
Message-ID: <4B0AC418.9070108@pobox.com>

Upendra Dadi wrote:
> Hi,
>   GDALOpen is unable to open URLs, it is giving the following error:
> 
> ERROR 4: `http://pubs.usgs.gov/of/1999/of99-396/data/imagery/utmd00/bathy1.tif' does not exist in the file system,
> and is not recognised as a supported dataset name.
> 
> The following is the code snippet:
> 
>  GDALDriver         *hDriver;
>  GDALDataset	    *hSrcDS;
> 
>  GDALAllRegister();
> 
>  hSrcDS = (GDALDataset *)GDALOpen("http://pubs.usgs.gov/of/1999/of99-396/data/imagery/utmd00/bathy1.tif",GA_ReadOnly );
> 
> 
> If I remember correctly, I was earlier able to read directly from URLs. Am I missing some library here? Please help. thanks.

Upendra,

The http driver depends on GDAL having been built with libcurl.  The
configure option is --with-curl.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ian.durkan at progeny.net  Mon Nov 23 12:45:55 2009
From: ian.durkan at progeny.net (Durkan, Ian)
Date: Mon Nov 23 12:46:01 2009
Subject: [gdal-dev] Issue with OGRGeometryFactory::createFromGML
Message-ID: <3F87AA6367687C43A854B8E7073CDF8C0E19A6@es-108a.paxriver.progeny.net>

Greetings,

 

I'm trying to use OGRGeometryFactory::createFromGML and
OGRGeometry::exportToWkt (both in  ogr_geometry.h)  to convert GML
geometry elements into well-known text and running into a problem when
the GML geometry is provided as a collection of <pos> elements.  Note
that the geometry is in GML 3.1.1 format, except the capitalization of
the outermost element names, which is irrelevant judging by the OGR
source code.  

 

This is basically the sequence of calls I'm making, where gmlText is an
std::string & contains the input text and buffer is a char* with
sufficient space for the output:

    OGRGeometry* geom =
OGRGeometryFactory::createFromGML(gmlText_noversion.c_str());

    geom->exportToWkt(&buffer);

 

As an example of how things are going wrong, here's sample input text to
createFromGML where a collection of <pos> elements is used:

<p1:polygon xmlns:p1="http://foo" xmlns:p2="http://www.opengis.net/gml">

 

  <p2:exterior>

    <p2:LinearRing>

      <p2:pos>-39 77.5</p2:pos>

      <p2:pos>-38.75 77.75</p2:pos>

      <p2:pos>-38.5 77.75</p2:pos>

      <p2:pos>-38.25 77.5</p2:pos>

      <p2:pos>-38.25 77.25</p2:pos>

      <p2:pos>-38.5 77</p2:pos>

      <p2:pos>-38.75 77</p2:pos>

      <p2:pos>-39 77.25</p2:pos> 

      <p2:pos>-39 77.5</p2:pos>

    </p2:LinearRing>

  </p2:exterior>

 

  <p2:interior>

    <p2:LinearRing>

      <p2:pos>-38.75 77.5</p2:pos>

      <p2:pos>-38.5 77.5</p2:pos>

      <p2:pos>-38.5 77.25</p2:pos>

      <p2:pos>-38.75 77.25</p2:pos>

      <p2:pos>-38.75 77.5</p2:pos>

    </p2:LinearRing>

  </p2:interior>

</p1:polygon>

 

Given the OGRGeometry created from the above text, exportToWkt gives me
the following:

POLYGON ((-39.0 77.5),(-38.75 77.5))

 

On the other hand, if I pass the following input to createFromGML:

<p1:polygon xmlns:p1="http://foo" xmlns:p2="http://www.opengis.net/gml">

 

  <p2:exterior>

    <p2:LinearRing>

      <p2:posList>-39 77.5 -38.75 77.75 -38.5 77.75 -38.25 77.5 -38.25
77.25 -38.5 77 -38.75 77 -39 77.25 -39 77.5</p2:posList>

    </p2:LinearRing>

  </p2:exterior>

 

  <p2:interior>

    <p2:LinearRing>

      <p2:posList>-38.75 77.5 -38.5 77.5 -38.5 77.25 -38.75 77.25 -38.75
77.5</p2:posList>

    </p2:LinearRing>

  </p2:interior>

 

</p1:polygon>

 

...I get the expected output from exportToWkt:

POLYGON ((-39.0 77.5,-38.75 77.75,-38.5 77.75,-38.25 77.5,-38.25
77.25,-38.5 77.0,-38.75 77.0,-39.0 77.25,-39.0 77.5),(-38.75 77.5,-38.5
77.5,-38.5 77.25,-38.75 77.25,-38.75 77.5))

 

This is happening for other GML geometries such as LineString as
well-the OGR functions handle <posList> input correctly, but not
collections of <pos> elements.  

 

 

Can anyone offer insight as to what is going wrong in the <pos> element
collection case?  My understanding is that either 4 or more <pos>
elements may be used in a LinearRing, or one <posList> containing the
list of coordinates.

 

 

Ian Durkan ( ian.durkan <at> progeny.net )

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091123/c510490c/attachment.html
From udadi at gmu.edu  Mon Nov 23 12:53:00 2009
From: udadi at gmu.edu (Upendra Dadi)
Date: Mon Nov 23 12:53:02 2009
Subject: [gdal-dev] problems using epsg:3785
In-Reply-To: <4B0AB88A.2020803@arcor.de>
References: <4B0AB88A.2020803@arcor.de>
Message-ID: <f667affeed1f.4b0a85ac@gmu.edu>

Peter,
  One reason could be that your original file does not have EPSG:32622, but something else. Or it is defined incorrectly in gdal, though I doubt it. A quick comparison of EPSG:32622 in proj.csv and gdalinfo for the original file might give you some hint. Try warping original file to EPSG:32622(without using -s_srs) and and then do gdalinfo on the resulting file. Compare the resulting file with original, they should have same bbox if the original file has EPSG:32622. This is my one cent opinion. 

Upendra

----- Original Message -----
From: Peter Freimuth <pfreimuth@arcor.de>
Date: Monday, November 23, 2009 11:30 am
Subject: [gdal-dev] problems using epsg:3785

> Hi all,
> 
> i am struggling around with a projection problem. I want to harmonize
> several hundreds of satellite images from different UTM Zones to the
> Google Projection Spherical Mercator. I am using a python script which
> handles the job for me using "gdalwarp" from the 1.6.1 and 1.7.0dev
> release (same result).
> 
> Find attached the gdalinfo output of the original file
> (gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.txt):
> 
> Upper Left  (  691500.000,-2471500.000) ( 49d 8'25.94"W, 
> 22d20'19.37"S)Lower Left  (  691500.000,-2496500.000) ( 49d 
> 8'15.09"W, 22d33'52.01"S)
> Upper Right (  716500.000,-2471500.000) ( 48d53'52.47"W, 22d20'8.69"S)
> Lower Right (  716500.000,-2496500.000) ( 48d53'40.21"W, 
> 22d33'41.21"S)
> echo "warp giving a source epsg code"
> gdalwarp -s_srs "EPSG:32622" -t_srs "EPSG:3785"
> 2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.pix
> c:\tmp\2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_32622-
> pix-3785.tif
> this results in
> (gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_32622-pix-
> 3785.txt)
> Upper Left  (-5470299.856,-2535649.342)
> Lower Left  (-5470299.856,-2563039.918)
> Upper Right (-5442909.280,-2535649.342)
> Lower Right (-5442909.280,-2563039.918)
> 
> echo "warp without giving a source epsg code"
> gdalwarp -t_srs "EPSG:3785"
> 2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB.pix
> c:\tmp\2009-03-02T140133_RE3_3A-NAC_642351_34785_enhancedRGB_pix-
> 3785.tif
> This results in
> (gdalinfo_2009-03-02T140133_RE3_3A-NAC_642351_34785_pix-3785.txt)
> 
> Upper Left  (-5470299.856,-2551883.715)
> Lower Left  (-5470299.856,-2579432.525)
> Upper Right (-5442913.703,-2551883.715)
> Lower Right (-5442913.703,-2579432.525)
> 
> Somehow i get big shift in the Y values of the images.
> 
> As a kind of reference i have a polygon layer in epsg:4326 stored 
> in a
> postgis 1.4.0 database table which contains the exact definitions 
> of the
> tiling grid which is used to create the satallite images.
> 
> The same shift can be reproduce in postgis when using a somehow
> different epsg:3785 definition:
> As you can see, there is a significant difference in the Y value.
> 
> select
> astext(envelope(transform(GeomFromEWKT('SRID=4326;POLYGON((-
> 49.1405410766602-22.5644474029541,-49.1405410766602 -
> 22.3357467651367,-48.8945007324219
> -22.3357467651367,-48.8945007324219 -22.5644474029541,-
> 49.1405410766602-22.5644474029541))'::TEXT),3785)))
> =>>"POLYGON((-5470300 -2579430.25,-5470300 -2551883.5,-5442911
> -2551883.5,-5442911 -2579430.25,-5470300 -2579430.25))"
> 
> select
> astext(envelope(transform(GeomFromEWKT('SRID=4326;POLYGON((-
> 49.1405410766602-22.5644474029541,-49.1405410766602 -
> 22.3357467651367,-48.8945007324219
> -22.3357467651367,-48.8945007324219 -22.5644474029541,-
> 49.1405410766602-22.5644474029541))'::TEXT),903785)))
> =>>"POLYGON((-5470300 -2563038,-5470300 -2535649.25,-5442911
> -2535649.25,-5442911 -2563038,-5470300 -2563038))"
> 
> Here are the two definitons as they are in my PostGIS 
> spatial_ref_sys table.
> 
> "3785" as defined in postgis 1.4.0 and proj-4.7.0 epsg file
> +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 
> +y_0=0+units=m +k=1.0 +nadgrids=@null +no_defs
> PROJCS["Popular Visualisation CRS / Mercator (deprecated)",
>    GEOGCS["Popular Visualisation CRS",
>        DATUM["Popular_Visualisation_Datum",
>            SPHEROID["Popular Visualisation Sphere",6378137,0,
>                AUTHORITY["EPSG","7059"]],
>            TOWGS84[0,0,0,0,0,0,0],
>            AUTHORITY["EPSG","6055"]],
>        PRIMEM["Greenwich",0,
>            AUTHORITY["EPSG","8901"]],
>        UNIT["degree",0.01745329251994328,
>            AUTHORITY["EPSG","9122"]],
>        AUTHORITY["EPSG","4055"]],
>    UNIT["metre",1,
>        AUTHORITY["EPSG","9001"]],
>    PROJECTION["Mercator_1SP"],
>    PARAMETER["central_meridian",0],
>    PARAMETER["scale_factor",1],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    AUTHORITY["EPSG","3785"],
>    AXIS["X",EAST],
>    AXIS["Y",NORTH]]"
> 
> I added a second definition which i took from spatialreference.org
> (http://spatialreference.org/ref/epsg/3785) with the srid 903785
> "903785"
> +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +a=6378137 +b=6378137
> +towgs84=0,0,0,0,0,0,0 +units=m +no_defs
> PROJCS["Popular Visualisation CRS / Mercator",
>    GEOGCS["Popular Visualisation CRS",
>        DATUM["Popular_Visualisation_Datum",
>            SPHEROID["Popular Visualisation Sphere",6378137,0,
>                AUTHORITY["EPSG","7059"]],
>            TOWGS84[0,0,0,0,0,0,0],
>            AUTHORITY["EPSG","6055"]],
>        PRIMEM["Greenwich",0,
>            AUTHORITY["EPSG","8901"]],
>        UNIT["degree",0.01745329251994328,
>            AUTHORITY["EPSG","9122"]],
>        AUTHORITY["EPSG","4055"]],
>    UNIT["metre",1,
>        AUTHORITY["EPSG","9001"]],
>    PROJECTION["Mercator_1SP"],
>    PARAMETER["central_meridian",0],
>    PARAMETER["scale_factor",1],
>    PARAMETER["false_easting",0],
>    PARAMETER["false_northing",0],
>    AUTHORITY["EPSG","3785"],
>    AXIS["X",EAST],
>    AXIS["Y",NORTH]]
> 
> 
> Now the big questions:
> Which of the above given definitions is the correct one?? So which of
> the polygons is the correct result when i want epsg:3785?
> 
> How  can it be explained that gdalwarp seems to use two different
> projections when warping the same file to the same output projection?
> 
> Any ideas or comments??
> 
> Thanks for any kind of help,
> Peter
> 
> -- 
> Peter Freimuth
> 
> 
> 
-------------- next part --------------
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From warmerdam at pobox.com  Mon Nov 23 13:05:41 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Nov 23 13:05:54 2009
Subject: [gdal-dev] GDALFillNodata link error
In-Reply-To: <150158ad0911230230w3d6502ceoe46e931fe0c49312@mail.gmail.com>
References: <150158ad0911230230w3d6502ceoe46e931fe0c49312@mail.gmail.com>
Message-ID: <4B0ACEF5.4020506@pobox.com>

Yilmaz Arslanoglu wrote:
> Hi all;
> 
> In version 1.6.2 and 1.6.3, the usage of the function
> "GDALFillNodata" gives a linker error, since "rasterfill.obj" is not
> listed under OBJ
> in "Makefile.vc" under "gdal\alg". However, it is listed in the
> current development version ( 1.7 )
> 
> Does this mean that the function GDALFillNodata is not intended to be
> used before 1.7 ?

Yilmaz,

The fill nodata support was not really fully finished in 1.6, and it
seems it was accidentally omitted from the windows makefile.  I see it
is in the unix GNUmakefile.   You can try it from 1.6, but you are better
off doing it in the 1.7/trunk tree if you want something dependable.

> As another question, is there a way to access somehow the iso8211
> functionality ( DDFModule etc. )
> via gdal library, or do we need to compile it as a seperate dll ? I
> tried to build the makefile under
> "gdal\frmts\iso8211" with "iso8211.dll" option, but it gives linker
> errors with this option as follows:

There are a bunch of library interfaces that are considered to be internal
to GDAL and these are generally declared with CPL_ODLL instead of CPL_DLL.
If you add:

#define CPL_OPTIONAL_APIS 1

in gdal/port/cpl_config.h or somewhere else appropriate it should cause
these interfaces to be exported from the GDAL DLL instead of being hidden
as they are by default.  I have confirmed this includes the iso8211
interfaces.

It would appear the local makefile targets for building a DLL are out of
date and would need some TLC to build standalone.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Mon Nov 23 13:50:22 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Nov 23 13:50:26 2009
Subject: [gdal-dev] Issue with OGRGeometryFactory::createFromGML
In-Reply-To: <3F87AA6367687C43A854B8E7073CDF8C0E19A6@es-108a.paxriver.progeny.net>
References: <3F87AA6367687C43A854B8E7073CDF8C0E19A6@es-108a.paxriver.progeny.net>
Message-ID: <4B0AD96E.4070204@mines-paris.org>

Ian,

this is clearly a bug in OGR that just returns after parsing the first 
<pos> element. I've filed it as the following ticket : 
http://trac.osgeo.org/gdal/ticket/3244
The fix should follow soon.

Best regards,
Even

Durkan, Ian a ?crit :
>
> Greetings,
>
> I?m trying to use OGRGeometryFactory::createFromGML and 
> OGRGeometry::exportToWkt (both in ogr_geometry.h) to convert GML 
> geometry elements into well-known text and running into a problem when 
> the GML geometry is provided as a collection of <pos> elements. Note 
> that the geometry is in GML 3.1.1 format, except the capitalization of 
> the outermost element names, which is irrelevant judging by the OGR 
> source code.
>
> This is basically the sequence of calls I?m making, where gmlText is 
> an std::string & contains the input text and buffer is a char* with 
> sufficient space for the output:
>
> OGRGeometry* geom = 
> OGRGeometryFactory::createFromGML(gmlText_noversion.c_str());
>
> geom->exportToWkt(&buffer);
>
> As an example of how things are going wrong, here?s sample input text 
> to createFromGML where a collection of <pos> elements is used:
>
> <p1:polygon xmlns:p1="http://foo" xmlns:p2="http://www.opengis.net/gml">
>
> <p2:exterior>
>
> <p2:LinearRing>
>
> <p2:pos>-39 77.5</p2:pos>
>
> <p2:pos>-38.75 77.75</p2:pos>
>
> <p2:pos>-38.5 77.75</p2:pos>
>
> <p2:pos>-38.25 77.5</p2:pos>
>
> <p2:pos>-38.25 77.25</p2:pos>
>
> <p2:pos>-38.5 77</p2:pos>
>
> <p2:pos>-38.75 77</p2:pos>
>
> <p2:pos>-39 77.25</p2:pos>
>
> <p2:pos>-39 77.5</p2:pos>
>
> </p2:LinearRing>
>
> </p2:exterior>
>
> <p2:interior>
>
> <p2:LinearRing>
>
> <p2:pos>-38.75 77.5</p2:pos>
>
> <p2:pos>-38.5 77.5</p2:pos>
>
> <p2:pos>-38.5 77.25</p2:pos>
>
> <p2:pos>-38.75 77.25</p2:pos>
>
> <p2:pos>-38.75 77.5</p2:pos>
>
> </p2:LinearRing>
>
> </p2:interior>
>
> </p1:polygon>
>
> Given the OGRGeometry created from the above text, exportToWkt gives 
> me the following:
>
> POLYGON ((-39.0 77.5),(-38.75 77.5))
>
> On the other hand, if I pass the following input to createFromGML:
>
> <p1:polygon xmlns:p1="http://foo" xmlns:p2="http://www.opengis.net/gml">
>
> <p2:exterior>
>
> <p2:LinearRing>
>
> <p2:posList>-39 77.5 -38.75 77.75 -38.5 77.75 -38.25 77.5 -38.25 77.25 
> -38.5 77 -38.75 77 -39 77.25 -39 77.5</p2:posList>
>
> </p2:LinearRing>
>
> </p2:exterior>
>
> <p2:interior>
>
> <p2:LinearRing>
>
> <p2:posList>-38.75 77.5 -38.5 77.5 -38.5 77.25 -38.75 77.25 -38.75 
> 77.5</p2:posList>
>
> </p2:LinearRing>
>
> </p2:interior>
>
> </p1:polygon>
>
> ...I get the expected output from exportToWkt:
>
> POLYGON ((-39.0 77.5,-38.75 77.75,-38.5 77.75,-38.25 77.5,-38.25 
> 77.25,-38.5 77.0,-38.75 77.0,-39.0 77.25,-39.0 77.5),(-38.75 
> 77.5,-38.5 77.5,-38.5 77.25,-38.75 77.25,-38.75 77.5))
>
> This is happening for other GML geometries such as LineString as 
> well-the OGR functions handle <posList> input correctly, but not 
> collections of <pos> elements.
>
> Can anyone offer insight as to what is going wrong in the <pos> 
> element collection case? My understanding is that either 4 or more 
> <pos> elements may be used in a LinearRing, or one <posList> 
> containing the list of coordinates.
>
> Ian Durkan ( ian.durkan <at> progeny.net )
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jared.carlson23 at gmail.com  Mon Nov 23 15:53:09 2009
From: jared.carlson23 at gmail.com (Jared Carlson)
Date: Mon Nov 23 15:53:12 2009
Subject: [gdal-dev] Help with USGS SDTS DEM
Message-ID: <a61dcb780911231253x77861c55kb8819b9948f8cdfd@mail.gmail.com>

Hello,

I'm trying to reconcile some geological data, via a SDTS DEM, and comparing
the elevations from what I'm reading in GDAL to what I'm seeing in ENVI.  I
seem to be reading everything in but am having issues with the actual
elevation data which seems to be scaled incorrectly.

For example, moving through the ENVI image, I see the maximum value for a
Maui DEM is 1322, but the Min/Max from GDALComputeRasterMinMax( .. ) is 0,
4116, but when I loop through my raster data, using:

pafScanline = (float*) CPLMalloc( sizeof(float) * nXSize * nYSize );
  /* Read the buffer via the following call RasterIO(
          GF_Read/GF_Write, xoffset, yoffset, width, height, void * data,
xBufWidth, yBufHeight, Type, pspace, lspace
  )
   */
  poBand->RasterIO( GF_Read, 0, 0, nXSize, nYSize, pafScanline, nXSize,
nYSize, GDT_Float32, 0, 0 );

  for (int i=0; i<nXSize*nYSize; i++)
    {
      if ( pafScanline[i] > value ) value = pafScanline[i];
    }

I see a max value of 4338...

Does anyone have some experience with this??  I'm a newbie to GDAL so
perhaps I'm doing something wrong.  I know the actual data in the rasterBand
is an int, but it says in the doc that RasterIO should still grab the
correct data values, and when looking at the GetDataNoValue that seems to
indicate that I did read in the data correctly but the maximums seem off,
and ENVI has different data values.  I checked the Scale and Offset, which
are 1.0, and 0.0 respectively.

Thanks for any help,

 - Jared
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091123/f212e9ec/attachment.html
From jared.carlson23 at gmail.com  Mon Nov 23 16:16:12 2009
From: jared.carlson23 at gmail.com (Jared Carlson)
Date: Mon Nov 23 16:16:15 2009
Subject: Fwd: [gdal-dev] Help with USGS SDTS DEM
In-Reply-To: <a61dcb780911231315j2b5da72akadea49683ff9fc04@mail.gmail.com>
References: <a61dcb780911231253x77861c55kb8819b9948f8cdfd@mail.gmail.com>
	<F369BB54-AC03-4510-8373-EA0456C7B29D@mac.com>
	<a61dcb780911231315j2b5da72akadea49683ff9fc04@mail.gmail.com>
Message-ID: <a61dcb780911231316w67435a14o8ec2489cca3c097a@mail.gmail.com>

Just making sure the list is covered as well...

---------- Forwarded message ----------
From: Jared Carlson <jared.carlson23@gmail.com>
Date: Mon, Nov 23, 2009 at 4:15 PM
Subject: Re: [gdal-dev] Help with USGS SDTS DEM
To: Greg Coats <gregcoats@mac.com>


Hi Greg,

Ok, but then where does the min,max calculation give me a different answer?
 The ComputeRasterMinMax gives me (0,4116) but as I said, doing the "dumb"
loop gives me 4338 which is consistent with the conversion...

Any ideas??

Thanks a lot for the help though, I appreciate any boost of confidence, even
simple unit conversions...

- Jared


On Mon, Nov 23, 2009 at 4:10 PM, Greg Coats <gregcoats@mac.com> wrote:

> 4338 feet = 1322 meters
> Greg
>
> On Nov 23, 2009, at 3:53 PM, Jared Carlson wrote:
>
> Hello,
>
> I'm trying to reconcile some geological data, via a SDTS DEM, and comparing
> the elevations from what I'm reading in GDAL to what I'm seeing in ENVI.  I
> seem to be reading everything in but am having issues with the actual
> elevation data which seems to be scaled incorrectly.
>
> For example, moving through the ENVI image, I see the maximum value for a
> Maui DEM is 1322, but the Min/Max from GDALComputeRasterMinMax( .. ) is 0,
> 4116, but when I loop through my raster data, using:
>
> pafScanline = (float*) CPLMalloc( sizeof(float) * nXSize * nYSize );
>   /* Read the buffer via the following call RasterIO(
>           GF_Read/GF_Write, xoffset, yoffset, width, height, void * data,
> xBufWidth, yBufHeight, Type, pspace, lspace
>    )
>    */
>   poBand->RasterIO( GF_Read, 0, 0, nXSize, nYSize, pafScanline, nXSize,
> nYSize, GDT_Float32, 0, 0 );
>
>   for (int i=0; i<nXSize*nYSize; i++)
>     {
>       if ( pafScanline[i] > value ) value = pafScanline[i];
>     }
>
> I see a max value of 4338...
>
> Does anyone have some experience with this??  I'm a newbie to GDAL so
> perhaps I'm doing something wrong.  I know the actual data in the rasterBand
> is an int, but it says in the doc that RasterIO should still grab the
> correct data values, and when looking at the GetDataNoValue that seems to
> indicate that I did read in the data correctly but the maximums seem off,
> and ENVI has different data values.  I checked the Scale and Offset, which
> are 1.0, and 0.0 respectively.
>
> Thanks for any help,
>
>  - Jared
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091123/f6f5c9d8/attachment.html
From jukka.rahkonen at mmmtike.fi  Mon Nov 23 17:38:35 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon Nov 23 17:42:29 2009
Subject: [gdal-dev] Re: problems using epsg:3785
References: <4B0AB88A.2020803@arcor.de>
Message-ID: <loom.20091123T233652-960@post.gmane.org>

Peter Freimuth <pfreimuth <at> arcor.de> writes:

> 
> Hi all,
> 
> i am struggling around with a projection problem. I want to harmonize
> several hundreds of satellite images from different UTM Zones to the
> Google Projection Spherical Mercator. I am using a python script which
> handles the job for me using "gdalwarp" from the 1.6.1 and 1.7.0dev
> release (same result).

Hi,

Gdal 1.6.3 release candidate announcement a few days ago informs:

 EPSG:3785 does not support spherical mercator hack
<http://trac.osgeo.org/gdal/ticket/3136/>

Perhaps this is your problem.  Have you tried what happens with epsg:900913?

-Jukka Rahkonen-

From jrepetto at free.fr  Tue Nov 24 02:14:36 2009
From: jrepetto at free.fr (Jean-Claude REPETTO)
Date: Tue Nov 24 02:14:48 2009
Subject: [gdal-dev] Re: problems using epsg:3785
In-Reply-To: <loom.20091123T233652-960@post.gmane.org>
References: <4B0AB88A.2020803@arcor.de>
	<loom.20091123T233652-960@post.gmane.org>
Message-ID: <4B0B87DC.4020604@free.fr>

Jukka Rahkonen a ?crit :
>
> Gdal 1.6.3 release candidate announcement a few days ago informs:
> 
>  EPSG:3785 does not support spherical mercator hack
> <http://trac.osgeo.org/gdal/ticket/3136/>
> 
> Perhaps this is your problem.  Have you tried what happens with epsg:900913?
>

And what happens with epsg:3857, the official EPSG number for Google 
spherical Mercator ? Does it support spherical mercator hack ?
From jukka.rahkonen at mmmtike.fi  Tue Nov 24 09:51:28 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue Nov 24 09:52:03 2009
Subject: [gdal-dev] Benefit of using 
Message-ID: <loom.20091124T153819-516@post.gmane.org>

Hi,

What is the benefit of using gdaladdo with option -clean?  I created
accidentally internal overviews instead of external and I was thinking that the
-clean option must be a tool to get back to the starting point with no overviews
and smaller file size. Hoever, -clean option is obviously made for some other
purpose because it seems to wipe away overviews so that no program can utilise
them, but still the file size remains the same.  For example

- original tiff             355023 KB
- with internal overviews   475209 KB
- after gdaladdo -clean     475209 KB

Is there any other way to get tiff file to its original size than to rewrite it
with gdal_translate? It is fast but it means some manual delete/rename
operations.

-Jukka Rahkonen-

From Boris.Vasiliev at forces.gc.ca  Tue Nov 24 11:29:34 2009
From: Boris.Vasiliev at forces.gc.ca (Boris.Vasiliev@forces.gc.ca)
Date: Tue Nov 24 11:30:57 2009
Subject: [gdal-dev] mdb to shape conversion: no geometry exported
Message-ID: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C3@img-str-e002214.forces.mil.ca>

Hi,

I would like to convert an ArcGIS .mdb database to shape files but,
unfortunately, the geometry is not exported.  This issue was raised
before in this mailing list, but I could not find a solution. Hence, a
new post.

In particular, ogrinfo returns valid layer names albeit with some
warnings

> ogrinfo PGeo:polling_geo

# ERROR 1: importFromWKT() failed on SRS 'GEOGCS["GCS_'.
# ERROR 1: importFromWKT() failed on SRS 'GEOGCS["GCS_'.
# INFO: Open of 'Pgeo:polling_geo'
#           using driver 'PGeo' successful
# Districts
# Subdivisions

The conversion raises the same warnings but does not fail

> ogr2ogr -f "ESRI Shapefile" -a_srs "+proj=longlat +ellps=WGS84
+datum=WGS84" districts.shp PGeo:"polling_geo"

The conversion creates districts.{shp,dbf,shx,prj}.  

The .dbf file contains the correct data; however, when I load the .shp
file into QGIS the layer is empty.  Similarly, when I import the shape
file into GRASS, GRASS shows 0 lines, polygons and points.  I tried
setting the new layer type option, -nlt, to GEOMETRY, POLYGON, and
LINESTRING but this did not help - shape files contain no geometry.

The ogr2ogr version is 1.6.2, released 2009/07/31.

Is this a known issue with .mdb files?  Are there any diagnostic tools
which may indicate what is wrong with the .mdb file and why geometry is
not exported?  Is anybody aware of possible fixes?

Regards,
Boris.



From warmerdam at pobox.com  Tue Nov 24 12:02:51 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Nov 24 12:03:03 2009
Subject: [gdal-dev] mdb to shape conversion: no geometry exported
In-Reply-To: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C3@img-str-e002214.forces.mil.ca>
References: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C3@img-str-e002214.forces.mil.ca>
Message-ID: <4B0C11BB.1020801@pobox.com>

Boris.Vasiliev@forces.gc.ca wrote:
> Hi,
> 
> I would like to convert an ArcGIS .mdb database to shape files but,
> unfortunately, the geometry is not exported.  This issue was raised
> before in this mailing list, but I could not find a solution. Hence, a
> new post.
...
> The .dbf file contains the correct data; however, when I load the .shp
> file into QGIS the layer is empty.  Similarly, when I import the shape
> file into GRASS, GRASS shows 0 lines, polygons and points.  I tried
> setting the new layer type option, -nlt, to GEOMETRY, POLYGON, and
> LINESTRING but this did not help - shape files contain no geometry.
> 
> The ogr2ogr version is 1.6.2, released 2009/07/31.
> 
> Is this a known issue with .mdb files?  Are there any diagnostic tools
> which may indicate what is wrong with the .mdb file and why geometry is
> not exported?  Is anybody aware of possible fixes?

Boris,

There are some geometry types in personal geodatabases which are known not
to translate.  A review of open personal geodatabase tickets should turn up
some information on this. I see the following potentially related tickets:

   http://trac.osgeo.org/gdal/ticket/3100
   http://trac.osgeo.org/gdal/ticket/2991
   http://trac.osgeo.org/gdal/ticket/2702
   http://trac.osgeo.org/gdal/ticket/2643
   http://trac.osgeo.org/gdal/ticket/1918

It looks like, from 2991, that fixes may be in trunk and 1.6.3 that would
be helpful.

Running ogrinfo with the "--debug on" flag might give additional diagnostic
information.

Chaitanya, could you review the status of all the above tickets and see if
your fixes for 2991 address the others?  Please close tickets when you are
reasonably confident they are dealt with (including notes such as pointers
to 2991).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Tue Nov 24 14:00:10 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Nov 24 14:00:11 2009
Subject: [gdal-dev] Benefit of using
In-Reply-To: <loom.20091124T153819-516@post.gmane.org>
References: <loom.20091124T153819-516@post.gmane.org>
Message-ID: <4B0C2D3A.6020305@mines-paris.org>

Jukka Rahkonen a ?crit :

I guess the main reason was to invalidate existing overviews when the 
content of the full resolution has changed.
See http://trac.osgeo.org/gdal/ticket/2915 for the history of this feature.

For external overviews, either in GeoTIFF format (.ovr), or in HFA 
Imagine format (.aux / .rrd), gdaladdo -clean destroys the external 
overview file.

For internal overviews in TIFF, it can't shrink the file. This would 
require libtiff to support a kind of "compaction" operation, which it 
doesn't. Currently, it just "unlinks" the IFDs corresponding to the 
overviews from the chain of IFDs thus leaving holes in the file. I've 
also observed similar behaviour for internal HFA Imagine datasets.

But for database drivers, gdaladdo -clean can also free space. For 
example, for the (trunk) rasterlite driver, gdaladdo -clean + ogrinfo 
-sql "vacuum" results in a file that has the same size as before adding 
the overviews.

> Hi,
>
> What is the benefit of using gdaladdo with option -clean?  I created
> accidentally internal overviews instead of external and I was thinking that the
> -clean option must be a tool to get back to the starting point with no overviews
> and smaller file size. Hoever, -clean option is obviously made for some other
> purpose because it seems to wipe away overviews so that no program can utilise
> them, but still the file size remains the same.  For example
>
> - original tiff             355023 KB
> - with internal overviews   475209 KB
> - after gdaladdo -clean     475209 KB
>
> Is there any other way to get tiff file to its original size than to rewrite it
> with gdal_translate? It is fast but it means some manual delete/rename
> operations.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>   


From kevin.chiou at progeny.net  Tue Nov 24 15:15:11 2009
From: kevin.chiou at progeny.net (Chiou, Kevin)
Date: Tue Nov 24 15:15:15 2009
Subject: [gdal-dev] Copying text segment header for the NITF driver
Message-ID: <3F87AA6367687C43A854B8E7073CDF8C0BD93C@es-108a.paxriver.progeny.net>

Hi,
I noticed that the current GDAL NITF driver does not copy text header
when CreateCopy is performed. So I updated the driver code to perform
the copying.  However, the approach I took adds some additional data to
the dataset's metadata.  I want to check to see if this is ok before I
open a Trac ticket to submit my changes.

NITF Text Domain Before:
DATA_0=This is test text file 01.
DATA_1=This is test text file 02.

NITF Text Domain Now:
DATA_0=This is test text file 01.
HEADER_0=TEXT00000020090407185409SOMETITLE_1...
DATA_1=This is test text file 02.
HEADER_1=TEXT00000020090408185409SOMETITLE_2...

Implementation Notes:
1)	The "HEADER_" metadata contains the whole header in unparsed
form.
2)	The header data has to be stored somewhere in the dataset so I
can read it back when writing it.  I am open to suggestion for putting
the data somewhere else.

 Let me know if this is ok.

-Kevin Chiou

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091124/337dba93/attachment.html
From hobu.inc at gmail.com  Tue Nov 24 16:12:53 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Tue Nov 24 16:22:30 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC1 to 1.6.3
In-Reply-To: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>
Message-ID: <27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>

I would like to motion to make the 1.6.3-rc1 official.  Please run a quick test if you have a chance before voting.

+1 Howard


On Nov 19, 2009, at 10:09 PM, Howard Butler wrote:

> All,
> 
> The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.
> 
> http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
> http://download.osgeo.org/gdal/gdal163-RC1.zip
> 
> The following issues were addressed in this release:
> 
> General:
> * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
> * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>
> 
> GDAL:
> * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
> * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
> * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
> * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
> * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
> * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
> * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
> * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
> * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
> * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
> * Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
> * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
> * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
> * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
> * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
> * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
> * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
> * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
> * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>
> 
> Utilities:
> * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
> * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
> * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>
> 
> OGR:
> * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
> * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
> * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
> * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
> * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>
> 
> Configuration:
> * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
> * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>
> 
> Python:
> * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
> * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>
> 
> OGR Spatial References:
> * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
> * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>
> 
> 

From simone.giannecchini at geo-solutions.it  Tue Nov 24 18:58:41 2009
From: simone.giannecchini at geo-solutions.it (Simone Giannecchini)
Date: Tue Nov 24 18:58:46 2009
Subject: [gdal-dev] Re: JAVA API - Performance
In-Reply-To: <4B06E3FF.7050503@mines-paris.org>
References: <20091109233607.2877.qmail@s466.sureserver.com>
	<1257850818.4af947c20752a@imp.free.fr>
	<961f4d9e0911100936n13e25d10hb1a241dcf3297e75@mail.gmail.com>
	<1257939206.4afaa106743c6@imp.free.fr>
	<961f4d9e0911200354v5294bb46ye9ddc959b3ffa918@mail.gmail.com>
	<4B06E3FF.7050503@mines-paris.org>
Message-ID: <961f4d9e0911241558t5ccc3416pc6ba46e2d3b92004@mail.gmail.com>

Ciao Even,
please read below...
-------------------------------------------------------
Ing. Simone Giannecchini
GeoSolutions S.A.S.
Founder - Software Engineer
Via Carignoni 51
55041  Camaiore (LU)
Italy

phone: +39 0584983027
fax:      +39 0584983027
mob:    +39 333 8128928


http://www.geo-solutions.it
http://geo-solutions.blogspot.com/
http://simboss.blogspot.com/
http://www.linkedin.com/in/simonegiannecchini

-------------------------------------------------------



On Fri, Nov 20, 2009 at 7:46 PM, Even Rouault
<even.rouault@mines-paris.org> wrote:
> Hi Simone,
>
> Simone Giannecchini a ?crit :
>>>
>>> I've tried GetPrimitiveArrayCritical() / ReleasePrimitiveArrayCritical()
>>> and
>>> I've observed they return non-copy pointers, which make them good
>>> candidates.
>>> Looking at
>>>
>>> http://java.sun.com/j2se/1.3/docs/guide/jni/jni-12.html#GetPrimitiveArrayCritical,
>>> it appears that there are restrictions to use them. But this is probably
>>> OK as
>>> we don't callback Java code in the RasterIO operations. But I'm not sure
>>> if the
>>> native operation can be considered to be fast enough to use those
>>> primitives. It
>>> depends on the query size and the driver. Perhaps it is not worth the
>>> risk and
>>> that the copy made by the JVM when calling GetByteArrayElements() is not
>>> that
>>> significant for modest size arrays.
>>
>> I decide not to take the risk. The problem with that call is that It
>> should block the GarbageCollector and this is highly counterproductive
>> in server side application (you tend to prefer less pause times more
>> often than ?a long pause time once ia while).
>>
>>
>
> I didn't use it finally. Just regular
> Get(Byte|Short|Int|Float|Double)ArrayElements functions.
>
>>> Another possibility is that in the ReadRaster() case, we don't care about
>>> the
>>> initial values of the array. We just want to update it in fact, so we
>>> could
>>> allocate a working buffer in the JNI code, call the native RasterIO() on
>>> it and
>>> upload its content into the Java array with SetByteArrayRegion(). This
>>> would
>>> save one copy.
>>>
>>
>> For the reasons I said in my previous email I would refrain from
>> allocating raster data inside the native code, the JVM seems to not
>> like that too much.
>> Moreover, the Java flag to control the native memory space is prefixed
>> XX which means that it might stop orking with no notice in a newer
>> java release.
>> I guess that the best thing, IMHO, is to stick with pinning and hope
>> for the best, however, it might be interesting to do kind of a testing
>> session having the geoserver hitting the gdal code for something like
>> ECW and see what happens with the different options in term of
>> stability/performance/robustness, what do you think?
>>
>>
>
> I did use the temporary allocation of a buffer before calling RasterIO() and
> then updating the Java array with
> SetByteArrayRegion(). I'm not sure why the JVM wouldn't like that. It
> doesn't have to deal with memory
> allocations done by third-party code and I'm working daily with a Java app
> that uses native DLLs that allocates
> big amount of memory without any problems. If a JVM doesn't like that, I
> would consider it to be seriously broken
> (that would imply that GDAL can't do its own memory allocations either and
> it must allocate temporary buffers for its
> block cache for example...).

Here what we have been facing during the performance shootout for the
FOSS4G for ECW data served via GDAL with GeoServer.
Under high load the GeoServer  was crashing the JVM with a strange
error unrelated to GDAL or GeoServer itself. The Java2D rendering
pipeline was dying on a null pointer exception since medialib was
unable to allocate internal intermediate images and apparently no
check against this conditions was made hence the crashes.

Now why this was happening and why we tried to move away from
DirectBuffers. My understanding of the memory model in Java is that
you roughly have two spaces one handled by the JVM (heap, stack on so
on) and then the native space, where the native code (e.g. GDAL)
allocates his memory and which is use by the JVM internal code itself
for his memory (and by the DirectMemory itself). Our guess was that
under real heavy load the couple GeoServer+GDAL using DirectBuffers
was exhausting the native memory of the JVM process jeopardizing the
JVM itself. Once we moved away from the DirectBuffers we got no more
problems.

Simone.

> However if you observe that it is a problem,
> you could try changing the typemaps to use
> the regular array pinning (it's the /* %typemap(in, numinputs=1) (ctype
> *regularArrayOut, long nRegularArraySizeOut) ?*/
> around line 1400 in swig/include/java/typemaps_java.i) to see if it changes
> things.
>
> I'd be happy to hear about the results of your tests with Geoserver.
>
> Even
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From ben at imqs.co.za  Wed Nov 25 02:33:24 2009
From: ben at imqs.co.za (Ben Harper)
Date: Wed Nov 25 02:34:37 2009
Subject: [gdal-dev] FlushFileBuffers in PNG and JPEG drivers
Message-ID: <27BA4145191C1849903386A90FE16D6518E80D469C@xserver.gls.co.za>

Hi,
I've noticed that the PNG and JPEG drivers in GDAL call theVSIFFlushL function when finished writing a file. On Win32, this winds up at FlushFileBuffers. Now, unless you're doing something transactional, or using memory mapped files, or something of that nature, FlushFileBuffers is simply not necessary, but it does have the penalty of forcing the disk to seek and write. I noticed this when using GDAL to produce and cache map tiles to PNG and JPEG files - you end up with a nasty serialization. I don't believe the TIF driver does this, nor the BMP, but I haven't investigated others.
I can't see why exactly this call exists, but I'm pretty sure they can be safely removed for the PNG and JPEG drivers, without any loss of correctness. I'm not submitting a patch, because this change is so trivial. And maybe there is some reason these things exist?

Ben
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091125/99495f12/attachment-0001.html
From yilmaz.arslanoglu at gmail.com  Wed Nov 25 04:31:14 2009
From: yilmaz.arslanoglu at gmail.com (Yilmaz Arslanoglu)
Date: Wed Nov 25 04:31:32 2009
Subject: [gdal-dev] GDALFillNodata link error
In-Reply-To: <4B0ACEF5.4020506@pobox.com>
References: <150158ad0911230230w3d6502ceoe46e931fe0c49312@mail.gmail.com>
	<4B0ACEF5.4020506@pobox.com>
Message-ID: <150158ad0911250131s7b50ab53qb186b52778e9fcee@mail.gmail.com>

Thank you very much for the answers, Frank.
Defining CPL_OPTIONAL_APIS did actually
exactly what I want, thanks again...

On Mon, Nov 23, 2009 at 7:05 PM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Yilmaz Arslanoglu wrote:
>>
>> Hi all;
>>
>> In version 1.6.2 and 1.6.3, the usage of the function
>> "GDALFillNodata" gives a linker error, since "rasterfill.obj" is not
>> listed under OBJ
>> in "Makefile.vc" under "gdal\alg". However, it is listed in the
>> current development version ( 1.7 )
>>
>> Does this mean that the function GDALFillNodata is not intended to be
>> used before 1.7 ?
>
> Yilmaz,
>
> The fill nodata support was not really fully finished in 1.6, and it
> seems it was accidentally omitted from the windows makefile. ?I see it
> is in the unix GNUmakefile. ? You can try it from 1.6, but you are better
> off doing it in the 1.7/trunk tree if you want something dependable.
>
>> As another question, is there a way to access somehow the iso8211
>> functionality ( DDFModule etc. )
>> via gdal library, or do we need to compile it as a seperate dll ? I
>> tried to build the makefile under
>> "gdal\frmts\iso8211" with "iso8211.dll" option, but it gives linker
>> errors with this option as follows:
>
> There are a bunch of library interfaces that are considered to be internal
> to GDAL and these are generally declared with CPL_ODLL instead of CPL_DLL.
> If you add:
>
> #define CPL_OPTIONAL_APIS 1
>
> in gdal/port/cpl_config.h or somewhere else appropriate it should cause
> these interfaces to be exported from the GDAL DLL instead of being hidden
> as they are by default. ?I have confirmed this includes the iso8211
> interfaces.
>
> It would appear the local makefile targets for building a DLL are out of
> date and would need some TLC to build standalone.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>
From Boris.Vasiliev at forces.gc.ca  Wed Nov 25 10:19:53 2009
From: Boris.Vasiliev at forces.gc.ca (Boris.Vasiliev@forces.gc.ca)
Date: Wed Nov 25 10:27:27 2009
Subject: [gdal-dev] mdb to shape conversion: no geometry exported
Message-ID: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C5@img-str-e002214.forces.mil.ca>

>  Boris.Vasiliev at forces.gc.ca
<http://lists.osgeo.org/mailman/listinfo/gdal-dev>  wrote:
> > Hi,
> > 
> > I would like to convert an ArcGIS .mdb database to shape files but,
> > unfortunately, the geometry is not exported.  This issue was raised
> > before in this mailing list, but I could not find a solution. Hence,
a
> > new post.
> ...
> > The .dbf file contains the correct data; however, when I load the
.shp
> > file into QGIS the layer is empty.  Similarly, when I import the
shape
> > file into GRASS, GRASS shows 0 lines, polygons and points.  I tried
> > setting the new layer type option, -nlt, to GEOMETRY, POLYGON, and
> > LINESTRING but this did not help - shape files contain no geometry.
> > 
> > The ogr2ogr version is 1.6.2, released 2009/07/31.
> > 
> > Is this a known issue with .mdb files?  Are there any diagnostic
tools
> > which may indicate what is wrong with the .mdb file and why geometry
is
> > not exported?  Is anybody aware of possible fixes?

> Boris,

> There are some geometry types in personal geodatabases which are known
not
> to translate.  A review of open personal geodatabase tickets should
turn up
> some information on this. I see the following potentially related
tickets:
>
>   http://trac.osgeo.org/gdal/ticket/3100
>   http://trac.osgeo.org/gdal/ticket/2991
>   http://trac.osgeo.org/gdal/ticket/2702
>   http://trac.osgeo.org/gdal/ticket/2643
>   http://trac.osgeo.org/gdal/ticket/1918

> It looks like, from 2991, that fixes may be in trunk and 1.6.3 that
would
> be helpful.

> Running ogrinfo with the "--debug on" flag might give additional
diagnostic
> information.

> Chaitanya, could you review the status of all the above tickets and
see if
> your fixes for 2991 address the others?  Please close tickets when you
are
> reasonably confident they are dealt with (including notes such as
pointers
> to 2991).

> Best regards,
> -- 
>
---------------------------------------+--------------------------------
------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at
pobox.com <http://lists.osgeo.org/mailman/listinfo/gdal-dev> 
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for
Rent

Thank you for quick reply.  I run ogrinfo with the "--debug on" 

ogrinfo Pgeo:polling_geo Districts

and got the following output. (The listing is truncated to one feature
of the map.)

# PGeo: MDB Tools driver: /usr/lib/libmdbodbc.so.0
# ODBC: HOME=/home/vasiliev
# ODBC: ODBCSYSINI=/home/vasiliev
# PGeo: MDB Tools driver installed successfully!
# PGeo: EstablishSession(polling_geo)
# ODBC: SQLConnect(polling_geo)
# ERROR 1: importFromWKT() failed on SRS 'GEOGCS["GCS_'.
# PGeo: Districts: no primary key
# ERROR 1: importFromWKT() failed on SRS 'GEOGCS["GCS_'.
# PGeo: KC_Districts: no primary key
# PGEO: Ignoreing GUID SRTEXT: {B286C06B-08
# PGeo: Highway: no primary key
# OGR: OGROpen(Pgeo:polling_geo/0x8051a90) succeeded as PGeo.
# OGR: GetLayerCount() = 3
# 
# Error at Line : syntax error near (
# ERROR 1: GetFeatureCount() failed on query SELECT COUNT(*) FROM
Districts.
# 
# INFO: Open of `Pgeo:polling_geo'
#       using driver `PGeo' successful.
# 
# Layer name: Districts
# Geometry: Unknown (any)
# Feature Count: 18
# Extent: (60.872970, 29.377130) - (68.112780, 34.411050)
# Layer SRS WKT:
# (unknown)
# OBJECTID: Integer (0.0)
# FID_1: Integer (0.0)
# Id: Integer (0.0)
# FID_2: Integer (0.0)
# ID_1: Integer (0.0)
# PROVINCE_N: String (0.0)
# DISTRICT_N: String (0.0)
# AREA_SQKM: Real (0.0)
# Distance: Real (0.0)
# Shape_Length: Real (0.0)
# Shape_Area: Real (0.0)
# OGRFeature(Districts):0
#   OBJECTID (Integer) = 5
#   FID_1 (Integer) = 31
#   Id (Integer) = 0
#   FID_2 (Integer) = 58
#   ID_1 (Integer) = 58
#   PROVINCE_N (String) = ABC
#   DISTRICT_N (String) = def
#   AREA_SQKM (Real) = 1229.33
#   Distance (Real) = 20200
#   Shape_Length (Real) = 1.700229
#   Shape_Area (Real) = 0.117263

It appears that ogrinfo does not recognize the geometry type because of
the  "Geometry: Unknown (any)" line. However, I checked the geometry
type in ArcGIS and it seems to be "Polygon". 

The issue may be related to the tickets you mentioned above; however
they seem to deal with the more complicated cases of PolygonZ (ticket
2991) whereas I think I have a map that contains several polygons.

At this time, I managed to export the map to a shape file with ArcMap;
however, it would be wonderful if the conversion could be done with
ogr2ogr from command line.

Regards,
Boris.

From hobu.inc at gmail.com  Wed Nov 25 11:27:20 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Wed Nov 25 11:30:53 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>
	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
Message-ID: <BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>

Even found a small issue with the Python bindings having their version number be 1.6.2.  I have issued an RC 2 to fix this.

http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
http://download.osgeo.org/gdal/gdal163-RC2.zip


On Nov 24, 2009, at 3:12 PM, Howard Butler wrote:

> I would like to motion to make the 1.6.3-rc1 official.  Please run a quick test if you have a chance before voting.
> 
> +1 Howard
> 
> 
> On Nov 19, 2009, at 10:09 PM, Howard Butler wrote:
> 
>> All,
>> 
>> The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.
>> 
>> http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
>> http://download.osgeo.org/gdal/gdal163-RC1.zip
>> 
>> The following issues were addressed in this release:
>> 
>> General:
>> * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
>> * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>
>> 
>> GDAL:
>> * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
>> * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
>> * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
>> * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
>> * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
>> * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
>> * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
>> * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
>> * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
>> * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
>> * Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
>> * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
>> * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
>> * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
>> * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
>> * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
>> * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
>> * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
>> * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>
>> 
>> Utilities:
>> * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
>> * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
>> * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>
>> 
>> OGR:
>> * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
>> * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
>> * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
>> * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
>> * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>
>> 
>> Configuration:
>> * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
>> * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>
>> 
>> Python:
>> * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
>> * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>
>> 
>> OGR Spatial References:
>> * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
>> * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>
>> 
>> 
> 

From warmerdam at pobox.com  Wed Nov 25 12:21:33 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 25 12:21:34 2009
Subject: [gdal-dev] mdb to shape conversion: no geometry exported
In-Reply-To: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C5@img-str-e002214.forces.mil.ca>
References: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C5@img-str-e002214.forces.mil.ca>
Message-ID: <4B0D679D.7090607@pobox.com>

Boris.Vasiliev@forces.gc.ca wrote:
> Thank you for quick reply.  I run ogrinfo with the "--debug on" 
> 
> ogrinfo Pgeo:polling_geo Districts
> 
> and got the following output. (The listing is truncated to one feature
> of the map.)
> 
> # PGeo: MDB Tools driver: /usr/lib/libmdbodbc.so.0

Boris,

I had not understood you were working on linux.  I have been very frustrated
with the fragility of the mdbtools based odbc driver and I'm no longer
interested in investing effort in supporting it.  If you really really want
it, then review:

   http://trac.osgeo.org/gdal/wiki/mdbtools

There may also be open tickets on the issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From tom.van.tilburg at gmail.com  Wed Nov 25 12:46:07 2009
From: tom.van.tilburg at gmail.com (TomvanTilburg)
Date: Wed Nov 25 12:46:09 2009
Subject: [Gdal-dev] PROJ.4 EPSG:28992
In-Reply-To: <47C8332B.1070003@pobox.com>
References: <5c6dd3b0751f426d8a62fd26d1095835@145.50.39.11>
	<47C8332B.1070003@pobox.com>
Message-ID: <1259171167164-4066454.post@n2.nabble.com>


Hi,

Im relatively new to the GDAL package but I've got the feeling I'm hitting
this same (old) problem.

At the moment I am trying to write a python script that transfers sets of
shapefiles in the Dutch nation grid (EPSG 28992) to WGS84, ultimately to
export them to KML files. Therefore I run the following code:

-snip-
inSpatialRef.ImportFromEPSG(28992)
outSpatialRef.ImportFromEPSG(4326)
coordTrans = osr.CoordinateTransformation(inSpatialRef, outSpatialRef)
-snip-
geom.Transform(coordTrans)

throws the following error:

Traceback (most recent call last):
  File "Y:/template(do not remove)/py scripts/reproj_osg.py", line 66, in
<module>
    geom.Transform(coordTrans)
  File "C:\Python26\lib\site-packages\osgeo\ogr.py", line 3173, in Transform
    return _ogr.Geometry_Transform(*args)
TypeError: in method 'Geometry_Transform', argument 2 of type
'OSRCoordinateTransformationShadow *'

I tried it with other (NAD) projections and that works fine. Could this
still be the same issue?

Best regards,
 Tom
-- 
View this message in context: http://n2.nabble.com/PROJ-4-EPSG-28992-tp2033665p4066454.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From warmerdam at pobox.com  Wed Nov 25 14:47:12 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 25 14:47:18 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>
	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
Message-ID: <4B0D89C0.2030207@pobox.com>

Howard Butler wrote:
> Even found a small issue with the Python bindings having their version number be 1.6.2.  I have issued an RC 2 to fix this.
> 
> http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
> http://download.osgeo.org/gdal/gdal163-RC2.zip
> 

Howard,

I'll treat the above as a motion to issue RC2 as 1.6.3.  I have tested
it on BSD/OS, including the building with python support and running against
the 1.6 autotest suite (from svn) and everything looks clean to me.

I have also compared all the include files in gdal/port, gdal/gcore,
gdal/alg, gdal/ogr, and gdal/ogr/ogrsf_frmts to those from 1.6.0 and
there are no inappropriate changes so I think we can be fairly confident
that the C and C++ API and ABI are unaltered.

I'm +1 to treat this RC as the final release.

PS. I've created 1.6.4 milestone we can move outstanding tickets to.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Wed Nov 25 17:15:21 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Nov 25 17:15:33 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <4B0D89C0.2030207@pobox.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
	<4B0D89C0.2030207@pobox.com>
Message-ID: <4B0DAC79.7040102@mines-paris.org>

I'm +1 to promote 1.6.3RC2 as 1.6.3

Frank Warmerdam a ?crit :
> Howard Butler wrote:
>> Even found a small issue with the Python bindings having their 
>> version number be 1.6.2.  I have issued an RC 2 to fix this.
>>
>> http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
>> http://download.osgeo.org/gdal/gdal163-RC2.zip
>>
>
> Howard,
>
> I'll treat the above as a motion to issue RC2 as 1.6.3.  I have tested
> it on BSD/OS, including the building with python support and running 
> against
> the 1.6 autotest suite (from svn) and everything looks clean to me.
>
> I have also compared all the include files in gdal/port, gdal/gcore,
> gdal/alg, gdal/ogr, and gdal/ogr/ogrsf_frmts to those from 1.6.0 and
> there are no inappropriate changes so I think we can be fairly confident
> that the C and C++ API and ABI are unaltered.
>
> I'm +1 to treat this RC as the final release.
>
> PS. I've created 1.6.4 milestone we can move outstanding tickets to.
>
> Best regards,


From szekerest at gmail.com  Wed Nov 25 17:28:34 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 25 17:28:39 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>
	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
Message-ID: <f3b73b7d0911251428k37cf9dden4ce291c8897f7639@mail.gmail.com>

+1

Best regards,

Tamas



2009/11/25 Howard Butler <hobu.inc@gmail.com>:
> Even found a small issue with the Python bindings having their version number be 1.6.2. ?I have issued an RC 2 to fix this.
>
> http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
> http://download.osgeo.org/gdal/gdal163-RC2.zip
>
>
> On Nov 24, 2009, at 3:12 PM, Howard Butler wrote:
>
>> I would like to motion to make the 1.6.3-rc1 official. ?Please run a quick test if you have a chance before voting.
>>
>> +1 Howard
>>
>>
>> On Nov 19, 2009, at 10:09 PM, Howard Butler wrote:
>>
>>> All,
>>>
>>> The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.
>>>
>>> http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
>>> http://download.osgeo.org/gdal/gdal163-RC1.zip
>>>
>>> The following issues were addressed in this release:
>>>
>>> General:
>>> * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
>>> * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>
>>>
>>> GDAL:
>>> * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
>>> * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
>>> * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
>>> * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
>>> * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
>>> * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
>>> * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
>>> * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
>>> * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
>>> * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
>>> * Cleanup of drivers when using ECW data ?is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
>>> * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
>>> * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
>>> * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
>>> * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
>>> * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
>>> * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
>>> * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
>>> * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>
>>>
>>> Utilities:
>>> * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
>>> * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
>>> * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>
>>>
>>> OGR:
>>> * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
>>> * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
>>> * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
>>> * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
>>> * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>
>>>
>>> Configuration:
>>> * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
>>> * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>
>>>
>>> Python:
>>> * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
>>> * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>
>>>
>>> OGR Spatial References:
>>> * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
>>> * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>
>>>
>>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From tom.van.tilburg at gmail.com  Thu Nov 26 01:44:27 2009
From: tom.van.tilburg at gmail.com (TomvanTilburg)
Date: Thu Nov 26 01:44:29 2009
Subject: [Gdal-dev] PROJ.4 EPSG:28992
In-Reply-To: <1259171167164-4066454.post@n2.nabble.com>
References: <5c6dd3b0751f426d8a62fd26d1095835@145.50.39.11>
	<47C8332B.1070003@pobox.com>
	<1259171167164-4066454.post@n2.nabble.com>
Message-ID: <1259217867103-4069671.post@n2.nabble.com>


Never mind, I was too quick in asking. 
It appeared to be a corrupted shapefile. Did it again with a new one and
worked like a charm.


TomvanTilburg wrote:
> 
> Hi,
> 
> Im relatively new to the GDAL package but I've got the feeling I'm hitting
> this same (old) problem.
> 
> At the moment I am trying to write a python script that transfers sets of
> shapefiles in the Dutch nation grid (EPSG 28992) to WGS84, ultimately to
> export them to KML files. Therefore I run the following code:
> .............
> 

-- 
View this message in context: http://n2.nabble.com/PROJ-4-EPSG-28992-tp2033665p4069671.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From weixj2003ld at 163.com  Thu Nov 26 03:17:08 2009
From: weixj2003ld at 163.com (weixj2003ld)
Date: Thu Nov 26 03:32:29 2009
Subject: [gdal-dev] how to display vector/raster data
Message-ID: <6683315.774241259223428140.JavaMail.coremail@bj163app30.163.com>

Hi,
1.I know that OpenEv can display satellite photos,what other opensource software can display it?
2.what is the main format of satellite photos?such .tif,what other?
Kind regards.
Wei
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091126/518b816e/attachment.html
From jorge.arevalo at gmail.com  Thu Nov 26 05:32:48 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Thu Nov 26 05:33:10 2009
Subject: [gdal-dev] how to display vector/raster data
In-Reply-To: <6683315.774241259223428140.JavaMail.coremail@bj163app30.163.com>
References: <6683315.774241259223428140.JavaMail.coremail@bj163app30.163.com>
Message-ID: <cb4457700911260232u52cb441bocf1eaf08b5f45ce7@mail.gmail.com>

Hi,

2009/11/26 weixj2003ld <weixj2003ld@163.com>:
> Hi,
> 1.I know that OpenEv can display satellite photos,what other opensource
> software can display it?

gvSIG, QGIS...


> 2.what is the main format of satellite photos?such .tif,what other?

GeoTIFF is a common format: http://en.wikipedia.org/wiki/GeoTIFF

> Kind regards.
> Wei
>
Best regards,
Jorge

>
> ________________________________
> "??"??????3D???????????????
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From tom.van.tilburg at gmail.com  Thu Nov 26 07:44:21 2009
From: tom.van.tilburg at gmail.com (TomvanTilburg)
Date: Thu Nov 26 07:44:22 2009
Subject: [Gdal-dev] PROJ.4 EPSG:28992
In-Reply-To: <47C8332B.1070003@pobox.com>
References: <5c6dd3b0751f426d8a62fd26d1095835@145.50.39.11>
	<47C8332B.1070003@pobox.com>
Message-ID: <1259239461411-4070970.post@n2.nabble.com>


Hi list,

Got a bit more info on this, hope someone can help.
It appears that running "geom.Transform(coordTrans)" on GDAL 1.6.0 PY 2.6.4
linux doesn't give an error while running the same script with the same
shapefile on GDAL 1.6.1 PY 2.6.3 winxp does produce the error (hence my
confusion yesterday when I saw it running on 1.6.0).

Summary:
inSpatialRef = osr.SpatialReference()
inSpatialRef.ImportFromEPSG(28992)
outSpatialRef = osr.SpatialReference()
outSpatialRef.ImportFromEPSG(4326)
coordTrans = osr.CoordinateTransformation(inSpatialRef, outSpatialRef)
...
geom.Transform(coordTrans)

trows an error with 
Anyone who can reproduce this?

I have a lot of data in Amserfoort coordinates that I'l like to transform
(in windows). Help would be greatly appreciated.

best regards,
 Tom


Frank Warmerdam wrote:
> 
> Bart van den Eijnden (OSGIS) wrote:
>> Hi list,
>> 
>> in PROJ version 4.6 the definition for the Dutch national grid
>> (EPSG:28992)
>> is missing the towgs84 parameters.
> 

-- 
View this message in context: http://n2.nabble.com/PROJ-4-EPSG-28992-tp2033665p4070970.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From micha at arava.co.il  Thu Nov 26 10:19:17 2009
From: micha at arava.co.il (Micha Silver)
Date: Thu Nov 26 08:20:15 2009
Subject: [gdal-dev] ECW in Southern Hemisphere
Message-ID: <4B0E9C75.2040102@arava.co.il>

I need to assist some agricultural projects using QGIS, and located in 
the Southern Hemisphere. They have a large set of ECW imagery which 
displays "up side down". It looks as if the images are rotated around 
their northern edge.  The northern edge is at the bottom of the map, and 
the southern edge at the top. Hope I've explained myself...
The imagery has no CRS in the metadata data but they are located in 
UTM40S. The same images in Arcview display correctly...

Any ideas how to overcome this would be greatly appreciated.

Thanks,
Micha

From jukka.rahkonen at mmmtike.fi  Thu Nov 26 10:15:07 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu Nov 26 10:15:38 2009
Subject: [gdal-dev] Re: ECW in Southern Hemisphere
References: <4B0E9C75.2040102@arava.co.il>
Message-ID: <loom.20091126T160950-603@post.gmane.org>

Micha Silver <micha <at> arava.co.il> writes:

> 
> I need to assist some agricultural projects using QGIS, and located in 
> the Southern Hemisphere. They have a large set of ECW imagery which 
> displays "up side down". It looks as if the images are rotated around 
> their northern edge.  The northern edge is at the bottom of the map, and 
> the southern edge at the top. Hope I've explained myself...
> The imagery has no CRS in the metadata data but they are located in 
> UTM40S. The same images in Arcview display correctly...
> 
> Any ideas how to overcome this would be greatly appreciated.

Hi,

If nothing else helps you could try to find an old ER Mapper utility program
called ECW Header editor somewhere. Perhaps ERDAS people at Leica can help you.
There is an option to set "Y Coordinates Increase: Upward/Downward".  But I fear
that everything is OK in the ecw file because Arcview shows it correctly and it
is QGis that cannot handle the situation.

-Jukka Rahkonen-

From dmorissette at mapgears.com  Thu Nov 26 10:18:24 2009
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Thu Nov 26 10:26:56 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
Message-ID: <4B0E9C40.7040100@mapgears.com>

Tested it and all looks good.

+1 to promote GDAL 1.6.3-RC2 to 1.6.3

Daniel

Howard Butler wrote:
> Even found a small issue with the Python bindings having their version number be 1.6.2.  I have issued an RC 2 to fix this.
> 
> http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
> http://download.osgeo.org/gdal/gdal163-RC2.zip
> 
> 
> On Nov 24, 2009, at 3:12 PM, Howard Butler wrote:
> 
>> I would like to motion to make the 1.6.3-rc1 official.  Please run a quick test if you have a chance before voting.
>>
>> +1 Howard
>>
>>
>> On Nov 19, 2009, at 10:09 PM, Howard Butler wrote:
>>
>>> All,
>>>
>>> The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.
>>>
>>> http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
>>> http://download.osgeo.org/gdal/gdal163-RC1.zip
>>>
>>> The following issues were addressed in this release:
>>>
>>> General:
>>> * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
>>> * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>
>>>
>>> GDAL:
>>> * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
>>> * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
>>> * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
>>> * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
>>> * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
>>> * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
>>> * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
>>> * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
>>> * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
>>> * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
>>> * Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
>>> * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
>>> * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
>>> * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
>>> * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
>>> * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
>>> * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
>>> * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
>>> * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>
>>>
>>> Utilities:
>>> * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
>>> * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
>>> * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>
>>>
>>> OGR:
>>> * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
>>> * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
>>> * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
>>> * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
>>> * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>
>>>
>>> Configuration:
>>> * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
>>> * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>
>>>
>>> Python:
>>> * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
>>> * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>
>>>
>>> OGR Spatial References:
>>> * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
>>> * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>
>>>
>>>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Daniel Morissette
http://www.mapgears.com/
From Boris.Vasiliev at forces.gc.ca  Thu Nov 26 11:11:35 2009
From: Boris.Vasiliev at forces.gc.ca (Boris.Vasiliev@forces.gc.ca)
Date: Thu Nov 26 11:12:48 2009
Subject: [gdal-dev] mdb to shape conversion: no geometry exported 
Message-ID: <CEF2A10A74B6DF4E940F3704ECC8B990144AC2C9@img-str-e002214.forces.mil.ca>

> Boris,
> I had not understood you were working on linux. I have been very
frustrated with the
> fragility of the mdbtools based odbc driver and I'm no longer
interested in investing 
> effort in supporting it. If you really really want it, then review: 
> http://trac.osgeo.org/gdal/wiki/mdbtools 
> There may also be open tickets on the issues. 
> Best regards, 
My apologies for the misunderstanding; I should have specified my
operating system at the beginning.  I will try to install FWtools on
Windows XP and check whether I can export the shape file from my .mbd
database.
Regards,
Boris,

From mail at danpearce.co.uk  Thu Nov 26 11:51:45 2009
From: mail at danpearce.co.uk (DevonDan)
Date: Thu Nov 26 11:51:47 2009
Subject: [Gdal-dev] Compiling GRASS for Windows with GDAL 1.6
Message-ID: <1259254305101-4072071.post@n2.nabble.com>


Hi all,

Apologies if this is a bit of a dumb question, but can anyone point me in
the direction of a guide to compiling GRASS so that it includes/makes use of
GDAL 1.6? This has to be a Windows only solution though as the people we are
working with don't have *NIX based machines.

The reason for this is that I would like to be able to read/display GRIB
files and, to the best of my understanding, this is not possible using GDAL
1.5. If I am wrong, or there is another solution, I would be most grateful
for your tips.

Thanks in advance for your time,

Dan
-- 
View this message in context: http://n2.nabble.com/Compiling-GRASS-for-Windows-with-GDAL-1-6-tp4072071p4072071.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From sunburned.surveyor at gmail.com  Thu Nov 26 12:02:57 2009
From: sunburned.surveyor at gmail.com (Sunburned Surveyor)
Date: Thu Nov 26 12:03:00 2009
Subject: [gdal-dev] Accessing GDAL/OGR From Python: Simple Feature and
	Rasters
Message-ID: <71097ae20911260902y1fb1fddes6f5d4d93b8087eae@mail.gmail.com>

Ragi Burhum and I decided it would be good if the California Chapter
of the OSGeo could get together to work on a simple open source GIS
project. (California is the home to the Silicon Valley, after all.)
After kicking around several ideas for projects, we decided to work on
a set of geoprocessing pipes implemented in Python. I am not an
experienced Python programmer, or very familiar with GDAL/OGR. But I'm
ready to learn Python, and Ragi has worked with GDAL/OGR in C++.

I'm trying to start work on my first pipe for our project. The input
of this pipe will be a set of simple features represented by point
geometries and an elevation grid/surface. The output of the pipe will
be a modified set of simple features. The point geometries of these
modified simple features will have an elevation based on the points
horizontal location "over" the elevation grid.

Here are my questions:

Is there a OGR programming construct to represent a simple feature? If
there is, can you tell me where to look for the Python files that
would represent these simple features? Is there any example Python
code that will show me how to obtain simple features from an ESRI
Shapefile?

I also need to know if GDAL has programming constructs to work with
elevation grids. If it does, where do I look for those Python files?

I realize that GDAL/OGR are written in C++ and not Python. If there
isn't a place to easiliy locate the Python files then I will work with
Ragi to build the Python files from the C++ source using SWIG
(something I know absolutely nothing about).

I know everyone is busy. I don't want anyone to write my code for me,
but any suggestions on where I start looking in the source code so I
can learn how to do what I need with the library is appreciated.

I will make a commitment to make documentation/Python code for working
with GDAL/ODR that results from our project available to everyone that
is interested.

Thanks for the help. Please remember I am a Java programmer, which
means I will require extra patience. Ragi and I wanted to get some
working code before we announce our project to the OSGeo community, so
I appreciate your discretion while we get things started. We don't
want to be dismissed as another idea that is all talk and no
substance. :]

Landon
From jluis at ualg.pt  Thu Nov 26 12:05:07 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu Nov 26 12:05:18 2009
Subject: [Gdal-dev] Compiling GRASS for Windows with GDAL 1.6
In-Reply-To: <1259254305101-4072071.post@n2.nabble.com>
References: <1259254305101-4072071.post@n2.nabble.com>
Message-ID: <4B0EB543.2000204@ualg.pt>

DevonDan wrote:
> The reason for this is that I would like to be able to read/display GRIB
> files and, to the best of my understanding, this is not possible using GDAL
> 1.5. If I am wrong, or there is another solution, I would be most grateful
> for your tips.
>   

You can display (plot) them with GMT, if GMT (4.5.1) wast built with 
GDAL support.
There are "official" Win binaries build that way that require only 
FWTools, and I also have one that is stand-alone at

 ftp://ftp.ualg.pt/users/jluis/m_gmt/GMT4.5.1_VC71_setup.exe

Joaquim Luis

From jmckenna at gatewaygeomatics.com  Thu Nov 26 12:04:05 2009
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu Nov 26 12:10:47 2009
Subject: [Gdal-dev] Compiling GRASS for Windows with GDAL 1.6
In-Reply-To: <1259254305101-4072071.post@n2.nabble.com>
References: <1259254305101-4072071.post@n2.nabble.com>
Message-ID: <4B0EB505.5090502@gatewaygeomatics.com>

DevonDan wrote:
> Hi all,
> 
> Apologies if this is a bit of a dumb question, but can anyone point me in
> the direction of a guide to compiling GRASS so that it includes/makes use of
> GDAL 1.6? This has to be a Windows only solution though as the people we are
> working with don't have *NIX based machines.
> 
> The reason for this is that I would like to be able to read/display GRIB
> files and, to the best of my understanding, this is not possible using GDAL
> 1.5. If I am wrong, or there is another solution, I would be most grateful
> for your tips.
> 
> Thanks in advance for your time,
> 

Hi Dan,

Some resources for you:

Compiling winGRASS:

http://trac.osgeo.org/grass/wiki/BuildingOnWindows
http://trac.osgeo.org/grass/wiki/CompileOnWindows

winGRASS Mailing list:

http://lists.osgeo.org/mailman/listinfo/grass-windows


OSGeo4W (windows package containing GRASS and GDAL):

http://trac.osgeo.org/osgeo4w/


have fun!

-jeff


-- 
Jeff McKenna
FOSS4G Consulting and Training Services
http://www.gatewaygeomatics.com/


From dylan.beaudette at gmail.com  Thu Nov 26 12:18:12 2009
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu Nov 26 12:18:14 2009
Subject: [gdal-dev] Accessing GDAL/OGR From Python: Simple Feature and 
	Rasters
In-Reply-To: <71097ae20911260902y1fb1fddes6f5d4d93b8087eae@mail.gmail.com>
References: <71097ae20911260902y1fb1fddes6f5d4d93b8087eae@mail.gmail.com>
Message-ID: <3c5546140911260918r1bb60c54x4677451e43cc2949@mail.gmail.com>

Hi,

There are lots of examples out there, many of them in blog postings. A
couple come to mind:

http://www.perrygeo.net/wordpress/
http://casoilresource.lawr.ucdavis.edu/drupal/node/288
http://casoilresource.lawr.ucdavis.edu/drupal/node/610

Good luck!

Dylan


On Thu, Nov 26, 2009 at 9:02 AM, Sunburned Surveyor
<sunburned.surveyor@gmail.com> wrote:
> Ragi Burhum and I decided it would be good if the California Chapter
> of the OSGeo could get together to work on a simple open source GIS
> project. (California is the home to the Silicon Valley, after all.)
> After kicking around several ideas for projects, we decided to work on
> a set of geoprocessing pipes implemented in Python. I am not an
> experienced Python programmer, or very familiar with GDAL/OGR. But I'm
> ready to learn Python, and Ragi has worked with GDAL/OGR in C++.
>
> I'm trying to start work on my first pipe for our project. The input
> of this pipe will be a set of simple features represented by point
> geometries and an elevation grid/surface. The output of the pipe will
> be a modified set of simple features. The point geometries of these
> modified simple features will have an elevation based on the points
> horizontal location "over" the elevation grid.
>
> Here are my questions:
>
> Is there a OGR programming construct to represent a simple feature? If
> there is, can you tell me where to look for the Python files that
> would represent these simple features? Is there any example Python
> code that will show me how to obtain simple features from an ESRI
> Shapefile?
>
> I also need to know if GDAL has programming constructs to work with
> elevation grids. If it does, where do I look for those Python files?
>
> I realize that GDAL/OGR are written in C++ and not Python. If there
> isn't a place to easiliy locate the Python files then I will work with
> Ragi to build the Python files from the C++ source using SWIG
> (something I know absolutely nothing about).
>
> I know everyone is busy. I don't want anyone to write my code for me,
> but any suggestions on where I start looking in the source code so I
> can learn how to do what I need with the library is appreciated.
>
> I will make a commitment to make documentation/Python code for working
> with GDAL/ODR that results from our project available to everyone that
> is interested.
>
> Thanks for the help. Please remember I am a Java programmer, which
> means I will require extra patience. Ragi and I wanted to get some
> working code before we announce our project to the OSGeo community, so
> I appreciate your discretion while we get things started. We don't
> want to be dismissed as another idea that is all talk and no
> substance. :]
>
> Landon
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From warmerdam at pobox.com  Thu Nov 26 12:24:41 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Nov 26 12:24:34 2009
Subject: [gdal-dev] Accessing GDAL/OGR From Python: Simple Feature and
	Rasters
In-Reply-To: <71097ae20911260902y1fb1fddes6f5d4d93b8087eae@mail.gmail.com>
References: <71097ae20911260902y1fb1fddes6f5d4d93b8087eae@mail.gmail.com>
Message-ID: <4B0EB9D9.4030801@pobox.com>

Sunburned Surveyor wrote:
> Is there a OGR programming construct to represent a simple feature? 

Landon,

The OGRGeometry class represents a simple feature geometry.  The
OGRFeature class extends this to a feature with attributes and
a feature id.  I would suggest reviewing the OGR Architecture
document at:

   http://www.gdal.org/ogr/ogr_arch.html

 > If
> there is, can you tell me where to look for the Python files that
> would represent these simple features? 

GDAL/OGR includes excellent Python bindings.  Some background
information is available at:

   http://trac.osgeo.org/gdal/wiki/GdalOgrInPython

 > Is there any example Python
> code that will show me how to obtain simple features from an ESRI
> Shapefile?

The GdalOgrInPython doc points to a variety of samples and utilities
implemented in Python.  The:

http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/get_soundg.py

script is an example of reading features from one source and writing
them to a shapefile and might be helpful.  The

http://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal2xyz.py

script reads a raster and converts to x/y/z text format and might
be a decent model for accessing raster data.

> I also need to know if GDAL has programming constructs to work with
> elevation grids. If it does, where do I look for those Python files?

Elevation grids are rasters covered by the "GDAL" side of GDAL/OGR.
You would "from osgeo import gdal" to get the interfaces.  Lots of docs
on the GDAL page including:

   http://www.gdal.org/gdal_tutorial.html
   http://www.gdal.org/gdal_datamodel.html

> I know everyone is busy. I don't want anyone to write my code for me,
> but any suggestions on where I start looking in the source code so I
> can learn how to do what I need with the library is appreciated.

With all respect I *feel* like you haven't yet really made a major
effort to scour the GDAL/OGR web site for information yet.

> I will make a commitment to make documentation/Python code for working
> with GDAL/ODR that results from our project available to everyone that
> is interested.

It might be suitable for submission to the Python samples directories.
Also feel free to improve the GdalOgrInPython Trac page.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Thu Nov 26 14:33:28 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Nov 26 14:33:36 2009
Subject: [Gdal-dev] PROJ.4 EPSG:28992
In-Reply-To: <1259239461411-4070970.post@n2.nabble.com>
References: <5c6dd3b0751f426d8a62fd26d1095835@145.50.39.11>	<47C8332B.1070003@pobox.com>
	<1259239461411-4070970.post@n2.nabble.com>
Message-ID: <4B0ED808.20700@mines-paris.org>

A few points to check that come to mind :
* Did you check that the proj.dll can be loaded by GDAL ? Check an error 
message about it
* Is the GDAL_DATA environment variable correctly set ?
* If testepsg.exe is compiled (nmake /f makefile.vc testepsg.exe in apps 
directory should do), try testepsg EPSG:28992

TomvanTilburg a ?crit :
> Hi list,
>
> Got a bit more info on this, hope someone can help.
> It appears that running "geom.Transform(coordTrans)" on GDAL 1.6.0 PY 2.6.4
> linux doesn't give an error while running the same script with the same
> shapefile on GDAL 1.6.1 PY 2.6.3 winxp does produce the error (hence my
> confusion yesterday when I saw it running on 1.6.0).
>
> Summary:
> inSpatialRef = osr.SpatialReference()
> inSpatialRef.ImportFromEPSG(28992)
> outSpatialRef = osr.SpatialReference()
> outSpatialRef.ImportFromEPSG(4326)
> coordTrans = osr.CoordinateTransformation(inSpatialRef, outSpatialRef)
> ...
> geom.Transform(coordTrans)
>
> trows an error with 
> Anyone who can reproduce this?
>
> I have a lot of data in Amserfoort coordinates that I'l like to transform
> (in windows). Help would be greatly appreciated.
>
> best regards,
>  Tom
>
>
> Frank Warmerdam wrote:
>   
>> Bart van den Eijnden (OSGIS) wrote:
>>     
>>> Hi list,
>>>
>>> in PROJ version 4.6 the definition for the Dutch national grid
>>> (EPSG:28992)
>>> is missing the towgs84 parameters.
>>>       
>
>   


From jmckenna at gatewaygeomatics.com  Thu Nov 26 14:42:06 2009
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu Nov 26 14:48:49 2009
Subject: [Gdal-dev] PROJ.4 EPSG:28992
In-Reply-To: <4B0ED808.20700@mines-paris.org>
References: <5c6dd3b0751f426d8a62fd26d1095835@145.50.39.11>	<47C8332B.1070003@pobox.com>	<1259239461411-4070970.post@n2.nabble.com>
	<4B0ED808.20700@mines-paris.org>
Message-ID: <4B0EDA0E.1020500@gatewaygeomatics.com>

Even Rouault wrote:
> * If testepsg.exe is compiled (nmake /f makefile.vc testepsg.exe in apps 
> directory should do), try testepsg EPSG:28992
> 

As there doesn't appear to be any documentation on this utility, maybe a 
small page should be created on the GDAL Trac Wiki for testepsg? 
(http://trac.osgeo.org/gdal/)

-jeff




From AWilliams at rapidmap.com  Thu Nov 26 19:24:08 2009
From: AWilliams at rapidmap.com (Andrew Williams)
Date: Thu Nov 26 19:25:17 2009
Subject: [gdal-dev] ECW in Southern Hemisphere
In-Reply-To: <4B0E9C75.2040102@arava.co.il>
References: <4B0E9C75.2040102@arava.co.il>
Message-ID: <29C3A52E0876C94C97BD6443FA96F733A19A862935@rms03.rapidmap.local>

It sounds like there is a companion file like a .PRJ, or something that is telling ArcView what to do with the image. Having no CRS in the ECW it's probably causing QGIS to just attempt to load the file and do the best it can.

Perhaps enquiring as to whether a companion file exists with the ECW set and then pushing this detail into the ECW header using something like ECW Header editor from ERM will correct the issue.

-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Micha Silver
Sent: Friday, 27 November 2009 2:19 AM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] ECW in Southern Hemisphere

I need to assist some agricultural projects using QGIS, and located in
the Southern Hemisphere. They have a large set of ECW imagery which
displays "up side down". It looks as if the images are rotated around
their northern edge.  The northern edge is at the bottom of the map, and
the southern edge at the top. Hope I've explained myself...
The imagery has no CRS in the metadata data but they are located in
UTM40S. The same images in Arcview display correctly...

Any ideas how to overcome this would be greatly appreciated.

Thanks,
Micha

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From weixj2003ld at 163.com  Thu Nov 26 22:44:25 2009
From: weixj2003ld at 163.com (weixj2003ld)
Date: Thu Nov 26 22:44:38 2009
Subject: [gdal-dev] compile qgis
Message-ID: <14654478.197201259293465990.JavaMail.coremail@bj163app123.163.com>

Hi,
I want to display satellite photos in my program(developmented by Qt+VC2005),Must I use GDAL(Does it only read/write geotiff data?)+QSIS(does it only display geotiff data?)?
Must I compile QGIS from scratch?
Kind regards?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091127/5feeb404/attachment.html
From craig.leat at gmail.com  Fri Nov 27 01:22:14 2009
From: craig.leat at gmail.com (Craig Leat)
Date: Fri Nov 27 01:22:17 2009
Subject: [gdal-dev] gdalwarp -of JPEG
Message-ID: <1fef7d9b0911262222o5d6469fv323f03dcdd1e4ae1@mail.gmail.com>

Hi,

I have noted with gdal 1.6.1 that gdalwarp -of JPEG returns the error
message "Output driver `JPEG' not recognised or does not support
direct output file creation." However, gdal_translate -of JPEG works.
Is there any justifiable reason that gdalwarp does not support writing
JPEG or is wrapping JPEG inside GTiff the usually way of doing things?

Thanks for any insights,

Craig
From jukka.rahkonen at mmmtike.fi  Fri Nov 27 05:01:32 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri Nov 27 05:01:52 2009
Subject: [gdal-dev] Re: gdalwarp -of JPEG
References: <1fef7d9b0911262222o5d6469fv323f03dcdd1e4ae1@mail.gmail.com>
Message-ID: <loom.20091127T105126-534@post.gmane.org>

Craig Leat <craig.leat <at> gmail.com> writes:

> 
> Hi,
> 
> I have noted with gdal 1.6.1 that gdalwarp -of JPEG returns the error
> message "Output driver `JPEG' not recognised or does not support
> direct output file creation." However, gdal_translate -of JPEG works.
> Is there any justifiable reason that gdalwarp does not support writing
> JPEG or is wrapping JPEG inside GTiff the usually way of doing things?
> 
> Thanks for any insights,

Hi,

I believe that in warping process data needs to be written in arbitrary places
into the output image and that can be impossible or ineffective if the target
image is jpeg compressed.  I guess it might be done somehow when simply warping
one whole image to another projection as it is, but gdalwarp can do other nice
things like warping from virtual mosaic or warp new data into an existing output
image. Let gdalwarp create an uncompressed tiff first and compress it to jpeg
afterwards. I bet it is also the fastest way do get the job done.

-Jukka Rahkonen-


From warmerdam at pobox.com  Fri Nov 27 08:26:55 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Nov 27 08:26:46 2009
Subject: [gdal-dev] Re: gdalwarp -of JPEG
In-Reply-To: <loom.20091127T105126-534@post.gmane.org>
References: <1fef7d9b0911262222o5d6469fv323f03dcdd1e4ae1@mail.gmail.com>
	<loom.20091127T105126-534@post.gmane.org>
Message-ID: <4B0FD39F.9000007@pobox.com>

Jukka Rahkonen wrote:
> Craig Leat <craig.leat <at> gmail.com> writes:
> 
>> Hi,
>>
>> I have noted with gdal 1.6.1 that gdalwarp -of JPEG returns the error
>> message "Output driver `JPEG' not recognised or does not support
>> direct output file creation." However, gdal_translate -of JPEG works.
>> Is there any justifiable reason that gdalwarp does not support writing
>> JPEG or is wrapping JPEG inside GTiff the usually way of doing things?
>>
>> Thanks for any insights,
> 
> Hi,
> 
> I believe that in warping process data needs to be written in arbitrary places
> into the output image and that can be impossible or ineffective if the target
> image is jpeg compressed.  I guess it might be done somehow when simply warping
> one whole image to another projection as it is, but gdalwarp can do other nice
> things like warping from virtual mosaic or warp new data into an existing output
> image. Let gdalwarp create an uncompressed tiff first and compress it to jpeg
> afterwards. I bet it is also the fastest way do get the job done.

Craig,

Jukka is correct.  There is a bit more information on this in the FAQ:

http://trac.osgeo.org/gdal/wiki/FAQRaster#Whywontgdalwarporgdal_mergewritetomostformats

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From hobu.inc at gmail.com  Fri Nov 27 14:57:10 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Nov 27 15:07:15 2009
Subject: [gdal-dev] Motion: Promote GDAL 1.6.3-RC2 to 1.6.3
In-Reply-To: <4B0E9C40.7040100@mapgears.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
	<4B0E9C40.7040100@mapgears.com>
Message-ID: <4055E14E-8060-45E5-A6FB-3A0BF42E6969@gmail.com>

After three days and +1's from Daniel, Frank, Even, myself, and Tamas, I declare the motion passed.  I will make the announcement shortly.

Howard

On Nov 26, 2009, at 9:18 AM, Daniel Morissette wrote:

> Tested it and all looks good.
> 
> +1 to promote GDAL 1.6.3-RC2 to 1.6.3
> 
> Daniel
> 
> Howard Butler wrote:
>> Even found a small issue with the Python bindings having their version number be 1.6.2.  I have issued an RC 2 to fix this.
>> http://download.osgeo.org/gdal/gdal-1.6.3-RC2.tar.gz
>> http://download.osgeo.org/gdal/gdal163-RC2.zip
>> On Nov 24, 2009, at 3:12 PM, Howard Butler wrote:
>>> I would like to motion to make the 1.6.3-rc1 official.  Please run a quick test if you have a chance before voting.
>>> 
>>> +1 Howard
>>> 
>>> 
>>> On Nov 19, 2009, at 10:09 PM, Howard Butler wrote:
>>> 
>>>> All,
>>>> 
>>>> The GDAL team is pleased to announce the release of GDAL 1.6.3 RC1.
>>>> 
>>>> http://download.osgeo.org/gdal/gdal-1.6.3-RC1.tar.gz
>>>> http://download.osgeo.org/gdal/gdal163-RC1.zip
>>>> 
>>>> The following issues were addressed in this release:
>>>> 
>>>> General:
>>>> * r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125/>
>>>> * GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209/>
>>>> 
>>>> GDAL:
>>>> * GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146/>
>>>> * Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270/>
>>>> * Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511/>
>>>> * ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907/>
>>>> * Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956/>
>>>> * Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989/>
>>>> * do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088/>
>>>> * [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112/>
>>>> * GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124/>
>>>> * SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130/>
>>>> * Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134/>
>>>> * When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151/>
>>>> * HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152/>
>>>> * undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167/>
>>>> * variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177/>
>>>> * GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189/>
>>>> * ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196/>
>>>> * Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207/>
>>>> * HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218/>
>>>> 
>>>> Utilities:
>>>> * Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783/>
>>>> * gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198/>
>>>> * [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206/>
>>>> 
>>>> OGR:
>>>> * OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694/>
>>>> * GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948/>
>>>> * GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156/>
>>>> * OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163/>
>>>> * XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164/>
>>>> 
>>>> Configuration:
>>>> * libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080/>
>>>> * Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149/>
>>>> 
>>>> Python:
>>>> * Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137/>
>>>> * ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173/>
>>>> 
>>>> OGR Spatial References:
>>>> * EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136/>
>>>> * Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187/>
>>>> 
>>>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> -- 
> Daniel Morissette
> http://www.mapgears.com/
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From hobu.inc at gmail.com  Fri Nov 27 14:59:12 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Fri Nov 27 15:09:14 2009
Subject: [gdal-dev] GDAL 1.6.3 released
In-Reply-To: <4055E14E-8060-45E5-A6FB-3A0BF42E6969@gmail.com>
References: <455014C8-CC57-476D-90AA-D8D0243457FA@gmail.com>	<27FDEA6B-73F8-4458-A189-84C7B811C83C@gmail.com>
	<BD698357-5870-4E1C-AA60-59AECC615026@gmail.com>
	<4B0E9C40.7040100@mapgears.com>
	<4055E14E-8060-45E5-A6FB-3A0BF42E6969@gmail.com>
Message-ID: <0F637640-C47E-4162-823D-C092C15680D2@gmail.com>

All,

The GDAL team is pleased to announce the release of GDAL 1.6.3.

http://download.osgeo.org/gdal/gdal-1.6.3.tar.gz
http://download.osgeo.org/gdal/gdal163.zip

The following issues were addressed in this release:

General:
* r13533 (ogr postgis plugin) have been added to the stable branch only <http://trac.osgeo.org/gdal/ticket/3125>
* GRIB detection not thread safe <http://trac.osgeo.org/gdal/ticket/3209>

GDAL:
* GDALRasterizeLayers() and GDALRasterizeGeometries() segfault when passed invalid band numbers <http://trac.osgeo.org/gdal/ticket/3146>
* Patch for HDF5 block size recognition <http://trac.osgeo.org/gdal/ticket/2270>
* Gdal doesn't calculate stats correctly if it is negative number <http://trac.osgeo.org/gdal/ticket/2511>
* ERS file pointing to an ECW file is not opening when a full path name is not specified <http://trac.osgeo.org/gdal/ticket/2907>
* Keyword causing format unrecognized (PDS) <http://trac.osgeo.org/gdal/ticket/2956>
* Add support for large NITF files <http://trac.osgeo.org/gdal/ticket/2989>
* do not remove leading spaces after TRE=xxxx= metadata when writing them <http://trac.osgeo.org/gdal/ticket/3088>
* [PATCH] TSX COSAR driver and 'pixel validity mask' <http://trac.osgeo.org/gdal/ticket/3112>
* GDALDataset::BlockBasedRasterIO() does not use overviews <http://trac.osgeo.org/gdal/ticket/3124>
* SIGBUS when reading A.TOC on Solaris <http://trac.osgeo.org/gdal/ticket/3130>
* Cleanup of drivers when using ECW data  is very expensive <http://trac.osgeo.org/gdal/ticket/3134>
* When PIXELTYPE=SIGNEDBYTE, band.GetStatistics returns wrong values <http://trac.osgeo.org/gdal/ticket/3151>
* HFA doesn't support reading COMPRESSED + SIGNEDBYTE <http://trac.osgeo.org/gdal/ticket/3152>
* undefined reference to ... error with gdalbuildvrt.cpp <http://trac.osgeo.org/gdal/ticket/3167>
* variation on label to image pointer (PDS) <http://trac.osgeo.org/gdal/ticket/3177>
* GDALGridCreate with NULL progress callback function <http://trac.osgeo.org/gdal/ticket/3189>
* ERS driver fails with ERSs containing relative paths to non-ERStorage rasters <http://trac.osgeo.org/gdal/ticket/3196>
* Wrong type casting in GDALGrid data metrics functions <http://trac.osgeo.org/gdal/ticket/3207>
* HDF5 driver crashes with stackoverflow on this HDF5 image <http://trac.osgeo.org/gdal/ticket/3218>

Utilities:
* Python utililities should support command-line wildcards <http://trac.osgeo.org/gdal/ticket/2783>
* gdalbuildvrt -resolution lowest/highest does not work correcty for y pixel size <http://trac.osgeo.org/gdal/ticket/3198>
* [PATCH] Part of the reprojected image is missing from GDAL 1.6.0 along 180E/180W longitude <http://trac.osgeo.org/gdal/ticket/3206>

OGR:
* OGRLayer::GetFIDColumn() and GetGeometryColumn() just return empty strings from Python bindings <http://trac.osgeo.org/gdal/ticket/2694>
* GML read failure for GDAL 1.6+ <http://trac.osgeo.org/gdal/ticket/2948>
* GML reading problems with Xerces 3.x <http://trac.osgeo.org/gdal/ticket/3156>
* OGRLayer::GetFeatureCount returns a wrong value for SOUNDG layer <http://trac.osgeo.org/gdal/ticket/3163>
* XPlane driver causes fatal memory allocation in ogrinfo/ogr2ogr <http://trac.osgeo.org/gdal/ticket/3164>

Configuration:
* libtool: /bin/sh: arg list too long (powerpc-ibm-aix5.3) <http://trac.osgeo.org/gdal/ticket/3080>
* Error when building the gdal 1.6.2 for Linux <http://trac.osgeo.org/gdal/ticket/3149>

Python:
* Add __version__ to python bindings <http://trac.osgeo.org/gdal/ticket/3137>
* ReadRaster() crashes when GDAL is built with MinGW <http://trac.osgeo.org/gdal/ticket/3173>

OGR Spatial References:
* EPSG:3785 does not support spherical mercator hack <http://trac.osgeo.org/gdal/ticket/3136>
* Add 2 NZ coordinate system definition to mitab driver <http://trac.osgeo.org/gdal/ticket/3187>


From patsv at bredband.net  Sun Nov 29 03:01:14 2009
From: patsv at bredband.net (patsv)
Date: Sun Nov 29 03:21:58 2009
Subject: [gdal-dev] Problem with readraster in C#
Message-ID: <004401ca70ca$1f936ae0$5eba40a0$@net>

Hi,  I am trying to read GDEM data from the ASTER dataset.

But all I get is a buffer with zeroes, is there something wrong with my code
or is it something with the readraster function.

 

Part of my code:

       Band band = ds.GetRasterBand(1);

       short[] DEM = new short[band.XSize * band.YSize];

          

       CPLErr Ret = band.ReadRaster(0, 0, band.XSize,band.YSize, DEM,
band.XSize, band.YSize, 2, band.XSize * 2);

       if (Ret != CPLErr.CE_None)

       {

                throw new Exception("Read error " + Ret.ToString());

       }

 

As mentioned above all I get is a buffer filled with Zeroes.

 

Thanks for a good library.

 

Regards

Patrik Svensson

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091129/b6c6080a/attachment.html
From giohappy at gmail.com  Sun Nov 29 07:30:48 2009
From: giohappy at gmail.com (G. Allegri)
Date: Sun Nov 29 07:30:53 2009
Subject: [gdal-dev] build gdal 1.6.2 with nmake and vc9
Message-ID: <e12429640911290430k87ef3au13de017f59408169@mail.gmail.com>

I'm trying to compile/build gdal fo windows, with minimal external libraries
set in nmake.opt (just expat and postgresql).
As explained by the docs, the deafult target is Debug, in fact it tries to
link libpqd.dll for postgres, which I suppose is the debug version.
Anyway I'm not sure how to set the Release target...
In the default nmake.opt there are the following otflags:

# Compilation flags
!IFNDEF OPTFLAGS
!IF $(MSVC_VER) >= 1400
!IFNDEF DEBUG
OPTFLAGS= /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
/D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
!ELSE
OPTFLAGS= /nologo /MD /EHsc /Zi /W4 /D_CRT_SECURE_NO_DEPRECATE
/D_CRT_NONSTDC_NO_DEPRECATE /Fd$(GDAL_ROOT)\gdal$(VERSION)
.pdb
!ENDIF
!ELSE
!IFNDEF DEBUG
OPTFLAGS=    /nologo /MD /EHsc /GR /Ox /W3 /DNDEBUG
!ELSE
#OPTFLAGS=    /nologo /MD /GX /Ox
#OPTFLAGS=    /nologo /MD /EHsc /GR /Zi /W4
/Fd$(GDAL_ROOT)\gdal$(VERSION).pdb
!ENDIF
!ENDIF  #MSVC_VER
!ENDIF  # OPTFLAGS

In my case, using the vc9 (MSVC_VER=1500), the following flags are set:

OPTFLAGS= /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
/D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG

I'm not experiences with Windows build, so ?m not sure about the meaning of
these flags, and in particular /DNDEBUG.
Is the Debug target set here? Otherwise, where is it set as default?
A bit confused....

thanks for any explanation,
giovanni
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091129/c2fa8e72/attachment.html
From giohappy at gmail.com  Sun Nov 29 16:13:09 2009
From: giohappy at gmail.com (G. Allegri)
Date: Sun Nov 29 16:13:12 2009
Subject: [gdal-dev] Re: build gdal 1.6.2 with nmake and vc9
In-Reply-To: <e12429640911290430k87ef3au13de017f59408169@mail.gmail.com>
References: <e12429640911290430k87ef3au13de017f59408169@mail.gmail.com>
Message-ID: <e12429640911291313x6fe0ec2cq66827be84c199226@mail.gmail.com>

SOLVED.
Sorry, it was a problem with a wrong parameter in my nmale.opt which caused
the DEBUG flag being set.

giovanni

2009/11/29 G. Allegri <giohappy@gmail.com>

> I'm trying to compile/build gdal fo windows, with minimal external
> libraries set in nmake.opt (just expat and postgresql).
> As explained by the docs, the deafult target is Debug, in fact it tries to
> link libpqd.dll for postgres, which I suppose is the debug version.
> Anyway I'm not sure how to set the Release target...
> In the default nmake.opt there are the following otflags:
>
> # Compilation flags
> !IFNDEF OPTFLAGS
> !IF $(MSVC_VER) >= 1400
> !IFNDEF DEBUG
> OPTFLAGS= /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
> !ELSE
> OPTFLAGS= /nologo /MD /EHsc /Zi /W4 /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /Fd$(GDAL_ROOT)\gdal$(VERSION)
> .pdb
> !ENDIF
> !ELSE
> !IFNDEF DEBUG
> OPTFLAGS=    /nologo /MD /EHsc /GR /Ox /W3 /DNDEBUG
> !ELSE
> #OPTFLAGS=    /nologo /MD /GX /Ox
> #OPTFLAGS=    /nologo /MD /EHsc /GR /Zi /W4
> /Fd$(GDAL_ROOT)\gdal$(VERSION).pdb
> !ENDIF
> !ENDIF  #MSVC_VER
> !ENDIF  # OPTFLAGS
>
> In my case, using the vc9 (MSVC_VER=1500), the following flags are set:
>
> OPTFLAGS= /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG
>
> I'm not experiences with Windows build, so ?m not sure about the meaning of
> these flags, and in particular /DNDEBUG.
> Is the Debug target set here? Otherwise, where is it set as default?
> A bit confused....
>
> thanks for any explanation,
> giovanni
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091129/1af87438/attachment.html
From udadi at gmu.edu  Mon Nov 30 01:46:21 2009
From: udadi at gmu.edu (Upendra Dadi)
Date: Mon Nov 30 01:46:31 2009
Subject: [gdal-dev] reading geotiff data from STDIN
Message-ID: <4D502C9669C6487B9E24EFDA647B4205@UpendraPC>

Hi,
  Is it possible to read geotiff data from standard input(STDIN) and write to standard output (STDOUT) instead of reading from a file? I see the following in the documentation to GDALOpen():

pszFilename the name of the file to access. In the case of exotic drivers this may not refer to a physical file, but instead contain information for the driver on how to access a dataset.

What options does Geotiff driver have for pszFilename? If I want to modify Geotiff driver to read and write from STDIN and STDOUT respectively, which files should I be looking at? 

Ability to do this might be useful if using GDAL in a Hadoop MapReduce job with streaming. Geotiff format could be the serialization format that MapReduce expects. If it is not already there, it might be useful to add this feature. It could make it a bit easier to use GDAL within a Cloud environment.  Thanks.

Upendra
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091130/dececc52/attachment.html
From jukka.rahkonen at mmmtike.fi  Mon Nov 30 07:25:13 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon Nov 30 07:25:38 2009
Subject: [gdal-dev] Why does OCI driver fail with SRID?
Message-ID: <loom.20091130T123729-827@post.gmane.org>

Hi,

Short question: I cannot get ogr2ogr to co-operate with me and Oracle
Spatial if I want to set the table SRID by using its EPSG code.  I can do what I
want by using SQL*Plus but not with ogr2ogr. What am I doing wrong?

Longish description follows.

I was trying to use ogr2ogr that comes with MS4W 3.0 (dgal version 1.7.0dev) for

a) Importing a shapefile into Oracle 10g and give SRID at the same time.
b) Appending date into existing table with SRID set.

The SRID I would like to use is epsg:2393.  It is configured it in Oracle as can
be seen from the following SQL query:

select * from mdsys.cs_srs where srid=2393;
CS_NAME | SRID |AUTH_SRID |AUTH_NAME |WKTEXT |CS_BOUNDS

KKJ / Finland Uniform Coordinate System
      2393       2393
www.nls.fi/maa/papers/kkj.html
PROJCS["KKJ / Finland Uniform Coordinate System", 
GEOGCS [ "KKJ", DATUM ["Kartasto Koordinaati Jarjestelma 1966 
(EPSG ID 6123)", SPHEROID ["International 1924 (EPSG ID 7022)",
6378388.0, 297.0], -90.7, -106.1, -119.2, 4.09, 0.218, -1.05, 
1.37], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
0.01745329251994328]], PROJECTION ["Finland Uniform Coordinate 
System (EPSG OP 18193)"], PARAMETER ["Latitude_Of_Origin", 0.0],
 PARAMETER ["Central_Meridian", 27.0], PARAMETER 
["Scale_Factor", 1.0], PARAMETER ["False_Easting", 3500000.0],
 PARAMETER ["False_Northing", 0.0], UNIT ["Meter", 1.0]]

Case a) Importing data to new table with ogr2ogr
================================================
Command:
ogr2ogr -f "OCI" OCI:username/passwd@db:test -a_srs epsg:2393 test.shp

Result: Table is created and features are inserted, but without SRID set.
Ogr2ogr is trying to insert a new line into the table MDSYS.CS_SRS but it fails
because of insufficient privileges
ERROR 1: ORA-01031: insufficient privileges
 in INSERT INTO MDSYS.CS_SRS (SRID, WKTEXT, CS_NAME) 
 VALUES (1000003006,'PROJCS["KKJ / Finland Uniform Coordinate 
System",GEOGCS["KKJ",DATUM["Kartastokoordinaattijarjestelma_1966",
SPHEROID["International 1924",6378388,297]],PRIMEM["Greenwich",0],
UNIT["Decimal Degree",0.0174532925199433]],UNIT["metre",1],
PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],
PARAMETER["central_meridian",27],PARAMETER["scale_factor",1],
PARAMETER["false_easting",3500000],PARAMETER["false_northing",0]]',
 'KKJ / Finland Uniform Coordinate System' )

I wonder why org2ogr is trying to add the projection, because SRID 2393 is
already defined in the database, and why it would like to insert my SRID=2393  
with code "1000003006".

Case b) Appending data into table having SRID=2393
================================================
Command:
ogr2ogr -update -append -f "OCI" OCI:username/passwd@db:test
 -a_srs epsg:2393 test2.shp

This fails with Oracle error ""Layer SRID does not match geometry SRID". I can
make the insert to succeed by dropping the spatial index of the table, but then
the newly inserted features have SRID=null.

-Jukka Rahkonen


From michael.smith at usace.army.mil  Mon Nov 30 07:37:55 2009
From: michael.smith at usace.army.mil (Smith, Michael ERDC-CRREL-NH)
Date: Mon Nov 30 07:38:00 2009
Subject: [gdal-dev] Why does OCI driver fail with SRID?
In-Reply-To: <loom.20091130T123729-827@post.gmane.org>
Message-ID: <C73926D3.240EB%michael.smith@usace.army.mil>

Jukka,

To set the SRID when loading to Oracle, you have to use the layer creation
option

-lco srid=2393

Mike


-- 
Michael Smith
RSGIS Center
US Army Corps of Engineers




On 11/30/09 7:25 AM, "Jukka Rahkonen" <jukka.rahkonen@mmmtike.fi> wrote:

> Hi,
> 
> Short question: I cannot get ogr2ogr to co-operate with me and Oracle
> Spatial if I want to set the table SRID by using its EPSG code.  I can do what
> I
> want by using SQL*Plus but not with ogr2ogr. What am I doing wrong?
> 
> Longish description follows.
> 
> I was trying to use ogr2ogr that comes with MS4W 3.0 (dgal version 1.7.0dev)
> for
> 
> a) Importing a shapefile into Oracle 10g and give SRID at the same time.
> b) Appending date into existing table with SRID set.
> 
> The SRID I would like to use is epsg:2393.  It is configured it in Oracle as
> can
> be seen from the following SQL query:
> 
> select * from mdsys.cs_srs where srid=2393;
> CS_NAME | SRID |AUTH_SRID |AUTH_NAME |WKTEXT |CS_BOUNDS
> 
> KKJ / Finland Uniform Coordinate System
>       2393       2393
> www.nls.fi/maa/papers/kkj.html
> PROJCS["KKJ / Finland Uniform Coordinate System",
> GEOGCS [ "KKJ", DATUM ["Kartasto Koordinaati Jarjestelma 1966
> (EPSG ID 6123)", SPHEROID ["International 1924 (EPSG ID 7022)",
> 6378388.0, 297.0], -90.7, -106.1, -119.2, 4.09, 0.218, -1.05,
> 1.37], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
> 0.01745329251994328]], PROJECTION ["Finland Uniform Coordinate
> System (EPSG OP 18193)"], PARAMETER ["Latitude_Of_Origin", 0.0],
>  PARAMETER ["Central_Meridian", 27.0], PARAMETER
> ["Scale_Factor", 1.0], PARAMETER ["False_Easting", 3500000.0],
>  PARAMETER ["False_Northing", 0.0], UNIT ["Meter", 1.0]]
> 
> Case a) Importing data to new table with ogr2ogr
> ================================================
> Command:
> ogr2ogr -f "OCI" OCI:username/passwd@db:test -a_srs epsg:2393 test.shp
> 
> Result: Table is created and features are inserted, but without SRID set.
> Ogr2ogr is trying to insert a new line into the table MDSYS.CS_SRS but it
> fails
> because of insufficient privileges
> ERROR 1: ORA-01031: insufficient privileges
>  in INSERT INTO MDSYS.CS_SRS (SRID, WKTEXT, CS_NAME)
>  VALUES (1000003006,'PROJCS["KKJ / Finland Uniform Coordinate
> System",GEOGCS["KKJ",DATUM["Kartastokoordinaattijarjestelma_1966",
> SPHEROID["International 1924",6378388,297]],PRIMEM["Greenwich",0],
> UNIT["Decimal Degree",0.0174532925199433]],UNIT["metre",1],
> PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],
> PARAMETER["central_meridian",27],PARAMETER["scale_factor",1],
> PARAMETER["false_easting",3500000],PARAMETER["false_northing",0]]',
>  'KKJ / Finland Uniform Coordinate System' )
> 
> I wonder why org2ogr is trying to add the projection, because SRID 2393 is
> already defined in the database, and why it would like to insert my SRID=2393
> with code "1000003006".
> 
> Case b) Appending data into table having SRID=2393
> ================================================
> Command:
> ogr2ogr -update -append -f "OCI" OCI:username/passwd@db:test
>  -a_srs epsg:2393 test2.shp
> 
> This fails with Oracle error ""Layer SRID does not match geometry SRID". I can
> make the insert to succeed by dropping the spatial index of the table, but
> then
> the newly inserted features have SRID=null.
> 
> -Jukka Rahkonen
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Jukka.Rahkonen at mmmtike.fi  Mon Nov 30 08:07:12 2009
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Mon Nov 30 08:14:54 2009
Subject: [gdal-dev] Why does OCI driver fail with SRID?
In-Reply-To: <C73926D3.240EB%michael.smith@usace.army.mil>
References: <loom.20091130T123729-827@post.gmane.org>
	<C73926D3.240EB%michael.smith@usace.army.mil>
Message-ID: <CC197224AC75CE4DB23F739B16891B86018797C2@tikka.haapa.mmm.fi>

Hi Mike,

Oh, naturally.  I had forgotten that even I seem to have -lco SRID
parameter included in all the scripts I have written myself.  But how
about appendind the data?  Using -a_srs does not work and using "-lco
SRID=2393" together with "-append" gives a message

"WARNING: Layer creation options ignored since an existing layer is
being appended to." 

-Jukka-

Smith, Michael wrote:
> 
> Jukka,
> 
> To set the SRID when loading to Oracle, you have to use the 
> layer creation option
> 
> -lco srid=2393
> 
> Mike
> 
> 
> --
> Michael Smith
> RSGIS Center
> US Army Corps of Engineers
> 
> 
> 
> 
> On 11/30/09 7:25 AM, "Jukka Rahkonen" 
> <jukka.rahkonen@mmmtike.fi> wrote:
> 
> > Hi,
> > 
> > Short question: I cannot get ogr2ogr to co-operate with me 
> and Oracle
> > Spatial if I want to set the table SRID by using its EPSG 
> code.  I can do what
> > I
> > want by using SQL*Plus but not with ogr2ogr. What am I doing wrong?
> > 
> > Longish description follows.
> > 
> > I was trying to use ogr2ogr that comes with MS4W 3.0 (dgal 
> version 1.7.0dev)
> > for
> > 
> > a) Importing a shapefile into Oracle 10g and give SRID at 
> the same time.
> > b) Appending date into existing table with SRID set.
> > 
> > The SRID I would like to use is epsg:2393.  It is 
> configured it in Oracle as
> > can
> > be seen from the following SQL query:
> > 
> > select * from mdsys.cs_srs where srid=2393;
> > CS_NAME | SRID |AUTH_SRID |AUTH_NAME |WKTEXT |CS_BOUNDS
> > 
> > KKJ / Finland Uniform Coordinate System
> >       2393       2393
> > www.nls.fi/maa/papers/kkj.html
> > PROJCS["KKJ / Finland Uniform Coordinate System",
> > GEOGCS [ "KKJ", DATUM ["Kartasto Koordinaati Jarjestelma 1966
> > (EPSG ID 6123)", SPHEROID ["International 1924 (EPSG ID 7022)",
> > 6378388.0, 297.0], -90.7, -106.1, -119.2, 4.09, 0.218, -1.05,
> > 1.37], PRIMEM [ "Greenwich", 0.000000 ], UNIT ["Decimal Degree",
> > 0.01745329251994328]], PROJECTION ["Finland Uniform Coordinate
> > System (EPSG OP 18193)"], PARAMETER ["Latitude_Of_Origin", 0.0],
> >  PARAMETER ["Central_Meridian", 27.0], PARAMETER
> > ["Scale_Factor", 1.0], PARAMETER ["False_Easting", 3500000.0],
> >  PARAMETER ["False_Northing", 0.0], UNIT ["Meter", 1.0]]
> > 
> > Case a) Importing data to new table with ogr2ogr
> > ================================================
> > Command:
> > ogr2ogr -f "OCI" OCI:username/passwd@db:test -a_srs 
> epsg:2393 test.shp
> > 
> > Result: Table is created and features are inserted, but 
> without SRID set.
> > Ogr2ogr is trying to insert a new line into the table 
> MDSYS.CS_SRS but it
> > fails
> > because of insufficient privileges
> > ERROR 1: ORA-01031: insufficient privileges
> >  in INSERT INTO MDSYS.CS_SRS (SRID, WKTEXT, CS_NAME)
> >  VALUES (1000003006,'PROJCS["KKJ / Finland Uniform Coordinate
> > System",GEOGCS["KKJ",DATUM["Kartastokoordinaattijarjestelma_1966",
> > SPHEROID["International 1924",6378388,297]],PRIMEM["Greenwich",0],
> > UNIT["Decimal Degree",0.0174532925199433]],UNIT["metre",1],
> > PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],
> > PARAMETER["central_meridian",27],PARAMETER["scale_factor",1],
> > PARAMETER["false_easting",3500000],PARAMETER["false_northing",0]]',
> >  'KKJ / Finland Uniform Coordinate System' )
> > 
> > I wonder why org2ogr is trying to add the projection, 
> because SRID 2393 is
> > already defined in the database, and why it would like to 
> insert my SRID=2393
> > with code "1000003006".
> > 
> > Case b) Appending data into table having SRID=2393
> > ================================================
> > Command:
> > ogr2ogr -update -append -f "OCI" OCI:username/passwd@db:test
> >  -a_srs epsg:2393 test2.shp
> > 
> > This fails with Oracle error ""Layer SRID does not match 
> geometry SRID". I can
> > make the insert to succeed by dropping the spatial index of 
> the table, but
> > then
> > the newly inserted features have SRID=null.
> > 
> > -Jukka Rahkonen
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
From udadi at gmu.edu  Mon Nov 30 08:51:58 2009
From: udadi at gmu.edu (Upendra Dadi)
Date: Mon Nov 30 08:52:11 2009
Subject: [gdal-dev] VSIFile from a string
In-Reply-To: <4D502C9669C6487B9E24EFDA647B4205@UpendraPC>
References: <4D502C9669C6487B9E24EFDA647B4205@UpendraPC>
Message-ID: <33AE176767B14BAFBDFC0820DF42A15C@UpendraPC>

Hi,
  In reference to my previous post, one way I could solve my problem is to create a memory file from a c++ string which contains a Geotiff file.  Can anyone please tell how to create a memory file using a char array? How do I read from and write to memory files? Thanks.

Upendra
  ----- Original Message ----- 
  From: Upendra Dadi 
  To: gdal-dev@lists.osgeo.org 
  Sent: Monday, November 30, 2009 1:46 AM
  Subject: [gdal-dev] reading geotiff data from STDIN


  Hi,
    Is it possible to read geotiff data from standard input(STDIN) and write to standard output (STDOUT) instead of reading from a file? I see the following in the documentation to GDALOpen():

  pszFilename the name of the file to access. In the case of exotic drivers this may not refer to a physical file, but instead contain information for the driver on how to access a dataset.

  What options does Geotiff driver have for pszFilename? If I want to modify Geotiff driver to read and write from STDIN and STDOUT respectively, which files should I be looking at? 

  Ability to do this might be useful if using GDAL in a Hadoop MapReduce job with streaming. Geotiff format could be the serialization format that MapReduce expects. If it is not already there, it might be useful to add this feature. It could make it a bit easier to use GDAL within a Cloud environment.  Thanks.

  Upendra


------------------------------------------------------------------------------


  _______________________________________________
  gdal-dev mailing list
  gdal-dev@lists.osgeo.org
  http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091130/cc93aa6b/attachment-0001.html
From udadi at gmu.edu  Mon Nov 30 09:12:47 2009
From: udadi at gmu.edu (Upendra Dadi)
Date: Mon Nov 30 09:13:01 2009
Subject: [gdal-dev] VSIFile from a string
In-Reply-To: <33AE176767B14BAFBDFC0820DF42A15C@UpendraPC>
References: <4D502C9669C6487B9E24EFDA647B4205@UpendraPC>
	<33AE176767B14BAFBDFC0820DF42A15C@UpendraPC>
Message-ID: <495E3F464BD747ACB77154AB6E22D0A0@UpendraPC>

Hi,
  I found out how to do it. I just had to read the documentation for void VSIInstallMemFileHandler.

Upendra
  ---- Original Message ----- 
  From: Upendra Dadi 
  To: gdal-dev@lists.osgeo.org 
  Sent: Monday, November 30, 2009 8:51 AM
  Subject: [gdal-dev] VSIFile from a string


  Hi,
    In reference to my previous post, one way I could solve my problem is to create a memory file from a c++ string which contains a Geotiff file.  Can anyone please tell how to create a memory file using a char array? How do I read from and write to memory files? Thanks.

  Upendra
    ----- Original Message ----- 
    From: Upendra Dadi 
    To: gdal-dev@lists.osgeo.org 
    Sent: Monday, November 30, 2009 1:46 AM
    Subject: [gdal-dev] reading geotiff data from STDIN


    Hi,
      Is it possible to read geotiff data from standard input(STDIN) and write to standard output (STDOUT) instead of reading from a file? I see the following in the documentation to GDALOpen():

    pszFilename the name of the file to access. In the case of exotic drivers this may not refer to a physical file, but instead contain information for the driver on how to access a dataset.

    What options does Geotiff driver have for pszFilename? If I want to modify Geotiff driver to read and write from STDIN and STDOUT respectively, which files should I be looking at? 

    Ability to do this might be useful if using GDAL in a Hadoop MapReduce job with streaming. Geotiff format could be the serialization format that MapReduce expects. If it is not already there, it might be useful to add this feature. It could make it a bit easier to use GDAL within a Cloud environment.  Thanks.

    Upendra


----------------------------------------------------------------------------


    _______________________________________________
    gdal-dev mailing list
    gdal-dev@lists.osgeo.org
    http://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------------------------------------------------------


  _______________________________________________
  gdal-dev mailing list
  gdal-dev@lists.osgeo.org
  http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091130/c4870a6d/attachment.html
From szekerest at gmail.com  Mon Nov 30 15:08:50 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon Nov 30 15:08:56 2009
Subject: [gdal-dev] Problem with readraster in C#
In-Reply-To: <004401ca70ca$1f936ae0$5eba40a0$@net>
References: <004401ca70ca$1f936ae0$5eba40a0$@net>
Message-ID: <f3b73b7d0911301208r17c6074chf85f4d3415c92ef8@mail.gmail.com>

Patrik,

Do you have this data available to reproduce the problem?

Best regards,

Tamas



2009/11/29 patsv <patsv@bredband.net>

>  Hi,  I am trying to read GDEM data from the ASTER dataset.
>
> But all I get is a buffer with zeroes, is there something wrong with my
> code or is it something with the readraster function.
>
>
>
> Part of my code:
>
>        Band band = ds.GetRasterBand(1);
>
>        short[] DEM = new short[band.XSize * band.YSize];
>
>
>
>        CPLErr Ret = band.ReadRaster(0, 0, band.XSize,band.YSize, DEM,
> band.XSize, band.YSize, 2, band.XSize * 2);
>
>        if (Ret != CPLErr.CE_None)
>
>        {
>
>                 throw new Exception("Read error " + Ret.ToString());
>
>        }
>
>
>
> As mentioned above all I get is a buffer filled with Zeroes.
>
>
>
> Thanks for a good library.
>
>
>
> Regards
>
> Patrik Svensson
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20091130/3be43fad/attachment.html
From rayg at daylongraphics.com  Mon Nov 30 22:06:07 2009
From: rayg at daylongraphics.com (Ray Gardener)
Date: Mon Nov 30 22:06:40 2009
Subject: [gdal-dev] OGR random read optimization?
In-Reply-To: <f3b73b7d0911301208r17c6074chf85f4d3415c92ef8@mail.gmail.com>
References: <004401ca70ca$1f936ae0$5eba40a0$@net>
	<f3b73b7d0911301208r17c6074chf85f4d3415c92ef8@mail.gmail.com>
Message-ID: <4B14881F.2000203@daylongraphics.com>

The OGRLayer::SetNextByIndex() function can be sped up by keeping track 
of the previously used index, and calling ResetReading() only if the new 
index is lesser than it. Otherwise, read forward and skip features by 
the difference of the new and old indices.

For thread safety, the old index should be kept in a caller-level data 
structure which is passed in as an argument to SetNextByIndex.

Ray
