From pgao at esri.com  Fri Jul  1 00:09:32 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] BMP not reading overview
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280F7F@firewire.esri.com>

BMP format doesn't recognize an overview (.ovr) once one is built
for it.
It seems that the following is missing from BMPDataset::Open().

Gao, Peng

/* --------------------------------------------------------------------
*/
/*      Check for external overviews.
*/
/* --------------------------------------------------------------------
*/
    poDS->oOvManager.Initialize( poDS, poOpenInfo->pszFilename );


From fwarmerdam at gmail.com  Tue Jul  5 13:45:00 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Turning off error message output
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F7A@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F7A@firewire.esri.com>
Message-ID: <931f8ea905070510457768560a@mail.gmail.com>

On 6/30/05, Peng Gao <pgao@esri.com> wrote:
> On Unix, GDAL prints error messages to the console, in addition to
> error return code. Is there a way to turn off the message printout?

Peng,

You can push your own error handler using CPLPushErrorHandler().
The simplest way to disable terminal output of error messages is
to push the quiet error handler. 

eg. 

  CPLPushErrorHandler( CPLQuietErrorHandler );

Note, that this really needs to be done for each thread using GDAL,
as currently the error handlers are thread-local information.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dron at ak4719.spb.edu  Tue Jul  5 13:52:23 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] BMP not reading overview
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F7F@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F7F@firewire.esri.com>
Message-ID: <20050705175222.GA25808@ak4719.spb.edu>

On Thu, Jun 30, 2005 at 09:09:32PM -0700, Peng Gao wrote:
> BMP format doesn't recognize an overview (.ovr) once one is built for
> it. It seems that the following is missing from BMPDataset::Open().
> 
> /* --------------------------------------------------------------------
> */
> /*      Check for external overviews.
> */
> /* --------------------------------------------------------------------
> */
>     poDS->oOvManager.Initialize( poDS, poOpenInfo->pszFilename );


Peng Gao,

Thanks, your change applied.

Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From fwarmerdam at gmail.com  Tue Jul  5 16:46:07 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] BMP not reading overview
In-Reply-To: <54808B311D66EB4E9CF4647B0DE707C2280F7F@firewire.esri.com>
References: <54808B311D66EB4E9CF4647B0DE707C2280F7F@firewire.esri.com>
Message-ID: <931f8ea905070513466dd5e039@mail.gmail.com>

On 7/1/05, Peng Gao <pgao@esri.com> wrote:
> BMP format doesn't recognize an overview (.ovr) once one is built
> for it.
> It seems that the following is missing from BMPDataset::Open().

Peng,

I think Andrey has now committed a fix for this. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From gerald.clette at free.fr  Tue Jul  5 17:36:49 2005
From: gerald.clette at free.fr (=?iso-8859-1?Q?G=E9rald_CLETTE?=)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] XResolution tag in GeoTiff 
Message-ID: <000801c581a9$a7406ac0$0167e352@hppav>

Hi

I developped a new driver based on the GDAL data model to handle a new
format with the gdal_warp tool.
Then, I tried to create a GTIFF product but the new file didn't contain the
XResolution, YResolution nor ResolutionUnit tags. I thought that these tags
were not optionnal in the GeoTiff description.

My question is : Is it a bug in the Geotiff library ? Or how can I manage to
product a "full" GeoTiff product with gdal_warp ?

Thank you for your answer.
G?rald CLETTE



From schuyler at nocat.net  Wed Jul  6 01:30:16 2005
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] Vector warping patch to ogr2ogr
In-Reply-To: <931f8ea9050705105373e219bd@mail.gmail.com>
References: <OFA76C84C9.AB2ED814-ON65257031.0022A2F6-65257031.0022B1C1@rmsi.com>
	<931f8ea9050705105373e219bd@mail.gmail.com>
Message-ID: <20050706053016.GB20457@vishnu.tridity.org>

* On  5-Jul-2005 at 10:53AM PDT, Frank Warmerdam said:
> >  
> > can u help me in transformation some vector data using the polynomial Third
> > Order method. 
>
> I don't have any programs conveniently setup to apply polynomial
> transformations to vector data; however, I do know of at least one
> person who has successfully modified the ogr2ogr code to accomplish
> this.  It is Schuyler Erle (cced on this message).  You might want to 
> ask him for a drop of his modified code. 

Hi guys, attached is a patch to ogr2ogr that allows you to specify
GCPs via standard input using the -gcp flag, which will then use the
thin plate spline warper from GDAL to warp the output points into the
matching projection. You'll probably want to use the -t_srs flag as
well. The format of the GCPs should be "x y pixel line", whitespace
separated, one GCP per line. If you need polynomial warping, you'll
want to hack the patched version. I don't think this patch is really
fit to be applied to the main distribution version of ogr2ogr, but...

Really, what I'd love to see happen is some kind of "filter"
interface, which would allow us to add an additional processing step
via command-line options, which would call out to a .so plugin, or
moral equivalent. Different vector warping modules and line
simplification are just two possible uses that come to mind. Of course
I can already imagine Frank breaking out in cold sweats reading this
email... :-) But I'd thought I'd open the can of worms and see where
they lead...

SDE


Index: ogr2ogr.cpp
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/ogr/ogr2ogr.cpp,v
retrieving revision 1.28
diff -u -r1.28 ogr2ogr.cpp
--- ogr2ogr.cpp	14 Apr 2005 14:20:24 -0000	1.28
+++ ogr2ogr.cpp	6 Jul 2005 04:13:58 -0000
@@ -117,6 +117,10 @@
 #include "ogrsf_frmts.h"
 #include "cpl_conv.h"
 #include "cpl_string.h"
+#include <gdal_alg.h>
+#include <gdal.h>
+#include <stdio.h>
+
 
 CPL_CVSID("$Id: ogr2ogr.cpp,v 1.28 2005/04/14 14:20:24 fwarmerdam Exp $");
 
@@ -133,10 +137,16 @@
                            char **papszSelFields,
                            int bAppend, int eGType );
 
+static void *CreateGCPTransform (const char *file);
+
+static OGRGeometry *warpGeometry (
+    OGRGeometry *poGeometry, void *poTransform );
+
 static int bSkipFailures = FALSE;
 static int nGroupTransactions = 200;
 static int bPreserveFID = FALSE;
 static int nFIDToFetch = OGRNullFID;
+static void *pTPSxform = NULL;
 
 /************************************************************************/
 /*                                main()                                */
@@ -303,6 +313,10 @@
             papszSelFields = CSLTokenizeStringComplex(pszSelect, " ,", 
                                                       FALSE, FALSE );
         }
+        else if( EQUAL(papszArgv[iArg],"-gcp") && papszArgv[iArg+1] != NULL )
+        {
+            pTPSxform = CreateGCPTransform(papszArgv[++iArg]);
+        }
         else if( papszArgv[iArg][0] == '-' )
         {
             Usage();
@@ -806,6 +820,15 @@
             }
         }
 
+	if (pTPSxform && poDstFeature->GetGeometryRef() != NULL ) {
+	    OGRGeometry *poDstGeom = poDstFeature->StealGeometry();
+	    OGRGeometry *poDstGeom2;
+
+	    poDstGeom2 = warpGeometry( poDstGeom, pTPSxform );
+	    poDstFeature->SetGeometryDirectly(poDstGeom2);
+	}
+
+
         if( poDstFeature->GetGeometryRef() != NULL && bForceToPolygon )
         {
             poDstFeature->SetGeometryDirectly( 
@@ -842,3 +865,113 @@
     return TRUE;
 }
 
+static void warpPoint (OGRPoint *poPoint, void *pXformer)
+{
+	double x = poPoint->getX(),
+	       y = poPoint->getY(),	
+	       z = poPoint->getZ();
+	int r = 0;
+	// printf("%lf %lf %lf -> ", x, y, z);
+	GDALTPSTransform(pXformer, FALSE, 1, &x, &y, &z, &r );
+	// printf("%lf %lf %lf\n", x, y, z);
+	if (!r) {
+	    printf("transform failed!\n");
+	    return;
+	}
+	poPoint->setX(x);	
+	poPoint->setY(y);	
+	poPoint->setZ(z);	
+}
+
+static void warpCurve (OGRCurve *poOut, OGRCurve *poIn, void *pXformer)
+{
+    OGRPoint *poPoint = new OGRPoint();
+    OGRLineString *poIn2 = (OGRLineString *) poIn;
+    OGRLineString *poOut2 = (OGRLineString *) poOut;
+    for (int n = 0; n < poIn2->getNumPoints(); n++) {
+	poIn2->getPoint(n, poPoint);
+	warpPoint(poPoint, pXformer);
+	poOut2->addPoint(poPoint);
+    }
+    delete poPoint;
+}
+
+static OGRGeometry *warpGeometry (OGRGeometry *poGeometry, void *poTransform)
+{
+    OGRGeometry *poGeomOut = NULL;
+    OGRwkbGeometryType eGeomType = poGeometry->getGeometryType();
+
+    if (eGeomType == wkbPoint) {
+	OGRPoint *poPoint = (OGRPoint *) poGeometry->clone();
+	warpPoint(poPoint, poTransform);
+	poGeomOut = (OGRGeometry *)poPoint;
+    }
+    if (eGeomType == wkbLineString) {
+	OGRLineString *poLineIn = (OGRLineString *) poGeometry;
+	OGRLineString *poLineOut = new OGRLineString();
+	warpCurve(poLineOut, poLineIn, poTransform);
+	poGeomOut = (OGRGeometry *)poLineOut;
+    }
+    else if (eGeomType == wkbPolygon) {
+	OGRPolygon *poPolyIn = (OGRPolygon *) poGeometry;
+	OGRPolygon *poPolyOut = new OGRPolygon();
+	OGRLinearRing *poRingIn = poPolyIn->getExteriorRing();
+	OGRLinearRing *poRingOut = new OGRLinearRing();
+
+	//printf("-.");
+	warpCurve( poRingOut, poRingIn, poTransform );
+	poPolyOut->addRingDirectly( poRingOut );
+	//printf(".-");
+
+	for (int n = 0; n < poPolyIn->getNumInteriorRings(); n++) {
+	    poRingIn = poPolyIn->getInteriorRing(n);
+	    poRingOut = new OGRLinearRing();
+	    warpCurve( poRingOut, poRingIn, poTransform );
+	    poPolyOut->addRingDirectly( poRingOut );
+	}
+
+	poGeomOut = (OGRGeometry *)poPolyOut;
+
+    }
+    return poGeomOut;
+}
+
+static void *CreateGCPTransform (const char *file) {
+    int n = 0, r = 0;
+    GDAL_GCP gcps[32];
+    FILE *gcpfile;
+    void *poTransform;
+
+    gcpfile = fopen(file, "r");
+    if (!gcpfile) {
+	printf("Can't open GCP file %s.\n", file);
+	exit(0);
+    }
+
+    while (!feof(gcpfile)) {
+	r = fscanf(gcpfile, "%lf %lf %lf %lf", 
+		&(gcps[n].dfGCPX),	&(gcps[n].dfGCPY),
+		&(gcps[n].dfGCPPixel),	&(gcps[n].dfGCPLine) );
+	if (r < 4)
+	    continue;
+/*	printf( "GCP %lf %lf %lf %lf\n", 
+		gcps[n].dfGCPX,	gcps[n].dfGCPX,
+		gcps[n].dfGCPPixel,	gcps[n].dfGCPLine ); */
+	gcps[n].dfGCPZ = 0;
+	gcps[n].pszId = gcps[n].pszInfo = "";
+	if (n++ == 32) {
+	    printf("only 32 GCPs supported, sorry :-/\n");
+	    break;
+	}
+    }
+    fclose(gcpfile);
+
+    poTransform = GDALCreateTPSTransformer( n, gcps, 0 );
+    if (poTransform == NULL) {
+	printf("Couldn't generate thin plate spline transform from GCPs.\n");
+	exit(1);
+    }
+
+    return poTransform;
+}
+

From vincent at ecovla.nl  Wed Jul  6 03:11:30 2005
From: vincent at ecovla.nl (Vincent Schut)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] gdal, swig-ng, csharp & mono
Message-ID: <1120633890.11225.3.camel@localhost>

Hi all,

just curious:

anybody tried (and succeeded?) building a gdal.net assembly using the ng
swig csharp bindings and mono on linux?
A whole shiny new world of building simple, cross-platform, gui RS
processing tools comes to my mind... Or is this a bit too optimistic...?

Cheers,
Vincent.


From magnus at homann.se  Wed Jul  6 08:15:57 2005
From: magnus at homann.se (Magnus Homann)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] shapefiles, attributes and non-ascii text
Message-ID: <42CBCB7D.4090709@homann.se>

Hi,
After readgin teh ESRI pages on shapefiles, it appears that somewhere in 
the shapefile there is a language driver ID. Is this read/written by ogr?

Is it possible to use unicode in the attributes set by 
OGRFeature::SetField()?

Thanks,
Magnus
-- 
Magnus Homann
magnus@homann.se
+46 702 399 558

From fwarmerdam at gmail.com  Wed Jul  6 09:56:24 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] shapefiles, attributes and non-ascii text
In-Reply-To: <42CBCB7D.4090709@homann.se>
References: <42CBCB7D.4090709@homann.se>
Message-ID: <931f8ea9050706065655ed72d4@mail.gmail.com>

On 7/6/05, Magnus Homann <magnus@homann.se> wrote:
> Hi,
> After readgin teh ESRI pages on shapefiles, it appears that somewhere in
> the shapefile there is a language driver ID. Is this read/written by ogr?

Magnus, 

Can you provide a more specific reference to this language flag? 
Is it in the shapefile header or the dbf file header?  Currently OGR
does *not* do anything special for this. 

> Is it possible to use unicode in the attributes set by
> OGRFeature::SetField()?

You could set unicode text in a string field, and it should transport
through the system, but there is nothing to tell the receiving
software what the encoding is. 

Hmm, looking at unicode a bit closer, I'm not so certain that
"unicode" string will have no zero-bytes in the string.  If you
encode your unicode text in UTF-8, then you would be fine.
If you encode it as UTF-16 then perhaps zero-page characters
would end up having zero-bytes which would be seen as a 
string end to the non-unicode aware OGR code. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jul  6 10:59:31 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] XResolution tag in GeoTiff
In-Reply-To: <000801c581a9$a7406ac0$0167e352@hppav>
References: <000801c581a9$a7406ac0$0167e352@hppav>
Message-ID: <931f8ea90507060759158ca8d2@mail.gmail.com>

On 7/5/05, G?rald CLETTE <gerald.clette@free.fr> wrote:
> Hi
> 
> I developped a new driver based on the GDAL data model to handle a new
> format with the gdal_warp tool.
> Then, I tried to create a GTIFF product but the new file didn't contain the
> XResolution, YResolution nor ResolutionUnit tags. I thought that these tags
> were not optionnal in the GeoTiff description.

G?rald,

The XResolution, YResolution and ResolutionUnit flags are not related to
the GeoTIFF specification.  I am not aware of these being required tags
in the core TIFF specification though it is possible.  If so, could you provide
a reference? 

> My question is : Is it a bug in the Geotiff library ? Or how can I manage to
> product a "full" GeoTiff product with gdal_warp ?

The -mo flag to gdal_translate can be used to add dataset level 
metadata which is how the GDAL GeoTIFF  driver handles the 
resolution information.  Something like the following would set a
72dpi (dots per inch) screen resolution:

gdal_translate in.tif out.tif \
      -mo TIFFTAG_XRESOLUTION=72 \
      -mo TIFFTAG_XRESOLUTION=72 \
      -mo TIFFTAG_RESOLUTIONUNIT=2

See the TIFF tag list for details on resolution unit values:
   http://www.awaresystems.be/imaging/tiff/tifftags/resolutionunit.html

PS. Keep in mind that the x/yresolution values have nothing
to do with geospatial resolution.  It is screen/print display resolution.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pgao at esri.com  Wed Jul  6 11:54:57 2005
From: pgao at esri.com (Peng Gao)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
Message-ID: <54808B311D66EB4E9CF4647B0DE707C2280FA0@firewire.esri.com>

Any comments? 

> -----Original Message-----
> From: Peng Gao 
> Sent: Thursday, June 30, 2005 8:36 AM
> To: Michael P. Gerlek; warmerdam@pobox.com
> Cc: gdal-dev@xserve.flids.com
> Subject: RE: [Gdal-dev] RE: Strange NoData value from a MrSID 
> image (Peng Gao)
> 
> > -----Original Message-----
> > From: Michael P. Gerlek [mailto:mpg@lizardtech.com]
> > Sent: Friday, June 24, 2005 11:43 AM
> > To: warmerdam@pobox.com; Peng Gao
> > Cc: gdal-dev@xserve.flids.com
> > Subject: RE: [Gdal-dev] RE: Strange NoData value from a MrSID image 
> > (Peng Gao)
> >
> > Frank, Peng:
> >
> > In the MrSID SDK, we are not band-specific -- that is, a pixel is 
> > considered nodata iff all bands match the given values.
> >
> > -mpg
> >
> >
> > -----Original Message-----
> > From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
> > Sent: Friday, June 24, 2005 10:57 AM
> > To: Peng Gao
> > Cc: Michael P. Gerlek; gdal-dev@xserve.flids.com
> > Subject: Re: [Gdal-dev] RE: Strange NoData value from a MrSID image 
> > (Peng Gao)
> >
> >
> > On 6/24/05, Peng Gao <pgao@esri.com> wrote:
> > > I have a question about the interpretation of MrSID NoData value.
> > > Is a pixel considered NoData only if all three values match their 
> > > corresponding band NoData value, or Is a pixel considered 
> NoData if 
> > > any band value matches band NoData value? For example, 
> given NoData 
> > > values (0, 0, 0), Are only those pixels with value (0, 0, 0) 
> > > considered NoData, or (0, x, x), (0, 0, x), and etc considered as 
> > > NoData pixels as well?
> >
> > Peng,
> >
> > In the GDAL data model, nodata is band specific.  So if 
> band one has a 
> > nodata value of 0, then that band is considered to be nodata if the 
> > pixel value is zero.  A pixel might well be no data in some 
> bands, and 
> > not in others ... at least in theory.
> >
> > I'm not sure if this is the normal interpretation in MrSID though.
> >
> 
> I have a case where MrSID SDK reports NoData values (0, 0, 0) for
> 3 bands, and I have a MrSID image containing black text with 
> value (0, 13, 14).  Since GDAL uses band specific NoData 
> interpretation, the band 1 is nodata. My app considers a 
> multiband pixel NoData if any of the band is nodata. As the 
> result, the black text is displayed transparent.
> I could ignore
> MrSID NoData color at application level. But I can't handle 
> the case where the NoData values come from PAM.
> 
> One solution could be not using native MrSID NoData color as 
> GDAL band specific NoData value (because it's not), and 
> adding a new call at Dataset level to get NoData color for 
> the entire dataset for apps that want to make use of the NoData color?
> 
> What do you think?
> 
> Gao, Peng
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 

From mpg at lizardtech.com  Wed Jul  6 12:01:26 2005
From: mpg at lizardtech.com (Michael P. Gerlek)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
Message-ID: <C5B740D9CEC9284A84B767BBD1DAA8467F011E@sea-srv-ms2.lizardtech.com>

> I have a case where MrSID SDK reports NoData values (0, 0, 0) for
> 3 bands, and I have a MrSID image containing black text with 
> value (0, 13, 14).  Since GDAL uses band specific NoData 
> interpretation, the band 1 is nodata. My app considers a 
> multiband pixel NoData if any of the band is nodata. As the 
> result, the black text is displayed transparent.
> I could ignore
> MrSID NoData color at application level. But I can't handle 
> the case where the NoData values come from PAM.
> 
> One solution could be not using native MrSID NoData color as 
> GDAL band specific NoData value (because it's not), and 
> adding a new call at Dataset level to get NoData color for 
> the entire dataset for apps that want to make use of the NoData color?
> 
> What do you think?

That certainly would be okay - but this is really a question at the
GDAL / MrSID driver level, though.  Frank?

-mpg

From fwarmerdam at gmail.com  Wed Jul  6 12:12:38 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] RE: Strange NoData value from a MrSID image (Peng Gao)
In-Reply-To: <C5B740D9CEC9284A84B767BBD1DAA8467F011E@sea-srv-ms2.lizardtech.com>
References: <C5B740D9CEC9284A84B767BBD1DAA8467F011E@sea-srv-ms2.lizardtech.com>
Message-ID: <931f8ea905070609124b23d2ca@mail.gmail.com>

On 7/6/05, Michael P. Gerlek <mpg@lizardtech.com> wrote:
> > One solution could be not using native MrSID NoData color as
> > GDAL band specific NoData value (because it's not), and
> > adding a new call at Dataset level to get NoData color for
> > the entire dataset for apps that want to make use of the NoData color?
> >
> > What do you think?
> 
> That certainly would be okay - but this is really a question at the
> GDAL / MrSID driver level, though.  Frank?

Peng / Michael, 

Well, Peng and discussed this a bit already, and I suggest we take
it to the list to see if there are other opinions.  I am not in any big rush
to add a "dataset level" nodata method, so the short term "fix" would
be to ignore nodata values for mrsid alltogether - at least for multi-band
products.  Presumably the same rule would be applied to other formats
with similar issues as they are noticed. 

So, do other list members feel it would be better to ignore MrSID nodata
values because they don't really mean what GDAL means by nodata? 

For those who might have lost track of the distinction, in MrSID format
the pixel is considered "nodata" if the nodata values for all bands match.
In GDAL each band is treated distinctly, so one band could have a pixel
be nodata if it matches the nodata value for that band, while the same pixel
in other bands is not nodata. 

The GDAL approach really comes from thinking of raster files as a
stack of data layers.  For instance, one band might be elevation and
another some value computed by a model.  In this sort of situation bands
are quite independent (other than geospatial co-incidence).  But when 
looking at an RGB photo, you often want to consider the bands as a unit.

PS. If I did stop returning the band level nodata values for MrSID, I 
could still offer them as dataset level metadata with a standard name,
so apps could still look for it.  The benefit of handling as metadata instead
of having a custom API entry point is that the change is much easier and
more backward compatible.  The downside is that as images are copied
around and processed the metadata may (or may not) be carried along with
it and might well become inaccurate. 

For instance, if you do "gdal_translate -b 3 -b 2 -b 1 in.tif out.tif" then
gdal_translate would make no effort to re-map the band ordering in some
dataset level metadata related to nodata. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From matt.wilkie at gov.yk.ca  Wed Jul  6 12:12:17 2005
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] resamp nodata bug not fixed?
Message-ID: <42CC02E1.9020900@gov.yk.ca>

Hello gdal-dev,

I'm using FWTools 0.9.8, April 25 2005, and am still getting nodata
resampled as data when exporting to CDED (USGS), as described in bug 793
(http://bugzilla.remotesensing.org/show_bug.cgi?id=793)
Bugzilla says the fix was submitted to CVS on or before April 3rd while
gdal_translate --version reports "GDAL 1.2.6.0, released 2005/03/13".
Does this mean the bug is still not fixed? Or is it that FWTools doesn't
have a recent enough gdal build?

((I apologise if this is the second time you've seen this message, we've 
been having some mail server problems and I'm not sure what's getting out))

cheers,


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From chodgson at refractions.net  Wed Jul  6 18:00:21 2005
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] VRT Dataset problem
Message-ID: <42CC5475.4050909@refractions.net>

I'm trying to write a VRT file which tiles several images together - 
each image is a google maps tile :)

I think my problem is that I need to define the color table for the 
vrtrasterband since I have defined it as "palette" ColorInterp. However, 
the individual tile images do not have identical color palettes (though 
I suspect they have very nearly the same colors, just at different table 
  indexes). Is there a way, with a vrt file, to tell gdal to map the 
colors from the table into a normal RGB colorspace?

Anyways, the symptom is that when I do a galinfo on the vrt file, I get 
a segfault:

$ gdalinfo test.vrt
Driver: VRT/Virtual Raster
Size is 512, 512
Coordinate System is `'
Origin = (0.000000,0.000000)
Pixel Size = (0.35156250,0.17578125)
Corner Coordinates:
Upper Left  (   0.0000000,   0.0000000)
Lower Left  (   0.0000000,  90.0000000)
Upper Right ( 180.0000000,   0.0000000)
Lower Right ( 180.0000000,  90.0000000)
Center      (  90.0000000,  45.0000000)
Band 1 Block=128x128 Type=Byte, ColorInterp=Palette
Segmentation fault


My tiles look like this (yes they have unusual names):

$ gdalinfo mt_v=w2.4\&x=1\&y=1\&zoom=15
Driver: GIF/Graphics Interchange Format (.gif)
Size is 256, 256
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  256.0)
Upper Right (  256.0,    0.0)
Lower Right (  256.0,  256.0)
Center      (  128.0,  128.0)
Band 1 Block=256x1 Type=Byte, ColorInterp=Palette
   NoData Value=144
   Color Table (RGB with 256 entries)
     0: 242,239,233,255
     1: 153,179,204,255
.....

My VRT file looks like this (essentially created by hand):

<VRTDataset rasterXSize="512" rasterYSize="512">
  <GeoTransform>0, 0.3515625, 0.0, 0, 0.0, 0.17578125</GeoTransform>
  <VRTRasterBand dataType="Byte" band="1">
   <ColorInterp>Palette</ColorInterp>
   <SimpleSource>
    <SourceFilename 
relativeToVRT="1">mt_v=w2.4&amp;x=0&amp;y=0&amp;zoom=15</SourceFilename>
    <SourceBand>1</SourceBand>
    <SrcRect xOff="0" yOff="0" xSize="256" ySize="256"/>
    <DstRect xOff="0" yOff="0" xSize="256" ySize="256"/>
   </SimpleSource>
   <SimpleSource>
    <SourceFilename 
relativeToVRT="1">mt_v=w2.4&amp;x=0&amp;y=1&amp;zoom=15</SourceFilename>
    <SourceBand>1</SourceBand>
    <SrcRect xOff="0" yOff="0" xSize="256" ySize="256"/>
    <DstRect xOff="0" yOff="256" xSize="256" ySize="256"/>
   </SimpleSource>
   <SimpleSource>
    <SourceFilename 
relativeToVRT="1">mt_v=w2.4&amp;x=1&amp;y=0&amp;zoom=15</SourceFilename>
    <SourceBand>1</SourceBand>
    <SrcRect xOff="0" yOff="0" xSize="256" ySize="256"/>
    <DstRect xOff="256" yOff="0" xSize="256" ySize="256"/>
   </SimpleSource>
   <SimpleSource>
    <SourceFilename 
relativeToVRT="1">mt_v=w2.4&amp;x=1&amp;y=1&amp;zoom=15</SourceFilename>
    <SourceBand>1</SourceBand>
    <SrcRect xOff="0" yOff="0" xSize="256" ySize="256"/>
    <DstRect xOff="256" yOff="256" xSize="256" ySize="256"/>
   </SimpleSource>
  </VRTRasterBand>
</VRTDataset>


From matt.wilkie at gov.yk.ca  Wed Jul  6 19:02:15 2005
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:40 2007
Subject: [Gdal-dev] resamp nodata bug not fixed?
In-Reply-To: <42CC02E1.9020900@gov.yk.ca>
References: <42CC02E1.9020900@gov.yk.ca>
Message-ID: <42CC62F7.405@gov.yk.ca>

Matt Wilkie wrote:
> Hello gdal-dev,
> 
> I'm using FWTools 0.9.8, April 25 2005, and am still getting nodata
> resampled as data when exporting to CDED (USGS), as described in bug 793
> (http://bugzilla.remotesensing.org/show_bug.cgi?id=793)
> Bugzilla says the fix was submitted to CVS on or before April 3rd while
> gdal_translate --version reports "GDAL 1.2.6.0, released 2005/03/13".
> Does this mean the bug is still not fixed? Or is it that FWTools doesn't
> have a recent enough gdal build?

 >sigh< Nevermind. It turns out that I was forcing resampling with '-co 
Resample=CubicSpline'. As soon as I remove that nodata stays nodata.


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

From fwarmerdam at gmail.com  Wed Jul  6 19:13:37 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] VRT Dataset problem
In-Reply-To: <42CC5475.4050909@refractions.net>
References: <42CC5475.4050909@refractions.net>
Message-ID: <931f8ea9050706161359530ff2@mail.gmail.com>

On 7/6/05, Chris Hodgson <chodgson@refractions.net> wrote:
> I'm trying to write a VRT file which tiles several images together -
> each image is a google maps tile :)
> 
> I think my problem is that I need to define the color table for the
> vrtrasterband since I have defined it as "palette" ColorInterp. However,
> the individual tile images do not have identical color palettes (though
> I suspect they have very nearly the same colors, just at different table
>   indexes). Is there a way, with a vrt file, to tell gdal to map the
> colors from the table into a normal RGB colorspace?

Chris, 

There is no way currently with VRT files to remap pixel values or
to expand paletted images to RGB.   You can convert files into 
RGB with the pct2rgb.py script.  I would suggest doing this, merging
the resulting RGB files, and then using rgb2pct.py to boil them back
down to paletted images (if necessary). 

> Anyways, the sympom is that when I do a galinfo on the vrt file, I get
> a segfault:

It should not be segfaulting.  Can you provide a small test case for this
via bugzilla for me to look into? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jhayes at lizardtech.com  Wed Jul  6 19:34:41 2005
From: jhayes at lizardtech.com (John Hayes)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
Message-ID: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>

Hi

I'm trying to reproject an image from "Arizona Central State Plane NAD 83" to "Arizona Central State Plane NAD 83 HARN".  This should shift the image by (X=-0.100, Y=0.182) meters according to http://www.ngs.noaa.gov/cgi-bin/nadcon2.prl.  PROJ4 does not seem to be applying the shift.

Does PROJ4 support HARN corrections?

I have the "normal" NADCOM grid shift files installed and a 2005-04-25 snapshot of GDAL. 

Thanks,
-john

From fwarmerdam at gmail.com  Wed Jul  6 20:09:05 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
In-Reply-To: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>
References: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>
Message-ID: <931f8ea905070617099b32831@mail.gmail.com>

On 7/6/05, John Hayes <jhayes@lizardtech.com> wrote:
> Hi
> 
> I'm trying to reproject an image from "Arizona Central State Plane NAD 83" to "Arizona Central State Plane NAD 83 HARN".  This should shift the image by (X=-0.100, Y=0.182) meters according to http://www.ngs.noaa.gov/cgi-bin/nadcon2.prl.  PROJ4 does not seem to be applying the shift.
> 
> Does PROJ4 support HARN corrections?
> 
> I have the "normal" NADCOM grid shift files installed and a 2005-04-25 snapshot of GDAL.

John,

PROJ/GDAL is not distributed with any HARN related grid shift files
as far as I know, and in any event, the OGRSpatialReference needs
to have special cases in the WKT<->PROJ.4 translation to use grid
shift files, which it does not have for HARN. 

How are you specifying the HARN coordinate systems?  By EPSG
code?  

I think the solution to this issue would be for GDAL to support a WKT
extension for specifying grid shift files, as opposed to the TOWGS84
method of defining a datum.   I think ESRI WKT already has this feature,
so I could do it similarly.  However, this isn't really high on my 
priority list at this time. 

If you just wanted to hack something in, you would need to look in the
gdal/ogr/ogr_srs_proj.cpp code circa line 1670 (search for 
+datum=nzgd49).   You would also need to read up on use of
grid shift files on the PROJ.4 web site (the +nadgrids option) and
dig up suitable HARN grid shift files. 

All in all quite alot of work!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bill at binko.net  Wed Jul  6 20:56:29 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
In-Reply-To: <931f8ea905070617099b32831@mail.gmail.com>
References: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>
	<931f8ea905070617099b32831@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0507062054230.15728@fastcat.binko.net>

On Wed, 6 Jul 2005, Frank Warmerdam wrote:

...

> I think the solution to this issue would be for GDAL to support a WKT
> extension for specifying grid shift files, as opposed to the TOWGS84
> method of defining a datum.   I think ESRI WKT already has this feature,
> so I could do it similarly.  However, this isn't really high on my 
> priority list at this time. 
> 

Frank,

Is there any way to make this supported by Proj in general?  I have HARN 
data in vector format (in PostGIS and shapefiles) that I'd like to have 
projected more accurately.  I was not aware of the existence of those grid 
shift files (and still don't have any for my coverage area), but I'd 
certainly like to remove those anomalies in my data that I (still) think 
come from the HARN/NonHARN Datum mismatch.

Bill

From fwarmerdam at gmail.com  Wed Jul  6 21:37:38 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
In-Reply-To: <Pine.LNX.4.58.0507062054230.15728@fastcat.binko.net>
References: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>
	<931f8ea905070617099b32831@mail.gmail.com>
	<Pine.LNX.4.58.0507062054230.15728@fastcat.binko.net>
Message-ID: <931f8ea905070618375e718f9b@mail.gmail.com>

On 7/6/05, Bill Binko <bill@binko.net> wrote:
> On Wed, 6 Jul 2005, Frank Warmerdam wrote:
> 
> ...
> 
> > I think the solution to this issue would be for GDAL to support a WKT
> > extension for specifying grid shift files, as opposed to the TOWGS84
> > method of defining a datum.   I think ESRI WKT already has this feature,
> > so I could do it similarly.  However, this isn't really high on my
> > priority list at this time.
> >
> 
> Frank,
> 
> Is there any way to make this supported by Proj in general?  I have HARN
> data in vector format (in PostGIS and shapefiles) that I'd like to have
> projected more accurately.  I was not aware of the existence of those grid
> shift files (and still don't have any for my coverage area), but I'd
> certainly like to remove those anomalies in my data that I (still) think
> come from the HARN/NonHARN Datum mismatch.

Bill, 

Well, PROJ already supports use of HARN grid shift files via the
nadgrids option, but the user has to manually select the grid files desired.
Were you looking for built-in +datum=HARN support?  Fixes in the epsg
support files for HARN coordinate systems?  These are all possible, but
I don't feel I am familiar enough with HARN file availability or "issues" to
pursue it at this time. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bill at binko.net  Wed Jul  6 22:53:43 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
In-Reply-To: <931f8ea905070618375e718f9b@mail.gmail.com>
References: <DBEC881B4E22D1449F5FAC530E1ADD1208890D@sea-srv-ms3.lizardtech.com>
	<931f8ea905070617099b32831@mail.gmail.com>
	<Pine.LNX.4.58.0507062054230.15728@fastcat.binko.net>
	<931f8ea905070618375e718f9b@mail.gmail.com>
Message-ID: <Pine.LNX.4.58.0507062248580.15728@fastcat.binko.net>

On Wed, 6 Jul 2005, Frank Warmerdam wrote:

> On 7/6/05, Bill Binko <bill@binko.net> wrote:
> > Is there any way to make this supported by Proj in general?  I have HARN
> > data in vector format (in PostGIS and shapefiles) that I'd like to have
> > projected more accurately.  I was not aware of the existence of those grid
> > shift files (and still don't have any for my coverage area), but I'd
> > certainly like to remove those anomalies in my data that I (still) think
> > come from the HARN/NonHARN Datum mismatch.
> 
> Bill, 
> 
> Well, PROJ already supports use of HARN grid shift files via the
> nadgrids option, but the user has to manually select the grid files desired.
> Were you looking for built-in +datum=HARN support?  Fixes in the epsg
> support files for HARN coordinate systems?  These are all possible, but
> I don't feel I am familiar enough with HARN file availability or "issues" to
> pursue it at this time. 
> 

I would simply like to be able to use HARN data in Mapserver layers, 
PostGIS datasets, and rasters manipulated by GDAL.  I don't even mind if 
it's limited to being able to convert from NAD 83 HARN to NAD83 without 
introducing any errors.  Perhaps that is possible now, but when I asked, I 
was told "Just use NAD 83 -- it's close enough".

So, yes, it would be nice to be able to have a +datum=HARN, but generally, 
I just want to be able to use HARN data in Mapserver et al.  I don't mind 
a few hoops I have to jump through.

Bill

From bill at binko.net  Wed Jul  6 23:56:03 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Creating VRT from TILEINDEX?
Message-ID: <Pine.LNX.4.58.0507062352020.27034@fastcat.binko.net>

Hi everyone. 

I have used gdaltindex successfully to be able to show my images in 
mapserver.  What I'd like to do is to be able to treat the entire image 
set as a single virtual image so that I can use the GDAL library to 
manipulate it more easily.

Is there a way to take the .shp file created by gdaltindex (or perhaps the 
output from ogrinfo) and create a VRT file?

Bill

From sgillies at frii.com  Thu Jul  7 00:24:40 2005
From: sgillies at frii.com (Sean Gillies)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Creating VRT from TILEINDEX?
In-Reply-To: <Pine.LNX.4.58.0507062352020.27034@fastcat.binko.net>
References: <Pine.LNX.4.58.0507062352020.27034@fastcat.binko.net>
Message-ID: <e5a7e739734dced32fe5c7cc78f8b8cc@frii.com>

Bill,

Check out the VRT and tileindex examples in

   
http://hobu.biz/software/OSGIS_Hacks/python_OSGIS_hacks_aggregation.pdf

There's more than one way to do it, but maybe this would be a place to 
start.

cheers,
Sean

On Jul 6, 2005, at 9:56 PM, Bill Binko wrote:

> Hi everyone.
>
> I have used gdaltindex successfully to be able to show my images in
> mapserver.  What I'd like to do is to be able to treat the entire image
> set as a single virtual image so that I can use the GDAL library to
> manipulate it more easily.
>
> Is there a way to take the .shp file created by gdaltindex (or perhaps 
> the
> output from ogrinfo) and create a VRT file?
>
> Bill
>

--
Sean Gillies
sgillies at frii dot com
http://zcologia.com


From uwe.schmitz at lverma.nrw.de  Thu Jul  7 05:05:27 2005
From: uwe.schmitz at lverma.nrw.de (Schmitz, Uwe)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Inaccuracy concerning PseudoColor-Tables
Message-ID: <C900396522B3C142AA9A7F5AFEE11CB30A8AB0@slva01lvnt23.lverma.nrw.de>

Hi,

I've detected a slight inaccuracy during translation
of a Gtiff formatted file.

I have a file f2.tif on which "tiffinfo -c" gives me:

TIFF Directory at offset 0xf4691e
  Image Width: 4000 Image Length: 4000
  Bits/Sample: 8
  Sample Format: unsigned integer
  Compression Scheme: None
  Photometric Interpretation: palette color (RGB from colormap)
  Samples/Pixel: 1
  Rows/Strip: 2
  Planar Configuration: single image plane
  Color Map: 
       0: 65535 65535 65535
       1: 65535     0     0
       2: 57054 65021 65535
       3: 13107 26214 65535
       4: 61166 53713 49858
       5: 57825 50629 43947
       6: 63736 52428 43176
<<snip>>

After doing

gdal_translate -co COMPRESS=PACKBITS f2.tif f3.tif

a "tiffinfo -c" for f3.tif results in:

TIFF Directory at offset 0x4080a
  Image Width: 4000 Image Length: 4000
  Bits/Sample: 8
  Sample Format: unsigned integer
  Compression Scheme: PackBits
  Photometric Interpretation: palette color (RGB from colormap)
  Samples/Pixel: 1
  Rows/Strip: 2
  Planar Configuration: single image plane
  Color Map: 
       0: 65280 65280 65280
       1: 65280     0     0
       2: 56832 64768 65280
       3: 13056 26112 65280
       4: 60928 53504 49664
       5: 57600 50432 43776
       6: 63488 52224 43008
<<snip>>

Please note that every color value
(except 0) has slightly changed. Well, gdalinfo produces
the same Output for both files, but it works with 8 bit
resolution.

Also using the identify command line tool from
ImageMagick (which also uses 8 bit channel resolution),
I get the following output:


File f2.tif:

f2.tif TIFF 4000x4000 PseudoClass 256c 15.3mb 0.656u 0:01
Image: f2.tif
  Format: TIFF (Tagged Image File Format)
  Geometry: 4000x4000
  Class: PseudoClass
  Type: Palette
  Endianess: LSB
  Colorspace: RGB
  Channel depth:
    Red: 8-bits
    Green: 8-bits
    Blue: 8-bits
  Channel statistics:
    <<channel stats snipped>>
  Colors: 256
         0: (255,255,255)	white
         1: (255,  0,  0)	red
         2: (222,253,255)	#DEFDFF
         3: ( 51,102,255)	#3366FF
         4: (238,209,194)	#EED1C2
         5: (225,197,171)	#E1C5AB
         6: (248,204,168)	#F8CCA8
<<snip>>

File f3.tif:

__3.tif TIFF 4000x4000 PseudoClass 256c 276kb 0.672u 0:01
Image: __3.tif
  Format: TIFF (Tagged Image File Format)
  Geometry: 4000x4000
  Class: PseudoClass
  Type: Palette
  Endianess: LSB
  Colorspace: RGB
  Channel depth:
    Red: 9-bits
    Green: 9-bits
    Blue: 9-bits
  Channel statistics:
    <<channel stats snipped>>
  Colors: 256
         0: (254,254,254)	#FEFEFE
         1: (254,  0,  0)	#FE0000
         2: (221,252,254)	#DDFCFE
         3: ( 50,101,254)	#3265FE
         4: (237,208,193)	#EDD0C1
         5: (224,196,170)	#E0C4AA
         6: (247,203,167)	#F7CBA7
<<snip>>

(Please recognize the unusual channel depth)

I've tested these with FWTools0.9.8 under Windows
and with gdal1.2.6 under Unix. I think this is a bug,
but may be I'm  missing something.

Best wishes
Uwe

---------------------------------------------------------
... Uwe Schmitz  Landesvermessungsamt Nordrhein-Westfalen
... Muffendorfer Str. 19 - 21              D - 53177 Bonn
... E-mail:       uwe.schmitzNO@SPAMlverma.nrw.de
... Internet:     http://www.lverma.nrw.de
 

From fwarmerdam at gmail.com  Thu Jul  7 09:24:23 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Inaccuracy concerning PseudoColor-Tables
In-Reply-To: <C900396522B3C142AA9A7F5AFEE11CB30A8AB0@slva01lvnt23.lverma.nrw.de>
References: <C900396522B3C142AA9A7F5AFEE11CB30A8AB0@slva01lvnt23.lverma.nrw.de>
Message-ID: <931f8ea905070706242c58c57@mail.gmail.com>

On 7/7/05, Schmitz, Uwe <uwe.schmitz@lverma.nrw.de> wrote:
> Hi,
> 
> I've detected a slight inaccuracy during translation
> of a Gtiff formatted file.
> 
> I have a file f2.tif on which "tiffinfo -c" gives me:
...
>   Color Map:
>        0: 65535 65535 65535
>        1: 65535     0     0
>        2: 57054 65021 65535
>        3: 13107 26214 65535
>        4: 61166 53713 49858
>        5: 57825 50629 43947
>        6: 63736 52428 43176
> <<snip>>
> 
> After doing
> 
> gdal_translate -co COMPRESS=PACKBITS f2.tif f3.tif
...
>   Color Map:
>        0: 65280 65280 65280
>        1: 65280     0     0
>        2: 56832 64768 65280
>        3: 13056 26112 65280
>        4: 60928 53504 49664
>        5: 57600 50432 43776
>        6: 63488 52224 43008

Uwe, 

I was somewhat shocked to see this, since I thought I had been
very careful about retaining the full dynamic range when converting
to 16bit for tiff colormaps.  What I discovered in the code is that there
are two sets of logic for writing colormaps in TIFF.  One for "immediate
writes" and one used in the CreateCopy() case (as used by gdal_translate). 
The immediate mode (SetColorTable()) was done right, but the 
CreateCopy() was not.  

I have committed a correction for this to CVS. 

Thanks for the careful report. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From MChapman at sanz.com  Thu Jul  7 11:47:52 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] BMP not reading overview
Message-ID: <ED3A48B9840E594890A2BC172D11946502F9BF26@mailman.san.com>

Is this a new bug? BMP and OVR files work ok for me.

Martin

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Frank Warmerdam
Sent: Tuesday, July 05, 2005 2:46 PM
To: Peng Gao
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] BMP not reading overview


On 7/1/05, Peng Gao <pgao@esri.com> wrote:
> BMP format doesn't recognize an overview (.ovr) once one is built for 
> it. It seems that the following is missing from BMPDataset::Open().

Peng,

I think Andrey has now committed a fix for this. 

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From jhayes at lizardtech.com  Thu Jul  7 13:49:57 2005
From: jhayes at lizardtech.com (John Hayes)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] converting from NAD 83 to NAD 83 HARN
Message-ID: <DBEC881B4E22D1449F5FAC530E1ADD12088911@sea-srv-ms3.lizardtech.com>

Frank,
  Thanks for the ideas.  I found some HARN grid shift files the other day so I will give this a try in the next few days.

Thanks,
-john

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent: Wednesday, July 06, 2005 5:09 PM
To: John Hayes
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] converting from NAD 83 to NAD 83 HARN


On 7/6/05, John Hayes <jhayes@lizardtech.com> wrote:
> Hi
> 
> I'm trying to reproject an image from "Arizona Central State Plane NAD 83" to "Arizona Central State Plane NAD 83 HARN".  This should shift the image by (X=-0.100, Y=0.182) meters according to http://www.ngs.noaa.gov/cgi-bin/nadcon2.prl.  PROJ4 does not seem to be applying the shift.
> 
> Does PROJ4 support HARN corrections?
> 
> I have the "normal" NADCOM grid shift files installed and a 2005-04-25 snapshot of GDAL.

John,

PROJ/GDAL is not distributed with any HARN related grid shift files
as far as I know, and in any event, the OGRSpatialReference needs
to have special cases in the WKT<->PROJ.4 translation to use grid
shift files, which it does not have for HARN. 

How are you specifying the HARN coordinate systems?  By EPSG
code?  

I think the solution to this issue would be for GDAL to support a WKT
extension for specifying grid shift files, as opposed to the TOWGS84
method of defining a datum.   I think ESRI WKT already has this feature,
so I could do it similarly.  However, this isn't really high on my 
priority list at this time. 

If you just wanted to hack something in, you would need to look in the
gdal/ogr/ogr_srs_proj.cpp code circa line 1670 (search for 
+datum=nzgd49).   You would also need to read up on use of
grid shift files on the PROJ.4 web site (the +nadgrids option) and
dig up suitable HARN grid shift files. 

All in all quite alot of work!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From saintsjd at yahoo.com  Thu Jul  7 14:49:46 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] open source co-registration tools?
Message-ID: <20050707184947.16638.qmail@web53901.mail.yahoo.com>

I am now successfully using gdal to manipulate HDF
aster data thanks to this list's excellent assistance.
Thank you all.

I now need to co-register my asters with a Landsat
dataset. Does anyone know of open source tools (maybe
gdal APIs?) that I could use to go about
co-registering the aster data set to the Landsat data?

We are using ITPfind and I thought that there must be
an alternative.

Thanks
Jon

From bill at binko.net  Thu Jul  7 16:51:04 2005
From: bill at binko.net (Bill Binko)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Creating VRT from TILEINDEX?
In-Reply-To: <e5a7e739734dced32fe5c7cc78f8b8cc@frii.com>
References: <Pine.LNX.4.58.0507062352020.27034@fastcat.binko.net>
	<e5a7e739734dced32fe5c7cc78f8b8cc@frii.com>
Message-ID: <Pine.LNX.4.58.0507071650470.9111@fastcat.binko.net>

Thanks Sean

I have taken a look and will give it a go.

Bill

On Wed, 6 Jul 2005, Sean Gillies wrote:

> Bill,
> 
> Check out the VRT and tileindex examples in
> 
>    
> http://hobu.biz/software/OSGIS_Hacks/python_OSGIS_hacks_aggregation.pdf
> 
> There's more than one way to do it, but maybe this would be a place to 
> start.
> 
> cheers,
> Sean
> 
> On Jul 6, 2005, at 9:56 PM, Bill Binko wrote:
> 
> > Hi everyone.
> >
> > I have used gdaltindex successfully to be able to show my images in
> > mapserver.  What I'd like to do is to be able to treat the entire image
> > set as a single virtual image so that I can use the GDAL library to
> > manipulate it more easily.
> >
> > Is there a way to take the .shp file created by gdaltindex (or perhaps 
> > the
> > output from ogrinfo) and create a VRT file?
> >
> > Bill
> >
> 
> --
> Sean Gillies
> sgillies at frii dot com
> http://zcologia.com
> 
> 
> 

From pierregm at engr.uga.edu  Fri Jul  8 00:45:49 2005
From: pierregm at engr.uga.edu (Pierre GM)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Floating point exception on x86_64
Message-ID: <200507080045.49650.pierregm@engr.uga.edu>

Folks,
I've been a quasi daily user of gdal for the last three years on x86. For the 
last week, I've been trying to use gdal-1.26 on two 64b machines, a Mobile 
AMD64 and a P4_E64. Both machines run Gentoo. I first used the gentoo ebuild. 
On both machines, installation works, gdal-config works properly, and I'm 
able to use the GRASS 'r.in.gdal' with success.
However, gdalinfo, gdalwarp, ogrinfo ... all crash with a floating point 
exception (even with as simple as a --help as flag). A dmesg gives me (for 
example):
gdalinfo[2657] trap divide error rip:3682a0811d rsp:7fffffffe900 error:0
gdalwarp[2799] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0
ogrinfo[2922] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0

Here are my regular CFLAGS and FFLAGS
CFLAGS="-march=k8 -O2 -pipe -fweb"
FLAGS="-march=k8 -O2 -pipe -fweb"
On top of that, I have 'pic' in my USE flags (for non-gentooer, that puts an 
additional -fPIC to the flags when needed).

Compiling the sources 'by hand' leads to the same (absence of) results. Same 
thing with 1.2.5

Any idea/comment/suggestion would be more than welcome, a GIS without gdal 
isn't really worth

Thx in advance

-- 
Pierre GERARD-MARCHANT
Dept. of Biological & Agricultural Engr.
Driftmier Engineering Center
ATHENS GA 30602-4435
Tel: (706) 542.8832 - Fax: (706) 542.8806

From fwarmerdam at gmail.com  Fri Jul  8 09:27:15 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Floating point exception on x86_64
In-Reply-To: <200507080045.49650.pierregm@engr.uga.edu>
References: <200507080045.49650.pierregm@engr.uga.edu>
Message-ID: <931f8ea9050708062727c04eaf@mail.gmail.com>

On 7/8/05, Pierre GM <pierregm@engr.uga.edu> wrote:
> Folks,
> I've been a quasi daily user of gdal for the last three years on x86. For the
> last week, I've been trying to use gdal-1.26 on two 64b machines, a Mobile
> AMD64 and a P4_E64. Both machines run Gentoo. I first used the gentoo ebuild.
> On both machines, installation works, gdal-config works properly, and I'm
> able to use the GRASS 'r.in.gdal' with success.
> However, gdalinfo, gdalwarp, ogrinfo ... all crash with a floating point
> exception (even with as simple as a --help as flag). A dmesg gives me (for
> example):
> gdalinfo[2657] trap divide error rip:3682a0811d rsp:7fffffffe900 error:0
> gdalwarp[2799] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0
> ogrinfo[2922] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0
> 
> Here are my regular CFLAGS and FFLAGS
> CFLAGS="-march=k8 -O2 -pipe -fweb"
> FLAGS="-march=k8 -O2 -pipe -fweb"
> On top of that, I have 'pic' in my USE flags (for non-gentooer, that puts an
> additional -fPIC to the flags when needed).
> 
> Compiling the sources 'by hand' leads to the same (absence of) results. Same
> thing with 1.2.5
> 
> Any idea/comment/suggestion would be more than welcome, a GIS without gdal
> isn't really worth

Pierre, 

Have you tried running gdalinfo in gdb?  Have you tried building after 
configuring --without-libtool?   If you don't make any progress with these
suggestions, and are able to provide me with ssh access, I would be
willing to do a few experiments on the system. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From zhang at aero.und.edu  Fri Jul  8 14:54:26 2005
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] how to uninstall gdal
Message-ID: <42CECBE2.5070306@aero.und.edu>

Hi developers,

With all the love to gdal and high regards to the developers, I'm just 
curious to know how to uninstall gdal package once it is installed 
through ./configure, make, make install (as root). I'm not sure if I 
will ever need it, but it would be nice to know if this can be done or 
not. I tried "make uninstall", which did not work.

For the proj package, "make uninstall" seems working.

Appreciate if someone can drop a line or two. Thanks.

Xiaodong


From fwarmerdam at gmail.com  Fri Jul  8 17:21:48 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] how to uninstall gdal
In-Reply-To: <42CECBE2.5070306@aero.und.edu>
References: <42CECBE2.5070306@aero.und.edu>
Message-ID: <931f8ea9050708142174899752@mail.gmail.com>

On 7/8/05, Xiaodong Zhang <zhang@aero.und.edu> wrote:
> Hi developers,
> 
> With all the love to gdal and high regards to the developers, I'm just
> curious to know how to uninstall gdal package once it is installed
> through ./configure, make, make install (as root). I'm not sure if I
> will ever need it, but it would be nice to know if this can be done or
> not. I tried "make uninstall", which did not work.
> 
> For the proj package, "make uninstall" seems working.
> 
> Appreciate if someone can drop a line or two. Thanks.

Xiadong, 

Sorry, make uninstall is not currently a feature of GDAL.  
If you need to be able to remove it, you could install it into
a GDAL specific tree with a configuration something like:

  ./configure --prefix=/usr/local/gdal

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From yangjh_163 at 163.com  Sat Jul  9 02:32:31 2005
From: yangjh_163 at 163.com (=?gb2312?B?eWFuZ2poXzE2Mw==?=)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] question about building with ecw lib?
Message-ID: <42CF6F7F.000021.10761@m0214.mail.163.com>



hi,
when i build gdal 1.2.6 with external ECW lib which are downded from http://www.ermapper.com/ecw/ using vc6.0, some questions have happened, is there other 
configuration i should set?

thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050709/ec220811/attachment.html
From dem at acri-st.fr  Tue Jul 12 03:22:41 2005
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] ogr2ogr Lambert 2 etendu to latlong
Message-ID: <6.1.1.1.0.20050712092218.025038b8@pop3>

Hi,

I try to convert with oogr2ogr a MapInfo vector data (the file "Fhd03.TAB" 
in the last MapInfo) with this projection :

$ ogrinfo Fhd03.TAB Fhd03 | more
Had to open data source read-only.
INFO: Open of `Fhd03.TAB'
using driver `MapInfo File' successful.

Layer name: Fhd03
Geometry: Unknown (any)
Feature Count: 8486
Extent: (75692.351355, 1633578.266952) - (1197468.936297, 2674331.601748)
Layer SRS WKT:
PROJCS["unnamed",
     GEOGCS["unnamed",
         DATUM["MIF 1002",
             SPHEROID["Clarke 1880 (modified for IGN)",6378249.2,293.4660213],
             TOWGS84[-168,-60,320,0,0,0,0]],
         PRIMEM["non-Greenwich",2.337229166667],
         UNIT["degree",0.0174532925199433]],
     PROJECTION["Lambert_Conformal_Conic_2SP"],
     PARAMETER["standard_parallel_1",45.898918964419],
     PARAMETER["standard_parallel_2",47.696014502038],
     PARAMETER["latitude_of_origin",46.8],
     PARAMETER["central_meridian",0],
     PARAMETER["false_easting",600000],
     PARAMETER["false_northing",2200000],
     UNIT["Meter",1.0]]
TOPONYMIE: String (27.0)
...

to latlong with this command : ogr2ogr -f "MapInfo File" -t_srs 
'+proj=latlong' france_hydro.tab Fhd03.TAB Fhd03
It works but the output seems have an offset of ~4.5?W...

I failed too to translate to Shapefile : "ERROR 1: Attempt to write 
non-linestring (POLYGON) geometry to ARC type shapefile."
I tried -lco SHPT=POLYGON and -nlt=POLYGON but it doesn't work.

I use GDAL 1.2.6.

Thanks in advance,

Julien
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050712/8ee3feb6/attachment.html
From pierregm at engr.uga.edu  Mon Jul 11 19:25:43 2005
From: pierregm at engr.uga.edu (Pierre GM)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Floating point exception on x86_64
In-Reply-To: <42D22752.3060803@ecovla.nl>
References: <200507080045.49650.pierregm@engr.uga.edu>
	<42D22752.3060803@ecovla.nl>
Message-ID: <200507111925.49023.pierregm@engr.uga.edu>

Folks, 
More info about this floating point exception of mine:

After checking the configuration flags one by one, it seems that the 
--with-ogdi flag is the culprit. I was able to compile and run gdal with 
success when I deselected it (well, a gdalinfo --version worked, a r.out.gdal 
worked as well, so that should be OK). I also tried the gentoo ebuild, with a 
USE="-ogdi" flag, and got the same good results. Note that vincent's config 
didn't use ogdi, that might be why vincent didn't get any error... Note also 
that I sued hdf, but not netcdf (I unemerged it for whatvr reason, and can't 
get it back because of some F90 tests failures I'm currently investigating)

As I don't really need ogdi, I'm happy with that for now. However, because I'm 
curious and not a cat, I'd be quite interested in knowing what goes wrong 
where: I suspect there might be another pb lurking on my machine.


Thanks for your time


-- 
Pierre GERARD-MARCHANT
Dept. of Biological & Agricultural Engr.
Driftmier Engineering Center
ATHENS GA 30602-4435
Tel: (706) 542.8832 - Fax: (706) 542.8806

From vincent at ecovla.nl  Mon Jul 11 04:01:22 2005
From: vincent at ecovla.nl (vincent@ecovla.nl)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Floating point exception on x86_64
In-Reply-To: <200507080045.49650.pierregm@engr.uga.edu>
References: <200507080045.49650.pierregm@engr.uga.edu>
Message-ID: <42D22752.3060803@ecovla.nl>

Just FYI,

I've been running gdal for more than one year now on amd64 linux
(Gentoo) without any (well, without much apparently amd64 related)
problems. Somewhere in the misty outbacks of my memory I do recall to
have had some problems in the beginning (could search the mailing list
for that) but those were solved by Frank then.
I always compile gdal from cvs, though, have never used the gentoo
ebuild. That could be some hint.

My gdal configure script:

#!/bin/bash
#gdal configure script
CFLAGS="-O3 -march=k8 " CXXFLAGS="-O3 -march=k8 " \
./configure \
--with-libz \
--with-png \
--with-libtiff=internal \
--with-geotiff=internal \
--with-jpeg \
--with-netcdf=/usr/lib \
--with-hdf4=/usr/lib \
--with-pg \
--with-grass=/usr/local/grass-6.1.cvs \
--with-odbc \
--with-jasper=no \
--with-geos

(and for the careful reader: yes, netcdf *and* hdf4 do work without any
interference, takes some ebuild tricks though).

Regards,
Vincent.


Pierre GM wrote:

>Folks,
>I've been a quasi daily user of gdal for the last three years on x86. For the 
>last week, I've been trying to use gdal-1.26 on two 64b machines, a Mobile 
>AMD64 and a P4_E64. Both machines run Gentoo. I first used the gentoo ebuild. 
>On both machines, installation works, gdal-config works properly, and I'm 
>able to use the GRASS 'r.in.gdal' with success.
>However, gdalinfo, gdalwarp, ogrinfo ... all crash with a floating point 
>exception (even with as simple as a --help as flag). A dmesg gives me (for 
>example):
>gdalinfo[2657] trap divide error rip:3682a0811d rsp:7fffffffe900 error:0
>gdalwarp[2799] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0
>ogrinfo[2922] trap divide error rip:3682a0811d rsp:7fffffffe910 error:0
>
>Here are my regular CFLAGS and FFLAGS
>CFLAGS="-march=k8 -O2 -pipe -fweb"
>FLAGS="-march=k8 -O2 -pipe -fweb"
>On top of that, I have 'pic' in my USE flags (for non-gentooer, that puts an 
>additional -fPIC to the flags when needed).
>
>Compiling the sources 'by hand' leads to the same (absence of) results. Same 
>thing with 1.2.5
>
>Any idea/comment/suggestion would be more than welcome, a GIS without gdal 
>isn't really worth
>
>Thx in advance
>
>  
>


From vincent at ecovla.nl  Mon Jul 11 06:59:01 2005
From: vincent at ecovla.nl (vincent@ecovla.nl)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] nodata error with gdalwarp and -rcs option
Message-ID: <42D250F5.1000603@ecovla.nl>

Frank, folks,

I found an error with gdalwarp. It appears that when the -rcs resampling
option is used in combination with -srcnodata and -dstnodata, the nodata
pixels still get interpolated. When another resampling option is used,
the nodata pixels are (correctly) retained as such in the output image.

Regards,
Vincent.

From tugrul at galatali.com  Sat Jul  9 22:11:09 2005
From: tugrul at galatali.com (Tugrul Galatali)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdalwarp hangs when -dstnodata is used
In-Reply-To: <200506151504.26233.dylan@iici.no-ip.org>
References: <200506151504.26233.dylan@iici.no-ip.org>
Message-ID: <1120961469.2501.32.camel@roach>

On Wed, 2005-06-15 at 15:04 -0700, Dylan Beaudette wrote:
> Hi,
> 
> gdalwarp (1.2.6 compiled from source) hangs after successfully re-projecting a 
> raster image when the -dstnodata flag is present.

	Same problem here. -tps has no effect. Taking out TILED=YES makes it
SIGSEGV instead of hang, same place. Anyway I do it, I do get an image,
but its solid black.

(gdb) run -s_srs "+init=nad83:3702 +units=us-ft" -tps -t_srs "+proj=utm +zone=11 +ellps=WGS84" -dstnodata 0 -co "TILED=YES" /tmp/25_43.tif /tmp/foo.tif
Starting program: /tmp/gdal-1.2.6/apps/.libs/lt-gdalwarp -s_srs "+init=nad83:3702 +units=us-ft" -tps -t_srs "+proj=utm +zone=11 +ellps=WGS84" -dstnodata 0 -co "TILED=YES" /tmp/25_43.tif /tmp/foo.tif
Creating output file that is 8981P x 8554L.
:0...10...20...30...40...50...60...70...80...90...100 - done.

Program received signal SIGINT, Interrupt.
0xb7a040a7 in mallopt () from /lib/tls/libc.so.6
(gdb) bt
#0  0xb7a040a7 in mallopt () from /lib/tls/libc.so.6
#1  0xb7a03f6e in mallopt () from /lib/tls/libc.so.6
#2  0xb7a02dcb in free () from /lib/tls/libc.so.6
#3  0xb7de27be in VSIFree (pData=0x8061ed8) at cpl_vsisimple.cpp:343
#4  0xb7dee9df in GDALDestroyWarpOptions (psOptions=0x8061ed8) at gdalwarper.cpp:752
#5  0xb7df79ac in GDALWarpOperation::WipeOptions (this=0xbffff54c) at gdalwarpoperation.cpp:249
#6  0xb7df86dc in ~GDALWarpOperation (this=0xbffff54c) at gdalwarpoperation.cpp:217
#7  0x0804b7b5 in main (argc=12, argv=0x804d430) at gdalwarp.cpp:685
(gdb) 

	I'm sending Mr. Warmerdam a link to the file in a private email.

	Tugrul Galatali



From fwarmerdam at gmail.com  Tue Jul 12 11:38:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] nodata error with gdalwarp and -rcs option
In-Reply-To: <42D250F5.1000603@ecovla.nl>
References: <42D250F5.1000603@ecovla.nl>
Message-ID: <931f8ea9050712083811035772@mail.gmail.com>

On 7/11/05, vincent@ecovla.nl <vincent@ecovla.nl> wrote:
> Frank, folks,
> 
> I found an error with gdalwarp. It appears that when the -rcs resampling
> option is used in combination with -srcnodata and -dstnodata, the nodata
> pixels still get interpolated. When another resampling option is used,
> the nodata pixels are (correctly) retained as such in the output image.

Vincent,

Yes, there is a bug report open on this already. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Tom.Kralidis at ec.gc.ca  Sun Jul 10 15:58:33 2005
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Autodesk DWF library
Message-ID: <2576812186CDD411BF1500508B6DCE950972FD84@ecnwri1.ontario.int.ec.gc.ca>


FYI -- wonder if this would be useful for inclusion as an OGR supported
format?

..Tom

http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=5520675

From t.r.decarlo at larc.nasa.gov  Tue Jul 12 13:52:46 2005
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] projection lost when translating HDF to GTiff
Message-ID: <012b01c5870a$82fb30d0$959877c6@cts1149>

Hi,
I gave up on compiling the HDF4 code myself and found that the binary bundle
will work with a couple of tweaks.

Anyway, I've got a bunch of ASTER DEM files that I need to convert to
geotiff and I'm losing the geographic projection info when I do the simple
"gdal_translate -of GTiff input.hdf output.tif"

I looked at the online docs and didn't see anything special needed to do
this translate. Can someone tell me what I'm missing?

Thanks,
Thom
--
Thom DeCarlo
-------------------------------------------------------
          It is ok to celebrate diversity...
As long as you don't point out that people are different.
                                - Colin Quinn



From fwarmerdam at gmail.com  Tue Jul 12 14:54:02 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Autodesk DWF library
In-Reply-To: <2576812186CDD411BF1500508B6DCE950972FD84@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950972FD84@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <931f8ea905071211547fabc55a@mail.gmail.com>

On 7/10/05, Kralidis,Tom [Burlington] <Tom.Kralidis@ec.gc.ca> wrote:
> 
> FYI -- wonder if this would be useful for inclusion as an OGR supported
> format?
> 
> ..Tom
> 
> http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=5520675

Tom,

What isn't clear to me is how much interest there is in DWF support.
Reading over the DWF FAQ I am concerned that it isn't a very 
accurate format.  I also *suspect* the original data is pretty dumbed 
down for display purposes though I don't know that for a fact.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bfraser at geoanalytic.com  Tue Jul 12 15:42:14 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] projection lost when translating HDF to GTiff
References: <012b01c5870a$82fb30d0$959877c6@cts1149>
Message-ID: <026f01c58719$cdc74d10$160002c0@shark>

Thom,

  Do you get a coord sys defined when you do a "gdalinfo" on the hdf file?

Brent


----- Original Message ----- 
From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
To: <gdal-dev@xserve.flids.com>
Sent: Tuesday, July 12, 2005 11:52 AM
Subject: [Gdal-dev] projection lost when translating HDF to GTiff


Hi,
I gave up on compiling the HDF4 code myself and found that the binary bundle
will work with a couple of tweaks.

Anyway, I've got a bunch of ASTER DEM files that I need to convert to
geotiff and I'm losing the geographic projection info when I do the simple
"gdal_translate -of GTiff input.hdf output.tif"

I looked at the online docs and didn't see anything special needed to do
this translate. Can someone tell me what I'm missing?

Thanks,
Thom
--
Thom DeCarlo
-------------------------------------------------------
          It is ok to celebrate diversity...
As long as you don't point out that people are different.
                                - Colin Quinn


_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev


From matt.wilkie at gov.yk.ca  Tue Jul 12 16:01:22 2005
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] nodata error with gdalwarp and -rcs option
In-Reply-To: <42D250F5.1000603@ecovla.nl>
References: <42D250F5.1000603@ecovla.nl>
Message-ID: <42D42192.5070305@gov.yk.ca>

vincent@ecovla.nl wrote:
> Frank, folks,
> 
> I found an error with gdalwarp. It appears that when the -rcs resampling
> option is used in combination with -srcnodata and -dstnodata, the nodata
> pixels still get interpolated. When another resampling option is used,
> the nodata pixels are (correctly) retained as such in the output image.

this sounds the same as 
http://bugzilla.remotesensing.org/show_bug.cgi?id=793
as long as my resampling is set to default (bilinear) nodata remains nodata.


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

From t.r.decarlo at larc.nasa.gov  Tue Jul 12 16:50:50 2005
From: t.r.decarlo at larc.nasa.gov (Thom DeCarlo)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] projection lost when translating HDF to GTiff
In-Reply-To: <026f01c58719$cdc74d10$160002c0@shark>
Message-ID: <013e01c58723$63301db0$959877c6@cts1149>

Hi Brent,
Yes, it does show a coord sys, but it is defined by GCPs. I found an email
in the archive that says I need to use gdalwarp to convert it into a
geo-transform matrix-based system. I've tried doing that, but for some
reason the output is not ending up in UTM. Instead, Imagine says it is
Transverse Mercator. I've tried setting the target coord sys manually
(-t_srs "+proj=utm +zone=-19 +datum=wgs84"), but I cannot figure out how to
tell it that it is in the southern hemisphere. And I really don't think I
should have to give it the target coord sys. The data is starting in UTM so
it should stay in UTM.

--
Thom DeCarlo
-------------------------------------------------------
     Is it a bad sign if you spend the day wondering
why there are no laws against what you do for a living?
                                - Dilbert

> -----Original Message-----
> From: Brent Fraser
> Sent: Tuesday, July 12, 2005 3:42 PM
> To: Thom DeCarlo; gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] projection lost when translating HDF to GTiff
> 
> Thom,
> 
>   Do you get a coord sys defined when you do a "gdalinfo" on the hdf file?
> 
> Brent
> 
> 
> ----- Original Message -----
> From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
> To: <gdal-dev@xserve.flids.com>
> Sent: Tuesday, July 12, 2005 11:52 AM
> Subject: [Gdal-dev] projection lost when translating HDF to GTiff
> 
> 
> Hi,
> I gave up on compiling the HDF4 code myself and found that the binary
> bundle
> will work with a couple of tweaks.
> 
> Anyway, I've got a bunch of ASTER DEM files that I need to convert to
> geotiff and I'm losing the geographic projection info when I do the simple
> "gdal_translate -of GTiff input.hdf output.tif"
> 
> I looked at the online docs and didn't see anything special needed to do
> this translate. Can someone tell me what I'm missing?
> 
> Thanks,
> Thom
> --
> Thom DeCarlo
> -------------------------------------------------------
>           It is ok to celebrate diversity...
> As long as you don't point out that people are different.
>                                 - Colin Quinn
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev



From bfraser at geoanalytic.com  Tue Jul 12 17:06:18 2005
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] projection lost when translating HDF to GTiff
References: <013e01c58723$63301db0$959877c6@cts1149>
Message-ID: <062b01c58725$8c70f580$160002c0@shark>

Thom,

  "+south" should do it.  Not too sure about "-19" as a zone number...  So
try:

-t_srs "+proj=utm +zone=19 +south +datum=WGS84"

  If the orginal data is defined by GCPs and not a spatial reference system
definition type (EPSG, proj, ...) gdalwarp/gdalinfo can translate into EPSG,
then you will have to specifiy -t_srs option.

Brent


----- Original Message ----- 
From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
To: "'Brent Fraser'" <bfraser@geoanalytic.com>; <gdal-dev@xserve.flids.com>
Sent: Tuesday, July 12, 2005 2:50 PM
Subject: RE: [Gdal-dev] projection lost when translating HDF to GTiff


Hi Brent,
Yes, it does show a coord sys, but it is defined by GCPs. I found an email
in the archive that says I need to use gdalwarp to convert it into a
geo-transform matrix-based system. I've tried doing that, but for some
reason the output is not ending up in UTM. Instead, Imagine says it is
Transverse Mercator. I've tried setting the target coord sys manually
(-t_srs "+proj=utm +zone=-19 +datum=wgs84"), but I cannot figure out how to
tell it that it is in the southern hemisphere. And I really don't think I
should have to give it the target coord sys. The data is starting in UTM so
it should stay in UTM.

--
Thom DeCarlo
-------------------------------------------------------
     Is it a bad sign if you spend the day wondering
why there are no laws against what you do for a living?
                                - Dilbert

> -----Original Message-----
> From: Brent Fraser
> Sent: Tuesday, July 12, 2005 3:42 PM
> To: Thom DeCarlo; gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] projection lost when translating HDF to GTiff
>
> Thom,
>
>   Do you get a coord sys defined when you do a "gdalinfo" on the hdf file?
>
> Brent
>
>
> ----- Original Message -----
> From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
> To: <gdal-dev@xserve.flids.com>
> Sent: Tuesday, July 12, 2005 11:52 AM
> Subject: [Gdal-dev] projection lost when translating HDF to GTiff
>
>
> Hi,
> I gave up on compiling the HDF4 code myself and found that the binary
> bundle
> will work with a couple of tweaks.
>
> Anyway, I've got a bunch of ASTER DEM files that I need to convert to
> geotiff and I'm losing the geographic projection info when I do the simple
> "gdal_translate -of GTiff input.hdf output.tif"
>
> I looked at the online docs and didn't see anything special needed to do
> this translate. Can someone tell me what I'm missing?
>
> Thanks,
> Thom
> --
> Thom DeCarlo
> -------------------------------------------------------
>           It is ok to celebrate diversity...
> As long as you don't point out that people are different.
>                                 - Colin Quinn
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev



From hamish_nospam at yahoo.com  Tue Jul 12 19:33:09 2005
From: hamish_nospam at yahoo.com (Hamish)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Autodesk DWF library
In-Reply-To: <2576812186CDD411BF1500508B6DCE950972FD84@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950972FD84@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <20050713113309.0db91053.hamish_nospam@yahoo.com>

> FYI -- wonder if this would be useful for inclusion as an OGR
> supported format?
> 
> ..Tom
> 
> http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=5520675


On the DebianGIS mailing list Steve Halasz pointed out that there is a
Google Summer of Code project to add DXF/DWF support to Inkscape:
  http://inkscape.org


There was also a question about Autodesk's license- Steve wrote:

"I'm not well versed in these things, but this clause may not meet the
Debian Free Software Guidelines:

1.1.1 (a) Use the Licensed Software for development, research, internal,
educational, or commercial purposes;

I think it may discriminate against fields of endeavor not explicitly
listed here. Can a non-profit use it?"



Before this release from Autodesk, DXF support is/was currently only
well supported outside AutoCAD by the non-Free (cost-free but binary
only after registration) OpenDWG library:  http://www.opendwg.org

It's a common request by GRASS users to read DXF format, and we have
code that will use the OpenDWG library, but due to both OpenDWG's and
GRASS's licenses we can't distribute the library or a binary of the
interface module. Got a bug report yesterday wondering about this.

Of course is it up to Frank & whoever would do the work to decide if it
is appropriate to add DXF to OGR or leave as a stand-alone app.



2c,
Hamish

From paul at toolscenter.org  Tue Jul 12 20:21:07 2005
From: paul at toolscenter.org (Paul Selormey)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Autodesk DWF library
In-Reply-To: <931f8ea905071211547fabc55a@mail.gmail.com>
Message-ID: <20050713002120.4F5DD26D8323@xserve.flids.com>

It is simply an alternative to PDF. It started as Whip (may be
to whip PDF!).

If there should be a support for Autodesk formats, obviously it
should be DXF and DWG. May be one day Autodesk will sponsor GDAL
to add the support for their RealDWG library.

Best regards,
Paul.

> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com 
> [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Frank 
> Warmerdam
> Sent: Wednesday, July 13, 2005 3:54 AM
> To: Kralidis,Tom [Burlington]
> Cc: gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] Autodesk DWF library
> 
> On 7/10/05, Kralidis,Tom [Burlington] <Tom.Kralidis@ec.gc.ca> wrote:
> > 
> > FYI -- wonder if this would be useful for inclusion as an OGR 
> > supported format?
> > 
> > ..Tom
> > 
> > http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=5520675
> 
> Tom,
> 
> What isn't clear to me is how much interest there is in DWF support.
> Reading over the DWF FAQ I am concerned that it isn't a very 
> accurate format.  I also *suspect* the original data is 
> pretty dumbed down for display purposes though I don't know 
> that for a fact.
> 
> Best regards,
> -- 
> ---------------------------------------+----------------------
> ----------
> ---------------------------------------+------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial 
> Programmer for Rent
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 



From andy.canfield at gmail.com  Tue Jul 12 22:21:52 2005
From: andy.canfield at gmail.com (Andy Canfield)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Autodesk DWF library
In-Reply-To: <20050713002120.4F5DD26D8323@xserve.flids.com>
References: <20050713002120.4F5DD26D8323@xserve.flids.com>
Message-ID: <200507121921.52323.andy.canfield@gmail.com>

I have much interest in this area/topic as it is a part of my everyday work. I 
have worked a little with DWF, a lot with dwg, and a very little with DXF. 
Here is some background on where I have been with this issue so far.

There is more than one dwf format. There is the old Whip compatible format and 
there is the new format which is what that download deals with. 

The new format is a lot more complex than the old one but does a lot more cool 
stuff. It is still however basically a raster format with very little entity 
information other than what is visually displayed. The new format works a lot 
like a jar file with a manifest and uses the same compression as zip and jar 
files. 

As far as dwg goes there are right around 6 dwg formats and they are not in 
any usable way compatible with each other. They are the Pre-R12, R12, R14, 
2000, 2000i-2002, 2003-2006 formats. Autodesk will not release any stand 
alone libraries to deal with any of the dwg formats unless you pay for it. I 
work for a huge corporation and we have asked more than once and the answer 
was an absolute no. The format 2003-2006 is also encrypted or as AutoDesk 
says "locked to validate data". 

OpenDesign formerly OpenDwg is free for in house use but you must pay if you 
distribute for money. I think if you keep it open source and don't charge for 
it it is free as well(I would have to check on that though). Their API 
follows AutoDesk's ObjectArx and ObjectDbx API's so closely that the function 
signatures in their libraries can in many cases be extracted and compared and 
there is no binary difference between the stubs. This makes OpenDesign really 
easy to use if you are familiar with ObjectArx because where they lack 
documentation you can guess and pretty sure you will be correct. The nice 
thing about OpenDesign is that it can be used on other platforms besides 
Windows. It supports all the dwg formats and all the dxf formats. They also 
have an OpenDgn library that will support the Microstation dgn's and Bentley 
uses the OpenDesign stuff for their dwg to dgn translator so their support 
for dgn is good as well. Though not as well documented as their dwg/dxf 
library.

I have had some discussions with people, Frank included, about supporting dwg 
in gdal/ogr and it basically comes down to if you want good support for dwg 
without going through AutoDesk you have to use OpenDwg. If you put that in 
there then you would have to do it as a conditional support so if the user 
doesn't want to negotiate an agreement with the OpenDesign alliance they can 
choose not to. After that it amounts to is there enough demand for it and who 
is going to spend the time implementing it? 

I currently use the OpenDesign libraries and the Ogr source in the same 
application so I know there is no compatibility issues between Ogr and 
OpenDesign anyway. If somebody volunteers to implement this I am more than 
willing to help out with any questions they might have about the OpenDesign 
C++ API's. 
Thanks,
Andy

As an aside:
My approach at my work so far has been mostly readers that translate the 
OpenDesign objects to Ogr objects( overloading operator= ) so they can be 
displayed by my apps with one draw function vice a bunch of special cases. 
The areas I have been running into headaches with is the 3D nature of dwg 
objects and some of the odd things they support like bulges in polylines 
where the bulge can jump out into the Z which doesn't display well in 2d. So 
if anyone has ideas on how to make this look decent in 2d please let me know.


On Tuesday 12 July 2005 17:21, Paul Selormey wrote:
> It is simply an alternative to PDF. It started as Whip (may be
> to whip PDF!).
>
> If there should be a support for Autodesk formats, obviously it
> should be DXF and DWG. May be one day Autodesk will sponsor GDAL
> to add the support for their RealDWG library.
>
> Best regards,
> Paul.
>
> > -----Original Message-----
> > From: gdal-dev-bounces@xserve.flids.com
> > [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Frank
> > Warmerdam
> > Sent: Wednesday, July 13, 2005 3:54 AM
> > To: Kralidis,Tom [Burlington]
> > Cc: gdal-dev@xserve.flids.com
> > Subject: Re: [Gdal-dev] Autodesk DWF library
> >
> > On 7/10/05, Kralidis,Tom [Burlington] <Tom.Kralidis@ec.gc.ca> wrote:
> > > FYI -- wonder if this would be useful for inclusion as an OGR
> > > supported format?
> > >
> > > ..Tom
> > >
> > > http://usa.autodesk.com/adsk/servlet/item?siteID=123112&id=5520675
> >
> > Tom,
> >
> > What isn't clear to me is how much interest there is in DWF support.
> > Reading over the DWF FAQ I am concerned that it isn't a very
> > accurate format.  I also *suspect* the original data is
> > pretty dumbed down for display purposes though I don't know
> > that for a fact.
> >
> > Best regards,
> > --
> > ---------------------------------------+----------------------
> > ----------
> > ---------------------------------------+------
> > I set the clouds in motion - turn up   | Frank Warmerdam,
> > warmerdam@pobox.com
> > light and sound - activate the windows | http://pobox.com/~warmerdam
> > and watch the world go round - Rush    | Geospatial
> > Programmer for Rent
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@xserve.flids.com
> > http://xserve.flids.com/mailman/listinfo/gdal-dev
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev

From saintsjd at yahoo.com  Wed Jul 13 00:09:20 2005
From: saintsjd at yahoo.com (Jon Saints)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] projection lost when translating HDF to GTiff
In-Reply-To: <062b01c58725$8c70f580$160002c0@shark>
Message-ID: <20050713040920.8795.qmail@web53904.mail.yahoo.com>

You need to use gdal_warp instead of gdaltranslate. I
had the same problem for a while until the list helped
me.

To convert an hdf subset to geotiff with projection
information I use the command:

gdalwarp HDF_SUBSET_NAME_HERE OUT_FILE_NAME.tif

for example I run:
gdalinfo MYD09A1.A2004313.h21v10.004.2004324183345.hdf

and see:
Subdatasets:
SUBDATASET_1_NAME=HDF4_SDS:UNKNOWN:"MYD09A1.A2004313.h21v10.004.2004324183345.
hdf":0
  
I use this information to export the first hdf subset
to geotiff by the command:

gdalwarp
HDF4_SDS:UNKNOWN:"MYD09A1.A2004313.h21v10.004.2004324183345.
hdf":0 outfile_band1.tiff

I hope this helps
Jon


--- Brent Fraser <bfraser@geoanalytic.com> wrote:

> Thom,
> 
>   "+south" should do it.  Not too sure about "-19"
> as a zone number...  So
> try:
> 
> -t_srs "+proj=utm +zone=19 +south +datum=WGS84"
> 
>   If the orginal data is defined by GCPs and not a
> spatial reference system
> definition type (EPSG, proj, ...) gdalwarp/gdalinfo
> can translate into EPSG,
> then you will have to specifiy -t_srs option.
> 
> Brent
> 
> 
> ----- Original Message ----- 
> From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
> To: "'Brent Fraser'" <bfraser@geoanalytic.com>;
> <gdal-dev@xserve.flids.com>
> Sent: Tuesday, July 12, 2005 2:50 PM
> Subject: RE: [Gdal-dev] projection lost when
> translating HDF to GTiff
> 
> 
> Hi Brent,
> Yes, it does show a coord sys, but it is defined by
> GCPs. I found an email
> in the archive that says I need to use gdalwarp to
> convert it into a
> geo-transform matrix-based system. I've tried doing
> that, but for some
> reason the output is not ending up in UTM. Instead,
> Imagine says it is
> Transverse Mercator. I've tried setting the target
> coord sys manually
> (-t_srs "+proj=utm +zone=-19 +datum=wgs84"), but I
> cannot figure out how to
> tell it that it is in the southern hemisphere. And I
> really don't think I
> should have to give it the target coord sys. The
> data is starting in UTM so
> it should stay in UTM.
> 
> --
> Thom DeCarlo
>
-------------------------------------------------------
>      Is it a bad sign if you spend the day wondering
> why there are no laws against what you do for a
> living?
>                                 - Dilbert
> 
> > -----Original Message-----
> > From: Brent Fraser
> > Sent: Tuesday, July 12, 2005 3:42 PM
> > To: Thom DeCarlo; gdal-dev@xserve.flids.com
> > Subject: Re: [Gdal-dev] projection lost when
> translating HDF to GTiff
> >
> > Thom,
> >
> >   Do you get a coord sys defined when you do a
> "gdalinfo" on the hdf file?
> >
> > Brent
> >
> >
> > ----- Original Message -----
> > From: "Thom DeCarlo" <t.r.decarlo@larc.nasa.gov>
> > To: <gdal-dev@xserve.flids.com>
> > Sent: Tuesday, July 12, 2005 11:52 AM
> > Subject: [Gdal-dev] projection lost when
> translating HDF to GTiff
> >
> >
> > Hi,
> > I gave up on compiling the HDF4 code myself and
> found that the binary
> > bundle
> > will work with a couple of tweaks.
> >
> > Anyway, I've got a bunch of ASTER DEM files that I
> need to convert to
> > geotiff and I'm losing the geographic projection
> info when I do the simple
> > "gdal_translate -of GTiff input.hdf output.tif"
> >
> > I looked at the online docs and didn't see
> anything special needed to do
> > this translate. Can someone tell me what I'm
> missing?
> >
> > Thanks,
> > Thom
> > --
> > Thom DeCarlo
> >
>
-------------------------------------------------------
> >           It is ok to celebrate diversity...
> > As long as you don't point out that people are
> different.
> >                                 - Colin Quinn
> >
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@xserve.flids.com
> > http://xserve.flids.com/mailman/listinfo/gdal-dev
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 


From vincent at ecovla.nl  Wed Jul 13 03:34:25 2005
From: vincent at ecovla.nl (vincent@ecovla.nl)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] nodata error with gdalwarp and -rcs option
In-Reply-To: <42D42192.5070305@gov.yk.ca>
References: <42D250F5.1000603@ecovla.nl> <42D42192.5070305@gov.yk.ca>
Message-ID: <42D4C401.6010808@ecovla.nl>

Matt Wilkie wrote:

> vincent@ecovla.nl wrote:
>
>> Frank, folks,
>>
>> I found an error with gdalwarp. It appears that when the -rcs resampling
>> option is used in combination with -srcnodata and -dstnodata, the nodata
>> pixels still get interpolated. When another resampling option is used,
>> the nodata pixels are (correctly) retained as such in the output image.
>
>
> this sounds the same as
> http://bugzilla.remotesensing.org/show_bug.cgi?id=793
> as long as my resampling is set to default (bilinear) nodata remains
> nodata.
>
>
You're right, I should have searched bugzilla first of course...
Apologies for the spam.

Vincent.

From dassau at gdf-hannover.de  Thu Jul 14 04:25:35 2005
From: dassau at gdf-hannover.de (Otto Dassau)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] ArcView .odb support
Message-ID: <200507141025.35858.dassau@gdf-hannover.de>

Hi,

does GDAL support ArcView .odb (Object Database ASCII File) format? And if 
not, is this planned for a future release?

  thanks
     Otto

From BEN at Syncera-ITSolutions.NL  Thu Jul 14 08:29:40 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] DGN 8
Message-ID: <s2d676e1.077@syncera.nl>

Hi list,

are there any plans for adding DGN 8 support to OGR? What kind of effort would be involved? Are there more people interested in (funding) this support?

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl

From BEN at Syncera-ITSolutions.NL  Thu Jul 14 09:18:29 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] tileindex location field: width 80
Message-ID: <s2d68252.075@syncera.nl>

Hi list,

normally I always use absolute paths in a tileindex when using Mapserver.

Why is the width the location field created by ogrtindex only 80? This is not long enough for my absolute paths in some cases ....

Is there a way to overrule it or do I need to manually adapt the tileindex afterwards?

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl

From cplist at earthlink.net  Fri Jul 15 09:35:12 2005
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] old mailing list link on maptools
Message-ID: <8982415.1121434512781.JavaMail.root@wamui-rustique.atl.sa.earthlink.net>

Hey, Frank:

I caught myself trying to resubscribe w/ a new email alias and found that the link on http://gdal.maptools.org/ w/ the words "on the web" points to what must be an old mailman link, http://remotesensing.org/mailman/listinfo/gdal-dev/.

I guess it should point here instead, http://xserve.flids.com/mailman/listinfo/gdal-dev?

Charlton

From cplist at earthlink.net  Fri Jul 15 10:20:41 2005
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] problems compiling dods into gdal
Message-ID: <21455371.1121437241891.JavaMail.root@elrwmxml-silver.atl.sa.earthlink.net>

Hi, all:

I am running into problems when I try building OPeNDAP into gdal.  I was originally trying to follow a MapServer wiki post (http://mapserver.gis.umn.edu/cgi-bin/wiki.pl?DODS_Build), but that was a bit dated, so I thought I'd get the latest and greatest of both worlds.

I believe I successfully covered my bases w/ the prerequisite libcurl and libxml.

I downloaded libdap-3.5.1.tar.gz from UCAR and followed a:
  * ./configure --prefix=/usr/local/dods/3.5.1
  * make
  * make install
  * ldconfig

That all went fine.

I downloaded gdal-1.2.6.tar.gz from gdal.org and followed a:
  * ./configure --with-dods-root=/usr/local/dods/3.5.1 --without-python
  * The configure works fine and shows that DODS support will be 'yes'.
  * make
  * Make has problems when it gets to the dods stuff.  It can't find .h's, and it looks like the INC gets set incorrectly.  It should be looking in /usr/local/dods/3.5.1/include/dap rather than what I see on the @INC output which is /usr/local/dods/3.5.1/include.

make -C dods install-obj
make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
/bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
 g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
dodsdataset2.cpp:50:19: debug.h: No such file or directory
[followed by more errors]

So I thought that it was only a matter of an @INC path.  Since I had nothing to lose I tried both adding the correct path to the INC of the ./configure, and then I also tried copying the *.h's into what gdal wanted for the heck of it.  Neither worked well since I ran into cpp errors which I know zilch about.

(after copying the *.h's to where gdal could find them)
make -C dods install-obj
make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
/bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
 g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
dodsdataset2.cpp: In constructor `DODSDataset::DODSDataset()':
dodsdataset2.cpp:300: error: no matching function for call to `DDS::DDS()'
/usr/local/dods/3.5.1/include/DDS.h:254: error: candidates are: DDS::DDS(const 
   DDS&)

Any help appreciated.  gentoo.  Colinux rocks for those who want 2 for the price of one.

Charlton

From fwarmerdam at gmail.com  Fri Jul 15 10:53:28 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] old mailing list link on maptools
In-Reply-To: <8982415.1121434512781.JavaMail.root@wamui-rustique.atl.sa.earthlink.net>
References: <8982415.1121434512781.JavaMail.root@wamui-rustique.atl.sa.earthlink.net>
Message-ID: <931f8ea90507150753414e552d@mail.gmail.com>

On 7/15/05, Charlton Purvis <cplist@earthlink.net> wrote:
> Hey, Frank:
> 
> I caught myself trying to resubscribe w/ a new email alias and found that the link on http://gdal.maptools.org/ w/ the words "on the web" points to what must be an old mailman link, http://remotesensing.org/mailman/listinfo/gdal-dev/.
> 
> I guess it should point here instead, http://xserve.flids.com/mailman/listinfo/gdal-dev?

Charlton,

You are right, but I am expecting to migrate the mailing list shortly.
The xserve system is apparently going away.  "Server churn" is the
bane of my existance.   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jul 15 11:03:57 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] tileindex location field: width 80
In-Reply-To: <s2d68252.075@syncera.nl>
References: <s2d68252.075@syncera.nl>
Message-ID: <931f8ea9050715080358f583b7@mail.gmail.com>

On 7/14/05, Bart van den Eijnden <BEN@syncera-itsolutions.nl> wrote:
> Hi list,
> 
> normally I always use absolute paths in a tileindex when using Mapserver.
> 
> Why is the width the location field created by ogrtindex only 80? This is not long enough for my absolute paths in some cases ....
> 
> Is there a way to overrule it or do I need to manually adapt the tileindex afterwards?

Bart,

There is no special reason why the width is 80.  I have upped it to 200. 
One workaround would be to pre-create the index file using other
tools,and then use ogrtindex to append to it.  But if you can build from
source, doing so from CVS should resolve the issue.

Or changing your local tree to have the following in ogrtindex.cpp:

        if( poDstDS->GetLayerCount() == 0 )
        {
            OGRFieldDefn oLocation( pszTileIndexField, OFTString );
            
            oLocation.SetWidth( 200 );                       // new line

            poDstLayer = poDstDS->CreateLayer( "tileindex" );
            poDstLayer->CreateField( &oLocation, OFTString );
        }


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jul 15 11:11:05 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] DGN 8
In-Reply-To: <s2d676e1.077@syncera.nl>
References: <s2d676e1.077@syncera.nl>
Message-ID: <931f8ea905071508118a792ef@mail.gmail.com>

On 7/14/05, Bart van den Eijnden <BEN@syncera-itsolutions.nl> wrote:
> Hi list,
> 
> are there any plans for adding DGN 8 support to OGR? What kind of effort would be involved? Are there more people interested in (funding) this support?

Bart,

I have done some investigation and DGN 8 seems like a hard nut to 
crack.  I am not planning to try, but I think the easiest way to 
integrate it if desired would be to use the DGNdirect library (or
whatever it is called currently) from the open design alliance.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jul 15 11:25:31 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] ArcView .odb support
In-Reply-To: <200507141025.35858.dassau@gdf-hannover.de>
References: <200507141025.35858.dassau@gdf-hannover.de>
Message-ID: <931f8ea905071508257c660866@mail.gmail.com>

On 7/14/05, Otto Dassau <dassau@gdf-hannover.de> wrote:
> Hi,
> 
> does GDAL support ArcView .odb (Object Database ASCII File) format? And if
> not, is this planned for a future release?

Otto, 

GDAL/OGR does not support ArcView .odb and there are no plans 
for this.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jul 15 13:20:40 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] problems compiling dods into gdal
In-Reply-To: <21455371.1121437241891.JavaMail.root@elrwmxml-silver.atl.sa.earthlink.net>
References: <21455371.1121437241891.JavaMail.root@elrwmxml-silver.atl.sa.earthlink.net>
Message-ID: <931f8ea9050715102071bbc21e@mail.gmail.com>

On 7/15/05, Charlton Purvis <cplist@earthlink.net> wrote:
> Hi, all:
> 
> I am running into problems when I try building OPeNDAP into gdal.  I was originally trying to follow a MapServer wiki post (http://mapserver.gis.umn.edu/cgi-bin/wiki.pl?DODS_Build), but that was a bit dated, so I thought I'd get the latest and greatest of both worlds.
> 
> I believe I successfully covered my bases w/ the prerequisite libcurl and libxml.
> 
> I downloaded libdap-3.5.1.tar.gz from UCAR and followed a:
>   * ./configure --prefix=/usr/local/dods/3.5.1
>   * make
>   * make install
>   * ldconfig
> 
> That all went fine.
> 
> I downloaded gdal-1.2.6.tar.gz from gdal.org and followed a:
>   * ./configure --with-dods-root=/usr/local/dods/3.5.1 --without-python
>   * The configure works fine and shows that DODS support will be 'yes'.
>   * make
>   * Make has problems when it gets to the dods stuff.  It can't find .h's, and it looks like the INC gets set incorrectly.  It should be looking in /usr/local/dods/3.5.1/include/dap rather than what I see on the @INC output which is /usr/local/dods/3.5.1/include.

Charlton, 

I have committed changes to GDAL in CVS to put both dods_root/include
and dods_root/include/dap into the include path.  I think pushing
stuff down into
a dap subdirectory must be a new convention. 
 
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp:50:19: debug.h: No such file or directory
> [followed by more errors]
> 
> So I thought that it was only a matter of an @INC path.  Since I had nothing to lose I tried both adding the correct path to the INC of the ./configure, and then I also tried copying the *.h's into what gdal wanted for the heck of it.  Neither worked well since I ran into cpp errors which I know zilch about.
> 
> (after copying the *.h's to where gdal could find them)
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp: In constructor `DODSDataset::DODSDataset()':
> dodsdataset2.cpp:300: error: no matching function for call to `DDS::DDS()'
> /usr/local/dods/3.5.1/include/DDS.h:254: error: candidates are: DDS::DDS(const
>    DDS&)

This may be a bit harder.  I'll try and prepare a dap 3.5.1 build and see
what I can figure out. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From werchowyna at epf.pl  Fri Jul 15 14:28:38 2005
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] cannot build grass plugin in gdal - still
Message-ID: <032b01c5896b$185c5f20$afe41d3e@eustahiush>

Hi

Still I can't build the gdal-grass plugin in gdal. I'm following what the 
README says - and nothing.

I have GDAL and GRASS61 (both fresh cvs) installed properly in their 
standard locations.
GRASS61 in /usr/local/grass-6.1.cvs and GDAL in /usr/local.

I enter the GRASS format dir in GDAL:

[trawiarz@quercus src]$ cd gdal/frmts/grass/pkg

Configure like the README ther says:

[trawiarz@quercus pkg]$ 
./configure --with-gdal=/usr/local/bin/gdal-config --with-grass=/usr/local/grass-6.1.cvs
checking for gcc... gcc
checking for C compiler default output file name... a.out
checking whether the C compiler works... yes
checking whether we are cross compiling... no
checking for suffix of executables...
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether gcc accepts -g... yes
checking for gcc option to accept ANSI C... none needed
checking for g++... g++
checking whether we are using the GNU C++ compiler... yes
checking whether g++ accepts -g... yes
checking for ranlib... ranlib
checking for g++ -shared ... yes
user supplied gdal-config (/usr/local/bin/gdal-config)
using /usr/local/lib as GDAL shared library autoload directory
checking for G_asprintf in -lgrass_gis... yes
configure: creating ./config.status
config.status: creating Makefile

Commit make:

[trawiarz@quercus pkg]$ make
make: *** No rule to make target `grass57dataset.o', needed by 
`gdal_GRASS.so'.  Stop.

Where's my error?

Maciek 


From coutm at yahoo.fr  Sun Jul 17 08:39:20 2005
From: coutm at yahoo.fr (cout m)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] is that ecw format is really supported?
Message-ID: <20050717123920.58998.qmail@web26705.mail.ukl.yahoo.com>

hi list,

I would like to know if the ecw format is really
supported by gdal. Because i'm trying to make ?
tileindex with gdaltindex and finally  I obtain  a
.shp, a .dbf and a .shx without data.
 
I write : "gdaltindex ./index1.shp ./raster/*.ecw" in
debian Konsol

But, when i made a tileindex with GTiff, it run fine.

have you got an idea about this problem?

Marie Coutard


	

	
		
___________________________________________________________________________ 
Appel audio GRATUIT partout dans le monde avec le nouveau Yahoo! Messenger 
T?l?chargez cette version sur http://fr.messenger.yahoo.com

From bartvde at xs4all.nl  Sun Jul 17 09:46:04 2005
From: bartvde at xs4all.nl (Bart van den Eijnden)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] is that ecw format is really supported?
In-Reply-To: <20050717123920.58998.qmail@web26705.mail.ukl.yahoo.com>
References: <20050717123920.58998.qmail@web26705.mail.ukl.yahoo.com>
Message-ID: <op.st18i2bqmjfraz@bart.lan>

Tileindexes are always shapefiles, and they only contain references to  
data (in the LOCATION field of the dbf), not the actual data.

Did you compile GDAL against the ECW SDK? Otherwise it can't read ECW  
files. Or which binary version are you using?

Best regards,
Bart

On Sun, 17 Jul 2005 14:39:20 +0200, cout m <coutm@yahoo.fr> wrote:

> hi list,
>
> I would like to know if the ecw format is really
> supported by gdal. Because i'm trying to make ?
> tileindex with gdaltindex and finally  I obtain  a
> .shp, a .dbf and a .shx without data.
> I write : "gdaltindex ./index1.shp ./raster/*.ecw" in
> debian Konsol
>
> But, when i made a tileindex with GTiff, it run fine.
>
> have you got an idea about this problem?
>
> Marie Coutard
>
>
> 	
>
> 	
> 		
> ___________________________________________________________________________
> Appel audio GRATUIT partout dans le monde avec le nouveau Yahoo!  
> Messenger
> T?l?chargez cette version sur http://fr.messenger.yahoo.com
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>



-- 
Using Opera's revolutionary e-mail client: http://www.opera.com/mail/

From coutm at yahoo.fr  Sun Jul 17 09:52:21 2005
From: coutm at yahoo.fr (cout m)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] is that ecw format is really supported?
Message-ID: <20050717135221.96390.qmail@web26710.mail.ukl.yahoo.com>

i compile gdal whit that args :
--with-ecw=/opt/ecwsdk-3.1.25Jan05-linux
I'm using gdal 1.2.6


	

	
		
___________________________________________________________________________ 
Appel audio GRATUIT partout dans le monde avec le nouveau Yahoo! Messenger 
T?l?chargez cette version sur http://fr.messenger.yahoo.com

From cplist at earthlink.net  Mon Jul 18 09:15:57 2005
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] problems compiling dods into gdal
Message-ID: <484568.1121692557828.JavaMail.root@wamui-ovcar.atl.sa.earthlink.net>

Thanks, Frank:

I registered the bug -- you're so darn fast I couldn't tell whether or not you took care of the INC issue.  But I included it there, nevertheless.

Many, many thanks!

Charlton

-----Original Message-----
From: Frank Warmerdam <fwarmerdam@gmail.com>
Sent: Jul 15, 2005 1:20 PM
To: Charlton Purvis <cplist@earthlink.net>
Cc: gdal-dev <gdal-dev@xserve.flids.com>
Subject: Re: [Gdal-dev] problems compiling dods into gdal

On 7/15/05, Charlton Purvis <cplist@earthlink.net> wrote:
> Hi, all:
> 
> I am running into problems when I try building OPeNDAP into gdal.  I was originally trying to follow a MapServer wiki post (http://mapserver.gis.umn.edu/cgi-bin/wiki.pl?DODS_Build), but that was a bit dated, so I thought I'd get the latest and greatest of both worlds.
> 
> I believe I successfully covered my bases w/ the prerequisite libcurl and libxml.
> 
> I downloaded libdap-3.5.1.tar.gz from UCAR and followed a:
>   * ./configure --prefix=/usr/local/dods/3.5.1
>   * make
>   * make install
>   * ldconfig
> 
> That all went fine.
> 
> I downloaded gdal-1.2.6.tar.gz from gdal.org and followed a:
>   * ./configure --with-dods-root=/usr/local/dods/3.5.1 --without-python
>   * The configure works fine and shows that DODS support will be 'yes'.
>   * make
>   * Make has problems when it gets to the dods stuff.  It can't find .h's, and it looks like the INC gets set incorrectly.  It should be looking in /usr/local/dods/3.5.1/include/dap rather than what I see on the @INC output which is /usr/local/dods/3.5.1/include.

Charlton, 

I have committed changes to GDAL in CVS to put both dods_root/include
and dods_root/include/dap into the include path.  I think pushing
stuff down into
a dap subdirectory must be a new convention. 
 
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp:50:19: debug.h: No such file or directory
> [followed by more errors]
> 
> So I thought that it was only a matter of an @INC path.  Since I had nothing to lose I tried both adding the correct path to the INC of the ./configure, and then I also tried copying the *.h's into what gdal wanted for the heck of it.  Neither worked well since I ran into cpp errors which I know zilch about.
> 
> (after copying the *.h's to where gdal could find them)
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp: In constructor `DODSDataset::DODSDataset()':
> dodsdataset2.cpp:300: error: no matching function for call to `DDS::DDS()'
> /usr/local/dods/3.5.1/include/DDS.h:254: error: candidates are: DDS::DDS(const
>    DDS&)

This may be a bit harder.  I'll try and prepare a dap 3.5.1 build and see
what I can figure out. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From neteler at itc.it  Mon Jul 18 09:20:27 2005
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] cannot build grass plugin in gdal - still
In-Reply-To: <032b01c5896b$185c5f20$afe41d3e@eustahiush>
References: <032b01c5896b$185c5f20$afe41d3e@eustahiush>
Message-ID: <20050718132027.GT10709@thuille.itc.it>

On Fri, Jul 15, 2005 at 08:28:38PM +0200, Maciek Sieczka wrote:
> Hi
> 
> Still I can't build the gdal-grass plugin in gdal. I'm following what the 
> README says - and nothing.
> 
> I have GDAL and GRASS61 (both fresh cvs) installed properly in their 
> standard locations.
> GRASS61 in /usr/local/grass-6.1.cvs and GDAL in /usr/local.
> 
> I enter the GRASS format dir in GDAL:
> 
> [trawiarz@quercus src]$ cd gdal/frmts/grass/pkg
> 
> Configure like the README ther says:
> 
> [trawiarz@quercus pkg]$ 
> ./configure --with-gdal=/usr/local/bin/gdal-config 
> --with-grass=/usr/local/grass-6.1.cvs
> checking for gcc... gcc
> checking for C compiler default output file name... a.out
> checking whether the C compiler works... yes
> checking whether we are cross compiling... no
> checking for suffix of executables...
> checking for suffix of object files... o
> checking whether we are using the GNU C compiler... yes
> checking whether gcc accepts -g... yes
> checking for gcc option to accept ANSI C... none needed
> checking for g++... g++
> checking whether we are using the GNU C++ compiler... yes
> checking whether g++ accepts -g... yes
> checking for ranlib... ranlib
> checking for g++ -shared ... yes
> user supplied gdal-config (/usr/local/bin/gdal-config)
> using /usr/local/lib as GDAL shared library autoload directory
> checking for G_asprintf in -lgrass_gis... yes
> configure: creating ./config.status
> config.status: creating Makefile
> 
> Commit make:
> 
> [trawiarz@quercus pkg]$ make
> make: *** No rule to make target `grass57dataset.o', needed by 
> `gdal_GRASS.so'.  Stop.
> 
> Where's my error?

What I do (maybe not ideal, but works):
You have to link the C files from ../ into the current directory:

 ln -sf ../*.cpp .
 make
 make install

Markus


From chodgson at refractions.net  Mon Jul 18 14:03:04 2005
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Trouble with ECW support
Message-ID: <42DBEED8.5050308@refractions.net>

I'm trying to get gdal working with the ERMapper ECW library. I managed 
to determine that their latest version, 3.2beta is not yet supported, so 
I switched to trying with 3.1. I was able to get the ecw library to 
compile without any particular hacks or tricks... however, in order to 
get the types to be included properly when I was compiling gdal with ecw 
support, I had to put

#define POSIX
#define LINUX

at the top of Source/include/NCSTypes.h in the ECW librray source. 
Otherwise, it when I was compiling gdal, it complained about missing 
types. I think this was the right thing to do? Anyways, it all compiles 
afterwards.

Then I compress several geotiffs into ECW using something like:

gdal_translate -of ECW -co 'TARGET=10' input.tif output.ecw

then I build a tile index of them using something like:

gdaltindex tiles *.ecw

then I use it in mapserver using something like:

   LAYER
     DEBUG ON
     NAME "ortho_collage"
     TYPE RASTER
     STATUS ON
     TILEINDEX "tiles.shp"
     TILEITEM "Location"
     PROJECTION
       "init=epsg:42102"
     END
     MAXSCALE 75000
   END

And all I can get is the standard error:

msDrawMap(): Failed to draw layer named 'ortho_collage'

gdalinfo gives the following:

Driver: ECW/ERMapper Compressed Wavelets
Size is 14610, 11308
Coordinate System is `'
Origin = (1057790.000000,515281.000000)
Pixel Size = (0.50000000,-0.50000000)
Corner Coordinates:
Upper Left  ( 1057790.000,  515281.000)
Lower Left  ( 1057790.000,  509627.000)
Upper Right ( 1065095.000,  515281.000)
Lower Right ( 1065095.000,  509627.000)
Center      ( 1061442.500,  512454.000)
Band 1 Block=14610x1 Type=Byte, ColorInterp=Gray
   Overviews: arbitrary

That's with gdal 1.2.6 - if I try with a recent cvs snapsot, I get the 
coordinate info from the .aux.xml file that gets created.

However, if I download one of the ecw files to my local computer and try 
to view it using ER Viewer, it refuses to show anything - just black, 
and it gives an error and nearly crashes if I try to zoom in.

So, it seems like just plain corrupt ECW are being created. Assuming 
this should work, I may have defined the wrong system type in the types 
header file (POSIX/LINUX) - how can I get this to work otherwise?

My system is an AMD 64-bit, which I suppose is helping to complicate 
things:
Linux dragonfly 2.6.5-1.358 #1 Sat May 8 09:01:26 EDT 2004 x86_64 x86_64 
x86_64 GNU/Linux

And I'm using a newly downloaded gcc 3.4.2:
Reading specs from /usr/lib/gcc/x86_64-redhat-linux/3.4.2/specs
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man 
--infodir=/usr/share/info --enable-shared --enable-threads=posix 
--disable-checking --with-system-zlib --enable-__cxa_atexit 
--disable-libunwind-exceptions --enable-languages=c,c++,objc,java,f77 
--enable-java-awt=gtk --host=x86_64-redhat-linux
Thread model: posix
gcc version 3.4.2 20041017 (Red Hat 3.4.2-6.fc3)

And I'm running fedora core 2.

Anybody have a clue for me?

Thanks in advance.

Chris

From cplist at earthlink.net  Mon Jul 18 14:50:25 2005
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] problems compiling dods into gdal
Message-ID: <7343003.1121712625745.JavaMail.root@wamui-polski.atl.sa.earthlink.net>

Thanks, Frank.  Everything works like a charm.  I really appreciate your help and quick fix.

Charlton

-----Original Message-----
From: Charlton Purvis <cplist@earthlink.net>
Sent: Jul 18, 2005 9:15 AM
To: warmerdam@pobox.com
Cc: gdal-dev <gdal-dev@xserve.flids.com>
Subject: Re: [Gdal-dev] problems compiling dods into gdal

Thanks, Frank:

I registered the bug -- you're so darn fast I couldn't tell whether or not you took care of the INC issue.  But I included it there, nevertheless.

Many, many thanks!

Charlton

-----Original Message-----
From: Frank Warmerdam <fwarmerdam@gmail.com>
Sent: Jul 15, 2005 1:20 PM
To: Charlton Purvis <cplist@earthlink.net>
Cc: gdal-dev <gdal-dev@xserve.flids.com>
Subject: Re: [Gdal-dev] problems compiling dods into gdal

On 7/15/05, Charlton Purvis <cplist@earthlink.net> wrote:
> Hi, all:
> 
> I am running into problems when I try building OPeNDAP into gdal.  I was originally trying to follow a MapServer wiki post (http://mapserver.gis.umn.edu/cgi-bin/wiki.pl?DODS_Build), but that was a bit dated, so I thought I'd get the latest and greatest of both worlds.
> 
> I believe I successfully covered my bases w/ the prerequisite libcurl and libxml.
> 
> I downloaded libdap-3.5.1.tar.gz from UCAR and followed a:
>   * ./configure --prefix=/usr/local/dods/3.5.1
>   * make
>   * make install
>   * ldconfig
> 
> That all went fine.
> 
> I downloaded gdal-1.2.6.tar.gz from gdal.org and followed a:
>   * ./configure --with-dods-root=/usr/local/dods/3.5.1 --without-python
>   * The configure works fine and shows that DODS support will be 'yes'.
>   * make
>   * Make has problems when it gets to the dods stuff.  It can't find .h's, and it looks like the INC gets set incorrectly.  It should be looking in /usr/local/dods/3.5.1/include/dap rather than what I see on the @INC output which is /usr/local/dods/3.5.1/include.

Charlton, 

I have committed changes to GDAL in CVS to put both dods_root/include
and dods_root/include/dap into the include path.  I think pushing
stuff down into
a dap subdirectory must be a new convention. 
 
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp:50:19: debug.h: No such file or directory
> [followed by more errors]
> 
> So I thought that it was only a matter of an @INC path.  Since I had nothing to lose I tried both adding the correct path to the INC of the ./configure, and then I also tried copying the *.h's into what gdal wanted for the heck of it.  Neither worked well since I ran into cpp errors which I know zilch about.
> 
> (after copying the *.h's to where gdal could find them)
> make -C dods install-obj
> make[2]: Entering directory `/usr/local/download/gdal-1.2.6/frmts/dods'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port  -I/usr/local/dods/3.5.1/include -c -o ../o/dodsdataset2.o dodsdataset2.cpp
>  g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts -I../../port -I/usr/local/dods/3.5.1/include -c dodsdataset2.cpp  -fPIC -DPIC -o ../o/.libs/dodsdataset2.o
> dodsdataset2.cpp: In constructor `DODSDataset::DODSDataset()':
> dodsdataset2.cpp:300: error: no matching function for call to `DDS::DDS()'
> /usr/local/dods/3.5.1/include/DDS.h:254: error: candidates are: DDS::DDS(const
>    DDS&)

This may be a bit harder.  I'll try and prepare a dap 3.5.1 build and see
what I can figure out. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Mon Jul 18 16:12:36 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] is that ecw format is really supported?
In-Reply-To: <20050717135221.96390.qmail@web26710.mail.ukl.yahoo.com>
References: <20050717135221.96390.qmail@web26710.mail.ukl.yahoo.com>
Message-ID: <931f8ea90507181312514cf40b@mail.gmail.com>

On 7/17/05, cout m <coutm@yahoo.fr> wrote:
> i compile gdal whit that args :
> --with-ecw=/opt/ecwsdk-3.1.25Jan05-linux
> I'm using gdal 1.2.6

Hi, 

Does "gdalinfo --format ecw" report information about the ECW
driver?  If so, you have ECW support built in. 

There are many complexities to ECW support though.  The Jan05
tree is pretty out of date now and might not be prudent to use.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From werchowyna at epf.pl  Mon Jul 18 17:05:55 2005
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] cannot build grass plugin in gdal - still
References: <032b01c5896b$185c5f20$afe41d3e@eustahiush>
	<20050718132027.GT10709@thuille.itc.it>
Message-ID: <010c01c58bdc$af0036e0$53d21d3e@eustahiush>

From: "Markus Neteler" <neteler@itc.it>

> On Fri, Jul 15, 2005 at 08:28:38PM +0200, Maciek Sieczka wrote:
>> Hi
>>
>> Still I can't build the gdal-grass plugin in gdal. I'm following what the
>> README says - and nothing.

<snip>

>> [trawiarz@quercus pkg]$ make
>> make: *** No rule to make target `grass57dataset.o', needed by
>> `gdal_GRASS.so'.  Stop.
>>
>> Where's my error?

> What I do (maybe not ideal, but works):
> You have to link the C files from ../ into the current directory:
>
> ln -sf ../*.cpp .
> make
> make install

Will try this, thanks Markus.

Does it have to be like this Frank? This makes an average amateur like me 
not able to build gdal-grass...

Maciek


From kruland at ku.edu  Mon Jul 18 22:17:07 2005
From: kruland at ku.edu (Kevin Ruland)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Next Generation SWIG - Ruby
In-Reply-To: <42C02694.70505@interserv.com>
References: <42C02694.70505@interserv.com>
Message-ID: <42DC62A3.6010407@ku.edu>


Charles,

Has nobody contacted you yet?  I just recently touched up the NG python
bindings and they are mostly working -- I have one unexplained test case.

Pull gdal from cvs and you will find the ng bindings in pymod/ng.  There
is a very rudimentary readme describing the different typemaps used. 
But the most effective way would be to start with the typemaps_python.i
file and cut out all the python junk and replace with ruby junk.

Good luck and please report if you need help or have any success.

Kevin Ruland

Charles F. I. Savage wrote:

> I came across an interview from April where a "next generation" swig
> binding approach for gdal was mentioned (see
> http://community.qgis.org/index.php?option=com_content&task=view&id=58&Itemid=2).
>
>
> I was wondering how much progress has been made on this?  I'd be
> interested in using SWIG to develop Ruby bindings for GDAL/OGR.
>
> Thanks for the help,
>
> Charlie
>
>------------------------------------------------------------------------
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev
>  
>


From BEN at Syncera-ITSolutions.NL  Tue Jul 19 07:04:25 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] feature count of 0 in Mapinfo TAB file
Message-ID: <s2dcfa69.008@syncera.nl>

Hi list,

I have a Mapinfo point file which displays well in Mapinfo, but OGR reports a feature count of 0. As a consequence it does not show in Mapserver.

Does anybody have an idea what could be the problem? What could I check?

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl


From BEN at Syncera-ITSolutions.NL  Tue Jul 19 07:15:56 2005
From: BEN at Syncera-ITSolutions.NL (Bart van den Eijnden)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Re: feature count of 0 in Mapinfo TAB file
Message-ID: <s2dcfd19.032@syncera.nl>

Sorry found the problem already. There is a geometry for the features but no attributes, i.e. the DBF file is empty (the DBF table which is coupled in the TAB file).

Btw FME also reports 0 features in this case.

Best regards,
Bart

Bart van den Eijnden
Syncera IT Solutions
Postbus 270
2600 AG  DELFT

tel.nr.: 015-7512436
email: BEN@Syncera-ITSolutions.nl
-------------- next part --------------
An embedded message was scrubbed...
From: "Bart van den Eijnden" <BEN@Syncera-ITSolutions.NL>
Subject: feature count of 0 in Mapinfo TAB file
Date: Tue, 19 Jul 2005 13:04:25 +0200
Size: 728
Url: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050719/e1a4e4fd/attachment.mht
From fx.prunayre at oieau.fr  Tue Jul 19 08:51:33 2005
From: fx.prunayre at oieau.fr (=?iso-8859-1?Q?Fran=E7ois_Prunayre?=)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RVB JPEG
Message-ID: <200507191304.j6JD41NM007043@ns1.oieau.fr>

Hi list, 
When using gdal_translate to convert GeoTIFF to JPEG, I get Greyscale JPEG.
How to get RVB JPEG instead ?
 
gdal_translate -of JPEG -co WORLDFILE=ON tmp/F056606.TIF tmp/F056606.JPG

 
 Thanks for your help. 
Francois

 

-- 
Ce message a ete verifie par MailScanner pour des virus ou des polluriels et rien de suspect n'a ete trouve.

Les donnees et renseignements contenus dans ce message sont personnels, confidentiels et prives. Toute publication, utilisation ou diffusion, meme partielle, doit etre autorisee.

Any data and information contained in this electronic mail is personal, confidential and secret. Any total or partial publication, use or distribution must be authorized.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050719/a1adb14d/attachment.html
From fwarmerdam at gmail.com  Tue Jul 19 09:18:38 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RVB JPEG
In-Reply-To: <200507191304.j6JD41NM007043@ns1.oieau.fr>
References: <200507191304.j6JD41NM007043@ns1.oieau.fr>
Message-ID: <931f8ea9050719061878584f86@mail.gmail.com>

On 7/19/05, Fran?ois Prunayre <fx.prunayre@oieau.fr> wrote:
>  
> Hi list, 
> When using gdal_translate to convert GeoTIFF to JPEG, I get Greyscale JPEG.
> How to get RVB JPEG instead ? 
>   
> gdal_translate -of JPEG -co WORLDFILE=ON tmp/F056606.TIF tmp/F056606.JPG

Fran?ois,

Is the input TIFF file a greyscale single band image?   If so, they
a greyscale output would seem appropriate. 

If the input TIFF file is pseudocolored, then you would need to first
convert it to RGB format and then encode that to JPEG. 

eg. 

pct2rgb.py tmp/F056606.TIF tmp/very_temporary.tif
gdal_translate -of JPEG -co WORLDFILE=ON \
  tmp/very_temporary.tif  tmp/F056606.JPG
rm tmp/very_temporary.tif

If this doesn't cover your situation, perhaps you could provide a
gdalinfo report on the input file. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fx.prunayre at oieau.fr  Tue Jul 19 10:00:35 2005
From: fx.prunayre at oieau.fr (=?iso-8859-1?Q?Fran=E7ois_Prunayre?=)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RVB JPEG
In-Reply-To: <931f8ea9050719061878584f86@mail.gmail.com>
Message-ID: <200507191413.j6JED2NM012678@ns1.oieau.fr>

TIFF file is pseudocolored in my case. Your exemple works fine for me. 

Thanks a lot.
Francois


echo -- Reprojection en WGS84
gdalwarp -s_srs '+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742
+x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515
+towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs' -t_srs
'+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs' $1 ./tmp/$2.TIF

echo -- Conversion Pseudocolor vers RGB
pct2rgb.py tmp/$2.TIF tmp/dummy.TIF

echo -- Conversion en JPEG
gdal_translate -of JPEG -co WORLDFILE=ON tmp/dummy.TIF tmp/$2.JPG

echo -- Suppression fichier temporaire
rm -f tmp/dummy.TIF
rm -f tmp/$2.TIF

echo -- Renomme fichier de georeferencement
mv tmp/$2.wld tmp/$2.jgw 

-----Message d'origine-----
De : Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Envoy? : mardi 19 juillet 2005 15:19
? : Fran?ois Prunayre
Cc : gdal-dev@xserve.flids.com
Objet : Re: [Gdal-dev] RVB JPEG

On 7/19/05, Fran?ois Prunayre <fx.prunayre@oieau.fr> wrote:
>  
> Hi list,
> When using gdal_translate to convert GeoTIFF to JPEG, I get Greyscale
JPEG.
> How to get RVB JPEG instead ? 
>   
> gdal_translate -of JPEG -co WORLDFILE=ON tmp/F056606.TIF 
> tmp/F056606.JPG

Fran?ois,

Is the input TIFF file a greyscale single band image?   If so, they
a greyscale output would seem appropriate. 

If the input TIFF file is pseudocolored, then you would need to first
convert it to RGB format and then encode that to JPEG. 

eg. 

pct2rgb.py tmp/F056606.TIF tmp/very_temporary.tif gdal_translate -of JPEG
-co WORLDFILE=ON \
  tmp/very_temporary.tif  tmp/F056606.JPG rm tmp/very_temporary.tif

If this doesn't cover your situation, perhaps you could provide a gdalinfo
report on the input file. 

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

--
Ce message a ete verifie par MailScanner pour des virus ou des polluriels et
rien de suspect n'a ete trouve.

Les donnees et renseignements contenus dans ce message sont personnels,
confidentiels et prives. Toute publication, utilisation ou diffusion, meme
partielle, doit etre autorisee.

Any data and information contained in this electronic mail is personal,
confidential and secret. Any total or partial publication, use or
distribution must be authorized.


-- 
Ce message a ete verifie par MailScanner pour des virus ou des polluriels et rien de suspect n'a ete trouve.

Les donnees et renseignements contenus dans ce message sont personnels, confidentiels et prives. Toute publication, utilisation ou diffusion, meme partielle, doit etre autorisee.

Any data and information contained in this electronic mail is personal, confidential and secret. Any total or partial publication, use or distribution must be authorized.


From Donald.W.Johnson at mvk02.usace.army.mil  Tue Jul 19 12:29:20 2005
From: Donald.W.Johnson at mvk02.usace.army.mil (Johnson,
	Donald W MVK Contractor)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] IO Problems on the Edge of Rasters
Message-ID: <67E7BC077964564C89D20FE0EDA30BE50C5667@MVK-ML01VIC.mvk.ds.usace.army.mil>

 IM working on program which uses very large raster which can not be fully
loaded into memory. Instead chunks of the raster a loaded from and stored to
disk as nessessary. The entire process is hidden by an abstraction class so
that the program logic is identical to working with a large 2D array. This
appeared to work correctly but is failling on the far right hand side of
rasters. For example if the raster is 160 rows and 212 columns and is loaded
in 100x100 blocks, does not correctly right the last 12 columns to disk,
however it returns no error.

Here is a simple test case.

/////////////////////////////////////////////////////////////////////////////
///////////////////

#include "VirtualMatrixGDAL.h"
#include <fstream>
#include <string>

using namespace std;

#include "boost/test/minimal.hpp"

template <class T> void fill_matrix(T& m)
{
	for( unsigned long i = 0; i < m.rows(); ++i )
	{
		long tmp = i * m.cols();
		
		for( unsigned long j = 0; j < m.cols(); ++j )
		{
			m[i][j] = tmp + j;
		}
	}	
}

template <class Stream, class Matrix> void print_matrix(Stream& s,Matrix& m)
{
	for( unsigned long i = 0; i < m.rows(); ++i )
	{	
		for( unsigned long j = 0; j < m.cols(); ++j )
		{
			s << m[i][j] << '\t';

			if ( m[i][j] < 1000 )
			{
				s << '\t';
			}
		}

		s << '\n';
	}	
}

int test_main(int argc, char **argv)
{
	std::ofstream output("results.txt");
	
	virtual_matrix_gdal<long> test_matrix;

	test_matrix.init("test.tif",GDT_Int32,16,24,10,10);

	test_matrix.set_max_memory(5,"MB");

	fill_matrix(test_matrix);
	print_matrix(output,test_matrix);

	test_matrix.store_all_and_release_mem();
	output << '\n';

	print_matrix(output,test_matrix);

	return 0;
}

/////////////////////////////////////////////////////////////////////////////
/////////////////////////

Calls to [][] become calls to data(unsigned long row, unsigned column);

/////////////////////////////////////////////////////////////////////////////
/////////////////////////

template < class T > T& virtual_matrix<T>::data(unsigned long r,unsigned long
c)
{
	unsigned long cr;
	unsigned long cc;
	
	// check for valid coordinates
	if ( !coordinates_valid(r,c) )
	{
		throw coordinate_range_error(r,c,num_rows,num_cols);
	}

	// get the coordinates of the correct cell
	cr = get_cell_row(r);
	cc = get_cell_col(c);
	
	virtual_matrix_cell<T>* target_cell = &cell(cr,cc);

	// load the cell if not active
	if ( target_cell->state() != cell_active )
	{
		load_cell(cr,cc);
	}



	target_cell->dirty(true);

	// get the internal row and column for the cell
	r -= (cell_rows * cr);
	c -= (cell_cols * cc);

	// remove a refrence if over max count
	if ( recent_reference.full() )
	{
		recent_reference.front()->remove_ref();
		recent_reference.pop_front();
	}

	//update the refernce counts
	
	target_cell->add_ref();
	//reference_count[cp] += 1;
	recent_reference.push_back(target_cell);

	return (*target_cell)(r,c); 
}

/////////////////////////////////////////////////////////////////////////////
/////////////////////////

The store_all_and_release_mem simply calls the base class store_all (
store_all was overridden to keep allocated memory when storing )

/////////////////////////////////////////////////////////////////////////////
/////////////////////////

template < class T > void virtual_matrix_gdal<T>::store_all_and_release_mem()
{ super_type::store_all(); }

template < class T > void virtual_matrix<T>::store_all()
{
	for( unsigned long i = 0; i < cell.rows(); ++i )
	{
		for( unsigned long j = 0; j < cell.columns(); ++j )
		{
			if ( cell(i,j).state() == cell_active )
			{
				store_cell(i,j);
			}
			else if ( cell(i,j).state() == cell_null )
			{
				load_cell(i,j);
				store_cell(i,j);
			}
		}
	}
}

template < class T > void virtual_matrix<T>::store_cell(unsigned long r,
unsigned long c)
{
	if ( r < num_cell_rows && c < num_cell_cols )
	{
		cell(r,c).state( cell_disk);
		cell(r,c).dirty( false);

		write_cell_to_file(r,c);

		cell(r,c).resize(0,0);

		current_memory_allocation -= cell_memory_requirements(r,c);
	}
}

template < class T > void virtual_matrix<T>::load_cell(unsigned long r,
unsigned long c)
{
	virtual_matrix_cell<T>& target_cell = cell(r,c);
	
	if ( memory_avalable(r,c) )
	{		
		if ( target_cell.state() == cell_null )
		{
			target_cell.resize(cell_rows,cell_cols);
			std::fill_n( target_cell.data(), target_cell.size(),
default_val );
		}
		else if ( cell(r,c).state() == cell_disk )
		{
			target_cell.resize(cell_rows,cell_cols);
			load_cell_from_file(r,c);
		}

		current_memory_allocation += cell_memory_requirements(r,c);
	}
	else
	{
		
		// find the cell with the least recent accesses
		find_least_used_cell();

		virtual_matrix_cell<T>& swap_cell = cell(t_row,t_col);

		// write the choosen cell back to disk
		if ( swap_cell.dirty() )
		{
			write_cell_to_file(t_row,t_col);
		}

		// swap the target cell with the cell to be loaded
		target_cell.swap( swap_cell );

		// mark the swaped file as being on disk
		swap_cell.state(cell_disk);

		// load the new cell
		if ( target_cell.state() == cell_null )
		{
			std::fill_n( target_cell.data(), target_cell.size(),
default_val );
		}
		else if ( target_cell.state() == cell_disk )
		{
			load_cell_from_file(r,c);	
		}
	}

	target_cell.state( cell_active );
	target_cell.dirty(false);
}

/////////////////////////////////////////////////////////////////////////////
///////////////////////

The only function call that uses gdal in this are the calls to
write_cell_to_file and load_cell_from file.
Here is ther implementation and where I assume the error is. 

/////////////////////////////////////////////////////////////////////////////
///////////////////////

template <class T> void virtual_matrix_gdal<T>::load_cell_from_file(unsigned
long r, unsigned long c)
{
	GDALRasterBand* pBand = storageBand;
	CPLErr err = CE_None; 

	int r_offset = r * cell_rows;
	int c_offset = c * cell_cols;

	int x_size = pBand->GetXSize();
	int y_size = pBand->GetYSize();
	int read_rows = ( r_offset + cell_rows <= y_size ) ? cell_rows :
y_size - r_offset;
	int read_cols = ( c_offset + cell_cols <= x_size ) ? cell_cols :
x_size - c_offset;

	T* buffer =  cell(r,c).data();
	err =
pBand->RasterIO(GF_Read,c_offset,r_offset,read_cols,read_rows,buffer,read_col
s,read_rows,data_type,0,0);
}

template <class T> void virtual_matrix_gdal<T>::write_cell_to_file(unsigned
long r, unsigned long c)
{
	GDALRasterBand* pBand = storageBand;
	CPLErr err = CE_None;

	unsigned long r_offset = r * cell_rows;
	unsigned long c_offset = c * cell_cols;

	int x_size = pBand->GetXSize();
	int y_size = pBand->GetYSize();
	int write_rows = ( r_offset + cell_rows <= y_size ) ? cell_rows :
y_size - r_offset;
	int write_cols = ( c_offset + cell_cols <= x_size ) ? cell_cols :
x_size - c_offset;

	T* buffer =  cell(r,c).data();
	err =
pBand->RasterIO(GF_Write,c_offset,r_offset,write_cols,write_rows,buffer,write
_cols,write_rows,data_type,0,0);
}

/////////////////////////////////////////////////////////////////////////////
///////////////////////

The problem is I have step though these function when writing or reading the
cells that get corrupted and 
RasterIO() does't give any errors.

Does anyone see what im doing wrong. If someone wants the complete test
project ill gladly send the files, I didn't want to include the entire
implementation of virtual_matrix because it is a large file. This is on
Windows XP using Visual Studio 2003. The version of GDAL is 1.2.3

Thanks
 Donald J


From fwarmerdam at gmail.com  Tue Jul 19 13:44:07 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] IO Problems on the Edge of Rasters
In-Reply-To: <67E7BC077964564C89D20FE0EDA30BE50C5667@MVK-ML01VIC.mvk.ds.usace.army.mil>
References: <67E7BC077964564C89D20FE0EDA30BE50C5667@MVK-ML01VIC.mvk.ds.usace.army.mil>
Message-ID: <931f8ea905071910445f792958@mail.gmail.com>

On 7/19/05, Johnson,  Donald W MVK Contractor
<Donald.W.Johnson@mvk02.usace.army.mil> wrote:
>  IM working on program which uses very large raster which can not be fully
> loaded into memory. Instead chunks of the raster a loaded from and stored to
> disk as nessessary. The entire process is hidden by an abstraction class so
> that the program logic is identical to working with a large 2D array. This
> appeared to work correctly but is failling on the far right hand side of
> rasters. For example if the raster is 160 rows and 212 columns and is loaded
> in 100x100 blocks, does not correctly right the last 12 columns to disk,
> however it returns no error.

Donald, 

I didn't dig through your code but one mistake sometimes encountered,
is that people try to use "windows" in RasterIO() that go off the file.
For instance if the last 100x100 "tile" is only partial, it is important that
you not specify a window that goes off the underyling GDAL file or it
will fail.   It should issue a proper error message of course. 

Any chance that this is what is happening? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Donald.W.Johnson at mvk02.usace.army.mil  Tue Jul 19 14:17:29 2005
From: Donald.W.Johnson at mvk02.usace.army.mil (Johnson,
	Donald W MVK Contractor)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RE: Gdal-dev Digest, Vol 14, Issue 9
Message-ID: <67E7BC077964564C89D20FE0EDA30BE50C5668@MVK-ML01VIC.mvk.ds.usace.army.mil>

I found the error. I need the to call raster io like this.

err =
pBand->RasterIO(GF_Write,c_offset,r_offset,write_cols,write_rows,buffer,write
_cols,write_rows,data_type,sizeof(T),cell_cols*sizeof(T));

Thanks
Donald J

From werchowyna at epf.pl  Tue Jul 19 16:53:29 2005
From: werchowyna at epf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] cannot build grass plugin in gdal - still
References: <032b01c5896b$185c5f20$afe41d3e@eustahiush><20050718132027.GT10709@thuille.itc.it>
	<010c01c58bdc$af0036e0$53d21d3e@eustahiush>
Message-ID: <037601c58ca3$eccfb3c0$c0e41d3e@eustahiush>

From: "Maciek Sieczka" <werchowyna@epf.pl>

> From: "Markus Neteler" <neteler@itc.it>
>
>> On Fri, Jul 15, 2005 at 08:28:38PM +0200, Maciek Sieczka wrote:
>>> Hi
>>>
>>> Still I can't build the gdal-grass plugin in gdal. I'm following what
>>> the
>>> README says - and nothing.
>
> <snip>
>
>>> [trawiarz@quercus pkg]$ make
>>> make: *** No rule to make target `grass57dataset.o', needed by
>>> `gdal_GRASS.so'.  Stop.
>>>
>>> Where's my error?
>
>> What I do (maybe not ideal, but works):
>> You have to link the C files from ../ into the current directory:
>>
>> ln -sf ../*.cpp .
>> make
>> make install
>
> Will try this, thanks Markus.
>
> Does it have to be like this Frank? This makes an average amateur like me
> not able to build gdal-grass...

Allright! Built and installed the plugin - for the very first time.

Yet the other problem was that after "make install" it didn't go to where
gdal expect plugins (/usr/local/lib/gdalplugins) but to standard
/usr/local/lib. Sure, I moved it manually, but I would be badly puzzled if I
didn't remember the issue discussed on the list before.

Frank, could that also be addressed, so that if a gdal-grass plugin is built
the default destination for "make install" would be
/usr/local/lib/gdalplugins like it should?

Maciek


From neteler at itc.it  Tue Jul 19 17:52:10 2005
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] cannot build grass plugin in gdal - still
In-Reply-To: <037601c58ca3$eccfb3c0$c0e41d3e@eustahiush>
References: <010c01c58bdc$af0036e0$53d21d3e@eustahiush>
	<037601c58ca3$eccfb3c0$c0e41d3e@eustahiush>
Message-ID: <20050719215210.GA3538@thuille.itc.it>

On Tue, Jul 19, 2005 at 10:53:29PM +0200, Maciek Sieczka wrote:
> From: "Maciek Sieczka" <werchowyna@epf.pl>
> 
> >From: "Markus Neteler" <neteler@itc.it>
> >
> >>On Fri, Jul 15, 2005 at 08:28:38PM +0200, Maciek Sieczka wrote:
> >>>Hi
> >>>
> >>>Still I can't build the gdal-grass plugin in gdal. I'm following what
> >>>the
> >>>README says - and nothing.
> >
> ><snip>
> >
> >>>[trawiarz@quercus pkg]$ make
> >>>make: *** No rule to make target `grass57dataset.o', needed by
> >>>`gdal_GRASS.so'.  Stop.
> >>>
> >>>Where's my error?
> >
> >>What I do (maybe not ideal, but works):
> >>You have to link the C files from ../ into the current directory:
> >>
> >>ln -sf ../*.cpp .
> >>make
> >>make install
> >
> >Will try this, thanks Markus.
> >
> >Does it have to be like this Frank? This makes an average amateur like me
> >not able to build gdal-grass...
> 
> Allright! Built and installed the plugin - for the very first time.
> 
> Yet the other problem was that after "make install" it didn't go to where
> gdal expect plugins (/usr/local/lib/gdalplugins) but to standard
> /usr/local/lib. Sure, I moved it manually, but I would be badly puzzled if I
> didn't remember the issue discussed on the list before.

Yes, it was discussed (unfortunately google doesn't index the xflids server).

You can grab a script to do the job here:

 http://mpa.itc.it/markus/useful/index.html
 ->  conf_install_gdal_grass_plugin.sh


Cheers

 Markus 

From fwarmerdam at gmail.com  Tue Jul 19 22:34:21 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] OGR - Coordinate Dimension / PostGIS
Message-ID: <931f8ea9050719193428e5a170@mail.gmail.com>

Folks,

Tonight I have committed a wide variety of changes to OGR in 
an effort to make the OGRGeometry classes maintain a sense of the
coordinate dimension regardless of whether all the Z values are zero
or not.  This has been carried into the PostGIS and Shapefile drivers.

In general this is important because in PostGIS 1.0 geometries that
are pushed into a table (layer) must have the dimension matching
that of the table properly.  In the past, geometries with all zero "z"
values would be considered 2D and corresponding WKT generated
for them.   This does not work with PostGIS 1.0.

While doing this, I made a few improvements to PostGIS support for
1.0, including a fix for ExecuteSQL() results losing their geometries.

I have still not dealt with PostGIS schema support issues.

I would appreciate feedback if people suddenly run into problems
with OGR, and especially from folks trying to work with PostGIS 1.0. 

I would like to thank Safe Software for supporting this improvement to
OGR. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From cplist at earthlink.net  Wed Jul 20 10:27:17 2005
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] ogr2ogr -where options
In-Reply-To: <32838573.1121692557348.JavaMail.root@wamui-ovcar.atl.sa.earthlink.net>
Message-ID: <E1DvFXe-0000hK-00@pop-borzoi.atl.sa.earthlink.net>

Hi, group:

Maybe I'm pressing my luck by asking another question, but I'm *this* close
to have a cutthroat app.

With some patience, the help of this list, and the help of the DODS list, I
have a DODS box that does 2 things:  it serves as a gateway to a non-DODS
JGOFS server; and it accepts OGR queries.  It works just fine and dandy, but
I'm running into a translation snafoo, I think.

I want something like this to fly:

ogr2ogr -f "CSV" test 'DODS:http://localhost/cgi-bin/nph-dods/test2?Yday'
-where 'Yday >= 365.861111'
ERROR 1: Attempt to use STRING field `Yday' with numeric comparison `>='.

Well, the error message makes sense and says it all.  (Doing a simple 'Yday
= 356' works fine.)  But perhaps my gateway approach is muddying the waters
by making the Yday field a string when it is really a float.  Maybe
something I could do in the DODS or JGOFS or metadata arena, but my OGR
question is, what kind of options do we have in the -where clause?  The
directions say it's like an SQL statement.  Is there any chance some kind of
basic functionality is built into the where clause, like the ability to mask
Yday as a float or to use some sort of regex to get around it?

Many thanks!

Charlton


From fwarmerdam at gmail.com  Wed Jul 20 15:44:15 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Fast Polygon intersections
In-Reply-To: <48E4232189A41343B805843CE27B6EFF150BEC@COMAIL02.digitalglobe.com>
References: <48E4232189A41343B805843CE27B6EFF150BEC@COMAIL02.digitalglobe.com>
Message-ID: <931f8ea9050720124452063af2@mail.gmail.com>

On 7/20/05, Chris Padwick <cpadwick@digitalglobe.com> wrote:
>  
>  
> 
> Greetings, 
> 
>   
> 
> I have a collection of 60 polygons and I'm using OGR to compare each polygon
> to every other polygon and test whether one is inside the other.  I'm using
> the OGRGeometry::Within() method to test them.  I've noticed that this test
> is really slow, taking many seconds to compare one polygon against 59 other
> polygons.  Is there another method I might use to speed up this test or
> another approach I could take all together? 

Chris,

You might want to try doing an extents comparison before doing the hard
test.   

But internally each request will convert the two geometries into GEOS
geometries, and then do the GEOS comparison operation.  You can likely
achieve much better performance by using GEOS directly, avoiding alot
of reconversion work at least.  You might also find that there are ways to
invoke GEOS that build and preserve the spatial index for a given polygon
over many comparisons.  I haven't tried this but for somewhat similar operations
I believe Safe Software has gotten big performance improvements. 

I would add that currently OGR converts to GEOS objects via WKT format, and
this may be a poor choice from a performance point of view.  I may well 
reimplement the conversion functions at some point. 

Even if you use GEOS directly, if you are reading your polygons with OGR
you may still find it helpful to OGRGeometry::exportToGEOS() method (with
the above caveats). 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Wed Jul 20 21:39:57 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] GDAL Mailing List Migration
Message-ID: <931f8ea905072018394bf30f7c@mail.gmail.com>

Folks,

The old GDAL mailing list host, xserve.flids.com (sometimes 
known as remotesensing.org) is being decommissioned soon and
isn't working properly so I have migrated the GDAL mailing list. 

While the new list has the same configuration and membership options
as the old list, it is at a new address.  I would appreciate everyone
updating their address books with the new information, and fixing
to the address when replying to old GDAL mailing list info.   

The new address is:

  gdal-dev@lists.maptools.org

The web interface is available at:

  http://lists.maptools.org/mailman/listinfo/gdal-dev

Sorry for the inconvenience.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From potts at cfl.rr.com  Thu Jul 21 07:16:11 2005
From: potts at cfl.rr.com (Garrett Potts)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] GDAL Mailing List Migration
In-Reply-To: <931f8ea905072018394bf30f7c@mail.gmail.com>
References: <931f8ea905072018394bf30f7c@mail.gmail.com>
Message-ID: <A5CD42B3-A8C1-4B28-A5ED-7B41166DE779@cfl.rr.com>

Hello Frank:


The www.remotesensing.org is up and running and will remain in tact.   
The xserver.flids.com domain will be decommissioned soon.


Take care

Garrett

On Jul 20, 2005, at 9:39 PM, Frank Warmerdam wrote:

> Folks,
>
> The old GDAL mailing list host, xserve.flids.com (sometimes
> known as remotesensing.org) is being decommissioned soon and
> isn't working properly so I have migrated the GDAL mailing list.
>
> While the new list has the same configuration and membership options
> as the old list, it is at a new address.  I would appreciate everyone
> updating their address books with the new information, and fixing
> to the address when replying to old GDAL mailing list info.
>
> The new address is:
>
>   gdal-dev@lists.maptools.org
>
> The web interface is available at:
>
>   http://lists.maptools.org/mailman/listinfo/gdal-dev
>
> Sorry for the inconvenience.
>
> Best regards,
> -- 
> --------------------------------------- 
> +--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,  
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for  
> Rent
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


From cgn at globexplorer.com  Thu Jul 21 15:05:21 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate versus mrsiddecode
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCE85@loki.wc.globexplorer.net>

Just checked out the latest/greatest CVS snapshot, as well as the same for MrSid DSDK, and not sure why, but mrsiddecode is *_way_* faster for some simple cases; I'm just trying to make thumbnails of some monster images we have sitting around, and doing some simple non-geographic extracts.

Something like:

gdal_translate -of jpeg -outsize 500 500 /data/f04/contentapu1/apu01_2ft_aus_2.sid /tmp/foo.jpg

Input file size is 188933, 47333

goes out to lunch for several minutes. mrsiddecode does the equivalent in under a second. 

Am I doing something wrong?

thanks in advance!
Chris


From cgn at globexplorer.com  Thu Jul 21 15:07:07 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RE: gdal_translate versus mrsiddecode
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCE86@loki.wc.globexplorer.net>

One more tidbit...
--------------------------------------------------------------------
pogo-> mrsidinfo /data/f04/contentapu1/apu01_2ft_aus_2.sid
mrsidinfo: (c) 2004 LizardTech, Inc. All rights reserved.

basic image info:
  format:            MRSID
  width:             188933
  height:            47333
  nband:             3
  color space:       RGB
  datatype:          uint8
  precision:         8
  dyn range min:     (natural)
  dyn range max:     (natural)
  background color:  (0, 0, 0)
  nodata color:      (255, 255, 255)
  metadata records:  20

geo coordinate info:
  X UL:              2.9673e+06
  Y UL:              1.01493e+07
  X res:             1.5
  Y res:             -1.5
  X rot:             0
  Y rot:             0

geo points (pixel centers):
  upper left:        (2967300.750000, 10149299.250000)
  upper right:       (3250698.750000, 10149299.250000)
  lower left:        (2967300.750000, 10078301.250000)
  lower right:       (3250698.750000, 10078301.250000)
  center:            (3108999.750000, 10113800.250000)

MrSID image info:
  number of levels:  8
  is locked:         false
  file version:      1.0.1.

MrSID/MG2-specific image info:
  is dithered:       false

pogo->


-----Original Message-----
From:	Chris G. Nicholas
Sent:	Thu 7/21/2005 12:05 PM
To:	gdal-dev@lists.maptools.org
Cc:	
Subject:	gdal_translate versus mrsiddecode
Just checked out the latest/greatest CVS snapshot, as well as the same for MrSid DSDK, and not sure why, but mrsiddecode is *_way_* faster for some simple cases; I'm just trying to make thumbnails of some monster images we have sitting around, and doing some simple non-geographic extracts.

Something like:

gdal_translate -of jpeg -outsize 500 500 /data/f04/contentapu1/apu01_2ft_aus_2.sid /tmp/foo.jpg

Input file size is 188933, 47333

goes out to lunch for several minutes. mrsiddecode does the equivalent in under a second. 

Am I doing something wrong?

thanks in advance!
Chris




From Ken.Boss at dnr.state.mn.us  Thu Jul 21 19:17:59 2005
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] failing to write geotiff
Message-ID: <s2dfe6eb.007@co5.dnr.state.mn.us>

Hello list--

I am working with gdal 1.2.6 with internal libtiff/geotiff on Solaris, and attempting to output geotiffs from gdal_merge.py, like:

gdal_merge.py -o /b4/keboss/tif_tiles_test/test/tester/ccw2004_tmp1.tif -v -of GTIFF -ps 1 1 -ul_lr 342707.5 5244447.5 345418.5 5242467.5 -n 0 /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw04009.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw05009.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw05010.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw04010.img

But I'm failing with a bunch of errors like:

TIFFWriteEncodedStrip:/b4/keboss/tif_tiles_test/test/tester/ccw2004_tmp1.tif: Must set "ImageWidth" before writing data

FWIW, I can output to other formats (eg., HFA) just fine.


Presumably for the same reason, gdal_translate is also unable to generate a usable geotiff:

gdal_translate ccw04009.img ccw04009.tif
Input file size is 2590, 1565
0...10...20...30...40...50...60...70...80...90...100 - done.
ERROR 4: `ccw04009.tif' not recognised as a supported file format.

ERROR 4: `ccw04009.tif' not recognised as a supported file format.

gdalinfo ccw04009.tif
ERROR 4: `ccw04009.tif' not recognised as a supported file format.

GDALOpen failed - 4
`ccw04009.tif' not recognised as a supported file format.


Any suggestions would be appreciated.

--Ken Boss
  MN DNR Forestry



From fwarmerdam at gmail.com  Fri Jul 22 09:35:07 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] failing to write geotiff
In-Reply-To: <s2dfe6eb.007@co5.dnr.state.mn.us>
References: <s2dfe6eb.007@co5.dnr.state.mn.us>
Message-ID: <931f8ea905072206354004ef3c@mail.gmail.com>

On 7/21/05, Ken Boss <Ken.Boss@dnr.state.mn.us> wrote:
> Hello list--
> 
> I am working with gdal 1.2.6 with internal libtiff/geotiff on Solaris, and attempting to output geotiffs from gdal_merge.py, like:
> 
> gdal_merge.py -o /b4/keboss/tif_tiles_test/test/tester/ccw2004_tmp1.tif -v -of GTIFF -ps 1 1 -ul_lr 342707.5 5244447.5 345418.5 5242467.5 -n 0 /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw04009.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw05009.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw05010.img /u/ortho/ccw/completed_blocks/ccw_block01/chips/ccw04010.img
> 
> But I'm failing with a bunch of errors like:
> 
> TIFFWriteEncodedStrip:/b4/keboss/tif_tiles_test/test/tester/ccw2004_tmp1.tif: Must set "ImageWidth" before writing data
> 
> FWIW, I can output to other formats (eg., HFA) just fine.
> 
> 
> Presumably for the same reason, gdal_translate is also unable to generate a usable geotiff:
> 
> gdal_translate ccw04009.img ccw04009.tif
> Input file size is 2590, 1565
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> ERROR 4: `ccw04009.tif' not recognised as a supported file format.
> 
> ERROR 4: `ccw04009.tif' not recognised as a supported file format.
> 
> gdalinfo ccw04009.tif
> ERROR 4: `ccw04009.tif' not recognised as a supported file format.
> 
> GDALOpen failed - 4
> `ccw04009.tif' not recognised as a supported file format.
> 
> 
> Any suggestions would be appreciated.

Ken,

I'm not sure what is going on here!  My suggestion would be
to verify you are using the internal version of libtiff and libgeotiff
in GDAL rather than the system version which may be somewhat
out of date.  You can configure to use internal versions with 
--with-libtiff=internal and --with-geotiff=internal. 

Best regards, 
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Fri Jul 22 10:13:02 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate versus mrsiddecode
In-Reply-To: <71E37EF6B7DCC1499CEA0316A2568328021FCE85@loki.wc.globexplorer.net>
References: <71E37EF6B7DCC1499CEA0316A2568328021FCE85@loki.wc.globexplorer.net>
Message-ID: <931f8ea905072207133c967ca0@mail.gmail.com>

On 7/21/05, Chris G. Nicholas <cgn@globexplorer.com> wrote:
> Just checked out the latest/greatest CVS snapshot, as well as the same for MrSid DSDK, and not sure why, but mrsiddecode is *_way_* faster for some simple cases; I'm just trying to make thumbnails of some monster images we have sitting around, and doing some simple non-geographic extracts.
> 
> Something like:
> 
> gdal_translate -of jpeg -outsize 500 500 /data/f04/contentapu1/apu01_2ft_aus_2.sid /tmp/foo.jpg
> 
> Input file size is 188933, 47333
> 
> goes out to lunch for several minutes. mrsiddecode does the equivalent in under a second.

Chris, 

The problem has to do with how the data is requested by gdal_translate
from the MrSID driver and how the mrsid driver handles that.  The 
above request results in a call to the CreateCopy() method on the GeoTIFF
driver which then requests the data one scanline at a time.  This results
in 500 individual calls into the MrSID driver asking for a chunk of imagery
to be rendered down to one line.  

Each request results in a separate windowed request into the MrSID library.
And setting up a request window in the MrSID API is relatively expensive.  

If you set the config option GDAL_FORCE_CACHING to YES then GDAL will
instead skip the "optimized" access and read the MrSID data into the block 
cache in fairly big chunks (usually 1024x128 chunks), then satisfy requests
from this cache.  In a test case I ran that was somewhat similar using this
option reduced a gdal_translate run from 26s to 1.5s.  In this case it basically
filled a 767x512 "overview level" cache in 4 MrSID requests.  All scanline 
requests then came from this cache. 

However, in other circumstances going through the CACHE is a bad idea.
For instance, MapServer makes it's entire read in one request, and it is
better to set a window specific to that request and do the read from the
MrSID in one go.  If caching is on, then the request gets broken into alot
of little requests. 

The MrSID driver *attempts* to decide which approach to use with some
heuristics.  Currently the logic is to use block cached IO if the request
is for only one scanline from the input file, or if the total request size
is less than 100 pixels.   It is attempting to treat small requests through the
caching mechanism. 

In our case of reducing to a 500 x 500 file though they request windows
are much more than one line even though the output of the request
is a single scanline.   For instance, with CPL_DEBUG set to ON I 
get reports like this in my case:

MrSID: RasterIO() - using optimized dataset level IO.
MrSID: Dataset:IRasterIO(0,8317 12268x17 -> 767x2 -> 500x1, zoom=16)

This indicates that the application request a 12268x17 window to be
read into a 500x1 buffer.  Because the input window was 17 lines the
logic handles it as a direct windowed read.  BTW, the 767x2 intermediate
buffer is due to having to do the read from a specific intermediate resolution
level from which a futher subsampling step is done.

For highly subsampled requests, I think it would be good for me to 
also look at the size of the output buffer, so I have added the following
rule and committed it this morning. 

    if( nBufYSize == 1 || nBufXSize * ((double) nBufYSize) < 100.0 )
        bUseBlockedIO = TRUE;

This forces "cached io" if the output buffer is only one scanline or
if the output window is less than 100 pixels.  Hopefully this will not
have to many unanticipated negative effects!  

In general, a number of drivers suffer from this sort of "cached/blocked
vs. direct window request" tradeoff.  Notably the ECW, JPEG2000 and
OGDI drivers.   The GDAL_FORCE_CACHING should force caching 
with them all. 

There is also a configuration option for "encouraging" direct windowed
reads.  That is the GDAL_ONE_BIG_READ config option.  This basically
tells the drivers that we are just making one big request so try and
satisfy it efficiently in isolation.  Don't expect it to be part of a pattern of
additional requests.  In effect this is the opposite of forcing cached IO
but it is only noticed but a couple of drivers ... the MrSID driver being
one of them.  So I sometimes advise MapServer uses to set this
config option, and I may make MapServer do it explicitly someday.

BTW, config options can be set as environment variables, or programatically
with CPLSetConfigOption() or on the commandline with the --config option
to most programs. 

eg. 

gdal_translate --config GDAL_ONE_BIG_READ YES  in.tif out.tif

Hopefully this advise will help others with MrSID, ECW and JPEG2000
performance issues to see some of what can happen "under the covers".

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cgn at globexplorer.com  Fri Jul 22 12:15:07 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate versus mrsiddecode
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCE8B@loki.wc.globexplorer.net>

Once again, Frank has demonstrated an awesome level of responsiveness.

How many people one this list have *every* gotten such a detailed response on short turn around from a commercial vendor?

Frank, you are truly inspirational; no wonder GDAL is taking over the world!

Chris


-----Original Message-----
From:	Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent:	Fri 7/22/2005 7:13 AM
To:	Chris G. Nicholas
Cc:	gdal-dev@lists.maptools.org
Subject:	Re: [Gdal-dev] gdal_translate versus mrsiddecode
On 7/21/05, Chris G. Nicholas <cgn@globexplorer.com> wrote:
> Just checked out the latest/greatest CVS snapshot, as well as the same for MrSid DSDK, and not sure why, but mrsiddecode is *_way_* faster for some simple cases; I'm just trying to make thumbnails of some monster images we have sitting around, and doing some simple non-geographic extracts.
> 
> Something like:
> 
> gdal_translate -of jpeg -outsize 500 500 /data/f04/contentapu1/apu01_2ft_aus_2.sid /tmp/foo.jpg
> 
> Input file size is 188933, 47333
> 
> goes out to lunch for several minutes. mrsiddecode does the equivalent in under a second.

Chris, 

The problem has to do with how the data is requested by gdal_translate
from the MrSID driver and how the mrsid driver handles that.  The 
above request results in a call to the CreateCopy() method on the GeoTIFF
driver which then requests the data one scanline at a time.  This results
in 500 individual calls into the MrSID driver asking for a chunk of imagery
to be rendered down to one line.  

Each request results in a separate windowed request into the MrSID library.
And setting up a request window in the MrSID API is relatively expensive.  

If you set the config option GDAL_FORCE_CACHING to YES then GDAL will
instead skip the "optimized" access and read the MrSID data into the block 
cache in fairly big chunks (usually 1024x128 chunks), then satisfy requests
from this cache.  In a test case I ran that was somewhat similar using this
option reduced a gdal_translate run from 26s to 1.5s.  In this case it basically
filled a 767x512 "overview level" cache in 4 MrSID requests.  All scanline 
requests then came from this cache. 

However, in other circumstances going through the CACHE is a bad idea.
For instance, MapServer makes it's entire read in one request, and it is
better to set a window specific to that request and do the read from the
MrSID in one go.  If caching is on, then the request gets broken into alot
of little requests. 

The MrSID driver *attempts* to decide which approach to use with some
heuristics.  Currently the logic is to use block cached IO if the request
is for only one scanline from the input file, or if the total request size
is less than 100 pixels.   It is attempting to treat small requests through the
caching mechanism. 

In our case of reducing to a 500 x 500 file though they request windows
are much more than one line even though the output of the request
is a single scanline.   For instance, with CPL_DEBUG set to ON I 
get reports like this in my case:

MrSID: RasterIO() - using optimized dataset level IO.
MrSID: Dataset:IRasterIO(0,8317 12268x17 -> 767x2 -> 500x1, zoom=16)

This indicates that the application request a 12268x17 window to be
read into a 500x1 buffer.  Because the input window was 17 lines the
logic handles it as a direct windowed read.  BTW, the 767x2 intermediate
buffer is due to having to do the read from a specific intermediate resolution
level from which a futher subsampling step is done.

For highly subsampled requests, I think it would be good for me to 
also look at the size of the output buffer, so I have added the following
rule and committed it this morning. 

    if( nBufYSize == 1 || nBufXSize * ((double) nBufYSize) < 100.0 )
        bUseBlockedIO = TRUE;

This forces "cached io" if the output buffer is only one scanline or
if the output window is less than 100 pixels.  Hopefully this will not
have to many unanticipated negative effects!  

In general, a number of drivers suffer from this sort of "cached/blocked
vs. direct window request" tradeoff.  Notably the ECW, JPEG2000 and
OGDI drivers.   The GDAL_FORCE_CACHING should force caching 
with them all. 

There is also a configuration option for "encouraging" direct windowed
reads.  That is the GDAL_ONE_BIG_READ config option.  This basically
tells the drivers that we are just making one big request so try and
satisfy it efficiently in isolation.  Don't expect it to be part of a pattern of
additional requests.  In effect this is the opposite of forcing cached IO
but it is only noticed but a couple of drivers ... the MrSID driver being
one of them.  So I sometimes advise MapServer uses to set this
config option, and I may make MapServer do it explicitly someday.

BTW, config options can be set as environment variables, or programatically
with CPLSetConfigOption() or on the commandline with the --config option
to most programs. 

eg. 

gdal_translate --config GDAL_ONE_BIG_READ YES  in.tif out.tif

Hopefully this advise will help others with MrSID, ECW and JPEG2000
performance issues to see some of what can happen "under the covers".

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

!DSPAM:42e0fef985337491954671!







From fwarmerdam at gmail.com  Fri Jul 22 14:46:03 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate versus mrsiddecode
In-Reply-To: <71E37EF6B7DCC1499CEA0316A2568328021FCE8B@loki.wc.globexplorer.net>
References: <71E37EF6B7DCC1499CEA0316A2568328021FCE8B@loki.wc.globexplorer.net>
Message-ID: <931f8ea9050722114679822872@mail.gmail.com>

On 7/22/05, Chris G. Nicholas <cgn@globexplorer.com> wrote:
> Once again, Frank has demonstrated an awesome level of responsiveness.
> 
> How many people one this list have *every* gotten such a detailed response on short turn around from a commercial vendor?
> 
> Frank, you are truly inspirational; no wonder GDAL is taking over the world!

Chris, 

Well, I don't want to suggest that I don't appreciate your kudos, but 
I have been failing to deal with various reports of poor mrsid 
performance for a while, and with your message things reached a sort
of critical threshold where I thought I should do some investigative
work.  

I'm sure Martin Daly is wondering why I still haven't looked further
into why he is getting poor performance with MrSID!  Perhaps something
from my response to you will be helpful for him too. 

The thing with me is that if I don't respond within a few hours, you are 
likely to never get a response since the message will fall below my 
email event-horizon (ie. off the first page in the gmail interface). 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tim at linfiniti.com  Sun Jul 24 00:36:49 2005
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Building overviews in external .ovr file programatticall
Message-ID: <200507240537.01032.tim@linfiniti.com>

Hi

The docs mention the ability to build .ovr files, but I dont see any way to 
force the behaviour programmatically. Are .ovr files supported on all 
formats? Is there a list of supported overview friendly formats if not?

Thanks

Tim
-- 
--
"Throw a resourceful man into a river and he will come up holding a fish" 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050724/56469155/attachment.bin
From fwarmerdam at gmail.com  Mon Jul 25 11:07:15 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Building overviews in external .ovr file
	programatticall
In-Reply-To: <200507240537.01032.tim@linfiniti.com>
References: <200507240537.01032.tim@linfiniti.com>
Message-ID: <931f8ea905072508073a21ce77@mail.gmail.com>

On 7/24/05, Tim Sutton <tim@linfiniti.com> wrote:
> Hi
> 
> The docs mention the ability to build .ovr files, but I dont see any way to
> force the behaviour programmatically. Are .ovr files supported on all
> formats? Is there a list of supported overview friendly formats if not?

Tim,

Check out the BuildOverviews() method on the GDALDataset for 
information on how to build overviews programmatically. 

http://www.gdal.org/classGDALDataset.html#a24

I would add that the gdaladdo source is quite short and you can
look at it. 

There is no clear way to figure out what formats support overviews.
Most do, but not all.   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Mon Jul 25 13:49:25 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Re: Error handler threading suggestion
In-Reply-To: <42E00918.6010607@vexcel.com>
References: <42E00918.6010607@vexcel.com>
Message-ID: <931f8ea905072510496a45cae@mail.gmail.com>

On 7/21/05, Steve Soule <Steve.Soule@vexcel.com> wrote:
> Currently, the GDAL error handler is thread-local.  If the client wants
> the error handler to be something other than CPLDefaultErrorHandler,
> CPLSetErrorHandler must be called by each thread created.  This is
> painful.
> 
> Currently there is an error-handler stack, maintained as
> psHandlerStack, with pfnErrorHandler implicitly the top of the
> stack.  CPLPushErrorHandler and CPLPopErrorHandler maintain the stack,
> and CPLSetErrorHandler replaces the top handler on the stack.  The stack
> must be thread-local, because push and pop are used to temporarily turn
> off error reporting in many places in GDAL.  It would be nice if
> CPLSetErrorHandler set the handler for all threads.
> 
> Here's how to do it:  let pfnErrorHandler implicitly be the bottom
> of the stack instead of the top of the stack.  Push and Pop would
> not change pfnErrorHandler.  The two places the error handler is
> called, CPLErrorV and CPLDebug, would be changed to check the stack
> first, and call the top handler on the stack if the stack were not
> empty, and only call pfnErrorHandler if the stack were empty.
> Then pfnErrorHandler would not need to be thread-local, and
> CPLSetErrorHandler would set the base error handler for all threads.
> CPLPushErrorHandler and CPLPopErrorHandler would override the base
> error handler for a single thread.

Steve,

I agree.  I have changed the model as you suggest, and now
the "error handler stack" is thread-local and takes precidence over
error handlers installed with CPLSetErrorHandler().  The handler
installed with CPLSetErrorHandler() is global to all threads. 

In single threaded applications this does potentially mean there is 
a change in how error handlers work in some applications.  In particular,
you can no longer be confident that CPLSetErrorHandler() will change
the error handler that will be used for the next error.  If there have
been error handlers pushed with CPLPushErrorHandler() then these
will take precidence.   However, I think this is a rare circumstance. 

I have updated the documentation accordingly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cgn at globexplorer.com  Mon Jul 25 14:19:11 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Re: Error handler threading suggestion
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCE9C@loki.wc.globexplorer.net>

In what multithreaded scenarios do people actually envision using GDAL? Is this all about FastCGI?  

Or are people on a quest to make the CPU and I/O intensive routines of GDAL truly multithreaded, in the sense that they might scale linearly with available resources? (of course, subject to underlying library restrictions of things like ECW, MrSid, Kakadu, Proj4, etc etc) 

Chris


-----Original Message-----
From:	gdal-dev-bounces@lists.maptools.org on behalf of Frank Warmerdam
Sent:	Mon 7/25/2005 10:49 AM
To:	Steve Soule
Cc:	gdal-dev@lists.maptools.org
Subject:	[Gdal-dev] Re: Error handler threading suggestion
On 7/21/05, Steve Soule <Steve.Soule@vexcel.com> wrote:
> Currently, the GDAL error handler is thread-local.  If the client wants
> the error handler to be something other than CPLDefaultErrorHandler,
> CPLSetErrorHandler must be called by each thread created.  This is
> painful.
> 
> Currently there is an error-handler stack, maintained as
> psHandlerStack, with pfnErrorHandler implicitly the top of the
> stack.  CPLPushErrorHandler and CPLPopErrorHandler maintain the stack,
> and CPLSetErrorHandler replaces the top handler on the stack.  The stack
> must be thread-local, because push and pop are used to temporarily turn
> off error reporting in many places in GDAL.  It would be nice if
> CPLSetErrorHandler set the handler for all threads.
> 
> Here's how to do it:  let pfnErrorHandler implicitly be the bottom
> of the stack instead of the top of the stack.  Push and Pop would
> not change pfnErrorHandler.  The two places the error handler is
> called, CPLErrorV and CPLDebug, would be changed to check the stack
> first, and call the top handler on the stack if the stack were not
> empty, and only call pfnErrorHandler if the stack were empty.
> Then pfnErrorHandler would not need to be thread-local, and
> CPLSetErrorHandler would set the base error handler for all threads.
> CPLPushErrorHandler and CPLPopErrorHandler would override the base
> error handler for a single thread.

Steve,

I agree.  I have changed the model as you suggest, and now
the "error handler stack" is thread-local and takes precidence over
error handlers installed with CPLSetErrorHandler().  The handler
installed with CPLSetErrorHandler() is global to all threads. 

In single threaded applications this does potentially mean there is 
a change in how error handlers work in some applications.  In particular,
you can no longer be confident that CPLSetErrorHandler() will change
the error handler that will be used for the next error.  If there have
been error handlers pushed with CPLPushErrorHandler() then these
will take precidence.   However, I think this is a rare circumstance. 

I have updated the documentation accordingly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

!DSPAM:42e527a1243531288513109!









From fwarmerdam at gmail.com  Mon Jul 25 17:06:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Re: Error handler threading suggestion
In-Reply-To: <71E37EF6B7DCC1499CEA0316A2568328021FCE9C@loki.wc.globexplorer.net>
References: <71E37EF6B7DCC1499CEA0316A2568328021FCE9C@loki.wc.globexplorer.net>
Message-ID: <931f8ea90507251406473cc771@mail.gmail.com>

On 7/25/05, Chris G. Nicholas <cgn@globexplorer.com> wrote:
> In what multithreaded scenarios do people actually envision using GDAL? Is this all about FastCGI?
> 
> Or are people on a quest to make the CPU and I/O intensive routines of GDAL truly multithreaded, in the sense that they might scale linearly with available resources? (of course, subject to underlying library restrictions of things like ECW, MrSid, Kakadu, Proj4, etc etc)

Chris, 

I can't speak for everyone, but the intent is to implement a server of
some sort that can have multiple threads active reading from a variety of
files with some degree of scalability.   

In some cases folks aren't as concerned about the scalability of GDAL
and ensuring that it can be safely used in existing multi-threaded
applications.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cgn at globexplorer.com  Mon Jul 25 17:33:42 2005
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Re: Error handler threading suggestion
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328021FCEA3@loki.wc.globexplorer.net>

For apps that can tolerate a few seconds of delay (i.e. aren't inline serving web users users with a very short attention span) I highly recommend the stuff of: http://gridengine.sunsource.net/ . We run this against 100+ CPUs all the time; works great. The other choice is: http://www.cs.wisc.edu/condor/ .

Simpler approaches are good old fork/exec based on inetd; you can use simple load balacing stuff in Apache, or use the Linux stuff of: http://lcic.org/load_balancing.html . We use this all over too...

Chris

-----Original Message-----
From:	Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent:	Mon 7/25/2005 2:06 PM
To:	Chris G. Nicholas
Cc:	gdal-dev@lists.maptools.org
Subject:	Re: [Gdal-dev] Re: Error handler threading suggestion
On 7/25/05, Chris G. Nicholas <cgn@globexplorer.com> wrote:
> In what multithreaded scenarios do people actually envision using GDAL? Is this all about FastCGI?
> 
> Or are people on a quest to make the CPU and I/O intensive routines of GDAL truly multithreaded, in the sense that they might scale linearly with available resources? (of course, subject to underlying library restrictions of things like ECW, MrSid, Kakadu, Proj4, etc etc)

Chris, 

I can't speak for everyone, but the intent is to implement a server of
some sort that can have multiple threads active reading from a variety of
files with some degree of scalability.   

In some cases folks aren't as concerned about the scalability of GDAL
and ensuring that it can be safely used in existing multi-threaded
applications.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

!DSPAM:42e55493275991938320547!








From csab7771 at uibk.ac.at  Mon Jul 25 18:28:57 2005
From: csab7771 at uibk.ac.at (Sabine Grabner)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] reading hdf4 file
Message-ID: <1122330537.42e567a9b107e@web-mail1.uibk.ac.at>

hello,

i try to read a hdf4 file but poDataset->GetRasterCount() returns 0 bands even
though gdalinfo lists all bands of the file.

i work with GDAL 1.2.6.0 from 03/13/2005.

can anybody help out please?

thank you,

sabine






********************************************************
Sabine Grabner
Assistant Researcher

Institute for Computational Earth System Science (ICESS)
6724 Ellison Hall
University of California
Santa Barbara, CA 93106-3060
Phone: 805-93-5308  Fax: 805-893-2578
E-mail: csab7771@uibk.ac.at
Web: www.icess.ucsb.edu

From tim at linfiniti.com  Mon Jul 25 19:01:27 2005
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Building overviews in external .ovr file
	programatticall
Message-ID: <200507260001.34383.tim@linfiniti.com>

Hi

Sorry my original message was not very clearly put. I have already
 implemented an overview builder in QGIS (since 0.6 release). Looking at the
 gdaladdo code, its not substantially different to what I have implemented.
 Some users filed bugs about QGIS not producing overviews for certain file
 types e.g. jpg. So I went back to the gdal docs (the gdaladdo docs instead
 of the api docs I previously used) to try to see what the supported file
 types were and then realised that it mentions the ability to e.g. build ovr
 files. On closer investigation however, I have discovered the real problem
 was that I was not handling errors correctly as I'd stubbed out bits of
 error handling code based on gdal api docs that didn't work. To resolve the
 problem I had a poke around in the gdal sources and discovered the following
 small errors in the api docs:

GDALDataset::BuildOverviews 'CPLE_NonSupported' should read
'CPLE_NotSupported'.

The same error is also in GDALRasterBand::BuildOverviews.

Also these same docs sections state that an error can be picked up using
CPLGetLastError(), but after a bit of snooping around in the source is looks
like its actually CPLGetLastErrorNo() that should be used.

That allowed me to implement a better error handler and will hopefully
 resolve my problem mostly.

Hope thats useful :-)

Regards

Tim

On Monday 25 July 2005 16:07, Frank Warmerdam wrote:
> On 7/24/05, Tim Sutton <tim@linfiniti.com> wrote:
> > Hi
> >
> > The docs mention the ability to build .ovr files, but I dont see any way
> > to force the behaviour programmatically. Are .ovr files supported on all
> > formats? Is there a list of supported overview friendly formats if not?
>
> Tim,
>
> Check out the BuildOverviews() method on the GDALDataset for
> information on how to build overviews programmatically.
>
> http://www.gdal.org/classGDALDataset.html#a24
>
> I would add that the gdaladdo source is quite short and you can
> look at it.
>
> There is no clear way to figure out what formats support overviews.
> Most do, but not all.
>
> Best regards,

--
"The mind once expanded to the dimensions of larger ideas never returns to
 its original dimensions."

-------------------------------------------------------
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050726/445b4293/attachment.bin
From fwarmerdam at gmail.com  Mon Jul 25 19:14:39 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] reading hdf4 file
In-Reply-To: <1122330537.42e567a9b107e@web-mail1.uibk.ac.at>
References: <1122330537.42e567a9b107e@web-mail1.uibk.ac.at>
Message-ID: <931f8ea905072516144d8ace9c@mail.gmail.com>

On 7/25/05, Sabine Grabner <csab7771@uibk.ac.at> wrote:
> hello,
> 
> i try to read a hdf4 file but poDataset->GetRasterCount() returns 0 bands even
> though gdalinfo lists all bands of the file.
> 
> i work with GDAL 1.2.6.0 from 03/13/2005.
> 
> can anybody help out please?

Sabine, 

It would be helpful to show the gdalinfo report.  Most likely the gdalinfo
report is listing a set of subdatasets but not any bands.  Generally for
HDF you need to open the file, get a list of subdatasets (from metadata)
and then open one or more of those subdatasets in order to get the 
accesss to the imagery.

The following code from gdal_translate might give an idea how to get
the list of subdatasets, and use it. 

/* -------------------------------------------------------------------- */
/*      Handle subdatasets.                                             */
/* -------------------------------------------------------------------- */
    if( CSLCount(GDALGetMetadata( hDataset, "SUBDATASETS" )) > 0 )
    {
        if( !bCopySubDatasets )
        {
            fprintf( stderr,
                     "Input file contains subdatasets. Please, select
one of them for reading.\n" );
        }
        else
        {
            char **papszSubdatasets = GDALGetMetadata(hDataset,"SUBDATASETS");
            char *pszSubDest = (char *) CPLMalloc(strlen(pszDest)+32);
            int i;
            int bOldSubCall = bSubCall;

            argv[iDstFileArg] = pszSubDest;
            bSubCall = TRUE;
            for( i = 0; papszSubdatasets[i] != NULL; i += 2 )
            {
                argv[iSrcFileArg] = strstr(papszSubdatasets[i],"=")+1;
                sprintf( pszSubDest, "%s%d", pszDest, i/2 + 1 );
                if( ProxyMain( argc, argv ) != 0 )
                    break;
            }

            bSubCall = bOldSubCall;
            CPLFree( pszSubDest );
        }

        GDALClose( hDataset );

        if( !bSubCall )
        {
            GDALDumpOpenDatasets( stderr );
            GDALDestroyDriverManager();
        }
        return 1;
    }

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cpadwick at digitalglobe.com  Mon Jul 25 19:35:13 2005
From: cpadwick at digitalglobe.com (Chris Padwick)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Fast Polygon intersections
Message-ID: <48E4232189A41343B805843CE27B6EFF150C2B@COMAIL02.digitalglobe.com>

Hi Frank, 

Thanks for the suggestion.  Using GEOS directly seems to go much faster.

Regards,

Chris

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Sent: Wednesday, July 20, 2005 1:44 PM
To: Chris Padwick
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Fast Polygon intersections

On 7/20/05, Chris Padwick <cpadwick@digitalglobe.com> wrote:
>  
>  
> 
> Greetings, 
> 
>   
> 
> I have a collection of 60 polygons and I'm using OGR to compare each
polygon
> to every other polygon and test whether one is inside the other.  I'm
using
> the OGRGeometry::Within() method to test them.  I've noticed that this
test
> is really slow, taking many seconds to compare one polygon against 59
other
> polygons.  Is there another method I might use to speed up this test
or
> another approach I could take all together? 

Chris,

You might want to try doing an extents comparison before doing the hard
test.   

But internally each request will convert the two geometries into GEOS
geometries, and then do the GEOS comparison operation.  You can likely
achieve much better performance by using GEOS directly, avoiding alot
of reconversion work at least.  You might also find that there are ways
to
invoke GEOS that build and preserve the spatial index for a given
polygon
over many comparisons.  I haven't tried this but for somewhat similar
operations
I believe Safe Software has gotten big performance improvements. 

I would add that currently OGR converts to GEOS objects via WKT format,
and
this may be a poor choice from a performance point of view.  I may well 
reimplement the conversion functions at some point. 

Even if you use GEOS directly, if you are reading your polygons with OGR
you may still find it helpful to OGRGeometry::exportToGEOS() method
(with
the above caveats). 

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dburken at comcast.net  Tue Jul 26 13:28:28 2005
From: dburken at comcast.net (dburken@comcast.net)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Error in geotiff.cpp (current cvs)
Message-ID: <072620051728.8733.42E672BC000B4D230000221D2200745672020A059D9A0D0B@comcast.net>

Hi Frank,

Hey just fyi in the current cvs tree of gdal:

Line 3237 I think "nBAnds" should be "nBands".

mercury$ make
g++ -Wall -fPIC -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts  -I../../port -I/work/drb/geotiff/include -I/work/drb/libtiff/include  -c -o geotiff.o geotiff.cpp
geotiff.cpp: In function TIFF* GTiffCreate(const char*, int, int, int, GDALDataType, char**):
geotiff.cpp:3237: error: nBAnds was not declared in this scope


Take care,
Dave


From fwarmerdam at gmail.com  Tue Jul 26 13:49:01 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Error in geotiff.cpp (current cvs)
In-Reply-To: <072620051728.8733.42E672BC000B4D230000221D2200745672020A059D9A0D0B@comcast.net>
References: <072620051728.8733.42E672BC000B4D230000221D2200745672020A059D9A0D0B@comcast.net>
Message-ID: <931f8ea90507261049415a8d99@mail.gmail.com>

On 7/26/05, dburken@comcast.net <dburken@comcast.net> wrote:
> Hi Frank,
> 
> Hey just fyi in the current cvs tree of gdal:
> 
> Line 3237 I think "nBAnds" should be "nBands".
> 
> mercury$ make
> g++ -Wall -fPIC -O2    -I../../port -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts  -I../../port -I/work/drb/geotiff/include -I/work/drb/libtiff/include  -c -o geotiff.o geotiff.cpp
> geotiff.cpp: In function 'TIFF* GTiffCreate(const char*, int, int, int, GDALDataType, char**)':
> geotiff.cpp:3237: error: 'nBAnds' was not declared in this scope

Dave,

Patched in CVS.  That is what comes of my not even compiling a
small change!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From leibold at lsec.dnd.ca  Tue Jul 26 16:20:58 2005
From: leibold at lsec.dnd.ca (Leibold, David)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate: loses colour from GeoTIF to JPEG 
Message-ID: <16727AD54B902446A4FE8DE23B20C8D11CE3FC@lsec.dnd.ca>

I have a GeoTiff file (*.tif) which seems to be in order (colours seem to be OK, as is georeferencing when viewed on Tatuk viewer, or presumably other geo viewers).

But when I converting TIF to JPEG:

gdal_translate -of JPEG -co "WORLDFILE=YES" geo.tif geo2.jpg

... the geo2.jpg comes out all greyscale. It does open OK in Tatuk viewer with georeferencing (after renaming the world file extension from .wld to .jfw), apart from the black & white TV look.

The GeoTiff file seems to have only one colour band, after running gdalinfo on it. The single band means -b 2, -b 3 flags wont' work.

Any way to bring colour from Tif to JPG?

Thanks.


David Leibold
Junior Systems Analyst / TL (C)
Land Software Engineering Centre

Tel: 613-995-8870
Email: leibold@lsec.dnd.ca



From fwarmerdam at gmail.com  Tue Jul 26 16:47:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate: loses colour from GeoTIF to JPEG
In-Reply-To: <16727AD54B902446A4FE8DE23B20C8D11CE3FC@lsec.dnd.ca>
References: <16727AD54B902446A4FE8DE23B20C8D11CE3FC@lsec.dnd.ca>
Message-ID: <931f8ea9050726134759b54476@mail.gmail.com>

On 7/26/05, Leibold, David <leibold@lsec.dnd.ca> wrote:
> I have a GeoTiff file (*.tif) which seems to be in order (colours seem to be OK, as is georeferencing when viewed on Tatuk viewer, or presumably other geo viewers).
> 
> But when I converting TIF to JPEG:
> 
> gdal_translate -of JPEG -co "WORLDFILE=YES" geo.tif geo2.jpg
> 
> ... the geo2.jpg comes out all greyscale. It does open OK in Tatuk viewer with georeferencing (after renaming the world file extension from .wld to .jfw), apart from the black & white TV look.
> 
> The GeoTiff file seems to have only one colour band, after running gdalinfo on it. The single band means -b 2, -b 3 flags wont' work.
> 
> Any way to bring colour from Tif to JPG?

David,

You need to convert the image from pseudocolored format to 24bit
RGB.  This can be accomplished wth the pct2rgb.py script.  

eg. 

pct2rgb.py original.tif rgb.tif
gdal_translate -of JPEG rgb.tif out.jpg -co WORLDFILE=YES

If you are using FWTools on windows, just invoke "rgb2pct" in
the shell.  There is a "bat" script around the python script. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jgreenberg at arc.nasa.gov  Tue Jul 26 22:52:56 2005
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Large file support under Tiger?
Message-ID: <200507270258.j6R2wAmP016527@duke.maptools.org>

Hi there, I've finally gotten a hold of Tiger and can't seem to get GDAL
compiled with large file i/o, which was supposed to be included in the 10.4
release.  I've tried adding the compiler flags:

CPPFLAGS=-D_FILE_OFFSET_BITS=64
CXXFLAGS=-D_FILE_OFFSET_BITS=64
CFLAGS=-D_FILE_OFFSET_BITS=64

But the configure script still says "Large file io... no"

Thoughts?  I honestly bought Tiger just so I could get starspan and grass
(which uses GDAL) working with > 4gb files, so I'm eagerly awaiting any
ideas...

--j

--

Jonathan A. Greenberg, PhD
NRC Research Associate
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Office: 650-604-5896
Cell: 415-794-5043
AIM: jgrn307
MSN: jgrn307@hotmail.com




From fwarmerdam at gmail.com  Tue Jul 26 23:21:59 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Large file support under Tiger?
In-Reply-To: <200507270258.j6R2wAmP016527@duke.maptools.org>
References: <200507270258.j6R2wAmP016527@duke.maptools.org>
Message-ID: <931f8ea9050726202171162be2@mail.gmail.com>

On 7/26/05, Jonathan Greenberg <jgreenberg@arc.nasa.gov> wrote:
> Hi there, I've finally gotten a hold of Tiger and can't seem to get GDAL
> compiled with large file i/o, which was supposed to be included in the 10.4
> release.  I've tried adding the compiler flags:
> 
> CPPFLAGS=-D_FILE_OFFSET_BITS=64
> CXXFLAGS=-D_FILE_OFFSET_BITS=64
> CFLAGS=-D_FILE_OFFSET_BITS=64
> 
> But the configure script still says "Large file io... no"
> 
> Thoughts?  I honestly bought Tiger just so I could get starspan and grass
> (which uses GDAL) working with > 4gb files, so I'm eagerly awaiting any
> ideas...

Jonathan, 

Are you using GDAL 1.2.6 or GDAL-CVS?  GDAL-CVS should support
large files on 10.3 without any special configuration options, but this
was added post-1.2.6.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From leibold at lsec.dnd.ca  Wed Jul 27 08:38:52 2005
From: leibold at lsec.dnd.ca (Leibold, David)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate: loses colour from GeoTIF to JPEG
Message-ID: <16727AD54B902446A4FE8DE23B20C8D1102F51@lsec.dnd.ca>

Pre-processing the 1-band geo.tif with pct2rgb worked - .jpg now has colour.

Thanks.

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent: Tuesday, July 26, 2005 4:47 PM
To: Leibold, David
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] gdal_translate: loses colour from GeoTIF to JPEG


On 7/26/05, Leibold, David <leibold@lsec.dnd.ca> wrote:
> I have a GeoTiff file (*.tif) which seems to be in order (colours seem to be OK, as is georeferencing when viewed on Tatuk viewer, or presumably other geo viewers).
> 
> But when I converting TIF to JPEG:
> 
> gdal_translate -of JPEG -co "WORLDFILE=YES" geo.tif geo2.jpg
> 
> ... the geo2.jpg comes out all greyscale. It does open OK in Tatuk viewer with georeferencing (after renaming the world file extension from .wld to .jfw), apart from the black & white TV look.
> 
> The GeoTiff file seems to have only one colour band, after running gdalinfo on it. The single band means -b 2, -b 3 flags wont' work.
> 
> Any way to bring colour from Tif to JPG?

David,

You need to convert the image from pseudocolored format to 24bit
RGB.  This can be accomplished wth the pct2rgb.py script.  

eg. 

pct2rgb.py original.tif rgb.tif
gdal_translate -of JPEG rgb.tif out.jpg -co WORLDFILE=YES

If you are using FWTools on windows, just invoke "rgb2pct" in
the shell.  There is a "bat" script around the python script. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dburken at comcast.net  Wed Jul 27 10:21:24 2005
From: dburken at comcast.net (dburken@comcast.net)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] kakadu 16 bit and lossless
Message-ID: <072720051421.13031.42E798640001B84F000032E72200761064020A059D9A0D0B@comcast.net>

Hi Frank,

Hey it looks like kakadu does not work with a QUALITY=100 or lossless on 16 bit data.

When writing an image with quality < 99.5 image is good.

When writing an image with quality >= 99.5 or "reversible" image is bad.

Garrett was saying he thought he saw this in the kakadu docs.

Not sure if you want to add a check in your writer for non-eight bit with quality >= 99.5 or not.

Now that I know the behavior I will avoid it.

Take care,
Dave

From mclark at sanz.com  Wed Jul 27 17:58:26 2005
From: mclark at sanz.com (Clark, Matt)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate question
Message-ID: <ED3A48B9840E594890A2BC172D11946502852BD4@mailman.san.com>

I was wondering if there is a way to either specify a pixel value of 0 as being transparent when using gdal_translate to create a PNG output file from a TIF, or if an alpha band can be added under the same circumstance.  Any advice in this area is greatly appreciated! 

Best Regards,
Matt Clark
303-495-6327
 <mailto:mclark@sanz.com> mclark@sanz.com 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050727/0ed8ae59/attachment.html
From tylermitchell at shaw.ca  Wed Jul 27 18:34:20 2005
From: tylermitchell at shaw.ca (Tyler Mitchell)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] gdal_translate question
Message-ID: <275f724276243d.276243d275f724@shaw.ca>

Matt,
I haven't tried it before but what about the -a_nodata parameter?
e.g. gdal_translate -of "PNG" -a_nodata 0  input.tif output.png
??

Tyler

----
Matt wrote:
I was wondering if there is a way to either specify a 
pixel value of 0 as being transparent when using 
gdal_translate to create a PNG output file from a TIF, 
or if an alpha band can be added under the same 
circumstance.  Any advice in this area is greatly 
appreciated! 


From gerald.clette at free.fr  Wed Jul 27 18:53:25 2005
From: gerald.clette at free.fr (=?iso-8859-1?Q?G=E9rald_CLETTE?=)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] XResolution / YResolution tags
Message-ID: <000001c592fd$ff8c8eb0$0100a8c0@master>

 
Hi Frank
 
I've found in the TIFF specification Rev 6.0 that the X/YResolution tags

don't have any default value.
It's also written that these tags are required for Bilevel Images,
Grayscale 
images, Palette color images as well as for RGB images.
I noticed that applications can display the images  with no care (!)
with 
these tags but it's not written that these tags can be absent.
 
I'm just trying to find how to get a default value for these tags (if
any 
but I don'tthink that it's a good idea to fx one) or a way to calculate
it.
 
Thank you
Gerald
 
"Frank Warmerdam" <fwarmerdam@gmail.com> a ?crit dans le message de
news: 
931f8ea90507060759158ca8d2@mail.gmail.com...
On 7/5/05, G?rald CLETTE <gerald.clette@free.fr> wrote:
> Hi
>
> I developped a new driver based on the GDAL data model to handle a new

> format with the gdal_warp tool. Then, I tried to create a GTIFF 
> product but the new file didn't contain the
> XResolution, YResolution nor ResolutionUnit tags. I thought that these

> tags
> were not optionnal in the GeoTiff description.
 
G?rald,
 
The XResolution, YResolution and ResolutionUnit flags are not related to
the GeoTIFF specification.  I am not aware of these being required tags
in the core TIFF specification though it is possible.  If so, could you 
provide
a reference?
 
> My question is : Is it a bug in the Geotiff library ? Or how can I 
> manage
> to
> product a "full" GeoTiff product with gdal_warp ?
 
The -mo flag to gdal_translate can be used to add dataset level metadata
which is how the GDAL GeoTIFF  driver handles the resolution
information.  Something like the following would set a 72dpi (dots per
inch) screen resolution:
 
gdal_translate in.tif out.tif \
      -mo TIFFTAG_XRESOLUTION=72 \
      -mo TIFFTAG_XRESOLUTION=72 \
      -mo TIFFTAG_RESOLUTIONUNIT=2
 
See the TIFF tag list for details on resolution unit values:
 
<http://www.awaresystems.be/imaging/tiff/tifftags/resolutionunit.html>
http://www.awaresystems.be/imaging/tiff/tifftags/resolutionunit.html
 
PS. Keep in mind that the x/yresolution values have nothing
to do with geospatial resolution.  It is screen/print display
resolution.
 
Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows |  <http://pobox.com/~warmerdam>
http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050728/285f3d4a/attachment.html
From dron at ak4719.spb.edu  Thu Jul 28 05:04:34 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] XResolution / YResolution tags
In-Reply-To: <000001c592fd$ff8c8eb0$0100a8c0@master>
References: <000001c592fd$ff8c8eb0$0100a8c0@master>
Message-ID: <20050728090434.GA28106@ak4719.spb.edu>

On Thu, Jul 28, 2005 at 12:53:25AM +0200, G?rald CLETTE wrote:
> I've found in the TIFF specification Rev 6.0 that the X/YResolution
> tags don't have any default value. It's also written that these tags
> are required for Bilevel Images, Grayscale images, Palette color
> images as well as for RGB images. I noticed that applications can
> display the images  with no care (!) with these tags but it's not
> written that these tags can be absent.
>  
> I'm just trying to find how to get a default value for these tags (if
> any but I don'tthink that it's a good idea to fx one) or a way to
> calculate it.


Gerald,


The resolution tags do not required to display an image and most image
viewers just ignore these tags. Displayed image can be arbitrary scaled
and we do not need predefined resolution, because it can be changed
dynamically. Resolution tags specified in the TIFF spec as required
fields, but you can safely omit them and vast majority of software will
open your files without problems. There is no default value for
resolution, but if you want to add the one for your files you can use
something like the 72 dpi or 100 dpi (typical display resolution).

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From oss-dev at rambler.ru  Thu Jul 28 08:47:31 2005
From: oss-dev at rambler.ru (Oleg Semykin)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] PostGIS Driver Performance
Message-ID: <42E8D3E3.5080905@rambler.ru>

Hi Craig!

Why the PostgreSQL driver loads all non-system tables from the database 
as layers? When we have a lot of tables this results in too big 
overhead. When we are working with PostGIS all layers are listed in the 
geometry_columns table and we can use it to prepare a list of tables to 
load. I can modify the driver to load only layers from the 
geometry_columns table when we have PostGIS and fallback to the old 
behaviour when we have plain PostgreSQL.

Oleg.

From fwarmerdam at gmail.com  Thu Jul 28 09:47:26 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] PostGIS Driver Performance
In-Reply-To: <42E8D3E3.5080905@rambler.ru>
References: <42E8D3E3.5080905@rambler.ru>
Message-ID: <931f8ea9050728064771ccbeae@mail.gmail.com>

On 7/28/05, Oleg Semykin <oss-dev@rambler.ru> wrote:
> Hi Craig!
> 
> Why the PostgreSQL driver loads all non-system tables from the database
> as layers? When we have a lot of tables this results in too big
> overhead. When we are working with PostGIS all layers are listed in the
> geometry_columns table and we can use it to prepare a list of tables to
> load. I can modify the driver to load only layers from the
> geometry_columns table when we have PostGIS and fallback to the old
> behaviour when we have plain PostgreSQL.

Oleg, 

I would be agreeable to such a change in the behavior of 
OGRPGDataSource::Open().  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Thu Jul 28 09:59:19 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] XResolution / YResolution tags
In-Reply-To: <20050728090434.GA28106@ak4719.spb.edu>
References: <000001c592fd$ff8c8eb0$0100a8c0@master>
	<20050728090434.GA28106@ak4719.spb.edu>
Message-ID: <931f8ea9050728065945ee5134@mail.gmail.com>

> On Thu, Jul 28, 2005 at 12:53:25AM +0200, G?rald CLETTE wrote:
> > I've found in the TIFF specification Rev 6.0 that the X/YResolution
> > tags don't have any default value. It's also written that these tags
> > are required for Bilevel Images, Grayscale images, Palette color
> > images as well as for RGB images. I noticed that applications can
> > display the images  with no care (!) with these tags but it's not
> > written that these tags can be absent.
> >
> > I'm just trying to find how to get a default value for these tags (if
> > any but I don'tthink that it's a good idea to fx one) or a way to
> > calculate it.

Gerald, 

I would personally suggest a default value of:
  XResolution: 1
  YResolution: 1
   ResolutionUnit: 1 (Unknown)

That is to say, if there is no built in resolution information then assume
that is because the sender does not know anything about what paper
resolution it ought to be displayed at!  This is very common in the 
remote sensing and GIS field where many images do no have an 
implicit scale. 

Of course, if you have to print it, then you will have to make some reasonable
decision.  As Andrey suggested, printing at 72dpi might make sense but it really
depends on your circumstances. 

If your concern is that GDAL is producing illegal TIFF files then please
point me directly to the part of the spec in question, and I will consider 
setting default resolution information in the file. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From craig.miller at spatialminds.com  Thu Jul 28 11:39:55 2005
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] RE: PostGIS Driver Performance
In-Reply-To: <42E8D3E3.5080905@rambler.ru>
Message-ID: <ALEXANDRIA0oVexDAey00000181@ALEXANDRIA.spatialminds.local>

In case it's useful, here is the SQL I used to do this when I was working on
a PostGIS OLEDB provider proof of concept last fall. 

        char * SQL_SELECT_TABLES = "SELECT a.relname AS
Name,obj_description(oid, 'pg_class') AS Description FROM pg_class a,
pg_user b WHERE ( relkind = 'r') and relname !~ '^pg_' AND relname !~
'^sql_' AND relname !~ '^xin[vx][0-9]+' AND b.usesysid = a.relowner AND NOT
(EXISTS (SELECT viewname FROM pg_views WHERE viewname=a.relname))";

--Craig

-----Original Message-----
From: Oleg Semykin [mailto:oss-dev@rambler.ru] 
Sent: Thursday, July 28, 2005 5:48 AM
To: Craig Miller; gdal-dev
Subject: PostGIS Driver Performance

Hi Craig!

Why the PostgreSQL driver loads all non-system tables from the database 
as layers? When we have a lot of tables this results in too big 
overhead. When we are working with PostGIS all layers are listed in the 
geometry_columns table and we can use it to prepare a list of tables to 
load. I can modify the driver to load only layers from the 
geometry_columns table when we have PostGIS and fallback to the old 
behaviour when we have plain PostgreSQL.

Oleg.



From carl.anderson at co.fulton.ga.us  Thu Jul 28 12:45:01 2005
From: carl.anderson at co.fulton.ga.us (Carl Anderson)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] PostGIS Driver Performance
In-Reply-To: <931f8ea9050728064771ccbeae@mail.gmail.com>
References: <42E8D3E3.5080905@rambler.ru>
	<931f8ea9050728064771ccbeae@mail.gmail.com>
Message-ID: <42E90B8D.9070503@co.fulton.ga.us>

Frank Warmerdam wrote:

>On 7/28/05, Oleg Semykin <oss-dev@rambler.ru> wrote:
>  
>
>>Hi Craig!
>>
>>Why the PostgreSQL driver loads all non-system tables from the database
>>as layers? When we have a lot of tables this results in too big
>>overhead. When we are working with PostGIS all layers are listed in the
>>geometry_columns table and we can use it to prepare a list of tables to
>>load. I can modify the driver to load only layers from the
>>geometry_columns table when we have PostGIS and fallback to the old
>>behaviour when we have plain PostgreSQL.
>>    
>>
>
>Oleg, 
>
>I would be agreeable to such a change in the behavior of 
>OGRPGDataSource::Open().  
>
>Best regards,
>  
>
As a longer term goal it might be nice to add an accessor function for 
the list of  layers available at the OGR level and to allow drivers to 
defer populating it until requested.  So direct access to the array of 
available layers would be deprecated.


C.


-- 
Carl Anderson
GIS Manager Fulton County, Georgia
carl.anderson@co.fulton.ga.us
404.730.8026



-----------------------------------------------------
This message has been scanned for viruses and
dangerous content for Fulton County by DefendMail, and is
believed to be clean.


From fwarmerdam at gmail.com  Thu Jul 28 12:53:33 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] PostGIS Driver Performance
In-Reply-To: <42E90B8D.9070503@co.fulton.ga.us>
References: <42E8D3E3.5080905@rambler.ru>
	<931f8ea9050728064771ccbeae@mail.gmail.com>
	<42E90B8D.9070503@co.fulton.ga.us>
Message-ID: <931f8ea9050728095311153be6@mail.gmail.com>

On 7/28/05, Carl Anderson <carl.anderson@co.fulton.ga.us> wrote:
> As a longer term goal it might be nice to add an accessor function for
> the list of  layers available at the OGR level and to allow drivers to
> defer populating it until requested.  So direct access to the array of
> available layers would be deprecated.

Carl,

I would agree that the current architecture is flawed in this respect.
We run into this problem with many RDBMS based drivers where getting
detailed table information can be expensive.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Thu Jul 28 13:54:20 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Raster Attribute Tables (RATs)
Message-ID: <931f8ea905072810541e4748dd@mail.gmail.com>

Folks,

I have finally started work on "raster attribute tables" (or RATs) for GDAL.  
This is intended to be a data structure capturing various sorts of information 
that can be associated with ranges of pixel values.  This would include:

 o Color tables where a specific color is associated with each 
   integer raster value.  Currently handled by GDALColorTable

 o Color tables where ranges of values are assigned one color value.
   Currently addressed by the COLOR_TABLE_RULE metadata returned
   by the GRASS driver, but no where else. 

 o Color tables where a range of pixel values are assigned a range of
   colors.  That is, the color for a particular pixel value is determined by
   looking up the category it falls into and interpolating the value between
   the start and end value for that category based on where the pixel value
   is between the category minimum and maximum.   This is also currently 
   only handled by the GRASS COLOR_TABLE_RULE metadata mechanism.

 o Histogram information, where histogram counts are available for for some
   binning pattern of the data.  This is currently handled via the 
   GetHistogram(), GetDefaultHistogram() and SetDefaultHistogram() methods 
   on the GDALRasterBand. 

 o Class names for categories ... currently handled by the GetCategoryNames()
   method on the GDALRasterBand. 

 o Other generic information, such as long class names, other computed
   statistics, etc.

It is still unclear to what extent this new mechanism will replace existing
mechanisms.  It is likely that it will superceed the COLOR_TABLE_RULE
mechanism implemented for the GRASS driver, but I don't expect it to
replace use of the GDALColorTable for simple paletted images.  It also
won't replace the histogram mechanism.  It *might* replace the 
GetCategoryNames() mechanism since that is so little used. 

The raster attribute table is essentially a table with one "row" for each
range of pixel values considered to belong to a class. In a classic 
256 color paletted image there would be 256 classes.  To hold a 16
bit histogrmam, it might need 65536 classes.   For an image intended
to be colored along a single color range it might only have one class. 

Each row implicitly or explicitly has a min and max pixel value defining
the range of pixel values to which the row (category/class) applies.  

The table will have one or more columns.  If the min/max ranges are not 
"regular", then they can be explicit columns in the table.  Other columns
could include "class name", "pixel count" (histogram), red, green, blue, 
alpha, red_min, red_max, and so forth.  Very simple tables might only have
one column (say the pixel count), while others may have most of the columns.

Each RAT would have a name, and a given GDALRasterBand might have more than 
one associated with it, though normally there would be zero or one such table.

I propose to implement a GDALRasterAttributeClass table for easy 
construction, and query of raster attribute tables.  The interface
would look something like:

typedef enum {
    GFT_Integer, 
    GFT_Real,
    GFT_String
} GDALRATFieldType;

typedef enum {
    GFU_Generic = 0,
    GFU_PixelCount = 1,
    GFU_Name = 2,
    GFU_Min = 3,
    GFU_Max = 4,
    GFU_Red = 5,
    GFU_Green = 6,
    GFU_Blue = 7,
    GFU_Alpha = 8,
    GFU_RedMin = 9,
    GFU_GreenMin = 10,
    GFU_BlueMin = 11,
    GFU_AlphaMin = 12,
    GFU_RedMax = 13,
    GFU_GreenMax = 14,
    GFU_BlueMax = 15,
    GFU_AlphaMax = 16,
    GFU_Max
} GDALRATFieldUsage;

class GDALRasterAttributeTable 
{
public:
    GDALRasterAttributeTable();
    ~GDALRasterAttributeTable();

    std::string   GetTableName() const;
    
    int           GetCategoryCount() const;

    const char   *GetNameOfCol( int );
    GDALRATFieldUsage GetUsageOfCol( int );
    GDALRATFieldType GetTypeOfCol( int );
    
    int           GetColOfUsage( GDALRATFieldUsage );

    int           GetRowCount() const;

    std::string   GetValueAsString( int iRow, int iField ) const;
    int           GetValueAsInt( int iRow, int iField ) const;
    double        GetValueAsDouble( int iRow, int iField ) const;

    void          SetValue( int iRow, int iField, const char *pszValue );
    void          SetValue( int iRow, int iField, double dfValue);
    void          SetValue( int iRow, int iField, int nValue );

    int           GetRowOfValue( double dfValue );
    int           GetRowOfValue( int nValue );
    int           GetColorOfValue( double dfValue, GDALColorEntry *psEntry );

    double        GetRowMin( int iRow );
    double        GetRowMax( int iRow );

    CPLErr        CreateColumn( std::string osFieldName, 
                                GDALRATFieldType eFieldType, 
                                GDALRATFieldUsage eFieldUsage );
    CPLErr        SetLinearBinning( double dfRow0Min, double dfBinSize );
    int           GetRegularBinning( double *pdfRow0Min, double *pdfBinSize );

    CPLXMLNode   *Serialize();
    CPLErr        XMLInit( CPLXMLNode *, const char * );

    CPLErr        InitializeFromColorTable( GDALColorTable * );
};


The GDALRasterBand class would have new virtual methods to query for 
or associate raster attribute tables with a band:

  virtual const GDALRasterAttributeTable *
              GetRasterAttributeTableRef( const char *pszTableName = NULL );
  virtual char **   
              GetRasterAttributeTableList();
  virtual CPLErr    
              AssociateRasterAttributeTable( GDALRasterAttributeTable * );

The GRASS and HFA (Erdas Imagine) drivers would include explicit support
for reading back the "raster attribute table" structures from those formats
directly.  The GDALPamRasterBand base class used for most driver's 
GDALRasterBand classes would also support these attribute tables via the
.aux.xml file.  

It is not yet clear to me to what extent some of the existing functions 
that overlap raster attribute tables would interact.  For instance, should
the default implementation of the GetHistogram() method search for existing 
RATs to satisfy a request?  

I think the most common use of RATs will be for applications wishing to 
preserve complex portrayal.  For instance, QGIS's GRASS plugin already uses
the COLOR_TABLE_RULE metadata to get range based colormaps.  It should be
upgraded to using RATs.  Basically scan for a RAT with color columns and
translate accordingly.  Likewise, MapServer could do the same thing, 
essentially internally defining a series of CLASSes on the raster layer based 
on the RAT rows. 

I am putting out this preliminary design to get feedback from you, the user
community, on things you would like to accomplish with RATs and suggestions
with regard to the interface and behavior. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Thu Jul 28 14:30:15 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] XResolution / YResolution tags
In-Reply-To: <931f8ea9050728065945ee5134@mail.gmail.com>
References: <000001c592fd$ff8c8eb0$0100a8c0@master>
	<20050728090434.GA28106@ak4719.spb.edu>
	<931f8ea9050728065945ee5134@mail.gmail.com>
Message-ID: <20050728183015.GB5425@ak4719.spb.edu>

On Thu, Jul 28, 2005 at 09:59:19AM -0400, Frank Warmerdam wrote:
> If your concern is that GDAL is producing illegal TIFF files then
> please point me directly to the part of the spec in question, and I
> will consider setting default resolution information in the file. 

Frank,

In fact specification requires setting resolution for all image types.
See pages 21, 22, 23, 24 of the TIFF spec. But I do not think it is so
important (though, most image writers add the resulution tags).

Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From chammack at fadedsky.com  Thu Jul 28 10:51:31 2005
From: chammack at fadedsky.com (Christopher Hammack)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Multiple Images in NITF
Message-ID: <E1Dy9jP-00056F-N9@mohawk.vervehosting.com>

We're currently evaluating the use of GDAL in a project I'm working 
on.  We're very impressed with it's potential to convert various 
formats to GeoTIFFs with a variety of options.  However, we need 
similar capability with the NITF format and being able to read/write 
multiple images from an NITF file will eventually be important.  
According to the documentation, this isn't a current capability.  I was 
curious if this was a planned feature, or how difficult of an 
undertaking adding this would be?


Thanks,

-c



From fwarmerdam at gmail.com  Thu Jul 28 20:42:06 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] Multiple Images in NITF
In-Reply-To: <E1Dy9jP-00056F-N9@mohawk.vervehosting.com>
References: <E1Dy9jP-00056F-N9@mohawk.vervehosting.com>
Message-ID: <931f8ea905072817427ca63320@mail.gmail.com>

On 7/28/05, Christopher Hammack <chammack@fadedsky.com> wrote:
> We're currently evaluating the use of GDAL in a project I'm working
> on.  We're very impressed with it's potential to convert various
> formats to GeoTIFFs with a variety of options.  However, we need
> similar capability with the NITF format and being able to read/write
> multiple images from an NITF file will eventually be important.
> According to the documentation, this isn't a current capability.  I was
> curious if this was a planned feature, or how difficult of an
> undertaking adding this would be?

Christopher, 

There is no current plan to read or write multi-image NITF files, but
I am not adverse to doing it if there is demand (and funding).   Reading
would likely be a couple days work  Writing might be a bit more 
involved since there is no GDAL mechanism for creating multi-image
files. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From woklist at charter.net  Sat Jul 30 17:43:00 2005
From: woklist at charter.net (William K)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] threads support?
Message-ID: <48A6AA48-939C-487B-AD24-6980DEE20F65@charter.net>

I never really payed attention to threads vs. no threads.  I've  
always built my GDAL with threads.  I recently started looking at the  
CVS snapshots, and a few weeks ago one build worked briefly, then  
stopped working at all - gdalinfo and gdal_translate would just sit  
there idling, doing nothing (processor idle, no disk activity), but  
the ogr utilities were not affected.  It affected the libraries, so  
that GRASS would do the same (r.in.gdal, not v.in.ogr).

Reconfiguring and rebuilding, and newer snapshots, did not help.   
Happens on Mac OS 10.4 and 10.3.

Today I thought to build it without thread support, and bingo! it's  
working again.

So, did something change in the thread support in GDAL since 1.2.6?   
If I leave out thread support, how adversely would it affect other  
software, like MapServer and GRASS?

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

Earth: "Mostly harmless"

- revised entry in the HitchHiker's Guide to the Galaxy

From fwarmerdam at gmail.com  Sat Jul 30 22:14:46 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] threads support?
In-Reply-To: <48A6AA48-939C-487B-AD24-6980DEE20F65@charter.net>
References: <48A6AA48-939C-487B-AD24-6980DEE20F65@charter.net>
Message-ID: <931f8ea90507301914ff8a3ce@mail.gmail.com>

On 7/30/05, William K <woklist@charter.net> wrote:
> I never really payed attention to threads vs. no threads.  I've
> always built my GDAL with threads.  I recently started looking at the
> CVS snapshots, and a few weeks ago one build worked briefly, then
> stopped working at all - gdalinfo and gdal_translate would just sit
> there idling, doing nothing (processor idle, no disk activity), but
> the ogr utilities were not affected.  It affected the libraries, so
> that GRASS would do the same (r.in.gdal, not v.in.ogr).
> 
> Reconfiguring and rebuilding, and newer snapshots, did not help.
> Happens on Mac OS 10.4 and 10.3.
> 
> Today I thought to build it without thread support, and bingo! it's
> working again.
> 
> So, did something change in the thread support in GDAL since 1.2.6?
> If I leave out thread support, how adversely would it affect other
> software, like MapServer and GRASS?

William, 

The problem is that MacOS X didn't support creating recursive 
mutexes the way I was doing it on Linux.  I have corrected this
code in port/cpl_multiproc.cpp and it works great on MacOS X now.

The aspect that changed in recent weeks is that GDAL now actually
uses the mutexes for lots of core stuff where it didn't really before. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From woklist at charter.net  Sun Jul 31 12:38:38 2005
From: woklist at charter.net (William K)
Date: Wed Nov 21 11:49:41 2007
Subject: [Gdal-dev] threads support?
In-Reply-To: <931f8ea90507301914ff8a3ce@mail.gmail.com>
References: <48A6AA48-939C-487B-AD24-6980DEE20F65@charter.net>
	<931f8ea90507301914ff8a3ce@mail.gmail.com>
Message-ID: <68788A35-215D-43FE-A728-489626A93017@charter.net>

Thanks, that did the trick - threads are back!


On Jul 30, 2005, at 9:14 PM, Frank Warmerdam wrote:
>
>
> William,
>
> The problem is that MacOS X didn't support creating recursive
> mutexes the way I was doing it on Linux.  I have corrected this
> code in port/cpl_multiproc.cpp and it works great on MacOS X now.
>
> The aspect that changed in recent weeks is that GDAL now actually
> uses the mutexes for lots of core stuff where it didn't really before.
>

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

Theory of the Universe

There is a theory which states that if ever anyone discovers exactly  
what the universe is for and why it is here, it will instantly  
disappear and be replaced by something even more bizarrely  
inexplicable.  There is another theory which states that this has  
already happened.

-Hitchhiker's Guide to the Galaxy 2nd season intro

