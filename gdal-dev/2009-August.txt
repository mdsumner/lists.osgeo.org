From jorge.arevalo at gmail.com  Sun Aug  2 07:56:52 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  2 07:57:15 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <200907312041.48228.even.rouault@mines-paris.org>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com> 
	<4A6FDAA7.1020903@pobox.com>
	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com> 
	<200907312041.48228.even.rouault@mines-paris.org>
Message-ID: <cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>

Hello,

On Fri, Jul 31, 2009 at 8:41 PM, Even
Rouault<even.rouault@mines-paris.org> wrote:
> Le Friday 31 July 2009 18:04:14 Jorge Ar?valo, vous avez ?crit?:
>>
>> Yes, it's not commited yet. But, where do you store the overviews? The
>> overviews are a kind of datasets exposed via GetOverview method and
>> based in the first level dataset, right? So, when I'm creating a
>> dataset, I can create overviews as other datasets that are stored in
>> an array in the more general dataset. Then, they are like "children
>> datasets". Is this point incorrect?
>
> You can have a look at the GTiff driver (but just a quick one as it is an
> horrible complex thing. I don't want you to have an headache ;-)), for an
> example of a driver that support its own overviews, especially
> GTiffRasterBand::GetOverviewCount() and GTiffRasterBand::GetOverview() in
> frmts/gtiff/geotiff.cpp

Yes, I've read the GTiff code several times and I think it's really
complex, but very useful too. Many thanks for the tip Even :-)

>
> It works exactly the way you've described : the base dataset has an array of
> children datasets, one for each overview level. It is responsible for
> instanciating them and destroying them in its own destructor.
>

So, I can create an array of children datasets to store the overviews,
but I shouldn't add the datasets as metatada under SUBDATASETS domain.
Is it right?

>>
>> > Is there any mechanism currently for creating overviews? ?How have
>> > you been testing overviews?
>>
>> gdal2wktraster script is able to construct overview tables, as Mateusz
>> said. I tested the code by creating an overview of a dataset (with
>> gdal2wktraster script) and reading it with gdalinfo as metadata of
>> SUBDATASETS domain. I need more testing at this point, to somehow read
>> each overview and maybe store it as out-db raster. I'm not sure on how
>> to test it properly.
>
> If you support overviews with the standard GetOverview() mechanism of a raster
> band, you should be able to display them by using any GDAL based viewer
> (qgis, openev) and zooming out the raster by the appropriate factor. Or
> gdal_translate -outsize 50% 50% in_dataset out_ovr_2.tif, will just extract
> the overview of factor 2.
>

OK. Successfully tested :-). But I've found a mistake.

When I create an overview (a children dataset), its properties are the
same properties of the general dataset (his parent), apart from pixel
size, table name and column_name, of course. The problem appears when
sharing the PGconn object.

My code looks like this:

poDS->overview[i]->hPGconn = poDS->hPGconn

If each dataset's destructor (from the general one and from the
overviews) calls PQfinish over the same object, I get a segmentation
fault after the first time, of course. So, I have 2 options:
- Detect when a connection object has been freed, and perform only one
call. How should I do this?
- Don't share the PGconn object. Should I declare a static PGconn pointer?

What is the best approach?

Thanks in advance
Best regards,
Jorge


>>
>> > Under DOUBTs you ask what happens if the bounding box of a block
>> > does not match any real block in the table, what should happen. ?In this
>> > case IReadBlock() should fill the buffer with the nodata value (zero if
>> > nodata is not set).
>>
>> Ok, understood.
>>
>> > You also mention a doubt about how to handle the 16BF type, which is
>> > apparently "16-bit float". ?I have never seen such a thing before and I'm
>> > not sure why it is part of the WKTRaster specification. I would suggest
>> > removing it.
>> >
>> > However, if we wanted to support it (and you could figure out what it
>> > actually is), then I think it would be most appropriate to transform it
>> > into a 32bit float as it is read in IReadBlock(). ?Presumably the full
>> > range of a 16bit float could not be kept in a 16 bit integer.
>>
>> Actually, now I transform it in a 32bit float
>>
>> > Likewise, 1BB, 2BUI, and 4BUI values (if supported) should be
>> > translated on the fly into GDT_Byte values. ?However, there is a special
>> > NBITS metadata item in the IMAGE_STRUCTURE metadata domain that can
>> > be set in these cases to represent the special nature of the image data.
>> > Likewise there is a special value to indicate signed eight bit integers.
>> > These values are discussed in:
>> >
>> > ?http://trac.osgeo.org/gdal/wiki/rfc14_imagestructure
>> >
>> > However, I consider implementation of these esoteric types optional given
>> > the relatively limited time remaining.
>>
>> Ok. Added to my todo list.
>>
>>
>> Thanks Frank
>>
>> Best regards,
>> Jorge
>>
>> > Best regards,
>> > --
>> > ---------------------------------------+---------------------------------
>> >----- I set the clouds in motion - turn up ? | Frank Warmerdam,
>> > warmerdam@pobox.com
>> > light and sound - activate the windows | http://pobox.com/~warmerdam
>> > and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
From even.rouault at mines-paris.org  Sun Aug  2 08:28:05 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Aug  2 08:28:20 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>
Message-ID: <200908021428.07069.even.rouault@mines-paris.org>

Le Sunday 02 August 2009 13:56:52 Jorge Ar?valo, vous avez ?crit?:
> Hello,
> So, I can create an array of children datasets to store the overviews,
> but I shouldn't add the datasets as metatada under SUBDATASETS domain.
> Is it right?

Right, you shouldn't use SUBDATASETS for reporting overviews.

>
> When I create an overview (a children dataset), its properties are the
> same properties of the general dataset (his parent), apart from pixel
> size, table name and column_name, of course. The problem appears when
> sharing the PGconn object.
>
> My code looks like this:
>
> poDS->overview[i]->hPGconn = poDS->hPGconn
>
> If each dataset's destructor (from the general one and from the
> overviews) calls PQfinish over the same object, I get a segmentation
> fault after the first time, of course. So, I have 2 options:
> - Detect when a connection object has been freed, and perform only one
> call. How should I do this?
> - Don't share the PGconn object. Should I declare a static PGconn pointer?
>
> What is the best approach?

A static variable is rarely a good idea. It would prevent the user from having 
multiple WKTRaster datasets opened at the same time.

Perhaps you should add a bBase flag to the WKTRasterDataset object (like it's 
done for the GTiffDataset). You set it to TRUE for the base dataset and to 
FALSE for the overviews. Then you only call PQfinish() if it is TRUE.

(I've no looked at what your code does recently, so the following remark might 
be irrelevant. But if you use transactions and their life cycle runs accross 
several calls of GDAL API, using the same connection object for the base 
dataset and its overviews might not be appropriate, or might require having a 
flag to know that a transaction is opened. --> You want to be able to mix 
RasterIO() calls on the base dataset and overviews)
From mateusz at loskot.net  Sun Aug  2 08:51:19 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Aug  2 08:51:27 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
	<4A6FDAA7.1020903@pobox.com>	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com>
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>
Message-ID: <4A758BC7.8080802@loskot.net>

Jorge Ar?valo wrote:
> When I create an overview (a children dataset), its properties are
> the same properties of the general dataset (his parent), apart from
> pixel size, table name and column_name, of course. The problem
> appears when sharing the PGconn object.
> 
> My code looks like this:
> 
> poDS->overview[i]->hPGconn = poDS->hPGconn
> 
> If each dataset's destructor (from the general one and from the 
> overviews) calls PQfinish over the same object, I get a segmentation 
> fault after the first time, of course. So, I have 2 options: - Detect
> when a connection object has been freed, and perform only one call.
> How should I do this?

If I understand it correctly, the problem can be summarised in some
kind of pseudo-code as follows:

struct Overview
{
   PGconn* c;
   Overview(PGconn* c) : c(c) {}
   ~Overview() { PQfinish(c); }

};

struct Dataset
{
   PGconn* c;
   Dataset(char const* connstr) { /*connect to pgsql*/ }
   ~Dataset() {  PQfinish(c) ; c = 0; }
   Overview get_overview() { return Overview(c); }
};


{
   Overview ov;
   {
      Dataset d(...); // connect
      ov = d.get_overview(); // side-effect: share connection
   }  // Dataset dctor calls PQfinish

   // Problem #1: Overview's connection no longer valid
} // Problem #2: Overview dctor tries to close and fails

Note: Overview here may be a subdataset, no difference between the two
for the problem analysis.

Assuming this example reproduces the problem correctly, then
there is no way to detect in Overview's dctor that
connection is still valid.

After Dataset dctor is called, the c pointer in Overview is a dangling
pointer which stores an address in memory, but that address no longer
identifies PGconn object.

> - Don't share the PGconn object. Should I declare a static PGconn
> pointer?

It would work just in the opposite direction - such static pointer would
be shared. Concept of static object == concept of global object.
They are used to implement shared resource, though in a weak and
primitive way.

> What is the best approach?

First, you have to identify if lifetime of Dataset and Overview (or
Subdataset) is predictable - can Overview live longer than Dataset or
lifetime of Dataset always exceeds lifetime of Overview object.

1. The Dataset always life longer is the simplest case, simply close
connection only from Dataset and don't close it from Overview.
In other words, Overview's connection is a weak reference [1] to
connection in Dataset - meaning, Dataset is the only owner of connection.

[1] http://en.wikipedia.org/wiki/Weak_reference

2. However, if Overview object can live longer than Dataset
or moreover, you are not able to determine/predict what's
possible lifetime of Dataset and Overview, then IMHO the best
approach is to make PGconn a real shared object between Dataset
and Overview.

The simplest implementation is to use shared_ptr<T> from
std::tr1 (in GCC 4.3+ or Visual C++ 9.0+) or from Boost libraries.
However, I presume these are forbidden in GDAL, so you'd need to provide
some minimal implementation of reference counting pattern on your own.
Scott Meyers' example may be helpful:
http://www.aristeia.com/BookErrata/M29Source.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jorge.arevalo at gmail.com  Sun Aug  2 09:22:24 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  2 09:22:46 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <200908021428.07069.even.rouault@mines-paris.org>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com> 
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com> 
	<200908021428.07069.even.rouault@mines-paris.org>
Message-ID: <cb4457700908020622x4788e9e4nd42041646e3b074b@mail.gmail.com>

Hello Even,

2009/8/2 Even Rouault <even.rouault@mines-paris.org>:
> Le Sunday 02 August 2009 13:56:52 Jorge Ar?valo, vous avez ?crit?:
>> Hello,
>> So, I can create an array of children datasets to store the overviews,
>> but I shouldn't add the datasets as metatada under SUBDATASETS domain.
>> Is it right?
>
> Right, you shouldn't use SUBDATASETS for reporting overviews.

Thanks for confirmation

>
>>
>> When I create an overview (a children dataset), its properties are the
>> same properties of the general dataset (his parent), apart from pixel
>> size, table name and column_name, of course. The problem appears when
>> sharing the PGconn object.
>>
>> My code looks like this:
>>
>> poDS->overview[i]->hPGconn = poDS->hPGconn
>>
>> If each dataset's destructor (from the general one and from the
>> overviews) calls PQfinish over the same object, I get a segmentation
>> fault after the first time, of course. So, I have 2 options:
>> - Detect when a connection object has been freed, and perform only one
>> call. How should I do this?
>> - Don't share the PGconn object. Should I declare a static PGconn pointer?
>>
>> What is the best approach?
>
> A static variable is rarely a good idea. It would prevent the user from having
> multiple WKTRaster datasets opened at the same time.
>
> Perhaps you should add a bBase flag to the WKTRasterDataset object (like it's
> done for the GTiffDataset). You set it to TRUE for the base dataset and to
> FALSE for the overviews. Then you only call PQfinish() if it is TRUE.

Very good idea. I think I'll use it. Many thanks!

>
> (I've no looked at what your code does recently, so the following remark might
> be irrelevant. But if you use transactions and their life cycle runs accross
> several calls of GDAL API, using the same connection object for the base
> dataset and its overviews might not be appropriate, or might require having a
> flag to know that a transaction is opened. --> You want to be able to mix
> RasterIO() calls on the base dataset and overviews)
>
No, I'm not using transactions just now, but I'll take it into account
if I use them. Thanks again.

Best regards,
Jorge
From jorge.arevalo at gmail.com  Sun Aug  2 09:33:42 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  2 09:34:05 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <4A758BC7.8080802@loskot.net>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com> 
	<4A6FDAA7.1020903@pobox.com>
	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com> 
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com> 
	<4A758BC7.8080802@loskot.net>
Message-ID: <cb4457700908020633gf506efcp25a150bb0e9eedaa@mail.gmail.com>

Hello,

2009/8/2 Mateusz Loskot <mateusz@loskot.net>:
> Jorge Ar?valo wrote:
>> When I create an overview (a children dataset), its properties are
>> the same properties of the general dataset (his parent), apart from
>> pixel size, table name and column_name, of course. The problem
>> appears when sharing the PGconn object.
>>
>> My code looks like this:
>>
>> poDS->overview[i]->hPGconn = poDS->hPGconn
>>
>> If each dataset's destructor (from the general one and from the
>> overviews) calls PQfinish over the same object, I get a segmentation
>> fault after the first time, of course. So, I have 2 options: - Detect
>> when a connection object has been freed, and perform only one call.
>> How should I do this?
>
> If I understand it correctly, the problem can be summarised in some
> kind of pseudo-code as follows:
>
> struct Overview
> {
> ? PGconn* c;
> ? Overview(PGconn* c) : c(c) {}
> ? ~Overview() { PQfinish(c); }
>
> };
>
> struct Dataset
> {
> ? PGconn* c;
> ? Dataset(char const* connstr) { /*connect to pgsql*/ }
> ? ~Dataset() { ?PQfinish(c) ; c = 0; }
> ? Overview get_overview() { return Overview(c); }
> };
>
>
> {
> ? Overview ov;
> ? {
> ? ? ?Dataset d(...); // connect
> ? ? ?ov = d.get_overview(); // side-effect: share connection
> ? } ?// Dataset dctor calls PQfinish
>
> ? // Problem #1: Overview's connection no longer valid
> } // Problem #2: Overview dctor tries to close and fails
>
> Note: Overview here may be a subdataset, no difference between the two
> for the problem analysis.

Yes, the problem looks like that.

>
> Assuming this example reproduces the problem correctly, then
> there is no way to detect in Overview's dctor that
> connection is still valid.

Ok, but maybe the Even's idea of a boolean var set to TRUE in dataset
and to FALSE in overviews could be a good way to simulate this
situation.

>
> After Dataset dctor is called, the c pointer in Overview is a dangling
> pointer which stores an address in memory, but that address no longer
> identifies PGconn object.

Yes, that's exactly the problem. The memory address is still
allocated, but the content it's not a PGconn.

>
>> - Don't share the PGconn object. Should I declare a static PGconn
>> pointer?
>
> It would work just in the opposite direction - such static pointer would
> be shared. Concept of static object == concept of global object.
> They are used to implement shared resource, though in a weak and
> primitive way.
>

Yes, ok. I realized on a static object is a "shared" object, in the
sense of it's a global object. Bad words using, sorry.


>> What is the best approach?
>
> First, you have to identify if lifetime of Dataset and Overview (or
> Subdataset) is predictable - can Overview live longer than Dataset or
> lifetime of Dataset always exceeds lifetime of Overview object.
>
> 1. The Dataset always life longer is the simplest case, simply close
> connection only from Dataset and don't close it from Overview.
> In other words, Overview's connection is a weak reference [1] to
> connection in Dataset - meaning, Dataset is the only owner of connection.

Yes, that's the situation. I'll finish the connection only from the
dataset, using the boolean var Even suggested, I think.

>
> [1] http://en.wikipedia.org/wiki/Weak_reference
>
> 2. However, if Overview object can live longer than Dataset
> or moreover, you are not able to determine/predict what's
> possible lifetime of Dataset and Overview, then IMHO the best
> approach is to make PGconn a real shared object between Dataset
> and Overview.
>
> The simplest implementation is to use shared_ptr<T> from
> std::tr1 (in GCC 4.3+ or Visual C++ 9.0+) or from Boost libraries.
> However, I presume these are forbidden in GDAL, so you'd need to provide
> some minimal implementation of reference counting pattern on your own.
> Scott Meyers' example may be helpful:
> http://www.aristeia.com/BookErrata/M29Source.html


Thanks for the links (added to delicious :-)) and for your analysis
and solutions.

Best regards,
Jorge

>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
From mateusz at loskot.net  Sun Aug  2 09:54:52 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Aug  2 09:54:59 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <cb4457700908020633gf506efcp25a150bb0e9eedaa@mail.gmail.com>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com>
	<4A6FDAA7.1020903@pobox.com>
	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com>
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com>
	<4A758BC7.8080802@loskot.net>
	<cb4457700908020633gf506efcp25a150bb0e9eedaa@mail.gmail.com>
Message-ID: <4A759AAC.5050108@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> 2009/8/2 Mateusz Loskot <mateusz@loskot.net>:
>> Jorge Ar?valo wrote:
>>> When I create an overview (a children dataset), its properties are
>>> the same properties of the general dataset (his parent), apart from
>>> pixel size, table name and column_name, of course. The problem
>>> appears when sharing the PGconn object.
>>>
>>> My code looks like this:
>>>
>>> poDS->overview[i]->hPGconn = poDS->hPGconn
>>>
>>> If each dataset's destructor (from the general one and from the
>>> overviews) calls PQfinish over the same object, I get a segmentation
>>> fault after the first time, of course. So, I have 2 options: - Detect
>>> when a connection object has been freed, and perform only one call.
>>> How should I do this?
>> If I understand it correctly, the problem can be summarised in some
>> kind of pseudo-code as follows:
>>
>> struct Overview
>> {
>>   PGconn* c;
>>   Overview(PGconn* c) : c(c) {}
>>   ~Overview() { PQfinish(c); }
>>
>> };
>>
>> struct Dataset
>> {
>>   PGconn* c;
>>   Dataset(char const* connstr) { /*connect to pgsql*/ }
>>   ~Dataset() {  PQfinish(c) ; c = 0; }
>>   Overview get_overview() { return Overview(c); }
>> };
>>
>>
>> {
>>   Overview ov;
>>   {
>>      Dataset d(...); // connect
>>      ov = d.get_overview(); // side-effect: share connection
>>   }  // Dataset dctor calls PQfinish
>>
>>   // Problem #1: Overview's connection no longer valid
>> } // Problem #2: Overview dctor tries to close and fails
>>
>> Note: Overview here may be a subdataset, no difference between the two
>> for the problem analysis.
> 
> Yes, the problem looks like that.
> 
>> Assuming this example reproduces the problem correctly, then
>> there is no way to detect in Overview's dctor that
>> connection is still valid.
> 
> Ok, but maybe the Even's idea of a boolean var set to TRUE in dataset
> and to FALSE in overviews could be a good way to simulate this
> situation.

Sure, it is but as long as you're confident that you
can determine who's the base - master dataset/overview/subdataset.

Clearly I lack of details and I've not read your code.
Thus, I may have been able to see the issue only partially,
so can't see & suggest best option.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jorge.arevalo at gmail.com  Sun Aug  2 10:13:27 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  2 10:13:49 2009
Subject: [gdal-dev] Re: [SoC] GDAL WKTRaster weekly report #9
In-Reply-To: <4A759AAC.5050108@loskot.net>
References: <cb4457700907260323n25c80a6dxae52f5fd2994d051@mail.gmail.com> 
	<4A6FDAA7.1020903@pobox.com>
	<cb4457700907310904h1a8136e5jaa671e5eb26d0f87@mail.gmail.com> 
	<200907312041.48228.even.rouault@mines-paris.org>
	<cb4457700908020456k125399feib97bdf01aafcf9fe@mail.gmail.com> 
	<4A758BC7.8080802@loskot.net>
	<cb4457700908020633gf506efcp25a150bb0e9eedaa@mail.gmail.com> 
	<4A759AAC.5050108@loskot.net>
Message-ID: <cb4457700908020713h6f3c6ef1ra2c85a229789a3c5@mail.gmail.com>

2009/8/2 Mateusz Loskot <mateusz@loskot.net>:
> Jorge Ar?valo wrote:
>> Hello,
>>
>> 2009/8/2 Mateusz Loskot <mateusz@loskot.net>:
>>> Jorge Ar?valo wrote:
>>>> When I create an overview (a children dataset), its properties are
>>>> the same properties of the general dataset (his parent), apart from
>>>> pixel size, table name and column_name, of course. The problem
>>>> appears when sharing the PGconn object.
>>>>
>>>> My code looks like this:
>>>>
>>>> poDS->overview[i]->hPGconn = poDS->hPGconn
>>>>
>>>> If each dataset's destructor (from the general one and from the
>>>> overviews) calls PQfinish over the same object, I get a segmentation
>>>> fault after the first time, of course. So, I have 2 options: - Detect
>>>> when a connection object has been freed, and perform only one call.
>>>> How should I do this?
>>> If I understand it correctly, the problem can be summarised in some
>>> kind of pseudo-code as follows:
>>>
>>> struct Overview
>>> {
>>> ? PGconn* c;
>>> ? Overview(PGconn* c) : c(c) {}
>>> ? ~Overview() { PQfinish(c); }
>>>
>>> };
>>>
>>> struct Dataset
>>> {
>>> ? PGconn* c;
>>> ? Dataset(char const* connstr) { /*connect to pgsql*/ }
>>> ? ~Dataset() { ?PQfinish(c) ; c = 0; }
>>> ? Overview get_overview() { return Overview(c); }
>>> };
>>>
>>>
>>> {
>>> ? Overview ov;
>>> ? {
>>> ? ? ?Dataset d(...); // connect
>>> ? ? ?ov = d.get_overview(); // side-effect: share connection
>>> ? } ?// Dataset dctor calls PQfinish
>>>
>>> ? // Problem #1: Overview's connection no longer valid
>>> } // Problem #2: Overview dctor tries to close and fails
>>>
>>> Note: Overview here may be a subdataset, no difference between the two
>>> for the problem analysis.
>>
>> Yes, the problem looks like that.
>>
>>> Assuming this example reproduces the problem correctly, then
>>> there is no way to detect in Overview's dctor that
>>> connection is still valid.
>>
>> Ok, but maybe the Even's idea of a boolean var set to TRUE in dataset
>> and to FALSE in overviews could be a good way to simulate this
>> situation.
>
> Sure, it is but as long as you're confident that you
> can determine who's the base - master dataset/overview/subdataset.
>
> Clearly I lack of details and I've not read your code.
> Thus, I may have been able to see the issue only partially,
> so can't see & suggest best option.

Anyway, things are more clear now, many thanks. Your analysis is valid
for my situation.

Best regards,
Jorge

>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
From jorge.arevalo at gmail.com  Sun Aug  2 17:46:51 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  2 17:47:13 2009
Subject: [gdal-dev] GDAL WKT Raster driver weekly report #10
Message-ID: <cb4457700908021446q3921649dmdadeef3cf255c0f@mail.gmail.com>

Hello,

Here, the report:
http://www.gis4free.org/blog/2009/08/02/gsoc-09-weekly-report-10-2407-3107/

Here, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards,
Jorge
From agnesyipck at gmail.com  Mon Aug  3 02:05:48 2009
From: agnesyipck at gmail.com (agnes123)
Date: Mon Aug  3 02:05:50 2009
Subject: [Gdal-dev] default pixel size in gdalwarp
In-Reply-To: <4A6FDE51.6020505@pobox.com>
References: <1248780631116-3341802.post@n2.nabble.com>
	<4A6FDE51.6020505@pobox.com>
Message-ID: <1249279548614-3376077.post@n2.nabble.com>


Frank,

Thanks for your reply.

Do you know if python can use the function  GDALSuggestedWarpOutput2() ? I
searched on web and found only the C/C++ examples.

Regards,
Agnes






Frank Warmerdam wrote:
> 
> agnes123 wrote:
>> 
>> Dear all,
>> 
>> i have one question on the default pixel size in gdalwarp. 
>> 
>> In gdalwarp, we can use -tr to determine output pixel size in x and y
>> direction, however, if i omit the argument -tr , gdal will have a default
>> pixel size value which is in target projection units. 
>> 
>> For example, if the orginal input raster which has geodetic projection
>> with
>> pixel size 0.000277778 (decimal degree), after projecting to Lambert
>> Conformal Conic without typing the argument -tr, gdal will have output
>> raster pixel size 28.793808m. What is the algorithm behind to obtain the
>> value 28.793808? 
>> 
>> I was wondering if there is somebody who knows it. I would greatly
>> appreciate it.Thanks!
>> 
>> Regards,
>> Agnes
>> 
> 
> Agnes,
> 
> The computation is done by the GDALSuggestedWarpOutput2() function.  I
> would
> suggest you read it's documentation and if still in doubt scan through the
> code.
> 
>   
> http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdaltransformer.cpp#L162
> 
> It is basically a heuristic to maintain approximately the same diagonal
> size of a pixel in the destination coordinate system as it was in the
> source coordinate system.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/default-pixel-size-in-gdalwarp-tp3341802p3376077.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From piva at meeo.it  Mon Aug  3 03:21:55 2009
From: piva at meeo.it (Giacomo Piva)
Date: Mon Aug  3 03:28:39 2009
Subject: [gdal-dev] Area intersection
Message-ID: <4A769013.3020000@meeo.it>

Hi All,
I'm trying to get georeferencing information from a GeoTIFF file in 
order to find if there is an intersection between two images.
Does someone can help me in this stuff?
What should i do?

Thanks.

-- 
Giacomo Piva



From piva at meeo.it  Mon Aug  3 08:31:52 2009
From: piva at meeo.it (Giacomo Piva)
Date: Mon Aug  3 08:32:07 2009
Subject: [gdal-dev] Area intersection
In-Reply-To: <4A769013.3020000@meeo.it>
References: <4A769013.3020000@meeo.it>
Message-ID: <4A76D8B8.6020405@meeo.it>

I found some useful instruction on how to use the GDALGetGeoTransform() 
function to get the affine transformation coefficients and how use them, 
but now, I need to get the UTM time zone too.

Does someone can help me?

> Hi All,
> I'm trying to get georeferencing information from a GeoTIFF file in 
> order to find if there is an intersection between two images.
> Does someone can help me in this stuff?
> What should i do?
>
> Thanks.
>


From BCassanova at weather.com  Mon Aug  3 08:56:31 2009
From: BCassanova at weather.com (Cassanova, Bill)
Date: Mon Aug  3 08:59:45 2009
Subject: [gdal-dev] Area intersection
In-Reply-To: <4A769013.3020000@meeo.it>
References: <4A769013.3020000@meeo.it>
Message-ID: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0650C@ATLMAIL01.corp.weather.com>

Hi Giacoma,

Check out OGRGeometry for the intersection related methods:

http://www.gdal.org/ogr/classOGRGeometry.html



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Giacomo Piva
Sent: Monday, August 03, 2009 3:22 AM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] Area intersection

Hi All,
I'm trying to get georeferencing information from a GeoTIFF file in 
order to find if there is an intersection between two images.
Does someone can help me in this stuff?
What should i do?

Thanks.

-- 
Giacomo Piva



_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From piva at meeo.it  Mon Aug  3 09:02:39 2009
From: piva at meeo.it (Giacomo Piva)
Date: Mon Aug  3 09:02:42 2009
Subject: [gdal-dev] Area intersection
In-Reply-To: <4A76DE3D.9020008@zmaw.de>
References: <4A769013.3020000@meeo.it> <4A76D8B8.6020405@meeo.it>
	<4A76DE3D.9020008@zmaw.de>
Message-ID: <4A76DFEF.4050702@meeo.it>

I know, but I'm writing a C application and I need to get it by code.
> You can display it with gdalinfo 'filename'
>   

-- 
Giacomo Piva


From warmerdam at pobox.com  Mon Aug  3 10:30:47 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug  3 10:31:08 2009
Subject: [Gdal-dev] default pixel size in gdalwarp
In-Reply-To: <1249279548614-3376077.post@n2.nabble.com>
References: <1248780631116-3341802.post@n2.nabble.com>
	<4A6FDE51.6020505@pobox.com> <1249279548614-3376077.post@n2.nabble.com>
Message-ID: <4A76F497.6000708@pobox.com>

agnes123 wrote:
> Frank,
> 
> Thanks for your reply.
> 
> Do you know if python can use the function  GDALSuggestedWarpOutput2() ? I
> searched on web and found only the C/C++ examples.

Agnes,

I am unaware of it being SWIG wrapped, so the answer appears to be no.
It is indirectly available via AutoCreateWarpedVRT() which uses it to
create a virtual warped file.  In theory you could call that, and then
query it to find the geotransform and pixel/line size then destroy it
without ever actually using it to do any data warping.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Mon Aug  3 12:07:33 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Aug  3 12:07:56 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
Message-ID: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com>

Hello,

Why GDALRasterBlock definition doesn't appear in the GDAL class list
at http://www.gdal.org/annotated.html ?

I'm trying to implement a cache-block system for GDAL WKT Raster
driver, but I'm not sure if I should use this class. Maybe is
deprecated?

Thanks in advance

Best regards,
Jorge
From even.rouault at mines-paris.org  Mon Aug  3 14:12:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug  3 14:12:22 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
In-Reply-To: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com>
References: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com>
Message-ID: <200908032012.11279.even.rouault@mines-paris.org>

Le Monday 03 August 2009 18:07:33 Jorge Ar?valo, vous avez ?crit?:
> Hello,
>
> Why GDALRasterBlock definition doesn't appear in the GDAL class list
> at http://www.gdal.org/annotated.html ?

Technical reason : It would just require to add a missing line
//! Raster block
before
class CPL_DLL GDALRasterBlock
in gcore/gdal_priv.h

More realistic reason : very few methods of GDALRasterBlock are properly 
documented + the fact it is a very internal thing that only interest GDAL 
developers themselves, not GDAL API users and very few GDAL driver 
developers.

>
> I'm trying to implement a cache-block system for GDAL WKT Raster
> driver, but I'm not sure if I should use this class. Maybe is
> deprecated?

It's not deprecated : it is actively used by GDALRasterBand.

But I'm not sure what/why you want to do about block caching for WKT raster 
driver. Is this a harddisk block caching or a RAM block caching ? If it's RAM 
block caching, you don't need to do anything as it is the purpose of the 
GDALRasterBlock/GDALRasterBand and doesn't require to write code to benefit 
from it.

Here's a synthesis of how it works :
The GDALRasterBand object has an array of pointers to blocks (papoBlocks). 
Initially, all the pointers are set to NULL.  When a GDALRasterIO() / 
GDALDatasetRasterIO() is issued, the default implementation in 
GDALRasterBand::IRasterIO() in gcore/rasterio.cpp will divide the requested 
source window into a list of blocks matching the block size of the band. It 
will call the GetLockedBlockRef() method of GDALRasterBand to see if there's 
already a matching block stored in papoBlocks. If yes, fine : the caller will 
fetch the pixel buffer from the cached block. If not, it will call the 
IReadBlock() method on the band (your implementation in WKTRaster driver for 
example) and will store the resulting buffer in a new GDALRasterBlock object 
(the cached pixel buffer is allocated by GDALRasterBlock::Internalize()). 
This object will be chained to other previously cached GDALRasterBlock (the 
cache is global to all the opened datasets, and that's one of the tricky 
point of the implementation : safe use in multithreading context). When there 
are too many cached blocks in RAM, GDALRasterBlock::Internalize(), through 
GDALFlushCacheBlock(), can evict the least recently used blocks from the list 
and nullify their corresponding entries into the papoBlocks array of their 
rasterbands. When a dataset is closed and its raster band destroyed or 
flushed, all the non-NULL blocks in papoBlocks will be flushed. I described 
here a read scenario, but it only works for a write scenario. Each block has 
a dirty flag to know if it must be written with IWriteBlock() before being 
deleted.

>
> Thanks in advance
>
> Best regards,
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Mon Aug  3 14:26:28 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug  3 14:26:46 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
In-Reply-To: <200908032012.11279.even.rouault@mines-paris.org>
References: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com>
	<200908032012.11279.even.rouault@mines-paris.org>
Message-ID: <4A772BD4.5030503@pobox.com>

Even Rouault wrote:
> Le Monday 03 August 2009 18:07:33 Jorge Ar?valo, vous avez ?crit :
>> Hello,
>>
>> Why GDALRasterBlock definition doesn't appear in the GDAL class list
>> at http://www.gdal.org/annotated.html ?
> 
> Technical reason : It would just require to add a missing line
> //! Raster block
> before
> class CPL_DLL GDALRasterBlock
> in gcore/gdal_priv.h
> 
> More realistic reason : very few methods of GDALRasterBlock are properly 
> documented + the fact it is a very internal thing that only interest GDAL 
> developers themselves, not GDAL API users and very few GDAL driver 
> developers.

Jorge,

Even is right; however, I have committed a few changes so parts of the
class are now documented.  It should appear on the web site within a
few hours.

>> I'm trying to implement a cache-block system for GDAL WKT Raster
>> driver, but I'm not sure if I should use this class. Maybe is
>> deprecated?
> 
> It's not deprecated : it is actively used by GDALRasterBand.
> 
> But I'm not sure what/why you want to do about block caching for WKT raster 
> driver. Is this a harddisk block caching or a RAM block caching ? If it's RAM 
> block caching, you don't need to do anything as it is the purpose of the 
> GDALRasterBlock/GDALRasterBand and doesn't require to write code to benefit 
> from it.

Jorge - are you wanting to push extra values from pixel interleaved blocks
into the block cache?  This is one of the few reasons a driver would need to
interact with the block cache directly.

This is done in a few drivers.  You might want to use the
PNGRasterBand::IReadBlock() method in gdal/frmts/png/pngdataset.cpp
as an example.

In this implementation accessing a block (scanline) causes it to get
loaded into a buffer on the dataset class, and then the IReadBlock picks
out the part of that pixel intereleaved scanline that are needed for
the band requested.

But - since the scanline is loaded it also calls GetLockedBlockRef() on
the other bands to force IReadBlock() to be called on them and the
block cache items for them to be filled in.   You can use a similar
approach in the WKTRasterBlock driver if you have it maintain a concept
of a currently loaded block - likely at the dataset level - and have
the IReadBlocks operate from that.

There are other approaches too, but I can't think of any examples, so
I'd suggest you follow the pattern in pngdataset.cpp.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Mon Aug  3 18:13:29 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Aug  3 18:13:52 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
In-Reply-To: <4A772BD4.5030503@pobox.com>
References: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com> 
	<200908032012.11279.even.rouault@mines-paris.org>
	<4A772BD4.5030503@pobox.com>
Message-ID: <cb4457700908031513u23a07246h66be3ca6de86db24@mail.gmail.com>

Hello,

On Mon, Aug 3, 2009 at 8:26 PM, Frank Warmerdam<warmerdam@pobox.com> wrote:
> Even Rouault wrote:
>>
>> Le Monday 03 August 2009 18:07:33 Jorge Ar?valo, vous avez ?crit :
>>>
>>> Hello,
>>>
>>> Why GDALRasterBlock definition doesn't appear in the GDAL class list
>>> at http://www.gdal.org/annotated.html ?
>>
>> Technical reason : It would just require to add a missing line
>> //! Raster block
>> before
>> class CPL_DLL GDALRasterBlock
>> in gcore/gdal_priv.h
>>
>> More realistic reason : very few methods of GDALRasterBlock are properly
>> documented + the fact it is a very internal thing that only interest GDAL
>> developers themselves, not GDAL API users and very few GDAL driver
>> developers.
>
> Jorge,
>
> Even is right; however, I have committed a few changes so parts of the
> class are now documented. ?It should appear on the web site within a
> few hours.

Ok, I can see http://www.gdal.org/classGDALRasterBlock.html. But I'm
not updating the last changes on official GDAL tree, of course.

>
>>> I'm trying to implement a cache-block system for GDAL WKT Raster
>>> driver, but I'm not sure if I should use this class. Maybe is
>>> deprecated?
>>
>> It's not deprecated : it is actively used by GDALRasterBand.
>>
>> But I'm not sure what/why you want to do about block caching for WKT
>> raster driver. Is this a harddisk block caching or a RAM block caching ? If
>> it's RAM block caching, you don't need to do anything as it is the purpose
>> of the GDALRasterBlock/GDALRasterBand and doesn't require to write code to
>> benefit from it.
>
> Jorge - are you wanting to push extra values from pixel interleaved blocks
> into the block cache? ?This is one of the few reasons a driver would need to
> interact with the block cache directly.
>
> This is done in a few drivers. ?You might want to use the
> PNGRasterBand::IReadBlock() method in gdal/frmts/png/pngdataset.cpp
> as an example.
>
> In this implementation accessing a block (scanline) causes it to get
> loaded into a buffer on the dataset class, and then the IReadBlock picks
> out the part of that pixel intereleaved scanline that are needed for
> the band requested.
>
> But - since the scanline is loaded it also calls GetLockedBlockRef() on
> the other bands to force IReadBlock() to be called on them and the
> block cache items for them to be filled in. ? You can use a similar
> approach in the WKTRasterBlock driver if you have it maintain a concept
> of a currently loaded block - likely at the dataset level - and have
> the IReadBlocks operate from that.
>
> There are other approaches too, but I can't think of any examples, so
> I'd suggest you follow the pattern in pngdataset.cpp.
>

I'm trying to consider this situation: In each IReadBlock call, I need
to perform a spatial query to get a block (or several blocks, in case
on irregular blocking). This, as Tamas suggested, is a "non-optimal"
solution. If I understood the excelent Even's explanation in the last
mail, IReadBlock calls are performed via IRasterIO -->
GetRasterBlockRef (always?) as the "worst solution" if the portion
(block) needed is not cached.

At present, my "best solution" is IReadBlock method, because this
method is always called when reading data from raster. My point is to
override the IRasterIO method to avoid extra calls to IReadBlock.
Maybe I can perform an only spatial query to read all the extent
required by the client (even the whole raster), instead of one query
per block. Is this point correct?

If yes, if I understood Even, again, the method to store blocks in RAM
is ?automatic? I mean, calling GDALRasterBlock::Internalize with each
new block, all the blocks fetched by the big spatial query are chained
in the cache system.

Best regards,
Jorge

> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From jorge.arevalo at gmail.com  Mon Aug  3 18:23:41 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Aug  3 18:24:04 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
In-Reply-To: <200908032012.11279.even.rouault@mines-paris.org>
References: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com> 
	<200908032012.11279.even.rouault@mines-paris.org>
Message-ID: <cb4457700908031523kb3a45d3w7b4be1e8f364925f@mail.gmail.com>

Hello,

2009/8/3 Even Rouault <even.rouault@mines-paris.org>:
> Le Monday 03 August 2009 18:07:33 Jorge Ar?valo, vous avez ?crit?:
>> Hello,
>>
>> Why GDALRasterBlock definition doesn't appear in the GDAL class list
>> at http://www.gdal.org/annotated.html ?
>
> Technical reason : It would just require to add a missing line
> //! Raster block
> before
> class CPL_DLL GDALRasterBlock
> in gcore/gdal_priv.h
>
> More realistic reason : very few methods of GDALRasterBlock are properly
> documented + the fact it is a very internal thing that only interest GDAL
> developers themselves, not GDAL API users and very few GDAL driver
> developers.
>
>>
>> I'm trying to implement a cache-block system for GDAL WKT Raster
>> driver, but I'm not sure if I should use this class. Maybe is
>> deprecated?
>
> It's not deprecated : it is actively used by GDALRasterBand.
>
> But I'm not sure what/why you want to do about block caching for WKT raster
> driver. Is this a harddisk block caching or a RAM block caching ? If it's RAM
> block caching, you don't need to do anything as it is the purpose of the
> GDALRasterBlock/GDALRasterBand and doesn't require to write code to benefit
> from it.
>

The simplest caching system. Then, I suppose RAM caching system. I
simply want to avoid one call to IReadBlock ( = 1 spatial query) for
each block of needed data.


> Here's a synthesis of how it works :
> The GDALRasterBand object has an array of pointers to blocks (papoBlocks).
> Initially, all the pointers are set to NULL. ?When a GDALRasterIO() /
> GDALDatasetRasterIO() is issued, the default implementation in
> GDALRasterBand::IRasterIO() in gcore/rasterio.cpp will divide the requested
> source window into a list of blocks matching the block size of the band. It
> will call the GetLockedBlockRef() method of GDALRasterBand to see if there's
> already a matching block stored in papoBlocks. If yes, fine : the caller will
> fetch the pixel buffer from the cached block. If not, it will call the
> IReadBlock() method on the band (your implementation in WKTRaster driver for
> example) and will store the resulting buffer in a new GDALRasterBlock object
> (the cached pixel buffer is allocated by GDALRasterBlock::Internalize()).

Understood until here.

> This object will be chained to other previously cached GDALRasterBlock (the
> cache is global to all the opened datasets, and that's one of the tricky
> point of the implementation : safe use in multithreading context).

I have a doubt here. What is exactly the "cache system"? Each
RasterBand has its own array of GDALRasterBlocks, but this array is
local to the Band, not global to all the datasets. So, this array of
chained blocks on each band can't be the "cache system"...


> When there are too many cached blocks in RAM, GDALRasterBlock::Internalize(), through
> GDALFlushCacheBlock(), can evict the least recently used blocks from the list
> and nullify their corresponding entries into the papoBlocks array of their
> rasterbands. When a dataset is closed and its raster band destroyed or
> flushed, all the non-NULL blocks in papoBlocks will be flushed. I described
> here a read scenario, but it only works for a write scenario. Each block has
> a dirty flag to know if it must be written with IWriteBlock() before being
> deleted.
>

So, in a read scenario, the cache blocks are simply deleted when
closing the dataset. In a pure read scenario, you don't really need to
flush blocks, because they aren't modified. Am I right?

Many thanks for the GREAT explanation.

Best regards,
Jorge

>>
>> Thanks in advance
>>
>> Best regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
From jorge.arevalo at gmail.com  Mon Aug  3 18:25:47 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Aug  3 18:26:10 2009
Subject: [gdal-dev] Where is GDALRasterBlock documentation?
In-Reply-To: <cb4457700908031513u23a07246h66be3ca6de86db24@mail.gmail.com>
References: <cb4457700908030907t6eda1941vf9b7054c3dcaf437@mail.gmail.com> 
	<200908032012.11279.even.rouault@mines-paris.org>
	<4A772BD4.5030503@pobox.com> 
	<cb4457700908031513u23a07246h66be3ca6de86db24@mail.gmail.com>
Message-ID: <cb4457700908031525g1d309b66of91170ebc09441eb@mail.gmail.com>

Hello,

2009/8/4 Jorge Ar?valo <jorge.arevalo@gmail.com>:
> Hello,
>
> On Mon, Aug 3, 2009 at 8:26 PM, Frank Warmerdam<warmerdam@pobox.com> wrote:
>> Even Rouault wrote:
>>>
>>> Le Monday 03 August 2009 18:07:33 Jorge Ar?valo, vous avez ?crit :
>>>>
>>>> Hello,
>>>>
>>>> Why GDALRasterBlock definition doesn't appear in the GDAL class list
>>>> at http://www.gdal.org/annotated.html ?
>>>
>>> Technical reason : It would just require to add a missing line
>>> //! Raster block
>>> before
>>> class CPL_DLL GDALRasterBlock
>>> in gcore/gdal_priv.h
>>>
>>> More realistic reason : very few methods of GDALRasterBlock are properly
>>> documented + the fact it is a very internal thing that only interest GDAL
>>> developers themselves, not GDAL API users and very few GDAL driver
>>> developers.
>>
>> Jorge,
>>
>> Even is right; however, I have committed a few changes so parts of the
>> class are now documented. ?It should appear on the web site within a
>> few hours.
>
> Ok, I can see http://www.gdal.org/classGDALRasterBlock.html. But I'm
> not updating the last changes on official GDAL tree, of course.
>
>>
>>>> I'm trying to implement a cache-block system for GDAL WKT Raster
>>>> driver, but I'm not sure if I should use this class. Maybe is
>>>> deprecated?
>>>
>>> It's not deprecated : it is actively used by GDALRasterBand.
>>>
>>> But I'm not sure what/why you want to do about block caching for WKT
>>> raster driver. Is this a harddisk block caching or a RAM block caching ? If
>>> it's RAM block caching, you don't need to do anything as it is the purpose
>>> of the GDALRasterBlock/GDALRasterBand and doesn't require to write code to
>>> benefit from it.
>>
>> Jorge - are you wanting to push extra values from pixel interleaved blocks
>> into the block cache? ?This is one of the few reasons a driver would need to
>> interact with the block cache directly.
>>
>> This is done in a few drivers. ?You might want to use the
>> PNGRasterBand::IReadBlock() method in gdal/frmts/png/pngdataset.cpp
>> as an example.
>>
>> In this implementation accessing a block (scanline) causes it to get
>> loaded into a buffer on the dataset class, and then the IReadBlock picks
>> out the part of that pixel intereleaved scanline that are needed for
>> the band requested.
>>
>> But - since the scanline is loaded it also calls GetLockedBlockRef() on
>> the other bands to force IReadBlock() to be called on them and the
>> block cache items for them to be filled in. ? You can use a similar
>> approach in the WKTRasterBlock driver if you have it maintain a concept
>> of a currently loaded block - likely at the dataset level - and have
>> the IReadBlocks operate from that.
>>
>> There are other approaches too, but I can't think of any examples, so
>> I'd suggest you follow the pattern in pngdataset.cpp.
>>
>
> I'm trying to consider this situation: In each IReadBlock call, I need
> to perform a spatial query to get a block (or several blocks, in case
> on irregular blocking). This, as Tamas suggested, is a "non-optimal"
> solution. If I understood the excelent Even's explanation in the last
> mail, IReadBlock calls are performed via IRasterIO -->
> GetRasterBlockRef (always?) as the "worst solution" if the portion
> (block) needed is not cached.
>
> At present, my "best solution" is IReadBlock method, because this
> method is always called when reading data from raster. My point is to
> override the IRasterIO method to avoid extra calls to IReadBlock.
> Maybe I can perform an only spatial query to read all the extent
> required by the client (even the whole raster), instead of one query
> per block. Is this point correct?
>
> If yes, if I understood Even, again, the method to store blocks in RAM
> is ?automatic? I mean, calling GDALRasterBlock::Internalize with each
> new block, all the blocks fetched by the big spatial query are chained
> in the cache system.

Ok, reading a Tamas' mail I see the way to add a block to the cache is
by AdoptBlock, in RasterBand class. I suppose this method will call
GDALRasterBlock::Internalize

>
> Best regards,
> Jorge
>
>> Best regards,
>> --
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up ? | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
From agnesyipck at gmail.com  Mon Aug  3 20:33:06 2009
From: agnesyipck at gmail.com (agnes123)
Date: Mon Aug  3 20:33:09 2009
Subject: [Gdal-dev] default pixel size in gdalwarp
In-Reply-To: <4A76F497.6000708@pobox.com>
References: <1248780631116-3341802.post@n2.nabble.com>
	<4A6FDE51.6020505@pobox.com>
	<1249279548614-3376077.post@n2.nabble.com>
	<4A76F497.6000708@pobox.com>
Message-ID: <1249345986517-3381564.post@n2.nabble.com>


Dear Frank,

Thank you very much!

By the way, is there any smaple scripts on how to use the
AutoCreateWarpedVRT() in python?

Regards,
Agnes


Frank Warmerdam wrote:
> 
> agnes123 wrote:
>> Frank,
>> 
>> Thanks for your reply.
>> 
>> Do you know if python can use the function  GDALSuggestedWarpOutput2() ?
>> I
>> searched on web and found only the C/C++ examples.
> 
> Agnes,
> 
> I am unaware of it being SWIG wrapped, so the answer appears to be no.
> It is indirectly available via AutoCreateWarpedVRT() which uses it to
> create a virtual warped file.  In theory you could call that, and then
> query it to find the geotransform and pixel/line size then destroy it
> without ever actually using it to do any data warping.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/default-pixel-size-in-gdalwarp-tp3341802p3381564.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From Gary.Smart at goodrich.com  Tue Aug  4 09:33:35 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Tue Aug  4 09:33:44 2009
Subject: [gdal-dev] Converting coordinates (easting/Northing to WGS84
	Lat/Long)
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3E4BA6A@nhc2ex11.goodrich.root.local>

I am still having problems using the geo-transformation utilities in
GDAL.

 

I don't suppose anyone managed to identify why the following code always
refuses to create a OGRCoordinateTransformation for me? 

 

The code below is an excerpt from code I use to open geotiffs and
extract geocoords.  However, although I can extract geocoords as
Eastings/Northings, I cannot then convert them to WGS84 lat/long
(essential for my purpose).  I am running this on linux SUSE-10 SP2.

 

Can anyone help?

 

// g++ -Wno-deprecated -m64 -g -o georef georef.c++ -lgdal -lm

#include "/usr/local/src/FWTools-2.0.6/include/gdal.h"
#include "/usr/local/src/FWTools-2.0.6/include/gdal_priv.h"
#include "/usr/local/src/FWTools-2.0.6/include/ogr_spatialref.h"
/* Following output is from the MapServer tutorial
...data/raster/shdrlfi020l_ugl.tif file.  This file opens
   fine in 'openev' and gives easting/northing readouts OK.
Driver: GTiff/GeoTIFF
Projection is `'
Origin = (176371.000000,548761.000000)
Pixel Size = (1000.000000,-1000.000000)
ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.
!!!Cannot create transform from input file georef space to WGS84
*/
/*  Following output is from a geotiff file that also works fine with
'openev'.
Driver: GTiff/GeoTIFF
Projection is `PROJCS["TM
D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke
1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["E
PSG","6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AU
THORITY["EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["lat
itude_of_origin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scal
e_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],
UNIT["metre",1,AUTHORITY["EPSG","9001"]]]'
Origin = (138586.280052,3768995.081326)
Pixel Size = (50.000000,-50.000000)
ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.
!!!Cannot create transform from input file georef space to WGS84
*/
int main(int argc, char **argv)
{
  GDALDataset  *poDataset;

  GDALAllRegister();

  poDataset = (GDALDataset *) GDALOpen( argv[1], GA_ReadOnly );
  if( poDataset == NULL )
  {
    fprintf(stderr, "!!!poDataset was NULL\n");
    exit(-1);
  }
  double adfGeoTransform[6];

  printf( "Driver: %s/%s\n",
          poDataset->GetDriver()->GetDescription(), 
          poDataset->GetDriver()->GetMetadataItem( GDAL_DMD_LONGNAME )
);

  if( poDataset->GetProjectionRef()  != NULL )
      printf( "Projection is `%s'\n", poDataset->GetProjectionRef() );

  if( poDataset->GetGeoTransform( adfGeoTransform ) == CE_None )
  {
      printf( "Origin = (%.6f,%.6f)\n",
              adfGeoTransform[0], adfGeoTransform[3] );

      printf( "Pixel Size = (%.6f,%.6f)\n",
              adfGeoTransform[1], adfGeoTransform[5] );
  }

  // We have to convert from native input file 
  // geospace to our standard WGS84 space so create a transform here.

  // First create a spatial reference in the input space
  OGRSpatialReference iref;
  const char *proj_ref = poDataset->GetProjectionRef();
  char *tmp = NULL;
  if (proj_ref)
  {
    tmp = (char *)malloc(strlen(proj_ref)+1);
    iref.importFromWkt(&tmp);

    // Create a spatial reference in WGS88 lat/long space and
    // create a transform object betseen input and output space
    OGRSpatialReference oref;
    oref.SetWellKnownGeogCS("WGS84");
    OGRCoordinateTransformation *coord_transform
      = OGRCreateCoordinateTransformation(&iref, &oref);
    if (!coord_transform)
    {
      fprintf(stderr, "!!!FAILED! Cannot create transform from input
file "
              "georef space to WGS84\n");

    } // end case default
    free(tmp);

  } // end if got projection ref

} // end main
 

 

Gary 

________________________________

From: Smart, Gary 
Sent: 21 July 2009 08:46
To: 'gdal-dev@lists.osgeo.org'
Cc: 'Martin Chapman'
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Yes I have the gdalinfo - it seems happy enough with the files I am
experimenting with.  I'm not sure what 'proj' is supposed to do and
can't find any info on it - but it is in my path and runs?

 

I have attached a small extract from my ever failing code - it compiles
and runs.  Perhaps someone could tell me what's wrong.  It seems to fail
to set up a coord transform for any file, even though openev happily
deals with them.  I can't help feeling that there is something decidedly
dodgy about the way I prime the transform with the 'importFromWkt call.
Perhaps the transform is never getting the transform string at all?

 

I also noticed that one of the map tif files from the mapserver tutorial
doesn't return any projection info fro mthe getProjectionRef call - will
this cause problems when trying to set up a transformation in future.

 

The files I used, and the response they give, are included in the
attachment as comments.

 

Gary 

________________________________

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: 20 July 2009 22:46
To: Smart, Gary
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Gary,

 

I tried the projection string in some of my code and it worked fine.  I
stepped through the gdal code and proj4 loaded the transform object ok
too which means the projection string is fine and that your environment
suffers from one of the following:

 

1.    Proj.dll cannot be found in the path on your machine or is not in
the same directory as gdal.dll and is failing when gdal calls
LoadLibrary() on "proj.dll".

2.   The proj.dll can be found but a dependency like the nad shift files
or gdal data cannot be found.

 

I would try the following:

 

1.   Use gdalinfo.exe that should come with fwtools or can be downloaded
from gdal.org and run the command gdalinfo.exe - formats and or
ogrinfo.exe -formats.

2.   See if the output from that command gives any useful information on
why proj is failing.

3.   From the command line type in proj.exe and see if the proj util can
be found in your path.  If it can be found then maybe it will give some
useful info.

 

Sorry I am not more help than that but the projection string is valid.

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 8:50 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Thanks Martin, but now to the next problem...

 

I downloaded PRROJ.4 which seemed to configure and compile OK.

Having set the PROJ_LIB as you proposed, I now get:

 

ERROR 1: No PROJ.4 translation for source SRS, coordinate transformation
initialization has failed.

 

I guess I am still missing comething.  The failure came from the same
geotiff file as below.

 

I also couldn't find a 'data dir' in the GDAL source and therefore
GDAL_DATA env var remained unset.  We installed everything from the
FWTools download for our Linux SUSE10 system.  Should there be a 'data'
directory under the FWTools directory somewhere?  There is no GDAL
source in this directory - just include files and libraries.  I presumed
this was all that was needed to use GDAL?   

 

________________________________

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: 20 July 2009 14:49
To: Smart, Gary; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

Gary,

 

Set your paths like such on startup or as an environment variable:

 

GDAL_DATA points at the data dir that comes with gdal source.

PROJ_LIB point to the nad directory that you download from proj4
website.

 

string env = string("GDAL_DATA=") + dataPath;

_putenv(env.c_str());

env = string("PROJ_LIB=") + nadPath;

_putenv(env.c_str());

 

and / or

 

CPLSetConfigOption("GDAL_DATA", dataPath.c_str());

CPLSetConfigOption("PROJ_LIB", nadPath.c_str());

 

Martin

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Smart, Gary
Sent: Monday, July 20, 2009 7:38 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] Converting raster pixel space to geospace

 

 

 

OK - I can get it to compile and not crash instantly (bonanza!)

 

However, when I try to create the OGR transform using importFromWkt, 

I get the following:

 

ERROR 6: Unable to load PROJ.4 library (libproj.so), creation of

OGRCoordinateTransformation failed.

 

Does anyone know what this means?  Is there some part of OGR/GDAL I have
yet to install?

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090804/71041e6b/attachment-0001.html
From piva at meeo.it  Tue Aug  4 09:52:16 2009
From: piva at meeo.it (Giacomo Piva)
Date: Tue Aug  4 09:52:19 2009
Subject: [gdal-dev] Area intersection
In-Reply-To: <1D5F4E64B8C04F4C868B94AC9A532AF80AD0650C@ATLMAIL01.corp.weather.com>
References: <4A769013.3020000@meeo.it>
	<1D5F4E64B8C04F4C868B94AC9A532AF80AD0650C@ATLMAIL01.corp.weather.com>
Message-ID: <4A783D10.7020606@meeo.it>

Hi Bill,
First of all, thanks for your reply.
It seems ti be what I'm looking for, but unfortunately I have some 
problems with documentation.

In OGRGeometry class I foud this two methods:

OGRGeometry::Intersects
OGRGeometry::Intersection

As I said I'm working to a C application, so I shall use these functions:

OGR_G_Intersects()
OGR_G_Intersection()

But I found a reference only for the OGR_G_Intersects() function...

Furthermore, I cannot understand HOW to create two geometry from a 
geo-referenced image.
Someone can help me?


> Check out OGRGeometry for the intersection related methods:
>
> http://www.gdal.org/ogr/classOGRGeometry.html
>
>
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Giacomo Piva
> Sent: Monday, August 03, 2009 3:22 AM
> To: gdal-dev@lists.osgeo.org
> Subject: [gdal-dev] Area intersection
>
> Hi All,
> I'm trying to get georeferencing information from a GeoTIFF file in 
> order to find if there is an intersection between two images.
> Does someone can help me in this stuff?
> What should i do?
>
> Thanks.
>
>   


-- 
Giacomo Piva

MEEO S.r.l.
Via Saragat 9
I-44122 Ferrara, Italy
Tel: +39 0532 1861501
Fax: +39 0532 1861637
http://www.meeo.it

========================================
"ATTENZIONE:le informazioni contenute in questo messaggio sono
da considerarsi confidenziali ed il loro utilizzo ? riservato unicamente
al destinatario sopra indicato. Chi dovesse ricevere questo messaggio
per errore ? tenuto ad informare il mittente ed a rimuoverlo
definitivamente da ogni supporto elettronico o cartaceo."

"WARNING:This message contains confidential and/or proprietary
information which may be subject to privilege or immunity and which
is intended for use of its addressee only. Should you receive this
message in error, you are kindly requested to inform the sender and
to definitively remove it from any paper or electronic format." 

From warmerdam at pobox.com  Tue Aug  4 11:02:20 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug  4 11:03:45 2009
Subject: [gdal-dev] Converting coordinates (easting/Northing to WGS84
	Lat/Long)
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3E4BA6A@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3E4BA6A@nhc2ex11.goodrich.root.local>
Message-ID: <4A784D7C.7000807@pobox.com>

Smart, Gary wrote:
> I am still having problems using the geo-transformation utilities in GDAL.
...
> // g++ -Wno-deprecated -m64 -g -o georef georef.c++ -lgdal -lm
> 
> #include "/usr/local/src/FWTools-2.0.6/include/gdal.h"
> #include "/usr/local/src/FWTools-2.0.6/include/gdal_priv.h"
> #include "/usr/local/src/FWTools-2.0.6/include/ogr_spatialref.h"

Gary,

You are including include files from FWTools, but building 64bit -
presumably linking against your own locally built libraries.  This
is a very risky practice.

Have you built and install PROJ.4?  If not, creation of transformation
objects will not work, though there should be some sort of error message
issued.

Also in the comments you write:

/* Following output is from the MapServer tutorial 
...data/raster/shdrlfi020l_ugl.tif file.  This file opens
    fine in 'openev' and gives easting/northing readouts OK.
Driver: GTiff/GeoTIFF
Projection is `'
Origin = (176371.000000,548761.000000)
Pixel Size = (1000.000000,-1000.000000)
ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.
!!!Cannot create transform from input file georef space to WGS84
*/

Well, the above geotiff has no coordinate system so it is impossible
to determine how to convert to WGS84.

/*  Following output is from a geotiff file that also works fine with 'openev'.
Driver: GTiff/GeoTIFF
Projection is `PROJCS["TM 
D-01",GEOGCS["NAD27",DATUM["North_American_Datum_1927",SPHEROID["Clarke 
1866",6378206.4,294.9786982139006,AUTHORITY["EPSG","7008"]],AUTHORITY["EPSG","6267"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","4267"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-124.5],PARAMETER["scale_factor",1],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]]]'
Origin = (138586.280052,3768995.081326)
Pixel Size = (50.000000,-50.000000)
ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.
!!!Cannot create transform from input file georef space to WGS84
*/

In this case the source coordinate system is well defined so it is
not entirely clear to me why you get the message "No PROJ.4 translation
for source SRS".  I tried running the above srs myself locally and it
worked fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Shawn.Gong at drdc-rddc.gc.ca  Tue Aug  4 16:31:32 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Tue Aug  4 16:51:40 2009
Subject: [gdal-dev] NITF Jpeg 2000 read support for GeoEye-1
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E9C1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E9C1@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA30@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I have GeoEye-1 data in NITF 2.1 with Jpeg 2000 compression, that needs
to be viewed in OpenEV. I need to build gdal Jpeg 2000 read support.

Kakadu doesn't seem to be suitable as we need to redistribute software
(for non-commercial use). Kakadu needs each end user to purchase
license. Please correct me if I am wrong.

What are the other choices, JP2ECW or JP2MrSID? I downloaded JP2ECW
source. Its Windows project files are rather old (MS VC6).
Would someone share your build experience?  I need to build on Windows
(compiler is Visual Studio 2005/2008) and Linux.

thanks,
Shawn


partial Gdalinfo output:
Driver: NITF/National Imagery Transmission Format
Files: ...ntf
Size is 9376, 28778
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AUTHORITY["EPSG","4326"]]
GeoTransform =
  -91.43197048929174, -5.898666666666618e-005, -3.474997393722632e-008
  74.58324254794314, -1.599999999984929e-007, 1.506411370191595e-005
Metadata:
  NITF_FHDR=NITF02.10
  NITF_CLEVEL=06
  NITF_STYPE=BF01
  NITF_OSTAID=UNIL
  NITF_FDT= ..
  NITF_FTITLE=_..
  NITF_FSCLAS=U
  NITF_FSCLSY=US
  NITF_FSCODE=
  NITF_FSCTLH=0
  NITF_FSREL=
  NITF_USE00A_ANGLE_TO_NORTH= ..
  NITF_USE00A_MEAN_GSD= ..
  NITF_USE00A_DYNAMIC_RANGE= ..
  NITF_USE00A_OBL_ANG=14.37
  NITF_STDIDC_ACQUISITION_DATE= ..
  NITF_STDIDC_MISSION=OV05
  NITF_STDIDC_PASS=01
  NITF_STDIDC_OP_NUM=000
  NITF_STDIDC_START_SEGMENT=AA
  NITF_STDIDC_REPRO_NUM=00
  NITF_STDIDC_REPLAY_REGEN=000
  NITF_STDIDC_START_COLUMN=001
  NITF_STDIDC_START_ROW=00001
  NITF_STDIDC_END_SEGMENT=AA
  NITF_STDIDC_END_COLUMN=010
  NITF_STDIDC_END_ROW=00029
  NITF_STDIDC_COUNTRY=CA
  NITF_STDIDC_WAC=0036
  NITF_STDIDC_LOCATION= ..
  NITF_USE00A_ROLL_ANG=-08.22
  NITF_USE00A_N_REF=00
  NITF_USE00A_REV_NUM= ..
  NITF_USE00A_N_SEG=001
  NITF_USE00A_MAX_LP_SEG= ..
  NITF_USE00A_SUN_EL= ..
  NITF_USE00A_SUN_AZ= ..
  NITF_FSDCTP=
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090804/2a070840/attachment.html
From jhayes at lizardtech.com  Tue Aug  4 20:55:21 2009
From: jhayes at lizardtech.com (John Hayes)
Date: Tue Aug  4 20:55:27 2009
Subject: [gdal-dev] reprojection to WGS 1984 Web Mercator
Message-ID: <C55473998E248B4DAEC5342D698DFE85CE332CF5@sea-srv-mail.lizardtech.com>

Hi,
  I'm having problems warping an image to WGS 1984 Web Mercator.  The lat/long center point moved south by 10 arc-minutes.  Does anyone have some suggestion on how to fix this?

 I'm pretty sure the USA_Contiguous_Equidistant_Conic transform worked fine because I looked at the lag/long in Google Earth and saw the same buildings.

I've also done the transform in two steps Source SRS to WGS84 and WGS84 to WGS 1984 Web Mercator but get the same answer.

Bellow is the command line I used to warp the image and info dumps of the before and after images.

$ gdalwarp -t_srs ESRI::wm.prj Athens_RGB_CEC1FT_200303.tif Athens_RGB_CEC1FT_200303-wm.tif
Creating output file that is 7455P x 6882L.
Processing input file Athens_RGB_CEC1FT_200303.tif.
0...10...20...30...40...50...60...70...80...90...100 - done.

Files: Athens_RGB_CEC1FT_200303.tif
Size is 6683, 6024
Coordinate System is:
PROJCS["USA_Contiguous_Equidistant_Conic",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Equidistant_Conic"],
    PARAMETER["standard_parallel_1",33],
    PARAMETER["standard_parallel_2",45],
    PARAMETER["latitude_of_center",39],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (1157874.742488616100000,-478125.149393160190000)
Pixel Size = (0.169893858067214,-0.169893858067214)
Corner Coordinates:
Upper Left  ( 1157874.742, -478125.149) ( 83d24'42.40"W, 33d58'12.44"N)
Lower Left  ( 1157874.742, -479148.590) ( 83d24'47.89"W, 33d57'39.54"N)
Upper Right ( 1159010.143, -478125.149) ( 83d23'58.53"W, 33d58'7.37"N)
Lower Right ( 1159010.143, -479148.590) ( 83d24'4.02"W, 33d57'34.47"N)
Center      ( 1158442.443, -478636.870) ( 83d24'23.21"W, 33d57'53.46"N)

Files: Athens_RGB_CEC1FT_200303-wm.tif
Size is 7455, 6882
Coordinate System is:
PROJCS["WGS_1984_Web_Mercator",
    GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",
        DATUM["WGS_1984_Major_Auxiliary_Sphere",
            SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-9285526.535261498800000,4000908.274406374400000)
Pixel Size = (0.204760916615493,-0.204760916615493)
Corner Coordinates:
Upper Left  (-9285526.535, 4000908.274) ( 83d24'47.89"W, 33d47'31.24"N)
Lower Left  (-9285526.535, 3999499.110) ( 83d24'47.89"W, 33d46'53.36"N)
Upper Right (-9284000.043, 4000908.274) ( 83d23'58.53"W, 33d47'31.24"N)
Lower Right (-9284000.043, 3999499.110) ( 83d23'58.53"W, 33d46'53.36"N)
Center      (-9284763.289, 4000203.692) ( 83d24'23.21"W, 33d47'12.30"N)






-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090804/3299ef82/attachment-0001.html
From Sjur.A.Kolberg at sintef.no  Wed Aug  5 03:13:17 2009
From: Sjur.A.Kolberg at sintef.no (Sjur Kolberg)
Date: Wed Aug  5 03:14:24 2009
Subject: [gdal-dev] RE: reprojection to WGS 1984 Web Mercator
In-Reply-To: <C55473998E248B4DAEC5342D698DFE85CE332CF5@sea-srv-mail.lizardtech.com>
References: <C55473998E248B4DAEC5342D698DFE85CE332CF5@sea-srv-mail.lizardtech.com>
Message-ID: <72251B925CE10A478606EEAC6AA683BE112D930A8F@SINTEFEXMBX01.sintef.no>

John,

This looks like the kind of north/south error you get when the transform gets the ellipsoids wrong, with most serious displacement if a one of the ellipsoids is a sphere.

I am guessing that your transform ignores the ellipsoid change, try see what you get if you specify GRS 1980 also in your target CS. You can use cs2cs on single points to check the transform.

Also, verify that 6378137 is the proper Earth radius both for your sphere and for the GRS80 spheroid, this is usually not the case.

Sorry I couldnt pinpoint he exact command to solve, it's too long since I dealt with these issues :-)

Sjur



________________________________
From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of John Hayes
Sent: 5 august 2009 02:55
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] reprojection to WGS 1984 Web Mercator

Hi,
  I'm having problems warping an image to WGS 1984 Web Mercator.  The lat/long center point moved south by 10 arc-minutes.  Does anyone have some suggestion on how to fix this?

 I'm pretty sure the USA_Contiguous_Equidistant_Conic transform worked fine because I looked at the lag/long in Google Earth and saw the same buildings.

I've also done the transform in two steps Source SRS to WGS84 and WGS84 to WGS 1984 Web Mercator but get the same answer.

Bellow is the command line I used to warp the image and info dumps of the before and after images.

$ gdalwarp -t_srs ESRI::wm.prj Athens_RGB_CEC1FT_200303.tif Athens_RGB_CEC1FT_200303-wm.tif
Creating output file that is 7455P x 6882L.
Processing input file Athens_RGB_CEC1FT_200303.tif.
0...10...20...30...40...50...60...70...80...90...100 - done.

Files: Athens_RGB_CEC1FT_200303.tif
Size is 6683, 6024
Coordinate System is:
PROJCS["USA_Contiguous_Equidistant_Conic",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Equidistant_Conic"],
    PARAMETER["standard_parallel_1",33],
    PARAMETER["standard_parallel_2",45],
    PARAMETER["latitude_of_center",39],
    PARAMETER["longitude_of_center",-96],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (1157874.742488616100000,-478125.149393160190000)
Pixel Size = (0.169893858067214,-0.169893858067214)
Corner Coordinates:
Upper Left  ( 1157874.742, -478125.149) ( 83d24'42.40"W, 33d58'12.44"N)
Lower Left  ( 1157874.742, -479148.590) ( 83d24'47.89"W, 33d57'39.54"N)
Upper Right ( 1159010.143, -478125.149) ( 83d23'58.53"W, 33d58'7.37"N)
Lower Right ( 1159010.143, -479148.590) ( 83d24'4.02"W, 33d57'34.47"N)
Center      ( 1158442.443, -478636.870) ( 83d24'23.21"W, 33d57'53.46"N)

Files: Athens_RGB_CEC1FT_200303-wm.tif
Size is 7455, 6882
Coordinate System is:
PROJCS["WGS_1984_Web_Mercator",
    GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",
        DATUM["WGS_1984_Major_Auxiliary_Sphere",
            SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-9285526.535261498800000,4000908.274406374400000)
Pixel Size = (0.204760916615493,-0.204760916615493)
Corner Coordinates:
Upper Left  (-9285526.535, 4000908.274) ( 83d24'47.89"W, 33d47'31.24"N)
Lower Left  (-9285526.535, 3999499.110) ( 83d24'47.89"W, 33d46'53.36"N)
Upper Right (-9284000.043, 4000908.274) ( 83d23'58.53"W, 33d47'31.24"N)
Lower Right (-9284000.043, 3999499.110) ( 83d23'58.53"W, 33d46'53.36"N)
Center      (-9284763.289, 4000203.692) ( 83d24'23.21"W, 33d47'12.30"N)






-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090805/b77985cc/attachment.html
From kohain8 at yahoo.com.cn  Wed Aug  5 04:27:24 2009
From: kohain8 at yahoo.com.cn (kohain)
Date: Wed Aug  5 04:27:25 2009
Subject: [Gdal-dev] How to find the count of subdatasets of a HDF file?
Message-ID: <1249460844440-3389927.post@n2.nabble.com>


How to find the count of subdatasets of a HDF file?
and how to ascertain band counts of each subdataset?

I'm using GDAL to read hdf4 files,but i don't know the particular usage.

-- 
View this message in context: http://n2.nabble.com/How-to-find-the-count-of-subdatasets-of-a-HDF-file--tp3389927p3389927.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090805/7534122a/attachment.html
From bartvde at osgis.nl  Wed Aug  5 06:29:56 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Wed Aug  5 06:30:14 2009
Subject: [gdal-dev] SDE connection string problem with 1.6.1?
Message-ID: <27466.145.50.39.11.1249468196.squirrel@webmail.hostingdiscounter.nl>

Hi list,

it seems the layer part of an SDE connection string is not picked up
anymore. We're using GDAL 1.6.1. Did anybody else experience this?

E.g.:

ogrinfo
SDE:geodatabase.ad.rws.nl,5151,5151,RWS_LEZEN,****,WEGEN.WEGEN_NWB_LIGHT

lists all tables and not only the one specified.

TIA.

Best regards,
Bart

From nicolas.simon at spw.wallonie.be  Wed Aug  5 08:54:58 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Wed Aug  5 08:55:07 2009
Subject: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B619@DGA-EXC01.mrw.wallonie.int>

Dear developpers, 

This problem is not actually well handled when we use feature with 2D and 3D coordinate.
(I provide test file with  Ticket #3025)  

1) When we WRITE data into Oracle, TranslateTOSDOGeometry() and TranslateElemGroup()
   use nDimension member variable of OCIWritableLayer to handle the translation.
   Unfortunaly nDimension initisation is
   nDimension = MAX(2,MIN(3,atoi(CPLGetConfigOption("OCI_DEFAULT_DIM","3"))));
   which is good when creating layer but not if we update feature table and
   if we have different feature table with different dimension 
   (OCI_DEFAULT_DIM cannot be set to handle both 2D and 3D simultanously). 

   The solution is to query ALL_SDO_GEOM_METADATA to get the dimension of existing table and
   overwrite the default value.

   The best place I found to put this check is in OGROCITableLayer::ReadTableDefinition() because it does not concern OGROCILoaderLayer.

   I attach the patch to Ticket #3025  (file is OCIWrite3025.diff )
    
2) When we READ data from Oracle, TranslateGeometry() and TranslateGeometryElement() take the dimension
   from Gtype of the SDO_GEOMETRY (That's right).
The dimension is well used in decoding sdo_ordinates (see GetOrdinalPoint for exemple).
The problem is when we create OGRGeometry because it always construct 3D geometry even if we have 2D geometry. 

For exemple (in TranslateGeometryElement())

    ...
    double dfX, dfY, dfZ = 0.0;

    GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ );

    poPoint->setX( dfX );
    poPoint->setY( dfY );
    poPoint->setZ( dfZ ); 

 Many strategies exist to fix this problem.

The simplest one is to force to 2D if dimension = 2 before returning from TranslateGeometry() but this solution does a lot of extra work (building a dummy 3D and deleting the 3rd dimension)

To apply this solution a call to Flatten2D maintains the Z dimention but set it to 0. Not the solution I would like => Bad solution

An other way is to call setCoordinateDimension() but the doc says "Setting the dimension of a geometry collection will not necessarily affect the children geometries.". Not a definitive solution.

My conclusion is that I should insert test on dimension when creating the geometry to prevent the cretion of a 3rd dimension.

For exemple (in TranslateGeometryElement())

    ...
    double dfX, dfY, dfZ = 0.0;

    GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ );

    poPoint->setX( dfX );
    poPoint->setY( dfY );
    if ( nDimension>2 ) poPoint->setZ( dfZ ); 

If you agree with this last strategie, I would provide a patch with this kind of test for all geometries created in TranslateGeometry() 

    Note: The test "nDimension>2" seems beter than "nDimension=3" because if SDO_GEOMETRY is 4 (permitted), we will generate a 3D OGRGeometry insteed of a 2D. 

    Best regards,

    Nicolas

================================================== 
Nicolas Simon, Informaticien 
Service Public de Wallonie (SPW)
Direction g?n?rale op?rationnelle Agriculture, Ressources Naturelles et Environnement (DGARNE)
D?partement des Aides
Direction de l'Octroi des Aides agricoles - Service Informatique
14, Chauss?e de Louvain - 4e ?tage 
5000 Namur 
BELGIUM 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090805/c9731752/attachment-0001.html
From spbhasker at gmail.com  Wed Aug  5 10:15:27 2009
From: spbhasker at gmail.com (spbhasker bachi)
Date: Wed Aug  5 10:15:49 2009
Subject: [gdal-dev] GDALCreateTPSTransformer :: Problem
Message-ID: <2b5309940908050715u105c7fafrc78ea63f075e18a0@mail.gmail.com>

Using Gdal Latest 1.6.1

Whenever i pass this Function my Application is Passing..

Any source on the Usage will be Helpful..

///my Gcpcount = 32 and gcps has an array loaded with Source and Target
GCP's

poTransform = GDALCreateTPSTransformer( GCPCount, gcps , 0   );
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090805/4fb730ef/attachment.html
From stefan.moebius at actix.com  Wed Aug  5 11:59:01 2009
From: stefan.moebius at actix.com (Stefan Moebius)
Date: Wed Aug  5 12:00:07 2009
Subject: [gdal-dev] Question on OGR handle types
Message-ID: <4A79AC45.7070407@actix.com>

Hi,

In May 2008, a couple of changes where made to improve type checking.

See http://lists.osgeo.org/pipermail/gdal-dev/2008-May/017059.html
http://trac.osgeo.org/gdal/changeset/14435
http://trac.osgeo.org/gdal/changeset/14441

Our code is using the function

OGRCoordinateTransformation* OGRCreateCoordinateTransformation
	(OGRSpatialReference * poSource,
	 OGRSpatialReference * poTarget)

and with the upgrade from 1.5 to 1.6, we now cannot properly destroy the 
OGRCoordinateTransformation anymore (at least in debug mode).

The documentation of that create function says:

> Create transformation object.
> 
> This is the same as the C function OCTNewCoordinateTransformation().
> 
> Input spatial reference system objects are assigned by copy (calling clone() method) and no ownership transfer occurs.
> 
> The delete operator, or OCTDestroyCoordinateTransformation() should be used to destroy transformation objects.

As we are linking the GDAL dynamically, using delete is not really an option 
as we cannot predict what heap was used to create the object. The destroy 
function, however, requires a parameter of type 
OGRCoordinateTransformationH, which we cannot cleanly cast to anymore for 
that change mentioned at the beginning.

What are we missing here? How is this supposed to be used?

Any help is appreciated.

Regards,
Stefan

-- 
Stefan M?bius
Development Manager

Actix GmbH
Altmarkt 10
01067 Dresden
Germany

T +49 351 40429 17
www.actix.com
From JAMES.E.HOPPER at saic.com  Wed Aug  5 12:13:32 2009
From: JAMES.E.HOPPER at saic.com (jim hopper)
Date: Wed Aug  5 12:29:45 2009
Subject: [gdal-dev] CPPFLAGS?
In-Reply-To: <20090805125509.880D5E00B4F@lists.osgeo.org>
Message-ID: <C69F27EC.FA15%james.e.hopper@saic.com>

I was trying to build gdal and noticed that setting CFLAGS is not enough as
you also need CPPFLAGS for the c++ code, fair enough.  But some places (the
one I found is in gcore and frmts/ilwis) this is not handled correctly.  In
gcore this appears correct


CPPFLAGS    :=    $(GDAL_INCLUDE) $(CPPFLAGS) $(PAM_SETTING)

However,  this isnt used in the GNUMakefile instead its CXXFLAGS that is
used in the make as shown below, shouldn't that be CPPFLAGS?

gdaldrivermanager.o:    gdaldrivermanager.cpp ../GDALmake.opt
    $(CXX) -c $(GDAL_INCLUDE) $(CXXFLAGS) -DINST_DATA=\"$(INST_DATA)\" \
        $*.cpp -o $*.o

There appear to other places that use CXXFLAGS

 frmts/GNUmakefile
 frmts/grib/GNUmakefile
frmts/grib/GNUmakefile
frmts/grib/GNUmakefile
frmts/grib/GNUmakefile
frmts/jp2kak/GNUmakefile
frmts/sdts/GNUmakefile
gcore/GNUmakefile
 port/GNUmakefile
 pymod/GNUmakefile

In iLwin CPPFLAGS ignores the existing CPPFLAGS and sets it like this:

CPPFLAGS    =    $(GDAL_INCLUDE)

Shouldn't this be 

CPPFLAGS    :=    $(GDAL_INCLUDE) $(CPPFLAGS)


Best jim


From anssisamuli at gmail.com  Wed Aug  5 13:49:37 2009
From: anssisamuli at gmail.com (ilumas)
Date: Wed Aug  5 13:49:40 2009
Subject: [Gdal-dev] gdalwarp, proj4 and Space Oblique Mercator problem
Message-ID: <1249494577908-3393778.post@n2.nabble.com>


Dear all,

I'm trying to re-project a USGS Landsat 5 scene with Space Oblique Mercator
projection with the following command:

gdalwarp -s_srs  '+proj=lsat +lsat=5 +path=188'  -t_srs EPSG:2393 input.tif
output.tif
 
For some reason this fails:

ERROR 1: Translating source or target SRS failed:
+proj=lsat +lsat=5 +path=188

even though my proj -lp lists the lsat projection and the parametrization
seems appropriate to me (see below).

Any idea what's wrong and how could I solve this? 

Cheers,

ilumas


--8< from http://download.osgeo.org/proj/proj.4.3.pdf ---8< ----

landsat C E S I 
+proj=lsat
+lsat=n
+path=p

This projection (not shown) is for use with landsat
satellite data and is a limited form of the more general
Space Oblique Mercator projection. The landsat satellite
number, n, must be in the range 1?5 and the path
number, p, must be in the ranges 1?251 for n = 1, 2, 3 or
1?233 for n = 3, 4.

--8< from http://download.osgeo.org/proj/proj.4.3.pdf ---8< ----

tmp> proj -lp |grep lsat
lsat : Space oblique for LANDSAT

tmp> proj 
Rel. 4.4.9, 29 Oct 2004

tmp> uname -a

Linux 2.6.13-15.11-smp #2 SMP Fri Jul 28 11:01:31 EEST 2006 x86_64 x86_64
x86_64 GNU/Linux

-------  hdr file for the input ------


-- 
View this message in context: http://n2.nabble.com/gdalwarp%2C-proj4-and-Space-Oblique-Mercator-problem-tp3393778p3393778.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From warmerdam at pobox.com  Wed Aug  5 14:17:22 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug  5 14:17:33 2009
Subject: [Gdal-dev] gdalwarp, proj4 and Space Oblique Mercator problem
In-Reply-To: <1249494577908-3393778.post@n2.nabble.com>
References: <1249494577908-3393778.post@n2.nabble.com>
Message-ID: <4A79CCB2.8090304@pobox.com>

ilumas wrote:
> Dear all,
> 
> I'm trying to re-project a USGS Landsat 5 scene with Space Oblique Mercator
> projection with the following command:
> 
> gdalwarp -s_srs  '+proj=lsat +lsat=5 +path=188'  -t_srs EPSG:2393 input.tif
> output.tif
>  
> For some reason this fails:
> 
> ERROR 1: Translating source or target SRS failed:
> +proj=lsat +lsat=5 +path=188
> 
> even though my proj -lp lists the lsat projection and the parametrization
> seems appropriate to me (see below).
> 
> Any idea what's wrong and how could I solve this? 

Ilumas,

The problem is that the OGRSpatialReference class does not understand
space oblique mercator.  I am not aware of any way of reprojecting
space oblique mercator images with gdalwarp without implementing
support for space oblique mercator in the OGRSpatialReference class.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Wed Aug  5 14:24:12 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug  5 14:24:18 2009
Subject: [gdal-dev] Question on OGR handle types
References: <4A79AC45.7070407@actix.com>
Message-ID: <6D17B8E2B6354C8680670679F484DB2A@PCZORGLUB>

Stefan,

Why are you so much afraid about using cast ? ;-) This is probably the
easiest solution for you :
OGRCoordinateTransformation* poCT =
OGRCreateCoordinateTransformation(poSRS1, poSRS2);
OCTDestroyCoordinateTransformation( (OGRCoordinateTransformationH) poCT);

No worry to have. It's exactly the kind of casts done in GDAL/OGR C API
wrappers to call the C++ API.
For example :

OGRCoordinateTransformationH CPL_STDCALL OCTNewCoordinateTransformation(
  OGRSpatialReferenceH hSourceSRS, OGRSpatialReferenceH hTargetSRS )
{
  return (OGRCoordinateTransformationH)
    OGRCreateCoordinateTransformation(   (OGRSpatialReference *) hSourceSRS,
(OGRSpatialReference *) hTargetSRS );
}

void CPL_STDCALL OCTDestroyCoordinateTransformation(
OGRCoordinateTransformationH hCT )
{
  delete (OGRCoordinateTransformation *) hCT;
}

Otherwise, as you've noted, the stricter typing is only enforced when DEBUG
is defined.
So your code should compile without any change if you don't define DEBUG.

The fundamental issue in fact is that you're mixing use of C++ API and C
API.
A pure C solution would be to use the pair
OCTNewCoordinateTransformation()/OCTDestroyCoordinateTransformation().
For the C++ part, we could argue there's a lack of a static void
OGRCoordinateTransformation::Destroy(OGRCoordinateTransformation*) method
to avoid using the delete operator, which can be an issue on Windows.

----- Original Message ----- 
From: "Stefan Moebius" <stefan.moebius@actix.com>
To: <gdal-dev@lists.osgeo.org>
Sent: Wednesday, August 05, 2009 5:59 PM
Subject: [gdal-dev] Question on OGR handle types


> Hi,
>
> In May 2008, a couple of changes where made to improve type checking.
>
> See http://lists.osgeo.org/pipermail/gdal-dev/2008-May/017059.html
> http://trac.osgeo.org/gdal/changeset/14435
> http://trac.osgeo.org/gdal/changeset/14441
>
> Our code is using the function
>
> OGRCoordinateTransformation* OGRCreateCoordinateTransformation
> (OGRSpatialReference * poSource,
> OGRSpatialReference * poTarget)
>
> and with the upgrade from 1.5 to 1.6, we now cannot properly destroy the 
> OGRCoordinateTransformation anymore (at least in debug mode).
>
> The documentation of that create function says:
>
>> Create transformation object.
>>
>> This is the same as the C function OCTNewCoordinateTransformation().
>>
>> Input spatial reference system objects are assigned by copy (calling 
>> clone() method) and no ownership transfer occurs.
>>
>> The delete operator, or OCTDestroyCoordinateTransformation() should be 
>> used to destroy transformation objects.
>
> As we are linking the GDAL dynamically, using delete is not really an 
> option as we cannot predict what heap was used to create the object. The 
> destroy function, however, requires a parameter of type 
> OGRCoordinateTransformationH, which we cannot cleanly cast to anymore for 
> that change mentioned at the beginning.
>
> What are we missing here? How is this supposed to be used?
>
> Any help is appreciated.
>
> Regards,
> Stefan
>
> -- 
> Stefan M?bius
> Development Manager
>
> Actix GmbH
> Altmarkt 10
> 01067 Dresden
> Germany
>
> T +49 351 40429 17
> www.actix.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> 


From even.rouault at mines-paris.org  Wed Aug  5 14:25:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug  5 14:25:16 2009
Subject: [Gdal-dev] gdalwarp, proj4 and Space Oblique Mercator problem
References: <1249494577908-3393778.post@n2.nabble.com>
Message-ID: <D3456DBC7882420496DD191B8680455D@PCZORGLUB>

This projection is recognized by proj, but not by the GDAL module that
parses PROJ.4 strings into its OGC WKT model. I'm afraid there's nothing you
can do, apart from improving OGR to support this projection method and
posting the patch ;-)

Maybe a way of cheating could be to use a valid (and unrelated) OGC WKT
string and putting your proj4 string  into the EXTENSION parameter. See
http://www.gdal.org/ogr/classOGRSpatialReference.html#a20

Something like that might be worth trying (completely untested. No warranty) 
:
LOCAL_CS["unnamed",EXTENSION["PROJ4","+proj=lsat +lsat=5 +path=188 
+wktext"]]

----- Original Message ----- 
From: "ilumas" <anssisamuli@gmail.com>
To: <gdal-dev@lists.osgeo.org>
Sent: Wednesday, August 05, 2009 7:49 PM
Subject: [Gdal-dev] gdalwarp, proj4 and Space Oblique Mercator problem



Dear all,

I'm trying to re-project a USGS Landsat 5 scene with Space Oblique Mercator
projection with the following command:

gdalwarp -s_srs  '+proj=lsat +lsat=5 +path=188'  -t_srs EPSG:2393 input.tif
output.tif

For some reason this fails:

ERROR 1: Translating source or target SRS failed:
+proj=lsat +lsat=5 +path=188

even though my proj -lp lists the lsat projection and the parametrization
seems appropriate to me (see below).

Any idea what's wrong and how could I solve this?

Cheers,

ilumas


--8< from http://download.osgeo.org/proj/proj.4.3.pdf ---8< ----

landsat C E S I
+proj=lsat
+lsat=n
+path=p

This projection (not shown) is for use with landsat
satellite data and is a limited form of the more general
Space Oblique Mercator projection. The landsat satellite
number, n, must be in the range 1?5 and the path
number, p, must be in the ranges 1?251 for n = 1, 2, 3 or
1?233 for n = 3, 4.

--8< from http://download.osgeo.org/proj/proj.4.3.pdf ---8< ----

tmp> proj -lp |grep lsat
lsat : Space oblique for LANDSAT

tmp> proj
Rel. 4.4.9, 29 Oct 2004

tmp> uname -a

Linux 2.6.13-15.11-smp #2 SMP Fri Jul 28 11:01:31 EEST 2006 x86_64 x86_64
x86_64 GNU/Linux

-------  hdr file for the input ------


-- 
View this message in context: 
http://n2.nabble.com/gdalwarp%2C-proj4-and-Space-Oblique-Mercator-problem-tp3393778p3393778.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



From even.rouault at mines-paris.org  Wed Aug  5 14:40:16 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug  5 14:40:23 2009
Subject: [Gdal-dev] How to find the count of subdatasets of a HDF file?
References: <1249460844440-3389927.post@n2.nabble.com>
Message-ID: <D1CEC9319D8D46CA95EA74BC70E978BB@PCZORGLUB>


----- Original Message ----- 
From: kohain
To: gdal-dev@lists.osgeo.org
Sent: Wednesday, August 05, 2009 10:27 AM
Subject: [Gdal-dev] How to find the count of subdatasets of a HDF file?


>> How to find the count of subdatasets of a HDF file?

CSLCount(GDALGetMetadata(hDS, "SUBDATASETS")) / 2

The division by 2 is dueto each subdataset having 2 metadata items : 
SUBDATASET_xxx_NAME and SUBDATASET_xxx_DESC

See http://gdal.org/gdal_datamodel.html at "SUBDATASETS Domain" section

>> and how to ascertain band counts of each subdataset?

GDALOpen() each SUBDATASET_xxx_NAME  and call GDALGetRasterCount() on the 
result dataset handle.

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 


From even.rouault at mines-paris.org  Wed Aug  5 14:47:53 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug  5 14:48:00 2009
Subject: [gdal-dev] GDALCreateTPSTransformer :: Problem
References: <2b5309940908050715u105c7fafrc78ea63f075e18a0@mail.gmail.com>
Message-ID: <6938801E1CC74AC2B6682FF7EEEF147F@PCZORGLUB>

I can only point to the API documentation : 
http://gdal.org/gdal__alg_8h.html#a30
This is used by GDAL in 
http://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdaltransformer.cpp

----- Original Message ----- 
From: spbhasker bachi
To: gdal-dev@lists.osgeo.org
Sent: Wednesday, August 05, 2009 4:15 PM
Subject: [gdal-dev] GDALCreateTPSTransformer :: Problem


Using Gdal Latest 1.6.1

Whenever i pass this Function my Application is Passing..

Any source on the Usage will be Helpful..

///my Gcpcount = 32 and gcps has an array loaded with Source and Target 
GCP's

poTransform = GDALCreateTPSTransformer( GCPCount, gcps , 0   );








_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 


From jorge.arevalo at gmail.com  Wed Aug  5 14:51:20 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Aug  5 14:51:41 2009
Subject: [gdal-dev] How to compile dumpoverviews
Message-ID: <cb4457700908051151s723b914cvc9169b58570be11@mail.gmail.com>

Hello,

How should I compile GDAL to get "dumpoverviews" executable tool? I've
tested by "make all" in the apps directory, but I'm not sure if it's
the best way.

Anyway, after compiling it with "make all", I can't debug it. I add
--enable-debug option to configure script, but after executing "make
all",  ddd dumpoverviews returns an error:

not in executable format: File format not recognized

It's strange, because dumpoverviews has been created properly, and I
can execute it, but not debug it...

Suggestions?

Thanks in advance

Best regards,
Jorge
From warmerdam at pobox.com  Wed Aug  5 14:58:38 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug  5 14:58:52 2009
Subject: [gdal-dev] How to compile dumpoverviews
In-Reply-To: <cb4457700908051151s723b914cvc9169b58570be11@mail.gmail.com>
References: <cb4457700908051151s723b914cvc9169b58570be11@mail.gmail.com>
Message-ID: <4A79D65E.2060809@pobox.com>

Jorge Ar?valo wrote:
> Hello,
> 
> How should I compile GDAL to get "dumpoverviews" executable tool? I've
> tested by "make all" in the apps directory, but I'm not sure if it's
> the best way.
> 
> Anyway, after compiling it with "make all", I can't debug it. I add
> --enable-debug option to configure script, but after executing "make
> all",  ddd dumpoverviews returns an error:
> 
> not in executable format: File format not recognized
> 
> It's strange, because dumpoverviews has been created properly, and I
> can execute it, but not debug it...

Jorge,

Is this your first attempt to debug a gdal executable?  It should work
similarly to the others.

I suspect you are building with libtool and the gdal/apps/dumpoverviews
is just a script running the binary in the gdal/apps/.libs directory.  You
can try running gdal/apps/.libs/dumpoverviews in ddd, but that can be tricky
because library stuff might not be setup properly.

I suggest configuring --without-libtool and doing a clean build.  Libtool
is just a big pain in the butt while developing (IMHO).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jorge.arevalo at gmail.com  Wed Aug  5 15:35:18 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Aug  5 15:35:39 2009
Subject: [gdal-dev] How to compile dumpoverviews
In-Reply-To: <4A79D65E.2060809@pobox.com>
References: <cb4457700908051151s723b914cvc9169b58570be11@mail.gmail.com> 
	<4A79D65E.2060809@pobox.com>
Message-ID: <cb4457700908051235x523667damb72f1a286afd61e5@mail.gmail.com>

Hello,

2009/8/5 Frank Warmerdam <warmerdam@pobox.com>:
> Jorge Ar?valo wrote:
>>
>> Hello,
>>
>> How should I compile GDAL to get "dumpoverviews" executable tool? I've
>> tested by "make all" in the apps directory, but I'm not sure if it's
>> the best way.
>>
>> Anyway, after compiling it with "make all", I can't debug it. I add
>> --enable-debug option to configure script, but after executing "make
>> all", ?ddd dumpoverviews returns an error:
>>
>> not in executable format: File format not recognized
>>
>> It's strange, because dumpoverviews has been created properly, and I
>> can execute it, but not debug it...
>
> Jorge,
>
> Is this your first attempt to debug a gdal executable? ?It should work
> similarly to the others.

No, I've debugged gdalinfo and gdal_translate, for example.

>
> I suspect you are building with libtool and the gdal/apps/dumpoverviews
> is just a script running the binary in the gdal/apps/.libs directory. ?You
> can try running gdal/apps/.libs/dumpoverviews in ddd, but that can be tricky
> because library stuff might not be setup properly.
>
> I suggest configuring --without-libtool and doing a clean build. ?Libtool
> is just a big pain in the butt while developing (IMHO).
>

Ok, I think that's the reason. I disabled libtool for compiling after
you recommended me to do, but I'm using it again just now (I can't
remember why...). I'll disable it again.

Many thanks!

Best regards,
Jorge


> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
>
From Shawn.Gong at drdc-rddc.gc.ca  Wed Aug  5 17:12:29 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Wed Aug  5 17:32:38 2009
Subject: [gdal-dev] gdal build error on Windows with Jasper
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I downloaded the 2009-08-03 daily stable gdal and built on Windows using
MS VS 2005.
First I tried without Jasper and it went fine. After I uncommented these
lines:
		# Uncomment for JasPer based JPEG2000 support
		JASPER_DIR = C:\build2\jasper-1.900.1
		JASPER_INCLUDE = -I$(JASPER_DIR)\src\libjasper\include
-DJAS_WIN_MSVC_BUILD
		JASPER_LIB =
$(JASPER_DIR)\src\msvc\win32_release\libjasper.lib
		# Uncomment the following line if you have patched
UUID-enabled version
		# of JasPer from ftp://ftp.remotesensing.org/gdal/
		#JASPER_INCLUDE = $(JASPER_INCLUDE) -DHAVE_JASPER_UUID
and I got the linking error as below.  Would someone tell me why?

Jasper was downloaded from http://www.ece.uvic.ca/~mdadams/jasper/ and
built using the same MS VS 2005 (batch build its projects)


thanks,
Shawn



        cl /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
/D_CRT_NONSTDC_N
O_DEPRECATE /DNDEBUG -I..\port -I..\ogr -I..\gcore  -I..\alg
-I..\ogr\ogrsf_frmt
s  -DOGR_ENABLED  /c vb6_support.cpp
vb6_support.cpp
        cd ..
        if exist gdal.lib del gdal.lib
        lib /nologo /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj
frmts\o\*.obj
 ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib vb6\vb6_support.obj
ogrsf_frmts.lib(parsexsd.obj) : warning LNK4221: no public symbols
found; archiv
e member will be inaccessible
        link /nologo /dll /INCLUDE:_OGRFeatureStylePuller
/INCLUDE:_OSRValidate
  /INCLUDE:_OPTGetProjectionMethods  /INCLUDE:_OGR_G_GetPointCount
/INCLUDE:_OG
RRegisterAll /INCLUDE:_GDALSimpleImageWarp@36
/INCLUDE:_GDALReprojectImage@48
/INCLUDE:_GDALComputeMedianCutPCT@32  /INCLUDE:_GDALDitherRGB2PCT@28
/INCLUDE:_
OCTNewCoordinateTransformation@8 /INCLUDE:_vbSafeArrayToPtr@16
port\*.obj gcore\
*.obj alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib
ogr\ogr.lib vb6\vb
6_support.obj       odbc32.lib odbccp32.lib user32.lib
/LIBPATH:C:\build2\HDF4
1r5\lib Ws2_32.lib
C:\build2\jasper-1.900.1\src\msvc\win32_release\libjasper.li
b      C:\build2\netcdf-3.5.0\lib\netcdf.lib
C:\build2\proj-4.6.1\src\proj_i
.lib     C:\build2\HDF5-166-win-vs2005\dll\hdf5dll.lib
C:\build2\szip21\dll\szli
bdll.lib        gcore\Version.res  /out:gdal16.dll /implib:gdal_i.lib
LIBCMT.lib(dosmap.obj) : error LNK2005: __errno already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo
already defin
ed in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encoded_null already defined
in MSVC
RT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __decode_pointer already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __amsg_exit already defined in
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __initterm_e already defined in
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: _exit already defined in
MSVCRT.lib(MSV
CR80.dll)
LIBCMT.lib(crtheap.obj) : error LNK2005: __malloc_crt already defined in
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __unlock already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __lock already defined in
MSVCRT.lib(MSVC
R80.dll)
LIBCMT.lib(mbctype.obj) : error LNK2005: __getmbcp already defined in
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(setlocal.obj) : error LNK2005: _setlocale already defined in
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(winxfltr.obj) : error LNK2005: ___CppXcptFilter already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_a already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_z already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_a already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_z already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(hooks.obj) : error LNK2005: "void __cdecl terminate(void)"
(?terminat
e@@YAXXZ) already defined in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(calloc.obj) : error LNK2005: _calloc already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(realloc.obj) : error LNK2005: _realloc already defined in
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strftime.obj) : error LNK2005: _strftime already defined in
MSVCRT.li
b(MSVCR80.dll)
LIBCMT.lib(lconv.obj) : error LNK2005: _localeconv already defined in
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(getenv.obj) : error LNK2005: _getenv already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strnicmp.obj) : error LNK2005: __strnicmp already defined in
MSVCRT.l
ib(MSVCR80.dll)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __stricmp already defined in
LIBCMT.lib
(stricmp.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __strdup already defined in
LIBCMT.lib(
strdup.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __unlink already defined in
LIBCMT.lib(
unlink.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __close already defined in
LIBCMT.lib(c
lose.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __open already defined in
LIBCMT.lib(op
en.obj)
   Creating library gdal_i.lib and object gdal_i.exp
LINK : warning LNK4098: defaultlib 'MSVCRT' conflicts with use of other
libs; us
e /NODEFAULTLIB:library
LINK : warning LNK4098: defaultlib 'LIBCMT' conflicts with use of other
libs; us
e /NODEFAULTLIB:library
LIBCMT.lib(crt0.obj) : error LNK2019: unresolved external symbol _main
reference
d in function ___tmainCRTStartup
gdal16.dll : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio
8\VC\BIN\l
ink.EXE"' : return code '0x460'
Stop.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090805/5857f4ec/attachment-0001.html
From thob at dmu.dk  Thu Aug  6 10:27:46 2009
From: thob at dmu.dk (Becker, Thomas)
Date: Thu Aug  6 10:34:33 2009
Subject: [gdal-dev] applying datum change during export from OpenEv
Message-ID: <D4AB8C2051A3D1449495F8E45815E6000B2ADCF2ED@dmupost.dmu.dk>

Hi listers,

I have a couple of NOAA AMSU-A data of NOAA-15 to use and I saw the possibility in OpenEv to change the datum for a layer. I am wondering if the export function in OpenEv can be used to set up the ellipsoid and the datum for the NOAA AMSU-A data to achieve a correct GTiff from the *.eos files.

I guess this would be the easiest way to get the data into a GTiff because I have no clue how to create a GTiff from this input data using gdal_translate.

Thanks, Thomas		
From oliver.newman at baesystems.com  Thu Aug  6 11:27:24 2009
From: oliver.newman at baesystems.com (Ollie Newman)
Date: Thu Aug  6 11:27:25 2009
Subject: [Gdal-dev] GDAL seems unable to translate CIB data set
Message-ID: <1249572444161-3398950.post@n2.nabble.com>


I am having a problem accessing some CIB data using GDAL.  The dataset in
question is a 44544 by 56832 pixel image split across 1073 files and is 1m
resolution sat imagery.  The data will open OK in ArcMap so I am reasonably
confident that the data is not corrupted.  Using OpenEV I can open the
dataset but only the first tile and a bit has any data, the rest is blank.

gdal_translate fails wth the following errors

E:\CIB\RPF>gdal_translate -of GTiff NITF_TOC_ENTRY:CIB__1M_2_2:./a.toc
out.tif
Input file size is 44544, 56832
0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
Warning 1: For .\NI425J2\01LGBN2B.I42, assert
'fabs(adfGeoTransform[GEOTRSFRM_TOPLEFT_X] - nwLong) < 1e-10' failed ERROR
1: IReadBlock failed at X offset 0, Y offset 0 ERROR 1: GetBlockRef failed
at X block offset 0, Y block offset 0 <execution stops>

I am using the latest version of FWTools.  Using an earlier version
execution continued until the 1000 warning limit was hit and then continued
but no output image was created.

Has anyone any suggestions for me - options I might try or whether anyone
has seen this before?

Thanks in advance

Ollie
-- 
View this message in context: http://n2.nabble.com/GDAL-seems-unable-to-translate-CIB-data-set-tp3398950p3398950.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From warmerdam at pobox.com  Thu Aug  6 11:45:37 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  6 11:45:42 2009
Subject: [Gdal-dev] GDAL seems unable to translate CIB data set
In-Reply-To: <1249572444161-3398950.post@n2.nabble.com>
References: <1249572444161-3398950.post@n2.nabble.com>
Message-ID: <4A7AFAA1.1070007@pobox.com>

Ollie Newman wrote:
> I am having a problem accessing some CIB data using GDAL.  The dataset in
> question is a 44544 by 56832 pixel image split across 1073 files and is 1m
> resolution sat imagery.  The data will open OK in ArcMap so I am reasonably
> confident that the data is not corrupted.  Using OpenEV I can open the
> dataset but only the first tile and a bit has any data, the rest is blank.
> 
> gdal_translate fails wth the following errors
> 
> E:\CIB\RPF>gdal_translate -of GTiff NITF_TOC_ENTRY:CIB__1M_2_2:./a.toc
> out.tif
> Input file size is 44544, 56832
> 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> Warning 1: For .\NI425J2\01LGBN2B.I42, assert
> 'fabs(adfGeoTransform[GEOTRSFRM_TOPLEFT_X] - nwLong) < 1e-10' failed ERROR
> 1: IReadBlock failed at X offset 0, Y offset 0 ERROR 1: GetBlockRef failed
> at X block offset 0, Y block offset 0 <execution stops>

Ollie,

Can you make .\NI425J2\01LGBN2B.I42 available for inspection?  I imagine Even
will need to comment on the particulars of the RPFTOC driver - I see this
assertion is coming from it, not the NITF driver.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Shawn.Gong at drdc-rddc.gc.ca  Thu Aug  6 11:36:18 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Aug  6 11:56:27 2009
Subject: [gdal-dev] RE: gdal build error on Windows with Jasper
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA35@ottawaex02.Ottawa.drdc-rddc.gc.ca>

OK.  I solved the problem. It is a conflict between MSVCRT.lib (dynamic
lib) and LIBCMT.lib (static lib) while building JasPer. Just need to set
runtime lib to /MD.
Now Jasper-1.900.1.uuid is built into Gdal.

But I am still getting the gdal error when try to open GeoEye-1 image:
	ERROR 4:
`J2K_SUBFILE:3798,1743855514,H:\sgong\images\GeoEye-1\Geoeye-Canada\21.n
tf' does not exist in
	the file system,
	and is not recognised as a supported dataset name.

	ERROR 1: Unable to open JPEG2000 image within NITF file.
	Is the JP2KAK driver available?
	ERROR 4:
`J2K_SUBFILE:3798,1743855514,H:\sgong\images\GeoEye-1\Geoeye-Canada\21.n
tf' does not exist in
	the file system,
	and is not recognised as a supported dataset name.

	ERROR 1: Unable to open JPEG2000 image within NITF file.
	Is the JP2KAK driver available?

Is JP2KAK the only way to open JPEG2000 image within NITF file ?


thanks,
Shawn



_____________________________________________
From: Gong, Shawn (Contractor) 
Sent: Wednesday, August 05, 2009 5:12 PM
To: gdal-dev@lists.osgeo.org
Subject: gdal build error on Windows with Jasper

hi list,

I downloaded the 2009-08-03 daily stable gdal and built on Windows using
MS VS 2005.
First I tried without Jasper and it went fine. After I uncommented these
lines:
		# Uncomment for JasPer based JPEG2000 support
		JASPER_DIR = C:\build2\jasper-1.900.1
		JASPER_INCLUDE = -I$(JASPER_DIR)\src\libjasper\include
-DJAS_WIN_MSVC_BUILD
		JASPER_LIB =
$(JASPER_DIR)\src\msvc\win32_release\libjasper.lib
		# Uncomment the following line if you have patched
UUID-enabled version
		# of JasPer from ftp://ftp.remotesensing.org/gdal/
		#JASPER_INCLUDE = $(JASPER_INCLUDE) -DHAVE_JASPER_UUID
and I got the linking error as below.  Would someone tell me why?

Jasper was downloaded from http://www.ece.uvic.ca/~mdadams/jasper/ and
built using the same MS VS 2005 (batch build its projects)


thanks,
Shawn



        cl /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE
/D_CRT_NONSTDC_N
O_DEPRECATE /DNDEBUG -I..\port -I..\ogr -I..\gcore  -I..\alg
-I..\ogr\ogrsf_frmt
s  -DOGR_ENABLED  /c vb6_support.cpp
vb6_support.cpp
        cd ..
        if exist gdal.lib del gdal.lib
        lib /nologo /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj
frmts\o\*.obj
 ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib vb6\vb6_support.obj
ogrsf_frmts.lib(parsexsd.obj) : warning LNK4221: no public symbols
found; archiv
e member will be inaccessible
        link /nologo /dll /INCLUDE:_OGRFeatureStylePuller
/INCLUDE:_OSRValidate
  /INCLUDE:_OPTGetProjectionMethods  /INCLUDE:_OGR_G_GetPointCount
/INCLUDE:_OG
RRegisterAll /INCLUDE:_GDALSimpleImageWarp@36
/INCLUDE:_GDALReprojectImage@48
/INCLUDE:_GDALComputeMedianCutPCT@32  /INCLUDE:_GDALDitherRGB2PCT@28
/INCLUDE:_
OCTNewCoordinateTransformation@8 /INCLUDE:_vbSafeArrayToPtr@16
port\*.obj gcore\
*.obj alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib
ogr\ogr.lib vb6\vb
6_support.obj       odbc32.lib odbccp32.lib user32.lib
/LIBPATH:C:\build2\HDF4
1r5\lib Ws2_32.lib
C:\build2\jasper-1.900.1\src\msvc\win32_release\libjasper.li
b      C:\build2\netcdf-3.5.0\lib\netcdf.lib
C:\build2\proj-4.6.1\src\proj_i
.lib     C:\build2\HDF5-166-win-vs2005\dll\hdf5dll.lib
C:\build2\szip21\dll\szli
bdll.lib        gcore\Version.res  /out:gdal16.dll /implib:gdal_i.lib
LIBCMT.lib(dosmap.obj) : error LNK2005: __errno already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo
already defin
ed in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encoded_null already defined
in MSVC
RT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __decode_pointer already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __amsg_exit already defined in
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __initterm_e already defined in
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: _exit already defined in
MSVCRT.lib(MSV
CR80.dll)
LIBCMT.lib(crtheap.obj) : error LNK2005: __malloc_crt already defined in
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __unlock already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __lock already defined in
MSVCRT.lib(MSVC
R80.dll)
LIBCMT.lib(mbctype.obj) : error LNK2005: __getmbcp already defined in
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(setlocal.obj) : error LNK2005: _setlocale already defined in
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(winxfltr.obj) : error LNK2005: ___CppXcptFilter already
defined in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_a already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_z already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_a already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_z already defined in
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(hooks.obj) : error LNK2005: "void __cdecl terminate(void)"
(?terminat
e@@YAXXZ) already defined in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(calloc.obj) : error LNK2005: _calloc already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(realloc.obj) : error LNK2005: _realloc already defined in
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strftime.obj) : error LNK2005: _strftime already defined in
MSVCRT.li
b(MSVCR80.dll)
LIBCMT.lib(lconv.obj) : error LNK2005: _localeconv already defined in
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(getenv.obj) : error LNK2005: _getenv already defined in
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strnicmp.obj) : error LNK2005: __strnicmp already defined in
MSVCRT.l
ib(MSVCR80.dll)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __stricmp already defined in
LIBCMT.lib
(stricmp.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __strdup already defined in
LIBCMT.lib(
strdup.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __unlink already defined in
LIBCMT.lib(
unlink.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __close already defined in
LIBCMT.lib(c
lose.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __open already defined in
LIBCMT.lib(op
en.obj)
   Creating library gdal_i.lib and object gdal_i.exp
LINK : warning LNK4098: defaultlib 'MSVCRT' conflicts with use of other
libs; us
e /NODEFAULTLIB:library
LINK : warning LNK4098: defaultlib 'LIBCMT' conflicts with use of other
libs; us
e /NODEFAULTLIB:library
LIBCMT.lib(crt0.obj) : error LNK2019: unresolved external symbol _main
reference
d in function ___tmainCRTStartup
gdal16.dll : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio
8\VC\BIN\l
ink.EXE"' : return code '0x460'
Stop.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/6385cdd0/attachment-0001.html
From oliver.newman at baesystems.com  Thu Aug  6 11:56:28 2009
From: oliver.newman at baesystems.com (Ollie Newman)
Date: Thu Aug  6 11:56:29 2009
Subject: [Gdal-dev] GDAL seems unable to translate CIB data set
In-Reply-To: <4A7AFAA1.1070007@pobox.com>
References: <1249572444161-3398950.post@n2.nabble.com>
	<4A7AFAA1.1070007@pobox.com>
Message-ID: <1249574188067-3399120.post@n2.nabble.com>




Frank Warmerdam wrote:
> 
> 
> Ollie,
> 
> Can you make .\NI425J2\01LGBN2B.I42 available for inspection?  I imagine
> Even
> will need to comment on the particulars of the RPFTOC driver - I see this
> assertion is coming from it, not the NITF driver.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

Hi Frank,

Unfortunately I think that would be unlikely as it's a limited distribution
military data set.  I know this doesn't help a great deal!

Attacking this from a different angle I am now using gdal_translate to
translate each of the 1073 tiles (which are in NITF format) to GeoTiffs and
then mosaic into a single image.  This will run overnight based on the
current rate but so far has produced 1073 previewable GeoTiffs (which at a
random sampling process all seem to contain some data) and is working
through the mosaic operation.  I'll confirm the results in the morning but
this may help narrow down where the problem area may be - or not (I'm not
familiar enough with the GDAL code to know whether this helps)

Thanks

Ollie

-- 
View this message in context: http://n2.nabble.com/GDAL-seems-unable-to-translate-CIB-data-set-tp3398950p3399120.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From matt at klaric.com  Thu Aug  6 11:59:19 2009
From: matt at klaric.com (Matt Klaric)
Date: Thu Aug  6 11:59:21 2009
Subject: [gdal-dev] RE: gdal build error on Windows with Jasper
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26EA35@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<DF1471B5C308B346BF5A2AEA00C5615E26EA35@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <eba00f2b0908060859u6f030061lb650460000586e60@mail.gmail.com>

On Thu, Aug 6, 2009 at 10:36 AM, Gong, Shawn (Contractor) <
Shawn.Gong@drdc-rddc.gc.ca> wrote:

>
>
>  Is JP2KAK the only way to open JPEG2000 image within NITF file ?
>
No, libecwj2 works as well.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/75e6b807/attachment.html
From Shawn.Gong at drdc-rddc.gc.ca  Thu Aug  6 12:20:37 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Aug  6 12:20:43 2009
Subject: [gdal-dev] RE: gdal build error on Windows with Jasper
In-Reply-To: <eba00f2b0908060859u6f030061lb650460000586e60@mail.gmail.com>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca><DF1471B5C308B346BF5A2AEA00C5615E26EA35@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<eba00f2b0908060859u6f030061lb650460000586e60@mail.gmail.com>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA36@ottawaex02.Ottawa.drdc-rddc.gc.ca>

thanks Matt.

I will try it.



Shawn 

 

________________________________

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Matt Klaric
Sent: Thursday, August 06, 2009 11:59 AM
To: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: gdal build error on Windows with Jasper

 

 

On Thu, Aug 6, 2009 at 10:36 AM, Gong, Shawn (Contractor)
<Shawn.Gong@drdc-rddc.gc.ca> wrote:

Is JP2KAK the only way to open JPEG2000 image within NITF file ?

No, libecwj2 works as well.  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/19b7918f/attachment.html
From atubar at 126.com  Thu Aug  6 11:56:41 2009
From: atubar at 126.com (atubar)
Date: Thu Aug  6 12:26:53 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
Message-ID: <9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>

Hello, I am a freshman in working with Gdal and HDF5 in Visual C++ 2008. I have built essential dlls as those guides said. And I got gdal16.dll, hdf5dll.dll and more.
I set up a project , add include and lib to this project. Then I copy some sample codes to test how gdal and hdf5 works.
These codes below works successfully:
    char *pszFormat="HDF5";
    GDALDriver *poDriver = GetGDALDriverManager()->GetDriverByName(pszFormat);
It returns an non null poDriver.
But when I work with these codes below: 
    char* filename="..\\hdf5_test.h5";
    GDALDataset *poDataset;
    poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
it occurs an error like this below:
   Unhandled exception in **.exe:0xC00000FD:Stack Overflow 
How it comes? Is it a bug?What should I do ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/30d3fdfa/attachment.html
From warmerdam at pobox.com  Thu Aug  6 13:29:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  6 13:29:40 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
Message-ID: <4A7B1304.2000401@pobox.com>

Motion: Adopt  GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.

---

Folks,

I have tested it briefly and all seems to be in order.

+1 from me


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Shawn.Gong at drdc-rddc.gc.ca  Thu Aug  6 15:31:40 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Aug  6 15:31:46 2009
Subject: [gdal-dev] building libecwj2 - missing winhttp.h
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA38@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I downloaded libecwj2 from ermapper and tried to build it on Windows
using VS 2005.
I opened
C:\...\libecwj2-3.3\Source\NCSBuildQmake\libecwj2_win32_net_static.vcpro
j and libecwj2_win32_net_shared.vcproj and btach_build.

I got error saying that winhttp.h is missing. This file is referred in 
C:\...\libecwj2-3.3\Source\C\NCSnet\NCScnet2\NCSWinHttp.c :
		#if !defined(_WIN32_WCE)
			#include "winhttp.h"
		#else
			#include <wininet.h>
		#endif

There is no such file in MS VS 2005. I copied one from MS VS 2008, but
it created more errors in the winhttp.h

If you had built libecwj2 on Windows, please help.  Is there a way to
bypass this, given that I only need the Jpeg2000 support?


thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/e48b7edf/attachment.html
From even.rouault at mines-paris.org  Thu Aug  6 16:08:50 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug  6 16:08:58 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
References: <4A7B1304.2000401@pobox.com>
Message-ID: <000601ca16d1$b7317c50$0c00a8c0@pctiphaine>

+1

----- Original Message ----- 
From: "Frank Warmerdam" <warmerdam@pobox.com>
To: "gdal-dev" <gdal-dev@lists.osgeo.org>
Sent: Thursday, August 06, 2009 7:29 PM
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release


> Motion: Adopt  GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.
>
> ---
>
> Folks,
>
> I have tested it briefly and all seems to be in order.
>
> +1 from me
>
>
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> 


From even.rouault at mines-paris.org  Thu Aug  6 16:28:56 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug  6 16:29:02 2009
Subject: [Gdal-dev] GDAL seems unable to translate CIB data set
References: <1249572444161-3398950.post@n2.nabble.com><4A7AFAA1.1070007@pobox.com>
	<1249574188067-3399120.post@n2.nabble.com>
Message-ID: <001a01ca16d4$859da760$0c00a8c0@pctiphaine>

Ollie,

There's probably nothing wrong with your dataset. The error comes from the 
part of the driver that tries to mosaic all the NITF tiles from the CIB 
exchange. The error issued by the RPFTOC driver is an assertion that checks 
that the theoretical placement of the tile into the mosaic given by the 
A.TOC file is consistant with the georeferencing of the NITF tile itself. 
The assertion would indicate that the longitude of the north west corner of 
the tile wouldn't match the one deduced from the A.TOC. Maybe the test is a 
bit too strict on the precision. I don't know. I've been able to test the 
driver on many CADRG datasets, but no CIB until now. What would help to 
understand is sending the output of gdalinfo on the .\NI425J2\01LGBN2B.I42 
tile to get its georeferencing (gdalinfo on other random tiles could help 
also to see/confirm if it's limited on a single tile or a general 
phenomenon) and joining the A.TOC file which is just an index and contains 
no imagery. You could create a Trac ticket (http://trac.osgeo.org/gdal/) for 
that. (I won't be able to look at this before two weeks).

Best regards,

Even

----- Original Message ----- 
From: "Ollie Newman" <oliver.newman@baesystems.com>
To: <gdal-dev@lists.osgeo.org>
Sent: Thursday, August 06, 2009 5:56 PM
Subject: Re: [Gdal-dev] GDAL seems unable to translate CIB data set


>
>
>
> Frank Warmerdam wrote:
>>
>>
>> Ollie,
>>
>> Can you make .\NI425J2\01LGBN2B.I42 available for inspection?  I imagine
>> Even
>> will need to comment on the particulars of the RPFTOC driver - I see this
>> assertion is coming from it, not the NITF driver.
>>
>> Best regards,
>> -- 
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows | http://pobox.com/~warmerdam
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
> Hi Frank,
>
> Unfortunately I think that would be unlikely as it's a limited 
> distribution
> military data set.  I know this doesn't help a great deal!
>
> Attacking this from a different angle I am now using gdal_translate to
> translate each of the 1073 tiles (which are in NITF format) to GeoTiffs 
> and
> then mosaic into a single image.  This will run overnight based on the
> current rate but so far has produced 1073 previewable GeoTiffs (which at a
> random sampling process all seem to contain some data) and is working
> through the mosaic operation.  I'll confirm the results in the morning but
> this may help narrow down where the problem area may be - or not (I'm not
> familiar enough with the GDAL code to know whether this helps)
>
> Thanks
>
> Ollie
>
> -- 
> View this message in context: 
> http://n2.nabble.com/GDAL-seems-unable-to-translate-CIB-data-set-tp3398950p3399120.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> 


From JAMES.E.HOPPER at saic.com  Thu Aug  6 16:31:07 2009
From: JAMES.E.HOPPER at saic.com (jim hopper)
Date: Thu Aug  6 16:31:44 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release (Frank
	Warmerdam)
In-Reply-To: <20090806202904.9FACAE01B9D@lists.osgeo.org>
Message-ID: <C6A0B5CB.FAC4%james.e.hopper@saic.com>

Fred,

Any chance of fixing the makefile issues I reported with cxxflags and
cppflags? Before final?

Best jim



On 8/6/09 4:29 PM, "gdal-dev-request@lists.osgeo.org"
<gdal-dev-request@lists.osgeo.org> wrote:

>  Motion: Adopt GDAL 1.6.2RC2 as final release (Frank Warmerdam)

From even.rouault at mines-paris.org  Thu Aug  6 16:49:35 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug  6 16:49:43 2009
Subject: [gdal-dev] RE: gdal build error on Windows with Jasper
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA32@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<DF1471B5C308B346BF5A2AEA00C5615E26EA35@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <003301ca16d7$6829f3c0$0c00a8c0@pctiphaine>

RE: gdal build error on Windows with JasperJasper driver cannot read 
JPEG2000 data embedded at an offset inside a NITF file. It can just read 
plain JP2 files. JP2ECW, JP2MrSID or JP2KAK can read JPEG2000 NITF.

----- Original Message ----- 
From: Gong, Shawn (Contractor)
To: gdal-dev@lists.osgeo.org
Sent: Thursday, August 06, 2009 5:36 PM
Subject: [gdal-dev] RE: gdal build error on Windows with Jasper


OK.  I solved the problem. It is a conflict between MSVCRT.lib (dynamic lib) 
and LIBCMT.lib (static lib) while building JasPer. Just need to set runtime 
lib to /MD.
Now Jasper-1.900.1.uuid is built into Gdal.
But I am still getting the gdal error when try to open GeoEye-1 image:
ERROR 4: 
`J2K_SUBFILE:3798,1743855514,H:\sgong\images\GeoEye-1\Geoeye-Canada\21.ntf' 
does not exist in
the file system,
and is not recognised as a supported dataset name.
ERROR 1: Unable to open JPEG2000 image within NITF file.
Is the JP2KAK driver available?
ERROR 4: 
`J2K_SUBFILE:3798,1743855514,H:\sgong\images\GeoEye-1\Geoeye-Canada\21.ntf' 
does not exist in
the file system,
and is not recognised as a supported dataset name.
ERROR 1: Unable to open JPEG2000 image within NITF file.
Is the JP2KAK driver available?
Is JP2KAK the only way to open JPEG2000 image within NITF file ?
thanks,
Shawn
_____________________________________________
From: Gong, Shawn (Contractor)
Sent: Wednesday, August 05, 2009 5:12 PM
To: gdal-dev@lists.osgeo.org
Subject: gdal build error on Windows with Jasper
hi list,
I downloaded the 2009-08-03 daily stable gdal and built on Windows using MS 
VS 2005.
First I tried without Jasper and it went fine. After I uncommented these 
lines:
# Uncomment for JasPer based JPEG2000 support
JASPER_DIR = C:\build2\jasper-1.900.1
JASPER_INCLUDE = -I$(JASPER_DIR)\src\libjasper\include -DJAS_WIN_MSVC_BUILD
JASPER_LIB = $(JASPER_DIR)\src\msvc\win32_release\libjasper.lib
# Uncomment the following line if you have patched UUID-enabled version
# of JasPer from ftp://ftp.remotesensing.org/gdal/
#JASPER_INCLUDE = $(JASPER_INCLUDE) -DHAVE_JASPER_UUID
and I got the linking error as below.  Would someone tell me why?
Jasper was downloaded from http://www.ece.uvic.ca/~mdadams/jasper/ and built 
using the same MS VS 2005 (batch build its projects)
thanks,
Shawn


        cl /nologo /MD /EHsc /Ox /W3 /D_CRT_SECURE_NO_DEPRECATE 
/D_CRT_NONSTDC_N
O_DEPRECATE 
/DNDEBUG -I..\port -I..\ogr -I..\gcore  -I..\alg -I..\ogr\ogrsf_frmt
s  -DOGR_ENABLED  /c vb6_support.cpp
vb6_support.cpp
        cd ..
        if exist gdal.lib del gdal.lib
        lib /nologo /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj 
frmts\o\*.obj
 ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib vb6\vb6_support.obj
ogrsf_frmts.lib(parsexsd.obj) : warning LNK4221: no public symbols found; 
archiv
e member will be inaccessible
        link /nologo /dll /INCLUDE:_OGRFeatureStylePuller 
/INCLUDE:_OSRValidate
  /INCLUDE:_OPTGetProjectionMethods  /INCLUDE:_OGR_G_GetPointCount 
/INCLUDE:_OG
RRegisterAll /INCLUDE:_GDALSimpleImageWarp@36 
/INCLUDE:_GDALReprojectImage@48
/INCLUDE:_GDALComputeMedianCutPCT@32  /INCLUDE:_GDALDitherRGB2PCT@28 
/INCLUDE:_
OCTNewCoordinateTransformation@8 /INCLUDE:_vbSafeArrayToPtr@16 port\*.obj 
gcore\
*.obj alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib 
vb6\vb
6_support.obj       odbc32.lib odbccp32.lib user32.lib 
/LIBPATH:C:\build2\HDF4
1r5\lib Ws2_32.lib 
C:\build2\jasper-1.900.1\src\msvc\win32_release\libjasper.li
b      C:\build2\netcdf-3.5.0\lib\netcdf.lib 
C:\build2\proj-4.6.1\src\proj_i
.lib     C:\build2\HDF5-166-win-vs2005\dll\hdf5dll.lib 
C:\build2\szip21\dll\szli
bdll.lib        gcore\Version.res  /out:gdal16.dll /implib:gdal_i.lib
LIBCMT.lib(dosmap.obj) : error LNK2005: __errno already defined in 
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(invarg.obj) : error LNK2005: __invalid_parameter_noinfo already 
defin
ed in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encode_pointer already defined 
in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __encoded_null already defined in 
MSVC
RT.lib(MSVCR80.dll)
LIBCMT.lib(tidtable.obj) : error LNK2005: __decode_pointer already defined 
in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __amsg_exit already defined in 
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: __initterm_e already defined in 
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(crt0dat.obj) : error LNK2005: _exit already defined in 
MSVCRT.lib(MSV
CR80.dll)
LIBCMT.lib(crtheap.obj) : error LNK2005: __malloc_crt already defined in 
MSVCRT.
lib(MSVCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __unlock already defined in 
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(mlock.obj) : error LNK2005: __lock already defined in 
MSVCRT.lib(MSVC
R80.dll)
LIBCMT.lib(mbctype.obj) : error LNK2005: __getmbcp already defined in 
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(setlocal.obj) : error LNK2005: _setlocale already defined in 
MSVCRT.l
ib(MSVCR80.dll)
LIBCMT.lib(winxfltr.obj) : error LNK2005: ___CppXcptFilter already defined 
in MS
VCRT.lib(MSVCR80.dll)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_a already defined in 
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xi_z already defined in 
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_a already defined in 
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(crt0init.obj) : error LNK2005: ___xc_z already defined in 
MSVCRT.lib(
cinitexe.obj)
LIBCMT.lib(hooks.obj) : error LNK2005: "void __cdecl terminate(void)" 
(?terminat
e@@YAXXZ) already defined in MSVCRT.lib(MSVCR80.dll)
LIBCMT.lib(calloc.obj) : error LNK2005: _calloc already defined in 
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(realloc.obj) : error LNK2005: _realloc already defined in 
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strftime.obj) : error LNK2005: _strftime already defined in 
MSVCRT.li
b(MSVCR80.dll)
LIBCMT.lib(lconv.obj) : error LNK2005: _localeconv already defined in 
MSVCRT.lib
(MSVCR80.dll)
LIBCMT.lib(getenv.obj) : error LNK2005: _getenv already defined in 
MSVCRT.lib(MS
VCR80.dll)
LIBCMT.lib(tolower.obj) : error LNK2005: _tolower already defined in 
MSVCRT.lib(
MSVCR80.dll)
LIBCMT.lib(strnicmp.obj) : error LNK2005: __strnicmp already defined in 
MSVCRT.l
ib(MSVCR80.dll)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __stricmp already defined in 
LIBCMT.lib
(stricmp.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __strdup already defined in 
LIBCMT.lib(
strdup.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __unlink already defined in 
LIBCMT.lib(
unlink.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __close already defined in 
LIBCMT.lib(c
lose.obj)
MSVCRT.lib(MSVCR80.dll) : error LNK2005: __open already defined in 
LIBCMT.lib(op
en.obj)
   Creating library gdal_i.lib and object gdal_i.exp
LINK : warning LNK4098: defaultlib 'MSVCRT' conflicts with use of other 
libs; us
e /NODEFAULTLIB:library
LINK : warning LNK4098: defaultlib 'LIBCMT' conflicts with use of other 
libs; us
e /NODEFAULTLIB:library
LIBCMT.lib(crt0.obj) : error LNK2019: unresolved external symbol _main 
reference
d in function ___tmainCRTStartup
gdal16.dll : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio 
8\VC\BIN\l
ink.EXE"' : return code '0x460'
Stop.



_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 


From warmerdam at pobox.com  Thu Aug  6 17:36:02 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  6 17:36:06 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release (Frank
	Warmerdam)
In-Reply-To: <C6A0B5CB.FAC4%james.e.hopper@saic.com>
References: <C6A0B5CB.FAC4%james.e.hopper@saic.com>
Message-ID: <4A7B4CC2.6050307@pobox.com>

jim hopper wrote:
> Any chance of fixing the makefile issues I reported with cxxflags and
> cppflags? Before final?

Jim,

They didn't seem like show stoppers to me.  I'm not even sure I know
what the solution will be though I was hoping someone might look into them
in the next few weeks.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From chapmanm at pixia.com  Thu Aug  6 17:50:45 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Thu Aug  6 17:50:53 2009
Subject: [gdal-dev] RasterIO Writing Packed RGB data
Message-ID: <554C59311B7C4BA586EF1565D6CD3199@chapmanm64>

I'm using the RasterIO method on the GDALDataset object and trying to write
a buffer where the pixels are packed as RGBRGBRGB etc. and having trouble
figuring out what parameters to pass as the pixel, line and band space.  My
desired output is a 3 band geotiff and the source and dest datatype is byte.
Can anyone point me the write direction on how to use those parameters in
this case?

 

Thanks in advance,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/6d427d0b/attachment.html
From chapmanm at pixia.com  Thu Aug  6 18:08:42 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Thu Aug  6 18:08:49 2009
Subject: [gdal-dev] RasterIO Writing Packed RGB data
In-Reply-To: <554C59311B7C4BA586EF1565D6CD3199@chapmanm64>
References: <554C59311B7C4BA586EF1565D6CD3199@chapmanm64>
Message-ID: <4B87E1E4C95C47D5AB45D6AD997A2924@chapmanm64>

Answered my on question: It is:

 

outputDataset->RasterIO(GF_Write, 0, 0, width, height, buffer, width,
height, GDT_Byte, numBands, NULL, 3, 3 * width, 1);

 

Martin

 

  _____  

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Martin Chapman
Sent: Thursday, August 06, 2009 3:51 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] RasterIO Writing Packed RGB data

 

I'm using the RasterIO method on the GDALDataset object and trying to write
a buffer where the pixels are packed as RGBRGBRGB etc. and having trouble
figuring out what parameters to pass as the pixel, line and band space.  My
desired output is a 3 band geotiff and the source and dest datatype is byte.
Can anyone point me the write direction on how to use those parameters in
this case?

 

Thanks in advance,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/a825dd9a/attachment.html
From chapmanm at pixia.com  Thu Aug  6 18:09:17 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Thu Aug  6 18:09:25 2009
Subject: [gdal-dev] RasterIO Writing Packed RGB data
In-Reply-To: <4B87E1E4C95C47D5AB45D6AD997A2924@chapmanm64>
References: <554C59311B7C4BA586EF1565D6CD3199@chapmanm64>
	<4B87E1E4C95C47D5AB45D6AD997A2924@chapmanm64>
Message-ID: <CBC83B66F337460BA240B639443AA229@chapmanm64>

Thanks Martin!

 

  _____  

From: Martin Chapman [mailto:chapmanm@pixia.com] 
Sent: Thursday, August 06, 2009 4:09 PM
To: 'Martin Chapman'; gdal-dev@lists.osgeo.org
Subject: RE: [gdal-dev] RasterIO Writing Packed RGB data

 

Answered my on question: It is:

 

outputDataset->RasterIO(GF_Write, 0, 0, width, height, buffer, width,
height, GDT_Byte, numBands, NULL, 3, 3 * width, 1);

 

Martin

 

  _____  

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Martin Chapman
Sent: Thursday, August 06, 2009 3:51 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] RasterIO Writing Packed RGB data

 

I'm using the RasterIO method on the GDALDataset object and trying to write
a buffer where the pixels are packed as RGBRGBRGB etc. and having trouble
figuring out what parameters to pass as the pixel, line and band space.  My
desired output is a 3 band geotiff and the source and dest datatype is byte.
Can anyone point me the write direction on how to use those parameters in
this case?

 

Thanks in advance,

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/085b2fc4/attachment-0001.html
From reinaldo at geodesign.com.br  Thu Aug  6 18:58:43 2009
From: reinaldo at geodesign.com.br (Reinaldo escada Chohfi)
Date: Thu Aug  6 19:05:40 2009
Subject: [gdal-dev] Help with OGR MapInfo Format
Message-ID: <38ecbdb80cf186b03285bea6cab7bc04.squirrel@webmail.geodesign.com.br>





I am using gdal 1.6.1 and trying to export a set of point fetures though
OGR in different formats: Shape, MapInfo, KML, etc.



The C++ program?exports to .shp with .prj without problems with the
correct srs information.



The .kml comes out fine too.? The points fall in the right place when
viewing in GoogleEarth/Maps



However, the MapInfo file doesn't have the srs.? It's always NonEarth
projection.



Could anyone help me?? What am I missing?



Thanks in advance.



Reinaldo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090806/a6d73918/attachment.html
From JAMES.E.HOPPER at saic.com  Thu Aug  6 20:09:25 2009
From: JAMES.E.HOPPER at saic.com (jim hopper)
Date: Thu Aug  6 20:10:03 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release (Frank
	Warmerdam)
In-Reply-To: <4A7B4CC2.6050307@pobox.com>
Message-ID: <C6A0E8F5.FAD0%james.e.hopper@saic.com>

Not show stoppers, but make it hard to compile with some options.  In my
case the architecture if I want to compile ppc vs i86 or x86_64.  Its a
trivial fix (in the case of the CXXFLAGS just change all of them to
CPPFLAGS, and one make file where you add CPPFLAGS) that's why I though
someone might want to fix them.  No problem if it has to wait.

Best jim



On 8/6/09 5:36 PM, "Frank Warmerdam" <warmerdam@pobox.com> wrote:

> jim hopper wrote:
>> Any chance of fixing the makefile issues I reported with cxxflags and
>> cppflags? Before final?
> 
> Jim,
> 
> They didn't seem like show stoppers to me.  I'm not even sure I know
> what the solution will be though I was hoping someone might look into them
> in the next few weeks.
> 
> Best regards,

From woklist at kyngchaos.com  Thu Aug  6 20:53:19 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu Aug  6 20:53:25 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release (Frank
	Warmerdam)
In-Reply-To: <C6A0E8F5.FAD0%james.e.hopper@saic.com>
References: <C6A0E8F5.FAD0%james.e.hopper@saic.com>
Message-ID: <DA7D3508-5DAF-459D-A0E6-4FD7BD1E6531@kyngchaos.com>

On Aug 6, 2009, at 7:09 PM, jim hopper wrote:

> Not show stoppers, but make it hard to compile with some options.   
> In my
> case the architecture if I want to compile ppc vs i86 or x86_64.   
> Its a
> trivial fix (in the case of the CXXFLAGS just change all of them to
> CPPFLAGS, and one make file where you add CPPFLAGS) that's why I  
> though
> someone might want to fix them.  No problem if it has to wait.
>
> Best jim
>
I always use CFLAGS, CXXFLAGS and LDFLAGS for OSX arch flags.  Works  
just fine.

>
>
> On 8/6/09 5:36 PM, "Frank Warmerdam" <warmerdam@pobox.com> wrote:
>
>> jim hopper wrote:
>>> Any chance of fixing the makefile issues I reported with cxxflags  
>>> and
>>> cppflags? Before final?
>>
>> Jim,
>>
>> They didn't seem like show stoppers to me.  I'm not even sure I know
>> what the solution will be though I was hoping someone might look  
>> into them
>> in the next few weeks.
>>
>> Best regards,
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"History is an illusion caused by the passage of time, and time is an  
illusion caused by the passage of history."

- Hitchhiker's Guide to the Galaxy


From woklist at kyngchaos.com  Thu Aug  6 22:47:45 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu Aug  6 22:47:51 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release (Frank
	Warmerdam)
In-Reply-To: <924E76187096974392FE7FC279CE11200EB04B@0768-ITS-EXMP03.us.saic.com>
References: <C6A0E8F5.FAD0%james.e.hopper@saic.com>
	<DA7D3508-5DAF-459D-A0E6-4FD7BD1E6531@kyngchaos.com>
	<924E76187096974392FE7FC279CE11200EB04A@0768-ITS-EXMP03.us.saic.com>
	<5410DCC7-AF91-4117-AFC4-3985F6112E05@kyngchaos.com>
	<924E76187096974392FE7FC279CE11200EB04B@0768-ITS-EXMP03.us.saic.com>
Message-ID: <880C2DB8-D991-4E23-80AF-64D678C402E4@kyngchaos.com>

Right, but since every object rule does include either CFLAGS or  
CXXFLAGS, put the arch flags in those instead of CPPFLAGS.  It works.

For the gcore makefile, CPPFLAGS is probably setting general flags for  
the objects, BUT gdaldrivermanager is a special case because it needs  
that extra macro.  It probably wouldn't hurt to use CPPFLAGS here for  
consistency, but it's not necessary.

On Aug 6, 2009, at 9:27 PM, Hopper, James E. wrote:

> frmt/ilwis, make file is below.  CPPFLAGS does not include the  
> passed in CPPFLAGS only GDAL_INCLUDE.  I looked at the .o files in  
> this directory using apples "file" utility and they plainly showed  
> the files to be i386 when i had configured with ppc.
>
> gcore is using the passed in CPPFLAG to create the local CPPFLAG,  
> but it is using CXXFLAG instead of the CPPFLAG that is constructed  
> in the makefile (see second makefile).  It might be possible to use  
> just CXXFLAG, but its not correct for the makefiles to mix them up.   
> it should stick with one or the other.
>
> jim
>
>
> -----Original Message-----
> From: William Kyngesburye [mailto:kyngchaos@kyngchaos.com]
> Sent: Thu 8/6/2009 10:16 PM
> To: Hopper, James E.
> Subject: Re: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release  
> (Frank Warmerdam)
>
> All of the makefiles #include gdalmake.opt, which has the default
> object compile rules, and these include either CFLAGS or CXXFLAGS
> depending on the source.  Most makefiles use the default object rules,
> and those that have custom rules (ie GRIB) do include either CFLAGS or
> CXXFLAGS.
>
> Which dir do you mean - I saw a few listed in that email, and all have
> C[XX]FLAGS as either the default rule or in a custom rule.
>
> On Aug 6, 2009, at 8:00 PM, Hopper, James E. wrote:
>
> > The 1.6 code i downloaded had one directory (specified in my initial
> > post) that used none of these.  i had to add CPPFLAGS to the make
> > file before i could get 2 files to build with any architecture other
> > than the i386 one.  some of the makefiles use CPPFLAGS and some use
> > CXXFLAGS, i had to specify both before i could get it to build.
> >
> > best jim

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

[Trillian]  What are you supposed to do WITH a maniacally depressed  
robot?

[Marvin]  You think you have problems?  What are you supposed to do if  
you ARE a maniacally depressed robot?  No, don't try and answer, I'm  
50,000 times more intelligent than you and even I don't know the  
answer...

- HitchHiker's Guide to the Galaxy




-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"The beast is actively interested only in now, and, as it is always  
now and always shall be, there is an eternity of time for the  
accomplishment of objects."

- the wisdom of Tarzan





From szekerest at gmail.com  Fri Aug  7 04:11:28 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  7 04:11:34 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
In-Reply-To: <4A7B1304.2000401@pobox.com>
References: <4A7B1304.2000401@pobox.com>
Message-ID: <f3b73b7d0908070111t39801851v21186e3765ec1d7f@mail.gmail.com>

+1

Tamas


2009/8/6 Frank Warmerdam <warmerdam@pobox.com>

> Motion: Adopt  GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.
>
> ---
>
> Folks,
>
> I have tested it briefly and all seems to be in order.
>
> +1 from me
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/cf560ca2/attachment.html
From didier.richard at ign.fr  Fri Aug  7 04:18:50 2009
From: didier.richard at ign.fr (RICHARD Didier)
Date: Fri Aug  7 04:25:33 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
In-Reply-To: <f3b73b7d0908070111t39801851v21186e3765ec1d7f@mail.gmail.com>
References: <4A7B1304.2000401@pobox.com>
	<f3b73b7d0908070111t39801851v21186e3765ec1d7f@mail.gmail.com>
Message-ID: <1143.192.168.120.61.1249633130.squirrel@webmail.ign.fr>

+1

didier

> +1
>
> Tamas
>
>
> 2009/8/6 Frank Warmerdam <warmerdam@pobox.com>
>
>> Motion: Adopt  GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.
>>
>> ---
>>
>> Folks,
>>
>> I have tested it briefly and all seems to be in order.
>>
>> +1 from me
>>
>>
>> --
>>
>> ---------------------------------------+--------------------------------------
>> I set the clouds in motion - turn up   | Frank Warmerdam,
>> warmerdam@pobox.com
>> light and sound - activate the windows |
>> http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
>> and watch the world go round - Rush    | Geospatial Programmer for Rent
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
RICHARD Didier - Chef du p?le technique du G?oportail
2/4, avenue Pasteur - 94165 Saint Mand? Cedex
T?l : +33 (0) 1 43 98 83 23
From bartvde at osgis.nl  Fri Aug  7 05:17:36 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Fri Aug  7 05:17:51 2009
Subject: [gdal-dev] Re: SDE connection string problem with 1.6.1?
In-Reply-To: <27466.145.50.39.11.1249468196.squirrel@webmail.hostingdiscounter.nl>
References: <27466.145.50.39.11.1249468196.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <41957.145.50.39.11.1249636656.squirrel@webmail.hostingdiscounter.nl>

An update on this issue. This is a bug and is still present in 1.6.2
unfortunately.

The problem is in ogrsdedatasource.cpp, where the else clause which lists
all spatial tables was moved down, so it now corresponds to a different if
clause.

old code:

    if ( CSLCount( papszTokens ) == 6 && *papszTokens[5] != '\0' )
    {
        OpenSpatialTable( papszTokens[5] );
    }
    else
    {
        EnumerateSpatialTables();
    }

new code:

    else if ( CSLCount( papszTokens ) == 8 && *papszTokens[7] != '\0' )
    {
        ....
    }
    else
    {
        CPLDebug("OGR_SDE", "Setting version to SDE.DEFAULT");
        nSDEErr = SetVersionState("SDE.DEFAULT");
        EnumerateSpatialTables();
        if (!nSDEErr)
        {
            // We've already set the error
            CSLDestroy( papszTokens );
            return FALSE;
        }

    }

Best regards,
Bart

> Hi list,
>
> it seems the layer part of an SDE connection string is not picked up
> anymore. We're using GDAL 1.6.1. Did anybody else experience this?
>
> E.g.:
>
> ogrinfo
> SDE:geodatabase.ad.rws.nl,5151,5151,RWS_LEZEN,****,WEGEN.WEGEN_NWB_LIGHT
>
> lists all tables and not only the one specified.
>
> TIA.
>
> Best regards,
> Bart
>


From bartvde at osgis.nl  Fri Aug  7 05:20:42 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Fri Aug  7 05:20:55 2009
Subject: [gdal-dev] Re: SDE connection string problem with 1.6.1?
In-Reply-To: <41957.145.50.39.11.1249636656.squirrel@webmail.hostingdiscounter.nl>
References: <27466.145.50.39.11.1249468196.squirrel@webmail.hostingdiscounter.nl>
	<41957.145.50.39.11.1249636656.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <45531.145.50.39.11.1249636842.squirrel@webmail.hostingdiscounter.nl>

Okay, at least there is a workaround for this issue, by opening the
dataset in read-only mode and specifying the version (which causes the
else loop not to be reached):

[bart@hades nappub_svn]$ ogrinfo -ro
SDE:geodatabase.ad.rws.nl,5151,PGPR,RWS_LEZEN,RWS_LEZEN,WEGEN.WEGEN_NWB_LIGHT,SDE.DEFAULT
INFO: Open of
`SDE:geodatabase.ad.rws.nl,5151,PGPR,RWS_LEZEN,RWS_LEZEN,WEGEN.WEGEN_NWB_LIGHT,SDE.DEFAULT'
      using driver `SDE' successful.
1: WEGEN.WEGEN_NWB_LIGHT


Best regards,
Bart

> An update on this issue. This is a bug and is still present in 1.6.2
> unfortunately.
>
> The problem is in ogrsdedatasource.cpp, where the else clause which lists
> all spatial tables was moved down, so it now corresponds to a different if
> clause.
>
> old code:
>
>     if ( CSLCount( papszTokens ) == 6 && *papszTokens[5] != '\0' )
>     {
>         OpenSpatialTable( papszTokens[5] );
>     }
>     else
>     {
>         EnumerateSpatialTables();
>     }
>
> new code:
>
>     else if ( CSLCount( papszTokens ) == 8 && *papszTokens[7] != '\0' )
>     {
>         ....
>     }
>     else
>     {
>         CPLDebug("OGR_SDE", "Setting version to SDE.DEFAULT");
>         nSDEErr = SetVersionState("SDE.DEFAULT");
>         EnumerateSpatialTables();
>         if (!nSDEErr)
>         {
>             // We've already set the error
>             CSLDestroy( papszTokens );
>             return FALSE;
>         }
>
>     }
>
> Best regards,
> Bart
>
>> Hi list,
>>
>> it seems the layer part of an SDE connection string is not picked up
>> anymore. We're using GDAL 1.6.1. Did anybody else experience this?
>>
>> E.g.:
>>
>> ogrinfo
>> SDE:geodatabase.ad.rws.nl,5151,5151,RWS_LEZEN,****,WEGEN.WEGEN_NWB_LIGHT
>>
>> lists all tables and not only the one specified.
>>
>> TIA.
>>
>> Best regards,
>> Bart
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From lewis.milehi at gmail.com  Fri Aug  7 08:24:49 2009
From: lewis.milehi at gmail.com (keith lewis)
Date: Fri Aug  7 08:24:53 2009
Subject: [gdal-dev] extract vector/raster data from GeoPDF
Message-ID: <c07aa7ad0908070524o580baed3naa124845c5e01658@mail.gmail.com>

Hello people,

Is there any talk about developing tools in GDAL/OGR to extract raster or
vector data from a GeoPDF now the 2.2 version was submitted to the OGC?? The
submitted specs are for the georeferencing aspect only. ArcGIS and TerraGo
tools can create a GeoPDF. The USGS offers free Geopdf that contain
geospatial data. I'm sure someone will eventually release a tool.

Keith
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/b450ee63/attachment-0001.html
From bartvde at osgis.nl  Fri Aug  7 08:46:07 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Fri Aug  7 08:46:23 2009
Subject: [gdal-dev] Re: CSV filesize and OVF
In-Reply-To: <40814.145.50.39.11.1247227803.squirrel@webmail.hostingdiscounter.nl>
References: <40814.145.50.39.11.1247227803.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <34754.145.50.39.11.1249649167.squirrel@webmail.hostingdiscounter.nl>

FYI, this is fixed after upgrading to GDAL 1.6.1.

Best regards,
Bart

> Hi list,
>
> I've got a CSV file with about 50.000 lines.
>
> Running ogrinfo on it directly goes smoothly, but if I access it using an
> ovf file it won't work.
>
> It will work if I split up the large file in 2 files.
>
> Is there a known limit I am running into?
>
> Best regards,
> Bart
>


From bfraser at geoanalytic.com  Fri Aug  7 10:47:46 2009
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Fri Aug  7 10:48:12 2009
Subject: [gdal-dev] extract vector/raster data from GeoPDF
In-Reply-To: <c07aa7ad0908070524o580baed3naa124845c5e01658@mail.gmail.com>
References: <c07aa7ad0908070524o580baed3naa124845c5e01658@mail.gmail.com>
Message-ID: <4A7C3E92.9090202@geoanalytic.com>

Keith,
   No talk that I'm aware of.  There was a little chatter on the Geowanking list:
http://geowanking.org/pipermail/geowanking_geowanking.org/2009-February/017492.html

And occasionally some interest about producing PDF from Mapserver (e.g. 
http://lists.osgeo.org/pipermail/mapserver-users/2009-July/062035.html).

I'm hoping that as GeoPDF becomes popular some funding can be found to build a 
GDAL/OGR driver to read it.

Best Regards,
Brent Fraser

keith lewis wrote:
> Hello people,
>  
> Is there any talk about developing tools in GDAL/OGR to extract raster 
> or vector data from a GeoPDF now the 2.2 version was submitted to the 
> OGC?? The submitted specs are for the georeferencing aspect only. ArcGIS 
> and TerraGo tools can create a GeoPDF. The USGS offers free Geopdf that 
> contain geospatial data. I'm sure someone will eventually release a tool.
>  
> Keith
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
From jorge.arevalo at gmail.com  Fri Aug  7 11:05:54 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Aug  7 11:06:18 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from GDALRasterBand
Message-ID: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>

Hello,

Context: GDAL WKT Raster driver

In my class derived from GDALRasterBand, I've overrided the methods:

- IReadBlock: Fetch a block from database
- IRasterIO: Should fetch several blocks, that cover an area, and add
them to papoBlocks (cache). The idea is to avoid rounds in the server

AFAIK, the base IRasterIO implementation (in GDALRasterBand), tries to
fetch the block from the cache. If the block isn't in the cache, then
call to IReadBlock. So, the normal way to read blocks in any GDAL
driver should be IRasterIO --> IReadBlock

Then, If I override IRasterIO in my driver RasterBand's class, I
should fetch several blocks in one round and call GetLockedBlockRef to
add these blocks to the cache. After this, call the base
implementation of IRasterIO (in GDALRasterBand) to do its work (see
previous point).

Is it correct? I have problems with my IRasterIO implementation,
because it takes a long time executing until this fail:

ERROR 7: Assertion `nLockCount == 0' failed
in file `gdalrasterblock.cpp', line 228

Is there any mistake in this approach? If not, I suppose I had to
debug my queries, but I'd like to rule our wrong concepts first.

Many thanks in advance.

Best regards,
Jorge
From szekerest at gmail.com  Fri Aug  7 12:03:06 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  7 12:03:09 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
Message-ID: <f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>

Jorge,

Did you call DropLock() right after copying the data on the newly allocated
block? This assertion shows the raster block have remained in locked state.

It's quite annoying if you find long executing times somewhere. Did you know
how much time required to fetch the data and place that into the internal
buffer.

One issue with this concept would be related to the limited memory size of
the particular machine, it may be more reasonable to copy the retrieved
blocks directly onto the output buffer if possible. In this case you cannot
much rely on the base RasterIO implementation.

Best regards,

Tamas



2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>

> Hello,
>
> Context: GDAL WKT Raster driver
>
> In my class derived from GDALRasterBand, I've overrided the methods:
>
> - IReadBlock: Fetch a block from database
> - IRasterIO: Should fetch several blocks, that cover an area, and add
> them to papoBlocks (cache). The idea is to avoid rounds in the server
>
> AFAIK, the base IRasterIO implementation (in GDALRasterBand), tries to
> fetch the block from the cache. If the block isn't in the cache, then
> call to IReadBlock. So, the normal way to read blocks in any GDAL
> driver should be IRasterIO --> IReadBlock
>
> Then, If I override IRasterIO in my driver RasterBand's class, I
> should fetch several blocks in one round and call GetLockedBlockRef to
> add these blocks to the cache. After this, call the base
> implementation of IRasterIO (in GDALRasterBand) to do its work (see
> previous point).
>
> Is it correct? I have problems with my IRasterIO implementation,
> because it takes a long time executing until this fail:
>
> ERROR 7: Assertion `nLockCount == 0' failed
> in file `gdalrasterblock.cpp', line 228
>
> Is there any mistake in this approach? If not, I suppose I had to
> debug my queries, but I'd like to rule our wrong concepts first.
>
> Many thanks in advance.
>
> Best regards,
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/efde368c/attachment.html
From chaitanya.ch at gmail.com  Fri Aug  7 12:31:51 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Aug  7 12:31:53 2009
Subject: [gdal-dev] Help with OGR MapInfo Format
In-Reply-To: <38ecbdb80cf186b03285bea6cab7bc04.squirrel@webmail.geodesign.com.br>
References: <38ecbdb80cf186b03285bea6cab7bc04.squirrel@webmail.geodesign.com.br>
Message-ID: <eb502d880908070931l68f2e6c9qe41e055b75b4a6a5@mail.gmail.com>

Reinaldo,

There are some unresolved issues with the mapinfo format. Please refer to
http://www.gdal.org/ogr/drv_mitab.html for more info and workarounds.

Best regards,
-- 
Chaitanya kumar CH.

On Fri, Aug 7, 2009 at 4:28 AM, Reinaldo escada Chohfi <
reinaldo@geodesign.com.br> wrote:

>
> I am using gdal 1.6.1 and trying to export a set of point fetures though
> OGR in different formats: Shape, MapInfo, KML, etc.
>
> The C++ program exports to .shp with .prj without problems with the correct
> srs information.
>
> The .kml comes out fine too.  The points fall in the right place when
> viewing in GoogleEarth/Maps
>
> However, the MapInfo file doesn't have the srs.  It's always NonEarth
> projection.
>
> Could anyone help me?  What am I missing?
>
> Thanks in advance.
>
> Reinaldo
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/f5d91ec6/attachment.html
From chaitanya.ch at gmail.com  Fri Aug  7 12:45:37 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri Aug  7 12:45:39 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
References: <9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
Message-ID: <eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>

atubar,

If you can try this with VC++2005, please do. In any case please tell the
result here.

If you can, provide a sample data that gives this error so that the
situation to be understood better.

2009/8/6 atubar <atubar@126.com>

> Hello, I am a freshman in working with Gdal and HDF5 in Visual C++ 2008. I
> have built essential dlls as those guides said. And I got gdal16.dll,
> hdf5dll.dll and more.
> I set up a project , add include and lib to this project. Then I copy some
> sample codes to test how gdal and hdf5 works.
> These codes below works successfully:
>     char *pszFormat="HDF5";
>     GDALDriver *poDriver =
> GetGDALDriverManager()->GetDriverByName(pszFormat);
> It returns an non null poDriver.
> But when I work with these codes below:
>     char* filename="..\\hdf5_test.h5";
>     GDALDataset *poDataset;
>     poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
> it occurs an error like this below:
>    Unhandled exception in **.exe:0xC00000FD:Stack Overflow
> How it comes? Is it a bug?What should I do ?
>
>
> ------------------------------
> ,www.yeah.net <http://www.yeah.net/?from=footer>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/a6c2e2a1/attachment.html
From even.rouault at mines-paris.org  Fri Aug  7 13:35:45 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Aug  7 13:35:52 2009
Subject: [gdal-dev] Question on OGR handle types
References: <4A79AC45.7070407@actix.com>
	<6D17B8E2B6354C8680670679F484DB2A@PCZORGLUB>
	<4A7BF7C7.5030406@actix.com>
Message-ID: <006401ca1785$7eaff370$0c00a8c0@pctiphaine>

Answers below

P.S. : Don't forget to use 'Answer to all' when answering to a post so that 
the list is CC'ed

----- Original Message ----- 
From: "Stefan Moebius" <stefan.moebius@actix.com>
To: "Even Rouault" <even.rouault@mines-paris.org>
Sent: Friday, August 07, 2009 11:45 AM
Subject: Re: [gdal-dev] Question on OGR handle types


> Even,
>
> Thanks for your reply.
>
> No we aren't actually afraid to use casts, we were just wondering what the 
> point is in changing the GDAL sources to improve type safety, just to tell 
> users to use not-really-type safe casts?

That depends on the point of view. The change to turn all "type void* foo" 
into something more specific enabled us to discover bugs in code using the C 
API in a few places inside GDAL itself as all C handles were equivalent 
before.

>
> > For the C++ part, we could argue there's a lack of a static void
> > OGRCoordinateTransformation::Destroy(OGRCoordinateTransformation*) 
> > method
> > to avoid using the delete operator, which can be an issue on Windows.
>
> Yes, that's exactly what we do argue ;-)
> (The pure-C way is not an option in our case.)
>
> Would it make sense for us to come up with a patch for adding this 
> function?

Patch welcome. Please post it as an attachement to a ticket in GDAL Trac. It 
should be done against svn trunk code ideally.

>
> Cheers,
> Stefan
>
> Even Rouault wrote:
>> Stefan,
>>
>> Why are you so much afraid about using cast ? ;-) This is probably the
>> easiest solution for you :
>> OGRCoordinateTransformation* poCT =
>> OGRCreateCoordinateTransformation(poSRS1, poSRS2);
>> OCTDestroyCoordinateTransformation( (OGRCoordinateTransformationH) poCT);
>>
>> No worry to have. It's exactly the kind of casts done in GDAL/OGR C API
>> wrappers to call the C++ API.
>> For example :
>>
>> OGRCoordinateTransformationH CPL_STDCALL OCTNewCoordinateTransformation(
>>  OGRSpatialReferenceH hSourceSRS, OGRSpatialReferenceH hTargetSRS )
>> {
>>  return (OGRCoordinateTransformationH)
>>    OGRCreateCoordinateTransformation(   (OGRSpatialReference *) 
>> hSourceSRS,
>> (OGRSpatialReference *) hTargetSRS );
>> }
>>
>> void CPL_STDCALL OCTDestroyCoordinateTransformation(
>> OGRCoordinateTransformationH hCT )
>> {
>>  delete (OGRCoordinateTransformation *) hCT;
>> }
>>
>> Otherwise, as you've noted, the stricter typing is only enforced when 
>> DEBUG
>> is defined.
>> So your code should compile without any change if you don't define DEBUG.
>>
>> The fundamental issue in fact is that you're mixing use of C++ API and C
>> API.
>> A pure C solution would be to use the pair
>> OCTNewCoordinateTransformation()/OCTDestroyCoordinateTransformation().
>> For the C++ part, we could argue there's a lack of a static void
>> OGRCoordinateTransformation::Destroy(OGRCoordinateTransformation*) method
>> to avoid using the delete operator, which can be an issue on Windows.
>>
>> ----- Original Message ----- From: "Stefan Moebius" 
>> <stefan.moebius@actix.com>
>> To: <gdal-dev@lists.osgeo.org>
>> Sent: Wednesday, August 05, 2009 5:59 PM
>> Subject: [gdal-dev] Question on OGR handle types
>>
>>
>>> Hi,
>>>
>>> In May 2008, a couple of changes where made to improve type checking.
>>>
>>> See http://lists.osgeo.org/pipermail/gdal-dev/2008-May/017059.html
>>> http://trac.osgeo.org/gdal/changeset/14435
>>> http://trac.osgeo.org/gdal/changeset/14441
>>>
>>> Our code is using the function
>>>
>>> OGRCoordinateTransformation* OGRCreateCoordinateTransformation
>>> (OGRSpatialReference * poSource,
>>> OGRSpatialReference * poTarget)
>>>
>>> and with the upgrade from 1.5 to 1.6, we now cannot properly destroy the 
>>> OGRCoordinateTransformation anymore (at least in debug mode).
>>>
>>> The documentation of that create function says:
>>>
>>>> Create transformation object.
>>>>
>>>> This is the same as the C function OCTNewCoordinateTransformation().
>>>>
>>>> Input spatial reference system objects are assigned by copy (calling 
>>>> clone() method) and no ownership transfer occurs.
>>>>
>>>> The delete operator, or OCTDestroyCoordinateTransformation() should be 
>>>> used to destroy transformation objects.
>>>
>>> As we are linking the GDAL dynamically, using delete is not really an 
>>> option as we cannot predict what heap was used to create the object. The 
>>> destroy function, however, requires a parameter of type 
>>> OGRCoordinateTransformationH, which we cannot cleanly cast to anymore 
>>> for that change mentioned at the beginning.
>>>
>>> What are we missing here? How is this supposed to be used?
>>>
>>> Any help is appreciated.
>>>
>>> Regards,
>>> Stefan
>
> -- 
> Stefan M?bius
> Development Manager
>
> Actix GmbH
> Altmarkt 10
> 01067 Dresden
> Germany
>
> T +49 351 40429 17
> www.actix.com
>
> 


From jorge.arevalo at gmail.com  Fri Aug  7 13:43:44 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Aug  7 13:44:07 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
Message-ID: <cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>

2009/8/7 Tamas Szekeres <szekerest@gmail.com>:
> Jorge,
>
> Did you call DropLock() right after copying the data on the newly allocated
> block? This assertion shows the raster block have remained in locked state.
>

OK, I commented this part during tests, -1 for me. The assertion
disappeared. Many thanks.

And about the time, it's only when executing gdalinfo with options
"-mm -stats -checksum". Takes about 35 seconds, with this image
http://download.osgeo.org/gdal/data/gtiff/utm.tif and one overview of
factor 2 (50% of size in both dimensions). I suppose is normal...

> It's quite annoying if you find long executing times somewhere. Did you know
> how much time required to fetch the data and place that into the internal
> buffer.
>
> One issue with this concept would be related to the limited memory size of
> the particular machine, it may be more reasonable to copy the retrieved
> blocks directly onto the output buffer if possible. In this case you cannot
> much rely on the base RasterIO implementation.

So, you suggest to copy the block data into the buffer without calling
base implementation of IRasterIO, do you? This implies take care of
the endianess and pixel size "by hand".

Best regards,
Jorge

>
> Best regards,
>
> Tamas
>
>
>
> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> Hello,
>>
>> Context: GDAL WKT Raster driver
>>
>> In my class derived from GDALRasterBand, I've overrided the methods:
>>
>> - IReadBlock: Fetch a block from database
>> - IRasterIO: Should fetch several blocks, that cover an area, and add
>> them to papoBlocks (cache). The idea is to avoid rounds in the server
>>
>> AFAIK, the base IRasterIO implementation (in GDALRasterBand), tries to
>> fetch the block from the cache. If the block isn't in the cache, then
>> call to IReadBlock. So, the normal way to read blocks in any GDAL
>> driver should be IRasterIO --> IReadBlock
>>
>> Then, If I override IRasterIO in my driver RasterBand's class, I
>> should fetch several blocks in one round and call GetLockedBlockRef to
>> add these blocks to the cache. After this, call the base
>> implementation of IRasterIO (in GDALRasterBand) to do its work (see
>> previous point).
>>
>> Is it correct? I have problems with my IRasterIO implementation,
>> because it takes a long time executing until this fail:
>>
>> ERROR 7: Assertion `nLockCount == 0' failed
>> in file `gdalrasterblock.cpp', line 228
>>
>> Is there any mistake in this approach? If not, I suppose I had to
>> debug my queries, but I'd like to rule our wrong concepts first.
>>
>> Many thanks in advance.
>>
>> Best regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
From szekerest at gmail.com  Fri Aug  7 16:17:36 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  7 16:25:46 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
Message-ID: <f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>

2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>

>
> > One issue with this concept would be related to the limited memory size
> of
> > the particular machine, it may be more reasonable to copy the retrieved
> > blocks directly onto the output buffer if possible. In this case you
> cannot
> > much rely on the base RasterIO implementation.
>
> So, you suggest to copy the block data into the buffer without calling
> base implementation of IRasterIO, do you? This implies take care of
> the endianess and pixel size "by hand".
>

And many more... I agree this wouldn't be that straightforward. Populating
the block buffer would be much easier.

Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/466d309c/attachment.html
From even.rouault at mines-paris.org  Fri Aug  7 16:31:24 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Aug  7 16:31:31 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from
	GDALRasterBand
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
Message-ID: <00e901ca179e$08563720$0c00a8c0@pctiphaine>


----- Original Message ----- 
From: "Jorge Ar?valo" <jorge.arevalo@gmail.com>
To: "Tamas Szekeres" <szekerest@gmail.com>
Cc: "gdal-dev" <gdal-dev@lists.osgeo.org>
Sent: Friday, August 07, 2009 7:43 PM
Subject: Re: [gdal-dev] Overriding IRasterIO in class derived from 
GDALRasterBand


>OK, I commented this part during tests, -1 for me. The assertion
>disappeared. Many thanks.

>And about the time, it's only when executing gdalinfo with options
>"-mm -stats -checksum". Takes about 35 seconds, with this image
>http://download.osgeo.org/gdal/data/gtiff/utm.tif and one overview of
>factor 2 (50% of size in both dimensions). I suppose is normal...

This looks quite slow to me for a modest 512x512 raster. 
"gdalinfo -mm -stats -checksum utm.tif" takes less than one second.
You should try to profile what is slow exactly : the DB request (server-side 
performance issue ?), the decoding of the result, ...

>So, you suggest to copy the block data into the buffer without calling
>base implementation of IRasterIO, do you? This implies take care of
>the endianess and pixel size "by hand".

Implementing yourself all the cases of IRasterIO will be complicated. Just 
look at GDALRasterBand::IRasterIO in rasterio.cpp. If you really want to 
implement it, I'd advise you to only concentrate first on a few common 
cases, like when the output buffer size is equal to the source buffer size 
(nXSize == nBufXSize && nYSize == nBufYSize). For other cases, default to 
the base implementation.

>Best regards,
>Jorge

>
> Best regards,
>
> Tamas
>
>
>
> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> Hello,
>>
>> Context: GDAL WKT Raster driver
>>
>> In my class derived from GDALRasterBand, I've overrided the methods:
>>
>> - IReadBlock: Fetch a block from database
>> - IRasterIO: Should fetch several blocks, that cover an area, and add
>> them to papoBlocks (cache). The idea is to avoid rounds in the server
>>
>> AFAIK, the base IRasterIO implementation (in GDALRasterBand), tries to
>> fetch the block from the cache. If the block isn't in the cache, then
>> call to IReadBlock. So, the normal way to read blocks in any GDAL
>> driver should be IRasterIO --> IReadBlock
>>
>> Then, If I override IRasterIO in my driver RasterBand's class, I
>> should fetch several blocks in one round and call GetLockedBlockRef to
>> add these blocks to the cache. After this, call the base
>> implementation of IRasterIO (in GDALRasterBand) to do its work (see
>> previous point).
>>
>> Is it correct? I have problems with my IRasterIO implementation,
>> because it takes a long time executing until this fail:
>>
>> ERROR 7: Assertion `nLockCount == 0' failed
>> in file `gdalrasterblock.cpp', line 228
>>
>> Is there any mistake in this approach? If not, I suppose I had to
>> debug my queries, but I'd like to rule our wrong concepts first.
>>
>> Many thanks in advance.
>>
>> Best regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



From szekerest at gmail.com  Fri Aug  7 16:32:56 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  7 16:32:58 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
Message-ID: <f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>

Just thinking out loadly;

Wouldn't it be easier to implement that cache at the driver level, just by
composing the raster in a temp image buffer and feed that image in the
subsequent IReadBlock calls? I think we should also think about the non
regular and overlapping blocks which should also be covered by the
implementation here.

Best regards,

Tamas




2009/8/7 Tamas Szekeres <szekerest@gmail.com>

>
>
> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>
>>
>> > One issue with this concept would be related to the limited memory size
>> of
>> > the particular machine, it may be more reasonable to copy the retrieved
>> > blocks directly onto the output buffer if possible. In this case you
>> cannot
>> > much rely on the base RasterIO implementation.
>>
>> So, you suggest to copy the block data into the buffer without calling
>> base implementation of IRasterIO, do you? This implies take care of
>> the endianess and pixel size "by hand".
>>
>
> And many more... I agree this wouldn't be that straightforward. Populating
> the block buffer would be much easier.
>
> Best regards,
>
> Tamas
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/b14d59f3/attachment.html
From jason.roberts at duke.edu  Fri Aug  7 18:05:28 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Fri Aug  7 18:05:35 2009
Subject: [gdal-dev] With 1.6.2,
	still can't read ArcInfo binary grids: GDAL Error 3:
	Attempt to read past EOF in
	C:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
Message-ID: <00b101ca17ab$2d0ec6b0$872c5410$@roberts@duke.edu>

Hi all,

 

I am using rgdal to read ArcInfo binary grids produced by ArcGIS. The latest
public version of rgdal, which binds with GDAL 1.6.1, fails with the error
message in the subject line of this email. I reported this a couple of weeks
ago in http://lists.osgeo.org/pipermail/gdal-dev/2009-July/021369.html.

 

Today, the rgdal developer (Roger Bivand) provided me with an rgdal built
against the 1.6.2 release candidate issued 31 July. The problem still
exists.

 

The problem had apparently been seen before. My original email prompted a
review of the issue, including mention of it being tracked in tickets #2447
and #3031. Evan made some checkins on 22 July that I thought would result in
this being fixed in both the trunk and the next release of 1.6 (which would
be 1.6.2). But I guess I did not fully understand it, and I missed the fact
that neither of these issues appeared in Howard's 31 July release candidate
email.

 

So: is there any chance the GDAL team can fix this in either 1.6.2 or, if it
is now too late, 1.6.3?

 

It may be that this fell off the radar because the severity of the tickets
(for example, #3031 is minor), or because there was a suggested workaround
that users could simply rename the "info" directory to prevent GDAL from
failing. Well the issue is indeed severe if you are an ArcGIS user. In my
case, the rasters were produced by ArcGIS 9.3.1. Presumably ESRI is
generating the rasters correctly. The workaround of renaming the info
directory is not a good idea. That renders all of the rasters in a directory
inaccessible to ArcGIS. It is a major corruption of the ArcInfo binary grid
format to do so. I'm not sure why it was suggested in the first place, but
it is a very bad idea.

 

I'm sorry for not staying on top of this issue and somehow missing that it
was not put into 1.6.2 and that the workaround is such as bad idea. In any
case, could you please consider fixing this in 1.6 soon? I can provide
example data if needed.

 

Thanks,

 

Jason

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090807/c755e968/attachment.html
From even.rouault at mines-paris.org  Sat Aug  8 08:12:59 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Aug  8 08:13:05 2009
Subject: [gdal-dev] With 1.6.2,
	still can't read ArcInfo binary grids: GDAL Error 3:Attempt to read
	past EOF
	inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
References: <00b101ca17ab$2d0ec6b0$872c5410$@roberts@duke.edu>
Message-ID: <002a01ca1821$925a76b0$0c00a8c0@pctiphaine>


----- Original Message ----- 
From: Jason Roberts
To: gdal-dev@lists.osgeo.org
Cc: 'Roger Bivand'
Sent: Saturday, August 08, 2009 12:05 AM
Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids: GDAL 
Error 3:Attempt to read past EOF 
inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.


> Hi all,

> I am using rgdal to read ArcInfo binary grids produced by ArcGIS. The 
> latest public version of rgdal, which binds with GDAL 1.6.1, fails with 
> the
> error message in the subject line of this email. I reported this a couple 
> of weeks ago in 
> http://lists.osgeo.org/pipermail/gdal-dev/2009-July/021369.html.

> Today, the rgdal developer (Roger Bivand) provided me with an rgdal built 
> against the 1.6.2 release candidate issued 31 July. The problem still 
> exists.

OK, I've looked more closely at 
http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/src/gdal-bindings.cpp?revision=1.32&view=markup 
and I see RGDAL defines its own error handler for GDAL errors (around lines 
114-134). So the fix pushed in 1.6.2 that solves the issue for Python and 
other bindings languages will not help for the RGDAL case as the error() 
call probably causes a R exception to be thrown. As I've no knowledge of R, 
it is just wild guessing.

RGDAL_OpenDataset() could be modified so that its own error handler is not 
used during GDALOpen. Something like this might do it :

...
CPLErrorReset();
CPLPushErrorHandler(CPLDefaultErrorHandler);
GDALDataset *pDataset = (GDALDataset *) GDALOpen(fn, RWFlag);
CPLPopErrorHandler();
// Similarly to SWIG bindings, the following lines will cause 
RGDAL_OpenDataset() to fail on - unclearred - errors even if pDataset is not 
NULL.
// They could also be just removed. While pDataset != NULL, there's some 
hope ;-)
CPLErr eclass = CPLGetLastErrorType();
if (pDataset != NULL && eclass == CE_Failure)
{
    GDALClose(pDataset);
    pDataset = NULL;
    __errorHandler(eclass, CPLGetLastErrorNo(), CPLGetLastErrorMsg());
}

if (pDataset == NULL)
    error("Could not open file: %s\n", filename);
....

Note this is uncompiled & untested, but that should avoid similar situations 
in other drivers (non fatal errors triggered during dataset opening and 
cleared by CPLErrorReset() ) to occur .

> The problem had apparently been seen before. My original email prompted a 
> review of the issue, including mention of it being tracked in tickets
> #2447 and #3031. Evan made some checkins on 22 July that I thought would 
> result in this being fixed in both the trunk and the next release of 1.6
> (which would be 1.6.2). But I guess I did not fully understand it, and I 
> missed the fact that neither of these issues appeared in Howard's 31 July
> release candidate email.

The tickets are not mentionned in Howard's email because the fix is only 
partial and the tickets still open.

> So: is there any chance the GDAL team can fix this in either 1.6.2 or, if 
> it is now too late, 1.6.3?

> It may be that this fell off the radar because the severity of the tickets 
> (for example, #3031 is minor), or because there was a suggested workaround
> that users could simply rename the "info" directory to prevent GDAL from 
> failing. Well the issue is indeed severe if you are an ArcGIS user. In my
> case, the rasters were produced by ArcGIS 9.3.1. Presumably ESRI is 
> generating the rasters correctly. The workaround of renaming the info
> directory is not a good idea. That renders all of the rasters in a 
> directory inaccessible to ArcGIS. It is a major corruption of the ArcInfo 
> binary grid
> format to do so. I'm not sure why it was suggested in the first place, but 
> it is a very bad idea.

Eh! workarounds are workarounds and generally not very elegant. It enables 
GDAL to avoids reading the VAT table, but if ArcGIS doesn't like it, that's 
another story... The advantage with renaming is that you can undo it when 
necessary... Anyway, you're free of ignoring it if you don't like it.

> I'm sorry for not staying on top of this issue and somehow missing that it 
> was not put into 1.6.2 and that the workaround is such as bad idea. In any
> case, could you please consider fixing this in 1.6 soon? I can provide 
> example data if needed.

#3031 has already a link to sample data that triggers the error message. You 
just need to find and convince someone that has time and knowledge of the 
AVC driver.

> Thanks,

> Jason



_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 


From Roger.Bivand at nhh.no  Sat Aug  8 09:21:03 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat Aug  8 09:22:11 2009
Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids:
	GDAL Error 3:Attempt to read past EOF
	inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
In-Reply-To: <002a01ca1821$925a76b0$0c00a8c0@pctiphaine>
References: <00b101ca17ab$2d0ec6b0$872c5410$@roberts@duke.edu>
	<002a01ca1821$925a76b0$0c00a8c0@pctiphaine>
Message-ID: <alpine.LRH.2.00.0908081515070.3660@reclus.nhh.no>

On Sat, 8 Aug 2009, Even Rouault wrote:

>
> ----- Original Message ----- From: Jason Roberts
> To: gdal-dev@lists.osgeo.org
> Cc: 'Roger Bivand'
> Sent: Saturday, August 08, 2009 12:05 AM
> Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids: GDAL 
> Error 3:Attempt to read past EOF 
> inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
>
>
>> Hi all,
>
>> I am using rgdal to read ArcInfo binary grids produced by ArcGIS. The 
>> latest public version of rgdal, which binds with GDAL 1.6.1, fails with the
>> error message in the subject line of this email. I reported this a couple 
>> of weeks ago in 
>> http://lists.osgeo.org/pipermail/gdal-dev/2009-July/021369.html.
>
>> Today, the rgdal developer (Roger Bivand) provided me with an rgdal built 
>> against the 1.6.2 release candidate issued 31 July. The problem still 
>> exists.
>
> OK, I've looked more closely at 
> http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/src/gdal-bindings.cpp?revision=1.32&view=markup 
> and I see RGDAL defines its own error handler for GDAL errors (around lines 
> 114-134). So the fix pushed in 1.6.2 that solves the issue for Python and 
> other bindings languages will not help for the RGDAL case as the error() call 
> probably causes a R exception to be thrown. As I've no knowledge of R, it is 
> just wild guessing.

Even, Jason,

Thanks, this looks helpful. I'll try to see how it fits into the error 
handler put in place from the R side. An R error() unwinds all the way up 
the call trace in C/C++ through to the R code; there is a warning() that 
could be used for non-fatal GDAL errors (though it isn't obvious which 
ones shouldn't be fatal, and since we're in a running R session, we cannot 
really allow anything not safe to persist (like a handle to a dataset not 
opened properly).

Jason, please send me off-list an example offending file (or link if big) 
so that I'll know when I'm making progress.

Roger

>
> RGDAL_OpenDataset() could be modified so that its own error handler is not 
> used during GDALOpen. Something like this might do it :
>
> ...
> CPLErrorReset();
> CPLPushErrorHandler(CPLDefaultErrorHandler);
> GDALDataset *pDataset = (GDALDataset *) GDALOpen(fn, RWFlag);
> CPLPopErrorHandler();
> // Similarly to SWIG bindings, the following lines will cause 
> RGDAL_OpenDataset() to fail on - unclearred - errors even if pDataset is not 
> NULL.
> // They could also be just removed. While pDataset != NULL, there's some hope 
> ;-)
> CPLErr eclass = CPLGetLastErrorType();
> if (pDataset != NULL && eclass == CE_Failure)
> {
>   GDALClose(pDataset);
>   pDataset = NULL;
>   __errorHandler(eclass, CPLGetLastErrorNo(), CPLGetLastErrorMsg());
> }
>
> if (pDataset == NULL)
>   error("Could not open file: %s\n", filename);
> ....
>
> Note this is uncompiled & untested, but that should avoid similar situations 
> in other drivers (non fatal errors triggered during dataset opening and 
> cleared by CPLErrorReset() ) to occur .
>
>> The problem had apparently been seen before. My original email prompted a 
>> review of the issue, including mention of it being tracked in tickets
>> #2447 and #3031. Evan made some checkins on 22 July that I thought would 
>> result in this being fixed in both the trunk and the next release of 1.6
>> (which would be 1.6.2). But I guess I did not fully understand it, and I 
>> missed the fact that neither of these issues appeared in Howard's 31 July
>> release candidate email.
>
> The tickets are not mentionned in Howard's email because the fix is only 
> partial and the tickets still open.
>
>> So: is there any chance the GDAL team can fix this in either 1.6.2 or, if 
>> it is now too late, 1.6.3?
>
>> It may be that this fell off the radar because the severity of the tickets 
>> (for example, #3031 is minor), or because there was a suggested workaround
>> that users could simply rename the "info" directory to prevent GDAL from 
>> failing. Well the issue is indeed severe if you are an ArcGIS user. In my
>> case, the rasters were produced by ArcGIS 9.3.1. Presumably ESRI is 
>> generating the rasters correctly. The workaround of renaming the info
>> directory is not a good idea. That renders all of the rasters in a 
>> directory inaccessible to ArcGIS. It is a major corruption of the ArcInfo 
>> binary grid
>> format to do so. I'm not sure why it was suggested in the first place, but 
>> it is a very bad idea.
>
> Eh! workarounds are workarounds and generally not very elegant. It enables 
> GDAL to avoids reading the VAT table, but if ArcGIS doesn't like it, that's 
> another story... The advantage with renaming is that you can undo it when 
> necessary... Anyway, you're free of ignoring it if you don't like it.
>
>> I'm sorry for not staying on top of this issue and somehow missing that it 
>> was not put into 1.6.2 and that the workaround is such as bad idea. In any
>> case, could you please consider fixing this in 1.6 soon? I can provide 
>> example data if needed.
>
> #3031 has already a link to sample data that triggers the error message. You 
> just need to find and convince someone that has time and knowledge of the AVC 
> driver.
>
>> Thanks,
>
>> Jason
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From mitchelljj98 at gmail.com  Sat Aug  8 10:15:14 2009
From: mitchelljj98 at gmail.com (John Mitchell)
Date: Sat Aug  8 10:15:17 2009
Subject: [gdal-dev] How would run the geographic query against the shape
	file via a gdal command line program?
Message-ID: <fa2ac0580908080715i1b211848vf218cbb9aa48c36e@mail.gmail.com>

I have tried running both gdalwarp and gdal_merge against a subset of
hundreds of geotiff images via geographic bounding box.
I would like to speed up the performance by running a geographic query
against the shape file which was already created via gdaltindex against all
the geotiff images.
Next I would like to take the selected objects from the shapefile and use
the location field to derive all geotiffs which are then used to as source
to run against gdal_merge or gdalwarp.

How would run the geographic query against the shape file via a gdal command
line program?

Thanks,

John J. Mitchell
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090808/ec31aa31/attachment.html
From jason.roberts at duke.edu  Sat Aug  8 10:16:16 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Sat Aug  8 10:16:23 2009
Subject: [gdal-dev] With 1.6.2,
	still can't read ArcInfo binary grids: GDAL Error 3:Attempt to read
	past EOF
	inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
In-Reply-To: <alpine.LRH.2.00.0908081515070.3660@reclus.nhh.no>
References: <00b101ca17ab$2d0ec6b0$872c5410$%roberts@duke.edu>
	<002a01ca1821$925a76b0$0c00a8c0@pctiphaine>
	<alpine.LRH.2.00.0908081515070.3660@reclus.nhh.no>
Message-ID: <000001ca1832$cb2ce930$6186bb90$@roberts@duke.edu>

Evan and Roger,

Thanks for clarifying the situation and coming up with a solution. I'm very
happy to hear that this can probably be addressed with the existing 1.6.2
release candidate. Kudos to both of you.

The idea of bubbling this non-fatal error up as a warning from rgdal sounds
ok, but not great as a long term solution. If I bubble it up to my user (an
ecologist, typically, sitting in front of a GUI) I will need to document
that they can safely ignore this warning because it does not really mean
anything. Or I could try to catch this specific warning and just not report
it. Roger faces the same decision about bubbling for his code (he just has a
more programming-savvy user, usually sitting in front of the R console).
Ultimately it would be best if GDAL would not report this warning. If the
root problem is that ESRI is generating grids that violate their own format,
then we should tell them (I can contact them, if you don't want to). But if
their grids are correct, GDAL should be fixed whenever the resources are
available.

Thanks again!

Jason

-----Original Message-----
From: Roger Bivand [mailto:Roger.Bivand@nhh.no] 
Sent: Saturday, August 08, 2009 9:21 AM
To: Even Rouault
Cc: Jason Roberts; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids:
GDAL Error 3:Attempt to read past EOF
inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.

On Sat, 8 Aug 2009, Even Rouault wrote:

>
> ----- Original Message ----- From: Jason Roberts
> To: gdal-dev@lists.osgeo.org
> Cc: 'Roger Bivand'
> Sent: Saturday, August 08, 2009 12:05 AM
> Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids: GDAL

> Error 3:Attempt to read past EOF 
> inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
>
>
>> Hi all,
>
>> I am using rgdal to read ArcInfo binary grids produced by ArcGIS. The 
>> latest public version of rgdal, which binds with GDAL 1.6.1, fails with
the
>> error message in the subject line of this email. I reported this a couple

>> of weeks ago in 
>> http://lists.osgeo.org/pipermail/gdal-dev/2009-July/021369.html.
>
>> Today, the rgdal developer (Roger Bivand) provided me with an rgdal built

>> against the 1.6.2 release candidate issued 31 July. The problem still 
>> exists.
>
> OK, I've looked more closely at 
>
http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/src/gdal-bindings.cpp?re
vision=1.32&view=markup 
> and I see RGDAL defines its own error handler for GDAL errors (around
lines 
> 114-134). So the fix pushed in 1.6.2 that solves the issue for Python and 
> other bindings languages will not help for the RGDAL case as the error()
call 
> probably causes a R exception to be thrown. As I've no knowledge of R, it
is 
> just wild guessing.

Even, Jason,

Thanks, this looks helpful. I'll try to see how it fits into the error 
handler put in place from the R side. An R error() unwinds all the way up 
the call trace in C/C++ through to the R code; there is a warning() that 
could be used for non-fatal GDAL errors (though it isn't obvious which 
ones shouldn't be fatal, and since we're in a running R session, we cannot 
really allow anything not safe to persist (like a handle to a dataset not 
opened properly).

Jason, please send me off-list an example offending file (or link if big) 
so that I'll know when I'm making progress.

Roger

>
> RGDAL_OpenDataset() could be modified so that its own error handler is not

> used during GDALOpen. Something like this might do it :
>
> ...
> CPLErrorReset();
> CPLPushErrorHandler(CPLDefaultErrorHandler);
> GDALDataset *pDataset = (GDALDataset *) GDALOpen(fn, RWFlag);
> CPLPopErrorHandler();
> // Similarly to SWIG bindings, the following lines will cause 
> RGDAL_OpenDataset() to fail on - unclearred - errors even if pDataset is
not 
> NULL.
> // They could also be just removed. While pDataset != NULL, there's some
hope 
> ;-)
> CPLErr eclass = CPLGetLastErrorType();
> if (pDataset != NULL && eclass == CE_Failure)
> {
>   GDALClose(pDataset);
>   pDataset = NULL;
>   __errorHandler(eclass, CPLGetLastErrorNo(), CPLGetLastErrorMsg());
> }
>
> if (pDataset == NULL)
>   error("Could not open file: %s\n", filename);
> ....
>
> Note this is uncompiled & untested, but that should avoid similar
situations 
> in other drivers (non fatal errors triggered during dataset opening and 
> cleared by CPLErrorReset() ) to occur .
>
>> The problem had apparently been seen before. My original email prompted a

>> review of the issue, including mention of it being tracked in tickets
>> #2447 and #3031. Evan made some checkins on 22 July that I thought would 
>> result in this being fixed in both the trunk and the next release of 1.6
>> (which would be 1.6.2). But I guess I did not fully understand it, and I 
>> missed the fact that neither of these issues appeared in Howard's 31 July
>> release candidate email.
>
> The tickets are not mentionned in Howard's email because the fix is only 
> partial and the tickets still open.
>
>> So: is there any chance the GDAL team can fix this in either 1.6.2 or, if

>> it is now too late, 1.6.3?
>
>> It may be that this fell off the radar because the severity of the
tickets 
>> (for example, #3031 is minor), or because there was a suggested
workaround
>> that users could simply rename the "info" directory to prevent GDAL from 
>> failing. Well the issue is indeed severe if you are an ArcGIS user. In my
>> case, the rasters were produced by ArcGIS 9.3.1. Presumably ESRI is 
>> generating the rasters correctly. The workaround of renaming the info
>> directory is not a good idea. That renders all of the rasters in a 
>> directory inaccessible to ArcGIS. It is a major corruption of the ArcInfo

>> binary grid
>> format to do so. I'm not sure why it was suggested in the first place,
but 
>> it is a very bad idea.
>
> Eh! workarounds are workarounds and generally not very elegant. It enables

> GDAL to avoids reading the VAT table, but if ArcGIS doesn't like it,
that's 
> another story... The advantage with renaming is that you can undo it when 
> necessary... Anyway, you're free of ignoring it if you don't like it.
>
>> I'm sorry for not staying on top of this issue and somehow missing that
it 
>> was not put into 1.6.2 and that the workaround is such as bad idea. In
any
>> case, could you please consider fixing this in 1.6 soon? I can provide 
>> example data if needed.
>
> #3031 has already a link to sample data that triggers the error message.
You 
> just need to find and convince someone that has time and knowledge of the
AVC 
> driver.
>
>> Thanks,
>
>> Jason
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no


From jorge.arevalo at gmail.com  Sat Aug  8 11:43:05 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Aug  8 11:43:28 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com> 
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com> 
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com> 
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
Message-ID: <cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>

Hello,

2009/8/7 Tamas Szekeres <szekerest@gmail.com>:
> Just thinking out loadly;
>
> Wouldn't it be easier to implement that cache at the driver level, just by
> composing the raster in a temp image buffer and feed that image in the
> subsequent IReadBlock calls? I think we should also think about the non
> regular and overlapping blocks which should also be covered by the
> implementation here.
>

And this buffer, would it be part of the Dataset, as a property?
What's the common way of reading data with a GDAL driver? I suppose
that the sequence is like this:

User's program --> GDALRasterBand::RasterIO --> Format specific
IRasterIO --> Format specific IReadBlock.

If the format speficic IRasterIO is not implemented, the generic
GDALRasterBand::IRasterIO is called, and this method calls IReadBlock
if needed (by GetLockedBlockRef).

Am I right?

If yes, in what point should I implement the cache at "driver level"?

Thanks in advance

Best regards,
Jorge

> Best regards,
>
> Tamas
>
>
>
>
> 2009/8/7 Tamas Szekeres <szekerest@gmail.com>
>>
>>
>> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>>
>>> > One issue with this concept would be related to the limited memory size
>>> > of
>>> > the particular machine, it may be more reasonable to copy the retrieved
>>> > blocks directly onto the output buffer if possible. In this case you
>>> > cannot
>>> > much rely on the base RasterIO implementation.
>>>
>>> So, you suggest to copy the block data into the buffer without calling
>>> base implementation of IRasterIO, do you? This implies take care of
>>> the endianess and pixel size "by hand".
>>
>> And many more... I agree this wouldn't be that straightforward. Populating
>> the block buffer would be much easier.
>>
>> Best regards,
>>
>> Tamas
>>
>
>
From peifer at gmx.eu  Sat Aug  8 11:47:17 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Aug  8 11:47:31 2009
Subject: [gdal-dev] Re: How would run the geographic query against the shape
 file via a gdal command line program?
In-Reply-To: <fa2ac0580908080715i1b211848vf218cbb9aa48c36e@mail.gmail.com>
References: <fa2ac0580908080715i1b211848vf218cbb9aa48c36e@mail.gmail.com>
Message-ID: <h5k6m5$t07$1@ger.gmane.org>

John Mitchell wrote:
> I have tried running both gdalwarp and gdal_merge against a subset of
> hundreds of geotiff images via geographic bounding box.
> I would like to speed up the performance by running a geographic query
> against the shape file which was already created via gdaltindex against all
> the geotiff images.
> Next I would like to take the selected objects from the shapefile and use
> the location field to derive all geotiffs which are then used to as source
> to run against gdal_merge or gdalwarp.
> 
> How would run the geographic query against the shape file via a gdal command
> line program?
> 

You could use:

ogrinfo -spat xmin ymin xmax ymax

man ogrinfo says about the spat argument:
> The area of interest. Only features within the rectangle will be reported. 


A hack, rather than a solution could be in your case:

TIFF_LIST=$(ogrinfo -ro -al -geom=NO -spat xmin ymin xmax ymax your_index.shp |
awk '/location.*=/{list = list " " $NF}END{print list}')

... followed by:

gdalwarp $TIFF_LIST outfile.tif

The above assumes geotiff file names without spaces. There must be smarter solutions, perhaps by constructing a cutline for galwarp.

Hermann

From szekerest at gmail.com  Sat Aug  8 13:35:24 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug  8 13:35:28 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>
Message-ID: <f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>

Hi Jorge,

What I have in my mind is something like the DirectRasterIO implementation
in  WCSDataset / WCSRasterBand (see wcsdataset.cpp). It appears that this
driver is suffering from the same issue, and intend to minimize the
roundtrips to the server as much as possible. It looks like this direct
implementation doesn't rely on IReadBlock called by an upper level IRasterIO
therefore the RasterBlock cache is also omitted in this case.


Best regards,

Tamas



2009/8/8 Jorge Ar?valo <jorge.arevalo@gmail.com>

> Hello,
>
> 2009/8/7 Tamas Szekeres <szekerest@gmail.com>:
> > Just thinking out loadly;
> >
> > Wouldn't it be easier to implement that cache at the driver level, just
> by
> > composing the raster in a temp image buffer and feed that image in the
> > subsequent IReadBlock calls? I think we should also think about the non
> > regular and overlapping blocks which should also be covered by the
> > implementation here.
> >
>
> And this buffer, would it be part of the Dataset, as a property?
> What's the common way of reading data with a GDAL driver? I suppose
> that the sequence is like this:
>
> User's program --> GDALRasterBand::RasterIO --> Format specific
> IRasterIO --> Format specific IReadBlock.
>
> If the format speficic IRasterIO is not implemented, the generic
> GDALRasterBand::IRasterIO is called, and this method calls IReadBlock
> if needed (by GetLockedBlockRef).
>
> Am I right?
>
> If yes, in what point should I implement the cache at "driver level"?
>
> Thanks in advance
>
> Best regards,
> Jorge
>
> > Best regards,
> >
> > Tamas
> >
> >
> >
> >
> > 2009/8/7 Tamas Szekeres <szekerest@gmail.com>
> >>
> >>
> >> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
> >>>
> >>> > One issue with this concept would be related to the limited memory
> size
> >>> > of
> >>> > the particular machine, it may be more reasonable to copy the
> retrieved
> >>> > blocks directly onto the output buffer if possible. In this case you
> >>> > cannot
> >>> > much rely on the base RasterIO implementation.
> >>>
> >>> So, you suggest to copy the block data into the buffer without calling
> >>> base implementation of IRasterIO, do you? This implies take care of
> >>> the endianess and pixel size "by hand".
> >>
> >> And many more... I agree this wouldn't be that straightforward.
> Populating
> >> the block buffer would be much easier.
> >>
> >> Best regards,
> >>
> >> Tamas
> >>
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090808/2fbd69a0/attachment.html
From jorge.arevalo at gmail.com  Sun Aug  9 07:41:06 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  9 07:41:28 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <00e901ca179e$08563720$0c00a8c0@pctiphaine>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com> 
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com> 
	<00e901ca179e$08563720$0c00a8c0@pctiphaine>
Message-ID: <cb4457700908090441pce9b046x8501b2f485293f3d@mail.gmail.com>

2009/8/7 Even Rouault <even.rouault@mines-paris.org>:
>
> ----- Original Message ----- From: "Jorge Ar?valo" <jorge.arevalo@gmail.com>
> To: "Tamas Szekeres" <szekerest@gmail.com>
> Cc: "gdal-dev" <gdal-dev@lists.osgeo.org>
> Sent: Friday, August 07, 2009 7:43 PM
> Subject: Re: [gdal-dev] Overriding IRasterIO in class derived from
> GDALRasterBand
>
>
>> OK, I commented this part during tests, -1 for me. The assertion
>> disappeared. Many thanks.
>
>> And about the time, it's only when executing gdalinfo with options
>> "-mm -stats -checksum". Takes about 35 seconds, with this image
>> http://download.osgeo.org/gdal/data/gtiff/utm.tif and one overview of
>> factor 2 (50% of size in both dimensions). I suppose is normal...
>
> This looks quite slow to me for a modest 512x512 raster. "gdalinfo -mm
> -stats -checksum utm.tif" takes less than one second.
> You should try to profile what is slow exactly : the DB request (server-side
> performance issue ?), the decoding of the result, ...

Ok, I debugged it and now is faster. But sometimes I get errors
because invalid block offsets. So, I need more debug...

>
>> So, you suggest to copy the block data into the buffer without calling
>> base implementation of IRasterIO, do you? This implies take care of
>> the endianess and pixel size "by hand".
>
> Implementing yourself all the cases of IRasterIO will be complicated. Just
> look at GDALRasterBand::IRasterIO in rasterio.cpp. If you really want to
> implement it, I'd advise you to only concentrate first on a few common
> cases, like when the output buffer size is equal to the source buffer size
> (nXSize == nBufXSize && nYSize == nBufYSize). For other cases, default to
> the base implementation.
>

Really complicated... Maybe I should take a different way, like Tamas'
suggestion.

Best regards,
Jorge

>> Best regards,
>> Jorge
>
>>
>> Best regards,
>>
>> Tamas
>>
>>
>>
>> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>>
>>> Hello,
>>>
>>> Context: GDAL WKT Raster driver
>>>
>>> In my class derived from GDALRasterBand, I've overrided the methods:
>>>
>>> - IReadBlock: Fetch a block from database
>>> - IRasterIO: Should fetch several blocks, that cover an area, and add
>>> them to papoBlocks (cache). The idea is to avoid rounds in the server
>>>
>>> AFAIK, the base IRasterIO implementation (in GDALRasterBand), tries to
>>> fetch the block from the cache. If the block isn't in the cache, then
>>> call to IReadBlock. So, the normal way to read blocks in any GDAL
>>> driver should be IRasterIO --> IReadBlock
>>>
>>> Then, If I override IRasterIO in my driver RasterBand's class, I
>>> should fetch several blocks in one round and call GetLockedBlockRef to
>>> add these blocks to the cache. After this, call the base
>>> implementation of IRasterIO (in GDALRasterBand) to do its work (see
>>> previous point).
>>>
>>> Is it correct? I have problems with my IRasterIO implementation,
>>> because it takes a long time executing until this fail:
>>>
>>> ERROR 7: Assertion `nLockCount == 0' failed
>>> in file `gdalrasterblock.cpp', line 228
>>>
>>> Is there any mistake in this approach? If not, I suppose I had to
>>> debug my queries, but I'd like to rule our wrong concepts first.
>>>
>>> Many thanks in advance.
>>>
>>> Best regards,
>>> Jorge
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
From Roger.Bivand at nhh.no  Sun Aug  9 09:46:31 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sun Aug  9 09:46:35 2009
Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids:
	GDAL Error 3:Attempt to read past EOF
	inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
In-Reply-To: <alpine.LRH.2.00.0908081515070.3660@reclus.nhh.no>
References: <00b101ca17ab$2d0ec6b0$872c5410$@roberts@duke.edu>
	<002a01ca1821$925a76b0$0c00a8c0@pctiphaine>
	<alpine.LRH.2.00.0908081515070.3660@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.0908091542150.14423@reclus.nhh.no>

On Sat, 8 Aug 2009, Roger Bivand wrote:

> On Sat, 8 Aug 2009, Even Rouault wrote:
>
>> 
>> ----- Original Message ----- From: Jason Roberts
>> To: gdal-dev@lists.osgeo.org
>> Cc: 'Roger Bivand'
>> Sent: Saturday, August 08, 2009 12:05 AM
>> Subject: [gdal-dev] With 1.6.2,still can't read ArcInfo binary grids: GDAL 
>> Error 3:Attempt to read past EOF 
>> inC:\Temp\GeoEcoTemp_Jason\tmpopx_s3\projected0a/../info/arc.dir.
>> 
>> 
>>> Hi all,
>> 
>>> I am using rgdal to read ArcInfo binary grids produced by ArcGIS. The 
>>> latest public version of rgdal, which binds with GDAL 1.6.1, fails with 
>>> the
>>> error message in the subject line of this email. I reported this a couple 
>>> of weeks ago in 
>>> http://lists.osgeo.org/pipermail/gdal-dev/2009-July/021369.html.
>> 
>>> Today, the rgdal developer (Roger Bivand) provided me with an rgdal built 
>>> against the 1.6.2 release candidate issued 31 July. The problem still 
>>> exists.
>> 
>> OK, I've looked more closely at 
>> http://rgdal.cvs.sourceforge.net/viewvc/rgdal/rgdal/src/gdal-bindings.cpp?revision=1.32&view=markup 
>> and I see RGDAL defines its own error handler for GDAL errors (around lines 
>> 114-134). So the fix pushed in 1.6.2 that solves the issue for Python and 
>> other bindings languages will not help for the RGDAL case as the error() 
>> call probably causes a R exception to be thrown. As I've no knowledge of R, 
>> it is just wild guessing.
>
> Even, Jason,
>
> Thanks, this looks helpful. I'll try to see how it fits into the error 
> handler put in place from the R side. An R error() unwinds all the way up the 
> call trace in C/C++ through to the R code; there is a warning() that could be 
> used for non-fatal GDAL errors (though it isn't obvious which ones shouldn't 
> be fatal, and since we're in a running R session, we cannot really allow 
> anything not safe to persist (like a handle to a dataset not opened 
> properly).

Using Even's suggestion with modifications (using REprintf(...) rather 
than fprintf(stderr, ...) to make sure messages if needed get displayed in 
the default error handler, or the quiet default handler otherwise), the 
problem in rgdal for offending AIG cases is now resolved - the Windows 
binary rgdal package will be built against 1.6.2 when 1.6.2 is formally 
released.

Thanks,

Roger

>
> Jason, please send me off-list an example offending file (or link if big) so 
> that I'll know when I'm making progress.
>
> Roger
>
>> 
>> RGDAL_OpenDataset() could be modified so that its own error handler is not 
>> used during GDALOpen. Something like this might do it :
>> 
>> ...
>> CPLErrorReset();
>> CPLPushErrorHandler(CPLDefaultErrorHandler);
>> GDALDataset *pDataset = (GDALDataset *) GDALOpen(fn, RWFlag);
>> CPLPopErrorHandler();
>> // Similarly to SWIG bindings, the following lines will cause 
>> RGDAL_OpenDataset() to fail on - unclearred - errors even if pDataset is 
>> not NULL.
>> // They could also be just removed. While pDataset != NULL, there's some 
>> hope ;-)
>> CPLErr eclass = CPLGetLastErrorType();
>> if (pDataset != NULL && eclass == CE_Failure)
>> {
>>   GDALClose(pDataset);
>>   pDataset = NULL;
>>   __errorHandler(eclass, CPLGetLastErrorNo(), CPLGetLastErrorMsg());
>> }
>> 
>> if (pDataset == NULL)
>>   error("Could not open file: %s\n", filename);
>> ....
>> 
>> Note this is uncompiled & untested, but that should avoid similar 
>> situations in other drivers (non fatal errors triggered during dataset 
>> opening and cleared by CPLErrorReset() ) to occur .
>> 
>>> The problem had apparently been seen before. My original email prompted a 
>>> review of the issue, including mention of it being tracked in tickets
>>> #2447 and #3031. Evan made some checkins on 22 July that I thought would 
>>> result in this being fixed in both the trunk and the next release of 1.6
>>> (which would be 1.6.2). But I guess I did not fully understand it, and I 
>>> missed the fact that neither of these issues appeared in Howard's 31 July
>>> release candidate email.
>> 
>> The tickets are not mentionned in Howard's email because the fix is only 
>> partial and the tickets still open.
>> 
>>> So: is there any chance the GDAL team can fix this in either 1.6.2 or, if 
>>> it is now too late, 1.6.3?
>> 
>>> It may be that this fell off the radar because the severity of the tickets 
>>> (for example, #3031 is minor), or because there was a suggested workaround
>>> that users could simply rename the "info" directory to prevent GDAL from 
>>> failing. Well the issue is indeed severe if you are an ArcGIS user. In my
>>> case, the rasters were produced by ArcGIS 9.3.1. Presumably ESRI is 
>>> generating the rasters correctly. The workaround of renaming the info
>>> directory is not a good idea. That renders all of the rasters in a 
>>> directory inaccessible to ArcGIS. It is a major corruption of the ArcInfo 
>>> binary grid
>>> format to do so. I'm not sure why it was suggested in the first place, but 
>>> it is a very bad idea.
>> 
>> Eh! workarounds are workarounds and generally not very elegant. It enables 
>> GDAL to avoids reading the VAT table, but if ArcGIS doesn't like it, that's 
>> another story... The advantage with renaming is that you can undo it when 
>> necessary... Anyway, you're free of ignoring it if you don't like it.
>> 
>>> I'm sorry for not staying on top of this issue and somehow missing that it 
>>> was not put into 1.6.2 and that the workaround is such as bad idea. In any
>>> case, could you please consider fixing this in 1.6 soon? I can provide 
>>> example data if needed.
>> 
>> #3031 has already a link to sample data that triggers the error message. 
>> You just need to find and convince someone that has time and knowledge of 
>> the AVC driver.
>> 
>>> Thanks,
>> 
>>> Jason
>> 
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From jorge.arevalo at gmail.com  Sun Aug  9 09:58:17 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug  9 09:58:41 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com> 
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com> 
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com> 
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com> 
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com> 
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>
Message-ID: <cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>

Hello Tamas,

2009/8/8 Tamas Szekeres <szekerest@gmail.com>:
> Hi Jorge,
>
> What I have in my mind is something like the DirectRasterIO implementation
> in? WCSDataset / WCSRasterBand (see wcsdataset.cpp). It appears that this
> driver is suffering from the same issue, and intend to minimize the
> roundtrips to the server as much as possible. It looks like this direct
> implementation doesn't rely on IReadBlock called by an upper level IRasterIO
> therefore the RasterBlock cache is also omitted in this case.
>

Ok. If I've understood the code, the idea is, in the first attempt to
access the data source to create the dataset, perform a "test" query
to establish several details about the raster (datatype and number of
bands). This will avoid more server rounds to get these data.

Then, my point could be, when creating the dataset (Open static
method), perform a query to get all the blocks that cover the extent
of the raster (the extent is in RASTER_COLUMNS table) and store them
in any place (A new class attribute?, flush the data on a tmp file?).
Then, override IRasterIO in Dataset to get the data fetched in the
extent query, instead of perform a new call. And override the
RasterBand::IReadBlock method too.

It will supppose a change of perspective, but it will improve the
performance, of course.

Thanks for suggestion!

Best regards,
Jorge

>
> Best regards,
>
> Tamas
>
>
>
> 2009/8/8 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> Hello,
>>
>> 2009/8/7 Tamas Szekeres <szekerest@gmail.com>:
>> > Just thinking out loadly;
>> >
>> > Wouldn't it be easier to implement that cache at the driver level, just
>> > by
>> > composing the raster in a temp image buffer and feed that image in the
>> > subsequent IReadBlock calls? I think we should also think about the non
>> > regular and overlapping blocks which should also be covered by the
>> > implementation here.
>> >
>>
>> And this buffer, would it be part of the Dataset, as a property?
>> What's the common way of reading data with a GDAL driver? I suppose
>> that the sequence is like this:
>>
>> User's program --> GDALRasterBand::RasterIO --> Format specific
>> IRasterIO --> Format specific IReadBlock.
>>
>> If the format speficic IRasterIO is not implemented, the generic
>> GDALRasterBand::IRasterIO is called, and this method calls IReadBlock
>> if needed (by GetLockedBlockRef).
>>
>> Am I right?
>>
>> If yes, in what point should I implement the cache at "driver level"?
>>
>> Thanks in advance
>>
>> Best regards,
>> Jorge
>>
>> > Best regards,
>> >
>> > Tamas
>> >
>> >
>> >
>> >
>> > 2009/8/7 Tamas Szekeres <szekerest@gmail.com>
>> >>
>> >>
>> >> 2009/8/7 Jorge Ar?valo <jorge.arevalo@gmail.com>
>> >>>
>> >>> > One issue with this concept would be related to the limited memory
>> >>> > size
>> >>> > of
>> >>> > the particular machine, it may be more reasonable to copy the
>> >>> > retrieved
>> >>> > blocks directly onto the output buffer if possible. In this case you
>> >>> > cannot
>> >>> > much rely on the base RasterIO implementation.
>> >>>
>> >>> So, you suggest to copy the block data into the buffer without calling
>> >>> base implementation of IRasterIO, do you? This implies take care of
>> >>> the endianess and pixel size "by hand".
>> >>
>> >> And many more... I agree this wouldn't be that straightforward.
>> >> Populating
>> >> the block buffer would be much easier.
>> >>
>> >> Best regards,
>> >>
>> >> Tamas
>> >>
>> >
>> >
>
>
From thob at dmu.dk  Mon Aug 10 08:00:50 2009
From: thob at dmu.dk (Becker, Thomas)
Date: Mon Aug 10 08:00:56 2009
Subject: [gdal-dev] reprojection HDF / GCP extraction
Message-ID: <D4AB8C2051A3D1449495F8E45815E6000B2ADCF42E@dmupost.dmu.dk>

Hi all,

I have a couple NOAA-15 images as HDF-EOS files which I would like to reproject to WGS84. The data carry a subgroup called 'Geolocation Fields' holding latitude and longitude for each pixel in separated arrays. Reading the files with gdalinfo leads to the output at the end of this posting.

Out of the HDF-EOS format I would like to create a correct georeferenced image (GTIF). One which will not look like a swath scanned image, but a skewed and correctly referenced one.

Using gdalwarp leads to the message: There is no affine transformation and no GCPs.

Since the coordinates for the centre of each pixel are stored in the before mentioned arrays, is there a way to extract GCPs out of the data.

Thanks for your help.

Best regards,
Thomas

gdalinfo output:

Driver: HDF4/Hierarchical Data Format Release 4
Files: amsua15_2000.034_08964_0104_0258_GC.eos
Size is 512, 512
Coordinate System is `'
Metadata:
  HDFEOSVersion=HDFEOS_V2.4
Subdatasets:
  SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:23800.37 MHz
  SUBDATASET_1_DESC=[851x30] 23800.37 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:31400.42 MHz
  SUBDATASET_2_DESC=[851x30] 31400.42 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:50299.91 MHz
  SUBDATASET_3_DESC=[851x30] 50299.91 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_4_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:52799.39 MHz
  SUBDATASET_4_DESC=[851x30] 52799.39 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_5_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:53595.41 +- 115 MHz
  SUBDATASET_5_DESC=[851x30] 53595.41 +- 115 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_6_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:54399.53 MHz
  SUBDATASET_6_DESC=[851x30] 54399.53 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_7_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:54940.64 MHz
  SUBDATASET_7_DESC=[851x30] 54940.64 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_8_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:55498.70 MHz
  SUBDATASET_8_DESC=[851x30] 55498.70 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_9_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 MHz
  SUBDATASET_9_DESC=[851x30] 57290.33 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_10_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 217 MHz
  SUBDATASET_10_DESC=[851x30] 57290.33 +- 217 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_11_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 48 MHz
  SUBDATASET_11_DESC=[851x30] 57290.33 +- 322.2 +- 48 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_12_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 22 MHz
  SUBDATASET_12_DESC=[851x30] 57290.33 +- 322.2 +- 22 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_13_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 10 MHz
  SUBDATASET_13_DESC=[851x30] 57290.33 +- 322.2 +- 10 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_14_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 4.5 MHz
  SUBDATASET_14_DESC=[851x30] 57290.33 +- 322.2 +- 4.5 MHz Orbit 8964 (32-bit floating-point)
  SUBDATASET_15_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:88997.00 MHz
  SUBDATASET_15_DESC=[851x30] 88997.00 MHz Orbit 8964 (32-bit floating-point)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)
From ivan.lucena at pmldnet.com  Mon Aug 10 08:14:39 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Lucena,=20Ivan?=)
Date: Mon Aug 10 08:14:41 2009
Subject: =?iso-8859-1?B?UmU6IFtnZGFsLWRldl0gcmVwcm9qZWN0aW9uIEhERiAvIEdDUCBleHRyYWN0aW9u?=
Message-ID: <20090810121439.27899.qmail@s466.sureserver.com>

Becker,

Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate

Regards,

Ivan


>  -------Original Message-------
>  From: Becker, Thomas <thob@dmu.dk>
>  Subject: [gdal-dev] reprojection HDF / GCP extraction
>  Sent: Aug 10 '09 07:00
>  
>  Hi all,
>  
>  I have a couple NOAA-15 images as HDF-EOS files which I would like to reproject to WGS84. The data carry a 
subgroup called 'Geolocation Fields' holding latitude and longitude for each pixel in separated arrays. Reading the files 
with gdalinfo leads to the output at the end of this posting.
>  
>  Out of the HDF-EOS format I would like to create a correct georeferenced image (GTIF). One which will not look 
like a swath scanned image, but a skewed and correctly referenced one.
>  
>  Using gdalwarp leads to the message: There is no affine transformation and no GCPs.
>  
>  Since the coordinates for the centre of each pixel are stored in the before mentioned arrays, is there a way to 
extract GCPs out of the data.
>  
>  Thanks for your help.
>  
>  Best regards,
>  Thomas
>  
>  gdalinfo output:
>  
>  Driver: HDF4/Hierarchical Data Format Release 4
>  Files: amsua15_2000.034_08964_0104_0258_GC.eos
>  Size is 512, 512
>  Coordinate System is `'
>  Metadata:
>  ??HDFEOSVersion=HDFEOS_V2.4
>  Subdatasets:
>  ??SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:23800.37 MHz
>  ??SUBDATASET_1_DESC=[851x30] 23800.37 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:31400.42 MHz
>  ??SUBDATASET_2_DESC=[851x30] 31400.42 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:50299.91 MHz
>  ??SUBDATASET_3_DESC=[851x30] 50299.91 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_4_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:52799.39 MHz
>  ??SUBDATASET_4_DESC=[851x30] 52799.39 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_5_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:53595.41 +- 115 MHz
>  ??SUBDATASET_5_DESC=[851x30] 53595.41 +- 115 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_6_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:54399.53 MHz
>  ??SUBDATASET_6_DESC=[851x30] 54399.53 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_7_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:54940.64 MHz
>  ??SUBDATASET_7_DESC=[851x30] 54940.64 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_8_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:55498.70 MHz
>  ??SUBDATASET_8_DESC=[851x30] 55498.70 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_9_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 MHz
>  ??SUBDATASET_9_DESC=[851x30] 57290.33 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_10_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 +- 217 MHz
>  ??SUBDATASET_10_DESC=[851x30] 57290.33 +- 217 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_11_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 +- 322.2 +- 48 MHz
>  ??SUBDATASET_11_DESC=[851x30] 57290.33 +- 322.2 +- 48 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_12_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 +- 322.2 +- 22 MHz
>  ??SUBDATASET_12_DESC=[851x30] 57290.33 +- 322.2 +- 22 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_13_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 +- 322.2 +- 10 MHz
>  ??SUBDATASET_13_DESC=[851x30] 57290.33 +- 322.2 +- 10 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_14_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:57290.33 +- 322.2 +- 4.5 MHz
>  ??SUBDATASET_14_DESC=[851x30] 57290.33 +- 322.2 +- 4.5 MHz Orbit 8964 (32-bit floating-point)
>  ??SUBDATASET_15_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
8964:88997.00 MHz
>  ??SUBDATASET_15_DESC=[851x30] 88997.00 MHz Orbit 8964 (32-bit floating-point)
>  Corner Coordinates:
>  Upper Left??(????0.0,????0.0)
>  Lower Left??(????0.0,??512.0)
>  Upper Right (??512.0,????0.0)
>  Lower Right (??512.0,??512.0)
>  Center??????(??256.0,??256.0)
>  _______________________________________________
>  gdal-dev mailing list
>  gdal-dev@lists.osgeo.org
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
From thob at dmu.dk  Mon Aug 10 09:05:29 2009
From: thob at dmu.dk (Becker, Thomas)
Date: Mon Aug 10 09:19:52 2009
Subject: [gdal-dev] reprojection HDF / GCP extraction
In-Reply-To: <20090810121439.27899.qmail@s466.sureserver.com>
References: <20090810121439.27899.qmail@s466.sureserver.com>
Message-ID: <D4AB8C2051A3D1449495F8E45815E6000B2ADCF470@dmupost.dmu.dk>

Hello Ivan,

thanks for the hint. Now is this how GDAL already works? Because this track is meant for comments. At least in my data which are from 2000 I can not see any metadata of that kind. After reading the trac I am puzzled. Also in the output of gdalinfo only the subdatset of 'Data Fields' is mentioned and not the subdataset of 'Geolocation Fields'. I can not realy see which band represent latitude and longitude.

If I just don't understand the trac maybe you can tell me how a command to GDAL, based on the gdalinfo output would look like to get the job done.

Regards,

Thomas

-----Original Message-----
From: Lucena, Ivan [mailto:ivan.lucena@pmldnet.com] 
Sent: Monday, August 10, 2009 2:15 PM
To: Becker, Thomas; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] reprojection HDF / GCP extraction

Becker,

Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate

Regards,

Ivan
From ivan.lucena at pmldnet.com  Mon Aug 10 09:37:17 2009
From: ivan.lucena at pmldnet.com (=?iso-8859-1?Q?Lucena,=20Ivan?=)
Date: Mon Aug 10 09:37:20 2009
Subject: =?iso-8859-1?B?UkU6IFtnZGFsLWRldl0gcmVwcm9qZWN0aW9uIEhERiAvIEdDUCBleHRyYWN0aW9u?=
Message-ID: <20090810133719.21851.qmail@s466.sureserver.com>

Becker,

I afraid I don't have much to add to what is in the RFC#4. You can search on the discussion list archives for more 
information or wait for the sun to weak up the experts.

Regards,

Ivan


>  -------Original Message-------
>  From: Becker, Thomas <thob@dmu.dk>
>  Subject: RE: [gdal-dev] reprojection HDF / GCP extraction
>  Sent: Aug 10 '09 08:05
>  
>  Hello Ivan,
>  
>  thanks for the hint. Now is this how GDAL already works? Because this track is meant for comments. At least in 
my data which are from 2000 I can not see any metadata of that kind. After reading the trac I am puzzled. Also in 
the output of gdalinfo only the subdatset of 'Data Fields' is mentioned and not the subdataset of 'Geolocation 
Fields'. I can not realy see which band represent latitude and longitude.
>  
>  If I just don't understand the trac maybe you can tell me how a command to GDAL, based on the gdalinfo 
output would look like to get the job done.
>  
>  Regards,
>  
>  Thomas
>  
>  -----Original Message-----
>  From: Lucena, Ivan [mailto:ivan.lucena@pmldnet.com]
>  Sent: Monday, August 10, 2009 2:15 PM
>  To: Becker, Thomas; gdal-dev@lists.osgeo.org
>  Subject: Re: [gdal-dev] reprojection HDF / GCP extraction
>  
>  Becker,
>  
>  Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate
>  
>  Regards,
>  
>  Ivan
>  
From dmorissette at mapgears.com  Mon Aug 10 11:12:45 2009
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon Aug 10 11:12:47 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
In-Reply-To: <4A7B1304.2000401@pobox.com>
References: <4A7B1304.2000401@pobox.com>
Message-ID: <4A8038ED.6080709@mapgears.com>

Frank Warmerdam wrote:
> Motion: Adopt  GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.
> 

+1  (Sorry for the delayed vote, I was away last week. I just tested it 
and it seems fine.)


Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
From mongoose_riki at mail.ru  Mon Aug 10 13:40:08 2009
From: mongoose_riki at mail.ru (Riki Tiki)
Date: Mon Aug 10 14:44:28 2009
Subject: [gdal-dev] (no subject)
Message-ID: <E1MaYqu-0003EU-00.mongoose_riki-mail-ru@f10.mail.ru>



Hi All,

I was trying to write a c# program to copy the existing raster file to a new raster file so that at the end i both files while displayed on tools like arcmap will be exactly the same... i started as follows


string src_file = @"C:\raster1";
Gdal.AllRegister();
Dataset src_ds  = Gdal.Open(src_file, Access.GA_ReadOnly);

Driver dr = Gdal.GetDriverByName("GTiff");
string dest_file = @"C:\raster_copy";
Dataset dest_ds = dr.Create(dest_file, src_ds.RasterXSize, src_ds.RasterYSize,
                            1, DataType.GDT_Float32, null);



now i do not know how to continue...? plz, can you help me?

http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALCreateCopy.cs

i have already seen above one but that creates two different images when i open in arcmap.

thanks a lot!
From bontepaarden at gmail.com  Mon Aug 10 17:22:06 2009
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon Aug 10 17:22:11 2009
Subject: [gdal-dev] Memory Error in _gdal.Band_ReadRaster(*args, **kwargs)
Message-ID: <870e056a0908101422x5f38bb6fh32c2bd848ff6c868@mail.gmail.com>

I'm trying to split a large ECW file into smaller files.
I've downloaded and installed OSGeo4W with gdal16
I managed to split a small ecw file.
That ecw file had this info:

Driver: ECW/ERMapper Compressed Wavelets
Files: tilertest.ecw
Size is 6800, 7500
Coordinate System is `'
Origin = (13000.000000000000000,381250.000000000000000)
Pixel Size = (2.500000000000000,-2.500000000000000)
Corner Coordinates:
Upper Left  (   13000.000,  381250.000)
Lower Left  (   13000.000,  362500.000)
Upper Right (   30000.000,  381250.000)
Lower Right (   30000.000,  362500.000)
Center      (   21500.000,  371875.000)
Band 1 Block=6800x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=6800x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=6800x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

I used this statement:
gdal_retile -v -s_srs EPSG:28992 -of ECW -ps 3700 3750 -targetDir tiles
TilerTest.ecw

But when I try to split the large ecw file (3.4GB) I get an error after a
few minutes.
The info is:
Driver: ECW/ERMapper Compressed Wavelets
Files: Large.ecw
Size is 173334, 160000
Coordinate System is:
LOCAL_CS["LOCAL - (unsupported)",
    UNIT["Meter",1]]
Origin = (33000.000000000000000,381000.000000000000000)
Pixel Size = (0.150000000001455,-0.150000000023283)
Corner Coordinates:
Upper Left  (   33000.000,  381000.000)
Lower Left  (   33000.000,  357000.000)
Upper Right (   59000.100,  381000.000)
Lower Right (   59000.100,  357000.000)
Center      (   46000.050,  369000.000)
Band 1 Block=173334x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=173334x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=173334x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

The statement is:
gdal_retile -v -s_srs EPSG:28992 -of ECW -ps 86667 80000 -targetDir tiles
large.ecw >retile.txt

The logfile (retile.txt) shows:
Building internal Index for 1 tile(s) ... finished
Filename: Terneuzen_15cm.ecw
File Size: 173334x160000x3
Pixel Size: 0.150000 x -0.150000
UL:(33000.000000,381000.000000)   LR:(59000.100000,356999.999996)
tileWidth       86667
tileHeight      80000
countTilesX:    2
countTilesY:    2
lastTileWidth:  86667
lastTileHeight: 80000

And the error is:
Traceback (most recent call last):
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 938, in <module>
sys.exit(main(sys.argv))
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 855, in main
dsCreatedTileIndex = tileImage(minfo,ti)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 335, in tileImage
createTile(minfo, offsetX, offsetY, width, height,tilename,OGRDS)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 467, in createTile
dec.uly+offsetY*dec.scaleY)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 250, in getDataSet
data = s_band.ReadRaster( readOffsetX,readOffsetY,readX,readY,
readX,readY,self.band_type )
  File "C:\OSGeo4W\apps\gdal-16\pymod\osgeo\gdal.py", line 760, in
ReadRaster return _gdal.Band_ReadRaster(*args, **kwargs) MemoryError

I've searched using Google and found a similar error:
http://article.gmane.org/gmane.comp.gis.gdal.devel/18936 and contacted
Sarah, but she's still having the problem.

Does anybody know how to solve this?

I run it on a Vista 64-Bit 4-core, with 8GB RAM. I'm getting the same error
on a WinXP sp3 2-core, with 2 GB RAM

Thanks,

Paul Meems
The Netherlands
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090810/c852d909/attachment.html
From adeel.raza at crc.gc.ca  Mon Aug 10 17:29:16 2009
From: adeel.raza at crc.gc.ca (Adeel Raza)
Date: Mon Aug 10 17:29:09 2009
Subject: [gdal-dev] What file extensions can be used to open a GDAL Dataset
 with the EHdr driver?
Message-ID: <4A80912C.3030106@crc.gc.ca>

Hi,

I was wondering besides .bil files what other file extensions can be 
used to open a GDAL Dataset with the EHdr driver?

Regards,
Adeel Raza.


From chaitanya.ch at gmail.com  Mon Aug 10 17:44:38 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon Aug 10 17:44:40 2009
Subject: [gdal-dev] What file extensions can be used to open a GDAL 
	Dataset with the EHdr driver?
In-Reply-To: <4A80912C.3030106@crc.gc.ca>
References: <4A80912C.3030106@crc.gc.ca>
Message-ID: <eb502d880908101444i31bafee6k11259b66034e1fba@mail.gmail.com>

Adeel,

The GDAL drivers usually don't use the file extensions as a basis for
supportability. You can get more info on GDAL supported formats at
http://gdal.org/formats_list.html and EHdr driver at
http://gdal.org/frmt_various.html#EHdr

On Tue, Aug 11, 2009 at 2:59 AM, Adeel Raza <adeel.raza@crc.gc.ca> wrote:

> Hi,
>
> I was wondering besides .bil files what other file extensions can be used
> to open a GDAL Dataset with the EHdr driver?
>
> Regards,
> Adeel Raza.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090811/148e86e8/attachment.html
From jorge.arevalo at gmail.com  Mon Aug 10 18:40:34 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Mon Aug 10 18:40:56 2009
Subject: [gdal-dev] GDAL WKT Raster driver weekly report #11
Message-ID: <cb4457700908101540w797f4508m789e2f1baa4cea92@mail.gmail.com>

Hello,

The weekly report is here:
http://www.gis4free.org/blog/2009/08/11/gsoc-09-weekly-report-11-3107-0708/

The project page here: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Best regards,
Jorge
From warmerdam at pobox.com  Mon Aug 10 22:53:08 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 10 22:53:10 2009
Subject: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
In-Reply-To: <4A7B1304.2000401@pobox.com>
References: <4A7B1304.2000401@pobox.com>
Message-ID: <931f8ea90908101953x7c1a503esecbcc9fdf12469b8@mail.gmail.com>

On Thu, Aug 6, 2009 at 1:29 PM, Frank Warmerdam<warmerdam@pobox.com> wrote:
> Motion: Adopt ?GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.

Folks,

I declare this motion passed with support from FrankW,
DanielM, EvenR, and TamasS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From neteler at osgeo.org  Tue Aug 11 05:42:08 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Tue Aug 11 05:42:11 2009
Subject: [gdal-dev] Problem with nodata values
In-Reply-To: <fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
Message-ID: <86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>

On Wed, Jul 29, 2009 at 9:08 AM, Rainer M Krug<r.m.krug@gmail.com> wrote:
> On Fri, Jul 24, 2009 at 5:44 PM, Frank Warmerdam<warmerdam@pobox.com> wrote:
>> Rainer M Krug wrote:
>>>
>>> Hi
>>>
>>> I have a geotiff and want to use gdalwarp to warp to it into a
>>> different projection.
>>> I do the following:
>>>
>>> gdalwarp -s_srs EPSG:32734 -t_srs '+proj=longlat +ellps=WGS84
>>> +no_defs' Outeniqua.tiff Outeniqua_wgs84.tiff
>>>
>>> The problem is, that in Outeniqua_wgs84.tiff, the nodata values from
>>> Outeniqua.tiff become translated into -9999. In addition, the areas
>>> new to Outeniqua_wgs84.tiff (due to the warping) become 1.
>>>
>>> Which options do I have to use to keep the nodata values and to make
>>> the values of the "new areas" also as nodata values?
>>
>> Rainer,
>>
>> I believe you want to pass the warp option INIT_DEST=-9999 to set all pixels
>> that do not come from the source file to -9999.
>
> Thanks a lot - that solved it partly. I now have all original pixels
> unequal to NULL now warped as they should be. Only slight problemk
> now: all NULL values from the input file, are now -9999 and I would
> prefer to heve them as NULL. I managed that by using gdal_translate
> and the -a_nulldata option, but shouldn't that be possible in
> gralwarp?

I just ran into the same problem...
Having a raster map of Italy with the sea being NULL, I obtain the
gdalwarped map with the sea becoming 0.

This works:

MAP=Italy
gdalwarp -r bilinear -tr 1000 1000 \
         -srcnodata "-32768" -dstnodata "-32768" -wo "INIT_DEST=-32768" \
         -t_srs epsg:32632 ${MAP}_LL.tif ${MAP}_UTM32.tif

Suggestion: add to the manual of gdalwarp:

-dstnodata: ... See also INIT_DEST in GDALWarpOptions::papszWarpOptions docs.

Markus
From warmerdam at pobox.com  Tue Aug 11 09:46:01 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 11 09:52:32 2009
Subject: [gdal-dev] (no subject)
In-Reply-To: <E1MaYqu-0003EU-00.mongoose_riki-mail-ru@f10.mail.ru>
References: <E1MaYqu-0003EU-00.mongoose_riki-mail-ru@f10.mail.ru>
Message-ID: <931f8ea90908110646g1d9bbf61m743bf51a1b2eac0a@mail.gmail.com>

2009/8/10 Riki Tiki <mongoose_riki@mail.ru>:
>
>
> Hi All,
>
> I was trying to write a c# program to copy the existing raster file to a new raster file so that at the end i both files while displayed on tools like arcmap will be exactly the same... i started as follows
>
>
> string src_file = @"C:\raster1";
> Gdal.AllRegister();
> Dataset src_ds ?= Gdal.Open(src_file, Access.GA_ReadOnly);
>
> Driver dr = Gdal.GetDriverByName("GTiff");
> string dest_file = @"C:\raster_copy";
> Dataset dest_ds = dr.Create(dest_file, src_ds.RasterXSize, src_ds.RasterYSize,
> ? ? ? ? ? ? ? ? ? ? ? ? ? ?1, DataType.GDT_Float32, null);
>
>
>
> now i do not know how to continue...? plz, can you help me?
>
> http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALCreateCopy.cs
>
> i have already seen above one but that creates two different images when i open in arcmap.

Riki,

In order to do better than GDALCreateCopy.cs you will need to
analyse why the source and destination images are different
in arcmap.  Is it a georeferencing issues?  Pixel types?

What is the source image format?  Perhaps it is an
arc binary grid?  These can have auxilary information
that does not appear in formats like GeoTIFF.   It might
be helpful to use gdalinfo on the source and destination
and see if there are any apparent differences.

If you want to see how to do something similar to
CreateCopy() using Create and direct methods you
can look through the default implementation of CreateCopy.

  http://trac.osgeo.org/gdal/browser/trunk/gdal/gcore/gdaldriver.cpp#L334

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From atubar at 126.com  Tue Aug 11 10:17:13 2009
From: atubar at 126.com (atubar)
Date: Tue Aug 11 10:48:16 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>
References: <eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>
	<9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
Message-ID: <11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>

I am sorry for that I can not take a test in VC++ 2005, because I built every essential dll in VC++ 2008, and I now only install VC2008 on my computer. Will it take any different results if  dlls built with different compiler ? 
I simply have a check in local : One with pre-built dlls from HDFGroup ,such as zlib, szip, jpeg . And the other with all dlls built from source.
But When reading a hdf5 file, they all gave me a report about  Stack Overflow. 
The HDF5 file is a sample data contained in hdfview which provided by HDFGroup and can be found in its website.
And the code I write is below:
//////////////////////////////////////////////////////////////////////////////////////
#include <iostream>
using namespace std;
#include "gdal_priv.h"
#pragma comment(lib,"gdal_i.lib")
int main()
{ 
 GDALAllRegister();
 char* filename="D:\\Documents and Settings\\Visual Studio 2008\\Projects\\GdalConsole\\Debug\\hdf5_test.h5";
 char *pszFormat="HDF5";
 GDALDriver *poDriver = GetGDALDriverManager()->GetDriverByName(pszFormat); 
////////////// here poDriver is non-null pointer////////////
 if( poDriver != NULL )
 {
  ........................
 }
 else
 {
  cout<<"Gdal do not support HDF4!"<<endl;
 }  
 GDALDataset *poDataset;
 poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
/////////////////when code run here, it reports that stack overflow
 if(poDataset == NULL)
 {
  cout<<"error!";
  return 0;
 }
 else
 {
  ...................
 } 
 poDataset=NULL;
 return 0;
}
/////////////////////////////////////////////////////////////////////////////

 

2009-08-08 00:45:37"Chaitanya kumar CH" <chaitanya.ch@gmail.com> 
atubar,

If you can try this with VC++2005, please do. In any case please tell the result here.

If you can, provide a sample data that gives this error so that the situation to be understood better.


2009/8/6 atubar <atubar@126.com>

Hello, I am a freshman in working with Gdal and HDF5 in Visual C++ 2008. I have built essential dlls as those guides said. And I got gdal16.dll, hdf5dll.dll and more.
I set up a project , add include and lib to this project. Then I copy some sample codes to test how gdal and hdf5 works.
These codes below works successfully:
    char *pszFormat="HDF5";
    GDALDriver *poDriver = GetGDALDriverManager()->GetDriverByName(pszFormat);
It returns an non null poDriver.
But when I work with these codes below: 
    char* filename="..\\hdf5_test.h5";
    GDALDataset *poDataset;
    poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
it occurs an error like this below:
   Unhandled exception in **.exe:0xC00000FD:Stack Overflow 
How it comes? Is it a bug?What should I do ?



,www.yeah.net
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090811/5b46e8a1/attachment.html
From Shawn.Gong at drdc-rddc.gc.ca  Tue Aug 11 12:17:58 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Tue Aug 11 12:18:12 2009
Subject: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits per sample
	will not be interpreted properly
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA4A@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I found help clues to build libecwj2 on Windows. 
The missing winhttp.h can be found in Microsoft Platform SDK for Windows
Server 2003 SP1. But on Microsoft site, this has been superceded by the
Windows SDK for Windows Server 2008 and .NET Framework 3.5. 
I found the original file at
http://download.cnet.com/Windows-Server-2003-SP1-Platform-SDK-ISO-Instal
l/3000-2070_4-10731571.html
Installed it and followed the instructions on
http://lists.maptools.org/pipermail/fwtools/2008-April/001213.html to
set the Include and Library Files.
Successfully built libecwj2 and added it to gdal (stable branch
2009-08-03).  "gdalinfo --format ecw" also works.

However when I tried to open GeoEye-1 NITF, I got "Warning 1: Image with
11 bits per sample will not be interpreted properly".
There are two sub-datasets in NITF (please see the gdalinfo at the end).
If I open the 2nd sub-dataset, the data show only 73 pixels and 220
lines; digital numbers are either 0 or 255. If I open the 1st
sub-dataset, python.exe crashed at ncsjpcbuffer.cpp's 
		CNCSJPCBuffer::~CNCSJPCBuffer()
		{
			Free();
		}
The OpenEV from FWTools2.3.0 behaves the same.

I found this Gdal-dev post:
http://lists.osgeo.org/pipermail/gdal-dev/2007-December/015139.html
Does that mean the 11-bit NITF data will be corrupted that I cannot read
them using Gdal?
I can view GeoEye-1 NITF images using PCI Geomatica.

BTW, I tried to build the nitfdump utility 
"nmake /f makefile.vc nitfdump.exe" 
/out:nitfdump.exe
nitfdump.obj
nitffile.obj
nitfimage.obj
mgrs.obj
nitfaridpcm.obj
nitfbilevel.obj
rpftocfile.obj
..\gtiff\tifvsi.obj
..\..\gdal_i.lib
   Creating library nitfdump.lib and object nitfdump.exp
nitfbilevel.obj : error LNK2019: unresolved external symbol
_TIFFReadEncodedStrip referenced in function _NITFUncompressBILEVEL
nitfbilevel.obj : error LNK2019: unresolved external symbol _TIFFClose
referenced in function _NITFUncompressBILEVEL
nitfbilevel.obj : error LNK2019: unresolved external symbol
_TIFFWriteDirectoryreferenced in function _NITFUncompressBILEVEL
nitfbilevel.obj : error LNK2019: unresolved external symbol
_TIFFWriteRawStrip referenced in function _NITFUncompressBILEVEL
nitfbilevel.obj : error LNK2019: unresolved external symbol
_TIFFSetField referenced in function _NITFUncompressBILEVEL
tifvsi.obj : error LNK2019: unresolved external symbol _TIFFError
referenced in function "struct tiff * __cdecl VSI_TIFFOpen(char const
*,char const *)" (?VSI_TIFFOpen@@YAPAUtiff@@PBD0@Z)
nitfdump.exe : fatal error LNK1120: 6 unresolved externals
NMAKE : fatal error U1077: '"C:\Program Files\Microsoft Visual Studio
8\VC\BIN\c
l.EXE"' : return code '0x2'
Stop.


thanks,
Shawn

some gdalinfo =============================
Size is 9376, 28778
 
Image Structure Metadata:
  COMPRESSION=JPEG2000
Subdatasets:
 
SUBDATASET_1_NAME=NITF_IM:0:21JUN09OV05010005V090621M0002821014A22200010
0292M_001526813.ntf
  SUBDATASET_1_DESC=Image 1 of
21JUN09OV05010005V090621M0002821014A222000100292M_001526813.ntf
 
SUBDATASET_2_NAME=NITF_IM:1:21JUN09OV05010005V090621M0002821014A22200010
0292M_001526813.ntf
  SUBDATASET_2_DESC=Image 2 of
21JUN09OV05010005V090621M0002821014A222000100292M_001526813.ntf

Band 1 Block=9376x1 Type=UInt16, ColorInterp=Blue
  Overviews: arbitrary
Band 2 Block=9376x1 Type=UInt16, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=9376x1 Type=UInt16, ColorInterp=Red
  Overviews: arbitrary
Band 4 Block=9376x1 Type=UInt16, ColorInterp=Undefined
  Overviews: arbitrary


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090811/926e7030/attachment.html
From peifer at gmx.eu  Tue Aug 11 12:53:52 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue Aug 11 12:53:56 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>	<4A69D6D0.4040903@pobox.com>	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
	<86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>
Message-ID: <4A81A220.1070502@gmx.eu>

Markus wrote
> 
> This works:
>    ... 
>          -srcnodata "-32768" -dstnodata "-32768" -wo "INIT_DEST=-32768" \
>    ...

I was taking a similar approach when warping several input tiffs into a single output tiff. It looks to me that for each input file, the output file is completely reset to the INIT_DEST value, overwriting the values from previously processed input files. The final output file did only contain the warped values of the last input file in the upper right corner, anything else was NODATA. I am wondering if this is rather a feature or a bug.

Hermann
From mateusz at loskot.net  Tue Aug 11 21:17:32 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Aug 11 21:17:43 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>
References: <eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>	<9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
	<11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>
Message-ID: <4A82182C.4000908@loskot.net>

atubar wrote:
> I am sorry for that I can not take a test in VC++ 2005, because I
> built every essential dll in VC++ 2008, and I now only install VC2008
> on my computer. Will it take any different results if  dlls built
> with different compiler ?

Of course there may be. For instance, linker may not accept it
and abort with errors. But looks like you're using VS2008 now,
so just rebuild all the libraries and client program
using this compiler.

> I simply have a check in local : One with
> pre-built dlls from HDFGroup ,such as zlib, szip, jpeg.

Ensure you downloaded HDF libraries for VS2008.

> And the
> other with all dlls built from source. But When reading a hdf5 file,
> they all gave me a report about  Stack Overflow.

What is the exact and the complete error message.

> The HDF5 file is a
> sample data contained in hdfview which provided by HDFGroup and can
> be found in its website. And the code I write is below: 
>
//////////////////////////////////////////////////////////////////////////////////////
> #include <iostream>
> using namespace std;

Open the namespace *after* all headers are include, not before.

> #include "gdal_priv.h"
> #pragma comment(lib,"gdal_i.lib")

using namespace std;

> int main()
> {
>  GDALAllRegister();
>  char* filename="D:\\Documents and Settings\\Visual Studio
2008\\Projects\\GdalConsole\\Debug\\hdf5_test.h5";

const char* not char*

>  char *pszFormat="HDF5";

const char*

>  GDALDriver *poDriver =
GetGDALDriverManager()->GetDriverByName(pszFormat);
> ////////////// here poDriver is non-null pointer////////////
>  if( poDriver != NULL )
>  {
>   ........................
>  }
>  else
>  {
>   cout<<"Gdal do not support HDF4!"<<endl;

likely, return 0; is missing from logical point.

>  }
>  GDALDataset *poDataset;
>  poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
> /////////////////when code run here, it reports that stack overflow
>  if(poDataset == NULL)
>  {
>   cout<<"error!";
>   return 0;
>  }
>  else
>  {
>   ...................
>  }
>  poDataset=NULL;

This is not how you are supposed to close GDAL dataset.

Pleasse, (re)read "Closing the Dataset" section here:

http://gdal.org/gdal_tutorial.html

>  return 0;
> }
>
/////////////////////////////////////////////////////////////////////////////

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From med.hedi.lassoued at gmail.com  Wed Aug 12 01:53:51 2009
From: med.hedi.lassoued at gmail.com (mohamed hedi lassoued)
Date: Wed Aug 12 01:53:54 2009
Subject: [gdal-dev] writing a datasate into another one
Message-ID: <32be03950908112253q48a9db8ew725263d0d7ed07d6@mail.gmail.com>

hello,

Im new with GDAL and i want add a gdal module to my application.this one
should translate a file from a format to another like gdal_translat .
So i should read the sourcefile making it into a dataset.my problem is that
in the copy() methode i should copy a data set to the copy one and chage
many options like projection.
i paste my module here and i wish that you can help me to copy the data set
to the new one. i saw the tutorial and i dont see copy methode and if i
should use band of dataset to copy a band to another one.


Code:

/*****************************************************************************
 *    ogr2gui is an application used to convert and manipulate geospatial
 *    data. It is based on the "OGR Simple Feature Library" from the
 *    "Geospatial Data Abstraction Library" <http://gdal.org>.
 *
 *    Copyright (c) 2009 Inventis <mailto:developpement@inventis.ca>
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the GNU General Public License as published by
 *    the Free Software Foundation, either version 3 of the License, or
 *    (at your option) any later version.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    GNU General Public License for more details.
 *
 *    You should have received a copy of the GNU General Public License
 *    along with this program.  If not, see <http://www.gnu.org/licenses/>
 *****************************************************************************/

/*!
 *    \file Cvt.cpp
 *    \brief Cvt
 *    \author Mohamed Hedi Lassoued [ Inventis ]
 *    \version 0.5
 *    \date 13/01/09
 */


#include "../inc/Cvt.h"

#include "gdal_priv.h"
#include "cpl_string.h"

Cvt::Cvt( void )
{
    GDALAllRegister() ;
}

Cvt::~Cvt( void )
{

}

bool Cvt::OpenDataset( const char * pszSrcFilename, const char *
pszDstFilename )
{
    //Open the source file

 poSrcDS = (GDALDataset *) GDALOpen( pszSrcFilename, GA_ReadOnly );
        if( poSrcDS != NULL )
        {
            //succ?s d'ouverture du Dataset
        }
    else
    {
        error = "unable to open Dataset";
        return false;

    }

    //Open the target file
poDstDS = (GDALDataset *) GDALOpen( pszDstFilename, GA_Update );
        if( poDstDS != NULL )
        {
            //succ?s d'ouverture du Dataset
        }
    else
    {
        error = "unable to open Dataset";
        return false;

    }
}
int Cvt::VerfCreat();
{
    const char *pszFormat = "GTiff"; // target Format

    char **papszMetadata;

    poDstDriver = GetGDALDriverManager()->GetDriverByName(pszFormat);

    if( poDstDriver == NULL )
       // exit( 1 );
    return 0;
    // V?rification de possibilit? d'utilisation CREAT ou CREATCOPY
    papszMetadata = poDstDriver->GetMetadata();
    if( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATE, FALSE ) )
        {
        printf( "Driver %s supports Create() method.\n", pszFormat );
        return 1;
    }
    if( CSLFetchBoolean( papszMetadata, GDAL_DCAP_CREATECOPY, FALSE ) )
        {
        printf( "Driver %s supports CreateCopy() method.\n", pszFormat );
        return 2;
    }

}

// creat of dataset copy with the new Format
//need to complet the if .... creat directly ....
bool Cvt::ConvertDataset();
{
    if ( VerfCreat()==2 ) // using CreateCopy
    {
        poDstDS = poDstDriver->CreateCopy( pszDstFilename, poSrcDS, FALSE,
                        NULL, NULL, NULL );

    }
    else if ( VerfCreat()==1 ) // using Creat
    {

        poDstDS = poDstDriver->Create( pszDstFilename,
poSrcDS->GetRasterXSize(), poSrcDS->GetRasterYSize(),
poSrcDS->GetRasterCount(), GDT_Byte,
                    papszOptions );

        //Modification  that we can do for the poDstDS (add a
geotransfor, UTM,  SetWellKnownGeogCS....

        poDstDS->SetGeoTransform( adfGeoTransform );

        oSRS.SetUTM( 11, TRUE );
        oSRS.SetWellKnownGeogCS( "NAD27" );
        oSRS.exportToWkt( &pszSRS_WKT );
        poDstDS->SetProjection( pszSRS_WKT );
        CPLFree( pszSRS_WKT );






        for( int i = 1; i<=poDstDS->GetRasterCount() ; i++ )
        {
            poBand = poSrcDS->GetRasterBand(i);

            //il faut ecrire dans le poDstDS  le poband lu, nrmalement
il y a un setRasterBand

            GByte
abyRaster[poSrcDS->GetRasterXSize()*poSrcDS->GetRasterYSize()];
            poBand->RasterIO( GF_Read, 0, 0,
poSrcDS->GetRasterXSize(), poSrcDS->GetRasterYSize(),
                abyRaster, 512, 512, GDT_Byte, 0, 0 );
            poDstDS = poDriver->Create( pszDstFilename, 512, 512, 1, GDT_Byte,
                        papszOptions );
        }
    }
            /* Once we're done, close properly the dataset */

    if( poDstDS != NULL )
        GDALClose( (GDALDatasetH) poDstDS );
        GDALClose( (GDALDatasetH) poSrcDS );




thx all

}
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090812/39839bf1/attachment.html
From rigal at rapideye.de  Wed Aug 12 08:53:23 2009
From: rigal at rapideye.de (Matthieu Rigal)
Date: Wed Aug 12 09:23:59 2009
Subject: [gdal-dev] strange path handling of ogr2ogr in append mode
Message-ID: <200908121453.23855.rigal@rapideye.de>

Hi folks,

Sorry to bother you with a problem occurring on an obsolete version, I will 
find a work-around for me, but I wanted to tell you -after making sure this 
was not reported before-, that on my 1.6.1 installation under Linux, 
ogr2ogr -update -append
is making strange errors :

It interpretes the paths in a strange way:

ogr2ogr -update -append merge.shp fileone.shp -nln second

ERROR 1: Failed to create file .shp file.
ERROR 4: Failed to open Shapefile `merge.shp/second.shp'.

AND

ogr2ogr -update -append merge.shp fileone.shp
ERROR 1: Failed to create file .shp file.
ERROR 4: Failed to open Shapefile `merge.shp/fileone.shp'.

If it was resolved, forget it, if I am the only one, forget it maybe also... 
but this is strange...

Regards,
Matthieu


-- 
Matthieu Rigal
Product Development

RapidEye AG                           Tel: +49-(0)3381-89 04 331
Molkenmarkt 30                       Fax: +49-(0)3381-89 04 101
14776 Brandenburg/Havel
Germany                                  http://www.rapideye.de

RapidEye AG
Molkenmarkt 30
14776 Brandenburg an der Havel
Germany

Follow us on Twitter! www.twitter.com/rapideye_ag
 
Head Office/Sitz der Gesellschaft: Brandenburg an der Havel
Management Board/Vorstand: Wolfgang G. Biedermann
Chairman of Supervisory Board/Vorsitzender des Aufsichtsrates: Axel Schmalz
Commercial Register/Handelsregister Potsdam HRB 17 796
Tax Number/Steuernummer: 048/100/00053
VAT-Ident-Number/Ust.-ID: DE 199331235
DIN EN ISO 9001 certified
 
*************************************************************************
Diese E-Mail enthaelt vertrauliche und/oder rechtlich geschuetzte
Informationen. Wenn Sie nicht der richtige Adressat sind oder diese
E-Mail irrtuemlich erhalten haben, informieren Sie bitte sofort den
Absender und vernichten Sie diese E-Mail. Das unerlaubte Kopieren sowie
die unbefugte Weitergabe dieser E-Mail ist nicht gestattet.
 
The information in this e-mail is intended for the named recipients
only. It may contain privileged and confidential information. If you
have received this communication in error, any use, copying or
dissemination of its contents is strictly prohibited. Please erase all
copies of the message along with any included attachments and notify
RapidEye AG or the sender immediately by telephone at the number
indicated on this page.
From warmerdam at pobox.com  Wed Aug 12 10:12:13 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 12 10:12:15 2009
Subject: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits per 
	sample will not be interpreted properly
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26EA4A@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA4A@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <931f8ea90908120712t17707d9sb408e1cc80348dd1@mail.gmail.com>

On Tue, Aug 11, 2009 at 12:17 PM, Gong, Shawn
(Contractor)<Shawn.Gong@drdc-rddc.gc.ca> wrote:
> hi list,
>
> I found help clues to build libecwj2 on Windows.

Shawn,

Congrats on working though this issue!  Perhaps you would like to add
some notes to:

  http://trac.osgeo.org/gdal/wiki/ECW

> However when I tried to open GeoEye-1 NITF, I got ?Warning 1: Image with 11
> bits per sample will not be interpreted properly?.

I thought there were changes in trunk to avoid this warning when the
image is jpeg2000 and being handled by a suitable codec.  However,
I think I only tested this specific issue when using JP2KAK for the
jpeg2000 support.  I'm not sure if there are problems with the ecw sdk
and such files or not.  However, the note about being badly corrupted
should not really apply.

> There are two sub-datasets in NITF (please see the gdalinfo at the end). If
> I open the 2nd sub-dataset, the data show only 73 pixels and 220 lines;
> digital numbers are either 0 or 255.

Hmm, I don't know why it would be particularly small in size.
I'm also surprised that the latest windows fwtools has problems.
Perhaps you could file a ticket on the issue and I could look into
it a bit next week (especially since problems can be reproduced
with FWTools which I think uses JP2KAK for this purpose).

Hmm, on second thought, I believe I removed JP2KAK from
FWTools for licensing reasons - so perhaps it is using the
ecw jpeg2000 driver too.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From warmerdam at pobox.com  Wed Aug 12 10:13:42 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 12 10:13:46 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <4A81A220.1070502@gmx.eu>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
	<86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>
	<4A81A220.1070502@gmx.eu>
Message-ID: <931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>

On Tue, Aug 11, 2009 at 12:53 PM, Hermann Peifer<peifer@gmx.eu> wrote:
> Markus wrote
>>
>> This works:
>> ? ... ? ? ? ? -srcnodata "-32768" -dstnodata "-32768" -wo
>> "INIT_DEST=-32768" \
>> ? ...
>
> I was taking a similar approach when warping several input tiffs into a
> single output tiff. It looks to me that for each input file, the output file
> is completely reset to the INIT_DEST value, overwriting the values from
> previously processed input files. The final output file did only contain the
> warped values of the last input file in the upper right corner, anything
> else was NODATA. I am wondering if this is rather a feature or a bug.

Hermann,

INIT_DEST should usually only be used for the first run when creating
the file.  The noted behavior is intentional.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From cui_chan at hotmail.com  Wed Aug 12 10:15:30 2009
From: cui_chan at hotmail.com (chen cui)
Date: Wed Aug 12 10:17:32 2009
Subject: [gdal-dev] convert Grass Raster to netCDF
Message-ID: <BLU149-W5AA29A71257B4FCB7AF57EB040@phx.gbl>


hello,

i would like to convert Grass Raster to netCDF format.

i have used  the following command from gdal library:

gdal_translate /directory/Global/Permanent/cellhd/RasterMask RasterNC.nc

which worked well!

i also use gdalinfo to check the netCDF file:

gdalinfo RasterNC.nc

Driver: GTiff/GeoTIFF
Size is 20, 2
Coordinate System is `'
Origin = (74.000000,35.500000)
Pixel Size = (0.20000000,-0.20000000)
Corner Coordinates:
Upper Left  (  74.0000000,  35.5000000)
Lower Left  (  74.0000000,  35.1000000)
Upper Right (  78.0000000,  35.5000000)
Lower Right (  78.0000000,  35.1000000)
Center      (  76.0000000,  35.3000000)
Band 1 Block=20x2 Type=Float32, ColorInterp=Gray
 NoData Value=-9999



Which shows the driver information is GTiff/GeoTIFF not
Driver:netCDF/Network Common Data Format

Could anybody tell me why it is like that? What kind of netCDF file format it is after using gdal_translate?

best regards,
Tracy

_________________________________________________________________
More than messages?check out the rest of the Windows Live?.
http://www.microsoft.com/windows/windowslive/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090812/7b51f375/attachment.html
From peifer at gmx.eu  Wed Aug 12 10:20:14 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Aug 12 10:23:37 2009
Subject: [gdal-dev] Re: Problem with nodata values
In-Reply-To: <931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>	
	<4A69D6D0.4040903@pobox.com>	
	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>	
	<86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>	
	<4A81A220.1070502@gmx.eu>
	<931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>
Message-ID: <4A82CF9E.7020203@gmx.eu>

Frank Warmerdam wrote:
> On Tue, Aug 11, 2009 at 12:53 PM, Hermann Peifer<peifer@gmx.eu> wrote:
>   
>> Markus wrote
>>     
>>> This works:
>>>   ...         -srcnodata "-32768" -dstnodata "-32768" -wo
>>> "INIT_DEST=-32768" \
>>>   ...
>>>       
>> I was taking a similar approach when warping several input tiffs into a
>> single output tiff. It looks to me that for each input file, the output file
>> is completely reset to the INIT_DEST value, overwriting the values from
>> previously processed input files. The final output file did only contain the
>> warped values of the last input file in the upper right corner, anything
>> else was NODATA. I am wondering if this is rather a feature or a bug.
>>     
>
> Hermann,
>
> INIT_DEST should usually only be used for the first run when creating
> the file.  The noted behavior is intentional.
>
> Best regards,
>   

OK. Thanks.

Just in case I didn't make myself clear enough, I was running a single 
gdalwarp command, something like:

$ gdalwarp -srcnodata "-9999" -dstnodata "-9999" -wo "INIT_DEST=-9999" \
   input1.tif input2.tif input3.tif ... output.tif

Hermann
From warmerdam at pobox.com  Wed Aug 12 10:59:29 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 12 10:59:31 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>
	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>
Message-ID: <931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com>

2009/8/9 Jorge Ar?valo <jorge.arevalo@gmail.com>:
> Then, my point could be, when creating the dataset (Open static
> method), perform a query to get all the blocks that cover the extent
> of the raster (the extent is in RASTER_COLUMNS table) and store them
> in any place (A new class attribute?, flush the data on a tmp file?).
> Then, override IRasterIO in Dataset to get the data fetched in the
> extent query, instead of perform a new call. And override the
> RasterBand::IReadBlock method too.
>
> It will supppose a change of perspective, but it will improve the
> performance, of course.

Jorge,

I'm afraid I have not quite followed the discussion of the IRasterIO
implementation, but I find the above statement quite alarming.
It is imperative that we *not* end up reading back all blocks
if only a few are requested.  Imagine a 100GB image split up
into blocks in a table.  If an application using GDAL is run and
only needs a small area of the file it is important that the
blocks not requested never be pulled from the DB.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From scott.sinclair.za at gmail.com  Wed Aug 12 11:50:58 2009
From: scott.sinclair.za at gmail.com (Scott Sinclair)
Date: Wed Aug 12 11:51:00 2009
Subject: [gdal-dev] convert Grass Raster to netCDF
In-Reply-To: <BLU149-W5AA29A71257B4FCB7AF57EB040@phx.gbl>
References: <BLU149-W5AA29A71257B4FCB7AF57EB040@phx.gbl>
Message-ID: <6a17e9ee0908120850q7d9e1b2do8c0aefb318dc2fa2@mail.gmail.com>

>2009/8/12 chen cui <cui_chan@hotmail.com>:
> i would like to convert Grass Raster to netCDF format.
>
> i have used? the following command from gdal library:
>
> gdal_translate /directory/Global/Permanent/cellhd/RasterMask RasterNC.nc
>
> which worked well!
>
> i also use gdalinfo to check the netCDF file:
>
> gdalinfo RasterNC.nc
>
> Driver: GTiff/GeoTIFF
>
> Which shows the driver information is GTiff/GeoTIFF not
> Driver:netCDF/Network Common Data Format

Hi,

You need to specify the output format using the '-of netCDF' option to
gdal_translate, the default output is GeoTIFF..

See http://www.remotesensing.org/gdal/gdal_translate.html &
http://www.remotesensing.org/gdal/formats_list.html

Cheers,
Scott
From Shawn.Gong at drdc-rddc.gc.ca  Wed Aug 12 12:17:03 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Wed Aug 12 12:17:14 2009
Subject: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits per
	sample will not be interpreted properly
In-Reply-To: <931f8ea90908120712t17707d9sb408e1cc80348dd1@mail.gmail.com>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA4A@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<931f8ea90908120712t17707d9sb408e1cc80348dd1@mail.gmail.com>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA4C@ottawaex02.Ottawa.drdc-rddc.gc.ca>

thanks Frank.

I suspect that the large file size may have something to do (the
uncompresssed NITF is more than 2.3 GB) on Windows.

So I downloaded your latest FWTools 2.0.6 on Linux and tried to use
openev. But I got Segmentation fault while opening any images.

Shawn


sgong@m:/home/sgong/FWTools-2.0.6> openev
Default software rendering mode (use -h if accelerated video card
installed).
 
Gdk-WARNING **: Missing charsets in FontSet creation
Gdk-WARNING **:     JISX0208.1983-0
Gdk-WARNING **:     KSC5601.1987-0
Gdk-WARNING **:     GB2312.1980-0
Gdk-WARNING **:     JISX0201.1976-0
 
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/gvrastertools.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/isodata.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/reproject.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/Tool_Export.py
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/Tool_ShapesGrid.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/calculator.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/compose.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/open_raw.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/wmstool.py
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/imgproctemplate.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/mil_symbols.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/rendertest.py
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/Tool_autopan.py
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/Tool_DriverList.py
Loading tools from /home/sgong/FWTools-2.0.6/bin/../tools/fft.py
Loading tools from
/home/sgong/FWTools-2.0.6/bin/../tools/open_subarea.py
/home/sgong/FWTools-2.0.6/bin/openev: line 25: 22128 Segmentation fault
(core dumped) ${OPENEV_HOME}/bin/python ${OPENEV_HOME}/pymod/openev.py
"$@"



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Frank Warmerdam
Sent: Wednesday, August 12, 2009 10:12 AM
To: Gong, Shawn (Contractor)
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits
per sample will not be interpreted properly

On Tue, Aug 11, 2009 at 12:17 PM, Gong, Shawn
(Contractor)<Shawn.Gong@drdc-rddc.gc.ca> wrote:
> hi list,
>
> I found help clues to build libecwj2 on Windows.

Shawn,

Congrats on working though this issue!  Perhaps you would like to add
some notes to:

  http://trac.osgeo.org/gdal/wiki/ECW

> However when I tried to open GeoEye-1 NITF, I got "Warning 1: Image
with 11
> bits per sample will not be interpreted properly".

I thought there were changes in trunk to avoid this warning when the
image is jpeg2000 and being handled by a suitable codec.  However,
I think I only tested this specific issue when using JP2KAK for the
jpeg2000 support.  I'm not sure if there are problems with the ecw sdk
and such files or not.  However, the note about being badly corrupted
should not really apply.

> There are two sub-datasets in NITF (please see the gdalinfo at the
end). If
> I open the 2nd sub-dataset, the data show only 73 pixels and 220
lines;
> digital numbers are either 0 or 255.

Hmm, I don't know why it would be particularly small in size.
I'm also surprised that the latest windows fwtools has problems.
Perhaps you could file a ticket on the issue and I could look into
it a bit next week (especially since problems can be reproduced
with FWTools which I think uses JP2KAK for this purpose).

Hmm, on second thought, I believe I removed JP2KAK from
FWTools for licensing reasons - so perhaps it is using the
ecw jpeg2000 driver too.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090812/15e83522/attachment.html
From mateusz at loskot.net  Wed Aug 12 12:24:41 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug 12 12:24:49 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from
	GDALRasterBand
In-Reply-To: <931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>
	<931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com>
Message-ID: <4A82ECC9.2050907@loskot.net>

Frank Warmerdam wrote:
> 2009/8/9 Jorge Ar?valo <jorge.arevalo@gmail.com>:
>> Then, my point could be, when creating the dataset (Open static 
>> method), perform a query to get all the blocks that cover the
>> extent of the raster (the extent is in RASTER_COLUMNS table) and
>> store them in any place (A new class attribute?, flush the data on
>> a tmp file?). Then, override IRasterIO in Dataset to get the data
>> fetched in the extent query, instead of perform a new call. And
>> override the RasterBand::IReadBlock method too.
>> 
>> It will supppose a change of perspective, but it will improve the 
>> performance, of course.
> 
> Jorge,
> 
> I'm afraid I have not quite followed the discussion of the IRasterIO 
> implementation, but I find the above statement quite alarming. It is
> imperative that we *not* end up reading back all blocks if only a few
> are requested.  Imagine a 100GB image split up into blocks in a
> table.  If an application using GDAL is run and only needs a small
> area of the file it is important that the blocks not requested never
> be pulled from the DB.

I can only second Frank's comment.
IOW, general idea is to query minimum (sub)set of tiles requested,
where request is based on spatial extent (i.e. geographic coordiantes)
or extent within pixel space of a coverage (specified as range of rows
and columns of a raster).

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jorge.arevalo at gmail.com  Wed Aug 12 15:21:28 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Aug 12 15:21:53 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <4A82ECC9.2050907@loskot.net>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com> 
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com> 
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com> 
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com> 
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com> 
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com> 
	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com> 
	<931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com> 
	<4A82ECC9.2050907@loskot.net>
Message-ID: <cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com>

Hello,

2009/8/12 Mateusz Loskot <mateusz@loskot.net>:
> Frank Warmerdam wrote:
>> 2009/8/9 Jorge Ar?valo <jorge.arevalo@gmail.com>:
>>> Then, my point could be, when creating the dataset (Open static
>>> method), perform a query to get all the blocks that cover the
>>> extent of the raster (the extent is in RASTER_COLUMNS table) and
>>> store them in any place (A new class attribute?, flush the data on
>>> a tmp file?). Then, override IRasterIO in Dataset to get the data
>>> fetched in the extent query, instead of perform a new call. And
>>> override the RasterBand::IReadBlock method too.
>>>
>>> It will supppose a change of perspective, but it will improve the
>>> performance, of course.
>>
>> Jorge,
>>
>> I'm afraid I have not quite followed the discussion of the IRasterIO
>> implementation, but I find the above statement quite alarming. It is
>> imperative that we *not* end up reading back all blocks if only a few
>> are requested. ?Imagine a 100GB image split up into blocks in a
>> table. ?If an application using GDAL is run and only needs a small
>> area of the file it is important that the blocks not requested never
>> be pulled from the DB.
>
> I can only second Frank's comment.
> IOW, general idea is to query minimum (sub)set of tiles requested,
> where request is based on spatial extent (i.e. geographic coordiantes)
> or extent within pixel space of a coverage (specified as range of rows
> and columns of a raster).
>

OK. Then, and correct me if I'm wrong, the point is to query only the
extent asked by the program using GDAL driver. Then, I should query
only the blocks requested in, for example, the IReadBlock method, just
as I did. But Tamas' suggestion was to minimize the number of server's
rounds implementing a kind of cache system at driver's level.

How could I combine both concepts? Fetch only the blocks that cover
the area defined by block offsets (One query for each IReadBlock call,
more server rounds)? Fetch more blocks but not all the blocks covered
by the raster extent, potentially millions of blocks? Which method
should I override, apart from IReadBlock in RasterBand? I suppose I
could override IRasterIO in Dataset or RasterBand, but it implies
taking care of a lot of things.

Thanks in advance

Best regards,
Jorge


> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
From mateusz at loskot.net  Wed Aug 12 15:32:03 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug 12 15:32:10 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from
	GDALRasterBand
In-Reply-To: <cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<f3b73b7d0908070903j3847e152i6a798f215ad12565@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>
	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>
	<931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com>
	<4A82ECC9.2050907@loskot.net>
	<cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com>
Message-ID: <4A8318B3.2050505@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> 2009/8/12 Mateusz Loskot <mateusz@loskot.net>:
>> Frank Warmerdam wrote:
>>> 2009/8/9 Jorge Ar?valo <jorge.arevalo@gmail.com>:
>>>> Then, my point could be, when creating the dataset (Open static
>>>> method), perform a query to get all the blocks that cover the
>>>> extent of the raster (the extent is in RASTER_COLUMNS table) and
>>>> store them in any place (A new class attribute?, flush the data on
>>>> a tmp file?). Then, override IRasterIO in Dataset to get the data
>>>> fetched in the extent query, instead of perform a new call. And
>>>> override the RasterBand::IReadBlock method too.
>>>>
>>>> It will supppose a change of perspective, but it will improve the
>>>> performance, of course.
>>> Jorge,
>>>
>>> I'm afraid I have not quite followed the discussion of the IRasterIO
>>> implementation, but I find the above statement quite alarming. It is
>>> imperative that we *not* end up reading back all blocks if only a few
>>> are requested.  Imagine a 100GB image split up into blocks in a
>>> table.  If an application using GDAL is run and only needs a small
>>> area of the file it is important that the blocks not requested never
>>> be pulled from the DB.
>> I can only second Frank's comment.
>> IOW, general idea is to query minimum (sub)set of tiles requested,
>> where request is based on spatial extent (i.e. geographic coordiantes)
>> or extent within pixel space of a coverage (specified as range of rows
>> and columns of a raster).
>>
> 
> OK. Then, and correct me if I'm wrong, the point is to query only the
> extent asked by the program using GDAL driver. Then, I should query
> only the blocks requested in, for example, the IReadBlock method, just
> as I did. But Tamas' suggestion was to minimize the number of server's
> rounds implementing a kind of cache system at driver's level.

My comment was related to similar use case as gdal_translate
and its -srcwin and -projwin parameters

But, I may be missing some of Tamas' points as I've not been
tracking the discussion closely enough.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From szekerest at gmail.com  Wed Aug 12 16:15:58 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Aug 12 16:16:01 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com>
	<cb4457700908071043w3edb7364s7fb439d304249786@mail.gmail.com>
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com>
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com>
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com>
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com>
	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com>
	<931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com>
	<4A82ECC9.2050907@loskot.net>
	<cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com>
Message-ID: <f3b73b7d0908121315v549808au9701a4def0654719@mail.gmail.com>

2009/8/12 Jorge Ar?valo <jorge.arevalo@gmail.com>

>
> >> I'm afraid I have not quite followed the discussion of the IRasterIO
> >> implementation, but I find the above statement quite alarming. It is
> >> imperative that we *not* end up reading back all blocks if only a few
> >> are requested.  Imagine a 100GB image split up into blocks in a
> >> table.  If an application using GDAL is run and only needs a small
> >> area of the file it is important that the blocks not requested never
> >> be pulled from the DB.
> >
> > I can only second Frank's comment.
> > IOW, general idea is to query minimum (sub)set of tiles requested,
> > where request is based on spatial extent (i.e. geographic coordiantes)
> > or extent within pixel space of a coverage (specified as range of rows
> > and columns of a raster).
> >
>
> OK. Then, and correct me if I'm wrong, the point is to query only the
> extent asked by the program using GDAL driver. Then, I should query
> only the blocks requested in, for example, the IReadBlock method, just
> as I did. But Tamas' suggestion was to minimize the number of server's
> rounds implementing a kind of cache system at driver's level.
>


I may have been misunderstood somewhere, but I've never talked about the
requirement to fetch all the data (the entire extent) of the raster data
table.
We have been talking about fetching all the tiles requested by a single
RasterIO call which tiles would definitely be requested by the subsequent
IReadBlock calls if we were rely on the default RasterIO implementation.
Just like what the WCS driver currently implements in DirectRasterIO to
prevent from accessing the server for each tiles.

Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090812/efdecd7f/attachment.html
From jorge.arevalo at gmail.com  Wed Aug 12 16:27:00 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Wed Aug 12 16:27:23 2009
Subject: [gdal-dev] Overriding IRasterIO in class derived from 
	GDALRasterBand
In-Reply-To: <f3b73b7d0908121315v549808au9701a4def0654719@mail.gmail.com>
References: <cb4457700908070805g2833db48j691aabb6f85b6bbb@mail.gmail.com> 
	<f3b73b7d0908071317x523c57ck5ea31ab270ca9ace@mail.gmail.com> 
	<f3b73b7d0908071332n28b3d471o68fa3c11a817d56b@mail.gmail.com> 
	<cb4457700908080843n7d29681el8e05998e07b40965@mail.gmail.com> 
	<f3b73b7d0908081035p44fdc037v5a823405767a0032@mail.gmail.com> 
	<cb4457700908090658q6a60edf1gcae955b3e3c5c4d5@mail.gmail.com> 
	<931f8ea90908120759r6cc06c2ewb236fc6b3f6fbebb@mail.gmail.com> 
	<4A82ECC9.2050907@loskot.net>
	<cb4457700908121221m3c4c4d9do97fe24bf961d14aa@mail.gmail.com> 
	<f3b73b7d0908121315v549808au9701a4def0654719@mail.gmail.com>
Message-ID: <cb4457700908121327k65931e18j7a0f4aed7d3c8e05@mail.gmail.com>

Hello,

2009/8/12 Tamas Szekeres <szekerest@gmail.com>:
>
>
> 2009/8/12 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> >> I'm afraid I have not quite followed the discussion of the IRasterIO
>> >> implementation, but I find the above statement quite alarming. It is
>> >> imperative that we *not* end up reading back all blocks if only a few
>> >> are requested. ?Imagine a 100GB image split up into blocks in a
>> >> table. ?If an application using GDAL is run and only needs a small
>> >> area of the file it is important that the blocks not requested never
>> >> be pulled from the DB.
>> >
>> > I can only second Frank's comment.
>> > IOW, general idea is to query minimum (sub)set of tiles requested,
>> > where request is based on spatial extent (i.e. geographic coordiantes)
>> > or extent within pixel space of a coverage (specified as range of rows
>> > and columns of a raster).
>> >
>>
>> OK. Then, and correct me if I'm wrong, the point is to query only the
>> extent asked by the program using GDAL driver. Then, I should query
>> only the blocks requested in, for example, the IReadBlock method, just
>> as I did. But Tamas' suggestion was to minimize the number of server's
>> rounds implementing a kind of cache system at driver's level.
>
>
> I may have been misunderstood somewhere, but I've never talked about the
> requirement to fetch all the data (the entire extent) of the raster data
> table.
> We have been talking about fetching all the tiles requested by a single
> RasterIO call which tiles would definitely be requested by the subsequent
> IReadBlock calls if we were rely on the default RasterIO implementation.
> Just like what the WCS driver currently implements in DirectRasterIO to
> prevent from accessing the server for each tiles.
>

Yes, of course. The idea of fetching all the data covered by the
extent of the raster was my (wrong) own suggestion.

In WCS, RasterBand::IRasterIO calls Dataset::DirectRasterIO, that
constructs exactly one GetCoverage petition for the given window,
instead of constructing one petition for each small block.

My generalization was to create a single query to get all the extent
of the raster after opening the dataset, instead of all the extent
needed in a IRasterIO call.
That was the error. I'm sorry.

Then, I should follow my first option: override the IRasterIO method
in RasterBand class (and in Dataset too, I suppose).

Best regards,
Jorge


> Best regards,
>
> Tamas
>
>
>
From aljadidi65 at hotmail.com  Thu Aug 13 00:32:17 2009
From: aljadidi65 at hotmail.com (Abdullah Al jadidi)
Date: Thu Aug 13 00:33:20 2009
Subject: [gdal-dev] RE: gdal-dev Digest, Vol 63, Issue 23
In-Reply-To: <20090810160021.194E8E01A75@lists.osgeo.org>
References: <20090810160021.194E8E01A75@lists.osgeo.org>
Message-ID: <COL104-W5976AFE0F18C715EB6F6B2CA050@phx.gbl>


so could you stop set messenge to me .

thank again, Tahnk you for coopration and all information  
 
> From: gdal-dev-request@lists.osgeo.org
> Subject: gdal-dev Digest, Vol 63, Issue 23
> To: gdal-dev@lists.osgeo.org
> Date: Mon, 10 Aug 2009 12:00:21 -0400
> 
> Send gdal-dev mailing list submissions to
> gdal-dev@lists.osgeo.org
> 
> To subscribe or unsubscribe via the World Wide Web, visit
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
> gdal-dev-request@lists.osgeo.org
> 
> You can reach the person managing the list at
> gdal-dev-owner@lists.osgeo.org
> 
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
> 
> 
> Today's Topics:
> 
> 1. reprojection HDF / GCP extraction (Becker, Thomas)
> 2. Re: reprojection HDF / GCP extraction ( Lucena, Ivan )
> 3. RE: reprojection HDF / GCP extraction (Becker, Thomas)
> 4. RE: reprojection HDF / GCP extraction ( Lucena, Ivan )
> 5. Re: Motion: Adopt GDAL 1.6.2RC2 as final release
> (Daniel Morissette)
> 
> 
> ----------------------------------------------------------------------
> 
> Message: 1
> Date: Mon, 10 Aug 2009 14:00:50 +0200
> From: "Becker, Thomas" <thob@dmu.dk>
> Subject: [gdal-dev] reprojection HDF / GCP extraction
> To: "gdal-dev@lists.osgeo.org" <gdal-dev@lists.osgeo.org>
> Message-ID:
> <D4AB8C2051A3D1449495F8E45815E6000B2ADCF42E@dmupost.dmu.dk>
> Content-Type: text/plain; charset="us-ascii"
> 
> Hi all,
> 
> I have a couple NOAA-15 images as HDF-EOS files which I would like to reproject to WGS84. The data carry a subgroup called 'Geolocation Fields' holding latitude and longitude for each pixel in separated arrays. Reading the files with gdalinfo leads to the output at the end of this posting.
> 
> Out of the HDF-EOS format I would like to create a correct georeferenced image (GTIF). One which will not look like a swath scanned image, but a skewed and correctly referenced one.
> 
> Using gdalwarp leads to the message: There is no affine transformation and no GCPs.
> 
> Since the coordinates for the centre of each pixel are stored in the before mentioned arrays, is there a way to extract GCPs out of the data.
> 
> Thanks for your help.
> 
> Best regards,
> Thomas
> 
> gdalinfo output:
> 
> Driver: HDF4/Hierarchical Data Format Release 4
> Files: amsua15_2000.034_08964_0104_0258_GC.eos
> Size is 512, 512
> Coordinate System is `'
> Metadata:
> HDFEOSVersion=HDFEOS_V2.4
> Subdatasets:
> SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:23800.37 MHz
> SUBDATASET_1_DESC=[851x30] 23800.37 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:31400.42 MHz
> SUBDATASET_2_DESC=[851x30] 31400.42 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:50299.91 MHz
> SUBDATASET_3_DESC=[851x30] 50299.91 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_4_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:52799.39 MHz
> SUBDATASET_4_DESC=[851x30] 52799.39 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_5_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:53595.41 +- 115 MHz
> SUBDATASET_5_DESC=[851x30] 53595.41 +- 115 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_6_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:54399.53 MHz
> SUBDATASET_6_DESC=[851x30] 54399.53 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_7_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:54940.64 MHz
> SUBDATASET_7_DESC=[851x30] 54940.64 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_8_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:55498.70 MHz
> SUBDATASET_8_DESC=[851x30] 55498.70 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_9_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 MHz
> SUBDATASET_9_DESC=[851x30] 57290.33 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_10_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 217 MHz
> SUBDATASET_10_DESC=[851x30] 57290.33 +- 217 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_11_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 48 MHz
> SUBDATASET_11_DESC=[851x30] 57290.33 +- 322.2 +- 48 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_12_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 22 MHz
> SUBDATASET_12_DESC=[851x30] 57290.33 +- 322.2 +- 22 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_13_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 10 MHz
> SUBDATASET_13_DESC=[851x30] 57290.33 +- 322.2 +- 10 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_14_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:57290.33 +- 322.2 +- 4.5 MHz
> SUBDATASET_14_DESC=[851x30] 57290.33 +- 322.2 +- 4.5 MHz Orbit 8964 (32-bit floating-point)
> SUBDATASET_15_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 8964:88997.00 MHz
> SUBDATASET_15_DESC=[851x30] 88997.00 MHz Orbit 8964 (32-bit floating-point)
> Corner Coordinates:
> Upper Left ( 0.0, 0.0)
> Lower Left ( 0.0, 512.0)
> Upper Right ( 512.0, 0.0)
> Lower Right ( 512.0, 512.0)
> Center ( 256.0, 256.0)
> 
> 
> ------------------------------
> 
> Message: 2
> Date: Mon, 10 Aug 2009 07:14:39 -0500
> From: " Lucena, Ivan " <ivan.lucena@pmldnet.com>
> Subject: Re: [gdal-dev] reprojection HDF / GCP extraction
> To: "Becker, Thomas" <thob@dmu.dk>, "gdal-dev@lists.osgeo.org"
> <gdal-dev@lists.osgeo.org>
> Message-ID: <20090810121439.27899.qmail@s466.sureserver.com>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> Becker,
> 
> Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate
> 
> Regards,
> 
> Ivan
> 
> 
> > -------Original Message-------
> > From: Becker, Thomas <thob@dmu.dk>
> > Subject: [gdal-dev] reprojection HDF / GCP extraction
> > Sent: Aug 10 '09 07:00
> > 
> > Hi all,
> > 
> > I have a couple NOAA-15 images as HDF-EOS files which I would like to reproject to WGS84. The data carry a 
> subgroup called 'Geolocation Fields' holding latitude and longitude for each pixel in separated arrays. Reading the files 
> with gdalinfo leads to the output at the end of this posting.
> > 
> > Out of the HDF-EOS format I would like to create a correct georeferenced image (GTIF). One which will not look 
> like a swath scanned image, but a skewed and correctly referenced one.
> > 
> > Using gdalwarp leads to the message: There is no affine transformation and no GCPs.
> > 
> > Since the coordinates for the centre of each pixel are stored in the before mentioned arrays, is there a way to 
> extract GCPs out of the data.
> > 
> > Thanks for your help.
> > 
> > Best regards,
> > Thomas
> > 
> > gdalinfo output:
> > 
> > Driver: HDF4/Hierarchical Data Format Release 4
> > Files: amsua15_2000.034_08964_0104_0258_GC.eos
> > Size is 512, 512
> > Coordinate System is `'
> > Metadata:
> >   HDFEOSVersion=HDFEOS_V2.4
> > Subdatasets:
> >   SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:23800.37 MHz
> >   SUBDATASET_1_DESC=[851x30] 23800.37 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:31400.42 MHz
> >   SUBDATASET_2_DESC=[851x30] 31400.42 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:50299.91 MHz
> >   SUBDATASET_3_DESC=[851x30] 50299.91 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_4_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:52799.39 MHz
> >   SUBDATASET_4_DESC=[851x30] 52799.39 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_5_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:53595.41 +- 115 MHz
> >   SUBDATASET_5_DESC=[851x30] 53595.41 +- 115 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_6_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:54399.53 MHz
> >   SUBDATASET_6_DESC=[851x30] 54399.53 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_7_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:54940.64 MHz
> >   SUBDATASET_7_DESC=[851x30] 54940.64 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_8_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:55498.70 MHz
> >   SUBDATASET_8_DESC=[851x30] 55498.70 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_9_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 MHz
> >   SUBDATASET_9_DESC=[851x30] 57290.33 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_10_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 +- 217 MHz
> >   SUBDATASET_10_DESC=[851x30] 57290.33 +- 217 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_11_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 +- 322.2 +- 48 MHz
> >   SUBDATASET_11_DESC=[851x30] 57290.33 +- 322.2 +- 48 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_12_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 +- 322.2 +- 22 MHz
> >   SUBDATASET_12_DESC=[851x30] 57290.33 +- 322.2 +- 22 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_13_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 +- 322.2 +- 10 MHz
> >   SUBDATASET_13_DESC=[851x30] 57290.33 +- 322.2 +- 10 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_14_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:57290.33 +- 322.2 +- 4.5 MHz
> >   SUBDATASET_14_DESC=[851x30] 57290.33 +- 322.2 +- 4.5 MHz Orbit 8964 (32-bit floating-point)
> >   SUBDATASET_15_NAME=HDF4_EOS:EOS_SWATH:"amsua15_2000.034_08964_0104_0258_GC.eos":Orbit 
> 8964:88997.00 MHz
> >   SUBDATASET_15_DESC=[851x30] 88997.00 MHz Orbit 8964 (32-bit floating-point)
> > Corner Coordinates:
> > Upper Left  (    0.0,    0.0)
> > Lower Left  (    0.0,  512.0)
> > Upper Right (  512.0,    0.0)
> > Lower Right (  512.0,  512.0)
> > Center      (  256.0,  256.0)
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> 
> 
> ------------------------------
> 
> Message: 3
> Date: Mon, 10 Aug 2009 15:05:29 +0200
> From: "Becker, Thomas" <thob@dmu.dk>
> Subject: RE: [gdal-dev] reprojection HDF / GCP extraction
> To: "Lucena, Ivan" <ivan.lucena@pmldnet.com>
> Cc: "gdal-dev@lists.osgeo.org" <gdal-dev@lists.osgeo.org>
> Message-ID:
> <D4AB8C2051A3D1449495F8E45815E6000B2ADCF470@dmupost.dmu.dk>
> Content-Type: text/plain; charset="us-ascii"
> 
> Hello Ivan,
> 
> thanks for the hint. Now is this how GDAL already works? Because this track is meant for comments. At least in my data which are from 2000 I can not see any metadata of that kind. After reading the trac I am puzzled. Also in the output of gdalinfo only the subdatset of 'Data Fields' is mentioned and not the subdataset of 'Geolocation Fields'. I can not realy see which band represent latitude and longitude.
> 
> If I just don't understand the trac maybe you can tell me how a command to GDAL, based on the gdalinfo output would look like to get the job done.
> 
> Regards,
> 
> Thomas
> 
> -----Original Message-----
> From: Lucena, Ivan [mailto:ivan.lucena@pmldnet.com] 
> Sent: Monday, August 10, 2009 2:15 PM
> To: Becker, Thomas; gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] reprojection HDF / GCP extraction
> 
> Becker,
> 
> Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate
> 
> Regards,
> 
> Ivan
> 
> 
> ------------------------------
> 
> Message: 4
> Date: Mon, 10 Aug 2009 08:37:17 -0500
> From: " Lucena, Ivan " <ivan.lucena@pmldnet.com>
> Subject: RE: [gdal-dev] reprojection HDF / GCP extraction
> To: "Becker, Thomas" <thob@dmu.dk>
> Cc: "gdal-dev@lists.osgeo.org" <gdal-dev@lists.osgeo.org>
> Message-ID: <20090810133719.21851.qmail@s466.sureserver.com>
> Content-Type: text/plain; charset="iso-8859-1"
> 
> Becker,
> 
> I afraid I don't have much to add to what is in the RFC#4. You can search on the discussion list archives for more 
> information or wait for the sun to weak up the experts.
> 
> Regards,
> 
> Ivan
> 
> 
> > -------Original Message-------
> > From: Becker, Thomas <thob@dmu.dk>
> > Subject: RE: [gdal-dev] reprojection HDF / GCP extraction
> > Sent: Aug 10 '09 08:05
> > 
> > Hello Ivan,
> > 
> > thanks for the hint. Now is this how GDAL already works? Because this track is meant for comments. At least in 
> my data which are from 2000 I can not see any metadata of that kind. After reading the trac I am puzzled. Also in 
> the output of gdalinfo only the subdatset of 'Data Fields' is mentioned and not the subdataset of 'Geolocation 
> Fields'. I can not realy see which band represent latitude and longitude.
> > 
> > If I just don't understand the trac maybe you can tell me how a command to GDAL, based on the gdalinfo 
> output would look like to get the job done.
> > 
> > Regards,
> > 
> > Thomas
> > 
> > -----Original Message-----
> > From: Lucena, Ivan [mailto:ivan.lucena@pmldnet.com]
> > Sent: Monday, August 10, 2009 2:15 PM
> > To: Becker, Thomas; gdal-dev@lists.osgeo.org
> > Subject: Re: [gdal-dev] reprojection HDF / GCP extraction
> > 
> > Becker,
> > 
> > Please take a look at RFC#4: http://trac.osgeo.org/gdal/wiki/rfc4_geolocate
> > 
> > Regards,
> > 
> > Ivan
> > 
> 
> 
> ------------------------------
> 
> Message: 5
> Date: Mon, 10 Aug 2009 11:12:45 -0400
> From: Daniel Morissette <dmorissette@mapgears.com>
> Subject: Re: [gdal-dev] Motion: Adopt GDAL 1.6.2RC2 as final release
> To: gdal-dev <gdal-dev@lists.osgeo.org>
> Message-ID: <4A8038ED.6080709@mapgears.com>
> Content-Type: text/plain; charset=ISO-8859-1; format=flowed
> 
> Frank Warmerdam wrote:
> > Motion: Adopt GDAL 1.6.2RC2 as official GDAL/OGR 1.6.2 release.
> > 
> 
> +1 (Sorry for the delayed vote, I was away last week. I just tested it 
> and it seems fine.)
> 
> 
> Daniel
> -- 
> Daniel Morissette
> http://www.mapgears.com/
> 
> 
> ------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> End of gdal-dev Digest, Vol 63, Issue 23
> ****************************************

_________________________________________________________________
.Windows Live ????? ????? ???? ???????? ????????? ???????? 
http://www.microsoft.com/middleeast/arabic/windows/windowslive/products/photo-gallery-edit.aspx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090813/54556464/attachment-0001.html
From atubar at 126.com  Thu Aug 13 03:52:46 2009
From: atubar at 126.com (atubar)
Date: Thu Aug 13 04:23:21 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <4A82182C.4000908@loskot.net>
References: <4A82182C.4000908@loskot.net>
	<eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>
	<9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
	<11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>
Message-ID: <14681142.266211250149966636.JavaMail.coremail@bj126app20.126.com>

Today, I find a computer with VS2005 installed on it. And I build  gdal 1.6.1 with pre-built dlls supplied as package named win42r4-VS2005-IVF101, hdf5_183_xp32_vs2005_ivf91 from HDFGroup website. While building, warnings can be ignored, and no error occurs.

I copy dlls such as gdal16.dll, hd424m.dll, hm424m.dll, hdf5dll.dll, szlibdll.dll(from szip21-vs2005-enc), zlib1.dll(from zlib123-vs2005)  into the project folder.  And add include and lib of gdal built results to the project.

Then I modify the program as what you said. The modified code is listed below:

//------------------------------------//
#include <iostream>

#include "gdal_priv.h"
#pragma comment(lib,"gdal_i.lib")

using namespace std;

int main()
{
 GDALAllRegister();
 
 const char* filename="D:\\RSI\\IDL63\\examples\\data\\africavlc.png";
 
 const char* pszFormat="HDF5";
 GDALDriver *poDriver = GetGDALDriverManager()->GetDriverByName(pszFormat);
 
 if( poDriver != NULL )
 {
  ////........................
  ////THe program can run here.
 }
 else
 {
  cout<<"Gdal do not support HDF5!"<<endl;

 }
 GDALDataset *poDataset;
 
 poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly);
 //The program reports an error like this.
 //Unhandled exception in **.exe:0xC00000FD:Stack Overflow
 //Then the compiler ask me wether to Break up the program.
 
 if(poDataset == NULL)
 {
  cout<<"error!";
  return 0;
 }
 else
 {
  //...................
 }
 
 GDALClose(poDataset);
 return 0;
}
//---------------------------------------------// 

Is there any detail that you need?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090813/3804261a/attachment.html
From cui_chan at hotmail.com  Thu Aug 13 07:31:41 2009
From: cui_chan at hotmail.com (chen cui)
Date: Thu Aug 13 07:32:42 2009
Subject: [gdal-dev] Problem: Convert to netCDF using gdal_translate
In-Reply-To: <931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
	<86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>
	<4A81A220.1070502@gmx.eu> 
	<931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>
Message-ID: <BLU149-W6AA5A9675C9DC5080C242EB050@phx.gbl>



Hello, dear all,

I would like to use gdal_translate to convert .tif file and Grass raster file to netCDF file. 
On my computer system, the libgdal version is 1.3.2 and the libnetcdf version is 3. I have
used the following command:

gdal_translate -of netCDF -b 1 test.tif test.nc

but it showed the following message:

0netcdf: 3 is not a valid cdfid

Could anybody tell me how to solve this problem?

thank you in advance!

Tracy


_________________________________________________________________
With Windows Live, you can organize, edit, and share your photos.
http://www.microsoft.com/middleeast/windows/windowslive/products/photo-gallery-edit.aspx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090813/6f67c6e7/attachment.html
From warmerdam at pobox.com  Thu Aug 13 11:59:53 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 13 11:59:56 2009
Subject: [gdal-dev] Re: Problem: Convert to netCDF using gdal_translate
In-Reply-To: <BLU149-W6AA5A9675C9DC5080C242EB050@phx.gbl>
References: <fb7c7e870907240620m1ebcfac7sbe1b25325179135@mail.gmail.com>
	<4A69D6D0.4040903@pobox.com>
	<fb7c7e870907290008q709c9426j7da5029b87768d8c@mail.gmail.com>
	<86782b610908110242j1bc79302y1a5473ef661a808a@mail.gmail.com>
	<4A81A220.1070502@gmx.eu>
	<931f8ea90908120713o45b4bbb4mc8d5f617962a49c2@mail.gmail.com>
	<BLU149-W6AA5A9675C9DC5080C242EB050@phx.gbl>
Message-ID: <931f8ea90908130859r32f35d39p4df697878ab6924e@mail.gmail.com>

Tracey,

I don't know what is going wrong here.  The cdfid is a file
descriptor used with libnetcdf.  This might possibly be a
file error (disk full?) but more likely it is some sort of build problem.

I tried some similar simple stuff with the netcdf driver from trunk and
had no problems.  I've been using libnetcdf 3.6.1 on windows.

Good luck,

On Thu, Aug 13, 2009 at 7:31 AM, chen cui<cui_chan@hotmail.com> wrote:
>
> Hello, dear all,
>
> I would like to use gdal_translate to convert .tif file and Grass raster
> file to netCDF file.
> On my computer system, the libgdal version is 1.3.2 and the libnetcdf
> version is 3. I have
> used the following command:
>
> gdal_translate -of netCDF -b 1 test.tif test.nc
>
> but it showed the following message:
>
> 0netcdf: 3 is not a valid cdfid
>
> Could anybody tell me how to solve this problem?
>
> thank you in advance!
>
> Tracy
>
>
> ________________________________
> With Windows Live, you can organize, edit, and share your photos.



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From woklist at kyngchaos.com  Thu Aug 13 14:43:27 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu Aug 13 14:43:31 2009
Subject: [gdal-dev] old autotest http/dods issue - fix
Message-ID: <724441FB-2C5C-4BC1-8C98-283E514CBCFD@kyngchaos.com>

I keep having this problem in the autotests where the gdalhttp test  
ends up using the DODS driver.  I finally fixed it by adding this  
after the initial HTTP driver load test, much like the various JP2  
tests:

     try:
         drv = gdal.GetDriverByName( 'DODS' )
         drv.Deregister();
         drv.Register()
         print 'Moved DODS'
     except:
         pass


P.S.  is there something wrong with the onearth WMS server used for  
the wms test?  The urlopen() check stalls with no timeout.  It didn't  
do this in the past.

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"History is an illusion caused by the passage of time, and time is an  
illusion caused by the passage of history."

- Hitchhiker's Guide to the Galaxy


From ealpert at digitalglobe.com  Thu Aug 13 18:50:54 2009
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Thu Aug 13 18:55:25 2009
Subject: [gdal-dev] autotest 1.6 errors - need help
In-Reply-To: <44C90163-589D-4A56-B77E-42AE889DCB9F@kyngchaos.com>
References: <412A2282-D695-471F-A522-F6B09C9A608C@kyngchaos.com><49341F2D.2020606@pobox.com><6CD6B857-6977-4F13-9F83-3052D759C429@kyngchaos.com><200812011920.15094.even.rouault@mines-paris.org>
	<44C90163-589D-4A56-B77E-42AE889DCB9F@kyngchaos.com>
Message-ID: <8B319E5A30FF4A48BE7EEAAF609DB233047909EE@COMAIL01.digitalglobe.com>


Was there ever any resolution to this problem?

I'm using 1.6 and xerces 3.0. When I try to read GML created with GDAL I
get the following error:

ERROR 1: <coordinates> element missing value



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of William
Kyngesburye
Sent: Monday, December 01, 2008 8:13 PM
To: Even Rouault
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] autotest 1.6 errors - need help

On Dec 1, 2008, at 12:20 PM, Even Rouault wrote:

> Yes, ILI/IOM has been fixed, but the GML driver has also been  
> changed so that
> it behaves correctly with Xerces 3.0. I can confirm that GDAL  
> 1.6.0RC2 passes
> the GML autotest when compiled and run against xerces-3.0.0 (x86  
> Linux).
> Are you sure you running a very recent GDAL ? The fix was commited  
> in r15773,
> on 2008/11/20, between beta2 and RC1.
>

Ah, something wrong with Xerces 3, at least with mine.  GDAL 1.6RC3  
now, same errors.  Rebuilt GDAL with Xerces 2.8 and all I get is:

   TEST: ogr_gml_4 ... fail
     Wrong featureCode field value

ILI still succeeds.

The full set of errors with Xerces 3 is:

   TEST: ogr_gml_1 ... ERROR 1: <coordinates> element missing value.
fail (blowup)
Traceback (most recent call last):
   File "pymod/gdaltest.py", line 89, in run_tests
     result = func()
   File "./ogr_gml_read.py", line 72, in ogr_gml_1
     if feat.GetField('Name') != 'Aartselaar':
AttributeError: 'NoneType' object has no attribute 'GetField'
   TEST: ogr_gml_2 ... ERROR 1: <coordinates> element missing value.
fail (blowup)
Traceback (most recent call last):
   File "pymod/gdaltest.py", line 89, in run_tests
     result = func()
   File "./ogr_gml_read.py", line 100, in ogr_gml_2
     if gml_ds.GetLayerCount() != 1:
AttributeError: 'NoneType' object has no attribute 'GetLayerCount'
   TEST: ogr_gml_3 ... ERROR 1: <coordinates> element missing value.
fail (blowup)
Traceback (most recent call last):
   File "pymod/gdaltest.py", line 89, in run_tests
     result = func()
   File "./ogr_gml_read.py", line 139, in ogr_gml_3
     if feat.GetField('ngd_id') != 817792:
AttributeError: 'NoneType' object has no attribute 'GetField'
   TEST: ogr_gml_4 ... ERROR 1: <coordinates> element missing value.
fail (blowup)
Traceback (most recent call last):
   File "pymod/gdaltest.py", line 89, in run_tests
     result = func()
   File "./ogr_gml_read.py", line 181, in ogr_gml_4
     if feat.GetField('featureCode') != 10198:
AttributeError: 'NoneType' object has no attribute 'GetField'
   TEST: ogr_gml_5 ... ERROR 1: <coordinates> element missing value.
success


-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

First Pogril: Why is life like sticking your head in a bucket filled  
with hyena offal?
Second Pogril: I don't know.  Why IS life like sticking your head in a  
bucket filled with hyena offal?
First Pogril: I don't know either.  Wretched, isn't it?

-HitchHiker's Guide to the Galaxy


_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

This electronic communication and any attachments may contain confidential and proprietary 
information of DigitalGlobe, Inc. If you are not the intended recipient, or an agent or employee 
responsible for delivering this communication to the intended recipient, or if you have received 
this communication in error, please do not print, copy, retransmit, disseminate or 
otherwise use the information. Please indicate to the sender that you have received this 
communication in error, and delete the copy you received. DigitalGlobe reserves the 
right to monitor any electronic communication sent or received by its employees, agents 
or representatives.

From woklist at kyngchaos.com  Thu Aug 13 19:06:59 2009
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu Aug 13 19:07:04 2009
Subject: [gdal-dev] autotest 1.6 errors - need help
In-Reply-To: <8B319E5A30FF4A48BE7EEAAF609DB233047909EE@COMAIL01.digitalglobe.com>
References: <412A2282-D695-471F-A522-F6B09C9A608C@kyngchaos.com><49341F2D.2020606@pobox.com><6CD6B857-6977-4F13-9F83-3052D759C429@kyngchaos.com><200812011920.15094.even.rouault@mines-paris.org>
	<44C90163-589D-4A56-B77E-42AE889DCB9F@kyngchaos.com>
	<8B319E5A30FF4A48BE7EEAAF609DB233047909EE@COMAIL01.digitalglobe.com>
Message-ID: <549140BF-5310-4613-B2E8-FC69700EDC86@kyngchaos.com>

I haven't tried since then.  Are you also using OSX?

Maybe I should try again, after 2 GDAL updates and a Xerces 3 update...

On Aug 13, 2009, at 5:50 PM, Ethan Alpert wrote:

>
> Was there ever any resolution to this problem?
>
> I'm using 1.6 and xerces 3.0. When I try to read GML created with  
> GDAL I
> get the following error:
>
> ERROR 1: <coordinates> element missing value
>
>
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of William
> Kyngesburye
> Sent: Monday, December 01, 2008 8:13 PM
> To: Even Rouault
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] autotest 1.6 errors - need help
>
> On Dec 1, 2008, at 12:20 PM, Even Rouault wrote:
>
>> Yes, ILI/IOM has been fixed, but the GML driver has also been
>> changed so that
>> it behaves correctly with Xerces 3.0. I can confirm that GDAL
>> 1.6.0RC2 passes
>> the GML autotest when compiled and run against xerces-3.0.0 (x86
>> Linux).
>> Are you sure you running a very recent GDAL ? The fix was commited
>> in r15773,
>> on 2008/11/20, between beta2 and RC1.
>>
>
> Ah, something wrong with Xerces 3, at least with mine.  GDAL 1.6RC3
> now, same errors.  Rebuilt GDAL with Xerces 2.8 and all I get is:
>
>   TEST: ogr_gml_4 ... fail
>     Wrong featureCode field value
>
> ILI still succeeds.
>
> The full set of errors with Xerces 3 is:
>
>   TEST: ogr_gml_1 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 72, in ogr_gml_1
>     if feat.GetField('Name') != 'Aartselaar':
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_2 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 100, in ogr_gml_2
>     if gml_ds.GetLayerCount() != 1:
> AttributeError: 'NoneType' object has no attribute 'GetLayerCount'
>   TEST: ogr_gml_3 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 139, in ogr_gml_3
>     if feat.GetField('ngd_id') != 817792:
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_4 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 181, in ogr_gml_4
>     if feat.GetField('featureCode') != 10198:
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_5 ... ERROR 1: <coordinates> element missing value.
> success

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Time is an illusion - lunchtime doubly so."

- Ford Prefect


From ealpert at digitalglobe.com  Thu Aug 13 19:17:32 2009
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Thu Aug 13 19:17:39 2009
Subject: [gdal-dev] autotest 1.6 errors - need help
In-Reply-To: <549140BF-5310-4613-B2E8-FC69700EDC86@kyngchaos.com>
References: <412A2282-D695-471F-A522-F6B09C9A608C@kyngchaos.com><49341F2D.2020606@pobox.com><6CD6B857-6977-4F13-9F83-3052D759C429@kyngchaos.com><200812011920.15094.even.rouault@mines-paris.org>
	<44C90163-589D-4A56-B77E-42AE889DCB9F@kyngchaos.com>
	<8B319E5A30FF4A48BE7EEAAF609DB233047909EE@COMAIL01.digitalglobe.com>
	<549140BF-5310-4613-B2E8-FC69700EDC86@kyngchaos.com>
Message-ID: <8B319E5A30FF4A48BE7EEAAF609DB233047909F3@COMAIL01.digitalglobe.com>


I'm running on a RHEL5.2 linux box.

-----Original Message-----
From: William Kyngesburye [mailto:woklist@kyngchaos.com] 
Sent: Thursday, August 13, 2009 5:07 PM
To: Ethan Alpert
Cc: Even Rouault; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] autotest 1.6 errors - need help

I haven't tried since then.  Are you also using OSX?

Maybe I should try again, after 2 GDAL updates and a Xerces 3 update...

On Aug 13, 2009, at 5:50 PM, Ethan Alpert wrote:

>
> Was there ever any resolution to this problem?
>
> I'm using 1.6 and xerces 3.0. When I try to read GML created with  
> GDAL I
> get the following error:
>
> ERROR 1: <coordinates> element missing value
>
>
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of William
> Kyngesburye
> Sent: Monday, December 01, 2008 8:13 PM
> To: Even Rouault
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] autotest 1.6 errors - need help
>
> On Dec 1, 2008, at 12:20 PM, Even Rouault wrote:
>
>> Yes, ILI/IOM has been fixed, but the GML driver has also been
>> changed so that
>> it behaves correctly with Xerces 3.0. I can confirm that GDAL
>> 1.6.0RC2 passes
>> the GML autotest when compiled and run against xerces-3.0.0 (x86
>> Linux).
>> Are you sure you running a very recent GDAL ? The fix was commited
>> in r15773,
>> on 2008/11/20, between beta2 and RC1.
>>
>
> Ah, something wrong with Xerces 3, at least with mine.  GDAL 1.6RC3
> now, same errors.  Rebuilt GDAL with Xerces 2.8 and all I get is:
>
>   TEST: ogr_gml_4 ... fail
>     Wrong featureCode field value
>
> ILI still succeeds.
>
> The full set of errors with Xerces 3 is:
>
>   TEST: ogr_gml_1 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 72, in ogr_gml_1
>     if feat.GetField('Name') != 'Aartselaar':
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_2 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 100, in ogr_gml_2
>     if gml_ds.GetLayerCount() != 1:
> AttributeError: 'NoneType' object has no attribute 'GetLayerCount'
>   TEST: ogr_gml_3 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 139, in ogr_gml_3
>     if feat.GetField('ngd_id') != 817792:
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_4 ... ERROR 1: <coordinates> element missing value.
> fail (blowup)
> Traceback (most recent call last):
>   File "pymod/gdaltest.py", line 89, in run_tests
>     result = func()
>   File "./ogr_gml_read.py", line 181, in ogr_gml_4
>     if feat.GetField('featureCode') != 10198:
> AttributeError: 'NoneType' object has no attribute 'GetField'
>   TEST: ogr_gml_5 ... ERROR 1: <coordinates> element missing value.
> success

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Time is an illusion - lunchtime doubly so."

- Ford Prefect



This electronic communication and any attachments may contain confidential and proprietary 
information of DigitalGlobe, Inc. If you are not the intended recipient, or an agent or employee 
responsible for delivering this communication to the intended recipient, or if you have received 
this communication in error, please do not print, copy, retransmit, disseminate or 
otherwise use the information. Please indicate to the sender that you have received this 
communication in error, and delete the copy you received. DigitalGlobe reserves the 
right to monitor any electronic communication sent or received by its employees, agents 
or representatives.

From mateusz at loskot.net  Thu Aug 13 21:27:46 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 13 21:27:53 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <14681142.266211250149966636.JavaMail.coremail@bj126app20.126.com>
References: <4A82182C.4000908@loskot.net>
	<eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>
	<9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
	<11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>
	<14681142.266211250149966636.JavaMail.coremail@bj126app20.126.com>
Message-ID: <4A84BD92.8060206@loskot.net>

atubar wrote:
> Today, I find a computer with VS2005 installed on it. And I build
> gdal 1.6.1 with pre-built dlls supplied as package named
> win42r4-VS2005-IVF101, hdf5_183_xp32_vs2005_ivf91 from HDFGroup
> website. While building, warnings can be ignored, and no error
> occurs.
> 
> I copy dlls such as gdal16.dll, hd424m.dll, hm424m.dll, hdf5dll.dll,
> szlibdll.dll(from szip21-vs2005-enc), zlib1.dll(from zlib123-vs2005)
> into the project folder.  And add include and lib of gdal built
> results to the project.
> 
> Then I modify the program as what you said. The modified code is
> listed below:
> 
> //------------------------------------// #include <iostream>
> 
> #include "gdal_priv.h" #pragma comment(lib,"gdal_i.lib")
> 
> using namespace std;
> 
> int main() { GDALAllRegister();
> 
> const char* filename="D:\\RSI\\IDL63\\examples\\data\\africavlc.png";
> 
> 
> const char* pszFormat="HDF5"; GDALDriver *poDriver =
> GetGDALDriverManager()->GetDriverByName(pszFormat);
> 
> if( poDriver != NULL ) { ////........................ ////THe program
> can run here. } else { cout<<"Gdal do not support HDF5!"<<endl;
> 
> } GDALDataset *poDataset;
> 
> poDataset= (GDALDataset *) GDALOpen( filename, GA_ReadOnly); //The
> program reports an error like this. //Unhandled exception in
> **.exe:0xC00000FD:Stack Overflow //Then the compiler ask me wether to
> Break up the program.

The only thing I can suggest is to play with debugger and try to identiy
where the problem comes from. I can't see any shortcut.

BTW, ensure you don't have any old files (headers or binaries) of
previous versions of GDAL or HDF dangling around.
IOW, ensure the dev environment is clean.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From srikanth1947 at gmail.com  Fri Aug 14 02:59:07 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Fri Aug 14 02:59:09 2009
Subject: [gdal-dev] regarding GDALDriver::Create
Message-ID: <7a566dfe0908132359l141c9e9aoc9b606c650520570@mail.gmail.com>

Dear All,

I am reading and writing raster images using GDAL. Below is the code which I
am using for writing a raster.
At times the code is working fine. But many a time , it is getting crashed
in the *GetRasterBand.* I have debugged the code several times and the
variables passed seems to be perfect. Any help in this is regard would be
appreciated.


bool GDALImageWriter::InitiliazeDataset(char* filename , int width , int
height , int numOfbands ,rasterDataType datatype){

   this->imageWidth = width ;
   this->imageHeight = height ;
   this->numOfBands = numOfbands ;
   this->datatpye = datatype ;
   poBand = new GDALRasterBand*[numOfbands] ;

   poDriver = GetGDALDriverManager()->GetDriverByName("GTiff");

   //papszOptions = CSLSetNameValue( papszOptions, "TILED", "YES" );
   //papszOptions = CSLSetNameValue( papszOptions, "COMPRESS", "PACKBITS" );

   poDataset=NULL;
   *poDataset = poDriver->Create(filename , width , height , numOfbands
,(GDALDataType)datatype,NULL);*

   for(int i=0 ; i < numOfbands ; i++)
     {
             poBand[i] = poDataset->GetRasterBand(i+1);
      }


   if(projectionStr != NULL)
       poDataset->SetProjection(projectionStr);
   if(adfGeoTransform != NULL)
       poDataset->SetGeoTransform(adfGeoTransform);

   if(poDataset == NULL)
       return false ;
   else
       return true ;
}



bool GDALImageWriter::writeData(int x , int y , int blockWidth , int
blockHeight ,uchar* data){

for(int i=0 ; i < numOfBands ; i++){

poBand[i]->RasterIO(GF_Write, x, y, blockWidth, blockHeight,data,
blockWidth, blockHeight,(GDALDataType)this->datatpye, 0, 0);

}

}

bool GDALImageWriter::closeDataset(){

if(poDataset!=NULL)

GDALClose(poDataset);

}










-- 
Regards,
Srikanth K.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090814/51130e3c/attachment-0001.html
From warmerdam at pobox.com  Fri Aug 14 08:01:32 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 14 08:06:36 2009
Subject: [gdal-dev] regarding GDALDriver::Create
In-Reply-To: <7a566dfe0908132359l141c9e9aoc9b606c650520570@mail.gmail.com>
References: <7a566dfe0908132359l141c9e9aoc9b606c650520570@mail.gmail.com>
Message-ID: <931f8ea90908140501y2b9a96aardd8923a4202f379e@mail.gmail.com>

On Fri, Aug 14, 2009 at 2:59 AM, Srikanth<srikanth1947@gmail.com> wrote:
> Dear All,
>
> I am reading and writing raster images using GDAL. Below is the code which I
> am using for writing a raster.
> At times the code is working fine. But many a time , it is getting crashed
> in the GetRasterBand. I have debugged the code several times and the
> variables passed seems to be perfect. Any help in this is regard would be
> appreciated.
...
> ? ?poDataset=NULL;
> ? ?poDataset = poDriver->Create(filename , width , height , numOfbands
> ,(GDALDataType)datatype,NULL);
>
> ? ?for(int i=0 ; i < numOfbands ; i++)
> ? ? ?{
> ? ? ? ? ? ? ?poBand[i] = poDataset->GetRasterBand(i+1);
> ? ? ? }

Hi,

I didn't see any showstopper problems in your code.  But
the above code is not safe if the dataset creation fails.
If the dataset creation fails, a null pointer will be returned
and GetRasterBand() will fail - possibly crashing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From jorge.arevalo at gmail.com  Fri Aug 14 08:47:30 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Aug 14 08:54:25 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem,
	options to solve and doubts
Message-ID: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>

Hello,

I've asked several concepts related with RasterIO-related methods in
Dataset and RasterBand. Thanks to your responses, I've a better
understanding of the GDAL drivers' I/O method. But I've a couple of
doubts I need to solve to finish the GSoC, although I'd like to
continue developing the driver after it.

Problem: In basic GDAL WKT Raster driver, each row of a raster table
(one block, in regularly blocked rasters) means one server round. This
is slow, and "sub-optimal".

How to solve it?: IReadBlock executes an spatial query to get all the
rows of a table that fits in a natural block, defined by nXOff, nYOff
and the values fetched by GetBlockSize. In many raster formats, one
natural block is a scanline, of size (nXRasterSize, 1). In WKT Raster
format, if we have a regularly blocked raster,  "natural" block size
will be equal to RASTER_COLUMNS-defined block size, and the query will
return one block. To avoid one spatial query for each block petition,
we should "force" the driver to get all the blocks covering the area
requested in a IRasterIO call.

How to implement it? My approach is based on implementing
WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
method). This method executes a spatial query that returns all the
raster rows covering the area requested. Now, I have all the data of
an image region. If the requested region dimensions match the buffer
dimensions, I can copy all the pixels fetched in this way:

pImage = {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}

Where bi are the bytes of the band i. A WKT Raster image has a
non-interleaved format, all the band are consecutive. Is it correct? I
mean, copy the data in pImage with this format.

And if the region dimensions don't match the buffer dimensiones,
should I raise an error and finish or delegate in base
GDALDataset::IRasterIO implementation?

Another question: After copying the data from fetched rows in pImage
buffer, should I do anything more?

Other part of my implementation is overriding
GDALRasterBand::IRasterIO method. My method will simply call the
WKTRasterDataset::IRasterIO method with only one band to read. Is it
correct?

Thanks in advance.

Best regards,
Jorge
From amanda.m.henneke at boeing.com  Fri Aug 14 09:21:38 2009
From: amanda.m.henneke at boeing.com (Henneke, Amanda M)
Date: Fri Aug 14 09:21:40 2009
Subject: [gdal-dev] Expanding a palette image to 3 bands
Message-ID: <A4A1B61586638F4C90EBCAC780B0617409351F5B@XCH-MW-2V2.mw.nos.boeing.com>

Hello all-

I have a need to expand a 1 band palette tif file into a 3 band (rgb) tif file.  I have found that gdal_translate -expand rgb will do this from the command line, but I was wondering if there was some way to do this within C# using the GDAL bindings?  I notice there is a ColorTable object and PaletteInterpretation object, but I haven't figured out yet (or seen anything online) about how to use these to expand the image.

Can anyone help?

Thanks,
Amanda

Amanda M. Henneke


 
When One tugs at a single thing in Nature, he finds it attached to the rest of the world. -John Muir
  Please consider the environment before printing this e-mail.

From warmerdam at pobox.com  Fri Aug 14 09:46:10 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 14 09:46:13 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
Message-ID: <931f8ea90908140646j242e94e3i3212f812a0c1b1d2@mail.gmail.com>

2009/8/14 Jorge Ar?valo <jorge.arevalo@gmail.com>:
> Problem: In basic GDAL WKT Raster driver, each row of a raster table
> (one block, in regularly blocked rasters) means one server round. This
> is slow, and "sub-optimal".

Jorge,

I would note that one round trip per block is not necessarily so terrible
if the block size is reasonably large (128x128 or larger for instance).

> How to solve it?: IReadBlock executes an spatial query to get all the
> rows of a table that fits in a natural block, defined by nXOff, nYOff
> and the values fetched by GetBlockSize. In many raster formats, one
> natural block is a scanline, of size (nXRasterSize, 1). In WKT Raster
> format, if we have a regularly blocked raster, ?"natural" block size
> will be equal to RASTER_COLUMNS-defined block size, and the query will
> return one block. To avoid one spatial query for each block petition,
> we should "force" the driver to get all the blocks covering the area
> requested in a IRasterIO call.
>
> How to implement it? My approach is based on implementing
> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
> method). This method executes a spatial query that returns all the
> raster rows covering the area requested. Now, I have all the data of
> an image region. If the requested region dimensions match the buffer
> dimensions, I can copy all the pixels fetched in this way:
>
> pImage = {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
>
> Where bi are the bytes of the band i. A WKT Raster image has a
> non-interleaved format, all the band are consecutive. Is it correct? I
> mean, copy the data in pImage with this format.

Some of the arguments to IRasterIO() are the values indicating
how the imagery should be interleaved into the target buffer.
You might want to check them and only implemented the direct
copy if the interleaving matches what is convenient for you.

> And if the region dimensions don't match the buffer dimensiones,
> should I raise an error and finish or delegate in base
> GDALDataset::IRasterIO implementation?

Definately do not raise an error.  If for any reason it is not
convenient to process a request in an optimized fashion then
just call the underlying IRasterIO() method (on whatever your
base class is, possible GDALDataset).

> Another question: After copying the data from fetched rows in pImage
> buffer, should I do anything more?

You need to ensure it is in local machine byte order if it is not
GDT_Byte.

> Other part of my implementation is overriding
> GDALRasterBand::IRasterIO method. My method will simply call the
> WKTRasterDataset::IRasterIO method with only one band to read. Is it
> correct?

This is acceptable I think.  My only concern is that there may be
situations in which WKTRasterDataset::IRasterIO() will not
process the request in an optimized fashion and will fallback to
GDALDataset::IRasterIO() which in turn might call IRasterIO
on the band again.  This may become obvious in use. :-)

I would note that the optimized IRasterIO() implementation is
not really necessary for a successful project though it would
certainly be a crowning achievement for the summer.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From warmerdam at pobox.com  Fri Aug 14 09:52:56 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 14 09:52:58 2009
Subject: [gdal-dev] Expanding a palette image to 3 bands
In-Reply-To: <A4A1B61586638F4C90EBCAC780B0617409351F5B@XCH-MW-2V2.mw.nos.boeing.com>
References: <A4A1B61586638F4C90EBCAC780B0617409351F5B@XCH-MW-2V2.mw.nos.boeing.com>
Message-ID: <931f8ea90908140652r60cbbe6dxb069255a833da5e5@mail.gmail.com>

On Fri, Aug 14, 2009 at 9:21 AM, Henneke, Amanda
M<amanda.m.henneke@boeing.com> wrote:
> Hello all-
>
> I have a need to expand a 1 band palette tif file into a 3 band (rgb) tif file. ?I have found that gdal_translate -expand rgb will do this from the command line, but I was wondering if there was some way to do this within C# using the GDAL bindings? ?I notice there is a ColorTable object and PaletteInterpretation object, but I haven't figured out yet (or seen anything online) about how to use these to expand the image.

Amanda,

You could skim the gdal_translate code to see how -expand rgb
works, but unfortunately it depends on access to VRT classes
that are not directly callable from C# or other swig bindings.  However,
you can compose the corresponding VRT XML directly in C# and
then "open" that VRT XML as a dataset that will have the expanded
bands.  This VRT dataset can then be passed to a CreateCopy() to
write out the expanded result.

I have attached the results of "gdal_translate -of VRT -expand rgb" on
a dataset as an example of the corresponding XML.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
-------------- next part --------------
A non-text attachment was scrubbed...
Name: out.vrt
Type: application/octet-stream
Size: 1672 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090814/a96e8a9a/out.obj
From Shawn.Gong at drdc-rddc.gc.ca  Fri Aug 14 10:08:53 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Fri Aug 14 10:08:59 2009
Subject: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits per
	sample will not be interpreted properly
In-Reply-To: <931f8ea90908120712t17707d9sb408e1cc80348dd1@mail.gmail.com>
References: <DF1471B5C308B346BF5A2AEA00C5615E26EA4A@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<931f8ea90908120712t17707d9sb408e1cc80348dd1@mail.gmail.com>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA54@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Hi Frank and list,

I rebuilt Gdal on a 64-bit Linux server, adding libecwj2, and it
ingested GeoEye-1 NITF just fine (a bit slow though).
So you are right that this warning should not really apply. 

My question is then why it failed on Windows XP, at libecwj2's
ncsjpcbuffer.cpp CNCSJPCBuffer(). The Jpeg2000 file is 463MB, after
decompression it is 2.375 GB. Do I need to specify "large file" when
building Gdal on Windows?


thanks,
Shawn



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Frank Warmerdam
Sent: Wednesday, August 12, 2009 10:12 AM
To: Gong, Shawn (Contractor)
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] GeoEye-1 NITF - Warning 1: Image with 11 bits
per sample will not be interpreted properly

On Tue, Aug 11, 2009 at 12:17 PM, Gong, Shawn
(Contractor)<Shawn.Gong@drdc-rddc.gc.ca> wrote:
> hi list,
>
> I found help clues to build libecwj2 on Windows.

Shawn,

Congrats on working though this issue!  Perhaps you would like to add
some notes to:

  http://trac.osgeo.org/gdal/wiki/ECW

> However when I tried to open GeoEye-1 NITF, I got "Warning 1: Image
with 11
> bits per sample will not be interpreted properly".

I thought there were changes in trunk to avoid this warning when the
image is jpeg2000 and being handled by a suitable codec.  However,
I think I only tested this specific issue when using JP2KAK for the
jpeg2000 support.  I'm not sure if there are problems with the ecw sdk
and such files or not.  However, the note about being badly corrupted
should not really apply.

> There are two sub-datasets in NITF (please see the gdalinfo at the
end). If
> I open the 2nd sub-dataset, the data show only 73 pixels and 220
lines;
> digital numbers are either 0 or 255.

Hmm, I don't know why it would be particularly small in size.
I'm also surprised that the latest windows fwtools has problems.
Perhaps you could file a ticket on the issue and I could look into
it a bit next week (especially since problems can be reproduced
with FWTools which I think uses JP2KAK for this purpose).

Hmm, on second thought, I believe I removed JP2KAK from
FWTools for licensing reasons - so perhaps it is using the
ecw jpeg2000 driver too.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From mateusz at loskot.net  Fri Aug 14 10:28:48 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 14 10:28:54 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem,	options to solve and
	doubts
In-Reply-To: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
Message-ID: <4A8574A0.600@loskot.net>

Jorge Ar?valo wrote:
> Hello,
> 
> I've asked several concepts related with RasterIO-related methods in
> Dataset and RasterBand. Thanks to your responses, I've a better
> understanding of the GDAL drivers' I/O method. But I've a couple of
> doubts I need to solve to finish the GSoC, although I'd like to
> continue developing the driver after it.
> 
> Problem: In basic GDAL WKT Raster driver, each row of a raster table
> (one block, in regularly blocked rasters) means one server round. This
> is slow, and "sub-optimal".

Jorge,

What you mean as one server round? Is it 1 SQL query per tile?

> How to solve it?: IReadBlock executes an spatial query to get all the
> rows of a table that fits in a natural block, defined by nXOff, nYOff
> and the values fetched by GetBlockSize. In many raster formats, one
> natural block is a scanline, of size (nXRasterSize, 1).

Yes, I found the natural block (=scalnline for many datasets)
as inconvenient for querying regular blocking tables.
Instead, I'd recommend to use tile (block) size as size of
natural block, so you always query and process
whole tile or number of tiles.

> In WKT Raster 
> format, if we have a regularly blocked raster,  "natural" block size
> will be equal to RASTER_COLUMNS-defined block size, and the query will
> return one block.

A! Perfect. This is what I've mentioned above.
By the way, my thinking of WKT Raster in general may be a bit biased
because I'm personally focused on regular blocking only.

> To avoid one spatial query for each block petition,
> we should "force" the driver to get all the blocks covering the area
> requested in a IRasterIO call.

Yes, this is the crux.

> How to implement it? My approach is based on implementing
> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
> method). This method executes a spatial query that returns all the
> raster rows covering the area requested. Now, I have all the data of
> an image region. If the requested region dimensions match the buffer
> dimensions, I can copy all the pixels fetched in this way:
> 
> pImage = {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
> 
> Where bi are the bytes of the band i. A WKT Raster image has a
> non-interleaved format, all the band are consecutive. Is it correct? I
> mean, copy the data in pImage with this format.
> 
> And if the region dimensions don't match the buffer dimensiones,
> should I raise an error and finish or delegate in base
> GDALDataset::IRasterIO implementation?

What it means "region dimensions don't match the buffer"?

I'd imagine something like this:

1. Query tiles that match the requested region (window) of raster
coverage (table).
2. Fetch
3. Merge tiles into in-memory or on-disk file.

The merge step could be based on RasterIO calls following this approach

http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/python/scripts/gdal_merge.py

Also, the step 3 should be constrained by max limit of data pushed into
memory, and fail if let's say a user queries 12000 tiles :-)
and there is no overview level available that could be returned
instead of such a huge amount of data.
Perhaps it could be configurable.

> Other part of my implementation is overriding
> GDALRasterBand::IRasterIO method. My method will simply call the
> WKTRasterDataset::IRasterIO method with only one band to read. Is it
> correct?

Looks OK.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jorge.arevalo at gmail.com  Fri Aug 14 11:06:01 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Aug 14 11:12:51 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <931f8ea90908140646j242e94e3i3212f812a0c1b1d2@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com> 
	<931f8ea90908140646j242e94e3i3212f812a0c1b1d2@mail.gmail.com>
Message-ID: <cb4457700908140806p770f9680vd1d5cdcf1c37cb7c@mail.gmail.com>

Hello,

2009/8/14 Frank Warmerdam <warmerdam@pobox.com>:
> 2009/8/14 Jorge Ar?valo <jorge.arevalo@gmail.com>:
>> Problem: In basic GDAL WKT Raster driver, each row of a raster table
>> (one block, in regularly blocked rasters) means one server round. This
>> is slow, and "sub-optimal".
>
> Jorge,
>
> I would note that one round trip per block is not necessarily so terrible
> if the block size is reasonably large (128x128 or larger for instance).
>

Yes, but don't you think it could be a good idea trying to avoid extra
server rounds, in general?


>> How to solve it?: IReadBlock executes an spatial query to get all the
>> rows of a table that fits in a natural block, defined by nXOff, nYOff
>> and the values fetched by GetBlockSize. In many raster formats, one
>> natural block is a scanline, of size (nXRasterSize, 1). In WKT Raster
>> format, if we have a regularly blocked raster, ?"natural" block size
>> will be equal to RASTER_COLUMNS-defined block size, and the query will
>> return one block. To avoid one spatial query for each block petition,
>> we should "force" the driver to get all the blocks covering the area
>> requested in a IRasterIO call.
>>
>> How to implement it? My approach is based on implementing
>> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
>> method). This method executes a spatial query that returns all the
>> raster rows covering the area requested. Now, I have all the data of
>> an image region. If the requested region dimensions match the buffer
>> dimensions, I can copy all the pixels fetched in this way:
>>
>> pImage = {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
>>
>> Where bi are the bytes of the band i. A WKT Raster image has a
>> non-interleaved format, all the band are consecutive. Is it correct? I
>> mean, copy the data in pImage with this format.
>
> Some of the arguments to IRasterIO() are the values indicating
> how the imagery should be interleaved into the target buffer.
> You might want to check them and only implemented the direct
> copy if the interleaving matches what is convenient for you.

Ok, nPixelSpace and nLineSpace, right. Stupid me. -1


>
>> And if the region dimensions don't match the buffer dimensiones,
>> should I raise an error and finish or delegate in base
>> GDALDataset::IRasterIO implementation?
>
> Definately do not raise an error. ?If for any reason it is not
> convenient to process a request in an optimized fashion then
> just call the underlying IRasterIO() method (on whatever your
> base class is, possible GDALDataset).

Ok, my code works in that way just now. Thanks


>
>> Another question: After copying the data from fetched rows in pImage
>> buffer, should I do anything more?
>
> You need to ensure it is in local machine byte order if it is not
> GDT_Byte.
>

Yes, I check this. I forgot to mention.

>> Other part of my implementation is overriding
>> GDALRasterBand::IRasterIO method. My method will simply call the
>> WKTRasterDataset::IRasterIO method with only one band to read. Is it
>> correct?
>
> This is acceptable I think. ?My only concern is that there may be
> situations in which WKTRasterDataset::IRasterIO() will not
> process the request in an optimized fashion and will fallback to
> GDALDataset::IRasterIO() which in turn might call IRasterIO
> on the band again. ?This may become obvious in use. :-)
>

Mmmm... I was studying the WCSDataset.cpp code and I thought that this
might happen:

- WCSDataset::IRasterIO calls GDALRasterBand::RasterIO
- GDALRasterBand::RasterIO calls WCSRasterBand::IRasterIO
- WCSRasterBand::IRasterIO calls WCSDataset::IRasterIO
....

But I'm sure I'm making a mistake, a misunderstanding, because WCS
driver is a solid, well tested driver. Anyway, my idea is only to call
IReadBlock as the "last resource". For this reason, I'd like to take
advantage of the GDAL Data Model with this simple algorithm:

WKTRasterDataset::IRasterIO(...)
{
   // Fetch all raster rows covered by the area requested

   If I have rows:
        // Get the data of these rows and copy it into the pImage
buffer (byte swapping if needed)
        // Anything more? return CE_None? add blocks to rasterband
cache? delegate in GDALDataset::RasterIO?
  else:
      // Delegate in GDALDataset::RasterIO? This will derive in
WKTRasterRasterBand::IReadBlock or not??
}


WKTRasterRasterBand::IRasterIO(...)
{
  poDS->IRasterIO(current band);
}


WKTRasterRasterBand::IReadBlock(...)
{
 // Fetch all raster rows that the block covers (in regularly blocked
rasters, 1 row (= 1 tile))

If only 1 block:
    // copy data in pImage buffer
    // return
else:
   // non-regularly blocked rasters. Raise an "under development"
error, just now.
}

But I don't know if this approach works as I want. IReadBlock works
fine, but I have problems with the rest of the system (IRasterIO
implementations), and I don't know what is the best approach on this
driver :-(

What's the normal way in which a program calls GDAL IO system. Is
usual to call RasterIO directly? maybe call IReadBlock directly? What
should a driver expect? Should a driver expect something as "usual"?

I suspect that depends of the driver format...

> I would note that the optimized IRasterIO() implementation is
> not really necessary for a successful project though it would
> certainly be a crowning achievement for the summer.
>

Ok. I've quite a lot of code related with this concept (cache,
IRasterIO...), but doesn't seem to works fine, for any reason. Maybe
needs more discussion and/or thinking. I could put it off...

Best regards,
Jorge

> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
From jorge.arevalo at gmail.com  Fri Aug 14 11:30:10 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Fri Aug 14 11:30:32 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <4A8574A0.600@loskot.net>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com> 
	<4A8574A0.600@loskot.net>
Message-ID: <cb4457700908140830i2c5bfcb9u3421bfd3425286d0@mail.gmail.com>

Hello,

2009/8/14 Mateusz Loskot <mateusz@loskot.net>:
> Jorge Ar?valo wrote:
>> Hello,
>>
>> I've asked several concepts related with RasterIO-related methods in
>> Dataset and RasterBand. Thanks to your responses, I've a better
>> understanding of the GDAL drivers' I/O method. But I've a couple of
>> doubts I need to solve to finish the GSoC, although I'd like to
>> continue developing the driver after it.
>>
>> Problem: In basic GDAL WKT Raster driver, each row of a raster table
>> (one block, in regularly blocked rasters) means one server round. This
>> is slow, and "sub-optimal".
>
> Jorge,
>
> What you mean as one server round? Is it 1 SQL query per tile?

Yes, 1 sql select per IReadBlock call (1 tile in regularly blocked rasters).


>
>> How to solve it?: IReadBlock executes an spatial query to get all the
>> rows of a table that fits in a natural block, defined by nXOff, nYOff
>> and the values fetched by GetBlockSize. In many raster formats, one
>> natural block is a scanline, of size (nXRasterSize, 1).
>
> Yes, I found the natural block (=scalnline for many datasets)
> as inconvenient for querying regular blocking tables.
> Instead, I'd recommend to use tile (block) size as size of
> natural block, so you always query and process
> whole tile or number of tiles.
>

Yes, I use block size read from RASTER_COLUMNS to create the
RasterBands, as block size.


>> In WKT Raster
>> format, if we have a regularly blocked raster, ?"natural" block size
>> will be equal to RASTER_COLUMNS-defined block size, and the query will
>> return one block.
>
> A! Perfect. This is what I've mentioned above.
> By the way, my thinking of WKT Raster in general may be a bit biased
> because I'm personally focused on regular blocking only.

Just like me... I've detected the points of the code where the
situation "non-regular blocking rasters" takes place, and, normally, I
raise an "Under development" error. This will be the bigger todo task
in this driver, I think.


>
>> To avoid one spatial query for each block petition,
>> we should "force" the driver to get all the blocks covering the area
>> requested in a IRasterIO call.
>
> Yes, this is the crux.
>
>> How to implement it? My approach is based on implementing
>> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
>> method). This method executes a spatial query that returns all the
>> raster rows covering the area requested. Now, I have all the data of
>> an image region. If the requested region dimensions match the buffer
>> dimensions, I can copy all the pixels fetched in this way:
>>
>> pImage = {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
>>
>> Where bi are the bytes of the band i. A WKT Raster image has a
>> non-interleaved format, all the band are consecutive. Is it correct? I
>> mean, copy the data in pImage with this format.
>>
>> And if the region dimensions don't match the buffer dimensiones,
>> should I raise an error and finish or delegate in base
>> GDALDataset::IRasterIO implementation?
>
> What it means "region dimensions don't match the buffer"?
>
> I'd imagine something like this:
>
> 1. Query tiles that match the requested region (window) of raster
> coverage (table).
> 2. Fetch
> 3. Merge tiles into in-memory or on-disk file.


Yes, that's the point. With "region dimensions don't match the buffer"
I mean that nXSize, nYSize are different from nBufXSize, nBufYSize.
And maybe eBufType is different from band data type (for each band.
I'm talking about WKTRasterDataset::RasterIO method).

And what should be the criterion to choose between in-memory or
on-disk storage? If the memory buffer is bigger enough to store the
fetched data... it should be enough.

>
> The merge step could be based on RasterIO calls following this approach
>
> http://trac.osgeo.org/gdal/browser/trunk/gdal/swig/python/scripts/gdal_merge.py
>
> Also, the step 3 should be constrained by max limit of data pushed into
> memory, and fail if let's say a user queries 12000 tiles :-)
> and there is no overview level available that could be returned
> instead of such a huge amount of data.
> Perhaps it could be configurable.

Thanks! I've used gdal_merge, but I didn't study the code. I'm going
to study it just now :-)

>
>> Other part of my implementation is overriding
>> GDALRasterBand::IRasterIO method. My method will simply call the
>> WKTRasterDataset::IRasterIO method with only one band to read. Is it
>> correct?
>
> Looks OK.

Thanks for confirmation.


Best regards,
Jorge


>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
From warmerdam at pobox.com  Fri Aug 14 11:35:09 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 14 11:35:12 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <cb4457700908140806p770f9680vd1d5cdcf1c37cb7c@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
	<931f8ea90908140646j242e94e3i3212f812a0c1b1d2@mail.gmail.com>
	<cb4457700908140806p770f9680vd1d5cdcf1c37cb7c@mail.gmail.com>
Message-ID: <931f8ea90908140835h6cd59560g197331f18770126b@mail.gmail.com>

2009/8/14 Jorge Ar?valo <jorge.arevalo@gmail.com>:
>> Jorge,
>>
>> I would note that one round trip per block is not necessarily so terrible
>> if the block size is reasonably large (128x128 or larger for instance).
>>
>
> Yes, but don't you think it could be a good idea trying to avoid extra
> server rounds, in general?

Jorge,

It would be nice, but only as long as the complexity and risk is
appropriate to the benefit.

> Mmmm... I was studying the WCSDataset.cpp code and I thought that this
> might happen:
>
> - WCSDataset::IRasterIO calls GDALRasterBand::RasterIO
> - GDALRasterBand::RasterIO calls WCSRasterBand::IRasterIO
> - WCSRasterBand::IRasterIO calls WCSDataset::IRasterIO
> ....
>
> But I'm sure I'm making a mistake, a misunderstanding, because WCS
> driver is a solid, well tested driver.

I believe the WCS code is careful about this, only calling into
WCSDataset::DirectRasterIO() for cases that can be handled
directly (checked via a Test method).  This care is exactly to
avoid a looping recursion.

> Anyway, my idea is only to call
> IReadBlock as the "last resource". For this reason, I'd like to take
> advantage of the GDAL Data Model with this simple algorithm:
>
> WKTRasterDataset::IRasterIO(...)
> {
> ? // Fetch all raster rows covered by the area requested
>
> ? If I have rows:
> ? ? ? ?// Get the data of these rows and copy it into the pImage
> buffer (byte swapping if needed)
> ? ? ? ?// Anything more? return CE_None? add blocks to rasterband
> cache? delegate in GDALDataset::RasterIO?
> ?else:
> ? ? ?// Delegate in GDALDataset::RasterIO? This will derive in
> WKTRasterRasterBand::IReadBlock or not??
> }
>
>
> WKTRasterRasterBand::IRasterIO(...)
> {
> ?poDS->IRasterIO(current band);
> }
>
>

> What's the normal way in which a program calls GDAL IO system. Is
> usual to call RasterIO directly? maybe call IReadBlock directly? What
> should a driver expect? Should a driver expect something as "usual"?

Normally applications call RasterIO() regardless of the underlying
format.  Direct block reads are very rarely done.

> I suspect that depends of the driver format...
>
>> I would note that the optimized IRasterIO() implementation is
>> not really necessary for a successful project though it would
>> certainly be a crowning achievement for the summer.
>>
>
> Ok. I've quite a lot of code related with this concept (cache,
> IRasterIO...), but doesn't seem to works fine, for any reason. Maybe
> needs more discussion and/or thinking. I could put it off...

Well, please ensure that the more sophisticated machinery can
be easily disabled, getting back to a safely working block at
a time approach if needed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From felix.schalck at gmail.com  Fri Aug 14 11:17:03 2009
From: felix.schalck at gmail.com (Felix Schalck)
Date: Fri Aug 14 11:39:39 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
Message-ID: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>

Hello,

I'm trying to create a high resolution topographic map of europe in
grass, using cgiar-cis srtm datas. The data is shipped in 5*5? tiles
which I need to somhow paste together. On the grass mailing list, I
was told to use gdalwarp in order to achieve this. Unfortunately, my
current gdalwarp command (1.5) tells me the final TIF file will be
over 4GB large, so that I need to get BigTIFF support.

To do so, I downloaded the 1.6 source from the main gdal site, and
launched ./configure with the following options:

sudo CFLAGS="-O2 -march=k8 -pipe" ./configure --with-tiff=internal
--with-hide-internal-symbols --with-jpeg=/usr --enable-largefile
--with-libz=internal

The command works fine, but the final message gives:

  LIBTIFF support:           external (BigTIFF=no)
  LIBGEOTIFF support:        internal

Somehow there must be a config option I'm missing; and I would be very
thankful if somebody in here could explain me what I'm doing wrong.

regards,

Felix Schalck
From warmerdam at pobox.com  Fri Aug 14 11:44:03 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 14 11:44:06 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
In-Reply-To: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
References: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
Message-ID: <931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>

Felix,

Please use --with-libtiff=internal instead of --with-tiff=internal.

On Fri, Aug 14, 2009 at 11:17 AM, Felix Schalck<felix.schalck@gmail.com> wrote:
> Hello,
>
> I'm trying to create a high resolution topographic map of europe in
> grass, using cgiar-cis srtm datas. The data is shipped in 5*5? tiles
> which I need to somhow paste together. On the grass mailing list, I
> was told to use gdalwarp in order to achieve this. Unfortunately, my
> current gdalwarp command (1.5) tells me the final TIF file will be
> over 4GB large, so that I need to get BigTIFF support.
>
> To do so, I downloaded the 1.6 source from the main gdal site, and
> launched ./configure with the following options:
>
> sudo CFLAGS="-O2 -march=k8 -pipe" ./configure --with-tiff=internal
> --with-hide-internal-symbols --with-jpeg=/usr --enable-largefile
> --with-libz=internal
>
> The command works fine, but the final message gives:
>
> ?LIBTIFF support: ? ? ? ? ? external (BigTIFF=no)
> ?LIBGEOTIFF support: ? ? ? ?internal
>
> Somehow there must be a config option I'm missing; and I would be very
> thankful if somebody in here could explain me what I'm doing wrong.
>
> regards,
>
> Felix Schalck
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From felix.schalck at gmail.com  Fri Aug 14 12:13:11 2009
From: felix.schalck at gmail.com (Felix Schalck)
Date: Fri Aug 14 12:13:13 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
In-Reply-To: <931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>
References: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
	<931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>
Message-ID: <ca2dd22a0908140913t7c2401c1ue83faa16056def5e@mail.gmail.com>

Many thanks for your reply: the configuration now shows

  LIBTIFF support:           internal (BigTIFF=yes)

I ran make & make install, but I'm still getting the following error
message, whie trying to merge my .tifs:

$gdalwarp -co bigtiff=yes *.tif europe_all.tif
Warning 6: Driver GTiff does not support bigtiff creation option
Creating output file that is 78000P x 36000L.
ERROR 6: A 78000 pixels x 36000 lines x 1 bands Int16 image would be
larger than 4GB
but this is the largest size a TIFF can be.  Creation failed.

Is there somthing else to reconfigure/recompile to get it work ? Is
there some wrong linking between the libs ?

Thanks for your time,

Felix Schalck

2009/8/14 Frank Warmerdam <warmerdam@pobox.com>:
> Felix,
>
> Please use --with-libtiff=internal instead of --with-tiff=internal.
>
> On Fri, Aug 14, 2009 at 11:17 AM, Felix Schalck<felix.schalck@gmail.com> wrote:
>> Hello,
>>
>> I'm trying to create a high resolution topographic map of europe in
>> grass, using cgiar-cis srtm datas. The data is shipped in 5*5? tiles
>> which I need to somhow paste together. On the grass mailing list, I
>> was told to use gdalwarp in order to achieve this. Unfortunately, my
>> current gdalwarp command (1.5) tells me the final TIF file will be
>> over 4GB large, so that I need to get BigTIFF support.
>>
>> To do so, I downloaded the 1.6 source from the main gdal site, and
>> launched ./configure with the following options:
>>
>> sudo CFLAGS="-O2 -march=k8 -pipe" ./configure --with-tiff=internal
>> --with-hide-internal-symbols --with-jpeg=/usr --enable-largefile
>> --with-libz=internal
>>
>> The command works fine, but the final message gives:
>>
>> ?LIBTIFF support: ? ? ? ? ? external (BigTIFF=no)
>> ?LIBGEOTIFF support: ? ? ? ?internal
>>
>> Somehow there must be a config option I'm missing; and I would be very
>> thankful if somebody in here could explain me what I'm doing wrong.
>>
>> regards,
>>
>> Felix Schalck
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
From ealpert at digitalglobe.com  Fri Aug 14 14:24:17 2009
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Fri Aug 14 14:24:22 2009
Subject: [gdal-dev] Definite problem with XERCES 3.0.x and GDAL
Message-ID: <8B319E5A30FF4A48BE7EEAAF609DB23304790A59@COMAIL01.digitalglobe.com>

 

I'm running 1.6.1 stable that I downloaded on 7/14 and xerces 3.0.1 on a
RHEL5.2 64 bit system.

 

When I convert a shapefile to GML and then try to convert back to
shapefile I was getting:

 

ERROR 1: <coordinates> element missing value

 

And an invalid shapefile with no polygons. I'd get this error at various
other points too.

 

 

I spent some time in gdb and found that a XERCES method parseNext inside
of the GMLReader::NextFeature() was returning an empty coordinates block
even though my GML had coordinates.

 

I backed out of xerces 3.0 to xerces 2.8 and recompiled GDAL and reran
my test and now everything is working.

 

I'm not sure what the next steps are here but xerces 3.0 and 3.0.1 did
not work with OGR.

 

-e

 


This electronic communication and any attachments may contain confidential and proprietary 
information of DigitalGlobe, Inc. If you are not the intended recipient, or an agent or employee 
responsible for delivering this communication to the intended recipient, or if you have received 
this communication in error, please do not print, copy, retransmit, disseminate or 
otherwise use the information. Please indicate to the sender that you have received this 
communication in error, and delete the copy you received. DigitalGlobe reserves the 
right to monitor any electronic communication sent or received by its employees, agents 
or representatives.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090814/a9e0a4c4/attachment.html
From felix.schalck at gmail.com  Fri Aug 14 14:35:17 2009
From: felix.schalck at gmail.com (Felix Schalck)
Date: Fri Aug 14 14:35:20 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
In-Reply-To: <931f8ea90908141045s278f1a5au38fd512f88c65428@mail.gmail.com>
References: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
	<931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>
	<ca2dd22a0908140913t7c2401c1ue83faa16056def5e@mail.gmail.com>
	<931f8ea90908140953w138e6f32od26eeb437a5f1f20@mail.gmail.com>
	<ca2dd22a0908141009n24d11f79yaa446cee7467aeb8@mail.gmail.com>
	<931f8ea90908141045s278f1a5au38fd512f88c65428@mail.gmail.com>
Message-ID: <ca2dd22a0908141135w7d04bbfbo2fb62aa62c7c255f@mail.gmail.com>

Dear Frank,

After some extensive research, I discovered this:

qwerkus@qwerkus-desktop:~$ ls -la /usr/local/bin/gdalwarp
-rwxr-xr-x 1 root root 95391 2009-08-14 20:20 /usr/local/bin/gdalwarp
qwerkus@qwerkus-desktop:~$ ls -la /usr/bin/gdalwarp
-rwxr-xr-x 1 root root 31608 2009-03-10 00:32 /usr/bin/gdalwarp

Looks like your were right: it is an installation problem: looks like
the installation script doesn't put gdal in the sam directory as the
ubuntu package manager.
Now, here comes another problem:

By invoquing /usr/local/bin/gdalwarp, I have this error message:

gdalwarp: error while loading shared libraries: libgdal.so.1: cannot
open shared object file: No such file or directory

Although, by launching gdalwarp from the compilation directory (in
scr/apps), It works fine INCLUDING BIGTIFF option.
How can I fix the linking problem ?

Thanks for your patience,

Felix Schalck


2009/8/14 Frank Warmerdam <warmerdam@pobox.com>:
> On Fri, Aug 14, 2009 at 1:09 PM, Felix Schalck<felix.schalck@gmail.com> wrote:
>> Well, I did the whole procedure again, after cleaning, and checked the
>> installed version with:
>>
>> $gdal-config
>>
>> Result:
>>
>> 1.6.2
>>
>> Looks like the correct version is installed, so that I'm quite lost.
>
> Felix,
>
> This is not really that conclusive as a way of ensuring you
> are using your new build but I don't know what else to suggest.
>
>> Notice that I found a similar problem on the mailing list archive here:
>>
>> http://n2.nabble.com/Trying-to-get-BIGTIFF-to-work-td2035106.html
>>
>> But the mail reamains unclear about the way to solve it. Looks like he
>> had to build everything against external libs; what options does this
>> mean for my ./configure command ?
>
> I don't see much in this discussion that implies external libraries
> are required for bigtiff support in 1.6.x.
>
> You could try a development snapshot from:
>
> ?http://download.osgeo.org/gdal/daily
>
> These are quite stable.
>
> Best regards,
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up ? | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush ? ?| Geospatial Programmer for Rent
>
From nikos.alexandris at felis.uni-freiburg.de  Fri Aug 14 15:47:00 2009
From: nikos.alexandris at felis.uni-freiburg.de (Nikos Alexandris)
Date: Fri Aug 14 15:47:04 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
In-Reply-To: <ca2dd22a0908141135w7d04bbfbo2fb62aa62c7c255f@mail.gmail.com>
References: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
	<931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>
	<ca2dd22a0908140913t7c2401c1ue83faa16056def5e@mail.gmail.com>
	<931f8ea90908140953w138e6f32od26eeb437a5f1f20@mail.gmail.com>
	<ca2dd22a0908141009n24d11f79yaa446cee7467aeb8@mail.gmail.com>
	<931f8ea90908141045s278f1a5au38fd512f88c65428@mail.gmail.com>
	<ca2dd22a0908141135w7d04bbfbo2fb62aa62c7c255f@mail.gmail.com>
Message-ID: <1250279220.4740.9.camel@vertical>

Felix Schalck:
> Dear Frank,
> After some extensive research, I discovered this:
> 
> qwerkus@qwerkus-desktop:~$ ls -la /usr/local/bin/gdalwarp
> -rwxr-xr-x 1 root root 95391 2009-08-14 20:20 /usr/local/bin/gdalwarp
> qwerkus@qwerkus-desktop:~$ ls -la /usr/bin/gdalwarp
> -rwxr-xr-x 1 root root 31608 2009-03-10 00:32 /usr/bin/gdalwarp
> 
> Looks like your were right: it is an installation problem: looks like
> the installation script doesn't put gdal in the sam directory as the
> ubuntu package manager.
> Now, here comes another problem:
> 
> By invoquing /usr/local/bin/gdalwarp, I have this error message:
> 
> gdalwarp: error while loading shared libraries: libgdal.so.1: cannot
> open shared object file: No such file or directory
> 
> Although, by launching gdalwarp from the compilation directory (in
> scr/apps), It works fine INCLUDING BIGTIFF option.
> How can I fix the linking problem ?

Felix,
I use (ubuntu 9.04 / 64-bit), among others, the following
in /etc/ld.so.conf:

---%<---%<--
# share
/usr/local/share/gdal

# gdal
/usr/local/lib/gdalplugins
#/geo/osgeo/FWTools-2.0.6/bin_safe
# I use the last line to read HDF files (like MODIS MOD09 products)
---%<---%<--

No warranty though. I am still messing up my system from time to time
and kill my time trying to fix it (or loading the lists with
questions :-p).

Maybe there should be a separate section in the wiki to explain
step-by-step linking issues, shared libraries, etc.

FYI, below I am copy-pasting notes with respect to "./configuration" for
GDAL compilation [*].

Kindest regards, Nikos
---

[*] GDAL related compilation notes

*Must* compile without GRASS support

# enter in directory gdal_stable
cd /usr/local/src/gdal_stable

# download with svn ## or update with svn up

# clean previous configurations/compilations
make distclean

# configure
CFLAGS="-g -Wall" LDFLAGS="-s" ./configure \
--with-png=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-ecw=yes \
--with-expat=yes \
--with-expat-inc=/usr/include/ \
--with-expat-lib=/usr/lib \
--with-sqlite3=yes \
--with-geos=yes \
--with-python \
--with-libz=internal \
--with-netcdf \
--with-sqlite \
--with-threads=yes \
--without-grass  \
--without-ogdi \
--with-pg=/usr/bin/pg_config \
--with-xerces=yes

#compile & install & ldconfig
make  &&  sudo make install  &&  sudo ldconfig


Where is GDAL installed?

# in /usr/local/bin
/usr/local/bin/gdal-config \
/usr/local/bin/gdal2tiles.py \
/usr/local/bin/gdal2xyz.py \
/usr/local/bin/gdal_contour \
/usr/local/bin/gdal_grid \
/usr/local/bin/gdal_merge.py \
/usr/local/bin/gdal_rasterize \
/usr/local/bin/gdal_retile.py \
/usr/local/bin/gdal_translate \
/usr/local/bin/gdaladdo \
/usr/local/bin/gdalchksum.py \
/usr/local/bin/gdalenhance \
/usr/local/bin/gdalident.py \ 
/usr/local/bin/gdalimport.py \
/usr/local/bin/gdalinfo \
/usr/local/bin/gdalmanage \
/usr/local/bin/gdaltindex \
/usr/local/bin/gdaltransform \
/usr/local/bin/gdalwarp \

# in /usr/local/share \
/usr/local/share/gdal \

# in /usr/local/lib \
/usr/local/lib/libgdal.a \
/usr/local/lib/libgdal.la \
/usr/local/lib/libgdal.so \
/usr/local/lib/libgdal.so.1 \
/usr/local/lib/libgdal.so.1.12.3 \

# in  /usr/local/include/
/usr/local/include/gdal.h \
/usr/local/include/gdal_alg.h \
/usr/local/include/gdal_frmts.h \
/usr/local/include/gdal_pam.h \
/usr/local/include/gdal_priv.h \
/usr/local/include/gdal_rat.h \
/usr/local/include/gdal_version.h \
/usr/local/include/gdal_vrt.h \
/usr/local/include/gdalgrid.h \
/usr/local/include/gdaljp2metadata.h \
/usr/local/include/gdalwarper.h \

From felix.schalck at gmail.com  Fri Aug 14 15:52:00 2009
From: felix.schalck at gmail.com (Felix Schalck)
Date: Fri Aug 14 15:52:02 2009
Subject: [gdal-dev] Strange things with gdalwarp ...
Message-ID: <ca2dd22a0908141252k43d3f4bbxf8cad1e1e3f9df92@mail.gmail.com>

Hello,

As explained in my previous question, I'm trying to create a high
resolution topographic map of europe based on cgiar processed srtm
data. Of cours, the first step is to merge the 5*5? tif tiles into one
big tif, which can be achieved using gdalwarp's mosaic feature.

Simply pasting all the tiles togther trough following code:

gdalwarp --config GDAL_CACHEMAX 512 -wm 512  HDA1/srtm_*.ti HDA2/final.tif

takes about 20 hours. HDA1/2 are two different harddrives.

Now, a second script, pasting first "slices" of 5*30? together, and
than merging all the slices:

for i in 39 40 41 42 43; do
gdalwarp --config GDAL_CACHEMAX 512 -wm 512 HDA1/srtm_$i*.tif
HDA2/slice_0$((i-34)).tif
done
gdalwarp --config GDAL_CACHEMAX 512 -wm 512 HDA2/slice_*.tif HDA1/final.tif

takes less than on hour ! Filesize is similar.

So what is the trick here ? Is there some quality loss when using gdalwarp ?

Felix Schalck
From felix.schalck at gmail.com  Fri Aug 14 15:54:33 2009
From: felix.schalck at gmail.com (Felix Schalck)
Date: Fri Aug 14 15:54:36 2009
Subject: [gdal-dev] Getting BigTiff support in Ubuntu 9.04 64bits
In-Reply-To: <1250279220.4740.9.camel@vertical>
References: <ca2dd22a0908140817ucb8162fw1782fbec339bcfc5@mail.gmail.com>
	<931f8ea90908140844k54ccd119j69853eb48aac5f8d@mail.gmail.com>
	<ca2dd22a0908140913t7c2401c1ue83faa16056def5e@mail.gmail.com>
	<931f8ea90908140953w138e6f32od26eeb437a5f1f20@mail.gmail.com>
	<ca2dd22a0908141009n24d11f79yaa446cee7467aeb8@mail.gmail.com>
	<931f8ea90908141045s278f1a5au38fd512f88c65428@mail.gmail.com>
	<ca2dd22a0908141135w7d04bbfbo2fb62aa62c7c255f@mail.gmail.com>
	<1250279220.4740.9.camel@vertical>
Message-ID: <ca2dd22a0908141254n41867f5bj5929ce446e869ec3@mail.gmail.com>

2009/8/14 Nikos Alexandris <nikos.alexandris@felis.uni-freiburg.de>:
> Felix Schalck:
>> Dear Frank,
>> After some extensive research, I discovered this:
>>
>> qwerkus@qwerkus-desktop:~$ ls -la /usr/local/bin/gdalwarp
>> -rwxr-xr-x 1 root root 95391 2009-08-14 20:20 /usr/local/bin/gdalwarp
>> qwerkus@qwerkus-desktop:~$ ls -la /usr/bin/gdalwarp
>> -rwxr-xr-x 1 root root 31608 2009-03-10 00:32 /usr/bin/gdalwarp
>>
>> Looks like your were right: it is an installation problem: looks like
>> the installation script doesn't put gdal in the sam directory as the
>> ubuntu package manager.
>> Now, here comes another problem:
>>
>> By invoquing /usr/local/bin/gdalwarp, I have this error message:
>>
>> gdalwarp: error while loading shared libraries: libgdal.so.1: cannot
>> open shared object file: No such file or directory
>>
>> Although, by launching gdalwarp from the compilation directory (in
>> scr/apps), It works fine INCLUDING BIGTIFF option.
>> How can I fix the linking problem ?
>
> Felix,
> I use (ubuntu 9.04 / 64-bit), among others, the following
> in /etc/ld.so.conf:
>
> ---%<---%<--
> # share
> /usr/local/share/gdal
>
> # gdal
> /usr/local/lib/gdalplugins
> #/geo/osgeo/FWTools-2.0.6/bin_safe
> # I use the last line to read HDF files (like MODIS MOD09 products)
> ---%<---%<--
>
> No warranty though. I am still messing up my system from time to time
> and kill my time trying to fix it (or loading the lists with
> questions :-p).
>
> Maybe there should be a separate section in the wiki to explain
> step-by-step linking issues, shared libraries, etc.
>
> FYI, below I am copy-pasting notes with respect to "./configuration" for
> GDAL compilation [*].
>
> Kindest regards, Nikos
> ---
>
> [*] GDAL related compilation notes
>
> *Must* compile without GRASS support
>
> # enter in directory gdal_stable
> cd /usr/local/src/gdal_stable
>
> # download with svn ## or update with svn up
>
> # clean previous configurations/compilations
> make distclean
>
> # configure
> CFLAGS="-g -Wall" LDFLAGS="-s" ./configure \
> --with-png=internal \
> --with-libtiff=internal \
> --with-geotiff=internal \
> --with-jpeg=internal \
> --with-gif=internal \
> --with-ecw=yes \
> --with-expat=yes \
> --with-expat-inc=/usr/include/ \
> --with-expat-lib=/usr/lib \
> --with-sqlite3=yes \
> --with-geos=yes \
> --with-python \
> --with-libz=internal \
> --with-netcdf \
> --with-sqlite \
> --with-threads=yes \
> --without-grass ?\
> --without-ogdi \
> --with-pg=/usr/bin/pg_config \
> --with-xerces=yes
>
> #compile & install & ldconfig
> make ?&& ?sudo make install ?&& ?sudo ldconfig
>
>
> Where is GDAL installed?
>
> # in /usr/local/bin
> /usr/local/bin/gdal-config \
> /usr/local/bin/gdal2tiles.py \
> /usr/local/bin/gdal2xyz.py \
> /usr/local/bin/gdal_contour \
> /usr/local/bin/gdal_grid \
> /usr/local/bin/gdal_merge.py \
> /usr/local/bin/gdal_rasterize \
> /usr/local/bin/gdal_retile.py \
> /usr/local/bin/gdal_translate \
> /usr/local/bin/gdaladdo \
> /usr/local/bin/gdalchksum.py \
> /usr/local/bin/gdalenhance \
> /usr/local/bin/gdalident.py \
> /usr/local/bin/gdalimport.py \
> /usr/local/bin/gdalinfo \
> /usr/local/bin/gdalmanage \
> /usr/local/bin/gdaltindex \
> /usr/local/bin/gdaltransform \
> /usr/local/bin/gdalwarp \
>
> # in /usr/local/share \
> /usr/local/share/gdal \
>
> # in /usr/local/lib \
> /usr/local/lib/libgdal.a \
> /usr/local/lib/libgdal.la \
> /usr/local/lib/libgdal.so \
> /usr/local/lib/libgdal.so.1 \
> /usr/local/lib/libgdal.so.1.12.3 \
>
> # in ?/usr/local/include/
> /usr/local/include/gdal.h \
> /usr/local/include/gdal_alg.h \
> /usr/local/include/gdal_frmts.h \
> /usr/local/include/gdal_pam.h \
> /usr/local/include/gdal_priv.h \
> /usr/local/include/gdal_rat.h \
> /usr/local/include/gdal_version.h \
> /usr/local/include/gdal_vrt.h \
> /usr/local/include/gdalgrid.h \
> /usr/local/include/gdaljp2metadata.h \
> /usr/local/include/gdalwarper.h \
>
>

Very nice ! This helped a lot. No linking error anymore.
Many thanks,

Felix
From bontepaarden at gmail.com  Fri Aug 14 16:08:56 2009
From: bontepaarden at gmail.com (Paul Meems)
Date: Fri Aug 14 16:08:59 2009
Subject: [gdal-dev] RE: Memory Error in _gdal.Band_ReadRaster(*args,
	**kwargs)
Message-ID: <870e056a0908141308s3a5b525p30856677909d7e55@mail.gmail.com>

I've been in contact with Christian the author of gdal_retile and he told me
this problem is in the main GDAL library.
He also suggested using some of the other GDAL tools to see if the problem
persists.

So I started using gdal_translate to copy my ecw to a new ecw using this
statement:
gdal_translate -a_srs EPSG:28992 -of ECW  -co "LARGE_OK=YES" large.ecw
Large_translate.ecw

After 6 hours (!) I got a new ecw file, this time 4.2GB with this info:
Driver: ECW/ERMapper Compressed Wavelets
Files: Large_translate.ecw
Size is 173334, 160000
Coordinate System is:
PROJCS["NUTM31",
    GEOGCS["RIJKDRIEHOEKSMETING",
        DATUM["RD",
            SPHEROID["BESS1841",6377397.155,299.1528128]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",3],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (33000.000000000000000,381000.000000000000000)
Pixel Size = (0.150000000001455,-0.150000000023283)
Corner Coordinates:
Upper Left  (   33000.000,  381000.000) (  1d12'3.77"W,  3d26'16.85"N)
Lower Left  (   33000.000,  357000.000) (  1d12'0.46"W,  3d13'17.23"N)
Upper Right (   59000.100,  381000.000) (  0d58'3.16"W,  3d26'20.47"N)
Lower Right (   59000.100,  357000.000) (  0d58'0.03"W,  3d13'20.61"N)
Center      (   46000.050,  369000.000) (  1d 5'1.86"W,  3d19'48.81"N)
Band 1 Block=173334x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=173334x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=173334x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

I tried to retile this ecw file using this command:
gdal_retile -v -s_srs EPSG:28992 -of ECW -ps 17335 16000 -targetDir tiles
Large_translate.ecw >retile.txt
But got the same memory error.

Next I tried converting to GeoTiff using this command:
gdal_translate -a_srs EPSG:28992 -of GTiff  Large.ecw Large.tiff
After 2.5 hours I got a 77.5GB Tiff file with this info:
Driver: GTiff/GeoTIFF
Files: Large.tiff
Size is 173334, 160000
Coordinate System is:
PROJCS["Amersfoort / RD New",
    GEOGCS["Amersfoort",
        DATUM["Amersfoort",
            SPHEROID["Bessel 1841",6377397.155,299.1528128000009,
                AUTHORITY["EPSG","7004"]],
            AUTHORITY["EPSG","6289"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4289"]],
    PROJECTION["Oblique_Stereographic"],
    PARAMETER["latitude_of_origin",52.15616055555555],
    PARAMETER["central_meridian",5.387638888888889],
    PARAMETER["scale_factor",0.9999079],
    PARAMETER["false_easting",155000],
    PARAMETER["false_northing",463000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","28992"]]
Origin = (33000.000000000000000,381000.000000000000000)
Pixel Size = (0.150000000001455,-0.150000000023283)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (   33000.000,  381000.000) (  3d38'2.16"E, 51d24'21.02"N)
Lower Left  (   33000.000,  357000.000) (  3d38'31.86"E, 51d11'24.60"N)
Upper Right (   59000.100,  381000.000) (  4d 0'27.21"E, 51d24'39.10"N)
Lower Right (   59000.100,  357000.000) (  4d 0'50.58"E, 51d11'42.56"N)
Center      (   46000.050,  369000.000) (  3d49'27.95"E, 51d18'2.36"N)
Band 1 Block=173334x1 Type=Byte, ColorInterp=Red
Band 2 Block=173334x1 Type=Byte, ColorInterp=Green
Band 3 Block=173334x1 Type=Byte, ColorInterp=Blue

When I try to retile this tiff using:
gdal_retile -v -s_srs EPSG:28992 -of GTiff -ps 17335 16000 -targetDir tiles
Large.tiff >retile.txt
I got again the memory error.

I don't know anymore how to to this. How can I split my large ecw file into
smaller tiles?

I also noticed that even if I use the same EPSG code I get different
projection info, even differences when using only gdal_translate.
The projection is the same, they only have different naming. Why is that?

I also noticed both gdal_translate and gdal_retile not use the full
potential of my hardware. I'm running Vista 64Bit on a AMD3 2.6Ghz quadcore
with 8GB RAM and only 2-2.5GB RAM was used by gdal_translate, leaving more
than 5 GB free and only 35-55% of my CPU was used. Do I need to set some
settings to speed things up?

Thanks,

Paul



From: Paul Meems <bontepaarden <at> gmail.com>
Subject: Memory Error in _gdal.Band_ReadRaster(*args,
**kwargs)<http://news.gmane.org/find-root.php?message_id=%3c870e056a0908101422x5f38bb6fh32c2bd848ff6c868%40mail.gmail.com%3e>
Newsgroups: gmane.comp.gis.gdal.devel<http://news.gmane.org/gmane.comp.gis.gdal.devel>
Date: 2009-08-10 21:22:06 GMT

I'm trying to split a large ECW file into smaller files.
I've downloaded and installed OSGeo4W with gdal16
I managed to split a small ecw file.
That ecw file had this info:

Driver: ECW/ERMapper Compressed Wavelets
Files: tilertest.ecw
Size is 6800, 7500
Coordinate System is `'
Origin = (13000.000000000000000,381250.000000000000000)
Pixel Size = (2.500000000000000,-2.500000000000000)
Corner Coordinates:
Upper Left  (   13000.000,  381250.000)
Lower Left  (   13000.000,  362500.000)
Upper Right (   30000.000,  381250.000)
Lower Right (   30000.000,  362500.000)
Center      (   21500.000,  371875.000)
Band 1 Block=6800x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=6800x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=6800x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

I used this statement:
gdal_retile -v -s_srs EPSG:28992 -of ECW -ps 3700 3750 -targetDir tiles
TilerTest.ecw

But when I try to split the large ecw file (3.4GB) I get an error after a
few minutes.
The info is:
Driver: ECW/ERMapper Compressed Wavelets
Files: Large.ecw
Size is 173334, 160000
Coordinate System is:
LOCAL_CS["LOCAL - (unsupported)",
    UNIT["Meter",1]]
Origin = (33000.000000000000000,381000.000000000000000)
Pixel Size = (0.150000000001455,-0.150000000023283)
Corner Coordinates:
Upper Left  (   33000.000,  381000.000)
Lower Left  (   33000.000,  357000.000)
Upper Right (   59000.100,  381000.000)
Lower Right (   59000.100,  357000.000)
Center      (   46000.050,  369000.000)
Band 1 Block=173334x1 Type=Byte, ColorInterp=Red
  Overviews: arbitrary
Band 2 Block=173334x1 Type=Byte, ColorInterp=Green
  Overviews: arbitrary
Band 3 Block=173334x1 Type=Byte, ColorInterp=Blue
  Overviews: arbitrary

The statement is:
gdal_retile -v -s_srs EPSG:28992 -of ECW -ps 86667 80000 -targetDir tiles
large.ecw >retile.txt

The logfile (retile.txt) shows:
Building internal Index for 1 tile(s) ... finished
Filename: Terneuzen_15cm.ecw
File Size: 173334x160000x3
Pixel Size: 0.150000 x -0.150000
UL:(33000.000000,381000.000000)   LR:(59000.100000,356999.999996)
tileWidth       86667
tileHeight      80000
countTilesX:    2
countTilesY:    2
lastTileWidth:  86667
lastTileHeight: 80000

And the error is:
Traceback (most recent call last):
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 938, in <module>
sys.exit(main(sys.argv))
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 855, in main
dsCreatedTileIndex = tileImage(minfo,ti)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 335, in tileImage
createTile(minfo, offsetX, offsetY, width, height,tilename,OGRDS)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 467, in createTile
dec.uly+offsetY*dec.scaleY)
  File "C:\OSGeo4W\apps\gdal-16\bin\gdal_retile.py", line 250, in getDataSet
data = s_band.ReadRaster( readOffsetX,readOffsetY,readX,readY,
readX,readY,self.band_type )
  File "C:\OSGeo4W\apps\gdal-16\pymod\osgeo\gdal.py", line 760, in
ReadRaster return _gdal.Band_ReadRaster(*args, **kwargs) MemoryError

I've searched using Google and found a similar error:
http://article.gmane.org/gmane.comp.gis.gdal.devel/18936 and contacted
Sarah, but she's still having the problem.

Does anybody know how to solve this?

I run it on a Vista 64-Bit 4-core, with 8GB RAM. I'm getting the same error
on a WinXP sp3 2-core, with 2 GB RAM

Thanks,

Paul Meems
The Netherlands
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090814/5d4c12f7/attachment.html
From szekerest at gmail.com  Fri Aug 14 16:20:57 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 14 16:21:01 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com>
Message-ID: <f3b73b7d0908141320r32bd2e48l68525208105e4d52@mail.gmail.com>

Hi Jorge,

I really appreciate your efforts to sort these issues out. I consider these
issues would be crucial especially when the requested block number is large
or when using non regular (and possibly overlapped) blocking where each
IReadBlock may result in fetching multiple raster rows.

However I consider we should start considering how to finalize the GSoc
project at a well defined stage, which we could safely be incorporated in
the gdal project tree as a new driver. It would be required to write up some
documentation or test scripts to make sure the existing code is working
correctly, then we should also submit the final evaluations within the Aug
17-24 interval according to the gsoc timeline. By all means please calculate
the necessary efforts to implement this enhancement we have recently been
talking about, and if it cannot be fitted in the gsoc timeline then go ahead
finalizing the existing implementation by adding the driver documentation
and scripts.

So as to implement these enhancements after finishing the gsoc efforts
you're happily welcomed in the gdal team to contribute with the remaining
parts to make this driver really compelling to use. Keep up the good work,


Best regards,

Tamas




2009/8/14 Jorge Ar?valo <jorge.arevalo@gmail.com>

> Hello,
>
> I've asked several concepts related with RasterIO-related methods in
> Dataset and RasterBand. Thanks to your responses, I've a better
> understanding of the GDAL drivers' I/O method. But I've a couple of
> doubts I need to solve to finish the GSoC, although I'd like to
> continue developing the driver after it.
>
> Problem: In basic GDAL WKT Raster driver, each row of a raster table
> (one block, in regularly blocked rasters) means one server round. This
> is slow, and "sub-optimal".
>
> How to solve it?: IReadBlock executes an spatial query to get all the
> rows of a table that fits in a natural block, defined by nXOff, nYOff
> and the values fetched by GetBlockSize. In many raster formats, one
> natural block is a scanline, of size (nXRasterSize, 1). In WKT Raster
> format, if we have a regularly blocked raster,  "natural" block size
> will be equal to RASTER_COLUMNS-defined block size, and the query will
> return one block. To avoid one spatial query for each block petition,
> we should "force" the driver to get all the blocks covering the area
> requested in a IRasterIO call.
>
> How to implement it? My approach is based on implementing
> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
> method). This method executes a spatial query that returns all the
> raster rows covering the area requested. Now, I have all the data of
> an image region. If the requested region dimensions match the buffer
> dimensions, I can copy all the pixels fetched in this way:
>
> pImage =
> {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
>
> Where bi are the bytes of the band i. A WKT Raster image has a
> non-interleaved format, all the band are consecutive. Is it correct? I
> mean, copy the data in pImage with this format.
>
> And if the region dimensions don't match the buffer dimensiones,
> should I raise an error and finish or delegate in base
> GDALDataset::IRasterIO implementation?
>
> Another question: After copying the data from fetched rows in pImage
> buffer, should I do anything more?
>
> Other part of my implementation is overriding
> GDALRasterBand::IRasterIO method. My method will simply call the
> WKTRasterDataset::IRasterIO method with only one band to read. Is it
> correct?
>
> Thanks in advance.
>
> Best regards,
> Jorge
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090814/59b31efd/attachment-0001.html
From gregcoats at mac.com  Fri Aug 14 16:26:52 2009
From: gregcoats at mac.com (Greg Coats)
Date: Fri Aug 14 17:26:57 2009
Subject: [gdal-dev] RE: Memory Error in _gdal.Band_ReadRaster(*args,
	**kwargs)
In-Reply-To: <870e056a0908141308s3a5b525p30856677909d7e55@mail.gmail.com>
References: <870e056a0908141308s3a5b525p30856677909d7e55@mail.gmail.com>
Message-ID: <3F8D900B-CA70-45DF-8A49-73989BAD41AB@mac.com>

It is my understanding that the default is
gdal_translate --config GDAL_CACHEMAX 40 ...
which equates to 40 MB of memory.
If you want to allow gdal_translate to use say 2 GB of memory for  
GDAL_CACHEMAX, enter
gdal_translate --config GDAL_CACHEMAX 2000 ...
In my experience, increasing GDAL_CACHEMAX substantially speeds up  
gdal_translate processing.
Greg

On Aug 14, 2009, at 4:08 PM, Paul Meems wrote:

> I also noticed both gdal_translate and gdal_retile not use the full  
> potential of my hardware. I'm running Vista 64Bit on a AMD3 2.6Ghz  
> quadcore with 8GB RAM and only 2-2.5GB RAM was used by  
> gdal_translate, leaving more than 5 GB free and only 35-55% of my  
> CPU was used. Do I need to set some settings to speed things up?

From jorge.arevalo at gmail.com  Sat Aug 15 05:49:56 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sat Aug 15 05:50:19 2009
Subject: [gdal-dev] GDAL WKT Raster cache: Problem, options to solve and 
	doubts
In-Reply-To: <f3b73b7d0908141320r32bd2e48l68525208105e4d52@mail.gmail.com>
References: <cb4457700908140547l56a5ce64ueb613f7c94676ccd@mail.gmail.com> 
	<f3b73b7d0908141320r32bd2e48l68525208105e4d52@mail.gmail.com>
Message-ID: <cb4457700908150249p65dc7967j23f74e548f70c89d@mail.gmail.com>

Hi Tamas,

2009/8/14 Tamas Szekeres <szekerest@gmail.com>:
> Hi Jorge,
>
> I really appreciate your efforts to sort these issues out. I consider these
> issues would be crucial especially when the requested block number is large
> or when using non regular (and possibly overlapped) blocking where each
> IReadBlock may result in fetching multiple raster rows.
>

Yes this situation is under control. Raising an "under development"
message, but under control, anyway.

> However I consider we should start considering how to finalize the GSoc
> project at a well defined stage, which we could safely be incorporated in
> the gdal project tree as a new driver. It would be required to write up some
> documentation or test scripts to make sure the existing code is working
> correctly, then we should also submit the final evaluations within the Aug
> 17-24 interval according to the gsoc timeline. By all means please calculate
> the necessary efforts to implement this enhancement we have recently been
> talking about, and if it cannot be fitted in the gsoc timeline then go ahead
> finalizing the existing implementation by adding the driver documentation
> and scripts.

Ok. I'll dedicate these last 2 days to simply finalize the GSoC-related work.

>
> So as to implement these enhancements after finishing the gsoc efforts
> you're happily welcomed in the gdal team to contribute with the remaining
> parts to make this driver really compelling to use. Keep up the good work,
>

Sounds really well. Thanks.


Best regards,
Jorge

>
> Best regards,
>
> Tamas
>
>
>
>
> 2009/8/14 Jorge Ar?valo <jorge.arevalo@gmail.com>
>>
>> Hello,
>>
>> I've asked several concepts related with RasterIO-related methods in
>> Dataset and RasterBand. Thanks to your responses, I've a better
>> understanding of the GDAL drivers' I/O method. But I've a couple of
>> doubts I need to solve to finish the GSoC, although I'd like to
>> continue developing the driver after it.
>>
>> Problem: In basic GDAL WKT Raster driver, each row of a raster table
>> (one block, in regularly blocked rasters) means one server round. This
>> is slow, and "sub-optimal".
>>
>> How to solve it?: IReadBlock executes an spatial query to get all the
>> rows of a table that fits in a natural block, defined by nXOff, nYOff
>> and the values fetched by GetBlockSize. In many raster formats, one
>> natural block is a scanline, of size (nXRasterSize, 1). In WKT Raster
>> format, if we have a regularly blocked raster, ?"natural" block size
>> will be equal to RASTER_COLUMNS-defined block size, and the query will
>> return one block. To avoid one spatial query for each block petition,
>> we should "force" the driver to get all the blocks covering the area
>> requested in a IRasterIO call.
>>
>> How to implement it? My approach is based on implementing
>> WKTRasterDataset::IRasterIO method (overriding GDALDataset::IRasterIO
>> method). This method executes a spatial query that returns all the
>> raster rows covering the area requested. Now, I have all the data of
>> an image region. If the requested region dimensions match the buffer
>> dimensions, I can copy all the pixels fetched in this way:
>>
>> pImage =
>> {b1b1b1b1b1b1b1b1b1b1...|b2b2b2b2b2b2b2b2b2...|...|bnbnbnbnbnbnbnbnbn}
>>
>> Where bi are the bytes of the band i. A WKT Raster image has a
>> non-interleaved format, all the band are consecutive. Is it correct? I
>> mean, copy the data in pImage with this format.
>>
>> And if the region dimensions don't match the buffer dimensiones,
>> should I raise an error and finish or delegate in base
>> GDALDataset::IRasterIO implementation?
>>
>> Another question: After copying the data from fetched rows in pImage
>> buffer, should I do anything more?
>>
>> Other part of my implementation is overriding
>> GDALRasterBand::IRasterIO method. My method will simply call the
>> WKTRasterDataset::IRasterIO method with only one band to read. Is it
>> correct?
>>
>> Thanks in advance.
>>
>> Best regards,
>> Jorge
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
From peifer at gmx.eu  Sat Aug 15 06:57:37 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Aug 15 06:57:43 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <ca2dd22a0908141252k43d3f4bbxf8cad1e1e3f9df92@mail.gmail.com>
References: <ca2dd22a0908141252k43d3f4bbxf8cad1e1e3f9df92@mail.gmail.com>
Message-ID: <4A8694A1.6070809@gmx.eu>

Felix Schalck wrote:
> Hello,
> 
> As explained in my previous question, I'm trying to create a high
> resolution topographic map of europe based on cgiar processed srtm
> data. Of cours, the first step is to merge the 5*5? tif tiles into one
> big tif, which can be achieved using gdalwarp's mosaic feature.
> 
> Simply pasting all the tiles togther trough following code:
> 
> gdalwarp --config GDAL_CACHEMAX 512 -wm 512  HDA1/srtm_*.ti HDA2/final.tif
> 
> takes about 20 hours. HDA1/2 are two different harddrives.
> 
> Now, a second script, pasting first "slices" of 5*30? together, and
> than merging all the slices:
> 
> for i in 39 40 41 42 43; do
> gdalwarp --config GDAL_CACHEMAX 512 -wm 512 HDA1/srtm_$i*.tif
> HDA2/slice_0$((i-34)).tif
> done
> gdalwarp --config GDAL_CACHEMAX 512 -wm 512 HDA2/slice_*.tif HDA1/final.tif
> 
> takes less than on hour ! Filesize is similar.
> 
> So what is the trick here ? Is there some quality loss when using gdalwarp ?
> 
> Felix Schalck


I have the same observation while working with ASTER GDEM tiles (1x1 degree tiles, 3601x3601 pixel each). When warping/merging, say: 10 tiles into a single outfile.tif, then it takes gdalwarp around 5 seconds per tile to do the job:

gdalwarp  --config GDAL_CACHEMAX 500 -wm 500    \
          -rb -srcnodata -9999 -dstnodata -9999 \
          -t_srs etrs89_laea_52_10.wkt          \
          -tr 100 100                           \
          ASTGTM_N51*.tif outfile.tif

When trying to do the same with some 200-300 input files, then it takes several minutes to process 1 tile. My area of interest translates roughly into 1500 ASTER GDEM tiles... :-(

Hermann
From robert.coup at onetrackmind.co.nz  Sun Aug 16 15:52:24 2009
From: robert.coup at onetrackmind.co.nz (Robert Coup)
Date: Sun Aug 16 15:58:40 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8694A1.6070809@gmx.eu>
References: <ca2dd22a0908141252k43d3f4bbxf8cad1e1e3f9df92@mail.gmail.com>
	<4A8694A1.6070809@gmx.eu>
Message-ID: <c5097ac40908161252p2bb3fcbekbb20fe8246ecec07@mail.gmail.com>

On Sat, Aug 15, 2009 at 10:57 PM, Hermann Peifer <peifer@gmx.eu> wrote:

>
> I have the same observation while working with ASTER GDEM tiles (1x1 degree
> tiles, 3601x3601 pixel each). When warping/merging, say: 10 tiles into a
> single outfile.tif, then it takes gdalwarp around 5 seconds per tile to do
> the job:


Does creating a tiled tiff (-co TILED=YES) make any difference? It should
improve random access, which is what writing new data to image blocks is.

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090817/16d23c87/attachment.html
From bontepaarden at gmail.com  Sun Aug 16 16:00:46 2009
From: bontepaarden at gmail.com (Paul Meems)
Date: Sun Aug 16 16:00:48 2009
Subject: [gdal-dev] RE: Memory Error in _gdal.Band_ReadRaster(*args, 
	**kwargs)
In-Reply-To: <3F8D900B-CA70-45DF-8A49-73989BAD41AB@mac.com>
References: <870e056a0908141308s3a5b525p30856677909d7e55@mail.gmail.com>
	<3F8D900B-CA70-45DF-8A49-73989BAD41AB@mac.com>
Message-ID: <870e056a0908161300l5b9ae3e5k15ead20624fad736@mail.gmail.com>

Thanks Greg for your help about speeding things up.
But speed is the least of my problems.
I wouldn't mind waiting 72 hours if it gets the job done.
But even with this statement:
gdal_retile --config GDAL_CACHEMAX 4000-v -s_srs EPSG:28992 -of ECW -ps
17335 16000 -targetDir tiles large.ecw

I get the Memory error.

Do you also have any suggestion on that. Would be very much appreciated.

Thanks,
Paul

2009/8/14 Greg Coats <gregcoats@mac.com>

> It is my understanding that the default is
> gdal_translate --config GDAL_CACHEMAX 40 ...
> which equates to 40 MB of memory.
> If you want to allow gdal_translate to use say 2 GB of memory for
> GDAL_CACHEMAX, enter
> gdal_translate --config GDAL_CACHEMAX 2000 ...
> In my experience, increasing GDAL_CACHEMAX substantially speeds up
> gdal_translate processing.
> Greg
>
> On Aug 14, 2009, at 4:08 PM, Paul Meems wrote:
>
>  I also noticed both gdal_translate and gdal_retile not use the full
>> potential of my hardware. I'm running Vista 64Bit on a AMD3 2.6Ghz quadcore
>> with 8GB RAM and only 2-2.5GB RAM was used by gdal_translate, leaving more
>> than 5 GB free and only 35-55% of my CPU was used. Do I need to set some
>> settings to speed things up?
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090816/53ab48ec/attachment.html
From jorge.arevalo at gmail.com  Sun Aug 16 20:16:18 2009
From: jorge.arevalo at gmail.com (=?UTF-8?Q?Jorge_Ar=C3=A9valo?=)
Date: Sun Aug 16 20:16:40 2009
Subject: [gdal-dev] GDAL WKT Raster last weekly report
Message-ID: <cb4457700908161716q4d776231o650ac6d31669f676@mail.gmail.com>

Hello,

Here, the last weekly report:
http://www.gis4free.org/blog/2009/08/17/gsoc-09-final-report-0708-1708/

And here, the project page: http://trac.osgeo.org/gdal/wiki/WKTRasterDriver

Congratulations to everyone! GSoC 09 has finished...

Best regards,
Jorge
From gregcoats at mac.com  Sun Aug 16 21:19:48 2009
From: gregcoats at mac.com (Greg Coats)
Date: Sun Aug 16 21:19:52 2009
Subject: [gdal-dev] RE: Memory Error in _gdal.Band_ReadRaster(*args,
	**kwargs)
In-Reply-To: <870e056a0908161300l5b9ae3e5k15ead20624fad736@mail.gmail.com>
References: <870e056a0908141308s3a5b525p30856677909d7e55@mail.gmail.com>
	<3F8D900B-CA70-45DF-8A49-73989BAD41AB@mac.com>
	<870e056a0908161300l5b9ae3e5k15ead20624fad736@mail.gmail.com>
Message-ID: <A31BAA62-F27E-4228-8974-B0E1A578AA4E@mac.com>

You said you have 8 GB RAM, and gdal_translate was using only 2 GB  
RAM, and your specific question was "Do I need to set some settings  
to speed things up?". Yes, you should increase the amount of RAM  
gdal_translate makes available to GDAL_CACHEMAX. For example,  
"gdal_translate --config GDAL_CACHEMAX 4000 " followed by the rest of  
the gdal_translate command. In your message you have "--config  
GDAL_CACHEMAX 4000-v", but there needs to be a space after "4000" and  
before "-v".
I have successfully used gdal_merge.py and gdal_translate to create  
GeoTIFF files as large as 142 GB, under Unix based Mac OS X, on a  
computer with only 3 GB RAM.
Greg

On Aug 16, 2009, at 4:00 PM, Paul Meems wrote:
> Thanks Greg for your help about speeding things up.
> But speed is the least of my problems.
> I wouldn't mind waiting 72 hours if it gets the job done.
> But even with this statement:
> gdal_retile --config GDAL_CACHEMAX 4000-v -s_srs EPSG:28992 -of ECW  
> -ps 17335 16000 -targetDir tiles large.ecw
>
> I get the Memory error.
>
> Do you also have any suggestion on that. Would be very much  
> appreciated.
>
> Thanks,
> Paul
>
> 2009/8/14 Greg Coats <gregcoats@mac.com>
> It is my understanding that the default is
> gdal_translate --config GDAL_CACHEMAX 40 ...
> which equates to 40 MB of memory.
> If you want to allow gdal_translate to use say 2 GB of memory for  
> GDAL_CACHEMAX, enter
> gdal_translate --config GDAL_CACHEMAX 2000 ...
> In my experience, increasing GDAL_CACHEMAX substantially speeds up  
> gdal_translate processing.
> Greg
>
> On Aug 14, 2009, at 4:08 PM, Paul Meems wrote:
>
> I also noticed both gdal_translate and gdal_retile not use the full  
> potential of my hardware. I'm running Vista 64Bit on a AMD3 2.6Ghz  
> quadcore with 8GB RAM and only 2-2.5GB RAM was used by  
> gdal_translate, leaving more than 5 GB free and only 35-55% of my  
> CPU was used. Do I need to set some settings to speed things up?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090816/de1e7b90/attachment.html
From fhillen at uni-osnabrueck.de  Mon Aug 17 10:40:44 2009
From: fhillen at uni-osnabrueck.de (Florian Hillen)
Date: Mon Aug 17 11:42:26 2009
Subject: [gdal-dev] OGRSpatialReference problem in QGIS
Message-ID: <3452.79.205.41.138.1250520044.squirrel@webmail.rz.uni-osnabrueck.de>

Hi list,

I have a problem with OGR, more precisely with OGR in Quantum GIS.

For my Plugin which reprojects rasterdata to another CS, I need a WKT
description of the new CS. With the class "QgsProjectionSelector" of
Quantum GIS I can select a CS and read out the epsg code or the proj4
string. But I fail by setting this to an OGRSpatialReference and export
that to a WKT.
If I transform a 4326 scene with my plugin to 31467 (german system), the
gdal warp works correctly (the coordinates are right), but the information
about the geocs looks like this:

PROJCS["unnamed",PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["Meter",1]]

Here is the code in which I set the OSR:

    OGRSpatialReference oSRS;

    long epsg = projectSelector->selectedEpsg();

    if(epsg == 0)
        return false;

    if(epsg == 4326)
    {
        QString epsgString;
        epsgString.setNum(epsg);
        epsgString.prepend("EPSG:");
        oSRS.SetWellKnownGeogCS(epsgString.toUtf8());
    }
    else
    {
        oSRS.SetProjCS((projectSelector->selectedName()).toUtf8());
        oSRS.importFromProj4((projectSelector->selectedProj4String()).toUtf8());
    }

    oSRS.exportToWkt( &pszDstWKT );

The if-clause for 4326 was just a try to use an other function, so don't
focus on that too much.

So can anyone help me with that?
Do I have to use the C-API for that? I already had problems with the C++
API of GDAL in Quantum GIS. My first attempt with the C-API for OGR wasn't
successful either, that's why I asked you for a hint.

Thanks in advance and best regards,
Florian
From mdillon at i3.com  Mon Aug 17 12:11:29 2009
From: mdillon at i3.com (Michael Dillon)
Date: Mon Aug 17 12:14:22 2009
Subject: [gdal-dev] GDALDataset - not writing to aux.xml?
Message-ID: <4A898131.1020606@i3.com>

I'm using the csharp swig wrappers to get information from various types 
of imagery.  I'm relying on the data to be stored in the *.aux.xml file 
for later retrieval. 

For NITF imagery, this seems to work fine.  For GeoTiffs however, none 
of the file's metadata is stored when I call FlushCache() on the 
dataset.  The information is there when I iterate over the various 
metadata domains, but it's not saved.  Another oddity is that histogram 
data *is* written, but no stats or other information.

Am I missing something? (a code snippet is below)

Thanks,

Mike

  private void ProcessMetadataDomain(Dataset ds, string domain)
  {
   string[] metadata = ds.GetMetadata(domain);
   if ((metadata != null) && (metadata.Length > 0))
   {
    ds.FlushCache(); // This isn't [always] writing the contents to the 
aux.xml...?
    WriteLine("  " + domain + " Metadata");
    for (int iMeta = 0; iMeta < metadata.Length; iMeta++)
     WriteLine("    " + iMeta + ":  " + metadata[iMeta]);
    WriteLine();
   }
   else
    WriteLine("  No '" + domain + "' Metadata found." + 
System.Environment.NewLine);
  }

I see this information in my GUI, but it doesn't get saved.

   Metadata
    0:  AREA_OR_POINT=Area
    1:  TIFFTAG_IMAGEDESCRIPTION="GeoEye"
    2:  TIFFTAG_DATETIME=2007:11:29 23:35:55
    3:  TIFFTAG_COPYRIGHT="(c) GeoEye"
    4:  TIFFTAG_XRESOLUTION=300
    5:  TIFFTAG_YRESOLUTION=300
    6:  TIFFTAG_MINSAMPLEVALUE=1
    7:  TIFFTAG_MAXSAMPLEVALUE=2047
    8:  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)

  IMAGE_STRUCTURE Metadata
    0:  INTERLEAVE=BAND

  No 'RPC' Metadata found.

  No 'SUBDATASETS' Metadata found.

  No 'GEOLOCATION' Metadata found.

From peifer at gmx.eu  Mon Aug 17 13:42:52 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Mon Aug 17 13:42:56 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <c5097ac40908161252p2bb3fcbekbb20fe8246ecec07@mail.gmail.com>
References: <ca2dd22a0908141252k43d3f4bbxf8cad1e1e3f9df92@mail.gmail.com>	
	<4A8694A1.6070809@gmx.eu>
	<c5097ac40908161252p2bb3fcbekbb20fe8246ecec07@mail.gmail.com>
Message-ID: <4A89969C.20102@gmx.eu>

Robert Coup wrote
> On Sat, Aug 15, 2009 at 10:57 PM, Hermann Peifer <peifer@gmx.eu> wrote:
> 
>> I have the same observation while working with ASTER GDEM tiles (1x1 degree
>> tiles, 3601x3601 pixel each). When warping/merging, say: 10 tiles into a
>> single outfile.tif, then it takes gdalwarp around 5 seconds per tile to do
>> the job:
> 
> 
> Does creating a tiled tiff (-co TILED=YES) make any difference? It should
> improve random access, which is what writing new data to image blocks is.
> 

Thanks for the hint, but I didn't make any substantial difference, as far as I could see.

Basically, my task is to warp/resample/merge some 1500 ASTER GDEM tiffs into a single output file in LAEA projection. My area of interest is around 5000 x 4000 km, i.e. my 100m output raster would be 50000 x 40000 x 16 bit/pixel = 4GB GeoTiff.

I thought this should be a doable task and would perhaps take some hours or so. But over the last days, I have been experimenting quite a lot with -wm, --config GDAL_CACHEMAX settings, etc. without getting anywhere apart from the insight that it would take 10 days and more to do the job. I have a vague feeling that I am overlooking something obvious.

A promising approach seemed to be to warp/resample the ASTER files one by one and create 1500 separate tiles in LAEA projection, as an intermediate step. Then I created a vrt file with gdalbuildvrt and gdal_translated it into tiff format. The result did however look odd, as the elevation data in most tiles was clipped by NODATA areas of their neighbouring tiles :-(

Hermann
From Jukka.Rahkonen at mmmtike.fi  Mon Aug 17 16:41:57 2009
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Mon Aug 17 16:56:50 2009
Subject: [gdal-dev] Re: Re: Strange things with gdalwarp ...
Message-ID: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>


From: Hermann Peifer <peifer <at> gmx.eu>

> A promising approach seemed to be to warp/resample the ASTER files one by one and create 1500 separate tiles
> in LAEA projection, as an intermediate step. Then I created a vrt file with gdalbuildvrt and
> gdal_translated it into tiff format. The result did however look odd, as the elevation data in most tiles
> was clipped by NODATA areas of their neighbouring tiles :-(

Hi, 

Did you try to use gdalwarp also for the second step with -srcnodata value [value...]?  I believe you did set some NODATA value in step 1 for the intermediate images.

-Jukka Rahkonen- 
From Gary.Smart at goodrich.com  Tue Aug 18 04:13:51 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Tue Aug 18 04:13:58 2009
Subject: [gdal-dev] Converting to J2K
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>

Can someone quickly tell me how to convert a ntf file into J2K format?

 

I am trying 'gdal_translate  -of JPEG2000  thingy.ntf  thingy.j2k' but
GDAL complains that it doesn't understand the format thingy.j2k

I think its getting the arguments confused.  What am I doing wrong?

 

Gary 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/d40feb5d/attachment.html
From warmerdam at pobox.com  Tue Aug 18 05:52:42 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 18 05:52:52 2009
Subject: [gdal-dev] Converting to J2K
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
Message-ID: <4A8A79EA.5010006@pobox.com>

Smart, Gary wrote:
> Can someone quickly tell me how to convert a ntf file into J2K format?
> 
>  
> 
> I am trying *?gdal_translate  ?of JPEG2000  thingy.ntf  thingy.j2k? *but 
> GDAL complains that it doesn?t understand the format /thingy.j2k/
> 
> I think its getting the arguments confused.  What am I doing wrong?

Gary,

Could you cut and paste the exact error message?  At the end of a data
translation process gdal_translate generally reopens the output file and
I'm wondering if it is at this point that the erroris happening.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From monshi at home.se  Tue Aug 18 07:15:34 2009
From: monshi at home.se (Tomas R)
Date: Tue Aug 18 07:16:06 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <f3b73b7d0907170618r7a1e6ffbn661bb2fbfa8a83ef@mail.gmail.com>
References: <h3c5r1$kmo$1@ger.gmane.org>
	<4A5A0B67.10309@pobox.com>	<h3plot$aap$1@ger.gmane.org>
	<f3b73b7d0907170618r7a1e6ffbn661bb2fbfa8a83ef@mail.gmail.com>
Message-ID: <h6e2gn$o4p$1@ger.gmane.org>

Ah, thanks. Been away some time from the list and no email regarding 
this answer. Will try it but am happy with the binaries I currently have.

Another Q...
On my Vista machine when I compile GDAL/Swig-links  it  is compiled for 
the .Net 3.5 platform. Would like to target .Net 2 instead. How? Am 
investigating myself but no luck so far.

Must I install .Net 2 SDK on my Vista? In the GUI there is no problem 
targeting .Net 2 but on the commandline? I currently open up, set up, 
the environment using the setenv.cmd in the folder C:\Program 
Files\Microsoft SDKs\Windows\v6.1\Bin
Compiles fine, but to .Net 3.5.
An environment setting? or?



Tamas Szekeres skrev:
>
>
> 2009/7/17 Tomas R <monshi@home.se <mailto:monshi@home.se>>
>
>     Hi again
>
>     Seems like I have solved the problem... the line
>
>         such as preprocessing the grid shift file into binary form.
>
>     gave me (finally) the hint I needed. Tried to compile Proj4 and
>     the shift files but managed only compile the first part. Then I
>     finally went for the easy solution, I grabbed the binary files
>     from FWTools and finally I got it working.
>
>     Compiling the shift files on Windows? How? Well, not at big issue
>     at the moment.
>
>
> Tomas,
>
>
> That would be something like:
>
> nmake /f makefile.vc <http://makefile.vc> nadshift
>
> in the proj source directory.
>
> If you download the SDK http://vbkto.dyndns.org:1280/sdk/Default.aspx
>
> copy the proj sources into the root directory (ie: \proj-4.6.1) of the 
> SDK and use:
>
> nmake proj PROJ_DIR=proj-4.6.1
>
> in the VS Command prompt, which should compile the nadshift files as well.
>
>
> Best regards,
>
> Tamas
>
>
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From szekerest at gmail.com  Tue Aug 18 08:22:46 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue Aug 18 08:28:35 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <h6e2gn$o4p$1@ger.gmane.org>
References: <h3c5r1$kmo$1@ger.gmane.org> <4A5A0B67.10309@pobox.com>
	<h3plot$aap$1@ger.gmane.org>
	<f3b73b7d0907170618r7a1e6ffbn661bb2fbfa8a83ef@mail.gmail.com>
	<h6e2gn$o4p$1@ger.gmane.org>
Message-ID: <f3b73b7d0908180522s448294fdq803d73adff3ec916@mail.gmail.com>

2009/8/18 Tomas R <monshi@home.se>

> Ah, thanks. Been away some time from the list and no email regarding this
> answer. Will try it but am happy with the binaries I currently have.
>
> Another Q...
> On my Vista machine when I compile GDAL/Swig-links  it  is compiled for the
> .Net 3.5 platform. Would like to target .Net 2 instead. How? Am
> investigating myself but no luck so far.
>
> Must I install .Net 2 SDK on my Vista? In the GUI there is no problem
> targeting .Net 2 but on the commandline? I currently open up, set up, the
> environment using the setenv.cmd in the folder C:\Program Files\Microsoft
> SDKs\Windows\v6.1\Bin
> Compiles fine, but to .Net 3.5.
> An environment setting? or?
>


I don't see any any framework preference in the default compilation, it
depends on which version of mscorlib is available at compile time. This
should be .net framework 2.0 by default, so make sure this framewok version
have been installed side by side on the development machine.


Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/03c3fd86/attachment.html
From gregcoats at mac.com  Tue Aug 18 10:44:20 2009
From: gregcoats at mac.com (Greg Coats)
Date: Tue Aug 18 10:44:25 2009
Subject: [gdal-dev] Converting to J2K
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
Message-ID: <68DC50B9-96B7-407A-AB43-1EABBE2B3314@mac.com>

$ gdal_translate --version
GDAL 1.6.2, released 2009/07/31
$ gdal_translate -of JPEG2000 18stj940125.tif 18stj940125.jp2
Input file size is 5000, 5000
0...10...20...30...40...50...60...70...80...90...100 - done.

FYI The convention for JPEG2000 image files is to use the  
extension .jp2.
Greg

On Aug 18, 2009, at 4:13 AM, Smart, Gary wrote:

> I am trying ?gdal_translate  ?of JPEG2000  thingy.ntf  thingy.j2k?  
> but GDAL complains that it doesn?t understand the format thingy.j2k
> I think its getting the arguments confused.  What am I doing wrong?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/2042f49d/attachment-0001.html
From Gary.Smart at goodrich.com  Tue Aug 18 11:14:54 2009
From: Gary.Smart at goodrich.com (Smart, Gary)
Date: Tue Aug 18 11:15:00 2009
Subject: [gdal-dev] Converting to J2K
In-Reply-To: <68DC50B9-96B7-407A-AB43-1EABBE2B3314@mac.com>
References: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
	<68DC50B9-96B7-407A-AB43-1EABBE2B3314@mac.com>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3E4C285@nhc2ex11.goodrich.root.local>

I have tried just about all the standard J2K extensions - none appear to
work.

 

This is the output from...

 

gdal_translate -of JPEG2000 image.ntf image.jp2

 

Input file size is 4008, 2672

0...10...20...30...40...50...60...70...80...90...100 - done.

ERROR 4: `image.jp2' not recognised as a supported file format.

 

The 0..10... bit happens absurdly quickly (as if it does nothing useful)

 

The ERROR is (I think) perhaps generated by an automatic gdalinfo
directly after the translate.

Certainly, a gdalinfo on the created file returns an almost identical
error.

 

I can convert the ntf file into a geotiff OK.  But then, if I try and
convert the geotiff to jp2 - it fails - giving exactly the same
symptoms.  Is there some sort of JPEG2000 library I have to specifically
load or something?

 

________________________________

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Greg Coats
Sent: 18 August 2009 15:44
To: Smart, Gary
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Converting to J2K

 

$ gdal_translate --version

GDAL 1.6.2, released 2009/07/31

$ gdal_translate -of JPEG2000 18stj940125.tif 18stj940125.jp2

Input file size is 5000, 5000

0...10...20...30...40...50...60...70...80...90...100 - done.

 

FYI The convention for JPEG2000 image files is to use the extension
.jp2.

Greg

 

On Aug 18, 2009, at 4:13 AM, Smart, Gary wrote:





I am trying 'gdal_translate  -of JPEG2000  thingy.ntf  thingy.j2k' but
GDAL complains that it doesn't understand the format thingy.j2k

I think its getting the arguments confused.  What am I doing wrong?

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/16bd4793/attachment.html
From gregcoats at mac.com  Tue Aug 18 12:35:50 2009
From: gregcoats at mac.com (Greg Coats)
Date: Tue Aug 18 12:35:58 2009
Subject: [gdal-dev] Converting to J2K
In-Reply-To: <45D1B79D2DCCF34E966D24728765DDB3E4C285@nhc2ex11.goodrich.root.local>
References: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
	<68DC50B9-96B7-407A-AB43-1EABBE2B3314@mac.com>
	<45D1B79D2DCCF34E966D24728765DDB3E4C285@nhc2ex11.goodrich.root.local>
Message-ID: <0F823ED9-4600-458A-B339-D25B1DB35AAA@mac.com>

According to http://www.gdal.org/formats_list.html , GDAL supports  
four flavors of JPEG2000, four different implementations of wavelet  
compression, based on JasPer, Kakadu, ECW, and MrSID. Two of these  
four are available to me
gdal_translate | grep 2000
   JP2KAK: JPEG-2000 (based on Kakadu)
   JPEG2000: JPEG-2000 part 1 (ISO/IEC 15444-1)
Which of these four are available to you?

When creating and writing a JPEG2000 file, use -of to specify which of  
the available flavors you want GDAL to use.
/usr/bin/time gdal_translate -of JPEG2000 18stj940125.tif  
18stj940125_gdalV162_of_JPEG200.jp2
Input file size is 5000, 5000
0...10...20...30...40...50...60...70...80...90...100 - done.
        24.27 real        20.91 user         2.47 sys
/usr/bin/time gdal_translate -of JP2KAK   18stj940125.tif  
18stj940125_gdalV162_of_JP2KAK.jp2
Input file size is 5000, 5000
0...10...20...30...40...50...60...70...80...90...100 - done.
        15.75 real        15.06 user         0.30 sys
Greg


On Aug 18, 2009, at 11:14 AM, Smart, Gary wrote:

> I have tried just about all the standard J2K extensions ? none  
> appear to work.
>
> This is the output from...
>
> gdal_translate -of JPEG2000 image.ntf image.jp2
>
> Input file size is 4008, 2672
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> ERROR 4: `image.jp2' not recognised as a supported file format.
>
> The 0..10... bit happens absurdly quickly (as if it does nothing  
> useful)
>
> The ERROR is (I think) perhaps generated by an automatic gdalinfo  
> directly after the translate.
> Certainly, a gdalinfo on the created file returns an almost  
> identical error.
>
> I can convert the ntf file into a geotiff OK.  But then, if I try  
> and convert the geotiff to jp2 ? it fails ? giving exactly the same  
> symptoms.  Is there some sort of JPEG2000 library I have to  
> specifically load or something?
>
> From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org 
> ] On Behalf Of Greg Coats
> Sent: 18 August 2009 15:44
> To: Smart, Gary
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Converting to J2K
>
> $ gdal_translate --version
> GDAL 1.6.2, released 2009/07/31
> $ gdal_translate -of JPEG2000 18stj940125.tif 18stj940125.jp2
> Input file size is 5000, 5000
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> FYI The convention for JPEG2000 image files is to use the  
> extension .jp2.
> Greg
>
> On Aug 18, 2009, at 4:13 AM, Smart, Gary wrote:
>
>
> I am trying ?gdal_translate  ?of JPEG2000  thingy.ntf  thingy.j2k?  
> but GDAL complains that it doesn?t understand the format thingy.j2k
> I think its getting the arguments confused.  What am I doing wrong?
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/1263809f/attachment.html
From peifer at gmx.eu  Tue Aug 18 14:48:44 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue Aug 18 14:48:49 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
Message-ID: <4A8AF78C.3030109@gmx.eu>

Jukka wrote
> From: Hermann Peifer <peifer <at> gmx.eu>
> 
>> A promising approach seemed to be to warp/resample the ASTER files one by one and create 1500 separate tiles
>> in LAEA projection, as an intermediate step. Then I created a vrt file with gdalbuildvrt and
>> gdal_translated it into tiff format. The result did however look odd, as the elevation data in most tiles
>> was clipped by NODATA areas of their neighbouring tiles :-(
> 
> Hi, 
> 
> Did you try to use gdalwarp also for the second step with -srcnodata value [value...]?  I believe you did set some NODATA value in step 1 for the intermediate images.
> 
> -Jukka Rahkonen- 

I did. However, the main problem with gdalwarp is its performance. So my options seem to be:

1.
gdalwarping 1500 ASTER tiles in 1 run into a 4GB 100m raster output.tif
= 5-10 days processing (my best estimate)

2.
gdalwarping 1500 ASTER tiles 1-by-1 as an intermediate step, then
gdal_merge or gdal_translate to mosaic warped tiles into output.tif
= smaller or larger NODATA areas in output.tif, along tile borders

Today I resorted to Plan B, which is option A with a 250m raster output.tif. This is not exactly what I want to have, but seems to be doable in ~1 day.

Hermann

From questions.anon at gmail.com  Tue Aug 18 17:40:44 2009
From: questions.anon at gmail.com (questions anon)
Date: Tue Aug 18 17:40:47 2009
Subject: [gdal-dev] calculate values within a vector
Message-ID: <aa15d47e0908181440w7e88162ake9e2a84b6c5de941@mail.gmail.com>

Does anyone have a script using Python that can:

-Open a shapefile

-Open many rasters

-Calculate the mean and standard deviation of those rasters within the
shapefile region, but is able to ignore areas of zeros or NoData

-Output the mean and standard deviation to a table

Any help is greatly appreciated! Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090818/b5c7d3cd/attachment.html
From aca at ngi.be  Wed Aug 19 03:51:37 2009
From: aca at ngi.be (acangi)
Date: Wed Aug 19 03:51:39 2009
Subject: [Gdal-dev] Flashy colors in a pyramid
Message-ID: <1250668297197-3470903.post@n2.nabble.com>


Hello list,

I created a pyramid of aerial photos using gdal_retile.py and now see there
are strange zones in the pyramid. I'm trying to understand why I got this
strange results and how I can fix it (Bombing the area to make sure it looks
like what I have ?). Description :
1. The command I used was gdal_retile.py -targetDir pyramid/ -levels 12
-pyramidOnly -v -s_srs /path/to/prjs/3812.prj -ps 10000 10000 -r bilinear
-co "TILED=YES" -co "COMPRESS=LZW" -co "INTERLEAVE=PIXEL" -tileIndex
orthocol -tileIndexField location /path/to/source/files/*.tif &
2. In the source files, I see nothing special. The tiles in this area look
like the other ones.
3. On the first (generated) level of the pyramid, I see a small area (alias
SMALL_SQUARE : 256m x 256m) in blue :
http://n2.nabble.com/file/n3470903/BlueSquare.jpg 
4. On the next levels of the pyramid, a black rectangle 512m x 256m is now
visible where SMALL_SQUARE was : 
http://n2.nabble.com/file/n3470903/BlackRect.jpg  
and the area corresponding to the first level tile containing SMALL_SQUARE
(alias BIG_SQUARE : 10000m x 10000m) is in green : 
http://n2.nabble.com/file/n3470903/GreenSquare.jpg 
5. I view the pyramid in geoserver, the tiles look like they are on disk,
except at the first level, geoserver doesn't show me the full SMALL_SQUARE,
only parts of it. In geoserver logs, I find nothing very interesting, it all
looks the same whether or not I'm looking at BIG_SQUARE.
6. If I set OutputTransparentColor to #000000 (the background color),
BIG_SQUARE is now invisible (in geoserver)

So, my questions are :
Why did it happen ? I suppose it's just a random error...
How can I fix it ? Is there any way other than rebuilding the whole pyramid
?

Any idea is welcome,

Alain
-- 
View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3470903.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From Gary.Smart at Goodrich.com  Wed Aug 19 04:28:19 2009
From: Gary.Smart at Goodrich.com (Smart, Gary)
Date: Wed Aug 19 04:28:26 2009
Subject: [gdal-dev] Converting to J2K
In-Reply-To: <0F823ED9-4600-458A-B339-D25B1DB35AAA@mac.com>
References: <45D1B79D2DCCF34E966D24728765DDB3E4C1CC@nhc2ex11.goodrich.root.local>
	<68DC50B9-96B7-407A-AB43-1EABBE2B3314@mac.com>
	<45D1B79D2DCCF34E966D24728765DDB3E4C285@nhc2ex11.goodrich.root.local>
	<0F823ED9-4600-458A-B339-D25B1DB35AAA@mac.com>
Message-ID: <45D1B79D2DCCF34E966D24728765DDB3E4C2D6@nhc2ex11.goodrich.root.local>

I only have the JPEG2000 part 1 blah blah available.  Nevertheless, this
is the one I am trying to use.  I guess it's yet another thing that
doesn't install properly on SUSE10!!

I'll try and get everything re-installed on my machine - I also seem to
have problems with PROJ4 stuff also.  I installed everything from the
FWTools package.  I don't suppose anyone knows a reliable installation
source for GDAL on SUSE10?

 

________________________________

From: Greg Coats [mailto:gregcoats@mac.com] 
Sent: 18 August 2009 17:36
To: Smart, Gary
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Converting to J2K

 

According to http://www.gdal.org/formats_list.html , GDAL supports four
flavors of JPEG2000, four different implementations of wavelet
compression, based on JasPer, Kakadu, ECW, and MrSID. Two of these four
are available to me

gdal_translate | grep 2000

  JP2KAK: JPEG-2000 (based on Kakadu)

  JPEG2000: JPEG-2000 part 1 (ISO/IEC 15444-1)

Which of these four are available to you?

 

When creating and writing a JPEG2000 file, use -of to specify which of
the available flavors you want GDAL to use.

/usr/bin/time gdal_translate -of JPEG2000 18stj940125.tif
18stj940125_gdalV162_of_JPEG200.jp2

Input file size is 5000, 5000

0...10...20...30...40...50...60...70...80...90...100 - done.

       24.27 real        20.91 user         2.47 sys

/usr/bin/time gdal_translate -of JP2KAK   18stj940125.tif
18stj940125_gdalV162_of_JP2KAK.jp2

Input file size is 5000, 5000

0...10...20...30...40...50...60...70...80...90...100 - done.

       15.75 real        15.06 user         0.30 sys

Greg

 

 

On Aug 18, 2009, at 11:14 AM, Smart, Gary wrote:





I have tried just about all the standard J2K extensions - none appear to
work.

 

This is the output from...

 

gdal_translate -of JPEG2000 image.ntf image.jp2

 

Input file size is 4008, 2672

0...10...20...30...40...50...60...70...80...90...100 - done.

ERROR 4: `image.jp2' not recognised as a supported file format.

 

The 0..10... bit happens absurdly quickly (as if it does nothing useful)

 

The ERROR is (I think) perhaps generated by an automatic gdalinfo
directly after the translate.

Certainly, a gdalinfo on the created file returns an almost identical
error.

 

I can convert the ntf file into a geotiff OK.  But then, if I try and
convert the geotiff to jp2 - it fails - giving exactly the same
symptoms.  Is there some sort of JPEG2000 library I have to specifically
load or something?

 

________________________________

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Greg Coats
Sent: 18 August 2009 15:44
To: Smart, Gary
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Converting to J2K

 

$ gdal_translate --version

GDAL 1.6.2, released 2009/07/31

$ gdal_translate -of JPEG2000 18stj940125.tif 18stj940125.jp2

Input file size is 5000, 5000

0...10...20...30...40...50...60...70...80...90...100 - done.

 

FYI The convention for JPEG2000 image files is to use the extension
.jp2.

Greg

 

On Aug 18, 2009, at 4:13 AM, Smart, Gary wrote:






I am trying 'gdal_translate  -of JPEG2000  thingy.ntf  thingy.j2k' but
GDAL complains that it doesn't understand the format thingy.j2k

I think its getting the arguments confused.  What am I doing wrong?

 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/f920c58a/attachment.html
From christian.mueller at nvoe.at  Wed Aug 19 07:04:03 2009
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Wed Aug 19 07:09:29 2009
Subject: [gdal-dev] Re: Flashy colors in a pyramid
In-Reply-To: <1250668297197-3470903.post@n2.nabble.com>
References: <1250668297197-3470903.post@n2.nabble.com>
Message-ID: <20090819110403.28673.qmail@mail.linux4all.at>

Hi, Christian speaking, I wrote the gdal_retile.py utility. 

Could you try to run a gdal_merge.py on the highest pyramid level containing 
this strange area. What is the result.?  I want to know if the problem is 
gdal_retile.py or geoserver. 

 

acangi writes: 

> 
> Hello list, 
> 
> I created a pyramid of aerial photos using gdal_retile.py and now see there
> are strange zones in the pyramid. I'm trying to understand why I got this
> strange results and how I can fix it (Bombing the area to make sure it looks
> like what I have ?). Description :
> 1. The command I used was gdal_retile.py -targetDir pyramid/ -levels 12
> -pyramidOnly -v -s_srs /path/to/prjs/3812.prj -ps 10000 10000 -r bilinear
> -co "TILED=YES" -co "COMPRESS=LZW" -co "INTERLEAVE=PIXEL" -tileIndex
> orthocol -tileIndexField location /path/to/source/files/*.tif &
> 2. In the source files, I see nothing special. The tiles in this area look
> like the other ones.
> 3. On the first (generated) level of the pyramid, I see a small area (alias
> SMALL_SQUARE : 256m x 256m) in blue :
> http://n2.nabble.com/file/n3470903/BlueSquare.jpg 
> 4. On the next levels of the pyramid, a black rectangle 512m x 256m is now
> visible where SMALL_SQUARE was : 
> http://n2.nabble.com/file/n3470903/BlackRect.jpg  
> and the area corresponding to the first level tile containing SMALL_SQUARE
> (alias BIG_SQUARE : 10000m x 10000m) is in green : 
> http://n2.nabble.com/file/n3470903/GreenSquare.jpg 
> 5. I view the pyramid in geoserver, the tiles look like they are on disk,
> except at the first level, geoserver doesn't show me the full SMALL_SQUARE,
> only parts of it. In geoserver logs, I find nothing very interesting, it all
> looks the same whether or not I'm looking at BIG_SQUARE.
> 6. If I set OutputTransparentColor to #000000 (the background color),
> BIG_SQUARE is now invisible (in geoserver) 
> 
> So, my questions are :
> Why did it happen ? I suppose it's just a random error...
> How can I fix it ? Is there any way other than rebuilding the whole pyramid
> ? 
> 
> Any idea is welcome, 
> 
> Alain
> -- 
> View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3470903.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From srikanth1947 at gmail.com  Wed Aug 19 07:28:44 2009
From: srikanth1947 at gmail.com (Srikanth)
Date: Wed Aug 19 07:28:47 2009
Subject: [gdal-dev] regarding GDALDriver::Create
In-Reply-To: <931f8ea90908140501y2b9a96aardd8923a4202f379e@mail.gmail.com>
References: <7a566dfe0908132359l141c9e9aoc9b606c650520570@mail.gmail.com>
	<931f8ea90908140501y2b9a96aardd8923a4202f379e@mail.gmail.com>
Message-ID: <7a566dfe0908190428k1f8011c4m4929fbf05ab7dd3a@mail.gmail.com>

Hi ,

Thanks for the mail Frank.

The problem is rightly pointed. In my case the dataset (poDataset) is not
getting created at times (parameters being the same) . I have checked
thoroughly everything related to this, but did not find any either solution
or problem.

I would appreciate if you can assist me solving this issue.

Regards,
Srikanth



On Fri, Aug 14, 2009 at 5:31 PM, Frank Warmerdam <warmerdam@pobox.com>wrote:

> On Fri, Aug 14, 2009 at 2:59 AM, Srikanth<srikanth1947@gmail.com> wrote:
> > Dear All,
> >
> > I am reading and writing raster images using GDAL. Below is the code
> which I
> > am using for writing a raster.
> > At times the code is working fine. But many a time , it is getting
> crashed
> > in the GetRasterBand. I have debugged the code several times and the
> > variables passed seems to be perfect. Any help in this is regard would be
> > appreciated.
> ...
> >    poDataset=NULL;
> >    poDataset = poDriver->Create(filename , width , height , numOfbands
> > ,(GDALDataType)datatype,NULL);
> >
> >    for(int i=0 ; i < numOfbands ; i++)
> >      {
> >              poBand[i] = poDataset->GetRasterBand(i+1);
> >       }
>
> Hi,
>
> I didn't see any showstopper problems in your code.  But
> the above code is not safe if the dataset creation fails.
> If the dataset creation fails, a null pointer will be returned
> and GetRasterBand() will fail - possibly crashing.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>



-- 
Regards,
Srikanth K.
www.servetheneedy.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/b46b1e6a/attachment-0001.html
From aca at ngi.be  Wed Aug 19 08:14:23 2009
From: aca at ngi.be (acangi)
Date: Wed Aug 19 08:14:25 2009
Subject: [Gdal-dev] Flashy colors in a pyramid
In-Reply-To: <20090819110403.28673.qmail@mail.linux4all.at>
References: <1250668297197-3470903.post@n2.nabble.com>
	<20090819110403.28673.qmail@mail.linux4all.at>
Message-ID: <1250684063228-3471888.post@n2.nabble.com>


Hi Christian,

Thanks for your reply and thanks for writing gdal_retile. I use it a lot and
it works great. 

I'm not sure I understand you well. On the highest level of the pyramid (the
top) there's only one file. Gdal_retile already created the files needed for
the mosaic (shp, shx, dbf and prj). Would you like me to re-create them ? 

Or do you mean at the base of the pyramid ? 

Alain 


Christian M?ller wrote:
> 
> Hi, Christian speaking, I wrote the gdal_retile.py utility. 
> 
> Could you try to run a gdal_merge.py on the highest pyramid level
> containing 
> this strange area. What is the result.?  I want to know if the problem is 
> gdal_retile.py or geoserver. 
> 
>  
> 
> acangi writes: 
> 
>> 
>> Hello list, 
>> 
>> I created a pyramid of aerial photos using gdal_retile.py and now see
>> there
>> are strange zones in the pyramid. I'm trying to understand why I got this
>> strange results and how I can fix it (Bombing the area to make sure it
>> looks
>> like what I have ?). Description :
>> 1. The command I used was gdal_retile.py -targetDir pyramid/ -levels 12
>> -pyramidOnly -v -s_srs /path/to/prjs/3812.prj -ps 10000 10000 -r bilinear
>> -co "TILED=YES" -co "COMPRESS=LZW" -co "INTERLEAVE=PIXEL" -tileIndex
>> orthocol -tileIndexField location /path/to/source/files/*.tif &
>> 2. In the source files, I see nothing special. The tiles in this area
>> look
>> like the other ones.
>> 3. On the first (generated) level of the pyramid, I see a small area
>> (alias
>> SMALL_SQUARE : 256m x 256m) in blue :
>> http://n2.nabble.com/file/n3470903/BlueSquare.jpg 
>> 4. On the next levels of the pyramid, a black rectangle 512m x 256m is
>> now
>> visible where SMALL_SQUARE was : 
>> http://n2.nabble.com/file/n3470903/BlackRect.jpg  
>> and the area corresponding to the first level tile containing
>> SMALL_SQUARE
>> (alias BIG_SQUARE : 10000m x 10000m) is in green : 
>> http://n2.nabble.com/file/n3470903/GreenSquare.jpg 
>> 5. I view the pyramid in geoserver, the tiles look like they are on disk,
>> except at the first level, geoserver doesn't show me the full
>> SMALL_SQUARE,
>> only parts of it. In geoserver logs, I find nothing very interesting, it
>> all
>> looks the same whether or not I'm looking at BIG_SQUARE.
>> 6. If I set OutputTransparentColor to #000000 (the background color),
>> BIG_SQUARE is now invisible (in geoserver) 
>> 
>> So, my questions are :
>> Why did it happen ? I suppose it's just a random error...
>> How can I fix it ? Is there any way other than rebuilding the whole
>> pyramid
>> ? 
>> 
>> Any idea is welcome, 
>> 
>> Alain
>> -- 
>> View this message in context:
>> http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3470903.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3471888.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From christian.mueller at nvoe.at  Wed Aug 19 08:34:23 2009
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Wed Aug 19 08:34:27 2009
Subject: [gdal-dev] Re: Flashy colors in a pyramid
In-Reply-To: <1250684063228-3471888.post@n2.nabble.com>
References: <1250668297197-3470903.post@n2.nabble.com>
	<20090819110403.28673.qmail@mail.linux4all.at>
	<1250684063228-3471888.post@n2.nabble.com>
Message-ID: <20090819123423.10659.qmail@mail.linux4all.at>

Hi 

The thing I want to know is if you have the blue or green areas in the 
output files of gdal_retile.py or if you see them when looking at the images 
with geoserver. So, is at problem of gdal_retile.py or of geoserver loading 
the output from gdal_retile.py. 

Btw, you use the option -co "TILED=YES". Why ?. Each output tile of 
gdal_retile.py has again tiles in it ? 

 

 


acangi writes: 

> 
> Hi Christian, 
> 
> Thanks for your reply and thanks for writing gdal_retile. I use it a lot and
> it works great.  
> 
> I'm not sure I understand you well. On the highest level of the pyramid (the
> top) there's only one file. Gdal_retile already created the files needed for
> the mosaic (shp, shx, dbf and prj). Would you like me to re-create them ?  
> 
> Or do you mean at the base of the pyramid ?  
> 
> Alain  
> 
> 
> Christian M?ller wrote:
>> 
>> Hi, Christian speaking, I wrote the gdal_retile.py utility.  
>> 
>> Could you try to run a gdal_merge.py on the highest pyramid level
>> containing 
>> this strange area. What is the result.?  I want to know if the problem is 
>> gdal_retile.py or geoserver.  
>> 
>>   
>> 
>> acangi writes:  
>> 
>>> 
>>> Hello list,  
>>> 
>>> I created a pyramid of aerial photos using gdal_retile.py and now see
>>> there
>>> are strange zones in the pyramid. I'm trying to understand why I got this
>>> strange results and how I can fix it (Bombing the area to make sure it
>>> looks
>>> like what I have ?). Description :
>>> 1. The command I used was gdal_retile.py -targetDir pyramid/ -levels 12
>>> -pyramidOnly -v -s_srs /path/to/prjs/3812.prj -ps 10000 10000 -r bilinear
>>> -co "TILED=YES" -co "COMPRESS=LZW" -co "INTERLEAVE=PIXEL" -tileIndex
>>> orthocol -tileIndexField location /path/to/source/files/*.tif &
>>> 2. In the source files, I see nothing special. The tiles in this area
>>> look
>>> like the other ones.
>>> 3. On the first (generated) level of the pyramid, I see a small area
>>> (alias
>>> SMALL_SQUARE : 256m x 256m) in blue :
>>> http://n2.nabble.com/file/n3470903/BlueSquare.jpg 
>>> 4. On the next levels of the pyramid, a black rectangle 512m x 256m is
>>> now
>>> visible where SMALL_SQUARE was : 
>>> http://n2.nabble.com/file/n3470903/BlackRect.jpg  
>>> and the area corresponding to the first level tile containing
>>> SMALL_SQUARE
>>> (alias BIG_SQUARE : 10000m x 10000m) is in green : 
>>> http://n2.nabble.com/file/n3470903/GreenSquare.jpg 
>>> 5. I view the pyramid in geoserver, the tiles look like they are on disk,
>>> except at the first level, geoserver doesn't show me the full
>>> SMALL_SQUARE,
>>> only parts of it. In geoserver logs, I find nothing very interesting, it
>>> all
>>> looks the same whether or not I'm looking at BIG_SQUARE.
>>> 6. If I set OutputTransparentColor to #000000 (the background color),
>>> BIG_SQUARE is now invisible (in geoserver)  
>>> 
>>> So, my questions are :
>>> Why did it happen ? I suppose it's just a random error...
>>> How can I fix it ? Is there any way other than rebuilding the whole
>>> pyramid
>>> ?  
>>> 
>>> Any idea is welcome,  
>>> 
>>> Alain
>>> -- 
>>> View this message in context:
>>> http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3470903.html
>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>   
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>> 
>> 
> 
> -- 
> View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3471888.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From aca at ngi.be  Wed Aug 19 09:20:35 2009
From: aca at ngi.be (acangi)
Date: Wed Aug 19 09:20:37 2009
Subject: [Gdal-dev] Flashy colors in a pyramid
In-Reply-To: <20090819123423.10659.qmail@mail.linux4all.at>
References: <1250668297197-3470903.post@n2.nabble.com>
	<20090819110403.28673.qmail@mail.linux4all.at>
	<1250684063228-3471888.post@n2.nabble.com>
	<20090819123423.10659.qmail@mail.linux4all.at>
Message-ID: <1250688035552-3472194.post@n2.nabble.com>



I see the same strange areas when I'm viewing the tiles with Irfanview, so geoserver is excluded. 

I re-created the first tile that gave me the problem (and only this tile) from the source files using gdal_retile and gdal_translate -projwin. The problem isn't there any more. So I guess it was only a random error ? I still need to recreate the higher tiles, if that works. 

Thanks for the tip on the option "TILED=YES". It comes from gdal_translate, I didn't think much when I started using gdal_retile. So I have no specific reason to use it and the output tiles of gdal_retile aren't tiled inside. 

Alain 

----- Mail Original ----- 
De: "Christian M?ller (via Nabble)" <ml-user+68004-9764870@n2.nabble.com> 
?: "acangi" <aca@ngi.be> 
Envoy?: Mercredi 19 Ao?t 2009 14h34:41 GMT +01:00 Amsterdam / Berlin / Berne / Rome / Stockholm / Vienne 
Objet: Re: [Gdal-dev] Flashy colors in a pyramid 

Hi 

The thing I want to know is if you have the blue or green areas in the 
output files of gdal_retile.py or if you see them when looking at the images 
with geoserver. So, is at problem of gdal_retile.py or of geoserver loading 
the output from gdal_retile.py. 

Btw, you use the option -co "TILED=YES". Why ?. Each output tile of 
gdal_retile.py has again tiles in it ? 






acangi writes: 


> 
> Hi Christian, 
> 
> Thanks for your reply and thanks for writing gdal_retile. I use it a lot and 
> it works great. 
> 
> I'm not sure I understand you well. On the highest level of the pyramid (the 
> top) there's only one file. Gdal_retile already created the files needed for 
> the mosaic (shp, shx, dbf and prj). Would you like me to re-create them ? 
> 
> Or do you mean at the base of the pyramid ? 
> 
> Alain 
> 
> 
> Christian M?ller wrote: 
>> 
>> Hi, Christian speaking, I wrote the gdal_retile.py utility. 
>> 
>> Could you try to run a gdal_merge.py on the highest pyramid level 
>> containing 
>> this strange area. What is the result.? I want to know if the problem is 
>> gdal_retile.py or geoserver. 
>> 
>> 
>> 
>> acangi writes: 
>> 
>>> 
>>> Hello list, 
>>> 
>>> I created a pyramid of aerial photos using gdal_retile.py and now see 
>>> there 
>>> are strange zones in the pyramid. I'm trying to understand why I got this 
>>> strange results and how I can fix it (Bombing the area to make sure it 
>>> looks 
>>> like what I have ?). Description : 
>>> 1. The command I used was gdal_retile.py -targetDir pyramid/ -levels 12 
>>> -pyramidOnly -v -s_srs /path/to/prjs/3812.prj -ps 10000 10000 -r bilinear 
>>> -co "TILED=YES" -co "COMPRESS=LZW" -co "INTERLEAVE=PIXEL" -tileIndex 
>>> orthocol -tileIndexField location /path/to/source/files/*.tif & 
>>> 2. In the source files, I see nothing special. The tiles in this area 
>>> look 
>>> like the other ones. 
>>> 3. On the first (generated) level of the pyramid, I see a small area 
>>> (alias 
>>> SMALL_SQUARE : 256m x 256m) in blue : 
>>> http://n2.nabble.com/file/n3470903/BlueSquare.jpg 
>>> 4. On the next levels of the pyramid, a black rectangle 512m x 256m is 
>>> now 
>>> visible where SMALL_SQUARE was : 
>>> http://n2.nabble.com/file/n3470903/BlackRect.jpg 
>>> and the area corresponding to the first level tile containing 
>>> SMALL_SQUARE 
>>> (alias BIG_SQUARE : 10000m x 10000m) is in green : 
>>> http://n2.nabble.com/file/n3470903/GreenSquare.jpg 
>>> 5. I view the pyramid in geoserver, the tiles look like they are on disk, 
>>> except at the first level, geoserver doesn't show me the full 
>>> SMALL_SQUARE, 
>>> only parts of it. In geoserver logs, I find nothing very interesting, it 
>>> all 
>>> looks the same whether or not I'm looking at BIG_SQUARE. 
>>> 6. If I set OutputTransparentColor to #000000 (the background color), 
>>> BIG_SQUARE is now invisible (in geoserver) 
>>> 
>>> So, my questions are : 
>>> Why did it happen ? I suppose it's just a random error... 
>>> How can I fix it ? Is there any way other than rebuilding the whole 
>>> pyramid 
>>> ? 
>>> 
>>> Any idea is welcome, 
>>> 
>>> Alain 
>>> -- 
>>> View this message in context: 
>>> http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3470903.html 
>>> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
>>> _______________________________________________ 
>>> gdal-dev mailing list 
>>> [hidden email] 
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>> 
>> 
>> _______________________________________________ 
>> gdal-dev mailing list 
>> [hidden email] 
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>> 
>> 
> 
> -- 
> View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3471888.html 
> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> _______________________________________________ 
> gdal-dev mailing list 
> [hidden email] 
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 

_______________________________________________ 
gdal-dev mailing list 
[hidden email] 
http://lists.osgeo.org/mailman/listinfo/gdal-dev 




View message @ http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3471969.html 
To unsubscribe from Re: Flashy colors in a pyramid, click here . 

-- 
View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3472194.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/f940e952/attachment.html
From proppy at aminche.com  Wed Aug 19 09:41:21 2009
From: proppy at aminche.com (Johan Euphrosine)
Date: Wed Aug 19 09:48:19 2009
Subject: [gdal-dev] map2geojson
Message-ID: <1250689281.18379.15.camel@yada>

Skipped content of type multipart/mixed-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/385637e5/attachment-0001.bin
From devrimbaris at gmail.com  Wed Aug 19 09:51:50 2009
From: devrimbaris at gmail.com (Devrim Baris Acar)
Date: Wed Aug 19 09:52:13 2009
Subject: [gdal-dev] losing elevation data
Message-ID: <ba11872d0908190651p39860188l704bad88a6632c05@mail.gmail.com>

Hi,
I am a newbie on gdal and gis so forgive me.

I have downloaded the geotiff elevation data  srtm30.7z from
http://worldwind28.arc.nasa.gov/public/WorldWindWMS/ . The file contains
elevation data for the globe. I want to change a a geotiff file from this
set to bil file format(hoping to use it in worldwind).

I use;

gdal_translate -of EHdr e020n40.Bathmetry.tif deneme.bil

It completes translation with no errors but when I open the file in free
tool ER Viewer it is pure black and white while the original contains tones
of gray.
It seems to have loss the granularity of data.

Why does this happen?
Thanks.
-- 
Devrim Baris Acar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/780a25c7/attachment.html
From warmerdam at pobox.com  Wed Aug 19 09:58:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 19 09:58:55 2009
Subject: [gdal-dev] losing elevation data
In-Reply-To: <ba11872d0908190651p39860188l704bad88a6632c05@mail.gmail.com>
References: <ba11872d0908190651p39860188l704bad88a6632c05@mail.gmail.com>
Message-ID: <4A8C0510.5040108@pobox.com>

Devrim Baris Acar wrote:
> Hi,
> I am a newbie on gdal and gis so forgive me.
> 
> I have downloaded the geotiff elevation data  srtm30.7z from 
> http://worldwind28.arc.nasa.gov/public/WorldWindWMS/ . The file contains 
> elevation data for the globe. I want to change a a geotiff file from 
> this set to bil file format(hoping to use it in worldwind).
> 
> I use;
> 
> gdal_translate -of EHdr e020n40.Bathmetry.tif deneme.bil
> 
> It completes translation with no errors but when I open the file in free 
> tool ER Viewer it is pure black and white while the original contains 
> tones of gray.
> It seems to have loss the granularity of data.

Devrim,

It looks like the source data is too large for me to practically download
and try.  Is one TIFF file (such as e020n40.Bathmetry.tif) more reasonable
sized?  Perhaps you could make it available for me to try?

The translation approach looks fine, but there is some lack of clarity in
how floating point vs. integer BIL files should be distinguished.  It may
be that ERViewer produces different results than ought to be the case.
You might want to try a GDAL based viewer such as OpenEV or QGIS on the
BIL dataset to see if it looks ok.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Aug 19 10:17:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 19 10:17:47 2009
Subject: [gdal-dev] regarding GDALDriver::Create
In-Reply-To: <7a566dfe0908190428k1f8011c4m4929fbf05ab7dd3a@mail.gmail.com>
References: <7a566dfe0908132359l141c9e9aoc9b606c650520570@mail.gmail.com>
	<931f8ea90908140501y2b9a96aardd8923a4202f379e@mail.gmail.com>
	<7a566dfe0908190428k1f8011c4m4929fbf05ab7dd3a@mail.gmail.com>
Message-ID: <4A8C0977.4030302@pobox.com>

Srikanth wrote:
> Hi ,
>  
> Thanks for the mail Frank.
>  
> The problem is rightly pointed. In my case the dataset (poDataset) is 
> not getting created at times (parameters being the same) . I have 
> checked thoroughly everything related to this, but did not find any 
> either solution or problem.
>  
> I would appreciate if you can assist me solving this issue.

Srikanth,

After a failed Create() operation you can call CPLGetLastErrorMsg() and display
the resulting string.  It should give some idea of what is going wrong.

In a normal console application you should also see this message emitted in
the console (stderr) automatically.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From randre at gmail.com  Wed Aug 19 18:18:42 2009
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Wed Aug 19 18:18:43 2009
Subject: [gdal-dev] Status of TMS minidriver in gdal_wms
Message-ID: <9c2015090908191518j6283bf87x19c0f474e6d4724e@mail.gmail.com>

Hi All,

I'd like to use GDAL to access tiles that have been generated by TileCache.
It appears this should be possible in GDAL 1.7 via the TMS service.  I
*think* the example at
http://www.gdal.org/frmt_wms_openstreetmap_tms.xmlshows this.

I'd appreciate it if someone could clarify whether my expectations are
reasonable regarding this, and whether this functionality can be enabled in
a pre-1.7 version of GDAL.

Thanks,

Roger
--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/c8c163c7/attachment.html
From randre at gmail.com  Thu Aug 20 01:08:43 2009
From: randre at gmail.com (=?UTF-8?B?Um9nZXIgQW5kcsOp?=)
Date: Thu Aug 20 01:08:45 2009
Subject: [gdal-dev] Re: Status of TMS minidriver in gdal_wms
In-Reply-To: <9c2015090908191518j6283bf87x19c0f474e6d4724e@mail.gmail.com>
References: <9c2015090908191518j6283bf87x19c0f474e6d4724e@mail.gmail.com>
Message-ID: <9c2015090908192208k2b806fa8y6e5a59bf36727d9d@mail.gmail.com>

I was able to get this to work using the patch checked in from the Toronto
code sprint. However, I still have questions.  I would like to take
advantage of the fact that I already have pre-rendered tiles in my
TileCache, but it seems that MapServer is still having to render all of the
requests that I'm making through the WMS service.  How can I use my
pre-existing TileCache tiles as the data source?  Do I need to match the
projection that they are created in when I make the request?  Do I need to
set resolution levels in the GDAL_WMS file?  I followed the syntax in the
OSM GDAL_WMS sample to make the requests work.

Thanks,

Roger
--

On Wed, Aug 19, 2009 at 3:18 PM, Roger Andr? <randre@gmail.com> wrote:

> Hi All,
>
> I'd like to use GDAL to access tiles that have been generated by
> TileCache.  It appears this should be possible in GDAL 1.7 via the TMS
> service.  I *think* the example at
> http://www.gdal.org/frmt_wms_openstreetmap_tms.xml shows this.
>
> I'd appreciate it if someone could clarify whether my expectations are
> reasonable regarding this, and whether this functionality can be enabled in
> a pre-1.7 version of GDAL.
>
> Thanks,
>
> Roger
> --
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090819/044c6d4a/attachment.html
From jukka.rahkonen at mmmtike.fi  Thu Aug 20 06:04:50 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu Aug 20 06:06:02 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu>
Message-ID: <loom.20090820T114441-892@post.gmane.org>

Hermann Peifer <peifer <at> gmx.eu> writes:

> 
> Jukka wrote

> > 
> > Did you try to use gdalwarp also for the second step with -srcnodata value
[value...]?  I believe you did set
> some NODATA value in step 1 for the intermediate images.
> > 
> > -Jukka Rahkonen- 
> 
> I did. However, the main problem with gdalwarp is its performance. So my
options seem to be:
> 
> 1.
> gdalwarping 1500 ASTER tiles in 1 run into a 4GB 100m raster output.tif
> = 5-10 days processing (my best estimate)
> 
> 2.
> gdalwarping 1500 ASTER tiles 1-by-1 as an intermediate step, then
> gdal_merge or gdal_translate to mosaic warped tiles into output.tif
> = smaller or larger NODATA areas in output.tif, along tile borders

Hi, 

I decided to do a little test in order to see how slow gdalwarp in in this kind
of usage with my own imagery. My test plan was like this:

1. Original images: 199 JPEG2000 images, with 3 bands and 10000 by 10000 pixels
each. All together make 28 gigabytes on disk in lossless JPEG2000 format, or 60
GB uncompressed.

2. My first try with gdalbuildvtr
gdalbuildvrt -input_file_list gdalwarptest.txt gdalwarptest.vrt
0...10...20...30...40...50...60...70...80...90...100 - done.
Nice experience, I like this little tool.

3. A try to make a tiff file from this virtual raster with gdalwarp
gdalwarp -co BIGTIFF=YES -srcnodata 0 gdalwarptest.vrt gdalwarptest.tif
Creating output file that is 182026P x 191204L.


Gdalwarp has now been running for 27 hours. Process is taking 70 megabytes of
memory and 5-15 percent of processor time. As a result I have now output tiff
file that is very, very slowly growing in size. Now, after 27-hour run the
filesize is 13 gigabytes. Judged by the filesize my new tiff file might be ready
after 4-5 more days.  However, I am not sure if this estimate is reliable. The
gdalwarp status indicator is still showing just zero for me:
Processing input file gdalwarptest.vrt.
0

Conclusion: Too slow to be useful with my settings.
Question 1: Should it work this way?
Question 2: If yes, is it worth trying to find the limits when it goes too slow
and perhaps file a ticket?

-Jukka Rahkonen-

From even.rouault at mines-paris.org  Thu Aug 20 06:39:59 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug 20 06:49:33 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <loom.20090820T114441-892@post.gmane.org>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
Message-ID: <1250764799.4a8d27ff422a1@imp.free.fr>

Quoting Jukka Rahkonen <jukka.rahkonen@mmmtike.fi>:

> Hermann Peifer <peifer <at> gmx.eu> writes:
>
> >
> > Jukka wrote
>
> > >
> > > Did you try to use gdalwarp also for the second step with -srcnodata
> value
> [value...]?  I believe you did set
> > some NODATA value in step 1 for the intermediate images.
> > >
> > > -Jukka Rahkonen-
> >
> > I did. However, the main problem with gdalwarp is its performance. So my
> options seem to be:
> >
> > 1.
> > gdalwarping 1500 ASTER tiles in 1 run into a 4GB 100m raster output.tif
> > = 5-10 days processing (my best estimate)
> >
> > 2.
> > gdalwarping 1500 ASTER tiles 1-by-1 as an intermediate step, then
> > gdal_merge or gdal_translate to mosaic warped tiles into output.tif
> > = smaller or larger NODATA areas in output.tif, along tile borders
>
> Hi,
>
> I decided to do a little test in order to see how slow gdalwarp in in this
> kind
> of usage with my own imagery. My test plan was like this:
>
> 1. Original images: 199 JPEG2000 images, with 3 bands and 10000 by 10000
> pixels
> each. All together make 28 gigabytes on disk in lossless JPEG2000 format, or
> 60
> GB uncompressed.
>
> 2. My first try with gdalbuildvtr
> gdalbuildvrt -input_file_list gdalwarptest.txt gdalwarptest.vrt
> 0...10...20...30...40...50...60...70...80...90...100 - done.
> Nice experience, I like this little tool.
>
> 3. A try to make a tiff file from this virtual raster with gdalwarp
> gdalwarp -co BIGTIFF=YES -srcnodata 0 gdalwarptest.vrt gdalwarptest.tif
> Creating output file that is 182026P x 191204L.
>
>
> Gdalwarp has now been running for 27 hours. Process is taking 70 megabytes of
> memory and 5-15 percent of processor time. As a result I have now output tiff
> file that is very, very slowly growing in size. Now, after 27-hour run the
> filesize is 13 gigabytes. Judged by the filesize my new tiff file might be
> ready
> after 4-5 more days.  However, I am not sure if this estimate is reliable.
> The
> gdalwarp status indicator is still showing just zero for me:
> Processing input file gdalwarptest.vrt.
> 0
>
> Conclusion: Too slow to be useful with my settings.
> Question 1: Should it work this way?
> Question 2: If yes, is it worth trying to find the limits when it goes too
> slow
> and perhaps file a ticket?

Jukka, you can probably speed up considerably the gdalwarp process by adding
"-co TILED=YES" to the gdalwarp commandline. For such a big output file, using
the default stripped structure of a TIFF will be very inefficient because the
way gdalwarp proceeds (by sort of tiles) causes a lot of cache thrashing and
I/O. A little of tuning with the "-wm XXX", "-config GDAL_CACHEMAX YYY" and
-multi options might also help.

>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From Jukka.Rahkonen at mmmtike.fi  Thu Aug 20 07:32:29 2009
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Thu Aug 20 07:32:33 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <1250764799.4a8d27ff422a1@imp.free.fr>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
	<1250764799.4a8d27ff422a1@imp.free.fr>
Message-ID: <CC197224AC75CE4DB23F739B16891B86F734E2@tikka.haapa.mmm.fi>

Even Rouault wrote:
 
> Quoting Jukka Rahkonen <jukka.rahkonen@mmmtike.fi>:
> 
> > Hermann Peifer <peifer <at> gmx.eu> writes:
> >
> > >
> > > Jukka wrote
> >
> > > >
> > > > Did you try to use gdalwarp also for the second step with 
> > > > -srcnodata
> > value
> > [value...]?  I believe you did set
> > > some NODATA value in step 1 for the intermediate images.
> > > >
> > > > -Jukka Rahkonen-
> > >
> > > I did. However, the main problem with gdalwarp is its 
> performance. 
> > > So my
> > options seem to be:
> > >
> > > 1.
> > > gdalwarping 1500 ASTER tiles in 1 run into a 4GB 100m raster 
> > > output.tif = 5-10 days processing (my best estimate)
> > >
> > > 2.
> > > gdalwarping 1500 ASTER tiles 1-by-1 as an intermediate step, then 
> > > gdal_merge or gdal_translate to mosaic warped tiles into 
> output.tif 
> > > = smaller or larger NODATA areas in output.tif, along tile borders
> >
> > Hi,
> >
> > I decided to do a little test in order to see how slow 
> gdalwarp in in 
> > this kind of usage with my own imagery. My test plan was like this:
> >
> > 1. Original images: 199 JPEG2000 images, with 3 bands and 10000 by 
> > 10000 pixels each. All together make 28 gigabytes on disk 
> in lossless 
> > JPEG2000 format, or 60 GB uncompressed.
> >
> > 2. My first try with gdalbuildvtr
> > gdalbuildvrt -input_file_list gdalwarptest.txt gdalwarptest.vrt 
> > 0...10...20...30...40...50...60...70...80...90...100 - done.
> > Nice experience, I like this little tool.
> >
> > 3. A try to make a tiff file from this virtual raster with gdalwarp 
> > gdalwarp -co BIGTIFF=YES -srcnodata 0 gdalwarptest.vrt 
> > gdalwarptest.tif Creating output file that is 182026P x 191204L.
> >
> >
> > Gdalwarp has now been running for 27 hours. Process is taking 70 
> > megabytes of memory and 5-15 percent of processor time. As 
> a result I 
> > have now output tiff file that is very, very slowly growing 
> in size. 
> > Now, after 27-hour run the filesize is 13 gigabytes. Judged by the 
> > filesize my new tiff file might be ready after 4-5 more days.  
> > However, I am not sure if this estimate is reliable.
> > The
> > gdalwarp status indicator is still showing just zero for me:
> > Processing input file gdalwarptest.vrt.
> > 0
> >
> > Conclusion: Too slow to be useful with my settings.
> > Question 1: Should it work this way?
> > Question 2: If yes, is it worth trying to find the limits 
> when it goes 
> > too slow and perhaps file a ticket?
> 
> Jukka, you can probably speed up considerably the gdalwarp 
> process by adding "-co TILED=YES" to the gdalwarp 
> commandline. For such a big output file, using the default 
> stripped structure of a TIFF will be very inefficient because 
> the way gdalwarp proceeds (by sort of tiles) causes a lot of 
> cache thrashing and I/O. A little of tuning with the "-wm 
> XXX", "-config GDAL_CACHEMAX YYY" and -multi options might also help.

I can have a try. I want to change just on option at a time and now it
is running with -co TILED=YES option. I will see tomorrow how did it do.
Now I can say just that in the beginning things looked much better.
Memory consumption and processor load were much higher and disk unit
went more silently. But after some half an hour the conversion  seems to
have almost stopped at 2,302,729,094 bytes output file size.  Gdalwarp
reserves 390 megabytes of memory and utilises 5-15 percent of processor
time.

Can you suggest any reasonable values for other parameters? This old
machine is running on Windows XP Pro and it has only 1 GB memory and one
3 GHz processor.
I do not have myself a real need for making large mosaics through .vrt
files at the moment, but as the set-up is ready and the computer
otherwise idle I can well let it run and gather some hopefully
comparable numbers. I have also a bit more powerful computer with 8
cores that I can use for final run if there is a reason to believe that
gdalwarp can do the job with some settings. I guess -multi stands for
multithreading and it may suit well the 8-core system.

-Jukka-
From nicolas.simon at spw.wallonie.be  Thu Aug 20 08:00:30 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Thu Aug 20 08:00:39 2009
Subject: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
In-Reply-To: <8C7DAE7B21100F4CABDD600FAAD339D003C4B61B@DGA-EXC01.mrw.wallonie.int>
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B690@DGA-EXC01.mrw.wallonie.int>

Hello,<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" />

 

    I've installed my Python environment successfully. Now I would like to test the autotest 

 

     <http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py> http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py

 

    but in the function ogr_oci_10() the 'expected_wkt' include a third dimension for a 2D feature. Think that I would like to fixe with my patches.

 

   so I would like to replace 

        expected_wkt = 'POLYGON ((1 1 0,5 1 0,5 7 0,1 7 0,1 1 0))' 

   by

        expected_wkt = 'POLYGON ((1 1,5 1,5 7,1 7,1 1))'

   Which is beter for a 2D geometry.

 

   Is this change wished or does it create incompatibilities ? 

 

  nb. This is also the case in ogr_oci_14() for LINESTRING and in ogr_oci_15().

 

  By the way, is there an svn access to autotest ?

 

  Nicolas

-----Message d'origine-----
De : Nicolas Simon 
Envoy? : mercredi 5 ao?t 2009 17:04
? : Nicolas Simon
Objet : RE: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension



Hi all,
    I provide a patch file against main trunk to solve the second point (read interpretation), attached with Ticket #3025 (file OCIRead3025.diff)
 
    Can anyone who use Oracle can provide me a feedback ?
 
    Thanks.
 
    Nicolas

-----Message d'origine-----
De : gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org]De la part de Nicolas Simon
Envoy? : mercredi 5 ao?t 2009 14:55
? : gdal-dev@lists.osgeo.org
Objet : [gdal-dev] OGR OCI Driver improvement about CoordinateDimension



Dear developpers, 

This problem is not actually well handled when we use feature with 2D and 3D coordinate. 
(I provide test file with  Ticket #3025)  

1) When we WRITE data into Oracle, TranslateTOSDOGeometry() and TranslateElemGroup() 
   use nDimension member variable of OCIWritableLayer to handle the translation. 
   Unfortunaly nDimension initisation is 
   nDimension = MAX(2,MIN(3,atoi(CPLGetConfigOption("OCI_DEFAULT_DIM","3")))); 
   which is good when creating layer but not if we update feature table and 
   if we have different feature table with different dimension 
   (OCI_DEFAULT_DIM cannot be set to handle both 2D and 3D simultanously). 

   The solution is to query ALL_SDO_GEOM_METADATA to get the dimension of existing table and 
   overwrite the default value. 

   The best place I found to put this check is in OGROCITableLayer::ReadTableDefinition() because it does not concern OGROCILoaderLayer.

   I attach the patch to Ticket #3025  (file is OCIWrite3025.diff ) 
    
2) When we READ data from Oracle, TranslateGeometry() and TranslateGeometryElement() take the dimension 
   from Gtype of the SDO_GEOMETRY (That's right). 
The dimension is well used in decoding sdo_ordinates (see GetOrdinalPoint for exemple). 
The problem is when we create OGRGeometry because it always construct 3D geometry even if we have 2D geometry. 

For exemple (in TranslateGeometryElement()) 

    ... 
    double dfX, dfY, dfZ = 0.0; 

    GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 

    poPoint->setX( dfX ); 
    poPoint->setY( dfY ); 
    poPoint->setZ( dfZ ); 

 Many strategies exist to fix this problem. 

The simplest one is to force to 2D if dimension = 2 before returning from TranslateGeometry() but this solution does a lot of extra work (building a dummy 3D and deleting the 3rd dimension)

To apply this solution a call to Flatten2D maintains the Z dimention but set it to 0. Not the solution I would like => Bad solution

An other way is to call setCoordinateDimension() but the doc says "Setting the dimension of a geometry collection will not necessarily affect the children geometries.". Not a definitive solution.

My conclusion is that I should insert test on dimension when creating the geometry to prevent the cretion of a 3rd dimension.

For exemple (in TranslateGeometryElement()) 

    ... 
    double dfX, dfY, dfZ = 0.0; 

    GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 

    poPoint->setX( dfX ); 
    poPoint->setY( dfY ); 
    if ( nDimension>2 ) poPoint->setZ( dfZ ); 

If you agree with this last strategie, I would provide a patch with this kind of test for all geometries created in TranslateGeometry() 

    Note: The test "nDimension>2" seems beter than "nDimension=3" because if SDO_GEOMETRY is 4 (permitted), we will generate a 3D OGRGeometry insteed of a 2D. 

    Best regards, 

    Nicolas 

==================================================
Nicolas Simon, Informaticien 
Service Public de Wallonie (SPW) 
Direction g?n?rale op?rationnelle Agriculture, Ressources Naturelles et Environnement (DGARNE) 
D?partement des Aides 
Direction de l'Octroi des Aides agricoles - Service Informatique 
14, Chauss?e de Louvain - 4e ?tage
5000 Namur
BELGIUM 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090820/b8f40fa0/attachment-0001.html
From even.rouault at mines-paris.org  Thu Aug 20 08:10:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug 20 08:10:11 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <CC197224AC75CE4DB23F739B16891B86F734E2@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
	<1250764799.4a8d27ff422a1@imp.free.fr>
	<CC197224AC75CE4DB23F739B16891B86F734E2@tikka.haapa.mmm.fi>
Message-ID: <1250770209.4a8d3d218119f@imp.free.fr>

Quoting Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi>:
> >
> > Jukka, you can probably speed up considerably the gdalwarp
> > process by adding "-co TILED=YES" to the gdalwarp
> > commandline. For such a big output file, using the default
> > stripped structure of a TIFF will be very inefficient because
> > the way gdalwarp proceeds (by sort of tiles) causes a lot of
> > cache thrashing and I/O. A little of tuning with the "-wm
> > XXX", "-config GDAL_CACHEMAX YYY" and -multi options might also help.
>
> I can have a try. I want to change just on option at a time and now it
> is running with -co TILED=YES option. I will see tomorrow how did it do.
> Now I can say just that in the beginning things looked much better.
> Memory consumption and processor load were much higher and disk unit
> went more silently. But after some half an hour the conversion  seems to
> have almost stopped at 2,302,729,094 bytes output file size.  Gdalwarp
> reserves 390 megabytes of memory and utilises 5-15 percent of processor
> time.

I have no explanation in mind why it seems to have stalled at 2.3 GB. I would
let it go and see what happens a few hours after.

>
> Can you suggest any reasonable values for other parameters? This old
> machine is running on Windows XP Pro and it has only 1 GB memory and one
> 3 GHz processor.

The -wm defaults to 64 MB and GDAL_CACHEMAX to 40 MB. So increasing both to 300
for example might work (it will let 1000-2*300=400 MB for the rest of the OS and
other buffers of gdalwarp). If you see the computer starts swapping, those
values should be reduced. See http://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp
for a discussion on those parameters.

> I do not have myself a real need for making large mosaics through .vrt
> files at the moment, but as the set-up is ready and the computer
> otherwise idle I can well let it run and gather some hopefully
> comparable numbers. I have also a bit more powerful computer with 8
> cores that I can use for final run if there is a reason to believe that
> gdalwarp can do the job with some settings. I guess -multi stands for
> multithreading and it may suit well the 8-core system.

-multi can also be helpfull with a single core system. It uses a thread for I/O
and another one for computation. The I/O thread is mostly I/O bound and doesn't
generally consumes much CPU, except if you use a compressed input or output file
(which might be the case with your JP2K data). But having more than 2 cores
won't help much.

>
> -Jukka-
>


From P.Halls at york.ac.uk  Thu Aug 20 08:17:27 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Thu Aug 20 08:17:32 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <1250770209.4a8d3d218119f@imp.free.fr>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>
	<loom.20090820T114441-892@post.gmane.org>	<1250764799.4a8d27ff422a1@imp.free.fr>	<CC197224AC75CE4DB23F739B16891B86F734E2@tikka.haapa.mmm.fi>
	<1250770209.4a8d3d218119f@imp.free.fr>
Message-ID: <4A8D3ED7.2000006@york.ac.uk>

Just a thought, but 2.3GB is remarkably like the maximum size of a positive 
32bit integer.  Is the file being written on Windows or some other 32bit system?

Peter

Even Rouault wrote:
> Quoting Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi>:
>>> Jukka, you can probably speed up considerably the gdalwarp
>>> process by adding "-co TILED=YES" to the gdalwarp
>>> commandline. For such a big output file, using the default
>>> stripped structure of a TIFF will be very inefficient because
>>> the way gdalwarp proceeds (by sort of tiles) causes a lot of
>>> cache thrashing and I/O. A little of tuning with the "-wm
>>> XXX", "-config GDAL_CACHEMAX YYY" and -multi options might also help.
>> I can have a try. I want to change just on option at a time and now it
>> is running with -co TILED=YES option. I will see tomorrow how did it do.
>> Now I can say just that in the beginning things looked much better.
>> Memory consumption and processor load were much higher and disk unit
>> went more silently. But after some half an hour the conversion  seems to
>> have almost stopped at 2,302,729,094 bytes output file size.  Gdalwarp
>> reserves 390 megabytes of memory and utilises 5-15 percent of processor
>> time.
> 
> I have no explanation in mind why it seems to have stalled at 2.3 GB. I would
> let it go and see what happens a few hours after.
> 
>> Can you suggest any reasonable values for other parameters? This old
>> machine is running on Windows XP Pro and it has only 1 GB memory and one
>> 3 GHz processor.
> 
> The -wm defaults to 64 MB and GDAL_CACHEMAX to 40 MB. So increasing both to 300
> for example might work (it will let 1000-2*300=400 MB for the rest of the OS and
> other buffers of gdalwarp). If you see the computer starts swapping, those
> values should be reduced. See http://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp
> for a discussion on those parameters.
> 
>> I do not have myself a real need for making large mosaics through .vrt
>> files at the moment, but as the set-up is ready and the computer
>> otherwise idle I can well let it run and gather some hopefully
>> comparable numbers. I have also a bit more powerful computer with 8
>> cores that I can use for final run if there is a reason to believe that
>> gdalwarp can do the job with some settings. I guess -multi stands for
>> multithreading and it may suit well the 8-core system.
> 
> -multi can also be helpfull with a single core system. It uses a thread for I/O
> and another one for computation. The I/O thread is mostly I/O bound and doesn't
> generally consumes much CPU, except if you use a compressed input or output file
> (which might be the case with your JP2K data). But having more than 2 cores
> won't help much.
> 
>> -Jukka-
>>
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From P.Halls at york.ac.uk  Thu Aug 20 08:25:18 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Thu Aug 20 08:25:27 2009
Subject: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
In-Reply-To: <8C7DAE7B21100F4CABDD600FAAD339D003C4B690@DGA-EXC01.mrw.wallonie.int>
References: <8C7DAE7B21100F4CABDD600FAAD339D003C4B690@DGA-EXC01.mrw.wallonie.int>
Message-ID: <4A8D40AE.1090803@york.ac.uk>

Nicolas,

    I think that the default geometry for OCI is 3 dimensions (Oracle), but the 
number of dimensions is stored in the mdsys_geom_metadata table entry for the 
table.  If you are opening an existing table, the OCI driver should set the 
geometry from the metadata; it is specified to OGR when creating a table anyway.

    What should you do?  Well, unless you operate in a flat world, with no 
elevation ever to be recorded in your data, you probably ought to respect that 
tables may have either 2 or 3 dimensioned coordinates.  Ideally, read the 
information for an existing table and set up to read accordingly.  I think that, 
if you use OCI to specify three dimensioned coordinates when the table only has 
two, OGR returns a zero Z value, rather than an error.  That seems to be the 
right approach to me.

Best wishes,

Peter

Nicolas Simon wrote:
> Hello,<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" />
> 
>  
> 
>     I've installed my Python environment successfully. Now I would like to test the autotest 
> 
>  
> 
>      <http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py> http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py
> 
>  
> 
>     but in the function ogr_oci_10() the 'expected_wkt' include a third dimension for a 2D feature. Think that I would like to fixe with my patches.
> 
>  
> 
>    so I would like to replace 
> 
>         expected_wkt = 'POLYGON ((1 1 0,5 1 0,5 7 0,1 7 0,1 1 0))' 
> 
>    by
> 
>         expected_wkt = 'POLYGON ((1 1,5 1,5 7,1 7,1 1))'
> 
>    Which is beter for a 2D geometry.
> 
>  
> 
>    Is this change wished or does it create incompatibilities ? 
> 
>  
> 
>   nb. This is also the case in ogr_oci_14() for LINESTRING and in ogr_oci_15().
> 
>  
> 
>   By the way, is there an svn access to autotest ?
> 
>  
> 
>   Nicolas
> 
> -----Message d'origine-----
> De : Nicolas Simon 
> Envoy? : mercredi 5 ao?t 2009 17:04
> ? : Nicolas Simon
> Objet : RE: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
> 
> 
> 
> Hi all,
>     I provide a patch file against main trunk to solve the second point (read interpretation), attached with Ticket #3025 (file OCIRead3025.diff)
>  
>     Can anyone who use Oracle can provide me a feedback ?
>  
>     Thanks.
>  
>     Nicolas
> 
> -----Message d'origine-----
> De : gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org]De la part de Nicolas Simon
> Envoy? : mercredi 5 ao?t 2009 14:55
> ? : gdal-dev@lists.osgeo.org
> Objet : [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
> 
> 
> 
> Dear developpers, 
> 
> This problem is not actually well handled when we use feature with 2D and 3D coordinate. 
> (I provide test file with  Ticket #3025)  
> 
> 1) When we WRITE data into Oracle, TranslateTOSDOGeometry() and TranslateElemGroup() 
>    use nDimension member variable of OCIWritableLayer to handle the translation. 
>    Unfortunaly nDimension initisation is 
>    nDimension = MAX(2,MIN(3,atoi(CPLGetConfigOption("OCI_DEFAULT_DIM","3")))); 
>    which is good when creating layer but not if we update feature table and 
>    if we have different feature table with different dimension 
>    (OCI_DEFAULT_DIM cannot be set to handle both 2D and 3D simultanously). 
> 
>    The solution is to query ALL_SDO_GEOM_METADATA to get the dimension of existing table and 
>    overwrite the default value. 
> 
>    The best place I found to put this check is in OGROCITableLayer::ReadTableDefinition() because it does not concern OGROCILoaderLayer.
> 
>    I attach the patch to Ticket #3025  (file is OCIWrite3025.diff ) 
>     
> 2) When we READ data from Oracle, TranslateGeometry() and TranslateGeometryElement() take the dimension 
>    from Gtype of the SDO_GEOMETRY (That's right). 
> The dimension is well used in decoding sdo_ordinates (see GetOrdinalPoint for exemple). 
> The problem is when we create OGRGeometry because it always construct 3D geometry even if we have 2D geometry. 
> 
> For exemple (in TranslateGeometryElement()) 
> 
>     ... 
>     double dfX, dfY, dfZ = 0.0; 
> 
>     GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 
> 
>     poPoint->setX( dfX ); 
>     poPoint->setY( dfY ); 
>     poPoint->setZ( dfZ ); 
> 
>  Many strategies exist to fix this problem. 
> 
> The simplest one is to force to 2D if dimension = 2 before returning from TranslateGeometry() but this solution does a lot of extra work (building a dummy 3D and deleting the 3rd dimension)
> 
> To apply this solution a call to Flatten2D maintains the Z dimention but set it to 0. Not the solution I would like => Bad solution
> 
> An other way is to call setCoordinateDimension() but the doc says "Setting the dimension of a geometry collection will not necessarily affect the children geometries.". Not a definitive solution.
> 
> My conclusion is that I should insert test on dimension when creating the geometry to prevent the cretion of a 3rd dimension.
> 
> For exemple (in TranslateGeometryElement()) 
> 
>     ... 
>     double dfX, dfY, dfZ = 0.0; 
> 
>     GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 
> 
>     poPoint->setX( dfX ); 
>     poPoint->setY( dfY ); 
>     if ( nDimension>2 ) poPoint->setZ( dfZ ); 
> 
> If you agree with this last strategie, I would provide a patch with this kind of test for all geometries created in TranslateGeometry() 
> 
>     Note: The test "nDimension>2" seems beter than "nDimension=3" because if SDO_GEOMETRY is 4 (permitted), we will generate a 3D OGRGeometry insteed of a 2D. 
> 
>     Best regards, 
> 
>     Nicolas 
> 
> ==================================================
> Nicolas Simon, Informaticien 
> Service Public de Wallonie (SPW) 
> Direction g?n?rale op?rationnelle Agriculture, Ressources Naturelles et Environnement (DGARNE) 
> D?partement des Aides 
> Direction de l'Octroi des Aides agricoles - Service Informatique 
> 14, Chauss?e de Louvain - 4e ?tage
> 5000 Namur
> BELGIUM 
> 
> 
> 
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From aca at ngi.be  Thu Aug 20 08:58:33 2009
From: aca at ngi.be (acangi)
Date: Thu Aug 20 08:58:34 2009
Subject: [Gdal-dev] Flashy colors in a pyramid
In-Reply-To: <1250688035552-3472194.post@n2.nabble.com>
References: <1250668297197-3470903.post@n2.nabble.com>
	<20090819110403.28673.qmail@mail.linux4all.at>
	<1250684063228-3471888.post@n2.nabble.com>
	<20090819123423.10659.qmail@mail.linux4all.at>
	<1250688035552-3472194.post@n2.nabble.com>
Message-ID: <1250773113150-3478873.post@n2.nabble.com>



acangi wrote:
> 
> I re-created the first tile that gave me the problem (and only this tile)
> from the source files using gdal_retile and gdal_translate -projwin. The
> problem isn't there any more. [...] I still need to recreate the higher
> tiles, if that works. 
> 

Using gdal_retile step by step for re-creating the higher tiles works fine. 
In a few monthes, I'd like to be able to do this on an automated way. The
source (geotiff) files I used to create the pyramid will be updated, and
I'll need to update the pyramids (and the cache). Maybe the best way is to
re-create the whole pyramid, but as this took me 10 days, I'd prefer to just
update the tiles above the ones that changed. Is there a tool that already
does that ? Or should I write a script herefor ?

In the latter case, do you know a way to query a mosaic shapefile with
coordinates to get the name of the geotiff file that includes this
coordinates ?
-- 
View this message in context: http://n2.nabble.com/Flashy-colors-in-a-pyramid-tp3470903p3478873.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From nicolas.simon at spw.wallonie.be  Thu Aug 20 09:35:21 2009
From: nicolas.simon at spw.wallonie.be (Nicolas Simon)
Date: Thu Aug 20 09:35:29 2009
Subject: [gdal-dev] OGR OCI Driver improvement about CoordinateDimension
In-Reply-To: <4A8D40AE.1090803@york.ac.uk>
Message-ID: <8C7DAE7B21100F4CABDD600FAAD339D003C4B695@DGA-EXC01.mrw.wallonie.int>

Peter,

> -----Message d'origine-----
> De : Peter J Halls [mailto:P.Halls@york.ac.uk]
> Envoy? : jeudi 20 ao?t 2009 14:25
> ? : Nicolas Simon
> Cc : gdal-dev@lists.osgeo.org
> Objet : Re: [gdal-dev] OGR OCI Driver improvement about
> CoordinateDimension
> 
> 
> Nicolas,
> 
>     I think that the default geometry for OCI is 3 dimensions 
> (Oracle), but the 
> number of dimensions is stored in the mdsys_geom_metadata 
> table entry for the 
> table.  If you are opening an existing table, the OCI driver 
> should set the 
> geometry from the metadata; it is specified to OGR when 
> creating a table anyway.

     There is no default dimension in Oracle, but when creating Oracle table through OGR,
     OGR uses 3 unless OCI_DEFAULT_DIM is specified.
     nDimension = MAX(2,MIN(3,atoi(CPLGetConfigOption("OCI_DEFAULT_DIM","3"))));

     You are right when saying that dimension can be found in mdsys_geom_metadata

     In my case, I have table with 2D and other with 3D.
     I agree with you when you said that the OCI driver should set the geometry from the metadata.

     But this is not the case unless you apply the patch I submit.
    
> 
>     What should you do?  Well, unless you operate in a flat 
> world, with no 
> elevation ever to be recorded in your data, you probably 
> ought to respect that 
> tables may have either 2 or 3 dimensioned coordinates.  
> Ideally, read the 
> information for an existing table and set up to read 
> accordingly.  I think that, 
> if you use OCI to specify three dimensioned coordinates when 
> the table only has 
> two, OGR returns a zero Z value, rather than an error.  That 
> seems to be the 
> right approach to me.
> 

  What I propose with the patch, is to return a valid Z value when we read from a 3D table and 
no Z value we read from a 2D table. 

  Unfortunaly, autotest create a 2D table and check a zero Z value.

  So patch for the code and autotest (not yet provided) should by apply simultaneously.	
 
> Best wishes,
> 
> Peter
> 

 Best wishes,

 Nicolas

> Nicolas Simon wrote:
> > Hello,<?xml:namespace prefix = o ns = 
> "urn:schemas-microsoft-com:office:office" />
> > 
> >  
> > 
> >     I've installed my Python environment successfully. Now 
> I would like to test the autotest 
> > 
> >  
> > 
> >      
> <http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py> 
> http://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_oci.py
> > 
> >  
> > 
> >     but in the function ogr_oci_10() the 'expected_wkt' 
> include a third dimension for a 2D feature. Think that I 
> would like to fixe with my patches.
> > 
> >  
> > 
> >    so I would like to replace 
> > 
> >         expected_wkt = 'POLYGON ((1 1 0,5 1 0,5 7 0,1 7 0,1 1 0))' 
> > 
> >    by
> > 
> >         expected_wkt = 'POLYGON ((1 1,5 1,5 7,1 7,1 1))'
> > 
> >    Which is beter for a 2D geometry.
> > 
> >  
> > 
> >    Is this change wished or does it create incompatibilities ? 
> > 
> >  
> > 
> >   nb. This is also the case in ogr_oci_14() for LINESTRING 
> and in ogr_oci_15().
> > 
> >  
> > 
> >   By the way, is there an svn access to autotest ?
> > 
> >  
> > 
> >   Nicolas
> > 
> > -----Message d'origine-----
> > De : Nicolas Simon 
> > Envoy? : mercredi 5 ao?t 2009 17:04
> > ? : Nicolas Simon
> > Objet : RE: [gdal-dev] OGR OCI Driver improvement about 
> CoordinateDimension
> > 
> > 
> > 
> > Hi all,
> >     I provide a patch file against main trunk to solve the 
> second point (read interpretation), attached with Ticket 
> #3025 (file OCIRead3025.diff)
> >  
> >     Can anyone who use Oracle can provide me a feedback ?
> >  
> >     Thanks.
> >  
> >     Nicolas
> > 
> > -----Message d'origine-----
> > De : gdal-dev-bounces@lists.osgeo.org 
> [mailto:gdal-dev-bounces@lists.osgeo.org]De la part de Nicolas Simon
> > Envoy? : mercredi 5 ao?t 2009 14:55
> > ? : gdal-dev@lists.osgeo.org
> > Objet : [gdal-dev] OGR OCI Driver improvement about 
> CoordinateDimension
> > 
> > 
> > 
> > Dear developpers, 
> > 
> > This problem is not actually well handled when we use 
> feature with 2D and 3D coordinate. 
> > (I provide test file with  Ticket #3025)  
> > 
> > 1) When we WRITE data into Oracle, TranslateTOSDOGeometry() 
> and TranslateElemGroup() 
> >    use nDimension member variable of OCIWritableLayer to 
> handle the translation. 
> >    Unfortunaly nDimension initisation is 
> >    nDimension = 
> MAX(2,MIN(3,atoi(CPLGetConfigOption("OCI_DEFAULT_DIM","3")))); 
> >    which is good when creating layer but not if we update 
> feature table and 
> >    if we have different feature table with different dimension 
> >    (OCI_DEFAULT_DIM cannot be set to handle both 2D and 3D 
> simultanously). 
> > 
> >    The solution is to query ALL_SDO_GEOM_METADATA to get 
> the dimension of existing table and 
> >    overwrite the default value. 
> > 
> >    The best place I found to put this check is in 
> OGROCITableLayer::ReadTableDefinition() because it does not 
> concern OGROCILoaderLayer.
> > 
> >    I attach the patch to Ticket #3025  (file is OCIWrite3025.diff ) 
> >     
> > 2) When we READ data from Oracle, TranslateGeometry() and 
> TranslateGeometryElement() take the dimension 
> >    from Gtype of the SDO_GEOMETRY (That's right). 
> > The dimension is well used in decoding sdo_ordinates (see 
> GetOrdinalPoint for exemple). 
> > The problem is when we create OGRGeometry because it always 
> construct 3D geometry even if we have 2D geometry. 
> > 
> > For exemple (in TranslateGeometryElement()) 
> > 
> >     ... 
> >     double dfX, dfY, dfZ = 0.0; 
> > 
> >     GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 
> > 
> >     poPoint->setX( dfX ); 
> >     poPoint->setY( dfY ); 
> >     poPoint->setZ( dfZ ); 
> > 
> >  Many strategies exist to fix this problem. 
> > 
> > The simplest one is to force to 2D if dimension = 2 before 
> returning from TranslateGeometry() but this solution does a 
> lot of extra work (building a dummy 3D and deleting the 3rd dimension)
> > 
> > To apply this solution a call to Flatten2D maintains the Z 
> dimention but set it to 0. Not the solution I would like => 
> Bad solution
> > 
> > An other way is to call setCoordinateDimension() but the 
> doc says "Setting the dimension of a geometry collection will 
> not necessarily affect the children geometries.". Not a 
> definitive solution.
> > 
> > My conclusion is that I should insert test on dimension 
> when creating the geometry to prevent the cretion of a 3rd dimension.
> > 
> > For exemple (in TranslateGeometryElement()) 
> > 
> >     ... 
> >     double dfX, dfY, dfZ = 0.0; 
> > 
> >     GetOrdinalPoint( nStartOrdinal, nDimension, &dfX, &dfY, &dfZ ); 
> > 
> >     poPoint->setX( dfX ); 
> >     poPoint->setY( dfY ); 
> >     if ( nDimension>2 ) poPoint->setZ( dfZ ); 
> > 
> > If you agree with this last strategie, I would provide a 
> patch with this kind of test for all geometries created in 
> TranslateGeometry() 
> > 
> >     Note: The test "nDimension>2" seems beter than 
> "nDimension=3" because if SDO_GEOMETRY is 4 (permitted), we 
> will generate a 3D OGRGeometry insteed of a 2D. 
> > 
> >     Best regards, 
> > 
> >     Nicolas 
> > 
> > ==================================================
> > Nicolas Simon, Informaticien 
> > Service Public de Wallonie (SPW) 
> > Direction g?n?rale op?rationnelle Agriculture, Ressources 
> Naturelles et Environnement (DGARNE) 
> > D?partement des Aides 
> > Direction de l'Octroi des Aides agricoles - Service Informatique 
> > 14, Chauss?e de Louvain - 4e ?tage
> > 5000 Namur
> > BELGIUM 
> > 
> > 
> > 
> > 
> > 
> > 
> > 
> --------------------------------------------------------------
> ----------
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> --------------------------------------------------------------
> ------------------
> Peter J Halls, GIS Advisor, University of York
> Telephone: 01904 433806     Fax: 01904 433740
> Snail mail: Computing Service, University of York, 
> Heslington, York YO10 5DD
> This message has the status of a private and personal communication
> --------------------------------------------------------------
> ------------------
> 
> 
> 


From warmerdam at pobox.com  Thu Aug 20 11:20:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 20 11:21:13 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <loom.20090820T114441-892@post.gmane.org>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
Message-ID: <4A8D69C8.7060503@pobox.com>

Jukka Rahkonen wrote:
> Gdalwarp has now been running for 27 hours. Process is taking 70 megabytes of
> memory and 5-15 percent of processor time. As a result I have now output tiff
> file that is very, very slowly growing in size. Now, after 27-hour run the
> filesize is 13 gigabytes. Judged by the filesize my new tiff file might be ready
> after 4-5 more days.  However, I am not sure if this estimate is reliable. The
> gdalwarp status indicator is still showing just zero for me:
> Processing input file gdalwarptest.vrt.
> 0
> 
> Conclusion: Too slow to be useful with my settings.
> Question 1: Should it work this way?
> Question 2: If yes, is it worth trying to find the limits when it goes too slow
> and perhaps file a ticket?

Jukka,

I hate to bring this up so late in the discussion, but have you tried
-wo SKIP_NOSOURCE=YES?  When mosaicing small images into large images it
prevents processing of chunks for which there is no source data.  Otherwise
the whole output image is generated for each input image.

There is an open ticket on this issue to apply this option by default.

BTW, in combination with SKIP_NOSOURCE it can be helpful to keep the -wm
option to a modest size to the tiles aren't too large.  A 200MB should be
sufficient - especially if the input and output image are tiled.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From questions.anon at gmail.com  Thu Aug 20 13:44:15 2009
From: questions.anon at gmail.com (questions anon)
Date: Thu Aug 20 13:44:20 2009
Subject: [gdal-dev] calculate raster values within a vector
Message-ID: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>

Can anyone get me started on a script that can -

 -Open a shapefile

 -Open many rasters

 -Calculate the mean and standard deviation of those rasters within the
shapefile region, but is able to ignore areas of zeros or NoData

 -Output the mean and standard deviation to a table

 Otherwise any tutorials or books that I could follow to work this out would
be greatly appreciated! Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090820/a5275a81/attachment.html
From monshi at home.se  Thu Aug 20 16:13:50 2009
From: monshi at home.se (Tomas R)
Date: Thu Aug 20 16:14:26 2009
Subject: [gdal-dev] Re: C# Nad27 to WGS 84
In-Reply-To: <f3b73b7d0908180522s448294fdq803d73adff3ec916@mail.gmail.com>
References: <h3c5r1$kmo$1@ger.gmane.org>
	<4A5A0B67.10309@pobox.com>	<h3plot$aap$1@ger.gmane.org>	<f3b73b7d0907170618r7a1e6ffbn661bb2fbfa8a83ef@mail.gmail.com>	<h6e2gn$o4p$1@ger.gmane.org>
	<f3b73b7d0908180522s448294fdq803d73adff3ec916@mail.gmail.com>
Message-ID: <h6kaq0$tvd$1@ger.gmane.org>

Installed .Net2 SDK on my Vista machine and compiled it via that 
installation and it worked. But should it not be doable on a .net3.5 
installation? From GUI editor (VSE 2008) it is, should also be via the 
command line.


Yours
Tomas

Tamas Szekeres skrev:
>
>
> 2009/8/18 Tomas R <monshi@home.se <mailto:monshi@home.se>>
>
>     Ah, thanks. Been away some time from the list and no email
>     regarding this answer. Will try it but am happy with the binaries
>     I currently have.
>
>     Another Q...
>     On my Vista machine when I compile GDAL/Swig-links  it  is
>     compiled for the .Net 3.5 platform. Would like to target .Net 2
>     instead. How? Am investigating myself but no luck so far.
>
>     Must I install .Net 2 SDK on my Vista? In the GUI there is no
>     problem targeting .Net 2 but on the commandline? I currently open
>     up, set up, the environment using the setenv.cmd in the folder
>     C:\Program Files\Microsoft SDKs\Windows\v6.1\Bin
>     Compiles fine, but to .Net 3.5.
>     An environment setting? or?
>
>
>
> I don't see any any framework preference in the default compilation, 
> it depends on which version of mscorlib is available at compile time. 
> This should be .net framework 2.0 by default, so make sure this 
> framewok version have been installed side by side on the development 
> machine.
>
>
> Best regards,
>
> Tamas
>
>  
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From kohain8 at yahoo.com.cn  Thu Aug 20 23:17:56 2009
From: kohain8 at yahoo.com.cn (kohain)
Date: Thu Aug 20 23:18:00 2009
Subject: [Gdal-dev] Could anyone share me a copy of sourcefile of dealing
	with hdf4.x using GDAL library?
Message-ID: <1250824676643-3484097.post@n2.nabble.com>


Could anyone share me a copy of sourcefile of dealing with hdf4.x using GDAL
library?
I miss a great trouble on using it.
-- 
View this message in context: http://n2.nabble.com/Could-anyone-share-me-a-copy-of-sourcefile-of-dealing-with-hdf4-x-using-GDAL-library-tp3484097p3484097.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From kohain8 at yahoo.com.cn  Thu Aug 20 23:23:48 2009
From: kohain8 at yahoo.com.cn (kohain)
Date: Thu Aug 20 23:23:49 2009
Subject: [Gdal-dev] Could anyone share me a copy of sourcefile of
	dealing with hdf4.x using GDAL library?
In-Reply-To: <1250824676643-3484097.post@n2.nabble.com>
References: <1250824676643-3484097.post@n2.nabble.com>
Message-ID: <1250825028002-3484121.post@n2.nabble.com>




kohain wrote:
> 
> Could anyone share me a copy of sourcefile of dealing with hdf4.x using
> GDAL library?
> I miss a great trouble on using it.
> 
The one which was built under VC++ will be the best.
And my E-Mail is kohain8@yahoo.com.cn
-- 
View this message in context: http://n2.nabble.com/Could-anyone-share-me-a-copy-of-sourcefile-of-dealing-with-hdf4-x-using-GDAL-library-tp3484097p3484121.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From leonardo.piga at gmail.com  Thu Aug 20 23:34:05 2009
From: leonardo.piga at gmail.com (Leonardo Piga)
Date: Thu Aug 20 23:34:26 2009
Subject: [gdal-dev] New OGR Driver
Message-ID: <2b366a5e0908202034h4fcfa266m294fa19b5886cfa8@mail.gmail.com>

Hello,

I'm implementing a new driver for OGR. The driver is responsible for
handling with GPSTrackMaker files <http://www.gpstm.com>. GTM files.

This program is extensively used in Brazil on a project called
Tracksource. This community makes maps from Brazilian cities and
distributes them freely for using on GPS devices. The project is
collaborative and the users develop the maps.

Each developer is responsible for one or more cities. Some developers
receive the maps from their city hall office (this is my case);
however, it doesn't give the maps on our preferable format. The
developer has to convert it. That's why I'm implement this driver.

The driver is reading the gtm a files already. I want to share my
effort, so that other people can use my driver.
Is it possible to make my driver available with OGR?

Thank you
-- 
Leonardo de Paula Rosa Piga
http://lampiao.lsc.ic.unicamp.br/~piga
From even.rouault at mines-paris.org  Fri Aug 21 04:03:25 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Aug 21 04:03:29 2009
Subject: [gdal-dev] New OGR Driver
In-Reply-To: <2b366a5e0908202034h4fcfa266m294fa19b5886cfa8@mail.gmail.com>
References: <2b366a5e0908202034h4fcfa266m294fa19b5886cfa8@mail.gmail.com>
Message-ID: <1250841805.4a8e54cd18b4f@imp.free.fr>

Selon Leonardo Piga <leonardo.piga@gmail.com>:

Leonardo,

the general way to proceed and a few recommandations are described here :
http://trac.osgeo.org/gdal/wiki/HowToContribute

I'm just curious : does this effort of creating maps for Brazilian cities relate
somehow with the OpenStreetMap project or is it a completely autonomous effort ?

I've just also noticed that the gpsbabel project handles the GTM format
(http://www.gpsbabel.org/capabilities.html). Did you consider using it instead,
or was the direct integration of the GTM format inside OGR more convenient for
you ?

Just speaking loud : it might be interesting to have a pseudo gpsbabel driver in
OGR. That would offer 'for free' all the formats gpsbabel handles to OGR.
Technically speaking, gpsbabel being an executable and not a library, OGR would
probably need to fork the gpsbabel executable and use the GPX format as an
exchange format between both software. One inconvenience I see when using
gpsbabel is that it has no format autodetection capability. So the syntax could
be for example "ogrinfo GPSBABEL:gtm:my_file.gtm" and this would execute
"gpsbabel -w -r -t -i gtm -f -i gtm -f my_file.gtm -o gpx -F tempfile.gpx". Or
the subformat autodetection capability could be added in the OGR gpsbabel driver
for a few selected formats.

Best regards,
Even

> Hello,
>
> I'm implementing a new driver for OGR. The driver is responsible for
> handling with GPSTrackMaker files <http://www.gpstm.com>. GTM files.
>
> This program is extensively used in Brazil on a project called
> Tracksource. This community makes maps from Brazilian cities and
> distributes them freely for using on GPS devices. The project is
> collaborative and the users develop the maps.
>
> Each developer is responsible for one or more cities. Some developers
> receive the maps from their city hall office (this is my case);
> however, it doesn't give the maps on our preferable format. The
> developer has to convert it. That's why I'm implement this driver.
>
> The driver is reading the gtm a files already. I want to share my
> effort, so that other people can use my driver.
> Is it possible to make my driver available with OGR?
>
> Thank you
> --
> Leonardo de Paula Rosa Piga
> http://lampiao.lsc.ic.unicamp.br/~piga
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From Roger.Bivand at nhh.no  Fri Aug 21 04:04:45 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Aug 21 04:04:49 2009
Subject: [gdal-dev] GDAL Erdas LAN/GIS driver
Message-ID: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>

Hi,

The code for the LAN/GIS driver uses GDT_Int16 for Pixel type 2, rather 
than GDT_UInt16. Is this justified? A user of rgdal has a case of unsigned 
16-bit data stored by "a forest landscape model", being treated by the 
driver as signed. The header does not seem to have a signed/unsigned flag. 
Is this a problem of ambiguity in use of a (closed?) specification, or 
should the driver be using GDT_UInt16?

I'm asking on the list first, because this may be ambiguity, not a bug.

Best wishes,

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From leonardo.piga at gmail.com  Fri Aug 21 09:11:57 2009
From: leonardo.piga at gmail.com (Leonardo Piga)
Date: Fri Aug 21 09:12:19 2009
Subject: [gdal-dev] New OGR Driver
In-Reply-To: <1250841805.4a8e54cd18b4f@imp.free.fr>
References: <2b366a5e0908202034h4fcfa266m294fa19b5886cfa8@mail.gmail.com> 
	<1250841805.4a8e54cd18b4f@imp.free.fr>
Message-ID: <2b366a5e0908210611j40d7aebag20109cf3131855bf@mail.gmail.com>

On Fri, Aug 21, 2009 at 5:03 AM, Even
Rouault<even.rouault@mines-paris.org> wrote:
> Selon Leonardo Piga <leonardo.piga@gmail.com>:
>
> Leonardo,
>
> the general way to proceed and a few recommandations are described here :
> http://trac.osgeo.org/gdal/wiki/HowToContribute
Thanks. I'll check.

>
> I'm just curious : does this effort of creating maps for Brazilian cities relate
> somehow with the OpenStreetMap project or is it a completely autonomous effort ?
No it isn't. Actually, the project effort is to develop maps for
Garmin GPS Devices. I'll really appreciate if they agree to share our
effort on OpenStreetMap and I thing the project should be wider. But
it is not just up to me, other developers must agree.

One flaw of the project is the lack of information in English, so I
can't give you many references.
If you want to know more, you can find details here, but these
references are in Portuguese.

The official website is: www.tracksource.org.br
There is a Wikipedia article: http://pt.wikipedia.org/wiki/Tracksource

>
> I've just also noticed that the gpsbabel project handles the GTM format
> (http://www.gpsbabel.org/capabilities.html). Did you consider using it instead,
> or was the direct integration of the GTM format inside OGR more convenient for
> you ?
The problem is that gpsbabel doesn't export track colors, neither
waypoint types, so for my needs it is critical. So, I decide to do my
own implementation.

>
> Just speaking loud : it might be interesting to have a pseudo gpsbabel driver in
> OGR. That would offer 'for free' all the formats gpsbabel handles to OGR.
> Technically speaking, gpsbabel being an executable and not a library, OGR would
> probably need to fork the gpsbabel executable and use the GPX format as an
> exchange format between both software. One inconvenience I see when using
> gpsbabel is that it has no format autodetection capability. So the syntax could
> be for example "ogrinfo GPSBABEL:gtm:my_file.gtm" and this would execute
> "gpsbabel -w -r -t -i gtm -f -i gtm -f my_file.gtm -o gpx -F tempfile.gpx". Or
> the subformat autodetection capability could be added in the OGR gpsbabel driver
> for a few selected formats.
It is an excellent idea. After finishing my GTM driver and wrap
everything up, I can do that.
We come back to this in some days.


Thank you very much.
>
> Best regards,
> Even
>
>> Hello,
>>
>> I'm implementing a new driver for OGR. The driver is responsible for
>> handling with GPSTrackMaker files <http://www.gpstm.com>. GTM files.
>>
>> This program is extensively used in Brazil on a project called
>> Tracksource. This community makes maps from Brazilian cities and
>> distributes them freely for using on GPS devices. The project is
>> collaborative and the users develop the maps.
>>
>> Each developer is responsible for one or more cities. Some developers
>> receive the maps from their city hall office (this is my case);
>> however, it doesn't give the maps on our preferable format. The
>> developer has to convert it. That's why I'm implement this driver.
>>
>> The driver is reading the gtm a files already. I want to share my
>> effort, so that other people can use my driver.
>> Is it possible to make my driver available with OGR?
>>
>> Thank you
>> --
>> Leonardo de Paula Rosa Piga
>> http://lampiao.lsc.ic.unicamp.br/~piga
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>



-- 
Leonardo de Paula Rosa Piga
MSc Computer Science Student
Computer Engineer
LSC - IC - UNICAMP
http://lampiao.lsc.ic.unicamp.br/~piga
From warmerdam at pobox.com  Fri Aug 21 09:18:23 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 21 09:18:40 2009
Subject: [gdal-dev] GDAL Erdas LAN/GIS driver
In-Reply-To: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>
References: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>
Message-ID: <4A8E9E9F.5060505@pobox.com>

Roger Bivand wrote:
> Hi,
> 
> The code for the LAN/GIS driver uses GDT_Int16 for Pixel type 2, rather 
> than GDT_UInt16. Is this justified? A user of rgdal has a case of 
> unsigned 16-bit data stored by "a forest landscape model", being treated 
> by the driver as signed. The header does not seem to have a 
> signed/unsigned flag. Is this a problem of ambiguity in use of a 
> (closed?) specification, or should the driver be using GDT_UInt16?
> 
> I'm asking on the list first, because this may be ambiguity, not a bug.

Roger,

The only specification information I have on the format does not indicate
whether 16bit values should be treated as signed or unsigned.  If you are
confident that it should be treated as unsigned file a ticket and we will
fix it - hopefully this won't just break it for someone else!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Roger.Bivand at nhh.no  Fri Aug 21 12:58:11 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Fri Aug 21 12:58:16 2009
Subject: [gdal-dev] GDAL Erdas LAN/GIS driver
In-Reply-To: <alpine.LRH.2.00.0908211606220.7507@reclus.nhh.no>
References: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>
	<4A8E9E9F.5060505@pobox.com>
	<alpine.LRH.2.00.0908211606220.7507@reclus.nhh.no>
Message-ID: <alpine.LRH.2.00.0908211846100.7507@reclus.nhh.no>

On Fri, 21 Aug 2009, Roger Bivand wrote:

> On Fri, 21 Aug 2009, Frank Warmerdam wrote:
>
>> Roger Bivand wrote:
>>> Hi,
>>> 
>>> The code for the LAN/GIS driver uses GDT_Int16 for Pixel type 2, rather 
>>> than GDT_UInt16. Is this justified? A user of rgdal has a case of unsigned 
>>> 16-bit data stored by "a forest landscape model", being treated by the 
>>> driver as signed. The header does not seem to have a signed/unsigned flag. 
>>> Is this a problem of ambiguity in use of a (closed?) specification, or 
>>> should the driver be using GDT_UInt16?
>>> 
>>> I'm asking on the list first, because this may be ambiguity, not a bug.
>> 
>> Roger,
>> 
>> The only specification information I have on the format does not indicate
>> whether 16bit values should be treated as signed or unsigned.  If you are
>> confident that it should be treated as unsigned file a ticket and we will
>> fix it - hopefully this won't just break it for someone else!
>
> Frank,
>
> Thanks, I'm waiting to receive the affected file. I'll let you know when I've 
> got it.

(reverting to list)

Correction, the user reported that:

> Apparently, gdalinfo retrieves the correct min, max, and statistics, 
> despite the use of GDT_Int16.

on his Windows platform. The different GDAL versions ought to explain why 
his gdalinfo says Int16 but gives statistics from UInt16.

He has:

>From FWTools:
gdalinfo --version
GDAL 1.7.0dev, FWTools 2.4.2 released 2009/06/24

C:\Program Files\FWTools2.4.2>gdalinfo stand_bm.gis
Driver: LAN/Erdas .LAN/.GIS
Files: c:\landis\harvest_problem\FTT-N_MinT-N\stand_bm.gis
       c:\landis\harvest_problem\FTT-N_MinT-N\stand_bm.gsw
Size is 1758, 839
Coordinate System is:
LOCAL_CS["Unknown",
    UNIT["Meter",1]]
Origin = (33773.261718750000000,945478.062500000000000)
Pixel Size = (100.000000000000000,-100.000000000000000)
Corner Coordinates:
Upper Left  (   33773.262,  945478.063)
Lower Left  (   33773.262,  861578.063)
Upper Right (  209573.262,  945478.063)
Lower Right (  209573.262,  861578.063)
Center      (  121673.262,  903528.063)
Band 1 Block=1758x1 Type=Int16, ColorInterp=Undefined
  Min=0.000 Max=48499.000
  Minimum=0.000, Maximum=48499.000, Mean=12833.830, StdDev=13635.800
  Metadata:
    STATISTICS_MINIMUM=0
    STATISTICS_MAXIMUM=48499
    STATISTICS_MEAN=12833.830260712
    STATISTICS_MEDIAN=8.7254821994872e-239
    STATISTICS_MODE=3.9864100424366e-293
    STATISTICS_STDDEV=13635.800289332
    LAYER_TYPE=thematic


rgdal_0.6-12
> getGDALVersionInfo()
[1] "GDAL 1.6.1, released 2009/05/11"

For me on x86_64, GDALinfo() in rgdal and 1.6.2 gdalinfo -stats agree.

$ gdalinfo -stats stand_bm.gis
Driver: LAN/Erdas .LAN/.GIS
Files: stand_bm.gis
Size is 1758, 839
Coordinate System is:
LOCAL_CS["Unknown",
     UNIT["Meter",1]]
Origin = (33773.261718750000000,945478.062500000000000)
Pixel Size = (100.000000000000000,-100.000000000000000)
Corner Coordinates:
Upper Left  (   33773.262,  945478.062)
Lower Left  (   33773.262,  861578.062)
Upper Right (  209573.262,  945478.062)
Lower Right (  209573.262,  861578.062)
Center      (  121673.262,  903528.062)
Band 1 Block=1758x1 Type=Int16, ColorInterp=Undefined
   Minimum=-32140.000, Maximum=29620.000, Mean=8315.507, StdDev=13186.107
   Metadata:
     STATISTICS_MINIMUM=-32140
     STATISTICS_MAXIMUM=29620
     STATISTICS_MEAN=8315.5065072863
     STATISTICS_STDDEV=13186.10731815

On the trunk, GDT_Int16 is used too, so how does gdalinfo detect that it 
is actually UInt16?

Roger

>
> Best wishes,
>
> Roger
>
>> 
>> Best regards,
>> 
>
>

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From maphew at gmail.com  Fri Aug 21 13:20:40 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Fri Aug 21 13:20:42 2009
Subject: [Gdal-dev] Compress via NTFS or in-image for performance?
Message-ID: <1250875240325-3491435.post@n2.nabble.com>


Dear GDAL,

Any thoughts on whether the best read/write performance vs disk space used
is achieved through file system compression or in-raster compression? The
former would be via Windows NTFS compact and the latter via TIFF LZW or
perhaps JP2.

thanks,

-matt
-- 
View this message in context: http://n2.nabble.com/Compress-via-NTFS-or-in-image-for-performance-tp3491435p3491435.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jon at gina.alaska.edu  Fri Aug 21 21:23:42 2009
From: jon at gina.alaska.edu (Jonathan Sawyer)
Date: Fri Aug 21 21:31:33 2009
Subject: [gdal-dev] Python gdal -- Class or function equivalent to
	`gdaltransform'
Message-ID: <5cab99fd0908211823w2bd05954t3e2f1faab2ae3562@mail.gmail.com>

Good evening developers,

I am very new to GDAL, so please bear with me.

What function/class/module do I need to look at to perform coordinate
transformation, in Python?

Or better yet, can anyone point me to good online docs to learn how the
Python bindings are used in gdal?

FYI: I am looking for the equivalent to this command line example:

$ gdaltransform -s_srs EPSG:4326 -t_srs EPSG:3338
-146.673599867, 64.7163624865
348408.577415968 1658661.40355536 0

Have a good weekend, and thanks for your help.

-- 
Jonathan Sawyer
Geographic Information Network of Alaska (GINA)
University of Alaska Fairbanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090821/7b815b6f/attachment.html
From warmerdam at pobox.com  Fri Aug 21 22:03:52 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug 21 22:04:05 2009
Subject: [gdal-dev] Python gdal -- Class or function equivalent to
	`gdaltransform'
In-Reply-To: <5cab99fd0908211823w2bd05954t3e2f1faab2ae3562@mail.gmail.com>
References: <5cab99fd0908211823w2bd05954t3e2f1faab2ae3562@mail.gmail.com>
Message-ID: <4A8F5208.60605@pobox.com>

Jonathan Sawyer wrote:
> Good evening developers,
> 
> I am very new to GDAL, so please bear with me.
> 
> What function/class/module do I need to look at to perform coordinate 
> transformation, in Python?
> 
> Or better yet, can anyone point me to good online docs to learn how the 
> Python bindings are used in gdal?
> 
> FYI: I am looking for the equivalent to this command line example:
> 
> $ gdaltransform -s_srs EPSG:4326 -t_srs EPSG:3338
> -146.673599867, 64.7163624865
> 348408.577415968 1658661.40355536 0
> 
> Have a good weekend, and thanks for your help.

Jonathan,

There are some pointers to sample python scripts at:

   http://trac.osgeo.org/gdal/wiki/GdalOgrInPython

The tolatlong.py script has some example script for transforming
points:

   http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/tolatlong.py

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From rykovd at gmail.com  Sat Aug 22 02:48:59 2009
From: rykovd at gmail.com (Denis Rykov)
Date: Sat Aug 22 02:54:48 2009
Subject: [gdal-dev] Export HDF-EOS to GeoTIFF
Message-ID: <2c9bd88a0908212348v7027c3a6wb807dfef97d53419@mail.gmail.com>

I'm trying export raster from HDF-EOS to GeoTIFF. At result I have GeoTiff
with 143 numbers of GCP.
There are some thousands GCP at HDF-EOS geolocation SDS. Is OGR drivers
support only 143 GCP?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090822/a7e3724a/attachment.html
From peifer at gmx.eu  Sat Aug 22 04:51:46 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Aug 22 04:51:52 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8D69C8.7060503@pobox.com>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>
	<loom.20090820T114441-892@post.gmane.org>
	<4A8D69C8.7060503@pobox.com>
Message-ID: <4A8FB1A2.3080401@gmx.eu>

Frank Warmerdam wrote
> Jukka Rahkonen wrote:
>>
>> Conclusion: Too slow to be useful with my settings.
>> Question 1: Should it work this way?
>> Question 2: If yes, is it worth trying to find the limits when it goes 
>> too slow
>> and perhaps file a ticket?
> 
> 
> I hate to bring this up so late in the discussion, but have you tried
> -wo SKIP_NOSOURCE=YES?  When mosaicing small images into large images it
> prevents processing of chunks for which there is no source data.  Otherwise
> the whole output image is generated for each input image.
> 
> There is an open ticket on this issue to apply this option by default.
> 
> BTW, in combination with SKIP_NOSOURCE it can be helpful to keep the -wm
> option to a modest size to the tiles aren't too large.  A 200MB should be
> sufficient - especially if the input and output image are tiled.
> 

Just to repeat my earlier observations: over the last days, I tried with all kinds of -wm and GDAL_CACHEMAX settings, and also added the options TILED=YES and SKIP_NOSOURCE=YES. I haven't documented the performance changes systematically, but my overall impression was that the changes were rather small. I also tried -multi on my dual processor machine, but I ended up with a fatal error.

What really helped was to follow Felix' approach, who wrote in the first mail of this thread:
> Now, a second script, pasting first "slices" of 5*30? together,
> and than merging all the slices...

This way, one can reduce the processing time to some 10-20% compared to the "all in one run approach". Concerning the size of the intermediate slices: the smaller they are, the faster it goes. The final step of gdalbuilding a vrt from the imtermediate slices and gdal_translating it to the final output.tif is also very fast.

In order to avoid NODATA gaps in the final output.tif: It seems to be safer if the intermediate slices are slightly overlapping, rather being than just adjacent.

Hermann
From nowak at xpam.de  Sat Aug 22 05:32:16 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Sat Aug 22 05:32:47 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FB1A2.3080401@gmx.eu>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>
	<4A8FB1A2.3080401@gmx.eu>
Message-ID: <4A8FBB20.2040509@xpam.de>

Some rather counterintuitive gdalwarp behavior: the bigger 
dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
warping not existing pixels. Why? Warping begins with the destination 
window size of entire output image size. If this size is larger than 
dfWarpMemoryLimit it is split in half along the longest axis and any 
half that doesn't contain the currently processed source file is 
discarded. With large dfWarpMemoryLimit this subdivision process will 
stop early with still large portions of out of source image pixels.

Hermann Peifer wrote:
> Frank Warmerdam wrote
>> Jukka Rahkonen wrote:
>>>
>>> Conclusion: Too slow to be useful with my settings.
>>> Question 1: Should it work this way?
>>> Question 2: If yes, is it worth trying to find the limits when it 
>>> goes too slow
>>> and perhaps file a ticket?
>>
>>
>> I hate to bring this up so late in the discussion, but have you tried
>> -wo SKIP_NOSOURCE=YES?  When mosaicing small images into large images it
>> prevents processing of chunks for which there is no source data.  
>> Otherwise
>> the whole output image is generated for each input image.
>>
>> There is an open ticket on this issue to apply this option by default.
>>
>> BTW, in combination with SKIP_NOSOURCE it can be helpful to keep the -wm
>> option to a modest size to the tiles aren't too large.  A 200MB should be
>> sufficient - especially if the input and output image are tiled.
>>
> 
> Just to repeat my earlier observations: over the last days, I tried with 
> all kinds of -wm and GDAL_CACHEMAX settings, and also added the options 
> TILED=YES and SKIP_NOSOURCE=YES. I haven't documented the performance 
> changes systematically, but my overall impression was that the changes 
> were rather small. I also tried -multi on my dual processor machine, but 
> I ended up with a fatal error.
> 
> What really helped was to follow Felix' approach, who wrote in the first 
> mail of this thread:
>> Now, a second script, pasting first "slices" of 5*30? together,
>> and than merging all the slices...
> 
> This way, one can reduce the processing time to some 10-20% compared to 
> the "all in one run approach". Concerning the size of the intermediate 
> slices: the smaller they are, the faster it goes. The final step of 
> gdalbuilding a vrt from the imtermediate slices and gdal_translating it 
> to the final output.tif is also very fast.
> 
> In order to avoid NODATA gaps in the final output.tif: It seems to be 
> safer if the intermediate slices are slightly overlapping, rather being 
> than just adjacent.
> 
> Hermann
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From peifer at gmx.eu  Sat Aug 22 06:09:57 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Sat Aug 22 06:10:02 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FBB20.2040509@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>
	<4A8FBB20.2040509@xpam.de>
Message-ID: <4A8FC3F5.1060008@gmx.eu>

Adam Nowacki wrote:
> Some rather counterintuitive gdalwarp behavior: the bigger 
> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
> warping not existing pixels. Why? Warping begins with the destination 
> window size of entire output image size. If this size is larger than 
> dfWarpMemoryLimit it is split in half along the longest axis and any 
> half that doesn't contain the currently processed source file is 
> discarded. With large dfWarpMemoryLimit this subdivision process will 
> stop early with still large portions of out of source image pixels.
> 

In other words, the counter-intuitive recommendation would be: The smaller the -wm setting, the better?
Or say: the -wm value should better be just a bit bigger than the source image size?

Hermann



> Hermann Peifer wrote:
>> Frank Warmerdam wrote
>>> Jukka Rahkonen wrote:
>>>>
>>>> Conclusion: Too slow to be useful with my settings.
>>>> Question 1: Should it work this way?
>>>> Question 2: If yes, is it worth trying to find the limits when it 
>>>> goes too slow
>>>> and perhaps file a ticket?
>>>
>>>
>>> I hate to bring this up so late in the discussion, but have you tried
>>> -wo SKIP_NOSOURCE=YES?  When mosaicing small images into large images it
>>> prevents processing of chunks for which there is no source data.  
>>> Otherwise
>>> the whole output image is generated for each input image.
>>>
>>> There is an open ticket on this issue to apply this option by default.
>>>
>>> BTW, in combination with SKIP_NOSOURCE it can be helpful to keep the -wm
>>> option to a modest size to the tiles aren't too large.  A 200MB 
>>> should be
>>> sufficient - especially if the input and output image are tiled.
>>>
>>
>> Just to repeat my earlier observations: over the last days, I tried 
>> with all kinds of -wm and GDAL_CACHEMAX settings, and also added the 
>> options TILED=YES and SKIP_NOSOURCE=YES. I haven't documented the 
>> performance changes systematically, but my overall impression was that 
>> the changes were rather small. I also tried -multi on my dual 
>> processor machine, but I ended up with a fatal error.
>>
>> What really helped was to follow Felix' approach, who wrote in the 
>> first mail of this thread:
>>> Now, a second script, pasting first "slices" of 5*30? together,
>>> and than merging all the slices...
>>
>> This way, one can reduce the processing time to some 10-20% compared 
>> to the "all in one run approach". Concerning the size of the 
>> intermediate slices: the smaller they are, the faster it goes. The 
>> final step of gdalbuilding a vrt from the imtermediate slices and 
>> gdal_translating it to the final output.tif is also very fast.
>>
>> In order to avoid NODATA gaps in the final output.tif: It seems to be 
>> safer if the intermediate slices are slightly overlapping, rather 
>> being than just adjacent.
>>
>> Hermann
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>

From mateusz at loskot.net  Sat Aug 22 06:23:13 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug 22 06:23:21 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FBB20.2040509@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>
	<4A8FBB20.2040509@xpam.de>
Message-ID: <4A8FC711.4020201@loskot.net>

Adam Nowacki wrote:
> Some rather counterintuitive gdalwarp behavior: the bigger
> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on
> warping not existing pixels. Why? Warping begins with the destination
> window size of entire output image size. If this size is larger than
> dfWarpMemoryLimit it is split in half along the longest axis and any
> half that doesn't contain the currently processed source file is
> discarded. With large dfWarpMemoryLimit this subdivision process will
> stop early with still large portions of out of source image pixels.

It's really good piece information that belongs to FAQ

http://trac.osgeo.org/gdal/wiki/FAQ

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From even.rouault at mines-paris.org  Sat Aug 22 06:28:43 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Aug 22 06:28:46 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FC711.4020201@loskot.net>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
	<4A8D69C8.7060503@pobox.com> <4A8FB1A2.3080401@gmx.eu>
	<4A8FBB20.2040509@xpam.de> <4A8FC711.4020201@loskot.net>
Message-ID: <1250936923.4a8fc85bd50b4@imp.free.fr>

Selon Mateusz Loskot <mateusz@loskot.net>:

Actually, it would rather belong to
http://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp

> Adam Nowacki wrote:
> > Some rather counterintuitive gdalwarp behavior: the bigger
> > dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on
> > warping not existing pixels. Why? Warping begins with the destination
> > window size of entire output image size. If this size is larger than
> > dfWarpMemoryLimit it is split in half along the longest axis and any
> > half that doesn't contain the currently processed source file is
> > discarded. With large dfWarpMemoryLimit this subdivision process will
> > stop early with still large portions of out of source image pixels.
>
> It's really good piece information that belongs to FAQ
>
> http://trac.osgeo.org/gdal/wiki/FAQ
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From gregcoats at mac.com  Sat Aug 22 12:29:47 2009
From: gregcoats at mac.com (Greg Coats)
Date: Sat Aug 22 12:29:45 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FB1A2.3080401@gmx.eu>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>
	<4A8AF78C.3030109@gmx.eu> <loom.20090820T114441-892@post.gmane.org>
	<4A8D69C8.7060503@pobox.com> <4A8FB1A2.3080401@gmx.eu>
Message-ID: <E132E223-D5C6-4A10-B6E3-81F8FEA451BE@mac.com>

On Aug 22, 2009, at 4:51 AM, Hermann Peifer wrote:

> Just to repeat my earlier observations: over the last days, I tried  
> with all kinds of -wm and GDAL_CACHEMAX settings, and also added  
> the options TILED=YES and SKIP_NOSOURCE=YES. I haven't documented  
> the performance changes systematically, but my overall impression  
> was that the changes were rather small. I also tried -multi on my  
> dual processor machine, but I ended up with a fatal error.


In January 2009, working with GDAL version 1.6.0, I did some testing  
and documenting of the effect of GDAL_CACHEMAX. Using as input an  
uncompressed GeoTif 15,000 x 15,000 x 3 = 675 MB, organized into 1024  
x 1024 tiles, I found that using gdal_translate to convert this  
GeoTif to a GeoJP2 with the default --config GDAL_CACHEMAX 40 took  
10473 sec (= 175 minutes), but increasing GDAL_CACHEMAX by only 12.5%  
to --config GDAL_CACHEMAX 45 the processing took only 166 sec (= 2.7  
minutes), which is 63 times faster! Further tests showed that  
increasing --config GDAL_CACHEMAX to values greater than 45 (up to  
1800) did not effect processing time. Greg

GDAL 1.6.0, released 2008/12/04
Input GeoTif 15,000 x 15,000 x 3 = 675 MB
gdal_translate -of JP2KAK -co QUALITY=10 --config GDAL_CACHEMAX
0040  10473.14 sec
0041  10326.75 sec
0042  10492.85 sec
0043   7081.57 sec
0044   3503.33 sec
0045    166.23 sec
0050    166.31 sec
0055    165.89 sec
0060    165.78 sec
0080    165.48 sec
0100    166.53 sec
0125    165.59 sec
0150    165.72 sec
0200    165.65 sec
0250    166.58 sec
0300    166.13 sec
0350    166.59 sec
0400    166.06 sec
0600    166.00 sec
0800    165.10 sec
1000    165.25 sec
1200    165.94 sec
1400    165.43 sec
1600    165.56 sec
1800    166.31 sec

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090822/de771245/attachment.html
From JAMES.E.HOPPER at saic.com  Sun Aug 23 13:13:38 2009
From: JAMES.E.HOPPER at saic.com (jim hopper)
Date: Sun Aug 23 13:14:10 2009
Subject: [gdal-dev] 1.6.2 autotest?
In-Reply-To: <20090823160028.505B1E01646@lists.osgeo.org>
Message-ID: <C6B6F102.1032D%james.e.hopper@saic.com>

Is there going to be an autotest download available for new 1.6.2 version?

Thanks jim

From warmerdam at pobox.com  Sun Aug 23 14:48:52 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Aug 23 14:49:07 2009
Subject: [gdal-dev] 1.6.2 autotest?
In-Reply-To: <C6B6F102.1032D%james.e.hopper@saic.com>
References: <C6B6F102.1032D%james.e.hopper@saic.com>
Message-ID: <4A918F14.3010101@pobox.com>

jim hopper wrote:
> Is there going to be an autotest download available for new 1.6.2 version?

Jim,

It is not common practice to update the autotest in stable branches, nor
to release updated autotest packages with point releases.  However, you
can grab the current state of the 1.6 autotest from subversion if you want
it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From tozjerimiah at gmail.com  Sun Aug 23 18:28:33 2009
From: tozjerimiah at gmail.com (Toz Jerimiah)
Date: Sun Aug 23 18:28:37 2009
Subject: [gdal-dev] ogr2ogr??
Message-ID: <cca8d9c50908231528v38b52d22oae7bf8317c55f454@mail.gmail.com>

Hello,

I am wondering if anyone can help with a problem which I have to solve: I
want to take coordinates in meters from an ACAD file, and project them in
lat/long as is compatible with google maps. I understand that ogr2ogr is the
way forward. I expect that I will have to shift the x,y coords in my drawing
to UTM which I am happy with.

However:

1. I do not know what format ogr2ogr expects the UTM data to be in.
2. I would appreciate it if someone could tell me what t-srs is correct to
get google style lat/long (or something which can be made to work)

If you can assist I would appreciate:
1. A UTM data file which ogr2ogr understands so that I can base my output on
that.
2. The command line which I need to pass to get the correct data out.

Apologies if I have posted to the wrong place - let me know where I need to
post if so.

Thanks,
Toz Jerimiah
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090823/64b993d9/attachment.html
From warmerdam at pobox.com  Sun Aug 23 20:35:46 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Aug 23 20:36:09 2009
Subject: [gdal-dev] Export HDF-EOS to GeoTIFF
In-Reply-To: <2c9bd88a0908212348v7027c3a6wb807dfef97d53419@mail.gmail.com>
References: <2c9bd88a0908212348v7027c3a6wb807dfef97d53419@mail.gmail.com>
Message-ID: <4A91E062.4080905@pobox.com>

Denis Rykov wrote:
> I'm trying export raster from HDF-EOS to GeoTIFF. At result I have 
> GeoTiff with 143 numbers of GCP.
> There are some thousands GCP at HDF-EOS geolocation SDS. Is OGR drivers 
> support only 143 GCP?

Denis,

Normally the HDF4 driver takes only a subset of GCPs to keep the number
managable.  The logic looks like:

/* -------------------------------------------------------------------- */
/*      Determine whether to use no, partial or full GCPs.              */
/* -------------------------------------------------------------------- */
     const char *pszGEOL_AS_GCPS = CPLGetConfigOption( "GEOL_AS_GCPS",
                                                       "PARTIAL" );
     int iGCPStepX, iGCPStepY;

     if( EQUAL(pszGEOL_AS_GCPS,"NONE") )
     {
         iGCPStepX = iGCPStepY = 0;
     }
     else if( EQUAL(pszGEOL_AS_GCPS,"FULL") )
     {
         iGCPStepX = iGCPStepY = 1;
     }
     else
     {
         // aim for 10x10 grid or so.
         iGCPStepX = MAX(1,((nXPoints-1) / 11));
         iGCPStepY = MAX(1,((nYPoints-1) / 11));
     }

So if you want them all you can set the configuration variable
GEOL_AS_GCPS to FULL either in the environment or as a commandline
switch ("--config GEOL_AS_GCPS FULL").

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fhillen at uni-osnabrueck.de  Mon Aug 24 08:03:15 2009
From: fhillen at uni-osnabrueck.de (Florian Hillen)
Date: Mon Aug 24 08:03:19 2009
Subject: [gdal-dev] Problem with GDALGetProjectionRef
In-Reply-To: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
Message-ID: <3168.79.205.42.128.1251115395.squirrel@webmail.rz.uni-osnabrueck.de>

Hi list,

I was wondering why GDALGetProjectionRef delivers an other result than
gdalinfo from FWTools of course by using the same file.

Here is my code from my qgis plugin:

    if( GDALGetProjectionRef( inputDS ) != NULL )
    {
        OGRSpatialReferenceH inputSRS;
        char *pszProjection;

        pszProjection = (char *) GDALGetProjectionRef( inputDS );

        inputSRS = OSRNewSpatialReference(NULL);
        if( OSRImportFromWkt( inputSRS, &pszProjection ) == CE_None )
        {
            char *prettyWkt = NULL;

            OSRExportToPrettyWkt( inputSRS, &prettyWkt, FALSE );

            QString wktFormat = prettyWkt;
            wktFormat.replace(QString("\n"), QString("<br>"));

            information += "<tr><td>";
            information += tr( "<b>Coordinate System:</b><br>" );
            information += wktFormat;
            information += "</td></tr>";
            CPLFree( prettyWkt );
        }
        else
        {
            information += "<tr><td>";
            information += tr( "<b>Coordinate System11:</b><br> %1" )
                            .arg( GDALGetProjectionRef( inputDS ) );
            information += "</td></tr>";
        }

        OSRDestroySpatialReference( inputSRS );
    }

and the same part from gdalinfo:

    if( GDALGetProjectionRef( hDataset ) != NULL )
    {
        OGRSpatialReferenceH  hSRS;
        char		      *pszProjection;

        pszProjection = (char *) GDALGetProjectionRef( hDataset );

        hSRS = OSRNewSpatialReference(NULL);
        if( OSRImportFromWkt( hSRS, &pszProjection ) == CE_None )
        {
            char	*pszPrettyWkt = NULL;

            OSRExportToPrettyWkt( hSRS, &pszPrettyWkt, FALSE );
            printf( "Coordinate System is:\n%s\n", pszPrettyWkt );
            CPLFree( pszPrettyWkt );
        }
        else
            printf( "Coordinate System is `%s'\n",
                    GDALGetProjectionRef( hDataset ) );

        OSRDestroySpatialReference( hSRS );
    }

gdalinfo delivers the right projection:

PROJCS["unnamed",
    GEOGCS["DHDN",
        DATUM["Deutsches_Hauptdreiecksnetz",
            SPHEROID["Bessel 1841",6377397.155,299.1528128000009,
                AUTHORITY["EPSG","7004"]],
            AUTHORITY["EPSG","6314"]],
[...]

GDALGetProjectionRef delivers the following WKT string (some of you know
this from some earlier mails):

PROJCS["unnamed",
GEOGCS["DHDN",
DATUM["unknown",
SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
PRIMEM["Greenwich",0],
UNIT["degree",0.0174532925199433],
AUTHORITY["EPSG","4314"]],
[...]

In the earlier mails I thought that the warp doesn't work correct, but
apparently the warp is correct, because I use the same file for gdalinfo
and in my plugin. So the problem must be GDALGetProjectionRef!?

Can anyone help me with that?

Best regards,
Florian
From peifer at gmx.eu  Mon Aug 24 08:25:12 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Mon Aug 24 08:24:45 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A8FBB20.2040509@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>
	<4A8FBB20.2040509@xpam.de>
Message-ID: <4A9286A8.70106@gmx.eu>

Adam Nowacki wrote:
> Some rather counterintuitive gdalwarp behavior: the bigger 
> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
> warping not existing pixels. Why? Warping begins with the destination 
> window size of entire output image size. If this size is larger than 
> dfWarpMemoryLimit it is split in half along the longest axis and any 
> half that doesn't contain the currently processed source file is 
> discarded. With large dfWarpMemoryLimit this subdivision process will 
> stop early with still large portions of out of source image pixels.
> 

Given Adam's explanations above, could someone tell me if my below 
assumptions are correct? Thanks.

Just to repeat, the input files are ASTER GTiffs in WGS84, 3601x3601 
pixels each. The output is a single mosaic of all tiles, a 100m GTiff, 
in LAEA projection


gdalwarp -wm 300 --config GDAL_CACHEMAX 300 --debug on ... reports:

Src=0,0,3601x3601 Dst=36375,31125,12125x10375

I understand this as follows: the source image of 3601x3601 pixels is 
read as one chunk (which after reprojection and resampling should be 
around 800x1100 pixels). However, 12125x10375 pixels are actually 
written to the output file. So 99.5% of the destination window must be 
completely unrelated to my input image.

If I counter-intuitively reduce the memory limit to, say: 40 MB and 
leave anything else unchanged, then gdalwarp behaviour changes to

Src=0,0,3601x3601 Dst=45468,38906,1516x2594

This tells me that the destination window is much smaller and gdalwarp 
will not waste time to write out so many irrelevant pixels, correct?

Perhaps gdalwarp should not only test if the destination window fits 
into memory, but also check what would be the minimum destination window 
for warping the input image. This could speed up the mosaicing of small 
tiles into a bigger output file.

Hermann
From nowak at xpam.de  Mon Aug 24 08:41:18 2009
From: nowak at xpam.de (Adam Nowacki)
Date: Mon Aug 24 08:41:53 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A9286A8.70106@gmx.eu>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>	<4A8FBB20.2040509@xpam.de>
	<4A9286A8.70106@gmx.eu>
Message-ID: <4A928A6E.4050206@xpam.de>

You can test with http://pastebin.com/m45e46f53
Also remember to use -wo SKIP_NOSOURCE=YES

Hermann Peifer wrote:
> Adam Nowacki wrote:
>> Some rather counterintuitive gdalwarp behavior: the bigger 
>> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
>> warping not existing pixels. Why? Warping begins with the destination 
>> window size of entire output image size. If this size is larger than 
>> dfWarpMemoryLimit it is split in half along the longest axis and any 
>> half that doesn't contain the currently processed source file is 
>> discarded. With large dfWarpMemoryLimit this subdivision process will 
>> stop early with still large portions of out of source image pixels.
>>
> 
> Given Adam's explanations above, could someone tell me if my below 
> assumptions are correct? Thanks.
> 
> Just to repeat, the input files are ASTER GTiffs in WGS84, 3601x3601 
> pixels each. The output is a single mosaic of all tiles, a 100m GTiff, 
> in LAEA projection
> 
> 
> gdalwarp -wm 300 --config GDAL_CACHEMAX 300 --debug on ... reports:
> 
> Src=0,0,3601x3601 Dst=36375,31125,12125x10375
> 
> I understand this as follows: the source image of 3601x3601 pixels is 
> read as one chunk (which after reprojection and resampling should be 
> around 800x1100 pixels). However, 12125x10375 pixels are actually 
> written to the output file. So 99.5% of the destination window must be 
> completely unrelated to my input image.
> 
> If I counter-intuitively reduce the memory limit to, say: 40 MB and 
> leave anything else unchanged, then gdalwarp behaviour changes to
> 
> Src=0,0,3601x3601 Dst=45468,38906,1516x2594
> 
> This tells me that the destination window is much smaller and gdalwarp 
> will not waste time to write out so many irrelevant pixels, correct?
> 
> Perhaps gdalwarp should not only test if the destination window fits 
> into memory, but also check what would be the minimum destination window 
> for warping the input image. This could speed up the mosaicing of small 
> tiles into a bigger output file.
> 
> Hermann
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From tozjerimiah at gmail.com  Mon Aug 24 08:47:54 2009
From: tozjerimiah at gmail.com (tozjerimiah)
Date: Mon Aug 24 08:47:56 2009
Subject: [Gdal-dev] ogr2ogr??
In-Reply-To: <cca8d9c50908231528v38b52d22oae7bf8317c55f454@mail.gmail.com>
References: <cca8d9c50908231528v38b52d22oae7bf8317c55f454@mail.gmail.com>
Message-ID: <1251118074300-3503075.post@n2.nabble.com>


Can anyone help with this? Or point me to a source of information?

Thanks v much.


tozjerimiah wrote:
> 
> Hello,
> 
> I am wondering if anyone can help with a problem which I have to solve: I
> want to take coordinates in meters from an ACAD file, and project them in
> lat/long as is compatible with google maps. I understand that ogr2ogr is
> the
> way forward. I expect that I will have to shift the x,y coords in my
> drawing
> to UTM which I am happy with.
> 
> However:
> 
> 1. I do not know what format ogr2ogr expects the UTM data to be in.
> 2. I would appreciate it if someone could tell me what t-srs is correct to
> get google style lat/long (or something which can be made to work)
> 
> If you can assist I would appreciate:
> 1. A UTM data file which ogr2ogr understands so that I can base my output
> on
> that.
> 2. The command line which I need to pass to get the correct data out.
> 
> Apologies if I have posted to the wrong place - let me know where I need
> to
> post if so.
> 
> Thanks,
> Toz Jerimiah
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/ogr2ogr-tp3500364p3503075.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From bartvde at osgis.nl  Mon Aug 24 08:48:44 2009
From: bartvde at osgis.nl (bartvde@osgis.nl)
Date: Mon Aug 24 09:05:32 2009
Subject: [gdal-dev] slow raster (large GDALRasterAttributeTable?)
Message-ID: <51205.145.50.39.11.1251118124.squirrel@webmail.hostingdiscounter.nl>

Hi list,

I've got a tiff file of 28 Mb and it is really slow, so I am assuming the
classification gets applied on the fly or something like that.

If I do a gdalinfo I get a huge list of STATISTICS_HISTOBINVALUES

  Metadata:
    STATISTICS_MINIMUM=-5838
    STATISTICS_MAXIMUM=4225
    STATISTICS_MEAN=-1010.4585191036
    STATISTICS_MEDIAN=-212
    STATISTICS_MODE=1
    STATISTICS_STDDEV=1833.0113850333
    LAYER_TYPE=athematic
    STATISTICS_HISTOBINVALUES=1|1|1|1|1|1|1|1|1|1|1|2|1|2|1|1|1|2|1|1|1|1.......

Also, the GDALRasterAttributeTable has 9150 rows. Don't know if this is
related.

Any ideas on how to speed this up? I tried to write it out to a new
GeoTiff or MrSID file, but somehow all this info is preserved, and the
slowness continues.

TIA.

Best regards,
Bart

From abhay.menon at gmail.com  Mon Aug 24 12:00:23 2009
From: abhay.menon at gmail.com (Abhay)
Date: Mon Aug 24 12:00:48 2009
Subject: [Gdal-dev] ogr2ogr??
In-Reply-To: <1251118074300-3503075.post@n2.nabble.com>
References: <cca8d9c50908231528v38b52d22oae7bf8317c55f454@mail.gmail.com> 
	<1251118074300-3503075.post@n2.nabble.com>
Message-ID: <7a30cd70908240900q386808b2l530983d61896bdab@mail.gmail.com>

On Mon, Aug 24, 2009 at 6:17 PM, tozjerimiah <tozjerimiah@gmail.com> wrote:

>
> Can anyone help with this? Or point me to a source of information?
>
> Thanks v much.
>
>
> tozjerimiah wrote:
> >
> > Hello,
> >
> > I am wondering if anyone can help with a problem which I have to solve: I
> > want to take coordinates in meters from an ACAD file, and project them in
> > lat/long as is compatible with google maps. I understand that ogr2ogr is
> > the
> > way forward. I expect that I will have to shift the x,y coords in my
> > drawing
> > to UTM which I am happy with.
> >
> > However:
> >
> > 1. I do not know what format ogr2ogr expects the UTM data to be in.
> > 2. I would appreciate it if someone could tell me what t-srs is correct
> to
> > get google style lat/long (or something which can be made to work)
> >
> > If you can assist I would appreciate:
> > 1. A UTM data file which ogr2ogr understands so that I can base my output
> > on
> > that.
> > 2. The command line which I need to pass to get the correct data out.
> >
> > Apologies if I have posted to the wrong place - let me know where I need
> > to
> > post if so.
> >
> > Thanks,
> > Toz Jerimiah
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
> --
> View this message in context:
> http://n2.nabble.com/ogr2ogr-tp3500364p3503075.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Have you tried the online source at www.gdal.org/ogr and proj.osgeo.org

if you can programme.. use this http://gdal.org/ogr/osr_tutorial.html else
look for CS2CS under PROJ.4

Rgds.

Abhay.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090824/52265817/attachment.html
From peifer at gmx.eu  Mon Aug 24 13:05:32 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Mon Aug 24 13:05:07 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A928A6E.4050206@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>	<4A8FBB20.2040509@xpam.de>	<4A9286A8.70106@gmx.eu>
	<4A928A6E.4050206@xpam.de>
Message-ID: <4A92C85C.9090203@gmx.eu>

Adam Nowacki wrote:
> You can test with http://pastebin.com/m45e46f53
> Also remember to use -wo SKIP_NOSOURCE=YES
> 

Now the input images are read in many chunks, rather than 1 (or max 2) 
before. Nevertheless, the performance is really great. Now, 100 tiles 
are warped in 5 minutes! That's 4-5 times faster than anything else I 
tried before.

Hermann


Before applying the patch, with intentionally small memory
(-wm 40, which was fastest, as far as I could see)

GDAL: GDALOpen(unzipped/ASTGTM_N30E039_dem.tif, this=0x9711470) succeeds 
as GTiff.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=0,0,3601x2185 Dst=42437,38906,3031x2594
GDAL: Potential thrashing on band 1 of unzipped/ASTGTM_N30E039_dem.tif.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=636,0,2965x3601 Dst=45468,38906,3032x2594
GDAL: GDALClose(unzipped/ASTGTM_N30E039_dem.tif, this=0x9711470)


After applying the patch, with -wm 300 --config GDAL_CACHEMAX 300
(and -wo SKIP_NOSOURCE=YES, which I always used)

GDAL: GDALOpen(unzipped/ASTGTM_N30E039_dem.tif, this=0x86f5dd0) succeeds 
as GTiff.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=704,0,435x91 Dst=45278,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=1042,0,435x207 Dst=45373,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=0,0,1383x2185 Dst=45089,40851,379x649
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=1380,0,863x439 Dst=45468,40689,189x162
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=2051,0,1058x673 Dst=45657,40527,190x324
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=2725,0,876x908 Dst=45847,40527,189x324
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3585,167,16x368 Dst=46036,40608,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3490,413,111x367 Dst=46036,40689,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3395,659,206x367 Dst=46036,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=636,204,2965x2911 Dst=45468,40851,758x649
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3592,2125,9x366 Dst=46226,41175,94x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3498,2371,103x366 Dst=46226,41256,94x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3309,2617,292x615 Dst=46226,41337,94x163
GDAL: GDALClose(unzipped/ASTGTM_N30E039_dem.tif, this=0x86f5dd0)























> Hermann Peifer wrote:
>> Adam Nowacki wrote:
>>> Some rather counterintuitive gdalwarp behavior: the bigger 
>>> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
>>> warping not existing pixels. Why? Warping begins with the destination 
>>> window size of entire output image size. If this size is larger than 
>>> dfWarpMemoryLimit it is split in half along the longest axis and any 
>>> half that doesn't contain the currently processed source file is 
>>> discarded. With large dfWarpMemoryLimit this subdivision process will 
>>> stop early with still large portions of out of source image pixels.
>>>
>>
>> Given Adam's explanations above, could someone tell me if my below 
>> assumptions are correct? Thanks.
>>
>> Just to repeat, the input files are ASTER GTiffs in WGS84, 3601x3601 
>> pixels each. The output is a single mosaic of all tiles, a 100m GTiff, 
>> in LAEA projection
>>
>>
>> gdalwarp -wm 300 --config GDAL_CACHEMAX 300 --debug on ... reports:
>>
>> Src=0,0,3601x3601 Dst=36375,31125,12125x10375
>>
>> I understand this as follows: the source image of 3601x3601 pixels is 
>> read as one chunk (which after reprojection and resampling should be 
>> around 800x1100 pixels). However, 12125x10375 pixels are actually 
>> written to the output file. So 99.5% of the destination window must be 
>> completely unrelated to my input image.
>>
>> If I counter-intuitively reduce the memory limit to, say: 40 MB and 
>> leave anything else unchanged, then gdalwarp behaviour changes to
>>
>> Src=0,0,3601x3601 Dst=45468,38906,1516x2594
>>
>> This tells me that the destination window is much smaller and gdalwarp 
>> will not waste time to write out so many irrelevant pixels, correct?
>>
>> Perhaps gdalwarp should not only test if the destination window fits 
>> into memory, but also check what would be the minimum destination 
>> window for warping the input image. This could speed up the mosaicing 
>> of small tiles into a bigger output file.
>>
>> Hermann
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>

From peifer at gmx.eu  Mon Aug 24 13:05:32 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Mon Aug 24 13:05:30 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A928A6E.4050206@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>	<4A8FBB20.2040509@xpam.de>	<4A9286A8.70106@gmx.eu>
	<4A928A6E.4050206@xpam.de>
Message-ID: <4A92C85C.9090203@gmx.eu>

Adam Nowacki wrote:
> You can test with http://pastebin.com/m45e46f53
> Also remember to use -wo SKIP_NOSOURCE=YES
> 

Now the input images are read in many chunks, rather than 1 (or max 2) 
before. Nevertheless, the performance is really great. Now, 100 tiles 
are warped in 5 minutes! That's 4-5 times faster than anything else I 
tried before.

Hermann


Before applying the patch, with intentionally small memory
(-wm 40, which was fastest, as far as I could see)

GDAL: GDALOpen(unzipped/ASTGTM_N30E039_dem.tif, this=0x9711470) succeeds 
as GTiff.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=0,0,3601x2185 Dst=42437,38906,3031x2594
GDAL: Potential thrashing on band 1 of unzipped/ASTGTM_N30E039_dem.tif.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=636,0,2965x3601 Dst=45468,38906,3032x2594
GDAL: GDALClose(unzipped/ASTGTM_N30E039_dem.tif, this=0x9711470)


After applying the patch, with -wm 300 --config GDAL_CACHEMAX 300
(and -wo SKIP_NOSOURCE=YES, which I always used)

GDAL: GDALOpen(unzipped/ASTGTM_N30E039_dem.tif, this=0x86f5dd0) succeeds 
as GTiff.
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=704,0,435x91 Dst=45278,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=1042,0,435x207 Dst=45373,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=0,0,1383x2185 Dst=45089,40851,379x649
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=1380,0,863x439 Dst=45468,40689,189x162
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=2051,0,1058x673 Dst=45657,40527,190x324
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=2725,0,876x908 Dst=45847,40527,189x324
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3585,167,16x368 Dst=46036,40608,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3490,413,111x367 Dst=46036,40689,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3395,659,206x367 Dst=46036,40770,95x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=636,204,2965x2911 Dst=45468,40851,758x649
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3592,2125,9x366 Dst=46226,41175,94x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3498,2371,103x366 Dst=46226,41256,94x81
GDAL: GDALWarpKernel()::GWKGeneralCase()
Src=3309,2617,292x615 Dst=46226,41337,94x163
GDAL: GDALClose(unzipped/ASTGTM_N30E039_dem.tif, this=0x86f5dd0)























> Hermann Peifer wrote:
>> Adam Nowacki wrote:
>>> Some rather counterintuitive gdalwarp behavior: the bigger 
>>> dfWarpMemoryLimit (-wm setting) the more cpu time will be wasted on 
>>> warping not existing pixels. Why? Warping begins with the destination 
>>> window size of entire output image size. If this size is larger than 
>>> dfWarpMemoryLimit it is split in half along the longest axis and any 
>>> half that doesn't contain the currently processed source file is 
>>> discarded. With large dfWarpMemoryLimit this subdivision process will 
>>> stop early with still large portions of out of source image pixels.
>>>
>>
>> Given Adam's explanations above, could someone tell me if my below 
>> assumptions are correct? Thanks.
>>
>> Just to repeat, the input files are ASTER GTiffs in WGS84, 3601x3601 
>> pixels each. The output is a single mosaic of all tiles, a 100m GTiff, 
>> in LAEA projection
>>
>>
>> gdalwarp -wm 300 --config GDAL_CACHEMAX 300 --debug on ... reports:
>>
>> Src=0,0,3601x3601 Dst=36375,31125,12125x10375
>>
>> I understand this as follows: the source image of 3601x3601 pixels is 
>> read as one chunk (which after reprojection and resampling should be 
>> around 800x1100 pixels). However, 12125x10375 pixels are actually 
>> written to the output file. So 99.5% of the destination window must be 
>> completely unrelated to my input image.
>>
>> If I counter-intuitively reduce the memory limit to, say: 40 MB and 
>> leave anything else unchanged, then gdalwarp behaviour changes to
>>
>> Src=0,0,3601x3601 Dst=45468,38906,1516x2594
>>
>> This tells me that the destination window is much smaller and gdalwarp 
>> will not waste time to write out so many irrelevant pixels, correct?
>>
>> Perhaps gdalwarp should not only test if the destination window fits 
>> into memory, but also check what would be the minimum destination 
>> window for warping the input image. This could speed up the mosaicing 
>> of small tiles into a bigger output file.
>>
>> Hermann
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>

From warmerdam at pobox.com  Mon Aug 24 14:05:30 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 24 14:06:02 2009
Subject: [gdal-dev] slow raster (large GDALRasterAttributeTable?)
In-Reply-To: <51205.145.50.39.11.1251118124.squirrel@webmail.hostingdiscounter.nl>
References: <51205.145.50.39.11.1251118124.squirrel@webmail.hostingdiscounter.nl>
Message-ID: <4A92D66A.9030804@pobox.com>

bartvde@osgis.nl wrote:
> Hi list,
> 
> I've got a tiff file of 28 Mb and it is really slow, so I am assuming the
> classification gets applied on the fly or something like that.
> 
> If I do a gdalinfo I get a huge list of STATISTICS_HISTOBINVALUES
> 
>   Metadata:
>     STATISTICS_MINIMUM=-5838
>     STATISTICS_MAXIMUM=4225
>     STATISTICS_MEAN=-1010.4585191036
>     STATISTICS_MEDIAN=-212
>     STATISTICS_MODE=1
>     STATISTICS_STDDEV=1833.0113850333
>     LAYER_TYPE=athematic
>     STATISTICS_HISTOBINVALUES=1|1|1|1|1|1|1|1|1|1|1|2|1|2|1|1|1|2|1|1|1|1.......
> 
> Also, the GDALRasterAttributeTable has 9150 rows. Don't know if this is
> related.
> 
> Any ideas on how to speed this up? I tried to write it out to a new
> GeoTiff or MrSID file, but somehow all this info is preserved, and the
> slowness continues.

Bart,

Could you provide the dataset?  I'd be interested in reviewing the
performance of the raster attribute table logic with an eye towards
optimizing it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Mon Aug 24 15:57:51 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 24 15:59:12 2009
Subject: [gdal-dev] Problem with GDALGetProjectionRef
In-Reply-To: <3168.79.205.42.128.1251115395.squirrel@webmail.rz.uni-osnabrueck.de>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<3168.79.205.42.128.1251115395.squirrel@webmail.rz.uni-osnabrueck.de>
Message-ID: <4A92F0BF.5090603@pobox.com>

Florian Hillen wrote:
> gdalinfo delivers the right projection:
> 
> PROJCS["unnamed",
>     GEOGCS["DHDN",
>         DATUM["Deutsches_Hauptdreiecksnetz",
>             SPHEROID["Bessel 1841",6377397.155,299.1528128000009,
>                 AUTHORITY["EPSG","7004"]],
>             AUTHORITY["EPSG","6314"]],
> [...]
> 
> GDALGetProjectionRef delivers the following WKT string (some of you know
> this from some earlier mails):
> 
> PROJCS["unnamed",
> GEOGCS["DHDN",
> DATUM["unknown",
> SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
> PRIMEM["Greenwich",0],
> UNIT["degree",0.0174532925199433],
> AUTHORITY["EPSG","4314"]],
> [...]
> 
> In the earlier mails I thought that the warp doesn't work correct, but
> apparently the warp is correct, because I use the same file for gdalinfo
> and in my plugin. So the problem must be GDALGetProjectionRef!?

Florian,

Two possibilities come to mind.

1) In your plugin the environment isn't correct and some .csv lookups
are failing which are used to fill out the datum information.

2) You are using a different version of GDAL in your plugin and it has
slightly different code for handling the coordinate system.

There is no apparent problem with the code you included.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From noah.solomon at ngc.com  Mon Aug 24 16:30:19 2009
From: noah.solomon at ngc.com (nsolomon)
Date: Mon Aug 24 16:30:21 2009
Subject: [Gdal-dev] Nitf Creation Spanning International Date Line
Message-ID: <1251145819283-3505900.post@n2.nabble.com>


Hi,

I'm having some troubles creating a Nitf image that spans the International
Date Line (180/-180 degrees longitude).  If I have an image that has a
western edge of around 150 degrees and an eastern edge of -150 degrees, I am
getting the following error "Attempt to write geographic bound outside of
legal range."  Are there any special considerations I need to take in order
to do this?  Has anyone seen any errors doing this type of thing before?

Thanks.
-- 
View this message in context: http://n2.nabble.com/Nitf-Creation-Spanning-International-Date-Line-tp3505900p3505900.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From even.rouault at mines-paris.org  Mon Aug 24 17:01:03 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug 24 17:01:06 2009
Subject: [Gdal-dev] Nitf Creation Spanning International Date Line
In-Reply-To: <1251145819283-3505900.post@n2.nabble.com>
References: <1251145819283-3505900.post@n2.nabble.com>
Message-ID: <1251147663.4a92ff8f75936@imp.free.fr>

Selon nsolomon <noah.solomon@ngc.com>:

>
> Hi,
>
> I'm having some troubles creating a Nitf image that spans the International
> Date Line (180/-180 degrees longitude).  If I have an image that has a
> western edge of around 150 degrees and an eastern edge of -150 degrees, I am
> getting the following error "Attempt to write geographic bound outside of
> legal range."  Are there any special considerations I need to take in order
> to do this?  Has anyone seen any errors doing this type of thing before?

Generally speaking, GDAL would have trouble to handle such images that spans the
anti-meridian. I had pushed in the past a patch in the NITF driver to recognize
(reading only) some CADRG tiles that have that property but it appeared to be
fairly fragile logic. It has been changed a few times because some users
reported that non north-up images could trigger the first version of the test in
the fix...

See nitfimage.c at line 1050 in trunk :

    /* Bug #1750 */
    /* Fix for cjnc/cjncz01/000k1023.jn1 (and similar) from NIMA GNCJNCN CDROM:
*/
    /* this product is crossing meridian 180deg and the upper and lower right
longitudes are negative (<-170) */
    /* while the upper and lower left longitudes are positive (> 170) which
causes problems in OpenEV, etc... */
    /* So we are adjusting the upper and lower right longitudes by setting them
above +180 */
    if( (psImage->chICORDS == 'G' || psImage->chICORDS == 'D') &&
        (psImage->dfULX > 170 && psImage->dfLLX > 170 && psImage->dfURX < -170
&& psImage->dfLRX < -170 &&
         psImage->dfULY > psImage->dfLLY && psImage->dfURY > psImage->dfLRY) )
    {
        psImage->dfURX += 360;
        psImage->dfLRX += 360;
    }


As far as writting such images is concerned, GDAL checks that the 4 corner
coordinates are valid in frmts/nitf/nitfimage.c at line 1887 and 1911 (in trunk)

        if( fabs(dfULX) > 180 || fabs(dfURX) > 180
            || fabs(dfLRX) > 180 || fabs(dfLLX) > 180
            || fabs(dfULY) >  90 || fabs(dfURY) >  90
            || fabs(dfLRY) >  90 || fabs(dfLLY) >  90 )
        {
            CPLError( CE_Failure, CPLE_AppDefined,
                      "Attempt to write geographic bound outside of legal
range." );
            return FALSE;
        }

I suppose that your topleft coordinates (adfGeoTransform[0], adfGeoTransform[3])
are around longitude 150 and that the computed east coordinates by GDAL are 150
+ east-west-resolution * width = 210, which is -150 + 360. 210 is not a legal
longitude, hence the above tests fails on dfLRX and dfURX. I suppose you could
fix that by adding the following code just before the tests.

       if ( dfURX > 180 ) dfURX -= 360;
       if ( dfLRX > 180 ) dfLRX -= 360;

We could perhaps push that change (maybe restricted to the north-up case)
without causing regressions, but I'm not too sure to what to do with the reading
part. In your example, for reading it back correctly, you should change the 170
value in the first code extract to 150.

>
> Thanks.
> --
> View this message in context:
>
http://n2.nabble.com/Nitf-Creation-Spanning-International-Date-Line-tp3505900p3505900.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From warmerdam at pobox.com  Mon Aug 24 17:39:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 24 17:40:00 2009
Subject: [gdal-dev] GDAL Erdas LAN/GIS driver
In-Reply-To: <alpine.LRH.2.00.0908211846100.7507@reclus.nhh.no>
References: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>
	<4A8E9E9F.5060505@pobox.com>
	<alpine.LRH.2.00.0908211606220.7507@reclus.nhh.no>
	<alpine.LRH.2.00.0908211846100.7507@reclus.nhh.no>
Message-ID: <4A930898.4090703@pobox.com>

Roger Bivand wrote:
> 
> (reverting to list)
> 
> Correction, the user reported that:
> 
>> Apparently, gdalinfo retrieves the correct min, max, and statistics, 
>> despite the use of GDT_Int16.
> 
> on his Windows platform. The different GDAL versions ought to explain 
> why his gdalinfo says Int16 but gives statistics from UInt16.
...
> On the trunk, GDT_Int16 is used too, so how does gdalinfo detect that it 
> is actually UInt16?

Roger,

I believe the min/max is actually being read from the file header in trunk
and is handled without regard to the actual imagery or it's type.

I skimmed the changelog for this driver and I didn't notice any obvious
changes in metadata / statistics handling so I'm surprised at this result.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From markus.reinhold at uni-jena.de  Mon Aug 24 18:06:39 2009
From: markus.reinhold at uni-jena.de (Markus Reinhold)
Date: Mon Aug 24 18:06:28 2009
Subject: [gdal-dev] Extracting band from raster stack & ENVI Header question
Message-ID: <4A930EEF.7040400@uni-jena.de>

Hejhej,
please allow me two short questions:
1) Using the GDAL Python bindings I currently need to extract a single 
band from a raster stack and save it in a different format, i.e. ENVI. 
To achieve this my processing includes
(a) analysis of the source dataset and desired band (width, height, 
pixel size, data type, geotransform),
(b) creation of a temporary in-memory dataset with one band (using 
Driver.Create()) that is identical with the desired source band except 
that it is all black and
(c) creation of a copy of the temporary dataset (using 
Driver.CreateCopy()) and setting it according to the original data 
(using RasterBand.ReadAsArray() and RasterBand.WriteArray()).
I found the second step necessary as for ENVI data it is only possible 
to create datasets using Driver.CreateCopy() for which a template is 
needed - hence the temporary single band dataset... My solution works, I 
find it a bit awkward though. Is there a simpler way to do this?
2) Another question concerning the creation of ENVI datasets with GDAL. 
I had been under the impression that *map info* strings for the ENVI 
header weren't created when copying another dataset. Now I have found 
that when the dataset is in a certain projection and coordinate system, 
i.e. UTM/WGS84 in my case, this is done after all. Is there any rule for 
which configurations GDAL is able to create a *map info*-section in the 
ENVI header?
Thank you very much in advance.
Regards,
Markus

-- 

********************************************************
Dipl.-Kartograph Markus Reinhold

Chair of Geoinformatics, Geohydrology and Modeling
Friedrich-Schiller-University Jena
L?bdergraben 32
D - 07743 Jena
Germany

Phone.: (+49)(0)3641 / 9 488 65
E-Mail: markus.reinhold@uni-jena.de
********************************************************
From jon at gina.alaska.edu  Mon Aug 24 18:20:57 2009
From: jon at gina.alaska.edu (Jonathan Sawyer)
Date: Mon Aug 24 18:20:58 2009
Subject: [gdal-dev] Python gdal -- Class or function equivalent to 
	`gdaltransform'
In-Reply-To: <4A8F5208.60605@pobox.com>
References: <5cab99fd0908211823w2bd05954t3e2f1faab2ae3562@mail.gmail.com>
	<4A8F5208.60605@pobox.com>
Message-ID: <5cab99fd0908241520y2db55c41ref7eec11901cd1fa@mail.gmail.com>

Frank (and all):

Thanks for the information. Using this link:

http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/tolatlong.py

I was able to figure out how to transform points from one EPSG coordinate
system to another using Python. Here's how:

#transform()
def transform(i_srs, o_srs, lon, lat):
    # i_srs looks like "EPSG:4326"
    # o_srs looks like "EPSG:3338"

    from osgeo import osr

    i_num = int(i_srs.split(':')[1]) #obtain the EPSG number
    o_num = int(o_srs.split(':')[1]) #obtain the EPSG number

    srs_in = osr.SpatialReference() #create an input Spatial Reference
    srs_in.ImportFromEPSG(i_num) #import from EPSG:4326

    srs_out = osr.SpatialReference() #create an output Spatial Reference
    srs_out.ImportFromEPSG(o_num) #import from EPSG:3338

    ct = osr.CoordinateTransformation(srs_in, srs_out)
#CoordinateTransformation object from EPSG:4326 to EPSG:3338
    (X, Y, height) = ct.TransformPoint(float(lon), float(lat)) #Calculate
our transformed points

    return (X, Y, height)
#the returned values give exactly what is expected as per my previous email
#end of script

Thanks again everyone!

Jon

On Fri, Aug 21, 2009 at 6:03 PM, Frank Warmerdam <warmerdam@pobox.com>wrote:

> Jonathan Sawyer wrote:
>
>> Good evening developers,
>>
>> I am very new to GDAL, so please bear with me.
>>
>> What function/class/module do I need to look at to perform coordinate
>> transformation, in Python?
>>
>> Or better yet, can anyone point me to good online docs to learn how the
>> Python bindings are used in gdal?
>>
>> FYI: I am looking for the equivalent to this command line example:
>>
>> $ gdaltransform -s_srs EPSG:4326 -t_srs EPSG:3338
>> -146.673599867, 64.7163624865
>> 348408.577415968 1658661.40355536 0
>>
>> Have a good weekend, and thanks for your help.
>>
>
> Jonathan,
>
> There are some pointers to sample python scripts at:
>
>  http://trac.osgeo.org/gdal/wiki/GdalOgrInPython
>
> The tolatlong.py script has some example script for transforming
> points:
>
>  http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/tolatlong.py
>
> Good luck,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>


-- 
Jonathan Sawyer
Geographic Information Network of Alaska (GINA)
University of Alaska Fairbanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090824/e5113d98/attachment.html
From chaitanya.ch at gmail.com  Tue Aug 25 03:45:20 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Tue Aug 25 03:45:23 2009
Subject: [gdal-dev] Extracting band from raster stack & ENVI Header 
	question
In-Reply-To: <4A930EEF.7040400@uni-jena.de>
References: <4A930EEF.7040400@uni-jena.de>
Message-ID: <eb502d880908250045l56b08a1br63458a7ea2dd4478@mail.gmail.com>

 Markus,

On Mon, Aug 24, 2009 at 10:06 PM, Markus Reinhold <
markus.reinhold@uni-jena.de> wrote:

> Hejhej,
> please allow me two short questions:
> 1) Using the GDAL Python bindings I currently need to extract a single band
> from a raster stack and save it in a different format, i.e. ENVI. To achieve
> this my processing includes
> (a) analysis of the source dataset and desired band (width, height, pixel
> size, data type, geotransform),
> (b) creation of a temporary in-memory dataset with one band (using
> Driver.Create()) that is identical with the desired source band except that
> it is all black and
> (c) creation of a copy of the temporary dataset (using Driver.CreateCopy())
> and setting it according to the original data (using
> RasterBand.ReadAsArray() and RasterBand.WriteArray()).
> I found the second step necessary as for ENVI data it is only possible to
> create datasets using Driver.CreateCopy() for which a template is needed -
> hence the temporary single band dataset... My solution works, I find it a
> bit awkward though. Is there a simpler way to do this?


I am not sure what all you are trying to do here but the utility program
'gdal_translate' (http://gdal.org/gdal_utilities.html) may help you. There
are some other programs described in that page.


>
> 2) Another question concerning the creation of ENVI datasets with GDAL. I
> had been under the impression that *map info* strings for the ENVI header
> weren't created when copying another dataset. Now I have found that when the
> dataset is in a certain projection and coordinate system, i.e. UTM/WGS84 in
> my case, this is done after all. Is there any rule for which configurations
> GDAL is able to create a *map info*-section in the ENVI header?


I don't know much about the ENVI driver but a glance at the source code
shows that 'map info' is hard-coded. You can take a look at the current
development snapshot at
http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/raw/envidataset.cpp


>
> Thank you very much in advance.
> Regards,
> Markus
>
> --
>
> ********************************************************
> Dipl.-Kartograph Markus Reinhold
>
> Chair of Geoinformatics, Geohydrology and Modeling
> Friedrich-Schiller-University Jena
> L?bdergraben 32
> D - 07743 Jena
> Germany
>
> Phone.: (+49)(0)3641 / 9 488 65
> E-Mail: markus.reinhold@uni-jena.de
> ********************************************************
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090825/43bd2d91/attachment-0001.html
From chaitanya.ch at gmail.com  Tue Aug 25 03:55:37 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Tue Aug 25 03:55:40 2009
Subject: [Gdal-dev] Compress via NTFS or in-image for performance?
In-Reply-To: <1250875240325-3491435.post@n2.nabble.com>
References: <1250875240325-3491435.post@n2.nabble.com>
Message-ID: <eb502d880908250055s1788c4efjd497f0d9d3507465@mail.gmail.com>

Matt,

NTFS compression is typically implemented for generic data. On the other
hand, the raster compression algorithms do it based on the heuristics of the
image data. It is bound to be better. You will even have an option of
choosing how lossy the compression should be with these algorithms. Tiff lzw
typically uses lossless compression.

In my experience NTFS compression slows down disk access time significantly.
I noticed this on my slow and old system.

On Fri, Aug 21, 2009 at 5:20 PM, Matt Wilkie <maphew@gmail.com> wrote:

>
> Dear GDAL,
>
> Any thoughts on whether the best read/write performance vs disk space used
> is achieved through file system compression or in-raster compression? The
> former would be via Windows NTFS compact and the latter via TIFF LZW or
> perhaps JP2.
>
> thanks,
>
> -matt
> --
> View this message in context:
> http://n2.nabble.com/Compress-via-NTFS-or-in-image-for-performance-tp3491435p3491435.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090825/bd27172c/attachment.html
From chaitanya.ch at gmail.com  Tue Aug 25 04:46:02 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Tue Aug 25 04:46:04 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
Message-ID: <eb502d880908250146h55a417d0q6f2c1613c89ba70b@mail.gmail.com>

'anon',

You can use the GDAL Python bindings for this. Refer to
http://trac.osgeo.org/gdal/wiki/GdalOgrInPython
You can also use any other language you like shown at
http://www.gdal.org/#index_bindings

On Thu, Aug 20, 2009 at 5:44 PM, questions anon <questions.anon@gmail.com>wrote:

> Can anyone get me started on a script that can -
>
>  -Open a shapefile
>
>  -Open many rasters
>
>  -Calculate the mean and standard deviation of those rasters within the
> shapefile region, but is able to ignore areas of zeros or NoData
>
>  -Output the mean and standard deviation to a table
>
>  Otherwise any tutorials or books that I could follow to work this out
> would be greatly appreciated! Thanks!
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090825/2acf13ff/attachment.html
From fhillen at uni-osnabrueck.de  Tue Aug 25 06:58:58 2009
From: fhillen at uni-osnabrueck.de (Florian Hillen)
Date: Tue Aug 25 07:04:55 2009
Subject: [gdal-dev] Problem with GDALGetProjectionRef
In-Reply-To: <4A92F0BF.5090603@pobox.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<3168.79.205.42.128.1251115395.squirrel@webmail.rz.uni-osnabrueck.de>
	<4A92F0BF.5090603@pobox.com>
Message-ID: <1908.79.205.22.15.1251197938.squirrel@webmail.rz.uni-osnabrueck.de>

> Florian Hillen wrote:
>> gdalinfo delivers the right projection:
>>
>> PROJCS["unnamed",
>>     GEOGCS["DHDN",
>>         DATUM["Deutsches_Hauptdreiecksnetz",
>>             SPHEROID["Bessel 1841",6377397.155,299.1528128000009,
>>                 AUTHORITY["EPSG","7004"]],
>>             AUTHORITY["EPSG","6314"]],
>> [...]
>>
>> GDALGetProjectionRef delivers the following WKT string (some of you know
>> this from some earlier mails):
>>
>> PROJCS["unnamed",
>> GEOGCS["DHDN",
>> DATUM["unknown",
>> SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
>> PRIMEM["Greenwich",0],
>> UNIT["degree",0.0174532925199433],
>> AUTHORITY["EPSG","4314"]],
>> [...]
>>
>> In the earlier mails I thought that the warp doesn't work correct, but
>> apparently the warp is correct, because I use the same file for gdalinfo
>> and in my plugin. So the problem must be GDALGetProjectionRef!?
>
> Florian,
>
> Two possibilities come to mind.
>
> 1) In your plugin the environment isn't correct and some .csv lookups
> are failing which are used to fill out the datum information.
>
> 2) You are using a different version of GDAL in your plugin and it has
> slightly different code for handling the coordinate system.
>
> There is no apparent problem with the code you included.
>
> Best regards,
> --
>


Hi Frank,

thanks for your help. After building qgis with different gdal versions
(which didn't helped), I check all environment variables which are set by
the setfwenv.bat from FWTools. The variable that was missing and makes
every work fine now is GEOTIFF_CSV=%FWTOOLS_DIR%\data.

Thanks for your patience ;)

Best regards,
Florian
From maphew at gmail.com  Tue Aug 25 12:53:09 2009
From: maphew at gmail.com (Matt Wilkie)
Date: Tue Aug 25 12:53:11 2009
Subject: [Gdal-dev] Compress via NTFS or in-image for performance?
In-Reply-To: <eb502d880908250055s1788c4efjd497f0d9d3507465@mail.gmail.com>
References: <1250875240325-3491435.post@n2.nabble.com>
	<eb502d880908250055s1788c4efjd497f0d9d3507465@mail.gmail.com>
Message-ID: <1251219189160-3511342.post@n2.nabble.com>


Thanks for your thoughts Chaitanya. 
I was hoping someone might have some data, but it looks like I might have to
devise some tests and see which route works best in our environment. :)

cheers,

-matt
-- 
View this message in context: http://n2.nabble.com/Compress-via-NTFS-or-in-image-for-performance-tp3491435p3511342.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From bartvde at osgis.nl  Tue Aug 25 12:58:02 2009
From: bartvde at osgis.nl (Bart van den Eijnden (OSGIS))
Date: Tue Aug 25 13:55:42 2009
Subject: [gdal-dev] slow raster (large GDALRasterAttributeTable?)
In-Reply-To: <4A92D66A.9030804@pobox.com>
References: <51205.145.50.39.11.1251118124.squirrel@webmail.hostingdiscounter.nl>
	<4A92D66A.9030804@pobox.com>
Message-ID: <4A94181A.1020301@osgis.nl>

Hi Frank,

I can (I'll send it to you off-list on Thursday), but the problem 
appears to be different. I overlooked the fact that the classification 
is being done in Mapserver (about 30 classes), but even with 
scalebuckets set I can't get it to speed up.

Best regards,
Bart

Frank Warmerdam wrote:
> bartvde@osgis.nl wrote:
>> Hi list,
>>
>> I've got a tiff file of 28 Mb and it is really slow, so I am assuming 
>> the
>> classification gets applied on the fly or something like that.
>>
>> If I do a gdalinfo I get a huge list of STATISTICS_HISTOBINVALUES
>>
>>   Metadata:
>>     STATISTICS_MINIMUM=-5838
>>     STATISTICS_MAXIMUM=4225
>>     STATISTICS_MEAN=-1010.4585191036
>>     STATISTICS_MEDIAN=-212
>>     STATISTICS_MODE=1
>>     STATISTICS_STDDEV=1833.0113850333
>>     LAYER_TYPE=athematic
>>     
>> STATISTICS_HISTOBINVALUES=1|1|1|1|1|1|1|1|1|1|1|2|1|2|1|1|1|2|1|1|1|1....... 
>>
>>
>> Also, the GDALRasterAttributeTable has 9150 rows. Don't know if this is
>> related.
>>
>> Any ideas on how to speed this up? I tried to write it out to a new
>> GeoTiff or MrSID file, but somehow all this info is preserved, and the
>> slowness continues.
>
> Bart,
>
> Could you provide the dataset?  I'd be interested in reviewing the
> performance of the raster attribute table logic with an eye towards
> optimizing it.
>
> Best regards,


-- 
Bart van den Eijnden
OSGIS, Open Source GIS
bartvde@osgis.nl
http://www.osgis.nl

From markus.reinhold at uni-jena.de  Tue Aug 25 19:48:45 2009
From: markus.reinhold at uni-jena.de (Markus Reinhold)
Date: Tue Aug 25 19:48:34 2009
Subject: [gdal-dev] Extracting band from raster stack & ENVI Header
	question
In-Reply-To: <eb502d880908250045l56b08a1br63458a7ea2dd4478@mail.gmail.com>
References: <4A930EEF.7040400@uni-jena.de>
	<eb502d880908250045l56b08a1br63458a7ea2dd4478@mail.gmail.com>
Message-ID: <4A94785D.1050304@uni-jena.de>

Hej,
thank you for your suggestions.

Chaitanya kumar CH schrieb:
>  Markus,
> 
> On Mon, Aug 24, 2009 at 10:06 PM, Markus Reinhold <
> markus.reinhold@uni-jena.de> wrote:
> 
>> Hejhej,
>> please allow me two short questions:
>> 1) Using the GDAL Python bindings I currently need to extract a single band
>> from a raster stack and save it in a different format, i.e. ENVI. To achieve
>> this my processing includes
>> (a) analysis of the source dataset and desired band (width, height, pixel
>> size, data type, geotransform),
>> (b) creation of a temporary in-memory dataset with one band (using
>> Driver.Create()) that is identical with the desired source band except that
>> it is all black and
>> (c) creation of a copy of the temporary dataset (using Driver.CreateCopy())
>> and setting it according to the original data (using
>> RasterBand.ReadAsArray() and RasterBand.WriteArray()).
>> I found the second step necessary as for ENVI data it is only possible to
>> create datasets using Driver.CreateCopy() for which a template is needed -
>> hence the temporary single band dataset... My solution works, I find it a
>> bit awkward though. Is there a simpler way to do this?
> 
> 
> I am not sure what all you are trying to do here but the utility program
> 'gdal_translate' (http://gdal.org/gdal_utilities.html) may help you. There
> are some other programs described in that page.

Well, I had been aware of gdal_translate, however I have to accomplish 
my objective using the GDAL API. I'll have a look at source of 
gdal_translate to see if there's something useful for me.

> 
> 
>> 2) Another question concerning the creation of ENVI datasets with GDAL. I
>> had been under the impression that *map info* strings for the ENVI header
>> weren't created when copying another dataset. Now I have found that when the
>> dataset is in a certain projection and coordinate system, i.e. UTM/WGS84 in
>> my case, this is done after all. Is there any rule for which configurations
>> GDAL is able to create a *map info*-section in the ENVI header?
> 
> 
> I don't know much about the ENVI driver but a glance at the source code
> shows that 'map info' is hard-coded. You can take a look at the current
> development snapshot at
> http://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/raw/envidataset.cpp
> 

Okay, that pretty much answers my questions. I created my own script to 
add the map info line to the headerfile after copying the dataset. Since 
my test data were in a pretty obscure projection and coordinate system, 
GDAL didn't recognize it though. I'll adjust my script to avoid possible 
conflicts with two map info entries.

Thanks again.
Regards,
Markus


********************************************************
Dipl.-Kartograph Markus Reinhold

Chair of Geoinformatics, Geohydrology and Modeling
Friedrich-Schiller-University Jena
L?bdergraben 32
D - 07743 Jena
Germany

Phone.: (+49)(0)3641 / 9 488 65
E-Mail: markus.reinhold@uni-jena.de
********************************************************

From pssmaniam at hotmail.com  Wed Aug 26 00:41:28 2009
From: pssmaniam at hotmail.com (subramaniam)
Date: Wed Aug 26 00:41:39 2009
Subject: [Gdal-dev] Problem with compiling 1.6.2 in VC6.0
Message-ID: <1251261688032-3514057.post@n2.nabble.com>


Dear All
I have downloaded 1.6.2 source code and tried to compile in windows 32bit
with Microsoft Visual studio 6.0 version. I getting error after the
generation of the gdal-i.lib  and other library files. So i am not getting
the corresponding executive file *.dll. I need help for solving this
problem. Thanks in advance for thr help.
With warm regards
S.Subramaniam
-- 
View this message in context: http://n2.nabble.com/Problem-with-compiling-1-6-2-in-VC6-0-tp3514057p3514057.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From jgomezdans at gmail.com  Wed Aug 26 10:13:08 2009
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed Aug 26 10:13:11 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
Message-ID: <91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>

Hi,

2009/8/20 questions anon <questions.anon@gmail.com>

> Can anyone get me started on a script that can -
>
>  -Open a shapefile
>
>  -Open many rasters
>
>  -Calculate the mean and standard deviation of those rasters within the
> shapefile region, but is able to ignore areas of zeros or NoData
>
>  -Output the mean and standard deviation to a table
>
i've done a similar example to what you want here:
< http://sites.google.com/site/spatialpython/aggregating-data-to-grid-cells>
Only difference is that I calculate the histogram, rather than just the mean
and std dev. It is trivial to modify this for your own purposes. In fact,
when I get some time, I'll throw in a full "zonal stats" class, but for now
this should get you started.

J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090826/0486560e/attachment.html
From dylan.beaudette at gmail.com  Wed Aug 26 10:15:30 2009
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Aug 26 10:23:15 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
Message-ID: <3c5546140908260715v61467f2dv6787e3cde40f3f9c@mail.gmail.com>

Hi,

There is also a tool called Starspan than uses GDAL and GEOS to do
arbitrary zonal stats.

Dylan

On Wed, Aug 26, 2009 at 7:13 AM, Jose Gomez-Dans<jgomezdans@gmail.com> wrote:
> Hi,
>
> 2009/8/20 questions anon <questions.anon@gmail.com>
>>
>> Can anyone get me started on a script that can -
>>
>> ?-Open a shapefile
>>
>> ?-Open many rasters
>>
>> ?-Calculate the mean and standard deviation of those rasters within the
>> shapefile region, but is able to ignore areas of zeros or NoData
>>
>> ?-Output the mean and standard deviation to a table
>
> i've done a similar example to what you want here:
> < http://sites.google.com/site/spatialpython/aggregating-data-to-grid-cells>
> Only difference is that I calculate the histogram, rather than just the mean
> and std dev. It is trivial to modify this for your own purposes. In fact,
> when I get some time, I'll throw in a full "zonal stats" class, but for now
> this should get you started.
>
> J
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From emiliomayorga at gmail.com  Wed Aug 26 10:40:35 2009
From: emiliomayorga at gmail.com (Emilio Mayorga)
Date: Wed Aug 26 11:02:14 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
Message-ID: <b0d146420908260740y5b8940brd30d5b33e0af29f9@mail.gmail.com>

Jose,

Thanks for your pointer to your web site. Looks like you have some
very interesting and useful code there. I've been trying to do
something similar, though I use raster "zone" grids rather than vector
layers; I'd be happy to share that code, but it's too messy at this
point. I'll write a blog post about it eventually. Having Python
functionality that replicates "zonalstats" would be great, with
histogram extractions thrown in.

Dylan, Starspan has always looked very promising, but last time I
checked it looked abandoned. When I tried to use it over a year ago,
it choked on my shapefiles and said they had many invalid geometries
(it had been exported from an arc coverage using the old command-line
ArcInfo), so I gave up after trying to identify the problems. Still,
having Starspan functionality within Python would be great.

Cheers,

-Emilio Mayorga
Applied Physics Laboratory
University of Washington
Box 355640
Seattle, WA 98105-6698  USA
http://staff.washington.edu/emiliom/

On Wed, Aug 26, 2009 at 7:13 AM, Jose Gomez-Dans<jgomezdans@gmail.com> wrote:
> Hi,
>
> 2009/8/20 questions anon <questions.anon@gmail.com>
>>
>> Can anyone get me started on a script that can -
>>
>> ?-Open a shapefile
>>
>> ?-Open many rasters
>>
>> ?-Calculate the mean and standard deviation of those rasters within the
>> shapefile region, but is able to ignore areas of zeros or NoData
>>
>> ?-Output the mean and standard deviation to a table
>
> i've done a similar example to what you want here:
> < http://sites.google.com/site/spatialpython/aggregating-data-to-grid-cells>
> Only difference is that I calculate the histogram, rather than just the mean
> and std dev. It is trivial to modify this for your own purposes. In fact,
> when I get some time, I'll throw in a full "zonal stats" class, but for now
> this should get you started.
>
> J
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From warmerdam at pobox.com  Wed Aug 26 11:08:32 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 26 11:08:49 2009
Subject: [Gdal-dev] Problem with compiling 1.6.2 in VC6.0
In-Reply-To: <1251261688032-3514057.post@n2.nabble.com>
References: <1251261688032-3514057.post@n2.nabble.com>
Message-ID: <4A954FF0.2080209@pobox.com>

subramaniam wrote:
> Dear All
> I have downloaded 1.6.2 source code and tried to compile in windows 32bit
> with Microsoft Visual studio 6.0 version. I getting error after the
> generation of the gdal-i.lib  and other library files. So i am not getting
> the corresponding executive file *.dll. I need help for solving this
> problem. Thanks in advance for thr help.
> With warm regards
> S.Subramaniam

S.

The project is no longer actively trying to support VC6 which is ... pretty
old now.  But if you actually quote the error you are encountering we might
be able to provide some advice.  I imagine GDAL can be built with VC6 with
some fiddling and hacking.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From debeaudette at ucdavis.edu  Wed Aug 26 11:42:57 2009
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Wed Aug 26 11:39:10 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <b0d146420908260740y5b8940brd30d5b33e0af29f9@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
	<b0d146420908260740y5b8940brd30d5b33e0af29f9@mail.gmail.com>
Message-ID: <200908260842.58037.dylan.beaudette@gmail.com>

On Wednesday 26 August 2009, Emilio Mayorga wrote:
> Jose,
>
> Thanks for your pointer to your web site. Looks like you have some
> very interesting and useful code there. I've been trying to do
> something similar, though I use raster "zone" grids rather than vector
> layers; I'd be happy to share that code, but it's too messy at this
> point. I'll write a blog post about it eventually. Having Python
> functionality that replicates "zonalstats" would be great, with
> histogram extractions thrown in.
>
> Dylan, Starspan has always looked very promising, but last time I
> checked it looked abandoned. When I tried to use it over a year ago,
> it choked on my shapefiles and said they had many invalid geometries
> (it had been exported from an arc coverage using the old command-line
> ArcInfo), so I gave up after trying to identify the problems. Still,
> having Starspan functionality within Python would be great.


Hi Emilio,

Indeed. The current (C++) version of Starspan is more or less unsupported. I 
tend to use an older, stabler, version-- but have become frustrated with it 
in recent studies. I think that the current maintainer Jon Greenberg is 
working on an R implementation-- however I am not certain that this will 
scale well to very large rasters. A Python incantation would be more flexible 
than the current C++ version, but perhaps at a speed cost. The current 
version is blazing fast, but there aren't any C++ programmers working on it 
now. If there is sufficient interest, I would like to get it into OSGeo so 
that a more skilled programmer (than myself) can have a look at it. 

If you are doing raster-on-raster zonal stats, then GRASS is fairly good at 
that too.

Cheers,
Dylan


> Cheers,
>
> -Emilio Mayorga
> Applied Physics Laboratory
> University of Washington
> Box 355640
> Seattle, WA 98105-6698  USA
> http://staff.washington.edu/emiliom/
>
> On Wed, Aug 26, 2009 at 7:13 AM, Jose Gomez-Dans<jgomezdans@gmail.com> 
wrote:
> > Hi,
> >
> > 2009/8/20 questions anon <questions.anon@gmail.com>
> >
> >> Can anyone get me started on a script that can -
> >>
> >> ?-Open a shapefile
> >>
> >> ?-Open many rasters
> >>
> >> ?-Calculate the mean and standard deviation of those rasters within the
> >> shapefile region, but is able to ignore areas of zeros or NoData
> >>
> >> ?-Output the mean and standard deviation to a table
> >
> > i've done a similar example to what you want here:
> > <
> > http://sites.google.com/site/spatialpython/aggregating-data-to-grid-cells
> >> Only difference is that I calculate the histogram, rather than just the
> > mean and std dev. It is trivial to modify this for your own purposes. In
> > fact, when I get some time, I'll throw in a full "zonal stats" class, but
> > for now this should get you started.
> >
> > J
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From jgomezdans at gmail.com  Wed Aug 26 12:37:39 2009
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed Aug 26 12:37:42 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <200908260842.58037.dylan.beaudette@gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
	<b0d146420908260740y5b8940brd30d5b33e0af29f9@mail.gmail.com>
	<200908260842.58037.dylan.beaudette@gmail.com>
Message-ID: <91d218430908260937h719f10f5j26ffe3924c0e112c@mail.gmail.com>

Hi,

2009/8/26 Dylan Beaudette <debeaudette@ucdavis.edu>

> ndeed. The current (C++) version of Starspan is more or less unsupported. I
> tend to use an older, stabler, version-- but have become frustrated with it
> in recent studies. I think that the current maintainer Jon Greenberg is
> working on an R implementation-- however I am not certain that this will
> scale well to very large rasters. A Python incantation would be more
> flexible
> than the current C++ version, but perhaps at a speed cost. The current
> version is blazing fast, but there aren't any C++ programmers working on it
> now. If there is sufficient interest, I would like to get it into OSGeo so
> that a more skilled programmer (than myself) can have a look at it.


Python is extremely fast for some of these things. The version I tend to use
< http://sites.google.com/site/spatialpython/zonal-statistics> is bearable
even working with whole landsat scenes. The example there (with one MODIS
1km tile) takes in my laptop:
%timeit S = ZonalStats ( labels_file, data_file, stats='mean') ; std_s =
S.ResampleToGrid("std")
10 loops, best of 3: 1.44 s per loop

%timeit S = ZonalStats ( labels_file, data_file, stats='mean') ; std_s =
S.ZonalStatistics("mean")
10 loops, best of 3: 359 ms per loop


I plan to add a number of refinements to the code, such as adding a vector
input that gets automaticall rasterised, something that the GDAL python
wrappers have allowed for quite some time now, and adding these values to
the output as extra fields, but so far, I have had no need for these, so I
haven't really bothered.

Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090826/4d6ad3fd/attachment.html
From peifer at gmx.eu  Wed Aug 26 14:50:56 2009
From: peifer at gmx.eu (Hermann Peifer)
Date: Wed Aug 26 14:51:02 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
In-Reply-To: <4A928A6E.4050206@xpam.de>
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>	<4A8FBB20.2040509@xpam.de>	<4A9286A8.70106@gmx.eu>
	<4A928A6E.4050206@xpam.de>
Message-ID: <4A958410.3040802@gmx.eu>

Adam wrote:
> You can test with http://pastebin.com/m45e46f53
> Also remember to use -wo SKIP_NOSOURCE=YES
> 

Adam,

Will your patch appear in trunk/gdal/alg at some point in time?

Hermann
From emiliomayorga at gmail.com  Wed Aug 26 15:02:54 2009
From: emiliomayorga at gmail.com (Emilio Mayorga)
Date: Wed Aug 26 15:02:56 2009
Subject: [gdal-dev] calculate raster values within a vector
In-Reply-To: <91d218430908260937h719f10f5j26ffe3924c0e112c@mail.gmail.com>
References: <aa15d47e0908201044i65703714w163d185f9eb5e70b@mail.gmail.com>
	<91d218430908260713x2095c792k5c739c49cb89636b@mail.gmail.com>
	<b0d146420908260740y5b8940brd30d5b33e0af29f9@mail.gmail.com>
	<200908260842.58037.dylan.beaudette@gmail.com>
	<91d218430908260937h719f10f5j26ffe3924c0e112c@mail.gmail.com>
Message-ID: <b0d146420908261202u6f214a2dje77693f31eb917a5@mail.gmail.com>

n Wed, Aug 26, 2009 at 9:37 AM, Jose Gomez-Dans<jgomezdans@gmail.com> wrote:
> 2009/8/26 Dylan Beaudette <debeaudette@ucdavis.edu>
>>
>> ndeed. The current (C++) version of Starspan is more or less unsupported.
>> I tend to use an older, stabler, version-- but have become frustrated with
>> it in recent studies. I think that the current maintainer Jon Greenberg is
>> working on an R implementation-- however I am not certain that this will
>> scale well to very large rasters. A Python incantation would be more
>> flexible
>> than the current C++ version, but perhaps at a speed cost. The current
>> version is blazing fast, but there aren't any C++ programmers working on
>> it now. If there is sufficient interest, I would like to get it into OSGeo so
>> that a more skilled programmer (than myself) can have a look at it.
>
> Python is extremely fast for some of these things. The version I tend to use
> < http://sites.google.com/site/spatialpython/zonal-statistics> is bearable
> even working with whole landsat scenes. The example there (with one MODIS
> 1km tile) takes in my laptop:
> %timeit S = ZonalStats ( labels_file, data_file, stats='mean') ; std_s =
> S.ResampleToGrid("std")
> 10 loops, best of 3: 1.44 s per loop
>
> %timeit S = ZonalStats ( labels_file, data_file, stats='mean') ; std_s =
> S.ZonalStatistics("mean")
> 10 loops, best of 3: 359 ms per loop
>
>
> I plan to add a number of refinements to the code, such as adding a vector
> input that gets automaticall rasterised, something that the GDAL python
> wrappers have allowed for quite some time now, and adding these values to
> the output as extra fields, but so far, I have had no need for these, so I
> haven't really bothered.

Wow, Jose, thanks for sharing that! It looks terrific. I may be able
to contribute to it, but not until October or so.


> 2009/8/26 Dylan Beaudette <debeaudette@ucdavis.edu>
> If you are doing raster-on-raster zonal stats, then GRASS is fairly good at
> that too.

Dylan, thanks for your comments on Starspan. Regarding GRASS, I wish I
had time to start using it, but so far I haven't been able to. One of
these days... Still, accessing this functionality from Python is a big
plus for me. For example, I'm sharing some of my zonalstats-like code
with a colleague. I've helped him set up Python with all the right
modules, and he can run my code. Adding GRASS to that bag of new
things would probably make this task too complicated. Anyways, that's
just my own preferred workflow. I'll get to GRASS one of these days...

Cheers,

-Emilio
From even.rouault at mines-paris.org  Wed Aug 26 17:54:58 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 26 17:55:02 2009
Subject: [gdal-dev] Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
Message-ID: <1251323698.4a95af32dab60@imp.free.fr>

Martin,

I take the liberty to CC the list, as it is an interesting issue and it's better
to go public if we want to make progress on that.

In a few words, this is about how we could speed up GetFeature() on the layers
returned when issuing a SQL request on OGR drivers that rely on databases : PG
driver, MySQL driver, SQLite driver (... ?). For people wanting to take part,
you might be interested in the below email exchange first.

After examining Martin's patches and reading its explanations, I cann see 2
possibilities if we want to implement such optimization :

1) we change the GetNextFeature() of the ResultSetLayer of the PG, MySQL and
SQLite drivers so that they always return a "FID" which is an integer : 0, 1, 2,
3 instead of the current behaviour where sometimes it is the FID from the table
when the result is just a sub-set of the table, or this ordinal suite in other
cases. I don't think that we have a strict need to match the FID of a SQL result
set with one of the database table since it is not possible in all cases (see
the example of the PG driver which sometimes return a "true" FID, sometimes just
an ordinal). Always returning 0, 1, 2, etc. as an FID on such layers might be
acceptable I think. This way the current GetFeature() would match both its
advertized semantics (GetFeature(nFID)->GetFID() == nFID) and the use you want
to make from it. Perhaps we should have a capability (OLCFIDIsOrdinal) on that
layer that means that feature ids are guaranteed to be just ordinals, so that
the user can be confident in the fact that GetFeature(nFID) where 0 <= nFID <
nFeatureCount will always succeed. (Of course, the layer should also advertizes
the OLCRandomRead so that the user knows that GetFeature() is specialized and
fast)

Pro : no need of new API, existing apps can benefit from enhanced performance
for free
Cons : change in behaviour for existing applications that would rely
on the fact that the feature id of a sql layer matches - sometimes - the feature
id of the associated table layer. AFAIK, this assumption is not made in the doc
of the OGR API.

2) add a new method in OGRLayer, something like GetFeatureByIndex(nIndex) ? that
would always return the nIndex th element (starting with 0) returned by
iterating GetNextFeature() nIndex+1 times. A default implementation of that
would be trivial in OGRLayer, and it could be specialized in the interested
drivers.

Pro : doesn't break anything existing
Cons :
  * new API
  * might be confusing as close to GetFeature()
  * only useful in very few cases (drivers which don't have a concept of FID
just returns ordinals)

3) do nothing... The user application can iterate on the result set and stores
in its own array a pointer to the features returned by GetNextFeature()

Pro : no change in GDAL
Cons :
  * no change in GDAL ;-)
  * if the result set is significant, might require a lot of memory and time to
build this array


So, personnaly, I think solution 1) might be the best solution.

What do you think ?

Best regards,

Even

> Even,
>
> Ok, after reviewing the code what I did is essentially overload the virtual
> function GetFeature(long nFeatureId) in the resultset layer to provide
> myself fast random access functionality in a resultset returned by
> ExecuteSQL() for a resultset row "index" versus an FID.  GetFeature() on the
> table class uses an FID which is not the same as the row index for a
> resultset.  I really should have named it GetFeature(long index) instead of
> GetFeature(long nFeatureId).
>
> Now I understand better what I did.  If you call ExecuteSQL() with a spatial
> of attribute filter I believe FID's come back like the following:
>
> 3
> 20
> 25
> 26
> 100
> 48
> ...
>
> And I needed an ordinal offset regardless of resultset filter like
>
> 0
> 1
> 2
> 3
> ...
>
> The reason was because I had other data structures in my application (like
> arrays and an in-memory rtree structure) that only worked with ordinals.
> Thus, in order to link the multiple structures without sacrificing
> performance I needed to work with array offsets versus FID's.
>
> Moral of the story, GDAL may be able to use FID's in an efficient manor when
> being used alone, but when included in higher level applications that use
> additional data structures the FID concept is limiting when using other
> linked data structures that are limited to ordinal array offsets.
>
> Martin
>
>
>
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org]
> Sent: Tuesday, August 25, 2009 4:22 PM
> To: chapmanm@pixia.com
> Subject: About your proposed optimizations in OGR db drivers
>
> Martin,
>
> don't ask me how, but I've just happened to read this page :
> http://postgis.refractions.net/pipermail/postgis-users/2008-April/019246.htm
> l
>
> Could you explain a bit more the background of those optimizations that at
> first
> sight looks interesting ? I see that the 3 ones are for the layer returned
> by
> ExecuteSQL on PG, MySQL and sqlite.
>
> 0) You mentionned that you have proposed them before, but I couldn't find
> where.
> (I haven't dig very deep in trac or the archives to be honest ;-))
>
> 1) I'm wondering why you choose implement random reading by GetFeature() on
> SQL
> results, and not use directly the one that exists for the layers that map to
> the
> DB tables (AFAIK, GetFeature() is properly implemented in OGRPGTableLayer,
> OGRSQLiteTableLayer and OGRMySQLTableLayer) ?
>
> 2) I think your optimizations would need some rework to be always correct :
>
>    a) For SQLite, it would only work if the user has created the layer with
> a
> "SELECT * FROM a_table WHERE ....". If the user only request a few columns,
> the
> poFeature->SetField() would probably try to feed fields that don't exist in
> the
> layer. If the SQL result is a result of something more complex like a join,
> there is really no table to query a FID in... So the analysis of the initial
> request would require to be restricted to a few selected cases. But then I
> go
> back to 1)
>
>   b) For Postgres, your optimization violates the contract of GetFeature()
> which
> says "If this function returns a non-NULL feature, it is guaranteed that its
> feature id (OGR_F_GetFID()) will be the same as nFID.". But "FETCH ABSOLUTE
> nFeatureId" will return the nFeatureId th feature of the result of the
> request.
> I've observed that when you do a "SELECT * FROM a_table WHERE....",
> GetNextFeature() manages to preserve the FID from the table, so the
> optimization
> wouldn't clearly respect the contract (it would return the nFeatureId th
> element, instead of the feature whose FID = nFeatureId). For a request like
> "SELECT a_column FROM a_table WHERE...", GetNextFeature() returns the
> features
> with fids of 0,1,2,..., so the optimization would almost work, except that
> it
> would have a off-by-one error
>
>   c) For MySQL, I haven't yet analyzed due to lack of testing env.
>
> Best regards,
>
> Even
>
>


From warmerdam at pobox.com  Wed Aug 26 18:02:01 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 26 18:02:13 2009
Subject: [gdal-dev] Re: Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <1251323698.4a95af32dab60@imp.free.fr>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
	<1251323698.4a95af32dab60@imp.free.fr>
Message-ID: <4A95B0D9.9080904@pobox.com>

Even Rouault wrote:
> Martin,
> 
> I take the liberty to CC the list, as it is an interesting issue and it's better
> to go public if we want to make progress on that.
> 
> In a few words, this is about how we could speed up GetFeature() on the layers
> returned when issuing a SQL request on OGR drivers that rely on databases : PG
> driver, MySQL driver, SQLite driver (... ?). For people wanting to take part,
> you might be interested in the below email exchange first.
> 
> After examining Martin's patches and reading its explanations, I cann see 2
> possibilities if we want to implement such optimization :

Even,

I haven't seen Martin's patches, but the normal way to provide indexed
access to resultsets is the OGRLayer::SetNextByIndex() method.  You
pass the index into the current result set and then GetNextFeature()
should read the indicated feature.

Currently only very few providers implement this in a customized way,
but it seems it would be better to expand that rather than introduce
a new mechanism.

Does this make sense?

PS. there are reasonably good reasons why we want the FID to be the
primary key where practical.  I would hate to break that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From chapmanm at pixia.com  Wed Aug 26 18:13:59 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Wed Aug 26 18:14:06 2009
Subject: [gdal-dev] RE: Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <4A95B0D9.9080904@pobox.com>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
	<1251323698.4a95af32dab60@imp.free.fr> <4A95B0D9.9080904@pobox.com>
Message-ID: <309C1159C5AC4C01BBCB068A803657A3@chapmanm64>

Even and Frank,

1.  I would absolutely not change any existing functionality of how FID is
handled or you will screw up everyone's code that depends on that and will
cause a lot of people serious grief.  

2.  I cannot remember exactly but I think SetNextByIndex was intended to
solve this problem because I originally asked Frank to add it so I would
look there first as Frank says.  Not sure why I couldn't use it in my case
but I think there was a reason.

2.  If SetNextByIndex doesn't work for this case and you want to add ordinal
row support perhaps adding a new interface (or inherited class) would be the
answer.  That way you don't screw up existing drivers and changes can be
implemented gradually driver by driver where it makes sense.  Maybe the new
interface would be called IRandomAccessCursor or something like that but to
match the OGR interface naming convention.

How does that sound?

Martin 

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Wednesday, August 26, 2009 4:02 PM
To: Even Rouault
Cc: Martin Chapman; Gdal-Dev
Subject: Re: Optimizing random access in SQL result set of OGR DB drivers

Even Rouault wrote:
> Martin,
> 
> I take the liberty to CC the list, as it is an interesting issue and it's
better
> to go public if we want to make progress on that.
> 
> In a few words, this is about how we could speed up GetFeature() on the
layers
> returned when issuing a SQL request on OGR drivers that rely on databases
: PG
> driver, MySQL driver, SQLite driver (... ?). For people wanting to take
part,
> you might be interested in the below email exchange first.
> 
> After examining Martin's patches and reading its explanations, I cann see
2
> possibilities if we want to implement such optimization :

Even,

I haven't seen Martin's patches, but the normal way to provide indexed
access to resultsets is the OGRLayer::SetNextByIndex() method.  You
pass the index into the current result set and then GetNextFeature()
should read the indicated feature.

Currently only very few providers implement this in a customized way,
but it seems it would be better to expand that rather than introduce
a new mechanism.

Does this make sense?

PS. there are reasonably good reasons why we want the FID to be the
primary key where practical.  I would hate to break that.

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Wed Aug 26 18:26:34 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 26 18:26:36 2009
Subject: [gdal-dev] Re: Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <4A95B0D9.9080904@pobox.com>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
	<1251323698.4a95af32dab60@imp.free.fr> <4A95B0D9.9080904@pobox.com>
Message-ID: <1251325594.4a95b69a40baf@imp.free.fr>

Selon Frank Warmerdam <warmerdam@pobox.com>:

> Even Rouault wrote:
> > Martin,
> >
> > I take the liberty to CC the list, as it is an interesting issue and it's
> better
> > to go public if we want to make progress on that.
> >
> > In a few words, this is about how we could speed up GetFeature() on the
> layers
> > returned when issuing a SQL request on OGR drivers that rely on databases :
> PG
> > driver, MySQL driver, SQLite driver (... ?). For people wanting to take
> part,
> > you might be interested in the below email exchange first.
> >
> > After examining Martin's patches and reading its explanations, I cann see 2
> > possibilities if we want to implement such optimization :
>
> Even,
>
> I haven't seen Martin's patches, but the normal way to provide indexed
> access to resultsets is the OGRLayer::SetNextByIndex() method.  You
> pass the index into the current result set and then GetNextFeature()
> should read the indicated feature.
>
> Currently only very few providers implement this in a customized way,
> but it seems it would be better to expand that rather than introduce
> a new mechanism.
>
> Does this make sense?

Yes absolutely ! I didn't realize this existed at all... Apparently, this is
only used in the Memory and Shape driver. But that's exactly what should be
implemented in the explained use cases.

An implementation difficulty I imagine is that on those SQL layers, calling once
SetNextByIndex() and then GetNextFeature() probably makes it
difficult/impossible to use the sequencial API of the DB library (the Step()
method of libpq for example) for the following calls to GetNextFeature(), until
the next call to ResetReading(). Well, that's just an implementation detail that
must be solved.

While looking again at Martin's patch, I think that they could easily be adapted
for the PG and MySQL case. But for the SQLite, I don't see how to do that
correctly as it relies on the OGC_FID, which doesn't necessary match with the
ordinal. But perhaps there's an equivalent of the "mysql_data_seek( hResultSet,
iNextShapeId )" or "FETCH ABSOLUTE %d in %s", nFeatureId, pszCursorName"".

>
> PS. there are reasonably good reasons why we want the FID to be the
> primary key where practical.  I would hate to break that.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>


From even.rouault at mines-paris.org  Wed Aug 26 18:32:59 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 26 18:33:01 2009
Subject: [gdal-dev] RE: Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <309C1159C5AC4C01BBCB068A803657A3@chapmanm64>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
	<1251323698.4a95af32dab60@imp.free.fr> <4A95B0D9.9080904@pobox.com>
	<309C1159C5AC4C01BBCB068A803657A3@chapmanm64>
Message-ID: <1251325979.4a95b81b384ea@imp.free.fr>

Selon Martin Chapman <chapmanm@pixia.com>:

> Even and Frank,
>
> 1.  I would absolutely not change any existing functionality of how FID is
> handled or you will screw up everyone's code that depends on that and will
> cause a lot of people serious grief.
>
> 2.  I cannot remember exactly but I think SetNextByIndex was intended to
> solve this problem because I originally asked Frank to add it so I would
> look there first as Frank says.  Not sure why I couldn't use it in my case
> but I think there was a reason.
>
> 2.  If SetNextByIndex doesn't work for this case and you want to add ordinal
> row support perhaps adding a new interface (or inherited class) would be the
> answer.  That way you don't screw up existing drivers and changes can be
> implemented gradually driver by driver where it makes sense.  Maybe the new
> interface would be called IRandomAccessCursor or something like that but to
> match the OGR interface naming convention.
>
> How does that sound?

Why would you need a new interface ? Calling SetNextByIndex(nIndex) followed by
GetNextFeature() is exacly what you want, unless I have missed something.
SetNextByIndex() would just need to be implemented on those layers and
GetNextFeature() adapted to take it into account

>
> Martin
>
> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Wednesday, August 26, 2009 4:02 PM
> To: Even Rouault
> Cc: Martin Chapman; Gdal-Dev
> Subject: Re: Optimizing random access in SQL result set of OGR DB drivers
>
> Even Rouault wrote:
> > Martin,
> >
> > I take the liberty to CC the list, as it is an interesting issue and it's
> better
> > to go public if we want to make progress on that.
> >
> > In a few words, this is about how we could speed up GetFeature() on the
> layers
> > returned when issuing a SQL request on OGR drivers that rely on databases
> : PG
> > driver, MySQL driver, SQLite driver (... ?). For people wanting to take
> part,
> > you might be interested in the below email exchange first.
> >
> > After examining Martin's patches and reading its explanations, I cann see
> 2
> > possibilities if we want to implement such optimization :
>
> Even,
>
> I haven't seen Martin's patches, but the normal way to provide indexed
> access to resultsets is the OGRLayer::SetNextByIndex() method.  You
> pass the index into the current result set and then GetNextFeature()
> should read the indicated feature.
>
> Currently only very few providers implement this in a customized way,
> but it seems it would be better to expand that rather than introduce
> a new mechanism.
>
> Does this make sense?
>
> PS. there are reasonably good reasons why we want the FID to be the
> primary key where practical.  I would hate to break that.
>
> Best regards,
> --
> ---------------------------------------+------------------------------------
> --
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>


From chapmanm at pixia.com  Wed Aug 26 19:21:23 2009
From: chapmanm at pixia.com (Martin Chapman)
Date: Wed Aug 26 19:21:28 2009
Subject: [gdal-dev] RE: Optimizing random access in SQL result set of OGR DB
	drivers
In-Reply-To: <1251325979.4a95b81b384ea@imp.free.fr>
References: <1251238939.4a94641b4e51f@imp.free.fr>
	<C5C3AAB4635F46B3A19FAE43DE754A63@chapmanm64>
	<1251323698.4a95af32dab60@imp.free.fr> <4A95B0D9.9080904@pobox.com>
	<309C1159C5AC4C01BBCB068A803657A3@chapmanm64>
	<1251325979.4a95b81b384ea@imp.free.fr>
Message-ID: <507E406C188749578DD19E9C6E77F4F2@chapmanm64>

Even,

I agree with your response. Regardless of specific implementation I think
your efforts to provide high speed random access searches by ordinal
position for the database drivers will be a fantastic addition to the OGR
library.  I am really excited to check it out when you get it ready for
testing.

Best regards,
Martin 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Wednesday, August 26, 2009 4:33 PM
To: Martin Chapman
Cc: 'Frank Warmerdam'; 'Even Rouault'; 'Gdal-Dev'
Subject: RE: Optimizing random access in SQL result set of OGR DB drivers

Selon Martin Chapman <chapmanm@pixia.com>:

> Even and Frank,
>
> 1.  I would absolutely not change any existing functionality of how FID is
> handled or you will screw up everyone's code that depends on that and will
> cause a lot of people serious grief.
>
> 2.  I cannot remember exactly but I think SetNextByIndex was intended to
> solve this problem because I originally asked Frank to add it so I would
> look there first as Frank says.  Not sure why I couldn't use it in my case
> but I think there was a reason.
>
> 2.  If SetNextByIndex doesn't work for this case and you want to add
ordinal
> row support perhaps adding a new interface (or inherited class) would be
the
> answer.  That way you don't screw up existing drivers and changes can be
> implemented gradually driver by driver where it makes sense.  Maybe the
new
> interface would be called IRandomAccessCursor or something like that but
to
> match the OGR interface naming convention.
>
> How does that sound?

Why would you need a new interface ? Calling SetNextByIndex(nIndex) followed
by
GetNextFeature() is exacly what you want, unless I have missed something.
SetNextByIndex() would just need to be implemented on those layers and
GetNextFeature() adapted to take it into account

>
> Martin
>
> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Wednesday, August 26, 2009 4:02 PM
> To: Even Rouault
> Cc: Martin Chapman; Gdal-Dev
> Subject: Re: Optimizing random access in SQL result set of OGR DB drivers
>
> Even Rouault wrote:
> > Martin,
> >
> > I take the liberty to CC the list, as it is an interesting issue and
it's
> better
> > to go public if we want to make progress on that.
> >
> > In a few words, this is about how we could speed up GetFeature() on the
> layers
> > returned when issuing a SQL request on OGR drivers that rely on
databases
> : PG
> > driver, MySQL driver, SQLite driver (... ?). For people wanting to take
> part,
> > you might be interested in the below email exchange first.
> >
> > After examining Martin's patches and reading its explanations, I cann
see
> 2
> > possibilities if we want to implement such optimization :
>
> Even,
>
> I haven't seen Martin's patches, but the normal way to provide indexed
> access to resultsets is the OGRLayer::SetNextByIndex() method.  You
> pass the index into the current result set and then GetNextFeature()
> should read the indicated feature.
>
> Currently only very few providers implement this in a customized way,
> but it seems it would be better to expand that rather than introduce
> a new mechanism.
>
> Does this make sense?
>
> PS. there are reasonably good reasons why we want the FID to be the
> primary key where practical.  I would hate to break that.
>
> Best regards,
> --
>
---------------------------------------+------------------------------------
> --
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>


From atubar at 126.com  Thu Aug 27 08:28:02 2009
From: atubar at 126.com (atubar)
Date: Thu Aug 27 08:58:56 2009
Subject: [gdal-dev] Stack Overflow in gdal with HDF5 using VC2008
In-Reply-To: <4A84BD92.8060206@loskot.net>
References: <4A84BD92.8060206@loskot.net> <4A82182C.4000908@loskot.net>
	<eb502d880908070945s213ba4b2q1d41c40d55c3f47a@mail.gmail.com>
	<9513738.763251249574201122.JavaMail.coremail@bj126app57.126.com>
	<11661419.423511250000233115.JavaMail.coremail@bj126app90.126.com>
	<14681142.266211250149966636.JavaMail.coremail@bj126app20.126.com>
Message-ID: <21391965.395131251376082256.JavaMail.coremail@bj126app48.126.com>

Today, I download a HDF5 sample data named hicam_catch-gray.re.ice.h5, from opticks which is an open source remote sensing software. Now the stack overflow error does not take place.

I wonder that whether all HDF5 files are supported by HDF5dll integrated with gdal. And compiling gdal, which version of hdf5dll is recommended, 1.6.X or 1.8.X? Is there any difference?

By the way ,I want to konw that where can I get some free RS Datas in these formats, such as HDF5,HDF4?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/30fbbcef/attachment.html
From Steve.Toutant at inspq.qc.ca  Thu Aug 27 09:52:30 2009
From: Steve.Toutant at inspq.qc.ca (Steve.Toutant@inspq.qc.ca)
Date: Thu Aug 27 09:52:44 2009
Subject: [gdal-dev] intersection between vector and raster
In-Reply-To: <E132E223-D5C6-4A10-B6E3-81F8FEA451BE@mac.com>
Message-ID: <OF0E413EE5.67B9F6C5-ON8525761F.004B6183-8525761F.004C37F6@ssss.gouv.qc.ca>

Hello!
I already use gdal_Rasterize to burn pixels that are within or outside 
some polygons of a vector dataset.
But I would like to do the opposite, keep polygons from a vector dataset 
based on a the value of the pixel of a raster dataset. Per example, keep 
polygons where the pixel's value is greater that 205.

Is there a gdal utlity I could use to do that without programming?
thanks
Steve


Steve Toutant, M. Sc.
Analyste en g?omatique
Secteur environnement
Direction des risques biologiques, environnementaux et occupationnels
Institut national de sant? publique du Qu?bec
945, avenue Wolfe
Qu?bec, Qc G1V 5B3 
T?l.: (418) 650-5115 #5281
Fax.: (418) 654-3144
steve.toutant@inspq.qc.ca
http://www.inspq.qc.ca
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/ea6d91f2/attachment.html
From Roger.Bivand at nhh.no  Thu Aug 27 11:13:58 2009
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu Aug 27 11:14:01 2009
Subject: [gdal-dev] GDAL Erdas LAN/GIS driver
In-Reply-To: <4A930898.4090703@pobox.com>
References: <alpine.LRH.2.00.0908210959270.6175@reclus.nhh.no>
	<4A8E9E9F.5060505@pobox.com>
	<alpine.LRH.2.00.0908211606220.7507@reclus.nhh.no>
	<alpine.LRH.2.00.0908211846100.7507@reclus.nhh.no>
	<4A930898.4090703@pobox.com>
Message-ID: <alpine.LRH.2.00.0908271709010.8723@reclus.nhh.no>

On Mon, 24 Aug 2009, Frank Warmerdam wrote:

> Roger Bivand wrote:
>> 
>> (reverting to list)
>> 
>> Correction, the user reported that:
>> 
>>> Apparently, gdalinfo retrieves the correct min, max, and statistics, 
>>> despite the use of GDT_Int16.
>> 
>> on his Windows platform. The different GDAL versions ought to explain why 
>> his gdalinfo says Int16 but gives statistics from UInt16.
> ...
>> On the trunk, GDT_Int16 is used too, so how does gdalinfo detect that it is 
>> actually UInt16?
>
> Roger,
>
> I believe the min/max is actually being read from the file header in trunk
> and is handled without regard to the actual imagery or it's type.
>
> I skimmed the changelog for this driver and I didn't notice any obvious
> changes in metadata / statistics handling so I'm surprised at this result.
>
> Best regards,
>

Frank,

Having at last got the data and a current 1.7.0dev, I have to report that 
on x86 Linux, I cannot reproduce the reading of Int16 as UInt16 reported 
by the original questioner - I get Int16 and a negative minimum with 
gdalinfo, and in rgdal using the same *.so. How the difference arose is 
unclear, I can download FWTools and check on Windows.

I would argue for replacing Int16 by UInt16 in the LAN/GIS driver based on 
PCI and ESRI references to the data types as unsigned, but am open to 
other arguments.

Best wishes,

Roger

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no

From mongoose_riki at mail.ru  Thu Aug 27 11:33:57 2009
From: mongoose_riki at mail.ru (Riki Tiki)
Date: Thu Aug 27 11:34:01 2009
Subject: [gdal-dev] open source tool
Message-ID: <E1Mggz7-0002tG-00.mongoose_riki-mail-ru@f5.mail.ru>

hi,

do you know any tools available for the conversion of LAS (LIDAR data) into Voronoi diagrams or TIN (triangular irregular networks)? thanks a lot!

or anyone can suggest how to do it in arcgis for example?

thanks


From jaadfoo at gmail.com  Thu Aug 27 14:11:42 2009
From: jaadfoo at gmail.com (Jamie Adams)
Date: Thu Aug 27 14:11:43 2009
Subject: [gdal-dev] open source tool
In-Reply-To: <E1Mggz7-0002tG-00.mongoose_riki-mail-ru@f5.mail.ru>
References: <E1Mggz7-0002tG-00.mongoose_riki-mail-ru@f5.mail.ru>
Message-ID: <f4339510908271111t27cbd315hc3b5d4e8aab05604@mail.gmail.com>

You probably want these, specifically las2tin.exe :
http://www.cs.unc.edu/~isenburg/lastools/

- Jamie

2009/8/27 Riki Tiki <mongoose_riki@mail.ru>

> hi,
>
> do you know any tools available for the conversion of LAS (LIDAR data) into
> Voronoi diagrams or TIN (triangular irregular networks)? thanks a lot!
>
> or anyone can suggest how to do it in arcgis for example?
>
> thanks
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/efdd37e7/attachment.html
From mikehapner at yahoo.com  Thu Aug 27 15:43:01 2009
From: mikehapner at yahoo.com (Mike Hapner)
Date: Thu Aug 27 15:49:43 2009
Subject: [gdal-dev] Trying to get ogr2ogr (and ogrinfo) to work with an ESRI
	Personal Geodatabase (.mdb) on Linux.
Message-ID: <317319.41001.qm@web54105.mail.re2.yahoo.com>

Short version:
Trying to get ogr2ogr (and ogrinfo) to work with an ESRI Personal Geodatabase (.mdb) on Linux.

-----------------------------------------------------------------------------------------------------------------------------------------

I've
done quite a bit of research and am pulling my hair out, so I'd love it
if someone can point out the one or more thing(s) that I'm doing wrong.

I've mainly been trying to get the scenario on this page to work:  http://gdal.org/ogr/drv_pgeo.html

I'm
trying to push an ESRI Personal Geodatabase called geonames.mdb into a
Postgres/PostGIS database.  I can do this fine with ogr2ogr on
windows...but cannot for the life of me get it to work on Linux.  (For
example -- in windows... ogr2ogr -f "PostgreSQL"
PG:"host=192.168.23.23 user=someuser dbname=poi password=somepassword
port=5432" S:\GISData\Geonames.mdb -a_srs EPSG:26986 works great)

My environment:
- Linux 2.6.28-14-server - Ubuntu 9.04(64bit)
- Postgres/PostGIS
- Installed the following packages with apt-get

        unixodbc libmdbodbc gdal-bin mdbtools
-- Note:  I installed gdal-bin to get the ogr utilities because I couldn't get FWTools installer to work.... 


/etc/odbcinst.ini --- Note that the file in the driver line exists... and has read permissions
  [Microsoft Access Driver (*.mdb)]
  Description = MDB Tools ODBC drivers
  Driver     = /usr/lib/libmdbodbc.so.0                           
  Setup      =
  FileUsage  = 1
  CPTimeout  =
  CPReuse    =



~/.odbc.ini 
[geonames]
Description = Sample PGeo Database
Driver      = Microsoft Access Driver (*.mdb)
Database    = /mnt/data/gis/testgis/geonames.mdb
Host        = 
Port        = 
User        =
Password    =
Trace       = Yes
TraceFile   = /mnt/data/gis/testgis/odbc.log



Things that work correctly:
$mdb-tables -1 geonames.mdb    #  proves to me that mdbtools is properly installed and can see the tables inside the mdb file
GDB_ReleaseInfo
GDB_FeatureDataset
GDB_ObjectClasses
...
...
...

$ogrinfo
abc123.shp       # proves to me that ogrinfo (from gdal-bin) is
installed and can at least open a SHP file I had laying around
INFO: Open of `abc123.shp'
      using driver `ESRI Shapefile' successful.
1: abc123 (3D Point)

$ogr2ogr -f "KML" abc123.kml abc123.shp  # This creates kml of the shp file... perfect.


The problem is when I try to get it to open the geonames connection...
--------------------------------------------------------------------------------------------------------------
$ ogrinfo PGeo:geonames
ERROR 1: PGeo: MDB Tools driver not found!

ERROR 1: Unable to install MDB driver for ODBC!

ERROR 1: PGeo: MDB Tools driver not found!

ERROR 1: Unable to install MDB driver for ODBC!

FAILURE:
Unable to open datasource `PGeo:geonames' with the following drivers.

---------------------------------------------------------------------------------------------------------------
$ ogr2ogr -f "KML" abc123.kml PGeo:geonames.mdb
ERROR 1: PGeo: MDB Tools driver not found!

ERROR 1: Unable to install MDB driver for ODBC!


I know this is kinda long, but I didn't want to get yelled at for not doing my homework and not giving enough info... Looking forward to hearing back!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/b6bdadea/attachment.html
From chaitanya.ch at gmail.com  Thu Aug 27 16:52:09 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu Aug 27 17:00:06 2009
Subject: [gdal-dev] Trying to get ogr2ogr (and ogrinfo) to work with an 
	ESRI Personal Geodatabase (.mdb) on Linux.
In-Reply-To: <317319.41001.qm@web54105.mail.re2.yahoo.com>
References: <317319.41001.qm@web54105.mail.re2.yahoo.com>
Message-ID: <eb502d880908271352r351d0760s8637b79fda940715@mail.gmail.com>

Mike,

The packages provided by the ubuntu repos may not be the latest. Despite the
fact that PGeo driver has been not as reliable on Linux as on Windows, it
might help if you installed the latest versions.

If you are willing to going through all this trouble, then you might as well
just compile the latest odbc library and then compile the gdal library
against it. Look at http://trac.osgeo.org/gdal/wiki/BuildingOnUnix and make
sure to use the option "--with-odbc=<path>" with the program ./configure .

On Fri, Aug 28, 2009 at 1:13 AM, Mike Hapner <mikehapner@yahoo.com> wrote:

> Short version:
> Trying to get ogr2ogr (and ogrinfo) to work with an ESRI Personal
> Geodatabase (.mdb) on Linux.
>
>
> -----------------------------------------------------------------------------------------------------------------------------------------
>
> I've done quite a bit of research and am pulling my hair out, so I'd love
> it if someone can point out the one or more thing(s) that I'm doing wrong.
>
> I've mainly been trying to get the scenario on this page to work:
> http://gdal.org/ogr/drv_pgeo.html
>
> I'm trying to push an ESRI Personal Geodatabase called geonames.mdb into a
> Postgres/PostGIS database.  I can do this fine with ogr2ogr on windows...but
> cannot for the life of me get it to work on Linux.  (For example -- in
> windows... ogr2ogr -f "PostgreSQL" PG:"host=192.168.23.23 user=someuser
> dbname=poi password=somepassword port=5432" S:\GISData\Geonames.mdb -a_srs
> EPSG:26986 works great)
>
> My environment:
> - Linux 2.6.28-14-server - Ubuntu 9.04(64bit)
> - Postgres/PostGIS
> - Installed the following packages with apt-get
>         unixodbc libmdbodbc gdal-bin mdbtools
> -- Note:  I installed gdal-bin to get the ogr utilities because I couldn't
> get FWTools installer to work....
>
>
> /etc/odbcinst.ini --- Note that the file in the driver line exists... and
> has read permissions
>   [Microsoft Access Driver (*.mdb)]
>   Description = MDB Tools ODBC drivers
>   Driver     = /usr/lib/libmdbodbc.so.0
>   Setup      =
>   FileUsage  = 1
>   CPTimeout  =
>   CPReuse    =
>
>
>
> ~/.odbc.ini
> [geonames]
> Description = Sample PGeo Database
> Driver      = Microsoft Access Driver (*.mdb)
> Database    = /mnt/data/gis/testgis/geonames.mdb
> Host        =
> Port        =
> User        =
> Password    =
> Trace       = Yes
> TraceFile   = /mnt/data/gis/testgis/odbc.log
>
>
>
> Things that work correctly:
> $mdb-tables -1 geonames.mdb    #  proves to me that mdbtools is properly
> installed and can see the tables inside the mdb file
> GDB_ReleaseInfo
> GDB_FeatureDataset
> GDB_ObjectClasses
> ...
> ...
> ...
>
> $ogrinfo abc123.shp       # proves to me that ogrinfo (from gdal-bin) is
> installed and can at least open a SHP file I had laying around
> INFO: Open of `abc123.shp'
>       using driver `ESRI Shapefile' successful.
> 1: abc123 (3D Point)
>
> $ogr2ogr -f "KML" abc123.kml abc123.shp  # This creates kml of the shp
> file... perfect.
>
>
> The problem is when I try to get it to open the geonames connection...
>
> --------------------------------------------------------------------------------------------------------------
> $ ogrinfo PGeo:geonames
> ERROR 1: PGeo: MDB Tools driver not found!
>
> ERROR 1: Unable to install MDB driver for ODBC!
>
> ERROR 1: PGeo: MDB Tools driver not found!
>
> ERROR 1: Unable to install MDB driver for ODBC!
>
> FAILURE:
> Unable to open datasource `PGeo:geonames' with the following drivers.
>
>
> ---------------------------------------------------------------------------------------------------------------
> $ ogr2ogr -f "KML" abc123.kml PGeo:geonames.mdb
> ERROR 1: PGeo: MDB Tools driver not found!
>
> ERROR 1: Unable to install MDB driver for ODBC!
>
>
> I know this is kinda long, but I didn't want to get yelled at for not doing
> my homework and not giving enough info... Looking forward to hearing back!
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090828/4bad5011/attachment.html
From nicolas.degarne at gmail.com  Thu Aug 27 17:19:30 2009
From: nicolas.degarne at gmail.com (Nicolas DEGARNE)
Date: Thu Aug 27 17:19:53 2009
Subject: [gdal-dev] Convert Geographic Lat/long (Deciomal degree) vers UTM
	31N meters
Message-ID: <3280c5c80908271419h37beded2y65a4ab1c712257d6@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/gif
Size: 126 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/0e0e2b14/attachment-0001.gif
From jason.roberts at duke.edu  Thu Aug 27 17:27:28 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu Aug 27 17:27:33 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
Message-ID: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>

Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs with
multiple bands? I have a 5-band AIG for which the Python gdal bindings for
GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a supported file
format." ArcGIS 9.3.1 reports that the "format" of it is "GRID Stack 7.x".
It was created using standard ArcGIS tools.

 

If this is not supported, I can work around the problem. I just would like
to know the intent of the GDAL team.

 

Thanks for your help,

 

Jason

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090827/ea6a1b2c/attachment.html
From warmerdam at pobox.com  Thu Aug 27 17:50:45 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 27 17:51:08 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
In-Reply-To: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>
References: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>
Message-ID: <4A96FFB5.3060706@pobox.com>

Jason Roberts wrote:
> Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs 
> with multiple bands? I have a 5-band AIG for which the Python gdal 
> bindings for GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a 
> supported file format." ArcGIS 9.3.1 reports that the "format" of it is 
> "GRID Stack 7.x". It was created using standard ArcGIS tools.
  >
> If this is not supported, I can work around the problem. I just would 
> like to know the intent of the GDAL team.

Jason,

I'd like to investigate the dataset if possible, to try and understand
why it isn't supported and if it could be easily enabled.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jason.roberts at duke.edu  Thu Aug 27 18:40:26 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu Aug 27 18:40:31 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
In-Reply-To: <4A96FFB5.3060706@pobox.com>
References: <018e01ca275d$2e257910$8a706b30$%roberts@duke.edu>
	<4A96FFB5.3060706@pobox.com>
Message-ID: <019f01ca2767$6070cb40$215261c0$@roberts@duke.edu>

Frank,

Please see http://trac.osgeo.org/gdal/ticket/3116. Thanks for looking at
this.

Best,
Jason

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Thursday, August 27, 2009 5:51 PM
To: Jason Roberts
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
bands?

Jason Roberts wrote:
> Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs 
> with multiple bands? I have a 5-band AIG for which the Python gdal 
> bindings for GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a 
> supported file format." ArcGIS 9.3.1 reports that the "format" of it is 
> "GRID Stack 7.x". It was created using standard ArcGIS tools.
  >
> If this is not supported, I can work around the problem. I just would 
> like to know the intent of the GDAL team.

Jason,

I'd like to investigate the dataset if possible, to try and understand
why it isn't supported and if it could be easily enabled.

Best regards,
--
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From massimodisasha at yahoo.it  Fri Aug 28 05:03:04 2009
From: massimodisasha at yahoo.it (Massimo Di Stefano)
Date: Fri Aug 28 05:10:34 2009
Subject: [gdal-dev] libgeotiff - svn ; problems running autogen.sh 
Message-ID: <D6F12B95-C91C-417E-86D3-F5ACEFA30DA7@yahoo.it>

Hi All,

i'm tring to install libtiff + libgeotiff from the cvs / svn repository
on a VM running sidux-xfce.

(i need to have gdal and ossim compiled against the same libtiff- 
libgeotiff libraries)

unlucky while libtiff compile without problems, libgeotiff give me  
error running the script :

./autogen.sh

seems it fails to find proj files, this the log :

###########################

sasha@epxbox:/usr/local/src/sorcedep/libgeotiff$ ./autogen.sh
Running aclocal
/usr/bin/m4:configure.ac:71: bad expression in eval: m4_Cursor + 2 + 1
/usr/bin/m4:configure.ac:71: bad expression in eval:  > (79)
/usr/bin/m4:configure.ac:71: bad expression in eval (bad input): 4098  
 > (but either projects.h or libproj.a not found!"
  fi
fi


if test "$PROJ_HOME" = "no" ; then
  echo "PROJ.4 support disabled."

elif test "$PROJ_LIB" != "" -a "$PROJ_INC" != "" ; then
  echo "Found $PROJ_LIB"
  echo "Found $PROJ_INC/projects.h"

  LIBS="$PROJ_LIB $LIBS"
  PROJ_INC=-I$PROJ_INC

  PROJ_INC=$PROJ_INC

  $as_echo "@%:@define HAVE_PROJECTS_H 1" >>confdefs.h

  $as_echo "@%:@define HAVE_LIBPROJ 1" >>confdefs.h


  PROJ_CONFIG="yes"
  PROJECTS_H_CONFIG="yes"

else
  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for pj_init in - 
lproj" >&5
$as_echo_n "checking for pj_init in -lproj... " >&6; }
if test "${ac_cv_lib_proj_pj_init+set}" = set; then :
  $as_echo_n "(cached) " >&6
else
  ac_check_lib_save_LIBS=$LIBS
LIBS="-lproj -lm $LIBS"
cat confdefs.h - <<_ACEOF >conftest.$ac_ext
/* end confdefs.h.  */

/* Override any GCC internal prototype to avoid an error.
   Use char because int might match the return type of a GCC
   builtin and then its argument prototype would still apply.  */
#ifdef __cplusplus
extern "C"
#endif
char pj_init ();
int
main ()
{
return pj_init ();
  ;
  return 0;
}
_ACEOF
if ac_fn_c_try_link "$LINENO"; then :
  ac_cv_lib_proj_pj_init=yes
else
  ac_cv_lib_proj_pj_init=no
fi
rm -f core conftest.err conftest.$ac_objext \
    conftest$ac_exeext conftest.$ac_ext
LIBS=$ac_check_lib_save_LIBS
fi
{ $as_echo "$as_me:${as_lineno-$LINENO}: result:  
$ac_cv_lib_proj_pj_init" >&5
$as_echo "$ac_cv_lib_proj_pj_init" >&6; }
if test "x$ac_cv_lib_proj_pj_init" = x""yes; then :
  cat >>confdefs.h <<_ACEOF
@%:@define HAVE_LIBPROJ 1
_ACEOF

  LIBS="-lproj $LIBS"

fi

  for ac_header in projects.h
do :
  ac_fn_c_check_header_mongrel "$LINENO" "projects.h"  
"ac_cv_header_projects_h" "$ac_includes_default"
if test "x$ac_cv_header_projects_h" = x""yes; then :
  cat >>confdefs.h <<_ACEOF
@%:@define HAVE_PROJECTS_H 1
_ACEOF

fi

done

  PROJ_CONFIG="yes"
fi

if test ! x$PROJ_CONFIG = xno; then
  PROJ_IS_CONFIG_TRUE=
  PROJ_IS_CONFIG_FALSE='#'
else
  PROJ_IS_CONFIG_TRUE='#'
  PROJ_IS_CONFIG_FALSE=
fi

if test ! x$PROJECTS_H_CONFIG = xno; then
  PROJECTS_H_IS_CONFIG_TRUE=
  PROJECTS_H_IS_CONFIG_FALSE='#'
else
  PROJECTS_H_IS_CONFIG_TRUE='#'
  PROJECTS_H_IS_CONFIG_FALSE=
fi




CSV_CONFIG="no"
  --enable-incode-epsg    Use C code EPSG tables
@%:@ Check whether --enable-incode-epsg was given.
if test "${enable_incode_epsg+set}" = set; then :
  enableval=$enable_incode_epsg;
else
  enable_incode_epsg=no
fi


if test "$enable_incode_epsg" != "no"  -o "$enable_incode_epsg" =  
""  ; then

    { $as_echo "$as_me:${as_lineno-$LINENO}: checking if EPSG tables  
will be read from .csv files" >&5
$as_echo_n "checking if EPSG tables will be read from .csv files... "  
 >&6; }
    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
$as_echo "yes" >&6; }
    CSV_CONFIG="yes"
else
    { $as_echo "$as_me:${as_lineno-$LINENO}: checking if EPSG tables  
will be read from .csv files" >&5
$as_echo_n "checking if EPSG tables will be read from .csv files... "  
 >&6; }
    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
$as_echo "no" >&6; }

fi
if test ! x$CSV_CONFIG = xno; then
  CSV_IS_CONFIG_TRUE=
  CSV_IS_CONFIG_FALSE='#'
else
  CSV_IS_CONFIG_TRUE='#'
  CSV_IS_CONFIG_FALSE=
fi




ac_config_files="$ac_config_files Makefile libxtiff/Makefile bin/ 
Makefile"


cat >confcache <<\_ACEOF
# This file is a shell script that caches the results of configure
# tests run on this system so they can be shared between configure
# scripts and configure runs, see configure's option --config-cache.
# It is not useful on other systems.  If it contains results you don't
# want to keep, you may remove or edit it.
#
# config.status only pays attention to the cache file if you give it
# the --recheck option to rerun configure.
#
# `ac_cv_env_foo' variables (set or unset) will be overridden when
# loading this file, other *unset* `ac_cv_foo' will be assigned the
# following values.

_ACEOF

# The following way of writing the cache mishandles newlines in values,
# but we know of no workaround that is simple, portable, and efficient.
# So, we kill variables containing newlines.
# Ultrix sh set writes to stderr and can't be redirected directly,
# and sets the high bit in the cache file unless we assign to the vars.
(
  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/ 
\1/p'`; do
    eval ac_val=\$$ac_var
    case $ac_val in #(
    *${as_nl}*)
      case $ac_var in #(
      *_cv_*)
autom4te: /usr/bin/m4 failed with exit status: 1
aclocal: autom4te failed with exit status: 1

  Something went wrong, giving up!

sasha@epxbox:/usr/local/src/sorcedep/libgeotiff$


#############################


i also tried to install proj from source (svn) in /usr/local
but nothing changes :-(

please have you any clue or have you any suggestion on how can i  
install libgeotiff ?
i'm avaiable for any kind of test.

thanks to All

Massimo.
From andrew.loughhead at gmail.com  Fri Aug 28 06:41:27 2009
From: andrew.loughhead at gmail.com (Andrew Loughhead)
Date: Fri Aug 28 06:48:53 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
In-Reply-To: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>
References: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>
Message-ID: <4A97B457.6010004@gmail.com>

Jason Roberts wrote:
>
> Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs 
> with multiple bands? I have a 5-band AIG for which the Python gdal 
> bindings for GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a 
> supported file format." ArcGIS 9.3.1 reports that the "format" of it 
> is "GRID Stack 7.x". It was created using standard ArcGIS tools.
>
I don't think that its quite right to see a GRID stack as an AIG with 
multiple bands. 

 From (somewhat long term) memory an ArcInfo Grid Stack is actually a 
collection of individual grids, rather than a single grid dataset with 
multiple bands.  Within ArcInfo Workstation stacks can be converted to a 
few multiband image formats, and multiband images converted to stacks.  
I *think* that Stacks always have an INFO file, possibly called 
<stackname>.stk, and I also think that the grids composing a stack had 
to have identical bounds, and be in the same workspace.  Any particular 
grid in a workspace could be in zero, one or more stacks.

Anyway I would expect that GDAL will deal fine with the individual grids 
in the stack, as individual datasets.  Any GDAL utility, or binding, 
which can combine individual datasets into a multiband image could 
therefore convert a stack into an image.  Of course you would need to 
know which individual grids form the stack. 

hth
Andrew

From P.Halls at york.ac.uk  Fri Aug 28 07:14:54 2009
From: P.Halls at york.ac.uk (Peter J Halls)
Date: Fri Aug 28 07:15:01 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
In-Reply-To: <4A97B457.6010004@gmail.com>
References: <018e01ca275d$2e257910$8a706b30$@roberts@duke.edu>
	<4A97B457.6010004@gmail.com>
Message-ID: <4A97BC2E.9090409@york.ac.uk>

Andrew is correct.  The ArcGIS grid stack comprises an index to the component 
grids, stackname.stk. The records comprise the grid names.  The grids must be in 
the same location (workspace) and have the same projection / coordinate system 
but do not need to have the same geographic extents (so long as there is an area 
of common overlap) or cell size.  Where the cell size differs, that quoted for 
the stack is the coarsest of the components.

It is quite common to use a stack to collect together raster layers representing 
disparate criteria in order to analyse them together, using geostats, for 
example.  A multi-band stack, such as, for example, might comprise a Landsat TM 
image, is a sort of special case.

Peter

Andrew Loughhead wrote:
> Jason Roberts wrote:
>>
>> Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs 
>> with multiple bands? I have a 5-band AIG for which the Python gdal 
>> bindings for GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a 
>> supported file format." ArcGIS 9.3.1 reports that the "format" of it 
>> is "GRID Stack 7.x". It was created using standard ArcGIS tools.
>>
> I don't think that its quite right to see a GRID stack as an AIG with 
> multiple bands.
>  From (somewhat long term) memory an ArcInfo Grid Stack is actually a 
> collection of individual grids, rather than a single grid dataset with 
> multiple bands.  Within ArcInfo Workstation stacks can be converted to a 
> few multiband image formats, and multiband images converted to stacks.  
> I *think* that Stacks always have an INFO file, possibly called 
> <stackname>.stk, and I also think that the grids composing a stack had 
> to have identical bounds, and be in the same workspace.  Any particular 
> grid in a workspace could be in zero, one or more stacks.
> 
> Anyway I would expect that GDAL will deal fine with the individual grids 
> in the stack, as individual datasets.  Any GDAL utility, or binding, 
> which can combine individual datasets into a multiband image could 
> therefore convert a stack into an image.  Of course you would need to 
> know which individual grids form the stack.
> hth
> Andrew
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
--------------------------------------------------------------------------------
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
--------------------------------------------------------------------------------
From jukka.rahkonen at mmmtike.fi  Fri Aug 28 07:30:59 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Fri Aug 28 07:31:28 2009
Subject: [gdal-dev] Re: Strange things with gdalwarp ...
References: <CC197224AC75CE4DB23F739B16891B86E34376@tikka.haapa.mmm.fi>	<4A8AF78C.3030109@gmx.eu>	<loom.20090820T114441-892@post.gmane.org>	<4A8D69C8.7060503@pobox.com>	<4A8FB1A2.3080401@gmx.eu>	<4A8FBB20.2040509@xpam.de>	<4A9286A8.70106@gmx.eu>
	<4A928A6E.4050206@xpam.de> <4A958410.3040802@gmx.eu>
Message-ID: <loom.20090828T131600-676@post.gmane.org>

Hermann Peifer <peifer <at> gmx.eu> writes:

> Adam wrote:
> > You can test with http://pastebin.com/m45e46f53
> > Also remember to use -wo SKIP_NOSOURCE=YES
> > 
> 
> Adam,
> 
> Will your patch appear in trunk/gdal/alg at some point in time?


Hi,

I had less time than I thought for testing gdalwarping .vrt files.  I have
managed to run gdalwarp at good speed against a .vrt file with 68 GeoTIFF images
(300 MB each).  I do also know that warping .vrt file referring to 200 files in
JPEG2000 format with certain settings is very slow but I have not tested
different JPEG2000 drivers or parameters yet. It would be very interesting to
test the effect of this patch with JPEG2000 images but I am limited to use ready
made Windows32 binaries. I keep my test set-up ready if somebody ever has
gdalwarp binaries including this patch and JPEG2000 support through JP2KAK
driver. We have Kakadu license if it matters.

-Jukka Rahkonen-




From jason.roberts at duke.edu  Fri Aug 28 08:09:58 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Fri Aug 28 08:10:05 2009
Subject: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
	bands?
In-Reply-To: <4A97BC2E.9090409@york.ac.uk>
References: <018e01ca275d$2e257910$8a706b30$%roberts@duke.edu>
	<4A97B457.6010004@gmail.com> <4A97BC2E.9090409@york.ac.uk>
Message-ID: <01ae01ca27d8$77962bf0$66c283d0$@roberts@duke.edu>

Andrew and Peter,

Thanks for this info. I have not worked with ArcGIS grid stacks before so
this is very helpful.

I will append your comments to the ticket we started on this topic
http://trac.osgeo.org/gdal/ticket/3116. Frank deduced some of this already
and I came across some documentation (see link in the ticket) that concurs
with what you've said.

Best,
Jason

-----Original Message-----
From: Peter J Halls [mailto:P.Halls@york.ac.uk] 
Sent: Friday, August 28, 2009 7:15 AM
To: Andrew Loughhead
Cc: Jason Roberts; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Does GDAL support ArcInfo Binary Grids with multiple
bands?

Andrew is correct.  The ArcGIS grid stack comprises an index to the
component 
grids, stackname.stk. The records comprise the grid names.  The grids must
be in 
the same location (workspace) and have the same projection / coordinate
system 
but do not need to have the same geographic extents (so long as there is an
area 
of common overlap) or cell size.  Where the cell size differs, that quoted
for 
the stack is the coarsest of the components.

It is quite common to use a stack to collect together raster layers
representing 
disparate criteria in order to analyse them together, using geostats, for 
example.  A multi-band stack, such as, for example, might comprise a Landsat
TM 
image, is a sort of special case.

Peter

Andrew Loughhead wrote:
> Jason Roberts wrote:
>>
>> Is the GDAL ArcInfo Binary Grid (AIG) driver intended to support AIGs 
>> with multiple bands? I have a 5-band AIG for which the Python gdal 
>> bindings for GDAL 1.6.0 report "`C:\Temp\ccomp2' not recognised as a 
>> supported file format." ArcGIS 9.3.1 reports that the "format" of it 
>> is "GRID Stack 7.x". It was created using standard ArcGIS tools.
>>
> I don't think that its quite right to see a GRID stack as an AIG with 
> multiple bands.
>  From (somewhat long term) memory an ArcInfo Grid Stack is actually a 
> collection of individual grids, rather than a single grid dataset with 
> multiple bands.  Within ArcInfo Workstation stacks can be converted to a 
> few multiband image formats, and multiband images converted to stacks.  
> I *think* that Stacks always have an INFO file, possibly called 
> <stackname>.stk, and I also think that the grids composing a stack had 
> to have identical bounds, and be in the same workspace.  Any particular 
> grid in a workspace could be in zero, one or more stacks.
> 
> Anyway I would expect that GDAL will deal fine with the individual grids 
> in the stack, as individual datasets.  Any GDAL utility, or binding, 
> which can combine individual datasets into a multiband image could 
> therefore convert a stack into an image.  Of course you would need to 
> know which individual grids form the stack.
> hth
> Andrew
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
----------------------------------------------------------------------------
----
Peter J Halls, GIS Advisor, University of York
Telephone: 01904 433806     Fax: 01904 433740
Snail mail: Computing Service, University of York, Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------
----

From Shawn.Gong at drdc-rddc.gc.ca  Fri Aug 28 15:39:36 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Fri Aug 28 15:42:42 2009
Subject: [gdal-dev] TerraSAR-X Geo-coded Product
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26EA8B@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

Is support for ScanSAR data available now?
http://www.gdal.org/frmt_cosar.html

How about TerraSAR-X Geo-coded Product (i.e., image data in GeoTiff
instead of COSAR format)?
When we ingest the XML file, the georeferenced is off. And we ingest the
GTiff file, the georeferenced is good.


thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090828/9c12f1b5/attachment.html
From theodore.wu at ngc.com  Fri Aug 28 19:02:44 2009
From: theodore.wu at ngc.com (TW)
Date: Fri Aug 28 19:02:46 2009
Subject: [Gdal-dev] Eagle Eye compression
Message-ID: <1251500564165-3538964.post@n2.nabble.com>


Hi all, I am new to the forum and have recently started using GDAL for a
project.  What I'm basically trying to do is take a NITF file, extract the
image from it, and display it.  One of the compression methods that NITF
could use is Eagle Eye compression.  I have found very little information on
this and I'm wondering if anyone else has heard of it or knows anything
about it?  This does not seem to be supported in GDAL right now but are
there any plans for doing so?

Thanks
-- 
View this message in context: http://n2.nabble.com/Eagle-Eye-compression-tp3538964p3538964.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
From randyqiuxy at hotmail.com  Sat Aug 29 01:56:56 2009
From: randyqiuxy at hotmail.com (Randyqiu)
Date: Sat Aug 29 01:56:49 2009
Subject: [gdal-dev] help:About Getting StyleString
Message-ID: <BLU137-DS3A91E216988300E2426D2C3F40@phx.gbl>

Hi,

  I have been in trouble with getting S_57 format(.000) files
styleString. 

 According to the article named OGR - Feature Style
<http://www.gdal.org/ogr/ogr_feature_style.html>  Specification, I wanted
to get some information about drawing tools such as colorpen width by
using some functions as follows:

 OGRLayer::GetStyleTable ()OGRFeature::GetStyleString()OGRDataSource::
GetStyleTable()

But they all returned nothing(0x000000) which means these functions were
useless and didnt get what I want .

Now, can you tell me the reason? Is it because I used the wrong function or
anything else? Can you give me an instance about getting the StyleString
or drawing tools information?

 Thanks, any suggestion or help will be appreciated!!!

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090829/68a4ac6c/attachment.html
From warmerdam at pobox.com  Sat Aug 29 12:34:48 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Aug 29 12:34:55 2009
Subject: [gdal-dev] help:About Getting StyleString
In-Reply-To: <BLU137-DS3A91E216988300E2426D2C3F40@phx.gbl>
References: <BLU137-DS3A91E216988300E2426D2C3F40@phx.gbl>
Message-ID: <4A9958A8.7050706@pobox.com>

Randyqiu wrote:
> Hi,
>=20
>   I have been in trouble with getting S_57 format(.000) files=A1=AF=20
> =A1=B0styleString=A1=B1.
>=20
>  According to the article named =A1=B0OGR - Feature Style Specification=
=20
> <http://www.gdal.org/ogr/ogr_feature_style.html>=A1=B1, I wanted to get=
 some=20
> information about =A1=B0drawing tools=A1=B1 such as color=A1=A2pen widt=
h by using some=20
> functions as follows:
>=20
> * OGRLayer::GetStyleTable ()**=A1=A2**OGRFeature::GetStyleString()**=A1=
=A2=20
> **OGRDataSource:: GetStyleTable()*
>=20
> But they all returned nothing(0x000000) which means these functions wer=
e=20
> useless and didn=A1=AFt get what I want .
>=20
> Now, can you tell me the reason? Is it because I used the wrong functio=
n=20
> or anything else? Can you give me an instance about getting the=20
> =A1=B0StyleString=A1=B1 or =A1=B0drawing tools=A1=B1 information?

Randyqiu,

I'm afraid that the S57 driver does not provide style support.  In fact,
I believe only two or three drivers do support styles.  In the case of S5=
7
format the style is not really intrinsic in the file though there are
standards  (S52) defined which indicate how S-57 data ought to be display=
ed.

Best regards,
--=20
---------------------------------------+---------------------------------=
-----
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox=
.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mongoose_riki at mail.ru  Sat Aug 29 13:00:42 2009
From: mongoose_riki at mail.ru (Riki Tiki)
Date: Sat Aug 29 13:00:47 2009
Subject: [gdal-dev] open source tool for TIN visualization
Message-ID: <E1MhRIA-0003MM-00.mongoose_riki-mail-ru@f71.mail.ru>


Hi,

Let's say i have converted LAS(Lidar data file) into TIN (triangular irregular networks file).

Can you help me to find any TIN viewer around available for free? Not necessarily in 3D, would be enough to be able to view it in 2D. Thanks in advance.

Thanks,
Riki
From belaid_moa at hotmail.com  Sat Aug 29 22:32:17 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Sat Aug 29 22:32:19 2009
Subject: [gdal-dev] VRT KernelFilteredSource and NoDataValue
Message-ID: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>


Hi everyone,
    I am using VRT KernelFilteredSource to implement an average filter as done in the VRT tutorial. However, I am still unclear on how it handles the NoDataValue pixels. Are they too averaged or does it leave them as they are? If they are masked,  does do an adjustment for the kernel coefficients to compensate for their absence? Another related question, is how does it handle the pixels on the borders and the kernel coefficients for those pixels?

   Thank you very very much in advance for any help on these issues.

   With best regards.
~Belaid.

_________________________________________________________________
Stay on top of things, check email from other accounts!
http://go.microsoft.com/?linkid=9671355
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090830/c28ec18e/attachment.html
From even.rouault at mines-paris.org  Sun Aug 30 04:12:04 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Aug 30 04:12:23 2009
Subject: [gdal-dev] VRT KernelFilteredSource and NoDataValue
In-Reply-To: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>
References: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>
Message-ID: <1251619924.4a9a345425511@imp.free.fr>

Selon Belaid MOA <belaid_moa@hotmail.com>:

Belaid,

First, the VRTKernelFilteredSource will only recognize the nodata value if you
set it on the VRTRasterBand (it will not fetch it directly from the
<SourceFilename>)

When a nodata value is set and found in one of the values in a NxN square, the
value will be ignored. The effect of this depends whether normalized="1" is set
on <Kernel> or not. If normalized=1, the sum of the coefficients is not
incremented for that nodata value, so the normalization will operate only on
valid pixel values. If normalized=0, the nodata value is just ignored

As far as what happens in the borders is concerned, the code says that : "Fill
in missing areas.  Note that we replicate the edge valid values out.  We don't
using "mirroring" which might be more suitable for some times of filters.  We
also don't mark these pixels as "nodata" though perhaps we should."

Best regards,

Even

>
> Hi everyone,
>     I am using VRT KernelFilteredSource to implement an average filter as
> done in the VRT tutorial. However, I am still unclear on how it handles the
> NoDataValue pixels. Are they too averaged or does it leave them as they are?
> If they are masked,  does do an adjustment for the kernel coefficients to
> compensate for their absence? Another related question, is how does it handle
> the pixels on the borders and the kernel coefficients for those pixels?
>
>    Thank you very very much in advance for any help on these issues.
>
>    With best regards.
> ~Belaid.
>
> _________________________________________________________________
> Stay on top of things, check email from other accounts!
> http://go.microsoft.com/?linkid=9671355


From chaitanya.ch at gmail.com  Sun Aug 30 09:11:45 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Sun Aug 30 09:11:51 2009
Subject: [gdal-dev] convert lines to polygons (2nd post)
In-Reply-To: <1132.168.103.217.117.1245930611.squirrel@ideotrope.org>
References: <1132.168.103.217.117.1245930611.squirrel@ideotrope.org>
Message-ID: <eb502d880908300611j76eb6ce1neabe1c443bf7e079@mail.gmail.com>

Bryan,

You can use the third or fourth arguments of the OGRBuildPolygonFromEdges
which indicate the option to close the polygon automatically and the
tolerence respectively.

Refer to
http://www.gdal.org/ogr/ogr__api_8h.html#74f64386be8d675e8da33d289ccc9892for
a more clear description of the function.

On Thu, Jun 25, 2009 at 5:20 PM, Bryan Keith <bryan@ideotrope.org> wrote:

> Hello,
>
> I'm posting this a second time because I see that by replying to an older
> gdal-dev message, my first message was put in that thread by some e-mail
> clients that sort threaded messages.  Sorry for the repeat.
>
> I'm using BuildPolygonFromEdges in ogr in an attempt to take some lines
> and convert them to polygons.  For a number of my sets of lines
> BuildPolygonFromEdges fails.  I think this is because the lines aren't
> closed.  Is there a way to put a tolerance into BuildPolygonFromEdges so
> that nodes within the tolerance are considered coincident?
>
> Or is there another tool that will do what I want?  I used to use ArcInfo
> CLEAN to do this, but I don't have access to that tool.  I'm open to any
> suggestions, not just gdal/ogr tools.  Thank you.
>
> Bryan
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090830/9ce00ed5/attachment.html
From belaid_moa at hotmail.com  Sun Aug 30 16:02:48 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Sun Aug 30 16:02:50 2009
Subject: [gdal-dev] VRT KernelFilteredSource and NoDataValue
In-Reply-To: <1251619924.4a9a345425511@imp.free.fr>
References: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>
	<1251619924.4a9a345425511@imp.free.fr>
Message-ID: <COL113-W42EF3FF87AF388F19ACED8F4F30@phx.gbl>


As always, thank you very ... very much Even. Just to make sure I understood your reply correctly,
I do the following to set the source_0 and the nodatavalue (passed as argument) 
after creating the XML for the VRTKernelFilteredSource and set it in the papszMetadata array. 
The poBand is the RasterBand I get from the VRT dataset.

      poBand->SetNoDataValue(noDataValue); 
      poBand->SetMetadata( papszMetadata, "vrt_sources" );

Is this right place to set the NoDataValue of the VRTRasterBand?

For the normalization effect (normalized=1), does it mean that:
1- The no data value pixels are ignored AND
2- The coefficients of valid pixels only are adjusted so that their sum  is equal to 1? 
If this is the case, then it is exactly the behavior I want! 

With best regards.
~Belaid.

> Date: Sun, 30 Aug 2009 10:12:04 +0200
> From: even.rouault@mines-paris.org
> To: belaid_moa@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] VRT KernelFilteredSource and NoDataValue
> 
> Selon Belaid MOA <belaid_moa@hotmail.com>:
> 
> Belaid,
> 
> First, the VRTKernelFilteredSource will only recognize the nodata value if you
> set it on the VRTRasterBand (it will not fetch it directly from the
> <SourceFilename>)
> 
> When a nodata value is set and found in one of the values in a NxN square, the
> value will be ignored. The effect of this depends whether normalized="1" is set
> on <Kernel> or not. If normalized=1, the sum of the coefficients is not
> incremented for that nodata value, so the normalization will operate only on
> valid pixel values. If normalized=0, the nodata value is just ignored
> 
> As far as what happens in the borders is concerned, the code says that : "Fill
> in missing areas.  Note that we replicate the edge valid values out.  We don't
> using "mirroring" which might be more suitable for some times of filters.  We
> also don't mark these pixels as "nodata" though perhaps we should."
> 
> Best regards,
> 
> Even
> 
> >
> > Hi everyone,
> >     I am using VRT KernelFilteredSource to implement an average filter as
> > done in the VRT tutorial. However, I am still unclear on how it handles the
> > NoDataValue pixels. Are they too averaged or does it leave them as they are?
> > If they are masked,  does do an adjustment for the kernel coefficients to
> > compensate for their absence? Another related question, is how does it handle
> > the pixels on the borders and the kernel coefficients for those pixels?
> >
> >    Thank you very very much in advance for any help on these issues.
> >
> >    With best regards.
> > ~Belaid.
> >
> > _________________________________________________________________
> > Stay on top of things, check email from other accounts!
> > http://go.microsoft.com/?linkid=9671355
> 
> 

_________________________________________________________________
Click less, chat more: Messenger on MSN.ca
http://go.microsoft.com/?linkid=9677404
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090830/3858841a/attachment.html
From even.rouault at mines-paris.org  Sun Aug 30 16:29:33 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun Aug 30 16:29:41 2009
Subject: [gdal-dev] VRT KernelFilteredSource and NoDataValue
In-Reply-To: <COL113-W42EF3FF87AF388F19ACED8F4F30@phx.gbl>
References: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>
	<1251619924.4a9a345425511@imp.free.fr>
	<COL113-W42EF3FF87AF388F19ACED8F4F30@phx.gbl>
Message-ID: <1251664173.4a9ae12dc9d05@imp.free.fr>

Selon Belaid MOA <belaid_moa@hotmail.com>:

>
> As always, thank you very ... very much Even. Just to make sure I understood
> your reply correctly,
> I do the following to set the source_0 and the nodatavalue (passed as
> argument)
> after creating the XML for the VRTKernelFilteredSource and set it in the
> papszMetadata array.
> The poBand is the RasterBand I get from the VRT dataset.
>
>       poBand->SetNoDataValue(noDataValue);
>       poBand->SetMetadata( papszMetadata, "vrt_sources" );
>
> Is this right place to set the NoDataValue of the VRTRasterBand?
>
> For the normalization effect (normalized=1), does it mean that:
> 1- The no data value pixels are ignored AND
> 2- The coefficients of valid pixels only are adjusted so that their sum  is
> equal to 1?

Yes, correct. Well, that's my understanding of the code : no warranty expressed
or implied ;-) I guess you just have now to try

> If this is the case, then it is exactly the behavior I want!
>
> With best regards.
> ~Belaid.
>
> > Date: Sun, 30 Aug 2009 10:12:04 +0200
> > From: even.rouault@mines-paris.org
> > To: belaid_moa@hotmail.com
> > CC: gdal-dev@lists.osgeo.org
> > Subject: Re: [gdal-dev] VRT KernelFilteredSource and NoDataValue
> >
> > Selon Belaid MOA <belaid_moa@hotmail.com>:
> >
> > Belaid,
> >
> > First, the VRTKernelFilteredSource will only recognize the nodata value if
> you
> > set it on the VRTRasterBand (it will not fetch it directly from the
> > <SourceFilename>)
> >
> > When a nodata value is set and found in one of the values in a NxN square,
> the
> > value will be ignored. The effect of this depends whether normalized="1" is
> set
> > on <Kernel> or not. If normalized=1, the sum of the coefficients is not
> > incremented for that nodata value, so the normalization will operate only
> on
> > valid pixel values. If normalized=0, the nodata value is just ignored
> >
> > As far as what happens in the borders is concerned, the code says that :
> "Fill
> > in missing areas.  Note that we replicate the edge valid values out.  We
> don't
> > using "mirroring" which might be more suitable for some times of filters.
> We
> > also don't mark these pixels as "nodata" though perhaps we should."
> >
> > Best regards,
> >
> > Even
> >
> > >
> > > Hi everyone,
> > >     I am using VRT KernelFilteredSource to implement an average filter as
> > > done in the VRT tutorial. However, I am still unclear on how it handles
> the
> > > NoDataValue pixels. Are they too averaged or does it leave them as they
> are?
> > > If they are masked,  does do an adjustment for the kernel coefficients to
> > > compensate for their absence? Another related question, is how does it
> handle
> > > the pixels on the borders and the kernel coefficients for those pixels?
> > >
> > >    Thank you very very much in advance for any help on these issues.
> > >
> > >    With best regards.
> > > ~Belaid.
> > >
> > > _________________________________________________________________
> > > Stay on top of things, check email from other accounts!
> > > http://go.microsoft.com/?linkid=9671355
> >
> >
>
> _________________________________________________________________
> Click less, chat more: Messenger on MSN.ca
> http://go.microsoft.com/?linkid=9677404


From belaid_moa at hotmail.com  Sun Aug 30 19:00:29 2009
From: belaid_moa at hotmail.com (Belaid MOA)
Date: Sun Aug 30 19:00:32 2009
Subject: [gdal-dev] VRT KernelFilteredSource and NoDataValue
In-Reply-To: <1251664173.4a9ae12dc9d05@imp.free.fr>
References: <COL113-W49E6490089858CE619B43FF4F30@phx.gbl>
	<1251619924.4a9a345425511@imp.free.fr>
	<COL113-W42EF3FF87AF388F19ACED8F4F30@phx.gbl>
	<1251664173.4a9ae12dc9d05@imp.free.fr>
Message-ID: <COL113-W47E81F6B26686B1B8D2282F4F30@phx.gbl>


Thank you very much Even. I will try it then and confirm our understanding!

With best regards.
~Belaid Moa.

> Date: Sun, 30 Aug 2009 22:29:33 +0200
> From: even.rouault@mines-paris.org
> To: belaid_moa@hotmail.com
> CC: even.rouault@mines-paris.org; gdal-dev@lists.osgeo.org
> Subject: RE: [gdal-dev] VRT KernelFilteredSource and NoDataValue
> 
> Selon Belaid MOA <belaid_moa@hotmail.com>:
> 
> >
> > As always, thank you very ... very much Even. Just to make sure I understood
> > your reply correctly,
> > I do the following to set the source_0 and the nodatavalue (passed as
> > argument)
> > after creating the XML for the VRTKernelFilteredSource and set it in the
> > papszMetadata array.
> > The poBand is the RasterBand I get from the VRT dataset.
> >
> >       poBand->SetNoDataValue(noDataValue);
> >       poBand->SetMetadata( papszMetadata, "vrt_sources" );
> >
> > Is this right place to set the NoDataValue of the VRTRasterBand?
> >
> > For the normalization effect (normalized=1), does it mean that:
> > 1- The no data value pixels are ignored AND
> > 2- The coefficients of valid pixels only are adjusted so that their sum  is
> > equal to 1?
> 
> Yes, correct. Well, that's my understanding of the code : no warranty expressed
> or implied ;-) I guess you just have now to try
> 
> > If this is the case, then it is exactly the behavior I want!
> >
> > With best regards.
> > ~Belaid.
> >
> > > Date: Sun, 30 Aug 2009 10:12:04 +0200
> > > From: even.rouault@mines-paris.org
> > > To: belaid_moa@hotmail.com
> > > CC: gdal-dev@lists.osgeo.org
> > > Subject: Re: [gdal-dev] VRT KernelFilteredSource and NoDataValue
> > >
> > > Selon Belaid MOA <belaid_moa@hotmail.com>:
> > >
> > > Belaid,
> > >
> > > First, the VRTKernelFilteredSource will only recognize the nodata value if
> > you
> > > set it on the VRTRasterBand (it will not fetch it directly from the
> > > <SourceFilename>)
> > >
> > > When a nodata value is set and found in one of the values in a NxN square,
> > the
> > > value will be ignored. The effect of this depends whether normalized="1" is
> > set
> > > on <Kernel> or not. If normalized=1, the sum of the coefficients is not
> > > incremented for that nodata value, so the normalization will operate only
> > on
> > > valid pixel values. If normalized=0, the nodata value is just ignored
> > >
> > > As far as what happens in the borders is concerned, the code says that :
> > "Fill
> > > in missing areas.  Note that we replicate the edge valid values out.  We
> > don't
> > > using "mirroring" which might be more suitable for some times of filters.
> > We
> > > also don't mark these pixels as "nodata" though perhaps we should."
> > >
> > > Best regards,
> > >
> > > Even
> > >
> > > >
> > > > Hi everyone,
> > > >     I am using VRT KernelFilteredSource to implement an average filter as
> > > > done in the VRT tutorial. However, I am still unclear on how it handles
> > the
> > > > NoDataValue pixels. Are they too averaged or does it leave them as they
> > are?
> > > > If they are masked,  does do an adjustment for the kernel coefficients to
> > > > compensate for their absence? Another related question, is how does it
> > handle
> > > > the pixels on the borders and the kernel coefficients for those pixels?
> > > >
> > > >    Thank you very very much in advance for any help on these issues.
> > > >
> > > >    With best regards.
> > > > ~Belaid.
> > > >
> > > > _________________________________________________________________
> > > > Stay on top of things, check email from other accounts!
> > > > http://go.microsoft.com/?linkid=9671355
> > >
> > >
> >
> > _________________________________________________________________
> > Click less, chat more: Messenger on MSN.ca
> > http://go.microsoft.com/?linkid=9677404
> 
> 

_________________________________________________________________
New! Get to Messenger faster: Sign-in here now!
http://go.microsoft.com/?linkid=9677407
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090830/1d033838/attachment.html
From rsignell at usgs.gov  Mon Aug 31 07:16:06 2009
From: rsignell at usgs.gov (Rich Signell)
Date: Mon Aug 31 07:16:10 2009
Subject: [gdal-dev] open source tool for TIN visualization
In-Reply-To: <E1MhRIA-0003MM-00.mongoose_riki-mail-ru@f71.mail.ru>
References: <E1MhRIA-0003MM-00.mongoose_riki-mail-ru@f71.mail.ru>
Message-ID: <61033b870908310416o804fbf1k53d6ce5711b7c33c@mail.gmail.com>

Riki,

I have not tried these LIDAR LAS tools, but they looked quite interesting:

http://www.cs.unc.edu/~isenburg/lastools/

-Rich

2009/8/29 Riki Tiki <mongoose_riki@mail.ru>:
>
> Hi,
>
> Let's say i have converted LAS(Lidar data file) into TIN (triangular irregular networks file).
>
> Can you help me to find any TIN viewer around available for free? Not necessarily in 3D, would be enough to be able to view it in 2D. Thanks in advance.
>
> Thanks,
> Riki
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Dr. Richard P. Signell   (508) 457-2229
USGS, 384 Woods Hole Rd.
Woods Hole, MA 02543-1598
From louis.pool at gmail.com  Mon Aug 31 09:07:38 2009
From: louis.pool at gmail.com (Lodewijk Pool)
Date: Mon Aug 31 09:08:02 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and
	OGRSFDriverRegistrar::Open()
Message-ID: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>

Hi All,

I'm having problems opening Raster and Vector Datasources that have
filenames and paths with special characters. I'm using GDALOpen for Raster
sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
pass for the filenames are UTF-8 encoded. Does anyone know whether these
functions support UTF-8 encoding, and if not, whether there are any other
API entry points that do support UTF-8 and/or UTF-16?

Thank you in advance,
Louis.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/4f80f18c/attachment-0001.html
From chaitanya.ch at gmail.com  Mon Aug 31 10:10:36 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon Aug 31 10:10:39 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>
Message-ID: <eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>

Louis,

GDAL/OGR usually supports utf-8 encoding. I just don't know where it doesn't
support.
Can you provide the details of the OS you are working on? Also, some sample
file names that caused you problems will come handy.
I presume you are working in C/C++.

On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool <louis.pool@gmail.com> wrote:

> Hi All,
>
> I'm having problems opening Raster and Vector Datasources that have
> filenames and paths with special characters. I'm using GDALOpen for Raster
> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
> pass for the filenames are UTF-8 encoded. Does anyone know whether these
> functions support UTF-8 encoding, and if not, whether there are any other
> API entry points that do support UTF-8 and/or UTF-16?
>
> Thank you in advance,
> Louis.
>
>  _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/2d8092eb/attachment.html
From louis.pool at gmail.com  Mon Aug 31 10:32:16 2009
From: louis.pool at gmail.com (Lodewijk Pool)
Date: Mon Aug 31 10:32:39 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com> 
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>
Message-ID: <6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com>

Hi Chaitanya,

Yes, this is using the C/C++ API, the functions I am using are declared in *
gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK English
locale) and a version of GDAL 1.6.2 that I compiled for Win32 using the
supplied nmake script files for VC8. The specific filename that is causing
me problems is this one; *"d?coupage_geographique.TAB"*. If I remove the '?'
character in that string and replace it with a normal 'e' the file opens
without any problems.

Any help would be appreciated.

Best Regards,
Louis.




On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH
<chaitanya.ch@gmail.com>wrote:

> Louis,
>
> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
> doesn't support.
> Can you provide the details of the OS you are working on? Also, some sample
> file names that caused you problems will come handy.
> I presume you are working in C/C++.
>
> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>
>> Hi All,
>>
>> I'm having problems opening Raster and Vector Datasources that have
>> filenames and paths with special characters. I'm using GDALOpen for Raster
>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
>> pass for the filenames are UTF-8 encoded. Does anyone know whether these
>> functions support UTF-8 encoding, and if not, whether there are any other
>> API entry points that do support UTF-8 and/or UTF-16?
>>
>> Thank you in advance,
>> Louis.
>>
>>  _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> Best regards,
> --
> Chaitanya kumar CH.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/d5f2190b/attachment.html
From geowiz at shaw.ca  Mon Aug 31 11:24:34 2009
From: geowiz at shaw.ca (Steve Miller)
Date: Mon Aug 31 11:24:37 2009
Subject: [gdal-dev] pdf/svg -> shape
Message-ID: <FF6C01C5-6892-4916-BA42-ECA1988DCA26@shaw.ca>

Hi,

I have a pdf file that contains a vector image. I can get the data  
into an svg file using inkscape. Is there someway of getting this into  
a shape file or other usable GIS file of polylines? I really don't  
want to convert to a raster and have to digitize the data.

Any help would be appreciated.
Thanks,
Steve
From mpg at lizardtech.com  Mon Aug 31 11:25:33 2009
From: mpg at lizardtech.com (Michael P. Gerlek)
Date: Mon Aug 31 11:25:39 2009
Subject: [gdal-dev] Re: open source tool for TIN visualization 
In-Reply-To: <20090831130808.44772E0129F@lists.osgeo.org>
References: <20090831130808.44772E0129F@lists.osgeo.org>
Message-ID: <C55473998E248B4DAEC5342D698DFE85CF8883FE@sea-srv-mail.lizardtech.com>

> I have not tried these LIDAR LAS tools, but they looked quite interesting:
>
> http://www.cs.unc.edu/~isenburg/lastools/

Be careful here -- it is not clear that Isenburg's tools are in fact OSI-compliant open source.  (He has lots of good stuff, and some of us wish it he was clearer on this point.)

[LizardTech has a 3D viewer (very windows-specific, however) which I intend to make open source at some point, but I've just not had the time to finish the job.]

-mpg

From hobu.inc at gmail.com  Mon Aug 31 11:26:57 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Mon Aug 31 11:28:53 2009
Subject: [gdal-dev] Re: open source tool for TIN visualization
In-Reply-To: <C55473998E248B4DAEC5342D698DFE85CF8883FE@sea-srv-mail.lizardtech.com>
References: <20090831130808.44772E0129F@lists.osgeo.org>
	<C55473998E248B4DAEC5342D698DFE85CF8883FE@sea-srv-mail.lizardtech.com>
Message-ID: <59283AB3-3E0C-4012-9FFE-076143887728@gmail.com>


On Aug 31, 2009, at 10:25 AM, Michael P. Gerlek wrote:

>> I have not tried these LIDAR LAS tools, but they looked quite  
>> interesting:
>>
>> http://www.cs.unc.edu/~isenburg/lastools/
>
> Be careful here -- it is not clear that Isenburg's tools are in fact  
> OSI-compliant open source.  (He has lots of good stuff, and some of  
> us wish it he was clearer on this point.)

Indeed.  Martin's tools are definitely not OSI-compliant open source,  
and you can contact him for licensing information if you wish to  
include his code in your softwares.  He did grant libLAS the ability  
to use a port of his lastools commandline utilities (las2las, las2txt  
and so on ... the more mundane administrative-type stuff) however.

Howard
From chaitanya.ch at gmail.com  Mon Aug 31 12:35:14 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon Aug 31 12:35:16 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>
	<6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com>
Message-ID: <eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com>

Louis,

I couldn't reproduce the problem on my WinXP-32 system with vc8 with locale
set to uk english. However, I used the filename on a GeoTiff file. I
couldn't identify the .TAB extension. I am not sure that is a problem.

Some of the drivers may not handle non-ascii data but file names should not
be a problem.

If you don't find any problem at your application side, submit a bug report
at http://trac.osgeo.org/gdal/

On Mon, Aug 31, 2009 at 8:02 PM, Lodewijk Pool <louis.pool@gmail.com> wrote:

> Hi Chaitanya,
>
> Yes, this is using the C/C++ API, the functions I am using are declared in
> *gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK
> English locale) and a version of GDAL 1.6.2 that I compiled for Win32 using
> the supplied nmake script files for VC8. The specific filename that is
> causing me problems is this one; *"d?coupage_geographique.TAB"*. If I
> remove the '?' character in that string and replace it with a normal 'e' the
> file opens without any problems.
>
> Any help would be appreciated.
>
> Best Regards,
> Louis.
>
>
>
>
>
> On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH <chaitanya.ch@
> gmail.com> wrote:
>
>> Louis,
>>
>> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
>> doesn't support.
>> Can you provide the details of the OS you are working on? Also, some
>> sample file names that caused you problems will come handy.
>> I presume you are working in C/C++.
>>
>> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>>
>>> Hi All,
>>>
>>> I'm having problems opening Raster and Vector Datasources that have
>>> filenames and paths with special characters. I'm using GDALOpen for Raster
>>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
>>> pass for the filenames are UTF-8 encoded. Does anyone know whether these
>>> functions support UTF-8 encoding, and if not, whether there are any other
>>> API entry points that do support UTF-8 and/or UTF-16?
>>>
>>> Thank you in advance,
>>> Louis.
>>>
>>>  _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>>
>> Best regards,
>> --
>> Chaitanya kumar CH.
>>
>
>


Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/f12d5f6a/attachment.html
From louis.pool at gmail.com  Mon Aug 31 12:51:57 2009
From: louis.pool at gmail.com (Lodewijk Pool)
Date: Mon Aug 31 12:52:21 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com> 
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com> 
	<6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com> 
	<eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com>
Message-ID: <6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com>

Hi Chaitanya,

I appreciate you taking the time to check. The TAB extension is MapInfo's
vector file format. The odd thing is that I did exactly the same test as you
did, I renamed a GeoTiff file to the offending filename and tried the normal
Raster Driver and got the same problem. Still, as far as you aware these
functions should support UTF-8 encoded strings?  There could possibly be a
peculiarity in the way I pack UTF-8 strings, though I am reasonably certain
that they are encoded correctly.

Could you perhaps send me the code snippet you used to test the
functionality (the part where you pass the string to GDALOpen). Do you think
there is a chance that my compiled version may differ from your own, i.e. is
it possible that I compiled a version of GDAL without UTF support?

Best Regards,
Louis.

On Mon, Aug 31, 2009 at 6:35 PM, Chaitanya kumar CH
<chaitanya.ch@gmail.com>wrote:

> Louis,
>
> I couldn't reproduce the problem on my WinXP-32 system with vc8 with locale
> set to uk english. However, I used the filename on a GeoTiff file. I
> couldn't identify the .TAB extension. I am not sure that is a problem.
>
> Some of the drivers may not handle non-ascii data but file names should not
> be a problem.
>
> If you don't find any problem at your application side, submit a bug report
> at http://trac.osgeo.org/gdal/
>
>
> On Mon, Aug 31, 2009 at 8:02 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>
>> Hi Chaitanya,
>>
>> Yes, this is using the C/C++ API, the functions I am using are declared in
>> *gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK
>> English locale) and a version of GDAL 1.6.2 that I compiled for Win32 using
>> the supplied nmake script files for VC8. The specific filename that is
>> causing me problems is this one; *"d?coupage_geographique.TAB"*. If I
>> remove the '?' character in that string and replace it with a normal 'e' the
>> file opens without any problems.
>>
>> Any help would be appreciated.
>>
>> Best Regards,
>> Louis.
>>
>>
>>
>>
>>
>> On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH <chaitanya.ch@
>> gmail.com> wrote:
>>
>>> Louis,
>>>
>>> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
>>> doesn't support.
>>> Can you provide the details of the OS you are working on? Also, some
>>> sample file names that caused you problems will come handy.
>>> I presume you are working in C/C++.
>>>
>>> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>>>
>>>> Hi All,
>>>>
>>>> I'm having problems opening Raster and Vector Datasources that have
>>>> filenames and paths with special characters. I'm using GDALOpen for Raster
>>>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
>>>> pass for the filenames are UTF-8 encoded. Does anyone know whether these
>>>> functions support UTF-8 encoding, and if not, whether there are any other
>>>> API entry points that do support UTF-8 and/or UTF-16?
>>>>
>>>> Thank you in advance,
>>>> Louis.
>>>>
>>>>  _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>>
>>> Best regards,
>>> --
>>> Chaitanya kumar CH.
>>>
>>
>>
>
>
> Best regards,
> --
> Chaitanya kumar CH.
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/ddd343e8/attachment.html
From chaitanya.ch at gmail.com  Mon Aug 31 13:19:22 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon Aug 31 13:19:25 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>
	<6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com>
	<eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com>
	<6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com>
Message-ID: <eb502d880908311019o40f5eea3t970d3277a267e61e@mail.gmail.com>

Louis,

I tested this with
http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdalinfo.c
GDALOpen() function is called at
http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdalinfo.c#L149

Check if the gdal utility programs work with your data. Use ogrinfo on the
offending mapinfo file and gdalinfo on the geotiff file. This can narrow
down the search.

On Mon, Aug 31, 2009 at 10:21 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:

> Hi Chaitanya,
>
> I appreciate you taking the time to check. The TAB extension is MapInfo's
> vector file format. The odd thing is that I did exactly the same test as you
> did, I renamed a GeoTiff file to the offending filename and tried the normal
> Raster Driver and got the same problem. Still, as far as you aware these
> functions should support UTF-8 encoded strings?  There could possibly be a
> peculiarity in the way I pack UTF-8 strings, though I am reasonably certain
> that they are encoded correctly.
>
> Could you perhaps send me the code snippet you used to test the
> functionality (the part where you pass the string to GDALOpen). Do you think
> there is a chance that my compiled version may differ from your own, i.e. is
> it possible that I compiled a version of GDAL without UTF support?
>
> Best Regards,
> Louis.
>
> On Mon, Aug 31, 2009 at 6:35 PM, Chaitanya kumar CH <chaitanya.ch@
> gmail.com> wrote:
>
>> Louis,
>>
>> I couldn't reproduce the problem on my WinXP-32 system with vc8 with
>> locale set to uk english. However, I used the filename on a GeoTiff file. I
>> couldn't identify the .TAB extension. I am not sure that is a problem.
>>
>> Some of the drivers may not handle non-ascii data but file names should
>> not be a problem.
>>
>> If you don't find any problem at your application side, submit a bug
>> report at http://trac.osgeo.org/gdal/
>>
>>
>> On Mon, Aug 31, 2009 at 8:02 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>>
>>> Hi Chaitanya,
>>>
>>> Yes, this is using the C/C++ API, the functions I am using are declared
>>> in *gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK
>>> English locale) and a version of GDAL 1.6.2 that I compiled for Win32 using
>>> the supplied nmake script files for VC8. The specific filename that is
>>> causing me problems is this one; *"d?coupage_geographique.TAB"*. If I
>>> remove the '?' character in that string and replace it with a normal 'e' the
>>> file opens without any problems.
>>>
>>> Any help would be appreciated.
>>>
>>> Best Regards,
>>> Louis.
>>>
>>> On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH <chaitanya.ch@
>>> gmail.com> wrote:
>>>
>>>> Louis,
>>>>
>>>> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
>>>> doesn't support.
>>>> Can you provide the details of the OS you are working on? Also, some
>>>> sample file names that caused you problems will come handy.
>>>> I presume you are working in C/C++.
>>>>
>>>> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
>>>>
>>>>> Hi All,
>>>>>
>>>>> I'm having problems opening Raster and Vector Datasources that have
>>>>> filenames and paths with special characters. I'm using GDALOpen for Raster
>>>>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings I
>>>>> pass for the filenames are UTF-8 encoded. Does anyone know whether these
>>>>> functions support UTF-8 encoding, and if not, whether there are any other
>>>>> API entry points that do support UTF-8 and/or UTF-16?
>>>>>
>>>>> Thank you in advance,
>>>>> Louis.
>>>>>
>>>>>  _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>
>>>>
>>>>
>>>> Best regards,
>>>> --
>>>> Chaitanya kumar CH.
>>>>
>>>
>>>
>> Best regards,
>> --
>> Chaitanya kumar CH.
>>
>
>
Best regards,
-- 
Chaitanya kumar CH.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/35a25f9e/attachment-0001.html
From even.rouault at mines-paris.org  Mon Aug 31 13:19:55 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug 31 13:19:57 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and
	OGRSFDriverRegistrar::Open()
In-Reply-To: <6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com>
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com>
	<6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com>
	<eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com>
	<6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com>
Message-ID: <1251739195.4a9c063b3b4bd@imp.free.fr>

Louis, Chaintanya,

I just wanted to mention that the topic of encoding for filenames dealt by GDAL
or OGR is a known issue that has not been addressed yet. You can read
http://trac.osgeo.org/gdal/wiki/rfc5_unicode which was a proposal but has not
been implemented. Some infrastructure for re-encoding has been introduced during
the implementation of http://trac.osgeo.org/gdal/wiki/rfc23_ogr_unicode (but
RFC23 only addresses the issue of encoding in OGR field values, not for
filenames)

My understanding is that :
* on Windows the current API used by GDAL/OGR does not expect UTF8 or Unicode
but ANSI.
* on Linux systems, UTF-8 is now assumed

Best regards,

Even

Selon Lodewijk Pool <louis.pool@gmail.com>:

> Hi Chaitanya,
>
> I appreciate you taking the time to check. The TAB extension is MapInfo's
> vector file format. The odd thing is that I did exactly the same test as you
> did, I renamed a GeoTiff file to the offending filename and tried the normal
> Raster Driver and got the same problem. Still, as far as you aware these
> functions should support UTF-8 encoded strings?  There could possibly be a
> peculiarity in the way I pack UTF-8 strings, though I am reasonably certain
> that they are encoded correctly.
>
> Could you perhaps send me the code snippet you used to test the
> functionality (the part where you pass the string to GDALOpen). Do you think
> there is a chance that my compiled version may differ from your own, i.e. is
> it possible that I compiled a version of GDAL without UTF support?
>
> Best Regards,
> Louis.
>
> On Mon, Aug 31, 2009 at 6:35 PM, Chaitanya kumar CH
> <chaitanya.ch@gmail.com>wrote:
>
> > Louis,
> >
> > I couldn't reproduce the problem on my WinXP-32 system with vc8 with locale
> > set to uk english. However, I used the filename on a GeoTiff file. I
> > couldn't identify the .TAB extension. I am not sure that is a problem.
> >
> > Some of the drivers may not handle non-ascii data but file names should not
> > be a problem.
> >
> > If you don't find any problem at your application side, submit a bug report
> > at http://trac.osgeo.org/gdal/
> >
> >
> > On Mon, Aug 31, 2009 at 8:02 PM, Lodewijk Pool <louis.pool@gmail.com>wrote:
> >
> >> Hi Chaitanya,
> >>
> >> Yes, this is using the C/C++ API, the functions I am using are declared in
> >> *gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK
> >> English locale) and a version of GDAL 1.6.2 that I compiled for Win32
> using
> >> the supplied nmake script files for VC8. The specific filename that is
> >> causing me problems is this one; *"d??coupage_geographique.TAB"*. If I
> >> remove the '??' character in that string and replace it with a normal 'e'
> the
> >> file opens without any problems.
> >>
> >> Any help would be appreciated.
> >>
> >> Best Regards,
> >> Louis.
> >>
> >>
> >>
> >>
> >>
> >> On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH <chaitanya.ch@
> >> gmail.com> wrote:
> >>
> >>> Louis,
> >>>
> >>> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
> >>> doesn't support.
> >>> Can you provide the details of the OS you are working on? Also, some
> >>> sample file names that caused you problems will come handy.
> >>> I presume you are working in C/C++.
> >>>
> >>> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool
> <louis.pool@gmail.com>wrote:
> >>>
> >>>> Hi All,
> >>>>
> >>>> I'm having problems opening Raster and Vector Datasources that have
> >>>> filenames and paths with special characters. I'm using GDALOpen for
> Raster
> >>>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the strings
> I
> >>>> pass for the filenames are UTF-8 encoded. Does anyone know whether these
> >>>> functions support UTF-8 encoding, and if not, whether there are any
> other
> >>>> API entry points that do support UTF-8 and/or UTF-16?
> >>>>
> >>>> Thank you in advance,
> >>>> Louis.
> >>>>
> >>>>  _______________________________________________
> >>>> gdal-dev mailing list
> >>>> gdal-dev@lists.osgeo.org
> >>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>>>
> >>>
> >>>
> >>>
> >>> Best regards,
> >>> --
> >>> Chaitanya kumar CH.
> >>>
> >>
> >>
> >
> >
> > Best regards,
> > --
> > Chaitanya kumar CH.
> >
>


From even.rouault at mines-paris.org  Mon Aug 31 13:45:06 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug 31 13:45:09 2009
Subject: [gdal-dev] Re: gdaldem
In-Reply-To: <B6878FCE-C2C0-4278-A8DD-DE78DDA320F8@gmail.com>
References: <2984c6ef0908310220n1956fe78jed0015a7af079044@mail.gmail.com>
	<B6878FCE-C2C0-4278-A8DD-DE78DDA320F8@gmail.com>
Message-ID: <1251740706.4a9c0c22bef03@imp.free.fr>

Selon Howard Butler <hobu.inc@gmail.com>:

I confirm that the 3 new modes have been added just a few days ago to trunk, so
you'll have to wait for the next FWTools or OSGeo4W version. Alternatively, you
could give a try to a daily build done by Tamas Szekeres :
http://vbkto.dyndns.org:1280/sdk/

>
> On Aug 31, 2009, at 4:20 AM, Louis Paladino wrote:
>
> > Hello,
> >
> > First off, let me thank you for providing extremely valuable tools
> > to the GIS/remote sensing community!!
> >
> > I am working with the gdaldem utility and see that a few new tools
> > were added; TRI, TPI, and roughness as documented here
> http://www.gdal.org/gdaldem.html
> > .  However, I am trying to run these tools with FWTools2.4.3 and I
> > get an error saying "Missing valud sub-utility mention."  Under the
> > usage in the command prompt, there is no mention of the
> > aformentioned tools.  Is there a snapshot version of FWTools where
> > these tools are implemented?  How can I access these tools?
> >
> > Thank you in advance for your reply,
>
> Please ask questions like this on the mailing list.
>
> The documentation for the website is generated from the latest trunk
> version of the code.  This means that those utilities are available if
> you are able to build from source code, otherwise you will have to
> wait until new FWTools or OSGeo4W or other distribution picks it up
> and builds it.
>
> Sorry I couldn't be of more help
>
> Howard
>
>


From a.neumann at carto.net  Mon Aug 31 14:15:25 2009
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon Aug 31 14:15:46 2009
Subject: [gdal-dev] pdf/svg -> shape
In-Reply-To: <FF6C01C5-6892-4916-BA42-ECA1988DCA26@shaw.ca>
References: <FF6C01C5-6892-4916-BA42-ECA1988DCA26@shaw.ca>
Message-ID: <4A9C133D.6060309@carto.net>

one approach would be to go throug dxf. Quite a few graphics/drawing 
tools can export to dxf. QGIS can import dxf to shape using a plugin. 
You can then translate/scale the data for georeferencing.

I am sure there are other options as well.

Andreas

Steve Miller wrote:
> Hi,
>
> I have a pdf file that contains a vector image. I can get the data 
> into an svg file using inkscape. Is there someway of getting this into 
> a shape file or other usable GIS file of polylines? I really don't 
> want to convert to a raster and have to digitize the data.
>
> Any help would be appreciated.
> Thanks,
> Steve
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jason.roberts at duke.edu  Mon Aug 31 16:28:47 2009
From: jason.roberts at duke.edu (Jason Roberts)
Date: Mon Aug 31 16:28:56 2009
Subject: [gdal-dev] Reading signed 8-bit Erdas Imagine .img (HFA driver)
Message-ID: <000901ca2a79$a51de650$ef59b2f0$@roberts@duke.edu>

I am testing GDAL's ability to read various data formats commonly
encountered by ArcGIS users, with the goal of replacing some of my
ArcGIS-based infrastructure with GDAL. At the moment I am working through
Erdas Imagine .img format.

 

The GDAL HFA driver page http://www.gdal.org/frmt_hfa.html says "It supports
the erdas band types u8, s8, u16, s16, u32, s32, f32, f64, c64 and c128". I
am trying to figure out how to successfully read s8. I have a .img generated
by ArcGIS from this ArcInfo ASCII grid:

 

ncols 3               

nrows 3

xllcorner 0.0

yllcorner 0.0

cellsize 1.0

-127 63 126

-127 63 126

-127 63 126

 

But I am getting this with the Python bindings and 1.6.0:

 

>>> dataset = gdal.Open(r'C:\Temp\NoDataTest\IMG\WithoutNoData\int8a.img')

>>> band = dataset.GetRasterBand(1)

>>> band.ReadAsArray()

array([[129,  63, 126],

       [129,  63, 126],

       [129,  63, 126]], dtype=uint8)

 

I expected an array with dtype int8 and the first column to have values
-127. 

 

I suspect this problem is here in hfadataset.cpp:

 

    switch( nHFADataType )

    {

      case EPT_u1:

      case EPT_u2:

      case EPT_u4:

      case EPT_u8:

      case EPT_s8:

        eDataType = GDT_Byte;

        break;

 

GDAL only supports unsigned 8-bit integers (GDT_Byte). That is the ultimate
difficulty but it has been worked around before in other drivers. Is there
any possibility that the HFA driver could be changed to work like the AIG
driver, so that S8 data is returned as GDT_Int16 instead of GDT_Byte? 

 

If not, how exactly does this driver support S8 .img files? If I had some
way of detecting that it was S8, I guess I could fix it up by casting the
array to int16 and subtracting 256 from all cells with values > 127. But I
know of no way to detect that it is S8 except by calling an ArcGIS API or
trying to parse .img format myself. Neither of those are a good solution.

 

Thanks for your help,

 

Jason

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090831/9905a091/attachment.html
From louis.pool at gmail.com  Mon Aug 31 19:05:37 2009
From: louis.pool at gmail.com (Lodewijk Pool)
Date: Mon Aug 31 19:06:00 2009
Subject: [gdal-dev] UTF-8 String Support in GDALOpen() and 
	OGRSFDriverRegistrar::Open()
In-Reply-To: <1251739195.4a9c063b3b4bd@imp.free.fr>
References: <6703cf3f0908310607p353dea45g6beb68eef91a8688@mail.gmail.com> 
	<eb502d880908310710n728a5128s452c8380a7f0b868@mail.gmail.com> 
	<6703cf3f0908310732j3d0c8339nf3bdc670170d55bb@mail.gmail.com> 
	<eb502d880908310935l56cb5088m1418304feac8639c@mail.gmail.com> 
	<6703cf3f0908310951q6c4c3978lade215e433d1d29e@mail.gmail.com> 
	<1251739195.4a9c063b3b4bd@imp.free.fr>
Message-ID: <6703cf3f0908311605k7bc909f7uc033be1f78113c3d@mail.gmail.com>

Even,

I think I've figured this out, in my particular example I had a filename
which contained the character '?' (U+00E9), which in UTF-8 encoding is the
two byte sequence 0xC3 0xA9. However, this character is also in the ANSI
character set (233 decimal), which explains why passing a "normal" ANSI
encoded C String to GDALOpen will open the file. If we instead try a
filename with a character that is not in the ANSI character set, for example
'?' (U+0259), then the function will not work (even) with a normal C String.

So the current Win32 C/C++ API does not support UTF-8 encoded strings. Are
you aware of any workarounds that may be available?

Best Regards,
Louis.


On Mon, Aug 31, 2009 at 7:19 PM, Even Rouault
<even.rouault@mines-paris.org>wrote:

> Louis, Chaintanya,
>
> I just wanted to mention that the topic of encoding for filenames dealt by
> GDAL
> or OGR is a known issue that has not been addressed yet. You can read
> http://trac.osgeo.org/gdal/wiki/rfc5_unicode which was a proposal but has
> not
> been implemented. Some infrastructure for re-encoding has been introduced
> during
> the implementation of http://trac.osgeo.org/gdal/wiki/rfc23_ogr_unicode(but
> RFC23 only addresses the issue of encoding in OGR field values, not for
> filenames)
>
> My understanding is that :
> * on Windows the current API used by GDAL/OGR does not expect UTF8 or
> Unicode
> but ANSI.
> * on Linux systems, UTF-8 is now assumed
>
> Best regards,
>
> Even
>
> Selon Lodewijk Pool <louis.pool@gmail.com>:
>
> > Hi Chaitanya,
> >
> > I appreciate you taking the time to check. The TAB extension is MapInfo's
> > vector file format. The odd thing is that I did exactly the same test as
> you
> > did, I renamed a GeoTiff file to the offending filename and tried the
> normal
> > Raster Driver and got the same problem. Still, as far as you aware these
> > functions should support UTF-8 encoded strings?  There could possibly be
> a
> > peculiarity in the way I pack UTF-8 strings, though I am reasonably
> certain
> > that they are encoded correctly.
> >
> > Could you perhaps send me the code snippet you used to test the
> > functionality (the part where you pass the string to GDALOpen). Do you
> think
> > there is a chance that my compiled version may differ from your own, i.e.
> is
> > it possible that I compiled a version of GDAL without UTF support?
> >
> > Best Regards,
> > Louis.
> >
> > On Mon, Aug 31, 2009 at 6:35 PM, Chaitanya kumar CH
> > <chaitanya.ch@gmail.com>wrote:
> >
> > > Louis,
> > >
> > > I couldn't reproduce the problem on my WinXP-32 system with vc8 with
> locale
> > > set to uk english. However, I used the filename on a GeoTiff file. I
> > > couldn't identify the .TAB extension. I am not sure that is a problem.
> > >
> > > Some of the drivers may not handle non-ascii data but file names should
> not
> > > be a problem.
> > >
> > > If you don't find any problem at your application side, submit a bug
> report
> > > at http://trac.osgeo.org/gdal/
> > >
> > >
> > > On Mon, Aug 31, 2009 at 8:02 PM, Lodewijk Pool <louis.pool@gmail.com
> >wrote:
> > >
> > >> Hi Chaitanya,
> > >>
> > >> Yes, this is using the C/C++ API, the functions I am using are
> declared in
> > >> *gdal.h* and *ogrsf_frmts.h* respectively. I am using WinXP 32bit (UK
> > >> English locale) and a version of GDAL 1.6.2 that I compiled for Win32
> > using
> > >> the supplied nmake script files for VC8. The specific filename that is
> > >> causing me problems is this one; *"d?coupage_geographique.TAB"*. If I
> > >> remove the '?' character in that string and replace it with a normal
> 'e'
> > the
> > >> file opens without any problems.
> > >>
> > >> Any help would be appreciated.
> > >>
> > >> Best Regards,
> > >> Louis.
> > >>
> > >>
> > >>
> > >>
> > >>
> > >> On Mon, Aug 31, 2009 at 4:10 PM, Chaitanya kumar CH <chaitanya.ch@
> > >> gmail.com> wrote:
> > >>
> > >>> Louis,
> > >>>
> > >>> GDAL/OGR usually supports utf-8 encoding. I just don't know where it
> > >>> doesn't support.
> > >>> Can you provide the details of the OS you are working on? Also, some
> > >>> sample file names that caused you problems will come handy.
> > >>> I presume you are working in C/C++.
> > >>>
> > >>> On Mon, Aug 31, 2009 at 6:37 PM, Lodewijk Pool
> > <louis.pool@gmail.com>wrote:
> > >>>
> > >>>> Hi All,
> > >>>>
> > >>>> I'm having problems opening Raster and Vector Datasources that have
> > >>>> filenames and paths with special characters. I'm using GDALOpen for
> > Raster
> > >>>> sources and OGRSFDriverRegistrar::Open() for Vector sources, the
> strings
> > I
> > >>>> pass for the filenames are UTF-8 encoded. Does anyone know whether
> these
> > >>>> functions support UTF-8 encoding, and if not, whether there are any
> > other
> > >>>> API entry points that do support UTF-8 and/or UTF-16?
> > >>>>
> > >>>> Thank you in advance,
> > >>>> Louis.
> > >>>>
> > >>>>  _______________________________________________
> > >>>> gdal-dev mailing list
> > >>>> gdal-dev@lists.osgeo.org
> > >>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >>>>
> > >>>
> > >>>
> > >>>
> > >>> Best regards,
> > >>> --
> > >>> Chaitanya kumar CH.
> > >>>
> > >>
> > >>
> > >
> > >
> > > Best regards,
> > > --
> > > Chaitanya kumar CH.
> > >
> >
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090901/d19c4312/attachment-0001.html
