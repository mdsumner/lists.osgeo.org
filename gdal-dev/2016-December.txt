From jukka.rahkonen at maanmittauslaitos.fi  Thu Dec  1 00:08:23 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 1 Dec 2016 01:08:23 -0700 (MST)
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
 bad capabilities
In-Reply-To: <1480535757783-5298089.post@n6.nabble.com>
References: <1480535757783-5298089.post@n6.nabble.com>
Message-ID: <1480579703822-5298160.post@n6.nabble.com>

esacree wrote
> Question:  Is it possible to get a TileLevel option added to the new GDAL
> WMTS driver?
> 
> Reason:  WMTS servers at USGS and ESRI are returning XML Capabilities with
> TileLevel 18 (Google) or TileLevel 19 (default028mm).   The USGS help desk
> said that the tile servers are only serving up to Tile Level 15.  The new
> GDAL WMTS driver always request data from the max TileLevel in the
> Capabilities.  The mismatch between the WMTS XML capabilities and the
> actual maximum TileLevel are causing the GDAL WMTS driver requests to fail
> with Error 404 (not found).
> 
> I have requested that they correct the WMTS XML Capabilities documents.  
> 
> Suggestion:  Could a "TileLevel" parameter be added to the WMTS GDAL
> driver to limit the TileLevel to one that is available?   A TileLevel
> parameter would help work around this situation.
> 
> Thanks!
> 
> Elaine

Hi,

You can do what Even suggested in
https://lists.osgeo.org/pipermail/gdal-dev/2016-November/045615.html:
download and save GetCapabilities on the disk, edit, and read the edited
GetCapabilities with GDAL.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/WMTS-Need-TileLevel-option-Servers-responding-with-bad-capabilities-tp5298089p5298160.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kassies at gmail.com  Thu Dec  1 00:45:36 2016
From: kassies at gmail.com (Rutger)
Date: Thu, 1 Dec 2016 01:45:36 -0700 (MST)
Subject: [gdal-dev] Converting multilayer KML to single layer output
In-Reply-To: <12766887.hqhanpFMqY@even-i700>
References: <1480509894962-5298014.post@n6.nabble.com>
 <12766887.hqhanpFMqY@even-i700>
Message-ID: <1480581936115-5298176.post@n6.nabble.com>

Hey,

Thank you for your reponse. 


Even Rouault-2 wrote
> I can't reproduce your issue with the file not being terminated with ]}
> 
> Hum maybe this is due to trying to append several layers with layers[1:]
> syntax. You should 
> probably 
> 
> Note that currently layers must be provided with an array, and not without
> a string 
> (otherwise it iterates over each character of the string...) This is a
> defect I'm going to fix.
> 
> Note also that the 'overwrite' mode is without effect here (and will
> actually not do what you 
> want). overwrite is for multi-layer datasets where you want to overwrite
> an existing layer. In 
> the GeoJSON driver, this is not implemented. You should just remove it and
> in that case the 
> whole file will be overwritten.

You're right of course about 'layers' not accepting a string if you try to
specify a single layer, i noticed that mistake in my code later on as well.
Its not affecting the behavior i'm experiencing. I work in the Jupyter
Notebook and that moves you away from the console where the GDAL warnings
are printed, which is why i didn't noticed it right away. GDAL prints a nice
'ERROR 1: Couldn't fetch requested layer 'a'!' warning which makes the
sliced string obvious. 


Even Rouault-2 wrote
> Actually I've just tested the following successfully (with trunk)
> 
> from osgeo import gdal
> 
> gdal.VectorTranslate('out.json', 'src', layerName = 'outlayer', format =
> 'GeoJSON', 
> accessMode='append', layers = ['poly', 'poly2', 'poly3'])

Good to know that it should work like that, i started off with something
similar. 

After some more trial and error i think I've found whats wrong. I was first
really focused on the keyword options, hence trying all access modes etc. 

It turns out that its more a flushing/releasing issue, perhaps in
combination with the Jupyter Notebook (holding a reference to the object?).
If i display the returned dataset, Jupyter displays the string 'repr'. I do
this all the time with GDAL datasets just to confirm i actually have a
dataset, whereas a failed command would result in "None". 

But somehow, in this case, closing the dataset with "ds = None" fails to
release the file handle (and doesnt flush?), but only when let Jupyter
display the dataset (repr).  If i close the dataset right away, it works as
expected. 

Here is a notebook showing what i did:
http://nbviewer.jupyter.org/gist/RutgerK/7da186e23b3ec20526c9a1c16c5cf98a

Is the method which doesn't work something that should work, or is it simply
bad practice? I'm pretty sure i do this with the raster utilities all the
time, without any problems.


Regards,
Rutger









--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Converting-multilayer-KML-to-single-layer-output-tp5298014p5298176.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Thu Dec  1 03:45:43 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 1 Dec 2016 11:45:43 +0000
Subject: [gdal-dev] Append new data to GeoPackege raster table as overview
Message-ID: <d6cc64c24251455ba566df36e992e266@C119S212VM022.msvyvi.vaha.local>

Hi,

Let's say that I have these raster maps with 2048 m and 1024 m pixel sizes
http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_8m/2048m/etrs89/png/Taustakartta_8milj.png
http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_8m/2048m/etrs89/png/Taustakartta_8milj.pgw

http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_4m/1024m/etrs89/png/Taustakartta_4milj.png
http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_4m/1024m/etrs89/png/Taustakartta_4milj.pgw

Converting the 8milj.png into GeoPackage raster table is easy

gdal_translate -of gpkg -a_srs epsg:3067 Taustakartta_8milj.png overview.gpkg

Image goes to zoom level 2 as reported by gdalinfo:
Metadata:
  IDENTIFIER=overview
  ZOOM_LEVEL=2

But now the hard part: I would like to append the second image 4milj.png to the same layer "overview" as ZOOM_LEVEL=3 because that  map is designed for that resolution. Is it possible to do that by using some parameters of the driver http://www.gdal.org/drv_geopackage_raster.html or with some clever trick?

-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161201/ef5c3c87/attachment.html>

From even.rouault at spatialys.com  Thu Dec  1 03:58:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 01 Dec 2016 12:58:54 +0100
Subject: [gdal-dev] Append new data to GeoPackege raster table as
	overview
In-Reply-To: <d6cc64c24251455ba566df36e992e266@C119S212VM022.msvyvi.vaha.local>
References: <d6cc64c24251455ba566df36e992e266@C119S212VM022.msvyvi.vaha.local>
Message-ID: <7333265.35pbXzm5M0@even-i700>

On jeudi 1 décembre 2016 11:45:43 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Let's say that I have these raster maps with 2048 m and 1024 m pixel sizes
> http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_8m/2048m/
> etrs89/png/Taustakartta_8milj.png
> http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_8m/2048m
> /etrs89/png/Taustakartta_8milj.pgw
> 
> http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_4m/1024m/
> etrs89/png/Taustakartta_4milj.png
> http://kartat.kapsi.fi/files/taustakarttasarja_jhs180/taustakartta_4m/1024m
> /etrs89/png/Taustakartta_4milj.pgw
> 
> Converting the 8milj.png into GeoPackage raster table is easy
> 
> gdal_translate -of gpkg -a_srs epsg:3067 Taustakartta_8milj.png
> overview.gpkg
> 
> Image goes to zoom level 2 as reported by gdalinfo:
> Metadata:
>   IDENTIFIER=overview
>   ZOOM_LEVEL=2
> 
> But now the hard part: I would like to append the second image 4milj.png to
> the same layer "overview" as ZOOM_LEVEL=3 because that  map is designed for
> that resolution. Is it possible to do that by using some parameters of the
> driver http://www.gdal.org/drv_geopackage_raster.html or with some clever
> trick?

The following works:

gdal_translate Taustakartta_4milj.png test.gpkg -of gpkg  -a_srs epsg:3067 -expand rgba
gdal_translate Taustakartta_8milj.png Taustakartta_8milj_rgba.tif -expand rgba
gdalwarp Taustakartta_8milj_rgba.tif test.gpkg -doo ZOOM_LEVEL=2

Expension to RGBA wouldn't be strictly needed in theory since your 2 rasters have the same palette,
but in practice you have to do it.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161201/77d33b06/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Dec  1 04:13:36 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 1 Dec 2016 05:13:36 -0700 (MST)
Subject: [gdal-dev] Append new data to GeoPackege raster table as
	overview
In-Reply-To: <7333265.35pbXzm5M0@even-i700>
References: <d6cc64c24251455ba566df36e992e266@C119S212VM022.msvyvi.vaha.local>
 <7333265.35pbXzm5M0@even-i700>
Message-ID: <1480594416500-5298218.post@n6.nabble.com>

Even Rouault-2 wrote
> The following works:
> 
> gdal_translate Taustakartta_4milj.png test.gpkg -of gpkg  -a_srs epsg:3067
> -expand rgba
> gdal_translate Taustakartta_8milj.png Taustakartta_8milj_rgba.tif -expand
> rgba
> gdalwarp Taustakartta_8milj_rgba.tif test.gpkg -doo ZOOM_LEVEL=2
> 
> Expension to RGBA wouldn't be strictly needed in theory since your 2
> rasters have the same palette,
> but in practice you have to do it.
> 
> Even

Oh yeah, naturally by polishing with gdalwarp and -doo. I would almost say
"supernaturally". Thanks, I will remember this, and if I won't I can find it
by searching "me+asking+something+tricky".

-Jukka-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Append-new-data-to-GeoPackege-raster-table-as-overview-tp5298214p5298218.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Thu Dec  1 11:35:30 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Thu, 1 Dec 2016 19:35:30 +0000 (UTC)
Subject: [gdal-dev] osm_id vs osm_way_id?
References: <814222902.4600775.1480620930127.ref@mail.yahoo.com>
Message-ID: <814222902.4600775.1480620930127@mail.yahoo.com>

Hello,
I am converting an .osm file to shapefile, and there is one thing that I do not understand:

What is the difference between: osm_id and osm_way_id fields (keys)?

They are defined in osmconf.ini file, but only for [multipolygons].
Here is an explanation from the osmconf.ini file:

# note: for multipolygons, osm_id=yes instanciates a osm_id field for the id of relations
# and a osm_way_id field for the id of closed ways. Both fields are exclusively set.
Does that mean that osm_way_id will be used to represent the osm id number of a closed way, while osm_id will only be used for to represent the osm id number of relations?

It's a bit confusing concept.

What makes the closed ways so special so that they need to have their own special field (osm_way_id)?
Why wasn't there a separate field for relations instead: like: osm_relation_id, while closed ways would use the osm_id.

Thank you for the reply.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161201/7abb8f87/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Dec  1 14:02:56 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 1 Dec 2016 15:02:56 -0700 (MST)
Subject: [gdal-dev] osm_id vs osm_way_id?
In-Reply-To: <814222902.4600775.1480620930127@mail.yahoo.com>
References: <814222902.4600775.1480620930127@mail.yahoo.com>
Message-ID: <1480629776252-5298304.post@n6.nabble.com>

georges wrote
> Hello,
> I am converting an .osm file to shapefile, and there is one thing that I
> do not understand:
> 
> What is the difference between: osm_id and osm_way_id fields (keys)?
> 
> They are defined in osmconf.ini file, but only for [multipolygons].
> Here is an explanation from the osmconf.ini file:
> 
> # note: for multipolygons, osm_id=yes instanciates a osm_id field for the
> id of relations
> # and a osm_way_id field for the id of closed ways. Both fields are
> exclusively set.
> Does that mean that osm_way_id will be used to represent the osm id number
> of a closed way, while osm_id will only be used for to represent the osm
> id number of relations?
> 
> It's a bit confusing concept.
> 
> What makes the closed ways so special so that they need to have their own
> special field (osm_way_id)?
> Why wasn't there a separate field for relations instead: like:
> osm_relation_id, while closed ways would use the osm_id.
> 
> Thank you for the reply.

Indeed, OSM data model is a bit confusing concept. You can read about it
from https://wiki.openstreetmap.org/wiki/Elements. Simple, small polygons
are usually modeled as a one continuous, closed ring. That makes one "way"
and the ID for it is found from way_id. All the other polygons are modeled
as relations which are collections of ways and they have "relation_id" in
the data as you can see

node_id http://www.openstreetmap.org/api/0.6/node/389960161
way_id  http://www.openstreetmap.org/api/0.6/way/34028339
relation_id http://www.openstreetmap.org/api/0.6/relation/125519

IDs are unique only for nodes/ways/relations but not across the elements. I
do not think that renaming osm_id into relation_id (and probably osm_id of
points into node_id, or?) and osm_way_id into way_id to follow the native
model would make things very much more clear.

-Jukka Rahkonen-










--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-osm-id-vs-osm-way-id-tp5298287p5298304.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Thu Dec  1 17:14:13 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Fri, 2 Dec 2016 01:14:13 +0000 (UTC)
Subject: [gdal-dev] osm_id vs osm_way_id?
In-Reply-To: <1480629776252-5298304.post@n6.nabble.com>
References: <814222902.4600775.1480620930127@mail.yahoo.com>
 <1480629776252-5298304.post@n6.nabble.com>
Message-ID: <329729624.4812002.1480641253200@mail.yahoo.com>

Hi Jukka,
As always thank you for the useful share of knowledge!!

> IDs are unique only for nodes/ways/relations but not across the elements. I
do not think that renaming osm_id into relation_id (and probably osm_id of
points into node_id, or?) and osm_way_id into way_id to follow the native
model would make things very much more clear.

I was only questioning why can't "osm_way_id" be renamed to "osm_relation_id". The "osm_id" would remain the same.
Of course I am not a developer, I was just thinking out loud, and hopping that somebody might explain to me, why is there the "osm_way_id" key.
I could totally be wrong.

All three examples you've sent me:

http://www.openstreetmap.org/api/0.6/node/389960161
http://www.openstreetmap.org/api/0.6/way/34028339 http://www.openstreetmap.org/api/0.6/relation/125519

Show the id of three different elements: An id of a node, of a way, and of a relation.

What makes it confusing (at least to me) is why did developers of the GDAL OSM driver decided to use a separate key(field) to depict the closed ways?

I understand that and ESRI shapefile can not differentiate between a closed way and a relation (for example: a relation consisted of two closed ways). So they had to "group" both closed ways and relation into a single shapefile geometry type (multi)polygons/polylines. But still, if they wanted to differentiate between these two elements, it's more logical (at least to me) that a relation should have gotten a separate key(field), instead of a close way. A relation is higher in the hierarchy of OSM elements, and can contain different elements (a node and a way, three ways, fours nodes...).

I am just thinking out loud, nothing more.I can definitively be wrong, and I am eager to learn more about the OSM in general.

 
----------------------------
    On Thursday, December 1, 2016 11:03 PM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
 

 georges wrote
> Hello,
> I am converting an .osm file to shapefile, and there is one thing that I
> do not understand:
> 
> What is the difference between: osm_id and osm_way_id fields (keys)?
> 
> They are defined in osmconf.ini file, but only for [multipolygons].
> Here is an explanation from the osmconf.ini file:
> 
> # note: for multipolygons, osm_id=yes instanciates a osm_id field for the
> id of relations
> # and a osm_way_id field for the id of closed ways. Both fields are
> exclusively set.
> Does that mean that osm_way_id will be used to represent the osm id number
> of a closed way, while osm_id will only be used for to represent the osm
> id number of relations?
> 
> It's a bit confusing concept.
> 
> What makes the closed ways so special so that they need to have their own
> special field (osm_way_id)?
> Why wasn't there a separate field for relations instead: like:
> osm_relation_id, while closed ways would use the osm_id.
> 
> Thank you for the reply.

Indeed, OSM data model is a bit confusing concept. You can read about it
from https://wiki.openstreetmap.org/wiki/Elements. Simple, small polygons
are usually modeled as a one continuous, closed ring. That makes one "way"
and the ID for it is found from way_id. All the other polygons are modeled
as relations which are collections of ways and they have "relation_id" in
the data as you can see

node_id http://www.openstreetmap.org/api/0.6/node/389960161
way_id  http://www.openstreetmap.org/api/0.6/way/34028339
relation_id http://www.openstreetmap.org/api/0.6/relation/125519

IDs are unique only for nodes/ways/relations but not across the elements. I
do not think that renaming osm_id into relation_id (and probably osm_id of
points into node_id, or?) and osm_way_id into way_id to follow the native
model would make things very much more clear.

-Jukka Rahkonen-

--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-osm-id-vs-osm-way-id-tp5298287p5298304.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161202/4560f0b6/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Dec  1 23:59:35 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 2 Dec 2016 07:59:35 +0000
Subject: [gdal-dev] osm_id vs osm_way_id?
Message-ID: <f9ec8d04cdb14755961b09f6f1403945@C119S212VM022.msvyvi.vaha.local>

Hi,

ogr2ogr creates these ids:


-          for point data node_id becomes ”osm_id”

-          for linestrings way_id becomes “osm_id”

-          for multilinestrings relation_id becomes “osm_id”

-          for other relations relation_id becomes “osm_id”

-          for polygons which come from relations relation_id becomes “osm_id” and osm_way_id is null

-          for polygons which come from ways the way_id becomes osm_way_id and osm_id is null

GDAL cannot write ids of the way polygons and relation polygons into the same ID field because there would be duplicate ids (same numbers coming from way_id and relation_id).

Historically GDAL wrote way polygons into layer named ”polygons” and relation polygons into ”multipolygons” and both had just “osm_id”. It was perhaps more clear when it comes to ids but more fuzzy for users to find polygons from two different tables. Remember that in the OSM model a way polygon must be converted into relation polygon if user wants to make a hole into the polygon.

If I understand right you consider that instead of having now in the multipolygon layer relation_id as osm_id and way_id as osm_way_id it would be better to have way_id as osm_id and relation_id as osm_relation_id.  Perhaps yes, but for my mind the difference is not huge.

I guess that when the developer of the OSM driver stopped using the “polygons” layer they made the driver to write also the way polygons into the existing “multipolygons” layer. That layer already had osm_id so a new field osm_way_id was simply added into that layer.

If you can prove that there are some general use cases where renaming the id fields of the multipolygons layer would be a big improvement, please file a feature request.

-Jukka Rahkonen-


Djordje Spasic wrote:
Re: [gdal-dev] osm_id vs osm_way_id?

Hi Jukka,


As always thank you for the useful share of knowledge!!

> IDs are unique only for nodes/ways/relations but not across the elements. I
do not think that renaming osm_id into relation_id (and probably osm_id of
points into node_id, or?) and osm_way_id into way_id to follow the native
model would make things very much more clear.

I was only questioning why can't "osm_way_id" be renamed to "osm_relation_id". The "osm_id" would remain the same.

Of course I am not a developer, I was just thinking out loud, and hopping that somebody might explain to me, why is there the "osm_way_id" key.
I could totally be wrong.



All three examples you've sent me:

http://www.openstreetmap.org/api/0.6/node/389960161
http://www.openstreetmap.org/api/0.6/way/34028339 http://www.openstreetmap.org/api/0.6/relation/125519

Show the id of three different elements: An id of a node, of a way, and of a relation.

What makes it confusing (at least to me) is why did developers of the GDAL OSM driver decided to use a separate key(field) to depict the closed ways?

I understand that and ESRI shapefile can not differentiate between a closed way and a relation (for example: a relation consisted of two closed ways). So they had to "group" both closed ways and relation into a single shapefile geometry type (multi)polygons/polylines. But still, if they wanted to differentiate between these two elements, it's more logical (at least to me) that a relation should have gotten a separate key(field), instead of a close way. A relation is higher in the hierarchy of OSM elements, and can contain different elements (a node and a way, three ways, fours nodes...).

I am just thinking out loud, nothing more.
I can definitively be wrong, and I am eager to learn more about the OSM in general.




----------------------------
On Thursday, December 1, 2016 11:03 PM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

georges wrote
> Hello,
> I am converting an .osm file to shapefile, and there is one thing that I
> do not understand:
>
> What is the difference between: osm_id and osm_way_id fields (keys)?
>
> They are defined in osmconf.ini file, but only for [multipolygons].
> Here is an explanation from the osmconf.ini file:
>
> # note: for multipolygons, osm_id=yes instanciates a osm_id field for the
> id of relations
> # and a osm_way_id field for the id of closed ways. Both fields are
> exclusively set.
> Does that mean that osm_way_id will be used to represent the osm id number
> of a closed way, while osm_id will only be used for to represent the osm
> id number of relations?
>
> It's a bit confusing concept.
>
> What makes the closed ways so special so that they need to have their own
> special field (osm_way_id)?
> Why wasn't there a separate field for relations instead: like:
> osm_relation_id, while closed ways would use the osm_id.
>
> Thank you for the reply.

Indeed, OSM data model is a bit confusing concept. You can read about it
from https://wiki.openstreetmap.org/wiki/Elements. Simple, small polygons
are usually modeled as a one continuous, closed ring. That makes one "way"
and the ID for it is found from way_id. All the other polygons are modeled
as relations which are collections of ways and they have "relation_id" in
the data as you can see

node_id http://www.openstreetmap.org/api/0.6/node/389960161
way_id  http://www.openstreetmap.org/api/0.6/way/34028339

relation_id
http://www.openstreetmap.org/api/0.6/relation/125519

IDs are unique only for nodes/ways/relations but not across the elements. I
do not think that renaming osm_id into relation_id (and probably osm_id of
points into node_id, or?) and osm_way_id into way_id to follow the native
model would make things very much more clear.

-Jukka Rahkonen-

--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-osm-id-vs-osm-way-id-tp5298287p5298304.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161202/5ebf723a/attachment-0001.html>

From issworld2000 at yahoo.com  Fri Dec  2 04:00:21 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Fri, 2 Dec 2016 12:00:21 +0000 (UTC)
Subject: [gdal-dev] osm_id vs osm_way_id?
In-Reply-To: <f9ec8d04cdb14755961b09f6f1403945@C119S212VM022.msvyvi.vaha.local>
References: <f9ec8d04cdb14755961b09f6f1403945@C119S212VM022.msvyvi.vaha.local>
Message-ID: <548671696.5051373.1480680021218@mail.yahoo.com>

Hi Jukka,

Thank you again for the explanation and information about GDAL history!!


> If I understand right you consider that instead of having now in the multipolygon layer relation_id as osm_id and way_id as osm_way_id it would be better to have way_id as osm_id and relation_id as osm_relation_id.  Perhaps yes, but for my mind the difference is not huge. 
Yes.


> I guess that when the developer of the OSM driver stopped using the “polygons” layer they made the driver to write also the way polygons into the existing “multipolygons” layer. That layer already had osm_id so a new field osm_way_id was simply added into that layer.
That perfectly explains my question!!


> If you can prove that there are some general use cases where renaming the id fields of the multipolygons layer would be a big improvement, please file a feature request.

I do not have any big or moderate improvement in mind. Your explanation on OSM driver history cleared why is that so.


Thank you once again Jukka.
I owe you at least a beer for the help you provided for the last couple of weeks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161202/f2af1a55/attachment.html>

From even.rouault at spatialys.com  Fri Dec  2 08:33:53 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 02 Dec 2016 17:33:53 +0100
Subject: [gdal-dev] How does WMTS driver detect DataWindow?
In-Reply-To: <808e5405157b4b49b807d7bae40042a1@C119S212VM022.msvyvi.vaha.local>
References: <808e5405157b4b49b807d7bae40042a1@C119S212VM022.msvyvi.vaha.local>
Message-ID: <1558948.GNO92XVUso@even-i700>

On mardi 29 novembre 2016 11:49:36 CET Rahkonen Jukka (MML) wrote:
> With a little help GDAL picks up correct extent. Removing the erroneous
> WGS84BoundingBox hint from GetCapabilities made it.
> 
> I consider that there is a bug in the WMTS server which is advertising
> invalid bounding box but I don't really know GDAL should do. I am not good
> at reading the code from
> https://trac.osgeo.org/gdal/browser/trunk/gdal/frmts/wmts/wmtsdataset.cpp
> but I do see that there are comments about making a clip with the implied
> bounding box of the most precise tile matrix, taking into account the
> TileMatrix limits if they appear in GetCapabilities
> 
> The logic seems to be now
> 
> 
> 1)      Use the BoundingBox of the layer expressed in the SRS of the tile
> matrix set if that exists (row 1394)
> 
> 2)      Otherwise use the BoundingBox of the layer expressed in some other
> SRS (for example WGS84) if that exists (row 1506)
> 
> 3)      Otherwise use the BoundingBox of the tile matrix set if that exists
> (row 1550)
> 
> 4)      Otherwise compute the bounding box from the definition of the most
> precise tile matrix (1558)
> 
> The comments about clipping are on rows 1572 and 1587.
> 
> So if the meaning was to take the advertised bounding box and clip it with
> the box that is computed from the tile matrix set and its limits, it seems
> to fail with our data
> 
> In our case the layer has this faulty
> <ows:WGS84BoundingBox>
> <ows:LowerCorner>-6.38153862706 55.6179644952</ows:LowerCorner>
> <ows:UpperCorner>60.3815386271 75.5825702342</ows:UpperCorner>
> </ows:WGS84BoundingBox>
> 
> and our most precise TM is
> <TileMatrix>
> <ows:Identifier>13</ows:Identifier>
> <ScaleDenominator>3571.42857143</ScaleDenominator>
> <TopLeftCorner>-548576.0 8388608.0</TopLeftCorner>
> <TileWidth>256</TileWidth>
> <TileHeight>256</TileHeight>
> <MatrixWidth>8192</MatrixWidth>
> <MatrixHeight>8192</MatrixHeight>
> </TileMatrix>
> 
> With WGS84BoundingBox GDAL finds
> <DataWindow>
>     <UpperLeftX>-1553364.000000402</UpperLeftX>
>     <UpperLeftY>8388608</UpperLeftY>
>     <LowerRightX>2553364.000001241</LowerRightX>
>     <LowerRightY>6681097.999999317</LowerRightY>
>   </DataWindow>
> 
> and without WGS84BoundingBox the correct
> <DataWindow>
>     <UpperLeftX>-548576</UpperLeftX>
>     <UpperLeftY>8388608</UpperLeftY>
>     <LowerRightX>1548576</LowerRightX>
>     <LowerRightY>6291456</LowerRightY>
>   </DataWindow>

OK, I managed to reproduce with your above elements. I've pushed a fix so that in that case 
the WGS84BoundingBox is just ignored and the most precise tile matrix used.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161202/7b3c78cb/attachment.html>

From hannah.augustin at gmail.com  Sat Dec  3 06:24:39 2016
From: hannah.augustin at gmail.com (Hannah Augustin)
Date: Sat, 3 Dec 2016 15:24:39 +0100
Subject: [gdal-dev] GRIB file error: Ran out of file reading SECT0
Message-ID: <CABeE34v58_YfvP=qCnDoPbJp-L3mSUP=LOcAFXh=BUKLdFytVA@mail.gmail.com>

Hello all,
For the first time I am working with GRIB files and have stumbled across a
problem having GDAL open files. The data source is the Copernicus
Atmosphere Monitoring Service (CAMS <https://atmosphere.copernicus.eu/>).
QGIS, ArcGIS and GRIB viewers have no problem opening the file for view,
yet GDAL returns this error using multiple functions, including gdalinfo:

Warning: Inside GRIB2Inventory, Message # 26
ERROR: Ran out of file reading SECT0
There were 72 trailing bytes in the file.

Depending on the file, the reported trailing bytes varies. I should also
mention that no spatial reference system is defined, though my assumption
is that it is WGS 84, based on the data. If I just wanted to view the data,
I would  use any of the aforementioned software to do so, but I would like
to archive selected GRIB datasets in a postGIS database if possible.

Does anyone know the source of this error message? Has anyone found a work
around? I would attach a sample GRIB file, but am not sure as to the
protocol for attachments on this listserv.

kind regards,
Hannah Augustin

More info about the dataset including error message and first band (out of
25) of GRIB file:
PS C:\temp> gdalinfo .\z_cams_c_ecmf_20161203000000_prod_an_pl_000_ch4.grib
Warning: Inside GRIB2Inventory, Message # 26
ERROR: Ran out of file reading SECT0
There were 72 trailing bytes in the file.
Driver: GRIB/GRIdded Binary (.grb)
Files: .\z_cams_c_ecmf_20161203000000_prod_an_pl_000_ch4.grb
Size is 900, 451
Coordinate System is:
GEOGCS["Coordinate System imported from GRIB file",
    DATUM["unknown",
        SPHEROID["Sphere",6367470,0]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433]]
Origin = (-0.200000000000000,90.200000000000003)
Pixel Size = (0.400000000000000,-0.400000000000000)
Corner Coordinates:
Upper Left  (  -0.2000000,  90.2000000) (  0d12' 0.00"W, 90d12' 0.00"N)
Lower Left  (  -0.2000000, -90.2000000) (  0d12' 0.00"W, 90d12' 0.00"S)
Upper Right (     359.800,      90.200) (359d48' 0.00"E, 90d12' 0.00"N)
Lower Right (     359.800,     -90.200) (359d48' 0.00"E, 90d12' 0.00"S)
Center      ( 179.8000000,   0.0000000) (179d48' 0.00"E,  0d 0' 0.01"N)
Band 1 Block=900x1 Type=Float64, ColorInterp=Undefined
  Description = 1[hPa] ISBL (Isobaric surface)
  Metadata:
    GRIB_COMMENT=Potential vorticity [m^2K/kg/s]
    GRIB_ELEMENT=PVORT
    GRIB_FORECAST_SECONDS=0 sec
    GRIB_REF_TIME=  1480723200 sec UTC
    GRIB_SHORT_NAME=1-ISBL
    GRIB_UNIT=[m^2K/kg/s]
    GRIB_VALID_TIME=  1480723200 sec UTC
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161203/a3c7955f/attachment.html>

From even.rouault at spatialys.com  Sat Dec  3 06:41:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 03 Dec 2016 15:41:21 +0100
Subject: [gdal-dev] GRIB file error: Ran out of file reading SECT0
In-Reply-To: <CABeE34v58_YfvP=qCnDoPbJp-L3mSUP=LOcAFXh=BUKLdFytVA@mail.gmail.com>
References: <CABeE34v58_YfvP=qCnDoPbJp-L3mSUP=LOcAFXh=BUKLdFytVA@mail.gmail.com>
Message-ID: <3641865.AIvXEcaBY1@even-i700>

On samedi 3 décembre 2016 15:24:39 CET Hannah Augustin wrote:
> Hello all,
> For the first time I am working with GRIB files and have stumbled across a
> problem having GDAL open files. The data source is the Copernicus
> Atmosphere Monitoring Service (CAMS <https://atmosphere.copernicus.eu/>).
> QGIS, ArcGIS and GRIB viewers have no problem opening the file for view,

QGIS uses GDAL to read GRIB files.

> yet GDAL returns this error using multiple functions, including gdalinfo:
> 
> Warning: Inside GRIB2Inventory, Message # 26
> ERROR: Ran out of file reading SECT0
> There were 72 trailing bytes in the file.

This warning/error doesn't prevent GDAL from opening the file since gdalinfo reports a 
dataset. Does gdal_translate to a GeoTIFF work ? Presumably yes, otherwise QGIS wouldn't 
have displayed the dataset. Then just ignore the warning.

I'm not sure if it is an issue in the degrib library used by GDAL or if the datasets have some 
form of non conformance and degrib is picky about it.

> 
> Depending on the file, the reported trailing bytes varies. I should also
> mention that no spatial reference system is defined, though my assumption
> is that it is WGS 84, based on the data.

In the below report, there is a SRS reported. Geographic based on a sphere of radius = 
6367470 m. Given the rather low resolution of this dataset, considering this is WGS84 or 
any other datum based on Greenwich is OK

> If I just wanted to view the data,
> I would  use any of the aforementioned software to do so, but I would like
> to archive selected GRIB datasets in a postGIS database if possible.
> 
> Does anyone know the source of this error message? Has anyone found a work
> around? I would attach a sample GRIB file, but am not sure as to the
> protocol for attachments on this listserv.
> 
> kind regards,
> Hannah Augustin
> 
> More info about the dataset including error message and first band (out of
> 25) of GRIB file:
> PS C:\temp> gdalinfo .\z_cams_c_ecmf_20161203000000_prod_an_pl_000_ch4.grib
> Warning: Inside GRIB2Inventory, Message # 26
> ERROR: Ran out of file reading SECT0
> There were 72 trailing bytes in the file.
> Driver: GRIB/GRIdded Binary (.grb)
> Files: .\z_cams_c_ecmf_20161203000000_prod_an_pl_000_ch4.grb
> Size is 900, 451
> Coordinate System is:
> GEOGCS["Coordinate System imported from GRIB file",
>     DATUM["unknown",
>         SPHEROID["Sphere",6367470,0]],
>     PRIMEM["Greenwich",0],
>     UNIT["degree",0.0174532925199433]]
> Origin = (-0.200000000000000,90.200000000000003)
> Pixel Size = (0.400000000000000,-0.400000000000000)
> Corner Coordinates:
> Upper Left  (  -0.2000000,  90.2000000) (  0d12' 0.00"W, 90d12' 0.00"N)
> Lower Left  (  -0.2000000, -90.2000000) (  0d12' 0.00"W, 90d12' 0.00"S)
> Upper Right (     359.800,      90.200) (359d48' 0.00"E, 90d12' 0.00"N)
> Lower Right (     359.800,     -90.200) (359d48' 0.00"E, 90d12' 0.00"S)
> Center      ( 179.8000000,   0.0000000) (179d48' 0.00"E,  0d 0' 0.01"N)
> Band 1 Block=900x1 Type=Float64, ColorInterp=Undefined
>   Description = 1[hPa] ISBL (Isobaric surface)
>   Metadata:
>     GRIB_COMMENT=Potential vorticity [m^2K/kg/s]
>     GRIB_ELEMENT=PVORT
>     GRIB_FORECAST_SECONDS=0 sec
>     GRIB_REF_TIME=  1480723200 sec UTC
>     GRIB_SHORT_NAME=1-ISBL
>     GRIB_UNIT=[m^2K/kg/s]
>     GRIB_VALID_TIME=  1480723200 sec UTC


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161203/0acaffbe/attachment.html>

From landa.martin at gmail.com  Sat Dec  3 10:32:33 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 3 Dec 2016 19:32:33 +0100
Subject: [gdal-dev] compilation error: jump to label 'free_warper'
Message-ID: <CA+Ei1OfHFPK86mhap=8eC8BnOcx71_sNTXufTYDPrpg6EXqAFg@mail.gmail.com>

Hi,

I am unable to compile GDAL trunk on my Debian (unstable) since today.
The compilation fails with:

gdalwarpkernel.cpp: In function 'CPLErr GWKOpenCLCase(GDALWarpKernel*)':
gdalwarpkernel.cpp:4494:1: error: jump to label 'free_warper' [-fpermissive]
 free_warper:
 ^
gdalwarpkernel.cpp:4280:22: note:   from here
                 goto free_warper;
                      ^
gdalwarpkernel.cpp:4322:18: note:   crosses initialization of 'const
double dfErrorThreshold'
     const double dfErrorThreshold = CPLAtof(
                  ^
gdalwarpkernel.cpp:4319:18: note:   crosses initialization of 'const
double dfSrcCoordPrecision'
     const double dfSrcCoordPrecision = CPLAtof(
                  ^
gdalwarpkernel.cpp:4318:10: note:   crosses initialization of 'int* pabSuccess'
     int *pabSuccess = static_cast<int *>(CPLMalloc(sizeof(int) * nDstXSize));
          ^
gdalwarpkernel.cpp:4316:13: note:   crosses initialization of 'double* padfZ'
     double *padfZ =
             ^
gdalwarpkernel.cpp:4314:14: note:   crosses initialization of 'double* padfY'
     double * padfY =
              ^
gdalwarpkernel.cpp:4312:13: note:   crosses initialization of 'double* padfX'
     double *padfX =


Running:

g++ (Debian 5.4.1-4) 5.4.1 20161202

My configuration:

    CFLAGS="-Wall -g" CXXFLAGS="-Wall -g" \
        ./configure --prefix=/usr/local --enable-debug
--mandir=/usr/local/share \
        --with-sqlite3 --with-spatialite=/usr/local --with-python \
        --with-gnu-ld --with-threads --with-opencl

Any idea, thanks, Martin

PS: BTW, I was surprised that GDAL uses goto statements.

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sat Dec  3 10:55:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 03 Dec 2016 19:55:15 +0100
Subject: [gdal-dev] compilation error: jump to label 'free_warper'
In-Reply-To: <CA+Ei1OfHFPK86mhap=8eC8BnOcx71_sNTXufTYDPrpg6EXqAFg@mail.gmail.com>
References: <CA+Ei1OfHFPK86mhap=8eC8BnOcx71_sNTXufTYDPrpg6EXqAFg@mail.gmail.com>
Message-ID: <10505661.C7soDevQvE@even-i700>

On samedi 3 décembre 2016 19:32:33 CET Martin Landa wrote:
> Hi,
> 
> I am unable to compile GDAL trunk on my Debian (unstable) since today.
> The compilation fails with:

Fixed

> 
> PS: BTW, I was surprised that GDAL uses goto statements.

Was a .c file. I've replaced the gotos with exception throwing.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161203/fe91fce9/attachment.html>

From landa.martin at gmail.com  Sat Dec  3 11:52:29 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 3 Dec 2016 20:52:29 +0100
Subject: [gdal-dev] compilation error: jump to label 'free_warper'
In-Reply-To: <10505661.C7soDevQvE@even-i700>
References: <CA+Ei1OfHFPK86mhap=8eC8BnOcx71_sNTXufTYDPrpg6EXqAFg@mail.gmail.com>
 <10505661.C7soDevQvE@even-i700>
Message-ID: <CA+Ei1Ocnnp5-yJVeUoNjHsntRF4MXLO9u4m5LyeT49wi-RgP4Q@mail.gmail.com>

Hi,

2016-12-03 19:55 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> Fixed

thanks! Confirmed. Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From issworld2000 at yahoo.com  Sat Dec  3 21:11:47 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 04 Dec 2016 05:11:47 -0000
Subject: [gdal-dev] Why are fields required in osmconf.ini file?
References: <1439833652.2357388.1479417602055.ref@mail.yahoo.com>
Message-ID: <1439833652.2357388.1479417602055@mail.yahoo.com>

Hello,

When converting an .osm file to .shp files with ogr2ogr.exe, one needs to define a list of required fields (keys) in gdal-data\osmconf.ini file, for each geometry type (points, lines, multipolygons, multilinestrings).Like so (labelled in red color):
[points]#common attributesosm_id=yesosm_version=noosm_timestamp=noosm_uid=noosm_user=noosm_changeset=no #keys to report as OGR fieldsattributes=name,barrier,highway,ref,address,is_in,place,man_made
Why is that so? Why do field names need to be predefined before their extraction from the .osm file?

Why can't only those fields which already exist in the .osm file, be extracted?


Thank you for the reply.

Kind regards,
Djordje Spasic

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161204/e1af7b1d/attachment.html>

From bradh at frogmouth.net  Sat Dec  3 22:02:09 2016
From: bradh at frogmouth.net (Brad Hards)
Date: Sun, 4 Dec 2016 17:02:09 +1100
Subject: [gdal-dev] Why are fields required in osmconf.ini file?
In-Reply-To: <1439833652.2357388.1479417602055@mail.yahoo.com>
References: <1439833652.2357388.1479417602055.ref@mail.yahoo.com>
 <1439833652.2357388.1479417602055@mail.yahoo.com>
Message-ID: <000001d24df3$f3b80200$db280600$@frogmouth.net>

> Why is that so? Why do field names need to be predefined before their
> extraction from the .osm file?
>
> Why can't only those fields which already exist in the .osm file, be 
> extracted?
How could ogr2ogr possibly know what fields are in the file? It would require 
a full parse of the file, and likely give you many more fields than you 
possibly want in any case.

Brad



From jukka.rahkonen at maanmittauslaitos.fi  Sun Dec  4 09:03:40 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sun, 4 Dec 2016 10:03:40 -0700 (MST)
Subject: [gdal-dev] Why are fields required in osmconf.ini file?
In-Reply-To: <000001d24df3$f3b80200$db280600$@frogmouth.net>
References: <1439833652.2357388.1479417602055@mail.yahoo.com>
 <000001d24df3$f3b80200$db280600$@frogmouth.net>
Message-ID: <1480871020644-5298525.post@n6.nabble.com>

Brad Hards wrote
>> Why is that so? Why do field names need to be predefined before their
>> extraction from the .osm file?
>>
>> Why can't only those fields which already exist in the .osm file, be 
>> extracted?
> How could ogr2ogr possibly know what fields are in the file? It would
> require 
> a full parse of the file, and likely give you many more fields than you 
> possibly want in any case.
> 
> Brad

Especially with shapefiles it is also practically impossible with any bigger
datasets.  Dbf file can have only 255 fields, or 254 if fields may contain
NULL values https://msdn.microsoft.com/en-us/library/3kfd3hw9(v=vs.80).aspx.
There are 1012 different tags in the Irish OSM data today
http://taginfo.openstreetmap.ie/tags. It means that there are 758 more tags
than it is possible to save as fields into shapefiles.

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Why-are-fields-required-in-osmconf-ini-file-tp5296342p5298525.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sun Dec  4 10:46:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 04 Dec 2016 19:46:06 +0100
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
	bad capabilities
In-Reply-To: <1480535757783-5298089.post@n6.nabble.com>
References: <1480535757783-5298089.post@n6.nabble.com>
Message-ID: <2522093.t2cPFpYZd0@even-i700>

On mercredi 30 novembre 2016 12:55:57 CET esacree wrote:
> Question:  Is it possible to get a TileLevel option added to the new GDAL
> WMTS driver?
> 
> Reason:  WMTS servers at USGS and ESRI are returning XML Capabilities with
> TileLevel 18 (Google) or TileLevel 19 (default028mm).   The USGS help desk
> said that the tile servers are only serving up to Tile Level 15.  The new
> GDAL WMTS driver always request data from the max TileLevel in the
> Capabilities.  The mismatch between the WMTS XML capabilities and the actual
> maximum TileLevel are causing the GDAL WMTS driver requests to fail with
> Error 404 (not found).
> 
> I have requested that they correct the WMTS XML Capabilities documents.
> 
> Suggestion:  Could a "TileLevel" parameter be added to the WMTS GDAL driver
> to limit the TileLevel to one that is available?   A TileLevel parameter
> would help work around this situation.

Hi,

I've just added  in GDAL trunk TILEMATRIX / ZOOM_LEVEL open options and the 
corresponding <TileMatrix> / <ZoomLevel> elements as child of <GDAL_WMTS>

Examples:

gdalinfo WMTSCapabilities_arcgis_usgs.xml -oo tilematrix=14
gdalinfo WMTSCapabilities_arcgis_usgs.xml,tilematrix=14
gdalinfo WMTSCapabilities_arcgis_usgs.xml -oo zoom_level=14 
gdalinfo WMTSCapabilities_arcgis_usgs.xml,zoom_level=14 


<GDAL_WMTS>
  <GetCapabilitiesUrl>/vsimem/nominal.xml</GetCapabilitiesUrl>
  <Layer>lyr1</Layer>
  <Style>style=auto</Style>
  <TileMatrixSet>tms</TileMatrixSet>
  <TileMatrix>tm_0</TileMatrix>
  <!-- or --> <ZoomLevel>0</ZoomLevel>
  <DataWindow>
    <UpperLeftX>-20037508.3428</UpperLeftX>
    <UpperLeftY>20037508.3428</UpperLeftY>
    <LowerRightX>20037508.34278254</LowerRightX>
    <LowerRightY>-20037508.34278254</LowerRightY>
  </DataWindow>
  <BandsCount>4</BandsCount>
  <Cache />
  <UnsafeSSL>true</UnsafeSSL>
  <ZeroBlockHttpCodes>204,404</ZeroBlockHttpCodes>
  <ZeroBlockOnServerException>true</ZeroBlockOnServerException>
</GDAL_WMTS>


The difference between TILEMATRIX and ZOOM_LEVEL is that the first is the value of the 
<ows:Identifier> of the <TileMatrix> in the WMTS GetCapabilities response, while the later is 
the index (starting with 0) of the <TileMatrix> to consider. Sometimes they are the same 
value (but sometimes the TileMatrix identifier is like EPSG:XXXX:zoom_level)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161204/a5035b87/attachment.html>

From esacree at knology.net  Sun Dec  4 11:29:03 2016
From: esacree at knology.net (esacree)
Date: Sun, 4 Dec 2016 12:29:03 -0700 (MST)
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
 bad capabilities
In-Reply-To: <2522093.t2cPFpYZd0@even-i700>
References: <1480535757783-5298089.post@n6.nabble.com>
 <2522093.t2cPFpYZd0@even-i700>
Message-ID: <1480879743908-5298533.post@n6.nabble.com>

Even,

Thank you!  

Elaine



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/WMTS-Need-TileLevel-option-Servers-responding-with-bad-capabilities-tp5298089p5298533.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Sun Dec  4 16:53:22 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Mon, 5 Dec 2016 00:53:22 +0000 (UTC)
Subject: [gdal-dev] Why are fields required in osmconf.ini file?
In-Reply-To: <1480871020644-5298525.post@n6.nabble.com>
References: <1439833652.2357388.1479417602055@mail.yahoo.com>
 <000001d24df3$f3b80200$db280600$@frogmouth.net>
 <1480871020644-5298525.post@n6.nabble.com>
Message-ID: <1814906921.6355632.1480899202663@mail.yahoo.com>

Thank you for the information once again Jukka!

    On Sunday, December 4, 2016 6:03 PM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
 

 Brad Hards wrote
>> Why is that so? Why do field names need to be predefined before their
>> extraction from the .osm file?
>>
>> Why can't only those fields which already exist in the .osm file, be 
>> extracted?
> How could ogr2ogr possibly know what fields are in the file? It would
> require 
> a full parse of the file, and likely give you many more fields than you 
> possibly want in any case.
> 
> Brad

Especially with shapefiles it is also practically impossible with any bigger
datasets.  Dbf file can have only 255 fields, or 254 if fields may contain
NULL values https://msdn.microsoft.com/en-us/library/3kfd3hw9(v=vs.80).aspx.
There are 1012 different tags in the Irish OSM data today
http://taginfo.openstreetmap.ie/tags. It means that there are 758 more tags
than it is possible to save as fields into shapefiles.

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Why-are-fields-required-in-osmconf-ini-file-tp5296342p5298525.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161205/6f7d7e6a/attachment.html>

From issworld2000 at yahoo.com  Sun Dec  4 17:01:43 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Mon, 5 Dec 2016 01:01:43 +0000 (UTC)
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
References: <1808570345.6361644.1480899703991.ref@mail.yahoo.com>
Message-ID: <1808570345.6361644.1480899703991@mail.yahoo.com>

I am using GDAL's ogr2ogr.exe to convert an .osm file to .shp files.

I noticed one thing I do not understand: OSM driver sometimes saves closed ways into both the multipolygons.shp and lines.shp files.
Why is that so?

Why are closed ways (like building footprints) sent to the lines.shp file? Shouldn't all of closed ways representing building footprints be saved to the multipolygons.shp file? Why are they sometimes saved into the lines.shp file as well?

I would be grateful for any kind of reply.

Thank you in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161205/a0ce2267/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Dec  5 01:36:18 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 5 Dec 2016 02:36:18 -0700 (MST)
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
In-Reply-To: <1808570345.6361644.1480899703991@mail.yahoo.com>
References: <1808570345.6361644.1480899703991@mail.yahoo.com>
Message-ID: <1480930578491-5298582.post@n6.nabble.com>

In OSM it is a bit fuzzy what closed linestrings mean. Partly it is based on
known and agreed semantics which may be documented in
wiki.openstreetmap.org/wiki/Map_Features. So a closed linestring is a
polygon if is has any building tag, but a closed linestring
"junction=roundabout" is a closed linestring. One can try to make a list
about which closed linestrings are always polygons by sorting the wiki page,
or then you can rely on the previous work. The default rendering style file
has such a list
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style and you
can find it also from the osmconf.ini file



However, users can use the override tag "area=yes/no" for changing the
interpretation. A way with tags highway=service, area=yes means polygon.
Also, as you can read from http://wiki.openstreetmap.org/wiki/Key:area, a
way can have one tag that makes it into polygon and another tag that means a
closed linestring at the same time.

For analyzing why you have now some way in both multipolygons and lines
tables you must take the osm_id from the lines or osm_way_id from the
multipolygons and check the data from the native OSM data. I can't show such
example right ahead but you will find examples from your own data. Take the
id and make a query like this



Check all the tags of the feature. If you still do not find a reason why it
goes into both polygon and linestring tables you can mail us the link.
However, the OSM data model differs so much from the traditional GIS model
with simple features and fixed schema that conversion from OSM to GIS tends
to be lossy.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-does-GDAL-OSM-driver-deal-with-closed-ways-tp5298544p5298582.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Dec  5 02:02:56 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 5 Dec 2016 03:02:56 -0700 (MST)
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
In-Reply-To: <1480930578491-5298582.post@n6.nabble.com>
References: <1808570345.6361644.1480899703991@mail.yahoo.com>
 <1480930578491-5298582.post@n6.nabble.com>
Message-ID: <1480932176112-5298586.post@n6.nabble.com>

Here are some useful links for those who are really interested in polygons in
OSM data

http://www.openstreetmap.org/user/BharataHS/diary/39957
https://www.openstreetmap.org/user/PlaneMad/diary/38908
https://github.com/osmlab/fixing-polygons-in-osm/blob/master/doc/faq.md
https://github.com/osmlab/fixing-polygons-in-osm/blob/master/doc/rendering.md
https://github.com/osmlab/fixing-polygons-in-osm/blob/master/doc/background.md

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-does-GDAL-OSM-driver-deal-with-closed-ways-tp5298544p5298586.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From issworld2000 at yahoo.com  Mon Dec  5 05:00:50 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Mon, 5 Dec 2016 13:00:50 +0000 (UTC)
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
In-Reply-To: <1480930578491-5298582.post@n6.nabble.com>
References: <1808570345.6361644.1480899703991@mail.yahoo.com>
 <1480930578491-5298582.post@n6.nabble.com>
Message-ID: <1823785455.6639427.1480942850523@mail.yahoo.com>

Thank you Jukka!

I wasn't precise enough: particular closed way is not sent to both multipolygons.shp and lines.shp. It is sent to the lines.shp, and I am wondering why hasn't it been sent to the multipolygons.shp.

But your detailed explanation helped me realize that this building footprint does not have the "building" key, only "building:levels". And as "building:levels" is not included in osmconf.ini file's line:
closed_ways_are_polygons=

it seems that this is why OSM driver sent it to the lines.shp.


I will definitively read through the links you gave me Jukka. Thank you.

Until then, do you mind if I ask just for a tiny clarification?


> The default rendering style file has such a list
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style 

Is this the part of that file that I need to take a look at:
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style#L83-L152


> and you can find it also from the osmconf.ini file

But osmconf.ini file only defines the polygons keys, not linear ones?
This is the line in osmconf.ini which defines polygon keys:

closed_ways_are_polygons=
?
 

    On Monday, December 5, 2016 10:36 AM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
 

 In OSM it is a bit fuzzy what closed linestrings mean. Partly it is based on
known and agreed semantics which may be documented in
wiki.openstreetmap.org/wiki/Map_Features. So a closed linestring is a
polygon if is has any building tag, but a closed linestring
"junction=roundabout" is a closed linestring. One can try to make a list
about which closed linestrings are always polygons by sorting the wiki page,
or then you can rely on the previous work. The default rendering style file
has such a list
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style and you
can find it also from the osmconf.ini file



However, users can use the override tag "area=yes/no" for changing the
interpretation. A way with tags highway=service, area=yes means polygon.
Also, as you can read from http://wiki.openstreetmap.org/wiki/Key:area, a
way can have one tag that makes it into polygon and another tag that means a
closed linestring at the same time.

For analyzing why you have now some way in both multipolygons and lines
tables you must take the osm_id from the lines or osm_way_id from the
multipolygons and check the data from the native OSM data. I can't show such
example right ahead but you will find examples from your own data. Take the
id and make a query like this



Check all the tags of the feature. If you still do not find a reason why it
goes into both polygon and linestring tables you can mail us the link.
However, the OSM data model differs so much from the traditional GIS model
with simple features and fixed schema that conversion from OSM to GIS tends
to be lossy.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-How-does-GDAL-OSM-driver-deal-with-closed-ways-tp5298544p5298582.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161205/406fb088/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Dec  5 05:08:42 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 5 Dec 2016 13:08:42 +0000
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
Message-ID: <f0dc9534468a451087d198403baf7576@C119S212VM022.msvyvi.vaha.local>



Djordje Spasic wrote:



I will definitively read through the links you gave me Jukka. Thank you.

Until then, do you mind if I ask just for a tiny clarification?


> The default rendering style file has such a list
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style
Is this the part of that file that I need to take a look at:
https://github.com/openstreetmap/osm2pgsql/blob/master/default.style#L83-L152

Yes.

> and you can find it also from the osmconf.ini file
But osmconf.ini file only defines the polygons keys, not linear ones?
This is the line in osmconf.ini which defines polygon keys:
closed_ways_are_polygons=


Those closed ways which are not defined to be polygons are considered to be linear rings and they go to the lines layer.

-Jukka-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161205/dbb15801/attachment.html>

From issworld2000 at yahoo.com  Mon Dec  5 07:55:32 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Mon, 5 Dec 2016 15:55:32 +0000 (UTC)
Subject: [gdal-dev] How does GDAL OSM driver deal with closed ways?
In-Reply-To: <f0dc9534468a451087d198403baf7576@C119S212VM022.msvyvi.vaha.local>
References: <f0dc9534468a451087d198403baf7576@C119S212VM022.msvyvi.vaha.local>
Message-ID: <181423341.6775398.1480953332361@mail.yahoo.com>

Perfect!!

Thank you Jukka. You helped me a lot again.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161205/29c82788/attachment.html>

From even.rouault at spatialys.com  Tue Dec  6 08:21:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 06 Dec 2016 17:21:46 +0100
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
	Polyhedral surface and TIN
Message-ID: <2629554.pVscNPs2f5@even-i700>

Hi,

This is a call to discuss the proposed RFC 64: Triangle, Polyhedral surface and TIN

    https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin

~~~~~

Summary:

As of now, the OGRGeometry class (the base class from which all the subtypes are derived) is 
limited to OGRCompoundCurve, OGRCircularString, OGRLinearRing, OGRMultiLineString, 
OGRMultiPoint, OGRMultiPolygon, OGRMultiCurve, OGRSimpleCurve, OGRCurvePolygon and 
OGRPolygon.

This RFC addresses the addition of the following new geometries in OGRGeometry:
* Triangle - A subset of polygons, the fundamental difference is that it is made of 3 nodes 
only (actually 4, with the last one being the repetition of the first one) and ONLY ONE 
exterior boundary and NO interior polygons.
* PolyhedralSurface - A 3D figure made exclusively of Polygons.
* TriangulatedSurface - A subset of PolyhedralSurface; a 3D figure which consists exclusively 
of Triangles. 

~~~~~

I've rebased and extended the work done by Avyav during last GSoc on top of current trunk, 
where it passes our continuous integration tests. I think we should consider  merging it soon 
as it can easily rot if kept longer in a branch (the refresh from my previous branch dating to 
end of August was rather painful)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161206/5893762b/attachment.html>

From even.rouault at spatialys.com  Tue Dec  6 09:33:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 06 Dec 2016 18:33:33 +0100
Subject: [gdal-dev] shapelib 1.4.0RC1 available
Message-ID: <2496937.8dvnXhqR83@even-i700>

Hi,

(CC'ing gdal-dev as well, since shapelib at lists.maptools.org has likely lower audience)

I've prepared a release candidate for shapelib 1.4.0.

The changes are:
<b>Release 1.4.0</b>:
<ul>
<li> Old Makefile build replaced by autoconf/automake (by Sandro Mani)
<li> CMake build system added (by Alan W. Irwin)
<li> Added read support for ESRI .sbn spatial index
<li> Resynchronization with GDAL's Shapefile driver. Mostly cleanups.
     SHPObject and DBFInfo structures extended with new members
<li> Add DBFSetLastModifiedDate() to modify the update date in the .dbf
<li> Add SHPSetFastModeReadObject() to read faster (but shapes got that way
     share state in the handle, so only one shape at a time can be used)
<li> Add SHPRestoreSHX() to recreate a missing .shx from the .shp and
     SHPOpenLLEx().
<li> Write DBF end-of-file character 0x1A by default.
     This behaviour can be controlled with the DBFSetWriteEndOfFileChar()
     function.
</ul>

The tarballs are available at:
http://download.osgeo.org/shapelib/shapelib-1.4.0RC1.tar.gz
http://download.osgeo.org/shapelib/shapelib-1.4.0RC1.zip

Please test and report if there are serious issues.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161206/558dab82/attachment.html>

From mdsumner at gmail.com  Tue Dec  6 12:31:57 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 06 Dec 2016 20:31:57 +0000
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <2629554.pVscNPs2f5@even-i700>
References: <2629554.pVscNPs2f5@even-i700>
Message-ID: <CAAcGz9-9C3KQBVkL6B=5Ugd_9kUcLqbNtO_kNQBFCCv9UJohDw@mail.gmail.com>

Thanks Even,

Does a TriangulatedSurface consist of separate Triangles, all with each
three vertices stored explicitly? I.e. is there no shared vertex pool that
primitives use via index?

That seems to be what simple features dictates, but it's unclear to me how
applications should work with it. Is vertex de-duplication to be be done at
each conversion, or is there a way to carry those indexes through?

Cheers, Mike

On Wed, Dec 7, 2016, 03:22 Even Rouault <even.rouault at spatialys.com> wrote:

> Hi,
>
>
>
> This is a call to discuss the proposed RFC 64: Triangle, Polyhedral
> surface and TIN
>
>
>
> https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
>
>
>
> ~~~~~
>
>
>
> Summary:
>
>
>
> As of now, the OGRGeometry class (the base class from which all the
> subtypes are derived) is limited to OGRCompoundCurve, OGRCircularString,
> OGRLinearRing, OGRMultiLineString, OGRMultiPoint, OGRMultiPolygon,
> OGRMultiCurve, OGRSimpleCurve, OGRCurvePolygon and OGRPolygon.
>
>
>
> This RFC addresses the addition of the following new geometries in
> OGRGeometry:
>
> * Triangle - A subset of polygons, the fundamental difference is that it
> is made of 3 nodes only (actually 4, with the last one being the repetition
> of the first one) and ONLY ONE exterior boundary and NO interior polygons.
>
> * PolyhedralSurface - A 3D figure made exclusively of Polygons.
>
> * TriangulatedSurface - A subset of PolyhedralSurface; a 3D figure which
> consists exclusively of Triangles.
>
>
>
> ~~~~~
>
>
>
> I've rebased and extended the work done by Avyav during last GSoc on top
> of current trunk, where it passes our continuous integration tests. I think
> we should consider merging it soon as it can easily rot if kept longer in a
> branch (the refresh from my previous branch dating to end of August was
> rather painful)
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161206/ce990bf1/attachment.html>

From sebastic at xs4all.nl  Tue Dec  6 12:38:14 2016
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Tue, 6 Dec 2016 21:38:14 +0100
Subject: [gdal-dev] shapelib 1.4.0RC1 available
In-Reply-To: <2496937.8dvnXhqR83@even-i700>
References: <2496937.8dvnXhqR83@even-i700>
Message-ID: <62489516-6bcc-3170-4cda-764654f8b225@xs4all.nl>

On 12/06/2016 06:33 PM, Even Rouault wrote:
> <li> Old Makefile build replaced by autoconf/automake (by Sandro Mani)

This is a very welcome change, allowing us to drop a bunch of patches
from the Debian package.

I've forwarded the remaining patches to Bugzilla.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Tue Dec  6 12:41:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 06 Dec 2016 21:41:28 +0100
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <CAAcGz9-9C3KQBVkL6B=5Ugd_9kUcLqbNtO_kNQBFCCv9UJohDw@mail.gmail.com>
References: <2629554.pVscNPs2f5@even-i700>
 <CAAcGz9-9C3KQBVkL6B=5Ugd_9kUcLqbNtO_kNQBFCCv9UJohDw@mail.gmail.com>
Message-ID: <1528885.FPiYfENHm5@even-i700>

On mardi 6 décembre 2016 20:31:57 CET Michael Sumner wrote:
> Thanks Even,
> 
> Does a TriangulatedSurface consist of separate Triangles, all with each
> three vertices stored explicitly? I.e. is there no shared vertex pool that
> primitives use via index?

Yes, the TriangulatedSurface is a collection of separate triangles. No smart optimization here. 
We stick to the simple features model.

> 
> That seems to be what simple features dictates, but it's unclear to me how
> applications should work with it. Is vertex de-duplication to be be done at
> each conversion, or is there a way to carry those indexes through?

Apart from shapefile/filegdb triangle strip/fan that could be considered as a kind of vertex 
indexing, the WKT/WKB representation (and thus the exchanges with PostGIS) don't have 
that.

Actually you could retrieve an indexed view of the TIN by using the 
GDALTriangulationCreateDelaunay() API
( http://www.gdal.org/gdal__alg_8h.html#a498205ae5f4f0ec9f43e5c65bb392060 ), although 
it is a bit overkill to recompute a triangulation from a set of triangles... (and the triangulation 
it will return will generally not be the original one)

Even

> 
> Cheers, Mike
> 
> On Wed, Dec 7, 2016, 03:22 Even Rouault <even.rouault at spatialys.com> wrote:
> > Hi,
> > 
> > 
> > 
> > This is a call to discuss the proposed RFC 64: Triangle, Polyhedral
> > surface and TIN
> > 
> > 
> > 
> > https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> > 
> > 
> > 
> > ~~~~~
> > 
> > 
> > 
> > Summary:
> > 
> > 
> > 
> > As of now, the OGRGeometry class (the base class from which all the
> > subtypes are derived) is limited to OGRCompoundCurve, OGRCircularString,
> > OGRLinearRing, OGRMultiLineString, OGRMultiPoint, OGRMultiPolygon,
> > OGRMultiCurve, OGRSimpleCurve, OGRCurvePolygon and OGRPolygon.
> > 
> > 
> > 
> > This RFC addresses the addition of the following new geometries in
> > OGRGeometry:
> > 
> > * Triangle - A subset of polygons, the fundamental difference is that it
> > is made of 3 nodes only (actually 4, with the last one being the
> > repetition
> > of the first one) and ONLY ONE exterior boundary and NO interior polygons.
> > 
> > * PolyhedralSurface - A 3D figure made exclusively of Polygons.
> > 
> > * TriangulatedSurface - A subset of PolyhedralSurface; a 3D figure which
> > consists exclusively of Triangles.
> > 
> > 
> > 
> > ~~~~~
> > 
> > 
> > 
> > I've rebased and extended the work done by Avyav during last GSoc on top
> > of current trunk, where it passes our continuous integration tests. I
> > think
> > we should consider merging it soon as it can easily rot if kept longer in
> > a
> > branch (the refresh from my previous branch dating to end of August was
> > rather painful)
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161206/3c1a355e/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Dec  7 01:01:54 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 7 Dec 2016 02:01:54 -0700 (MST)
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <2629554.pVscNPs2f5@even-i700>
References: <2629554.pVscNPs2f5@even-i700>
Message-ID: <1481101314734-5298990.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> This is a call to discuss the proposed RFC 64: Triangle, Polyhedral
> surface and TIN
> 
>     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> 
> ~~~~~

I am wondering this part:
 
"GEOS methods are still used in some cases, but with the following
limitations - a Triangle is converted to a Polygon with one exterior ring;
Polyhedral Surfaces and Triangulated Surfaces are converted to
MultiPolygons?. (each Triangle in a Triangulated Surface is converted to a
Polygon as described previously)"

Does it mean presenting a TIN with two triangles as something like



As far as I know such multipolygon is not valid accorfing to the Simple
feature specification where "boundaries and may touch at only a finite
number of Points". Valid presentation would probably be to wrap polygons
into GeometryCollection. Is GEOS used in a relaxed way so that shared parts
of boundaries in MultiPolygons do not throw an error?

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-64-Triangle-Polyhedral-surface-and-TIN-tp5298840p5298990.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mdsumner at gmail.com  Wed Dec  7 01:20:39 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 07 Dec 2016 09:20:39 +0000
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <1528885.FPiYfENHm5@even-i700>
References: <2629554.pVscNPs2f5@even-i700>
 <CAAcGz9-9C3KQBVkL6B=5Ugd_9kUcLqbNtO_kNQBFCCv9UJohDw@mail.gmail.com>
 <1528885.FPiYfENHm5@even-i700>
Message-ID: <CAAcGz98pECrDRZAqD+9xV_x8ptBDdMbmaqGju6cs+dgSei7dUw@mail.gmail.com>

On Wed, 7 Dec 2016 at 07:41 Even Rouault <even.rouault at spatialys.com> wrote:

> On mardi 6 décembre 2016 20:31:57 CET Michael Sumner wrote:
>
> > Thanks Even,
>
> >
>
> > Does a TriangulatedSurface consist of separate Triangles, all with each
>
> > three vertices stored explicitly? I.e. is there no shared vertex pool
> that
>
> > primitives use via index?
>
>
>
> Yes, the TriangulatedSurface is a collection of separate triangles. No
> smart optimization here. We stick to the simple features model.
>
>
>
> >
>
> > That seems to be what simple features dictates, but it's unclear to me
> how
>
> > applications should work with it. Is vertex de-duplication to be be done
> at
>
> > each conversion, or is there a way to carry those indexes through?
>
>
>
> Apart from shapefile/filegdb triangle strip/fan that could be considered
> as a kind of vertex indexing, the WKT/WKB representation (and thus the
> exchanges with PostGIS) don't have that.
>
>
>
> Actually you could retrieve an indexed view of the TIN by using the
> GDALTriangulationCreateDelaunay() API
>
> ( http://www.gdal.org/gdal__alg_8h.html#a498205ae5f4f0ec9f43e5c65bb392060
> ), although it is a bit overkill to recompute a triangulation from a set of
> triangles... (and the triangulation it will return will generally not be
> the original one)
>
>
>

Thanks Even, I was thinking of preserving an indexed mesh, with (for
example) a constrained triangulation. Simple features will ingest this, but
once it comes back out vertex de-duplication would be enough to restore the
indexing. You'd need some record of vertex identity after they are expanded
out on each triangle, but there's no internal way to ID them in simple fs
(except maybe by using M).

I feel that simple features is not particularly useful in this regard,
though fine as a one-way output from triangulation sources. I think
TopoJSON is similar, in that all vertices are explict, there's no index
-but because they are all integer-scaled in the context of the graph,
there's no numerical difficulties with uniqueness.  Interested to hear
other views, though appreciate that this is pretty off-topic.

Cheers, Mike.




> Even
>
>
>
> >
>
> > Cheers, Mike
>
> >
>
> > On Wed, Dec 7, 2016, 03:22 Even Rouault <even.rouault at spatialys.com>
> wrote:
>
> > > Hi,
>
> > >
>
> > >
>
> > >
>
> > > This is a call to discuss the proposed RFC 64: Triangle, Polyhedral
>
> > > surface and TIN
>
> > >
>
> > >
>
> > >
>
> > > https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
>
> > >
>
> > >
>
> > >
>
> > > ~~~~~
>
> > >
>
> > >
>
> > >
>
> > > Summary:
>
> > >
>
> > >
>
> > >
>
> > > As of now, the OGRGeometry class (the base class from which all the
>
> > > subtypes are derived) is limited to OGRCompoundCurve,
> OGRCircularString,
>
> > > OGRLinearRing, OGRMultiLineString, OGRMultiPoint, OGRMultiPolygon,
>
> > > OGRMultiCurve, OGRSimpleCurve, OGRCurvePolygon and OGRPolygon.
>
> > >
>
> > >
>
> > >
>
> > > This RFC addresses the addition of the following new geometries in
>
> > > OGRGeometry:
>
> > >
>
> > > * Triangle - A subset of polygons, the fundamental difference is that
> it
>
> > > is made of 3 nodes only (actually 4, with the last one being the
>
> > > repetition
>
> > > of the first one) and ONLY ONE exterior boundary and NO interior
> polygons.
>
> > >
>
> > > * PolyhedralSurface - A 3D figure made exclusively of Polygons.
>
> > >
>
> > > * TriangulatedSurface - A subset of PolyhedralSurface; a 3D figure
> which
>
> > > consists exclusively of Triangles.
>
> > >
>
> > >
>
> > >
>
> > > ~~~~~
>
> > >
>
> > >
>
> > >
>
> > > I've rebased and extended the work done by Avyav during last GSoc on
> top
>
> > > of current trunk, where it passes our continuous integration tests. I
>
> > > think
>
> > > we should consider merging it soon as it can easily rot if kept longer
> in
>
> > > a
>
> > > branch (the refresh from my previous branch dating to end of August was
>
> > > rather painful)
>
> > >
>
> > >
>
> > >
>
> > > Even
>
> > >
>
> > >
>
> > >
>
> > > --
>
> > >
>
> > > Spatialys - Geospatial professional services
>
> > >
>
> > > http://www.spatialys.com
>
> > > _______________________________________________
>
> > > gdal-dev mailing list
>
> > > gdal-dev at lists.osgeo.org
>
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/f9108e1f/attachment.html>

From even.rouault at spatialys.com  Wed Dec  7 02:09:03 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 11:09:03 +0100
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <CAAcGz98pECrDRZAqD+9xV_x8ptBDdMbmaqGju6cs+dgSei7dUw@mail.gmail.com>
References: <2629554.pVscNPs2f5@even-i700> <1528885.FPiYfENHm5@even-i700>
 <CAAcGz98pECrDRZAqD+9xV_x8ptBDdMbmaqGju6cs+dgSei7dUw@mail.gmail.com>
Message-ID: <1559377.Jx12peopun@even-i700>

> Thanks Even, I was thinking of preserving an indexed mesh, with (for
> example) a constrained triangulation. Simple features will ingest this, but
> once it comes back out vertex de-duplication would be enough to restore the
> indexing. You'd need some record of vertex identity after they are expanded
> out on each triangle, but there's no internal way to ID them in simple fs
> (except maybe by using M).

Yes that's indeed a limitation. A function to do the de-duplication and get an indexed 
triangulation could be added later. We don't strictly need to store the ID (unless preserving 
the actual value of the ID is needed ? if so, yes using M could be a workaround). The 
deduplication can be done later by building a map from point coordinates to an integer index 
while iterating over the geometries. The performance should be O(N*log(N)) where N is the 
total number of vertices.
This RFC paves the ground for later functionalities, and in its current state, should already be 
useful for exchanges between formats like PostGIS / GML / Shapefile.

> 
> I feel that simple features is not particularly useful in this regard,
> though fine as a one-way output from triangulation sources. I think
> TopoJSON is similar, in that all vertices are explict, there's no index
> -but because they are all integer-scaled in the context of the graph,
> there's no numerical difficulties with uniqueness.

Actually TopoJSON is a bit of mixed topological format. Lines and polygons can use shared 
arcs, but the vertices themselves are repeated among arcs that share the same vertices, so 
you could have inconsistencies and checking for them is not immediate. See
https://github.com/topojson/topojson-specification

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/0aaf63ff/attachment-0001.html>

From even.rouault at spatialys.com  Wed Dec  7 02:56:25 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 11:56:25 +0100
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <1481101314734-5298990.post@n6.nabble.com>
References: <2629554.pVscNPs2f5@even-i700>
 <1481101314734-5298990.post@n6.nabble.com>
Message-ID: <8141552.M174bPgYIH@even-i700>

On mercredi 7 décembre 2016 02:01:54 CET jratike80 wrote:
> Even Rouault-2 wrote
> 
> > Hi,
> > 
> > This is a call to discuss the proposed RFC 64: Triangle, Polyhedral
> > surface and TIN
> > 
> >     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> > 
> > ~~~~~
> 
> I am wondering this part:
> 
> "GEOS methods are still used in some cases, but with the following
> limitations - a Triangle is converted to a Polygon with one exterior ring;
> Polyhedral Surfaces and Triangulated Surfaces are converted to
> MultiPolygons?. (each Triangle in a Triangulated Surface is converted to a
> Polygon as described previously)"
> 
> Does it mean presenting a TIN with two triangles as something like
> 

Something missing here, but I guess you meant as a multipolygon made of 2 polygons ?

> 
> 
> As far as I know such multipolygon is not valid accorfing to the Simple
> feature specification where "boundaries and may touch at only a finite
> number of Points". Valid presentation would probably be to wrap polygons
> into GeometryCollection. Is GEOS used in a relaxed way so that shared parts
> of boundaries in MultiPolygons do not throw an error?

That's a very good remark. Indeed for GEOS purposes, a MultiPolygon with Polygons that 
have shared boundaries is invalid. I've changed that to a GeometryCollection. But anyway, TIN 
& PoyhedralSurface in GEOS world are degraded cases where behaviour will always be 
suboptimal.

Thanks for the feedback.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/4b78a063/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Dec  7 03:03:39 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 7 Dec 2016 11:03:39 +0000
Subject: [gdal-dev] Call for discussion on RFC 64: Triangle,
 Polyhedral surface and TIN
Message-ID: <fb2e86fe49c34eb9a178db4c74ee618d@C119S212VM022.msvyvi.vaha.local>

Hi,

Perhaps some problem with markup, the WKT dows show in Nabble http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-64-Triangle-Polyhedral-surface-and-TIN-tc5298840.html

MULTIPOLYGON ((( 553 352, 327 363, 442 486, 553 352 )), (( 327 363, 553 352, 422 186, 327 363 )))

-Jukka-



Even Rouault wrote:
Re: [gdal-dev] Call for discussion on RFC 64: Triangle, Polyhedral surface and TIN


On mercredi 7 décembre 2016 02:01:54 CET jratike80 wrote:

> Even Rouault-2 wrote

>

> > Hi,

> >

> > This is a call to discuss the proposed RFC 64: Triangle, Polyhedral

> > surface and TIN

> >

> > https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin

> >

> > ~~~~~

>

> I am wondering this part:

>

> "GEOS methods are still used in some cases, but with the following

> limitations - a Triangle is converted to a Polygon with one exterior ring;

> Polyhedral Surfaces and Triangulated Surfaces are converted to

> MultiPolygons?. (each Triangle in a Triangulated Surface is converted to a

> Polygon as described previously)"

>

> Does it mean presenting a TIN with two triangles as something like

>



Something missing here, but I guess you meant as a multipolygon made of 2 polygons ?



>

>

> As far as I know such multipolygon is not valid accorfing to the Simple

> feature specification where "boundaries and may touch at only a finite

> number of Points". Valid presentation would probably be to wrap polygons

> into GeometryCollection. Is GEOS used in a relaxed way so that shared parts

> of boundaries in MultiPolygons do not throw an error?



That's a very good remark. Indeed for GEOS purposes, a MultiPolygon with Polygons that have shared boundaries is invalid. I've changed that to a GeometryCollection. But anyway, TIN & PoyhedralSurface in GEOS world are degraded cases where behaviour will always be suboptimal.



Thanks for the feedback.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/d526a263/attachment.html>

From even.rouault at spatialys.com  Wed Dec  7 04:57:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 13:57:51 +0100
Subject: [gdal-dev] GDAL and ElasticSearch 5.0
In-Reply-To: <7709994.4rmnRryc6z@even-i700>
References: <a396c51dcd49486b8bc47a45b4f7cd0c@C119S212VM022.msvyvi.vaha.local>
 <a4ddd8d084b641049a41549f68204966@PELEPCDEXC028.birch.int.bell.ca>
 <7709994.4rmnRryc6z@even-i700>
Message-ID: <12995835.gHjASgyiWj@even-i700>

On lundi 21 novembre 2016 17:26:45 CET Even Rouault wrote:
> Hi,
> 
> I've just tested and confirm that ES 5.0 isn't compatible of current driver.
> I've created https://trac.osgeo.org/gdal/ticket/6724 to track this.

I've just committed into trunk support for ES 5.0

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/d16aba42/attachment-0001.html>

From vincent.bernat at magellium.fr  Wed Dec  7 05:13:09 2016
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Wed, 7 Dec 2016 13:13:09 +0000
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
Message-ID: <1481116389794.25615@magellium.fr>

Hi all,

I work with gdal-2.1.0 on CentOS

I would like to compil with ECW 5.2.1 so i add in the configure :

--with-ecw=/usr/local/hexagon


but i get the following message when compiling :


libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)

libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)

libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)



Did i miss something?


Thanks a lot.


Regards,

Vincent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/f27db783/attachment.html>

From jmckenna at gatewaygeomatics.com  Wed Dec  7 05:42:42 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 7 Dec 2016 09:42:42 -0400
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <1481116389794.25615@magellium.fr>
References: <1481116389794.25615@magellium.fr>
Message-ID: <7b1b3ae9-bb11-ebf6-edcb-c151890bf094@gatewaygeomatics.com>

Hi Vincent,

You might also review the BuildHints wiki page, that we all try to keep 
uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW  And if you 
notice something missing (like a tip for CentOS users) please definitely 
edit that wiki page and add it.  Hopefully this helps a little. Thanks!

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-12-07 9:13 AM, Vincent BERNAT wrote:
> Hi all,
>
> I work with gdal-2.1.0 on CentOS
>
> I would like to compil with ECW 5.2.1 so i add in the configure :
>
> --with-ecw=/usr/local/hexagon
>
>
> but i get the following message when compiling :
>
>
> libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)
>
> libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)
>
> libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)
>
>
>
> Did i miss something?
>
>
> Thanks a lot.
>
>
> Regards,
>
> Vincent
>
>



From vincent.bernat at magellium.fr  Wed Dec  7 06:27:08 2016
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Wed, 7 Dec 2016 14:27:08 +0000
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <7b1b3ae9-bb11-ebf6-edcb-c151890bf094@gatewaygeomatics.com>
References: <1481116389794.25615@magellium.fr>,
 <7b1b3ae9-bb11-ebf6-edcb-c151890bf094@gatewaygeomatics.com>
Message-ID: <1481120828207.82771@magellium.fr>

Thanks for reply Jeff :)

There are lots of things about ecw 2.3.3 which is compiling for me.

But not the 5.2.1 with gcc 5.1.0
it's about link... 
In the 2.3.3 i had :
- libNCSEcwC.so    
- libNCSEcwC.so    
- libNCSEcwC.so    

________________________________________
De : gdal-dev <gdal-dev-bounces at lists.osgeo.org> de la part de Jeff McKenna <jmckenna at gatewaygeomatics.com>
Envoyé : mercredi 7 décembre 2016 14:42
À : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1

Hi Vincent,

You might also review the BuildHints wiki page, that we all try to keep
uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW  And if you
notice something missing (like a tip for CentOS users) please definitely
edit that wiki page and add it.  Hopefully this helps a little. Thanks!

-jeff


--
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-12-07 9:13 AM, Vincent BERNAT wrote:
> Hi all,
>
> I work with gdal-2.1.0 on CentOS
>
> I would like to compil with ECW 5.2.1 so i add in the configure :
>
> --with-ecw=/usr/local/hexagon
>
>
> but i get the following message when compiling :
>
>
> libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)
>
> libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)
>
> libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)
>
>
>
> Did i miss something?
>
>
> Thanks a lot.
>
>
> Regards,
>
> Vincent
>
>


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From vincent.bernat at magellium.fr  Wed Dec  7 06:31:33 2016
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Wed, 7 Dec 2016 14:31:33 +0000
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <1481120828207.82771@magellium.fr>
References: <1481116389794.25615@magellium.fr>,
 <7b1b3ae9-bb11-ebf6-edcb-c151890bf094@gatewaygeomatics.com>,
 <1481120828207.82771@magellium.fr>
Message-ID: <1481121093363.48447@magellium.fr>

Thanks for reply Jeff :)

There are lots of things about ecw 2.3.3 which is compiling for me.
But not the 5.2.1 with gcc 5.1.0

my problem is about link...

In the 2.3.3 i had :
- libNCSEcwC.so
- libNCSEcw.so
- libNCSCnet.so
- libNCSCUtil.so

but in ECW 5.2.1, i only got :
- libNCSEcw.so
- libNCSEcwJNI.so

Is it enough to build it with gdal?

Thanks

Vincent
________________________________________
De : gdal-dev <gdal-dev-bounces at lists.osgeo.org> de la part de Jeff McKenna <jmckenna at gatewaygeomatics.com>
Envoyé : mercredi 7 décembre 2016 14:42
À : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1

Hi Vincent,

You might also review the BuildHints wiki page, that we all try to keep
uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW  And if you
notice something missing (like a tip for CentOS users) please definitely
edit that wiki page and add it.  Hopefully this helps a little. Thanks!

-jeff


--
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-12-07 9:13 AM, Vincent BERNAT wrote:
> Hi all,
>
> I work with gdal-2.1.0 on CentOS
>
> I would like to compil with ECW 5.2.1 so i add in the configure :
>
> --with-ecw=/usr/local/hexagon
>
>
> but i get the following message when compiling :
>
>
> libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)
>
> libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)
>
> libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)
>
>
>
> Did i miss something?
>
>
> Thanks a lot.
>
>
> Regards,
>
> Vincent
>
>


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Wed Dec  7 07:19:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 16:19:19 +0100
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <1481121093363.48447@magellium.fr>
References: <1481116389794.25615@magellium.fr>
 <1481120828207.82771@magellium.fr> <1481121093363.48447@magellium.fr>
Message-ID: <3456098.2pOcMBAk0O@even-i700>

On mercredi 7 décembre 2016 14:31:33 CET Vincent BERNAT wrote:
> Thanks for reply Jeff :)
> 
> There are lots of things about ecw 2.3.3 which is compiling for me.
> But not the 5.2.1 with gcc 5.1.0
> 
> my problem is about link...
> 
> In the 2.3.3 i had :
> - libNCSEcwC.so
> - libNCSEcw.so
> - libNCSCnet.so
> - libNCSCUtil.so
> 
> but in ECW 5.2.1, i only got :
> - libNCSEcw.so
> - libNCSEcwJNI.so
> 
> Is it enough to build it with gdal?
> 
> Thanks
> 
> Vincent
> ________________________________________
> De : gdal-dev <gdal-dev-bounces at lists.osgeo.org> de la part de Jeff McKenna
> <jmckenna at gatewaygeomatics.com> Envoyé : mercredi 7 décembre 2016 14:42
> À : gdal-dev at lists.osgeo.org
> Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1
> 
> Hi Vincent,
> 
> You might also review the BuildHints wiki page, that we all try to keep
> uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW  And if you
> notice something missing (like a tip for CentOS users) please definitely
> edit that wiki page and add it.  Hopefully this helps a little. Thanks!
> 
> -jeff
> 
> 
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> http://www.gatewaygeomatics.com/
> 
> On 2016-12-07 9:13 AM, Vincent BERNAT wrote:
> > Hi all,
> > 
> > I work with gdal-2.1.0 on CentOS
> > 
> > I would like to compil with ECW 5.2.1 so i add in the configure :
> > 
> > --with-ecw=/usr/local/hexagon
> > 
> > 
> > but i get the following message when compiling :
> > 
> > 
> > libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)
> > 
> > libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)
> > 
> > libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)
> > 
> > 
> > 
> > Did i miss something?
> > 

The issue is actually documented in https://trac.osgeo.org/gdal/wiki/ECW:

"""
Binary ECW SDK and GCC >= 5.2
Since GCC 5.2, GCC uses by default a new C++ ABI for libstdc++, which is incompatible of the 
ECW SDK binaries (at least to this date). The workaround is to build GDAL with CXXFLAGS="-
D_GLIBCXX_USE_CXX11_ABI=0" ./configure [options] 
Note: this trick will not work if you link against other C++ libraries compiler with the new ABI 
(such as likbml, podofo, poppler, cryptopp, etc.. typically coming from your distrution). If you 
also need them, you'll have to recompile them from source with CXXFLAGS="-
D_GLIBCXX_USE_CXX11_ABI=0" 
"""
Even the latest ECW SDK 5.3 uses the old ABI. You'll have to wait that the vendor releases a 
new build with the new C++ ABI for a less awkward solution.
Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/e6ec1e96/attachment-0001.html>

From sault.don at gmail.com  Wed Dec  7 09:22:54 2016
From: sault.don at gmail.com (Donovan Cameron)
Date: Wed, 7 Dec 2016 10:22:54 -0700
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
	release branch
Message-ID: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>

Morning Everyone!

Jasper was update in Arch Linux today and trying to build gdal 2.1 from 
the git 2.1 release branch (r36743) the compile fails with a jpeg2000 + 
jasper error:

make -C jpeg2000 install-obj
make[2]: Entering directory 
'/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe 
-fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC  
-Wall -Wextra -Winit-self -Wunused-parameter -Wformat 
-Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow 
-Werror=vla -Wnull-dereference -Wduplicated-cond -Wmissing-declarations 
-Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names 
-DOGR_ENABLED -D_FORTIFY_SOURCE=2 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include 
-DGDAL_COMPILATION -c -o ../o/jpeg2000dataset.o jpeg2000dataset.cpp
g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe 
-fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC  
-Wall -Wextra -Winit-self -Wunused-parameter -Wformat 
-Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow 
-Werror=vla -Wnull-dereference -Wduplicated-cond -Wmissing-declarations 
-Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names 
-DOGR_ENABLED -D_FORTIFY_SOURCE=2 
-I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include 
-DGDAL_COMPILATION -c -o ../o/jpeg2000_vsil_io.o jpeg2000_vsil_io.cpp
In file included from /usr/include/jasper/jasper.h:68:0,
                  from jpeg2000_vsil_io.h:33,
                  from jpeg2000_vsil_io.cpp:77:
jpeg2000_vsil_io.cpp: In function ‘void 
JPEG2000_VSIL_jas_stream_initbuf(jas_stream_t*, int, char*, int)’:
jpeg2000_vsil_io.cpp:212:32: error: ‘uchar’ was not declared in this scope
     stream->bufbase_ = JAS_CAST(uchar *, buf);
                                 ^
jpeg2000_vsil_io.cpp:212:23: error: expected primary-expression before 
‘)’ token
     stream->bufbase_ = JAS_CAST(uchar *, buf);
                        ^
make[2]: *** [../../GDALmake.opt:648: ../o/jpeg2000_vsil_io.o] Error 1
make[2]: Leaving directory 
'/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
make[1]: *** [GNUmakefile:15: jpeg2000-install-obj] Error 2
make[1]: Leaving directory '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts'
make: *** [GNUmakefile:88: frmts-target] Error 2

I have the following versions installed:

jasper 1.900.31

openjpeg2 2.1.2



-- 
Kind regards,

Donovan


From sault.don at gmail.com  Wed Dec  7 09:27:41 2016
From: sault.don at gmail.com (Donovan Cameron)
Date: Wed, 7 Dec 2016 10:27:41 -0700
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
	release branch
In-Reply-To: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
References: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
Message-ID: <cb1d314e-7956-4a83-e4fc-5629f147e229@gmail.com>

Downgrading jasper to 1.900.5 results in a successful build.



On 07/12/16 10:22 AM, Donovan Cameron wrote:
> Morning Everyone!
>
> Jasper was update in Arch Linux today and trying to build gdal 2.1 
> from the git 2.1 release branch (r36743) the compile fails with a 
> jpeg2000 + jasper error:
>
> make -C jpeg2000 install-obj
> make[2]: Entering directory 
> '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
> g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe 
> -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC  
> -Wall -Wextra -Winit-self -Wunused-parameter -Wformat 
> -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow 
> -Werror=vla -Wnull-dereference -Wduplicated-cond 
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual 
> -fno-operator-names -DOGR_ENABLED -D_FORTIFY_SOURCE=2 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include 
> -DGDAL_COMPILATION -c -o ../o/jpeg2000dataset.o jpeg2000dataset.cpp
> g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe 
> -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC  
> -Wall -Wextra -Winit-self -Wunused-parameter -Wformat 
> -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow 
> -Werror=vla -Wnull-dereference -Wduplicated-cond 
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual 
> -fno-operator-names -DOGR_ENABLED -D_FORTIFY_SOURCE=2 
> -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include 
> -DGDAL_COMPILATION -c -o ../o/jpeg2000_vsil_io.o jpeg2000_vsil_io.cpp
> In file included from /usr/include/jasper/jasper.h:68:0,
>                  from jpeg2000_vsil_io.h:33,
>                  from jpeg2000_vsil_io.cpp:77:
> jpeg2000_vsil_io.cpp: In function ‘void 
> JPEG2000_VSIL_jas_stream_initbuf(jas_stream_t*, int, char*, int)’:
> jpeg2000_vsil_io.cpp:212:32: error: ‘uchar’ was not declared in this 
> scope
>     stream->bufbase_ = JAS_CAST(uchar *, buf);
>                                 ^
> jpeg2000_vsil_io.cpp:212:23: error: expected primary-expression before 
> ‘)’ token
>     stream->bufbase_ = JAS_CAST(uchar *, buf);
>                        ^
> make[2]: *** [../../GDALmake.opt:648: ../o/jpeg2000_vsil_io.o] Error 1
> make[2]: Leaving directory 
> '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
> make[1]: *** [GNUmakefile:15: jpeg2000-install-obj] Error 2
> make[1]: Leaving directory '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts'
> make: *** [GNUmakefile:88: frmts-target] Error 2
>
> I have the following versions installed:
>
> jasper 1.900.31
>
> openjpeg2 2.1.2
>
>
>

-- 
Kind regards,

Donovan


From even.rouault at spatialys.com  Wed Dec  7 09:41:43 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 18:41:43 +0100
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
	release branch
In-Reply-To: <cb1d314e-7956-4a83-e4fc-5629f147e229@gmail.com>
References: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
 <cb1d314e-7956-4a83-e4fc-5629f147e229@gmail.com>
Message-ID: <1499688.NPYc9NrGn9@even-i700>

On mercredi 7 décembre 2016 10:27:41 CET Donovan Cameron wrote:
> Downgrading jasper to 1.900.5 results in a successful build.

Looking in the jasper of my ubuntu 16.04 (1.900.1-debian1-2.4ubuntu1), I can see:

/usr/include/jasper/jas_config2.h:#define	uchar		unsigned char
/usr/include/jasper/jas_config.h:#define uchar unsigned char
/usr/include/jasper/jas_icc.h:	uchar *ucdata; /* Unicode localizable description */
/usr/include/jasper/jas_icc.h:	uchar macdata[69]; /* Localizable Macintosh description 
*/
/usr/include/jasper/jas_icc.h:extern uchar jas_iccprofdata_srgb[];
/usr/include/jasper/jas_icc.h:extern uchar jas_iccprofdata_sgray[];
/usr/include/jasper/jas_icc.h:jas_iccprof_t *jas_iccprof_createfrombuf(uchar *buf, int len);
/usr/include/jasper/jas_stream.h:	uchar *bufbase_;
/usr/include/jasper/jas_stream.h:	uchar *bufstart_;
/usr/include/jasper/jas_stream.h:	uchar *ptr_;
/usr/include/jasper/jas_stream.h:	uchar tinybuf_[JAS_STREAM_MAXPUTBACK + 1];
/usr/include/jasper/jas_stream.h:	uchar *buf_;
/usr/include/jasper/jas_stream.h:	  jas_stream_flushbuf((stream), (uchar)(c)) : \
/usr/include/jasper/jas_types.h:#if !defined(uchar)
/usr/include/jasper/jas_types.h:#define uchar unsigned char

jasper.h is included by GDAL, which includes in turn jas_config.h and jas_types.h, which both 
provide the #define	uchar		unsigned char

So probably your newer jasper.h has no longer those includes, or something has changed in 
one of the above files.

You could as well replace the JAS_CAST(uchar *, buf); by JAS_CAST(unsigned char*, buf)

Even

> On 07/12/16 10:22 AM, Donovan Cameron wrote:
> > Morning Everyone!
> > 
> > Jasper was update in Arch Linux today and trying to build gdal 2.1
> > from the git 2.1 release branch (r36743) the compile fails with a
> > jpeg2000 + jasper error:
> > 
> > make -C jpeg2000 install-obj
> > make[2]: Entering directory
> > '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
> > g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe
> > -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC
> > -Wall -Wextra -Winit-self -Wunused-parameter -Wformat
> > -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow
> > -Werror=vla -Wnull-dereference -Wduplicated-cond
> > -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> > -fno-operator-names -DOGR_ENABLED -D_FORTIFY_SOURCE=2
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include
> > -DGDAL_COMPILATION -c -o ../o/jpeg2000dataset.o jpeg2000dataset.cpp
> > g++ -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gcore
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/alg
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/ogr/ogrsf_frmts
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/gnm
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/apps -march=native -O2 -pipe
> > -fstack-protector --param=ssp-buffer-size=4 -D_FORTIFY_SOURCE=2 -fPIC
> > -Wall -Wextra -Winit-self -Wunused-parameter -Wformat
> > -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow
> > -Werror=vla -Wnull-dereference -Wduplicated-cond
> > -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> > -fno-operator-names -DOGR_ENABLED -D_FORTIFY_SOURCE=2
> > -I/tmp/makepkg/gdal-filegdb/src/gdal-2.1/port -I/usr/include
> > -DGDAL_COMPILATION -c -o ../o/jpeg2000_vsil_io.o jpeg2000_vsil_io.cpp
> > In file included from /usr/include/jasper/jasper.h:68:0,
> > 
> >                  from jpeg2000_vsil_io.h:33,
> > 
> >                  from jpeg2000_vsil_io.cpp:77:
> > jpeg2000_vsil_io.cpp: In function ‘void
> > JPEG2000_VSIL_jas_stream_initbuf(jas_stream_t*, int, char*, int)’:
> > jpeg2000_vsil_io.cpp:212:32: error: ‘uchar’ was not declared in this
> > scope
> > 
> >     stream->bufbase_ = JAS_CAST(uchar *, buf);
> >     
> >                                 ^
> > 
> > jpeg2000_vsil_io.cpp:212:23: error: expected primary-expression before
> > ‘)’ token
> > 
> >     stream->bufbase_ = JAS_CAST(uchar *, buf);
> >     
> >                        ^
> > 
> > make[2]: *** [../../GDALmake.opt:648: ../o/jpeg2000_vsil_io.o] Error 1
> > make[2]: Leaving directory
> > '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts/jpeg2000'
> > make[1]: *** [GNUmakefile:15: jpeg2000-install-obj] Error 2
> > make[1]: Leaving directory '/tmp/makepkg/gdal-filegdb/src/gdal-2.1/frmts'
> > make: *** [GNUmakefile:88: frmts-target] Error 2
> > 
> > I have the following versions installed:
> > 
> > jasper 1.900.31
> > 
> > openjpeg2 2.1.2


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/efcfcb26/attachment-0001.html>

From sault.don at gmail.com  Wed Dec  7 10:19:11 2016
From: sault.don at gmail.com (Donovan Cameron)
Date: Wed, 7 Dec 2016 11:19:11 -0700
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
 release branch
In-Reply-To: <1499688.NPYc9NrGn9@even-i700>
References: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
 <cb1d314e-7956-4a83-e4fc-5629f147e229@gmail.com>
 <1499688.NPYc9NrGn9@even-i700>
Message-ID: <aafd3ab4-e3e7-0512-0763-f7e0251ff923@gmail.com>

On 07/12/16 10:41 AM, Even Rouault wrote:
>
> You could as well replace the JAS_CAST(uchar *, buf); by 
> JAS_CAST(unsigned char*, buf)
>

Thanks Even, that's helpful.

Whereabouts would I try to make this patch? Not sure what file to look 
for to do this. Sorry!



-- 
Kind regards,

Donovan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/105debb5/attachment.html>

From even.rouault at spatialys.com  Wed Dec  7 10:22:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Dec 2016 19:22:54 +0100
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
	release branch
In-Reply-To: <aafd3ab4-e3e7-0512-0763-f7e0251ff923@gmail.com>
References: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
 <1499688.NPYc9NrGn9@even-i700>
 <aafd3ab4-e3e7-0512-0763-f7e0251ff923@gmail.com>
Message-ID: <18752138.i2tFQV1F9v@even-i700>

On mercredi 7 décembre 2016 11:19:11 CET Donovan Cameron wrote:
> On 07/12/16 10:41 AM, Even Rouault wrote:
> > You could as well replace the JAS_CAST(uchar *, buf); by
> > JAS_CAST(unsigned char*, buf)
> 
> Thanks Even, that's helpful.
> 
> Whereabouts would I try to make this patch? Not sure what file to look
> for to do this. Sorry!

frmts/jpeg2000/jpeg2000_vsil_io.cpp, line 212


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/daa18eb5/attachment.html>

From sault.don at gmail.com  Wed Dec  7 10:43:24 2016
From: sault.don at gmail.com (Donovan Cameron)
Date: Wed, 7 Dec 2016 11:43:24 -0700
Subject: [gdal-dev] jpeg2000/jasper error compiling gdal 2.1 from git
 release branch
In-Reply-To: <18752138.i2tFQV1F9v@even-i700>
References: <319ab05d-d7f1-33d8-066d-19f9d657e26e@gmail.com>
 <1499688.NPYc9NrGn9@even-i700>
 <aafd3ab4-e3e7-0512-0763-f7e0251ff923@gmail.com>
 <18752138.i2tFQV1F9v@even-i700>
Message-ID: <96c0a2f8-1879-e8d4-ce5c-80bf02fc5a6e@gmail.com>

Awesome, patch works as expected and gdal builds against the latest jasper.

Thanks a lot.

diff --git a/frmts/jpeg2000/jpeg2000_vsil_io.cpp 
b/frmts/jpeg2000/jpeg2000_vsil_io.cpp index 74f1e64..3a948d0 100644 --- 
a/frmts/jpeg2000/jpeg2000_vsil_io.cpp +++ 
b/frmts/jpeg2000/jpeg2000_vsil_io.cpp @@ -209,7 +209,7 @@ static void 
JPEG2000_VSIL_jas_stream_initbuf(jas_stream_t *stream, int bufmode, /* 
The buffer must be large enough to accommodate maximum putback. */ 
assert(bufsize > JAS_STREAM_MAXPUTBACK); - stream->bufbase_ = 
JAS_CAST(uchar *, buf); + stream->bufbase_ = JAS_CAST(unsigned char*, 
buf); stream->bufsize_ = bufsize - JAS_STREAM_MAXPUTBACK; } } else {


On 07/12/16 11:22 AM, Even Rouault wrote:
>
> On mercredi 7 décembre 2016 11:19:11 CET Donovan Cameron wrote:
>
> > On 07/12/16 10:41 AM, Even Rouault wrote:
>
> > > You could as well replace the JAS_CAST(uchar *, buf); by
>
> > > JAS_CAST(unsigned char*, buf)
>
> >
>
> > Thanks Even, that's helpful.
>
> >
>
> > Whereabouts would I try to make this patch? Not sure what file to look
>
> > for to do this. Sorry!
>
> frmts/jpeg2000/jpeg2000_vsil_io.cpp, line 212
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

-- 
Kind regards,

Donovan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161207/16dc2dcf/attachment.html>

From nigel.westbury at 1spatial.com  Wed Dec  7 07:57:32 2016
From: nigel.westbury at 1spatial.com (Nigel Westbury)
Date: Wed, 7 Dec 2016 15:57:32 +0000
Subject: [gdal-dev] Building GDAL using MSBuild
Message-ID: <HE1PR07MB14170D7FB383F1F09F4F9773B8850@HE1PR07MB1417.eurprd07.prod.outlook.com>

I have a quick question:  does anyone know if anyone has attempted to build GDAL using MSBuild.  I am planning on writing an MSBuild script for GDAL so it can more easily be built in Jenkins.

Thanks,

Nigel

 [http://www.1spatial.com/signatures/1SpatialLogo_Small.jpg] <http://www.1spatial.com>





[http://www.1spatial.com/wp-content/themes/1spatial/images/youtube.png]<http://www.youtube.com/user/1SpatialGroup> [http://www.1spatial.com/wp-content/themes/1spatial/images/facebook.png] <https://www.facebook.com/1Spatial>  [http://www.1spatial.com/wp-content/themes/1spatial/images/linkedIn.png] <http://www.linkedin.com/company/1spatial>  [http://www.1spatial.com/wp-content/themes/1spatial/images/twitter.png] <http://www.twitter.com/1spatial>

________________________________

The information in this e-mail is confidential and may be legally privileged. It is intended solely for the addressee. Access to this email by anyone else is unauthorised. Any views or opinions expressed in this e-mail may be solely those of the author and are not necessarily those of 1Spatial Plc. This email has been scanned for viruses and message content. 1Spatial Group Limited is a company registered in England and Wales No.4785688. Registered Office: Tennyson House, Cambridge Business Park, Cambridge CB4 0WZ

From mateusz at loskot.net  Wed Dec  7 13:04:21 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 7 Dec 2016 22:04:21 +0100
Subject: [gdal-dev] Building GDAL using MSBuild
In-Reply-To: <HE1PR07MB14170D7FB383F1F09F4F9773B8850@HE1PR07MB1417.eurprd07.prod.outlook.com>
References: <HE1PR07MB14170D7FB383F1F09F4F9773B8850@HE1PR07MB1417.eurprd07.prod.outlook.com>
Message-ID: <CABUeae9rcEVBUhW85ZuDfD4WZo8wQUfG85pNTLnK4rWQrrZF8A@mail.gmail.com>

On 7 December 2016 at 16:57, Nigel Westbury <nigel.westbury at 1spatial.com> wrote:
> I have a quick question:  does anyone know if anyone has attempted to build GDAL using MSBuild.  I am planning on writing an MSBuild script for GDAL so it can more easily be built in Jenkins.

Nigel,

Try make_gdal.bat, https://trac.osgeo.org/gdal/wiki/MakeFileProjects

Then, feed MSBuild with .vcxproj file.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From dmorissette at mapgears.com  Wed Dec  7 20:13:45 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 7 Dec 2016 23:13:45 -0500
Subject: [gdal-dev] Code Sprint in Daytona Beach Feb 7 to 10, 2017
Message-ID: <f2e12526-001b-770d-2371-764f67761c40@mapgears.com>

Hi MapServer, GDAL and PostGIS devs,

This is a friendly reminder that we are planning the annual "C Tribe 
Code Sprint" (open to all tribes, just a historical name) in Daytona 
Beach the week of Feb 7 to 10, 2017.

For once we'll be heading to a warm place!

Find out more in the wiki at 
https://wiki.osgeo.org/wiki/Daytona_Beach_Code_Sprint_2017 and by 
following the "tosprint" list where the planning is happening 
(https://lists.osgeo.org/mailman/listinfo/tosprint)

ACTION ITEM: In order to help with planning, if you are interested in 
participating then please list yourself as early as possible in the wiki 
at https://wiki.osgeo.org/wiki/Daytona_Beach_Code_Sprint_2017#Participants

Thanks and hoping to see you there!

Daniel


P.S. Please do not hesitate to forward this to other project mailing 
lists after adding your own spices to the sauce... I just didn't want to 
be guilty of cross-posting the same email to all OSGeo project lists.

From vincent.bernat at magellium.fr  Thu Dec  8 00:28:32 2016
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Thu, 8 Dec 2016 08:28:32 +0000
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <3456098.2pOcMBAk0O@even-i700>
References: <1481116389794.25615@magellium.fr>
 <1481120828207.82771@magellium.fr>
 <1481121093363.48447@magellium.fr>,<3456098.2pOcMBAk0O@even-i700>
Message-ID: <1481185712702.76398@magellium.fr>

great! you're right!


I didn't try this solution because my gcc is 5.1.0^^


Thanks a lot


Regards,

Vincent


________________________________
De : Even Rouault <even.rouault at spatialys.com>
Envoyé : mercredi 7 décembre 2016 16:19
À : gdal-dev at lists.osgeo.org
Cc : Vincent BERNAT; Jeff McKenna
Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1


On mercredi 7 décembre 2016 14:31:33 CET Vincent BERNAT wrote:

> Thanks for reply Jeff :)

>

> There are lots of things about ecw 2.3.3 which is compiling for me.

> But not the 5.2.1 with gcc 5.1.0

>

> my problem is about link...

>

> In the 2.3.3 i had :

> - libNCSEcwC.so

> - libNCSEcw.so

> - libNCSCnet.so

> - libNCSCUtil.so

>

> but in ECW 5.2.1, i only got :

> - libNCSEcw.so

> - libNCSEcwJNI.so

>

> Is it enough to build it with gdal?

>

> Thanks

>

> Vincent

> ________________________________________

> De : gdal-dev <gdal-dev-bounces at lists.osgeo.org> de la part de Jeff McKenna

> <jmckenna at gatewaygeomatics.com> Envoyé : mercredi 7 décembre 2016 14:42

> À : gdal-dev at lists.osgeo.org

> Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1

>

> Hi Vincent,

>

> You might also review the BuildHints wiki page, that we all try to keep

> uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW And if you

> notice something missing (like a tip for CentOS users) please definitely

> edit that wiki page and add it. Hopefully this helps a little. Thanks!

>

> -jeff

>

>

> --

> Jeff McKenna

> MapServer Consulting and Training Services

> http://www.gatewaygeomatics.com/

>

> On 2016-12-07 9:13 AM, Vincent BERNAT wrote:

> > Hi all,

> >

> > I work with gdal-2.1.0 on CentOS

> >

> > I would like to compil with ECW 5.2.1 so i add in the configure :

> >

> > --with-ecw=/usr/local/hexagon

> >

> >

> > but i get the following message when compiling :

> >

> >

> > libgdal.so : undefined reference to 'NCS::CView::SetTransformList (...)

> >

> > libgdal.so : undefined reference to 'NCS::CString::Utf8Decode(...)

> >

> > libgdal.so : undefined reference to 'NCS::CString::utf8_str(...)

> >

> >

> >

> > Did i miss something?

> >



The issue is actually documented in https://trac.osgeo.org/gdal/wiki/ECW:



"""

Binary ECW SDK and GCC >= 5.2

Since GCC 5.2, GCC uses by default a new C++ ABI for libstdc++, which is incompatible of the ECW SDK binaries (at least to this date). The workaround is to build GDAL with CXXFLAGS="-D_GLIBCXX_USE_CXX11_ABI=0" ./configure [options]

Note: this trick will not work if you link against other C++ libraries compiler with the new ABI (such as likbml, podofo, poppler, cryptopp, etc.. typically coming from your distrution). If you also need them, you'll have to recompile them from source with CXXFLAGS="-D_GLIBCXX_USE_CXX11_ABI=0"

"""

Even the latest ECW SDK 5.3 uses the old ABI. You'll have to wait that the vendor releases a new build with the new C++ ABI for a less awkward solution.

Even





--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161208/3a764e5a/attachment-0001.html>

From even.rouault at spatialys.com  Thu Dec  8 00:49:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 08 Dec 2016 09:49:47 +0100
Subject: [gdal-dev] [gdal 2.1] ecw 5.2.1
In-Reply-To: <1481185712702.76398@magellium.fr>
References: <1481116389794.25615@magellium.fr> <3456098.2pOcMBAk0O@even-i700>
 <1481185712702.76398@magellium.fr>
Message-ID: <15117747.Vv9urZhJpJ@even-i700>

On jeudi 8 décembre 2016 08:28:32 CET Vincent BERNAT wrote:
> great! you're right!
> 
> 
> I didn't try this solution because my gcc is 5.1.0^^

Ah you're right. Looking at
https://gcc.gnu.org/onlinedocs/libstdc%2B%2B/manual/using_dual_abi.html , it seems the 
version with the new ABI was indeed 5.1. I've fixed the wiki.
> 
> 
> Thanks a lot
> 
> 
> Regards,
> 
> Vincent
> 
> 
> ________________________________
> De : Even Rouault <even.rouault at spatialys.com>
> Envoyé : mercredi 7 décembre 2016 16:19
> À : gdal-dev at lists.osgeo.org
> Cc : Vincent BERNAT; Jeff McKenna
> Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1
> 
> On mercredi 7 décembre 2016 14:31:33 CET Vincent BERNAT wrote:
> > Thanks for reply Jeff :)
> > 
> > 
> > 
> > There are lots of things about ecw 2.3.3 which is compiling for me.
> > 
> > But not the 5.2.1 with gcc 5.1.0
> > 
> > 
> > 
> > my problem is about link...
> > 
> > 
> > 
> > In the 2.3.3 i had :
> > 
> > - libNCSEcwC.so
> > 
> > - libNCSEcw.so
> > 
> > - libNCSCnet.so
> > 
> > - libNCSCUtil.so
> > 
> > 
> > 
> > but in ECW 5.2.1, i only got :
> > 
> > - libNCSEcw.so
> > 
> > - libNCSEcwJNI.so
> > 
> > 
> > 
> > Is it enough to build it with gdal?
> > 
> > 
> > 
> > Thanks
> > 
> > 
> > 
> > Vincent
> > 
> > ________________________________________
> > 
> > De : gdal-dev <gdal-dev-bounces at lists.osgeo.org> de la part de Jeff
> > McKenna
> > 
> > <jmckenna at gatewaygeomatics.com> Envoyé : mercredi 7 décembre 2016 14:42
> > 
> > À : gdal-dev at lists.osgeo.org
> > 
> > Objet : Re: [gdal-dev] [gdal 2.1] ecw 5.2.1
> > 
> > 
> > 
> > Hi Vincent,
> > 
> > 
> > 
> > You might also review the BuildHints wiki page, that we all try to keep
> > 
> > uptodate, for ECW at https://trac.osgeo.org/gdal/wiki/ECW And if you
> > 
> > notice something missing (like a tip for CentOS users) please definitely
> > 
> > edit that wiki page and add it. Hopefully this helps a little. Thanks!
> > 
> > 
> > 
> > -jeff
> > 
> > 
> > 
> > 
> > 
> > --
> > 
> > Jeff McKenna
> > 
> > MapServer Consulting and Training Services
> > 
> > http://www.gatewaygeomatics.com/
> > 
> > On 2016-12-07 9:13 AM, Vincent BERNAT wrote:
> > > Hi all,
> > > 
> > > 
> > > 
> > > I work with gdal-2.1.0 on CentOS
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161208/d1f69422/attachment-0001.html>

From mateusz at loskot.net  Thu Dec  8 02:05:31 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 8 Dec 2016 11:05:31 +0100
Subject: [gdal-dev] Building GDAL using MSBuild
In-Reply-To: <HE1PR07MB141791D8E51EDEF168E15785B8840@HE1PR07MB1417.eurprd07.prod.outlook.com>
References: <HE1PR07MB14170D7FB383F1F09F4F9773B8850@HE1PR07MB1417.eurprd07.prod.outlook.com>
 <CABUeae9rcEVBUhW85ZuDfD4WZo8wQUfG85pNTLnK4rWQrrZF8A@mail.gmail.com>
 <HE1PR07MB141791D8E51EDEF168E15785B8840@HE1PR07MB1417.eurprd07.prod.outlook.com>
Message-ID: <CABUeae-m8efdcxYh44_8XijJh_GsQodkd2Lpw34NoqutU0o4cg@mail.gmail.com>

Nigel,

You're welcome.

Regards,
Mateusz

On 8 December 2016 at 11:02, Nigel Westbury <nigel.westbury at 1spatial.com> wrote:
> Thanks so much.  That is really helpful and exactly what I need.
>
> -----Original Message-----
> From: Mateusz Loskot [mailto:mateusz at loskot.net]
> Sent: 07 December 2016 21:04
> To: Nigel Westbury
> Cc: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Building GDAL using MSBuild
>
> On 7 December 2016 at 16:57, Nigel Westbury <nigel.westbury at 1spatial.com> wrote:
>> I have a quick question:  does anyone know if anyone has attempted to build GDAL using MSBuild.  I am planning on writing an MSBuild script for GDAL so it can more easily be built in Jenkins.
>
> Nigel,
>
> Try make_gdal.bat, https://trac.osgeo.org/gdal/wiki/MakeFileProjects
>
> Then, feed MSBuild with .vcxproj file.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
>  [http://www.1spatial.com/signatures/1SpatialLogo_Small.jpg] <http://www.1spatial.com>
>
>
>
>
>
> [http://www.1spatial.com/wp-content/themes/1spatial/images/youtube.png]<http://www.youtube.com/user/1SpatialGroup> [http://www.1spatial.com/wp-content/themes/1spatial/images/facebook.png] <https://www.facebook.com/1Spatial>  [http://www.1spatial.com/wp-content/themes/1spatial/images/linkedIn.png] <http://www.linkedin.com/company/1spatial>  [http://www.1spatial.com/wp-content/themes/1spatial/images/twitter.png] <http://www.twitter.com/1spatial>
>
> ________________________________
>
> The information in this e-mail is confidential and may be legally privileged. It is intended solely for the addressee. Access to this email by anyone else is unauthorised. Any views or opinions expressed in this e-mail may be solely those of the author and are not necessarily those of 1Spatial Plc. This email has been scanned for viruses and message content. 1Spatial Group Limited is a company registered in England and Wales No.4785688. Registered Office: Tennyson House, Cambridge Business Park, Cambridge CB4 0WZ



-- 
Mateusz Loskot, http://mateusz.loskot.net

From tomerlieber at gmail.com  Thu Dec  8 02:19:01 2016
From: tomerlieber at gmail.com (Tomer)
Date: Thu, 8 Dec 2016 03:19:01 -0700 (MST)
Subject: [gdal-dev]  Error in building GDAL with java binding
Message-ID: <1481192341505-5299188.post@n6.nabble.com>

Hey,

I want to build java binding for GDAL.
After following "Build Instructions for GDAL/OGR In Java (Windows)", I get
the next error:
*"NMAKE : fatal error U1045: spawn failed : Permission denied"*

Regards,
Tomer



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Error-in-building-GDAL-with-java-binding-tp5299188.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From cmartinez at scolab.es  Thu Dec  8 15:21:49 2016
From: cmartinez at scolab.es (=?UTF-8?B?Q8Opc2FyIE1hcnTDrW5leg==?=)
Date: Fri, 9 Dec 2016 00:21:49 +0100
Subject: [gdal-dev] Primary keys are ignored in ogr2ogr when converting from
	Sqlite databases
Message-ID: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>

Hi, I am using ogr2ogr to export data from Spatialite to other formats
(such as PostGIS or a new Spatialite db).

The layers have an integer primary key, but this field is ignored in
the output table, as an OGC_FID field is created which uses
consecutive numbers, ignoring the real values of the primary key in
the original field.

This is quite inconvenient, as the layer is quite useless after loosing the PK.

I'll provide one example to make it clearer.

- Input data:

CREATE TABLE test
(id INTEGER NOT NULL PRIMARY KEY,
name TEXT NOT NULL);
SELECT AddGeometryColumn('test', 'the_geom', 4326, 'POINT', 'XY');

INSERT INTO 'test' (id, name, the_geom) VALUES (1, "row1",
GeomFromText('POINT(1.01 2.02)', 4326));
INSERT INTO 'test' (id, name, the_geom) VALUES (3, "row3",
GeomFromText('POINT(3.03 4.04)', 4326));

Now we export the table using ogr2ogr:
ogr2ogr -f "SQLite" db2.sqlite  db.sqlite test -dsco SPATIALITE=YES

Now compare both layers:
$ ogrinfo -q db.sqlite test

Layer name: test
OGRFeature(test):1
  name (String) = row1
  POINT (1.01 2.02)

OGRFeature(test):3
  name (String) = row3
  POINT (3.03 4.04)

$ ogrinfo -q db2.sqlite test

Layer name: test
OGRFeature(test):1
  name (String) = row1
  POINT (1.01 2.02)

OGRFeature(test):2
  name (String) = row3
  POINT (3.03 4.04)

Is this a bug or is an intended behaviour? Is there any way to workaround it?
I am using GDAL version 1.11.3. It also happens when exporting to a
different format such as PostGIS.

Greetings,

César Martinez


-- 
SCOLAB
http://scolab.es

From bo.victor.thomsen at gmail.com  Fri Dec  9 00:36:08 2016
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Fri, 9 Dec 2016 09:36:08 +0100
Subject: [gdal-dev] Primary keys are ignored in ogr2ogr when converting
 from Sqlite databases
In-Reply-To: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>
References: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>
Message-ID: <118de8c3-1891-4df4-5183-3ab78baf2e88@gmail.com>

Have you tried to use the *-preserve_fid *qualifier*??
*

ex.

ogr2ogr -preserve_fid -f "SQLite" db2.sqlite  db.sqlite test -dsco SPATIALITE=YES

Regards
Bo Victor Thomsen
AestasGIS

Den 09-12-2016 kl. 00:21 skrev César Martínez:
> Hi, I am using ogr2ogr to export data from Spatialite to other formats
> (such as PostGIS or a new Spatialite db).
>
> The layers have an integer primary key, but this field is ignored in
> the output table, as an OGC_FID field is created which uses
> consecutive numbers, ignoring the real values of the primary key in
> the original field.
>
> This is quite inconvenient, as the layer is quite useless after loosing the PK.
>
> I'll provide one example to make it clearer.
>
> - Input data:
>
> CREATE TABLE test
> (id INTEGER NOT NULL PRIMARY KEY,
> name TEXT NOT NULL);
> SELECT AddGeometryColumn('test', 'the_geom', 4326, 'POINT', 'XY');
>
> INSERT INTO 'test' (id, name, the_geom) VALUES (1, "row1",
> GeomFromText('POINT(1.01 2.02)', 4326));
> INSERT INTO 'test' (id, name, the_geom) VALUES (3, "row3",
> GeomFromText('POINT(3.03 4.04)', 4326));
>
> Now we export the table using ogr2ogr:
> ogr2ogr -f "SQLite" db2.sqlite  db.sqlite test -dsco SPATIALITE=YES
>
> Now compare both layers:
> $ ogrinfo -q db.sqlite test
>
> Layer name: test
> OGRFeature(test):1
>    name (String) = row1
>    POINT (1.01 2.02)
>
> OGRFeature(test):3
>    name (String) = row3
>    POINT (3.03 4.04)
>
> $ ogrinfo -q db2.sqlite test
>
> Layer name: test
> OGRFeature(test):1
>    name (String) = row1
>    POINT (1.01 2.02)
>
> OGRFeature(test):2
>    name (String) = row3
>    POINT (3.03 4.04)
>
> Is this a bug or is an intended behaviour? Is there any way to workaround it?
> I am using GDAL version 1.11.3. It also happens when exporting to a
> different format such as PostGIS.
>
> Greetings,
>
> César Martinez
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161209/0be8548f/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Dec  9 00:49:01 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 9 Dec 2016 01:49:01 -0700 (MST)
Subject: [gdal-dev] Primary keys are ignored in ogr2ogr when converting
 from Sqlite databases
In-Reply-To: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>
References: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>
Message-ID: <1481273341881-5299325.post@n6.nabble.com>

César Martínez wrote
> Is this a bug or is an intended behaviour? Is there any way to workaround
> it?
> I am using GDAL version 1.11.3. It also happens when exporting to a
> different format such as PostGIS.

A workaround is to pick the primary key as a normal attribute and let GDAL
to create its own primary key. You can add a unique constraint to ID
afterwards https://www.techonthenet.com/sqlite/unique.php and then it is
almost like a PK for you



Easier way for preventing duplicate values would be to create an unique
index on ID.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Primary-keys-are-ignored-in-ogr2ogr-when-converting-from-Sqlite-databases-tp5299286p5299325.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Dec  9 03:10:25 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 09 Dec 2016 12:10:25 +0100
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
	Polyhedral surface and TIN
Message-ID: <2857702.EmuknaLicI@even-i700>

Hi,

There have been some good remarks, one regarding integration with GEOS that I've 
taken into account in the implementation, another one regarding the possibility to 
get indexed TIN that I think can be later added if needed.

So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN

    https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin

Starting with my +1,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161209/86dfa7b9/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Dec  9 05:12:28 2016
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 9 Dec 2016 06:12:28 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <2857702.EmuknaLicI@even-i700>
References: <2857702.EmuknaLicI@even-i700>
Message-ID: <1481289148388-5299369.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> There have been some good remarks, one regarding integration with GEOS
> that I've 
> taken into account in the implementation, another one regarding the
> possibility to 
> get indexed TIN that I think can be later added if needed.
> 
> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
> 
>     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> 
> Starting with my +1,

+1

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motion-adopt-RFC-64-Triangle-Polyhedral-surface-and-TIN-tp5299355p5299369.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Dec  9 05:56:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 09 Dec 2016 14:56:27 +0100
Subject: [gdal-dev] shapelib 1.4.0 is released
Message-ID: <54866253.c7MHxuM9Us@even-i700>

Hi,

The shapelib 1.4.0 release is available at:
     http://download.osgeo.org/shapelib/shapelib-1.4.0.tar.gz
     http://download.osgeo.org/shapelib/shapelib-1.4.0.zip


The differences since RC1 are:

2016-12-09  Even Rouault  <even.rouault at spatialys.com>

        * Makefile.am: add web/maptools.css to EXTRA_DIST

        * Shapelib 1.4.0 released

2016-12-06  Even Rouault  <even.rouault at spatialys.com>

        * configure.ac: change soname to 2:1:0 to be in sync with Debian soname.
        http://bugzilla.maptools.org/show_bug.cgi?id=2628
        Patch by Bas Couwenberg 

        * contrib/doc/Shape_PointInPoly_README.txt, contrib/shpgeo.c: typo fixes.
        http://bugzilla.maptools.org/show_bug.cgi?id=2629
        Patch by Bas Couwenberg

        * web/*: use a local .css file to avoid a privacy breach issue reported
        by the lintian QA tool. 
        http://bugzilla.maptools.org/show_bug.cgi?id=2630
        Patch by Bas Couwenberg

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161209/03a02d57/attachment-0001.html>

From landa.martin at gmail.com  Sat Dec 10 04:17:00 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 10 Dec 2016 13:17:00 +0100
Subject: [gdal-dev] FileGDB: subtypes
Message-ID: <CA+Ei1OdQA7Vur-D6Ma6CfJnShctdn59Xf=qkfTSZ_j4968MdHg@mail.gmail.com>

Hi,

I am interested how FileGDB subtypes work in GDAL (GDAL should support
them since version 2.0). I have feature class `Silnice` (roads) with
attribute `typ` (type). This attribute is connected with subtype
road_type (1 - highway, 2 - speed road, 3 - ...). ogrinfo detects this
attribute as an integer, eg.

$ ogrinfo Repository/ArcCR500/ArcCR500_v32.gdb Silnice -fid 36843
Had to open data source read-only.
INFO: Open of `Repository/ArcCR500/ArcCR500_v32.gdb'
      using driver `OpenFileGDB' successful.
...
OGRFeature(Silnice):36843
  TRIDA (Integer) = 1
  CISLO_SILNICE (String) = 185
  ...

Is it possible to change this behaviour in the sense of preferring
subtype description, something like:

OGRFeature(Silnice):36843
  TRIDA (String) = 'highway'
  CISLO_SILNICE (String) = 185
  ...

or

OGRFeature(Silnice):36843
  TRIDA (Integer) = 1
  TRIDA_DESC (String) = 'highway'
  CISLO_SILNICE (String) = 185
  ...

?

Is there any difference between OpenFileGDB and FileGDB drivers?

Thanks! Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sat Dec 10 05:08:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 10 Dec 2016 14:08:26 +0100
Subject: [gdal-dev] FileGDB: subtypes
In-Reply-To: <CA+Ei1OdQA7Vur-D6Ma6CfJnShctdn59Xf=qkfTSZ_j4968MdHg@mail.gmail.com>
References: <CA+Ei1OdQA7Vur-D6Ma6CfJnShctdn59Xf=qkfTSZ_j4968MdHg@mail.gmail.com>
Message-ID: <3505664.TvLTtYh6sl@even-i700>

On samedi 10 décembre 2016 13:17:00 CET Martin Landa wrote:
> Hi,
> 
> I am interested how FileGDB subtypes work in GDAL (GDAL should support
> them since version 2.0). I have feature class `Silnice` (roads) with
> attribute `typ` (type). This attribute is connected with subtype
> road_type (1 - highway, 2 - speed road, 3 - ...). ogrinfo detects this
> attribute as an integer, eg.

How sub-type works is explained in
https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype

What you want here is probably related to "expanding" "coded value domains". There is a 
ticket about that:
https://trac.osgeo.org/gdal/ticket/5741

This isn't implemented yet.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161210/82452142/attachment.html>

From landa.martin at gmail.com  Sat Dec 10 08:47:55 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Sat, 10 Dec 2016 17:47:55 +0100
Subject: [gdal-dev] FileGDB: subtypes
In-Reply-To: <3505664.TvLTtYh6sl@even-i700>
References: <CA+Ei1OdQA7Vur-D6Ma6CfJnShctdn59Xf=qkfTSZ_j4968MdHg@mail.gmail.com>
 <3505664.TvLTtYh6sl@even-i700>
Message-ID: <CA+Ei1OcpN6TzEEOeaPQeNLMWwojzOgR6dn_EX1JJZwMNjE3Twg@mail.gmail.com>

Hi,

2016-12-10 14:08 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> What you want here is probably related to "expanding" "coded value domains".
> There is a ticket about that:
>
> https://trac.osgeo.org/gdal/ticket/5741

right. Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Sun Dec 11 14:29:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 11 Dec 2016 23:29:55 +0100
Subject: [gdal-dev] GDAL 2.1.2 compilation error
In-Reply-To: <64fc50c0-c6ad-1c77-ef0c-4f1bee73f188@cubewerx.com>
References: <07d763a8-6d70-4718-ebc4-92830966268d@cubewerx.com>
 <201611092114.31968.even.rouault@spatialys.com>
 <64fc50c0-c6ad-1c77-ef0c-4f1bee73f188@cubewerx.com>
Message-ID: <201612112329.56102.even.rouault@spatialys.com>

>  I worked around the problem by making a float-type-only copy of the
> templated function VRTComplexSource::RasterIOInternal() and calling that
> instead inside "vrtfilters.cpp" and GCC 4.6.3 seems to be happy with that.

I've reproduced the issue with another compiler and fixed it with
https://trac.osgeo.org/gdal/ticket/6748


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From johan.de.braak at eleaf.com  Sun Dec 11 23:50:11 2016
From: johan.de.braak at eleaf.com (Johan de Braak)
Date: Mon, 12 Dec 2016 00:50:11 -0700 (MST)
Subject: [gdal-dev] Sentinel driver
Message-ID: <1481529011795-5299537.post@n6.nabble.com>

Hi all,

Will there be an update of the Sentinel driver that is able to deal with the
new Level 1C product format (as announced here:
https://scihub.copernicus.eu/news/News00124 ) ?

Thanks,

Johan



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Sentinel-driver-tp5299537.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From julien.michel at cnes.fr  Mon Dec 12 00:52:40 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 12 Dec 2016 09:52:40 +0100
Subject: [gdal-dev] Sentinel driver
In-Reply-To: <1481529011795-5299537.post@n6.nabble.com>
References: <1481529011795-5299537.post@n6.nabble.com>
Message-ID: <d8bfc87c-1bdc-20f6-9ba1-2fee10ec3cd5@cnes.fr>

Hi,

I started working on it here :

https://github.com/jmichel-otb/gdal/tree/sentinel2-new-format-support

But :
- The more I work on it, the more it looks like a bunch of ugly patches,
- I managed to get datasets reporting right, but the reading still fails.

I do not have much time to move it forward at the moment. I would also 
propably need help on the reading part ...

Regards,

Julien

Le 12/12/2016 à 08:50, Johan de Braak a écrit :
> Hi all,
>
> Will there be an update of the Sentinel driver that is able to deal with the
> new Level 1C product format (as announced here:
> https://scihub.copernicus.eu/news/News00124 ) ?
>
> Thanks,
>
> Johan
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Sentinel-driver-tp5299537.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Julien MICHEL
CNES - DCT/SI/AP


From bontepaarden at gmail.com  Tue Dec 13 01:44:24 2016
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 13 Dec 2016 10:44:24 +0100
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to GeoTiff
Message-ID: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>

I'm trying to use the precipitation accumulations from our national weather
agency: https://data.knmi.nl/datasets/radar_tar_corr_accum_03h/2.0
The data is in HDF5 with two subsets.
I only need one subset and I need the data in WGS84.

I'm using GDAL v2.2 from GisInternals.com
I tried using GDALWarp but then I get an error about missing the
transformation matrix.
Using Google I figured out I need to do GDALTranslate first to set the
georeferenced bounds.

This is the result of GDALInfo:
Driver: HDF5/Hierarchical Data Format Release 5
Files: RAD_NL25_RAC_03H_201612041200.h5
Size is 512, 512
Coordinate System is `'
Metadata:
  geographic_geo_column_offset=0
  geographic_geo_dim_pixel=KM,KM
  geographic_geo_number_columns=700
  geographic_geo_number_rows=765
  geographic_geo_par_pixel=X,Y
  geographic_geo_pixel_def=LU
  geographic_geo_pixel_size_x=1.0000013
  geographic_geo_pixel_size_y=-1.0000055
  geographic_geo_product_corners=0 49.362053 0 55.973602 10.856429
55.388977 9.0092793 48.895298
  geographic_geo_row_offset=3649.9792
  geographic_map_projection_projection_indication=Y
  geographic_map_projection_projection_name=STEREOGRAPHIC
  geographic_map_projection_projection_proj4_params=+proj=stere +lat_0=90
+lon_0=0 +lat_ts=60 +a=6378.14 +b=6356.75 +x_0=0 y_0=0
  image1_calibration_calibration_flag=Y
  image1_calibration_calibration_formulas=GEO = 0.010000 * PV + 0.000000
  image1_calibration_calibration_missing_data=0
  image1_calibration_calibration_out_of_image=65535
  image1_image_bytes_per_pixel=2
  image1_image_data_CLASS=IMAGE
  image1_image_data_VERSION=1.2
  image1_image_geo_parameter=PRECIP_[MM]
  image1_image_number_accumulated_products=37
  image1_image_product_name=RAD_NL25_RAC_H1.5_03H
  image1_image_size=535500
  image1_statistics_stat_max_value=9.96
  image1_statistics_stat_min_value=0
  image2_calibration_calibration_flag=Y
  image2_calibration_calibration_formulas=GEO=0.001*PV+-32.768
  image2_calibration_calibration_missing_data=0
  image2_calibration_calibration_out_of_image=65535
  image2_image_bytes_per_pixel=2
  image2_image_data_CLASS=IMAGE
  image2_image_data_VERSION=1.2
  image2_image_geo_parameter=ADJUSTMENT_FACTOR_[DB]
  image2_image_number_accumulated_products=37
  image2_image_product_name=RAD_NL25_RAC_H1.5_03H
  image2_image_size=535500
  image2_statistics_stat_max_value=0
  image2_statistics_stat_min_value=0
  overview_hdftag_version_number=3.6
  overview_number_image_groups=2
  overview_number_radar_groups=1
  overview_number_satellite_groups=0
  overview_number_station_groups=0
  overview_product_datetime_end=04-DEC-2016;12:00:00.000
  overview_product_datetime_start=04-DEC-2016;09:00:00.000
  overview_product_group_name=RAD_NL25_RAC_03H
  overview_products_missing=NA
  radar1_radar_adjustment=F=-0.00dB
  radar1_radar_location=5.17834 52.101681
  radar1_radar_name=DeBilt
Subdatasets:

SUBDATASET_1_NAME=HDF5:"RAD_NL25_RAC_03H_201612041200.h5"://image1/image_data
  SUBDATASET_1_DESC=[765x700] //image1/image_data (16-bit unsigned integer)

SUBDATASET_2_NAME=HDF5:"RAD_NL25_RAC_03H_201612041200.h5"://image2/image_data
  SUBDATASET_2_DESC=[765x700] //image2/image_data (16-bit unsigned integer)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)


This is my GDALTranslate command, the projectionstring and a_ullr come from
the meta data:

gdal_translate -of GTiff -a_nodata 65535 -a_srs "+proj=stere +lat_0=90
+lon_0=0 +lat_ts=60 +a=6378.14 +b=6356.75 +x_0=0 y_0=0" -a_ullr 0
55.973602 9.0092793 48.895298
"HDF5:\"RAD_NL25_RAC_03H_201612041200.h5\"://image1/image_data"
"test-translate.tif"


This is my GDALWarp command:

gdalwarp -overwrite -s_srs "+proj=stere +lat_0=90 +lon_0=0 +lat_ts=60
+a=6378.14 +b=6356.75 +x_0=0 y_0=0" -t_srs EPSG:3857 -dstnodata 65535
-of GTiff "test-translate.tif" "test-warp.tif"


The warped tif is not where I expect it to be.
I expect a origin around 52 en 5 degrees (The Netherlands)
I'm getting: Origin = (169.559973821725920,89.530840368222059)

I've checked with the data provider and the projectionstring is correct.
What am I doing wrong?

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/dcab5e06/attachment.html>

From kassies at gmail.com  Tue Dec 13 02:29:55 2016
From: kassies at gmail.com (Rutger)
Date: Tue, 13 Dec 2016 03:29:55 -0700 (MST)
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
 GeoTiff
In-Reply-To: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
Message-ID: <1481624995057-5299666.post@n6.nabble.com>

Hey Paul,

If you assign the RD projection with 'a_srs', you should also assign the
'ullr' coordinates in that same projection, not in lat/lon degrees like you
do now.


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-precipitation-accumulations-from-HDF5-to-GeoTiff-tp5299661p5299666.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bontepaarden at gmail.com  Tue Dec 13 04:46:17 2016
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 13 Dec 2016 13:46:17 +0100
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
	GeoTiff
In-Reply-To: <1481624995057-5299666.post@n6.nabble.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
 <1481624995057-5299666.post@n6.nabble.com>
Message-ID: <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>

Thanks Rutger,

You are completely right. I assumed the coordinates were in the same
projection as the project string.

Menno van Scheers replied me directly and suggested I should use 0.0,
-3650.000, 800.000, -4415.000 as ullr coordinates.
I tried it and now the GeoTiff is where I expect it to be.




Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2016-12-13 11:29 GMT+01:00 Rutger <kassies at gmail.com>:

> Hey Paul,
>
> If you assign the RD projection with 'a_srs', you should also assign the
> 'ullr' coordinates in that same projection, not in lat/lon degrees like you
> do now.
>
>
> Regards,
> Rutger
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.
> nabble.com/gdal-dev-Convert-precipitation-accumulations-
> from-HDF5-to-GeoTiff-tp5299661p5299666.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/0ac8beea/attachment.html>

From kassies at gmail.com  Tue Dec 13 05:17:18 2016
From: kassies at gmail.com (Rutger)
Date: Tue, 13 Dec 2016 06:17:18 -0700 (MST)
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
	GeoTiff
In-Reply-To: <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
 <1481624995057-5299666.post@n6.nabble.com>
 <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>
Message-ID: <1481635038580-5299678.post@n6.nabble.com>

Hey,

Based on the metadata from the file you posted i would guess the
x-coordinate of the right edge (lrx) should be about ~700km or ~700000m.

The column offset is 0, and there are 700 columns in the file which are
slightly over 1km. How would you end up with 800?

You can calculate the other corner coordinates in a similar fashion. 


Regards,
Rutger




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-precipitation-accumulations-from-HDF5-to-GeoTiff-tp5299661p5299678.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bontepaarden at gmail.com  Tue Dec 13 06:33:33 2016
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 13 Dec 2016 15:33:33 +0100
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
	GeoTiff
In-Reply-To: <CAHNf2YRJ26pSMdgi=BHYnEcheMFz6BRf2Ji=MMp242BS_uRoBw@mail.gmail.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
 <1481624995057-5299666.post@n6.nabble.com>
 <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>
 <1481635038580-5299678.post@n6.nabble.com>
 <CAHNf2YRJ26pSMdgi=BHYnEcheMFz6BRf2Ji=MMp242BS_uRoBw@mail.gmail.com>
Message-ID: <CAHNf2YTx+Uz0Y7FbUdsOm5+T8opi7gb1wjwa4Qx3nGb2y+CxVg@mail.gmail.com>

Thanks again Rutger for your observation.

The bounding box was sent to me and I was already very happy the tiff is
located in The Netherlands ;)

I did a closer look at the meta data and with your explanation I come up
with this 'formula':

The ul is 0.0, -1 * geographic_geo_row_offset
lr is geographic_geo_number_columns, -1 * (geographic_geo_number_rows +
geographic_geo_row_offset)
Resulting in 0.0 3650 700, -4415

Thanks,

Paul



> 2016-12-13 14:17 GMT+01:00 Rutger <kassies at gmail.com>:
>
>> Hey,
>>
>> Based on the metadata from the file you posted i would guess the
>> x-coordinate of the right edge (lrx) should be about ~700km or ~700000m.
>>
>> The column offset is 0, and there are 700 columns in the file which are
>> slightly over 1km. How would you end up with 800?
>>
>> You can calculate the other corner coordinates in a similar fashion.
>>
>>
>> Regards,
>> Rutger
>>
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.nabbl
>> e.com/gdal-dev-Convert-precipitation-accumulations-from-
>> HDF5-to-GeoTiff-tp5299661p5299678.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/2463d359/attachment.html>

From cmartinez at scolab.es  Tue Dec 13 06:36:47 2016
From: cmartinez at scolab.es (=?UTF-8?B?Q8Opc2FyIE1hcnTDrW5leg==?=)
Date: Tue, 13 Dec 2016 15:36:47 +0100
Subject: [gdal-dev] Primary keys are ignored in ogr2ogr when converting
 from Sqlite databases
In-Reply-To: <118de8c3-1891-4df4-5183-3ab78baf2e88@gmail.com>
References: <CA+RzLkbxAP+TaHeFmasTW85OSB5iwpCuN8PWLP4VZnka3JivCg@mail.gmail.com>
 <118de8c3-1891-4df4-5183-3ab78baf2e88@gmail.com>
Message-ID: <CA+RzLkZmYTwX+u_QsPxEGPH5eocuGg-HC8X797mYuE0xBtjO=w@mail.gmail.com>

Thank you, I was not aware of the -preserve_fid qualifier, it works as
expected when I use it.
Sorry about the noise.

César Martínez

2016-12-09 9:36 GMT+01:00 Bo Victor Thomsen <bo.victor.thomsen at gmail.com>:
> Have you tried to use the -preserve_fid qualifier ??
>
> ex.
>
> ogr2ogr -preserve_fid -f "SQLite" db2.sqlite  db.sqlite test -dsco
> SPATIALITE=YES
>
> Regards
> Bo Victor Thomsen
> AestasGIS
>
> Den 09-12-2016 kl. 00:21 skrev César Martínez:
>
> Hi, I am using ogr2ogr to export data from Spatialite to other formats
> (such as PostGIS or a new Spatialite db).
>
> The layers have an integer primary key, but this field is ignored in
> the output table, as an OGC_FID field is created which uses
> consecutive numbers, ignoring the real values of the primary key in
> the original field.
>
> This is quite inconvenient, as the layer is quite useless after loosing the
> PK.
>
> I'll provide one example to make it clearer.
>
> - Input data:
>
> CREATE TABLE test
> (id INTEGER NOT NULL PRIMARY KEY,
> name TEXT NOT NULL);
> SELECT AddGeometryColumn('test', 'the_geom', 4326, 'POINT', 'XY');
>
> INSERT INTO 'test' (id, name, the_geom) VALUES (1, "row1",
> GeomFromText('POINT(1.01 2.02)', 4326));
> INSERT INTO 'test' (id, name, the_geom) VALUES (3, "row3",
> GeomFromText('POINT(3.03 4.04)', 4326));
>
> Now we export the table using ogr2ogr:
> ogr2ogr -f "SQLite" db2.sqlite  db.sqlite test -dsco SPATIALITE=YES
>
> Now compare both layers:
> $ ogrinfo -q db.sqlite test
>
> Layer name: test
> OGRFeature(test):1
>   name (String) = row1
>   POINT (1.01 2.02)
>
> OGRFeature(test):3
>   name (String) = row3
>   POINT (3.03 4.04)
>
> $ ogrinfo -q db2.sqlite test
>
> Layer name: test
> OGRFeature(test):1
>   name (String) = row1
>   POINT (1.01 2.02)
>
> OGRFeature(test):2
>   name (String) = row3
>   POINT (3.03 4.04)
>
> Is this a bug or is an intended behaviour? Is there any way to workaround
> it?
> I am using GDAL version 1.11.3. It also happens when exporting to a
> different format such as PostGIS.
>
> Greetings,
>
> César Martinez
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
SCOLAB
http://scolab.es

From jukka.rahkonen at maanmittauslaitos.fi  Tue Dec 13 06:36:19 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 13 Dec 2016 14:36:19 +0000
Subject: [gdal-dev] Creating JPEG compressed external overviews fails
Message-ID: <6088f347aaa743919a7dc69d5172f47c@C119S212VM022.msvyvi.vaha.local>

Hi,

This has worked for me and still works with GDAL version GDAL 2.0dev, released 2011/12/29
gdaladdo -r average -ro --config COMPRESS_OVERVIEW JPEG --config PHOTOMETRIC_OVERVIEW YCBCR --config INTERLEAVE_OVERVIEW PIXEL input.tif  2 4 8 16 32 64

However, GDAL 2.2.0dev, released 2016/99/99 fails:

0...10...20...30...40...50...60...70...80...90.ERROR 1: JPEGLib:Huffman table 0x00 was not defined
ERROR 1: TIFFReadEncodedTile() failed.
ERROR 1: IReadBlock failed at X offset 0, Y offset 0
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
..100 - done.
Overview building failed.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/d3216fcd/attachment.html>

From kassies at gmail.com  Tue Dec 13 07:25:11 2016
From: kassies at gmail.com (Rutger)
Date: Tue, 13 Dec 2016 08:25:11 -0700 (MST)
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
	GeoTiff
In-Reply-To: <CAHNf2YTx+Uz0Y7FbUdsOm5+T8opi7gb1wjwa4Qx3nGb2y+CxVg@mail.gmail.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
 <1481624995057-5299666.post@n6.nabble.com>
 <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>
 <1481635038580-5299678.post@n6.nabble.com>
 <CAHNf2YTx+Uz0Y7FbUdsOm5+T8opi7gb1wjwa4Qx3nGb2y+CxVg@mail.gmail.com>
Message-ID: <1481642711248-5299702.post@n6.nabble.com>

Hey,

Yes, that looks good. Although instead of using the -1, i think its meant to
be the actual y-resolution as provided in the metadata, but i'm never 100%
sure on those things. Its tempting to ignore it in this case, since its so
close to 1, but imagine what will happen if they increase the resolution
after an upgrade. If you read the number of rows from the data, and use a
hard coded resolution, the geographical extent would change instead of the
resolution.
/
# geographic_geo_pixel_size_x
yres = -1.0000052 # km
xres = 1.0000013

# geographic_geo_column_offset
xoffset = 0
yoffset = 3649.9802

# geographic_geo_number_columns
ncol = 700
nrow = 765

ulx = xoffset * xres
uly = yoffset * yres
lrx = ulx + ncol * xres
lry = uly + nrow * yres
/
Which gives: 
(0.0, -3649.9991798970395, 700.0009100000001, -4415.003157897039)

You can also calculate them by transforming the given lat/lon corner
coordinates to the proj4 projection string given in the metadata. If i do
that as well, i get:
(0.0, -3649.9991119177544, 700.000903671186, -4415.003881997636)

Since both should be similar (there could be some rounding in the provided
corner coordinates), its a good way to check if you did it right.

The last thing to think about it what the coordinates are refering to, the
outer edge of the corner pixel, or the center of the corner pixel. Given
"geographic_geo_pixel_def=LU" in the metadata, i would guess it the actual
outer edge (which is GDAL-style as well).

Here is a Jupyter Notebook which i used (but nbviewer is down right now,
check it later):
http://nbviewer.jupyter.org/gist/RutgerK/70fe9d76d72b0fbfdeebda0568753828

And i have to apologize to Even for not using OSR's coordinate conversion in
that example. ;)


Regards,
Rutger


 




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-precipitation-accumulations-from-HDF5-to-GeoTiff-tp5299661p5299702.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kassies at gmail.com  Tue Dec 13 07:39:34 2016
From: kassies at gmail.com (Rutger)
Date: Tue, 13 Dec 2016 08:39:34 -0700 (MST)
Subject: [gdal-dev] Convert precipitation accumulations from HDF5 to
	GeoTiff
In-Reply-To: <1481642711248-5299702.post@n6.nabble.com>
References: <CAHNf2YQcQ5k+2c9HzWKLN+ampBEHUMC9oLiUcexRBmwM1-HT+Q@mail.gmail.com>
 <1481624995057-5299666.post@n6.nabble.com>
 <CAHNf2YTgLoj_fC6mezA+-g6s-_FTcWF0Rms70sgbSbxaMv8qAQ@mail.gmail.com>
 <1481635038580-5299678.post@n6.nabble.com>
 <CAHNf2YTx+Uz0Y7FbUdsOm5+T8opi7gb1wjwa4Qx3nGb2y+CxVg@mail.gmail.com>
 <1481642711248-5299702.post@n6.nabble.com>
Message-ID: <1481643574977-5299706.post@n6.nabble.com>

Sorry, what i said makes no sense at all. You shouldn't multiply the offset
with the y-resolution, although you should take the sign, like you did. Its
a bit strange that they provide the offset as a positive value. 


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Convert-precipitation-accumulations-from-HDF5-to-GeoTiff-tp5299661p5299706.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Dec 13 08:55:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Dec 2016 17:55:10 +0100
Subject: [gdal-dev] Creating JPEG compressed external overviews fails
In-Reply-To: <6088f347aaa743919a7dc69d5172f47c@C119S212VM022.msvyvi.vaha.local>
References: <6088f347aaa743919a7dc69d5172f47c@C119S212VM022.msvyvi.vaha.local>
Message-ID: <2444530.8L083Jkp4J@even-i700>

Hi Jukka,

Thanks for the report. Should now be fixed per r36849. This was introduced on Nov 24th. 
Crazy that the hundreds of existing tests didn't catch that, so I added a new one :-)

Even

> Hi,
> 
> This has worked for me and still works with GDAL version GDAL 2.0dev,
> released 2011/12/29 gdaladdo -r average -ro --config COMPRESS_OVERVIEW JPEG
> --config PHOTOMETRIC_OVERVIEW YCBCR --config INTERLEAVE_OVERVIEW PIXEL
> input.tif  2 4 8 16 32 64
> 
> However, GDAL 2.2.0dev, released 2016/99/99 fails:
> 
> 0...10...20...30...40...50...60...70...80...90.ERROR 1: JPEGLib:Huffman
> table 0x00 was not defined ERROR 1: TIFFReadEncodedTile() failed.
> ERROR 1: IReadBlock failed at X offset 0, Y offset 0
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
> ..100 - done.
> Overview building failed.
> 
> -Jukka Rahkonen-


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/e05a6804/attachment-0001.html>

From even.rouault at spatialys.com  Tue Dec 13 10:13:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Dec 2016 19:13:09 +0100
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <2857702.EmuknaLicI@even-i700>
References: <2857702.EmuknaLicI@even-i700>
Message-ID: <4958955.0M9DAnGDVB@even-i700>

On vendredi 9 décembre 2016 12:10:25 CET Even Rouault wrote:
> Hi,
> 
> There have been some good remarks, one regarding integration with GEOS that
> I've taken into account in the implementation, another one regarding the
> possibility to get indexed TIN that I think can be later added if needed.
> 
> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
> 
>     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> 
> Starting with my +1,

Friendly remainder that this motion is under vote.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/05889e67/attachment.html>

From andrew.bell.ia at gmail.com  Tue Dec 13 14:12:41 2016
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 13 Dec 2016 16:12:41 -0600
Subject: [gdal-dev] Error Handling (or not) in GTIFSetFromOGISDefn
Message-ID: <CACJ51z3aMH82uCiBGXEX+nnPuM=Hs7MLU2vtpoAgMfGzBihzqA@mail.gmail.com>

Hi,

I'm passing a WKT CRS into GTIFSetFromOGISDefn().  The WKT is valid in that
it conforms to the OGC representation v1.0 (12-063-r5).  The function
mentioned above parses the WKT into nodes properly, but the code that tries
to interpret the actual WKT can't deal with the new specification.
However, it doesn't error.  Instead, it sets a bunch of value to be
"user-defined" and results in Geotiff keys that don't map to the input CRS.

Is there a reason that a "bad" CRS is mapped as a user-defined value rather
than returning an error?  Is there a plan to update WKT code to handle the
new specification?

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161213/8cd2d40d/attachment.html>

From even.rouault at spatialys.com  Tue Dec 13 15:43:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Dec 2016 00:43:19 +0100
Subject: [gdal-dev] Error Handling (or not) in GTIFSetFromOGISDefn
In-Reply-To: <CACJ51z3aMH82uCiBGXEX+nnPuM=Hs7MLU2vtpoAgMfGzBihzqA@mail.gmail.com>
References: <CACJ51z3aMH82uCiBGXEX+nnPuM=Hs7MLU2vtpoAgMfGzBihzqA@mail.gmail.com>
Message-ID: <19246096.qF0IXOK1ku@even-i700>

Andrew,

> 
> I'm passing a WKT CRS into GTIFSetFromOGISDefn().  The WKT is valid in that
> it conforms to the OGC representation v1.0 (12-063-r5).  The function
> mentioned above parses the WKT into nodes properly, but the code that tries
> to interpret the actual WKT can't deal with the new specification.
> However, it doesn't error.  Instead, it sets a bunch of value to be
> "user-defined" and results in Geotiff keys that don't map to the input CRS.
> 
> Is there a reason that a "bad" CRS is mapped as a user-defined value rather
> than returning an error?

GDAL doesn't handle WKT 2 yet (the parsing of the WKT as a OGRSpatialReference object 
happens to work as both WKT 1 and 2 are serialized in similar way), so the current behaviour 
is not surprising. GTIFSetFromOGISDefn() should indeed probably error out if it identifies the 
WKT as WKT v2. Note that we don't want to reject all WKT that we don't recognize entirely, 
since the code can for example handle a WKT (v1) with a projection method it doesn't 
recognize as a ESRI WKT PE string.

> Is there a plan to update WKT code to handle the
> new specification?

Nobody is working on it as far as I know (it has been proposed as a potential subject in past 
GSoC programs), but that would be indeed neat to consider it. The big question is : how ? One 
of the possibilities would be to map WKT v2 as WKT v1 on ingestion, so that only affects a 
single part of the code. Another possibility would be to accept both in all places where GDAL 
handles WKT / OGRSpatialRefrence, but that means updating all drivers that map WKT to 
their own internal representation. None of them are really satisfactory. Or a third one would 
be to make WKT 2 the internal representation and WKT 1 just on import/export borders, but 
that also requires updating various drivers, and there would be some loss of information as 
WKT 1 has for example the TOWGS84 node that doesn't exist in WKT 2.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/80f11754/attachment.html>

From daniele.romagnoli at geo-solutions.it  Wed Dec 14 06:01:51 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed, 14 Dec 2016 15:01:51 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
Message-ID: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>

Hi List,
I'm investigating on some GeoTIFF data being produced with GDAL 1.11.3.
Basically, when setting COMPRESS=JPEG, the generated GTIFF has the 0th IFD
offset set to some KB.

these are the first 16 bytes of a GeoTIFF being generated like that:
49 49 2A 00 88 44 00 00 *10* 00 00 01 03 00 01

so:
49 49 is the endianness
00 2A is the magic number
00 00 44 88 is the offset of the 0th IFD = (17544 bytes)
Then there are several TAGs (baseline, extended and so on).
However, I think that any TIFF reader will jump to the 00 00 44 88 offset.
Moreover, the offset 00 00 00 08 (referring to the red bolded byte in my
previous sample) seems not referred by any other referencing IFD.

So it seems like that GeoTIFF has some useless bytes right after the first
8s.

I have then tried to use GDAL 2.2.1 and GDAL 2.1.0 and with that version I
see that the GeoTIFF being produced using same exact command is smaller and
the 0th IFD offset is 8 with these recent versions.
(This information is confirmed by AsTIFFTagViewer and TiffInfo too).

When activating CPL_DEBUG on all versions I see this output on GDAL
1.11.3/1.11.4 whilst I don't see it on GDAL 2.x

*GTiff: directory moved during flush in FlushDirectory()*

I have quickly checked some reference in the issue tracker but I was unable
to find anything, especially due to the fact that when searching for "IFD"
it returns hundreds of results related to "IFDefined" :-)

Do you have any feedback or comment on this?
Is it related to any bug in old code or some version update? (is a
different libtiff version somehow involved?)

Please, let me know.
Best Regards,
Daniele




-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/042ffb1b/attachment.html>

From vincent.bernat at magellium.fr  Wed Dec 14 06:21:39 2016
From: vincent.bernat at magellium.fr (Vincent BERNAT)
Date: Wed, 14 Dec 2016 14:21:39 +0000
Subject: [gdal-dev]  [gdal 2.1] reordering band
Message-ID: <1481725299592.77742@magellium.fr>

Hi all,


I got some products which have a wrong band ordering in raster but the good one in metadata.

In my c++ application, what are the gdal functions to call  to set the new band ordering ?

Is it possible?


Thanks.


Regards,

Vincent

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/81197d28/attachment-0001.html>

From even.rouault at spatialys.com  Wed Dec 14 06:23:41 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Dec 2016 15:23:41 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
Message-ID: <1742709.r98ED4cx7H@even-i700>

On mercredi 14 décembre 2016 15:01:51 CET Daniele Romagnoli wrote:
> Hi List,
> I'm investigating on some GeoTIFF data being produced with GDAL 1.11.3.
> Basically, when setting COMPRESS=JPEG, the generated GTIFF has the 0th IFD
> offset set to some KB.
> 
> these are the first 16 bytes of a GeoTIFF being generated like that:
> 49 49 2A 00 88 44 00 00 *10* 00 00 01 03 00 01
> 
> so:
> 49 49 is the endianness
> 00 2A is the magic number
> 00 00 44 88 is the offset of the 0th IFD = (17544 bytes)
> Then there are several TAGs (baseline, extended and so on).
> However, I think that any TIFF reader will jump to the 00 00 44 88 offset.
> Moreover, the offset 00 00 00 08 (referring to the red bolded byte in my
> previous sample) seems not referred by any other referencing IFD.
> 
> So it seems like that GeoTIFF has some useless bytes right after the first
> 8s.
> 
> I have then tried to use GDAL 2.2.1 and GDAL 2.1.0 and with that version I
> see that the GeoTIFF being produced using same exact command is smaller and
> the 0th IFD offset is 8 with these recent versions.
> (This information is confirmed by AsTIFFTagViewer and TiffInfo too).
> 
> When activating CPL_DEBUG on all versions I see this output on GDAL
> 1.11.3/1.11.4 whilst I don't see it on GDAL 2.x
> 
> *GTiff: directory moved during flush in FlushDirectory()*
> 
> I have quickly checked some reference in the issue tracker but I was unable
> to find anything, especially due to the fact that when searching for "IFD"
> it returns hundreds of results related to "IFDefined" :-)
> 
> Do you have any feedback or comment on this?
> Is it related to any bug in old code or some version update? (is a
> different libtiff version somehow involved?)

Yes this is an enhancement I did during 2.0 cycle.

I think it is linked to this NEWS item (although it is clearly not obvious), which brings other 
space enhancements:
 * for JPEG-compressed TIFF, avoid quantization tables to be emitted in each strip/tile and 
use optimized Huffman coding by default

Previously we indeed lost space since the IFD was written twice. The handling of JPEG 
quantization tables in libtiff is quite tricky, since they are emitted only when the first pixel is 
encoded, but at that time, you have already had to write a first version of the IFD without the 
tables. So the trick is to generate a in-memory very small JPEG-compressed TIFF with the 
same settings as the real image, extract the JpegTables tag from it, and apply it right away to 
the real IFD. Obvious, isn't it ;-) ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/aa7c705f/attachment.html>

From even.rouault at spatialys.com  Wed Dec 14 06:51:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Dec 2016 15:51:55 +0100
Subject: [gdal-dev] [gdal 2.1] reordering band
In-Reply-To: <1481725299592.77742@magellium.fr>
References: <1481725299592.77742@magellium.fr>
Message-ID: <3231758.OhdeXGTJQ5@even-i700>

On mercredi 14 décembre 2016 14:21:39 CET Vincent BERNAT wrote:
> Hi all,
> 
> 
> I got some products which have a wrong band ordering in raster but the good
> one in metadata.
> 
> In my c++ application, what are the gdal functions to call  to set the new
> band ordering ?
> 
> Is it possible?

Vincent,

Are you talking about the order of th band regarding their color interpretation ? You can 
indeed have Band 1 = Blue, Band 2 = Green, Band 3 = Red in some cases. GDAL drivers will not 
reorder them to be in R,G,B order. If you need this, you need to handle that at the application 
level, by for example issuing Dataset RasterIO with the 3,2,1 order. You could also create a 
VRT that reorder the bands.

gdal_translate -b 3 -b 2 -b 1 -of VRT in_bgr.tif out_rgb.vrt

(you can do that with GDALTranslate() API)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/ed841061/attachment.html>

From dmorissette at mapgears.com  Wed Dec 14 07:05:46 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 14 Dec 2016 10:05:46 -0500
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <4958955.0M9DAnGDVB@even-i700>
References: <2857702.EmuknaLicI@even-i700> <4958955.0M9DAnGDVB@even-i700>
Message-ID: <d6a82370-57b2-9943-8e44-dbefe06ad77a@mapgears.com>

+0 as I'm wondering if there could be a better way to handle this, i.e. 
it's not clear to me how useful it is to read/write those new geometry 
types without maintaining the (topological?) relationships between the 
objects. I am no expert with that type of data structures so my concerns 
may be completely invalid too and I have no alternative to offer, hence 
my +0.

Daniel

On 2016-12-13 1:13 PM, Even Rouault wrote:
> On vendredi 9 décembre 2016 12:10:25 CET Even Rouault wrote:
>
>> Hi,
>
>>
>
>> There have been some good remarks, one regarding integration with GEOS
> that
>
>> I've taken into account in the implementation, another one regarding the
>
>> possibility to get indexed TIN that I think can be later added if needed.
>
>>
>
>> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
>
>>
>
>> https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
>
>>
>
>> Starting with my +1,
>
>
>
> Friendly remainder that this motion is under vote.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From even.rouault at spatialys.com  Wed Dec 14 07:19:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Dec 2016 16:19:51 +0100
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <d6a82370-57b2-9943-8e44-dbefe06ad77a@mapgears.com>
References: <2857702.EmuknaLicI@even-i700> <4958955.0M9DAnGDVB@even-i700>
 <d6a82370-57b2-9943-8e44-dbefe06ad77a@mapgears.com>
Message-ID: <2337026.0mZLrI6kY7@even-i700>

On mercredi 14 décembre 2016 10:05:46 CET Daniel Morissette wrote:
> +0 as I'm wondering if there could be a better way to handle this, i.e.
> it's not clear to me how useful it is to read/write those new geometry
> types without maintaining the (topological?) relationships between the
> objects. I am no expert with that type of data structures so my concerns
> may be completely invalid too and I have no alternative to offer, hence
> my +0.

The Simple Feature model clearly doesn't maintain topological relationships. Topological 
consistency must be checked in a later stage with a IsValid() call for example (this also holds 
true for already handled geometry types). And if you look at some drivers that implement 
TIN currenlty like PostGIS or GML, they are based on the Simple Feature model as well. Only 
shapefile/filegdb has something a bit stronger with shared nodes.

I think that support for topological geometries would be a completely different concept to 
be added in OGR. Would require management of nodes, edges and faces, and conversions 
between simple feature geometries and topogeometries. I had some preliminary discussions 
about that with an interested party in the past but they didn't go further.

In the current state of things, the TIN support should be hopefully good enough for 
conversions between PostGIS, GML, DXF and shapefile/filegdb.

Even

> 
> Daniel
> 
> On 2016-12-13 1:13 PM, Even Rouault wrote:
> > On vendredi 9 décembre 2016 12:10:25 CET Even Rouault wrote:
> >> Hi,
> >> 
> >> 
> >> 
> >> There have been some good remarks, one regarding integration with GEOS
> > 
> > that
> > 
> >> I've taken into account in the implementation, another one regarding the
> >> 
> >> possibility to get indexed TIN that I think can be later added if needed.
> >> 
> >> 
> >> 
> >> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
> >> 
> >> 
> >> 
> >> https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> >> 
> >> 
> >> 
> >> Starting with my +1,
> > 
> > Friendly remainder that this motion is under vote.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161214/f9f9a951/attachment-0001.html>

From dmorissette at mapgears.com  Wed Dec 14 07:42:32 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 14 Dec 2016 10:42:32 -0500
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <2337026.0mZLrI6kY7@even-i700>
References: <2857702.EmuknaLicI@even-i700> <4958955.0M9DAnGDVB@even-i700>
 <d6a82370-57b2-9943-8e44-dbefe06ad77a@mapgears.com>
 <2337026.0mZLrI6kY7@even-i700>
Message-ID: <7dbb3249-c211-2102-4d9f-27441ea592a0@mapgears.com>

Thank you for the clarification. Since those changes are useful by 
themselves then I change my vote to +1

Daniel


On 2016-12-14 10:19 AM, Even Rouault wrote:
> On mercredi 14 décembre 2016 10:05:46 CET Daniel Morissette wrote:
>
>> +0 as I'm wondering if there could be a better way to handle this, i.e.
>
>> it's not clear to me how useful it is to read/write those new geometry
>
>> types without maintaining the (topological?) relationships between the
>
>> objects. I am no expert with that type of data structures so my concerns
>
>> may be completely invalid too and I have no alternative to offer, hence
>
>> my +0.
>
>
>
> The Simple Feature model clearly doesn't maintain topological
> relationships. Topological consistency must be checked in a later stage
> with a IsValid() call for example (this also holds true for already
> handled geometry types). And if you look at some drivers that implement
> TIN currenlty like PostGIS or GML, they are based on the Simple Feature
> model as well. Only shapefile/filegdb has something a bit stronger with
> shared nodes.
>
>
>
> I think that support for topological geometries would be a completely
> different concept to be added in OGR. Would require management of nodes,
> edges and faces, and conversions between simple feature geometries and
> topogeometries. I had some preliminary discussions about that with an
> interested party in the past but they didn't go further.
>
>
>
> In the current state of things, the TIN support should be hopefully good
> enough for conversions between PostGIS, GML, DXF and shapefile/filegdb.
>
>
>
> Even
>
>
>
>>
>
>> Daniel
>
>>
>
>> On 2016-12-13 1:13 PM, Even Rouault wrote:
>
>> > On vendredi 9 décembre 2016 12:10:25 CET Even Rouault wrote:
>
>> >> Hi,
>
>> >>
>
>> >>
>
>> >>
>
>> >> There have been some good remarks, one regarding integration with GEOS
>
>> >
>
>> > that
>
>> >
>
>> >> I've taken into account in the implementation, another one
> regarding the
>
>> >>
>
>> >> possibility to get indexed TIN that I think can be later added if
> needed.
>
>> >>
>
>> >>
>
>> >>
>
>> >> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
>
>> >>
>
>> >>
>
>> >>
>
>> >> https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
>
>> >>
>
>> >>
>
>> >>
>
>> >> Starting with my +1,
>
>> >
>
>> > Friendly remainder that this motion is under vote.
>
>> >
>
>> >
>
>> >
>
>> > Even
>
>> >
>
>> >
>
>> >
>
>> > --
>
>> >
>
>> > Spatialys - Geospatial professional services
>
>> >
>
>> > http://www.spatialys.com
>
>> >
>
>> >
>
>> >
>
>> > _______________________________________________
>
>> > gdal-dev mailing list
>
>> > gdal-dev at lists.osgeo.org
>
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From howard at hobu.co  Wed Dec 14 13:00:45 2016
From: howard at hobu.co (Howard Butler)
Date: Wed, 14 Dec 2016 15:00:45 -0600
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
 Polyhedral surface and TIN
In-Reply-To: <2857702.EmuknaLicI@even-i700>
References: <2857702.EmuknaLicI@even-i700>
Message-ID: <9149D376-BC54-49B0-924A-8EB64864CA2E@hobu.co>


> On Dec 9, 2016, at 5:10 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
>  
> There have been some good remarks, one regarding integration with GEOS that I've taken into account in the implementation, another one regarding the possibility to get indexed TIN that I think can be later added if needed.
>  
> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
>  
>     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
>  
> Starting with my +1,

+1


From issworld2000 at yahoo.com  Wed Dec 14 16:04:50 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Thu, 15 Dec 2016 00:04:50 +0000 (UTC)
Subject: [gdal-dev] shortest path or networks in GDAL
References: <1014526123.3295626.1481760290930.ref@mail.yahoo.com>
Message-ID: <1014526123.3295626.1481760290930@mail.yahoo.com>

I am wondering if it is possible to perform the shortest path or network analysis in Windows version of GDAL?
I googled and found gnmanalyse page on GDAL website, which seems to be able to do that:
http://www.gdal.org/gnmanalyse.html

But is this gnmanalyse functionality available only through GDAL C#/python binaries?

I can not access it directly by running GDAL Windows .exe files?

Thank you for the reply.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161215/1755560c/attachment.html>

From even.rouault at spatialys.com  Thu Dec 15 05:19:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 15 Dec 2016 14:19:07 +0100
Subject: [gdal-dev] Motion: adopt RFC 64: Triangle,
	Polyhedral surface and TIN
In-Reply-To: <2857702.EmuknaLicI@even-i700>
References: <2857702.EmuknaLicI@even-i700>
Message-ID: <2413038.jY22rgSGkX@even-i700>

On vendredi 9 décembre 2016 12:10:25 CET Even Rouault wrote:
> Hi,
> 
> There have been some good remarks, one regarding integration with GEOS that
> I've taken into account in the implementation, another one regarding the
> possibility to get indexed TIN that I think can be later added if needed.
> 
> So I move to adopt RFC 64: Triangle, Polyhedral surface and TIN
> 
>     https://trac.osgeo.org/gdal/wiki/rfc64_triangle_polyhedralsurface_tin
> 

I declare this motion passed with +1 from JukkaR, DanielM, HowardB and myself.

I will proceed to merge into trunk.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161215/4b48c5fb/attachment.html>

From esacree at knology.net  Thu Dec 15 15:55:05 2016
From: esacree at knology.net (esacree)
Date: Thu, 15 Dec 2016 16:55:05 -0700 (MST)
Subject: [gdal-dev] VirtualEarth Style Parameter in GDAL C++
Message-ID: <1481846105491-5300088.post@n6.nabble.com>


Is it possible to change the map style on the VirtualEarth in GDAL?

The current example shows the Aerial Map Style:
http://a${server_num}.ortho.tiles.virtualearth.net/tiles/a${quadkey}.jpeg?g=90"

Is it possible to get the other Bing/VirtualEarth map styles like the road
view or road view with labels?
Is the style controlled by the "a" parameter following the http:://?

What does the g=90 mean?  Is g the direction angle?  (90 being East?).

Thanks!

Elaine



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/VirtualEarth-Style-Parameter-in-GDAL-C-tp5300088.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bishop.dev at gmail.com  Thu Dec 15 22:37:53 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Fri, 16 Dec 2016 09:37:53 +0300
Subject: [gdal-dev] shortest path or networks in GDAL
In-Reply-To: <1014526123.3295626.1481760290930@mail.yahoo.com>
References: <1014526123.3295626.1481760290930.ref@mail.yahoo.com>
 <1014526123.3295626.1481760290930@mail.yahoo.com>
Message-ID: <08cf0f5e-9464-50f3-9137-7b43ff5429e8@gmail.com>

Hi Djordje,

Default build of GNM in GDAL was enabled recently. I think this build is 
not available by GISInternals.

Try our (NextGIS) own build of GDAL from here: http://nextgis.com/borsch/

Best regards,
     Dmitry

15.12.16 3:04, Djordje Spasic пишет:
> I am wondering if it is possible to perform the shortest path or 
> network analysis in Windows version of GDAL 
> <http://www.gisinternals.com/release.php>?
> I googled and found gnmanalyse page on GDAL website, which seems to be 
> able to do that:
> http://www.gdal.org/gnmanalyse.html
>
> But is this gnmanalyse functionality available only through GDAL 
> C#/python binaries?
>
> I can not access it directly by running GDAL Windows .exe files?
>
> Thank you for the reply.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/3cef3fa2/attachment.html>

From daniele.romagnoli at geo-solutions.it  Fri Dec 16 04:05:31 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Fri, 16 Dec 2016 13:05:31 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <1742709.r98ED4cx7H@even-i700>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <1742709.r98ED4cx7H@even-i700>
Message-ID: <CAJaHrDxkr-uzDBFL9C0xDZgffZSKgcCXmZHGqrA7=m+MaryDMQ@mail.gmail.com>

Hi Even,
thanks for the feedback!

Since I'm here, I'm bothering you again with another question.
I have regenerated that GeoTIFF using GDAL 2.1.2.
Right now there isn't a useless IFD at the beginning anymore, due to the
improvement you was talking about.
While still checking the data bytes (with an Hex editor and a calculator,
... doh!) I have noticed that there is an unused bytes section between the
last data tile of the main page and the first byte of the second page (it's
a GeoTIFF with overviews).

Here below, some numbers to make you lost :-) You can skip them and go to
the "--------" section.

So the latest TileOffsets of page1 is 0x6BF9, the latest TileByteCounts is
0x095D resulting into last byte for Page1 is 0x7555.
The next referred IFD is 0xBBF0 which for the TileOffsets refer back the
0x7A64 byte.
Checking IFD, TAGs and what else, there is some useless bytes in the range
0x7556-0x7A63.
Going to 0x7556 I have found 13 TAG Definitions (some of them are also
TileOffsets/TileByteCounts Tag referring to an address containing nothing).
----------
Wondering if when generating overviews we still have a problem similar to
the one you have fixed in 2.0 or some data-updating issue.

These are my hypothesis on what is going on.
A simple translate with no overviews makes the file ending at 0x7555 with
offset of next IFD saying 0x0000.
When you add overviews, it writes a new IFD at 0x7556 with TAG entries,
then it encodes something and then it writes a new IFD.
At the end, it goes back updating the offset of the 1st overview IFD
(0xBBF0) making the one at 0x7556 being not referred anymore.
Does it make sense?

Please let me know and sorry for all these numbers.
Daniele






On Wed, Dec 14, 2016 at 3:23 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 14 décembre 2016 15:01:51 CET Daniele Romagnoli wrote:
>
> > Hi List,
>
> > I'm investigating on some GeoTIFF data being produced with GDAL 1.11.3.
>
> > Basically, when setting COMPRESS=JPEG, the generated GTIFF has the 0th
> IFD
>
> > offset set to some KB.
>
> >
>
> > these are the first 16 bytes of a GeoTIFF being generated like that:
>
> > 49 49 2A 00 88 44 00 00 *10* 00 00 01 03 00 01
>
> >
>
> > so:
>
> > 49 49 is the endianness
>
> > 00 2A is the magic number
>
> > 00 00 44 88 is the offset of the 0th IFD = (17544 bytes)
>
> > Then there are several TAGs (baseline, extended and so on).
>
> > However, I think that any TIFF reader will jump to the 00 00 44 88
> offset.
>
> > Moreover, the offset 00 00 00 08 (referring to the red bolded byte in my
>
> > previous sample) seems not referred by any other referencing IFD.
>
> >
>
> > So it seems like that GeoTIFF has some useless bytes right after the
> first
>
> > 8s.
>
> >
>
> > I have then tried to use GDAL 2.2.1 and GDAL 2.1.0 and with that version
> I
>
> > see that the GeoTIFF being produced using same exact command is smaller
> and
>
> > the 0th IFD offset is 8 with these recent versions.
>
> > (This information is confirmed by AsTIFFTagViewer and TiffInfo too).
>
> >
>
> > When activating CPL_DEBUG on all versions I see this output on GDAL
>
> > 1.11.3/1.11.4 whilst I don't see it on GDAL 2.x
>
> >
>
> > *GTiff: directory moved during flush in FlushDirectory()*
>
> >
>
> > I have quickly checked some reference in the issue tracker but I was
> unable
>
> > to find anything, especially due to the fact that when searching for
> "IFD"
>
> > it returns hundreds of results related to "IFDefined" :-)
>
> >
>
> > Do you have any feedback or comment on this?
>
> > Is it related to any bug in old code or some version update? (is a
>
> > different libtiff version somehow involved?)
>
>
>
> Yes this is an enhancement I did during 2.0 cycle.
>
>
>
> I think it is linked to this NEWS item (although it is clearly not
> obvious), which brings other space enhancements:
>
> * for JPEG-compressed TIFF, avoid quantization tables to be emitted in
> each strip/tile and use optimized Huffman coding by default
>
>
>
> Previously we indeed lost space since the IFD was written twice. The
> handling of JPEG quantization tables in libtiff is quite tricky, since they
> are emitted only when the first pixel is encoded, but at that time, you
> have already had to write a first version of the IFD without the tables. So
> the trick is to generate a in-memory very small JPEG-compressed TIFF with
> the same settings as the real image, extract the JpegTables tag from it,
> and apply it right away to the real IFD. Obvious, isn't it ;-) ?
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/5e5b2bdc/attachment-0001.html>

From even.rouault at spatialys.com  Fri Dec 16 04:52:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Dec 2016 13:52:27 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDxkr-uzDBFL9C0xDZgffZSKgcCXmZHGqrA7=m+MaryDMQ@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <1742709.r98ED4cx7H@even-i700>
 <CAJaHrDxkr-uzDBFL9C0xDZgffZSKgcCXmZHGqrA7=m+MaryDMQ@mail.gmail.com>
Message-ID: <5533045.SmJALounZ5@even-i700>

> Wondering if when generating overviews we still have a problem similar to
> the one you have fixed in 2.0 or some data-updating issue.
> 
> These are my hypothesis on what is going on.
> A simple translate with no overviews makes the file ending at 0x7555 with
> offset of next IFD saying 0x0000.
> When you add overviews, it writes a new IFD at 0x7556 with TAG entries,
> then it encodes something and then it writes a new IFD.
> At the end, it goes back updating the offset of the 1st overview IFD
> (0xBBF0) making the one at 0x7556 being not referred anymore.
> Does it make sense?
> 

With JPEG compression right ? I do reproduce something similar to your findings in 2.1 
indeed. This no longer happens in trunk due to related improvements (https://
trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in the last couple of weeks (using 
the same trick of creating a in-memory TIFF file to get the JPEG tables and set them direcly 
on the overview IFD at creation time).

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/de8c4eb8/attachment.html>

From daniele.romagnoli at geo-solutions.it  Fri Dec 16 05:29:10 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Fri, 16 Dec 2016 14:29:10 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <5533045.SmJALounZ5@even-i700>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <1742709.r98ED4cx7H@even-i700>
 <CAJaHrDxkr-uzDBFL9C0xDZgffZSKgcCXmZHGqrA7=m+MaryDMQ@mail.gmail.com>
 <5533045.SmJALounZ5@even-i700>
Message-ID: <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>

On Fri, Dec 16, 2016 at 1:52 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
>
> > Wondering if when generating overviews we still have a problem similar to
>
> > the one you have fixed in 2.0 or some data-updating issue.
>
> >
>
> > These are my hypothesis on what is going on.
>
> > A simple translate with no overviews makes the file ending at 0x7555 with
>
> > offset of next IFD saying 0x0000.
>
> > When you add overviews, it writes a new IFD at 0x7556 with TAG entries,
>
> > then it encodes something and then it writes a new IFD.
>
> > At the end, it goes back updating the offset of the 1st overview IFD
>
> > (0xBBF0) making the one at 0x7556 being not referred anymore.
>
> > Does it make sense?
>
> >
>
>
>
> With JPEG compression right ?
>
Right,
Indeed, before sending my previous email I have also tried with:
*gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
PHOTOMETRIC_OVERVIEW RGB*
to understand if it was related to JPEG only but, even with these options,
the output overviews were jpeg compressed (I assume there is some kind of
coherency check in gdaladdo).



> I do reproduce something similar to your findings in 2.1 indeed. This no
> longer happens in trunk due to related improvements (
> https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in the
> last couple of weeks (using the same trick of creating a in-memory TIFF
> file to get the JPEG tables and set them direcly on the overview IFD at
> creation time).
>
>
>
Do you think this will be available in other series or does it introduce
new API/major changes which makes it available on 2.2.x only?
Thanks again for your precious feedbacks.

Cheers,
Daniele


> Even
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/099ea9b8/attachment.html>

From even.rouault at spatialys.com  Fri Dec 16 05:48:25 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Dec 2016 14:48:25 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
	JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <5533045.SmJALounZ5@even-i700>
 <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>
Message-ID: <7413075.dPIrFvsHGm@even-i700>

> Right,
> Indeed, before sending my previous email I have also tried with:
> *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
> PHOTOMETRIC_OVERVIEW RGB*
> to understand if it was related to JPEG only but, even with these options,
> the output overviews were jpeg compressed (I assume there is some kind of
> coherency check in gdaladdo).

With internal overviews, the _OVERVIEW configuration options are ignored. Their value is 
deduced from the settings of the main IFD. I don't think there's a strong technical reason for 
that. Mostly a side effect of the fact that there are slightly different code paths to handle 
creation of internal and external overviews, and the reading of _OVERVIEW config options is 
done only in the external overview code path.

> 
> > I do reproduce something similar to your findings in 2.1 indeed. This no
> > longer happens in trunk due to related improvements (
> > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in the
> > last couple of weeks (using the same trick of creating a in-memory TIFF
> > file to get the JPEG tables and set them direcly on the overview IFD at
> > creation time).
> 
> Do you think this will be available in other series or does it introduce
> new API/major changes which makes it available on 2.2.x only?

No API change, but this is in the improvement category rather than bugfixing, and my first 
changeset resulted in some corrupted images in some situations, which was unnoticed for a 
few weeks, so that's a sign that it is a somewhat risky change (the GeoTIFF driver is a complex 
beast), not worth the trouble of breaking stable branches.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/16d5a69d/attachment-0001.html>

From daniele.romagnoli at geo-solutions.it  Fri Dec 16 05:56:50 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Fri, 16 Dec 2016 14:56:50 +0100
Subject: [gdal-dev] Question on 0th IFD offset when producing a
 JPEG-Compressed GeoTIFF (GDAL 1.11 vs 2.x)
In-Reply-To: <7413075.dPIrFvsHGm@even-i700>
References: <CAJaHrDwPP5_1_+oTAi2u=reSYRbjWhb2cKyREXFe0sLfB3XUVQ@mail.gmail.com>
 <5533045.SmJALounZ5@even-i700>
 <CAJaHrDxNew_OffFTXMBkdQut=Mrok=O+=037jEYfrSuO_x5xqw@mail.gmail.com>
 <7413075.dPIrFvsHGm@even-i700>
Message-ID: <CAJaHrDx0K6zgyktOV9-KDMNhxGEHrpGDLj7mSzDCJCn489TNLQ@mail.gmail.com>

On Fri, Dec 16, 2016 at 2:48 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

>
>
> > Right,
>
> > Indeed, before sending my previous email I have also tried with:
>
> > *gdaladdo -r average --config COMPRESS_OVERVIEW DEFLATE --config
>
> > PHOTOMETRIC_OVERVIEW RGB*
>
> > to understand if it was related to JPEG only but, even with these
> options,
>
> > the output overviews were jpeg compressed (I assume there is some kind of
>
> > coherency check in gdaladdo).
>
>
>
> With internal overviews, the _OVERVIEW configuration options are ignored.
> Their value is deduced from the settings of the main IFD.
>
It makes sense, indeed.


> I don't think there's a strong technical reason for that. Mostly a side
> effect of the fact that there are slightly different code paths to handle
> creation of internal and external overviews, and the reading of _OVERVIEW
> config options is done only in the external overview code path.
>
>
>
> >
>
> > > I do reproduce something similar to your findings in 2.1 indeed. This
> no
>
> > > longer happens in trunk due to related improvements (
>
> > > https://trac.osgeo.org/gdal/wiki/CloudOptimizedGeoTIFF), I made in the
>
> > > last couple of weeks (using the same trick of creating a in-memory TIFF
>
> > > file to get the JPEG tables and set them direcly on the overview IFD at
>
> > > creation time).
>
> >
>
> > Do you think this will be available in other series or does it introduce
>
> > new API/major changes which makes it available on 2.2.x only?
>
>
>
> No API change, but this is in the improvement category rather than
> bugfixing, and my first changeset resulted in some corrupted images in some
> situations, which was unnoticed for a few weeks, so that's a sign that it
> is a somewhat risky change (the GeoTIFF driver is a complex beast), not
> worth the trouble of breaking stable branches.
>
Understood. thanks for the feedback.
Cheers,
Daniele


>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/2b0177c5/attachment.html>

From luc.vanlinden at gmail.com  Fri Dec 16 07:52:19 2016
From: luc.vanlinden at gmail.com (lucvanlinden)
Date: Fri, 16 Dec 2016 08:52:19 -0700 (MST)
Subject: [gdal-dev] DWG_driver in compiled version available?
Message-ID: <1481903539611-5300170.post@n6.nabble.com>

Hi

Is this https://trac.osgeo.org/gdal/wiki/DWG_driver
work also available in a (windows) compiled version of GDAL/OGR?

tx


Luc



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/DWG-driver-in-compiled-version-available-tp5300170.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Dec 16 07:57:30 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Dec 2016 16:57:30 +0100
Subject: [gdal-dev] DWG_driver in compiled version available?
In-Reply-To: <1481903539611-5300170.post@n6.nabble.com>
References: <1481903539611-5300170.post@n6.nabble.com>
Message-ID: <7642274.fBCOebOkuj@even-i700>

On vendredi 16 décembre 2016 08:52:19 CET you wrote:
> Hi
> 
> Is this https://trac.osgeo.org/gdal/wiki/DWG_driver
> work also available in a (windows) compiled version of GDAL/OGR?

It is available in the MSVC 2013 builds (requires a C++11 compiler) at:
http://gisinternals.com/development.php

> 
> tx
> 
> 
> Luc
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/DWG-driver-in-compiled-version-availabl
> e-tp5300170.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/265496df/attachment.html>

From even.rouault at spatialys.com  Fri Dec 16 08:37:22 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Dec 2016 17:37:22 +0100
Subject: [gdal-dev] Fwd: [Projects] Budgeting project event support for 2017
Message-ID: <1672408.rbHrtlkYkO@even-i700>

Hi,

below an invitation from the OSGeo board for projects to mention their budget needs for 
2017.
We could potentially ask for funds to cover, at least partially, expenses of people who attend 
code sprints (not completely sure if funds can be allocated for that), like the Daytona code 
sprint in February (I won't be able to attend unfortunately). Who might be interested in such 
a support ?
Any other ideas ?

Even

----------  Forwarded Message  ----------

Subject: [Projects] Budgeting project event support for 2017
Date: jeudi 15 décembre 2016, 23:03:34 CET
From: Anita Graser <anitagraser at gmx.at>
To: projects at lists.osgeo.org

Dear OSGeo project members,

It is this time of the year, OSGeo is looking forward to 2017. Over the
previous years, OSGeo has been proud to support a growing number of project
events, such as code sprints, developer meetings, and user conferences.

To plan for next year, the OSGeo board is reaching out to all committees,
including PSCs. We would like to ask you to help us with proposals for you
planned event support requests for 2017. This information will help us to
set aside a realistic amount of funds.

Please join GRASS, QGIS, Geoserver, and the ZOO-Project and send me your
requests or add them to the budget draft yourself at:

https://wiki.osgeo.org/wiki/OSGeo_Budget_2017#Draft_2017_Budget

ideally until Monday Dec, 19th.

Thank you and best wishes,

Anita Graser
OSGeo Board

-----------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/ed998526/attachment-0001.html>

From esacree at knology.net  Fri Dec 16 12:14:37 2016
From: esacree at knology.net (esacree)
Date: Fri, 16 Dec 2016 13:14:37 -0700 (MST)
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
 bad capabilities
In-Reply-To: <1480535757783-5298089.post@n6.nabble.com>
References: <1480535757783-5298089.post@n6.nabble.com>
Message-ID: <1481919277392-5300212.post@n6.nabble.com>


Even,

I tried the daily build from 9-Dec-2016.  The new ZoomLevel parameter is
there and the value is extracted.  Unfortunately, GDAL is still using the
maximum tile level from the capabilities document.

USGS hasn't responded to my request to fix their capabilities documents. 
ESRI's world time zones WMTS server appears to have the same problem.  The
capabilities advertises more zoom levels than are available.

Elaine



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/WMTS-Need-TileLevel-option-Servers-responding-with-bad-capabilities-tp5298089p5300212.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Dec 16 12:45:04 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Dec 2016 21:45:04 +0100
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
	bad capabilities
In-Reply-To: <1481919277392-5300212.post@n6.nabble.com>
References: <1480535757783-5298089.post@n6.nabble.com>
 <1481919277392-5300212.post@n6.nabble.com>
Message-ID: <2737766.KQTCTgvQU2@even-i700>

On vendredi 16 décembre 2016 13:14:37 CET esacree wrote:
> Even,
> 
> I tried the daily build from 9-Dec-2016.  The new ZoomLevel parameter is
> there and the value is extracted.  Unfortunately, GDAL is still using the
> maximum tile level from the capabilities document.

That works fine for me. Could you share your .xml ?

Eve

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161216/f2a06d42/attachment.html>

From aman at thakral.ca  Sat Dec 17 14:13:38 2016
From: aman at thakral.ca (Aman Thakral)
Date: Sat, 17 Dec 2016 14:13:38 -0800
Subject: [gdal-dev] SystemErrors when running GDAL with python3 bindings
Message-ID: <CAAGkx0vndxNAwrfdHpB4Vs_941Z9xVs=sxZEXqsTwMBVK6ELjw@mail.gmail.com>

Hi All,

I'm trying to add python3 support to a personal project:

https://github.com/granularag/pyspatial/tree/feature/python2_3_support

My unit tests pass with python2, but fail with python3.  I'm getting the
following errors:

StopIteration

During handling of the above exception, another exception occurred:

SystemError: <built-in function delete_SpatialReference> returned a result
with an error set

During handling of the above exception, another exception occurred:

SystemError: <built-in function delete_Geometry> returned a result with an
error set

I recently compiled a local GDAL 2.1.2 and am running the tests as follows:

#!/bin/bash
set -e
set -x

export GDAL_HOME=$HOME/local
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$GDAL_HOME/lib
nosetests -v

Has anyone see these errors before?  My system wide gdal is 1.11.2 that I
am using for python 2.  I tried using my system wide GDAL with python3 as
well, but get the same errors.

Not sure what the difference is here between the python2 and python3
versions.

My python versions are 2.7 and 3.5.

Is this a known problem?  Any help would be greatly appreciated.

Thanks!
Aman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161217/e2372cb9/attachment.html>

From even.rouault at spatialys.com  Sat Dec 17 14:16:04 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 17 Dec 2016 23:16:04 +0100
Subject: [gdal-dev] SystemErrors when running GDAL with python3 bindings
In-Reply-To: <CAAGkx0vndxNAwrfdHpB4Vs_941Z9xVs=sxZEXqsTwMBVK6ELjw@mail.gmail.com>
References: <CAAGkx0vndxNAwrfdHpB4Vs_941Z9xVs=sxZEXqsTwMBVK6ELjw@mail.gmail.com>
Message-ID: <1622520.thqCunYXNQ@even-i700>

On samedi 17 décembre 2016 14:13:38 CET Aman Thakral wrote:
> Hi All,
> 
> I'm trying to add python3 support to a personal project:
> 
> https://github.com/granularag/pyspatial/tree/feature/python2_3_support
> 
> Has anyone see these errors before?  My system wide gdal is 1.11.2 that I
> am using for python 2.  I tried using my system wide GDAL with python3 as
> well, but get the same errors.
> 
> Not sure what the difference is here between the python2 and python3
> versions.
> 
> My python versions are 2.7 and 3.5.
> 
> Is this a known problem?  Any help would be greatly appreciated.

This has been reported last week and fixed in trunk per
https://trac.osgeo.org/gdal/ticket/6749

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161217/4ad74825/attachment.html>

From eduardosilverio1990 at gmail.com  Sat Dec 17 15:04:18 2016
From: eduardosilverio1990 at gmail.com (Eduardo Silverio da Silva)
Date: Sat, 17 Dec 2016 21:04:18 -0200
Subject: [gdal-dev] Questionnaire about Geoprocessing Algorithms
Message-ID: <CAEazUve5uSUfY3=NSXeCb2JC+87MgrqHm-rpqPUZwmb3Z-OZyg@mail.gmail.com>

Hello gdal-dev Osgeo members,

Here is Eduardo Silverio da Silva, from UFPR in Curitiba, Brazil. I am a
master's student in Geodetic Sciences.
I am contacting this community because I would like some help to answer and
to share my questionnaire about geoprocessing algorithms/codes:

English version:
https://goo.gl/forms/KnqCcLSvJEVcTtLM2

Spanish version:
https://goo.gl/forms/2K9A04nwMORbafBe2

Portuguese version:
https://goo.gl/forms/EMtNDOdw5MIL8KmP2

To answer, the person must be from the ​​Geosciences area
(Cartography/Surveying, Geography, Forestry, Geology, Geophysics,
Oceanography, Agronomy)
or anyone who has already used some GIS (ArcGIS, QGIS, etc).

Merry Christmas and Happy New Year!


-- 
Eduardo Silverio da Silva
Mestrando em Ciências Geodésicas na Universidade Federal do Paraná
Engenheiro Cartógrafo e Agrimensor
+55 41 99873-6274
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161217/50815cc6/attachment.html>

From mofoyoda at gmail.com  Mon Dec 19 03:49:37 2016
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Mon, 19 Dec 2016 14:49:37 +0300
Subject: [gdal-dev] GDAL doesn't read GeoTiff .msk mask file
Message-ID: <E8951863-F7A4-46D1-B566-840C388277F5@gmail.com>

Hello gdal devs!

I’ve got an 8-bit 3-band (RGB) GeoTiff file created in ArcGIS and it has a mask file (myfile.tif.msk) along with it, indicating which pixels have "nodata" value. When viewing it in ArcMap, I get “nodata” for masked pixels. But when viewing in QGIS, I get an unmasked raster and masked pixels return pixel values of R G and B bands. Gdalinfo doesn’t return a .tif.msk file in a list of dataset files (however it does return .aux.xml).

My goal is to add an internal mask band to GeoTiff files, so everything is packed within one file, and create a VRT mosaic afterwards. Another option is to use .tif.msk file as is. But I can’t find any options to gdal_translate, or gdalinfo to force gdal use the mask file. There isn’t much gdal documentation regarding .msk files. How can I read mask file with gdal and convert my initial RGB GeoTiff to a GeoTiff with a mask band from it?

Cheers,
Nick

From even.rouault at spatialys.com  Mon Dec 19 04:38:04 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Dec 2016 13:38:04 +0100
Subject: [gdal-dev] GDAL doesn't read GeoTiff .msk mask file
In-Reply-To: <E8951863-F7A4-46D1-B566-840C388277F5@gmail.com>
References: <E8951863-F7A4-46D1-B566-840C388277F5@gmail.com>
Message-ID: <2468975.cBTvPvHcPc@even-i700>

Nikolai,

> 
> I’ve got an 8-bit 3-band (RGB) GeoTiff file created in ArcGIS and it has a
> mask file (myfile.tif.msk) along with it, indicating which pixels have
> "nodata" value. When viewing it in ArcMap, I get “nodata” for masked
> pixels. But when viewing in QGIS, I get an unmasked raster and masked
> pixels return pixel values of R G and B bands. Gdalinfo doesn’t return a
> .tif.msk file in a list of dataset files (however it does return .aux.xml).

If you look at a valid .msk file generated by GDAL, you'll see INTERNAL_MASK_FLAGS_x
metadata item being reported. If there's no INTERNAL_MASK_FLAGS_x for band x,
then GDAL will ignore the .msk file for this band.

$ gdalinfo with_mask.tif.msk
Driver: GTiff/GeoTIFF
Files: with_mask.tif.msk
Size is 50, 50
Coordinate System is `'
Metadata:
  INTERNAL_MASK_FLAGS_1=2
  INTERNAL_MASK_FLAGS_2=2
  INTERNAL_MASK_FLAGS_3=2
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,   50.0)
Upper Right (   50.0,    0.0)
Lower Right (   50.0,   50.0)
Center      (   25.0,   25.0)
Band 1 Block=50x50 Type=Byte, ColorInterp=Gray


The 2 here comes from the following GMF_ enumeration and so means that it
is a mask valid for all the bands of the dataset.

/** Flag returned by GDALGetMaskFlags() to indicate that all pixels are valid */
#define GMF_ALL_VALID     0x01
/** Flag returned by GDALGetMaskFlags() to indicate that the mask band is
 * valid for all bands */
#define GMF_PER_DATASET   0x02
/** Flag returned by GDALGetMaskFlags() to indicate that the mask band is
 * an alpha band */
#define GMF_ALPHA         0x04
/** Flag returned by GDALGetMaskFlags() to indicate that the mask band is
 * computed from nodata values */
#define GMF_NODATA        0x08

You can add this flag with gdal_translate :

gdal_translate my_invalid.tif.msk my_valid.tif.msk -co COMPRESS=DEFLATE \
 -mo INTERNAL_MASK_FLAGS_1=2 -mo INTERNAL_MASK_FLAGS_2=2 -mo INTERNAL_MASK_FLAGS_3=2


> 
> My goal is to add an internal mask band to GeoTiff files, so everything is
> packed within one file, and create a VRT mosaic afterwards. Another option
> is to use .tif.msk file as is. But I can’t find any options to
> gdal_translate, or gdalinfo to force gdal use the mask file. There isn’t
> much gdal documentation regarding .msk files. 

See:
https://trac.osgeo.org/gdal/wiki/rfc15_nodatabitmask
http://gdal.org/frmt_gtiff.html ("Internal nodata masks" section)

But it is true that the details of .msk files were not mentionned. I've just
improved that withhttps://trac.osgeo.org/gdal/changeset/36955 and
https://trac.osgeo.org/gdal/wiki/rfc15_nodatabitmask?action=diff&version=16&old_version=15

> How can I read mask file with
> gdal and convert my initial RGB GeoTiff to a GeoTiff with a mask band from
> it?

Once your mask is fixed to be recognized as explain above, you can create an 
internal mask with:

gdal_translate in_with_external_mask.tif out_with_internal_mask.tif --config GDAL_TIFF_INTERNAL_MASK YES

But note that QGIS does not handle GDAL mask band currently. You'll have to
transform the binary mask band as an alpha channel instead

gdal_translate rgb_with_mask.tif rgba.tif -b 1 -b 2 -b 3 -b mask

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/3a2d377d/attachment.html>

From even.rouault at spatialys.com  Mon Dec 19 05:09:00 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Dec 2016 14:09:00 +0100
Subject: [gdal-dev] GDAL doesn't read GeoTiff .msk mask file
In-Reply-To: <2468975.cBTvPvHcPc@even-i700>
References: <E8951863-F7A4-46D1-B566-840C388277F5@gmail.com>
 <2468975.cBTvPvHcPc@even-i700>
Message-ID: <14974075.IAr6uForZ5@even-i700>

On lundi 19 décembre 2016 13:38:04 CET Even Rouault wrote:
> Nikolai,
> 
> > I’ve got an 8-bit 3-band (RGB) GeoTiff file created in ArcGIS and it has a
> > mask file (myfile.tif.msk) along with it, indicating which pixels have
> > "nodata" value. When viewing it in ArcMap, I get “nodata” for masked
> > pixels. But when viewing in QGIS, I get an unmasked raster and masked
> > pixels return pixel values of R G and B bands. Gdalinfo doesn’t return a
> > .tif.msk file in a list of dataset files (however it does return
> > .aux.xml)

Actually looking at the code and experimenting, that's super weird. The .msk file 
should always be listed in the file list, even if there are no INTERNAL_MASK_FLAGS_x 
metadata item. Does gdalinfo on the .msk file succeed ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/6b1c110f/attachment-0001.html>

From esacree at knology.net  Mon Dec 19 09:47:41 2016
From: esacree at knology.net (esacree)
Date: Mon, 19 Dec 2016 10:47:41 -0700 (MST)
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
 bad capabilities
In-Reply-To: <2737766.KQTCTgvQU2@even-i700>
References: <1480535757783-5298089.post@n6.nabble.com>
 <1481919277392-5300212.post@n6.nabble.com> <2737766.KQTCTgvQU2@even-i700>
Message-ID: <1482169661273-5300523.post@n6.nabble.com>

I've tried both the "TileLevel" and the "ZoomLevel" parameters both
separately and together.  The URL still shows the maximum tile zoom level on
the request.

<GDAL_WMTS>
       
<GetCapabilitiesUrl>http://basemap.nationalmap.gov/arcgis/rest/services/USGSShadedReliefOnly/MapServer/WMTS/1.0.0/WMTSCapabilities.xml</GetCapabilitiesUrl>
        <Layer>USGSShadedReliefOnly</Layer>
        
        <TileMatrixSet>GoogleMapsCompatible</TileMatrixSet>
        <TileLevel>14</TileLevel>
        <ZoomLevel>14</ZoomLevel>
        <Format>image/jpg</Format>
    <DataWindow>
        <UpperLeftX>-9663275.545</UpperLeftX>
        <UpperLeftY>4328130.660</UpperLeftY>
        <LowerRightX>-9647573.528</LowerRightX>
        <LowerRightY>4319175.789</LowerRightY>
        </DataWindow>
    <BandsCount>4</BandsCount>
    <ExtendBeyondDateLine>TRUE</ExtendBeyondDateLine>
    <Cache>
    <Path>./GDALWMSCache</Path>
    <Depth>2</Depth>
    <Extension>.jpg</Extension>
    </Cache>
    <MaxConnections>5</MaxConnections>
    <UnsafeSSL>true</UnsafeSSL>
    <ZeroBlockHttpCodes>404</ZeroBlockHttpCodes>
    <ZeroBlockOnServerException>true</ZeroBlockOnServerException>
</GDAL_WMTS>

Elaine



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/WMTS-Need-TileLevel-option-Servers-responding-with-bad-capabilities-tp5298089p5300523.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Dec 19 09:57:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Dec 2016 18:57:37 +0100
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
	bad capabilities
In-Reply-To: <1482169661273-5300523.post@n6.nabble.com>
References: <1480535757783-5298089.post@n6.nabble.com>
 <2737766.KQTCTgvQU2@even-i700> <1482169661273-5300523.post@n6.nabble.com>
Message-ID: <2003063.XeNXW7VbIB@even-i700>

> I've tried both the "TileLevel" and the "ZoomLevel" parameters both
> separately and together.  The URL still shows the maximum tile zoom 
level on
> the request.

You are probably not using a trunk build or a recent enough trunk build. 
Your XML works fine for me and results in level 14 being fetched.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/e5b2fc88/attachment.html>

From esacree at knology.net  Mon Dec 19 11:47:41 2016
From: esacree at knology.net (esacree)
Date: Mon, 19 Dec 2016 12:47:41 -0700 (MST)
Subject: [gdal-dev] WMTS - Need TileLevel option Servers responding with
 bad capabilities
In-Reply-To: <2003063.XeNXW7VbIB@even-i700>
References: <1480535757783-5298089.post@n6.nabble.com>
 <1481919277392-5300212.post@n6.nabble.com> <2737766.KQTCTgvQU2@even-i700>
 <1482169661273-5300523.post@n6.nabble.com> <2003063.XeNXW7VbIB@even-i700>
Message-ID: <1482176861974-5300541.post@n6.nabble.com>

Even,

Ah!  You are correct.  I just loaded the 17-Dec-2016 daily stable branch. 
Wrong one.

Thank you for checking the syntax for me.  WMTS should be good to go for the
next release of GDAL.
I have 5 other map server types working correctly now.

Thanks for your help!

Elaine



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/WMTS-Need-TileLevel-option-Servers-responding-with-bad-capabilities-tp5298089p5300541.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From armin.burger at gmx.net  Mon Dec 19 13:02:43 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Mon, 19 Dec 2016 22:02:43 +0100
Subject: [gdal-dev] Problem when creating overviews for large input files
	with gdaladdo
Message-ID: <1d2cd0fd-1885-4294-0f85-5c526ba0928a@gmx.net>

Dear all

I ran into a problem when trying to create overviews for large 
LZW-compressed GeoTIFF images using gdaladdo. The TIFF's are internally 
tiled, the file type is Byte. GDAL versions tested are 2.1.1 and 1.11, 
running on 64bit Linux.

The first try was using an input file of size 1038336 x 565248 pixels. 
Setting CPL_DEBUG=ON the processing goes up to the message

...10...20...30...40...50...60...70..GDAL: Potential thrashing on band 1 
of tileindex_nodsm_otsu_2

and then it remains at this "70.." % forever, with no further log 
output. This happened for all files of similar size, on multiple 
machines, on both GDAL versions. Always hangs at this "70.." state, the 
process remains alive but nothing is written any more to the output 
file. I used the command like

gdaladdo -ro --config COMPRESS_OVERVIEW LZW  INPUT_FILE 2 4 8 16 32 64

Trying to specify BIGTIFF or not for the overview did not make any 
difference.

Using a smaller file or converting the large input file to 50% size and 
running the gdaladdo on this smaller file finished successfully, but 
also here I got some warnings of a similar kind, and the process got 
stuck for a while after the ".70..GDAL: Potential thrashing..." warning, 
but then continued to the end. The full log is attached.

An additional observation I made was that the overview file stopping at 
70% was already bigger than the input file.

I was thinking to create single lower resolution files and merging them 
to an overview file, but there's no built-in functionality for this, so 
did not follow it up further.

Could there be a sort of limitation of maximum pixels x*y, or with the 
LZW compression? Any ideas how this could be solved?

Thanks in advance for any hint
Armin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdaladdo.log
Type: text/x-log
Size: 5367 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/a00e777d/attachment.bin>

From even.rouault at spatialys.com  Mon Dec 19 13:26:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Dec 2016 22:26:14 +0100
Subject: [gdal-dev] Problem when creating overviews for large input
	files with gdaladdo
In-Reply-To: <1d2cd0fd-1885-4294-0f85-5c526ba0928a@gmx.net>
References: <1d2cd0fd-1885-4294-0f85-5c526ba0928a@gmx.net>
Message-ID: <1968593.c78aGyxG9Z@even-i700>

Armin,

This is a "well known" performance issue with the geotiff driver / libtiff when switching back 
and forth between IFD (image file directories). At ~ 75%, you start generating overview 
factor 4 and that implies switching regularly between the one previously computed (read 
operations) and the new one (write operations). Each time you switch, you need to read and 
write the TileOffsets and TileByteCounts tags (those can be 10's of megabytes large on huge 
file, and are the root cause for the performance problem). With infinite patience, this would 
eventually complete.

A trick you can use is :

gdaladdo -ro --config COMPRESS_OVERVIEW LZW  INPUT_FILE 2
gdaladdo -ro --config COMPRESS_OVERVIEW LZW  INPUT_FILE.ovr 2
gdaladdo -ro --config COMPRESS_OVERVIEW LZW  INPUT_FILE.ovr.ovr 2
gdaladdo -ro --config COMPRESS_OVERVIEW LZW  INPUT_FILE.ovr.ovr.ovr 2

Even



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/b6d21186/attachment.html>

From armin.burger at gmx.net  Mon Dec 19 13:38:00 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Mon, 19 Dec 2016 22:38:00 +0100
Subject: [gdal-dev] Problem when creating overviews for large input
 files with gdaladdo
In-Reply-To: <1968593.c78aGyxG9Z@even-i700>
References: <1d2cd0fd-1885-4294-0f85-5c526ba0928a@gmx.net>
 <1968593.c78aGyxG9Z@even-i700>
Message-ID: <c3bfbb71-ca96-229b-dcf6-b66f99f815ff@gmx.net>

Hi Even

thanks a lot for the fast reply and the explanation! I will try your 
workaround. The patience needed to wait for the completion of the 
"normal" method seems to be a bit too high, I stopped the last test 
after 4 days...

Best
Armin



On 19/12/16 22:26, Even Rouault wrote:
> Armin,
>
>
>
> This is a "well known" performance issue with the geotiff driver /
> libtiff when switching back and forth between IFD (image file
> directories). At ~ 75%, you start generating overview factor 4 and that
> implies switching regularly between the one previously computed (read
> operations) and the new one (write operations). Each time you switch,
> you need to read and write the TileOffsets and TileByteCounts tags
> (those can be 10's of megabytes large on huge file, and are the root
> cause for the performance problem). With infinite patience, this would
> eventually complete.
>
>
>
> A trick you can use is :
>
>
>
> gdaladdo -ro --config COMPRESS_OVERVIEW LZW INPUT_FILE 2
>
> gdaladdo -ro --config COMPRESS_OVERVIEW LZW INPUT_FILE.ovr 2
>
> gdaladdo -ro --config COMPRESS_OVERVIEW LZW INPUT_FILE.ovr.ovr 2
>
> gdaladdo -ro --config COMPRESS_OVERVIEW LZW INPUT_FILE.ovr.ovr.ovr 2
>
>
>
> Even
>
>
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

From mofoyoda at gmail.com  Mon Dec 19 17:34:55 2016
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Tue, 20 Dec 2016 04:34:55 +0300
Subject: [gdal-dev] GDAL doesn't read GeoTiff .msk mask file
In-Reply-To: <mailman.16316.1482152944.1612.gdal-dev@lists.osgeo.org>
References: <mailman.16316.1482152944.1612.gdal-dev@lists.osgeo.org>
Message-ID: <75EEA39B-78EA-4D2B-8D2C-464CC7C4752E@gmail.com>

Even, thanks a lot for replying.

No, the strange thing is neither gdalinfo, nor gdal_translate work on my .msk file.
Gdalinfo returns "not recognized as a supported file format”. Though this .msk works ok in ArcGIS.
I can even export raster from ArcGIS with baked-in mask (like setting output to 16-bit and nodata value to 256 (anything bigger than 255)).
But then I don’t know how to get gdal translate it back to 8 bit with adding a mask band from pixels with value of 256. Is that possible?

Cheers, 
Nick

> 
> On lundi 19 décembre 2016 13:38:04 CET Even Rouault wrote:
>> Nikolai,
>> 
>>> I’ve got an 8-bit 3-band (RGB) GeoTiff file created in ArcGIS and it has a
>>> mask file (myfile.tif.msk) along with it, indicating which pixels have
>>> "nodata" value. When viewing it in ArcMap, I get “nodata” for masked
>>> pixels. But when viewing in QGIS, I get an unmasked raster and masked
>>> pixels return pixel values of R G and B bands. Gdalinfo doesn’t return a
>>> .tif.msk file in a list of dataset files (however it does return
>>> .aux.xml)
> 
> Actually looking at the code and experimenting, that's super weird. The .msk file 
> should always be listed in the file list, even if there are no INTERNAL_MASK_FLAGS_x 
> metadata item. Does gdalinfo on the .msk file succeed ?
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161219/6b1c110f/attachment.html>
> 


From even.rouault at spatialys.com  Tue Dec 20 00:53:13 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 20 Dec 2016 09:53:13 +0100
Subject: [gdal-dev] GDAL doesn't read GeoTiff .msk mask file
In-Reply-To: <75EEA39B-78EA-4D2B-8D2C-464CC7C4752E@gmail.com>
References: <mailman.16316.1482152944.1612.gdal-dev@lists.osgeo.org>
 <75EEA39B-78EA-4D2B-8D2C-464CC7C4752E@gmail.com>
Message-ID: <3689958.vo0O7MaxgK@even-i700>

On mardi 20 décembre 2016 04:34:55 CET Nikolai Bezdna wrote:
> No, the strange thing is neither gdalinfo, nor gdal_translate work on my
> .msk file.
> Gdalinfo returns "not recognized as a supported file format”.

Oh, then that's really an ArcGIS specific thing. Not even a regular TIFF

> Though this .msk works ok in ArcGIS. I can even export raster from ArcGIS
> with baked-in mask (like setting output to 16-bit and nodata value to 256
> (anything bigger than 255)). But then I don’t know how to get gdal
> translate it back to 8 bit with adding a mask band from pixels with value
> of 256. Is that possible?

Use gdal_translate -a_nodata 256 in.tif out.tif

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161220/a2fd8f11/attachment-0001.html>

From armin.burger at gmx.net  Tue Dec 20 13:21:15 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Tue, 20 Dec 2016 22:21:15 +0100
Subject: [gdal-dev] Read error on large VRT files
Message-ID: <b2185561-95c8-15a6-1d4a-3e75011fc48c@gmx.net>

Hi all

I sometimes get read errors when trying to convert large input VRT files 
into a single BigTIFF file, typically applying an outsize of e.g. 50% or 
25%. Errors are like

ERROR 1: TIFFFillTile:Read error at row 11264, col 11264; got 46 by
tes, expected 84
ERROR 1: TIFFReadEncodedTile() failed.

ERROR 1: 2352/2592_BUCNFD.tif, band 1: IReadBlock failed at X offset 45, 
Y offset 47

The tile that returns the error can be converted alone without problems.
All together the number of tiles of the VRT can be towards 6000, having 
100 GB in total, tiles are LZW or Deflate compressed TIFF's.


Is there a possible source of errors when trying to read and convert 
VRT's of compressed TIFF of that size?

Thanks for any hint

Armin

From armin.burger at gmx.net  Wed Dec 21 01:29:27 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Wed, 21 Dec 2016 10:29:27 +0100
Subject: [gdal-dev] Read error on large VRT files
In-Reply-To: <CABa=8Qo_9Jc2gRsdcqAsTEo61T1uJ37W06Tj9Lc9yg8mPYkXwA@mail.gmail.com>
References: <b2185561-95c8-15a6-1d4a-3e75011fc48c@gmx.net>,
 <CABa=8Qo_9Jc2gRsdcqAsTEo61T1uJ37W06Tj9Lc9yg8mPYkXwA@mail.gmail.com>
Message-ID: <trinity-1d137510-7727-4e43-89e1-0fd88d669ec5-1482312567879@3capp-gmx-bs12>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161221/d680f306/attachment.html>

From even.rouault at spatialys.com  Wed Dec 21 01:49:59 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 21 Dec 2016 10:49:59 +0100
Subject: [gdal-dev] Read error on large VRT files
In-Reply-To: <trinity-1d137510-7727-4e43-89e1-0fd88d669ec5-1482312567879@3capp-gmx-bs12>
References: <b2185561-95c8-15a6-1d4a-3e75011fc48c@gmx.net>
 <CABa=8Qo_9Jc2gRsdcqAsTEo61T1uJ37W06Tj9Lc9yg8mPYkXwA@mail.gmail.com>
 <trinity-1d137510-7727-4e43-89e1-0fd88d669ec5-1482312567879@3capp-gmx-bs12>
Message-ID: <3183764.CUtO5xN5ZW@even-i700>

On mercredi 21 décembre 2016 10:29:27 CET Armin Burger wrote:
> Margherita
>  
> thanks, now that you say this, I remeber a special GDAL option
> "GDAL_MAX_DATASET_POOL_SIZE" which by default is 100. The operating system
> limit itself is high enough on our server (65k). When running the
> processing again with less memory cache (and hence likely less concurrent
> opened files) it worked without errors. I will set this GDAL option and see
> if I ever run into this errors again. 

On which option did you play exactly ?

The TIFF error you get is a rather low level one (really trying to read a range of bytes from 
a file), and I can't explain why GDAL options would play a role on it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161221/7391fb13/attachment.html>

From armin.burger at gmx.net  Thu Dec 22 02:20:42 2016
From: armin.burger at gmx.net (Armin Burger)
Date: Thu, 22 Dec 2016 11:20:42 +0100
Subject: [gdal-dev] Read error on large VRT files
In-Reply-To: <3183764.CUtO5xN5ZW@even-i700>
References: <b2185561-95c8-15a6-1d4a-3e75011fc48c@gmx.net>
 <CABa=8Qo_9Jc2gRsdcqAsTEo61T1uJ37W06Tj9Lc9yg8mPYkXwA@mail.gmail.com>
 <trinity-1d137510-7727-4e43-89e1-0fd88d669ec5-1482312567879@3capp-gmx-bs12>
 <3183764.CUtO5xN5ZW@even-i700>
Message-ID: <2ecf1a23-4a41-aec3-29a6-67d29c794f7f@gmx.net>

I meant the GDAL_MAX_DATASET_POOL_SIZE option. Don't know if it really 
has any influence, but these read errors happened multiple times in the 
past when trying to translate VRT's with lots of input files, for tiles 
that were actually readable. It could be of course also a problem of the 
network file system, short network time-outs etc.

Armin

On 21/12/16 10:49, Even Rouault wrote:
> On mercredi 21 décembre 2016 10:29:27 CET Armin Burger wrote:
>
>> Margherita
>
>>
>
>> thanks, now that you say this, I remeber a special GDAL option
>
>> "GDAL_MAX_DATASET_POOL_SIZE" which by default is 100. The operating system
>
>> limit itself is high enough on our server (65k). When running the
>
>> processing again with less memory cache (and hence likely less concurrent
>
>> opened files) it worked without errors. I will set this GDAL option
> and see
>
>> if I ever run into this errors again.
>
>
>
> On which option did you play exactly ?
>
>
>
> The TIFF error you get is a rather low level one (really trying to read
> a range of bytes from a file), and I can't explain why GDAL options
> would play a role on it.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>

From cavallini at faunalia.it  Thu Dec 22 07:51:15 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Thu, 22 Dec 2016 16:51:15 +0100
Subject: [gdal-dev] gdaldem color-relief transparency
Message-ID: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>

Hi all,
sorry if this is not the right list. Please redirect me elsewhere in case.
I cannot give a transparency to NULL when creating a coloured raster:

gdaldem color-relief -alpha temp_clip.tif byr.txt temp_col.tif -of GTiff

where byr.txt is:

0% 5 113 176 255
25% 146 197 222 255
50% 247 247 247 255
75% 244 165 130 255
100% 202 0 32 255
nv 255 255 255 0

I tried several other combinations, but I cannot hava a transparency of
NULLs.
Where am I wrong?
All the best.
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From even.rouault at spatialys.com  Thu Dec 22 07:57:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 22 Dec 2016 16:57:46 +0100
Subject: [gdal-dev] gdaldem color-relief transparency
In-Reply-To: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>
References: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>
Message-ID: <2997626.BUL7JdVKos@even-i700>

Paolo,

This works for me as expected with the following input raster (and using your palette):

$ cat wrk/in.asc
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3750120.000000000000
cellsize     60.000000000000
NODATA_value 0
 107 123 
 0 100

$ gdaldem  color-relief -alpha  wrk/in.asc wrk/palette.txt wrk/out.tif

$ gdal_translate wrk/out.tif /vsistdout/ -of aaigrid -b 4
ncols        2
nrows        2
xllcorner    440720.000000000000
yllcorner    3750120.000000000000
cellsize     60.000000000000
 255 255
 0 255


Perhaps there's an issue with the nodata value of your raster ?

Even


> Hi all,
> sorry if this is not the right list. Please redirect me elsewhere in case.
> I cannot give a transparency to NULL when creating a coloured raster:
> 
> gdaldem color-relief -alpha temp_clip.tif byr.txt temp_col.tif -of GTiff
> 
> where byr.txt is:
> 
> 0% 5 113 176 255
> 25% 146 197 222 255
> 50% 247 247 247 255
> 75% 244 165 130 255
> 100% 202 0 32 255
> nv 255 255 255 0
> 
> I tried several other combinations, but I cannot hava a transparency of
> NULLs.
> Where am I wrong?
> All the best.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161222/bf70c8c6/attachment.html>

From cavallini at faunalia.it  Thu Dec 22 08:14:33 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Thu, 22 Dec 2016 17:14:33 +0100
Subject: [gdal-dev] gdaldem color-relief transparency
In-Reply-To: <2997626.BUL7JdVKos@even-i700>
References: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>
 <2997626.BUL7JdVKos@even-i700>
Message-ID: <9ee9b5f0-7477-df77-5079-75b86008245e@faunalia.it>

Hi Even,

Il 22/12/2016 16:57, Even Rouault ha scritto:

> Perhaps there's an issue with the nodata value of your raster ?

maybe; I have created it with:

gdalwarp -q -cutline mcp_buf.shp -tr 0.0015703125 0.00038671875
temperature.tif temp_clip.tif

How do I check?

Thanks.

-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From even.rouault at spatialys.com  Thu Dec 22 08:21:36 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 22 Dec 2016 17:21:36 +0100
Subject: [gdal-dev] gdaldem color-relief transparency
In-Reply-To: <9ee9b5f0-7477-df77-5079-75b86008245e@faunalia.it>
References: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>
 <2997626.BUL7JdVKos@even-i700>
 <9ee9b5f0-7477-df77-5079-75b86008245e@faunalia.it>
Message-ID: <6004549.h6onFrIBlY@even-i700>

On jeudi 22 décembre 2016 17:14:33 CET Paolo Cavallini wrote:
> Hi Even,
> 
> Il 22/12/2016 16:57, Even Rouault ha scritto:
> > Perhaps there's an issue with the nodata value of your raster ?
> 
> maybe; I have created it with:
> 
> gdalwarp -q -cutline mcp_buf.shp -tr 0.0015703125 0.00038671875
> temperature.tif temp_clip.tif

Look at the nodata value reported with

gdalinfo temp_clip.tif

If there's none, then you've spotted the issue and you need to define one with -dstnodata

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161222/24de0580/attachment.html>

From cavallini at faunalia.it  Thu Dec 22 08:29:38 2016
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Thu, 22 Dec 2016 17:29:38 +0100
Subject: [gdal-dev] gdaldem color-relief transparency
In-Reply-To: <6004549.h6onFrIBlY@even-i700>
References: <9e88b837-967d-d67f-e9a7-8e5afb3354c4@faunalia.it>
 <2997626.BUL7JdVKos@even-i700>
 <9ee9b5f0-7477-df77-5079-75b86008245e@faunalia.it>
 <6004549.h6onFrIBlY@even-i700>
Message-ID: <44163414-91a5-df69-827e-78fa3394aa50@faunalia.it>

Il 22/12/2016 17:21, Even Rouault ha scritto:

> If there's none, then you've spotted the issue and you need to define
> one with -dstnodata

exactly, it works now with

gdalwarp -dstnodata -999 -q -cutline mcp_buf.shp -tr 0.0015703125
0.00038671875 output/temperature.tif output/temp_clip.tif

thanks a lot
-- 
Paolo Cavallini - www.faunalia.eu
QGIS & PostGIS courses: http://www.faunalia.eu/training.html
https://www.google.com/trends/explore?date=all&geo=IT&q=qgis,arcgis

From schwehr at gmail.com  Fri Dec 23 10:05:46 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 23 Dec 2016 10:05:46 -0800
Subject: [gdal-dev] C++11 timeline
Message-ID: <CACmBxysv7H=MP1iV+O=sHfh4Z8teuuvic7mgQrGiSmpeC_fmcw@mail.gmail.com>

Hi all,

I would like to continue the C++11 discussion over the next couple weeks
while many people are on slower development cycles with a proposal:

* Starting 2017-Mar-01, we switch GDAL trunk to require C++11 support from
the compiler.
* All prior branches would stick with their existing requirements for C++03
support

I had come up with a bunch of other things for a timeline, but they all see
like noise after Even pointed out a whole ton of issues my thoughts.  This
isn't as aggressive as I would like, but it would definitely help reduce
the maintenance burden on humans and reduce the test load for continuous
integration.  I removed explicit mention of OS or compiler versions which I
had in my initial thoughts.

This would not be a free-for-all on C++11 features.  I think we would want
to just start with removing some of the macros and workarounds that are
currently in the code base.  Until we decide to go forward with other
features, the main changes that would happen in C++ only code after this
would be:

- Change NULL to nullptr
- Drop virtual when using the override keyword (this becomes a req with
C++17)
- CPL_OVERRIDE -> override
- Remove HAVE_CXX11 #ifs
- And maybe some other things I missed

Once those are all done, we can then discuss when to allow things like
unique_ptr internally (which will allow some serious simplification of some
code).

Then at some later time, we can discuss what API changes to allow, when to
require C++14, C++17, C11, etc.

Thoughts?

-kurt

e.g.

find . -name \*.cpp -o -name \*.h | xargs grep -i override | grep virtual |
wc -l
    3998

find . -name \*.cpp -o -name \*.h | xargs grep CPL_OVERRIDE | wc -l
     712

find . -name \*.cpp -o -name \*.h | xargs grep HAVE_CXX11 | wc -l
      36
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161223/2259125b/attachment.html>

From issworld2000 at yahoo.com  Sat Dec 24 16:21:12 2016
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sun, 25 Dec 2016 00:21:12 +0000 (UTC)
Subject: [gdal-dev] shortest path or networks in GDAL
In-Reply-To: <08cf0f5e-9464-50f3-9137-7b43ff5429e8@gmail.com>
References: <1014526123.3295626.1481760290930.ref@mail.yahoo.com>
 <1014526123.3295626.1481760290930@mail.yahoo.com>
 <08cf0f5e-9464-50f3-9137-7b43ff5429e8@gmail.com>
Message-ID: <2071770369.1614939.1482625272463@mail.yahoo.com>

Hi Dmitry,
I apologize for taking me too long to reply back.
Thank you for the suggestion and information!

Happy New year holidays to you and your family! 

    On Friday, December 16, 2016 7:38 AM, Dmitry Baryshnikov <bishop.dev at gmail.com> wrote:
 

  Hi Djordje, Default build of GNM in GDAL was enabled recently. I think this build is not available by GISInternals. Try our (NextGIS) own build of GDAL from here: http://nextgis.com/borsch/
  Best regards,
    Dmitry 15.12.16 3:04, Djordje Spasic пишет:
  
  I am wondering if it is possible to perform the shortest path or network analysis in Windows version of GDAL?
  I googled and found gnmanalyse page on GDAL website, which seems to be able to do that:
  http://www.gdal.org/gnmanalyse.html
  
  But is this gnmanalyse functionality available only through GDAL C#/python binaries?
 
 I can not access it directly by running GDAL Windows .exe files?
 
 Thank you for the reply.
  
  
 _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 
 
 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20161225/55feb9e8/attachment.html>

