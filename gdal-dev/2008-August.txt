From 27949218 at qq.com  Fri Aug  1 03:51:41 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Fri Aug  1 03:51:48 2008
Subject: [gdal-dev] Update existing shape file
Message-ID: <tencent_7CA38D560B29D7BF63FEFFF0@qq.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: 2135025775.txt
Type: application/octet-stream
Size: 147 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080801/936a1eb5/2135025775-0001.obj
From huntc at internode.on.net  Fri Aug  1 06:20:30 2008
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Aug  1 06:20:30 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<487D3C22.3070501@pobox.com>
	<7890CB5F-AAF1-4ADF-8EB6-3368B105855B@internode.on.net>
	<487D5C8C.1000104@pobox.com>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
Message-ID: <27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>

Hi Frank et. al,

Sorry to be a pest. I've been trying tons of things, trawling tons of  
search results, and I'm really no better off than I was a few days  
ago. :-P

In summary I have an aerial photo image of an airport with three well  
known points (expressed in lat/longs). I'm wanting the image to be  
projected using a equidistant cylindrical projection.

On gdal_translate's gcps, I'm presuming that the origin of the image  
is assumed to be top-left for the gcp pixel and line values... and  
that the gcp easting and northing values are expressed in metres?

How do I centre a projection? lat_0 and lon_0 values?

Thanks again for your time - I appreciate that time is precious.

Cheers,
-C

On 30/07/2008, at 5:38 PM, Christopher Hunt wrote:

> On 30/07/2008, at 9:07 AM, Frank Warmerdam wrote:
>
>> Christopher Hunt wrote:
>>> Hi Frank,
>>> Thanks for the reply and for the confirmation that I'm on the  
>>> right track.
>>> Dumb newbie question: wouldn't most aerial photos taken, say, from  
>>> 12,000ft be ortho in their projection?
>>
>> Christopher,
>>
>> I don't think that is a good assumption at all.  And if you were  
>> going to
>> go with that assumption it seems to me you would want the  
>> projection center
>> to be in the photo center.
> Ah yes, so if the projection centre were approximately 51.47177116,  
> -0.46551585 then:
>
> > proj +proj=ortho +datum=WGS84 +lat_0=51.47177116 +lon_0=-0.46551585
> > -0.49310374 51.47858961
> -1912.68	759.39
> > -0.46551585 51.47177116
> 0.00	0.00
> > -0.43439870 51.46490423
> 2158.02	-763.96
> > ^C
>
> ...to get my eastings and northings and then:
>
> gdal_translate -a_srs '+proj=ortho +datum=WGS84 +lat_0=51.47177116  
> +lon_0=-0.46551585' \
>  -gcp 61 115 -1912.68 759.39 \
>  -gcp 465 280 0.00 0.00 \
>  -gcp 899 435 2158.02 -763.96 \
>  infile outfile
>
> i.e. the +lat_0 and +lon_0 centres the projection right?
>
> Unfortunately the above still doesn't yield the result I'm expecting.
>
>> But then, I'm in the habit of treating projections as black boxes,  
>> and I
>> seldom try to physically interprete their characteristics.
> Understood. Unfortunately I don't have a great deal of projection  
> information for the image that I have.
>
> Thanks for any further guidance.
>
> Cheers,
> -C

From tutey at o2.pl  Fri Aug  1 07:52:24 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Fri Aug  1 07:50:50 2008
Subject: [gdal-dev] Tiled vs Stripped TIFs,	how many overviews and why
	(wirh gdaladdo)?
In-Reply-To: <1217542501.14976.18.camel@vertical>
References: <1217542501.14976.18.camel@vertical>
Message-ID: <4892F8F8.70505@o2.pl>

Nikos Alexandris pisze:
> There has been a lot of discussion lately about using 
> gdal_translate/gdalwarp with or without the "-co TILED=YES" option, 
> about overviews and more. How can I determine what is best for my 300
>  photos? I want faster loading and as less disk usage as possible...
> what everybody wants :-)

Nikos,

Regarding disk usage you might find some hints here:

https://trac.osgeo.org/qgis/ticket/605#comment:7

(If there are errors in my analysis please Anybody point them out!)

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From patrick.cannon at barcosoft.com  Fri Aug  1 08:43:05 2008
From: patrick.cannon at barcosoft.com (Patrick Cannon)
Date: Fri Aug  1 08:37:21 2008
Subject: [gdal-dev] GDALDataset limits?
Message-ID: <200808010743.05424.patrick.cannon@barcosoft.com>

Hi Frank,

Is there a limit to the number of GDALDatasets that can be open at one time?

My program is set to automatically open raster images from a database.  
There are over 2254 charts in the database.  Each record has the path to 
the actual file on disk.

In auto mode it gets to around 1004 or so files and then GDAL starts 
returning "file not found" errors.  If I manually open the files it says 
can not be found, it opens them without issue.  So the file is available on 
disk.  Also, if I change the sort on the database so it loads from the 
bottom it has no problem opening the files in auto mode.

I do not think this is a memory issue because with the program running and 
1000+ datasets open it has not hit the swap.

If it is not a limit in the library, do you have any ideas?

Best regards,
Patrick Cannon
Barco Software LLC


From dmorissette at mapgears.com  Fri Aug  1 08:49:37 2008
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri Aug  1 08:50:23 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <200808010743.05424.patrick.cannon@barcosoft.com>
References: <200808010743.05424.patrick.cannon@barcosoft.com>
Message-ID: <48930661.9090809@mapgears.com>

Patrick Cannon wrote:
> 
> I do not think this is a memory issue because with the program running and 
> 1000+ datasets open it has not hit the swap.
> 
> If it is not a limit in the library, do you have any ideas?
> 

Could you be running out of file handles?

By default, at least on my Ubuntu box, there is a maximum of 1024 file 
handles per user process. If you're on Linux you could find out the 
limit on your system with 'ulimit -a'.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
From mateusz at loskot.net  Fri Aug  1 09:17:58 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 09:18:05 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <48930661.9090809@mapgears.com>
References: <200808010743.05424.patrick.cannon@barcosoft.com>
	<48930661.9090809@mapgears.com>
Message-ID: <48930D06.7010802@loskot.net>

Daniel Morissette wrote:
> Patrick Cannon wrote:
>>
>> I do not think this is a memory issue because with the program running
>> and 1000+ datasets open it has not hit the swap.
>>
>> If it is not a limit in the library, do you have any ideas?
>>
> 
> Could you be running out of file handles?
> 
> By default, at least on my Ubuntu box, there is a maximum of 1024 file
> handles per user process. If you're on Linux you could find out the
> limit on your system with 'ulimit -a'.

I support Daniel's assumption.
On my Mac OS X 10.5 (Power PC) it's set to 256.
So, it varies significantly across operating systems.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From nikos.alexandris at felis.uni-freiburg.de  Fri Aug  1 09:19:17 2008
From: nikos.alexandris at felis.uni-freiburg.de (Nikos Alexandris)
Date: Fri Aug  1 09:19:20 2008
Subject: [gdal-dev] Tiled vs Stripped TIFs,	how many overviews and why
	(wirh gdaladdo)?
In-Reply-To: <4892F8F8.70505@o2.pl>
References: <1217542501.14976.18.camel@vertical>  <4892F8F8.70505@o2.pl>
Message-ID: <1217596757.7081.4.camel@vertical>

On Fri, 2008-08-01 at 13:52 +0200, Maciej Sieczka wrote:
> Nikos Alexandris pisze:
> > There has been a lot of discussion lately about using 
> > gdal_translate/gdalwarp with or without the "-co TILED=YES" option, 
> > about overviews and more. How can I determine what is best for my 300
> >  photos? I want faster loading and as less disk usage as possible...
> > what everybody wants :-)
> 
> Nikos,
> 
> Regarding disk usage you might find some hints here:
> 
> https://trac.osgeo.org/qgis/ticket/605#comment:7
> 
> (If there are errors in my analysis please Anybody point them out!)
> 
> Maciek

Maciek (or Maciej?),

thank you for the useful hint. This makes a huge difference when it
comes to handle hundreds of tiff's.

Nikos

From ivan.lucena at pmldnet.com  Fri Aug  1 09:30:56 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Fri Aug  1 09:30:59 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <48930D06.7010802@loskot.net>
References: <200808010743.05424.patrick.cannon@barcosoft.com>	<48930661.9090809@mapgears.com>
	<48930D06.7010802@loskot.net>
Message-ID: <48931010.90802@pmldnet.com>

Patrick,

What is the DBMS that you are using? Since the image are unmanaged (file 
system) the DBMS should face the same file-handles limitation, no? 
Anyway, do you really need to have all 2254 files opened at the same 
time? Just curiosity.

Best regards,

Ivan

Mateusz Loskot wrote:
> Daniel Morissette wrote:
>> Patrick Cannon wrote:
>>> I do not think this is a memory issue because with the program running
>>> and 1000+ datasets open it has not hit the swap.
>>>
>>> If it is not a limit in the library, do you have any ideas?
>>>
>> Could you be running out of file handles?
>>
>> By default, at least on my Ubuntu box, there is a maximum of 1024 file
>> handles per user process. If you're on Linux you could find out the
>> limit on your system with 'ulimit -a'.
> 
> I support Daniel's assumption.
> On my Mac OS X 10.5 (Power PC) it's set to 256.
> So, it varies significantly across operating systems.
> 
> Best regards,
From warmerdam at pobox.com  Fri Aug  1 09:56:03 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  1 09:56:33 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <200808010743.05424.patrick.cannon@barcosoft.com>
References: <200808010743.05424.patrick.cannon@barcosoft.com>
Message-ID: <489315F3.6020408@pobox.com>

Patrick Cannon wrote:
> Hi Frank,
> 
> Is there a limit to the number of GDALDatasets that can be open at one time?
> 
> My program is set to automatically open raster images from a database.  
> There are over 2254 charts in the database.  Each record has the path to 
> the actual file on disk.
> 
> In auto mode it gets to around 1004 or so files and then GDAL starts 
> returning "file not found" errors.  

Patrick,

My first guess would be a file handle limit, as others have mentioned.

 > If I manually open the files it says can not be found, it opens them
 > without issue.

I'm afraid I don't understand this.  The "says it can not be found"
and "opens them without issue" parts of this sentance seem to conflict.

 > So the file is available on
> disk.  Also, if I change the sort on the database so it loads from the 
> bottom it has no problem opening the files in auto mode.

You are saying that you can open at 2254 charts fine if you open them in
a different order than the default?  That is odd behavior!

At this point I'd normally try running in the debugger to track down
the failure, and/or running things under something like valgrind.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From tutey at o2.pl  Fri Aug  1 10:03:57 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Fri Aug  1 10:02:20 2008
Subject: [gdal-dev] Tiled vs Stripped TIFs,	how many overviews and why
	(wirh gdaladdo)?
In-Reply-To: <1217596757.7081.4.camel@vertical>
References: <1217542501.14976.18.camel@vertical> <4892F8F8.70505@o2.pl>
	<1217596757.7081.4.camel@vertical>
Message-ID: <489317CD.3050205@o2.pl>

Nikos Alexandris pisze:
> On Fri, 2008-08-01 at 13:52 +0200, Maciej Sieczka wrote:

>> Regarding disk usage you might find some hints here:
>>
>> https://trac.osgeo.org/qgis/ticket/605#comment:7

> Maciek (or Maciej?),

It's like Matt vs Matthew.

Cheers,
Maciek

-- 
Maciej Sieczka
www.sieczka.org
From warmerdam at pobox.com  Fri Aug  1 10:02:29 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  1 10:03:07 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<487D3C22.3070501@pobox.com>
	<7890CB5F-AAF1-4ADF-8EB6-3368B105855B@internode.on.net>
	<487D5C8C.1000104@pobox.com>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
Message-ID: <48931775.9010601@pobox.com>

Christopher Hunt wrote:
> Hi Frank et. al,
> 
> Sorry to be a pest. I've been trying tons of things, trawling tons of 
> search results, and I'm really no better off than I was a few days ago. :-P
> 
> In summary I have an aerial photo image of an airport with three well 
> known points (expressed in lat/longs). I'm wanting the image to be 
> projected using a equidistant cylindrical projection.
> 
> On gdal_translate's gcps, I'm presuming that the origin of the image is 
> assumed to be top-left for the gcp pixel and line values... and that the 
> gcp easting and northing values are expressed in metres?

Chris,

Correct.

> How do I centre a projection? lat_0 and lon_0 values?
> 
> Thanks again for your time - I appreciate that time is precious.

I honestly believe that reprojection is the wrong tool to take a raw
aerial photo and try to turn into an orthophoto.  Normally this process
is address by orthorectification software that takes into account the
geometry of the camera lens, the orientation of the camera when the photo
is taken, and the elevation model of the target region.

If you are going to try and accomplish orthorectification by something as
simple as reprojection then the fit is going to be relatively poor in all
but the most ideal circumstances.

So, sorry to say it, but I'm not going to wrack my brain to try and solve
a problem that I think is likely insolvable.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Fri Aug  1 10:08:50 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 10:09:00 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <489315F3.6020408@pobox.com>
References: <200808010743.05424.patrick.cannon@barcosoft.com>
	<489315F3.6020408@pobox.com>
Message-ID: <489318F2.8010101@loskot.net>

Frank Warmerdam wrote:
> At this point I'd normally try running in the debugger to track down
> the failure, and/or running things under something like valgrind.

If Patrick uses POSIX system, then I'd try to write a test program
and monitor errno value if it's gets set to EMFILE [1]

[1]
http://www.opengroup.org/onlinepubs/009695399/functions/xsh_chap02_03.html#tag_02_03

-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Fri Aug  1 10:18:46 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 10:18:56 2008
Subject: [gdal-dev] Update existing shape file
In-Reply-To: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
References: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
Message-ID: <48931B46.9010602@loskot.net>

wow wrote:
> Hi,
>   I wanna set new field value to an existing shape file which has been
> opened with update access, but it doesn't work, my code like this:
>  
>   OGRFeature* pFeature = pLayer->GetFeature(2); 
>   int nIdx = pFeature->GetFieldIndex("Name");
>  pFeature->UnsetField(nIdx);
>  pFeature->SetField( "Name", "hanJ reiver" );
>  
>   Anyone give me some advices?

You need to call OGRLayer::SyncToDisk method

http://www.gdal.org/ogr/classOGRLayer.html#ebb07284c734e485d8611b7c8599254f

to get data update flushed to file on disk.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Fri Aug  1 10:42:32 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  1 10:43:08 2008
Subject: [gdal-dev] Update existing shape file
In-Reply-To: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
References: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
Message-ID: <489320D8.2010408@pobox.com>

wow wrote:
> Hi,
>   I wanna set new field value to an existing shape file which has been 
> opened with update access, but it doesn't work, my code like this:
>  
>   OGRFeature* pFeature = pLayer->GetFeature(2); 
>   int nIdx = pFeature->GetFieldIndex("Name");
>  pFeature->UnsetField(nIdx);
>  pFeature->SetField( "Name", "hanJ reiver" );
>  
>   Anyone give me some advices?

Chen Xuexia,

After modifying the in memory feature, you need to write it back to the
file using OGRLayer::SetFeature().

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From warmerdam at pobox.com  Fri Aug  1 10:56:45 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  1 10:57:10 2008
Subject: [gdal-dev] Question about GDAL 1.4.5 release date
In-Reply-To: <7221db410807310952u310076deu92b7f3d5d2e39ef7@mail.gmail.com>
References: <7221db410807310952u310076deu92b7f3d5d2e39ef7@mail.gmail.com>
Message-ID: <4893242D.4030607@pobox.com>

Daniele Romagnoli wrote:
> Hi list,
> we are thinking about tagging a version of our ImageIO-Ext project 
> (actually based on GDAL 1.4.4).
> In such a context I would like to know if a date for the release #1.4.5 
> has already been estimated.
> And what about GDAL 1.5.3?

Daniele,

I'd *like* to proceed with either/both soon, but there is no fixed schedule.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Fri Aug  1 11:11:46 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 11:11:58 2008
Subject: [gdal-dev] Update existing shape file
In-Reply-To: <489320D8.2010408@pobox.com>
References: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
	<489320D8.2010408@pobox.com>
Message-ID: <489327B2.9090700@loskot.net>

Frank Warmerdam wrote:
> wow wrote:
>> Hi,
>>   I wanna set new field value to an existing shape file which has been
>> opened with update access, but it doesn't work, my code like this:
>>  
>>   OGRFeature* pFeature = pLayer->GetFeature(2);   int nIdx =
>> pFeature->GetFieldIndex("Name");
>>  pFeature->UnsetField(nIdx);
>>  pFeature->SetField( "Name", "hanJ reiver" );
>>  
>>   Anyone give me some advices?
> 
> Chen Xuexia,
> 
> After modifying the in memory feature, you need to write it back to the
> file using OGRLayer::SetFeature().

Frank,

SyncToDisk has no effect here?

Ciao,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From ksshannon at gmail.com  Fri Aug  1 15:05:45 2008
From: ksshannon at gmail.com (Kyle Shannon)
Date: Fri Aug  1 15:05:47 2008
Subject: [gdal-dev] OGRSpatialReference::importFromWkt ()
Message-ID: <c28f2e140808011205u42c1a16ctb815a16eb33037de@mail.gmail.com>

Hello all,
I am using OGR Spatial references to reproject points to plot in google
earth.  I read an ascii raster and an associated prj file to define the
source and destination spatial references.  My program gets hung up with a
certain *.prj file containing the text:

PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
GEOGCS["GCS_North_American_1983",
DATUM["D_North_American_1983",
SPHEROID["GRS_1980",6378137.0,298.257222101],TOWGS84[0.0, 0.0, 0.0, 0.0,
0.0, 0.0, 0.0]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Albers"],
PARAMETER["False_Easting",0.0],
PARAMETER["False_Northing",0.0],
PARAMETER["Central_Meridian",-114.9786],
PARAMETER["Standard_Parallel_1",45.54426],
PARAMETER["Standard_Parallel_2",46.12414],
PARAMETER["Latitude_Of_Origin",45.8342],
UNIT["Meter",1.0]]


I assume this is a valid prj, although importFrom Wkt() returns 5, which is
OGRERR_CORRUPT_DATA.  Any advice would be greatly appreciated.  Thank you
for your time.

kss

-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)829-6954
kshannon@fs.fed.us
ksshannon@gmail.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080801/7216b753/attachment.html
From mateusz at loskot.net  Fri Aug  1 15:42:43 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 15:42:50 2008
Subject: [gdal-dev] OGRSpatialReference::importFromWkt ()
In-Reply-To: <c28f2e140808011205u42c1a16ctb815a16eb33037de@mail.gmail.com>
References: <c28f2e140808011205u42c1a16ctb815a16eb33037de@mail.gmail.com>
Message-ID: <48936733.8070105@loskot.net>

Kyle Shannon wrote:
> Hello all,
> I am using OGR Spatial references to reproject points to plot in google
> earth.  I read an ascii raster and an associated prj file to define the
> source and destination spatial references.  My program gets hung up with a
> certain *.prj file containing the text:
> 
> PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
> GEOGCS["GCS_North_American_1983",
> DATUM["D_North_American_1983",
> SPHEROID["GRS_1980",6378137.0,298.257222101],TOWGS84[0.0, 0.0, 0.0, 0.0,
> 0.0, 0.0, 0.0]],
> PRIMEM["Greenwich",0.0],
> UNIT["Degree",0.0174532925199433]],
> PROJECTION["Albers"],
> PARAMETER["False_Easting",0.0],
> PARAMETER["False_Northing",0.0],
> PARAMETER["Central_Meridian",-114.9786],
> PARAMETER["Standard_Parallel_1",45.54426],
> PARAMETER["Standard_Parallel_2",46.12414],
> PARAMETER["Latitude_Of_Origin",45.8342],
> UNIT["Meter",1.0]]
> 
> 
> I assume this is a valid prj, although importFrom Wkt() returns 5, which is
> OGRERR_CORRUPT_DATA.  Any advice would be greatly appreciated.  Thank you
> for your time.

Kyle,

Yes, this is valid .prj file but the WKT definition it stores
is not OGC WKT;

It reminds this (compare with ESRI WKT link output):

http://spatialreference.org/ref/epsg/102003/

but parameters are slightly different.


I'd suggest you to try to call ImportFromESRI  instead of ImportFromWkt.
It should handle it, I hope,

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From patrick.cannon at barcosoft.com  Fri Aug  1 15:59:32 2008
From: patrick.cannon at barcosoft.com (Patrick Cannon)
Date: Fri Aug  1 15:53:54 2008
Subject: [gdal-dev] GDALDataset limits?
In-Reply-To: <489315F3.6020408@pobox.com>
References: <200808010743.05424.patrick.cannon@barcosoft.com>
	<489315F3.6020408@pobox.com>
Message-ID: <200808011459.32477.patrick.cannon@barcosoft.com>

Hello Frank and everyone,

Thank you for the replies.

As Daniel and many of you suggested I checked the file handles and it is the 
issue. I had forgotten about that as I was stepping through the software.

We have to have a lot of files open at one time in order to provide 
for "quiltting" of the images.  I was planning to optimize how we load the 
layers and now I have a good reason to move if from "plan" to the "todo" 
list.  I think we can get away with around 100 open files and still cover 
the viewing area.

I apologize for not making my explanation of what was happening clearer.

When I said "?If I manually open the files it says can not be found, it 
opens them without issue. " I left out the part about restarting the 
program and not using the "auto" load feature.  When it gave me the file as 
not found, I restarted the program and manually opened the file.  At that 
point I only had 1 dataset open so naturally it worked.

Again, thank you all for your help!


Best regards,
Patrick Cannon
Barco Software LLC

On Friday 01 August 2008 08:56:03 am you wrote:
> Patrick Cannon wrote:
> > Hi Frank,
> >
> > Is there a limit to the number of GDALDatasets that can be open at one
> > time?
> >
> > My program is set to automatically open raster images from a database.
> > There are over 2254 charts in the database.  Each record has the path
> > to the actual file on disk.
> >
> > In auto mode it gets to around 1004 or so files and then GDAL starts
> > returning "file not found" errors.
>
> Patrick,
>
> My first guess would be a file handle limit, as others have mentioned.
>
>  > If I manually open the files it says can not be found, it opens them
>  > without issue.
>
> I'm afraid I don't understand this.  The "says it can not be found"
> and "opens them without issue" parts of this sentance seem to conflict.
>
>  > So the file is available on
> >
> > disk.  Also, if I change the sort on the database so it loads from the
> > bottom it has no problem opening the files in auto mode.
>
> You are saying that you can open at 2254 charts fine if you open them in
> a different order than the default?  That is odd behavior!
>
> At this point I'd normally try running in the debugger to track down
> the failure, and/or running things under something like valgrind.
>
> Best regards,


From ksshannon at gmail.com  Fri Aug  1 16:45:53 2008
From: ksshannon at gmail.com (Kyle Shannon)
Date: Fri Aug  1 16:45:56 2008
Subject: [gdal-dev] OGRSpatialReference::importFromWkt ()
In-Reply-To: <48936733.8070105@loskot.net>
References: <c28f2e140808011205u42c1a16ctb815a16eb33037de@mail.gmail.com>
	<48936733.8070105@loskot.net>
Message-ID: <c28f2e140808011345m641bf1f2kf2b5ddc6c67e709c@mail.gmail.com>

Thank you Mateusz,
I called CPLLoad() to initialize a list of strings and then called
ImportFromEsri() with that string and it worked.  Thanks again.

kss

On Fri, Aug 1, 2008 at 1:42 PM, Mateusz Loskot <mateusz@loskot.net> wrote:

> Kyle Shannon wrote:
>
>> Hello all,
>> I am using OGR Spatial references to reproject points to plot in google
>> earth.  I read an ascii raster and an associated prj file to define the
>> source and destination spatial references.  My program gets hung up with a
>> certain *.prj file containing the text:
>>
>> PROJCS["USA_Contiguous_Albers_Equal_Area_Conic_USGS_version",
>> GEOGCS["GCS_North_American_1983",
>> DATUM["D_North_American_1983",
>> SPHEROID["GRS_1980",6378137.0,298.257222101],TOWGS84[0.0, 0.0, 0.0, 0.0,
>> 0.0, 0.0, 0.0]],
>> PRIMEM["Greenwich",0.0],
>> UNIT["Degree",0.0174532925199433]],
>> PROJECTION["Albers"],
>> PARAMETER["False_Easting",0.0],
>> PARAMETER["False_Northing",0.0],
>> PARAMETER["Central_Meridian",-114.9786],
>> PARAMETER["Standard_Parallel_1",45.54426],
>> PARAMETER["Standard_Parallel_2",46.12414],
>> PARAMETER["Latitude_Of_Origin",45.8342],
>> UNIT["Meter",1.0]]
>>
>>
>> I assume this is a valid prj, although importFrom Wkt() returns 5, which
>> is
>> OGRERR_CORRUPT_DATA.  Any advice would be greatly appreciated.  Thank you
>> for your time.
>>
>
> Kyle,
>
> Yes, this is valid .prj file but the WKT definition it stores
> is not OGC WKT;
>
> It reminds this (compare with ESRI WKT link output):
>
> http://spatialreference.org/ref/epsg/102003/
>
> but parameters are slightly different.
>
>
> I'd suggest you to try to call ImportFromESRI  instead of ImportFromWkt.
> It should handle it, I hope,
>
> Best regards
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>



-- 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)829-6954
kshannon@fs.fed.us
ksshannon@gmail.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080801/d6cb573e/attachment.html
From tutey at o2.pl  Fri Aug  1 18:42:41 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Fri Aug  1 18:41:09 2008
Subject: [gdal-dev] HFA_USE_RRD vs USE_RRD
Message-ID: <48939161.2050302@o2.pl>

Hi!

If I use the followiwng syntax:

  gdaladdo --config HFA_USE_RRD YES --config USE_RRD YES some.tif 2 4 8

a small aux file and a big rrd file are created. If I use:

  gdaladdo --config USE_RRD YES some.tif 2 4 8

only a big aux is created.

In the 1st case the sum of aux and rrd file sizes is equal the size of
the aux file from the 2nd case.

What is the difference between the 2 methods, is any better (in what
terms) and could gdaladdo man page please address these issues
(currently it only mentions USE_RRD alone).

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From mateusz at loskot.net  Fri Aug  1 19:04:01 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  1 19:04:07 2008
Subject: [gdal-dev] HFA_USE_RRD vs USE_RRD
In-Reply-To: <48939161.2050302@o2.pl>
References: <48939161.2050302@o2.pl>
Message-ID: <48939661.9010107@loskot.net>

Maciej Sieczka wrote:
> Hi!
> 
> If I use the followiwng syntax:
> 
>  gdaladdo --config HFA_USE_RRD YES --config USE_RRD YES some.tif 2 4 8
> 
> a small aux file and a big rrd file are created. If I use:
> 
>  gdaladdo --config USE_RRD YES some.tif 2 4 8
> 
> only a big aux is created.
> 
> In the 1st case the sum of aux and rrd file sizes is equal the size of
> the aux file from the 2nd case.
> 
> What is the difference between the 2 methods, is any better (in what
> terms) and could gdaladdo man page please address these issues
> (currently it only mentions USE_RRD alone).

The HFA_USE_RRD controls native overviews builder implemented 
specifically for a driver, HFA in this case.

The USE_RRD controls so called default overviews builder, for drivers 
that do not support it natively.

However, I'm unable to give in depth explanation what is the differences 
between these two types of overviews for HFA.

Greetings,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From nikos.alexandris at felis.uni-freiburg.de  Sat Aug  2 08:37:52 2008
From: nikos.alexandris at felis.uni-freiburg.de (Nikos Alexandris)
Date: Sat Aug  2 08:37:57 2008
Subject: [gdal-dev] GRASS export GeoTiff adventure :-)
Message-ID: <1217680672.12281.36.camel@vertical>

Many questions... Thank you in advance, Nikos :-)

Importing RGB tiff's (size: 2500, 2500 --- with INTERLEAVE=PIXEL) in
GRASS' database splits them, as expected, in red, green and blue raster
maps. After MASKing out unwanted areas, how should one export the maps
to end-up with tiff files similar (or improved) to the original ones?

1. Using r.composite and exporting with r.out.gdal gives "white" as
nodata. Whenever I set "nodata=0" I don't get a viewable photo

2. r.out.tiff does not provide a "nodata" option. What's the necessity
of r.out.tiff if r.out.gdal can do the same with more options?

3. GeoTiff metadata are lost always (?) while exporting with
r.out.gdal. 

4. The createopt="INTERLEAVE=PIXEL" is not respected by r.out.gdal (?)

e.g.
r.out.gdal in=koblenz_2618_5566.red_i type=Byte
out=/home/nik/grassdb/rlp_fgaps/data/orthophotos/koblenz/test/koblenz_2618_5566.red_i2 createopt="INTERLEAVE=PIXEL,TFW=YES"

gdalinfo koblenz_2618_5566.red_i2
[...]
INTERLEAVE=BAND
[...]


5. What is the correct way to import an rgb photo, process, export back
in GeoTiff?

6. Is it better to export the red, green and blue GRASS raster maps
one-by-one and merge them with gdal_translate (or gdal_merge.py)?

7. Exporting a group (the ones that automatically are created for each
imported photo and contain the red, green and blue components
respectively), gives "INTERLEAVE=PIXEL" but "Block=2500x3". Is it
correct to force createopt="BLOCKYSIZE=1" which gives "Block=2500x1"? 

8. I read in Markus' blog [1] how to "write out a GRASS raster map to
GeoTIFF -- this format 
includes the coordinates within the file's metadata" using
gdal_translate.
Doesn't r.out.gdal do that and if not why?

There is also that tiles provide "Fast image display...". From my small
experience, I can't really judge if TILES accelerate image display.
Sometimes I have the impression that they are slower that STRIPPED
tiffs.

8. There are several compression methods? Does compression affect
significantly reading/displaying an image?

9. Should one prefer another file format?

[1]
http://gfoss.blogspot.com/2008/06/gdal-raster-data-tips-and-tricks.html

From warmerdam at pobox.com  Sat Aug  2 09:20:21 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Aug  2 09:20:55 2008
Subject: [gdal-dev] HFA_USE_RRD vs USE_RRD
In-Reply-To: <48939161.2050302@o2.pl>
References: <48939161.2050302@o2.pl>
Message-ID: <48945F15.4020505@pobox.com>

Maciej Sieczka wrote:
> Hi!
> 
> If I use the followiwng syntax:
> 
>  gdaladdo --config HFA_USE_RRD YES --config USE_RRD YES some.tif 2 4 8
> 
> a small aux file and a big rrd file are created. If I use:
> 
>  gdaladdo --config USE_RRD YES some.tif 2 4 8
> 
> only a big aux is created.
> 
> In the 1st case the sum of aux and rrd file sizes is equal the size of
> the aux file from the 2nd case.
> 
> What is the difference between the 2 methods, is any better (in what
> terms) and could gdaladdo man page please address these issues
> (currently it only mentions USE_RRD alone).

Maciek,

The HFA_USE_RRD was implemented at the request of a client to mimic the
behavior of another application.   It isn't really any better than just
putting the overviews in the .aux file.  If you file a ticket I'll try and
document things somewhat better.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Sat Aug  2 09:20:59 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug  2 09:21:04 2008
Subject: [gdal-dev] Why warp.py tests disabled?
Message-ID: <48945F3B.4080500@loskot.net>

Andrey,

Could you tell me why some test cases of warp.py have been
disabled [1] ? The log message does not say much about.

http://trac.osgeo.org/gdal/changeset/14617

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Sat Aug  2 09:29:53 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Aug  2 09:30:15 2008
Subject: [gdal-dev] Update existing shape file
In-Reply-To: <489327B2.9090700@loskot.net>
References: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
	<489320D8.2010408@pobox.com> <489327B2.9090700@loskot.net>
Message-ID: <48946151.4000206@pobox.com>

Mateusz Loskot wrote:
> Frank Warmerdam wrote:
>> wow wrote:
>>> Hi,
>>>   I wanna set new field value to an existing shape file which has been
>>> opened with update access, but it doesn't work, my code like this:
>>>  
>>>   OGRFeature* pFeature = pLayer->GetFeature(2);   int nIdx =
>>> pFeature->GetFieldIndex("Name");
>>>  pFeature->UnsetField(nIdx);
>>>  pFeature->SetField( "Name", "hanJ reiver" );
>>>  
>>>   Anyone give me some advices?
>> Chen Xuexia,
>>
>> After modifying the in memory feature, you need to write it back to the
>> file using OGRLayer::SetFeature().
> 
> Frank,
> 
> SyncToDisk has no effect here?

Mateusz,

When you read a feature with GetFeature(), and then modify that feature
you are modifying an essentially "free standing" feature - not a proxy for
a feature in the layer.  There is no presumed effect on the layer till you
write the feature back using SetFeature().  After that SyncToDisk() might
be helpful to ensure the feature isn't being cached by the driver - that is
to ensure it actually gets written to disk.

The important distinction here is that GetFeature(), and GetNextFeature()
are returning a feature that you can modify, etc without having any effect
on the layer.  They are essentially free standing (though they do depend
on the definition of the layer - so you really should not add fields to
a layer when features exist that use it's definition for instance).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Sat Aug  2 10:38:47 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug  2 10:38:53 2008
Subject: [gdal-dev] Re: Why warp.py tests disabled?
In-Reply-To: <48945F3B.4080500@loskot.net>
References: <48945F3B.4080500@loskot.net>
Message-ID: <48947177.9050200@loskot.net>

Mateusz Loskot wrote:
> Andrey,
> 
> Could you tell me why some test cases of warp.py have been
> disabled [1] ? The log message does not say much about.
> 
> http://trac.osgeo.org/gdal/changeset/14617

Andrey,


I extended [1] the test case to print some statistics

http://trac.osgeo.org/gdal/changeset/15095

It's interesting that warp_4 test case fails only on
two slaves: epimetheus-full (GCC 4.0.1)
and mloskot-gcc43-full (GCC 4.3.1) with following report:

Logical AND on matrix values failed. Expected values <= 1.000000 in 
matrix with min=0.000000 and max=255..000000

Does it mean the value treshold is incorrect for the test data
being used here?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From keo at keo.cz  Sat Aug  2 12:47:04 2008
From: keo at keo.cz (=?ISO-8859-1?Q?V=E1clav_Klus=E1k?=)
Date: Sat Aug  2 12:47:07 2008
Subject: [gdal-dev] SoC Report: GDAL TMS driver
Message-ID: <aeac0d590808020947p4c86f99fs4c4fbb08ecdd1b33@mail.gmail.com>

Report for 14.7. -- 2.8. 2008.

Warning: lengthy and somewhat depressing account of my doings follows.

First two weeks I spent in a scout camp. Kids were great, no work on GDAL
though.

Then I returned back to the driver. I started experimenting with the
simplified cache as mentioned in the previous report, hoping that I would
discover the data mangling bug in the process. Which I did. It was due to an
incorrect calculation of the gap on the top of tiles which caused the whole
image to be shifted one block up. Fixed that. Reading now works without a
hitch for me.

After that I spent some time on proper input validation and overall
hardening. So far so good.

But for the whole time I have been pondering about the IO performance and
how to do it best. The problem is this.

GDAL uniformly touches raster data in bandwise, top-down, left-right order.
This is the exact opposite of what TMS driver needs. As I have written in
the last post, TMS tiles doesn't map 1:1 to GDAL blocks. Two tiles, one
above the other, contain data for one block. To be efficient, the driver
must therefore cache the tiles. But in the top-down left-right order this
means that two whole lines of tiles must be in cache at all times. For
example, sixteen megabytes of memory is enough for sixty four png tiles
256x256 pixels. So the driver will efficiently operate only on requests that
read at most 32x256 = 8192 pixels wide raster.

If the driver could work in the left-right top-down order, however, only the
two tiles composing a single block would have to be cached.

Same goes for bands. The default implementation of Dataset::IRasterIO just
calls RasterBand::IRasterIO on each band in turn. And while one line of
tiles might usualy fit into cache, the whole raster most definitely
wouldn't. This means that for png tiles, each file would be touched four
times.

Therefore the optimal order is left-right, top-down, bandwise. This way,
each tile file is read/written only once. How could this be achieved? The
only place where all necessary information is present is the
Dataset::IRasterIO method, because only it can know which bands were
requested. So, my idea was to write Dataset::IRasterIO to use some other
generic method DoIO based on the default IRasterIO but with the optimal
order of access. RasterBand::IRasterIO would call DoIO on its dataset with
appropriate arguments. DoIO would have to find the best overview when
reading and write into all overviews of course.

So I started to dig into that. I finished the basic structure and decided to
test it to see if all methods were called correctly.

NOOOOOOOOOOOOOOO!!!

They weren't of course. Mainly because gdal_translate (which I have been
using for testing) doesn't even call Dataset::RasterIO. It loops through the
raster bands and adds them one after each other to the output dataset.
Exactly what it must not do in order to achieve optimality. And this is not
an exception. The notion of raster band seems to be pilar, and the various
parts of GDAL code use them frequently.

So, what do I do?

One theoreticaly possible way to optimise writing is to just store IO
requests in some data structure and only in the FlushCache method optimise
and actualy do them. But nothing like this is possible for reading since the
caller expects the data to be transferred at the end of the call. I don't
see a way out, the TMS driver will be slow and will thrash the hard drive.

To sum up what I have in my hands right now:

Reading TMS datasets works. The infrastructure for writing blocks is mostly
in place (ten or so lines missing) but I don't have the code that creates
new datasets in the filesystem yet. The cache works but should be improved a
little. All this could be finished in a day or two. After that comes the
rest of GDALDataset boilerplate: transformations, GCPs etc. These I haven't
studied much yet.

Keo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080802/f51965f6/attachment.html
From karthik3186 at gmail.com  Sun Aug  3 06:25:13 2008
From: karthik3186 at gmail.com (Karthik)
Date: Sun Aug  3 06:27:42 2008
Subject: [gdal-dev] SDTS elevation values
Message-ID: <011f01c8f553$3ac35670$b04a0350$@com>

Skipped content of type multipart/alternative-------------- next part --------------
#include <iostream>
#include "sdts_al.h"
#include <stdlib.h>
#include <math.h>
using namespace std;


int east, south, west, north;
int latitudePosts, longitudePosts;
SDTSRasterReader oSDTSRasterReader;
char _szFMT[32];
double xres, yres, tlEasting, tlNorthing, brEasting, brNorthing;
double adfTransform[6];

//Reads a block of raw data from the XXXXCEL0.DDF and interprets
//it as int/float depending on the type of the data.
void getBlock(int row, float elevations[]) {
        int nBytes = oSDTSRasterReader.GetRasterType()==1?2:4;
        char *pabyData = (char*)CPLMalloc(nBytes * longitudePosts);
        oSDTSRasterReader.GetBlock(0, row, pabyData);
        int j=0;
        for(int i=0; i<nBytes * longitudePosts; i+=nBytes) {
                char buffer[nBytes];
                memcpy(buffer, pabyData+i, nBytes);
                if (nBytes == 2) {
                        short *elevation = (short *)buffer;
                        elevations[j++] = (float)*elevation;
                } else if(EQUAL(_szFMT,"BI32") ) {
                        int *elevation = (int *)buffer;
                        elevations[j++] = (float)*elevation;
                } else {
                        float *elevation = (float *)buffer;
                        elevations[j++] = (float)*elevation;
                }
        }
        CPLFree(pabyData);
}

//Helper routine to calculate absolute elevation at a point
double getElevationAtPoint(int col, int row) {
        float elevations[longitudePosts];
        getBlock(row-1, elevations);
        return elevations[col];
}

//The following code's logic follows directly from - http://en.wikipedia.org/wiki/Bilinear_interpolation
float interpolate (int x1, int y2, double x, double y) {

        int x2 = x1 + 1;
        int y1 = y2 + 1;

        cout << "Four surrounding posts are - (" << x1 << "," << y1 << ") " <<
                                             "(" << x2 << "," << y1 << ") " <<
                                             "(" << x1 << "," << y2 << ") " <<
                                             "(" << x2 << "," << y2 << ") " << endl;


        double a00 = getElevationAtPoint(x1, y1);
        double a10 = getElevationAtPoint(x2, y1);
        double a01 = getElevationAtPoint(x1, y2);
        double a11 = getElevationAtPoint(x2, y2);

        cout << "The elevations at these points are : " << a00 << " " << a10 << " " << a01 << " " << a11 << endl;
        double x1_ = tlEasting + xres * x1;
        double y1_ = tlNorthing - yres * y1;
        double x2_ = tlEasting + xres * x2;
        double y2_ = tlNorthing - yres * y2;

        double den = (x2_ - x1_) * (y2_ - y1_);
        double term1 = a00 * (x2_ - x) * (y2_ - y)/den;
        double term2 = a10 * (x - x1_) * (y2_ - y)/den;
        double term3 = a01 * (x2_ - x) * (y - y1_)/den;
        double term4 = a11 * (x - x1_) * (y - y1_)/den;
        return term1 + term2 + term3 + term4;
}
//Get the interpolated elevation at the given UTM easting and northing
float getElevation(double easting, double northing) {
        int row = floor((tlNorthing-northing)/xres);
        int col = floor((easting - tlEasting)/yres);
        return interpolate(col, row, easting, northing);
}

int main() {
        DDFRecord *poRecord;
        //Get the CATD file
        char *pszCATD = (char*)malloc(100);
        cout << "Enter the *CATD file\n";
        cin >> pszCATD;

        //Create the SDTS_CATD and SDTS_IREF objects
        SDTS_CATD *poCATD  = new SDTS_CATD();
        SDTS_IREF *poIREF  = new SDTS_IREF();

        //Read the CATD File
        poCATD -> Read (pszCATD);

        //Read the IREF File
        poIREF -> Read (poCATD -> GetModuleFilePath("IREF"));

        //Read the RSDF File
        DDFModule oRSDF;
        oRSDF.Open(poCATD->GetModuleFilePath("RSDF"));
        poRecord = oRSDF.ReadRecord();
        double dfZ;
        //Get the topleft coordinates
        poIREF -> GetSADR(poRecord->FindField( "SADR" ), 1, adfTransform+0, adfTransform+3, &dfZ);
        tlEasting = adfTransform[0];
        tlNorthing = adfTransform[3];

        //Get the x and y resolutions
        xres = poIREF -> dfXRes;
        yres = poIREF -> dfYRes;

        cout << "X and Y Resolution are : " << xres << "," << yres << endl;

        //Get the format in which the elevations are stored.
        DDFModule oDDSH;
        oDDSH.Open(poCATD->GetModuleFilePath("DDSH"));
        poRecord = oDDSH.ReadRecord();
        strcpy( _szFMT, poRecord->GetStringSubfield("DDSH",0,"FMT",0) );


        DDFModule oLDEF;
        oLDEF.Open(poCATD->GetModuleFilePath("LDEF"));
        poRecord = oLDEF.ReadRecord();
        //Get the number of rows and columns (latitude and longitude posts)
		longitudePosts = poRecord->GetIntSubfield( "LDEF", 0, "NCOL", 0 );
        latitudePosts = poRecord->GetIntSubfield( "LDEF", 0, "NROW", 0 );

        char szINTR[5];
        strcpy(szINTR, poRecord -> GetStringSubfield(  "LDEF", 0, "INTR", 0 ) );
        //if the TL coordinates are actually the center pixel, shift them to left and
        //top by half pixel
        if (EQUAL(szINTR, "CE")) {
                tlEasting -= xres * 0.5;
                tlNorthing -= yres * 0.5;
        }
        cout << "Top Left UTM Coordinates are : " << tlEasting << "," << tlNorthing << endl;

        //Instantiate the Raster Reader for reading a block of elevation values from the
        //CEL0 Module.
        oSDTSRasterReader.Open(poCATD, poIREF, "CEL0");

        cout << "Enter the point at which elevation is needed" << endl;
        double _easting, _northing;
        //Read the points where the elevation is needed
        cin >> _easting >> _northing;

        //calculate the interpolated elevation at this point.
        cout << "Interpolated Elevation : " << getElevation(_easting, _northing) << endl;

}
-------------- next part --------------
A non-text attachment was scrubbed...
Name: makefile
Type: application/octet-stream
Size: 176 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080803/5275b4a6/makefile.obj
From mateusz at loskot.net  Sun Aug  3 08:11:08 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Aug  3 08:11:16 2008
Subject: [gdal-dev] Update existing shape file
In-Reply-To: <48946151.4000206@pobox.com>
References: <tencent_76B899EF78F4C6202FE9B61F@qq.com>
	<489320D8.2010408@pobox.com> <489327B2.9090700@loskot.net>
	<48946151.4000206@pobox.com>
Message-ID: <4895A05C.2020802@loskot.net>

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Frank Warmerdam wrote:
>>> wow wrote:
>>>> Hi,
>>>>   I wanna set new field value to an existing shape file which has been
>>>> opened with update access, but it doesn't work, my code like this:
>>>>  
>>>>   OGRFeature* pFeature = pLayer->GetFeature(2);   int nIdx =
>>>> pFeature->GetFieldIndex("Name");
>>>>  pFeature->UnsetField(nIdx);
>>>>  pFeature->SetField( "Name", "hanJ reiver" );
>>>>  
>>>>   Anyone give me some advices?
>>> Chen Xuexia,
>>>
>>> After modifying the in memory feature, you need to write it back to the
>>> file using OGRLayer::SetFeature().
>>
>> Frank,
>>
>> SyncToDisk has no effect here?
> 
> Mateusz,
> 
> When you read a feature with GetFeature(), and then modify that feature
> you are modifying an essentially "free standing" feature - not a proxy for
> a feature in the layer.  There is no presumed effect on the layer till you
> write the feature back using SetFeature().  After that SyncToDisk() might
> be helpful to ensure the feature isn't being cached by the driver - that is
> to ensure it actually gets written to disk.


Frank,

All it makes sense. I've forgot that feature object has no
reference to its parent layer.

> The important distinction here is that GetFeature(), and GetNextFeature()
> are returning a feature that you can modify, etc without having any effect
> on the layer.  They are essentially free standing (though they do depend
> on the definition of the layer - so you really should not add fields to
> a layer when features exist that use it's definition for instance).

Yes, I got it.

Thanks for the reminding explanation.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From nicholas.g.lawrence at mainroads.qld.gov.au  Sun Aug  3 21:09:06 2008
From: nicholas.g.lawrence at mainroads.qld.gov.au (nicholas.g.lawrence@mainroads.qld.gov.au)
Date: Sun Aug  3 21:26:09 2008
Subject: [gdal-dev] open street map
Message-ID: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>


Can gdal handle an open street map file (*.osm)?

Regards,
nick


***********************************************************************
WARNING: This e-mail (including any attachments) may contain legally
privileged, confidential or private information and may be protected by
copyright. You may only use it if you are the person(s) it was intended
to be sent to and if you use it in an authorised way.  No one is 
allowed to use, review, alter, transmit, disclose, distribute, print 
or copy this e-mail without appropriate authority.

If this e-mail was not intended for you and was sent to you by mistake,
please telephone or e-mail me immediately, destroy any hardcopies of
this e-mail and delete it and any copies of it from your computer
system. Any right which the sender may have under copyright law, and 
any legal privilege and confidentiality attached to this e-mail is not 
waived or destroyed by that mistake.

It is your responsibility to ensure that this e-mail does not contain
and is not affected by computer viruses, defects or interference by
third parties or replication problems (including incompatibility with
your computer system).

Opinions contained in this e-mail do not necessarily reflect the
opinions of the Queensland Department of Main Roads, Queensland
Transport or Maritime Safety Queensland, or endorsed organisations
utilising the same infrastructure.
***********************************************************************

From Martin.Spott at mgras.net  Sun Aug  3 22:13:02 2008
From: Martin.Spott at mgras.net (Martin Spott)
Date: Sun Aug  3 22:14:08 2008
Subject: [gdal-dev] open street map
References: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
Message-ID: <g75oje$skq$1@osprey.mgras.de>

nicholas.g.lawrence@mainroads.qld.gov.au wrote:

> Can gdal handle an open street map file (*.osm)?

I suspect this is not the case, but several people offer OSM data in
Shapefile or other formats. If you're just looking for the most road,
rail and waterway layers, then you might find what you're looking for
at this page:

  http://mapserver.flightgear.org/download.psp

The OSM data at this DB is typically updated twice a month,

	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------
From richard.greenwood at gmail.com  Sun Aug  3 23:23:53 2008
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sun Aug  3 23:23:56 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <48931775.9010601@pobox.com>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<487D5C8C.1000104@pobox.com>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
Message-ID: <ae9185aa0808032023y51aa0069k4f82ee7999e1bd3c@mail.gmail.com>

On Fri, Aug 1, 2008 at 8:02 AM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Christopher Hunt wrote:
>>
>> Hi Frank et. al,
>>
>> Sorry to be a pest. I've been trying tons of things, trawling tons of
>> search results, and I'm really no better off than I was a few days ago. :-P
>>
>> In summary I have an aerial photo image of an airport with three well
>> known points (expressed in lat/longs). I'm wanting the image to be projected
>> using a equidistant cylindrical projection.
>>
>> On gdal_translate's gcps, I'm presuming that the origin of the image is
>> assumed to be top-left for the gcp pixel and line values... and that the gcp
>> easting and northing values are expressed in metres?
>
> Chris,
>
> Correct.
>
>> How do I centre a projection? lat_0 and lon_0 values?
>>
>> Thanks again for your time - I appreciate that time is precious.
>
> I honestly believe that reprojection is the wrong tool to take a raw
> aerial photo and try to turn into an orthophoto.  Normally this process
> is address by orthorectification software that takes into account the
> geometry of the camera lens, the orientation of the camera when the photo
> is taken, and the elevation model of the target region.
>
> If you are going to try and accomplish orthorectification by something as
> simple as reprojection then the fit is going to be relatively poor in all
> but the most ideal circumstances.
>
> So, sorry to say it, but I'm not going to wrack my brain to try and solve
> a problem that I think is likely insolvable.

I'm coming into this thread pretty late, but I think Frank is on the
right track. You can't assume that your photo is orthorectified. If it
were, you probably would not need to provide GCPs because control
points would have been required to rectify it in the first place.

Does the image have a collar, possibly with fiducial marks (usually 8
small "+" marks at the edges) and other info? If so it was taken with
a "real" photogrammetric camera. If the collar edges are wavy (not
perfectly straight and square), then the image may indeed have been
ortorectified and you probably can simply project it. If the collar
edges are perfectly straight, then it probably hasn't been rectified.
GRASS has a great ortho rectification module for working on single
images.

If your image does not have a collar, then you are really guessing.
And in any case, if you can get some info from who ever produced the
image, you could greatly reduce the guessing.

Rich

-- 
Richard Greenwood
richard.greenwood@gmail.com
www.greenwoodmap.com
From jukka.rahkonen at mmmtike.fi  Mon Aug  4 01:54:28 2008
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon Aug  4 01:54:45 2008
Subject: [gdal-dev] Re: open street map
References: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
	<g75oje$skq$1@osprey.mgras.de>
Message-ID: <loom.20080804T053924-12@post.gmane.org>

Martin Spott <Martin.Spott <at> mgras.net> writes:

> 
> nicholas.g.lawrence <at> mainroads.qld.gov.au wrote:
> 
> > Can gdal handle an open street map file (*.osm)?
> 
> I suspect this is not the case, but several people offer OSM data in
> Shapefile or other formats. If you're just looking for the most road,
> rail and waterway layers, then you might find what you're looking for
> at this page:
> 
>   http://mapserver.flightgear.org/download.psp
> 
> The OSM data at this DB is typically updated twice a month,

Another source for ready made shapefiles is http://download.geofabrik.de/osm

If you use PostGIS then quite a good way for translating OSM data to other
formats or publish it through MapServer is to import the data fist to PostGIS
with  osm2pgsql utility.  Source code for Linus users is here:
http://trac.openstreetmap.org/browser/applications/utils/export/osm2pgsql
Windows version (not up to date, but works) can be found here:
http://artem.dev.openstreetmap.org/files/

It would be nice to have a direct GDAL driver for OSM data, though.

-Jukka Rahkonen-


From mateusz at loskot.net  Mon Aug  4 05:53:40 2008
From: mateusz at loskot.net (=?UTF-8?B?TWF0ZXVzeiDFgW9za290?=)
Date: Mon Aug  4 05:53:47 2008
Subject: [gdal-dev] open street map
In-Reply-To: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
References: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
Message-ID: <4896D1A4.7050100@loskot.net>

nicholas.g.lawrence@mainroads.qld.gov.au pisze:
> Can gdal handle an open street map file (*.osm)?
> 
> Regards,
> nick

Nick,

There is no OSM support now. It was proposed for GSoC 2008 [1] but not 
started.

[1] http://trac.osgeo.org/gdal/wiki/SummerOfCode


> ***********************************************************************
> WARNING: This e-mail (including any attachments) may contain legally
> privileged, confidential or private information and may be protected by
> copyright. You may only use it if you are the person(s) it was intended
> to be sent to and if you use it in an authorised way.  No one is 
> allowed to use, review, alter, transmit, disclose, distribute, print 
> or copy this e-mail without appropriate authority.
> 
> If this e-mail was not intended for you and was sent to you by mistake,
> please telephone or e-mail me immediately, destroy any hardcopies of
> this e-mail and delete it and any copies of it from your computer
> system. Any right which the sender may have under copyright law, and 
> any legal privilege and confidentiality attached to this e-mail is not 
> waived or destroyed by that mistake.
> 
> It is your responsibility to ensure that this e-mail does not contain
> and is not affected by computer viruses, defects or interference by
> third parties or replication problems (including incompatibility with
> your computer system).
> 
> Opinions contained in this e-mail do not necessarily reflect the
> opinions of the Queensland Department of Main Roads, Queensland
> Transport or Maritime Safety Queensland, or endorsed organisations
> utilising the same infrastructure.
> ***********************************************************************

Nice sig :-)

Ciao,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From Martin.Spott at mgras.net  Mon Aug  4 06:03:04 2008
From: Martin.Spott at mgras.net (Martin Spott)
Date: Mon Aug  4 06:04:08 2008
Subject: [gdal-dev] Re: open street map
References: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
	<loom.20080804T053924-12@post.gmane.org>
Message-ID: <g76k4o$n4s$1@osprey.mgras.de>

Jukka Rahkonen wrote:
> Martin Spott <Martin.Spott <at> mgras.net> writes:

> >   http://mapserver.flightgear.org/download.psp
> > 
> > The OSM data at this DB is typically updated twice a month,

> Another source for ready made shapefiles is http://download.geofabrik.de/osm

Yup, and we know each other personally  :-)
Actually, their approach and the service I'm offering are of different
nature and aim a different target. My database is oriented at
delivering all the stuff that is required for building flight
simulation terrain, thus for example leaving mailboxes and pubs out
(don't drink and fly  ;-)
On the other hand, the FlightGear MapServer site offers the entire
coverage to the date when the import was done and you're free to chose
your bounding box. We're hosting the data anyway, so providing
on-the-fly Shapefile downloads for all of the listed layers was sort of
a side-effect.

So, if you're interesed in a feature-rich representation of a single
European country, then Geofabrik's offer certainly is the best bet for
you. If you just need individual chunks of the most visible line data
at every place of the OSM entire coverage, then visit the FlightGear
MapServer.

> If you use PostGIS then quite a good way for translating OSM data to other
> formats or publish it through MapServer is to import the data fist to PostGIS
> with  osm2pgsql utility.

This is what I'm doing at the FlightGear Mapserver.


While we are at it: I'm not entirely certain that having an OGR driver
to read OSM is really a sane solution. The OSM format resembles a
moving target and those guys at OSM, who decide when to make a format
switch, are not the sort of people who happily negotiate 'release'
dates with 'external' efforts that might be affected by such a switch.
In other words: If you're going to integrate an OSM reader into OGR,
then chances are high that the most recent GDAL release is most of the
time going to be behind the current state of affairs with the OSM
format ....

In my eyes it's much more clever to rely on a tool ('osm2pgsql') whose
development resides at the heart of the OSM project itself and
therefore is accurately in sync with the current OSM format.

Cheers,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------
From timmichelsen at gmx-topmail.de  Mon Aug  4 09:27:17 2008
From: timmichelsen at gmx-topmail.de (Tim Michelsen)
Date: Mon Aug  4 09:27:35 2008
Subject: [gdal-dev] reprojecting a georeferenced image (PNG, JPG)
Message-ID: <loom.20080804T125825-537@post.gmane.org>

Hello,
I have a PNG file with some transparent areas.
I used QGIS to georeference the file using the latlon/WGS84 projection settings.
Within this process, a world file (*.wld) and a point file where created.

Now, I'd like to reproject this image into another projection.

How do I have run gadlwarp that:
* the transparen regions in the PNG are being maintained tranparent and
* a new word file is written which corresponds to the new projection settings?

I tried to run the program with "-worldfile=yes" but no new worlfile was written.

Thanks in advance,
Timmie

From mateusz at loskot.net  Mon Aug  4 09:42:12 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug  4 09:42:20 2008
Subject: [gdal-dev] reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <loom.20080804T125825-537@post.gmane.org>
References: <loom.20080804T125825-537@post.gmane.org>
Message-ID: <48970734.8090705@loskot.net>

Tim Michelsen wrote:
> Hello,
> I have a PNG file with some transparent areas.
> I used QGIS to georeference the file using the latlon/WGS84 projection settings.
> Within this process, a world file (*.wld) and a point file where created.
> 
> Now, I'd like to reproject this image into another projection.
> 
> How do I have run gadlwarp that:
> * the transparen regions in the PNG are being maintained tranparent and
> * a new word file is written which corresponds to the new projection settings?
> 
> I tried to run the program with "-worldfile=yes" but no new worlfile was written.

Tim,

You have not shown us the exact command you tried, but have you included
-t_srs option, and name of source and output files?

Regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From christian.mueller at nvoe.at  Mon Aug  4 09:39:55 2008
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Mon Aug  4 09:59:16 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <loom.20080804T125825-537@post.gmane.org>
References: <loom.20080804T125825-537@post.gmane.org>
Message-ID: <20080804133955.21684.qmail@mail.linux4all.at>

run the program with: 

gdlawarp-co "WORLDFILE=YES" .... 

 

Tim Michelsen writes: 

> Hello,
> I have a PNG file with some transparent areas.
> I used QGIS to georeference the file using the latlon/WGS84 projection settings.
> Within this process, a world file (*.wld) and a point file where created. 
> 
> Now, I'd like to reproject this image into another projection. 
> 
> How do I have run gadlwarp that:
> * the transparen regions in the PNG are being maintained tranparent and
> * a new word file is written which corresponds to the new projection settings? 
> 
> I tried to run the program with "-worldfile=yes" but no new worlfile was written. 
> 
> Thanks in advance,
> Timmie 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From Wajid.Khattak at keynetix.com  Mon Aug  4 10:23:22 2008
From: Wajid.Khattak at keynetix.com (wkhattak)
Date: Mon Aug  4 10:23:23 2008
Subject: [Gdal-dev] Problem loading tif files
Message-ID: <18812250.post@talk.nabble.com>


Hi,

I am trying to load up tif based raster data using GDAL provider within MG
Enterprise 2009.I have created a utility that creates the config file
required by GDAL provider. I can see the files referenced by the data
connection within Maestro but the moment I click on 'View Data' within MG,
it comes up with a Debug error & crashes the MG service. On the flip side,
GDAL provider works perfectly with ecw file format (but MG seems to crash
when the same ecw files are viewed using Autodesk's Raster provider which is
apparantly due to the large amount of data that I am trying to display). I
was wondering if someone could shed some light as to what exacly is the
problem?

reagrds,

W Khattak
-- 
View this message in context: http://www.nabble.com/Problem-loading-tif-files-tp18812250p18812250.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Mon Aug  4 10:46:26 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug  4 10:46:35 2008
Subject: [gdal-dev] reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <48970734.8090705@loskot.net>
References: <loom.20080804T125825-537@post.gmane.org>
	<48970734.8090705@loskot.net>
Message-ID: <48971642.2030804@loskot.net>

Tim Michelsen wrote:
> I tried to run the program with "-worldfile=yes" but no new worlfile was written.

I've just realized and remined to myself there is no such option
available in gdalwarp program. Here you have the doc:

http://www.gdal.org/gdalwarp.html

Also, please don't forget to check this:

http://www.gdal.org/frmt_various.html#PNG

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jukka.rahkonen at mmmtike.fi  Mon Aug  4 12:17:10 2008
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon Aug  4 12:17:24 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
Message-ID: <loom.20080804T160638-837@post.gmane.org>

Christian M?ller <christian.mueller <at> nvoe.at> writes:

> 
> run the program with: 
> 
> gdlawarp-co "WORLDFILE=YES" .... 
> 

Even better for geotiff output is to use -co TFW=YES, because it seems to work
while worldfile=yes does not.  At least it did not work for me as I tried it
with FWTools 2.0.6. 

-Jukka Rahkonen-

From warmerdam at pobox.com  Mon Aug  4 12:45:48 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug  4 12:46:20 2008
Subject: [gdal-dev] SDTS elevation values
In-Reply-To: <011f01c8f553$3ac35670$b04a0350$@com>
References: <011f01c8f553$3ac35670$b04a0350$@com>
Message-ID: <4897323C.4060702@pobox.com>

Karthik wrote:
> Hi,
>                 I have been using GDAL for SDTS raster terrain format 
> for reading DDF files provided by USGS. To get the exact interpolated 
> elevation at a particular point, I used the logic in 
> http://en.wikipedia.org/wiki/Bilinear_interpolation. For verifying 
> whether the values match exactly, I used Global Mapper but I find that 
> the variation of around 6 to 10 occurs and some places around 20. I 
> tried my code on various samples and in almost every sample I get the 
> same observation. I am sure I am missing something. I am attaching the 
> CPP file along with the makefile in this mail.

Kart,

I would suggest doing a bit more specific testing.

Do you get an exact match when you check the center of a pixel (ie. no
bilinear interpolation is required?)

I would suspect an off-by-half-pixel error in positioning, but I'm not
brave enough to dig through your code in detail.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From timmichelsen at gmx-topmail.de  Mon Aug  4 12:56:23 2008
From: timmichelsen at gmx-topmail.de (Tim Michelsen)
Date: Mon Aug  4 12:56:38 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
Message-ID: <loom.20080804T164409-264@post.gmane.org>

> gdlawarp-co "WORLDFILE=YES" .... 
Thanks, this really got me going.

I think the documentation could need some example here...

Kind regards,
Timmie

From mateusz at loskot.net  Mon Aug  4 14:12:41 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug  4 14:12:47 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <loom.20080804T164409-264@post.gmane.org>
References: <loom.20080804T125825-537@post.gmane.org>	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
Message-ID: <48974699.8070801@loskot.net>

Tim Michelsen wrote:
>> gdlawarp-co "WORLDFILE=YES" .... 
> Thanks, this really got me going.
> 
> I think the documentation could need some example here...

Tim,

I think it would lead to maintenance of documents.
Instead, it should be enough to remember that GDAL/OGR documentation
forms a kind of cascade.

- check general utilities doc [1] for options you need
-- not found, next, check utility specific doc [2]
--- if there is no option listed you are looking for
---- next step is to check driver specific options
----- so check driver doc
------ and here [3] you find what you need, creation option WORLDFILE
- back to general utility doc [1] to find how to pass creation option
and you get -co NAME=VALUE


[1] http://www.gdal.org/gdal_utilities.html
[2] http://www.gdal.org/gdalwarp.html
[3] http://www.gdal.org/frmt_various.html#PNG
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From dron at ak4719.spb.edu  Mon Aug  4 02:25:30 2008
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Mon Aug  4 14:38:53 2008
Subject: [gdal-dev] Why warp.py tests disabled?
In-Reply-To: <48945F3B.4080500@loskot.net>
References: <48945F3B.4080500@loskot.net>
Message-ID: <20080804062530.GA32489@ak4719.spb.edu>

On Sat, Aug 02, 2008 at 03:20:59PM +0200, Mateusz Loskot wrote:
> Could you tell me why some test cases of warp.py have been
> disabled [1] ? The log message does not say much about.
> 
> http://trac.osgeo.org/gdal/changeset/14617

Mateusz,

These tests failed on some slaves (AFAIR on x86 hosts). I think it is
due to the floating point issues, either computation errors or
float-to-integer conversion. Actually I don't know what to do about
that. Threshold is 1.0 for byte data type, so it means that we are
having seriously different warping results on different hosts.

At least these tests can be used locally when working with warping code.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517
From chris.melick at baronservices.com  Mon Aug  4 14:53:50 2008
From: chris.melick at baronservices.com (Chris Melick)
Date: Mon Aug  4 14:53:57 2008
Subject: [gdal-dev] GDAL - map projection not specified properly
Message-ID: <001801c8f663$6f1743d0$4d45cb70$@melick@baronservices.com>

Greetings,

 

I have a netcdf file of NCEP model data (originally in GRIB) that I'm
converting over to a GeoTiff.  I'm trying to set up the exact projection for
the AWIPS Lambert conformal grid (#252 - RUC-20km;
http://www.weather.gov/om/tpb/490body.htm) but the data is off center from
what the original GRIB file displays using GEMPAK.  I think the problem lies
in the fact that the lower left and upper right corners exactly mirror those
of the other corners, which isn't what should happen with LCC.  Could
someone please help me with the exact specification of the gdal_translate
command line?  

 

On last try, I have been using:

 

gdal_translate -scale 988 1360 1 256 -ot Byte -a_srs '+proj=lcc +lat_0=39
+lat_1=25 lat_2=25 +lon_0=-95 +datum=GRS80' -a_ullr -139.86 54.17 -69.04
17.34 NETCDF:"lccmod.nc":HGT_875mb lccmod-final.tif

 

 

Thanks,

Chris  

 

 

 

Dr. Christopher J. Melick

Data Services Meteorologist

Ph: 256.881.8811

Fx: 256.881.8283

 <http://www.baronservices.com> www.baronservices.com

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080804/bc63ac2e/attachment.html
From warmerdam at pobox.com  Mon Aug  4 14:54:26 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug  4 14:55:10 2008
Subject: [gdal-dev] Re: SoC Report: GDAL TMS driver
In-Reply-To: <aeac0d590808020947p4c86f99fs4c4fbb08ecdd1b33@mail.gmail.com>
References: <aeac0d590808020947p4c86f99fs4c4fbb08ecdd1b33@mail.gmail.com>
Message-ID: <48975062.1070404@pobox.com>

V?clav Klus?k wrote:
> They weren't of course. Mainly because gdal_translate (which I have been 
> using for testing) doesn't even call Dataset::RasterIO. It loops through 
> the raster bands and adds them one after each other to the output 
> dataset. Exactly what it must not do in order to achieve optimality. And 
> this is not an exception. The notion of raster band seems to be pilar, 
> and the various parts of GDAL code use them frequently.
> 
> So, what do I do?
> 
> One theoreticaly possible way to optimise writing is to just store IO 
> requests in some data structure and only in the FlushCache method 
> optimise and actualy do them. But nothing like this is possible for 
> reading since the caller expects the data to be transferred at the end 
> of the call. I don't see a way out, the TMS driver will be slow and will 
> thrash the hard drive.
> 
> To sum up what I have in my hands right now:
> 
> Reading TMS datasets works. The infrastructure for writing blocks is 
> mostly in place (ten or so lines missing) but I don't have the code that 
> creates new datasets in the filesystem yet. The cache works but should 
> be improved a little. All this could be finished in a day or two. After 
> that comes the rest of GDALDataset boilerplate: transformations, GCPs 
> etc. These I haven't studied much yet.

Keo,

A few suggestions:

1) Per http://trac.osgeo.org/gdal/wiki/rfc14_imagestructure try setting
    the IMAGE_STRUCTURE INTERLEAVE metadata item to PIXEL if the data
    is pixel interleaved.  Some applications and CreateCopy() implementations
    will take advantage of this clue.

2) In your IReadBlock() method try pushing the other bands than the one
    requested into the cache.  This will of course result in extra cache
    churn, but with a big enough cache, and depending on the application
    io strategy this can mean the other bands are already in the cache
    when they are needed.

3) We might consider possible changes to GDALDatasetCopyWholeRaster() for
    tiled data so that whole rows of tiles do not need to be cached.  It
    is in gdal/gcore/rasterio.cpp.  It is used by some of the CreateCopy()
    implementations.

4) To some extent we may just need to educate users to use large cache
    size settings for wide TMS datasets.

The problems you are encountering aren't that different than faced by any
other pixel interleaved tiled format.  They are just a bit more severe with
TMS because we expect large images, the tiles are unusually large, and we
need two rows instead of one.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Mon Aug  4 14:55:13 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug  4 14:55:19 2008
Subject: [gdal-dev] Why warp.py tests disabled?
In-Reply-To: <20080804062530.GA32489@ak4719.spb.edu>
References: <48945F3B.4080500@loskot.net>
	<20080804062530.GA32489@ak4719.spb.edu>
Message-ID: <48975091.7020200@loskot.net>

Andrey Kiselev wrote:
> On Sat, Aug 02, 2008 at 03:20:59PM +0200, Mateusz Loskot wrote:
>> Could you tell me why some test cases of warp.py have been
>> disabled [1] ? The log message does not say much about.
>>
>> http://trac.osgeo.org/gdal/changeset/14617
> 
> Mateusz,
> 
> These tests failed on some slaves (AFAIR on x86 hosts). I think it is
> due to the floating point issues, either computation errors or
> float-to-integer conversion. Actually I don't know what to do about
> that.

Andrey,

Thanks for the explanation. I have no idea either, so perhaps best
is to leave them disabled for now.

> Threshold is 1.0 for byte data type, so it means that we are
> having seriously different warping results on different hosts.

But do you consider these differences of warp_4 results
as effect of an error?

> At least these tests can be used locally when working with warping code.

Yes.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From christian.mueller at nvoe.at  Tue Aug  5 05:31:38 2008
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Tue Aug  5 05:32:22 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <48974699.8070801@loskot.net>
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
Message-ID: <20080805093138.32236.qmail@mail.linux4all.at>

Two years ago, I had the same problem. The cascading documentation
is not obvious when starting with gdal.
(My problem was a CMD LINE BUFFER EXCEEDED error using gdal_merge.py not 
knowing that I can use the general option --optfile). Starting the 
documentation with a brief description of the cascading structure will help 
a lot.). I think Tim is another example. 

 

Mateusz Loskot writes: 

> Tim Michelsen wrote:
>>> gdlawarp-co "WORLDFILE=YES" .... 
>> Thanks, this really got me going. 
>> 
>> I think the documentation could need some example here...
> 
> Tim, 
> 
> I think it would lead to maintenance of documents.
> Instead, it should be enough to remember that GDAL/OGR documentation
> forms a kind of cascade. 
> 
> - check general utilities doc [1] for options you need
> -- not found, next, check utility specific doc [2]
> --- if there is no option listed you are looking for
> ---- next step is to check driver specific options
> ----- so check driver doc
> ------ and here [3] you find what you need, creation option WORLDFILE
> - back to general utility doc [1] to find how to pass creation option
> and you get -co NAME=VALUE 
> 
> 
> [1] http://www.gdal.org/gdal_utilities.html
> [2] http://www.gdal.org/gdalwarp.html
> [3] http://www.gdal.org/frmt_various.html#PNG
> -- 
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From dron at ak4719.spb.edu  Tue Aug  5 04:19:08 2008
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Tue Aug  5 13:07:31 2008
Subject: [gdal-dev] Why warp.py tests disabled?
In-Reply-To: <48975091.7020200@loskot.net>
References: <48945F3B.4080500@loskot.net>
	<20080804062530.GA32489@ak4719.spb.edu>
	<48975091.7020200@loskot.net>
Message-ID: <20080805081908.GA13315@ak4719.spb.edu>

Mateusz,

On Mon, Aug 04, 2008 at 08:55:13PM +0200, Mateusz Loskot wrote:
> > Threshold is 1.0 for byte data type, so it means that we are
> > having seriously different warping results on different hosts.
> 
> But do you consider these differences of warp_4 results
> as effect of an error?

No, it is another kind of problem. It was already reported:

 http://trac.osgeo.org/gdal/ticket/2414

Also I have somewhat improved version of the warping code in the
separate SVN branch, but it is not perfect yet also. See here for
details:

 http://trac.osgeo.org/gdal/ticket/2327

It is possible that #2414 is related to problems fixed in #2327.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517
From mateusz at loskot.net  Tue Aug  5 13:13:08 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Aug  5 13:13:14 2008
Subject: [gdal-dev] Why warp.py tests disabled?
In-Reply-To: <20080805081908.GA13315@ak4719.spb.edu>
References: <48945F3B.4080500@loskot.net>	<20080804062530.GA32489@ak4719.spb.edu>	<48975091.7020200@loskot.net>
	<20080805081908.GA13315@ak4719.spb.edu>
Message-ID: <48988A24.5020000@loskot.net>

Andrey Kiselev wrote:
> Mateusz,
> 
> On Mon, Aug 04, 2008 at 08:55:13PM +0200, Mateusz Loskot wrote:
>>> Threshold is 1.0 for byte data type, so it means that we are 
>>> having seriously different warping results on different hosts.
>> But do you consider these differences of warp_4 results as effect
>> of an error?
> 
> No, it is another kind of problem. It was already reported:
> 
> http://trac.osgeo.org/gdal/ticket/2414
> 
> Also I have somewhat improved version of the warping code in the 
> separate SVN branch, but it is not perfect yet also. See here for 
> details:
> 
> http://trac.osgeo.org/gdal/ticket/2327
> 
> It is possible that #2414 is related to problems fixed in #2327.

Andrey,

Thanks for all these notes. As we have talked on IRC, this problem is
not trivial and will likely require in depth testing. As you've
suggested, I'll leave it to you.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From sfkeller at gmail.com  Tue Aug  5 18:01:43 2008
From: sfkeller at gmail.com (Stefan Keller)
Date: Tue Aug  5 18:01:46 2008
Subject: [gdal-dev] open street map
In-Reply-To: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
References: <OF4B2B28ED.1C59EA72-ON4A25749B.00064252-4A25749B.000653BC@transport.qld.gov.au>
Message-ID: <25bc040b0808051501t45c865abu9b91901000f95fb1@mail.gmail.com>

Nick,

You can download an .osm file from the OSM Slippy Map (main map page) and
upload this to our online 'geoconverter'.

We're using a two step approach to do this:

1. convert .osm to gml by using an XSLT (based on
http://wiki.openstreetmap.org/index.php/Converting_OSM_to_GML)
2. convert gml to Shape or whatever target format ogr2ogr supports.

- S.

2008/8/4 <nicholas.g.lawrence@mainroads.qld.gov.au>

>
> Can gdal handle an open street map file (*.osm)?
>
> Regards,
> nick
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080806/88e4ec51/attachment.html
From warmerdam at pobox.com  Tue Aug  5 18:59:58 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug  5 19:00:34 2008
Subject: [gdal-dev] gdal.org domain interruption
Message-ID: <4898DB6E.9030701@pobox.com>

Folks,

I have migrated the gdal.org domain from my own care at Tucows to OSGeo
administration at pairnic.  There may be up to a four hour interruption in
operation of the gdal.org, www.gdal.org and home.gdal.org domains.  Sorry for
the inconvenience.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From eloquence2 at gmail.com  Wed Aug  6 08:26:32 2008
From: eloquence2 at gmail.com (Dejan Gregor)
Date: Wed Aug  6 08:26:34 2008
Subject: [Gdal-dev] GDAL OGR2OGR does not export Oracle Views
Message-ID: <18850008.post@talk.nabble.com>



Hi, 


I am trying to export an Oracle view (11g) that is made of an Oracle spatial
geometry carrier and an ordinary Oracle table to a Shapefile. so what I want
to export is an Oracle view.


C:\>ogr2ogr -f "ESRI Shapefile" WA_PIPE "OCI:****/****@ORCL:MARIBOR.WA_PIPE_
VIEW"
ERROR 1: ORA-04043: object MARIBOR.WA_PIPE_VIEW does not exist
 in OCIDescribeAny
FAILED: Layer MARIBOR.WA_PIPE_VIEW already exists, and -append not
specified.
        Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation of layer MARIBOR.WA_PIPE_VIEW

What am I doing wrong, can someone help with this?

Thanks!

Dejan



-- 
View this message in context: http://www.nabble.com/GDAL-OGR2OGR-does-not-export-Oracle-Views-tp18850008p18850008.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Wed Aug  6 10:10:19 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug  6 10:10:25 2008
Subject: [Gdal-dev] GDAL OGR2OGR does not export Oracle Views
In-Reply-To: <18850008.post@talk.nabble.com>
References: <18850008.post@talk.nabble.com>
Message-ID: <4899B0CB.3070007@loskot.net>

Dejan Gregor wrote:
> Hi, 
> 
> I am trying to export an Oracle view (11g) that is made of an Oracle spatial
> geometry carrier and an ordinary Oracle table to a Shapefile. so what I want
> to export is an Oracle view.
> 
> C:\>ogr2ogr -f "ESRI Shapefile" WA_PIPE "OCI:****/****@ORCL:MARIBOR.WA_PIPE_
> VIEW"
> ERROR 1: ORA-04043: object MARIBOR.WA_PIPE_VIEW does not exist
>  in OCIDescribeAny
> FAILED: Layer MARIBOR.WA_PIPE_VIEW already exists, and -append not
> specified.
>         Consider using -append, or -overwrite.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer MARIBOR.WA_PIPE_VIEW
> 
> What am I doing wrong, can someone help with this?

Dejan,

Honestly, I'm not sure. Long time ago there was a bug report [1] related
to missing support of views in OCI driver but it has been fixed.


[1] http://trac.osgeo.org/gdal/ticket/394

Can you report your view with ogrinfo?
What the following comamnd reports?

ogrinfo OCI:****/****@ORCL:MARIBOR.WA_PIPE_VIEW


Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From even.rouault at mines-paris.org  Wed Aug  6 17:49:44 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug  6 17:49:52 2008
Subject: [gdal-dev] About palette/color table expansion
Message-ID: <200808062349.45785.even.rouault@mines-paris.org>

Folks,

just a few words to advertize the new capability of color table expansion that 
has been added recently to GDAL trunk (1.6.0dev).

A new option of gdal_translate, -expand rgb|rgba, enables the user to ask for 
the expansion of a single band dataset with a color table and its translation 
to a 3 or 4 band dataset with the R,G,B,A components. Usefull for output 
drivers such as JPEG, JPEG2000, MrSID, ECW that don?t support color indexed 
datasets.

That capability relies on an extension of the VRTComplexSource that adds an 
extra optionnal attribute  
<ColorTableComponent>num_of_the_component</ColorTableComponent>.

You can use color table expansion to warp color indexed datasets with 
resampling methods more sophisticated than simple nearest neighbour, without 
an intermediate file that would have been produced by pct2rgb for example.

For example :
gdal_translate -of VRT -expand rgb color_indexed.tif color_expanded.vrt
gdalwarp -t_srs EPSG:32631 color_expanded.vrt color_expanded_warped.tif

Regards.
From matt.wilkie at gov.yk.ca  Wed Aug  6 17:56:41 2008
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Aug  6 17:56:51 2008
Subject: [gdal-dev] About palette/color table expansion
In-Reply-To: <200808062349.45785.even.rouault@mines-paris.org>
References: <200808062349.45785.even.rouault@mines-paris.org>
Message-ID: <489A1E19.3020008@gov.yk.ca>

Thanks Even!

This perfectly matches a task I have, and lets me cast half a dozen 
scripts I've created with the pctrgb workaround into the compost bin. :)

matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


Even Rouault wrote:
> Folks,
> 
> just a few words to advertize the new capability of color table expansion that 
> has been added recently to GDAL trunk (1.6.0dev).
> 
> A new option of gdal_translate, -expand rgb|rgba, enables the user to ask for 
> the expansion of a single band dataset with a color table and its translation 
> to a 3 or 4 band dataset with the R,G,B,A components. Usefull for output 
> drivers such as JPEG, JPEG2000, MrSID, ECW that don?t support color indexed 
> datasets.
> 
> That capability relies on an extension of the VRTComplexSource that adds an 
> extra optionnal attribute  
> <ColorTableComponent>num_of_the_component</ColorTableComponent>.
> 
> You can use color table expansion to warp color indexed datasets with 
> resampling methods more sophisticated than simple nearest neighbour, without 
> an intermediate file that would have been produced by pct2rgb for example.
> 
> For example :
> gdal_translate -of VRT -expand rgb color_indexed.tif color_expanded.vrt
> gdalwarp -t_srs EPSG:32631 color_expanded.vrt color_expanded_warped.tif
> 
> Regards.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From timmichelsen at gmx-topmail.de  Wed Aug  6 18:08:59 2008
From: timmichelsen at gmx-topmail.de (Tim Michelsen)
Date: Wed Aug  6 18:09:14 2008
Subject: [gdal-dev] Re: reprojecting a georeferenced image (PNG, JPG)
In-Reply-To: <20080805093138.32236.qmail@mail.linux4all.at>
References: <loom.20080804T125825-537@post.gmane.org>	<20080804133955.21684.qmail@mail.linux4all.at>	<loom.20080804T164409-264@post.gmane.org>	<48974699.8070801@loskot.net>
	<20080805093138.32236.qmail@mail.linux4all.at>
Message-ID: <g7d7dr$q83$1@ger.gmane.org>

> Two years ago, I had the same problem. The cascading documentation
> is not obvious when starting with gdal.
> (My problem was a CMD LINE BUFFER EXCEEDED error using gdal_merge.py not 
> knowing that I can use the general option --optfile). Starting the 
> documentation with a brief description of the cascading structure will 
> help a lot.). I think Tim is another example.
Thanks for the support ;-)

I think that gdal/ogr are really useful tools. But the options are just 
that many that one needs some time to find his/her way around. So some 
questions may seem silly to long time users but not to beginners.
Many GIS users only use the GIS GUIs to reformat/reproject GIS data.
Therefore, thanks to all who patiently help out.

Kind regards,
Timmie

From gok at aerometric-ak.com  Wed Aug  6 21:35:32 2008
From: gok at aerometric-ak.com (Gennady Khokhorin)
Date: Wed Aug  6 21:38:19 2008
Subject: [gdal-dev] About palette/color table expansion
Message-ID: <3054411AF4728548AD6D7137190D56B302B581C9@admin1.aeromap.com>

Even,
Want to try -expand option. Where 1.6.0dev trunk is living? 
On gdal.org ftp download page latest is 1.5.2
Thanks

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Wednesday, August 06, 2008 1:50 PM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] About palette/color table expansion

Folks,

just a few words to advertize the new capability of color table
expansion that has been added recently to GDAL trunk (1.6.0dev).

A new option of gdal_translate, -expand rgb|rgba, enables the user to
ask for the expansion of a single band dataset with a color table and
its translation to a 3 or 4 band dataset with the R,G,B,A components.
Usefull for output drivers such as JPEG, JPEG2000, MrSID, ECW that don't
support color indexed datasets.

That capability relies on an extension of the VRTComplexSource that adds
an extra optionnal attribute
<ColorTableComponent>num_of_the_component</ColorTableComponent>.

You can use color table expansion to warp color indexed datasets with
resampling methods more sophisticated than simple nearest neighbour,
without an intermediate file that would have been produced by pct2rgb
for example.

For example :
gdal_translate -of VRT -expand rgb color_indexed.tif color_expanded.vrt
gdalwarp -t_srs EPSG:32631 color_expanded.vrt color_expanded_warped.tif

Regards.
_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From mateusz at loskot.net  Wed Aug  6 22:11:46 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug  6 22:11:53 2008
Subject: [gdal-dev] About palette/color table expansion
In-Reply-To: <3054411AF4728548AD6D7137190D56B302B581C9@admin1.aeromap.com>
References: <3054411AF4728548AD6D7137190D56B302B581C9@admin1.aeromap.com>
Message-ID: <489A59E2.8090602@loskot.net>

Gennady Khokhorin wrote:
> Even,
> Want to try -expand option. Where 1.6.0dev trunk is living? 
> On gdal.org ftp download page latest is 1.5.2

Gennady,

trunk is name of the main line of development. It is available directly 
from SVN:

http://svn.osgeo.org/gdal/trunk/

or as nightly source package (choose file with trunk in name):

http://download.osgeo.org/gdal/daily/

Check this Wiki page for more details:

http://trac.osgeo.org/gdal/wiki/DownloadSource

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From aperezcarro at yahoo.es  Thu Aug  7 02:23:57 2008
From: aperezcarro at yahoo.es (Antonio Prez)
Date: Thu Aug  7 02:24:13 2008
Subject: [gdal-dev] Gdal contour problem
Message-ID: <g7e4ds$qo5$1@ger.gmane.org>

> Hello everybody:
> My question is related with gdal_contour.exe utility
> This utility works fine writing data vectorized shp and kml formats but
> something must be wrong with dgn format.
>
> The aspect of the file (loaded in microstation) is quite strange, polygons
> appears broken.
> ( I send a jpg examples)
> May be because my gdal_contour ( dated : 13/02/2008) write V7 DGN ?????
>
> ( the file vectorized is a strm tif  of 74000 Kb although I thinks it is
> not the problem  )
>
> Thank you
>
> -- 
excuse me if this message are sent twice...

-- 
     --------------------------------------
     Antonio Prez Carro
 



From eloquence2 at gmail.com  Thu Aug  7 02:53:47 2008
From: eloquence2 at gmail.com (D)
Date: Thu Aug  7 02:53:50 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated queries
	from a DB
Message-ID: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>

Hi,

I have a question about the usage of OGR2OGR in defining an ESRI Shapefile
output name. I am exporting Spatial data from Oracle Spatial (11g) from a
single table to an ESRI Shapefile and would like to get the following naming
syntax for my Shapefile:


[select distinct FIELD1 from SHEMA.TABLE][select distinct FIELD2 from
SHEMA.TABLE][fixed value -> 01]

.. the output would look like

50000002806200701.shp
50000002806200701.shx
50000002806200701.dbf

The naming parts/chunks that are concatenated here are actually queries in
the source database (Oracle).

Any examples (sample scripts, procedures) or hints on how to implement this,
would be very helpful.

Thanks!

Best regards,
Dejan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080807/4e0c0f4f/attachment.html
From eloquence2 at gmail.com  Thu Aug  7 03:18:33 2008
From: eloquence2 at gmail.com (Dejan Gregor)
Date: Thu Aug  7 03:18:36 2008
Subject: [Gdal-dev] GDAL OGR2OGR does not export Oracle Views
In-Reply-To: <4899B0CB.3070007@loskot.net>
References: <18850008.post@talk.nabble.com> <4899B0CB.3070007@loskot.net>
Message-ID: <18865340.post@talk.nabble.com>


Hi Mateusz,

thanks for your reply. I have ran the command and got a response:

C:\>ogrinfo "OCI:maribor/admin@ORCL:MARIBOR.WA_PIPE_VIEW"
ERROR 1: ORA-04043: object MARIBOR.WA_PIPE_VIEW does not exist in
OCIDescribeAny
INFO: Open of `OCI:maribor/admin@ORCL:MARIBOR.WA_PIPE_VIEW'
      using driver `OCI' successful.
1: MARIBOR.WA_PIPE_VIEW

However, the export into an ESRI Shapefile works fine, I didn't see that
although the error message occured (probably because of the missing metadata
in MDSYS), it exported the ESRI Shapefile perfectly.

I think it is not a bug.

Thanks!

Dejan
-- 
View this message in context: http://www.nabble.com/GDAL-OGR2OGR-does-not-export-Oracle-Views-tp18850008p18865340.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From abhay.menon at gmail.com  Thu Aug  7 05:30:36 2008
From: abhay.menon at gmail.com (abhay menon)
Date: Thu Aug  7 05:30:41 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated
	queries from a DB
In-Reply-To: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
References: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
Message-ID: <7a30cd70808070230r2cbf1decw5106b00c2d76e837@mail.gmail.com>

On Thu, Aug 7, 2008 at 12:23 PM, D <eloquence2@gmail.com> wrote:

>  Hi,
>
> I have a question about the usage of OGR2OGR in defining an ESRI Shapefile
> output name. I am exporting Spatial data from Oracle Spatial (11g) from a
> single table to an ESRI Shapefile and would like to get the following naming
> syntax for my Shapefile:
>
>
> [select distinct FIELD1 from SHEMA.TABLE][select distinct FIELD2 from
> SHEMA.TABLE][fixed value -> 01]
>
> .. the output would look like
>
> 50000002806200701.shp
> 50000002806200701.shx
> 50000002806200701.dbf
>
> The naming parts/chunks that are concatenated here are actually queries in
> the source database (Oracle).
>
> Any examples (sample scripts, procedures) or hints on how to implement
> this, would be very helpful.
>
> Thanks!
>
> Best regards,
> Dejan
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

Hi Dejan,

I don't think it is possible using ogr2ogr.exe, you will need to write a
small programme to do so.

Sorry I have not written any script yet on such a issue. But you could what
you could do is.

Open a recordset and from the desired name in select statement

select [select distinct FIELD1 from SHEMA.TABLE] || [select distinct FIELD2
from SHEMA.TABLE] || 01 from DUAL

and then pass this into the command line parameter as string

to from

ogr2ogr.exe -f "ESRI Shapefile" <string from database result>.shp
"OCI:xxxxxxx/xxxxxxx@dbname" -sql <select queries that you want the output
from >

and execute this thru shell or command prompt.

Hope this helps...!!!

Rgds.
Abhay.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080807/94f97452/attachment-0001.html
From mateusz at loskot.net  Thu Aug  7 10:50:29 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug  7 10:50:35 2008
Subject: [Gdal-dev] GDAL OGR2OGR does not export Oracle Views
In-Reply-To: <18865340.post@talk.nabble.com>
References: <18850008.post@talk.nabble.com> <4899B0CB.3070007@loskot.net>
	<18865340.post@talk.nabble.com>
Message-ID: <489B0BB5.8090806@loskot.net>

Dejan Gregor wrote:
> Hi Mateusz,
> 
> thanks for your reply. I have ran the command and got a response:
> 
> C:\>ogrinfo "OCI:maribor/admin@ORCL:MARIBOR.WA_PIPE_VIEW"
> ERROR 1: ORA-04043: object MARIBOR.WA_PIPE_VIEW does not exist in
> OCIDescribeAny
> INFO: Open of `OCI:maribor/admin@ORCL:MARIBOR.WA_PIPE_VIEW'
>       using driver `OCI' successful.
> 1: MARIBOR.WA_PIPE_VIEW
> 
> However, the export into an ESRI Shapefile works fine, I didn't see that
> although the error message occured (probably because of the missing metadata
> in MDSYS), it exported the ESRI Shapefile perfectly.

Dejan,

Good it's working!

 > I think it is not a bug.

OK. Seems like inaccurate message only.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Thu Aug  7 11:19:26 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  7 11:19:58 2008
Subject: [gdal-dev] SDTS elevation values
In-Reply-To: <00c701c8f855$4f2dcf50$ed896df0$@com>
References: <011f01c8f553$3ac35670$b04a0350$@com>
	<4897323C.4060702@pobox.com> <00c701c8f855$4f2dcf50$ed896df0$@com>
Message-ID: <489B127E.9050803@pobox.com>

Karthik wrote:
> Frank,
> 
> 	Thanks for your suggestion. I tried it out and I get the exact value
> as expected. If I understand correctly, you are referring to the
> intracell-reference-location field. It's used to denote whether the top left
> coordinates are off by half a pixel or not. I have taken care of this
> situation also. I think the variation is due to reading the wrong record. I
> think I am somehow reading the one record below or above the required
> record. I am also not sure whether Global mapper is using other
> interpolations like Bicubic or Trilinear interpolation which can give more
> accuracy. 
> 
> 	Also, I want a reassurance on the math I used. I have attached a
> JPEG image that explains the math I used to get the four surrounding points.

Karthik,

The image skips some of the core math you use to do the interpolation
but it seems generally reasonable.

> 	One more basic question I have here. How can one be sure of the
> values they are getting after interpolation? Is there some other
> verification tool available other than Global Mapper to cross verify?

When I write interpolators I do test points and then manually compute the
results I would expect.  In particular I do some test at pixel center (should
get the exact value of the original pixel) and on a grid corner (should get
a simple average of the four surrounding pixels).

I'm sorry I don't have more time to dig into this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From mateusz at loskot.net  Thu Aug  7 11:42:03 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug  7 11:42:34 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated
	queries from a DB
In-Reply-To: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
References: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
Message-ID: <489B17CB.3010902@loskot.net>

D wrote:
> Hi,
> 
> I have a question about the usage of OGR2OGR in defining an ESRI Shapefile
> output name. I am exporting Spatial data from Oracle Spatial (11g) from a
> single table to an ESRI Shapefile and would like to get the following naming
> syntax for my Shapefile:
> 
> 
> [select distinct FIELD1 from SHEMA.TABLE][select distinct FIELD2 from
> SHEMA.TABLE][fixed value -> 01]
> 
> .. the output would look like
> 
> 50000002806200701.shp
> 50000002806200701.shx
> 50000002806200701.dbf
> 
> The naming parts/chunks that are concatenated here are actually queries in
> the source database (Oracle).

D,

It's not possible to get it done with ogr2ogr only. You need to write a 
script.

> Any examples (sample scripts, procedures) or hints on how to implement this,
> would be very helpful.


Here you have a prototype of how it can be solve with Python:

#################################
import os
import cx_Oracle

connstr = 'system/pantera@localhost'
conn = cx_Oracle.connect(connstr)
cur = conn.cursor()

# build your SQL queries
cur.execute('SELECT DISTINCT NAME FROM TEST_POINTS')
row = cur.fetchone()
i = 0
while row is not None:
     # generate filename
     prefix = row[0]
     name = prefix + '_%02d' % i

     # call ogr2ogr and pass the generate name as output file name
     os.system('ogr2ogr -f "ESRI Shapefile" %s.shp ....' % name)
     ...

     # read next record
     row = cur.fetchone()
     i = i + 1

if cur is not None:
     cur.close()
if conn is not None:
     conn.close()
#################################

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From eloquence2 at gmail.com  Thu Aug  7 11:48:26 2008
From: eloquence2 at gmail.com (D)
Date: Thu Aug  7 11:48:29 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated
	queries from a DB
In-Reply-To: <489B17CB.3010902@loskot.net>
References: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
	<489B17CB.3010902@loskot.net>
Message-ID: <860f58590808070848x437bf110jb2dae81c6a635e88@mail.gmail.com>

Hi Mateusz,

thanks for the help and the sample! I will try to implement it. I have also
received a sample from an Oracle DBA how to create a Batch file with a
properly defined command line while executing an SQL script with some PL/SQL
procedures.

If interested, I will send it to you, when completed developing and testing
it.

Best regards,

Dejan

On Thu, Aug 7, 2008 at 5:42 PM, Mateusz Loskot <mateusz@loskot.net> wrote:

> D wrote:
>
>> Hi,
>>
>> I have a question about the usage of OGR2OGR in defining an ESRI Shapefile
>> output name. I am exporting Spatial data from Oracle Spatial (11g) from a
>> single table to an ESRI Shapefile and would like to get the following
>> naming
>> syntax for my Shapefile:
>>
>>
>> [select distinct FIELD1 from SHEMA.TABLE][select distinct FIELD2 from
>> SHEMA.TABLE][fixed value -> 01]
>>
>> .. the output would look like
>>
>> 50000002806200701.shp
>> 50000002806200701.shx
>> 50000002806200701.dbf
>>
>> The naming parts/chunks that are concatenated here are actually queries in
>> the source database (Oracle).
>>
>
> D,
>
> It's not possible to get it done with ogr2ogr only. You need to write a
> script.
>
>  Any examples (sample scripts, procedures) or hints on how to implement
>> this,
>> would be very helpful.
>>
>
>
> Here you have a prototype of how it can be solve with Python:
>
> #################################
> import os
> import cx_Oracle
>
> connstr = 'system/pantera@localhost'
> conn = cx_Oracle.connect(connstr)
> cur = conn.cursor()
>
> # build your SQL queries
> cur.execute('SELECT DISTINCT NAME FROM TEST_POINTS')
> row = cur.fetchone()
> i = 0
> while row is not None:
>    # generate filename
>    prefix = row[0]
>    name = prefix + '_%02d' % i
>
>    # call ogr2ogr and pass the generate name as output file name
>    os.system('ogr2ogr -f "ESRI Shapefile" %s.shp ....' % name)
>    ...
>
>    # read next record
>    row = cur.fetchone()
>    i = i + 1
>
> if cur is not None:
>    cur.close()
> if conn is not None:
>    conn.close()
> #################################
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080807/63c08c12/attachment.html
From mateusz at loskot.net  Thu Aug  7 11:51:02 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug  7 11:51:07 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated
	queries from a DB
In-Reply-To: <860f58590808070848x437bf110jb2dae81c6a635e88@mail.gmail.com>
References: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>	
	<489B17CB.3010902@loskot.net>
	<860f58590808070848x437bf110jb2dae81c6a635e88@mail.gmail.com>
Message-ID: <489B19E6.7030104@loskot.net>

D wrote:
> Hi Mateusz,
> 
> thanks for the help and the sample! I will try to implement it. I have also
> received a sample from an Oracle DBA how to create a Batch file with a
> properly defined command line while executing an SQL script with some PL/SQL
> procedures.

Dejan,

Sounds good.

> If interested, I will send it to you, when completed developing and testing
> it.

IMO, mailing list (ie. as reply to this thread) is better place, so 
others can use it as well.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From lran at unc.edu  Thu Aug  7 12:24:16 2008
From: lran at unc.edu (Limei Ran)
Date: Thu Aug  7 12:25:03 2008
Subject: [gdal-dev] How to read GRIB2 fommat data
Message-ID: <489B21B0.3050005@unc.edu>

Hi:

GRIB is a format listed in the GDAL supported formats.  But, I  get the 
following error message when I used gdalinfo.

============================
gdalinfo goes_rtv_CALB_200608051145Z.grid
ERROR 4: `goes_rtv_CALB_200608051145Z.grid' does not exist in the file 
system,
and is not recognised as a supported dataset name.

gdalinfo failed - unable to open 'goes_rtv_CALB_200608051145Z.grid'.
============================

I believe that my file is GRIB2 format.  What should I do to have GRIB 
format in my compiled GDAL?

Thanks,

Limei
From kruschitz at grid-it.at  Thu Aug  7 12:21:16 2008
From: kruschitz at grid-it.at (Philippe Kruschitz)
Date: Thu Aug  7 12:35:34 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
Message-ID: <489B20FC.1020507@grid-it.at>

Hi,

The "Building On Windows With Minimized Drivers" page being under 
construction, I'll take a chance and post my question here.

What I need are basically binaries for an application that only makes 
use of the OGR utilities. My application works like a charm with the 
FWTools, but the whole thing is way to big to be integrated. I tried the 
"minimalist windows executables" with the PG plug-in on the binaries 
page, but experienced some problems. First, exporting from a PostGIS DB 
to a shapefile with ogr2ogr would not create a *.prj file, which it did 
with the last FWTools (newer version?). Writing the same table to KML 
didn't work either, my coordinates being (for some obscure reason) 
totally messed up.

Now my question, how difficult would it be to build a stripped down 
version of the library with only the OGR utilities. I builded some 
things before, but only under Linux (GRASS and other GIS software). My 
knowledge on this topic is, at the best, rudimentary, but I'm ready to 
give it a try (I was able to build GDAL from source using the 
information in the wiki). Is there something like a configuration file 
(nmake.opt?), where I could only use those things I really needed?

Thanks,

Philippe Kruschitz

From warmerdam at pobox.com  Thu Aug  7 12:35:20 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  7 12:36:18 2008
Subject: [gdal-dev] How to read GRIB2 fommat data
In-Reply-To: <489B21B0.3050005@unc.edu>
References: <489B21B0.3050005@unc.edu>
Message-ID: <489B2448.7090306@pobox.com>

Limei Ran wrote:
> Hi:
> 
> GRIB is a format listed in the GDAL supported formats.  But, I  get the 
> following error message when I used gdalinfo.
> 
> ============================
> gdalinfo goes_rtv_CALB_200608051145Z.grid
> ERROR 4: `goes_rtv_CALB_200608051145Z.grid' does not exist in the file 
> system,
> and is not recognised as a supported dataset name.
> 
> gdalinfo failed - unable to open 'goes_rtv_CALB_200608051145Z.grid'.
> ============================
> 
> I believe that my file is GRIB2 format.  What should I do to have GRIB 
> format in my compiled GDAL?

Limei,

What version of GDAL are you using?  The GRIB driver evolved a fair amount
this year.  It might be helpful if you could make your file available
so I could test with it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From hietokolob at gmail.com  Thu Aug  7 12:39:11 2008
From: hietokolob at gmail.com (Lee Eschler)
Date: Thu Aug  7 12:39:14 2008
Subject: [gdal-dev] failed to load NAD27-83 correction file
Message-ID: <895794ad0808070939u4ba9af00x8fe7793e35d70e60@mail.gmail.com>

Greetings,

I am trying to transform XY coordinates using Python.  I am using Python
2.4.1 on Windows XP Professional Service Pack 3.  Here is the code I am
using:



from osgeo import osr



#original SRS

sourceSR = osr.SpatialReference()

sourceSR.ImportFromEPSG(26712) #utm nad27 12n

#target SRS

targetSR= osr.SpatialReference()

targetSR.ImportFromEPSG(4301) #stateplane nad83 Utah north zone

#targetSR.ImportFromEPSG(26912)# utm nad 83 12n # Same results as (4301)

coordTrans =osr.CoordinateTransformation(sourceSR,targetSR)

x=423061.91

y=4524687.86

res=coordTrans.TransformPoint(x,y)

print 'x= %10.2f , y= %10.2f' % (res[0],res[1])





I get x= -1.95, y= 0.71

should be x = 196359.35 y = 1885770.43



The error returned is " ERROR 1: failed to load NAD27-83 correction file".




I extracted the PROJ 4.4.6 WIN32 Binaries into my C:\Program Files
directory. Added C:\Program Files\proj\bin to the end of my System Path
environment variable.

Added a System environment variable called PROJ_LIB with the value of
C:\Program Files\proj\nad



I am not sure what I have done wrong and was hoping someone could point me
in the right direction.



Thanks


Lee Eschler
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080807/bd29746a/attachment.html
From matt.wilkie at gov.yk.ca  Thu Aug  7 13:15:46 2008
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Thu Aug  7 13:15:49 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <489B20FC.1020507@grid-it.at>
References: <489B20FC.1020507@grid-it.at>
Message-ID: <489B2DC2.5070105@gov.yk.ca>

Hi Philippe,

It's not ogr only, but if you use OSGeo4W advanced install and select 
just the 'gdal' package you get something which is much lighter weight 
than fwtools with a minimum of fuss.

See http://trac.osgeo.org/osgeo4w/wiki

cheers,


matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


Philippe Kruschitz wrote:
> Hi,
> 
> The "Building On Windows With Minimized Drivers" page being under 
> construction, I'll take a chance and post my question here.
> 
> What I need are basically binaries for an application that only makes 
> use of the OGR utilities. My application works like a charm with the 
> FWTools, but the whole thing is way to big to be integrated. I tried the 
> "minimalist windows executables" with the PG plug-in on the binaries 
> page, but experienced some problems. First, exporting from a PostGIS DB 
> to a shapefile with ogr2ogr would not create a *.prj file, which it did 
> with the last FWTools (newer version?). Writing the same table to KML 
> didn't work either, my coordinates being (for some obscure reason) 
> totally messed up.
> 
> Now my question, how difficult would it be to build a stripped down 
> version of the library with only the OGR utilities. I builded some 
> things before, but only under Linux (GRASS and other GIS software). My 
> knowledge on this topic is, at the best, rudimentary, but I'm ready to 
> give it a try (I was able to build GDAL from source using the 
> information in the wiki). Is there something like a configuration file 
> (nmake.opt?), where I could only use those things I really needed?
> 
> Thanks,
> 
> Philippe Kruschitz
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From warmerdam at pobox.com  Thu Aug  7 13:23:09 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug  7 13:23:39 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <489B2DC2.5070105@gov.yk.ca>
References: <489B20FC.1020507@grid-it.at> <489B2DC2.5070105@gov.yk.ca>
Message-ID: <489B2F7D.8090002@pobox.com>

Matt Wilkie wrote:
> Hi Philippe,
> 
> It's not ogr only, but if you use OSGeo4W advanced install and select 
> just the 'gdal' package you get something which is much lighter weight 
> than fwtools with a minimum of fuss.
> 
> See http://trac.osgeo.org/osgeo4w/wiki

Matt / Philippe,

This is still quite a bit heavier than the default build of GDAL from source
due to the dependency on various external DLLs for stuff like hdf, netcdf,
etc.

I will note that you can substantially reduce the amount of raster stuff in
the GDAL DLL by modifying the EXTRAFLAGS in gdal\frmts\makefile.vc to
include less item.  With a variety of hacking I was able to get a small
configuration working with it set to:

EXTRAFLAGS =    -DFRMT_raw -DFRMT_png -DFRMT_mem -DFRMT_jpeg -DFRMT_vrt

for a client.  But I believe I ended up making various other changes -
for instance to disable the OGRSpatialReference dependence on the GeoTIFF
stuff for EPSG lookups.

I wish I had added notes in the wiki as I did this work!

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From bhudspeth at edac.unm.edu  Thu Aug  7 06:47:29 2008
From: bhudspeth at edac.unm.edu (William Hudspeth)
Date: Thu Aug  7 13:48:14 2008
Subject: [gdal-dev] Georeferencing for HDF files
Message-ID: <1218106049.5312.7.camel@localhost>

Hello,

I am trying to import an HDF file into GRASS using r.in.gdal. The HDF
file was acquired via a WCS GetCoverage request from a NASA data
archive, and contains one scientific raster grid. According to a
DescribeCoverage WCS request, the data is of global extent (e.g.
90S,90N, 180W,180E) in LatLong-WGS84, but is delivered in the HDF as a
raster grid of 720 by 1440 pixels (presumably, this corresponds to 1/4
degree resolution for the global coverage). When I run gdalinfo on the
HDF file, it shows the following:

Driver: HDF4Image/HDF4 Dataset
Size is 1440, 720
Coordinate System is `'
Metadata:
  units=DU
  _FillValue=-1.267651e+30
  unitsCategory=science
  structureType=Grid
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  720.0)
Upper Right ( 1440.0,    0.0)
Lower Right ( 1440.0,  720.0)
Center      (  720.0,  360.0)
Band 1 Block=1440x1 Type=Float32, ColorInterp=Gray

When I try to import into GRASS, it must be brought into an XY location,
with no associated georeferencing.

Can I use any of the GDAL tools to move translate the pixel-based image
coordinates into a file that is in LatLong? What are the paramters for
specifiying a pixel grid?

Thanks,

Bill

From eloquence2 at gmail.com  Fri Aug  8 02:27:27 2008
From: eloquence2 at gmail.com (D)
Date: Fri Aug  8 02:27:31 2008
Subject: [gdal-dev] OGR2OGR - Define output naming from concatenated
	queries from a DB
In-Reply-To: <489B19E6.7030104@loskot.net>
References: <860f58590808062353v61666e2ble0159236a1d5ba47@mail.gmail.com>
	<489B17CB.3010902@loskot.net>
	<860f58590808070848x437bf110jb2dae81c6a635e88@mail.gmail.com>
	<489B19E6.7030104@loskot.net>
Message-ID: <860f58590808072327s33e70390xd91a4d0c62f10774@mail.gmail.com>

>
>  Hi Mateusz,
>>
>> thanks for the help and the sample! I will try to implement it. I have
>> also
>> received a sample from an Oracle DBA how to create a Batch file with a
>> properly defined command line while executing an SQL script with some
>> PL/SQL
>> procedures.
>>
>
> Dejan,
>
> Sounds good.
>
> If interested, I will send it to you, when completed developing and testing
>> it.
>>
>
> IMO, mailing list (ie. as reply to this thread) is better place, so others
> can use it as well.
>

Here is the sample code to start with in PL/SQL and SQL in Oracle.

The typical 'preamble' for doing this in Sql*plus is

set heading off feedback off pagesize 0 newpage 0

Then you could do virtually anything
column dag noprint new_value dag
select to_char(sysdate,'yymmdd') dag
from dual;

spool exp_&dag..bat

select ....
from ....
spool off

host exp_&dag..bat
exit
Best regards,
Dejan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/134e61ab/attachment-0001.html
From mateusz at loskot.net  Fri Aug  8 02:48:49 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 02:48:55 2008
Subject: [gdal-dev] GDAL Maintenance Report No 4
Message-ID: <489BEC51.2050003@loskot.net>

Folks,

I've just posted update No 4 to the maintenance reports at:

http://trac.osgeo.org/gdal/wiki/MaintenanceReportsByMateusz2008

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From eloquence2 at gmail.com  Fri Aug  8 03:00:59 2008
From: eloquence2 at gmail.com (D)
Date: Fri Aug  8 03:01:04 2008
Subject: [gdal-dev] GDAL support for rasters stored in E00
Message-ID: <860f58590808080000l2b9f674aoa79c36e9039adc2e@mail.gmail.com>

Hi,

I could not find any documentation from GDAL for ESRI ArcInfo Exchange File
'E00' (raster).

I have tried using FW Tools, but it supports only the vector E00 format.

Are there any plans or already an available functionality in GDAL for
rasters in E00?

Thanks!
Dejan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/3916d870/attachment.html
From kruschitz at grid-it.at  Fri Aug  8 03:43:16 2008
From: kruschitz at grid-it.at (Philippe Kruschitz)
Date: Fri Aug  8 03:43:49 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <489B2F7D.8090002@pobox.com>
References: <489B20FC.1020507@grid-it.at> <489B2DC2.5070105@gov.yk.ca>
	<489B2F7D.8090002@pobox.com>
Message-ID: <489BF914.3020000@grid-it.at>


Thanks Frank and Matt,

I'll have a look at it. Regarding the .prj-file generation, starting 
with what version does GDAL do it? The newer FWTools have it, but the 
1.5.0 version (at least the one included in those "minimalist binaries") 
doesn't.

Thanks,

Philippe
From kruschitz at grid-it.at  Fri Aug  8 04:06:47 2008
From: kruschitz at grid-it.at (Philippe Kruschitz)
Date: Fri Aug  8 04:07:21 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <860f58590808080053n6d6e50c9l7320ec50f081aa21@mail.gmail.com>
References: <489B20FC.1020507@grid-it.at> <489B2DC2.5070105@gov.yk.ca>	
	<489B2F7D.8090002@pobox.com> <489BF914.3020000@grid-it.at>
	<860f58590808080053n6d6e50c9l7320ec50f081aa21@mail.gmail.com>
Message-ID: <489BFE97.7090306@grid-it.at>


Hi Dejan,

Thanks for the explanation. I wasn't aware that the ESRI projections 
definitions were modified that often. As I'm working with only a couple 
of projections in this project, I'll write the PRJ files manually (and 
hope they don't change those definitions in a near future...)

Regards,

Philippe

> However, I do see that a whole database of PRJ files has to be 
> incorporated and matched with a projection database in FW Tools/GDAL, 
> since the keywords for different PCS, GCS, DATUMS, SPHEREOIDS and other 
> parameters have to keep the same/identical (they are then stored e.g. 
> into SDE repository directly after importing a SHP into a GDB, so you 
> might have different SRID entries for the same Spatial references as you 
> might have different PRJ files pointing to the same spatial references, 
> with the same/similar parameters).

> However, ESRI is updating its projection database quite often (even 
> through the SP releases), so reconciling both database could be a huge 
> task. Not being in sync with the ESRI DB can cause users using GDAL 
> managed data at ESRI side some problems, especially when calling SRIDs 
> or having multiple environments, different ESRI SW versions and updates 
> installed.
>  
> However, I would love to see that output files from GDAL have 
> appropriate PRJ files with it, if this is feasible :-)
>  
> Best regards,
> Dejan
From eloquence2 at gmail.com  Fri Aug  8 04:15:34 2008
From: eloquence2 at gmail.com (D)
Date: Fri Aug  8 04:15:37 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <860f58590808080114k35b5b020l8fac8a67b18dc1b2@mail.gmail.com>
References: <489B20FC.1020507@grid-it.at> <489B2DC2.5070105@gov.yk.ca>
	<489B2F7D.8090002@pobox.com> <489BF914.3020000@grid-it.at>
	<860f58590808080053n6d6e50c9l7320ec50f081aa21@mail.gmail.com>
	<489BFE97.7090306@grid-it.at>
	<860f58590808080114k35b5b020l8fac8a67b18dc1b2@mail.gmail.com>
Message-ID: <860f58590808080115t7e0e6870g864375f6731ddbed@mail.gmail.com>

>  Dear Philippe,
>
> you might try just to copy your PRJ file from an ESRI ArcGIS installation
> (under \Program Files\ArcGIS\Coordinate Systems). However, I have seen
> problems in ArcObjects when programatically calling a Projection ID that was
> not hard-coded with ESRI SW or with work-around with adding keywords into
> env. settings.
>
> However, many PRJ files are identical or similar between different DB of
> spatial references.
>
> Good luck!
>
> Dejan
>
>   On Fri, Aug 8, 2008 at 10:06 AM, Philippe Kruschitz <
> kruschitz@grid-it.at> wrote:
>
>>
>> Hi Dejan,
>>
>> Thanks for the explanation. I wasn't aware that the ESRI projections
>> definitions were modified that often. As I'm working with only a couple of
>> projections in this project, I'll write the PRJ files manually (and hope
>> they don't change those definitions in a near future...)
>>
>> Regards,
>>
>> Philippe
>>
>>
>> However, I do see that a whole database of PRJ files has to be
>>> incorporated and matched with a projection database in FW Tools/GDAL, since
>>> the keywords for different PCS, GCS, DATUMS, SPHEREOIDS and other parameters
>>> have to keep the same/identical (they are then stored e.g. into SDE
>>> repository directly after importing a SHP into a GDB, so you might have
>>> different SRID entries for the same Spatial references as you might have
>>> different PRJ files pointing to the same spatial references, with the
>>> same/similar parameters).
>>>
>>
>> However, ESRI is updating its projection database quite often (even
>>> through the SP releases), so reconciling both database could be a huge task.
>>> Not being in sync with the ESRI DB can cause users using GDAL managed data
>>> at ESRI side some problems, especially when calling SRIDs or having multiple
>>> environments, different ESRI SW versions and updates installed.
>>>  However, I would love to see that output files from GDAL have
>>> appropriate PRJ files with it, if this is feasible :-)
>>>  Best regards,
>>> Dejan
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/80062d7c/attachment.html
From oueslati.cherif at gmail.com  Fri Aug  8 04:35:43 2008
From: oueslati.cherif at gmail.com (Cherif Oueslati)
Date: Fri Aug  8 04:35:46 2008
Subject: [gdal-dev] [GDAL 1.5.1] How to build and run GDAL 1.5.1 on windows
Message-ID: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>

Hello every body,

I found a problem to run the GDAL 1.5.1 in a MS Visual Studio 2003
Environment, to test the implementation of a driver that i developed.
The error appears when i would like to run the project and indicates that it
is impossible to begin the debug because it's impossible to start the
"gdal15.dll".
Someone suggest to me to well define the "environment variables".
Can you tell me how could i run gdal 1.5.1 or how to set the "environment
variables" inside the visual studio it self.
With all my gratitude.
Cherif.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/bce6742f/attachment.html
From szekerest at gmail.com  Fri Aug  8 06:57:55 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  8 06:57:58 2008
Subject: [gdal-dev] [GDAL 1.5.1] How to build and run GDAL 1.5.1 on windows
In-Reply-To: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
References: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
Message-ID: <f3b73b7d0808080357ne3a316ar37cea623ed800c91@mail.gmail.com>

Cherif,

You have to create or use a host process which is loading and use the
gdal15.dll. Probably you can utilize one of the existing applications
like gdalinfo.exe or ogrinfo.exe have been compiled along with the
gdal project.

Best regards,

Tamas


2008/8/8 Cherif Oueslati <oueslati.cherif@gmail.com>:
>
> Hello every body,
> I found a problem to run the GDAL 1.5.1 in a MS Visual Studio 2003
> Environment, to test the implementation of a driver that i developed.
> The error appears when i would like to run the project and indicates that it
> is impossible to begin the debug because it's impossible to start the
> "gdal15.dll".
> Someone suggest to me to well define the "environment variables".
> Can you tell me how could i run gdal 1.5.1 or how to set the "environment
> variables" inside the visual studio it self.
> With all my gratitude.
> Cherif.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From eloquence2 at gmail.com  Fri Aug  8 08:22:31 2008
From: eloquence2 at gmail.com (D)
Date: Fri Aug  8 08:22:34 2008
Subject: [Gdal-dev] GDAL OGR2OGR does not export Oracle Views
In-Reply-To: <7a30cd70808060834w63f1da70u241261575792a97f@mail.gmail.com>
References: <18850008.post@talk.nabble.com>
	<7a30cd70808060834w63f1da70u241261575792a97f@mail.gmail.com>
Message-ID: <860f58590808080522t5ef825bbt74c29de13125e1e2@mail.gmail.com>

Hello Abhay,

here is what I have also tried to get rid of the error message.


> PS. OCIDescribeAny error occur when you create a entry in
USER_SDO_GEOM_METADATA for the VIEW in use.


I did insert the metadata afterwards, but did not help.

Here is the insert statement

 INSERT INTO USER_SDO_GEOM_METADATA
VALUES (
'WA_PIPE_VIEW',
'GEOM',
MDSYS.SDO_DIM_ARRAY(
MDSYS.SDO_DIM_ELEMENT('X', 300000, 650000, 0.0005),
MDSYS.SDO_DIM_ELEMENT('Y', 20000, 200000, 0.0005),
MDSYS.SDO_DIM_ELEMENT('Z', -10, 10000, 0.0005)),
'5000000');
COMMIT;


Best regards,
Dejan

 > And my implementation looks like this
>
> C:\Dev\gdal\bld152\bin>ogr2ogr -f "ESRI Shapefile" test.shp
"OCI:xxxxxxx/xxxxxxx@pilot" -sql "Select * from tblinputs_v where tileid=247
> " -nlt POLYGON
>
> Rgds.
>
> Abhay.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/259ab253/attachment-0001.html
From mateusz at loskot.net  Fri Aug  8 08:31:41 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 08:31:48 2008
Subject: [gdal-dev] [GDAL 1.5.1] How to build and run GDAL 1.5.1 on windows
In-Reply-To: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
References: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
Message-ID: <489C3CAD.6020503@loskot.net>

Cherif Oueslati wrote:
> Hello every body,
> 
> I found a problem to run the GDAL 1.5.1 in a MS Visual Studio 2003
> Environment, to test the implementation of a driver that i developed.
> The error appears when i would like to run the project and indicates that it
> is impossible to begin the debug because it's impossible to start the
> "gdal15.dll".

Cherif,

This is correct, you can no *run* a DLL (if you mean this as "start the 
gdal15.dll") in any version of Visual Studio.
You need to add your own test program (.exe project) and attach its 
project to the solution, configure dependencies and set your test 
project as startup project.
If you don't know how to do it, refer MSDN and VS documentation:

http://msdn.microsoft.com/en-us/library/0bxe8ytt.aspx

> Someone suggest to me to well define the "environment variables".
> Can you tell me how could i run gdal 1.5.1 or how to set the "environment
> variables" inside the visual studio it self.

All this is well explained in the VS documentation:

http://msdn.microsoft.com/en-us/library/aa909648.aspx

But please notice, you do need to set environment variables to be able 
to fully debug and test GDAL dll, but environment variables does not the 
first problem. You still need to create a project for test program (.exe 
application).

Another option but IMHO more difficult if you are not experienced with 
VS and debugging, as Tamas suggested, is to attach debugging session to 
a process started as .exe program, for example gdalinfo or ogrinfo.

In case you don't know how to configure and use Visual Studio debugger, 
I recommend to read MSDN:

http://msdn.microsoft.com/en-us/library/d0b8xh0y.aspx

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From ivan.lucena at pmldnet.com  Fri Aug  8 09:37:21 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Fri Aug  8 09:37:24 2008
Subject: [gdal-dev] [GDAL 1.5.1] How to build and run GDAL 1.5.1 on windows
In-Reply-To: <489C3CAD.6020503@loskot.net>
References: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
	<489C3CAD.6020503@loskot.net>
Message-ID: <489C4C11.1090301@pmldnet.com>

Friends,

I would like to exchange my experience on the VS debugging part, if I may.

If you load one of the "fake" VC projects from the GDAL source 
distribution, makegdal71.vcproj or makegdal80.vcproj, it is pretty easy 
to write in the Project Property Pages/Debugging what are your settings 
for test anything basically. Ex.:

"""
Command: D:/gdal/apps/gdal_translate.exe
Command Arguments: -of gtiff input.vrt ouput.tif
Working Directory: D:/Data/Test
Environment: CPL_DEBUG=ON
"""

One note about environment variables, VS2003 doesn't have one entry for 
"Environment" on the Project Property Pages, VS2005 does. But you can 
always set them directly on windows. Just remember to close and open 
VS2003 again so that it will catch the changes.

To run in debugging mode is pretty simple. You don't necessarily need to 
create a complicate VS Solution and add several projects to it. Just add 
the other project source folder to your source tree on "Solution/Explorer"

Just click on the left side of your source code line to make that little 
red dot to show up and click on "Debug/Start".

I have used that to launch other application that would ultimately load 
GDAL dll during the execution like:

Python:

"""
Command: "C:\Program 
Files\Python24\Lib\site-packages\pythonwin\Pythonwin.exe"
"""

ArcMAP:

"""
Command: "C:\Program Files\ESRI\bin\ArcMap.exe"
"""

But another option is to attach to one existing/running process by using 
the "Debug/Process" options.

I used to start PythonWin first and then attach to its process and make 
calls to the specific function to test specific part of my code. It is 
great.

If you are developing a driver that is not on the trunk yet you can run 
the "fake" VS project generator that I wrote:

D:\GDAL > makegdal_gen.bat
Usage: makegdal_gen "MS Visual C++ version" > makegdalNN.vcproj
Examples:
    makegdal_gen 7.10 > makegdal71.vcproj
    makegdal_gen 8.00 > makegdal80.vcproj

That will update the source file tree.

Of course you can do that with XEmacs or GDB but VS is just more 
comfortable and maybe improve your productivity to solve problems.

By the way, does anybody interested in developing a KDeveloper project 
for GDAL? I can do that if there are demand for it. :)

Best regards,

Ivan





Mateusz Loskot wrote:
> Cherif Oueslati wrote:
>> Hello every body,
>>
>> I found a problem to run the GDAL 1.5.1 in a MS Visual Studio 2003
>> Environment, to test the implementation of a driver that i developed.
>> The error appears when i would like to run the project and indicates 
>> that it
>> is impossible to begin the debug because it's impossible to start the
>> "gdal15.dll".
> 
> Cherif,
> 
> This is correct, you can no *run* a DLL (if you mean this as "start the 
> gdal15.dll") in any version of Visual Studio.
> You need to add your own test program (.exe project) and attach its 
> project to the solution, configure dependencies and set your test 
> project as startup project.
> If you don't know how to do it, refer MSDN and VS documentation:
> 
> http://msdn.microsoft.com/en-us/library/0bxe8ytt.aspx
> 
>> Someone suggest to me to well define the "environment variables".
>> Can you tell me how could i run gdal 1.5.1 or how to set the "environment
>> variables" inside the visual studio it self.
> 
> All this is well explained in the VS documentation:
> 
> http://msdn.microsoft.com/en-us/library/aa909648.aspx
> 
> But please notice, you do need to set environment variables to be able 
> to fully debug and test GDAL dll, but environment variables does not the 
> first problem. You still need to create a project for test program (.exe 
> application).
> 
> Another option but IMHO more difficult if you are not experienced with 
> VS and debugging, as Tamas suggested, is to attach debugging session to 
> a process started as .exe program, for example gdalinfo or ogrinfo.
> 
> In case you don't know how to configure and use Visual Studio debugger, 
> I recommend to read MSDN:
> 
> http://msdn.microsoft.com/en-us/library/d0b8xh0y.aspx
> 
> Best regards,
From mateusz at loskot.net  Fri Aug  8 09:52:09 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 09:52:17 2008
Subject: [gdal-dev] [GDAL 1.5.1] How to build and run GDAL 1.5.1 on windows
In-Reply-To: <489C4C11.1090301@pmldnet.com>
References: <d94dd9d00808080135q4a26509au5f2e9acc1724114d@mail.gmail.com>
	<489C3CAD.6020503@loskot.net> <489C4C11.1090301@pmldnet.com>
Message-ID: <489C4F89.60403@loskot.net>

Lucena, Ivan wrote:
> Friends,
> 
> I would like to exchange my experience on the VS debugging part, if I may.
> [...]

Ivan,

Your notes are very helpful. Belongs to the Wiki :-)

> One note about environment variables, VS2003 doesn't have one entry for 
> "Environment" on the Project Property Pages, VS2005 does.

Ups, my fault. I've forgot how it is with VS2003

> But you can 
> always set them directly on windows. Just remember to close and open 
> VS2003 again so that it will catch the changes.

I think another option is to launch Visual Studio from cmd line

C: \> find an vsvars32.bat
C: \> set MY_ENV_VAR=foo
C: \> devenv.exe makegdal71.sln

Then MY_ENV_VAR is available in the VS env.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Fri Aug  8 10:34:29 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  8 10:35:00 2008
Subject: [gdal-dev] GDAL support for rasters stored in E00
In-Reply-To: <860f58590808080000l2b9f674aoa79c36e9039adc2e@mail.gmail.com>
References: <860f58590808080000l2b9f674aoa79c36e9039adc2e@mail.gmail.com>
Message-ID: <489C5975.5030200@pobox.com>

D wrote:
> Hi,
>  
> I could not find any documentation from GDAL for ESRI ArcInfo Exchange 
> File 'E00' (raster).
>  
> I have tried using FW Tools, but it supports only the vector E00 format.
>  
> Are there any plans or already an available functionality in GDAL for 
> rasters in E00?

Dejan,

There are no plans to support E00 rasters at this time.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

From odonnems at yahoo.com  Fri Aug  8 11:30:55 2008
From: odonnems at yahoo.com (Michael ODonnell)
Date: Fri Aug  8 11:37:37 2008
Subject: [gdal-dev] osr transformto error
Message-ID: <86093.73577.qm@web58014.mail.re3.yahoo.com>

I am trying to run a simple script and the class transformto does not appear to be working for me. I have used GDAL before for raster analysis, but I have little experience with OSR. Does anyone have any ideas as to why this is not working? I have also run a script I found online called test_transformation_osr.py and it also produces errors when transforming between spatial references. In other words, there seems to be a problem with the installation or something was not installed that I should have installed. I installed gdal1.5.2 binaries on win32 xp OS system.

Thanks for the help.
Mike


import osr, ogr

# CREATE WKT STRING OF POINT COORDS
sample = (' 776041.000', ' 3386618.000')
x = sample[0]
y = sample[1]
wkt = 'POINT(%s %s)' % (x, y)

# CREATE PROJECTION OBJECTS
utm16N = osr.SpatialReference ()
utm16N.ImportFromEPSG(26916)
wgs84 = osr.SpatialReference()
wgs84.ImportFromEPSG(4326)

# CREATE OGR POINT OBJECT, ASSIGN PROJECTION, REPROJECT
point = ogr.CreateGeometryFromWkt(wkt)
point.AssignSpatialReference(utm16N)
point.TransformTo(wgs84)

print wkt
print point


      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/eb3e0fc6/attachment.html
From abhay.menon at gmail.com  Fri Aug  8 11:46:43 2008
From: abhay.menon at gmail.com (abhay menon)
Date: Fri Aug  8 11:46:47 2008
Subject: [gdal-dev] osr transformto error
In-Reply-To: <86093.73577.qm@web58014.mail.re3.yahoo.com>
References: <86093.73577.qm@web58014.mail.re3.yahoo.com>
Message-ID: <7a30cd70808080846m2bccb33ci72ca699f3e3782a7@mail.gmail.com>

On Fri, Aug 8, 2008 at 9:00 PM, Michael ODonnell <odonnems@yahoo.com> wrote:

> I am trying to run a simple script and the class transformto does not
> appear to be working for me. I have used GDAL before for raster analysis,
> but I have little experience with OSR. Does anyone have any ideas as to why
> this is not working? I have also run a script I found online called
> test_transformation_osr.py and it also produces errors when transforming
> between spatial references. In other words, there seems to be a problem with
> the installation or something was not installed that I should have
> installed. I installed gdal1.5.2 binaries on win32 xp OS system.
>
> Thanks for the help.
> Mike
>
>
> import osr, ogr
>
> # CREATE WKT STRING OF POINT COORDS
> sample = (' 776041.000', ' 3386618.000')
> x = sample[0]
> y = sample[1]
> wkt = 'POINT(%s %s)' % (x, y)
>
> # CREATE PROJECTION OBJECTS
> utm16N = osr.SpatialReference ()
> utm16N.ImportFromEPSG(26916)
> wgs84 = osr.SpatialReference()
> wgs84.ImportFromEPSG(4326)
>
> # CREATE OGR POINT OBJECT, ASSIGN PROJECTION, REPROJECT
> point = ogr.CreateGeometryFromWkt(wkt)
> point.AssignSpatialReference(utm16N)
> point.TransformTo(wgs84)
>
> print wkt
> print point
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

Hi Mike,

Have you setup GDAL_DATA in the environment variable?

Please go through the following link

http://trac.osgeo.org/gdal/wiki/GdalOgrInPython

Rgds.
Abhay.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/c79d29ea/attachment-0001.html
From randre at gmail.com  Fri Aug  8 12:46:14 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 12:46:16 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
Message-ID: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>

Hi everyone,

I'm getting a new machine setup and have hit a snag with the GDAL
installation.  I've installed GDAL from source onto a CentOS box using the
gdal-1.5.2.tar.gz file, and with the following parameters:

$ sudo ./configure --prefix=/export --with-pg=/export/bin/pg_config
--with-python
$ make
$ make install
$ which gdalinfo
    /export/bin/gdalinfo
--> Good!

The problem comes when I try to import the osgeo module in Python.

$ python
Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
[GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from osgeo import gdal
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
ImportError: No module named osgeo
--> Not good.

Looking back through the make output, I see that the osgeo modules are being
created and copied:
    copying build/lib.linux-x86_64-2.3/osgeo/gdal.py ->
/export/lib64/python2.3/site-packages/osgeo

So I tried appending the location to the sys.path in Python to make the
modules available, but am only partially succesful with that:
[root@randre-linux ~]# python
Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
[GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path.append('/export/lib64/python2.3/site-packages/')
>>> import osgeo
--> Good!

>>> from osgeo import gdal
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
  File "/export/lib64/python2.3/site-packages/osgeo/gdal.py", line 7, in ?
    import _gdal
ImportError: libgdal.so.1: cannot open shared object file: No such file or
directory
--> Not good.

So I'm guessing that my gdal libs aren't accessible for some reason, but I'm
just guessing.  Is there a way that I can fix this at the ./configure stage?


Thanks,

Roger
--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/fc527540/attachment.html
From mateusz at loskot.net  Fri Aug  8 12:50:49 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 12:51:04 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
Message-ID: <489C7969.9040304@loskot.net>

Roger Andr? wrote:
> Hi everyone,
> 
> I'm getting a new machine setup and have hit a snag with the GDAL
> installation.  I've installed GDAL from source onto a CentOS box using the
> gdal-1.5.2.tar.gz file, and with the following parameters:
> 
> $ sudo ./configure --prefix=/export --with-pg=/export/bin/pg_config
> --with-python
> $ make
> $ make install
> $ which gdalinfo
>     /export/bin/gdalinfo
> --> Good!
> 
> The problem comes when I try to import the osgeo module in Python.
> 
> $ python
> Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
> [GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
>>>> from osgeo import gdal
> Traceback (most recent call last):
>   File "<stdin>", line 1, in ?
> ImportError: No module named osgeo
> --> Not good.
> 
> Looking back through the make output, I see that the osgeo modules are being
> created and copied:
>     copying build/lib.linux-x86_64-2.3/osgeo/gdal.py ->
> /export/lib64/python2.3/site-packages/osgeo
> 
> So I tried appending the location to the sys.path in Python to make the
> modules available, but am only partially succesful with that:
> [root@randre-linux ~]# python
> Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
> [GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
>>>> import sys
>>>> sys.path.append('/export/lib64/python2.3/site-packages/')
>>>> import osgeo
> --> Good!
> 
>>>> from osgeo import gdal
> Traceback (most recent call last):
>   File "<stdin>", line 1, in ?
>   File "/export/lib64/python2.3/site-packages/osgeo/gdal.py", line 7, in ?
>     import _gdal
> ImportError: libgdal.so.1: cannot open shared object file: No such file or
> directory
> --> Not good.
> 
> So I'm guessing that my gdal libs aren't accessible for some reason, but I'm
> just guessing.  Is there a way that I can fix this at the ./configure stage?

It looks like path where gdal library was installed is not available to 
loader.

Try this:

export LD_LIBRARY_PATH=/path/to/dir/with/libgdal.so


Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From randre at gmail.com  Fri Aug  8 12:59:47 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 12:59:49 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489C7969.9040304@loskot.net>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C7969.9040304@loskot.net>
Message-ID: <9c2015090808080959m7c5352f6q2c1f46a0db2cb3f@mail.gmail.com>

Thanks Mateusz, that did the trick, thanks.

# find /export -name "libgdal.so"
/export/lib/libgdal.so
# export LD_LIBRARY_PATH=/export/lib

# python
Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
[GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import sys
>>> sys.path.append('/export/lib64/python2.3/site-packages')
>>> from osgeo import gdal

Roger
--


On Fri, Aug 8, 2008 at 9:50 AM, Mateusz Loskot <mateusz@loskot.net> wrote:

> Roger Andr? wrote:
>
>> Hi everyone,
>>
>> I'm getting a new machine setup and have hit a snag with the GDAL
>> installation.  I've installed GDAL from source onto a CentOS box using the
>> gdal-1.5.2.tar.gz file, and with the following parameters:
>>
>> $ sudo ./configure --prefix=/export --with-pg=/export/bin/pg_config
>> --with-python
>> $ make
>> $ make install
>> $ which gdalinfo
>>    /export/bin/gdalinfo
>> --> Good!
>>
>> The problem comes when I try to import the osgeo module in Python.
>>
>> $ python
>> Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
>> [GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
>> Type "help", "copyright", "credits" or "license" for more information.
>>
>>> from osgeo import gdal
>>>>>
>>>> Traceback (most recent call last):
>>  File "<stdin>", line 1, in ?
>> ImportError: No module named osgeo
>> --> Not good.
>>
>> Looking back through the make output, I see that the osgeo modules are
>> being
>> created and copied:
>>    copying build/lib.linux-x86_64-2.3/osgeo/gdal.py ->
>> /export/lib64/python2.3/site-packages/osgeo
>>
>> So I tried appending the location to the sys.path in Python to make the
>> modules available, but am only partially succesful with that:
>> [root@randre-linux ~]# python
>> Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
>> [GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
>> Type "help", "copyright", "credits" or "license" for more information.
>>
>>> import sys
>>>>> sys.path.append('/export/lib64/python2.3/site-packages/')
>>>>> import osgeo
>>>>>
>>>> --> Good!
>>
>>  from osgeo import gdal
>>>>>
>>>> Traceback (most recent call last):
>>  File "<stdin>", line 1, in ?
>>  File "/export/lib64/python2.3/site-packages/osgeo/gdal.py", line 7, in ?
>>    import _gdal
>> ImportError: libgdal.so.1: cannot open shared object file: No such file or
>> directory
>> --> Not good.
>>
>> So I'm guessing that my gdal libs aren't accessible for some reason, but
>> I'm
>> just guessing.  Is there a way that I can fix this at the ./configure
>> stage?
>>
>
> It looks like path where gdal library was installed is not available to
> loader.
>
> Try this:
>
> export LD_LIBRARY_PATH=/path/to/dir/with/libgdal.so
>
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/7194eb1a/attachment.html
From Chris.Barker at noaa.gov  Fri Aug  8 15:01:35 2008
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Fri Aug  8 15:01:37 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
Message-ID: <489C980F.5050208@noaa.gov>

Roger Andr? wrote:

> $ python
> Python 2.3.4 (#1, Dec 11 2007, 05:28:55)
> [GCC 3.4.6 20060404 (Red Hat 3.4.6-9)] on linux2
> Type "help", "copyright", "credits" or "license" for more information.
>  >>> from osgeo import gdal
> Traceback (most recent call last):
>   File "<stdin>", line 1, in ?
> ImportError: No module named osgeo
> --> Not good.
> 
> Looking back through the make output, I see that the osgeo modules are 
> being created and copied:
>     copying build/lib.linux-x86_64-2.3/osgeo/gdal.py -> 
> /export/lib64/python2.3/site-packages/osgeo
> 
> So I tried appending the location to the sys.path in Python to make the 
> modules available,

that shouldn't be required -- site-packages should be on your sys.path 
already. Is your python in /export/lib64/python2.3 ? Do you have more 
than one python?

try:

$ which python

and maybe something like:

$ python
 >> import datetime 3 or any standard module
 >> print datetime.__file__

As a way to see where your python install is.

Also -- why python 2.3? that's getting pretty darn old!

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From warmerdam at pobox.com  Fri Aug  8 16:54:18 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Aug  8 16:54:59 2008
Subject: [gdal-dev] Maintainer Activities
Message-ID: <489CB27A.6010606@pobox.com>

Folks,

Mateusz has informed me that other commitments (school and MOSS4G) will
make it impossible for him to spend any appreciable time on GDAL maintenance
through to the end of his contract at the end of August.  He will also not
be available for a new contract for a while after that.

He will invoice at the end of August, but I anticipate he will only have used
a modest faction of the allocated funds.

Also, unfortunately, I must report that Chris Howell disappeared and has been
unreachable pretty much from the point the maintainer contract was signed with
him.  So, that is also a "write off", though there was no cost to us other
than a bit of paperwork.

This does put us back in the position that we are looking for a maintainer
candidate for short or longer term.  Keep an eye out for good folks who
might be interested.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From szekerest at gmail.com  Fri Aug  8 17:43:49 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug  8 17:43:51 2008
Subject: [gdal-dev] Maintainer Activities
In-Reply-To: <489CB27A.6010606@pobox.com>
References: <489CB27A.6010606@pobox.com>
Message-ID: <f3b73b7d0808081443s3f2f5dabq68f8f5f8e29a346c@mail.gmail.com>

Bad news :-(


2008/8/8 Frank Warmerdam <warmerdam@pobox.com>:
> Folks,
>
> Mateusz has informed me that other commitments (school and MOSS4G) will
> make it impossible for him to spend any appreciable time on GDAL maintenance
> through to the end of his contract at the end of August.  He will also not
> be available for a new contract for a while after that.
>
> He will invoice at the end of August, but I anticipate he will only have
> used
> a modest faction of the allocated funds.
>
> Also, unfortunately, I must report that Chris Howell disappeared and has
> been
> unreachable pretty much from the point the maintainer contract was signed
> with
> him.  So, that is also a "write off", though there was no cost to us other
> than a bit of paperwork.
>
> This does put us back in the position that we are looking for a maintainer
> candidate for short or longer term.  Keep an eye out for good folks who
> might be interested.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From mateusz at loskot.net  Fri Aug  8 17:57:18 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 17:57:24 2008
Subject: [gdal-dev] Maintainer Activities
In-Reply-To: <489CB27A.6010606@pobox.com>
References: <489CB27A.6010606@pobox.com>
Message-ID: <489CC13E.7020701@loskot.net>

Frank Warmerdam wrote:
> Folks,
> 
> Mateusz has informed me that other commitments (school and MOSS4G) will
> make it impossible for him to spend any appreciable time on GDAL 
> maintenance
> through to the end of his contract at the end of August.  He will also not
> be available for a new contract for a while after that.
> 
> He will invoice at the end of August, but I anticipate he will only have 
> used
> a modest faction of the allocated funds.
> 
> Also, unfortunately, I must report that Chris Howell disappeared and has 
> been
> unreachable pretty much from the point the maintainer contract was 
> signed with
> him.  So, that is also a "write off", though there was no cost to us other
> than a bit of paperwork.
> 
> This does put us back in the position that we are looking for a maintainer
> candidate for short or longer term.  Keep an eye out for good folks who
> might be interested.


Dear GDAL Folks,

I'd like to thank you for the fantastic time and experiences I got while
working on the position of GDAL maintainer. I have to leave the project 
for a while, but I really hope to be back.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From matt.wilkie at gov.yk.ca  Fri Aug  8 18:05:19 2008
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Fri Aug  8 18:05:54 2008
Subject: [gdal-dev] Maintainer Activities
In-Reply-To: <489CC13E.7020701@loskot.net>
References: <489CB27A.6010606@pobox.com> <489CC13E.7020701@loskot.net>
Message-ID: <489CC31F.2060604@gov.yk.ca>

Thank you for your work Mateusz. It is much appreciated!

cheers,

matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


Mateusz Loskot wrote:
...
> Dear GDAL Folks,
> 
> I'd like to thank you for the fantastic time and experiences I got while
> working on the position of GDAL maintainer. I have to leave the project 
> for a while, but I really hope to be back.
> 
> Best regards,

From randre at gmail.com  Fri Aug  8 19:15:13 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 19:15:15 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489C980F.5050208@noaa.gov>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C980F.5050208@noaa.gov>
Message-ID: <9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>

Hi Chris,


> that shouldn't be required -- site-packages should be on your sys.path
> already. Is your python in /export/lib64/python2.3 ? Do you have more than
> one python?


My Python is not in  /export/lib64/python2.3.  (for some reason, saying that
makes me laugh, but I digress)  I also do not have more than one version
installed.

try:
>
> $ python
> >> import datetime 3 or any standard module
> >> print datetime.__file__
>

That's a useful trick, thanks.  My python install appears to be in:
 /usr/lib64/python2.3

>
> Also -- why python 2.3? that's getting pretty darn old!


Yeah, defintely.  This is a work machine, and I'm going to have to get onto
my soapbox to get IT to up the version in our production environment as
well.

Thanks for the help.  I did get this working by adding the gdal lib path to
ld.so.conf and running ldconfig.  Then added a PYTHONPATH setting in .bashrc
that points to the /export/lib64/site-package dir.

Roger
--

>
> -Chris
>
>
> --
> Christopher Barker, Ph.D.
> Oceanographer
>
> Emergency Response Division
> NOAA/NOS/OR&R            (206) 526-6959   voice
> 7600 Sand Point Way NE   (206) 526-6329   fax
> Seattle, WA  98115       (206) 526-6317   main reception
>
> Chris.Barker@noaa.gov
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/2e674219/attachment.html
From randre at gmail.com  Fri Aug  8 19:24:00 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 19:24:02 2008
Subject: [gdal-dev] The world is flipped redux
Message-ID: <9c2015090808081624i6e99b3ddrb4f07ee7cc8a4d42@mail.gmail.com>

Ok, this is driving me nuts, I can't handle "South is up" anymore.  I have
NetCDF derived GMT grids which have a flipped y-axis.  This makes for
georeferencing that looks like this:
Corner Coordinates:
Upper Left  ( -90.0000000, -90.0000000)
Lower Left  ( -90.0000000,   0.0000000)
Upper Right (   0.0000000, -90.0000000)
Lower Right (   0.0000000,   0.0000000)

I've seen some old discussions about this, but haven't really found a good
solution.  I've tried a "flip_raster.py" utility that Matt Perry wrote, but
it doesn't seem to do anything with my data.  (probably due to my crappy
data, not Matt's tool) I've also read that there have been some rewrites of
the NetCDF driver that are supposed to be able to deal with this, but I'm
not sure about that.

How have others out there dealt with this issue?  I'd like to be able to
convert the grids into GeoTIFF's and have the TIFF's be "right" side up.

Thanks,

Flipped-off Roger
--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/994f84ec/attachment.html
From Chris.Barker at noaa.gov  Fri Aug  8 19:36:01 2008
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Fri Aug  8 19:36:04 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C980F.5050208@noaa.gov>
	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>
Message-ID: <489CD861.1050200@noaa.gov>

Roger Andr? wrote:
>     that shouldn't be required -- site-packages should be on your
>     sys.path already. Is your python in /export/lib64/python2.3 ? Do you
>     have more than one python?
>  
> My Python is not in  /export/lib64/python2.3. 

> That's a useful trick, thanks.  My python install appears to be in:
>  /usr/lib64/python2.3

> Thanks for the help.  I did get this working by adding the gdal lib path 
> to ld.so.conf and running ldconfig.  Then added a PYTHONPATH setting in 
> .bashrc that points to the /export/lib64/site-package dir.

the question is: why did gdal put your python extensions there? Is there 
anything else there?

What is /export? I've seen that before.

Do you have a site-packages dir in /usr/lib64/python2.3 anywhere? Maybe 
you could put a link in /usr/lib/python2.3 to /export/lib64/site-packages

On the other hand, you have it working, so why mess with it?

-CHB



-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From Chris.Barker at noaa.gov  Fri Aug  8 19:39:49 2008
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Fri Aug  8 19:39:53 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489CD861.1050200@noaa.gov>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C980F.5050208@noaa.gov>
	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>
	<489CD861.1050200@noaa.gov>
Message-ID: <489CD945.6030903@noaa.gov>

Christopher Barker wrote:
> What is /export? I've seen that before.

I meant, I HAVEN'T seen that before.

Anyone, what I'm trying to figure out is if  there is something wrong 
with GDAL's install scripts, or if there is something odd about your system.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov
From randre at gmail.com  Fri Aug  8 19:44:31 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 19:44:33 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489CD945.6030903@noaa.gov>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C980F.5050208@noaa.gov>
	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>
	<489CD861.1050200@noaa.gov> <489CD945.6030903@noaa.gov>
Message-ID: <9c2015090808081644l3ec79b9ep5ea7c6957580328f@mail.gmail.com>

No, no, there is nothing wrong with the install scripts.  The reason it
placed the stuff there is because I specified a --prefix=/export flag in my
configure command.  I installed a bunch of different things on my machine,
and I have a large mounted disk at /export.

Thanks for the follow-up though.
--

On Fri, Aug 8, 2008 at 4:39 PM, Christopher Barker <Chris.Barker@noaa.gov>wrote:

> Christopher Barker wrote:
>
>> What is /export? I've seen that before.
>>
>
> I meant, I HAVEN'T seen that before.
>
> Anyone, what I'm trying to figure out is if  there is something wrong with
> GDAL's install scripts, or if there is something odd about your system.
>
> -Chris
>
>
>
>
> --
> Christopher Barker, Ph.D.
> Oceanographer
>
> Emergency Response Division
> NOAA/NOS/OR&R            (206) 526-6959   voice
> 7600 Sand Point Way NE   (206) 526-6329   fax
> Seattle, WA  98115       (206) 526-6317   main reception
>
> Chris.Barker@noaa.gov
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/b27d21e8/attachment.html
From mateusz at loskot.net  Fri Aug  8 19:47:03 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug  8 19:47:09 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489CD945.6030903@noaa.gov>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>	<489C980F.5050208@noaa.gov>	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>	<489CD861.1050200@noaa.gov>
	<489CD945.6030903@noaa.gov>
Message-ID: <489CDAF7.5070908@loskot.net>

Christopher Barker wrote:
> Christopher Barker wrote:
>> What is /export? I've seen that before.
> 
> I meant, I HAVEN'T seen that before.
> 
> Anyone, what I'm trying to figure out is if  there is something wrong 
> with GDAL's install scripts, or if there is something odd about your 
> system.

Chris,

I don't think so. I presume Roger used custom --prefix and --pymoddir 
while configuring.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From randre at gmail.com  Fri Aug  8 19:51:30 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Aug  8 19:51:31 2008
Subject: [gdal-dev] Re: The world is flipped redux
In-Reply-To: <9c2015090808081624i6e99b3ddrb4f07ee7cc8a4d42@mail.gmail.com>
References: <9c2015090808081624i6e99b3ddrb4f07ee7cc8a4d42@mail.gmail.com>
Message-ID: <9c2015090808081651w479c4395jde9db8b92690135@mail.gmail.com>

My apologies to Matt, the flip_raster.py does flip something, as when I
compare the images in OpenEV, I can see that they are reversed.  But when I
compare their corner coords with gdalinfo, they appear identical.

$ gdalinfo test.tif
<snip>
Corner Coordinates:
Upper Left  ( -71.3600000, -23.5000000)
Lower Left  ( -71.3600000,  -8.5000000)
Upper Right ( -55.7000000, -23.5000000)
Lower Right ( -55.7000000,  -8.5000000)

$ gdalinfo bolivia_fullres.tif
<snip>
Corner Coordinates:
Upper Left  ( -71.3600000, -23.5000000)
Lower Left  ( -71.3600000,  -8.5000000)
Upper Right ( -55.7000000, -23.5000000)
Lower Right ( -55.7000000,  -8.5000000)

My head hurts.
--

On Fri, Aug 8, 2008 at 4:24 PM, Roger Andr? <randre@gmail.com> wrote:

> Ok, this is driving me nuts, I can't handle "South is up" anymore.  I have
> NetCDF derived GMT grids which have a flipped y-axis.  This makes for
> georeferencing that looks like this:
> Corner Coordinates:
> Upper Left  ( -90.0000000, -90.0000000)
> Lower Left  ( -90.0000000,   0.0000000)
> Upper Right (   0.0000000, -90.0000000)
> Lower Right (   0.0000000,   0.0000000)
>
> I've seen some old discussions about this, but haven't really found a good
> solution.  I've tried a "flip_raster.py" utility that Matt Perry wrote, but
> it doesn't seem to do anything with my data.  (probably due to my crappy
> data, not Matt's tool) I've also read that there have been some rewrites of
> the NetCDF driver that are supposed to be able to deal with this, but I'm
> not sure about that.
>
> How have others out there dealt with this issue?  I'd like to be able to
> convert the grids into GeoTIFF's and have the TIFF's be "right" side up.
>
> Thanks,
>
> Flipped-off Roger
> --
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080808/f98a7dff/attachment.html
From warmerdam at pobox.com  Sat Aug  9 00:59:55 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Aug  9 01:01:14 2008
Subject: [gdal-dev] Minimalist Windows binaries (OGR)
In-Reply-To: <489BF914.3020000@grid-it.at>
References: <489B20FC.1020507@grid-it.at> <489B2DC2.5070105@gov.yk.ca>
	<489B2F7D.8090002@pobox.com> <489BF914.3020000@grid-it.at>
Message-ID: <489D244B.50908@pobox.com>

Philippe Kruschitz wrote:
> 
> Thanks Frank and Matt,
> 
> I'll have a look at it. Regarding the .prj-file generation, starting 
> with what version does GDAL do it? The newer FWTools have it, but the 
> 1.5.0 version (at least the one included in those "minimalist binaries") 
> doesn't.


Philippe,

I'm afraid I've lost a bit of our thread.  The OGR Shapefile driver has
supported .prj files since at least GDAL/OGR 1.4.0 if that is the question.
I'm not sure what problem you are having with 1.5 binaries.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Chris.Barker at noaa.gov  Sat Aug  9 02:06:34 2008
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Sat Aug  9 02:06:38 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489CDAF7.5070908@loskot.net>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>
	<489C980F.5050208@noaa.gov>
	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>
	<489CD861.1050200@noaa.gov> <489CD945.6030903@noaa.gov>
	<489CDAF7.5070908@loskot.net>
Message-ID: <489D33EA.4080707@noaa.gov>

Mateusz Loskot wrote:
> I don't think so. I presume Roger used custom --prefix and --pymoddir 
> while configuring.

If that's the case, then he could set --pmoddir to the regular python 
location.

But if setting --prefix changes where the python stuff goes too, then 
that's an unfortunate limitation in the build/install scripts.

-Chris




-- 
Christopher Barker, Ph.D.
Oceanographer

NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception
From mateusz at loskot.net  Sat Aug  9 07:56:37 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug  9 07:56:48 2008
Subject: [gdal-dev] Problem importing osgeo module in Python
In-Reply-To: <489D33EA.4080707@noaa.gov>
References: <9c2015090808080946hcacdb77j27d7334d6b8cadf5@mail.gmail.com>	<489C980F.5050208@noaa.gov>	<9c2015090808081615x274422ddwf7208bd495c6d4@mail.gmail.com>	<489CD861.1050200@noaa.gov>
	<489CD945.6030903@noaa.gov>	<489CDAF7.5070908@loskot.net>
	<489D33EA.4080707@noaa.gov>
Message-ID: <489D85F5.4010909@loskot.net>

Christopher Barker wrote:
> Mateusz Loskot wrote:http://trac.osgeo.org/gdal/browser/trunk
>> I don't think so. I presume Roger used custom --prefix and --pymoddir 
>> while configuring.
> 
> If that's the case, then he could set --pmoddir to the regular python 
> location.
> 
> But if setting --prefix changes where the python stuff goes too, then 
> that's an unfortunate limitation in the build/install scripts.

Christopher,

--prefix does not affect where Python stuff goes.
GDAL ./configure tries to detect Python location using sys.prefix 
property what is Python version dependent:

$python_prefix/$PYLIB/python${python_version}/site-packages


On x64 systems, PYLIB=lib64.

Here is the whole logic implemented:

http://trac.osgeo.org/gdal/browser/trunk/gdal/m4/acinclude.m4

If Python location can not be determined properly, then it falls back with:

pythondir='$(prefix)/lib/site-python'

Perhaps this last case is suspicious, but I'm not an expert of Python 
installations.

Anyway, if anyone has noticed bugs in the Python detection logic, please 
  don't hesitate to report a ticket at http://trac.osgeo.org/gdal/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From tutey at o2.pl  Sun Aug 10 03:14:30 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Sun Aug 10 03:12:59 2008
Subject: [gdal-dev] could GDAL enforce towgs84=0,0,0 for ETRS89-based CRSs?
In-Reply-To: <4890E4D4.2040208@o2.pl>
References: <4890E4D4.2040208@o2.pl>
Message-ID: <489E9556.7030503@o2.pl>

Maciej Sieczka pisze:

> Due to a change in PROJ 4.6.0, no datum shift is aplied when
> reprojecting between a CRS which has an implicit datum definition (e.g.
> Pulkovo 1942/58-based EPSG 4179, for which GDAL uses
> towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84) and an ETRS89-based
> CRS, e.g. EPSG 2180, that has no implicit towgs84 or datum.
> 
> The above results in reprojection errors of about 150 m and makes using
> EPSG codes for ETRS89-based CRS impossible. Could PROJ.4 and GDAL
> enforce towgs84=0,0,0 for all ETRS89 CRSs that have no implicit datum
> definition otherwise?
> 
> For instance, GRASS always forces towgs84=0,0,0 for EPSG 2180 and does
> the reprojection right.

I'm repeating my request. Please read above for the general outline.
More details follow below.

There are 58 CRSs in PROJ.4 4.6 epsg file that are based on ETRS89
datum. Using any of their EPSG codes leads to *huge* reprojection errors
because towgs84=0,0,0 is not applied for them. Example:

The source EPSG 4179 is Pulkovo 1942(58) based, target EPSG 2180 is
ETRS89 based. Since no explicit towgs84 is specified for EPSG 2180 but
it is for EPSG 4179, GDAL fails to perform the datum shift and returns a
wrong result:

$ echo "16E 52N 64" | gdaltransform -s_srs EPSG:4179 -t_srs EPSG:2180
294132.884446735 463557.976146893 64

The correct reprojection is possible only if the EPSG 2180 definition is
given in proj4 format *plus* +towgs84=0,0,0:

$ echo "16E 52N 64" | gdaltransform -s_srs EPSG:4179 -t_srs "+proj=tmerc 
+lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 
+units=m +towgs84=0,0,0"
294006.094422874 463523.916413687 103.090447655879

Please do something about it. Currently, GDAL dependent software that
relies on GDAL's interpretation of EPSG codes will introduce
reprojection errors of dozens of meters for all the 58 ETRS89 based
CRSs, including e.g. pan-European LCC (EPSG 3034) or LAEA (EPSG 3035),
when datum shift is involved. Lots of users are affected.

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From 27949218 at qq.com  Sun Aug 10 05:29:53 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Sun Aug 10 05:29:58 2008
Subject: [gdal-dev] Update ShapeLayer
Message-ID: <tencent_3777B60031B76F0679D051A2@qq.com>

Hi,
  To update shape files. i got two questions: 
 1. How could i delete a field from a shapelayer?
 2. How to set a value to a specified field of all records? Could i use SQL sentences like "set field_name='value'" on the datasource of shapelayer? 
 Thank you.
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080810/42e67b35/attachment.html
From klokan at klokan.cz  Sun Aug 10 05:36:49 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Sun Aug 10 05:36:53 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: Opacity for Google Maps Overlay,
	Embedded Google Earth, Tile generation
Message-ID: <6e41d95b0808100236u53c419f3s4ce44bfd2f01b05c@mail.gmail.com>

Hi folks,

1. What did I do recently:

- Update of the Google Maps based viewer. I designed my own Opacity
Control for Google Maps - so overlay has a changeable opacity on the
web. The HYBRID transparent labels are over the custom overlay (a lot
of work :-().
- Update of the Google Earth Plugin viewer (embedded in webbrowser),
so it is loading the KML SuperOverlay for tiles.

look at: http://www.klokan.cz/projects/gdal2tiles/overlay/googlemaps.html

- OpenLayers based viewer implementing the same functionality (the
opacity control is not finished yet) but the overlay is displayed on
top of all possible maps (and can be combined with custom WMS source).
OpenLayers supports now all Google Maps, Microsoft Virtual Earth Maps,
Yahoo Maps, OpenStreetMap and OpenAerialMap.

look at: http://www.klokan.cz/projects/gdal2tiles/overlay/openlayers.html

- A set of python scripts for testing of the quality of the tile
generation for new version of GDAL2Tiles. To choose best quality/speed
combination without dependency on external libraries. In the end I am
using gdal.AutoCreateWarpedVRT() for reprojecting the supplied raster
to Spherical Mercator, then requesting a window by ReadRaster(). This
window is stored in memory (MEM driver) and has bigger size then the
needed tile. The tile itself is created by scaling down this bigger
memory dataset to the final size by gdal.RegenerateOverview()
('average' algorithm) and then by calling CreateCopy to final PNG
file.

*** I hope this is the best way how to generate high-quality
reprojected tiles from a supplied raster. If you have some ideas
regarding this, please let me know...

This approach is used only for maximal resulution tiles. The higher
level of the tile pyramid (overviews) are going to be done the same
way like gdal_retile.py do, e.g. by reading existing 4 tiles and
scaling down to the one with the same geographical extent. I plan to
use again gdal.RegenerateOverview(), but I there is a way how to do
that with gdal.ReprojectImage() - even for the non-georeferenced
rasters. When calling ReprojectImage you can choose scaling algo
('bilinear','cubic','lanczos',..), but I prefer to use Overview's
'average' algorithm.
This seems to be fastest way and it guarantee the best results even on
the top of pyramid which are not achievable by other technique.
It is fastest also because the source raster can be Warped VRT.

- I was playing with the new GDAL 1.6 (trunk) functionality for  which
is replacing pct2rgb.py (gdal_translate -expand rgb|rgba). When used
in combination with VRT driver it perfectly serves the raster files
which has palette inside (typically NOAA BSB, USGS, some other TIFFs).

The code is published in my GDAL SVN sandbox.

2. What do I plan to do next week:

- Merge the developed functionality with gdal2tiles.py from gdal-trunk svn.
I plan to add parameters:
-s_srs 'source projection'   - for specifying a spatial reference
system for file which does not have it embeded
-zoom number|from-|-to|from-to -for selecting zoom levels (of Google
Maps/SphericalMercator pyramid) which will be generated from raster
-format 'mercator'|'geodetic'|'simple' - for selecting the tms profile of tiles
-forcekml will have extended functionality, as it will generate kml
for tiles in any projection (including Spherical Mercator) - it is not
cartographically correct, as you are using for example mercator raster
on top of Platte Carre, but it is a requested feature as then you need
only one set of tiles for both web viewer overlay (Google Maps like)
and 3D overlay (Google Earth). The cartographic shift is disapearing
as you are zooming closer. I think I will include some kind of
warning.

- Finish the templates for gdal2tiles and use them in code of the utility.

I guess the documentation and submitting of the new opacity controls
to OpenLayers trac / Google Maps API Examples will wait after
pencil-down deadline.
I plan to create a nice website about Spherical Mercator projection -
to explain how the tiling in Google Maps and similar services runs. It
will use the diagrams and graphic from my poster:
http://www.klokan.cz/projects/gdal2tiles/gdal2tiles-poster.pdf

3. I blocked on:

- OpenLayers synchronous AJAX loading of XML. Right now the generated
web viewers has the bounding box of raster encoded inside the
JavaScipt.
I am afraid I will not implement the loading of Metadata
(tilemapresource.xml) dynamically as it is hard to do (overlay will
appear later) and there are issues with XSS (you can't load XML from
another server then the html viewer is without setting up of a cgi
proxy)

Klokan
From mateusz at loskot.net  Sun Aug 10 08:35:24 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Aug 10 08:35:30 2008
Subject: [gdal-dev] Update ShapeLayer
In-Reply-To: <tencent_3777B60031B76F0679D051A2@qq.com>
References: <tencent_3777B60031B76F0679D051A2@qq.com>
Message-ID: <489EE08C.2020102@loskot.net>

wow wrote:
> Hi,
>   To update shape files. i got two questions: 

wow,

For Shapefile updating issues, read this post:

http://lists.osgeo.org/pipermail/gdal-dev/2008-August/017855.html

>  1. How could i delete a field from a shapelayer?

You have to create new Shapefile based on attributes schema of the 
exisiting Shapefile but removing unwanted field.

If your shapefile stores any features, it's not possible to update its 
structure.

>  2. How to set a value to a specified field of all records?
 > Could i use SQL sentences like "set field_name='value'" on the
> datasource of shapelayer? 

You can do it programmatically with a script or C/C++ program.
OGR SQL [1] engine does not support SQL UPDATE/INSERT commands.

[1] http://gdal.org/ogr/ogr_sql.html

BTW, it's a good idea to scan the archives of this mailing list, where 
you will find a lot of discussion about updating Shapefile issues.

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From sfkeller at gmail.com  Sun Aug 10 08:51:29 2008
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun Aug 10 08:51:31 2008
Subject: [gdal-dev] Status of (WMS) tiling specification at OGC and OSGEO?
Message-ID: <25bc040b0808100551o207defa3ucfdbf566ec888a74@mail.gmail.com>

Hi Petr, hello all,

That GSoC project GDAL2Tiles from you is an awesome work. You're giving also
a good overview on viewers and "Tile Structures for Custom Map Publishing"
here: http://www.klokan.cz/projects/gdal2tiles/

This raises for me some questions to you but ultimately are targeted to OGC,
OSGEO as well as to other members regarding the status of (WMS) tiling
specification(s).

You speak of "TMS compatible". I think there is quite some confusion
regarding (WMS) tiling and caching standards, especially but not only on
OSGEO ( http://wiki.osgeo.org/wiki/WMS_Tile_Caching;
http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification;
http://wiki.osgeo.org/wiki/WMS_Tiling_Client_Recommendation;
http://wiki.osgeo.org/wiki/TilingStandard). There's also a recent thread
about this about "WMS-C tile caching spec" here
https://lists.opengeospatial.org/mailman/private/mass-market-geo/ where
David P. prepares a talk.

I think it would be worthwhile especially for OGC and OSGEO to clarify:

1. What is the status of "WMS Tiling"at OGC?

2. What is the status of the tiling standard from an OSGEO view (same as
OGC's "WMS Tiling"? Will it follow OGC's proposal if there's one)?

3. Someone to summarize the relationship of "WMS Tiling/Tiles (OGC)", "Tile
Map Service Specification/TMS (OSGEO)" and WMS-C (OSGEO,
http://tilecache.org)?

- Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080810/ed547c1d/attachment.html
From jaadfoo at gmail.com  Sun Aug 10 13:21:29 2008
From: jaadfoo at gmail.com (Jamie Adams)
Date: Sun Aug 10 13:21:32 2008
Subject: [gdal-dev] Re: The world is flipped redux
In-Reply-To: <9c2015090808081651w479c4395jde9db8b92690135@mail.gmail.com>
References: <9c2015090808081624i6e99b3ddrb4f07ee7cc8a4d42@mail.gmail.com>
	<9c2015090808081651w479c4395jde9db8b92690135@mail.gmail.com>
Message-ID: <f4339510808101021o3f8b3d76x3f533f7d80045cf5@mail.gmail.com>

It looks like Matt's script doesn't modify the geotransform, just reverses
the rows in the image.  You probably need to calculate a new ulx and make
sure the pixel dimensions are expressed correctly (+/-).

>From the sound of it, your original image would actually be right if the
viewer software read the corner coordinates and displayed the image based on
those.  :-)

-Jamie

On Fri, Aug 8, 2008 at 4:51 PM, Roger Andr? <randre@gmail.com> wrote:

> My apologies to Matt, the flip_raster.py does flip something, as when I
> compare the images in OpenEV, I can see that they are reversed.  But when I
> compare their corner coords with gdalinfo, they appear identical.
>
> $ gdalinfo test.tif
> <snip>
> Corner Coordinates:
> Upper Left  ( -71.3600000, -23.5000000)
> Lower Left  ( -71.3600000,  -8.5000000)
> Upper Right ( -55.7000000, -23.5000000)
> Lower Right ( -55.7000000,  -8.5000000)
>
> $ gdalinfo bolivia_fullres.tif
> <snip>
> Corner Coordinates:
> Upper Left  ( -71.3600000, -23.5000000)
> Lower Left  ( -71.3600000,  -8.5000000)
> Upper Right ( -55.7000000, -23.5000000)
> Lower Right ( -55.7000000,  -8.5000000)
>
> My head hurts.
> --
>
>
> On Fri, Aug 8, 2008 at 4:24 PM, Roger Andr? <randre@gmail.com> wrote:
>
>> Ok, this is driving me nuts, I can't handle "South is up" anymore.  I have
>> NetCDF derived GMT grids which have a flipped y-axis.  This makes for
>> georeferencing that looks like this:
>> Corner Coordinates:
>> Upper Left  ( -90.0000000, -90.0000000)
>> Lower Left  ( -90.0000000,   0.0000000)
>> Upper Right (   0.0000000, -90.0000000)
>> Lower Right (   0.0000000,   0.0000000)
>>
>> I've seen some old discussions about this, but haven't really found a good
>> solution.  I've tried a "flip_raster.py" utility that Matt Perry wrote, but
>> it doesn't seem to do anything with my data.  (probably due to my crappy
>> data, not Matt's tool) I've also read that there have been some rewrites of
>> the NetCDF driver that are supposed to be able to deal with this, but I'm
>> not sure about that.
>>
>> How have others out there dealt with this issue?  I'd like to be able to
>> convert the grids into GeoTIFF's and have the TIFF's be "right" side up.
>>
>> Thanks,
>>
>> Flipped-off Roger
>> --
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080810/3f2426f8/attachment.html
From klokan at klokan.cz  Sun Aug 10 16:58:00 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Sun Aug 10 16:58:04 2008
Subject: [gdal-dev] Re: Status of (WMS) tiling specification at OGC and
	OSGEO?
In-Reply-To: <25bc040b0808100551o207defa3ucfdbf566ec888a74@mail.gmail.com>
References: <25bc040b0808100551o207defa3ucfdbf566ec888a74@mail.gmail.com>
Message-ID: <6e41d95b0808101358l500b9881u767248baefd2497b@mail.gmail.com>

Hello everybody,

I try to describe the difference between specifications (it is
simplified a bit).

If we will speak about the most wanted tiles for "Spherical Mercator"
(EPSG:900913/EPSG:3785
http://spatialreference.org/ref/user/epsg900913/), the key is
compatibility with Google Maps and similar services (Microsoft,
Yahoo), which all uses the same projection - tiles covering the same
area in the same zoom level. It means you can combine/overlay
different map-sources exactly as it is done for example in:
http://www.klokan.cz/projects/gdal2tiles/overlay/openlayers.html
(OpenLayers does the job).

It means the extent of available tiles and zoom (number of pixels per
meter) is predefined for the whole Earth. The difference between
tiling standards (OSGEO/OGC) is only in the URL you need to use to
access particular tile. Another difference is in the xml format of
metadata related to the service (think equivalent of WMS's
GetCapabilities).

TileCache.org projects implements two OSGEO standards: WMS-C and TMS.
GDAL2Tiles is a generator of tiles compatible with TMS.
Do you know about any implementations of OGC tiling standards?

OSGEO WMS-C:
-------------------------

WMS-C is a normal WMS with a recommendation for client query, there is
no extension on the standard. The server guarantee to (quickly) answer
only the requests for extents which are defined by tiling scheme (and
are therefore compatible with other tiles). Any WMS server is serving
also WMS-C, but a WMS client needs to be modified into WMS-C - to send
only requests in predefined extents. True WMS-C server (like
tilecache) is not able to return raster for any extent, only for
extents predefined by tiling profile.

More info:
http://wiki.osgeo.org/wiki/WMS_Tile_Caching
(http://wiki.osgeo.org/wiki/WMS_Tiling_Client_Recommendation)

Example (shorten) of a tile request looks like normal WMS (this is
epsg:4326 so Global Geodetic Profile):

http://labs.metacarta.com/wms-c/tilecache.py?LAYERS=basic
    &FORMAT=image/png
   &SERVICE=WMS
   &VERSION=1.1.1
   &REQUEST=GetMap
   &SRS=EPSG:4326
   &BBOX=-90,0,0,90
   &WIDTH=256
   &HEIGHT=256

OSGEO Tile Map Service - TMS:
------------------------------------------------

Tiles are requested in the REST form, so both dynamic generation (a la
tilecache.org) and pre-generation into static tiles (a la gdal2tiles)
is possible.
The geographic extent is addressed by zoom level and tile coordinates.

Documentation is at:
http://wiki.osgeo.org/wiki/Tile_Map_Service_Specification

Request looks like:

http://labs.metacarta.com/wms-c/tilecache.py/1.0.0/basic/5/32/23.png

or in general:

server-and-url/5/32/23.png
server-and-url/script.ext?var=/5/32/23.png

My notes to the TMS standard:
There is plenty of XML Metadata files, but nobody has ever used that
as I know (the are generated by tilecache, but no clients are parsing
them as I know but new Keo's GDAL TMS read driver from this year
GSoC). Origin of the tiles is bottom-left (IMHO it should be changed
to in the new version of TMS as it is causing a lot of implementation
troubles on both client and server side, some are using TMS but with
top-left origin tiles, for example OpenStreetMap. Google Maps is
naturally top-left, gdal is internally top-left, any computer raster
graphic is top-left).

OpenGIS Tiled WMS:
-------------------------------

As I know it is a suggestion for extension of the WMS standard so the
tiles are access differently, there is extension of GetCapabilities,
etc..
Tiles are access in the form (shorten):

baseUrl?SERVICE=WMS
       &REQUEST=GetTile
       &FORMAT=image/png
       &SCALE=5e6
       &TIME=2007-06
       &TILEROW=42
       &TILECOL=112

I have no clue if anybody implemented that.
Origin of tiles is top-left.
Documentation is available at:
http://portal.opengeospatial.org/files/?artifact_id=23206

Does it really bring something new, when compared to WMS-C which is
more or less only client based? I think server can make cacheing even
without changing anything on the WMS standard or not?

OpenGIS Web Map Tiling Service (WMTS)
--------------------------------------------------------------

OpenGIS is working on another service called WMTS. I think it should
be more or less the same like OSGEO TMS (I hope they are going to make
it RESTful). I haven't seen any documentation (where to get the
document: specification draft OGC 07-057r4 ?).

Other tile formats
-------------------------
There is plenty of application using tiles, both providers and
clients. Usually they define their own format.
Well known is format of Microsoft Quadkey (implemented by Virtual
Earth and by generator MapCruncher), format of NASA WorldWind
(implemented by tilecache as well) and several other. I summarized
some of them at:
http://spreadsheets.google.com/pub?key=pm3_jKEJCJ2fWv3lToe7KZA
The table could be longer, but i don't see any reason why to do that...

Comments are welcome

Klokan

P.S.
There is similarity between relation of an imageserver/zoomify and WMS/TMS.
TMS directly does not mean the the static files. I can imagine a
simplified tilecache project serving tiles directly based on TMS,
where the tiles are stored for example on Google BigTable (App Engine)
or Amazon S3 or in any other database/storage.
It would be even possible to write a patch for mapserver which will
add tms= argument and internally expand it to the standard WMS query.
From ivan.lucena at pmldnet.com  Sun Aug 10 21:26:23 2008
From: ivan.lucena at pmldnet.com (=?utf-8?Q?Lucena,=20Ivan?=)
Date: Sun Aug 10 21:26:25 2008
Subject: =?utf-8?B?UmU6IFtnZGFsLWRldl0gR1NvQyBHREFMMlRpbGVzOiBPcGFjaXR5IGZvciBHb29nbGUgTWFwcyBPdmVybGF5LAlFbWJlZGRlZCBHb29nbGUgRWFydGgsIFRpbGUgZ2VuZXJhdGlvbg==?=
Message-ID: <20080811012623.22494.qmail@s466.sureserver.com>

Hi Klokan,

Would you mind if I extend your message tread a little bit?

The GDAL2Tiles is a great tool and it just getting better, congratulation.

But I have some end-user complain that they don't like to see the pixel blended when you get very close to then. Those folks really want to see the big square blocks of their images classification on top of Google Earth images. That is not your fault of course. That is a nice feature on GE, a anti-aliasing rendering technique that probably attend the general public. I have spoken with Google about that but it didn't resonate. 

As far as I can remember (from OpenGL project that I worked in the past) this problem could be easily solved with just a parameter change on the texture-surface-rendering definition. I may be wrong.

My question is, do you know if there is any way to change that behavior on GE? 

Doesn't look like you can change that option through the API as a plugin, does it? Or maybe there is something you can do on the KML.

By the way, does any one have ever received that request from users?

Best regards,

Ivan


>  -------Original Message-------
>  From: Klokan Petr P?idal <klokan@klokan.cz>
>  Subject: [gdal-dev] GSoC GDAL2Tiles: Opacity for Google Maps Overlay,	Embedded Google Earth, Tile generation
>  Sent: Aug 10 '08 09:36
>  
>  Hi folks,
>  
>  1. What did I do recently:
>  
>  - Update of the Google Maps based viewer. I designed my own Opacity
>  Control for Google Maps - so overlay has a changeable opacity on the
>  web. The HYBRID transparent labels are over the custom overlay (a lot
>  of work :-().
>  - Update of the Google Earth Plugin viewer (embedded in webbrowser),
>  so it is loading the KML SuperOverlay for tiles.
>  
>  look at: http://www.klokan.cz/projects/gdal2tiles/overlay/googlemaps.html
>  
>  - OpenLayers based viewer implementing the same functionality (the
>  opacity control is not finished yet) but the overlay is displayed on
>  top of all possible maps (and can be combined with custom WMS source).
>  OpenLayers supports now all Google Maps, Microsoft Virtual Earth Maps,
>  Yahoo Maps, OpenStreetMap and OpenAerialMap.
>  
>  look at: http://www.klokan.cz/projects/gdal2tiles/overlay/openlayers.html
>  
>  - A set of python scripts for testing of the quality of the tile
>  generation for new version of GDAL2Tiles. To choose best quality/speed
>  combination without dependency on external libraries. In the end I am
>  using gdal.AutoCreateWarpedVRT() for reprojecting the supplied raster
>  to Spherical Mercator, then requesting a window by ReadRaster(). This
>  window is stored in memory (MEM driver) and has bigger size then the
>  needed tile. The tile itself is created by scaling down this bigger
>  memory dataset to the final size by gdal.RegenerateOverview()
>  ('average' algorithm) and then by calling CreateCopy to final PNG
>  file.
>  
>  *** I hope this is the best way how to generate high-quality
>  reprojected tiles from a supplied raster. If you have some ideas
>  regarding this, please let me know...
>  
>  This approach is used only for maximal resulution tiles. The higher
>  level of the tile pyramid (overviews) are going to be done the same
>  way like gdal_retile.py do, e.g. by reading existing 4 tiles and
>  scaling down to the one with the same geographical extent. I plan to
>  use again gdal.RegenerateOverview(), but I there is a way how to do
>  that with gdal.ReprojectImage() - even for the non-georeferenced
>  rasters. When calling ReprojectImage you can choose scaling algo
>  ('bilinear','cubic','lanczos',..), but I prefer to use Overview's
>  'average' algorithm.
>  This seems to be fastest way and it guarantee the best results even on
>  the top of pyramid which are not achievable by other technique.
>  It is fastest also because the source raster can be Warped VRT.
>  
>  - I was playing with the new GDAL 1.6 (trunk) functionality for  which
>  is replacing pct2rgb.py (gdal_translate -expand rgb|rgba). When used
>  in combination with VRT driver it perfectly serves the raster files
>  which has palette inside (typically NOAA BSB, USGS, some other TIFFs).
>  
>  The code is published in my GDAL SVN sandbox.
>  
>  2. What do I plan to do next week:
>  
>  - Merge the developed functionality with gdal2tiles.py from gdal-trunk svn.
>  I plan to add parameters:
>  -s_srs 'source projection'   - for specifying a spatial reference
>  system for file which does not have it embeded
>  -zoom number|from-|-to|from-to -for selecting zoom levels (of Google
>  Maps/SphericalMercator pyramid) which will be generated from raster
>  -format 'mercator'|'geodetic'|'simple' - for selecting the tms profile of tiles
>  -forcekml will have extended functionality, as it will generate kml
>  for tiles in any projection (including Spherical Mercator) - it is not
>  cartographically correct, as you are using for example mercator raster
>  on top of Platte Carre, but it is a requested feature as then you need
>  only one set of tiles for both web viewer overlay (Google Maps like)
>  and 3D overlay (Google Earth). The cartographic shift is disapearing
>  as you are zooming closer. I think I will include some kind of
>  warning.
>  
>  - Finish the templates for gdal2tiles and use them in code of the utility.
>  
>  I guess the documentation and submitting of the new opacity controls
>  to OpenLayers trac / Google Maps API Examples will wait after
>  pencil-down deadline.
>  I plan to create a nice website about Spherical Mercator projection -
>  to explain how the tiling in Google Maps and similar services runs. It
>  will use the diagrams and graphic from my poster:
>  http://www.klokan.cz/projects/gdal2tiles/gdal2tiles-poster.pdf
>  
>  3. I blocked on:
>  
>  - OpenLayers synchronous AJAX loading of XML. Right now the generated
>  web viewers has the bounding box of raster encoded inside the
>  JavaScipt.
>  I am afraid I will not implement the loading of Metadata
>  (tilemapresource.xml) dynamically as it is hard to do (overlay will
>  appear later) and there are issues with XSS (you can't load XML from
>  another server then the html viewer is without setting up of a cgi
>  proxy)
>  
>  Klokan
>  _______________________________________________
>  gdal-dev mailing list
>  gdal-dev@lists.osgeo.org
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
From Michael.Smith at usace.army.mil  Mon Aug 11 04:07:29 2008
From: Michael.Smith at usace.army.mil (Michael Smith)
Date: Mon Aug 11 04:08:35 2008
Subject: [Gdal-dev] support for Oracle GeoRaster?
Message-ID: <C4C56B82.5BAE4%Michael.Smith@usace.army.mil>

John,

Saw your inquiry in the gdal-dev list and wanted to let you know that beta
oracle georaster support is now in gdal svn. Note that I?m not the developer
but one of the proponents that help push Oracle to fund this.

Mike


-- 
Michael Smith
RSGIS Center
ERDC - CRREL
US Army Corps of Engineers
w: 603-646-4765
m: 603-401-4173 


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080811/1351b3e6/attachment.html
From schut at sarvision.nl  Mon Aug 11 06:35:37 2008
From: schut at sarvision.nl (Vincent Schut)
Date: Mon Aug 11 06:40:49 2008
Subject: [gdal-dev] BuildOverviews (python) going nuts?
Message-ID: <48A015F9.6020303@sarvision.nl>

Hi folks,

is it just me, or is the BuildOverviews function behaving strange on you to?
I regularly call someDs.BuildOverviews("AVERAGE", [plist]) on my output 
datasets (in swig python, that is). Until some time ago (can't tell 
precisely, have been out of business for some time) this worked find. 
However, currently I get the following errors:

ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "Compression" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "ImageWidth" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "PlanarConfiguration" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "BitsPerSample" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "SamplesPerPixel" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "Compression" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "PhotometricInterpretation" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "SampleFormat" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "TileWidth" while writing
ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
Cannot modify tag "TileLength" while writing
ERROR 1: GTIFFWriteDirectory:Can not write tiles to a stripped image

Which is quite strange, because I am definitely sure that my image is a 
tiled image. I have double-checked this with gdalinfo.

Calling gdaladdo afterward on the file works OK, though, so I suppose 
something has changed in the swig/python wrappers...

Btw this is on linux, pretty recent gdal from svn (rev. 15069), bigtiff 
enabled.

Cheers,
Vincent.
From eloquence2 at gmail.com  Mon Aug 11 09:41:56 2008
From: eloquence2 at gmail.com (D)
Date: Mon Aug 11 09:41:58 2008
Subject: [gdal-dev] Exporting line vertices to SHP using GDAL
Message-ID: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>

Hi,

I would like to export vertices from a 3D Geometry from Oracle Spatial (11g)
into an 2D ESRI Shapefile with a field "Z" that comes from the the 3D SDO
geometry.

Is is possible to do this using GDAL tools?

Any suggestions how to handle this, would be very helpful!

Thanks!

Dejan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080811/c975309e/attachment.html
From mateusz at loskot.net  Mon Aug 11 09:45:53 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 11 09:45:59 2008
Subject: [gdal-dev] Exporting line vertices to SHP using GDAL
In-Reply-To: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>
References: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>
Message-ID: <48A04291.7030206@loskot.net>

D wrote:
> Hi,
> 
> I would like to export vertices from a 3D Geometry from Oracle Spatial (11g)
> into an 2D ESRI Shapefile with a field "Z" that comes from the the 3D SDO
> geometry.
> 
> Is is possible to do this using GDAL tools?

Dejan,

You can use ogr2ogr utility with option -nlt, see this:

http://gdal.org/ogr/ogr2ogr.html

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From eloquence2 at gmail.com  Mon Aug 11 09:54:51 2008
From: eloquence2 at gmail.com (D)
Date: Mon Aug 11 09:54:54 2008
Subject: [gdal-dev] Exporting line vertices to SHP using GDAL
In-Reply-To: <48A04291.7030206@loskot.net>
References: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>
	<48A04291.7030206@loskot.net>
Message-ID: <860f58590808110654s2cbbfa0cr9021e7d68812fe2@mail.gmail.com>

Dear Mateusz,

I was not clear enough. what I would need is exporting every single vertex
to a single point feature in a SHP.

If I am quessing, I can just define in OGR2OGR -NLT POINT and I will point
objects of every single vertex?

How do I fill in the atribute Z value for every single exported point
feature?

Thanks!

Dejan

On Mon, Aug 11, 2008 at 3:45 PM, Mateusz Loskot <mateusz@loskot.net> wrote:

> D wrote:
>
>> Hi,
>>
>> I would like to export vertices from a 3D Geometry from Oracle Spatial
>> (11g)
>> into an 2D ESRI Shapefile with a field "Z" that comes from the the 3D SDO
>> geometry.
>>
>> Is is possible to do this using GDAL tools?
>>
>
> Dejan,
>
> You can use ogr2ogr utility with option -nlt, see this:
>
> http://gdal.org/ogr/ogr2ogr.html
>
> Best regards
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080811/141c9c3f/attachment.html
From tutey at o2.pl  Mon Aug 11 10:03:38 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Mon Aug 11 10:02:04 2008
Subject: [gdal-dev] HFA_USE_RRD vs USE_RRD
In-Reply-To: <48945F15.4020505@pobox.com>
References: <48939161.2050302@o2.pl> <48945F15.4020505@pobox.com>
Message-ID: <48A046BA.2090109@o2.pl>

Frank Warmerdam pisze:
> If you file a ticket I'll try and document things somewhat better.

Done http://trac.osgeo.org/gdal/ticket/2529.

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From mateusz at loskot.net  Mon Aug 11 10:04:53 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 11 10:04:58 2008
Subject: [gdal-dev] Exporting line vertices to SHP using GDAL
In-Reply-To: <860f58590808110654s2cbbfa0cr9021e7d68812fe2@mail.gmail.com>
References: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>	
	<48A04291.7030206@loskot.net>
	<860f58590808110654s2cbbfa0cr9021e7d68812fe2@mail.gmail.com>
Message-ID: <48A04705.6040101@loskot.net>

D wrote:
> Dear Mateusz,
> 
> I was not clear enough. what I would need is exporting every single vertex
> to a single point feature in a SHP.
> 
> If I am quessing, I can just define in OGR2OGR -NLT POINT and I will point
> objects of every single vertex?
> 
> How do I fill in the atribute Z value for every single exported point
> feature?

Dejan,

I suppose you need to write a script to get it done.
Pythonized solution won't take too long.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Mon Aug 11 10:31:52 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 11 10:31:57 2008
Subject: [gdal-dev] Exporting line vertices to SHP using GDAL
In-Reply-To: <860f58590808110709m4181bbccoaac9e29be6a2f0a2@mail.gmail.com>
References: <860f58590808110641u21ee093di7bd1674aceb6ca1@mail.gmail.com>	
	<48A04291.7030206@loskot.net>	
	<860f58590808110654s2cbbfa0cr9021e7d68812fe2@mail.gmail.com>	
	<48A04705.6040101@loskot.net>
	<860f58590808110709m4181bbccoaac9e29be6a2f0a2@mail.gmail.com>
Message-ID: <48A04D58.5010903@loskot.net>

D wrote:
> Thanks for the hint, Mateusz.
> 
> I am guessing that I will need to get a driver in Python to write from an
> Oracle table to a DBF field 'Z'?

Yes, you've probably seen my script:

http://lists.osgeo.org/pipermail/gdal-dev/2008-August/017897.html

> I am not quite sure how the script will know for which point feature it has
> to write which Z value - one line feature in SDO has multiple point feature
> in SHP :S

You have to figure out how you want to make points separation of your 
geometry.

> Another problem is that is am also a beginner in Python, but I am growing
> :-)

I'm quite sure that everybody here was a beginner too :-)
This should be helpful:

http://trac.osgeo.org/gdal/wiki/GdalOgrInPython
http://docs.python.org/tut/tut.html

and here you can find plenty of examples:

http://trac.osgeo.org/gdal/browser/trunk/autotest/ogr


Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From randre at gmail.com  Mon Aug 11 11:50:26 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Mon Aug 11 11:56:30 2008
Subject: [gdal-dev] Re: The world is flipped redux
In-Reply-To: <f4339510808101021o3f8b3d76x3f533f7d80045cf5@mail.gmail.com>
References: <9c2015090808081624i6e99b3ddrb4f07ee7cc8a4d42@mail.gmail.com>
	<9c2015090808081651w479c4395jde9db8b92690135@mail.gmail.com>
	<f4339510808101021o3f8b3d76x3f533f7d80045cf5@mail.gmail.com>
Message-ID: <9c2015090808110850x16d7042cs6ba5db0f1b1198a1@mail.gmail.com>

Cool, thanks.  I'll add some print statements to the script to see what's
being written, will flip the y-axis coords in the output, and will verify
that the origin values and pixel dimensions are properly expressed in the
output.

It's neat that you can do this sort of thing with gdal.
--

On Sun, Aug 10, 2008 at 10:21 AM, Jamie Adams <jaadfoo@gmail.com> wrote:

> It looks like Matt's script doesn't modify the geotransform, just reverses
> the rows in the image.  You probably need to calculate a new ulx and make
> sure the pixel dimensions are expressed correctly (+/-).
>
> From the sound of it, your original image would actually be right if the
> viewer software read the corner coordinates and displayed the image based on
> those.  :-)
>
> -Jamie
>
> On Fri, Aug 8, 2008 at 4:51 PM, Roger Andr? <randre@gmail.com> wrote:
>
>> My apologies to Matt, the flip_raster.py does flip something, as when I
>> compare the images in OpenEV, I can see that they are reversed.  But when I
>> compare their corner coords with gdalinfo, they appear identical.
>>
>> $ gdalinfo test.tif
>> <snip>
>> Corner Coordinates:
>> Upper Left  ( -71.3600000, -23.5000000)
>> Lower Left  ( -71.3600000,  -8.5000000)
>> Upper Right ( -55.7000000, -23.5000000)
>> Lower Right ( -55.7000000,  -8.5000000)
>>
>> $ gdalinfo bolivia_fullres.tif
>> <snip>
>> Corner Coordinates:
>> Upper Left  ( -71.3600000, -23.5000000)
>> Lower Left  ( -71.3600000,  -8.5000000)
>> Upper Right ( -55.7000000, -23.5000000)
>> Lower Right ( -55.7000000,  -8.5000000)
>>
>> My head hurts.
>> --
>>
>>
>> On Fri, Aug 8, 2008 at 4:24 PM, Roger Andr? <randre@gmail.com> wrote:
>>
>>> Ok, this is driving me nuts, I can't handle "South is up" anymore.  I
>>> have NetCDF derived GMT grids which have a flipped y-axis.  This makes for
>>> georeferencing that looks like this:
>>> Corner Coordinates:
>>> Upper Left  ( -90.0000000, -90.0000000)
>>> Lower Left  ( -90.0000000,   0.0000000)
>>> Upper Right (   0.0000000, -90.0000000)
>>> Lower Right (   0.0000000,   0.0000000)
>>>
>>> I've seen some old discussions about this, but haven't really found a
>>> good solution.  I've tried a "flip_raster.py" utility that Matt Perry wrote,
>>> but it doesn't seem to do anything with my data.  (probably due to my crappy
>>> data, not Matt's tool) I've also read that there have been some rewrites of
>>> the NetCDF driver that are supposed to be able to deal with this, but I'm
>>> not sure about that.
>>>
>>> How have others out there dealt with this issue?  I'd like to be able to
>>> convert the grids into GeoTIFF's and have the TIFF's be "right" side up.
>>>
>>> Thanks,
>>>
>>> Flipped-off Roger
>>> --
>>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080811/ea53d4fd/attachment.html
From Martin.Spott at mgras.net  Mon Aug 11 12:31:20 2008
From: Martin.Spott at mgras.net (Martin Spott)
Date: Mon Aug 11 12:32:26 2008
Subject: [gdal-dev] X-Plane runway orientation
Message-ID: <20080811163120.GA7349@jive.mgras.de>

Hi,
the X-Plane driver is reading a single name for a runway and computes
the opposite runway direction. Apparently a tiny mistake has crept into
the respective logic: Currently the opposite of runway 18 is being
computed as runway 00 - but there's no such thing as a runway 00,
instead we're supposed to have runway 36.

The following patch is meant to fix this issue:

--- ./gdal-svn-trunk-2008.08.10/ogr/ogrsf_frmts/xplane/ogr_xplane_apt_reader.cpp~	2008-08-11 18:15:26.000000000 +0200
+++ ./gdal-svn-trunk-2008.08.10/ogr/ogrsf_frmts/xplane/ogr_xplane_apt_reader.cpp	2008-08-11 18:15:26.000000000 +0200
@@ -420,7 +420,7 @@
         int abReil[2];
 
         int num1 = atoi(pszRwyNum);
-        int num2 = (num1 < 18) ? num1 + 18 : num1 - 18;
+        int num2 = (num1 > 18) ? num1 - 18 : num1 + 18;
         if (pszRwyNum[2] == '0' || pszRwyNum[2] == 'x')
         {
             aosRwyNum[0].Printf("%02d", num1);


Please note that I have been looking at the runway threshold names only !!
I'm pretty convinced there are more places (in the same file) where a
similar patch should get applied, most of these look something like:

  dfTrueHeading : (dfTrueHeading < 180) ? dfTrueHeading + 180 : dfTrueHeading - 180

Because I don't know I in which output table to cross-check the
respective results, I decided to leave these unchanged.
Please to me the honour of applying at least this single patch.

Thanks,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------
From bclay at ball.com  Mon Aug 11 12:46:56 2008
From: bclay at ball.com (Clay, Bruce)
Date: Mon Aug 11 12:47:02 2008
Subject: [gdal-dev] curve fit question
Message-ID: <C482FF98AE985A47B8C982FD429C9E34FEFF62@daytonmsg2k3.AERO.BALL.COM>

Does anyone know of a function in GDAL or related libraries that given a
set of points it will return a new set of points that is or can be used
to create a smoothed polyline?  I have heard about things like linear
fit and least squares but I have not used them and I am quite rusty on
the math used to calculate a smoothed line from a set of points.  I have
done a lot of web searching and found various generic algorithms but I
don't see how to apply them.  For example a linear regression sample
takes in a set of X-Y points but it only returns 3 values of C and
standard deviation. 

 

Any help would be greatly appreciated.

 

Bruce




This message and any enclosures are intended only for the addressee.  Please  
notify the sender by email if you are not the intended recipient.  If you are  
not the intended recipient, you may not use, copy, disclose, or distribute this  
message or its contents or enclosures to any other person and any such actions  
may be unlawful.  Ball reserves the right to monitor and review all messages  
and enclosures sent to or from this email address.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080811/5037315b/attachment.html
From neteler at osgeo.org  Mon Aug 11 12:53:00 2008
From: neteler at osgeo.org (Markus Neteler)
Date: Mon Aug 11 12:53:05 2008
Subject: [gdal-dev] curve fit question
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34FEFF62@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34FEFF62@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <86782b610808110953n7cf91e17ua59fe13b7c515f6e@mail.gmail.com>

On Mon, Aug 11, 2008 at 6:46 PM, Clay, Bruce <bclay@ball.com> wrote:
> Does anyone know of a function in GDAL or related libraries that given a set
> of points it will return a new set of points that is or can be used to
> create a smoothed polyline?  I have heard about things like linear fit and
> least squares but I have not used them and I am quite rusty on the math used
> to calculate a smoothed line from a set of points.  I have done a lot of web
> searching and found various generic algorithms but I don't see how to apply
> them.  For example a linear regression sample takes in a set of X-Y points
> but it only returns 3 values of C and standard deviation.

In the old v.digit of GRASS was a spline based curve smoother:
http://trac.osgeo.org/grass/browser/grass/branches/releasebranch_5_0/src/mapdev/v.digit/spline.c

Maybe interesting to look at.

Markus
From mateusz at loskot.net  Mon Aug 11 14:04:06 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 11 14:04:12 2008
Subject: [gdal-dev] curve fit question
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34FEFF62@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34FEFF62@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <48A07F16.70701@loskot.net>

Clay, Bruce wrote:
> Does anyone know of a function in GDAL or related libraries that given a
> set of points it will return a new set of points that is or can be used
> to create a smoothed polyline?  I have heard about things like linear
> fit and least squares but I have not used them and I am quite rusty on
> the math used to calculate a smoothed line from a set of points.  I have
> done a lot of web searching and found various generic algorithms but I
> don't see how to apply them.  For example a linear regression sample
> takes in a set of X-Y points but it only returns 3 values of C and
> standard deviation. 

Bruce,

There are number of simplifiers available in GEOS

http://trac.osgeo.org/geos/

Some very poor-man solution is here :-)

http://mateusz.loskot.net/tmp/gdal/ogr_collinear_simplify.cpp.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From ivan.lucena at pmldnet.com  Mon Aug 11 18:33:39 2008
From: ivan.lucena at pmldnet.com (=?utf-8?Q?Lucena,=20Ivan?=)
Date: Mon Aug 11 18:33:42 2008
Subject: [gdal-dev] Limit on CPLSerializeXMLTree?
Message-ID: <20080811223339.10413.qmail@s466.sureserver.com>

Hi all,

Is there any limitation on the size of the string produced by CPLSerializeXMLTree()?

Best regards,

Ivan
From aperezcarro at yahoo.es  Tue Aug 12 03:28:26 2008
From: aperezcarro at yahoo.es (Antonio Prez)
Date: Tue Aug 12 03:28:37 2008
Subject: [gdal-dev] Gdal contour again ....
Message-ID: <g7re2r$uvo$1@ger.gmane.org>

Hello everybody:
My question is related with gdal_contour.exe utility
This utility works fine writing data vectorized shp and kml formats but
something must be wrong with dgn format.

The aspect of the file (loaded in microstation) is quite strange, polygons
appears broken.

May be because my gdal_contour ( dated : 13/02/2008) write V7 DGN ?????

Some help would we appreciated

Thank you
     --------------------------------------
     Antonio Prez



From schut at sarvision.nl  Tue Aug 12 03:42:55 2008
From: schut at sarvision.nl (Vincent Schut)
Date: Tue Aug 12 03:43:02 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: Opacity for Google Maps Overlay,
	Embedded Google Earth, Tile generation
In-Reply-To: <20080811012623.22494.qmail@s466.sureserver.com>
References: <20080811012623.22494.qmail@s466.sureserver.com>
Message-ID: <48A13EFF.9010003@sarvision.nl>

Hi Ivan, Klokan,

Lucena, Ivan wrote:
> Hi Klokan,
> 
> Would you mind if I extend your message tread a little bit?
> The GDAL2Tiles is a great tool and it just getting better, congratulation.
> But I have some end-user complain that they don't like to see the pixel blended when you get very close to then. Those folks really want to see the big square blocks of their images classification on top of Google Earth images. That is not your fault of course. That is a nice feature on GE, a anti-aliasing rendering technique that probably attend the general public. I have spoken with Google about that but it didn't resonate. 
> As far as I can remember (from OpenGL project that I worked in the past) this problem could be easily solved with just a parameter change on the texture-surface-rendering definition. I may be wrong.
> My question is, do you know if there is any way to change that behavior on GE? 
> Doesn't look like you can change that option through the API as a plugin, does it? Or maybe there is something you can do on the KML.
> By the way, does any one have ever received that request from users?
> 
> Best regards,
> 
> Ivan
> 
<big snip>

It does resonate here :)
I have been publishing deforestation maps with GE (using a home-brewn
gdal-python script), and had the same complaints. I don't want my
classes to mix. An area is either forest, or non-forest, or deforested,
and nothing in between. O how nice it is to force your own will upon
reality :-)
The way I 'solved' this was by adding subsampled tiles, which
effectively prevent GE to start antialiasing to soon. So my highest
resolution tiles are in fact higher resolution than the real full
resolution. This of course is just a workaround and just works if the
user does not zoom in too much, but in my experience it improved the
users' feeling a lot.

I must say I am very interested in a better way to force GE to not
antialias raster overlays.

Regards,
Vincent Schut.

From schut at sarvision.nl  Tue Aug 12 07:21:05 2008
From: schut at sarvision.nl (Vincent Schut)
Date: Tue Aug 12 07:21:09 2008
Subject: [gdal-dev] BuildOverviews (python) going nuts?
In-Reply-To: <48A015F9.6020303@sarvision.nl>
References: <48A015F9.6020303@sarvision.nl>
Message-ID: <48A17221.1020007@sarvision.nl>

OK, my bad, forget this issue. Had an older version of gdal python 
bindings in /usr/lib/python2.5/site-packages, and the newest version in 
/usr/local/lib/... Of course the older one got imported...

VS.

Vincent Schut wrote:
> Hi folks,
> 
> is it just me, or is the BuildOverviews function behaving strange on you 
> to?
> I regularly call someDs.BuildOverviews("AVERAGE", [plist]) on my output 
> datasets (in swig python, that is). Until some time ago (can't tell 
> precisely, have been out of business for some time) this worked find. 
> However, currently I get the following errors:
> 
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "Compression" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "ImageWidth" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "PlanarConfiguration" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "BitsPerSample" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "SamplesPerPixel" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "Compression" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "PhotometricInterpretation" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "SampleFormat" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "TileWidth" while writing
> ERROR 1: TIFFSetField:/home/mrp/modis/zandbak/vzaCorrectionTest.tif: 
> Cannot modify tag "TileLength" while writing
> ERROR 1: GTIFFWriteDirectory:Can not write tiles to a stripped image
> 
> Which is quite strange, because I am definitely sure that my image is a 
> tiled image. I have double-checked this with gdalinfo.
> 
> Calling gdaladdo afterward on the file works OK, though, so I suppose 
> something has changed in the swig/python wrappers...
> 
> Btw this is on linux, pretty recent gdal from svn (rev. 15069), bigtiff 
> enabled.
> 
> Cheers,
> Vincent.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

From plieger at knmi.nl  Tue Aug 12 07:44:55 2008
From: plieger at knmi.nl (Maarten Plieger)
Date: Tue Aug 12 07:45:19 2008
Subject: [gdal-dev] Scale and Offset, datatype and UMN MapServer
Message-ID: <48A177B7.1030304@knmi.nl>

Hi,

When using a file with scale and an offset to transform 8bit BYTE raster 
values into meaningful values, what happens with the datatype? I would 
like to implement the scale and offset parameters in our ADAGUC netcdf4 
driver.
I have seen some drivers to change the datatype to float. What happens 
when translating from such a file to another file? Will the datatype be 
changed to float always?

What happens with UMN MapServer in combination with such a file? I can 
imagine that mapserver does not see a scale and offset parameter, but 
just a raster with datatype float?

The problem is that I would like to pass the reduced BYTE raster data 
with accompaning scale and offset through the Web Coverage Service of 
Mapserver. I do not want to pass the unpacked float raster data.

Is there a standard and neat way to do this?

Best regards,
 Maarten Plieger


-- 
Maarten Plieger
KNMI, R&D Information and Observation Technology, De Bilt
(t) +31 30 2206330 

From randre at gmail.com  Tue Aug 12 13:24:43 2008
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Tue Aug 12 13:24:44 2008
Subject: [gdal-dev] Question about compiling C++ gdal utility
Message-ID: <9c2015090808121024k7e8deec9ufffe330a631d2f19@mail.gmail.com>

I'm trying to compile a gdal utility written in C++ (which is something
completely new to me), and am encountering an error.

color-relief.cpp:30:23: gdal_priv.h: No such file or directory
color-relief.cpp:31:23: stringtok.h: No such file or directory

The gdal_priv.h file is located in /export/include/gdal_priv.h, but I'm not
sure where the stringtok.h file is.

The command I gave to compile was this, "sudo g++ color-relief.cpp -lgdal -o
color-relief".

Can one of you C++ geniuses give me a couple pointers about how to do this
"the right way"?

Thanks,

Roger
--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080812/64548ee3/attachment.html
From mike.nidel at lmco.com  Tue Aug 12 15:44:59 2008
From: mike.nidel at lmco.com (Nidel, Mike)
Date: Tue Aug 12 15:45:20 2008
Subject: [gdal-dev] static linkage of GDAL and GDAL JNI
Message-ID: <E4692D1DCAD27245866154AF9CE126B10F37F721@emss04m02.us.lmco.com>

I'm using GDAL from Java.

I wondered if anyone has statically linked libgdal into the gdaljni.so
for the purposes of Java/JNI interface usage. For anyone who has done
this from Java, you know that setting the java system property
java.library.path is sufficient for the JVM to find a DLL or shared lib
that is located in this path. The problem is that if THAT library
depends on another library in the way that gdaljni.dll/so depends on
gdal.dll/so, then the secondary library can't be located unless it is in
the PATH or the LD_LIBRARY_PATH.

So for example, if you place the gdaljni.dll and gdal.dll in C:/gdal/lib
and set -Djava.library.path=C:/gdal/lib, then you get an error when
gdaljni.dll tries to load gdal.dll. If you also set PATH=C:\gdal\lib,
then it works fine.

I'd really rather not have to worry about the PATH (or LD_LIBRARY_PATH
on linux/unix), so building it all into a single DLL/SO is an
alternative. Does anyone have any thoughts on how to do this within the
GDAL build?

thanks,

Mike
From neteler at osgeo.org  Wed Aug 13 02:58:17 2008
From: neteler at osgeo.org (Markus Neteler)
Date: Wed Aug 13 02:58:20 2008
Subject: [gdal-dev] could GDAL enforce towgs84=0, 0,
	0 for ETRS89-based CRSs?
In-Reply-To: <489E9556.7030503@o2.pl>
References: <4890E4D4.2040208@o2.pl> <489E9556.7030503@o2.pl>
Message-ID: <86782b610808122358w3579d944xf1576d5877a36aac@mail.gmail.com>

On Sun, Aug 10, 2008 at 9:14 AM, Maciej Sieczka <tutey@o2.pl> wrote:
> Maciej Sieczka pisze:
>
>> Due to a change in PROJ 4.6.0, no datum shift is aplied when
>> reprojecting between a CRS which has an implicit datum definition (e.g.
>> Pulkovo 1942/58-based EPSG 4179, for which GDAL uses
>> towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84) and an ETRS89-based
>> CRS, e.g. EPSG 2180, that has no implicit towgs84 or datum.
>>
>> The above results in reprojection errors of about 150 m and makes using
>> EPSG codes for ETRS89-based CRS impossible. Could PROJ.4 and GDAL
>> enforce towgs84=0,0,0 for all ETRS89 CRSs that have no implicit datum
>> definition otherwise?
>>
>> For instance, GRASS always forces towgs84=0,0,0 for EPSG 2180 and does
>> the reprojection right.
>
> I'm repeating my request. Please read above for the general outline.
> More details follow below.
>
> There are 58 CRSs in PROJ.4 4.6 epsg file that are based on ETRS89
> datum. Using any of their EPSG codes leads to *huge* reprojection errors
> because towgs84=0,0,0 is not applied for them. Example:
>
> The source EPSG 4179 is Pulkovo 1942(58) based, target EPSG 2180 is
> ETRS89 based. Since no explicit towgs84 is specified for EPSG 2180 but
> it is for EPSG 4179, GDAL fails to perform the datum shift and returns a
> wrong result:
>
> $ echo "16E 52N 64" | gdaltransform -s_srs EPSG:4179 -t_srs EPSG:2180
> 294132.884446735 463557.976146893 64
>
> The correct reprojection is possible only if the EPSG 2180 definition is
> given in proj4 format *plus* +towgs84=0,0,0:
>
> $ echo "16E 52N 64" | gdaltransform -s_srs EPSG:4179 -t_srs "+proj=tmerc
> +lat_0=0 +lon_0=19 +k=0.9993 +x_0=500000 +y_0=-5300000 +ellps=GRS80 +units=m
> +towgs84=0,0,0"
> 294006.094422874 463523.916413687 103.090447655879
>
> Please do something about it. Currently, GDAL dependent software that
> relies on GDAL's interpretation of EPSG codes will introduce
> reprojection errors of dozens of meters for all the 58 ETRS89 based
> CRSs, including e.g. pan-European LCC (EPSG 3034) or LAEA (EPSG 3035),
> when datum shift is involved. Lots of users are affected.

As European I am curious how to deal with this problem.
Should we bring it up on PROJ4?

Markus
From ivan.lucena at pmldnet.com  Wed Aug 13 07:56:34 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Wed Aug 13 07:56:33 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: Opacity for Google Maps Overlay,
	Embedded Google Earth, Tile generation
In-Reply-To: <48A13EFF.9010003@sarvision.nl>
References: <20080811012623.22494.qmail@s466.sureserver.com>
	<48A13EFF.9010003@sarvision.nl>
Message-ID: <48A2CBF2.6050603@pmldnet.com>

Hi Vincent,

I found someone having the same complain on WorldWind forum but the 
complainer call it "lost of resolution". :)

I also found the OpenGL code where you can change that behavior. There 
is a function called glTextParameteri() where the last parameter tells 
OpenGL which magnifier filter to use: GL_NEAREST or GL_LINEAR.

In my implementation I don't access that function directly but through a 
3D component that does that. But I expose that option to the user on a 
right-click popup-menu. "Power to the user!"

Anyway, Thanks for you suggestion. It seams to work.

Best regards,

Ivan

Vincent Schut wrote:
> Hi Ivan, Klokan,
> 
> Lucena, Ivan wrote:
>> Hi Klokan,
>>
>> Would you mind if I extend your message tread a little bit?
>> The GDAL2Tiles is a great tool and it just getting better, 
>> congratulation.
>> But I have some end-user complain that they don't like to see the 
>> pixel blended when you get very close to then. Those folks really want 
>> to see the big square blocks of their images classification on top of 
>> Google Earth images. That is not your fault of course. That is a nice 
>> feature on GE, a anti-aliasing rendering technique that probably 
>> attend the general public. I have spoken with Google about that but it 
>> didn't resonate. As far as I can remember (from OpenGL project that I 
>> worked in the past) this problem could be easily solved with just a 
>> parameter change on the texture-surface-rendering definition. I may be 
>> wrong.
>> My question is, do you know if there is any way to change that 
>> behavior on GE? Doesn't look like you can change that option through 
>> the API as a plugin, does it? Or maybe there is something you can do 
>> on the KML.
>> By the way, does any one have ever received that request from users?
>>
>> Best regards,
>>
>> Ivan
>>
> <big snip>
> 
> It does resonate here :)
> I have been publishing deforestation maps with GE (using a home-brewn
> gdal-python script), and had the same complaints. I don't want my
> classes to mix. An area is either forest, or non-forest, or deforested,
> and nothing in between. O how nice it is to force your own will upon
> reality :-)
> The way I 'solved' this was by adding subsampled tiles, which
> effectively prevent GE to start antialiasing to soon. So my highest
> resolution tiles are in fact higher resolution than the real full
> resolution. This of course is just a workaround and just works if the
> user does not zoom in too much, but in my experience it improved the
> users' feeling a lot.
> 
> I must say I am very interested in a better way to force GE to not
> antialias raster overlays.
> 
> Regards,
> Vincent Schut.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
From mateusz at loskot.net  Wed Aug 13 08:19:21 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug 13 08:19:27 2008
Subject: [gdal-dev] Question about compiling C++ gdal utility
In-Reply-To: <9c2015090808121024k7e8deec9ufffe330a631d2f19@mail.gmail.com>
References: <9c2015090808121024k7e8deec9ufffe330a631d2f19@mail.gmail.com>
Message-ID: <48A2D149.1000407@loskot.net>

Roger Andr? wrote:
> I'm trying to compile a gdal utility written in C++ (which is something
> completely new to me), and am encountering an error.

Roger,

This does not look like an official GDAL utility shipped with GDAL/OGR 
sources. Where did you get it?

It looks like Matt Perry's tool:

http://perrygeo.googlecode.com/svn/trunk/demtools/

If this is the tool you are talking about, then just get it directly 
from Matt's repository where all files are included.

Next time, please provide more details about where you got source code 
you are experiencing problems about.

Best regards
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From zane at ideotrope.org  Wed Aug 13 14:50:51 2008
From: zane at ideotrope.org (Zane Selvans)
Date: Wed Aug 13 15:07:55 2008
Subject: [gdal-dev] transforming coordinates for true polar wander
Message-ID: <5D15664D-B20B-4774-B470-4CDBBBEDBDB4@ideotrope.org>

Hi all,

I have a bunch of one dimensional features mapped in spherical  
(unprojected) coordinates (each is a series of lat/lon points) and I  
need to be able to translate and rotate them on the surface of the  
sphere (Jupiter's satellite, Europa).

I actually want to change their locations on the body in order to  
place them where they would have been before a true polar wander  
event, (during which the axis of rotation changed).  Is this something  
that can be done using OGRCoordinateTransformation::Transform(), or  
can it only be used to do transformations between projected (and  
unprojected) coordinate systems?  If it can be used for this, what's  
the simplest way to go about specifying the coordinate system?  All I  
have is the current lat/lon position of the paleopole.

Also, it would be sweet if this was doable from the Python interface...

Thanks for any insight!

Zane

--
Zane Selvans
Amateur Earthling
http://zaneselvans.org
zane@ideotrope.org
303/815-6866
PGP Key: 55E0815F

From tutey at o2.pl  Wed Aug 13 15:57:33 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Aug 13 15:56:01 2008
Subject: [gdal-dev] could GDAL enforce towgs84=0,0,0 for ETRS89-based CRSs?
In-Reply-To: <489E9556.7030503@o2.pl>
References: <4890E4D4.2040208@o2.pl> <489E9556.7030503@o2.pl>
Message-ID: <48A33CAD.7000705@o2.pl>

Another interesting thing: reprojecting rasters using an EPSG code of an
ETRS89 based CRS, results in a GeoTIFF header lacking the latlong
boundaries (the last 5 lines of gdalinfo output below):

$ gdalwarp -t_srs EPSG:3035 N51E016.hgt srtm_etrs89.tif

$ gdalinfo srtm_etrs89.tif

Driver: GTiff/GeoTIFF
Files: srtm_etrs89.tif
Size is 1023, 1516
Coordinate System is:
PROJCS["ETRS89 / ETRS-LAEA",
     GEOGCS["ETRS89",
         DATUM["European_Terrestrial_Reference_System_1989",
             SPHEROID["GRS 1980",6378137,298.2572221010002,
                 AUTHORITY["EPSG","7019"]],
             AUTHORITY["EPSG","6258"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4258"]],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AUTHORITY["EPSG","3035"]]
Origin = (4732497.919957611709833,3233119.219332384876907)
Pixel Size = (77.290356972219669,-77.290356972219669)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 4732497.920, 3233119.219)
Lower Left  ( 4732497.920, 3115947.038)
Upper Right ( 4811565.955, 3233119.219)
Lower Right ( 4811565.955, 3115947.038)
Center      ( 4772031.938, 3174533.129)
Band 1 Block=1023x4 Type=Int16, ColorInterp=Gray



Whereas the same raster reprojected to e.g. a Pulkovo 1942(58) based CRS
has these latlon coordinates in place:

$ gdalwarp -t_srs EPSG:2174 N51E016.hgt srtm_pulkovo.tif

$ gdalinfo srtm_pulkovo.tif

Driver: GTiff/GeoTIFF
Files: srtm_pulkovo.tif
Size is 909, 1444
Coordinate System is:
PROJCS["Pulkovo 1942(58) / Poland zone IV",
     GEOGCS["Pulkovo 1942(58)",
         DATUM["Pulkovo_1942_58",
             SPHEROID["Krassowsky 1940",6378245,298.2999999999985,
                 AUTHORITY["EPSG","7024"]],
             AUTHORITY["EPSG","6179"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4179"]],
     PROJECTION["Oblique_Stereographic"],
     PARAMETER["latitude_of_origin",51.67083333333333],
     PARAMETER["central_meridian",16.67222222222222],
     PARAMETER["scale_factor",0.9998],
     PARAMETER["false_easting",3703000],
     PARAMETER["false_northing",5627000],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],
     AUTHORITY["EPSG","2174"]]
Origin = (3655914.793169156182557,5663915.491245908662677)
Pixel Size = (77.265039270892487,-77.265039270892487)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 3655914.793, 5663915.491) ( 15d59'11.37"E, 52d 0'2.46"N)
Lower Left  ( 3655914.793, 5552344.775) ( 16d 0'5.03"E, 50d59'51.91"N)
Upper Right ( 3726148.714, 5663915.491) ( 17d 0'33.70"E, 52d 0'7.90"N)
Lower Right ( 3726148.714, 5552344.775) ( 17d 0'7.31"E, 50d59'57.19"N)
Center      ( 3691031.754, 5608130.133) ( 16d29'59.40"E, 51d30'3.86"N)
Band 1 Block=909x4 Type=Int16, ColorInterp=Gray

Why the difference?

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From warmerdam at pobox.com  Wed Aug 13 20:48:54 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 13 20:48:57 2008
Subject: [gdal-dev] could GDAL enforce towgs84=0, 0,
	0 for ETRS89-based CRSs?
In-Reply-To: <4890E4D4.2040208@o2.pl>
References: <4890E4D4.2040208@o2.pl>
Message-ID: <931f8ea90808131748x335f5affv6c38e9b3d165d269@mail.gmail.com>

Maciej,

Please file a ticket against the PROJ trac on this issue.  I'm hoping to
take advantage of datum and other definitions from CSMap at some point
which may help.  Otherwise, I'll try and include an override for ETRS89
which indicates that it can be treated as equivelent to WGS84 if
that is in fact a reasonable approach.

Best regards,
FrankW

On Wed, Jul 30, 2008 at 6:01 PM, Maciej Sieczka <tutey@o2.pl> wrote:
> Hi,
>
> Due to a change in PROJ 4.6.0, no datum shift is aplied when
> reprojecting between a CRS which has an implicit datum definition (e.g.
> Pulkovo 1942/58-based EPSG 4179, for which GDAL uses
> towgs84=33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84) and an ETRS89-based
> CRS, e.g. EPSG 2180, that has no implicit towgs84 or datum.
>
> The above results in reprojection errors of about 150 m and makes using
> EPSG codes for ETRS89-based CRS impossible. Could PROJ.4 and GDAL
> enforce towgs84=0,0,0 for all ETRS89 CRSs that have no implicit datum
> definition otherwise?
>
> For instance, GRASS always forces towgs84=0,0,0 for EPSG 2180 and does
> the reprojection right.
>
> Maciek
>
> --
> Maciej Sieczka
> www.sieczka.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From cryan at csse.com.au  Thu Aug 14 02:00:03 2008
From: cryan at csse.com.au (Fodder)
Date: Thu Aug 14 02:00:08 2008
Subject: [Gdal-dev] Tif file getting larger and larger
Message-ID: <18976082.post@talk.nabble.com>


Hi,

I have a program that is reading and writing to a GeoTif file using Open,
RasterIO and Close calls and Float32 data types.

However, I find that the file just gets larger and larger whenever I write
to the file even though I'm trying to overwrite the existing data. For
example, if open a Tif file with a large range of values and then write the
same value to every pixel and close the dataset, I don't see any reduction
in file size as I would expect to result from the compression. I've noticed
this with LZW and Packbits compression, tiled and striped.

I'm sure it's something simple I'm missing.

Cheers,



-- 
View this message in context: http://www.nabble.com/Tif-file-getting-larger-and-larger-tp18976082p18976082.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From tutey at o2.pl  Thu Aug 14 07:48:37 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Thu Aug 14 07:47:02 2008
Subject: [gdal-dev] could GDAL enforce towgs84=0,0,0 for ETRS89-based CRSs?
In-Reply-To: <931f8ea90808131748x335f5affv6c38e9b3d165d269@mail.gmail.com>
References: <4890E4D4.2040208@o2.pl>
	<931f8ea90808131748x335f5affv6c38e9b3d165d269@mail.gmail.com>
Message-ID: <48A41B95.5070907@o2.pl>

Frank Warmerdam pisze:

> Please file a ticket against the PROJ trac on this issue.  I'm hoping to
> take advantage of datum and other definitions from CSMap at some point
> which may help.  Otherwise, I'll try and include an override for ETRS89
> which indicates that it can be treated as equivelent to WGS84 if
> that is in fact a reasonable approach.

Done http://trac.osgeo.org/proj/ticket/11.

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From tutey at o2.pl  Thu Aug 14 07:52:04 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Thu Aug 14 07:50:29 2008
Subject: [Gdal-dev] Tif file getting larger and larger
In-Reply-To: <18976082.post@talk.nabble.com>
References: <18976082.post@talk.nabble.com>
Message-ID: <48A41C64.6090406@o2.pl>

Fodder pisze:

> I have a program that is reading and writing to a GeoTif file using Open,
> RasterIO and Close calls and Float32 data types.
> 
> However, I find that the file just gets larger and larger whenever I write
> to the file even though I'm trying to overwrite the existing data. For
> example, if open a Tif file with a large range of values and then write the
> same value to every pixel and close the dataset, I don't see any reduction
> in file size as I would expect to result from the compression. I've noticed
> this with LZW and Packbits compression, tiled and striped.

Related?: http://trac.osgeo.org/gdal/ticket/1688 (some more info in a 
duplicate http://trac.osgeo.org/gdal/ticket/1689).

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From cryan at csse.com.au  Thu Aug 14 08:05:59 2008
From: cryan at csse.com.au (Fodder)
Date: Thu Aug 14 08:06:01 2008
Subject: [Gdal-dev] Tif file getting larger and larger
In-Reply-To: <48A41C64.6090406@o2.pl>
References: <18976082.post@talk.nabble.com> <48A41C64.6090406@o2.pl>
Message-ID: <18980252.post@talk.nabble.com>




Ah, dear, so if I want to frequently change values in TIF file, I basically
can't use compression as the file will quickly get larger than the
uncompressed version. Is this a fair comment?

Also, I've noticed that after 5-8 re-writes of the whole dataset (RasterIO
the whole grid from a buffer), the dataset seems to get corrupted anyway.



Maciej Sieczka wrote:
> 
> 
> Related?: http://trac.osgeo.org/gdal/ticket/1688 (some more info in a 
> duplicate http://trac.osgeo.org/gdal/ticket/1689).
> 
> Maciek
> 
> -- 
> Maciej Sieczka
> www.sieczka.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://www.nabble.com/Tif-file-getting-larger-and-larger-tp18976082p18980252.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schut at sarvision.nl  Thu Aug 14 08:20:38 2008
From: schut at sarvision.nl (Vincent Schut)
Date: Thu Aug 14 08:20:42 2008
Subject: [Gdal-dev] Tif file getting larger and larger
In-Reply-To: <18980252.post@talk.nabble.com>
References: <18976082.post@talk.nabble.com> <48A41C64.6090406@o2.pl>
	<18980252.post@talk.nabble.com>
Message-ID: <48A42316.4030202@sarvision.nl>

Fodder wrote:
> 
> 
> Ah, dear, so if I want to frequently change values in TIF file, I basically
> can't use compression as the file will quickly get larger than the
> uncompressed version. Is this a fair comment?

Right. the combination of tiled compression (where a line counts as a 
tile too) and tiff's internal file layout simply does not allow for easy 
rewriting of data, because a tile's compressed size will change, and 
possibly not fit anymore in the space that is reserved for that tile in 
the tiff file. One could rewrite the tiff driver/library to then change 
the layout of the tiff file instead of simply adding new reserved space 
for that tile, but that would usually mean that a large part of the tiff 
file will be changed, which would be a big performance hit (and a big 
rewrite).
A workaround could be to regularly rewrite the file using 
gdal_translate, which will re-layout all tiles and discard the unused 
'old' space. (a simple 'gdal_translate -co <compression options> 
file.tiff file_new.tiff' should do the trick).

That being said, my opinion on compressing: disk space is cheap 
nowadays, and though cpu cycles are too, imho compression often is not 
worth the effort, especially on files that you often need to read or 
write to. Compression can be a large performance hit. Especially on 
files you  need random write access on, don't compress. Of course there 
are exceptions to this, and you very well could be one... But generally, 
I think this holds.

In case someone is interested, personally I use these optimization rules:
- random write access: don't compress, strip or tile and pixel or band 
interleave according to read/write algorithm;
- mainly intended for reading/viewing: don't compress, square tiles 
(256x256), add pyramids;
- intended for clients that use commercial GIS/RS software: pixel 
interleave, strip oriented, no compression, no strange data types
- space is really really really an issue and I am sure I don't need any 
random write access to it and I am the only one that wants to read/view 
it: band interleaved, usually tiled, deflate compression. Sometimes add 
(compressed) pyramids.

Cheers,
Vincent.
> 
> Also, I've noticed that after 5-8 re-writes of the whole dataset (RasterIO
> the whole grid from a buffer), the dataset seems to get corrupted anyway.
> 
> 
> 
> Maciej Sieczka wrote:
>>
>> Related?: http://trac.osgeo.org/gdal/ticket/1688 (some more info in a 
>> duplicate http://trac.osgeo.org/gdal/ticket/1689).
>>
>> Maciek
>>
>> -- 
>> Maciej Sieczka
>> www.sieczka.org
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
> 

From cjanssen at iavo-rs.com  Thu Aug 14 09:09:58 2008
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Thu Aug 14 09:10:03 2008
Subject: [gdal-dev] ComputeStatistics/GetHistogram errors
Message-ID: <8E606D04-758E-4791-87C1-1521FD4D8A7E@iavo-rs.com>

I wonder if anyone else is experiencing problems with the ComputeStatistics/GetHistogram functions. I'm running the latest build off the cvs trunk with the ERMapper ECW SDK linked in. Whenever I try to call the GetHistogram function (256 bins, 0-255 range) after running a ComputeStatistics on a JPEG2000 file I get an invalid access exception. If I run GetHistogram with identical inputs without calling ComputeStatistics at any time previous, the function runs and finishes with no problems. I tried tracking the error down but stopped at ReadLineBIL function in the ERMapper SDK. My guess is some state variable, most likely in the ERMapper SDK, is getting messed up during the ComputeStatistics function call (I'm not sure if any other functions would cause the same result, this is the only thing I've tried so far). If anyone can help it would be greatly appreciated.

Christiaan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080814/4f06ea7b/attachment-0001.html
From warmerdam at pobox.com  Thu Aug 14 09:33:27 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 14 09:33:30 2008
Subject: [gdal-dev] ComputeStatistics/GetHistogram errors
In-Reply-To: <8E606D04-758E-4791-87C1-1521FD4D8A7E@iavo-rs.com>
References: <8E606D04-758E-4791-87C1-1521FD4D8A7E@iavo-rs.com>
Message-ID: <931f8ea90808140633r68fe833em5099b6542b64c50a@mail.gmail.com>

Christian,

I have had intermittent problems with heavy random access to
ECW datasets, presumably due to problems in some versions
of the ECW SDK.

I don't have any useful suggestions.

Best regards,


On Thu, Aug 14, 2008 at 9:09 AM, Christiaan Janssen
<cjanssen@iavo-rs.com> wrote:
> I wonder if anyone else is experiencing problems with the
> ComputeStatistics/GetHistogram functions. I'm running the latest build off
> the cvs trunk with the ERMapper ECW SDK linked in. Whenever I try to call
> the GetHistogram function (256 bins, 0-255 range) after running a
> ComputeStatistics on a JPEG2000 file I get an invalid access exception. If I
> run GetHistogram with identical inputs without calling ComputeStatistics at
> any time previous, the function runs and finishes with no problems. I tried
> tracking the error down but stopped at ReadLineBIL function in the ERMapper
> SDK. My guess is some state variable, most likely in the ERMapper SDK, is
> getting messed up during the ComputeStatistics function call (I'm not sure
> if any other functions would cause the same result, this is the only thing
> I've tried so far). If anyone can help it would be greatly appreciated.
>
> Christiaan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From tutey at o2.pl  Thu Aug 14 09:45:09 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Thu Aug 14 09:44:12 2008
Subject: [Gdal-dev] Tif file getting larger and larger
In-Reply-To: <48A42316.4030202@sarvision.nl>
References: <18976082.post@talk.nabble.com>
	<48A41C64.6090406@o2.pl>	<18980252.post@talk.nabble.com>
	<48A42316.4030202@sarvision.nl>
Message-ID: <48A436E5.3050702@o2.pl>

Vincent Schut pisze:
> Compression can be a large performance hit. Especially on 
> files you  need random write access on, don't compress. Of course there 
> are exceptions to this, and you very well could be one... But generally, 
> I think this holds.

One common exception is mobile GIS. If the PDA does not support SDHC you
are stick to 4 GB card + your internal ROM at max. It's easy to run out
of space.

SDHC would let you have 32GB (but now only 16GB is widely available at a
resonable price). Yet you have to be lucky that your PDA supports SDHC,
cause it's a fairly new thing and you don't change PDAs that frequently.

Just 0,01 PLN worth rambling.

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From ivan.lucena at pmldnet.com  Thu Aug 14 11:02:58 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Thu Aug 14 11:03:02 2008
Subject: [gdal-dev] orginfo and prj files
Message-ID: <48A44922.7060502@pmldnet.com>

Hi there,

Correct if I am wrong.

If there is a .PRJ file associated with a .SHP, ogrinfo will just print 
out the content of the .PRJ. Ex.:


"""
D:\Data\ESRIDATA\USA> ogrinfo -so states.shp states
INFO: Open of `states.shp'
       using driver `ESRI Shapefile' successful.
Layer name: states
Geometry: Polygon
Feature Count: 51
Extent: (-178.217598, 18.924782) - (-66.969271, 71.406235)
Layer SRS WKT:
GEOGCS["GCS_North_American_1983",
     DATUM["North_American_Datum_1983",
         SPHEROID["GRS_1980",6378137,298.257222101]],
     PRIMEM["Greenwich",0],
     UNIT["Degree",0.0174532925199433]]
"""

It will not going to run "OGRImportFromESRI()" to get EPSG Authority 
codes. Isn't it right?

Thanks in advance for any help.

Ivan

From mateusz at loskot.net  Thu Aug 14 11:09:58 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 14 11:10:05 2008
Subject: [gdal-dev] orginfo and prj files
In-Reply-To: <48A44922.7060502@pmldnet.com>
References: <48A44922.7060502@pmldnet.com>
Message-ID: <48A44AC6.1070204@loskot.net>

Lucena, Ivan wrote:
> Hi there,
> 
> Correct if I am wrong.
> 
> If there is a .PRJ file associated with a .SHP, ogrinfo will just print 
> out the content of the .PRJ. Ex.:

Ivan,

It does
1) import it expecting it might be in ESRI WKT format
2) print it

> """
> D:\Data\ESRIDATA\USA> ogrinfo -so states.shp states
> INFO: Open of `states.shp'
>       using driver `ESRI Shapefile' successful.
> Layer name: states
> Geometry: Polygon
> Feature Count: 51
> Extent: (-178.217598, 18.924782) - (-66.969271, 71.406235)
> Layer SRS WKT:
> GEOGCS["GCS_North_American_1983",
>     DATUM["North_American_Datum_1983",
>         SPHEROID["GRS_1980",6378137,298.257222101]],
>     PRIMEM["Greenwich",0],
>     UNIT["Degree",0.0174532925199433]]
> """
> 
> It will not going to run "OGRImportFromESRI()" to get EPSG Authority 
> codes. Isn't it right?

For Shapefile format specifically, it does run through morphing 
procedure by calling OGRSpatialReference::importFromESRI

The doc may be imprecise perhaps, but IMO it suggests that:

"If a .prj files in old Arc/Info style or new ESRI OGC WKT style is 
present, it will be read and used to associate a projection with features."

http://gdal.org/ogr/drv_shapefile.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From a.neumann at carto.net  Thu Aug 14 10:54:24 2008
From: a.neumann at carto.net (Andreas Neumann)
Date: Thu Aug 14 11:25:25 2008
Subject: [gdal-dev] Trying to get BIGTIFF to work
Message-ID: <24186.193.246.86.39.1218725664.squirrel@webmail.customers.iirc.at>

Hi gdal developers,

I am trying to get BIGTIFF to work.

When I use the configure script it tells me:

  LIBTIFF support:           external (BigTIFF=yes)
  LIBGEOTIFF support:        internal

It compiles and install fine.

I have to mention that I have both the older stable version installed
(libtiff 3.8.2-7ubuntu3 installed in /usr) and the newer version (libtiff 
tiff-4.0.0beta2 installed in /usr/local) - I told the configure script to
use the newer version (./configure --with-perl --with-python --with-xerces
--with-sqlite --with-pg=/usr/local/pgsql/bin/pg_config --with-geotiff
--with-libtiff=/usr/local)

When I do a big file extract with gdal_translate, I get the following
error message:

gdal_translate -of GTIFF -a_srs EPSG:21781 -projwin 689000 252000 702000
242000 -co "BIGTIFF=YES" orthofoto_2006.img
orthofoto_2006_2008_08_13-16_32.tiff
Input file size is 56000, 44000
Computed -srcwin 0 0 52000 40000 from projected window.
Warning 6: Driver GTiff does not support BIGTIFF creation option
0ERROR 6: A 52000 pixels x 40000 lines x 3 bands Byte image would be
larger than 4GB
but this is the largest size a TIFF can be.  Creation failed.

So I wonder what went wrong with my compilation or library installation
that gdal can't use the BIGTIFF option, although the configure script
would tell me BIGTIFF=YES

I am on Ubuntu Server Hardy 64bit version.

Thank you for any hints on how to get bigtiff working on my systems,
Andreas

-- 
Andreas Neumann
B?schacherstrasse 6, CH-8624 Gr?t/Gossau, Switzerland
Email: a.neumann@carto.net, Web:
* http://www.carto.net/ (Carto and SVG resources)
* http://www.carto.net/neumann/ (personal page)
* http://www.svgopen.org/ (SVG Open Conference)
* http://www.geofoto.ch/ (Georeferenced Photos of Switzerland)

From tutey at o2.pl  Thu Aug 14 11:49:07 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Thu Aug 14 11:47:31 2008
Subject: [gdal-dev] Trying to get BIGTIFF to work
In-Reply-To: <24186.193.246.86.39.1218725664.squirrel@webmail.customers.iirc.at>
References: <24186.193.246.86.39.1218725664.squirrel@webmail.customers.iirc.at>
Message-ID: <48A453F3.3010604@o2.pl>

Andreas Neumann pisze:

> gdal_translate -of GTIFF -a_srs EPSG:21781 -projwin 689000 252000 702000
> 242000 -co "BIGTIFF=YES" orthofoto_2006.img
> orthofoto_2006_2008_08_13-16_32.tiff
> Input file size is 56000, 44000
> Computed -srcwin 0 0 52000 40000 from projected window.
> Warning 6: Driver GTiff does not support BIGTIFF creation option
> 0ERROR 6: A 52000 pixels x 40000 lines x 3 bands Byte image would be
> larger than 4GB
> but this is the largest size a TIFF can be.  Creation failed.
> 
> So I wonder what went wrong with my compilation or library installation
> that gdal can't use the BIGTIFF option, although the configure script
> would tell me BIGTIFF=YES

I had the same problem once. Adding "-co BIGTIFF=YES" on your command
line should help.

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From a.neumann at carto.net  Thu Aug 14 11:52:09 2008
From: a.neumann at carto.net (Andreas Neumann)
Date: Thu Aug 14 11:52:14 2008
Subject: [gdal-dev] Trying to get BIGTIFF to work
In-Reply-To: <931f8ea90808140835n5133c61co6312e24384dbf35f@mail.gmail.com>
References: <24186.193.246.86.39.1218725664.squirrel@webmail.customers.iirc.at>
	<931f8ea90808140835n5133c61co6312e24384dbf35f@mail.gmail.com>
Message-ID: <58158.193.246.86.39.1218729129.squirrel@webmail.customers.iirc.at>

It seems to work now.

I needed to compile gdal not only against the new external libtiff but
also against external libgeotiff, which I did not do in the first try.
Before I did use gdals internal support for geotiff which seems not to
support BIGTIFF? Is my assumption correct that an external libgeotiff is
required for BIGTIFF?

Anyway - it now seems to work. I need to check if the output also displays
correctly.

Thanks,
Andreas

> Andreas,
>
> BigTIFF support is built in if the TIFF_OPTS variable in gdal/GDALmake.opt
> is set to -DBIGTIFF_SUPPORT.  You might want to verify that.  Also, if you
> altered your configuration to include the bigtiff version of libtiff
> you need to
> do a complete build (ie. make clean ; make).
>
> I *suspect* you either didn't completely rebuild GDAL with the new
> configuration or you didn't install it or you aren't actually running the
> version you built and installed yourself.
>
> Good luck,
>
> On Thu, Aug 14, 2008 at 10:54 AM, Andreas Neumann <a.neumann@carto.net>
> wrote:
>> Hi gdal developers,
>>
>> I am trying to get BIGTIFF to work.
>>
>> When I use the configure script it tells me:
>>
>>  LIBTIFF support:           external (BigTIFF=yes)
>>  LIBGEOTIFF support:        internal
>>
>> It compiles and install fine.
>>
>> I have to mention that I have both the older stable version installed
>> (libtiff 3.8.2-7ubuntu3 installed in /usr) and the newer version
>> (libtiff
>> tiff-4.0.0beta2 installed in /usr/local) - I told the configure script
>> to
>> use the newer version (./configure --with-perl --with-python
>> --with-xerces
>> --with-sqlite --with-pg=/usr/local/pgsql/bin/pg_config --with-geotiff
>> --with-libtiff=/usr/local)
>>
>> When I do a big file extract with gdal_translate, I get the following
>> error message:
>>
>> gdal_translate -of GTIFF -a_srs EPSG:21781 -projwin 689000 252000 702000
>> 242000 -co "BIGTIFF=YES" orthofoto_2006.img
>> orthofoto_2006_2008_08_13-16_32.tiff
>> Input file size is 56000, 44000
>> Computed -srcwin 0 0 52000 40000 from projected window.
>> Warning 6: Driver GTiff does not support BIGTIFF creation option
>> 0ERROR 6: A 52000 pixels x 40000 lines x 3 bands Byte image would be
>> larger than 4GB
>> but this is the largest size a TIFF can be.  Creation failed.
>>
>> So I wonder what went wrong with my compilation or library installation
>> that gdal can't use the BIGTIFF option, although the configure script
>> would tell me BIGTIFF=YES
>>
>> I am on Ubuntu Server Hardy 64bit version.
>>
>> Thank you for any hints on how to get bigtiff working on my systems,
>> Andreas
>>
>> --
>> Andreas Neumann
>> B?schacherstrasse 6, CH-8624 Gr?t/Gossau, Switzerland
>> Email: a.neumann@carto.net, Web:
>> * http://www.carto.net/ (Carto and SVG resources)
>> * http://www.carto.net/neumann/ (personal page)
>> * http://www.svgopen.org/ (SVG Open Conference)
>> * http://www.geofoto.ch/ (Georeferenced Photos of Switzerland)
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush | Geospatial Programmer for Rent
>


-- 
Andreas Neumann
B?schacherstrasse 6, CH-8624 Gr?t/Gossau, Switzerland
Email: a.neumann@carto.net, Web:
* http://www.carto.net/ (Carto and SVG resources)
* http://www.carto.net/neumann/ (personal page)
* http://www.svgopen.org/ (SVG Open Conference)
* http://www.geofoto.ch/ (Georeferenced Photos of Switzerland)

From ivan.lucena at pmldnet.com  Thu Aug 14 12:12:09 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Thu Aug 14 12:12:15 2008
Subject: [gdal-dev] orginfo and prj files
In-Reply-To: <48A44AC6.1070204@loskot.net>
References: <48A44922.7060502@pmldnet.com> <48A44AC6.1070204@loskot.net>
Message-ID: <48A45959.8010400@pmldnet.com>

Mateusz,

Mateusz Loskot wrote:
 > For Shapefile format specifically, it does run through morphing
 > procedure by calling OGRSpatialReference::importFromESRI

In that case I would expect something like coming from ogrinfo:

     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.257222101,
                 AUTHORITY["EPSG","7019"]],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0,
             AUTHORITY["EPSG","8901"]],
         UNIT["degree",0.01745329251994328,
             AUTHORITY["EPSG","9122"]],
         AUTHORITY["EPSG","4269"]],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]],

But instead I am getting just the content of the PRJ file:

> Lucena, Ivan wrote:
>> D:\Data\ESRIDATA\USA> ogrinfo -so states.shp states
>> INFO: Open of `states.shp'
>>       using driver `ESRI Shapefile' successful.
>> Layer name: states
>> Geometry: Polygon
>> Feature Count: 51
>> Extent: (-178.217598, 18.924782) - (-66.969271, 71.406235)
>> Layer SRS WKT:
>> GEOGCS["GCS_North_American_1983",
>>     DATUM["North_American_Datum_1983",
>>         SPHEROID["GRS_1980",6378137,298.257222101]],
>>     PRIMEM["Greenwich",0],
>>     UNIT["Degree",0.0174532925199433]]

BTW, I checked my %GDAL_DATA% and it is correct and working fine on the 
same "Command Prompt" section with gdalinfo.

Would that be a bug or a misunderstanding of my part?

Thanks,

Ivan



From vishal.mehta at sei-us.org  Thu Aug 14 12:42:06 2008
From: vishal.mehta at sei-us.org (Vishal Mehta)
Date: Thu Aug 14 12:43:09 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf
	data
Message-ID: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>


Hello all,

I've been having problems getting gdal to work with netcdf files.

Using Ubuntu 8.04 LTS (Hardy)
1. problems with libgdal 1.4.4
First i tried the default gdal versions and libraries installed through Synaptic Package Manager. The packaged version was gdal 1.4.4
 All programs that called gdal - Grass (using r.in.gdal), FWTools and gdalinfo, gdal_translate etc -
gave me a 'segmentation fault'

I then looked up online and this bug report seemed to say it was a fault with how gdal is packaged by Ubuntu - https://bugs.launchpad.net/ubuntu/+source/libgdal-grass/+bug/126916

and the recommendation was to compile from source. So then on to part 2

2. I compiled from source gdal1.5.2 from
http://trac.osgeo.org/gdal/wiki/DownloadSource

using the following configure

./configure --with-netcdf=/usr/lib --with-libtiff=yes --with-geotiff=yes --with-jpeg=/usr/lib --with-gif=/usr/lib --with-png=/ur/lib --with-pg=/usr/bin/pg_config --with-libgrass=yes

make

sudo make install

and made sure the libgdal link was referring to the new one.

I tried
gdalinfo file.nc

and again got 'segmentation fault'

it works for other data types; only netcdf does not work (just like before with gdal1.4.4)

How can i fix this problem? I am not a linux expert by the way...perhaps that was obvious:)

The .nc file is very large - It iss climate projection data from the California Climate Change Center. All i want to do is automate the extraction of climate data for a set of points - am trying to do the following:

- import .nc data into Grass rasters or GeoTiff with bands = images on the netcdf file
- run a small script to extract climate data for vector point data from each Grass raster/GTiff

Please help,
Vishal

FYI:
vishal@vishal-laptop:~/downloads/gdal-1.5.2$ gdalinfo --version
GDAL 1.5.2, released 2008/05/29



Vishal K. Mehta, Ph.D.
Scientist
Stockholm Environment Institute - US
133 D St Suite F
Davis, CA 95616
www.sei-us.org

From mateusz at loskot.net  Thu Aug 14 13:40:47 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 14 13:40:55 2008
Subject: [gdal-dev] orginfo and prj files
In-Reply-To: <48A45959.8010400@pmldnet.com>
References: <48A44922.7060502@pmldnet.com> <48A44AC6.1070204@loskot.net>
	<48A45959.8010400@pmldnet.com>
Message-ID: <48A46E1F.806@loskot.net>

Lucena, Ivan wrote:
> Mateusz,
> 
> Mateusz Loskot wrote:
>  > For Shapefile format specifically, it does run through morphing
>  > procedure by calling OGRSpatialReference::importFromESRI
> 
> In that case I would expect something like coming from ogrinfo:
> 
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.257222101,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0,
>             AUTHORITY["EPSG","8901"]],
>         UNIT["degree",0.01745329251994328,
>             AUTHORITY["EPSG","9122"]],
>         AUTHORITY["EPSG","4269"]],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
> 
> But instead I am getting just the content of the PRJ file:

Ivan,

I've stepped through the OGR code while opening states.shp data from 
ESRI and I confirm that the execution goes through morphFromESRI 
function. However, I'm not sure why ESRI version is printed, I suppose 
your ESRI WKT is passed through morphing but it isn't recognized well.
May be Frank will have more comments.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Thu Aug 14 14:12:24 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 14 14:12:26 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on
	netcdf data
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>
Message-ID: <931f8ea90808141112y63994407g87d6117719bfb6a7@mail.gmail.com>

On Thu, Aug 14, 2008 at 12:42 PM, Vishal Mehta <vishal.mehta@sei-us.org> wrote:

> 2. I compiled from source gdal1.5.2 from
> http://trac.osgeo.org/gdal/wiki/DownloadSource
>
> using the following configure
>
> ./configure --with-netcdf=/usr/lib --with-libtiff=yes --with-geotiff=yes --with-jpeg=/usr/lib --with-gif=/usr/lib --with-png=/ur/lib --with-pg=/usr/bin/pg_config --with-libgrass=yes
>
> make
>
> sudo make install
>
> and made sure the libgdal link was referring to the new one.
>
> I tried
> gdalinfo file.nc
>
> and again got 'segmentation fault'
>
> it works for other data types; only netcdf does not work (just like before with gdal1.4.4)

Vishal,

Have you tried with other netcdf files?  How big is "big"?   Perhaps
you are encounter a 2GB file size limit?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From warmerdam at pobox.com  Thu Aug 14 14:28:02 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 14 14:28:04 2008
Subject: [gdal-dev] orginfo and prj files
In-Reply-To: <48A46E1F.806@loskot.net>
References: <48A44922.7060502@pmldnet.com> <48A44AC6.1070204@loskot.net>
	<48A45959.8010400@pmldnet.com> <48A46E1F.806@loskot.net>
Message-ID: <931f8ea90808141128y7fbe3ee9x9b984339d30cb2de@mail.gmail.com>

On Thu, Aug 14, 2008 at 1:40 PM, Mateusz Loskot <mateusz@loskot.net> wrote:
> Lucena, Ivan wrote:

>> In that case I would expect something like coming from ogrinfo:
>>
>>    GEOGCS["NAD83",
>>        DATUM["North_American_Datum_1983",
>>            SPHEROID["GRS 1980",6378137,298.257222101,
>>                AUTHORITY["EPSG","7019"]],
>>            AUTHORITY["EPSG","6269"]],

Ivan,

The shapefile driver does run morphFromESRI() and we can confirm
that takes place because the D_ has been stripped from the datum
name.  However, morphFromESRI() will *not* add in authority nodes
or otherwise fill in missing information.  It just changes a few known
patterns from ESRI names to OGR names (projection names, parameters
datums).

Your earlier question related to whether it was possible to establish
what EPSG coordinate system an ESRI .prj file is.  There is no practical
way to do this with OGRSpatialReference.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From dylan.beaudette at gmail.com  Thu Aug 14 14:13:55 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Thu Aug 14 14:51:09 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on
	netcdf data
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>
Message-ID: <200808141113.55679.dylan.beaudette@gmail.com>

On Thursday 14 August 2008, Vishal Mehta wrote:
> Hello all,
>
> I've been having problems getting gdal to work with netcdf files.
>
> Using Ubuntu 8.04 LTS (Hardy)
> 1. problems with libgdal 1.4.4
> First i tried the default gdal versions and libraries installed through
> Synaptic Package Manager. The packaged version was gdal 1.4.4 All programs
> that called gdal - Grass (using r.in.gdal), FWTools and gdalinfo,
> gdal_translate etc - gave me a 'segmentation fault'
>
> I then looked up online and this bug report seemed to say it was a fault
> with how gdal is packaged by Ubuntu -
> https://bugs.launchpad.net/ubuntu/+source/libgdal-grass/+bug/126916
>
> and the recommendation was to compile from source. So then on to part 2
>
> 2. I compiled from source gdal1.5.2 from
> http://trac.osgeo.org/gdal/wiki/DownloadSource
>
> using the following configure
>
> ./configure --with-netcdf=/usr/lib --with-libtiff=yes --with-geotiff=yes
> --with-jpeg=/usr/lib --with-gif=/usr/lib --with-png=/ur/lib
> --with-pg=/usr/bin/pg_config --with-libgrass=yes
>
> make
>
> sudo make install
>
> and made sure the libgdal link was referring to the new one.
>
> I tried
> gdalinfo file.nc
>
> and again got 'segmentation fault'
>
> it works for other data types; only netcdf does not work (just like before
> with gdal1.4.4)
>
> How can i fix this problem? I am not a linux expert by the way...perhaps
> that was obvious:)
>
> The .nc file is very large - It iss climate projection data from the
> California Climate Change Center. All i want to do is automate the
> extraction of climate data for a set of points - am trying to do the
> following:
>
> - import .nc data into Grass rasters or GeoTiff with bands = images on the
> netcdf file - run a small script to extract climate data for vector point
> data from each Grass raster/GTiff
>
> Please help,
> Vishal
>
> FYI:
> vishal@vishal-laptop:~/downloads/gdal-1.5.2$ gdalinfo --version
> GDAL 1.5.2, released 2008/05/29
>
>
>

Hi Vishal,

Are you positive that you are invoking the latest gdal tools and libraries? I 
would remove any that you have installed via package manager (aptitude, 
etc.), and then run"

gdal-config --version

after removing the packaged version, it might also be a good idea to run 
ldconfig (as root).


Cheers,

Dylan


-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From jeremiahosullivan at gmail.com  Thu Aug 14 16:37:11 2008
From: jeremiahosullivan at gmail.com (Jerry O'Sullivan)
Date: Thu Aug 14 16:37:13 2008
Subject: [gdal-dev] OGR Translate File
Message-ID: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>

Hi,

I am looking to use the OGR dlls to transform some vector data between GIS
formats.

What classes do I need to use for this

Thanks,
Jerry
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080814/bb61fa2c/attachment.html
From mateusz at loskot.net  Thu Aug 14 17:10:37 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 14 17:10:43 2008
Subject: [gdal-dev] OGR Translate File
In-Reply-To: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>
References: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>
Message-ID: <48A49F4D.3060501@loskot.net>

Jerry O'Sullivan wrote:
> Hi,
> 
> I am looking to use the OGR dlls to transform some vector data between GIS
> formats.
> 
> What classes do I need to use for this

Jerry,

Check this: http://gdal.org/ogr/ogr_apitut.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From ivan.lucena at pmldnet.com  Thu Aug 14 17:14:06 2008
From: ivan.lucena at pmldnet.com (=?utf-8?Q?Lucena,=20Ivan?=)
Date: Thu Aug 14 17:14:07 2008
Subject: =?utf-8?B?UmU6IFtnZGFsLWRldl0gb3JnaW5mbyBhbmQgcHJqIGZpbGVz?=
Message-ID: <20080814211406.18128.qmail@s466.sureserver.com>

Frank,

>  The shapefile driver does run morphFromESRI() and we can confirm
>  that takes place because the D_ has been stripped from the datum
>  name.  However, morphFromESRI() will *not* add in authority nodes
>  or otherwise fill in missing information.  It just changes a few known
>  patterns from ESRI names to OGR names (projection names, parameters
>  datums).

I got it.

>  Your earlier question related to whether it was possible to establish
>  what EPSG coordinate system an ESRI .prj file is.  There is no practical
>  way to do this with OGRSpatialReference.

So, one would need to write a C/C++ code to go through the csv tables (using the CPL_CSV.h type and functions) trying to match the names/values in order to recover the codes, keeping track of the relationships between Datum, Reference system and Projection system. Not a easy task and also process time consuming, I believe.

But one end-user practical solution would be to use org2org to export to another format which the driver does explicitly shows the EPSG code. Would that be possible? Does other OGR driver shows authority code?

Thanks,

Ivan
From nbarker at ittvis.com  Thu Aug 14 16:51:17 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Thu Aug 14 17:21:29 2008
Subject: [gdal-dev] progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>	<20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>

Hi,

I am interested in discussing (and perhaps we can brainstorm on IRC, or
on the GDAL wiki) how to add generic progressive format support to GDAL.

In particular if we could create a generic interface so that commercial
and open source streaming client engines could be hooked in.

I have a lot of experience in writing jpip clients, and am interested in
creating this interface.  

I would suggest we need a callback handler, but we need to incorporate
the parameters req'd by ecwp, progressive jpeg and jpeg2000.

Hopefully others are interested too and perhaps have already thought of
the interfaces that we can add to GDAL?

I am trying to avoid the original way of doing jpip with gdal (before it
was disabled :-) ) of a one-shot jpip request, to a more dynamic raster
support.

Just to add to the scope this interface would ideally be exposed via
swig to allow java and jpip clients.

Any thoughts appreciated, and if you can advise of an appropriate place
to capture this (wiki?).

Many thanks,

Norman Barker
From mateusz at loskot.net  Thu Aug 14 17:53:54 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 14 17:53:59 2008
Subject: [gdal-dev] OGR Translate File
In-Reply-To: <67fe0b0808141424r4223c7f3y66cd1c4975d985bd@mail.gmail.com>
References: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>	
	<48A49F4D.3060501@loskot.net>
	<67fe0b0808141424r4223c7f3y66cd1c4975d985bd@mail.gmail.com>
Message-ID: <48A4A972.1060406@loskot.net>

Jerry O'Sullivan wrote:
> Mateusz,
> 
> Thanks for that...I am looking at doing the same work as ogr2ogr so the code
> here -http://dl.maptools.org/dl/php_ogr/ should help me in the right
> direction

If you are going to use php_ogr, I recommend to
read the thread "gdal-dev] Future of PHP bindings"

http://lists.osgeo.org/pipermail/gdal-dev/2007-December/thread.html#15333

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From gregor at hostgis.com  Thu Aug 14 17:59:08 2008
From: gregor at hostgis.com (Gregor Mosheh)
Date: Thu Aug 14 17:59:14 2008
Subject: [gdal-dev] OGR Translate File
In-Reply-To: <48A4A972.1060406@loskot.net>
References: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>		<48A49F4D.3060501@loskot.net>	<67fe0b0808141424r4223c7f3y66cd1c4975d985bd@mail.gmail.com>
	<48A4A972.1060406@loskot.net>
Message-ID: <48A4AAAC.7000100@hostgis.com>

Mateusz Loskot wrote:
> If you are going to use php_ogr, I recommend to
> read the thread "gdal-dev] Future of PHP bindings"

In that discussion, they mention the same download as I commonly use, 
and enjoy. http://dl.maptools.org/dl/php_ogr/  Works great.

Are you saying that THAT php_ogr will also be orphaned, and/or that GDAL 
will change to be incompatible with it?

-- 
Gregor Mosheh / Greg Allensworth, BS, A+
System Administrator
HostGIS cartographic development & hosting services
http://www.HostGIS.com/

"Remember that no one cares if you can back up,
  only if you can restore." - AMANDA
From warmerdam at pobox.com  Thu Aug 14 18:25:33 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 14 18:25:36 2008
Subject: [gdal-dev] orginfo and prj files
In-Reply-To: <20080814211406.18128.qmail@s466.sureserver.com>
References: <20080814211406.18128.qmail@s466.sureserver.com>
Message-ID: <931f8ea90808141525u33275bc7q51ec7c19ef41d09d@mail.gmail.com>

On Thu, Aug 14, 2008 at 5:14 PM, Lucena, Ivan <ivan.lucena@pmldnet.com> wrote:
>>  Your earlier question related to whether it was possible to establish
>>  what EPSG coordinate system an ESRI .prj file is.  There is no practical
>>  way to do this with OGRSpatialReference.
>
> So, one would need to write a C/C++ code to go through the csv tables (using the CPL_CSV.h type and functions) trying to match the names/values in order to recover the codes, keeping track of the relationships between Datum, Reference system and Projection system. Not a easy task and also process time consuming, I believe.

Ivan,

This approach can work to some degree, but it is not clear that the
names for datums from an ESRI WKT will match the name we fetch
from the EPSG tables (for instance).

> But one end-user practical solution would be to use org2org to export to another format which the driver does explicitly shows the EPSG code. Would that be possible? Does other OGR driver shows authority code?

Generally this won't work well because GDAL/OGR can't easily figure out the
EPSG codes to write to formats like GeoTIFF that would normally include
the EPSG codes.

I will note there is an AutoIdentifyEPSG() method on the OGRSpatialReference
which makes a preliminary effort to add EPSG authority codes to definitions.  I
believe now it just recognises a few well known coordinate systems like NAD27,
WGS84, etc.  So not very useful.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From vishal.mehta at sei-us.org  Thu Aug 14 18:35:05 2008
From: vishal.mehta at sei-us.org (Vishal Mehta)
Date: Thu Aug 14 18:38:55 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on
	netcdf data
In-Reply-To: <931f8ea90808141112y63994407g87d6117719bfb6a7@mail.gmail.com>
References: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>,
	<931f8ea90808141112y63994407g87d6117719bfb6a7@mail.gmail.com>
Message-ID: <3C465A6646C7AD48B03EBF86127AA6541FF145F8@winxbeus09.exchange.xchg>

Hi Frank,

I have tried with 2 netcdf files from different sites - same error 'segmentation fault'

the first was 60mb, the second was small !260kb.

does anyone in the list have this problem with gdal and netcdf data? earlier posts seemed to suggest a conflict between netcdf and hdf4, but i did not compile with hdf support so that shouldnt be a problem i thought..

thanks,
vishal


__________________
From: fwarmerdam@gmail.com [fwarmerdam@gmail.com] On Behalf Of Frank Warmerdam [warmerdam@pobox.com]
Sent: Thursday, August 14, 2008 11:12 AM
To: Vishal Mehta
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf data

On Thu, Aug 14, 2008 at 12:42 PM, Vishal Mehta <vishal.mehta@sei-us.org> wrote:

> 2. I compiled from source gdal1.5.2 from
> http://trac.osgeo.org/gdal/wiki/DownloadSource
>
> using the following configure
>
> ./configure --with-netcdf=/usr/lib --with-libtiff=yes --with-geotiff=yes --with-jpeg=/usr/lib --with-gif=/usr/lib --with-png=/ur/lib --with-pg=/usr/bin/pg_config --with-libgrass=yes
>
> make
>
> sudo make install
>
> and made sure the libgdal link was referring to the new one.
>
> I tried
> gdalinfo file.nc
>
> and again got 'segmentation fault'
>
> it works for other data types; only netcdf does not work (just like before with gdal1.4.4)

Vishal,

Have you tried with other netcdf files?  How big is "big"?   Perhaps
you are encounter a 2GB file size limit?

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent

No virus found in this incoming message.
Checked by AVG - http://www.avg.com
Version: 8.0.138 / Virus Database: 270.6.3/1611 - Release Date: 8/14/2008 6:20 AM
From mateusz at loskot.net  Thu Aug 14 18:50:00 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 14 18:50:07 2008
Subject: [gdal-dev] OGR Translate File
In-Reply-To: <48A4AAAC.7000100@hostgis.com>
References: <67fe0b0808141337p186b6c10h3f7abeb6c9663c0@mail.gmail.com>		<48A49F4D.3060501@loskot.net>	<67fe0b0808141424r4223c7f3y66cd1c4975d985bd@mail.gmail.com>
	<48A4A972.1060406@loskot.net> <48A4AAAC.7000100@hostgis.com>
Message-ID: <48A4B698.3050300@loskot.net>

Gregor Mosheh wrote:
> Mateusz Loskot wrote:
>> If you are going to use php_ogr, I recommend to
>> read the thread "gdal-dev] Future of PHP bindings"
> 
> In that discussion, they mention the same download as I commonly use, 
> and enjoy. http://dl.maptools.org/dl/php_ogr/  Works great.

Gregor,

Yes, the same package is mentioned.

> Are you saying that THAT php_ogr will also be orphaned, and/or that GDAL 
> will change to be incompatible with it?

No, I'm not saying that. I've just pointed to the most recent discussion 
about OGR and PHP that I'm aware of. So, Jerry can get an
impression of its current status.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From 27949218 at qq.com  Thu Aug 14 21:56:20 2008
From: 27949218 at qq.com (=?gbk?B?d293?=)
Date: Thu Aug 14 21:56:27 2008
Subject: [gdal-dev] deleting feature exceptions
Message-ID: <tencent_70F4F4384C33AD601EC68AB2@qq.com>

Hi,
    i try to delete features from a set of shape file, sometimes get error. I use this version of ogrshapelayer.cpp  : http://trac.osgeo.org/gdal/changeset/10969 . Delete feature in two ways would get different result:
 (1)  for(iFeat=0;iFeat<nFeat;iFeat++)
   {
        int cplE = pLayer->DeleteFeature(0);
        if(cplE==CE_None)
       { 
         OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
         cplE = pShpLayer->Repack();
          if(cplE!=CE_None)
         {
            printf("delete feature failed \n");
            return false;
         }
      }
  }
    int nFeatRest = pLayer->GetFeatureCount();
  
     These codes could delete each feature with returned value CE_None, and  at the end nFeatRest=0. But when ran to pShpLayer->Repack()  second, the error occurs: "Failure writing DBF record 0", it jumped untill all features were deleted.
  
 (2)  for(iFeat=nFeat-1;iFeat>=0;iFeat--)
 {
      int cplE = pLayer->DeleteFeature(iFeat);
      if(cplE==CE_None)
     { 
           OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
           cplE = pShpLayer->Repack();
           if(cplE!=CE_None)
          {
           printf("delete feature failed \n");
          return false;
          }
     }
 }
     int nFeatRest = pLayer->GetFeatureCount();
  
     These codes could delete each feature with returned value CE_None, but at the end nFeatRest>0 and nFeatRest<nFeat, some features were NOT deleted yet!   Same as (1), when ran to pShpLayer->Repack()  second, the error occurs: "Failure writing DBF record iFeat", it jumped untill all features were deleted.
     Trace the error  "Failure writing DBF record ..." into Repack():
    /* -------------------------------------------------------------------- */
   /*      Build a list of records to be dropped.                          */
   /* -------------------------------------------------------------------- */
    ...
     for( iShape = 0; iShape < nTotalShapeCount; iShape++ )
    {
        if( DBFIsRecordDeleted( hDBF, iShape ) )//------------ERROR jumped ---------
            panRecordsToDelete[nDeleteCount++] = iShape;
    }
    Why did this phenomena occurs? 
     Thank you.
     
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080815/2c555853/attachment-0001.html
From 27949218 at qq.com  Thu Aug 14 21:54:23 2008
From: 27949218 at qq.com (=?gbk?B?d293?=)
Date: Thu Aug 14 21:56:32 2008
Subject: [gdal-dev] deleting feature exceptions
Message-ID: <tencent_0513141112A1F16A7CCC7EED@qq.com>

Hi,
    i try to delete features from a set of shape file, sometimes get error. I use this version of ogrshapelayer.cpp  : http://trac.osgeo.org/gdal/changeset/10969 . Delete feature in two ways would get different result:
 (1)  for(iFeat=0;iFeat<nFeat;iFeat++)
   {
        int cplE = pLayer->DeleteFeature(0);
        if(cplE==CE_None)
       { 
         OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
         cplE = pShpLayer->Repack();
          if(cplE!=CE_None)
         {
            printf("delete feature failed \n");
            return false;
         }
      }
  }
    int nFeatRest = pLayer->GetFeatureCount();
  
     These codes could delete each feature with returned value CE_None, and  at the end nFeatRest=0. But when ran to pShpLayer->Repack()  second, the error occurs: "Failure writing DBF record 0", it jumped untill all features were deleted.
  
 (2)  for(iFeat=nFeat-1;iFeat>=0;iFeat--)
 {
      int cplE = pLayer->DeleteFeature(iFeat);
      if(cplE==CE_None)
     { 
           OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
           cplE = pShpLayer->Repack();
           if(cplE!=CE_None)
          {
           printf("delete feature failed \n");
          return false;
          }
     }
 }
     int nFeatRest = pLayer->GetFeatureCount();
  
     These codes could delete each feature with returned value CE_None, but at the end nFeatRest>0 and nFeatRest<nFeat, some features were NOT deleted yet!   Same as (1), when ran to pShpLayer->Repack()  second, the error occurs: "Failure writing DBF record iFeat", it jumped untill all features were deleted.
     Trace the error  "Failure writing DBF record ..." into Repack():
    /* -------------------------------------------------------------------- */
   /*      Build a list of records to be dropped.                          */
   /* -------------------------------------------------------------------- */
    ...
     for( iShape = 0; iShape < nTotalShapeCount; iShape++ )
    {
        if( DBFIsRecordDeleted( hDBF, iShape ) )//------------ERROR jumped ---------
            panRecordsToDelete[nDeleteCount++] = iShape;
    }
    Why did this phenomena occurs? 
     Thank you.
     
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080815/23f62390/attachment.html
From warmerdam at pobox.com  Thu Aug 14 22:06:56 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Aug 14 22:06:57 2008
Subject: [gdal-dev] deleting feature exceptions
In-Reply-To: <tencent_70F4F4384C33AD601EC68AB2@qq.com>
References: <tencent_70F4F4384C33AD601EC68AB2@qq.com>
Message-ID: <931f8ea90808141906v424e0b0du315400f78ef7f188@mail.gmail.com>

Chen,

I'm surprised both approaches don't work smoothly.  I'd suggest you boil
down a minimum example of the problem, and file a bug ticket on it
including the input data.

Best regards,
FrankW

2008/8/14 wow <27949218@qq.com>:
>
> Hi,
>    i try to delete features from a set of shape file, sometimes get error. I
> use this version of ogrshapelayer.cpp  :
> http://trac.osgeo.org/gdal/changeset/10969 . Delete feature in two ways
> would get different result:
> (1)  for(iFeat=0;iFeat<nFeat;iFeat++)
>    {
>         int cplE = pLayer->DeleteFeature(0);
>         if(cplE==CE_None)
>        {
>          OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
>          cplE = pShpLayer->Repack();
>          if(cplE!=CE_None)
>          {
>             printf("delete feature failed ?\n");
>             return false;
>          }
>       }
>   }
>    int nFeatRest = pLayer->GetFeatureCount();
>
>     These codes could delete each feature with returned value CE_None, and
> at the end nFeatRest=0. But when ran to pShpLayer->Repack()  second, the
> error occurs: "Failure writing DBF record 0", it jumped untill all features
> were deleted.
>
> (2)  for(iFeat=nFeat-1;iFeat>=0;iFeat--)
>  {
>       int cplE = pLayer->DeleteFeature(iFeat);
>      if(cplE==CE_None)
>      {
>            OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
>            cplE = pShpLayer->Repack();
>            if(cplE!=CE_None)
>           {
>            printf("delete feature failed ?\n");
>           return false;
>           }
>      }
>  }
>     int nFeatRest = pLayer->GetFeatureCount();
>
>     These codes could delete each feature with returned value CE_None, but
> at the end nFeatRest>0 and nFeatRest<nFeat, some features were NOT deleted
> yet!   Same as (1), when ran to pShpLayer->Repack()  second, the error
> occurs: "Failure writing DBF record iFeat", it jumped untill all features
> were deleted.
>     Trace the error  "Failure writing DBF record ..." into Repack():
>    /* --------------------------------------------------------------------
> */
>    /*      Build a list of records to be dropped.
> */
>    /* --------------------------------------------------------------------
> */
>     ...
>     for( iShape = 0; iShape < nTotalShapeCount; iShape++ )
>     {
>         if( DBFIsRecordDeleted( hDBF, iShape ) )//------------ERROR jumped
> ---------
>             panRecordsToDelete[nDeleteCount++] = iShape;
>     }
>     Why did this phenomena occurs?
>     Thank you.
>
> ------------------
> To the world you're little, but to a person you're the world.
>                                             Chen Xuexia
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From cryan at csse.com.au  Thu Aug 14 22:17:51 2008
From: cryan at csse.com.au (Fodder)
Date: Thu Aug 14 22:17:53 2008
Subject: [Gdal-dev] Tif file getting larger and larger
In-Reply-To: <48A42316.4030202@sarvision.nl>
References: <18976082.post@talk.nabble.com> <48A41C64.6090406@o2.pl>
	<18980252.post@talk.nabble.com> <48A42316.4030202@sarvision.nl>
Message-ID: <18992723.post@talk.nabble.com>


Thanks for that Vincent, very interesting. 


Vincent Schut-2 wrote:
> 
> 
> In case someone is interested, personally I use these optimization rules:
> - random write access: don't compress, strip or tile and pixel or band 
> interleave according to read/write algorithm;
> - mainly intended for reading/viewing: don't compress, square tiles 
> (256x256), add pyramids;
> - intended for clients that use commercial GIS/RS software: pixel 
> interleave, strip oriented, no compression, no strange data types
> - space is really really really an issue and I am sure I don't need any 
> random write access to it and I am the only one that wants to read/view 
> it: band interleaved, usually tiled, deflate compression. Sometimes add 
> (compressed) pyramids.
> 
> Cheers,
> Vincent.
>> 

-- 
View this message in context: http://www.nabble.com/Tif-file-getting-larger-and-larger-tp18976082p18992723.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From 27949218 at qq.com  Fri Aug 15 03:34:48 2008
From: 27949218 at qq.com (=?gbk?B?d293?=)
Date: Fri Aug 15 03:34:57 2008
Subject: [gdal-dev] deleting feature exceptions
Message-ID: <tencent_5DB6B0536D453CD95DCAAC17@qq.com>

Hi, Frank,thank you for reply. 
   I have posted the ticket with little experience here:
   http://trac.osgeo.org/gdal/ticket/2531.
   Attachment of this mail is the example project. Thank you for more help.
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia

  
  
 ------------------ Original ------------------
  From:  "Frank Warmerdam"<warmerdam@pobox.com>;
 Date:  Fri, Aug 15, 2008 10:06 AM
 To:  "wow"<27949218@qq.com>; 
 Cc:  "gdal-dev"<gdal-dev@lists.osgeo.org>; 
 Subject:  Re: [gdal-dev] deleting feature exceptions

  
 Chen,

I'm surprised both approaches don't work smoothly.  I'd suggest you boil
down a minimum example of the problem, and file a bug ticket on it
including the input data.

Best regards,
FrankW

2008/8/14 wow <27949218@qq.com>:
>
> Hi,
>    i try to delete features from a set of shape file, sometimes get error. I
> use this version of ogrshapelayer.cpp  :
> http://trac.osgeo.org/gdal/changeset/10969 . Delete feature in two ways
> would get different result:
> (1)  for(iFeat=0;iFeat<nFeat;iFeat++)
>    {
>         int cplE = pLayer->DeleteFeature(0);
>         if(cplE==CE_None)
>        {
>          OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
>          cplE = pShpLayer->Repack();
>          if(cplE!=CE_None)
>          {
>             printf("delete feature failed \n");
>             return false;
>          }
>       }
>   }
>    int nFeatRest = pLayer->GetFeatureCount();
>
>     These codes could delete each feature with returned value CE_None, and
> at the end nFeatRest=0. But when ran to pShpLayer->Repack()  second, the
> error occurs: "Failure writing DBF record 0", it jumped untill all features
> were deleted.
>
> (2)  for(iFeat=nFeat-1;iFeat>=0;iFeat--)
>  {
>       int cplE = pLayer->DeleteFeature(iFeat);
>      if(cplE==CE_None)
>      {
>            OGRShapeLayer* pShpLayer = (OGRShapeLayer*)pLayer;
>            cplE = pShpLayer->Repack();
>            if(cplE!=CE_None)
>           {
>            printf("delete feature failed \n");
>           return false;
>           }
>      }
>  }
>     int nFeatRest = pLayer->GetFeatureCount();
>
>     These codes could delete each feature with returned value CE_None, but
> at the end nFeatRest>0 and nFeatRest<nFeat, some features were NOT deleted
> yet!   Same as (1), when ran to pShpLayer->Repack()  second, the error
> occurs: "Failure writing DBF record iFeat", it jumped untill all features
> were deleted.
>     Trace the error  "Failure writing DBF record ..." into Repack():
>    /* --------------------------------------------------------------------
> */
>    /*      Build a list of records to be dropped.
> */
>    /* --------------------------------------------------------------------
> */
>     ...
>     for( iShape = 0; iShape < nTotalShapeCount; iShape++ )
>     {
>         if( DBFIsRecordDeleted( hDBF, iShape ) )//------------ERROR jumped
> ---------
>             panRecordsToDelete[nDeleteCount++] = iShape;
>     }
>     Why did this phenomena occurs?
>     Thank you.
>
> ------------------
> To the world you're little, but to a person you're the world.
>                                             Chen Xuexia
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent


QQmin-projV1.4.rar (2.92M) []  (: 2008822 15:14)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080815/8717d96e/attachment-0001.html
From mateusz at loskot.net  Fri Aug 15 07:06:40 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 15 07:06:49 2008
Subject: [gdal-dev] deleting feature exceptions
In-Reply-To: <tencent_5DB6B0536D453CD95DCAAC17@qq.com>
References: <tencent_5DB6B0536D453CD95DCAAC17@qq.com>
Message-ID: <48A56340.1010806@loskot.net>

wow wrote:
> Hi, Frank,thank you for reply. 
>    I have posted the ticket with little experience here:
>    http://trac.osgeo.org/gdal/ticket/2531.

Chen,

Please, take care next time to wrap source code snippet included in the 
Ticket description with triple parenthesis, like this:

{{{
... your code here
}}}

This way, the code does not break the structure of ticket.

Also, if you want to include long URLs, this is the best way to do it:

[http://yourlongwebaddress.com  My URL]

It will display short "My URL" title linked to the URL.

Here you can find more details:

http://trac.osgeo.org/gdal/wiki/WikiFormatting

>    Attachment of this mail is the example project. Thank you for more help.

I've noticed no file attached to the ticket you reported.
Do you mean the attachement as URL in your updating comment?

http://trac.osgeo.org/gdal/ticket/2531#comment:1

I've tried to polish your ticket report.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Fri Aug 15 07:16:07 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 15 07:16:12 2008
Subject: [gdal-dev] deleting feature exceptions
In-Reply-To: <48A56340.1010806@loskot.net>
References: <tencent_5DB6B0536D453CD95DCAAC17@qq.com>
	<48A56340.1010806@loskot.net>
Message-ID: <48A56577.9070606@loskot.net>

Mateusz Loskot wrote:
>> Attachment of this mail is the example project. Thank you for more 
>> help.
> 
> I've noticed no file attached to the ticket you reported.
> Do you mean the attachement as URL in your updating comment?

Chen,

I'd suggest to attach your file min-projV1.4.rar directly to the ticket 
- hit "Attach File" button.

For me, the URL you included in the ticket does not return any file, but 
a web page that I can't read & understand, sorry for my ignorance.

http://xianexs.mail.qq.com/cgi-bin/downloadfilepart/svrid240/min-projV1.4.rar?svrid=240&fid=0005cdc7f9832359f9e4eb3efc621a7a0b6aed38b0648f15&&txf_fid=0f757a1c67e9d00af86bb29f362dca856bb234a4&&txf_sid=326af806a32d836c8f8ca536069d59f48fb8309e

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From fepeacock at bulldoghome.com  Fri Aug 15 07:01:31 2008
From: fepeacock at bulldoghome.com (Frank Peacock)
Date: Fri Aug 15 07:24:26 2008
Subject: [gdal-dev] GRIB2 file produces None on opening
Message-ID: <000001c8fec6$46facb40$d4f061c0$@com>

Hello

 

I have a GRIB2 file called "a" which I have tested and is correct.  I use
the following code:

 

from osgeo import gdal

 

src_ds = gdal.Open("a")

print src_ds

 

The result of the print is None. 

 

I have also run a test with a tif file and it works correctly producing

 

<osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow *' at
0x14381b8> >

 

Can anyone help to explain why the GRIB2 file is not being read correctly.

 

Thanks

 

Frank

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080815/ed0a0370/attachment.html
From mateusz at loskot.net  Fri Aug 15 07:38:08 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 15 07:38:13 2008
Subject: [gdal-dev] GRIB2 file produces None on opening
In-Reply-To: <000001c8fec6$46facb40$d4f061c0$@com>
References: <000001c8fec6$46facb40$d4f061c0$@com>
Message-ID: <48A56AA0.7030805@loskot.net>

Frank Peacock wrote:
> Hello
> 
> I have a GRIB2 file called "a" which I have tested and is correct.  I use
> the following code:
> 
> from osgeo import gdal
> src_ds = gdal.Open("a")
> print src_ds
> 
> The result of the print is None. 
> I have also run a test with a tif file and it works correctly producing
> <osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow *' at
> 0x14381b8> >
> 
> Can anyone help to explain why the GRIB2 file is not being read correctly.

Frank,

What version of GDAL do you use?
What does the following command return:

$ gdalinfo --formats | grep GRIB

Have you tried to open your dataset using gdalinfo?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From plieger at knmi.nl  Fri Aug 15 07:43:28 2008
From: plieger at knmi.nl (Maarten Plieger)
Date: Fri Aug 15 07:43:32 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on	netcdf
	data
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA6541FF145F8@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA6541FEE4C84@winxbeus09.exchange.xchg>,
	<931f8ea90808141112y63994407g87d6117719bfb6a7@mail.gmail.com>
	<3C465A6646C7AD48B03EBF86127AA6541FF145F8@winxbeus09.exchange.xchg>
Message-ID: <48A56BE0.5000101@knmi.nl>

Hi Vishal,
I do not have any problems with the gdal netcdf driver...
The example netcdf files from the unidata website work well for example.
I am using GDAL 1.5.2 with the latest netcdf 4.0 library.

Maarten

Vishal Mehta schreef:
> Hi Frank,
>
> I have tried with 2 netcdf files from different sites - same error 'segmentation fault'
>
> the first was 60mb, the second was small !260kb.
>
> does anyone in the list have this problem with gdal and netcdf data? earlier posts seemed to suggest a conflict between netcdf and hdf4, but i did not compile with hdf support so that shouldnt be a problem i thought..
>
> thanks,
> vishal
>
>
> __________________
> From: fwarmerdam@gmail.com [fwarmerdam@gmail.com] On Behalf Of Frank Warmerdam [warmerdam@pobox.com]
> Sent: Thursday, August 14, 2008 11:12 AM
> To: Vishal Mehta
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf data
>
> On Thu, Aug 14, 2008 at 12:42 PM, Vishal Mehta <vishal.mehta@sei-us.org> wrote:
>
>   
>> 2. I compiled from source gdal1.5.2 from
>> http://trac.osgeo.org/gdal/wiki/DownloadSource
>>
>> using the following configure
>>
>> ./configure --with-netcdf=/usr/lib --with-libtiff=yes --with-geotiff=yes --with-jpeg=/usr/lib --with-gif=/usr/lib --with-png=/ur/lib --with-pg=/usr/bin/pg_config --with-libgrass=yes
>>
>> make
>>
>> sudo make install
>>
>> and made sure the libgdal link was referring to the new one.
>>
>> I tried
>> gdalinfo file.nc
>>
>> and again got 'segmentation fault'
>>
>> it works for other data types; only netcdf does not work (just like before with gdal1.4.4)
>>     
>
> Vishal,
>
> Have you tried with other netcdf files?  How big is "big"?   Perhaps
> you are encounter a 2GB file size limit?
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush | Geospatial Programmer for Rent
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.3/1611 - Release Date: 8/14/2008 6:20 AM
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>   


-- 
Maarten Plieger
KNMI, R&D Information and Observation Technology, De Bilt
(t) +31 30 2206330 

From ivan.lucena at pmldnet.com  Fri Aug 15 07:58:18 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Fri Aug 15 07:58:16 2008
Subject: [gdal-dev] GRIB2 file produces None on opening
In-Reply-To: <48A56AA0.7030805@loskot.net>
References: <000001c8fec6$46facb40$d4f061c0$@com> <48A56AA0.7030805@loskot.net>
Message-ID: <48A56F5A.4090601@pmldnet.com>

Just a comment: There are some grib files generated by SPRING that are 
not compatible with the GRIB driver. It might be a version issue GRIB1, 
GRIB2 or something. Ex.:

C:\Data\SpringDB\SP\SPaulo>gdalinfo I000355.grb
ERROR 4: `I000355.grb' not recognised as a supported file format.

gdalinfo failed - unable to open 'I000355.grb'.

Mateusz Loskot wrote:
> Frank Peacock wrote:
>> Hello
>>
>> I have a GRIB2 file called "a" which I have tested and is correct.  I use
>> the following code:
>>
>> from osgeo import gdal
>> src_ds = gdal.Open("a")
>> print src_ds
>>
>> The result of the print is None. I have also run a test with a tif 
>> file and it works correctly producing
>> <osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow 
>> *' at
>> 0x14381b8> >
>>
>> Can anyone help to explain why the GRIB2 file is not being read 
>> correctly.
> 
> Frank,
> 
> What version of GDAL do you use?
> What does the following command return:
> 
> $ gdalinfo --formats | grep GRIB
> 
> Have you tried to open your dataset using gdalinfo?
> 
> Best regards,
From huntc at internode.on.net  Fri Aug 15 08:41:48 2008
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Aug 15 08:38:49 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <48931775.9010601@pobox.com>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<487D3C22.3070501@pobox.com>
	<7890CB5F-AAF1-4ADF-8EB6-3368B105855B@internode.on.net>
	<487D5C8C.1000104@pobox.com>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
Message-ID: <507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>

Hi again Frank et. al,

I've made some progress. The aerial image provider now tells me that  
it is projected as OSGB 1936 which I believe is EPSG:27700. Thus if I  
use a command like:

gdal_translate -a_srs EPSG:27700 -a_ullr ....

then I should be able to create my GeoTIFF.

Unfortunately the image provider hasn't provided the top left/bottom  
right coords so I'm going to Google Earth to approximate them (yes,  
ugly I know). I'm hopeful that the actual top left/bottom right will  
ultimately be provided to me, but meanwhile I want to ensure that the  
a_ullr parameters I provide will be in metres i.e. eastings and  
northings from the OSGB 1936 origin. Is this correct?

Thanks again for your help. I'm hoping that my documented journey into  
gdal will benefit others... :-)

Cheers,
-C
From lran at unc.edu  Fri Aug 15 09:29:34 2008
From: lran at unc.edu (Limei Ran)
Date: Fri Aug 15 09:36:10 2008
Subject: [gdal-dev] GRIB2 file produces None on opening
In-Reply-To: <48A56F5A.4090601@pmldnet.com>
References: <000001c8fec6$46facb40$d4f061c0$@com>
	<48A56AA0.7030805@loskot.net> <48A56F5A.4090601@pmldnet.com>
Message-ID: <20080815092934.xafpusikg0ss800g@webmail5.isis.unc.edu>


Hi:

I have the same problem.  I just installed 1.5.2 version on Linux. When I do:
gdalinfo --formats | grep GRIB

Nothing came out.  Also when I do:
gdalinfo abc.grb I got: not recognised as a supported file format

My grb file is GRIB2 format.  Do we need to download the GRIB driver 
before the installation?

Thanks,

Limei
-- 
Limei Ran, Research Associate
Center for Environmental Modeling for Policy Development
the Institute for the Environment University of North Carolina at Chapel Hill
Bank of American Plaza - CB#6116
137 E. Franklin, Room 661
Chapel Hill, NC 27599-6116

Email: lran@unc.edu
Phone:  919-966-2245
Fax:    919-843-3113




Quoting Lucena, Ivan:

> Just a comment: There are some grib files generated by SPRING that 
> are not compatible with the GRIB driver. It might be a version issue 
> GRIB1, GRIB2 or something. Ex.:
>
> C:\Data\SpringDB\SP\SPaulo>gdalinfo I000355.grb
> ERROR 4: `I000355.grb' not recognised as a supported file format.
>
> gdalinfo failed - unable to open 'I000355.grb'.
>
> Mateusz Loskot wrote:
>> Frank Peacock wrote:
>>> Hello
>>>
>>> I have a GRIB2 file called "a" which I have tested and is correct.  I use
>>> the following code:
>>>
>>> from osgeo import gdal
>>> src_ds = gdal.Open("a")
>>> print src_ds
>>>
>>> The result of the print is None. I have also run a test with a tif 
>>> file and it works correctly producing
>>> <osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow *' at
>>> 0x14381b8> >
>>>
>>> Can anyone help to explain why the GRIB2 file is not being read correctly.
>>
>> Frank,
>>
>> What version of GDAL do you use?
>> What does the following command return:
>>
>> $ gdalinfo --formats | grep GRIB
>>
>> Have you tried to open your dataset using gdalinfo?
>>
>> Best regards,
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From bfraser at geoanalytic.com  Fri Aug 15 13:09:10 2008
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Fri Aug 15 13:39:46 2008
Subject: [gdal-dev] Disabiling Geos messages via OGR
Message-ID: <48A5B836.7020001@geoanalytic.com>

I'm using OGR's Geos functions (e.g. OGRGeometry::IsValid) to process some polygons.  Geos spits out messages to console (stderr?) like "Warning 1: Self-intersection at or near point ...".  Is there a way to disable these messages via OGR?

Thanks!
Brent Fraser
From warmerdam at pobox.com  Sat Aug 16 00:05:15 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Aug 16 00:05:18 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
Message-ID: <931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>

On Fri, Aug 15, 2008 at 8:41 AM, Christopher Hunt
<huntc@internode.on.net> wrote:
> Hi again Frank et. al,
>
> I've made some progress. The aerial image provider now tells me that it is
> projected as OSGB 1936 which I believe is EPSG:27700. Thus if I use a
> command like:
>
> gdal_translate -a_srs EPSG:27700 -a_ullr ....
>
> then I should be able to create my GeoTIFF.
>
> Unfortunately the image provider hasn't provided the top left/bottom right
> coords so I'm going to Google Earth to approximate them (yes, ugly I know).
> I'm hopeful that the actual top left/bottom right will ultimately be
> provided to me, but meanwhile I want to ensure that the a_ullr parameters I
> provide will be in metres i.e. eastings and northings from the OSGB 1936
> origin. Is this correct?

Chris,

I believe EPSG:27700 is British National Grid which is a projected
coordinate system based on the OSGB 1936 datum.  So you should
ensure the provider means the dataset is actually in BNG, in addition
to being based on OSGB 1936.

If you can get BNG coordinates then that is great.  If you can only
get WGS84 or OSGB1936 lat/long coordinates then you can
convert these to BNG using a program like cs2cs though that is
a bit tricky.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush | Geospatial Programmer for Rent
From huntc at internode.on.net  Sat Aug 16 05:54:39 2008
From: huntc at internode.on.net (Christopher Hunt)
Date: Sat Aug 16 05:54:43 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
Message-ID: <F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>

Thanks for your reply Frank.

On 16/08/2008, at 2:05 PM, Frank Warmerdam wrote:

> I believe EPSG:27700 is British National Grid which is a projected
> coordinate system based on the OSGB 1936 datum.  So you should
> ensure the provider means the dataset is actually in BNG, in addition
> to being based on OSGB 1936.
OK, will do.

> If you can get BNG coordinates then that is great.
I've asked so fingers crossed.

> If you can only
> get WGS84 or OSGB1936 lat/long coordinates then you can
> convert these to BNG using a program like cs2cs though that is
> a bit tricky.
Understood.

Hopefully one last question on this though: the a_ullr parameters -  
given the a_srs spec of EPSG:27700, are the a_ullr parameters expected  
to be in BNG coordinates i.e. eastings and northings values? Asking  
this another way, what actually dictates the coordinate system used  
for the a_ullr parameters?

Cheers,
-C

From 27949218 at qq.com  Sat Aug 16 09:45:15 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Sat Aug 16 09:47:42 2008
Subject: [gdal-dev] deleting feature exceptions
Message-ID: <tencent_69534AA552BDAA4312968B95@qq.com>

Hi, 
 Loskot, thank you for reply. I'm sorry for my rough operation on my first ticket.
 The long URL in the updating comment stores the example project that you can download, but must input  download code:
 74cb36d4,  then click the right button to download. Sorry, I can't upload the project to the attachment of the comment because of the slow transport  speed.
    Thank you.
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia

  
  
 ------------------ Original ------------------
  From:  "Mateusz Loskot"<mateusz@loskot.net>;
 Date:  Fri, Aug 15, 2008 07:16 PM
 To:  "wow"<27949218@qq.com>; 
 Cc:  "gdal-dev"<gdal-dev@lists.osgeo.org>; 
 Subject:  Re: [gdal-dev] deleting feature exceptions

  
 Mateusz Loskot wrote:
>> Attachment of this mail is the example project. Thank you for more 
>> help.
> 
> I've noticed no file attached to the ticket you reported.
> Do you mean the attachement as URL in your updating comment?

Chen,

I'd suggest to attach your file min-projV1.4.rar directly to the ticket 
- hit "Attach File" button.

For me, the URL you included in the ticket does not return any file, but 
a web page that I can't read & understand, sorry for my ignorance.

http://xianexs.mail.qq.com/cgi-bin/downloadfilepart/svrid240/min-projV1.4.rar?svrid=240&fid=0005cdc7f9832359f9e4eb3efc621a7a0b6aed38b0648f15&&txf_fid=0f757a1c67e9d00af86bb29f362dca856bb234a4&&txf_sid=326af806a32d836c8f8ca536069d59f48fb8309e

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080816/0a1e745f/attachment.html
From koen at fietsnet.be  Sat Aug 16 11:52:08 2008
From: koen at fietsnet.be (Koen Mannaerts [fietsnet.be])
Date: Sat Aug 16 11:52:12 2008
Subject: [gdal-dev] Reprojection differs between FWtools versions
Message-ID: <48A6F7A8.2080208@fietsnet.be>


Hi all,

I noticed that ogr2ogr in FWtools 1.0.0.a7 returns a different result 
than ogr2ogr in FWtools 2.2.0, 2.2.1.

No doubt it's due to what I pass as arguments. The idea is to convert 
Belgian Lambert, Belgian Datum shapefiles to Lat/Lon WGS84.
With the following arguments 1.0.0.a7 does this correctly, 2.2.1 
produces polylines ~110m off to the north west (Belgium).

-f "ESRI Shapefile" -s_srs "+proj=lcc +lat_2=49.8333339 +lat_1=51.166667 
+lat_0=90.0000000 +lon_0=4.3674867 +x_0=150000.013 +y_0=5400088.438 
+units=m +ellps=intl 
+towgs84=-99.059,53.322,-112.486,0.419,-0.830,1.885,-0.999999" -t_srs 
"+proj=latlong +ellps=WGS84"

Do I need to express the argument otherwise to make it work in newer 
versions?

Thanks heaps,

Koen
From 27949218 at qq.com  Sun Aug 17 00:31:48 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Sun Aug 17 00:31:55 2008
Subject: [gdal-dev] OGRFeatureStyle  update from version1.4.1 to 1.5.2; 
Message-ID: <tencent_50DCED291C8AE39A0A536798@qq.com>

Hi,
   When i tried to update my whole program from ver1.4.1 to 1.5.2, all worked well except the  OGRFeatureStyle  module. The function OGRStyleMgr::AddStyle() couldn't write the provided style name and style string right with ver1.5.2, but could run smoothly with version 1.4.1. 
   My code :
 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
 bool CBcgtDoc::CreateDefaultStyle(CString strTlbPath, int nType)
{ 
      OGRStyleTable oStyleTable;
      OGRStyleMgr   *poStyleMgr = new OGRStyleMgr(&oStyleTable);
      bool res;
      switch(nType)
     {
          case 1:            //point
          {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#FFFF00,f:\"MS Gothic\",s:10px,t:\"\",l:1)");
            res = oStyleTable.SaveStyleTable(strTlbPath);
         }
           break;
        case 2:              //line
         {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");//
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#0000FF,f:\"MS Gothic\",s:10px,t:\"\",l:1)");//
            res = poStyleMgr->AddStyle("@line", "PEN(c:#FF0000,w:3px,id:\"swL0\",l:1)");//
            res = oStyleTable.SaveStyleTable(strTlbPath); 
        }
           break;
       case 3:              //polygon
        {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#FF0000,f:\"MS Gothic\",s:10px,t:\"\",l:1)");
            res = poStyleMgr->AddStyle("@line", "PEN(c:#FF0000,w:3px,id:\"swL0\",l:1)");
            res = poStyleMgr->AddStyle("@brush", "BRUSH(fc:#C0C0C0,id:\"swR0\")");
            res = oStyleTable.SaveStyleTable(strTlbPath); 
       }
           break;
      default:
           break;
    }
  if(poStyleMgr)
  {
  delete poStyleMgr;
  poStyleMgr = NULL;
  }
  if(!res)
  {
     return false;
  }
  return true;
}
 ///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      Thank you.
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080817/39ef83fb/attachment.html
From tutey at o2.pl  Sun Aug 17 10:32:10 2008
From: tutey at o2.pl (Maciej Sieczka)
Date: Sun Aug 17 10:30:36 2008
Subject: [gdal-dev] reproject an array of points
Message-ID: <48A8366A.5090700@o2.pl>

Hi

How do I reproject an array of points in one run, in Python? Each point
consist of 'easting, northing, value'. 'value' is supposed to remain
unchanged after transformation. (Please bear with me - I'm still
learning Python).

Maciek

-- 
Maciej Sieczka
www.sieczka.org
From mateusz at loskot.net  Sun Aug 17 12:29:01 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun Aug 17 12:29:34 2008
Subject: [gdal-dev] reproject an array of points
In-Reply-To: <48A8366A.5090700@o2.pl>
References: <48A8366A.5090700@o2.pl>
Message-ID: <1833.91.94.207.140.1218990541.squirrel@loskot.net>

Maciej Sieczka wrote:
>
> How do I reproject an array of points in one run, in Python? Each point
> consist of 'easting, northing, value'. 'value' is supposed to remain
> unchanged after transformation. (Please bear with me - I'm still
> learning Python).

Maciej,

It should be simple to use Projection.py module from Thuban.
Here you have archived page on Hobu's website:

http://web.archive.org/web/20070216084221/http://hobu.biz/software/pyprojection

You can find some example on my page too:

http://mateusz.loskot.net/software/gis/pyepsglookup/

Best regards,
-- 
Mateusz Loskot
http://mateusz.loskot.net

From nikos.alexandris at felis.uni-freiburg.de  Sun Aug 17 18:06:54 2008
From: nikos.alexandris at felis.uni-freiburg.de (Nikos Alexandris)
Date: Sun Aug 17 18:06:58 2008
Subject: [gdal-dev] QGIS looses toolbar icons after changing background color
Message-ID: <1219010814.21599.4.camel@vertical>

Dear QGIS-users and developers,
I 've come across this strange behaviour: Settings > Background Color
(change color to anything) > OK. The result is that all toolbar icons
disappear, only text is shown for each button!

QGIS 0.11.0-Metis under Ubuntu Hardy 64-bit (with GRASS 6.4.svn)

Kind regards, Nikos

From warmerdam at pobox.com  Mon Aug 18 10:20:51 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 18 10:20:54 2008
Subject: [gdal-dev] Disabiling Geos messages via OGR
In-Reply-To: <48A5B836.7020001@geoanalytic.com>
References: <48A5B836.7020001@geoanalytic.com>
Message-ID: <931f8ea90808180720m4604930bla4fffc7cc7952e5b@mail.gmail.com>

On 8/15/08, Brent Fraser <bfraser@geoanalytic.com> wrote:
> I'm using OGR's Geos functions (e.g. OGRGeometry::IsValid) to process some
> polygons.  Geos spits out messages to console (stderr?) like "Warning 1:
> Self-intersection at or near point ...".  Is there a way to disable these
> messages via OGR?

Brent,

OGR reroutes GEOS errors and warnings via the CPL error reporting
mechanism.  So, if you are working programatically you could
install a custom warning/error handler (see CPLPushErrorHandler()
for instance).

If you are just using the utilities there is no practical way to filter
out the GEOS messages other than by redirecting stderr to
/dev/null.

Best regards,


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From warmerdam at pobox.com  Mon Aug 18 10:50:17 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 18 10:50:21 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
	<F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
Message-ID: <931f8ea90808180750w3d4e907cj47701dc089812176@mail.gmail.com>

On 8/16/08, Christopher Hunt <huntc@internode.on.net> wrote:
>  Hopefully one last question on this though: the a_ullr parameters - given
> the a_srs spec of EPSG:27700, are the a_ullr parameters expected to be in
> BNG coordinates i.e. eastings and northings values? Asking this another way,
> what actually dictates the coordinate system used for the a_ullr parameters?


Chris,

The coordinates in the -a_ullr should match the coordinate
system of the image (ie. what gdalinfo reports for instance)
or the coordinate system supplied in -a_srs if you give that
to assign a new coordinate system.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From warmerdam at pobox.com  Mon Aug 18 10:58:04 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 18 10:58:06 2008
Subject: [gdal-dev] Reprojection differs between FWtools versions
In-Reply-To: <48A6F7A8.2080208@fietsnet.be>
References: <48A6F7A8.2080208@fietsnet.be>
Message-ID: <931f8ea90808180758j448194dfl39d37afe9bb45ab7@mail.gmail.com>

On 8/16/08, Koen Mannaerts [fietsnet.be] <koen@fietsnet.be> wrote:
>
>  Hi all,
>
>  I noticed that ogr2ogr in FWtools 1.0.0.a7 returns a different result than
> ogr2ogr in FWtools 2.2.0, 2.2.1.


Koen,

The behavior of PROJ.4 changed between PROJ 4.5.x and
PROJ 4.6.0.  In particular, PROJ.4 will no longer attempt to
apply a change of ellipsoid when going between different
ellipsoids if no datum information is provided.

>  No doubt it's due to what I pass as arguments. The idea is to convert
> Belgian Lambert, Belgian Datum shapefiles to Lat/Lon WGS84.
>  With the following arguments 1.0.0.a7 does this correctly, 2.2.1 produces
> polylines ~110m off to the north west (Belgium).
>
>  -f "ESRI Shapefile" -s_srs "+proj=lcc +lat_2=49.8333339 +lat_1=51.166667
> +lat_0=90.0000000 +lon_0=4.3674867 +x_0=150000.013 +y_0=5400088.438 +units=m
> +ellps=intl
> +towgs84=-99.059,53.322,-112.486,0.419,-0.830,1.885,-0.999999"
> -t_srs "+proj=latlong +ellps=WGS84"


I would suggest using +datum=WGS84 in the second definition,
instead of (or addition to) +ellps=WGS84.  You will also need some
datum shift info for the intl ellipsoid.  If you want the old behavior,
provide +towgs84=0,0,0.  This means only a change of ellipsoid
will be applied, but no other datum shifting will be done.

>  Do I need to express the argument otherwise to make it work in newer
> versions?

Please also keep in mind that if you play "fast and loose" with
datum shifts, there is a substantial risk that the results are
not accurate.  At the best of times, a datum shift usually
involves some error due to the approximate nature of datum
shift formulas.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From mateusz at loskot.net  Mon Aug 18 11:03:16 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 18 11:03:23 2008
Subject: [gdal-dev] GRIB2 file produces None on opening
In-Reply-To: <20080815092934.xafpusikg0ss800g@webmail5.isis.unc.edu>
References: <000001c8fec6$46facb40$d4f061c0$@com>	<48A56AA0.7030805@loskot.net>
	<48A56F5A.4090601@pmldnet.com>
	<20080815092934.xafpusikg0ss800g@webmail5.isis.unc.edu>
Message-ID: <48A98F34.30000@loskot.net>

Limei Ran wrote:
> 
> Hi:
> 
> I have the same problem.  I just installed 1.5.2 version on Linux. When
> I do:
> gdalinfo --formats | grep GRIB
> 
> Nothing came out.  Also when I do:
> gdalinfo abc.grb I got: not recognised as a supported file format
> 
> My grb file is GRIB2 format.  Do we need to download the GRIB driver
> before the installation?


GRIB format is available in current SVN trunk, so it will be released in
1.6.0. So, to get GRIB support now, you need to download GDAL sources
from SVN trunk and build it.

http://svn.osgeo.org/gdal/trunk/gdal/frmts/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From warmerdam at pobox.com  Mon Aug 18 11:12:24 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Aug 18 11:12:28 2008
Subject: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;
In-Reply-To: <tencent_50DCED291C8AE39A0A536798@qq.com>
References: <tencent_50DCED291C8AE39A0A536798@qq.com>
Message-ID: <931f8ea90808180812q7a6a88f1rc79dea8490148f1e@mail.gmail.com>

On 8/17/08, wow <27949218@qq.com> wrote:
> Hi,
>   When i tried to update my whole program from ver1.4.1 to 1.5.2, all worked
> well except the  OGRFeatureStyle  module. The function
> OGRStyleMgr::AddStyle() couldn't write the provided style
> name and style string right with ver1.5.2, but could run smoothly with
> version 1.4.1.
>   My code :

Chen,

There has been some work on the style string parser since 1.4 and
I suspect it has been subtly broken for your case in some fashion.
Could you file a ticket?  Make sure you provide any additional
details we might need, like the format you are trying to write to.

Ideally a single small self contained program demonstrating the
problem would be best.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
From mateusz at loskot.net  Mon Aug 18 14:12:37 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 18 14:12:44 2008
Subject: [gdal-dev] QGIS looses toolbar icons after changing background
	color
In-Reply-To: <1219010814.21599.4.camel@vertical>
References: <1219010814.21599.4.camel@vertical>
Message-ID: <48A9BB95.2090002@loskot.net>

Nikos Alexandris wrote:
> Dear QGIS-users and developers,
> I 've come across this strange behaviour: Settings > Background Color
> (change color to anything) > OK. The result is that all toolbar icons
> disappear, only text is shown for each button!
> 
> QGIS 0.11.0-Metis under Ubuntu Hardy 64-bit (with GRASS 6.4.svn)

Nikos,

FYI, you've sent your message to gdal-dev mailing list which is not
related in any way to core Quantum GIS development.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From even.rouault at mines-paris.org  Mon Aug 18 15:07:24 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug 18 15:07:29 2008
Subject: [gdal-dev] Re: X-Plane runway orientation
In-Reply-To: <20080811163120.GA7349@jive.mgras.de>
References: <20080811163120.GA7349@jive.mgras.de>
Message-ID: <200808182107.24827.even.rouault@mines-paris.org>

Hi Martin,

I've applied your patch in r15154.

As far as the true heading is concerned, I'm not sure if it is necessary to 
change things as it is an angle, and 0 or 360 mean pretty much the same 
thing. Furthermore, this value is probably not directly read by "humans", but 
used for computations. Which is different from the runway name, where there 
is clearly a naming convention.

Le Monday 11 August 2008 18:31:20 Martin Spott, vous avez ?crit?:
> Hi,
> the X-Plane driver is reading a single name for a runway and computes
> the opposite runway direction. Apparently a tiny mistake has crept into
> the respective logic: Currently the opposite of runway 18 is being
> computed as runway 00 - but there's no such thing as a runway 00,
> instead we're supposed to have runway 36.
>
> The following patch is meant to fix this issue:
>
> ---
> ./gdal-svn-trunk-2008.08.10/ogr/ogrsf_frmts/xplane/ogr_xplane_apt_reader.cp
>p~	2008-08-11 18:15:26.000000000 +0200 +++
> ./gdal-svn-trunk-2008.08.10/ogr/ogrsf_frmts/xplane/ogr_xplane_apt_reader.cp
>p	2008-08-11 18:15:26.000000000 +0200 @@ -420,7 +420,7 @@
>          int abReil[2];
>
>          int num1 = atoi(pszRwyNum);
> -        int num2 = (num1 < 18) ? num1 + 18 : num1 - 18;
> +        int num2 = (num1 > 18) ? num1 - 18 : num1 + 18;
>          if (pszRwyNum[2] == '0' || pszRwyNum[2] == 'x')
>          {
>              aosRwyNum[0].Printf("%02d", num1);
>
>
> Please note that I have been looking at the runway threshold names only !!
> I'm pretty convinced there are more places (in the same file) where a
> similar patch should get applied, most of these look something like:
>
>   dfTrueHeading : (dfTrueHeading < 180) ? dfTrueHeading + 180 :
> dfTrueHeading - 180
>
> Because I don't know I in which output table to cross-check the
> respective results, I decided to leave these unchanged.
> Please to me the honour of applying at least this single patch.
>
> Thanks,
> 	Martin.


From nikos.alexandris at felis.uni-freiburg.de  Mon Aug 18 16:19:22 2008
From: nikos.alexandris at felis.uni-freiburg.de (Nikos Alexandris)
Date: Mon Aug 18 16:19:30 2008
Subject: [gdal-dev] QGIS looses toolbar icons after changing background
	color
In-Reply-To: <48A9BB95.2090002@loskot.net>
References: <1219010814.21599.4.camel@vertical> <48A9BB95.2090002@loskot.net>
Message-ID: <1219090762.9346.0.camel@vertical>

On Mon, 2008-08-18 at 20:12 +0200, Mateusz Loskot wrote:
> Nikos Alexandris wrote:
> > Dear QGIS-users and developers,
> > I 've come across this strange behaviour: Settings > Background Color
> > (change color to anything) > OK. The result is that all toolbar icons
> > disappear, only text is shown for each button!
> > 
> > QGIS 0.11.0-Metis under Ubuntu Hardy 64-bit (with GRASS 6.4.svn)
> 
> Nikos,
> 
> FYI, you've sent your message to gdal-dev mailing list which is not
> related in any way to core Quantum GIS development.
> 
> Best regards,

That message was not meant to arrive in gdal-dev list. Apologies for the
traffic.

Best regards, Nikos

From klokan at klokan.cz  Mon Aug 18 16:23:44 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Mon Aug 18 16:23:47 2008
Subject: [gdal-dev] 
	GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection Web,
	Source Code
Message-ID: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>

Hello everybody,

what was done recently on GDAL2Tiles project:

New cool example of the map generated by GDAL2Tiles:
----------------------------------------------------------------------------------
I processed freely available USGS DRG map of Grand Canyon by
GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:

http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml

Source Code:
--------------------
- Fully functional source code for generating Google Maps tiles is in
my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
The code was refactored a lot and it is almost prepared for merging to
stable svn trunk gdal2tiles.py, but some coding is still needed. I am
going to work on it during the next week.

- I split the code into three files: 'gdal2tiles.py' (the main command
line utility), then 'globalmaptiles.py' (classes for global
mercator/geodetic tile bounds calculation, runs as command line
utility too), and supporting module 'templates.py' with sample HTML
viewers and base for generated XML files.

- Implementation of several resampling algorithms for controlling the
quality of tile rendering. Default is 'average' used in the GDAL's
overview functionality. Complete list is:
'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
The last one is high quality Lanczos based antialiasing algorithm, but
you will need Python Image Library for that.
Quality of the tile rendering is excellent I think. If you need it,
the simple and fast 'near' it is still available.

- GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
based Overlay viewer and KML files for Google Earth.

- The utility automatically warp the raster to Google Maps projection
(EPSG:900913) by AutoCreateWarpedVRT().

- For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
like to automate this step).

The code is NOT YET READY for production use (now supports only RGBA -
4 bands - source files for example), so I recommend you to wait for
merged version which will appear in the GDAL trunk. I will send a note
when I will finish the merging.

Documetation & MapTiler.org
------------------------------------------

- I decided to create a special website for distributing binary
installer and user-friendly GUI for GDAL2Tiles. I plan to develop
wxWidget based GUI a la step by step wizard. The user-friendly project
has name MapTiler, http://www.MapTiler.org/. Right now this web is
used only for documentation on for raster files for templates, which I
did not want to distribute with utility.

I received great feedback from several users and realized that
GDAL2Tiles utility is expected by community. That pushed me to crete
this new project and change the name to MapTiler, which is more
straightforward and fits to the utility probably better, especially
for users who are not familiar with GDAL tools yet.
GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
will implement just GUI and binary distribution.

It would be great to have blessing of OSGEO for this project, I would
prefer to not make separate SVN repository for such small project,
better to keep it as part of GDAL. Would it be possible? Otherwise I
will create Google Code project.

- I studied the OpenGIS proposal for WMTS standard, which is related
to TMS and I plan to send some comments to that standard. Is there
still free OSGEO slot for OpenGIS membership?

- I created a website about Spherical Mercator and Google Maps
Projection and Coordinate system, for anybody who is interested to see
the math behind tiles:
http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/

Question to community:
----------------------------------

- Would it be possible to keep more files separately even in the main
GDAL tree or the utility really have to be merged to one file?

- Is there anybody in the OpenLayers community who whould like to have
a look at the Opacity Control for OL? I prepared the bitmaps. Is there
any need on the OpenLayers templates? Now I am using /dev/ tree of
OpenLayers as Virtual Earth support is broken in the stable tree
(Safari for example).

- Does anybody know how to correctly set the KML SuperOverlay
maxlodpixels and fadeextents so transparency and opacity runs well and
tiles are not disappearing in Google Earth?

- Is anybody interested to help me with developing MapTiler (for
example compilation of latest GDAL with all modules, preparing of
Windows installer, help with wxPython...)
KyngChaos (thank you!) already had a look at binaries for MacOSX, but
we did not moved far yet as I need some functionality from 1.6dev.

Thanks belong to everybody who gave me excellent advices on #gdal IRC,
especially to 'FrankW' and 'even'.

BTW I am looking for an interesting job or paid projects... any offers? ;-)

Is there anybody who would like to support further development of
MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
of produced tiles with existing tile tree, support for MapCruncher
tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
better usage of threads on multi-core processors, driver for remote
online TMS tiles for GDAL/MapServer to allow WMS from statically
published tiles, etc..).

Best regards...

Klokan Petr Pridal
From nbarker at ittvis.com  Mon Aug 18 16:47:22 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Mon Aug 18 16:47:25 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>	<20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>

Having spent some more time on this, is adding progressive support to
gdal as simple as overloading the RasterIO function

http://www.gdal.org/classGDALDataset.html#e077c53268d2272eebed10b891a057
43

and adding a callback function?  I would like to standardize this if
possible in the GDALDataset class.

Thanks,

Norman

-----Original Message-----
From: Norman Barker 
Sent: Thursday, August 14, 2008 2:51 PM
To: gdal-dev@lists.osgeo.org
Subject: progressive rendering

Hi,

I am interested in discussing (and perhaps we can brainstorm on IRC, or
on the GDAL wiki) how to add generic progressive format support to GDAL.

In particular if we could create a generic interface so that commercial
and open source streaming client engines could be hooked in.

I have a lot of experience in writing jpip clients, and am interested in
creating this interface.  

I would suggest we need a callback handler, but we need to incorporate
the parameters req'd by ecwp, progressive jpeg and jpeg2000.

Hopefully others are interested too and perhaps have already thought of
the interfaces that we can add to GDAL?

I am trying to avoid the original way of doing jpip with gdal (before it
was disabled :-) ) of a one-shot jpip request, to a more dynamic raster
support.

Just to add to the scope this interface would ideally be exposed via
swig to allow java and jpip clients.

Any thoughts appreciated, and if you can advise of an appropriate place
to capture this (wiki?).

Many thanks,

Norman Barker
From guillaume.sueur at neogeo-online.net  Mon Aug 18 17:06:37 2008
From: guillaume.sueur at neogeo-online.net (Guillaume Sueur)
Date: Mon Aug 18 17:06:41 2008
Subject: [gdal-dev] 	GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection
	Web,	Source Code
In-Reply-To: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
Message-ID: <48A9E45D.8010002@neogeo-online.net>

That's an awesome job actually Klokan ! Thanks for these enhancements.

Just a question after a quick look at the doc : can the input file be a
raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
fur web publication are sometimes already tiled in several pieces
because of their size.

Best regards,

Guillaume

Klokan Petr P?idal a ?crit :
> Hello everybody,
> 
> what was done recently on GDAL2Tiles project:
> 
> New cool example of the map generated by GDAL2Tiles:
> ----------------------------------------------------------------------------------
> I processed freely available USGS DRG map of Grand Canyon by
> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
> 
> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
> 
> Source Code:
> --------------------
> - Fully functional source code for generating Google Maps tiles is in
> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
> The code was refactored a lot and it is almost prepared for merging to
> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
> going to work on it during the next week.
> 
> - I split the code into three files: 'gdal2tiles.py' (the main command
> line utility), then 'globalmaptiles.py' (classes for global
> mercator/geodetic tile bounds calculation, runs as command line
> utility too), and supporting module 'templates.py' with sample HTML
> viewers and base for generated XML files.
> 
> - Implementation of several resampling algorithms for controlling the
> quality of tile rendering. Default is 'average' used in the GDAL's
> overview functionality. Complete list is:
> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
> The last one is high quality Lanczos based antialiasing algorithm, but
> you will need Python Image Library for that.
> Quality of the tile rendering is excellent I think. If you need it,
> the simple and fast 'near' it is still available.
> 
> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
> based Overlay viewer and KML files for Google Earth.
> 
> - The utility automatically warp the raster to Google Maps projection
> (EPSG:900913) by AutoCreateWarpedVRT().
> 
> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
> like to automate this step).
> 
> The code is NOT YET READY for production use (now supports only RGBA -
> 4 bands - source files for example), so I recommend you to wait for
> merged version which will appear in the GDAL trunk. I will send a note
> when I will finish the merging.
> 
> Documetation & MapTiler.org
> ------------------------------------------
> 
> - I decided to create a special website for distributing binary
> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
> wxWidget based GUI a la step by step wizard. The user-friendly project
> has name MapTiler, http://www.MapTiler.org/. Right now this web is
> used only for documentation on for raster files for templates, which I
> did not want to distribute with utility.
> 
> I received great feedback from several users and realized that
> GDAL2Tiles utility is expected by community. That pushed me to crete
> this new project and change the name to MapTiler, which is more
> straightforward and fits to the utility probably better, especially
> for users who are not familiar with GDAL tools yet.
> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
> will implement just GUI and binary distribution.
> 
> It would be great to have blessing of OSGEO for this project, I would
> prefer to not make separate SVN repository for such small project,
> better to keep it as part of GDAL. Would it be possible? Otherwise I
> will create Google Code project.
> 
> - I studied the OpenGIS proposal for WMTS standard, which is related
> to TMS and I plan to send some comments to that standard. Is there
> still free OSGEO slot for OpenGIS membership?
> 
> - I created a website about Spherical Mercator and Google Maps
> Projection and Coordinate system, for anybody who is interested to see
> the math behind tiles:
> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
> 
> Question to community:
> ----------------------------------
> 
> - Would it be possible to keep more files separately even in the main
> GDAL tree or the utility really have to be merged to one file?
> 
> - Is there anybody in the OpenLayers community who whould like to have
> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
> any need on the OpenLayers templates? Now I am using /dev/ tree of
> OpenLayers as Virtual Earth support is broken in the stable tree
> (Safari for example).
> 
> - Does anybody know how to correctly set the KML SuperOverlay
> maxlodpixels and fadeextents so transparency and opacity runs well and
> tiles are not disappearing in Google Earth?
> 
> - Is anybody interested to help me with developing MapTiler (for
> example compilation of latest GDAL with all modules, preparing of
> Windows installer, help with wxPython...)
> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
> we did not moved far yet as I need some functionality from 1.6dev.
> 
> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
> especially to 'FrankW' and 'even'.
> 
> BTW I am looking for an interesting job or paid projects... any offers? ;-)
> 
> Is there anybody who would like to support further development of
> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
> of produced tiles with existing tile tree, support for MapCruncher
> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
> better usage of threads on multi-core processors, driver for remote
> online TMS tiles for GDAL/MapServer to allow WMS from statically
> published tiles, etc..).
> 
> Best regards...
> 
> Klokan Petr Pridal
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

From craig.miller at spatialminds.com  Mon Aug 18 17:30:51 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Mon Aug 18 17:31:57 2008
Subject: [gdal-dev] 	GSoC GDAL2Tiles: MapTiler.org,
	Google Maps Projection	Web, Source Code
In-Reply-To: <48A9E45D.8010002@neogeo-online.net>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
	<48A9E45D.8010002@neogeo-online.net>
Message-ID: <016101c90179$b059b730$110d2590$@miller@spatialminds.com>

Nice work.  Looks great.

Can a bounding box for the input image be specified so the collar will be trimmed prior to creating the tile images?

Craig

-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Guillaume Sueur
Sent: Monday, August 18, 2008 2:07 PM
To: Klokan Petr P?idal
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection Web, Source Code

That's an awesome job actually Klokan ! Thanks for these enhancements.

Just a question after a quick look at the doc : can the input file be a
raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
fur web publication are sometimes already tiled in several pieces
because of their size.

Best regards,

Guillaume

Klokan Petr P?idal a ?crit :
> Hello everybody,
> 
> what was done recently on GDAL2Tiles project:
> 
> New cool example of the map generated by GDAL2Tiles:
> ----------------------------------------------------------------------------------
> I processed freely available USGS DRG map of Grand Canyon by
> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
> 
> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
> 
> Source Code:
> --------------------
> - Fully functional source code for generating Google Maps tiles is in
> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
> The code was refactored a lot and it is almost prepared for merging to
> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
> going to work on it during the next week.
> 
> - I split the code into three files: 'gdal2tiles.py' (the main command
> line utility), then 'globalmaptiles.py' (classes for global
> mercator/geodetic tile bounds calculation, runs as command line
> utility too), and supporting module 'templates.py' with sample HTML
> viewers and base for generated XML files.
> 
> - Implementation of several resampling algorithms for controlling the
> quality of tile rendering. Default is 'average' used in the GDAL's
> overview functionality. Complete list is:
> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
> The last one is high quality Lanczos based antialiasing algorithm, but
> you will need Python Image Library for that.
> Quality of the tile rendering is excellent I think. If you need it,
> the simple and fast 'near' it is still available.
> 
> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
> based Overlay viewer and KML files for Google Earth.
> 
> - The utility automatically warp the raster to Google Maps projection
> (EPSG:900913) by AutoCreateWarpedVRT().
> 
> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
> like to automate this step).
> 
> The code is NOT YET READY for production use (now supports only RGBA -
> 4 bands - source files for example), so I recommend you to wait for
> merged version which will appear in the GDAL trunk. I will send a note
> when I will finish the merging.
> 
> Documetation & MapTiler.org
> ------------------------------------------
> 
> - I decided to create a special website for distributing binary
> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
> wxWidget based GUI a la step by step wizard. The user-friendly project
> has name MapTiler, http://www.MapTiler.org/. Right now this web is
> used only for documentation on for raster files for templates, which I
> did not want to distribute with utility.
> 
> I received great feedback from several users and realized that
> GDAL2Tiles utility is expected by community. That pushed me to crete
> this new project and change the name to MapTiler, which is more
> straightforward and fits to the utility probably better, especially
> for users who are not familiar with GDAL tools yet.
> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
> will implement just GUI and binary distribution.
> 
> It would be great to have blessing of OSGEO for this project, I would
> prefer to not make separate SVN repository for such small project,
> better to keep it as part of GDAL. Would it be possible? Otherwise I
> will create Google Code project.
> 
> - I studied the OpenGIS proposal for WMTS standard, which is related
> to TMS and I plan to send some comments to that standard. Is there
> still free OSGEO slot for OpenGIS membership?
> 
> - I created a website about Spherical Mercator and Google Maps
> Projection and Coordinate system, for anybody who is interested to see
> the math behind tiles:
> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
> 
> Question to community:
> ----------------------------------
> 
> - Would it be possible to keep more files separately even in the main
> GDAL tree or the utility really have to be merged to one file?
> 
> - Is there anybody in the OpenLayers community who whould like to have
> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
> any need on the OpenLayers templates? Now I am using /dev/ tree of
> OpenLayers as Virtual Earth support is broken in the stable tree
> (Safari for example).
> 
> - Does anybody know how to correctly set the KML SuperOverlay
> maxlodpixels and fadeextents so transparency and opacity runs well and
> tiles are not disappearing in Google Earth?
> 
> - Is anybody interested to help me with developing MapTiler (for
> example compilation of latest GDAL with all modules, preparing of
> Windows installer, help with wxPython...)
> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
> we did not moved far yet as I need some functionality from 1.6dev.
> 
> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
> especially to 'FrankW' and 'even'.
> 
> BTW I am looking for an interesting job or paid projects... any offers? ;-)
> 
> Is there anybody who would like to support further development of
> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
> of produced tiles with existing tile tree, support for MapCruncher
> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
> better usage of threads on multi-core processors, driver for remote
> online TMS tiles for GDAL/MapServer to allow WMS from statically
> published tiles, etc..).
> 
> Best regards...
> 
> Klokan Petr Pridal
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

No virus found in this incoming message.
Checked by AVG - http://www.avg.com 
Version: 8.0.138 / Virus Database: 270.6.5/1618 - Release Date: 8/18/2008 6:51 AM



From szekerest at gmail.com  Mon Aug 18 18:03:05 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Mon Aug 18 18:03:08 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
Message-ID: <f3b73b7d0808181503k12fb1d5av9b4ef482a4c2ba72@mail.gmail.com>

Norman,

It seems like adding a GDALProgressFunc like parameter to RasterIO
would be a solution but I'm not totally sure about the negaive effects
of this change since these functions are frequently used.

Most of the drivers are doing band based rasterIO so you should also
deal with Band.RasterIO in addition. The default implementation of
GDALDataset::IRasterIO is calling the band based rasterIO functions of
the drivers. In such cases how the progress func. of the band based
raserIO would be bound to the progress func of the outer dataset?

I would also be curious to know how the underlying intermediary data
should be stored and would vary between the subsequent progress
reports. For example would the raster X and Y size be different or
would it be handed as a temporary buffers and datasets or bands (like
overviews) for example?

Best regards,

Tamas
From plists at prometheus.org.yu  Mon Aug 18 19:43:57 2008
From: plists at prometheus.org.yu (Attila Csipa)
Date: Mon Aug 18 19:42:21 2008
Subject: [gdal-dev] encodings, locales ?
Message-ID: <200808190143.57799.plists@prometheus.org.yu>

Just being curious as to what the current status on encoding/locale support is 
in GDAL/OGR ? I've seen RFC-23 (and 5), but I'm curious as to which drivers 
support this currently or at least in known development phase (as their 
implementation is listed as 'on demand' in the RFC). Also, is there plan for 
doing proper localization or is it just internationalization for now ?
From mateusz at loskot.net  Mon Aug 18 19:50:18 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon Aug 18 19:50:30 2008
Subject: [gdal-dev] encodings, locales ?
In-Reply-To: <200808190143.57799.plists@prometheus.org.yu>
References: <200808190143.57799.plists@prometheus.org.yu>
Message-ID: <48AA0ABA.6000005@loskot.net>

Attila Csipa wrote:
> Just being curious as to what the current status on encoding/locale support is 
> in GDAL/OGR ? I've seen RFC-23 (and 5), but I'm curious as to which drivers 
> support this currently or at least in known development phase (as their 
> implementation is listed as 'on demand' in the RFC).

Some bits of the RFC-23 implementation has been already
submitted to the  SVN trunk. Try this queries to find detailed changesets:

http://trac.osgeo.org/gdal/search?q=RFC23&noquickjump=1&changeset=on
http://trac.osgeo.org/gdal/search?q=RFC+23&noquickjump=1&changeset=on

> Also, is there plan for 
> doing proper localization or is it just internationalization for now ?

Could you explain what you mean as "proper localization" and what is 
missing in the RFC-23 that would make it "proper"?

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From nbarker at ittvis.com  Mon Aug 18 20:06:32 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Mon Aug 18 20:30:29 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<f3b73b7d0808181503k12fb1d5av9b4ef482a4c2ba72@mail.gmail.com>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B477@gemini.rsinc.com>

Tamas,

Thanks for the input, much appreciated since I would like to get this
interface defined.

A streaming driver so JPIPKAK for example would need to register as its
own driver to handle urls of the type jpip://, similarly ecwp would need
its own driver if it were to use the same callback for streaming data.
As such the management of GDALDataset::RasterIO and Band.RasterIO would
be the implementors responsibility, most likely this could be defined
with references back to the parent dataset as the controller thread.

The comment about raster x and y size is interesting, in the case of
jpip raster x and y size is known as a result of the image metadata
being transferred to the client in the initial request and can be
handled as overviews, for other formats like MrSID, ECW then I defer to
the better informed.

JPIP does have a client cache, and this data is needed between requests,
but I believe we can keep this data internal to the format driver.

Would it be possible to add this callback function as a stub method?

Thanks,

Norman

-----Original Message-----
From: Tamas Szekeres [mailto:szekerest@gmail.com] 
Sent: Monday, August 18, 2008 4:03 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman,

It seems like adding a GDALProgressFunc like parameter to RasterIO
would be a solution but I'm not totally sure about the negaive effects
of this change since these functions are frequently used.

Most of the drivers are doing band based rasterIO so you should also
deal with Band.RasterIO in addition. The default implementation of
GDALDataset::IRasterIO is calling the band based rasterIO functions of
the drivers. In such cases how the progress func. of the band based
raserIO would be bound to the progress func of the outer dataset?

I would also be curious to know how the underlying intermediary data
should be stored and would vary between the subsequent progress
reports. For example would the raster X and Y size be different or
would it be handed as a temporary buffers and datasets or bands (like
overviews) for example?

Best regards,

Tamas
From 27949218 at qq.com  Mon Aug 18 21:13:16 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Mon Aug 18 21:13:22 2008
Subject: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;
Message-ID: <tencent_243003554CB96A303E0638E9@qq.com>

Hi,  Frank, welcome to China. I'd like to see you in Beijing, i'm sure that you're the  joss of many young students, hehe.
   I have found the reason why  failed to deal styles with ver1.5.2. Compared  with ver1.4.1,   CPLSPrintf() is replaced the CPLString().Printf()  , and i could trace the error to CPLString().Printf() every time debug. It might not allocate memory for the dest string in CPLString().Printf(). Of cource, if i still use CPLSPrintf(), no error occurs. Is this a bug in whole OGRFeatureStyle.cpp in ver1.5.2? 
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia

  
  
 ------------------ Original ------------------
  From:  "Frank Warmerdam"<warmerdam@pobox.com>;
 Date:  Mon, Aug 18, 2008 11:12 PM
 To:  "wow"<27949218@qq.com>; 
 Cc:  "gdal-dev"<gdal-dev@lists.osgeo.org>; 
 Subject:  Re: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;

  
 On 8/17/08, wow <27949218@qq.com> wrote:
> Hi,
>   When i tried to update my whole program from ver1.4.1 to 1.5.2, all worked
> well except the  OGRFeatureStyle  module. The function
> OGRStyleMgr::AddStyle() couldn't write the provided style
> name and style string right with ver1.5.2, but could run smoothly with
> version 1.4.1.
>   My code :

Chen,

There has been some work on the style string parser since 1.4 and
I suspect it has been subtly broken for your case in some fashion.
Could you file a ticket?  Make sure you provide any additional
details we might need, like the format you are trying to write to.

Ideally a single small self contained program demonstrating the
problem would be best.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080819/7cc667b8/attachment.html
From 27949218 at qq.com  Mon Aug 18 21:33:14 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Mon Aug 18 21:33:20 2008
Subject: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;
Message-ID: <tencent_6A1D0F341FF686B647DD9346@qq.com>

Frank, this is my example for you to test the ver1.5.2 OGRFeatureStyle.cpp. Thank you.
 //-------------------------------CODE----------------------------------------------------------
     bool CreateDefaultStyle("shpcreate\\1.tbl", 2);
     void main()
   {
    bool res = CreateDefaultStyle("shpcreate\\1.tbl", 2);
   }
  
 bool CreateDefaultStyle(CString strTlbPath, int nType)
{ 
      OGRStyleTable oStyleTable;
      OGRStyleMgr   *poStyleMgr = new OGRStyleMgr(&oStyleTable);
      bool res;
      switch(nType)
     {
          case 1:            //point
          {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#FFFF00,f:\"MS Gothic\",s:10px,t:\"\",l:1)");
            res = oStyleTable.SaveStyleTable(strTlbPath);
          }
           break;
         case 2:              //line
         {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");//
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#0000FF,f:\"MS Gothic\",s:10px,t:\"\",l:1)");//
            res = poStyleMgr->AddStyle("@line", "PEN(c:#FF0000,w:3px,id:\"swL0\",l:1)");//
            res = oStyleTable.SaveStyleTable(strTlbPath); 
         }
           break;
        case 3:              //polygon
        {
            res = poStyleMgr->AddStyle("@symbol", "SYMBOL(c:#00FF00,id:\"swS0\",s:1.0,l:1)");
            res = poStyleMgr->AddStyle("@label", "LABEL(c:#FF0000,f:\"MS Gothic\",s:10px,t:\"\",l:1)");
            res = poStyleMgr->AddStyle("@line", "PEN(c:#FF0000,w:3px,id:\"swL0\",l:1)");
            res = poStyleMgr->AddStyle("@brush", "BRUSH(fc:#C0C0C0,id:\"swR0\")");
            res = oStyleTable.SaveStyleTable(strTlbPath); 
        }
           break;
      default:
           break;
    }
   if(poStyleMgr)
    {
     delete poStyleMgr;
     poStyleMgr = NULL;
     }
  if(!res)
  {
     return false;
  }
  return true;
}
 //--------------------------------END----------------------------------------------------------
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia

  
  
 ------------------ Original ------------------
  From:  "wow"<27949218@qq.com>;
 Date:  Tue, Aug 19, 2008 09:13 AM
 To:  "Frank Warmerdam"<warmerdam@pobox.com>; 
 Cc:  "gdal-dev"<gdal-dev@lists.osgeo.org>; 
 Subject:  Re: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;

  
  Hi,  Frank, welcome to China. I'd like to see you in Beijing, i'm sure that you're the  joss of many young students, hehe.
   I have found the reason why  failed to deal styles with ver1.5.2. Compared  with ver1.4.1,   CPLSPrintf() is replaced the CPLString().Printf()  , and i could trace the error to CPLString().Printf() every time debug. It might not allocate memory for the dest string in CPLString().Printf(). Of cource, if i still use CPLSPrintf(), no error occurs. Is this a bug in whole OGRFeatureStyle.cpp in ver1.5.2? 
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia

  
  
 ------------------ Original ------------------
  From:  "Frank Warmerdam"<warmerdam@pobox.com>;
 Date:  Mon, Aug 18, 2008 11:12 PM
 To:  "wow"<27949218@qq.com>; 
 Cc:  "gdal-dev"<gdal-dev@lists.osgeo.org>; 
 Subject:  Re: [gdal-dev] OGRFeatureStyle update from version1.4.1 to 1.5.2;

  
 On 8/17/08, wow <27949218@qq.com> wrote:
> Hi,
>   When i tried to update my whole program from ver1.4.1 to 1.5.2, all worked
> well except the  OGRFeatureStyle  module. The function
> OGRStyleMgr::AddStyle() couldn't write the provided style
> name and style string right with ver1.5.2, but could run smoothly with
> version 1.4.1.
>   My code :

Chen,

There has been some work on the style string parser since 1.4 and
I suspect it has been subtly broken for your case in some fashion.
Could you file a ticket?  Make sure you provide any additional
details we might need, like the format you are trying to write to.

Ideally a single small self contained program demonstrating the
problem would be best.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080819/3aa10c22/attachment-0001.html
From 27949218 at qq.com  Tue Aug 19 02:36:04 2008
From: 27949218 at qq.com (=?ISO-8859-1?B?d293?=)
Date: Tue Aug 19 02:36:32 2008
Subject: [gdal-dev] Does OGRLayer::CreateField() suport UNICODE in ver1.4.1 ?
Message-ID: <tencent_6BAC406D0BFFFD9014CBE25B@qq.com>

Hi, When i call  OGRLayer::CreateField() to create a field with a Chinese name[UNICODE], i got errors. The driver is ESRI shape. Does OGRLayer::CreateField() suport UNICODE in ver1.4.1 ?
  
 ------------------
  To the world you're little, but to a person you're the world.
                                             Chen Xuexia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080819/4a50abc1/attachment.html
From klokan at klokan.cz  Tue Aug 19 02:39:16 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Tue Aug 19 02:39:19 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org,
	Google Maps Projection Web, Source Code
In-Reply-To: <48A9E45D.8010002@neogeo-online.net>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
	<48A9E45D.8010002@neogeo-online.net>
Message-ID: <6e41d95b0808182339k3b7f2858ub43d3e88aafc3969@mail.gmail.com>

Hi Guillaume,

Thank you for positive feedback ;-)

> Just a question after a quick look at the doc : can the input file be a
> raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
> fur web publication are sometimes already tiled in several pieces
> because of their size.

I don't think you can use gdaltindex with other gdal tools (like
gdal_transform) either.
gdaltindex is used by UNM MapServer but not by other GDAL tools, as I know.

You would need to use VRT for combining several rasters into one...
Use gdal_vrtmerge.py, it has similar syntax like gdaltindex. It is in
the source under /swig/python/samples/.
Result can be passed then to gdal2tiles and it should run well I hope.

Is there any plan to merge gdal_vrtmerge into "gdal_merge -of VRT"?

Best regards

Klokan

> Best regards,
>
> Guillaume
>
> Klokan Petr P?idal a ?crit :
>> Hello everybody,
>>
>> what was done recently on GDAL2Tiles project:
>>
>> New cool example of the map generated by GDAL2Tiles:
>> ----------------------------------------------------------------------------------
>> I processed freely available USGS DRG map of Grand Canyon by
>> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
>>
>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
>>
>> Source Code:
>> --------------------
>> - Fully functional source code for generating Google Maps tiles is in
>> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
>> The code was refactored a lot and it is almost prepared for merging to
>> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
>> going to work on it during the next week.
>>
>> - I split the code into three files: 'gdal2tiles.py' (the main command
>> line utility), then 'globalmaptiles.py' (classes for global
>> mercator/geodetic tile bounds calculation, runs as command line
>> utility too), and supporting module 'templates.py' with sample HTML
>> viewers and base for generated XML files.
>>
>> - Implementation of several resampling algorithms for controlling the
>> quality of tile rendering. Default is 'average' used in the GDAL's
>> overview functionality. Complete list is:
>> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
>> The last one is high quality Lanczos based antialiasing algorithm, but
>> you will need Python Image Library for that.
>> Quality of the tile rendering is excellent I think. If you need it,
>> the simple and fast 'near' it is still available.
>>
>> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
>> based Overlay viewer and KML files for Google Earth.
>>
>> - The utility automatically warp the raster to Google Maps projection
>> (EPSG:900913) by AutoCreateWarpedVRT().
>>
>> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
>> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
>> like to automate this step).
>>
>> The code is NOT YET READY for production use (now supports only RGBA -
>> 4 bands - source files for example), so I recommend you to wait for
>> merged version which will appear in the GDAL trunk. I will send a note
>> when I will finish the merging.
>>
>> Documetation & MapTiler.org
>> ------------------------------------------
>>
>> - I decided to create a special website for distributing binary
>> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
>> wxWidget based GUI a la step by step wizard. The user-friendly project
>> has name MapTiler, http://www.MapTiler.org/. Right now this web is
>> used only for documentation on for raster files for templates, which I
>> did not want to distribute with utility.
>>
>> I received great feedback from several users and realized that
>> GDAL2Tiles utility is expected by community. That pushed me to crete
>> this new project and change the name to MapTiler, which is more
>> straightforward and fits to the utility probably better, especially
>> for users who are not familiar with GDAL tools yet.
>> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
>> will implement just GUI and binary distribution.
>>
>> It would be great to have blessing of OSGEO for this project, I would
>> prefer to not make separate SVN repository for such small project,
>> better to keep it as part of GDAL. Would it be possible? Otherwise I
>> will create Google Code project.
>>
>> - I studied the OpenGIS proposal for WMTS standard, which is related
>> to TMS and I plan to send some comments to that standard. Is there
>> still free OSGEO slot for OpenGIS membership?
>>
>> - I created a website about Spherical Mercator and Google Maps
>> Projection and Coordinate system, for anybody who is interested to see
>> the math behind tiles:
>> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
>>
>> Question to community:
>> ----------------------------------
>>
>> - Would it be possible to keep more files separately even in the main
>> GDAL tree or the utility really have to be merged to one file?
>>
>> - Is there anybody in the OpenLayers community who whould like to have
>> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
>> any need on the OpenLayers templates? Now I am using /dev/ tree of
>> OpenLayers as Virtual Earth support is broken in the stable tree
>> (Safari for example).
>>
>> - Does anybody know how to correctly set the KML SuperOverlay
>> maxlodpixels and fadeextents so transparency and opacity runs well and
>> tiles are not disappearing in Google Earth?
>>
>> - Is anybody interested to help me with developing MapTiler (for
>> example compilation of latest GDAL with all modules, preparing of
>> Windows installer, help with wxPython...)
>> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
>> we did not moved far yet as I need some functionality from 1.6dev.
>>
>> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
>> especially to 'FrankW' and 'even'.
>>
>> BTW I am looking for an interesting job or paid projects... any offers? ;-)
>>
>> Is there anybody who would like to support further development of
>> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
>> of produced tiles with existing tile tree, support for MapCruncher
>> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
>> better usage of threads on multi-core processors, driver for remote
>> online TMS tiles for GDAL/MapServer to allow WMS from statically
>> published tiles, etc..).
>>
>> Best regards...
>>
>> Klokan Petr Pridal
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
From klokan at klokan.cz  Tue Aug 19 02:55:44 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Tue Aug 19 02:55:48 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org,
	Google Maps Projection Web, Source Code
In-Reply-To: <41970093611214945@unknownmsgid>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
	<48A9E45D.8010002@neogeo-online.net> <41970093611214945@unknownmsgid>
Message-ID: <6e41d95b0808182355u5891cd2fj9f8aa016e06fa1bf@mail.gmail.com>

Hi Craig,

For clipping you should use another GDAL tools before passing raster
to gdal2tiles for tile generation.

If you need to clip just by specifying bounding box in source
coordinates or raster coordinates you can use 'gdal_translate' on the
input raster and its parameters -srcwin or -projwin (probably with -of
VRT).

If you have shapefile of the mask, then use tool like 'gdal_rasterize'
to burn the mask into the alpha channel band.

Best regards

Klokan

On Mon, Aug 18, 2008 at 11:30 PM, Craig Miller
<craig.miller@spatialminds.com> wrote:
> Nice work.  Looks great.
>
> Can a bounding box for the input image be specified so the collar will be trimmed prior to creating the tile images?
>
> Craig
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Guillaume Sueur
> Sent: Monday, August 18, 2008 2:07 PM
> To: Klokan Petr P?idal
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection Web, Source Code
>
> That's an awesome job actually Klokan ! Thanks for these enhancements.
>
> Just a question after a quick look at the doc : can the input file be a
> raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
> fur web publication are sometimes already tiled in several pieces
> because of their size.
>
> Best regards,
>
> Guillaume
>
> Klokan Petr P?idal a ?crit :
>> Hello everybody,
>>
>> what was done recently on GDAL2Tiles project:
>>
>> New cool example of the map generated by GDAL2Tiles:
>> ----------------------------------------------------------------------------------
>> I processed freely available USGS DRG map of Grand Canyon by
>> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
>>
>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
>>
>> Source Code:
>> --------------------
>> - Fully functional source code for generating Google Maps tiles is in
>> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
>> The code was refactored a lot and it is almost prepared for merging to
>> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
>> going to work on it during the next week.
>>
>> - I split the code into three files: 'gdal2tiles.py' (the main command
>> line utility), then 'globalmaptiles.py' (classes for global
>> mercator/geodetic tile bounds calculation, runs as command line
>> utility too), and supporting module 'templates.py' with sample HTML
>> viewers and base for generated XML files.
>>
>> - Implementation of several resampling algorithms for controlling the
>> quality of tile rendering. Default is 'average' used in the GDAL's
>> overview functionality. Complete list is:
>> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
>> The last one is high quality Lanczos based antialiasing algorithm, but
>> you will need Python Image Library for that.
>> Quality of the tile rendering is excellent I think. If you need it,
>> the simple and fast 'near' it is still available.
>>
>> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
>> based Overlay viewer and KML files for Google Earth.
>>
>> - The utility automatically warp the raster to Google Maps projection
>> (EPSG:900913) by AutoCreateWarpedVRT().
>>
>> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
>> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
>> like to automate this step).
>>
>> The code is NOT YET READY for production use (now supports only RGBA -
>> 4 bands - source files for example), so I recommend you to wait for
>> merged version which will appear in the GDAL trunk. I will send a note
>> when I will finish the merging.
>>
>> Documetation & MapTiler.org
>> ------------------------------------------
>>
>> - I decided to create a special website for distributing binary
>> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
>> wxWidget based GUI a la step by step wizard. The user-friendly project
>> has name MapTiler, http://www.MapTiler.org/. Right now this web is
>> used only for documentation on for raster files for templates, which I
>> did not want to distribute with utility.
>>
>> I received great feedback from several users and realized that
>> GDAL2Tiles utility is expected by community. That pushed me to crete
>> this new project and change the name to MapTiler, which is more
>> straightforward and fits to the utility probably better, especially
>> for users who are not familiar with GDAL tools yet.
>> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
>> will implement just GUI and binary distribution.
>>
>> It would be great to have blessing of OSGEO for this project, I would
>> prefer to not make separate SVN repository for such small project,
>> better to keep it as part of GDAL. Would it be possible? Otherwise I
>> will create Google Code project.
>>
>> - I studied the OpenGIS proposal for WMTS standard, which is related
>> to TMS and I plan to send some comments to that standard. Is there
>> still free OSGEO slot for OpenGIS membership?
>>
>> - I created a website about Spherical Mercator and Google Maps
>> Projection and Coordinate system, for anybody who is interested to see
>> the math behind tiles:
>> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
>>
>> Question to community:
>> ----------------------------------
>>
>> - Would it be possible to keep more files separately even in the main
>> GDAL tree or the utility really have to be merged to one file?
>>
>> - Is there anybody in the OpenLayers community who whould like to have
>> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
>> any need on the OpenLayers templates? Now I am using /dev/ tree of
>> OpenLayers as Virtual Earth support is broken in the stable tree
>> (Safari for example).
>>
>> - Does anybody know how to correctly set the KML SuperOverlay
>> maxlodpixels and fadeextents so transparency and opacity runs well and
>> tiles are not disappearing in Google Earth?
>>
>> - Is anybody interested to help me with developing MapTiler (for
>> example compilation of latest GDAL with all modules, preparing of
>> Windows installer, help with wxPython...)
>> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
>> we did not moved far yet as I need some functionality from 1.6dev.
>>
>> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
>> especially to 'FrankW' and 'even'.
>>
>> BTW I am looking for an interesting job or paid projects... any offers? ;-)
>>
>> Is there anybody who would like to support further development of
>> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
>> of produced tiles with existing tile tree, support for MapCruncher
>> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
>> better usage of threads on multi-core processors, driver for remote
>> online TMS tiles for GDAL/MapServer to allow WMS from statically
>> published tiles, etc..).
>>
>> Best regards...
>>
>> Klokan Petr Pridal
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.5/1618 - Release Date: 8/18/2008 6:51 AM
>
>
>
>
From Martin.Spott at mgras.net  Tue Aug 19 03:49:56 2008
From: Martin.Spott at mgras.net (Martin Spott)
Date: Tue Aug 19 03:51:04 2008
Subject: [gdal-dev] Re: X-Plane runway orientation
References: <20080811163120.GA7349@jive.mgras.de>
	<200808182107.24827.even.rouault@mines-paris.org>
Message-ID: <g8dtv4$tlk$1@osprey.mgras.de>

Even Rouault wrote:

> I've applied your patch in r15154.

Ok, thanks,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------
From dkazimirov at issart.com  Tue Aug 19 04:16:54 2008
From: dkazimirov at issart.com (Dmitriy Kazimirov)
Date: Tue Aug 19 04:17:00 2008
Subject: [gdal-dev] GDAL 1.5.2 and GRIB2 support
Message-ID: <48AA8176.4070606@issart.com>

Hi,
Where GRIB2 support gone from 1.5.2?attempting to configure on Cygwin 
shows grib2 support no, grib directory is absent from frmts.
Which of last versions support GRIB2?

-- 
Best Regards,
Dmitriy Kazimirov,
Senior C#/C++ Developer
of ISS Art, Ltd., Omsk, Russia
Web: http://www.issart.com
E-mail: dkazimirov@issart.com 

From guillaume.sueur at neogeo-online.net  Tue Aug 19 04:31:44 2008
From: guillaume.sueur at neogeo-online.net (Guillaume Sueur)
Date: Tue Aug 19 04:31:55 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection
	Web, Source Code
In-Reply-To: <6e41d95b0808182339k3b7f2858ub43d3e88aafc3969@mail.gmail.com>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>	<48A9E45D.8010002@neogeo-online.net>
	<6e41d95b0808182339k3b7f2858ub43d3e88aafc3969@mail.gmail.com>
Message-ID: <48AA84F0.1000302@neogeo-online.net>

I'm talking about 10 to 100 GigaBytes datasets, with which it doesn't
seem reasonnable to generate a single merged file !

Couldn't gdal2tiles parse a whole directory ?

Thanks,

Guillaume

Klokan Petr P?idal a ?crit :
> Hi Guillaume,
> 
> Thank you for positive feedback ;-)
> 
>> Just a question after a quick look at the doc : can the input file be a
>> raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
>> fur web publication are sometimes already tiled in several pieces
>> because of their size.
> 
> I don't think you can use gdaltindex with other gdal tools (like
> gdal_transform) either.
> gdaltindex is used by UNM MapServer but not by other GDAL tools, as I know.
> 
> You would need to use VRT for combining several rasters into one...
> Use gdal_vrtmerge.py, it has similar syntax like gdaltindex. It is in
> the source under /swig/python/samples/.
> Result can be passed then to gdal2tiles and it should run well I hope.
> 
> Is there any plan to merge gdal_vrtmerge into "gdal_merge -of VRT"?
> 
> Best regards
> 
> Klokan
> 
>> Best regards,
>>
>> Guillaume
>>
>> Klokan Petr P?idal a ?crit :
>>> Hello everybody,
>>>
>>> what was done recently on GDAL2Tiles project:
>>>
>>> New cool example of the map generated by GDAL2Tiles:
>>> ----------------------------------------------------------------------------------
>>> I processed freely available USGS DRG map of Grand Canyon by
>>> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
>>>
>>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
>>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
>>>
>>> Source Code:
>>> --------------------
>>> - Fully functional source code for generating Google Maps tiles is in
>>> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
>>> The code was refactored a lot and it is almost prepared for merging to
>>> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
>>> going to work on it during the next week.
>>>
>>> - I split the code into three files: 'gdal2tiles.py' (the main command
>>> line utility), then 'globalmaptiles.py' (classes for global
>>> mercator/geodetic tile bounds calculation, runs as command line
>>> utility too), and supporting module 'templates.py' with sample HTML
>>> viewers and base for generated XML files.
>>>
>>> - Implementation of several resampling algorithms for controlling the
>>> quality of tile rendering. Default is 'average' used in the GDAL's
>>> overview functionality. Complete list is:
>>> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
>>> The last one is high quality Lanczos based antialiasing algorithm, but
>>> you will need Python Image Library for that.
>>> Quality of the tile rendering is excellent I think. If you need it,
>>> the simple and fast 'near' it is still available.
>>>
>>> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
>>> based Overlay viewer and KML files for Google Earth.
>>>
>>> - The utility automatically warp the raster to Google Maps projection
>>> (EPSG:900913) by AutoCreateWarpedVRT().
>>>
>>> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
>>> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
>>> like to automate this step).
>>>
>>> The code is NOT YET READY for production use (now supports only RGBA -
>>> 4 bands - source files for example), so I recommend you to wait for
>>> merged version which will appear in the GDAL trunk. I will send a note
>>> when I will finish the merging.
>>>
>>> Documetation & MapTiler.org
>>> ------------------------------------------
>>>
>>> - I decided to create a special website for distributing binary
>>> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
>>> wxWidget based GUI a la step by step wizard. The user-friendly project
>>> has name MapTiler, http://www.MapTiler.org/. Right now this web is
>>> used only for documentation on for raster files for templates, which I
>>> did not want to distribute with utility.
>>>
>>> I received great feedback from several users and realized that
>>> GDAL2Tiles utility is expected by community. That pushed me to crete
>>> this new project and change the name to MapTiler, which is more
>>> straightforward and fits to the utility probably better, especially
>>> for users who are not familiar with GDAL tools yet.
>>> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
>>> will implement just GUI and binary distribution.
>>>
>>> It would be great to have blessing of OSGEO for this project, I would
>>> prefer to not make separate SVN repository for such small project,
>>> better to keep it as part of GDAL. Would it be possible? Otherwise I
>>> will create Google Code project.
>>>
>>> - I studied the OpenGIS proposal for WMTS standard, which is related
>>> to TMS and I plan to send some comments to that standard. Is there
>>> still free OSGEO slot for OpenGIS membership?
>>>
>>> - I created a website about Spherical Mercator and Google Maps
>>> Projection and Coordinate system, for anybody who is interested to see
>>> the math behind tiles:
>>> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
>>>
>>> Question to community:
>>> ----------------------------------
>>>
>>> - Would it be possible to keep more files separately even in the main
>>> GDAL tree or the utility really have to be merged to one file?
>>>
>>> - Is there anybody in the OpenLayers community who whould like to have
>>> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
>>> any need on the OpenLayers templates? Now I am using /dev/ tree of
>>> OpenLayers as Virtual Earth support is broken in the stable tree
>>> (Safari for example).
>>>
>>> - Does anybody know how to correctly set the KML SuperOverlay
>>> maxlodpixels and fadeextents so transparency and opacity runs well and
>>> tiles are not disappearing in Google Earth?
>>>
>>> - Is anybody interested to help me with developing MapTiler (for
>>> example compilation of latest GDAL with all modules, preparing of
>>> Windows installer, help with wxPython...)
>>> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
>>> we did not moved far yet as I need some functionality from 1.6dev.
>>>
>>> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
>>> especially to 'FrankW' and 'even'.
>>>
>>> BTW I am looking for an interesting job or paid projects... any offers? ;-)
>>>
>>> Is there anybody who would like to support further development of
>>> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
>>> of produced tiles with existing tile tree, support for MapCruncher
>>> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
>>> better usage of threads on multi-core processors, driver for remote
>>> online TMS tiles for GDAL/MapServer to allow WMS from statically
>>> published tiles, etc..).
>>>
>>> Best regards...
>>>
>>> Klokan Petr Pridal
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From klokan at klokan.cz  Tue Aug 19 05:06:41 2008
From: klokan at klokan.cz (=?ISO-8859-2?Q?Klokan_Petr_P=F8idal?=)
Date: Tue Aug 19 05:06:45 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org,
	Google Maps Projection Web, Source Code
In-Reply-To: <48AA84F0.1000302@neogeo-online.net>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>
	<48A9E45D.8010002@neogeo-online.net>
	<6e41d95b0808182339k3b7f2858ub43d3e88aafc3969@mail.gmail.com>
	<48AA84F0.1000302@neogeo-online.net>
Message-ID: <6e41d95b0808190206v7da4ed36v71c12c4924a02e51@mail.gmail.com>

Hi,

> I'm talking about 10 to 100 GigaBytes datasets, with which it doesn't
> seem reasonnable to generate a single merged file !

In case you use -of VRT it should not be problem. VRT is just an XML
file telling where is each file placed and what processing is
necessary - so in fact there is not big logical difference between
gdal_vrtmerge's VRT and gdaltindex result (one is using XML another
shape file for storing the same kind of link to raster data).

The stable version of GDAL2Tiles is able to handle such huge raster
files without problems.

The new version (in my sandbox) is not tested properly. As I've
written before >it is not yet ready for production<. Before I merge it
with gdal-trunk I will do some test on a raster dataset with size over
30 GB as well...

In case you anyway have WMS server for raster data, you can use
TileCache.org or GeoWebCache.org to cache the tiles.
Advantage of GDAL2Tiles over TileCache is practically zero
configuration of any server software. The result from the user point
of view is almost equal.

BTW It would be also possible to write an extension of GDAL2Tiles for
saving of generated tiles directly into a database (SQL / Amazon S3 /
Google BigTable - App Engine) instead of having small PNG files on a
disk. TileCache and GDAL2Tiles are close to each other...

Klokan

On Tue, Aug 19, 2008 at 10:31 AM, Guillaume Sueur
<guillaume.sueur@neogeo-online.net> wrote:
> Klokan Petr P?idal a ?crit :
>> Hi Guillaume,
>>
>> Thank you for positive feedback ;-)
>>
>>> Just a question after a quick look at the doc : can the input file be a
>>> raster catalog (the gdaltindex thing) ? Raster data needing to be tiled
>>> fur web publication are sometimes already tiled in several pieces
>>> because of their size.
>>
>> I don't think you can use gdaltindex with other gdal tools (like
>> gdal_transform) either.
>> gdaltindex is used by UNM MapServer but not by other GDAL tools, as I know.
>>
>> You would need to use VRT for combining several rasters into one...
>> Use gdal_vrtmerge.py, it has similar syntax like gdaltindex. It is in
>> the source under /swig/python/samples/.
>> Result can be passed then to gdal2tiles and it should run well I hope.
>>
>> Is there any plan to merge gdal_vrtmerge into "gdal_merge -of VRT"?
>>
>> Best regards
>>
>> Klokan
>>
>>> Best regards,
>>>
>>> Guillaume
>>>
>>> Klokan Petr P?idal a ?crit :
>>>> Hello everybody,
>>>>
>>>> what was done recently on GDAL2Tiles project:
>>>>
>>>> New cool example of the map generated by GDAL2Tiles:
>>>> ----------------------------------------------------------------------------------
>>>> I processed freely available USGS DRG map of Grand Canyon by
>>>> GDAL2Tiles. It is a nice example of what GDAL2Tiles can generate:
>>>>
>>>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/
>>>> http://www.maptiler.org/example-usgs-drg-grand-canyon-gtiff/usgs-drg-grand-canyon.kml
>>>>
>>>> Source Code:
>>>> --------------------
>>>> - Fully functional source code for generating Google Maps tiles is in
>>>> my GDAL SVN sandbox (http://svn.osgeo.org/gdal/sandbox/klokan/).
>>>> The code was refactored a lot and it is almost prepared for merging to
>>>> stable svn trunk gdal2tiles.py, but some coding is still needed. I am
>>>> going to work on it during the next week.
>>>>
>>>> - I split the code into three files: 'gdal2tiles.py' (the main command
>>>> line utility), then 'globalmaptiles.py' (classes for global
>>>> mercator/geodetic tile bounds calculation, runs as command line
>>>> utility too), and supporting module 'templates.py' with sample HTML
>>>> viewers and base for generated XML files.
>>>>
>>>> - Implementation of several resampling algorithms for controlling the
>>>> quality of tile rendering. Default is 'average' used in the GDAL's
>>>> overview functionality. Complete list is:
>>>> 'average','near','bilinear','cubic','cubicspline','lanczos','antialias'.
>>>> The last one is high quality Lanczos based antialiasing algorithm, but
>>>> you will need Python Image Library for that.
>>>> Quality of the tile rendering is excellent I think. If you need it,
>>>> the simple and fast 'near' it is still available.
>>>>
>>>> - GDAL2Tiles generates the sample Google Maps Based viewer, OpenLayers
>>>> based Overlay viewer and KML files for Google Earth.
>>>>
>>>> - The utility automatically warp the raster to Google Maps projection
>>>> (EPSG:900913) by AutoCreateWarpedVRT().
>>>>
>>>> - For raster files with palette (USGS DRG, NOAA BSB, ...) a separate
>>>> VRT with "rasterize rgba" (GDAL 1.6dev) is recommended (later I would
>>>> like to automate this step).
>>>>
>>>> The code is NOT YET READY for production use (now supports only RGBA -
>>>> 4 bands - source files for example), so I recommend you to wait for
>>>> merged version which will appear in the GDAL trunk. I will send a note
>>>> when I will finish the merging.
>>>>
>>>> Documetation & MapTiler.org
>>>> ------------------------------------------
>>>>
>>>> - I decided to create a special website for distributing binary
>>>> installer and user-friendly GUI for GDAL2Tiles. I plan to develop
>>>> wxWidget based GUI a la step by step wizard. The user-friendly project
>>>> has name MapTiler, http://www.MapTiler.org/. Right now this web is
>>>> used only for documentation on for raster files for templates, which I
>>>> did not want to distribute with utility.
>>>>
>>>> I received great feedback from several users and realized that
>>>> GDAL2Tiles utility is expected by community. That pushed me to crete
>>>> this new project and change the name to MapTiler, which is more
>>>> straightforward and fits to the utility probably better, especially
>>>> for users who are not familiar with GDAL tools yet.
>>>> GDAL2Tiles will be maintained as GDAL command line utility. MapTiler
>>>> will implement just GUI and binary distribution.
>>>>
>>>> It would be great to have blessing of OSGEO for this project, I would
>>>> prefer to not make separate SVN repository for such small project,
>>>> better to keep it as part of GDAL. Would it be possible? Otherwise I
>>>> will create Google Code project.
>>>>
>>>> - I studied the OpenGIS proposal for WMTS standard, which is related
>>>> to TMS and I plan to send some comments to that standard. Is there
>>>> still free OSGEO slot for OpenGIS membership?
>>>>
>>>> - I created a website about Spherical Mercator and Google Maps
>>>> Projection and Coordinate system, for anybody who is interested to see
>>>> the math behind tiles:
>>>> http://www.maptiler.org/google-maps-coordinate-system-projection-epsg-900913-3785/
>>>>
>>>> Question to community:
>>>> ----------------------------------
>>>>
>>>> - Would it be possible to keep more files separately even in the main
>>>> GDAL tree or the utility really have to be merged to one file?
>>>>
>>>> - Is there anybody in the OpenLayers community who whould like to have
>>>> a look at the Opacity Control for OL? I prepared the bitmaps. Is there
>>>> any need on the OpenLayers templates? Now I am using /dev/ tree of
>>>> OpenLayers as Virtual Earth support is broken in the stable tree
>>>> (Safari for example).
>>>>
>>>> - Does anybody know how to correctly set the KML SuperOverlay
>>>> maxlodpixels and fadeextents so transparency and opacity runs well and
>>>> tiles are not disappearing in Google Earth?
>>>>
>>>> - Is anybody interested to help me with developing MapTiler (for
>>>> example compilation of latest GDAL with all modules, preparing of
>>>> Windows installer, help with wxPython...)
>>>> KyngChaos (thank you!) already had a look at binaries for MacOSX, but
>>>> we did not moved far yet as I need some functionality from 1.6dev.
>>>>
>>>> Thanks belong to everybody who gave me excellent advices on #gdal IRC,
>>>> especially to 'FrankW' and 'even'.
>>>>
>>>> BTW I am looking for an interesting job or paid projects... any offers? ;-)
>>>>
>>>> Is there anybody who would like to support further development of
>>>> MapTiler/GDAL2Tiles? There is plenty of features on todo list (merging
>>>> of produced tiles with existing tile tree, support for MapCruncher
>>>> tiles, Zoomify tiles, speed improvement - rewrite to C++ to allow
>>>> better usage of threads on multi-core processors, driver for remote
>>>> online TMS tiles for GDAL/MapServer to allow WMS from statically
>>>> published tiles, etc..).
>>>>
>>>> Best regards...
>>>>
>>>> Klokan Petr Pridal
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>>
>>> ------------------------------------------------------------------------
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
From mateusz at loskot.net  Tue Aug 19 05:14:03 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Aug 19 05:14:08 2008
Subject: [gdal-dev] GDAL 1.5.2 and GRIB2 support
In-Reply-To: <48AA8176.4070606@issart.com>
References: <48AA8176.4070606@issart.com>
Message-ID: <48AA8EDB.20806@loskot.net>

Dmitriy Kazimirov wrote:
> Hi,
> Where GRIB2 support gone from 1.5.2?attempting to configure on Cygwin 
> shows grib2 support no, grib directory is absent from frmts.
> Which of last versions support GRIB2?

Dmitriy,

What is the last version of GDAL you mean that included GRIB support?
I don't recall GRIB support in any of 1.5.0, 1.5.1 and 1.5.2.

GRIB support (frmts/grib directory) is available in SVN trunk

http://svn.osgeo.org/gdal/trunk/gdal/frmts/grib/

In February 2008, grib module was moved from spike [1] to trunk:

http://trac.osgeo.org/gdal/changeset/13877

[1] module for experimental, alpha and non-official codes
http://lists.osgeo.org/pipermail/gdal-dev/2007-February/011691.html

If you want to gest GRIB support, download the frmts/grib from trunk and 
follow instructions explained here:

http://lists.osgeo.org/pipermail/gdal-dev/2007-February/011663.html

but replace URL
https://svn.osgeo.org/svn/gdal/trunk/spike/grib
with
https://svn.osgeo.org/gdal/trunk/gdal/frmts/grib/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From guillaume.sueur at neogeo-online.net  Tue Aug 19 05:29:10 2008
From: guillaume.sueur at neogeo-online.net (Guillaume Sueur)
Date: Tue Aug 19 05:29:18 2008
Subject: [gdal-dev] GSoC GDAL2Tiles: MapTiler.org, Google Maps Projection
	Web, Source Code
In-Reply-To: <6e41d95b0808190206v7da4ed36v71c12c4924a02e51@mail.gmail.com>
References: <6e41d95b0808181323j3e87c98bu92cbb16935449bc5@mail.gmail.com>	
	<48A9E45D.8010002@neogeo-online.net>	
	<6e41d95b0808182339k3b7f2858ub43d3e88aafc3969@mail.gmail.com>	
	<48AA84F0.1000302@neogeo-online.net>
	<6e41d95b0808190206v7da4ed36v71c12c4924a02e51@mail.gmail.com>
Message-ID: <48AA9266.9090801@neogeo-online.net>



Klokan Petr P?idal a ?crit :
> Hi,
> 
>> I'm talking about 10 to 100 GigaBytes datasets, with which it doesn't
>> seem reasonnable to generate a single merged file !
> 
> In case you use -of VRT it should not be problem. VRT is just an XML
> file telling where is each file placed and what processing is
> necessary - so in fact there is not big logical difference between
> gdal_vrtmerge's VRT and gdaltindex result (one is using XML another
> shape file for storing the same kind of link to raster data).

ok, sounds interesting


> In case you anyway have WMS server for raster data, you can use
> TileCache.org or GeoWebCache.org to cache the tiles.
> Advantage of GDAL2Tiles over TileCache is practically zero
> configuration of any server software. The result from the user point
> of view is almost equal.

that's what I use for now. Both products are quite equivalent. Tell me
if I'm wrong when I imagine that :
gdal2tiles has a fixed grid and zoom levels for tiles, based on google ones
gdal2tiles must populate the whole cache at once.

Regards,

Guillaume
From plists at prometheus.org.yu  Tue Aug 19 05:58:58 2008
From: plists at prometheus.org.yu (Attila Csipa)
Date: Tue Aug 19 06:16:02 2008
Subject: [gdal-dev] encodings, locales ?
In-Reply-To: <48AA0ABA.6000005@loskot.net>
References: <200808190143.57799.plists@prometheus.org.yu>
	<48AA0ABA.6000005@loskot.net>
Message-ID: <200808191158.58528.plists@prometheus.org.yu>

On Tuesday 19 August 2008 01.50:18 Mateusz Loskot wrote:
> Some bits of the RFC-23 implementation has been already
> submitted to the  SVN trunk. Try this queries to find detailed changesets:
>
> http://trac.osgeo.org/gdal/search?q=RFC23&noquickjump=1&changeset=on
> http://trac.osgeo.org/gdal/search?q=RFC+23&noquickjump=1&changeset=on

OK, so no driver specific changes (yet), but I don't expect those until RFC23 
is actually finished.

> > Also, is there plan for
> > doing proper localization or is it just internationalization for now ?
>
> Could you explain what you mean as "proper localization" and what is
> missing in the RFC-23 that would make it "proper"?

From what I see, RFC-23 is internationalization, which means it makes it 
possible to use it with languages other than the original (e.g. English) as 
it would get mostly language-agnostic with utf8. This is a good first step 
(with the arguably acceptable loss of information in some of the more obscure 
encodings), but it would be really good to have user-defineable input/output 
encoding, especially as not all formats define the encoding themselves (see 
dbf, csv). The output encoding problem can especially escalate if your 
original encoding was a non-latin one byte encoding. For example, if you have 
a source WIN1251 Cyrillic encoding, the utf8 version would take roughly twice 
the number of bytes, so your data would either get truncated or the field 
length must be changed to accommodate.

Localization is different as it also means functional difference in terms that 
the app actually acts differently based on your locale/encoding. In the GIS 
field this often relates to date/time format representation, but also the 
textual representation of numbers (see thousand separator, comma, as csv/xml 
imports can be especially pesky). Arguably projections could/should be part 
of this, too, but I understand that it could cause as many problems (even if 
for the right reasons) for many existing installs.

In the broadest sense this would mean the interface of the application itself 
(so, if you have a locale set, the application communicates error and help 
messages in the language and format appropriate for the given locale), but 
this is really hard to coordinate and I guess not really expected from a 
specialist tool like GDAL. 
From enrico at enricozini.org  Tue Aug 19 11:48:38 2008
From: enrico at enricozini.org (Enrico Zini)
Date: Tue Aug 19 12:10:11 2008
Subject: [gdal-dev] Passing information between drivers
Message-ID: <20080819154838.GA357@enricozini.org>

Hello,

I am working on some drivers that contain extra metadata, which I would
need to pass on to the new files created when running, for example,
gdalwarp, if the output driver supports it.

In particular, the drivers do import and export satellite images, and
the output image of gdalwarp would need to carry, if possible, extra
metadata such as the sensor model or the channel number, from the input
image.

Is the output driver given a chance to query the input driver, or can it
only rely on the limited set of information it gets via Set* methods?


Ciao,

Enrico

-- 
GPG key: 1024D/797EBFAB 2000-12-05 Enrico Zini <enrico@debian.org>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Digital signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080819/3fbae279/attachment.bin
From warmerdam at pobox.com  Tue Aug 19 13:18:59 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 19 13:19:20 2008
Subject: [gdal-dev] Passing information between drivers
In-Reply-To: <20080819154838.GA357@enricozini.org>
References: <20080819154838.GA357@enricozini.org>
Message-ID: <48AB0083.7080402@pobox.com>

Enrico Zini wrote:
> Hello,
> 
> I am working on some drivers that contain extra metadata, which I would
> need to pass on to the new files created when running, for example,
> gdalwarp, if the output driver supports it.
> 
> In particular, the drivers do import and export satellite images, and
> the output image of gdalwarp would need to carry, if possible, extra
> metadata such as the sensor model or the channel number, from the input
> image.
> 
> Is the output driver given a chance to query the input driver, or can it
> only rely on the limited set of information it gets via Set* methods?

Enrico,

Unfortunately, in gdalwarp only explicitly passed information gets to the
output driver.   Currently there is no way to get metadata such as what you
describe from the source to the destination file.

Potentially we could change the behavior of gdalwarp to copy the primary
domain metadata when it is creating a new file from a single input file.
I'm not sure if there are likely to be downsides to this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Aug 19 15:20:26 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 19 15:20:56 2008
Subject: [gdal-dev] Does OGRLayer::CreateField() suport UNICODE in
	ver1.4.1 ?
In-Reply-To: <tencent_6BAC406D0BFFFD9014CBE25B@qq.com>
References: <tencent_6BAC406D0BFFFD9014CBE25B@qq.com>
Message-ID: <48AB1CFA.1030103@pobox.com>

wow wrote:
> Hi, When i call OGRLayer::CreateField() to create a field with a Chinese 
> name[UNICODE], i got errors. The driver is ESRI shape. Does 
> OGRLayer::CreateField() suport UNICODE in ver1.4.1 ?

Chen Xuexia,

The Shapefile driver has not been updated to be encoding aware at all.  The
zero terminated string passed as the field name is truncated to 11 (10?) bytes
and used directly in the .dbf file with no attempts at translation.

The DBF format has a couple mechanisms for identifying encoding - OGR ignores
them all.  A good fix for this would be desirable.  The intent of RFC 23
(http://trac.osgeo.org/gdal/wiki/rfc23_ogr_unicode) is that field values,
and presumably field and layer names should be treated as UTF-8 strings.  But
only a few format drivers actual do anything about this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Aug 19 16:31:18 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 19 16:33:26 2008
Subject: [gdal-dev] encodings, locales ?
In-Reply-To: <200808191158.58528.plists@prometheus.org.yu>
References: <200808190143.57799.plists@prometheus.org.yu>
	<48AA0ABA.6000005@loskot.net>
	<200808191158.58528.plists@prometheus.org.yu>
Message-ID: <48AB2D96.6060904@pobox.com>

Attila Csipa wrote:
> On Tuesday 19 August 2008 01.50:18 Mateusz Loskot wrote:
>> Some bits of the RFC-23 implementation has been already
>> submitted to the  SVN trunk. Try this queries to find detailed changesets:
>>
>> http://trac.osgeo.org/gdal/search?q=RFC23&noquickjump=1&changeset=on
>> http://trac.osgeo.org/gdal/search?q=RFC+23&noquickjump=1&changeset=on
> 
> OK, so no driver specific changes (yet), but I don't expect those until RFC23 
> is actually finished.

Attila,

It would appear that the above queries miss the changes.  The
GML, PG (Postgres), ODBC and PGEO drivers have been updated as I
recall.  I'm not sure if I touched one or two others.

>>> Also, is there plan for
>>> doing proper localization or is it just internationalization for now ?
>> Could you explain what you mean as "proper localization" and what is
>> missing in the RFC-23 that would make it "proper"?
> 
> From what I see, RFC-23 is internationalization, which means it makes it 
> possible to use it with languages other than the original (e.g. English) as 
> it would get mostly language-agnostic with utf8. This is a good first step 
> (with the arguably acceptable loss of information in some of the more obscure 
> encodings), but it would be really good to have user-defineable input/output 
> encoding, especially as not all formats define the encoding themselves (see 
> dbf, csv). The output encoding problem can especially escalate if your 
> original encoding was a non-latin one byte encoding. For example, if you have 
> a source WIN1251 Cyrillic encoding, the utf8 version would take roughly twice 
> the number of bytes, so your data would either get truncated or the field 
> length must be changed to accommodate.

I would be happy to have some drivers offer datasource or layer creation
options to specify the desired encoding in created files.  This would
be done on a driver by driver basis based on demand and interest.

I'd also like to see some sort of mechanism added to ogr2ogr that would
let us apply a transcoding - essentially this means we are assuming the input
dataset is not in UTF-8 but that this was not identifiable in the driver so
it has to be "fixed up" via user direction.  But I don't have any timeline to
do this.

> Localization is different as it also means functional difference in terms that 
> the app actually acts differently based on your locale/encoding. In the GIS 
> field this often relates to date/time format representation, but also the 
> textual representation of numbers (see thousand separator, comma, as csv/xml 
> imports can be especially pesky). 

To some degree OGR already honours normal locale mechanisms.  For instance,
I *think* ogrinfo will report numeric values with local conventions by
virtue of GetFieldAsString() using sprintf() or analogs without overriding
the inherited locale.  For the most part this is left up to applications.

 > Arguably projections could/should be part
> of this, too, but I understand that it could cause as many problems (even if 
> for the right reasons) for many existing installs.

There has been a deliberate effort (though not necessarily a comprehensive
effort) to support reading coordinate system definitions with numeric values
in unusual locales (ie. comma for decimal point), but it is not my desire
to report these values with local locale settings in WKT form if I can avoid
it as I think this causes problems.

> In the broadest sense this would mean the interface of the application itself 
> (so, if you have a locale set, the application communicates error and help 
> messages in the language and format appropriate for the given locale), but 
> this is really hard to coordinate and I guess not really expected from a 
> specialist tool like GDAL. 

I'm not particularly interested in providing error text in different languages,
though if there was sufficient interest I'd be ok with having the English
hardcoded into the library but processed via a mechanism that would allow
translation into other languages using translation files.

But realistically, it would be hard to do, and many of the errors barely
make sense in context in english.  Translation is likely to degrade that
and be challenging to maintain.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Aug 19 16:44:28 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 19 16:46:19 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
Message-ID: <48AB30AC.2000509@pobox.com>

Norman Barker wrote:
> Having spent some more time on this, is adding progressive support to
> gdal as simple as overloading the RasterIO function
> 
> http://www.gdal.org/classGDALDataset.html#e077c53268d2272eebed10b891a057
> 43
> 
> and adding a callback function?  I would like to standardize this if
> possible in the GDALDataset class.

Norman,

Can you comment on how you would expect the driver to update the buffer?

For instance, would you require a callback after each scanline?  Would it
be possible for the drivers to update the buffer one tile at a time?  Does
the callback need to clearly indicate what has changed in the buffer since
the last call to minimize screen areas updated?  Do you want to address
data that might be returned in interlaced format?

The simpliest case I can imagine would be passing (or installing) a
callback that drivers *could* call periodically to indicate that some
unspecified area of the RasterIO() buffer has been updated.

Is the main objective to be able to update stuff on the screen while a
buffer is being downloaded by JPIP or other slow access mechanisms?

I will note there was previously a different approach implemented.  That
was for the application to call AdviseRead() on the dataset to give the
driver a pre-clue to what region of interest will be accessed, and then
for the application to call RasterIO() on the desired region - often a
bit (ie. scanline) at a time.  This would give the driver advance information
on the area of interest (suitable to construct a single JPIP request),
and by accessing a line at a time the application gets the chance to
update things as they are received.

In actual fact though it was hard to implement drivers to take advantage
of this mechanism, and there was very little application level interest
in it.  So it has been essentially still-born - and I'd like to consider
deprecating and eventually removing GDALDataset::AdviseRead() from GDAL.

I will note that adding a callback to RasterIO() will result in
duplication of many interfaces since we need to preserve the old ones.
I'd like to ensure we do this "right" if we are going to do it since
we (GDAL) have a hard time getting rid of cruft once it's in a release
and gets into use.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From nbarker at ittvis.com  Tue Aug 19 17:25:48 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Tue Aug 19 17:25:52 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<48AB30AC.2000509@pobox.com>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>

Frank,

Comments inline, I will refer mainly to JPIP (since this is what I know)
but this should hopefully apply to other streaming formats.  

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, August 19, 2008 2:44 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman Barker wrote:
> Having spent some more time on this, is adding progressive support to
> gdal as simple as overloading the RasterIO function
> 
>
http://www.gdal.org/classGDALDataset.html#e077c53268d2272eebed10b891a057
> 43
> 
> and adding a callback function?  I would like to standardize this if
> possible in the GDALDataset class.

Norman,

Can you comment on how you would expect the driver to update the buffer?

For instance, would you require a callback after each scanline?  Would
it
be possible for the drivers to update the buffer one tile at a time?
Does
the callback need to clearly indicate what has changed in the buffer
since
the last call to minimize screen areas updated?  Do you want to address
data that might be returned in interlaced format?

<ncb>
In jpip, message response codes are used 

R=1 	Image Done
R=2	Window Done	
R=3	Window Change
R=4	Byte Limit Reached
R=5	Quality Limit Reached
R=6	Session Limit Reached	
R=7	Response Limit Reached
R=0xFF	Non Specified Reason	

Mainly it is either end of response, image done, or window done to
indicate that there is a buffer update and the display should be
updated, anything else can pretty much be ignored.  

Ideally the callback should indicate the region that has changed, since
the server is entitled to change the region it streams if the client has
requested an invalid ROI.

The callback isn't per scan line, but a whole window (at a particular
resolution level).
</ncb>

The simpliest case I can imagine would be passing (or installing) a
callback that drivers *could* call periodically to indicate that some
unspecified area of the RasterIO() buffer has been updated.

<ncb>
The callback would need to include the x,y offsets, width, height and
resx, resy since otherwise there needs to be too much state
synchronization between the format driver and the client.  The simplest
would be to specify x,y, width, height at the base resolution of the
image and to use resx, resy to sample for the display implying the
buffer size.  The format driver would keep the cache.
</ncb>

Is the main objective to be able to update stuff on the screen while a
buffer is being downloaded by JPIP or other slow access mechanisms?

<ncb>
Definitely, this is the main objective.  A secondary objective is to use
the mechanism to download complete sections of a streaming image (so to
stream until a window done message) for use with gdal_translate for
example.
</ncb>

I will note there was previously a different approach implemented.  That
was for the application to call AdviseRead() on the dataset to give the
driver a pre-clue to what region of interest will be accessed, and then
for the application to call RasterIO() on the desired region - often a
bit (ie. scanline) at a time.  This would give the driver advance
information
on the area of interest (suitable to construct a single JPIP request),
and by accessing a line at a time the application gets the chance to
update things as they are received.

<ncb>
I looked at AdviseRead, jpip is more progressive than this, an image
update is potentially available on every server read.
</ncb>

In actual fact though it was hard to implement drivers to take advantage
of this mechanism, and there was very little application level interest
in it.  So it has been essentially still-born - and I'd like to consider
deprecating and eventually removing GDALDataset::AdviseRead() from GDAL.

I will note that adding a callback to RasterIO() will result in
duplication of many interfaces since we need to preserve the old ones.
I'd like to ensure we do this "right" if we are going to do it since
we (GDAL) have a hard time getting rid of cruft once it's in a release
and gets into use.

<ncb>
I fully agree with this, lets get the interface right.  I don't think a
progressive interface would be cruft, but I agree that currently
applications aren't implementing this.  The wince port (and others) of
gdal to handheld devices may make this more useful and increase the
requirement for image streaming.

Many thanks,

Norman
</ncb>

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Tue Aug 19 17:44:50 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Aug 19 17:45:25 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<48AB30AC.2000509@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>
Message-ID: <48AB3ED2.9010705@pobox.com>

Norman Barker wrote:
> Mainly it is either end of response, image done, or window done to
> indicate that there is a buffer update and the display should be
> updated, anything else can pretty much be ignored.  
> 
> Ideally the callback should indicate the region that has changed, since
> the server is entitled to change the region it streams if the client has
> requested an invalid ROI.

Norman,

If we load this capability onto RasterIO() call I don't imagine we
would want to allow the client to change the area being loaded. If
an invalid ROI is requested the driver should either error out, or
only update the valid part of the buffer.

> The callback isn't per scan line, but a whole window (at a particular
> resolution level).
> </ncb>

Ah, gotcha.  I hadn't even considered this aspect!

> The simpliest case I can imagine would be passing (or installing) a
> callback that drivers *could* call periodically to indicate that some
> unspecified area of the RasterIO() buffer has been updated.
> 
> <ncb>
> The callback would need to include the x,y offsets, width, height and
> resx, resy since otherwise there needs to be too much state
> synchronization between the format driver and the client.  The simplest
> would be to specify x,y, width, height at the base resolution of the
> image and to use resx, resy to sample for the display implying the
> buffer size.  The format driver would keep the cache.
> </ncb>

OK, now you have lost me.  The RasterIO() call includes a buffer,
and defines the size of that buffer (in x and y) and the size of
file window to load into that buffer.  I don't get what you mean
about there being too much state synchronization between the driver
and the client.

> Is the main objective to be able to update stuff on the screen while a
> buffer is being downloaded by JPIP or other slow access mechanisms?
> 
> <ncb>
> Definitely, this is the main objective.  A secondary objective is to use
> the mechanism to download complete sections of a streaming image (so to
> stream until a window done message) for use with gdal_translate for
> example.
> </ncb>

I don't follow the secondary objective.   How does having the callback
add value to just reading the data into the buffer in chunks and
then writing it to the output file?

Perhaps it would make sense to mock up a proposed RasterIO() variation
with the callback in RFC form so we can more easily talk about the same
thing?  This can be done in the trac wiki.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From nbarker at ittvis.com  Tue Aug 19 17:59:12 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Tue Aug 19 17:59:15 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<48AB30AC.2000509@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>
	<48AB3ED2.9010705@pobox.com>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B481@gemini.rsinc.com>

Hi Frank,

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, August 19, 2008 3:45 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman Barker wrote:
> Mainly it is either end of response, image done, or window done to
> indicate that there is a buffer update and the display should be
> updated, anything else can pretty much be ignored.  
> 
> Ideally the callback should indicate the region that has changed,
since
> the server is entitled to change the region it streams if the client
has
> requested an invalid ROI.

Norman,

If we load this capability onto RasterIO() call I don't imagine we
would want to allow the client to change the area being loaded. If
an invalid ROI is requested the driver should either error out, or
only update the valid part of the buffer.

<ncb>
We have 

User -> format driver -> server

The server is allowed (by the spec) to change the ROI it serves, the
returned stream is self-describing and the format driver interprets this
stream. 

It is unlikely that the format driver will have a complete blank buffer
of the whole image and only update sections of this buffer, it will
probably just keep a tiny buffer and the attributes (x,y, width, height,
res etc.) of this buffer and publish this to the user.
</ncb>

> The callback isn't per scan line, but a whole window (at a particular
> resolution level).
> </ncb>

Ah, gotcha.  I hadn't even considered this aspect!

> The simpliest case I can imagine would be passing (or installing) a
> callback that drivers *could* call periodically to indicate that some
> unspecified area of the RasterIO() buffer has been updated.
> 
> <ncb>
> The callback would need to include the x,y offsets, width, height and
> resx, resy since otherwise there needs to be too much state
> synchronization between the format driver and the client.  The
simplest
> would be to specify x,y, width, height at the base resolution of the
> image and to use resx, resy to sample for the display implying the
> buffer size.  The format driver would keep the cache.
> </ncb>

OK, now you have lost me.  The RasterIO() call includes a buffer,
and defines the size of that buffer (in x and y) and the size of
file window to load into that buffer.  I don't get what you mean
about there being too much state synchronization between the driver
and the client.

<ncb>
The user (client display) is changing the request window constantly to
the format driver as they pan and zoom the image, there is a lag between
this change and the server response - however the response stream is
self describing, and the format driver will have knowledge of the
currently processed request window (which may not have been updated with
the new user request).  It is simpler for the format driver to return
the window parameters it used to fill the buffer rather than the user
(client display) to think it has received a different buffer. 

The reason for the mismatch is that the call to the server and format
driver call back are likely to be in different threads.

Sorry for not having made that clearer!
</ncb>

> Is the main objective to be able to update stuff on the screen while a
> buffer is being downloaded by JPIP or other slow access mechanisms?
> 
> <ncb>
> Definitely, this is the main objective.  A secondary objective is to
use
> the mechanism to download complete sections of a streaming image (so
to
> stream until a window done message) for use with gdal_translate for
> example.
> </ncb>

I don't follow the secondary objective.   How does having the callback
add value to just reading the data into the buffer in chunks and
then writing it to the output file?

<ncb>
There is no advantage with the secondary objective, it is just that a
single request window to a jpip server has been disabled in GDAL for a
while, and if we are getting objective (1) to work, then it would be
good to get (2) to work as well!
</ncb>

Perhaps it would make sense to mock up a proposed RasterIO() variation
with the callback in RFC form so we can more easily talk about the same
thing?  This can be done in the trac wiki.

<ncb>
I agree, watch this space - I will get something up on the wiki for
discussion.  Thanks again for discussing this.

Norman
</ncb>

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From szekerest at gmail.com  Tue Aug 19 18:32:35 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue Aug 19 18:32:37 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B477@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<f3b73b7d0808181503k12fb1d5av9b4ef482a4c2ba72@mail.gmail.com>
	<B1B624F7C110834B96594065A74F3A540916B477@gemini.rsinc.com>
Message-ID: <f3b73b7d0808191532x7a11af93hbfe7e13dcf322cf1@mail.gmail.com>

2008/8/19 Norman Barker <nbarker@ittvis.com>:
> Tamas,
>
> Thanks for the input, much appreciated since I would like to get this
> interface defined.
>
> A streaming driver so JPIPKAK for example would need to register as its
> own driver to handle urls of the type jpip://, similarly ecwp would need
> its own driver if it were to use the same callback for streaming data.
> As such the management of GDALDataset::RasterIO and Band.RasterIO would
> be the implementors responsibility, most likely this could be defined
> with references back to the parent dataset as the controller thread.
>

Norman,

Is this somewhat different as how the RasterIO is handled in the
current approach. The controller thread you mentioned would change the
synchronous behaviour of RarterIO into an asynchronous approach, yes?
In that case your callback would also denote the completion of the
overall process as well as to notify the user about a change in the
underlying data?
In any case I'd prefer a separate band/dataset level callback instead
of changing the current RasterIO signature.

The driver could also keep on the current mechanism like using the
thread of the caller to complete the RasterIO operation  in this case
the driver might want to provide that the client could re-enter into
the function from the callback in order to read out the intermediary
data from the buffers.

> The comment about raster x and y size is interesting, in the case of
> jpip raster x and y size is known as a result of the image metadata
> being transferred to the client in the initial request and can be
> handled as overviews, for other formats like MrSID, ECW then I defer to
> the better informed.
>
> JPIP does have a client cache, and this data is needed between requests,
> but I believe we can keep this data internal to the format driver.
>

I thing it's crucial how the progressive rendering capable driver
would represent the intermediary images. In case when different
buffers are used the client cannot use the same RasterIO to read out
the changes so some additional parameters/functions might have to be
introduced.

Best regards,

Tamas
From max at geoinova.com  Wed Aug 20 05:46:06 2008
From: max at geoinova.com (Maksim Sestic)
Date: Wed Aug 20 05:46:11 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
Message-ID: <19066003.post@talk.nabble.com>


Hi all,

I'm having troubles with gdal_translate while creating uncompressed 3-band
GTiff with CMYK photometric representation. Well, at least CMYK
representation recognized by Photoshop, which is
PhotometricInterpretation=5. If I use recommended gdal_translate -co
'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, again,
that's what Photoshop says (PhotometricInterpretation=1).

What other -co parameters should I set to make it work? I'm using
gdal_translate from FWTools 2.2.3 


Here's the gdalinfo reports:

1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
 switch:

Size is 945, 945
Coordinate System is `'
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_SOFTWARE=MyApp
  TIFFTAG_DATETIME=20.08.2008 02:51:37
  TIFFTAG_XRESOLUTION=240
  TIFFTAG_YRESOLUTION=240
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  945.0)
Upper Right (  945.0,    0.0)
Lower Right (  945.0,  945.0)
Center      (  472.5,  472.5)
Band 1 Block=945x2 Type=Byte, ColorInterp=Gray
Band 2 Block=945x2 Type=Byte, ColorInterp=Undefined
Band 3 Block=945x2 Type=Byte, ColorInterp=Undefined

Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and
'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.


2) Photoshopped tiff with CMYK mode set (that's what I need to get):

Driver: GTiff/GeoTIFF
Files: 080417_75008_000000017_CMYK.tif
Size is 945, 945
Coordinate System is `'
Metadata:
  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
  TIFFTAG_DATETIME=2008:08:20 02:21:08
  TIFFTAG_XRESOLUTION=240
  TIFFTAG_YRESOLUTION=240
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  945.0)
Upper Right (  945.0,    0.0)
Lower Right (  945.0,  945.0)
Center      (  472.5,  472.5)
Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined
Band 2 Block=945x2 Type=Byte, ColorInterp=Undefined
Band 3 Block=945x2 Type=Byte, ColorInterp=Undefined
Band 4 Block=945x2 Type=Byte, ColorInterp=Undefined

Also, there's another Photoshop's TIFF tag, "NativeDigest", which I don't
really get (it's not recognized by gdalinfo) - here's the xmp output:
<tiff:NativeDigest
xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,284,530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;46BB973B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>


Regards,
Maksim Sestic
-- 
View this message in context: http://www.nabble.com/GTiff---gdal_translate---CMYK---problem-tp19066003p19066003.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From dmorissette at mapgears.com  Wed Aug 20 09:47:35 2008
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Aug 20 09:48:13 2008
Subject: [gdal-dev] ogr2gui - project development
In-Reply-To: <20080718172153.B62F32D48@fep3.cogeco.net>
References: <20080718172153.B62F32D48@fep3.cogeco.net>
Message-ID: <48AC2077.1010106@mapgears.com>

Frank, and all,

What would you think of adding a "OGR related projects / resources" to 
the OGR website that could link to projects like this "ogr2gui" and 
perhaps translated docs (e.g. 
http://softlibre.gloobe.org/doku.php/gdal_ogr/start) and any external 
resources that may be of interest to GDAL/OGR users?

Daniel

Mathieu Lahaye wrote:
> Hi,
> 
> My company developed a graphical user interface (GUI) for ogr2ogr. We 
> created an open source project called ogr2gui.
> 
> We intend to make this application available to GIS users who aren?t 
> comfortable with the ogr2ogr syntax or looking for a fast, easy and free 
> geospatial data translator.
> 
>  
> 
> You can download the source code or the installer at: inventis.ca/ogr2gui
> 
> Note that this is only RC 0.1 and only few data formats are supported. 
> We?ll add some more as soon as possible?
> 
>  
> 
> We?re currently looking for some people who?d like to get involved in 
> this utility program development.
> 
> We?d also like to get some feedback about the project?do you think it?s 
> useful? should it looks different? functions we should add or remove, etc.
> 
>  
> 
> All comments or suggestions are welcome!
> 
>  
> 
> Thanks,
> 
>  
> 
> **Mathieu Lahaye**
> 
> mathieu@inventis.ca <mailto:mathieu@inventis.ca>
> 
> www.inventis.ca <http://www.inventis.ca>
> 
>  
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Daniel Morissette
http://www.mapgears.com/
From warmerdam at pobox.com  Wed Aug 20 11:49:53 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 20 11:50:17 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <19066003.post@talk.nabble.com>
References: <19066003.post@talk.nabble.com>
Message-ID: <48AC3D21.4000901@pobox.com>

Maksim Sestic wrote:
> Hi all,
> 
> I'm having troubles with gdal_translate while creating uncompressed 3-band
> GTiff with CMYK photometric representation. Well, at least CMYK
> representation recognized by Photoshop, which is
> PhotometricInterpretation=5. If I use recommended gdal_translate -co
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, again,
> that's what Photoshop says (PhotometricInterpretation=1).
> 
> What other -co parameters should I set to make it work? I'm using
> gdal_translate from FWTools 2.2.3 
> 
> 
> Here's the gdalinfo reports:
> 
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
> 
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray
> Band 2 Block=945x2 Type=Byte, ColorInterp=Undefined
> Band 3 Block=945x2 Type=Byte, ColorInterp=Undefined
> 
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.

Maksim,

I would note that CMYK photometric interpretation requires 4 bands.
Furthermore, GDAL does *not* manage the conversion to CMYK color space.
You would need to do that ahead of time by some means.

I've never tried to create CMYK files so I don't have any further advice.

Best regards,


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Aug 20 11:52:15 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 20 11:52:36 2008
Subject: [gdal-dev] ogr2gui - project development
In-Reply-To: <48AC2077.1010106@mapgears.com>
References: <20080718172153.B62F32D48@fep3.cogeco.net>
	<48AC2077.1010106@mapgears.com>
Message-ID: <48AC3DAF.4060207@pobox.com>

Daniel Morissette wrote:
> Frank, and all,
> 
> What would you think of adding a "OGR related projects / resources" to 
> the OGR website that could link to projects like this "ogr2gui" and 
> perhaps translated docs (e.g. 
> http://softlibre.gloobe.org/doku.php/gdal_ogr/start) and any external 
> resources that may be of interest to GDAL/OGR users?

Daniel,

I'm generally supportive, but I'd suggest making it a page in Trac,
and pointing to that from the main OGR page (www.gdal.org/ogr) so that
it is easier for non-commiters to add resources to the page.  I think this
approach has worked reasonable well for the "Software using GDAL" for instance.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Wed Aug 20 12:14:56 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 20 12:15:26 2008
Subject: [gdal-dev] SoC Final Report: GDAL TMS driver
Message-ID: <48AC4300.2030408@pobox.com>


Folks,

I received the following report from V?clav on the GDAL TMS driver status:

"""
Since the final deadline has approached, I am sending you the result of 
my futile attempt to implement the TMS driver.

The reading part sort of works. The driver always assumes Origin is in 
the bottom left corner of the map. There is no support for profiles and 
projections. It will read the raster data from disk.

I could not get the writing right. During testing, gdal_translate 
regularily calls methods on dataset that has already been deleted, don't 
know why. The driver will write the xml resource file, create the 
directory structure and fill it with empty tiles. Writing after this 
point doesn't work, the cached tiles won't be written and for the life 
of me I don't know why. Also the IRasterIO implementation is probably 
bogus too, since gdal_translate calls IWriteBlock only on the 
TopRasterBand instead of on all overviews as it should. There are no 
output settings, tiles are hardcoded to PNG, 256x256 pixels.
"""

I have uploaded the source he supplied into /spike/tms in the GDAL 
subversion and added some notes on how to build and test it at:
 
  http://trac.osgeo.org/gdal/wiki/SoCTMSDriver

The project period is over, and it isn't clear whether V?clav will be 
doing any more work on the driver.  I'm available to consult and help 
with anyone wanting to carry this effort forward.  For the time being 
the project artifacts are captured in the wiki and subversion and should 
not be lost.

Best regards,
FrankW
From jmckenna at gatewaygeomatics.com  Wed Aug 20 13:11:09 2008
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed Aug 20 13:17:52 2008
Subject: [gdal-dev] ogr2gui - project development
In-Reply-To: <48AC2077.1010106@mapgears.com>
References: <20080718172153.B62F32D48@fep3.cogeco.net>
	<48AC2077.1010106@mapgears.com>
Message-ID: <48AC502D.1030504@gatewaygeomatics.com>

interesting...but i somehow missed this announcement...


-jeff




> 
> Mathieu Lahaye wrote:
>> Hi,
>>
>> My company developed a graphical user interface (GUI) for ogr2ogr. We 
>> created an open source project called ogr2gui.
>>
>> We intend to make this application available to GIS users who aren?t 
>> comfortable with the ogr2ogr syntax or looking for a fast, easy and 
>> free geospatial data translator.
>>
>>  
>>
>> You can download the source code or the installer at: inventis.ca/ogr2gui
>>
>> Note that this is only RC 0.1 and only few data formats are supported. 
>> We?ll add some more as soon as possible?
>>
>>  
>>
>> We?re currently looking for some people who?d like to get involved in 
>> this utility program development.
>>
>> We?d also like to get some feedback about the project?do you think 
>> it?s useful? should it looks different? functions we should add or 
>> remove, etc.
>>
>>  
>>
>> All comments or suggestions are welcome!
>>
>>  
>>
>> Thanks,
>>
>>  
>>
>> **Mathieu Lahaye**
>>
>> mathieu@inventis.ca <mailto:mathieu@inventis.ca>
>>
>> www.inventis.ca <http://www.inventis.ca>
>>



-- 
Jeff McKenna
FOSS4G Consulting and Training Services
http://www.gatewaygeomatics.com/
From denis.nadeau at gmail.com  Thu Aug 21 13:53:04 2008
From: denis.nadeau at gmail.com (Denis Nadeau)
Date: Thu Aug 21 13:53:07 2008
Subject: [gdal-dev] netcdf driver
Message-ID: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>

Hi,

I will being doing some new development on netCDF driver to make it more
CF-1 Compliant.

Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
--disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
"H4_MAX_NC_NAME" and many other similar macros. Need to do some testing on
this.

I also noticed that DODS (dodsdataset2.cpp) does not seem to compile with
libdap3.8.2.  There are some major changes in the library for C++.
I will take a look into this as well, but do not promess anything...

If you have suggestion of improvements for DODS, HDF4 and netCDF drivers,
let me know, I have a little bit of time this coming month.

Regards,
Denis
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080821/920dbed4/attachment.html
From nbarker at ittvis.com  Thu Aug 21 14:03:07 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Thu Aug 21 14:03:12 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<48AB30AC.2000509@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>
	<48AB3ED2.9010705@pobox.com>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>

Tamas, Frank, all

I have created RFC 24 on 

http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support

for comment; hopefully the likes of mpg, simboss and others will chip in
as well.  

Currently we are just defining an interface - but I am certainly
interested in coding the driver (and probably will) as well.

If JPIP means nothing to you then check out http://iasdemo.ittvis.com
and in the interest of fairness have a look at Lizardtech, Erdas and
Kakadu as well!

Thanks,

Norman

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, August 19, 2008 3:45 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman Barker wrote:
> Mainly it is either end of response, image done, or window done to
> indicate that there is a buffer update and the display should be
> updated, anything else can pretty much be ignored.  
> 
> Ideally the callback should indicate the region that has changed,
since
> the server is entitled to change the region it streams if the client
has
> requested an invalid ROI.

Norman,

If we load this capability onto RasterIO() call I don't imagine we
would want to allow the client to change the area being loaded. If
an invalid ROI is requested the driver should either error out, or
only update the valid part of the buffer.

> The callback isn't per scan line, but a whole window (at a particular
> resolution level).
> </ncb>

Ah, gotcha.  I hadn't even considered this aspect!

> The simpliest case I can imagine would be passing (or installing) a
> callback that drivers *could* call periodically to indicate that some
> unspecified area of the RasterIO() buffer has been updated.
> 
> <ncb>
> The callback would need to include the x,y offsets, width, height and
> resx, resy since otherwise there needs to be too much state
> synchronization between the format driver and the client.  The
simplest
> would be to specify x,y, width, height at the base resolution of the
> image and to use resx, resy to sample for the display implying the
> buffer size.  The format driver would keep the cache.
> </ncb>

OK, now you have lost me.  The RasterIO() call includes a buffer,
and defines the size of that buffer (in x and y) and the size of
file window to load into that buffer.  I don't get what you mean
about there being too much state synchronization between the driver
and the client.

> Is the main objective to be able to update stuff on the screen while a
> buffer is being downloaded by JPIP or other slow access mechanisms?
> 
> <ncb>
> Definitely, this is the main objective.  A secondary objective is to
use
> the mechanism to download complete sections of a streaming image (so
to
> stream until a window done message) for use with gdal_translate for
> example.
> </ncb>

I don't follow the secondary objective.   How does having the callback
add value to just reading the data into the buffer in chunks and
then writing it to the output file?

Perhaps it would make sense to mock up a proposed RasterIO() variation
with the callback in RFC form so we can more easily talk about the same
thing?  This can be done in the trac wiki.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Thu Aug 21 14:44:11 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug 21 14:44:16 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <19066003.post@talk.nabble.com>
References: <19066003.post@talk.nabble.com>
Message-ID: <200808212044.12724.even.rouault@mines-paris.org>

Maksim,

I've just done a few changes in the GeoTIFF driver to enable basic CMYK 
support.

See the log message of http://trac.osgeo.org/gdal/changeset/15178.
And for examples : http://trac.osgeo.org/gdal/changeset/15179.

Regards,
Even

Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
> Hi all,
>
> I'm having troubles with gdal_translate while creating uncompressed 3-band
> GTiff with CMYK photometric representation. Well, at least CMYK
> representation recognized by Photoshop, which is
> PhotometricInterpretation=5. If I use recommended gdal_translate -co
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, again,
> that's what Photoshop says (PhotometricInterpretation=1).
>
> What other -co parameters should I set to make it work? I'm using
> gdal_translate from FWTools 2.2.3
>
>
> Here's the gdalinfo reports:
>
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
>
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray
> Band 2 Block=945x2 Type=Byte, ColorInterp=Undefined
> Band 3 Block=945x2 Type=Byte, ColorInterp=Undefined
>
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>
>
> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>
> Driver: GTiff/GeoTIFF
> Files: 080417_75008_000000017_CMYK.tif
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined
> Band 2 Block=945x2 Type=Byte, ColorInterp=Undefined
> Band 3 Block=945x2 Type=Byte, ColorInterp=Undefined
> Band 4 Block=945x2 Type=Byte, ColorInterp=Undefined
>
> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I don't
> really get (it's not recognized by gdalinfo) - here's the xmp output:
> <tiff:NativeDigest
> xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,284,
>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;46BB97
>3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>
>
> Regards,
> Maksim Sestic


From condit at sdsc.edu  Thu Aug 21 15:19:12 2008
From: condit at sdsc.edu (Christopher Condit)
Date: Thu Aug 21 15:21:36 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
Message-ID: <845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>

Hi Denis-

I put this patch in a few months ago addressing this libdap 3.8 issue:

http://trac.osgeo.org/gdal/ticket/2404

This will get the code to build against libdap3.8 (primarily a namespace
problem), but there are still issues accessing DODS datasources:

http://trac.osgeo.org/gdal/ticket/2492

 

If you get some time to look into this it would be great...

 

Thanks,

-Chris

 

 

From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Denis Nadeau
Sent: Thursday, August 21, 2008 10:53 AM
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] netcdf driver

 

Hi,

I will being doing some new development on netCDF driver to make it more
CF-1 Compliant. 

Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
--disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
"H4_MAX_NC_NAME" and many other similar macros. Need to do some testing
on this.

I also noticed that DODS (dodsdataset2.cpp) does not seem to compile
with libdap3.8.2.  There are some major changes in the library for C++.

I will take a look into this as well, but do not promess anything...

If you have suggestion of improvements for DODS, HDF4 and netCDF
drivers, let me know, I have a little bit of time this coming month.

Regards,
Denis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080821/d4ddccc0/attachment.html
From denis.nadeau at gmail.com  Thu Aug 21 16:05:27 2008
From: denis.nadeau at gmail.com (Denis Nadeau)
Date: Thu Aug 21 16:05:31 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
	<845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
Message-ID: <304163b00808211305w7da6f572k16d4bf019d2fd2a3@mail.gmail.com>

Chris,

I corrected the namespace problem on my local machine and it worked for me
with Tropical Rainfall data from NASA/GSFC DISC.  I will check in the code
later today.

Also, the problem your having on
http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4 is due to
the fact that you are using GDS(Grads-DODS) which is meant for Grads.

I will look at the source code and try to find out why the IReadBlock
failed.   It might be very simple to fix.  In fact, I think it would be very
nice if GDAL DODS driver support GDS since GDS is georeferenced and a lot of
people doing research are using it.

Thanks for your input!
Denis

e.g.
gdalinfo -mm
http://disc2.nascom.nasa.gov/opendap/TRMM_L3/TRMM_3B42/2000/004/3B42.000104.12.6.HDF.Z?precipitation[0]
[y][x]

Driver: DODS/DAP 3.x servers
Files: none associated
Size is 400, 1440
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 1440.0)
Upper Right (  400.0,    0.0)
Lower Right (  400.0, 1440.0)
Center      (  200.0,  720.0)
Band 1 Block=400x128 Type=Float32, ColorInterp=Undefined
    Computed Min/Max=-9999.900,38.662
  NoData Value=3.82456147081407153e-62
  Overviews: 200x720, 100x360, 50x180


Denis
2008/8/21 Christopher Condit <condit@sdsc.edu>

>  Hi Denis-
>
> I put this patch in a few months ago addressing this libdap 3.8 issue:
>
> http://trac.osgeo.org/gdal/ticket/2404
>
> This will get the code to build against libdap3.8 (primarily a namespace
> problem), but there are still issues accessing DODS datasources:
>
> http://trac.osgeo.org/gdal/ticket/2492
>
>
>
> If you get some time to look into this it would be great?
>
>
>
> Thanks,
>
> -Chris
>
>
>
>
>
> *From:* gdal-dev-bounces@lists.osgeo.org [mailto:
> gdal-dev-bounces@lists.osgeo.org] *On Behalf Of *Denis Nadeau
> *Sent:* Thursday, August 21, 2008 10:53 AM
> *To:* gdal-dev@lists.osgeo.org
> *Subject:* [gdal-dev] netcdf driver
>
>
>
> Hi,
>
> I will being doing some new development on netCDF driver to make it more
> CF-1 Compliant.
>
> Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
> --disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
> "H4_MAX_NC_NAME" and many other similar macros. Need to do some testing on
> this.
>
> I also noticed that DODS (dodsdataset2.cpp) does not seem to compile with
> libdap3.8.2.  There are some major changes in the library for C++.
> I will take a look into this as well, but do not promess anything...
>
> If you have suggestion of improvements for DODS, HDF4 and netCDF drivers,
> let me know, I have a little bit of time this coming month.
>
> Regards,
> Denis
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080821/8fda1e1e/attachment-0001.html
From gaffigan at sfos.uaf.edu  Thu Aug 21 20:40:53 2008
From: gaffigan at sfos.uaf.edu (gaffigan@sfos.uaf.edu)
Date: Thu Aug 21 21:05:37 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
Message-ID: <52117.206.174.44.249.1219365653.squirrel@ssl.sfos.uaf.edu>

Thanks for requesting input from the masses.  I have two suggestions which
are based on patches I apply to the NETCDF and HDF4 drivers every time I
build GDAL.

I suggest providing a consistent way to georeference grids across the
DODS, NETCDF, HDF4, and HDF5 drivers.  We patch the NETCDF and HDF4
drivers to recognize georeferencing global attributes, "spatial_ref" and
"GeoTransform".  This allows for georeferencing whether accessing data
through these local file drivers or the DODS driver.

http://trac.osgeo.org/gdal/ticket/1639 (frmts/DODS, done)
http://trac.osgeo.org/gdal/ticket/1637 (frmts/NETCDF, pending)
http://trac.osgeo.org/gdal/ticket/2539 (frmts/HDF4, just submitted)

Also, I think there should be a way to specify the values of higher-order
dimensions (time, level, etc.) in the NETCDF connection string, similar to
what the DODS driver allows (e.g.
"http://penguin.sfos.uaf.edu/opendap/forecasts/WRF/APWS4km/AEFF/latest.nc?TMP_GPML[24][0][y][x]").
 The existing ticket #1808 includes this and many other enhancements to
the NETCDF driver.  It would be great to see these enhancements in a
future GDAL release.  Alternatively, the patch in ticket #2540, though
redundant to that above, is a simpler alternative for selecting
individual bands which we have used extensively.

http://trac.osgeo.org/gdal/ticket/1808
http://trac.osgeo.org/gdal/ticket/2540 (just submitted)

Steve Gaffigan
Data Analyst
Alaska Ocean Observing System


> Hi,
>
> I will being doing some new development on netCDF driver to make it more
> CF-1 Compliant.
>
> Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
> --disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
> "H4_MAX_NC_NAME" and many other similar macros. Need to do some testing on
> this.
>
> I also noticed that DODS (dodsdataset2.cpp) does not seem to compile with
> libdap3.8.2.  There are some major changes in the library for C++.
> I will take a look into this as well, but do not promess anything...
>
> If you have suggestion of improvements for DODS, HDF4 and netCDF drivers,
> let me know, I have a little bit of time this coming month.
>
> Regards,
> Denis
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From gaffigan at sfos.uaf.edu  Thu Aug 21 22:12:58 2008
From: gaffigan at sfos.uaf.edu (gaffigan@sfos.uaf.edu)
Date: Thu Aug 21 22:12:59 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
	<845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
Message-ID: <41537.206.174.44.249.1219371178.squirrel@ssl.sfos.uaf.edu>

I think the source of the problem in ticket #2492 is not a GDAL defect,
but that the variable in the connection string is "u.u".  The .operator is
used to refer to members of a structure (see
http://opendap.org/user/guide-html/guide_61.html), but the variables in
this dataset are grouped by grids (see
http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4.dds). 
It may be that using the .operator to access members of grids was allowed
in older versions of libdap.  As it is, replacing "u.u" with "u"
eliminates the problem for me on machines with libdap-3.8.2/gdal-svn15148
and libdap-3.7.10/gdal-gdal-1.4.2, respectively.

Steve Gaffigan

gdalinfo -mm
"http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4?u[0][0][y][x]"
Driver: DODS/DAP 3.x servers
Files: none associated
Size is 720, 330
Coordinate System is `'
Origin = (0.000000000000000,-75.500000000000000)
Pixel Size = (0.500000000000000,0.500000000000000)
Corner Coordinates:
Upper Left  (   0.0000000, -75.5000000)
Lower Left  (   0.0000000,  89.5000000)
Upper Right (     360.000,     -75.500)
Lower Right (     360.000,      89.500)
Center      ( 180.0000000,   7.0000000)
Band 1 Block=720x128 Type=Float32, ColorInterp=Undefined
    Computed Min/Max=-9989999710577420651746759362478080.000,1.407
  NoData Value=-9.9899999999999995e+33
  Overviews: 360x165, 180x82


> Hi Denis-
>
> I put this patch in a few months ago addressing this libdap 3.8 issue:
>
> http://trac.osgeo.org/gdal/ticket/2404
>
> This will get the code to build against libdap3.8 (primarily a namespace
> problem), but there are still issues accessing DODS datasources:
>
> http://trac.osgeo.org/gdal/ticket/2492
>
>
>
> If you get some time to look into this it would be great...
>
>
>
> Thanks,
>
> -Chris
>
>
>
>
>
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Denis Nadeau
> Sent: Thursday, August 21, 2008 10:53 AM
> To: gdal-dev@lists.osgeo.org
> Subject: [gdal-dev] netcdf driver
>
>
>
> Hi,
>
> I will being doing some new development on netCDF driver to make it more
> CF-1 Compliant.
>
> Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
> --disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
> "H4_MAX_NC_NAME" and many other similar macros. Need to do some testing
> on this.
>
> I also noticed that DODS (dodsdataset2.cpp) does not seem to compile
> with libdap3.8.2.  There are some major changes in the library for C++.
>
> I will take a look into this as well, but do not promess anything...
>
> If you have suggestion of improvements for DODS, HDF4 and netCDF
> drivers, let me know, I have a little bit of time this coming month.
>
> Regards,
> Denis
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From max at geoinova.com  Fri Aug 22 03:39:32 2008
From: max at geoinova.com (Maksim Sestic)
Date: Fri Aug 22 03:39:51 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <200808212044.12724.even.rouault@mines-paris.org>
Message-ID: <000001c9042a$3ec4eb40$0501a8c0@max2>

Hi Even,

Thanks for the info, but I need it other way round - RGB to CMYK conversion.
As Frank said, it's possible to create a CMYK result using gdal_translate
giving it an extra band as a parameter (i.e. -b 1 -b 2 -b 3 -b 1), but the
end result is of no use since that extra band (along with R, G and B) takes
some color mangling I'm not very familiar with. And there's not much to read
about it, here's what I found (citations ahead):

http://semmix.pl/color/extrans/etr10.htm

Transformation RGB, CMY, CMYK
Formal transformation of the components RGB into the components CMY or
inversely is as follows:

we have color RGB=(r,g,b) then color CMY=(1-r,1-g,1-b) we have color
CMY=(c,m,y) then color RGB=(1-c,1-m,1-y).

Transformation of CMY into CMYK is presented as algorithm:
k=min(c,m,y), CMYK=(c-k,m-k,y-k,k)

This explanation seems sane enough, but then: "we have color RGB=(r,g,b)
then color CMY=(1-r,1-g,1-b)" is giving me a headache with "1-r" etc. part.
What do they mean by "1-r"? :-)

Furthermore, RGB to CMYK is supported by .NET 3.5 only, and giving it a shot
via GDAL managed wrappers is also viable solution (thanks Tamas for
LoadBitmapDirect and SaveBitmapDirect C# examples). I'm working with .NET
2.0 and can't use this approach, but here's the code anyways (author
unknown):

using System;
using System.IO;
using System.Windows.Forms;
using System.Windows.Media;
using System.Windows.Media.Imaging;
...

Stream imageStream = new FileStream(@"C:\temp\mike4.jpg", FileMode.Open,
FileAccess.Read, FileShare.Read);   
BitmapSource myBitmapSource = BitmapFrame.Create(imageStream);   
  
FormatConvertedBitmap newFormatedBitmapSource = new FormatConvertedBitmap();

newFormatedBitmapSource.BeginInit();   
newFormatedBitmapSource.Source = myBitmapSource;   
newFormatedBitmapSource.DestinationFormat = PixelFormats.Cmyk32;   
newFormatedBitmapSource.EndInit();   
  
BitmapEncoder encoder = new TiffBitmapEncoder();   
encoder.Frames.Add(BitmapFrame.Create(newFormatedBitmapSource));   
Stream cmykStream = new FileStream(@"C:\temp\mike4_CMYK.tif",
FileMode.Create, FileAccess.Write, FileShare.Write);   
encoder.Save(cmykStream);   
cmykStream.Close();  


Again, it would be great if someone could explain how to do it via GDAL
wrappers running on .NET 2.0 (I'm using GDAL build from FWTools).

Regards,
Maksim Sestic
 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Thursday, August 21, 2008 20:44
To: gdal-dev@lists.osgeo.org
Cc: Maksim Sestic
Subject: Re: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Maksim,

I've just done a few changes in the GeoTIFF driver to enable basic CMYK
support.

See the log message of http://trac.osgeo.org/gdal/changeset/15178.
And for examples : http://trac.osgeo.org/gdal/changeset/15179.

Regards,
Even

Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
> Hi all,
>
> I'm having troubles with gdal_translate while creating uncompressed 
> 3-band GTiff with CMYK photometric representation. Well, at least CMYK 
> representation recognized by Photoshop, which is 
> PhotometricInterpretation=5. If I use recommended gdal_translate -co 
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, 
> again, that's what Photoshop says (PhotometricInterpretation=1).
>
> What other -co parameters should I set to make it work? I'm using 
> gdal_translate from FWTools 2.2.3
>
>
> Here's the gdalinfo reports:
>
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
>
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and 
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>
>
> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>
> Driver: GTiff/GeoTIFF
> Files: 080417_75008_000000017_CMYK.tif Size is 945, 945 Coordinate 
> System is `'
> Metadata:
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined Band 4 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I 
>don't  really get (it's not recognized by gdalinfo) - here's the xmp
output:
> <tiff:NativeDigest
> 
>xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,
>284,
>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;4
>6BB97 3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>
>
> Regards,
> Maksim Sestic



__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com

 

__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com
 

From craig.miller at spatialminds.com  Fri Aug 22 05:22:02 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Fri Aug 22 05:22:17 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <000001c9042a$3ec4eb40$0501a8c0@max2>
References: <200808212044.12724.even.rouault@mines-paris.org>
	<000001c9042a$3ec4eb40$0501a8c0@max2>
Message-ID: <00e001c90438$89707ca0$9c5175e0$@miller@spatialminds.com>

I'm no expert on color conversions, but I am reading it as 1 = 100%.  So, if
you have an RGB image with values ranging from 0 - 255, then convert it to a
percent first then subtract it from R.  

For example, if you have RGB values of 200, 100, 255:

r = 200/255 = .7843
g = 100/255 = .3921
b = 255/255 = 1.0

Then CMY = (1-.7843, 1-.3921, 1-1.0) or (C=0.2157, M=0.6079, Y=0.0)

Craig


-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Maksim Sestic
Sent: Friday, August 22, 2008 12:40 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Hi Even,

Thanks for the info, but I need it other way round - RGB to CMYK conversion.
As Frank said, it's possible to create a CMYK result using gdal_translate
giving it an extra band as a parameter (i.e. -b 1 -b 2 -b 3 -b 1), but the
end result is of no use since that extra band (along with R, G and B) takes
some color mangling I'm not very familiar with. And there's not much to read
about it, here's what I found (citations ahead):

http://semmix.pl/color/extrans/etr10.htm

Transformation RGB, CMY, CMYK
Formal transformation of the components RGB into the components CMY or
inversely is as follows:

we have color RGB=(r,g,b) then color CMY=(1-r,1-g,1-b) we have color
CMY=(c,m,y) then color RGB=(1-c,1-m,1-y).

Transformation of CMY into CMYK is presented as algorithm:
k=min(c,m,y), CMYK=(c-k,m-k,y-k,k)

This explanation seems sane enough, but then: "we have color RGB=(r,g,b)
then color CMY=(1-r,1-g,1-b)" is giving me a headache with "1-r" etc. part.
What do they mean by "1-r"? :-)

Furthermore, RGB to CMYK is supported by .NET 3.5 only, and giving it a shot
via GDAL managed wrappers is also viable solution (thanks Tamas for
LoadBitmapDirect and SaveBitmapDirect C# examples). I'm working with .NET
2.0 and can't use this approach, but here's the code anyways (author
unknown):

using System;
using System.IO;
using System.Windows.Forms;
using System.Windows.Media;
using System.Windows.Media.Imaging;
...

Stream imageStream = new FileStream(@"C:\temp\mike4.jpg", FileMode.Open,
FileAccess.Read, FileShare.Read);   
BitmapSource myBitmapSource = BitmapFrame.Create(imageStream);   
  
FormatConvertedBitmap newFormatedBitmapSource = new FormatConvertedBitmap();

newFormatedBitmapSource.BeginInit();   
newFormatedBitmapSource.Source = myBitmapSource;   
newFormatedBitmapSource.DestinationFormat = PixelFormats.Cmyk32;   
newFormatedBitmapSource.EndInit();   
  
BitmapEncoder encoder = new TiffBitmapEncoder();   
encoder.Frames.Add(BitmapFrame.Create(newFormatedBitmapSource));   
Stream cmykStream = new FileStream(@"C:\temp\mike4_CMYK.tif",
FileMode.Create, FileAccess.Write, FileShare.Write);   
encoder.Save(cmykStream);   
cmykStream.Close();  


Again, it would be great if someone could explain how to do it via GDAL
wrappers running on .NET 2.0 (I'm using GDAL build from FWTools).

Regards,
Maksim Sestic
 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Thursday, August 21, 2008 20:44
To: gdal-dev@lists.osgeo.org
Cc: Maksim Sestic
Subject: Re: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Maksim,

I've just done a few changes in the GeoTIFF driver to enable basic CMYK
support.

See the log message of http://trac.osgeo.org/gdal/changeset/15178.
And for examples : http://trac.osgeo.org/gdal/changeset/15179.

Regards,
Even

Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
> Hi all,
>
> I'm having troubles with gdal_translate while creating uncompressed 
> 3-band GTiff with CMYK photometric representation. Well, at least CMYK 
> representation recognized by Photoshop, which is 
> PhotometricInterpretation=5. If I use recommended gdal_translate -co 
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, 
> again, that's what Photoshop says (PhotometricInterpretation=1).
>
> What other -co parameters should I set to make it work? I'm using 
> gdal_translate from FWTools 2.2.3
>
>
> Here's the gdalinfo reports:
>
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
>
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and 
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>
>
> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>
> Driver: GTiff/GeoTIFF
> Files: 080417_75008_000000017_CMYK.tif Size is 945, 945 Coordinate 
> System is `'
> Metadata:
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined Band 4 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I 
>don't  really get (it's not recognized by gdalinfo) - here's the xmp
output:
> <tiff:NativeDigest
> 
>xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,
>284,
>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;4
>6BB97 3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>
>
> Regards,
> Maksim Sestic



__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com

 

__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com
 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

No virus found in this incoming message.
Checked by AVG - http://www.avg.com 
Version: 8.0.138 / Virus Database: 270.6.6/1625 - Release Date: 8/21/2008
6:04 AM



From huntc at internode.on.net  Fri Aug 22 06:08:02 2008
From: huntc at internode.on.net (Christopher Hunt)
Date: Fri Aug 22 06:08:07 2008
Subject: [gdal-dev] Guidance sought on using gdal-translate
In-Reply-To: <F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
References: <E268F017-2CDB-4968-A908-63280DA3C4A7@internode.on.net>
	<86A4D80B-9ED4-406F-8293-5BE9E7181CAB@internode.on.net>
	<FB1D14A7-39F2-4B39-86C0-E125C7BE543F@internode.on.net>
	<488F501E.3090608@pobox.com>
	<6FD022B3-B5AE-4D1C-9599-2FFA27BB2980@internode.on.net>
	<488FA29F.10501@pobox.com>
	<DB0F35D0-8235-4512-850C-0F6D8063B920@internode.on.net>
	<27F957A3-702E-4B78-808F-3BAF0AD3246F@internode.on.net>
	<48931775.9010601@pobox.com>
	<507C81FF-9130-4389-904E-5FC32FA36E81@internode.on.net>
	<931f8ea90808152105j56604d67wcdde647ed24b901c@mail.gmail.com>
	<F74E272F-D375-4D83-9E21-5916F1416B12@internode.on.net>
Message-ID: <735B509E-2222-4090-A1B6-6FFF8E907DF5@internode.on.net>

Hi Frank and friends,

Just to wrap this one up - we actually ended up receiving a geocoded  
image and I used gdal_translate to assign EPSG:27700 (the image was  
missing the coord sys declaration - this seems to be the case with a  
few image providers I've noticed):

gdal_translate -a_srs EPSG:27700 ...

Anyhow all good. Thanks for the help.

Cheers,
-C

On 16/08/2008, at 7:54 PM, Christopher Hunt wrote:

> Thanks for your reply Frank.
>
> On 16/08/2008, at 2:05 PM, Frank Warmerdam wrote:
>
>> I believe EPSG:27700 is British National Grid which is a projected
>> coordinate system based on the OSGB 1936 datum.  So you should
>> ensure the provider means the dataset is actually in BNG, in addition
>> to being based on OSGB 1936.
> OK, will do.
>
>> If you can get BNG coordinates then that is great.
> I've asked so fingers crossed.
>
>> If you can only
>> get WGS84 or OSGB1936 lat/long coordinates then you can
>> convert these to BNG using a program like cs2cs though that is
>> a bit tricky.
> Understood.
>
> Hopefully one last question on this though: the a_ullr parameters -  
> given the a_srs spec of EPSG:27700, are the a_ullr parameters  
> expected to be in BNG coordinates i.e. eastings and northings  
> values? Asking this another way, what actually dictates the  
> coordinate system used for the a_ullr parameters?
>
> Cheers,
> -C
>

From max at geoinova.com  Fri Aug 22 06:09:31 2008
From: max at geoinova.com (Maksim Sestic)
Date: Fri Aug 22 06:09:49 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <00e001c90438$89707ca0$9c5175e0$@miller@spatialminds.com>
Message-ID: <000601c9043f$32a33fa0$0501a8c0@max2>

Hi Craig,

Good tip, I'll give it a shot and see what comes out.

BTW, GTiff driver won't let you create CMY-only dataset (3 bands: C, M and
Y). 

I also sumbled onto this piece of code (if anyone's interested in
implementing it in GDAL) for both CMYK->RGB and RBG->CMYK conversions, based
on Adobe and Artifex algorithms:
http://svn.ghostscript.com/ghostscript/tags/gs-ghostpdl-1.50/src/gxdcconv.c

It seems that Adobe (Photoshop) keeps color "presets" in NATIVEDIGEST tiff
tag, but that's just an assumption.

Regards,
Maksim Sestic
 

-----Original Message-----
From: Craig Miller [mailto:craig.miller@spatialminds.com] 
Sent: Friday, August 22, 2008 11:22
To: 'Maksim Sestic'; gdal-dev@lists.osgeo.org
Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

I'm no expert on color conversions, but I am reading it as 1 = 100%.  So, if
you have an RGB image with values ranging from 0 - 255, then convert it to a
percent first then subtract it from R.  

For example, if you have RGB values of 200, 100, 255:

r = 200/255 = .7843
g = 100/255 = .3921
b = 255/255 = 1.0

Then CMY = (1-.7843, 1-.3921, 1-1.0) or (C=0.2157, M=0.6079, Y=0.0)

Craig


-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Maksim Sestic
Sent: Friday, August 22, 2008 12:40 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Hi Even,

Thanks for the info, but I need it other way round - RGB to CMYK conversion.
As Frank said, it's possible to create a CMYK result using gdal_translate
giving it an extra band as a parameter (i.e. -b 1 -b 2 -b 3 -b 1), but the
end result is of no use since that extra band (along with R, G and B) takes
some color mangling I'm not very familiar with. And there's not much to read
about it, here's what I found (citations ahead):

http://semmix.pl/color/extrans/etr10.htm

Transformation RGB, CMY, CMYK
Formal transformation of the components RGB into the components CMY or
inversely is as follows:

we have color RGB=(r,g,b) then color CMY=(1-r,1-g,1-b) we have color
CMY=(c,m,y) then color RGB=(1-c,1-m,1-y).

Transformation of CMY into CMYK is presented as algorithm:
k=min(c,m,y), CMYK=(c-k,m-k,y-k,k)

This explanation seems sane enough, but then: "we have color RGB=(r,g,b)
then color CMY=(1-r,1-g,1-b)" is giving me a headache with "1-r" etc. part.
What do they mean by "1-r"? :-)

Furthermore, RGB to CMYK is supported by .NET 3.5 only, and giving it a shot
via GDAL managed wrappers is also viable solution (thanks Tamas for
LoadBitmapDirect and SaveBitmapDirect C# examples). I'm working with .NET
2.0 and can't use this approach, but here's the code anyways (author
unknown):

using System;
using System.IO;
using System.Windows.Forms;
using System.Windows.Media;
using System.Windows.Media.Imaging;
...

Stream imageStream = new FileStream(@"C:\temp\mike4.jpg", FileMode.Open,
FileAccess.Read, FileShare.Read);   
BitmapSource myBitmapSource = BitmapFrame.Create(imageStream);   
  
FormatConvertedBitmap newFormatedBitmapSource = new FormatConvertedBitmap();

newFormatedBitmapSource.BeginInit();   
newFormatedBitmapSource.Source = myBitmapSource;   
newFormatedBitmapSource.DestinationFormat = PixelFormats.Cmyk32;   
newFormatedBitmapSource.EndInit();   
  
BitmapEncoder encoder = new TiffBitmapEncoder();   
encoder.Frames.Add(BitmapFrame.Create(newFormatedBitmapSource));   
Stream cmykStream = new FileStream(@"C:\temp\mike4_CMYK.tif",
FileMode.Create, FileAccess.Write, FileShare.Write);   
encoder.Save(cmykStream);   
cmykStream.Close();  


Again, it would be great if someone could explain how to do it via GDAL
wrappers running on .NET 2.0 (I'm using GDAL build from FWTools).

Regards,
Maksim Sestic
 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org]
Sent: Thursday, August 21, 2008 20:44
To: gdal-dev@lists.osgeo.org
Cc: Maksim Sestic
Subject: Re: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Maksim,

I've just done a few changes in the GeoTIFF driver to enable basic CMYK
support.

See the log message of http://trac.osgeo.org/gdal/changeset/15178.
And for examples : http://trac.osgeo.org/gdal/changeset/15179.

Regards,
Even

Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
> Hi all,
>
> I'm having troubles with gdal_translate while creating uncompressed 
> 3-band GTiff with CMYK photometric representation. Well, at least CMYK 
> representation recognized by Photoshop, which is 
> PhotometricInterpretation=5. If I use recommended gdal_translate -co 
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, 
> again, that's what Photoshop says (PhotometricInterpretation=1).
>
> What other -co parameters should I set to make it work? I'm using 
> gdal_translate from FWTools 2.2.3
>
>
> Here's the gdalinfo reports:
>
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
>
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and 
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>
>
> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>
> Driver: GTiff/GeoTIFF
> Files: 080417_75008_000000017_CMYK.tif Size is 945, 945 Coordinate 
> System is `'
> Metadata:
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined Band 4 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I 
>don't  really get (it's not recognized by gdalinfo) - here's the xmp
output:
> <tiff:NativeDigest
> 
>xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,
>284,
>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;4
>6BB97 3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>
>
> Regards,
> Maksim Sestic



__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com

 

__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com
 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

No virus found in this incoming message.
Checked by AVG - http://www.avg.com
Version: 8.0.138 / Virus Database: 270.6.6/1625 - Release Date: 8/21/2008
6:04 AM




__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com


From max at geoinova.com  Fri Aug 22 06:31:10 2008
From: max at geoinova.com (Maksim Sestic)
Date: Fri Aug 22 06:31:27 2008
Subject: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <00e001c90438$89707ca0$9c5175e0$@miller@spatialminds.com>
Message-ID: <000301c90442$391db290$0501a8c0@max2>

Finally, found some PHP code that makes sense :-)
(source: http://forums.digitalpoint.com/showthread.php?t=475864)


Parameters:
        $rgb    -   an array of color information where
                    $rgb[0] == red value
                    $rgb[1] == green value
                    $rgb[2] == blue value
    Returns:
        array containing cmyk color information:
            $array[0] == cyan value
            $array[1] == magenta value
            $array[2] == yellow value
            $array[3] == black value
*/
function RGB_to_CMYK($rgb)
{
    $cyan = 1 - ($rgb[0] / 255);
    $magenta = 1 - ($rgb[1] / 255);
    $yellow = 1 - ($rgb[2] / 255);

    $min = min($cyan, $magenta, $yellow);
    
    if ($min == 1)
        return array(0,0,0,1);

    $K = $min;
    $black = 1 - $K;

    return array
    (
        ($cyan - $K) / $black,
        ($magenta- $K) / $black,
        ($yellow - $K) / $black,
        $K
    );
}


Regards,
Maksim Sestic

 

-----Original Message-----
From: Craig Miller [mailto:craig.miller@spatialminds.com] 
Sent: Friday, August 22, 2008 11:22
To: 'Maksim Sestic'; gdal-dev@lists.osgeo.org
Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

I'm no expert on color conversions, but I am reading it as 1 = 100%.  So, if
you have an RGB image with values ranging from 0 - 255, then convert it to a
percent first then subtract it from R.  

For example, if you have RGB values of 200, 100, 255:

r = 200/255 = .7843
g = 100/255 = .3921
b = 255/255 = 1.0

Then CMY = (1-.7843, 1-.3921, 1-1.0) or (C=0.2157, M=0.6079, Y=0.0)

Craig


-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Maksim Sestic
Sent: Friday, August 22, 2008 12:40 AM
To: gdal-dev@lists.osgeo.org
Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Hi Even,

Thanks for the info, but I need it other way round - RGB to CMYK conversion.
As Frank said, it's possible to create a CMYK result using gdal_translate
giving it an extra band as a parameter (i.e. -b 1 -b 2 -b 3 -b 1), but the
end result is of no use since that extra band (along with R, G and B) takes
some color mangling I'm not very familiar with. And there's not much to read
about it, here's what I found (citations ahead):

http://semmix.pl/color/extrans/etr10.htm

Transformation RGB, CMY, CMYK
Formal transformation of the components RGB into the components CMY or
inversely is as follows:

we have color RGB=(r,g,b) then color CMY=(1-r,1-g,1-b) we have color
CMY=(c,m,y) then color RGB=(1-c,1-m,1-y).

Transformation of CMY into CMYK is presented as algorithm:
k=min(c,m,y), CMYK=(c-k,m-k,y-k,k)

This explanation seems sane enough, but then: "we have color RGB=(r,g,b)
then color CMY=(1-r,1-g,1-b)" is giving me a headache with "1-r" etc. part.
What do they mean by "1-r"? :-)

Furthermore, RGB to CMYK is supported by .NET 3.5 only, and giving it a shot
via GDAL managed wrappers is also viable solution (thanks Tamas for
LoadBitmapDirect and SaveBitmapDirect C# examples). I'm working with .NET
2.0 and can't use this approach, but here's the code anyways (author
unknown):

using System;
using System.IO;
using System.Windows.Forms;
using System.Windows.Media;
using System.Windows.Media.Imaging;
...

Stream imageStream = new FileStream(@"C:\temp\mike4.jpg", FileMode.Open,
FileAccess.Read, FileShare.Read);   
BitmapSource myBitmapSource = BitmapFrame.Create(imageStream);   
  
FormatConvertedBitmap newFormatedBitmapSource = new FormatConvertedBitmap();

newFormatedBitmapSource.BeginInit();   
newFormatedBitmapSource.Source = myBitmapSource;   
newFormatedBitmapSource.DestinationFormat = PixelFormats.Cmyk32;   
newFormatedBitmapSource.EndInit();   
  
BitmapEncoder encoder = new TiffBitmapEncoder();   
encoder.Frames.Add(BitmapFrame.Create(newFormatedBitmapSource));   
Stream cmykStream = new FileStream(@"C:\temp\mike4_CMYK.tif",
FileMode.Create, FileAccess.Write, FileShare.Write);   
encoder.Save(cmykStream);   
cmykStream.Close();  


Again, it would be great if someone could explain how to do it via GDAL
wrappers running on .NET 2.0 (I'm using GDAL build from FWTools).

Regards,
Maksim Sestic
 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org]
Sent: Thursday, August 21, 2008 20:44
To: gdal-dev@lists.osgeo.org
Cc: Maksim Sestic
Subject: Re: [Gdal-dev] GTiff / gdal_translate / CMYK - problem

Maksim,

I've just done a few changes in the GeoTIFF driver to enable basic CMYK
support.

See the log message of http://trac.osgeo.org/gdal/changeset/15178.
And for examples : http://trac.osgeo.org/gdal/changeset/15179.

Regards,
Even

Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
> Hi all,
>
> I'm having troubles with gdal_translate while creating uncompressed 
> 3-band GTiff with CMYK photometric representation. Well, at least CMYK 
> representation recognized by Photoshop, which is 
> PhotometricInterpretation=5. If I use recommended gdal_translate -co 
> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, 
> again, that's what Photoshop says (PhotometricInterpretation=1).
>
> What other -co parameters should I set to make it work? I'm using 
> gdal_translate from FWTools 2.2.3
>
>
> Here's the gdalinfo reports:
>
> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>  switch:
>
> Size is 945, 945
> Coordinate System is `'
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=MyApp
>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and 
> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>
>
> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>
> Driver: GTiff/GeoTIFF
> Files: 080417_75008_000000017_CMYK.tif Size is 945, 945 Coordinate 
> System is `'
> Metadata:
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>   TIFFTAG_XRESOLUTION=240
>   TIFFTAG_YRESOLUTION=240
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  945.0)
> Upper Right (  945.0,    0.0)
> Lower Right (  945.0,  945.0)
> Center      (  472.5,  472.5)
> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined Band 2 Block=945x2 
> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
> ColorInterp=Undefined Band 4 Block=945x2 Type=Byte, 
> ColorInterp=Undefined
>
> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I 
>don't  really get (it's not recognized by gdalinfo) - here's the xmp
output:
> <tiff:NativeDigest
> 
>xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,
>284,
>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;4
>6BB97 3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>
>
> Regards,
> Maksim Sestic



__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com

 

__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com
 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

No virus found in this incoming message.
Checked by AVG - http://www.avg.com
Version: 8.0.138 / Virus Database: 270.6.6/1625 - Release Date: 8/21/2008
6:04 AM




__________ Information from ESET NOD32 Antivirus, version of virus signature
database 2888 (20080220) __________

The message was checked by ESET NOD32 Antivirus.

http://www.eset.com


From max at geoinova.com  Fri Aug 22 07:09:58 2008
From: max at geoinova.com (Maksim Sestic)
Date: Fri Aug 22 07:10:00 2008
Subject: [gdal-dev] GTiff / gdal_translate / CMYK - problem
In-Reply-To: <00e001c90438$89707ca0$9c5175e0$@miller@spatialminds.com>
References: <200808212044.12724.even.rouault@mines-paris.org>
	<000001c9042a$3ec4eb40$0501a8c0@max2>
	<00e001c90438$89707ca0$9c5175e0$@miller@spatialminds.com>
Message-ID: <1219403398430-751427.post@n2.nabble.com>


Finally, found some PHP code that makes sense :-)
(source: http://forums.digitalpoint.com/showthread.php?t=475864)


Parameters:
        $rgb    -   an array of color information where
                    $rgb[0] == red value
                    $rgb[1] == green value
                    $rgb[2] == blue value
    Returns:
        array containing cmyk color information:
            $array[0] == cyan value
            $array[1] == magenta value
            $array[2] == yellow value
            $array[3] == black value
*/
function RGB_to_CMYK($rgb)
{
    $cyan = 1 - ($rgb[0] / 255);
    $magenta = 1 - ($rgb[1] / 255);
    $yellow = 1 - ($rgb[2] / 255);

    $min = min($cyan, $magenta, $yellow);
    
    if ($min == 1)
        return array(0,0,0,1);

    $K = $min;
    $black = 1 - $K;

    return array
    (
        ($cyan - $K) / $black,
        ($magenta- $K) / $black,
        ($yellow - $K) / $black,
        $K
    );
}


Regards,
Maksim Sestic



Craig Miller-2 wrote:
> 
> I'm no expert on color conversions, but I am reading it as 1 = 100%.  So,
> if
> you have an RGB image with values ranging from 0 - 255, then convert it to
> a
> percent first then subtract it from R.  
> 
> For example, if you have RGB values of 200, 100, 255:
> 
> r = 200/255 = .7843
> g = 100/255 = .3921
> b = 255/255 = 1.0
> 
> Then CMY = (1-.7843, 1-.3921, 1-1.0) or (C=0.2157, M=0.6079, Y=0.0)
> 
> Craig
> 
> 
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Maksim Sestic
> Sent: Friday, August 22, 2008 12:40 AM
> To: gdal-dev@lists.osgeo.org
> Subject: RE: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
> 
> Hi Even,
> 
> Thanks for the info, but I need it other way round - RGB to CMYK
> conversion.
> As Frank said, it's possible to create a CMYK result using gdal_translate
> giving it an extra band as a parameter (i.e. -b 1 -b 2 -b 3 -b 1), but the
> end result is of no use since that extra band (along with R, G and B)
> takes
> some color mangling I'm not very familiar with. And there's not much to
> read
> about it, here's what I found (citations ahead):
> 
> http://semmix.pl/color/extrans/etr10.htm
> 
> Transformation RGB, CMY, CMYK
> Formal transformation of the components RGB into the components CMY or
> inversely is as follows:
> 
> we have color RGB=(r,g,b) then color CMY=(1-r,1-g,1-b) we have color
> CMY=(c,m,y) then color RGB=(1-c,1-m,1-y).
> 
> Transformation of CMY into CMYK is presented as algorithm:
> k=min(c,m,y), CMYK=(c-k,m-k,y-k,k)
> 
> This explanation seems sane enough, but then: "we have color RGB=(r,g,b)
> then color CMY=(1-r,1-g,1-b)" is giving me a headache with "1-r" etc.
> part.
> What do they mean by "1-r"? :-)
> 
> Furthermore, RGB to CMYK is supported by .NET 3.5 only, and giving it a
> shot
> via GDAL managed wrappers is also viable solution (thanks Tamas for
> LoadBitmapDirect and SaveBitmapDirect C# examples). I'm working with .NET
> 2.0 and can't use this approach, but here's the code anyways (author
> unknown):
> 
> using System;
> using System.IO;
> using System.Windows.Forms;
> using System.Windows.Media;
> using System.Windows.Media.Imaging;
> ...
> 
> Stream imageStream = new FileStream(@"C:\temp\mike4.jpg", FileMode.Open,
> FileAccess.Read, FileShare.Read);   
> BitmapSource myBitmapSource = BitmapFrame.Create(imageStream);   
>   
> FormatConvertedBitmap newFormatedBitmapSource = new
> FormatConvertedBitmap();
> 
> newFormatedBitmapSource.BeginInit();   
> newFormatedBitmapSource.Source = myBitmapSource;   
> newFormatedBitmapSource.DestinationFormat = PixelFormats.Cmyk32;   
> newFormatedBitmapSource.EndInit();   
>   
> BitmapEncoder encoder = new TiffBitmapEncoder();   
> encoder.Frames.Add(BitmapFrame.Create(newFormatedBitmapSource));   
> Stream cmykStream = new FileStream(@"C:\temp\mike4_CMYK.tif",
> FileMode.Create, FileAccess.Write, FileShare.Write);   
> encoder.Save(cmykStream);   
> cmykStream.Close();  
> 
> 
> Again, it would be great if someone could explain how to do it via GDAL
> wrappers running on .NET 2.0 (I'm using GDAL build from FWTools).
> 
> Regards,
> Maksim Sestic
>  
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org] 
> Sent: Thursday, August 21, 2008 20:44
> To: gdal-dev@lists.osgeo.org
> Cc: Maksim Sestic
> Subject: Re: [Gdal-dev] GTiff / gdal_translate / CMYK - problem
> 
> Maksim,
> 
> I've just done a few changes in the GeoTIFF driver to enable basic CMYK
> support.
> 
> See the log message of http://trac.osgeo.org/gdal/changeset/15178.
> And for examples : http://trac.osgeo.org/gdal/changeset/15179.
> 
> Regards,
> Even
> 
> Le Wednesday 20 August 2008 11:46:06 Maksim Sestic, vous avez ?crit?:
>> Hi all,
>>
>> I'm having troubles with gdal_translate while creating uncompressed 
>> 3-band GTiff with CMYK photometric representation. Well, at least CMYK 
>> representation recognized by Photoshop, which is 
>> PhotometricInterpretation=5. If I use recommended gdal_translate -co 
>> 'PHOTOMETRIC=CMYK' switch I keep getting "grayscale" (!) result, 
>> again, that's what Photoshop says (PhotometricInterpretation=1).
>>
>> What other -co parameters should I set to make it work? I'm using 
>> gdal_translate from FWTools 2.2.3
>>
>>
>> Here's the gdalinfo reports:
>>
>> 1) For RGB raster parsed with gdal_translate -co 'PHOTOMETRIC=CMYK'
>>  switch:
>>
>> Size is 945, 945
>> Coordinate System is `'
>> Metadata:
>>   AREA_OR_POINT=Area
>>   TIFFTAG_SOFTWARE=MyApp
>>   TIFFTAG_DATETIME=20.08.2008 02:51:37
>>   TIFFTAG_XRESOLUTION=240
>>   TIFFTAG_YRESOLUTION=240
>>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>>   INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left  (    0.0,    0.0)
>> Lower Left  (    0.0,  945.0)
>> Upper Right (  945.0,    0.0)
>> Lower Right (  945.0,  945.0)
>> Center      (  472.5,  472.5)
>> Band 1 Block=945x2 Type=Byte, ColorInterp=Gray Band 2 Block=945x2 
>> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
>> ColorInterp=Undefined
>>
>> Side note: I also tried using -co 'PHOTOMETRIC=YCBCR' and 
>> 'PHOTOMETRIC=CIELAB'switches but then gdal_translate crashes.
>>
>>
>> 2) Photoshopped tiff with CMYK mode set (that's what I need to get):
>>
>> Driver: GTiff/GeoTIFF
>> Files: 080417_75008_000000017_CMYK.tif Size is 945, 945 Coordinate 
>> System is `'
>> Metadata:
>>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Windows
>>   TIFFTAG_DATETIME=2008:08:20 02:21:08
>>   TIFFTAG_XRESOLUTION=240
>>   TIFFTAG_YRESOLUTION=240
>>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) Image Structure Metadata:
>>   INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left  (    0.0,    0.0)
>> Lower Left  (    0.0,  945.0)
>> Upper Right (  945.0,    0.0)
>> Lower Right (  945.0,  945.0)
>> Center      (  472.5,  472.5)
>> Band 1 Block=945x2 Type=Byte, ColorInterp=Undefined Band 2 Block=945x2 
>> Type=Byte, ColorInterp=Undefined Band 3 Block=945x2 Type=Byte, 
>> ColorInterp=Undefined Band 4 Block=945x2 Type=Byte, 
>> ColorInterp=Undefined
>>
>> Also, there's another Photoshop's TIFF tag, "NativeDigest", which I 
>>don't  really get (it's not recognized by gdalinfo) - here's the xmp
> output:
>> <tiff:NativeDigest
>> 
>>xmlns:tiff="http://ns.adobe.com/tiff/1.0/">256,257,258,259,262,274,277,
>>284,
>>530,531,282,283,296,301,318,319,529,532,306,270,271,272,305,315,33432;4
>>6BB97 3B26CC7DED3A1C59F8F9AC7EC5</tiff:NativeDigest>
>>
>>
>> Regards,
>> Maksim Sestic
> 
> 
> 
> __________ Information from ESET NOD32 Antivirus, version of virus
> signature
> database 2888 (20080220) __________
> 
> The message was checked by ESET NOD32 Antivirus.
> 
> http://www.eset.com
> 
>  
> 
> __________ Information from ESET NOD32 Antivirus, version of virus
> signature
> database 2888 (20080220) __________
> 
> The message was checked by ESET NOD32 Antivirus.
> 
> http://www.eset.com
>  
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com 
> Version: 8.0.138 / Virus Database: 270.6.6/1625 - Release Date: 8/21/2008
> 6:04 AM
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/Re%3A-GTiff---gdal_translate---CMYK---problem-tp740987p751427.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From plieger at knmi.nl  Fri Aug 22 11:31:01 2008
From: plieger at knmi.nl (Maarten Plieger)
Date: Fri Aug 22 11:31:04 2008
Subject: [gdal-dev] Trac ADAGUC Wiki
Message-ID: <48AEDBB5.3080003@knmi.nl>

Hi,

In agreement with Frank I created an ADAGUC wiki on trac: 
http://trac.osgeo.org/gdal/wiki/ADAGUC. It describes the GDAL ADAGUC 
netCDF driver I have been working on. It has been created on basis of 
the original driver from Denis Nadeau and Frank Warmerdam.
The driver requires the latest netcdf4 and HDF5 libraries. The ADAGUC 
driver supports the creation of NetCDF3 and NetCDF4 files. ADAGUC netCDF 
files follow the Climate and Forecast (CF) 1.2 and ISO:19115 metadata 
conventions. Besides these conventions the format provides space for 
specific product metadata. The document describing the format will be 
released soon. More information about ADAGUC (Atmospheric Data Access 
for the Geospatial User Community) can be found here: http://adaguc.knmi.nl
*The ADAGUC format currently supports a maximum of three dimensions, 
which are X, Y and time.

This is the first release (v0.1) of the driver. If you are going to use 
it, please let me know if you experience any problems installing or 
using it. The wiki describes the installation instructions and provides 
some sample files.

Best Regards,
Maarten Plieger

-- 
Maarten Plieger
KNMI, R&D Information and Observation Technology, De Bilt
(t) +31 30 2206330 

From condit at sdsc.edu  Fri Aug 22 12:44:03 2008
From: condit at sdsc.edu (Christopher Condit)
Date: Fri Aug 22 12:44:11 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <41537.206.174.44.249.1219371178.squirrel@ssl.sfos.uaf.edu>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
	<845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
	<41537.206.174.44.249.1219371178.squirrel@ssl.sfos.uaf.edu>
Message-ID: <845AADAC1106E44996327D62097E4C6B010D39BC@et.ad.sdsc.edu>

Thanks, Steve. I see that it's working now.
It should be noted that the same call (with the u.u) worked in libdap
3.6.2.
I went ahead and closed this ticket.

-Chris

> -----Original Message-----
> From: gaffigan@sfos.uaf.edu [mailto:gaffigan@sfos.uaf.edu]
> Sent: Thursday, August 21, 2008 7:13 PM
> To: Christopher Condit
> Cc: Denis Nadeau; gdal-dev@lists.osgeo.org
> Subject: RE: [gdal-dev] netcdf driver
> 
> I think the source of the problem in ticket #2492 is not a GDAL
defect,
> but that the variable in the connection string is "u.u".  The
.operator
> is
> used to refer to members of a structure (see
> http://opendap.org/user/guide-html/guide_61.html), but the variables
in
> this dataset are grouped by grids (see
>
http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4.dds).
> It may be that using the .operator to access members of grids was
> allowed
> in older versions of libdap.  As it is, replacing "u.u" with "u"
> eliminates the problem for me on machines with libdap-3.8.2/gdal-
> svn15148
> and libdap-3.7.10/gdal-gdal-1.4.2, respectively.
> 
> Steve Gaffigan
> 
> gdalinfo -mm
>
"http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4?u[0]
> [0][y][x]"
> Driver: DODS/DAP 3.x servers
> Files: none associated
> Size is 720, 330
> Coordinate System is `'
> Origin = (0.000000000000000,-75.500000000000000)
> Pixel Size = (0.500000000000000,0.500000000000000)
> Corner Coordinates:
> Upper Left  (   0.0000000, -75.5000000)
> Lower Left  (   0.0000000,  89.5000000)
> Upper Right (     360.000,     -75.500)
> Lower Right (     360.000,      89.500)
> Center      ( 180.0000000,   7.0000000)
> Band 1 Block=720x128 Type=Float32, ColorInterp=Undefined
>     Computed Min/Max=-9989999710577420651746759362478080.000,1.407
>   NoData Value=-9.9899999999999995e+33
>   Overviews: 360x165, 180x82
> 
> 
> > Hi Denis-
> >
> > I put this patch in a few months ago addressing this libdap 3.8
> issue:
> >
> > http://trac.osgeo.org/gdal/ticket/2404
> >
> > This will get the code to build against libdap3.8 (primarily a
> namespace
> > problem), but there are still issues accessing DODS datasources:
> >
> > http://trac.osgeo.org/gdal/ticket/2492
> >
> >
> >
> > If you get some time to look into this it would be great...
> >
> >
> >
> > Thanks,
> >
> > -Chris
> >
> >
> >
> >
> >
> > From: gdal-dev-bounces@lists.osgeo.org
> > [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Denis Nadeau
> > Sent: Thursday, August 21, 2008 10:53 AM
> > To: gdal-dev@lists.osgeo.org
> > Subject: [gdal-dev] netcdf driver
> >
> >
> >
> > Hi,
> >
> > I will being doing some new development on netCDF driver to make it
> more
> > CF-1 Compliant.
> >
> > Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
> > --disable-netcdf)  I had to change all macros such as "MAX_NC_NAME"
> to
> > "H4_MAX_NC_NAME" and many other similar macros. Need to do some
> testing
> > on this.
> >
> > I also noticed that DODS (dodsdataset2.cpp) does not seem to compile
> > with libdap3.8.2.  There are some major changes in the library for
> C++.
> >
> > I will take a look into this as well, but do not promess anything...
> >
> > If you have suggestion of improvements for DODS, HDF4 and netCDF
> > drivers, let me know, I have a little bit of time this coming month.
> >
> > Regards,
> > Denis
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

From denis.nadeau at gmail.com  Fri Aug 22 13:44:00 2008
From: denis.nadeau at gmail.com (Denis Nadeau)
Date: Fri Aug 22 13:44:04 2008
Subject: [gdal-dev] netcdf driver
In-Reply-To: <41537.206.174.44.249.1219371178.squirrel@ssl.sfos.uaf.edu>
References: <304163b00808211053s182e4e62m14635a22f29bbdcb@mail.gmail.com>
	<845AADAC1106E44996327D62097E4C6B010D3948@et.ad.sdsc.edu>
	<41537.206.174.44.249.1219371178.squirrel@ssl.sfos.uaf.edu>
Message-ID: <304163b00808221044u42faab84qa2a924c1ffb11086@mail.gmail.com>

Hi Steve,

Thanks I'll look into this.

I think that   if you replace "u.u" with "u"  libdap will look into the
entire file to find a variable called "u" regardless of the structure.

Denis

2008/8/21 <gaffigan@sfos.uaf.edu>

> I think the source of the problem in ticket #2492 is not a GDAL defect,
> but that the variable in the connection string is "u.u".  The .operator is
> used to refer to members of a structure (see
> http://opendap.org/user/guide-html/guide_61.html), but the variables in
> this dataset are grouped by grids (see
> http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4.dds).
> It may be that using the .operator to access members of grids was allowed
> in older versions of libdap.  As it is, replacing "u.u" with "u"
> eliminates the problem for me on machines with libdap-3.8.2/gdal-svn15148
> and libdap-3.7.10/gdal-gdal-1.4.2, respectively.
>
> Steve Gaffigan
>
> gdalinfo -mm
> "
> http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4?u[0][0][y][x]<http://apdrc.soest.hawaii.edu/dods/public_data/SODA/soda_pop2.0.4?u%5B0%5D%5B0%5D%5By%5D%5Bx%5D>
> "
> Driver: DODS/DAP 3.x servers
> Files: none associated
> Size is 720, 330
> Coordinate System is `'
> Origin = (0.000000000000000,-75.500000000000000)
> Pixel Size = (0.500000000000000,0.500000000000000)
> Corner Coordinates:
> Upper Left  (   0.0000000, -75.5000000)
> Lower Left  (   0.0000000,  89.5000000)
> Upper Right (     360.000,     -75.500)
> Lower Right (     360.000,      89.500)
> Center      ( 180.0000000,   7.0000000)
> Band 1 Block=720x128 Type=Float32, ColorInterp=Undefined
>    Computed Min/Max=-9989999710577420651746759362478080.000,1.407
>  NoData Value=-9.9899999999999995e+33
>  Overviews: 360x165, 180x82
>
>
> > Hi Denis-
> >
> > I put this patch in a few months ago addressing this libdap 3.8 issue:
> >
> > http://trac.osgeo.org/gdal/ticket/2404
> >
> > This will get the code to build against libdap3.8 (primarily a namespace
> > problem), but there are still issues accessing DODS datasources:
> >
> > http://trac.osgeo.org/gdal/ticket/2492
> >
> >
> >
> > If you get some time to look into this it would be great...
> >
> >
> >
> > Thanks,
> >
> > -Chris
> >
> >
> >
> >
> >
> > From: gdal-dev-bounces@lists.osgeo.org
> > [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Denis Nadeau
> > Sent: Thursday, August 21, 2008 10:53 AM
> > To: gdal-dev@lists.osgeo.org
> > Subject: [gdal-dev] netcdf driver
> >
> >
> >
> > Hi,
> >
> > I will being doing some new development on netCDF driver to make it more
> > CF-1 Compliant.
> >
> > Note: when I compiled the netCDF 3.6.2  with HDF4.2r3 (with the flag
> > --disable-netcdf)  I had to change all macros such as "MAX_NC_NAME" to
> > "H4_MAX_NC_NAME" and many other similar macros. Need to do some testing
> > on this.
> >
> > I also noticed that DODS (dodsdataset2.cpp) does not seem to compile
> > with libdap3.8.2.  There are some major changes in the library for C++.
> >
> > I will take a look into this as well, but do not promess anything...
> >
> > If you have suggestion of improvements for DODS, HDF4 and netCDF
> > drivers, let me know, I have a little bit of time this coming month.
> >
> > Regards,
> > Denis
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080822/60226ded/attachment.html
From barry at pocket-link.com  Sat Aug 23 14:57:03 2008
From: barry at pocket-link.com (Barry Hollran)
Date: Sat Aug 23 14:57:05 2008
Subject: [gdal-dev] Help with GeoData
Message-ID: <1219517823706-778740.post@n2.nabble.com>


Hi All,

I am very new to geo data and need some help.

I will try and explain what I have and where I need to get to. I have
developed some custom software that reads in Google Map files. These are
organised in layers 0 - 20 with each image being a jpg file. Each file is
256 x 256 pipels in size. This software works OK at the moment. The data
that I am using is downloaded from google maps as I have only needed small
test datasets up until now. 

I have purchased a data set of Portugal which I have in 2 Formats (Mapinfo
and Arcview), I have choosen to use the Mapinfo data set. This has 8 Layers.
and is split into much larger tiles. i.e 6000ish by 6000ish pixels.

In short I need to convert all the mapinfo data to a google style dataset so
that the existing software can use it. I would also like to (if possible use
Mapserver to serve the new data so that I can store only the bits I need off
line)

Where I am now.

I have downloaded and installed GDAL and FWTools. 

using gdalinfo and ogrinfo for both data sets as well as google searches 

I think that the google data uses the wsg84 datum in  mercator projection.
(This does not mean a lot to me but I have read up as much as I can)

I think the Mapinfo data uses the wsg84 datum and a Lambert Conical
Projection

the Mpainfo tab file is:

!table
!version 300
!charset WindowsLatin1

Definition Table
File "8000000.TIF"
Type "RASTER"
(0,0) (0,2304) Label "Pt 1",
(0,7558272) (0,0) Label "Pt 2",
(7558272,7558272) (2304,0) Label "Pt 3",
(7558272,0) (2304,2304) Label "Pt 4"
CoordSys Earth Projection 3, 104, "m", 5, 49.08516574, 44, 54, 1507373,
1607866
Units "m"

And using gdalinfo i get the following:

Driver: GTiff/GeoTIFF
Files: 8000000.tif
Size is 2304, 2304
Coordinate System is `'
Origin = (0.000000000000000,7558272.000000000000000)
Pixel Size = (3280.500000000000000,-3280.500000000000000)
Metadata:
  TIFFTAG_XRESOLUTION=300
  TIFFTAG_YRESOLUTION=300
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (       0.000, 7558272.000) 
Lower Left  (   0.0000000,   0.0000000) 
Upper Right ( 7558272.000, 7558272.000) 
Lower Right ( 7558272.000,       0.000) 
Center      ( 3779136.000, 3779136.000) 
Band 1 Block=2304x8 Type=Byte, ColorInterp=Palette
  Image Structure Metadata:
    NBITS=4
  Color Table (RGB with 16 entries)
    0: 0,0,0,255
    1: 36,36,36,255
    2: 84,84,84,255
    3: 128,128,128,255
    4: 168,168,168,255
    5: 255,255,255,255
    6: 0,0,255,255
    7: 112,189,217,255
    8: 140,176,135,255
    9: 168,196,151,255
   10: 196,214,171,255
   11: 199,191,209,255
   12: 247,181,102,255
   13: 255,0,0,255
   14: 255,255,0,255
   15: 255,255,140,255

I have uploaded the tif file if it helps!

I have played with cs2cs to try and change the projection so that it would
be the same a s the google one(I dont even know if I need to do this, but
was experimenting)

If I under stand the above correctly the tif is 2304 pixels wide and each
pixel represents 3280.5 meters wide, so this tif represents a total size in
metrs of 7558272 wide, as can be seen in the top left size etc. But where is
this referenced from? I think I need to make sure that booth the google data
and mapinfo data are referenced from the same place.

Can any one please tell me the best way to try and acheive this?

A breakdown of steps would be great, and a confirmation of my understading
so far would also help.



Many thanks in advance.


Barry









http://n2.nabble.com/file/n778740/8000000.tif 8000000.tif 
http://n2.nabble.com/file/n778740/8000000.TAB 8000000.TAB 
-- 
View this message in context: http://n2.nabble.com/Help-with-GeoData-tp778740p778740.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Sat Aug 23 15:33:59 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug 23 15:34:04 2008
Subject: [gdal-dev] [Fwd: RE: ogr2gui on Linux]
Message-ID: <48B06627.2060309@loskot.net>

Folks,

Perhaps some of you will be interested in update note on ogr2gui.
See messages below.

-- mateusz

-------- Original Message --------
Subject: RE: ogr2gui on Linux
Date: Sat, 23 Aug 2008 13:29:20 -0400
From: Olivier Pilotte <xxx>
To: 'Mateusz Loskot' <mateusz@loskot.net>

M. Loskot,

The new version of ogr2gui is now available for download :
http://inventis.ca/ogr2gui (0.3)

Thanks a lot for the Makefile !

Best regards.

Olivier Pilotte, d?veloppeur

418.557.5001

olivier@inventis.ca

www.inventis.ca


-----Message d'origine-----
De : Mateusz Loskot [mailto:mateusz@loskot.net]
Envoy? : Wednesday, August 20, 2008 6:31 PM
? : developpement@inventis.ca
Objet : ogr2gui on Linux

Hi,

I've tried to build ogr2gui under Linux (Ubuntu 7.04) using GCC 4.1.2
and wxWidgets 2.8 but without success. There is large number of string
literals not wrapped with wxT() and GCC reports invalid conversions like:

Frm.cpp:537: Error: error: invalid conversion from ?const wchar_t*? to
?char?

Unfortunately, I've had no time to deal with these errors now but as I
see ogr2gui is not supported on Linux yet so I just decide to share my
experiences.
I'm attaching basic Makefile that I use to build ogr2gui. It's fairly
complete, and not based on autotools. Feel free to add it to the ogr2gui
distribution if you like.

Best regards.
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org


From even.rouault at mines-paris.org  Sat Aug 23 17:01:41 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Aug 23 17:01:46 2008
Subject: [gdal-dev] [Fwd: RE: ogr2gui on Linux]
In-Reply-To: <48B06627.2060309@loskot.net>
References: <48B06627.2060309@loskot.net>
Message-ID: <200808232301.42082.even.rouault@mines-paris.org>

I've attached a patch that enables ogr2gui to build on Linux and run 
successfully.

I'm not sure about the 'a_wx_string.mb_str(wxConvUTF8)' stuff that may not 
work on Windows but that is necessary on Linux to get an UTF8 string instead 
of a multi-byte unicode string. That unicode stuff in wxWidget is really a 
nightmare.

But there's also a very important fix that must be applied for all platforms. 
The OGRGetDriver ( an_integer ) call must be absolutely avoided ! It depends 
on the drivers that are build in the gdal library. That may change for each 
user (it didn't work with my GDAL build). Use OGRGetDriverByName 
( "the_name_of_the_driver") instead. Another thing, when opening an OGR 
dataset, you don't need to provide the driver. This is an output of the 
OGROpen call in fact, and you can pass NULL if you're not interested by 
knowing which source driver it is.

Best regards

Even
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Gui.cpp.patch
Type: text/x-diff
Size: 5522 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080823/fd1cec0b/Gui.cpp.bin
From even.rouault at mines-paris.org  Sat Aug 23 17:27:21 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Aug 23 17:27:24 2008
Subject: [gdal-dev] Amusing use of GDAL API : a GIMP plugin
Message-ID: <200808232327.21572.even.rouault@mines-paris.org>

At http://trac.osgeo.org/gdal/attachment/wiki/CodeSnippets/gimp-gdal.c, you'll 
find the source for a GIMP plugin that can open GDAL datasets.

Instructions how to build (on Unix), install and use are in the header of the 
file.

More fun than really usefull though, as (to the extent of my knowledge) GIMP 
must open entirely the dataset into memory at loading. So unless you have 
much RAM and patience, you won't be able to open big datasets.

Enjoy.
From szekerest at gmail.com  Sat Aug 23 17:51:18 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug 23 17:51:21 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<20080804133955.21684.qmail@mail.linux4all.at>
	<loom.20080804T164409-264@post.gmane.org>
	<48974699.8070801@loskot.net>
	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>
	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>
	<48AB30AC.2000509@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>
	<48AB3ED2.9010705@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>
Message-ID: <f3b73b7d0808231451o59ba804ag46c16c916dd1d9cc@mail.gmail.com>

2008/8/21 Norman Barker <nbarker@ittvis.com>:
> Tamas, Frank, all
>
> I have created RFC 24 on
>
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support
>
> for comment; hopefully the likes of mpg, simboss and others will chip in
> as well.
>
> Currently we are just defining an interface - but I am certainly
> interested in coding the driver (and probably will) as well.
>

Norman,

Just some quick notes, I've read this over but I'm still dubious about
the issues have been manifested earlier in this thread, namely:

1. It seems we are tending to spawn new threads in every RasterIO
operations at driver level, which is quite uncovenient at the moment,
therefore it should be considered with care. Will you allow RasterIO
to be re-entered from the GDALProgFunc event handler or by another
thread? Will you provide a copy of pBuff in GDALProgFunc or the same
pointer will be passed back to the caller? How this buffer will be
protected from the simultaneous access of the multiple threads?

2. How the intermediary data will be represented in the buffer
required by the various kind of rendering methods? Will the user
re-read the whole buffer in every roundtrip, or a subset of the data
will be definied that have been changed in the meantime? I guess some
cases only the modified scanlines or reduced resolution images would
be sufficient to read.

3. Interchange between the dataset and band level functions.

4. Supporting the the current synchronous mode in addition to the
asynchronous rendering mode.

5. With regard to the SWIG / C API would this be supported by means of
adding a new function name to the API like GDALBeginRasterIO or
GDALAsyncRasterIO for instance?


> If JPIP means nothing to you then check out http://iasdemo.ittvis.com
> and in the interest of fairness have a look at Lizardtech, Erdas and
> Kakadu as well!
>

Would this driver be an extension or a replacement of the currently
existing JP2KAK implementation? I can see some kind of support inside
for JPIP as well however I'm not sure if it is fully functional.


Best regards,

Tamas
From nowak at xpam.de  Sat Aug 23 20:08:05 2008
From: nowak at xpam.de (Adam Nowacki)
Date: Sat Aug 23 20:40:11 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>	<48974699.8070801@loskot.net>	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>	<48AB30AC.2000509@pobox.com>	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>	<48AB3ED2.9010705@pobox.com>
	<B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>
Message-ID: <48B0A665.1080503@xpam.de>

Norman Barker wrote:
> I have created RFC 24 on 
> 
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support

I'd suggest creating completely new interface for this.
Why is this better (imo):
- application decides when and how ofter the updates occur, minimal 
threading issues
- clearly defined synchronization points: NextAsyncRasterIOMessage(), 
LockBuffer(), UnlockBuffer()
- requests can be aborted with EndAsyncRasterIO();


class GDALAsyncRasterIOMessage {
   GDALAsyncRasterIO *asyncrasterio;

   void *userptr;

  // GARM_UPDATE, GARM_COMPLETE, GARM_ERROR, ...
   int what;

   int xoff, yoff;
   int xsize, ysize;
   // ...
};


class GDALAsyncRasterIO {
// lock a whole buffer
   void LockBuffer();

// lock only a block
   void LockBuffer(int xbufoff, int ybufoff, int xbufsize, int ybufsize);

   void UnlockBuffer();
};


class GDALAsyncDataset : public GDALDataset {
   GDALAsyncRasterIO *AsyncRasterIO( /* same as RasterIO */ , void 
*userptr);

   void EndAsyncRasterIO(GDALAsyncRasterIO *);

// if there are no new messages return NULL if wait is false or wait for 
new message if wait is true
   GDALAsyncRasterIOMessage *NextAsyncRasterIOMessage(bool wait);

   void ReleaseAsyncRasterIOMessage(GDALAsyncRasterIOMessage *m);
};




// ###############
//  How to use it
// ###############

GDALDataset *ds = GDALOpen( /* ... */, GA_ReadOnly);

// start asynchronous raster io, can have multiple running at same time
GDALAsyncRasterIO *r = ds->AsyncRasterIO(GF_Read, xoff, yoff, xsize, 
ysize, bufptr, bufxsize, bufysize, bufdatatype, 3, NULL, 0, 0, 0, userptr);

while (...) {
   GDALAsyncRasterIOMessage *m = ds->NextAsyncRasterIOMessage(true);

   if (m) {
     if (m->what == GARM_UPDATE) {
// lock the buffer so there will be no updates while we read from it
       m->asyncrasterio->LockBuffer( /* ... */ );

// display updated region

       m->asyncrasterio->UnlockBuffer();
     } else {
// handle completion, display error message, ...

     }

     ds->ReleaseAsyncRasterIOMessage(m);
   }

}

ds->EndAsyncRasterIO(r);

From nbarker at ittvis.com  Mon Aug 25 10:29:49 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Mon Aug 25 10:29:51 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org><20080804133955.21684.qmail@mail.linux4all.at><loom.20080804T164409-264@post.gmane.org>	<48974699.8070801@loskot.net>	<B1B624F7C110834B96594065A74F3A540916B469@gemini.rsinc.com>	<B1B624F7C110834B96594065A74F3A540916B475@gemini.rsinc.com>	<48AB30AC.2000509@pobox.com>	<B1B624F7C110834B96594065A74F3A540916B480@gemini.rsinc.com>	<48AB3ED2.9010705@pobox.com><B1B624F7C110834B96594065A74F3A540916B48F@gemini.rsinc.com>
	<48B0A665.1080503@xpam.de>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B4A0@gemini.rsinc.com>

Adam,

Thank you for your detailed reply, I am certainly considering it and I
will add it to the wiki for comment.  I will also be editing my notes to
take in Tamas comments.

I a couple of questions, I loosely based the callback function in the
RFC on the listener (observer) pattern
(http://en.wikipedia.org/wiki/Observer_pattern) which minimizes the
amount of client integration - with your proposal I can see that we need
the client to decide how often to update the screen this will require a
polling thread and a degree of synchronization with the data buffer
which imo result in poor display - the display could be blocky in
between updates rather than truly progressive.  With a callback function
the limiting factor is the refresh of the gui.  With the listener
pattern we can have multiple displays subscribe to the same source as
well (thumbnail, main etc.) - this is possible with your code too, but
the separation of events isn't there resulting in a master controller
function to decide who gets the updates.

Can you provide me of examples of the interface you propose working?  I
would like to consider it; coming from a java background the listener
pattern is pretty common and at the moment I am leaning towards that.

Norman



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Adam Nowacki
Sent: Saturday, August 23, 2008 6:08 PM
To: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman Barker wrote:
> I have created RFC 24 on 
> 
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support

I'd suggest creating completely new interface for this.
Why is this better (imo):
- application decides when and how ofter the updates occur, minimal 
threading issues
- clearly defined synchronization points: NextAsyncRasterIOMessage(), 
LockBuffer(), UnlockBuffer()
- requests can be aborted with EndAsyncRasterIO();


class GDALAsyncRasterIOMessage {
   GDALAsyncRasterIO *asyncrasterio;

   void *userptr;

  // GARM_UPDATE, GARM_COMPLETE, GARM_ERROR, ...
   int what;

   int xoff, yoff;
   int xsize, ysize;
   // ...
};


class GDALAsyncRasterIO {
// lock a whole buffer
   void LockBuffer();

// lock only a block
   void LockBuffer(int xbufoff, int ybufoff, int xbufsize, int
ybufsize);

   void UnlockBuffer();
};


class GDALAsyncDataset : public GDALDataset {
   GDALAsyncRasterIO *AsyncRasterIO( /* same as RasterIO */ , void 
*userptr);

   void EndAsyncRasterIO(GDALAsyncRasterIO *);

// if there are no new messages return NULL if wait is false or wait for

new message if wait is true
   GDALAsyncRasterIOMessage *NextAsyncRasterIOMessage(bool wait);

   void ReleaseAsyncRasterIOMessage(GDALAsyncRasterIOMessage *m);
};




// ###############
//  How to use it
// ###############

GDALDataset *ds = GDALOpen( /* ... */, GA_ReadOnly);

// start asynchronous raster io, can have multiple running at same time
GDALAsyncRasterIO *r = ds->AsyncRasterIO(GF_Read, xoff, yoff, xsize, 
ysize, bufptr, bufxsize, bufysize, bufdatatype, 3, NULL, 0, 0, 0,
userptr);

while (...) {
   GDALAsyncRasterIOMessage *m = ds->NextAsyncRasterIOMessage(true);

   if (m) {
     if (m->what == GARM_UPDATE) {
// lock the buffer so there will be no updates while we read from it
       m->asyncrasterio->LockBuffer( /* ... */ );

// display updated region

       m->asyncrasterio->UnlockBuffer();
     } else {
// handle completion, display error message, ...

     }

     ds->ReleaseAsyncRasterIOMessage(m);
   }

}

ds->EndAsyncRasterIO(r);

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From even.rouault at mines-paris.org  Mon Aug 25 17:40:57 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Aug 25 17:41:02 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed archives
	(.gz and .zip)
Message-ID: <200808252340.57728.even.rouault@mines-paris.org>

Folks,

I've just commited code in gdal 1.6.0dev SVN trunk that enables GDAL to 
decompress on-the-fly data from GZIP (.gz) and ZIP (.zip) archives.

This is implemented as 2 virtual file systems (like /vsimem for 
example), /vsigzip and /vsizip. Only read-only access is supported.

Note that performance will not be very impressive, as random access to ZIP 
file is slow by nature, although some optimizations have been made to make it 
faster and generally usable.

----------------------------------
To read from a .gz file,
----------------------------------
gdalinfo /vsigzip/path/to/the/file.gz were path/to/the/file.gz is relative or 
absolute.

The first time that a .gz file is read, a small .gz.properties file will be 
generated (if possible) to capture the uncompressed data size. This will make 
following opening of that dataset much faster.

--------------------------------------
* To read from a .zip file,
-------------------------------------
gdalinfo /vsizip/path/to/the/file.zip/path/inside/the/zip/file were 
path/to/the/file.zip is relative or absolute and path/inside/the/zip/file is 
the relative path to the file inside the archive.

For example gdalinfo /vsizip/myarchive.zip/subdir1/file1.tif

The ReadDir() method is implemented for the .zip archives, so a driver will be 
able to find files relative to the given file inside the archive. For 
example, you can read a CADRG dataset from the zipped archive of the a.toc 
file and all its NITF tiles.

Small syntaxic sugar : if the .zip file contains only one file located at its 
root, just mentionning "/vsizip/path/to/the/file.zip" will work.

------------------------------------------------

The fact that this new capability is implemented as virtual file systems imply 
that it will only work for GDAL drivers supporting the "large file API". A 
list of such drivers is : PNG, JPEG, ILWIS, GTiff, GIF, JP2KAK, NITF, ADRG, 
DTED, SRTMHGT, BMP, LCP, HFA (Erdas Imagine), AAIGRID. Other drivers may work 
too (I just looked for those advertizing the GDAL_DCAP_VIRTUALIO capability)

(See http://trac.osgeo.org/gdal/ticket/1369 for the history of that feature.)

Best regards

Even
From wendell at enflight.com  Tue Aug 26 09:41:04 2008
From: wendell at enflight.com (Wendell Turner)
Date: Tue Aug 26 09:46:52 2008
Subject: [gdal-dev] Telling lies with geotiif metadata
Message-ID: <20080826134104.GA26209@q.rho.net>

Hello!

I am trying to do something I probably shouldn't ...

I have about 30 geotiffs that tile the continental US (aviation sectional 
charts).  Each of them uses a slightly different projection -- LCC with 
different standard parallels and origins for each chart.

Using gdalwarp, I converted everything to a single projection -- epsg 3395 
-- but the quality suffered (I was never able to get any resampling method 
other than "near" to work properly; the colormaps kept getting screwed up.  
There doesn't seem to be any way to tell gdalwarp "stop trying to make a 
new colormap, just use the old one!")

The result is OK for display on a screen (I have a nifty OpenLayers 
interface to it), but I also need to print good-quality versions. Sometimes 
the prints will need to cross the boundaries between the geotiffs.  These 
prints also need to be at a (nearly) constant scale, which is inconsistent 
with using 3395 anyway, since it is a Mercator projection.

I could warp everything to some other projection (LCC with a single set of 
standard parallels, say) but I am willing to accept a small amount of 
mis-registration at the boundaries between charts if it would save me the 
loss of quality in the warp.  (In fact, people do this with the paper 
charts all the time -- at many airports you'll see multiple charts glued to 
the wall, abutting.  The misregistration is typically less than a few 
millimeters across a four-foot chart.)

[Of course, the misregistration is probably cumulative in some sense; with 
the paper charts one can simply "eyeball" the error and slide the chart so 
as to minimize it.  I'm not sure how to express this mathematically ... ]

So, what I am thinking of doing is to rewrite the geotiff metadata so as to 
simply lie about the projection.  gdal_translate has options called -a_srs 
and -a_ullr that appear to do at least part of what I want.

Is there a "null projection" that I could give to gdal_translate so as to 
not to munge any of the actual pixels?

Is there some better way of re-writing the geotiff metadata than by passing 
it through gdal_translate?

Is this a silly idea that I should receive the cartographic equivalent of 
being disbarred for even suggesting?
-- 

	   Many, many thanks for any insight that you can provide!

		- nick

[ I'm sending this to the list since Nick's email is inop a
the moment.  Wendell ]

From even.rouault at mines-paris.org  Tue Aug 26 13:10:48 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Aug 26 13:10:53 2008
Subject: [gdal-dev] Telling lies with geotiif metadata
In-Reply-To: <20080826134104.GA26209@q.rho.net>
References: <20080826134104.GA26209@q.rho.net>
Message-ID: <200808261910.49223.even.rouault@mines-paris.org>

Disclaimer : I just read the 2 first paragraphs. 

Indeed, if you want to be able to using bilinear resampling, cubic, etc..., 
you can't do that on a paletted dataset. You must convert it before to 24 
bit. So the solution is to pct2rgb.py your input files (or use the 
new -expand rgb|rgba option in gdal_translate in GDAL development version) 
and then warp them into epsg 3395. Then you should get correct quality.

Le Tuesday 26 August 2008 15:41:04 Wendell Turner, vous avez ?crit?:
> Hello!
>
> I am trying to do something I probably shouldn't ...
>
> I have about 30 geotiffs that tile the continental US (aviation sectional
> charts).  Each of them uses a slightly different projection -- LCC with
> different standard parallels and origins for each chart.
>
> Using gdalwarp, I converted everything to a single projection -- epsg 3395
> -- but the quality suffered (I was never able to get any resampling method
> other than "near" to work properly; the colormaps kept getting screwed up.
> There doesn't seem to be any way to tell gdalwarp "stop trying to make a
> new colormap, just use the old one!")
>
> The result is OK for display on a screen (I have a nifty OpenLayers
> interface to it), but I also need to print good-quality versions. Sometimes
> the prints will need to cross the boundaries between the geotiffs.  These
> prints also need to be at a (nearly) constant scale, which is inconsistent
> with using 3395 anyway, since it is a Mercator projection.
>
> I could warp everything to some other projection (LCC with a single set of
> standard parallels, say) but I am willing to accept a small amount of
> mis-registration at the boundaries between charts if it would save me the
> loss of quality in the warp.  (In fact, people do this with the paper
> charts all the time -- at many airports you'll see multiple charts glued to
> the wall, abutting.  The misregistration is typically less than a few
> millimeters across a four-foot chart.)
>
> [Of course, the misregistration is probably cumulative in some sense; with
> the paper charts one can simply "eyeball" the error and slide the chart so
> as to minimize it.  I'm not sure how to express this mathematically ... ]
>
> So, what I am thinking of doing is to rewrite the geotiff metadata so as to
> simply lie about the projection.  gdal_translate has options called -a_srs
> and -a_ullr that appear to do at least part of what I want.
>
> Is there a "null projection" that I could give to gdal_translate so as to
> not to munge any of the actual pixels?
>
> Is there some better way of re-writing the geotiff metadata than by passing
> it through gdal_translate?
>
> Is this a silly idea that I should receive the cartographic equivalent of
> being disbarred for even suggesting?


From Doug_Newcomb at fws.gov  Tue Aug 26 15:34:13 2008
From: Doug_Newcomb at fws.gov (Doug_Newcomb@fws.gov)
Date: Tue Aug 26 15:44:16 2008
Subject: [gdal-dev] Shapefile reprojection - copy and update metadata file
Message-ID: <OFA1F98B63.DFA78A79-ON852574B1.00679B00-852574B1.006B80E8@fws.gov>


Hi Folks,
      Before I try to clumsily reinvent the wheel, I'd like to know if
someone has a method to :

      1) use ogr2ogr to reproject a shape file ( easy enough ).
      2) after the above projection copy the .xml file   (if it exists)
from the old shapefile to the new shapefile (easy as well).
      3) Update the copied .xml file to reflect the new projection
information, and possibly the action of projecting (the fun part :-)) .

Doug

Doug Newcomb
USFWS
Raleigh, NC
919-856-4520 ext. 14 doug_newcomb@fws.gov
---------------------------------------------------------------------------------------------------------

The opinions I express are my own and are not representative of the
official policy of the U.S.Fish and Wildlife Service or Dept. of Interior.
Life is too short for undocumented, proprietary data formats.

From even.rouault at mines-paris.org  Tue Aug 26 15:52:44 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Aug 26 15:52:49 2008
Subject: [gdal-dev] Shapefile reprojection - copy and update metadata file
In-Reply-To: <OFA1F98B63.DFA78A79-ON852574B1.00679B00-852574B1.006B80E8@fws.gov>
References: <OFA1F98B63.DFA78A79-ON852574B1.00679B00-852574B1.006B80E8@fws.gov>
Message-ID: <200808262152.45238.even.rouault@mines-paris.org>

I've no idea of what the XML file you are refering too is.

The OGR Shape driver only handles the .shp, .shx, .dbf, .prj and .qix 
extensions for shapefiles.

Le Tuesday 26 August 2008 21:34:13 Doug_Newcomb@fws.gov, vous avez ?crit?:
> Hi Folks,
>       Before I try to clumsily reinvent the wheel, I'd like to know if
> someone has a method to :
>
>       1) use ogr2ogr to reproject a shape file ( easy enough ).
>       2) after the above projection copy the .xml file   (if it exists)
> from the old shapefile to the new shapefile (easy as well).
>       3) Update the copied .xml file to reflect the new projection
> information, and possibly the action of projecting (the fun part :-)) .
>
> Doug
>
> Doug Newcomb
> USFWS
> Raleigh, NC
> 919-856-4520 ext. 14 doug_newcomb@fws.gov
> ---------------------------------------------------------------------------
>------------------------------
>
> The opinions I express are my own and are not representative of the
> official policy of the U.S.Fish and Wildlife Service or Dept. of Interior.
> Life is too short for undocumented, proprietary data formats.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From craig.miller at spatialminds.com  Wed Aug 27 00:04:37 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Aug 27 00:04:46 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
Message-ID: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>

I am working with an in-house utility written a couple of years ago that
uses the MEM driver.  Recently, after upgrading to Vista64 the utility
stopped working.  As it was using an old version of GDAL, I decided to fetch
the source from the vault and recompile/link against GDAL 1.5.2.  I didn't
change any code, but the new utility is failing with "ERROR 1:  Missing
required field (one of PIXELS, LINES, or DATAPOINTER)"

I'm assuming the problem is either incorrect source (old code), a 64 bit
issue, or a GDAL version issue.  Before I start modifying the code to
allocate memory and include a DATAPOINTER I thought I'd ask if there were
any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause this
or if it is a well known Vista 64 problem?
 
Here's the snippet of code that is fails on the poMemDriver->Create(.) line:


	GDALDriver* poMemDriver;
	CString format = "MEM";
	CString filename = "MEM:::";

	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
	if (poMemDriver == NULL)
	{
		cout << "\"MEM\" driver not supported." <<  endl;
		return false;
	}
	m_poUtmRgbDataset = poMemDriver->Create( filename,
		m_poSrcDataset->GetRasterXSize(), 
		m_poSrcDataset->GetRasterYSize(), 
		3,  // 3 Bands, Red, Green, and Blue
		GDT_Byte,
		NULL);



From Chris.Eustace at petrosys.com.au  Wed Aug 27 00:42:36 2008
From: Chris.Eustace at petrosys.com.au (Chris Eustace)
Date: Wed Aug 27 01:15:30 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
In-Reply-To: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>
References: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>
Message-ID: <48B4DB3C.9050105@petrosys.com.au>

I had a near identical issue when upgrading from V1.4.x to V1.5.2.

The code checks the name passed in as the "filename" to Create(). ONLY 
if it is of the form "MEM:::" will it then look for other expected 
parameters (including PIXELS, LINES and DATAPOINTER). Otherwise, the 
passed in filename is pretty much ignored.

So, the actual answer is to rename "MEM:::" as anything else and you 
will be fine.

Chris Eustace.

Craig Miller wrote:
> I am working with an in-house utility written a couple of years ago that
> uses the MEM driver.  Recently, after upgrading to Vista64 the utility
> stopped working.  As it was using an old version of GDAL, I decided to fetch
> the source from the vault and recompile/link against GDAL 1.5.2.  I didn't
> change any code, but the new utility is failing with "ERROR 1:  Missing
> required field (one of PIXELS, LINES, or DATAPOINTER)"
>
> I'm assuming the problem is either incorrect source (old code), a 64 bit
> issue, or a GDAL version issue.  Before I start modifying the code to
> allocate memory and include a DATAPOINTER I thought I'd ask if there were
> any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause this
> or if it is a well known Vista 64 problem?
>  
> Here's the snippet of code that is fails on the poMemDriver->Create(.) line:
>
>
> 	GDALDriver* poMemDriver;
> 	CString format = "MEM";
> 	CString filename = "MEM:::";
>
> 	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
> 	if (poMemDriver == NULL)
> 	{
> 		cout << "\"MEM\" driver not supported." <<  endl;
> 		return false;
> 	}
> 	m_poUtmRgbDataset = poMemDriver->Create( filename,
> 		m_poSrcDataset->GetRasterXSize(), 
> 		m_poSrcDataset->GetRasterYSize(), 
> 		3,  // 3 Bands, Red, Green, and Blue
> 		GDT_Byte,
> 		NULL);
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>   




From Konstantin.Baumann at hpi.uni-potsdam.de  Wed Aug 27 03:00:50 2008
From: Konstantin.Baumann at hpi.uni-potsdam.de (Baumann, Konstantin)
Date: Wed Aug 27 03:19:26 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed
	archives(.gz and .zip)
In-Reply-To: <200808252340.57728.even.rouault@mines-paris.org>
References: <200808252340.57728.even.rouault@mines-paris.org>
Message-ID: <5AC0F51A926CD442BC08D55DA7DAB1D40C7E1913@3mxma1r.hpi.uni-potsdam.de>

Hi Even!

That sounds cool. Is there also a function for retrieving all available
files inside of a ZIP archive?

Kind regards,
	Kosta 

> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org] 
> Sent: Monday, August 25, 2008 11:41 PM
> To: gdal-dev@lists.osgeo.org
> Subject: [gdal-dev] Support for reading GDAL datasets in 
> compressed archives(.gz and .zip)
> 
> Folks,
> 
> I've just commited code in gdal 1.6.0dev SVN trunk that 
> enables GDAL to 
> decompress on-the-fly data from GZIP (.gz) and ZIP (.zip) archives.
> 
> This is implemented as 2 virtual file systems (like /vsimem for 
> example), /vsigzip and /vsizip. Only read-only access is supported.
> 
> Note that performance will not be very impressive, as random 
> access to ZIP 
> file is slow by nature, although some optimizations have been 
> made to make it 
> faster and generally usable.
> 
> ----------------------------------
> To read from a .gz file,
> ----------------------------------
> gdalinfo /vsigzip/path/to/the/file.gz were 
> path/to/the/file.gz is relative or 
> absolute.
> 
> The first time that a .gz file is read, a small 
> .gz.properties file will be 
> generated (if possible) to capture the uncompressed data 
> size. This will make 
> following opening of that dataset much faster.
> 
> --------------------------------------
> * To read from a .zip file,
> -------------------------------------
> gdalinfo /vsizip/path/to/the/file.zip/path/inside/the/zip/file were 
> path/to/the/file.zip is relative or absolute and 
> path/inside/the/zip/file is 
> the relative path to the file inside the archive.
> 
> For example gdalinfo /vsizip/myarchive.zip/subdir1/file1.tif
> 
> The ReadDir() method is implemented for the .zip archives, so 
> a driver will be 
> able to find files relative to the given file inside the archive. For 
> example, you can read a CADRG dataset from the zipped archive 
> of the a.toc 
> file and all its NITF tiles.
> 
> Small syntaxic sugar : if the .zip file contains only one 
> file located at its 
> root, just mentionning "/vsizip/path/to/the/file.zip" will work.
> 
> ------------------------------------------------
> 
> The fact that this new capability is implemented as virtual 
> file systems imply 
> that it will only work for GDAL drivers supporting the "large 
> file API". A 
> list of such drivers is : PNG, JPEG, ILWIS, GTiff, GIF, 
> JP2KAK, NITF, ADRG, 
> DTED, SRTMHGT, BMP, LCP, HFA (Erdas Imagine), AAIGRID. Other 
> drivers may work 
> too (I just looked for those advertizing the 
> GDAL_DCAP_VIRTUALIO capability)
> 
> (See http://trac.osgeo.org/gdal/ticket/1369 for the history 
> of that feature.)
> 
> Best regards
> 
> Even
> 
> 
From warmerdam at pobox.com  Wed Aug 27 09:43:01 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Aug 27 09:43:37 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed
	archives(.gz and .zip)
In-Reply-To: <5AC0F51A926CD442BC08D55DA7DAB1D40C7E1913@3mxma1r.hpi.uni-potsdam.de>
References: <200808252340.57728.even.rouault@mines-paris.org>
	<5AC0F51A926CD442BC08D55DA7DAB1D40C7E1913@3mxma1r.hpi.uni-potsdam.de>
Message-ID: <48B559E5.5050704@pobox.com>

Baumann, Konstantin wrote:
> Hi Even!
> 
> That sounds cool. Is there also a function for retrieving all available
> files inside of a ZIP archive?

Kosta,

Programatically this can presumably be accomplished with VSIReadDir()
(aka CPLReadDir()).

char CPL_DLL **VSIReadDir( const char * );

The VSI filesystem operations should generally work on virtual
file systems, though in the case of the zip driver I presume all the
update operations (like VSIRename() or VSIUnlink()) are unimplemented.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ivan.lucena at pmldnet.com  Wed Aug 27 09:58:54 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Wed Aug 27 09:58:56 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed
	archives (.gz and .zip)
In-Reply-To: <200808252340.57728.even.rouault@mines-paris.org>
References: <200808252340.57728.even.rouault@mines-paris.org>
Message-ID: <48B55D9E.6040705@pmldnet.com>

Rouault,

Nice job!

Even Rouault wrote:
> ----------------------------------
> To read from a .gz file,
> ----------------------------------
> gdalinfo /vsigzip/path/to/the/file.gz were path/to/the/file.gz is relative or 
> absolute.
> 
> The first time that a .gz file is read, a small .gz.properties file will be 
> generated (if possible) to capture the uncompressed data size. This will make 
> following opening of that dataset much faster.

Suggestion:

Would be interesting to bring the content of "file.gz" as subdatasets:

Subdatasets:
   SUBDATASET_1_NAME=/vsizip/myarchive.zip/subdir1/file1.tif
   SUBDATASET_1_DESC=GeoTiff,100x110x1
   SUBDATASET_2_NAME=/vsizip/myarchive.zip/subdir1/file2.tif
   SUBDATASET_2_DESC=GeoTiff,100x110x1
   SUBDATASET_3_NAME=/vsizip/myarchive.zip/subdir1/file3.tif
   SUBDATASET_3_DESC=GeoTiff,100x110x1

What do you think?

> Small syntaxic sugar : if the .zip file contains only one file located at its 
> root, just mentionning "/vsizip/path/to/the/file.zip" will work.

The same would apply to subdatasets, I guess.

> The fact that this new capability is implemented as virtual file systems imply 
> that it will only work for GDAL drivers supporting the "large file API". A 
> list of such drivers is : PNG, JPEG, ILWIS, GTiff, GIF, JP2KAK, NITF, ADRG, 
> DTED, SRTMHGT, BMP, LCP, HFA (Erdas Imagine), AAIGRID. Other drivers may work 
> too (I just looked for those advertizing the GDAL_DCAP_VIRTUALIO capability)

That all we need? Nice!

Best regards,

Ivan


From cavicchi at ferrara.linux.it  Wed Aug 27 11:00:34 2008
From: cavicchi at ferrara.linux.it (Mario Cavicchi)
Date: Wed Aug 27 11:09:03 2008
Subject: [gdal-dev] HDF4 extrac lat/lon subdatasets...
Message-ID: <48B56C12.60506@ferrara.linux.it>

Hi All,
I must extract from a HDF MOD03 file the subdatasets of latitude and
longitude. if I open the image with ENVI, in the list of subdatasets, I
read this list:

Latitude
Longitude
Height
SensorZenith
SensorAzimuth
Range
SolarZenith
SolarAzimuth
Land/SeaMask
gflags

instead the command gdalinfo shows this list of subdatasets:

Subdatasets:

SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:Height
  SUBDATASET_1_DESC=[2030x1354] Height MODIS_Swath_Type_GEO (16-bit integer)
SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:SensorZenith
  SUBDATASET_2_DESC=[2030x1354] SensorZenith MODIS_Swath_Type_GEO
(16-bit integer)
SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:SensorAzimuth
  SUBDATASET_3_DESC=[2030x1354] SensorAzimuth MODIS_Swath_Type_GEO
(16-bit integer)
SUBDATASET_4_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:Range
  SUBDATASET_4_DESC=[2030x1354] Range MODIS_Swath_Type_GEO (16-bit
unsigned integer)
SUBDATASET_5_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:SolarZenith
  SUBDATASET_5_DESC=[2030x1354] SolarZenith MODIS_Swath_Type_GEO (16-bit
integer)
SUBDATASET_6_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:SolarAzimuth
  SUBDATASET_6_DESC=[2030x1354] SolarAzimuth MODIS_Swath_Type_GEO
(16-bit integer)
SUBDATASET_7_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:Land/SeaMask
  SUBDATASET_7_DESC=[2030x1354] Land/SeaMask MODIS_Swath_Type_GEO (8-bit
unsigned integer)
SUBDATASET_8_NAME=HDF4_EOS:EOS_SWATH:"MOD03.A2006159.1045.005.2008113013452.hdf":MODIS_Swath_Type_GEO:gflags
  SUBDATASET_8_DESC=[2030x1354] gflags MODIS_Swath_Type_GEO (8-bit
unsigned integer)

How I can get the first and the second dataset?

Thanks to all. Regards.

-- 
Ciao,
        Mario

[ Web Info: http://members.ferrara.linux.it/cavicchi ]
From craig.miller at spatialminds.com  Wed Aug 27 14:27:01 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Aug 27 14:27:11 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
In-Reply-To: <48B4DB3C.9050105@petrosys.com.au>
References: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>
	<48B4DB3C.9050105@petrosys.com.au>
Message-ID: <01c801c90872$800fc1a0$802f44e0$@miller@spatialminds.com>

Thanks Chris.   That did the trick.

Perhaps a quick note could be added to the MEM driver doc page?

Craig


-----Original Message-----
From: Chris Eustace [mailto:Chris.Eustace@petrosys.com.au] 
Sent: Tuesday, August 26, 2008 9:43 PM
To: Craig Miller
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] MEM Driver under Vista 64?

I had a near identical issue when upgrading from V1.4.x to V1.5.2.

The code checks the name passed in as the "filename" to Create(). ONLY 
if it is of the form "MEM:::" will it then look for other expected 
parameters (including PIXELS, LINES and DATAPOINTER). Otherwise, the 
passed in filename is pretty much ignored.

So, the actual answer is to rename "MEM:::" as anything else and you 
will be fine.

Chris Eustace.

Craig Miller wrote:
> I am working with an in-house utility written a couple of years ago that
> uses the MEM driver.  Recently, after upgrading to Vista64 the utility
> stopped working.  As it was using an old version of GDAL, I decided to
fetch
> the source from the vault and recompile/link against GDAL 1.5.2.  I didn't
> change any code, but the new utility is failing with "ERROR 1:  Missing
> required field (one of PIXELS, LINES, or DATAPOINTER)"
>
> I'm assuming the problem is either incorrect source (old code), a 64 bit
> issue, or a GDAL version issue.  Before I start modifying the code to
> allocate memory and include a DATAPOINTER I thought I'd ask if there were
> any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause
this
> or if it is a well known Vista 64 problem?
>  
> Here's the snippet of code that is fails on the poMemDriver->Create(.)
line:
>
>
> 	GDALDriver* poMemDriver;
> 	CString format = "MEM";
> 	CString filename = "MEM:::";
>
> 	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
> 	if (poMemDriver == NULL)
> 	{
> 		cout << "\"MEM\" driver not supported." <<  endl;
> 		return false;
> 	}
> 	m_poUtmRgbDataset = poMemDriver->Create( filename,
> 		m_poSrcDataset->GetRasterXSize(), 
> 		m_poSrcDataset->GetRasterYSize(), 
> 		3,  // 3 Bands, Red, Green, and Blue
> 		GDT_Byte,
> 		NULL);
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>   





No virus found in this incoming message.
Checked by AVG - http://www.avg.com 
Version: 8.0.138 / Virus Database: 270.6.9/1635 - Release Date: 8/26/2008
7:29 AM



From even.rouault at mines-paris.org  Wed Aug 27 14:28:51 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 14:28:58 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed
	archives(.gz and .zip)
In-Reply-To: <48B559E5.5050704@pobox.com>
References: <200808252340.57728.even.rouault@mines-paris.org>
	<5AC0F51A926CD442BC08D55DA7DAB1D40C7E1913@3mxma1r.hpi.uni-potsdam.de>
	<48B559E5.5050704@pobox.com>
Message-ID: <200808272028.52346.even.rouault@mines-paris.org>

Konstantin,

Frank is correct.

Let's suppose you have an archive archive.zip with the following content :

"file1"
"dir1/"
"dir1/dir1file1"
"dir1/dir1file2"
"file2"

(After r15231), the behaviour of VSIReadDir and VSIStatL is similar to the 
behaviour of those functions as if archive.zip was a directory with its 
content at its base.

That is to say, you can do VSIReadDir("/vsizip/path/to/your/archive.zip") and 
it will return :
"file1"
"dir1"
"file2"

If you do VSIReadDir("/vsizip/path/to/your/archive.zip/dir1"), it will 
return :
"dir1file1"
"dir1file2"

And yes, the /vsigzip and /vsizip filesystems are read-only. No rename, 
deletion, write etc is possible.

Le Wednesday 27 August 2008 15:43:01 Frank Warmerdam, vous avez ?crit?:
> Baumann, Konstantin wrote:
> > Hi Even!
> >
> > That sounds cool. Is there also a function for retrieving all available
> > files inside of a ZIP archive?
>
> Kosta,
>
> Programatically this can presumably be accomplished with VSIReadDir()
> (aka CPLReadDir()).
>
> char CPL_DLL **VSIReadDir( const char * );
>
> The VSI filesystem operations should generally work on virtual
> file systems, though in the case of the zip driver I presume all the
> update operations (like VSIRename() or VSIUnlink()) are unimplemented.
>
> Best regards,


From even.rouault at mines-paris.org  Wed Aug 27 14:34:19 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 14:34:23 2008
Subject: [gdal-dev] Support for reading GDAL datasets in compressed
	archives (.gz and .zip)
In-Reply-To: <48B55D9E.6040705@pmldnet.com>
References: <200808252340.57728.even.rouault@mines-paris.org>
	<48B55D9E.6040705@pmldnet.com>
Message-ID: <200808272034.19732.even.rouault@mines-paris.org>

Le Wednesday 27 August 2008 15:58:54 Lucena, Ivan, vous avez ?crit?:
> Rouault,
>
> Nice job!
>
> Even Rouault wrote:
> > ----------------------------------
> > To read from a .gz file,
> > ----------------------------------
> > gdalinfo /vsigzip/path/to/the/file.gz were path/to/the/file.gz is
> > relative or absolute.
> >
> > The first time that a .gz file is read, a small .gz.properties file will
> > be generated (if possible) to capture the uncompressed data size. This
> > will make following opening of that dataset much faster.
>
> Suggestion:
>
> Would be interesting to bring the content of "file.gz" as subdatasets:
>
> Subdatasets:
>    SUBDATASET_1_NAME=/vsizip/myarchive.zip/subdir1/file1.tif
>    SUBDATASET_1_DESC=GeoTiff,100x110x1
>    SUBDATASET_2_NAME=/vsizip/myarchive.zip/subdir1/file2.tif
>    SUBDATASET_2_DESC=GeoTiff,100x110x1
>    SUBDATASET_3_NAME=/vsizip/myarchive.zip/subdir1/file3.tif
>    SUBDATASET_3_DESC=GeoTiff,100x110x1
>
> What do you think?

In fact a .gz file is just one single compressed file (I do not 
handle .tar.gz), so it does not make sense for that format.

It could make more sense for .zip files. But what you propose is not directly 
linked to zip files. It would be true of regular directories on 
the "classical" file system. And I'm not sure that all GDAL files under a 
directory can be considered as subdatasets of that directory. That behaviour 
should be clearly specified, and I think it belongs to the application level, 
not to the library one.

>
> > Small syntaxic sugar : if the .zip file contains only one file located at
> > its root, just mentionning "/vsizip/path/to/the/file.zip" will work.
>
> The same would apply to subdatasets, I guess.
>
> > The fact that this new capability is implemented as virtual file systems
> > imply that it will only work for GDAL drivers supporting the "large file
> > API". A list of such drivers is : PNG, JPEG, ILWIS, GTiff, GIF, JP2KAK,
> > NITF, ADRG, DTED, SRTMHGT, BMP, LCP, HFA (Erdas Imagine), AAIGRID. Other
> > drivers may work too (I just looked for those advertizing the
> > GDAL_DCAP_VIRTUALIO capability)
>
> That all we need? Nice!
>
> Best regards,
>
> Ivan


From even.rouault at mines-paris.org  Wed Aug 27 14:54:18 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 14:56:02 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
In-Reply-To: <01c801c90872$800fc1a0$802f44e0$@miller@spatialminds.com>
References: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>
	<48B4DB3C.9050105@petrosys.com.au>
	<01c801c90872$800fc1a0$802f44e0$@miller@spatialminds.com>
Message-ID: <200808272054.19105.even.rouault@mines-paris.org>

Craig

In fact the true reason is that the Create() method begins by trying to 
destroy the dataset by calling the Delete() method on it. And that was new to 
GDAL 1.5.0.

So when you do some_driver->Create("MEM:::"), the identify method of the MEM 
driver detects that "MEM:::" prefix is handles by it. then it calls the 
Delete() method on it. But there's not pfnDelete() function for that driver, 
so it goes on by trying to Open() it and then it fails...

Well, so now, the real fix is to (NULL-) implement the pfnDelete() method on 
the MEM driver, so that it does ... nothing ;-)

Furthermore, it's safer because otherwise mem_driver->Create("foo.tif", ...) 
would remove "foo.tif" on the filesystem. So the Delete() method for the MEM 
driver must absolutely do nothing.

Fixed in trunk in r15232

Le Wednesday 27 August 2008 20:27:01 Craig Miller, vous avez ?crit?:
> Thanks Chris.   That did the trick.
>
> Perhaps a quick note could be added to the MEM driver doc page?
>
> Craig
>
>
> -----Original Message-----
> From: Chris Eustace [mailto:Chris.Eustace@petrosys.com.au]
> Sent: Tuesday, August 26, 2008 9:43 PM
> To: Craig Miller
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] MEM Driver under Vista 64?
>
> I had a near identical issue when upgrading from V1.4.x to V1.5.2.
>
> The code checks the name passed in as the "filename" to Create(). ONLY
> if it is of the form "MEM:::" will it then look for other expected
> parameters (including PIXELS, LINES and DATAPOINTER). Otherwise, the
> passed in filename is pretty much ignored.
>
> So, the actual answer is to rename "MEM:::" as anything else and you
> will be fine.
>
> Chris Eustace.
>
> Craig Miller wrote:
> > I am working with an in-house utility written a couple of years ago that
> > uses the MEM driver.  Recently, after upgrading to Vista64 the utility
> > stopped working.  As it was using an old version of GDAL, I decided to
>
> fetch
>
> > the source from the vault and recompile/link against GDAL 1.5.2.  I
> > didn't change any code, but the new utility is failing with "ERROR 1: 
> > Missing required field (one of PIXELS, LINES, or DATAPOINTER)"
> >
> > I'm assuming the problem is either incorrect source (old code), a 64 bit
> > issue, or a GDAL version issue.  Before I start modifying the code to
> > allocate memory and include a DATAPOINTER I thought I'd ask if there were
> > any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause
>
> this
>
> > or if it is a well known Vista 64 problem?
> >
> > Here's the snippet of code that is fails on the poMemDriver->Create(.)
>
> line:
> > 	GDALDriver* poMemDriver;
> > 	CString format = "MEM";
> > 	CString filename = "MEM:::";
> >
> > 	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
> > 	if (poMemDriver == NULL)
> > 	{
> > 		cout << "\"MEM\" driver not supported." <<  endl;
> > 		return false;
> > 	}
> > 	m_poUtmRgbDataset = poMemDriver->Create( filename,
> > 		m_poSrcDataset->GetRasterXSize(),
> > 		m_poSrcDataset->GetRasterYSize(),
> > 		3,  // 3 Bands, Red, Green, and Blue
> > 		GDT_Byte,
> > 		NULL);
> >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.9/1635 - Release Date: 8/26/2008
> 7:29 AM
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From craig.miller at spatialminds.com  Wed Aug 27 14:59:57 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Aug 27 15:00:06 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
In-Reply-To: <200808272054.19105.even.rouault@mines-paris.org>
References: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>	<48B4DB3C.9050105@petrosys.com.au>	<01c801c90872$800fc1a0$802f44e0$@miller@spatialminds.com>
	<200808272054.19105.even.rouault@mines-paris.org>
Message-ID: <01cd01c90877$19a7fd60$4cf7f820$@miller@spatialminds.com>

Even better.  Thanks for the explanation and for submitting a fix.

Craig


-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Even Rouault
Sent: Wednesday, August 27, 2008 11:54 AM
To: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] MEM Driver under Vista 64?

Craig

In fact the true reason is that the Create() method begins by trying to 
destroy the dataset by calling the Delete() method on it. And that was new
to 
GDAL 1.5.0.

So when you do some_driver->Create("MEM:::"), the identify method of the MEM

driver detects that "MEM:::" prefix is handles by it. then it calls the 
Delete() method on it. But there's not pfnDelete() function for that driver,

so it goes on by trying to Open() it and then it fails...

Well, so now, the real fix is to (NULL-) implement the pfnDelete() method on

the MEM driver, so that it does ... nothing ;-)

Furthermore, it's safer because otherwise mem_driver->Create("foo.tif", ...)

would remove "foo.tif" on the filesystem. So the Delete() method for the MEM

driver must absolutely do nothing.

Fixed in trunk in r15232

Le Wednesday 27 August 2008 20:27:01 Craig Miller, vous avez ?crit?:
> Thanks Chris.   That did the trick.
>
> Perhaps a quick note could be added to the MEM driver doc page?
>
> Craig
>
>
> -----Original Message-----
> From: Chris Eustace [mailto:Chris.Eustace@petrosys.com.au]
> Sent: Tuesday, August 26, 2008 9:43 PM
> To: Craig Miller
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] MEM Driver under Vista 64?
>
> I had a near identical issue when upgrading from V1.4.x to V1.5.2.
>
> The code checks the name passed in as the "filename" to Create(). ONLY
> if it is of the form "MEM:::" will it then look for other expected
> parameters (including PIXELS, LINES and DATAPOINTER). Otherwise, the
> passed in filename is pretty much ignored.
>
> So, the actual answer is to rename "MEM:::" as anything else and you
> will be fine.
>
> Chris Eustace.
>
> Craig Miller wrote:
> > I am working with an in-house utility written a couple of years ago that
> > uses the MEM driver.  Recently, after upgrading to Vista64 the utility
> > stopped working.  As it was using an old version of GDAL, I decided to
>
> fetch
>
> > the source from the vault and recompile/link against GDAL 1.5.2.  I
> > didn't change any code, but the new utility is failing with "ERROR 1: 
> > Missing required field (one of PIXELS, LINES, or DATAPOINTER)"
> >
> > I'm assuming the problem is either incorrect source (old code), a 64 bit
> > issue, or a GDAL version issue.  Before I start modifying the code to
> > allocate memory and include a DATAPOINTER I thought I'd ask if there
were
> > any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause
>
> this
>
> > or if it is a well known Vista 64 problem?
> >
> > Here's the snippet of code that is fails on the poMemDriver->Create(.)
>
> line:
> > 	GDALDriver* poMemDriver;
> > 	CString format = "MEM";
> > 	CString filename = "MEM:::";
> >
> > 	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
> > 	if (poMemDriver == NULL)
> > 	{
> > 		cout << "\"MEM\" driver not supported." <<  endl;
> > 		return false;
> > 	}
> > 	m_poUtmRgbDataset = poMemDriver->Create( filename,
> > 		m_poSrcDataset->GetRasterXSize(),
> > 		m_poSrcDataset->GetRasterYSize(),
> > 		3,  // 3 Bands, Red, Green, and Blue
> > 		GDT_Byte,
> > 		NULL);
> >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.9/1635 - Release Date: 8/26/2008
> 7:29 AM
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

No virus found in this incoming message.
Checked by AVG - http://www.avg.com 
Version: 8.0.138 / Virus Database: 270.6.9/1637 - Release Date: 8/27/2008
7:01 AM



From even.rouault at mines-paris.org  Wed Aug 27 15:28:30 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 15:28:47 2008
Subject: [gdal-dev] MEM Driver under Vista 64?
In-Reply-To: <01cd01c90877$19a7fd60$4cf7f820$@miller@spatialminds.com>
References: <001801c907fa$06382110$12a86330$@miller@spatialminds.com>
	<200808272054.19105.even.rouault@mines-paris.org>
	<01cd01c90877$19a7fd60$4cf7f820$@miller@spatialminds.com>
Message-ID: <200808272128.31321.even.rouault@mines-paris.org>

Craig,

in fact I missed a small line that make my analysis was not exact and my 
commit r15232 didn't do what I've advertized...

In r15233, hopefully,  ' mem_driver->Create("MEM:::", ...) ' is possible now.

However, be carefull, since it turns out that there's no easy way of avoiding 
GDAL to destroy 'filename.tif' if you 
do 'mem_driver->Create("filename.tif", ...). The Delete() method will be 
called on the driver that recognizes the given filename.

So, as all the drivers, you must avoid giving an existing filename if you 
don't want it to be deleted...

Best regards.

Le Wednesday 27 August 2008 20:59:57, vous avez ?crit?:
> Even better.  Thanks for the explanation and for submitting a fix.
>
> Craig
>
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org
> [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Even Rouault
> Sent: Wednesday, August 27, 2008 11:54 AM
> To: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] MEM Driver under Vista 64?
>
> Craig
>
> In fact the true reason is that the Create() method begins by trying to
> destroy the dataset by calling the Delete() method on it. And that was new
> to
> GDAL 1.5.0.
>
> So when you do some_driver->Create("MEM:::"), the identify method of the
> MEM
>
> driver detects that "MEM:::" prefix is handles by it. then it calls the
> Delete() method on it. But there's not pfnDelete() function for that
> driver,
>
> so it goes on by trying to Open() it and then it fails...
>
> Well, so now, the real fix is to (NULL-) implement the pfnDelete() method
> on
>
> the MEM driver, so that it does ... nothing ;-)
>
> Furthermore, it's safer because otherwise mem_driver->Create("foo.tif",
> ...)
>
> would remove "foo.tif" on the filesystem. So the Delete() method for the
> MEM
>
> driver must absolutely do nothing.
>
> Fixed in trunk in r15232
>
> Le Wednesday 27 August 2008 20:27:01 Craig Miller, vous avez ?crit?:
> > Thanks Chris.   That did the trick.
> >
> > Perhaps a quick note could be added to the MEM driver doc page?
> >
> > Craig
> >
> >
> > -----Original Message-----
> > From: Chris Eustace [mailto:Chris.Eustace@petrosys.com.au]
> > Sent: Tuesday, August 26, 2008 9:43 PM
> > To: Craig Miller
> > Cc: gdal-dev@lists.osgeo.org
> > Subject: Re: [gdal-dev] MEM Driver under Vista 64?
> >
> > I had a near identical issue when upgrading from V1.4.x to V1.5.2.
> >
> > The code checks the name passed in as the "filename" to Create(). ONLY
> > if it is of the form "MEM:::" will it then look for other expected
> > parameters (including PIXELS, LINES and DATAPOINTER). Otherwise, the
> > passed in filename is pretty much ignored.
> >
> > So, the actual answer is to rename "MEM:::" as anything else and you
> > will be fine.
> >
> > Chris Eustace.
> >
> > Craig Miller wrote:
> > > I am working with an in-house utility written a couple of years ago
> > > that uses the MEM driver.  Recently, after upgrading to Vista64 the
> > > utility stopped working.  As it was using an old version of GDAL, I
> > > decided to
> >
> > fetch
> >
> > > the source from the vault and recompile/link against GDAL 1.5.2.  I
> > > didn't change any code, but the new utility is failing with "ERROR 1:
> > > Missing required field (one of PIXELS, LINES, or DATAPOINTER)"
> > >
> > > I'm assuming the problem is either incorrect source (old code), a 64
> > > bit issue, or a GDAL version issue.  Before I start modifying the code
> > > to allocate memory and include a DATAPOINTER I thought I'd ask if there
>
> were
>
> > > any changes between GDAL 1.4 (Maybe older) GDAL 1.5.2 that might cause
> >
> > this
> >
> > > or if it is a well known Vista 64 problem?
> > >
> > > Here's the snippet of code that is fails on the poMemDriver->Create(.)
> >
> > line:
> > > 	GDALDriver* poMemDriver;
> > > 	CString format = "MEM";
> > > 	CString filename = "MEM:::";
> > >
> > > 	poMemDriver = GetGDALDriverManager()->GetDriverByName(format);
> > > 	if (poMemDriver == NULL)
> > > 	{
> > > 		cout << "\"MEM\" driver not supported." <<  endl;
> > > 		return false;
> > > 	}
> > > 	m_poUtmRgbDataset = poMemDriver->Create( filename,
> > > 		m_poSrcDataset->GetRasterXSize(),
> > > 		m_poSrcDataset->GetRasterYSize(),
> > > 		3,  // 3 Bands, Red, Green, and Blue
> > > 		GDT_Byte,
> > > 		NULL);
> > >
> > >
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > No virus found in this incoming message.
> > Checked by AVG - http://www.avg.com
> > Version: 8.0.138 / Virus Database: 270.6.9/1635 - Release Date: 8/26/2008
> > 7:29 AM
> >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.9/1637 - Release Date: 8/27/2008
> 7:01 AM


From even.rouault at mines-paris.org  Wed Aug 27 16:34:58 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 16:35:02 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B4A0@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<48B0A665.1080503@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4A0@gemini.rsinc.com>
Message-ID: <200808272234.59205.even.rouault@mines-paris.org>

Norman,

as I see you are currently editing your proposal and I've not yet made my 
comments, here I go.

I would like that the dataset object to be added as the first argument of the 
callback, and a void* user_data to be added as the last argument

So the call would be :

ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize, bufYSize, 
bufType, nBandCount, bandMap, nPixelSpace, nLineSpace, nBandSpace, 
pfnProgressIO, pProgressUserData)

typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int yOff, int 
xSize, int ySize, void * pBuf, int bufXSize, int bufYSize, GDALDataType 
bufType, int nBandCount, int* bandMap, int nPixelSpace, int nLineSpace, int 
nBandSpace, void* pProgressUserData)


I've a few questions so that your explanations and proposals are clear to my 
mind.

- Is the extended version of the RasterIO() call still blocking as the current 
version?
My understanding of the discussion is "yes", but I would like a yes/no 
confirmation. If "no", then I don't understand at all how it can work.

- What happens if the user specifies a not NULL argument as the output buffer 
( in (1) ) ? What happens if the user specifies GF_Write ?
It is probably an argument for a name change, something like 
ProgressiveRasterIO.

- Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace, 
nLineSpace, nBandSpace specified by the caller will be the values passed to 
the call back function ?

- Maybe it can make sense to add some way of cancelling the whole RasterIO 
call by providing a callback, like the standard progress callback 
(GDALProgressFunc in gdal.h) mechanism do ? Because the RasterIO() will spend 
most of the time waiting for data. It could resume from time to time to call 
that callback and see if the user still wants the request to be continued. It 
would be nice if the mechanism could provide some percentage of the total 
progress as it might be tedious for the user to compute that ? But that's 
probably not easy to define if you first update the whole request area with a 
low resolution, and then at higher resolutions.

- What happens if the user issues another call to RasterIO(), traditionnal 
version and/or your extended version, in the pfnProgressIO callback ? Is it 
forbidden, or does the answer depend of the underlying driver ?

Best regards

From vishal.mehta at sei-us.org  Wed Aug 27 16:38:04 2008
From: vishal.mehta at sei-us.org (Vishal Mehta)
Date: Wed Aug 27 16:40:34 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on	netcdf
Message-ID: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>

Hello all,

I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu 8.04 with netcdf files.

I re-compiled gdal from source again, this time with Dylan Beaudette's gracious help (thanks Dylan!).
I still got segmentation fault.

Below are the last few lines of strace - hope that helps in identifying what the problem is...
I have libnetcdf 3.6-2-2

Please note that the two netcdf files I've tried do open using FWTools for Windows as well as starspan for Windows - so I don't think anything is wrong with the netcdf files..

-vishal

-------excerpt from strace follows---

read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 4096) = 4096
_llseek(3, 0, [0], SEEK_SET)            = 0
open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
getdents(4, /* 6 entries */, 4096)      = 136
getdents(4, /* 0 entries */, 4096)      = 0
close(4)                                = 0
open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
_llseek(4, 0, [0], SEEK_SET)            = 0
read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 8192) = 8192
--- SIGSEGV (Segmentation fault) @ 0 (0) ---
+++ killed by SIGSEGV +++
Process 395 detached
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080827/200684bb/attachment.html
From even.rouault at mines-paris.org  Wed Aug 27 16:42:04 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 16:42:10 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <200808272234.59205.even.rouault@mines-paris.org>
References: <loom.20080804T125825-537@post.gmane.org>
	<B1B624F7C110834B96594065A74F3A540916B4A0@gemini.rsinc.com>
	<200808272234.59205.even.rouault@mines-paris.org>
Message-ID: <200808272242.04932.even.rouault@mines-paris.org>

Another question :

how will that work with the block cache mechanism ?

If GDALDataset::RasterIO() is overloaded by the driver, the block cache will 
not be used. 
Not sure if it is a problem, but that might be interesting to think about 
that. I've the feeling that this is a bit linked to how the modified 
RasterIO() on the dataset works with the RasterIO() on the band.


Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> Norman,
>
> as I see you are currently editing your proposal and I've not yet made my
> comments, here I go.
>
> I would like that the dataset object to be added as the first argument of
> the callback, and a void* user_data to be added as the last argument
>
> So the call would be :
>
> ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize,
> bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace,
> nBandSpace, pfnProgressIO, pProgressUserData)
>
> typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int yOff,
> int xSize, int ySize, void * pBuf, int bufXSize, int bufYSize, GDALDataType
> bufType, int nBandCount, int* bandMap, int nPixelSpace, int nLineSpace, int
> nBandSpace, void* pProgressUserData)
>
>
> I've a few questions so that your explanations and proposals are clear to
> my mind.
>
> - Is the extended version of the RasterIO() call still blocking as the
> current version?
> My understanding of the discussion is "yes", but I would like a yes/no
> confirmation. If "no", then I don't understand at all how it can work.
>
> - What happens if the user specifies a not NULL argument as the output
> buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> It is probably an argument for a name change, something like
> ProgressiveRasterIO.
>
> - Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace,
> nLineSpace, nBandSpace specified by the caller will be the values passed to
> the call back function ?
>
> - Maybe it can make sense to add some way of cancelling the whole RasterIO
> call by providing a callback, like the standard progress callback
> (GDALProgressFunc in gdal.h) mechanism do ? Because the RasterIO() will
> spend most of the time waiting for data. It could resume from time to time
> to call that callback and see if the user still wants the request to be
> continued. It would be nice if the mechanism could provide some percentage
> of the total progress as it might be tedious for the user to compute that ?
> But that's probably not easy to define if you first update the whole
> request area with a low resolution, and then at higher resolutions.
>
> - What happens if the user issues another call to RasterIO(), traditionnal
> version and/or your extended version, in the pfnProgressIO callback ? Is it
> forbidden, or does the answer depend of the underlying driver ?
>
> Best regards
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Wed Aug 27 16:43:48 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Aug 27 16:43:58 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on	netcdf
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
Message-ID: <48B5BC84.9020206@loskot.net>

Vishal Mehta wrote:
> Hello all,
> 
> I continue to have 'segmentation fault' error using gdal-1.5.2 on
> Ubuntu 8.04 with netcdf files.
> 
> I re-compiled gdal from source again, this time with Dylan
> Beaudette's gracious help (thanks Dylan!). I still got segmentation
> fault.
> 
> Below are the last few lines of strace - hope that helps in
> identifying what the problem is... 

Vishal,

It would be yet helpful if you could give exact command (assuming you 
use GDAL utilities) or code snippet you use to open your file.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From dylan.beaudette at gmail.com  Wed Aug 27 16:48:04 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Aug 27 16:47:53 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2
	=?utf-8?q?on=09netcdf?=
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
Message-ID: <200808271348.04717.dylan.beaudette@gmail.com>

On Wednesday 27 August 2008, Vishal Mehta wrote:
> Hello all,
>
> I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu
> 8.04 with netcdf files.
>
> I re-compiled gdal from source again, this time with Dylan Beaudette's
> gracious help (thanks Dylan!). I still got segmentation fault.
>
> Below are the last few lines of strace - hope that helps in identifying
> what the problem is... I have libnetcdf 3.6-2-2
>
> Please note that the two netcdf files I've tried do open using FWTools for
> Windows as well as starspan for Windows - so I don't think anything is
> wrong with the netcdf files..
>
> -vishal
>
> -------excerpt from strace follows---
>
> read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 4096)
> = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> getdents(4, /* 6 entries */, 4096)      = 136
> getdents(4, /* 0 entries */, 4096)      = 0
> close(4)                                = 0
> open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> _llseek(4, 0, [0], SEEK_SET)            = 0
> read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 8192)
> = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> +++ killed by SIGSEGV +++
> Process 395 detached

I also noticed the following error with the same file (dmesg), on a 
Debian/Unstable system:

gdalinfo[15469]: segfault at 1031 ip b73a1c09 sp bf873c20 error 4 in 
libmfhdf.so.4.1r4[b7390000+21000]

this was with a fairly recent SVN copy of GDAL-1.5, and the libnetcdf3 
package.

I have updated my netcdf libraries to 
libnetcdf4 3.6.2-3.1

and will try again with a freshly updated GDAL source tree...


-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From even.rouault at mines-paris.org  Wed Aug 27 16:50:14 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 16:50:17 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2
	=?utf-8?q?on=09netcdf?=
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
Message-ID: <200808272250.14310.even.rouault@mines-paris.org>

Any chance that you are building GDAL with HDF4 support too ?

http://trac.osgeo.org/gdal/wiki/NetCDF says :

"If building GDAL with both HDF4 and NetCDF support it is necessary to build 
the HDF library specially or a dangerous conflict will occur. See the 
http://trac.osgeo.org/gdal/wiki/HDF topic for details."

On my ubuntu 7.04, the hdf4 library coming from the .deb is not build properly 
as indicated in the wiki and GDAL does crash.

Le Wednesday 27 August 2008 22:38:04 Vishal Mehta, vous avez ?crit?:
> Hello all,
>
> I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu
> 8.04 with netcdf files.
>
> I re-compiled gdal from source again, this time with Dylan Beaudette's
> gracious help (thanks Dylan!). I still got segmentation fault.
>
> Below are the last few lines of strace - hope that helps in identifying
> what the problem is... I have libnetcdf 3.6-2-2
>
> Please note that the two netcdf files I've tried do open using FWTools for
> Windows as well as starspan for Windows - so I don't think anything is
> wrong with the netcdf files..
>
> -vishal
>
> -------excerpt from strace follows---
>
> read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 4096)
> = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> getdents(4, /* 6 entries */, 4096)      = 136
> getdents(4, /* 0 entries */, 4096)      = 0
> close(4)                                = 0
> open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> _llseek(4, 0, [0], SEEK_SET)            = 0
> read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"..., 8192)
> = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> +++ killed by SIGSEGV +++
> Process 395 detached


From dylan.beaudette at gmail.com  Wed Aug 27 17:10:44 2008
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Aug 27 17:10:31 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2
	=?utf-8?q?on=09netcdf?=
In-Reply-To: <200808272250.14310.even.rouault@mines-paris.org>
References: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
	<200808272250.14310.even.rouault@mines-paris.org>
Message-ID: <200808271410.44625.dylan.beaudette@gmail.com>

On Wednesday 27 August 2008, Even Rouault wrote:
> Any chance that you are building GDAL with HDF4 support too ?
>
> http://trac.osgeo.org/gdal/wiki/NetCDF says :
>
> "If building GDAL with both HDF4 and NetCDF support it is necessary to
> build the HDF library specially or a dangerous conflict will occur. See the
> http://trac.osgeo.org/gdal/wiki/HDF topic for details."
>
> On my ubuntu 7.04, the hdf4 library coming from the .deb is not build
> properly as indicated in the wiki and GDAL does crash.

Thanks for the tip Even.

I can confirm that I had built my copy of GDAL with both NetCDF and HDF 
support. I re-built after removing support for HDF, and now 

gdalinfo netcdf_file_that_was_broken 

returns the expected results!

Great tip.

Vishal: you will need to remove the hdf packages, and re-configure GDAL, then 
re-compile GDAL. I would do something like this

sudo aptitude purge {name of hdf package}
cd gdal/
make clean
./configure [options from last time ....]
make
sudo make install

Cheers,
Dylan


> Le Wednesday 27 August 2008 22:38:04 Vishal Mehta, vous avez ?crit?:
> > Hello all,
> >
> > I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu
> > 8.04 with netcdf files.
> >
> > I re-compiled gdal from source again, this time with Dylan Beaudette's
> > gracious help (thanks Dylan!). I still got segmentation fault.
> >
> > Below are the last few lines of strace - hope that helps in identifying
> > what the problem is... I have libnetcdf 3.6-2-2
> >
> > Please note that the two netcdf files I've tried do open using FWTools
> > for Windows as well as starspan for Windows - so I don't think anything
> > is wrong with the netcdf files..
> >
> > -vishal
> >
> > -------excerpt from strace follows---
> >
> > read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 4096) = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> > open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> > fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> > fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> > getdents(4, /* 6 entries */, 4096)      = 136
> > getdents(4, /* 0 entries */, 4096)      = 0
> > close(4)                                = 0
> > open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > _llseek(4, 0, [0], SEEK_SET)            = 0
> > read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 8192) = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> > +++ killed by SIGSEGV +++
> > Process 395 detached
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341
From nbarker at ittvis.com  Wed Aug 27 17:19:26 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Aug 27 17:19:30 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>
	<B1B624F7C110834B96594065A74F3A540916B4A0@gemini.rsinc.com>
	<200808272234.59205.even.rouault@mines-paris.org>
	<200808272242.04932.even.rouault@mines-paris.org>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B4B9@gemini.rsinc.com>

Tamas, Even, all

Thank you for your detailed feedback, I have added a section to the RFC

http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support

Which takes each of your questions and provides a response, please comment further - it is a great help. 

I have added the questions to the RFC since I want to capture them for reference as they raise good points.

Adam, as mentioned in an earlier email, I am considering the interface you propose can you provide me with examples of it working - currently I am sticking as close to a traditional pattern as I can.

I would like to get this interface defined and approved, so that format drivers for streaming data can be written.

Many thanks,

Norman  

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Wednesday, August 27, 2008 2:42 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Another question :

how will that work with the block cache mechanism ?

If GDALDataset::RasterIO() is overloaded by the driver, the block cache will not be used. 
Not sure if it is a problem, but that might be interesting to think about that. I've the feeling that this is a bit linked to how the modified
RasterIO() on the dataset works with the RasterIO() on the band.


Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> Norman,
>
> as I see you are currently editing your proposal and I've not yet made 
> my comments, here I go.
>
> I would like that the dataset object to be added as the first argument 
> of the callback, and a void* user_data to be added as the last 
> argument
>
> So the call would be :
>
> ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize,
> bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace, 
> nBandSpace, pfnProgressIO, pProgressUserData)
>
> typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int 
> yOff, int xSize, int ySize, void * pBuf, int bufXSize, int bufYSize, 
> GDALDataType bufType, int nBandCount, int* bandMap, int nPixelSpace, 
> int nLineSpace, int nBandSpace, void* pProgressUserData)
>
>
> I've a few questions so that your explanations and proposals are clear 
> to my mind.
>
> - Is the extended version of the RasterIO() call still blocking as the 
> current version?
> My understanding of the discussion is "yes", but I would like a yes/no 
> confirmation. If "no", then I don't understand at all how it can work.
>
> - What happens if the user specifies a not NULL argument as the output 
> buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> It is probably an argument for a name change, something like 
> ProgressiveRasterIO.
>
> - Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace, 
> nLineSpace, nBandSpace specified by the caller will be the values 
> passed to the call back function ?
>
> - Maybe it can make sense to add some way of cancelling the whole 
> RasterIO call by providing a callback, like the standard progress 
> callback (GDALProgressFunc in gdal.h) mechanism do ? Because the 
> RasterIO() will spend most of the time waiting for data. It could 
> resume from time to time to call that callback and see if the user 
> still wants the request to be continued. It would be nice if the 
> mechanism could provide some percentage of the total progress as it might be tedious for the user to compute that ?
> But that's probably not easy to define if you first update the whole 
> request area with a low resolution, and then at higher resolutions.
>
> - What happens if the user issues another call to RasterIO(), 
> traditionnal version and/or your extended version, in the 
> pfnProgressIO callback ? Is it forbidden, or does the answer depend of the underlying driver ?
>
> Best regards
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Wed Aug 27 17:26:46 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 17:26:50 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <200808272242.04932.even.rouault@mines-paris.org>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272234.59205.even.rouault@mines-paris.org>
	<200808272242.04932.even.rouault@mines-paris.org>
Message-ID: <200808272326.46673.even.rouault@mines-paris.org>

Norman,

I've seen your answers to my question on the wiki.

So, if the call is not blocking, it means that the callback will not be called 
back in the thread of the caller, but by a thread created by the driver. That 
might be a problem, as many bad things can happen then if the dataset is 
called before the last call from the driver is made, or if the user_data or 
the "objects" that it contains are destroyed, etc. OK, this is not the fault 
of the driver, but it is very easy for users to write bad code in such a 
design. Or they need to have an obvious way of knowing that it is definitely 
finished. I must also mention that you can't for example use safely the same 
GDALDataset* object from different threads without locks.

Your API proposal could be OK if the RasterIO() call is blocking and the 
callback called from the caller thread.
But I think that if we really want a non-blocking API, something looking like 
Adam Nowacki's proposal is rather to be considered.

I think that a callback called from another thread is going to be a source of 
lot of problems.


Le Wednesday 27 August 2008 22:42:04 Even Rouault, vous avez ?crit?:
> Another question :
>
> how will that work with the block cache mechanism ?
>
> If GDALDataset::RasterIO() is overloaded by the driver, the block cache
> will not be used.
> Not sure if it is a problem, but that might be interesting to think about
> that. I've the feeling that this is a bit linked to how the modified
> RasterIO() on the dataset works with the RasterIO() on the band.
>
> Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> > Norman,
> >
> > as I see you are currently editing your proposal and I've not yet made my
> > comments, here I go.
> >
> > I would like that the dataset object to be added as the first argument of
> > the callback, and a void* user_data to be added as the last argument
> >
> > So the call would be :
> >
> > ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize,
> > bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace,
> > nBandSpace, pfnProgressIO, pProgressUserData)
> >
> > typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int
> > yOff, int xSize, int ySize, void * pBuf, int bufXSize, int bufYSize,
> > GDALDataType bufType, int nBandCount, int* bandMap, int nPixelSpace, int
> > nLineSpace, int nBandSpace, void* pProgressUserData)
> >
> >
> > I've a few questions so that your explanations and proposals are clear to
> > my mind.
> >
> > - Is the extended version of the RasterIO() call still blocking as the
> > current version?
> > My understanding of the discussion is "yes", but I would like a yes/no
> > confirmation. If "no", then I don't understand at all how it can work.
> >
> > - What happens if the user specifies a not NULL argument as the output
> > buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> > It is probably an argument for a name change, something like
> > ProgressiveRasterIO.
> >
> > - Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace,
> > nLineSpace, nBandSpace specified by the caller will be the values passed
> > to the call back function ?
> >
> > - Maybe it can make sense to add some way of cancelling the whole
> > RasterIO call by providing a callback, like the standard progress
> > callback (GDALProgressFunc in gdal.h) mechanism do ? Because the
> > RasterIO() will spend most of the time waiting for data. It could resume
> > from time to time to call that callback and see if the user still wants
> > the request to be continued. It would be nice if the mechanism could
> > provide some percentage of the total progress as it might be tedious for
> > the user to compute that ? But that's probably not easy to define if you
> > first update the whole request area with a low resolution, and then at
> > higher resolutions.
> >
> > - What happens if the user issues another call to RasterIO(),
> > traditionnal version and/or your extended version, in the pfnProgressIO
> > callback ? Is it forbidden, or does the answer depend of the underlying
> > driver ?
> >
> > Best regards
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From vishal.mehta at sei-us.org  Wed Aug 27 17:30:30 2008
From: vishal.mehta at sei-us.org (Vishal Mehta)
Date: Wed Aug 27 17:37:42 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf
In-Reply-To: <200808271410.44625.dylan.beaudette@gmail.com>
Message-ID: <3C465A6646C7AD48B03EBF86127AA65437658369@winxbeus09.exchange.xchg>

Thanks Dylan and Even,

But does this mean that I would not be able to use gdal for hdf4 if I want netcdf support?

vishal


-----Original Message-----
From: Dylan Beaudette [mailto:dylan.beaudette@gmail.com]
Sent: Wednesday, August 27, 2008 2:11 PM
To: gdal-dev@lists.osgeo.org
Cc: Even Rouault; Vishal Mehta
Subject: Re: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf

On Wednesday 27 August 2008, Even Rouault wrote:
> Any chance that you are building GDAL with HDF4 support too ?
>
> http://trac.osgeo.org/gdal/wiki/NetCDF says :
>
> "If building GDAL with both HDF4 and NetCDF support it is necessary to
> build the HDF library specially or a dangerous conflict will occur. See the
> http://trac.osgeo.org/gdal/wiki/HDF topic for details."
>
> On my ubuntu 7.04, the hdf4 library coming from the .deb is not build
> properly as indicated in the wiki and GDAL does crash.

Thanks for the tip Even.

I can confirm that I had built my copy of GDAL with both NetCDF and HDF
support. I re-built after removing support for HDF, and now

gdalinfo netcdf_file_that_was_broken

returns the expected results!

Great tip.

Vishal: you will need to remove the hdf packages, and re-configure GDAL, then
re-compile GDAL. I would do something like this

sudo aptitude purge {name of hdf package}
cd gdal/
make clean
./configure [options from last time ....]
make
sudo make install

Cheers,
Dylan


> Le Wednesday 27 August 2008 22:38:04 Vishal Mehta, vous avez ?crit :
> > Hello all,
> >
> > I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu
> > 8.04 with netcdf files.
> >
> > I re-compiled gdal from source again, this time with Dylan Beaudette's
> > gracious help (thanks Dylan!). I still got segmentation fault.
> >
> > Below are the last few lines of strace - hope that helps in identifying
> > what the problem is... I have libnetcdf 3.6-2-2
> >
> > Please note that the two netcdf files I've tried do open using FWTools
> > for Windows as well as starspan for Windows - so I don't think anything
> > is wrong with the netcdf files..
> >
> > -vishal
> >
> > -------excerpt from strace follows---
> >
> > read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 4096) = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> > open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> > fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> > fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> > getdents(4, /* 6 entries */, 4096)      = 136
> > getdents(4, /* 0 entries */, 4096)      = 0
> > close(4)                                = 0
> > open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > _llseek(4, 0, [0], SEEK_SET)            = 0
> > read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 8192) = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> > +++ killed by SIGSEGV +++
> > Process 395 detached
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341

No virus found in this incoming message.
Checked by AVG - http://www.avg.com
Version: 8.0.138 / Virus Database: 270.6.9/1637 - Release Date: 8/27/2008 7:01 AM
From nbarker at ittvis.com  Wed Aug 27 17:39:44 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Aug 27 17:39:51 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272234.59205.even.rouault@mines-paris.org>
	<200808272242.04932.even.rouault@mines-paris.org>
	<200808272326.46673.even.rouault@mines-paris.org>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>

Even,

I really am not sure how the interface from Adam would work with JPIP - I need to see an example of this working.  Sure I understand how the interface he proposes could work with the occassional update, but here we are talking many updates a second and adding the locking, blocking at the user level etc. I think will be a big perform issues and additional complexity for the user to take advantage of streaming data services.

So from the proposed new design

while (...) {
   GDALAsyncRasterIOMessage *m = ds->NextAsyncRasterIOMessage(true);

   if (m) {
     if (m->what == GARM_UPDATE) {
// lock the buffer so there will be no updates while we read from it
       m->asyncrasterio->LockBuffer( /* ... */ );

// display updated region

       m->asyncrasterio->UnlockBuffer();
     } else {
// handle completion, display error message, ...

     }

     ds->ReleaseAsyncRasterIOMessage(m);
   }

}

In my opinion this should be hidden from the user, but with the new strategy would have to be implemented.

I am open to a redesign, but I definitely need to see a pattern reference or an example of this working to be convinced.

To me the benefits of using an observer like pattern is the simplicity for the user to use this library, they just add a listener and get updates.

http://www.codeproject.com/KB/architecture/observer.aspx


Norman 

-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Wednesday, August 27, 2008 3:27 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman,

I've seen your answers to my question on the wiki.

So, if the call is not blocking, it means that the callback will not be called back in the thread of the caller, but by a thread created by the driver. That might be a problem, as many bad things can happen then if the dataset is called before the last call from the driver is made, or if the user_data or the "objects" that it contains are destroyed, etc. OK, this is not the fault of the driver, but it is very easy for users to write bad code in such a design. Or they need to have an obvious way of knowing that it is definitely finished. I must also mention that you can't for example use safely the same
GDALDataset* object from different threads without locks.

Your API proposal could be OK if the RasterIO() call is blocking and the callback called from the caller thread.
But I think that if we really want a non-blocking API, something looking like Adam Nowacki's proposal is rather to be considered.

I think that a callback called from another thread is going to be a source of lot of problems.


Le Wednesday 27 August 2008 22:42:04 Even Rouault, vous avez ?crit?:
> Another question :
>
> how will that work with the block cache mechanism ?
>
> If GDALDataset::RasterIO() is overloaded by the driver, the block cache
> will not be used.
> Not sure if it is a problem, but that might be interesting to think about
> that. I've the feeling that this is a bit linked to how the modified
> RasterIO() on the dataset works with the RasterIO() on the band.
>
> Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> > Norman,
> >
> > as I see you are currently editing your proposal and I've not yet made my
> > comments, here I go.
> >
> > I would like that the dataset object to be added as the first argument of
> > the callback, and a void* user_data to be added as the last argument
> >
> > So the call would be :
> >
> > ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize,
> > bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace,
> > nBandSpace, pfnProgressIO, pProgressUserData)
> >
> > typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int
> > yOff, int xSize, int ySize, void * pBuf, int bufXSize, int bufYSize,
> > GDALDataType bufType, int nBandCount, int* bandMap, int nPixelSpace, int
> > nLineSpace, int nBandSpace, void* pProgressUserData)
> >
> >
> > I've a few questions so that your explanations and proposals are clear to
> > my mind.
> >
> > - Is the extended version of the RasterIO() call still blocking as the
> > current version?
> > My understanding of the discussion is "yes", but I would like a yes/no
> > confirmation. If "no", then I don't understand at all how it can work.
> >
> > - What happens if the user specifies a not NULL argument as the output
> > buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> > It is probably an argument for a name change, something like
> > ProgressiveRasterIO.
> >
> > - Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace,
> > nLineSpace, nBandSpace specified by the caller will be the values passed
> > to the call back function ?
> >
> > - Maybe it can make sense to add some way of cancelling the whole
> > RasterIO call by providing a callback, like the standard progress
> > callback (GDALProgressFunc in gdal.h) mechanism do ? Because the
> > RasterIO() will spend most of the time waiting for data. It could resume
> > from time to time to call that callback and see if the user still wants
> > the request to be continued. It would be nice if the mechanism could
> > provide some percentage of the total progress as it might be tedious for
> > the user to compute that ? But that's probably not easy to define if you
> > first update the whole request area with a low resolution, and then at
> > higher resolutions.
> >
> > - What happens if the user issues another call to RasterIO(),
> > traditionnal version and/or your extended version, in the pfnProgressIO
> > callback ? Is it forbidden, or does the answer depend of the underlying
> > driver ?
> >
> > Best regards
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Wed Aug 27 17:41:44 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 17:41:48 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf
In-Reply-To: <3C465A6646C7AD48B03EBF86127AA65437658369@winxbeus09.exchange.xchg>
References: <3C465A6646C7AD48B03EBF86127AA65437658369@winxbeus09.exchange.xchg>
Message-ID: <200808272341.44652.even.rouault@mines-paris.org>

Vishal,

you can use both netcdf and HDF4, but you'll have to uninstall the HDF4 
library packaged by Ubuntu, and compile it from the source with the 
instructions given in the wiki.

Maybe worth reporting that to Debian/Ubuntu packagers if there's something 
they can do to build a compatible HDF4 library by default.

Le Wednesday 27 August 2008 23:30:30 Vishal Mehta, vous avez ?crit?:
> Thanks Dylan and Even,
>
> But does this mean that I would not be able to use gdal for hdf4 if I want
> netcdf support?
>
> vishal
>
>
> -----Original Message-----
> From: Dylan Beaudette [mailto:dylan.beaudette@gmail.com]
> Sent: Wednesday, August 27, 2008 2:11 PM
> To: gdal-dev@lists.osgeo.org
> Cc: Even Rouault; Vishal Mehta
> Subject: Re: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on
> netcdf
>
> On Wednesday 27 August 2008, Even Rouault wrote:
> > Any chance that you are building GDAL with HDF4 support too ?
> >
> > http://trac.osgeo.org/gdal/wiki/NetCDF says :
> >
> > "If building GDAL with both HDF4 and NetCDF support it is necessary to
> > build the HDF library specially or a dangerous conflict will occur. See
> > the http://trac.osgeo.org/gdal/wiki/HDF topic for details."
> >
> > On my ubuntu 7.04, the hdf4 library coming from the .deb is not build
> > properly as indicated in the wiki and GDAL does crash.
>
> Thanks for the tip Even.
>
> I can confirm that I had built my copy of GDAL with both NetCDF and HDF
> support. I re-built after removing support for HDF, and now
>
> gdalinfo netcdf_file_that_was_broken
>
> returns the expected results!
>
> Great tip.
>
> Vishal: you will need to remove the hdf packages, and re-configure GDAL,
> then re-compile GDAL. I would do something like this
>
> sudo aptitude purge {name of hdf package}
> cd gdal/
> make clean
> ./configure [options from last time ....]
> make
> sudo make install
>
> Cheers,
> Dylan
>
> > Le Wednesday 27 August 2008 22:38:04 Vishal Mehta, vous avez ?crit :
> > > Hello all,
> > >
> > > I continue to have 'segmentation fault' error using gdal-1.5.2 on
> > > Ubuntu 8.04 with netcdf files.
> > >
> > > I re-compiled gdal from source again, this time with Dylan Beaudette's
> > > gracious help (thanks Dylan!). I still got segmentation fault.
> > >
> > > Below are the last few lines of strace - hope that helps in identifying
> > > what the problem is... I have libnetcdf 3.6-2-2
> > >
> > > Please note that the two netcdf files I've tried do open using FWTools
> > > for Windows as well as starspan for Windows - so I don't think anything
> > > is wrong with the netcdf files..
> > >
> > > -vishal
> > >
> > > -------excerpt from strace follows---
> > >
> > > read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > > 4096) = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> > > open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> > > fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> > > fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> > > getdents(4, /* 6 entries */, 4096)      = 136
> > > getdents(4, /* 0 entries */, 4096)      = 0
> > > close(4)                                = 0
> > > open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> > > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > > _llseek(4, 0, [0], SEEK_SET)            = 0
> > > read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > > 8192) = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> > > +++ killed by SIGSEGV +++
> > > Process 395 detached
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Dylan Beaudette
> Soil Resource Laboratory
> http://casoilresource.lawr.ucdavis.edu/
> University of California at Davis
> 530.754.7341
>
> No virus found in this incoming message.
> Checked by AVG - http://www.avg.com
> Version: 8.0.138 / Virus Database: 270.6.9/1637 - Release Date: 8/27/2008
> 7:01 AM


From even.rouault at mines-paris.org  Wed Aug 27 17:59:32 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Aug 27 17:59:35 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
Message-ID: <200808272359.32297.even.rouault@mines-paris.org>

Norman,

In fact, Adam's proposal reminds me a lot of the asynchronous queue object 
from GLIB-2.0

See : http://library.gnome.org/devel/glib/2.12/glib-Asynchronous-Queues.html

I don't know JPIP, but I can image that the driver would start a thread when 
AsyncRasterIO() is called. It communicates with the server and receives the 
updates with a polling loop. When it has received an update,it put the 
received data as well as the parameters describing the window, etc... in a 
structure (let's call it a ticket), pushes that ticket in a stack and goes on 
pushing tickets, or wait for the ticket to be consumed by the reader (both 
are possible, even if you can't push continuously new tickets as memory will 
increase, so the working thread would have to go in idle mode until the queue 
decreases a bit)

The NextAsyncRasterIOMessage() call will check that some message is available 
and unstack the first ticket. In fact, the LockBuffer() / UnlockBuffer() 
could probably be avoided at the API level. Of course the implementation of 
NextAsyncRasterIOMessage() needs an internal mutex to protect the accesses to 
the queue.

Really, that would match very closely the GAsyncQueue*.

Design pattern against design pattern....


Le Wednesday 27 August 2008 23:39:44, vous avez ?crit?:
> Even,
>
> I really am not sure how the interface from Adam would work with JPIP - I
> need to see an example of this working.  Sure I understand how the
> interface he proposes could work with the occassional update, but here we
> are talking many updates a second and adding the locking, blocking at the
> user level etc. I think will be a big perform issues and additional
> complexity for the user to take advantage of streaming data services.
>
> So from the proposed new design
>
> while (...) {
>    GDALAsyncRasterIOMessage *m = ds->NextAsyncRasterIOMessage(true);
>
>    if (m) {
>      if (m->what == GARM_UPDATE) {
> // lock the buffer so there will be no updates while we read from it
>        m->asyncrasterio->LockBuffer( /* ... */ );
>
> // display updated region
>
>        m->asyncrasterio->UnlockBuffer();
>      } else {
> // handle completion, display error message, ...
>
>      }
>
>      ds->ReleaseAsyncRasterIOMessage(m);
>    }
>
> }
>
> In my opinion this should be hidden from the user, but with the new
> strategy would have to be implemented.
>
> I am open to a redesign, but I definitely need to see a pattern reference
> or an example of this working to be convinced.
>
> To me the benefits of using an observer like pattern is the simplicity for
> the user to use this library, they just add a listener and get updates.
>
> http://www.codeproject.com/KB/architecture/observer.aspx
>
>
> Norman
>
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org]
> Sent: Wednesday, August 27, 2008 3:27 PM
> To: Norman Barker
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] RE: progressive rendering
>
> Norman,
>
> I've seen your answers to my question on the wiki.
>
> So, if the call is not blocking, it means that the callback will not be
> called back in the thread of the caller, but by a thread created by the
> driver. That might be a problem, as many bad things can happen then if the
> dataset is called before the last call from the driver is made, or if the
> user_data or the "objects" that it contains are destroyed, etc. OK, this is
> not the fault of the driver, but it is very easy for users to write bad
> code in such a design. Or they need to have an obvious way of knowing that
> it is definitely finished. I must also mention that you can't for example
> use safely the same GDALDataset* object from different threads without
> locks.
>
> Your API proposal could be OK if the RasterIO() call is blocking and the
> callback called from the caller thread. But I think that if we really want
> a non-blocking API, something looking like Adam Nowacki's proposal is
> rather to be considered.
>
> I think that a callback called from another thread is going to be a source
> of lot of problems.
>
> Le Wednesday 27 August 2008 22:42:04 Even Rouault, vous avez ?crit?:
> > Another question :
> >
> > how will that work with the block cache mechanism ?
> >
> > If GDALDataset::RasterIO() is overloaded by the driver, the block cache
> > will not be used.
> > Not sure if it is a problem, but that might be interesting to think about
> > that. I've the feeling that this is a bit linked to how the modified
> > RasterIO() on the dataset works with the RasterIO() on the band.
> >
> > Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> > > Norman,
> > >
> > > as I see you are currently editing your proposal and I've not yet made
> > > my comments, here I go.
> > >
> > > I would like that the dataset object to be added as the first argument
> > > of the callback, and a void* user_data to be added as the last argument
> > >
> > > So the call would be :
> > >
> > > ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), bufXSize,
> > > bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace,
> > > nBandSpace, pfnProgressIO, pProgressUserData)
> > >
> > > typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, int
> > > yOff, int xSize, int ySize, void * pBuf, int bufXSize, int bufYSize,
> > > GDALDataType bufType, int nBandCount, int* bandMap, int nPixelSpace,
> > > int nLineSpace, int nBandSpace, void* pProgressUserData)
> > >
> > >
> > > I've a few questions so that your explanations and proposals are clear
> > > to my mind.
> > >
> > > - Is the extended version of the RasterIO() call still blocking as the
> > > current version?
> > > My understanding of the discussion is "yes", but I would like a yes/no
> > > confirmation. If "no", then I don't understand at all how it can work.
> > >
> > > - What happens if the user specifies a not NULL argument as the output
> > > buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> > > It is probably an argument for a name change, something like
> > > ProgressiveRasterIO.
> > >
> > > - Is it guaranteed that the bufType, nBandCount, bandMap, nPixelSpace,
> > > nLineSpace, nBandSpace specified by the caller will be the values
> > > passed to the call back function ?
> > >
> > > - Maybe it can make sense to add some way of cancelling the whole
> > > RasterIO call by providing a callback, like the standard progress
> > > callback (GDALProgressFunc in gdal.h) mechanism do ? Because the
> > > RasterIO() will spend most of the time waiting for data. It could
> > > resume from time to time to call that callback and see if the user
> > > still wants the request to be continued. It would be nice if the
> > > mechanism could provide some percentage of the total progress as it
> > > might be tedious for the user to compute that ? But that's probably not
> > > easy to define if you first update the whole request area with a low
> > > resolution, and then at higher resolutions.
> > >
> > > - What happens if the user issues another call to RasterIO(),
> > > traditionnal version and/or your extended version, in the pfnProgressIO
> > > callback ? Is it forbidden, or does the answer depend of the underlying
> > > driver ?
> > >
> > > Best regards
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nbarker at ittvis.com  Wed Aug 27 18:08:39 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Aug 27 18:08:43 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B4BB@gemini.rsinc.com>

 
Even,

Thanks for the example, that has made it clearer, particularly the mention of a queue, I like that - also you mention we can avoid the lockbuffer / unlock at the api level which was my other worry.

Give me a day or so to update the RFC with both approaches - pattern vs pattern :-). I can see that a queue would work with GDAL, and an observer (typical java pattern) would work with the swig java wrapper - I am sure there is a way to accommodate both; perhaps queue within the format driver and a simulated subscriber within the swig wrapper.

Many thanks for your comments, I will post again when the RFC is updated.

Norman
-----Original Message-----
From: Even Rouault [mailto:even.rouault@mines-paris.org] 
Sent: Wednesday, August 27, 2008 4:00 PM
To: Norman Barker
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Norman,

In fact, Adam's proposal reminds me a lot of the asynchronous queue object from GLIB-2.0

See : http://library.gnome.org/devel/glib/2.12/glib-Asynchronous-Queues.html

I don't know JPIP, but I can image that the driver would start a thread when
AsyncRasterIO() is called. It communicates with the server and receives the updates with a polling loop. When it has received an update,it put the received data as well as the parameters describing the window, etc... in a structure (let's call it a ticket), pushes that ticket in a stack and goes on pushing tickets, or wait for the ticket to be consumed by the reader (both are possible, even if you can't push continuously new tickets as memory will increase, so the working thread would have to go in idle mode until the queue decreases a bit)

The NextAsyncRasterIOMessage() call will check that some message is available and unstack the first ticket. In fact, the LockBuffer() / UnlockBuffer() could probably be avoided at the API level. Of course the implementation of
NextAsyncRasterIOMessage() needs an internal mutex to protect the accesses to the queue.

Really, that would match very closely the GAsyncQueue*.

Design pattern against design pattern....


Le Wednesday 27 August 2008 23:39:44, vous avez ?crit?:
> Even,
>
> I really am not sure how the interface from Adam would work with JPIP 
> - I need to see an example of this working.  Sure I understand how the 
> interface he proposes could work with the occassional update, but here 
> we are talking many updates a second and adding the locking, blocking 
> at the user level etc. I think will be a big perform issues and 
> additional complexity for the user to take advantage of streaming data services.
>
> So from the proposed new design
>
> while (...) {
>    GDALAsyncRasterIOMessage *m = ds->NextAsyncRasterIOMessage(true);
>
>    if (m) {
>      if (m->what == GARM_UPDATE) {
> // lock the buffer so there will be no updates while we read from it
>        m->asyncrasterio->LockBuffer( /* ... */ );
>
> // display updated region
>
>        m->asyncrasterio->UnlockBuffer();
>      } else {
> // handle completion, display error message, ...
>
>      }
>
>      ds->ReleaseAsyncRasterIOMessage(m);
>    }
>
> }
>
> In my opinion this should be hidden from the user, but with the new 
> strategy would have to be implemented.
>
> I am open to a redesign, but I definitely need to see a pattern 
> reference or an example of this working to be convinced.
>
> To me the benefits of using an observer like pattern is the simplicity 
> for the user to use this library, they just add a listener and get updates.
>
> http://www.codeproject.com/KB/architecture/observer.aspx
>
>
> Norman
>
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault@mines-paris.org]
> Sent: Wednesday, August 27, 2008 3:27 PM
> To: Norman Barker
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] RE: progressive rendering
>
> Norman,
>
> I've seen your answers to my question on the wiki.
>
> So, if the call is not blocking, it means that the callback will not 
> be called back in the thread of the caller, but by a thread created by 
> the driver. That might be a problem, as many bad things can happen 
> then if the dataset is called before the last call from the driver is 
> made, or if the user_data or the "objects" that it contains are 
> destroyed, etc. OK, this is not the fault of the driver, but it is 
> very easy for users to write bad code in such a design. Or they need 
> to have an obvious way of knowing that it is definitely finished. I 
> must also mention that you can't for example use safely the same 
> GDALDataset* object from different threads without locks.
>
> Your API proposal could be OK if the RasterIO() call is blocking and 
> the callback called from the caller thread. But I think that if we 
> really want a non-blocking API, something looking like Adam Nowacki's 
> proposal is rather to be considered.
>
> I think that a callback called from another thread is going to be a 
> source of lot of problems.
>
> Le Wednesday 27 August 2008 22:42:04 Even Rouault, vous avez ?crit?:
> > Another question :
> >
> > how will that work with the block cache mechanism ?
> >
> > If GDALDataset::RasterIO() is overloaded by the driver, the block 
> > cache will not be used.
> > Not sure if it is a problem, but that might be interesting to think 
> > about that. I've the feeling that this is a bit linked to how the 
> > modified
> > RasterIO() on the dataset works with the RasterIO() on the band.
> >
> > Le Wednesday 27 August 2008 22:34:58 Even Rouault, vous avez ?crit?:
> > > Norman,
> > >
> > > as I see you are currently editing your proposal and I've not yet 
> > > made my comments, here I go.
> > >
> > > I would like that the dataset object to be added as the first 
> > > argument of the callback, and a void* user_data to be added as the 
> > > last argument
> > >
> > > So the call would be :
> > >
> > > ds->RasterIO (GF_Read, xOff, yOff, xSize, ySize, NULL (1), 
> > > ds->bufXSize,
> > > bufYSize, bufType, nBandCount, bandMap, nPixelSpace, nLineSpace, 
> > > nBandSpace, pfnProgressIO, pProgressUserData)
> > >
> > > typedef (*GDALRasterIOProgressFunc) (GDALDatasetH hDS, int xOff, 
> > > int yOff, int xSize, int ySize, void * pBuf, int bufXSize, int 
> > > bufYSize, GDALDataType bufType, int nBandCount, int* bandMap, int 
> > > nPixelSpace, int nLineSpace, int nBandSpace, void* 
> > > pProgressUserData)
> > >
> > >
> > > I've a few questions so that your explanations and proposals are 
> > > clear to my mind.
> > >
> > > - Is the extended version of the RasterIO() call still blocking as 
> > > the current version?
> > > My understanding of the discussion is "yes", but I would like a 
> > > yes/no confirmation. If "no", then I don't understand at all how it can work.
> > >
> > > - What happens if the user specifies a not NULL argument as the 
> > > output buffer ( in (1) ) ? What happens if the user specifies GF_Write ?
> > > It is probably an argument for a name change, something like 
> > > ProgressiveRasterIO.
> > >
> > > - Is it guaranteed that the bufType, nBandCount, bandMap, 
> > > nPixelSpace, nLineSpace, nBandSpace specified by the caller will 
> > > be the values passed to the call back function ?
> > >
> > > - Maybe it can make sense to add some way of cancelling the whole 
> > > RasterIO call by providing a callback, like the standard progress 
> > > callback (GDALProgressFunc in gdal.h) mechanism do ? Because the
> > > RasterIO() will spend most of the time waiting for data. It could 
> > > resume from time to time to call that callback and see if the user 
> > > still wants the request to be continued. It would be nice if the 
> > > mechanism could provide some percentage of the total progress as 
> > > it might be tedious for the user to compute that ? But that's 
> > > probably not easy to define if you first update the whole request 
> > > area with a low resolution, and then at higher resolutions.
> > >
> > > - What happens if the user issues another call to RasterIO(), 
> > > traditionnal version and/or your extended version, in the 
> > > pfnProgressIO callback ? Is it forbidden, or does the answer 
> > > depend of the underlying driver ?
> > >
> > > Best regards
> > >
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev@lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


From vishal.mehta at sei-us.org  Wed Aug 27 20:40:31 2008
From: vishal.mehta at sei-us.org (Vishal Mehta)
Date: Wed Aug 27 20:45:55 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf
In-Reply-To: <200808271410.44625.dylan.beaudette@gmail.com>
References: <3C465A6646C7AD48B03EBF86127AA65437658351@winxbeus09.exchange.xchg>
	<200808272250.14310.even.rouault@mines-paris.org>,
	<200808271410.44625.dylan.beaudette@gmail.com>
Message-ID: <3C465A6646C7AD48B03EBF86127AA654376CC109@winxbeus09.exchange.xchg>

Super,

I removed hdf4 libraries, recompiled gdal. Now it works!

Thanks Even and Dylan!
I'll try to fix the hdf4 bit at some later time, right now i needed netcdf to work..

I recommend Dylan's notes on this and related topics: they're at

http://casoilresource.lawr.ucdavis.edu/drupal/node/123


Vishal K. Mehta, Ph.D.
Scientist
Stockholm Environment Institute - US
133 D St Suite F
Davis, CA 95616
www.sei-us.org

________________________________________
From: Dylan Beaudette [dylan.beaudette@gmail.com]
Sent: Wednesday, August 27, 2008 2:10 PM
To: gdal-dev@lists.osgeo.org
Cc: Even Rouault; Vishal Mehta
Subject: Re: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on        netcdf

On Wednesday 27 August 2008, Even Rouault wrote:
> Any chance that you are building GDAL with HDF4 support too ?
>
> http://trac.osgeo.org/gdal/wiki/NetCDF says :
>
> "If building GDAL with both HDF4 and NetCDF support it is necessary to
> build the HDF library specially or a dangerous conflict will occur. See the
> http://trac.osgeo.org/gdal/wiki/HDF topic for details."
>
> On my ubuntu 7.04, the hdf4 library coming from the .deb is not build
> properly as indicated in the wiki and GDAL does crash.

Thanks for the tip Even.

I can confirm that I had built my copy of GDAL with both NetCDF and HDF
support. I re-built after removing support for HDF, and now

gdalinfo netcdf_file_that_was_broken

returns the expected results!

Great tip.

Vishal: you will need to remove the hdf packages, and re-configure GDAL, then
re-compile GDAL. I would do something like this

sudo aptitude purge {name of hdf package}
cd gdal/
make clean
./configure [options from last time ....]
make
sudo make install

Cheers,
Dylan


> Le Wednesday 27 August 2008 22:38:04 Vishal Mehta, vous avez ?crit :
> > Hello all,
> >
> > I continue to have 'segmentation fault' error using gdal-1.5.2 on Ubuntu
> > 8.04 with netcdf files.
> >
> > I re-compiled gdal from source again, this time with Dylan Beaudette's
> > gracious help (thanks Dylan!). I still got segmentation fault.
> >
> > Below are the last few lines of strace - hope that helps in identifying
> > what the problem is... I have libnetcdf 3.6-2-2
> >
> > Please note that the two netcdf files I've tried do open using FWTools
> > for Windows as well as starspan for Windows - so I don't think anything
> > is wrong with the netcdf files..
> >
> > -vishal
> >
> > -------excerpt from strace follows---
> >
> > read(3, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 4096) = 4096 _llseek(3, 0, [0], SEEK_SET)            = 0
> > open(".", O_RDONLY|O_NONBLOCK|O_LARGEFILE|O_DIRECTORY|0x80000) = 4
> > fstat64(4, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
> > fcntl64(4, F_GETFD)                     = 0x1 (flags FD_CLOEXEC)
> > getdents(4, /* 6 entries */, 4096)      = 136
> > getdents(4, /* 0 entries */, 4096)      = 0
> > close(4)                                = 0
> > open("airtemp.nc", O_RDONLY|O_LARGEFILE) = 4
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > fstat64(4, {st_mode=S_IFREG|0666, st_size=265644, ...}) = 0
> > _llseek(4, 0, [0], SEEK_SET)            = 0
> > read(4, "CDF\1\0\0\0\1\0\0\0\n\0\0\0\3\0\0\0\3lat\0\0\0\1h\0\0\0"...,
> > 8192) = 8192 --- SIGSEGV (Segmentation fault) @ 0 (0) ---
> > +++ killed by SIGSEGV +++
> > Process 395 detached
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
Dylan Beaudette
Soil Resource Laboratory
http://casoilresource.lawr.ucdavis.edu/
University of California at Davis
530.754.7341

No virus found in this incoming message.
Checked by AVG - http://www.avg.com
Version: 8.0.138 / Virus Database: 270.6.9/1637 - Release Date: 8/27/2008 7:01 AM
From ivan.lucena at pmldnet.com  Wed Aug 27 20:50:27 2008
From: ivan.lucena at pmldnet.com (=?utf-8?Q?Lucena,=20Ivan?=)
Date: Wed Aug 27 20:50:29 2008
Subject: =?utf-8?B?UmU6IFtnZGFsLWRldl0gU3VwcG9ydCBmb3IgcmVhZGluZyBHREFMIGRhdGFzZXRzIGluIGNvbXByZXNzZWQgYXJjaGl2ZXMgKC5neiBhbmQgLnppcCk=?=
Message-ID: <20080828005027.21989.qmail@s466.sureserver.com>

Even,

Yes, ".gz" doesn't make sense. Copy&Paste error. I meant ".zip".

Imagine that you are a user and you want to know what is in the ZIP file, what if you could browse through the ZIP directory, like that:

% gdalinfo /vsizip/myarchive.zip
Subdatasets:
  SUBDATASET_1_NAME=/vsizip/myarchive.zip/subdir1
  SUBDATASET_1_DESC=directory: subdir1
  SUBDATASET_2_NAME=/vsizip/myarchive.zip/subdir1
  SUBDATASET_2_DESC=directory: subdir2

% gdalinfo /vsizip/myarchive.zip/subdir1
Subdatasets:
  SUBDATASET_1_NAME=/vsizip/myarchive.zip/subdir1/scene1.tif
  SUBDATASET_1_DESC=file: scene1.tif
  SUBDATASET_2_NAME=/vsizip/myarchive.zip/subdir1/scene2.tif
  SUBDATASET_2_DESC=file: scene2.tif

You could go up and down the directories this way.

Now, Imagine that you are a GUI developer and you what your specialized version of a "FileSelectionBox" to load any GDAL supported format by following the logic: 

if GDALOpen() returned a valid GDALDataset but there are subdatasets: then re-load the dialog box with the list of dataset descriptions. Keep doing that until you got a real GDALDataset. Just like what ESRI applications does for multi-band images.

Anyway, I believe that beavering like that the driver would help command like users and GUI developers to use sub-datasets in the same way for all GDAL formats that supports it.

Semantically, I would not be ashamed of calling a "folder" a "dataset-container", with "sub-datasets" inside.

Just an idea, too much coffee :)

Best regards,

Ivan

>  -------Original Message-------
>  From: Even Rouault <even.rouault@mines-paris.org>
>  Subject: Re: [gdal-dev] Support for reading GDAL datasets in compressed archives (.gz and .zip)
>  Sent: Aug 27 '08 18:34
>  
>  Le Wednesday 27 August 2008 15:58:54 Lucena, Ivan, vous avez ?crit :
>  > Rouault,
>  >
>  > Nice job!
>  >
>  > Even Rouault wrote:
>  > > ----------------------------------
>  > > To read from a .gz file,
>  > > ----------------------------------
>  > > gdalinfo /vsigzip/path/to/the/file.gz were path/to/the/file.gz is
>  > > relative or absolute.
>  > >
>  > > The first time that a .gz file is read, a small .gz.properties file will
>  > > be generated (if possible) to capture the uncompressed data size. This
>  > > will make following opening of that dataset much faster.
>  >
>  > Suggestion:
>  >
>  > Would be interesting to bring the content of "file.gz" as subdatasets:
>  >
>  > Subdatasets:
>  >    SUBDATASET_1_NAME=/vsizip/myarchive.zip/subdir1/file1.tif
>  >    SUBDATASET_1_DESC=GeoTiff,100x110x1
>  >    SUBDATASET_2_NAME=/vsizip/myarchive.zip/subdir1/file2.tif
>  >    SUBDATASET_2_DESC=GeoTiff,100x110x1
>  >    SUBDATASET_3_NAME=/vsizip/myarchive.zip/subdir1/file3.tif
>  >    SUBDATASET_3_DESC=GeoTiff,100x110x1
>  >
>  > What do you think?
>  
>  In fact a .gz file is just one single compressed file (I do not
>  handle .tar.gz), so it does not make sense for that format.
>  
>  It could make more sense for .zip files. But what you propose is not directly
>  linked to zip files. It would be true of regular directories on
>  the "classical" file system. And I'm not sure that all GDAL files under a
>  directory can be considered as subdatasets of that directory. That behaviour
>  should be clearly specified, and I think it belongs to the application level,
>  not to the library one.
>  
>  >
>  > > Small syntaxic sugar : if the .zip file contains only one file located at
>  > > its root, just mentionning "/vsizip/path/to/the/file.zip" will work.
>  >
>  > The same would apply to subdatasets, I guess.
>  >
>  > > The fact that this new capability is implemented as virtual file systems
>  > > imply that it will only work for GDAL drivers supporting the "large file
>  > > API". A list of such drivers is : PNG, JPEG, ILWIS, GTiff, GIF, JP2KAK,
>  > > NITF, ADRG, DTED, SRTMHGT, BMP, LCP, HFA (Erdas Imagine), AAIGRID. Other
>  > > drivers may work too (I just looked for those advertizing the
>  > > GDAL_DCAP_VIRTUALIO capability)
>  >
>  > That all we need? Nice!
>  >
>  > Best regards,
>  >
>  > Ivan
>  
>  
>  
From silviamarchesi at gmail.com  Thu Aug 28 10:30:25 2008
From: silviamarchesi at gmail.com (Silvia Marchesi)
Date: Thu Aug 28 10:30:26 2008
Subject: [gdal-dev] geotiff image problem
Message-ID: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>

Hi everybody!
I'm a new user of GDAL; in particular I'm working with GDAL in Visual Studio
2005 in order to read Geotiff images; I'm following the GDAL API Tutorial,
but I have some problems.
I'm trying to open the file (a geotiff image); according to the tutorial I
have written the following code:

#include <gdal_priv.h>
int main()
{
   GDALDataset *poDataset;
   GDALAllRegister();
   poDataset=(GDALDataset *)GDALOpen("image.tif", GA_ReadOnly);
   if (poDataset==NULL)
       int a=12;
}

where image.tif is the name of my dataset; when I try to compile the program
I receive a message with a lot of errors like these:
Error    1    error LNK2001: unresolved external symbol "public: virtual
char const * __thiscall GDALMajorObject::GetDescription(void)const "
(?GetDescription@GDALMajorObject@@UBEPBDXZ)    provaopen.obj   Error    2
error LNK2001: unresolved external symbol "public: virtual void __thiscall
GDALMajorObject::SetDescription(char const *)"
(?SetDescription@GDALMajorObject@@UAEXPBD@Z)    provaopen.obj   Error
3    error LNK2001: unresolved external symbol "public: virtual char * *
__thiscall GDALMajorObject::GetMetadata(char const *)"
(?GetMetadata@GDALMajorObject@@UAEPAPADPBD@Z)    provaopen.obj

Can somebody help me?

Best regards,
Silvia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/2e5d7a5d/attachment.html
From mchapman at fortifieddatacom.com  Thu Aug 28 10:30:40 2008
From: mchapman at fortifieddatacom.com (mchapman@fortifieddatacom.com)
Date: Thu Aug 28 10:37:29 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>
Message-ID: <204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>

Silvia,

In your project properties in vs under the "Link" tab you need to add the path to the file "gdal_i.lib".

Martin

Sent via BlackBerry by AT&T

-----Original Message-----
From: "Silvia Marchesi" <silviamarchesi@gmail.com>

Date: Thu, 28 Aug 2008 16:30:25 
To: <gdal-dev@lists.osgeo.org>
Subject: [gdal-dev] geotiff image problem


_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From silviamarchesi at gmail.com  Thu Aug 28 11:27:22 2008
From: silviamarchesi at gmail.com (Silvia Marchesi)
Date: Thu Aug 28 11:27:24 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>
	<204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>
Message-ID: <b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>

Thanks a lot,!
Now I can compile, but when I try to run the program a message appears:
"This application has failed to start because gdal15d-vc8 was not found.
Re-installing the application may fix the problem"

I have checked and in the folder I have downloaded (pre-installed
gdal151-vc8) there are only gdal_id-vc8.lib and gdal_i-vc8.lib.

Best regards,
Silvia

2008/8/28 <mchapman@fortifieddatacom.com>

> Silvia,
>
> In your project properties in vs under the "Link" tab you need to add the
> path to the file "gdal_i.lib".
>
> Martin
>
> Sent via BlackBerry by AT&T
>
> -----Original Message-----
> From: "Silvia Marchesi" <silviamarchesi@gmail.com>
>
> Date: Thu, 28 Aug 2008 16:30:25
> To: <gdal-dev@lists.osgeo.org>
> Subject: [gdal-dev] geotiff image problem
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/f1bab835/attachment.html
From silviamarchesi at gmail.com  Thu Aug 28 11:41:49 2008
From: silviamarchesi at gmail.com (Silvia Marchesi)
Date: Thu Aug 28 11:41:52 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>
	<204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>
	<b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>
Message-ID: <b1ccf1c10808280841o49031d69ka8101e958c8375b7@mail.gmail.com>

Sorry for my last post.. I have made a bit of confusion! In the folder 'bin'
I have found the missed .dll, however I can't understand why does it not
find it.

Silvia

2008/8/28 Silvia Marchesi <silviamarchesi@gmail.com>

> Thanks a lot,!
> Now I can compile, but when I try to run the program a message appears:
> "This application has failed to start because gdal15d-vc8 was not found.
> Re-installing the application may fix the problem"
>
> I have checked and in the folder I have downloaded (pre-installed
> gdal151-vc8) there are only gdal_id-vc8.lib and gdal_i-vc8.lib.
>
> Best regards,
> Silvia
>
> 2008/8/28 <mchapman@fortifieddatacom.com>
>
> Silvia,
>>
>> In your project properties in vs under the "Link" tab you need to add the
>> path to the file "gdal_i.lib".
>>
>> Martin
>>
>> Sent via BlackBerry by AT&T
>>
>> -----Original Message-----
>> From: "Silvia Marchesi" <silviamarchesi@gmail.com>
>>
>> Date: Thu, 28 Aug 2008 16:30:25
>> To: <gdal-dev@lists.osgeo.org>
>> Subject: [gdal-dev] geotiff image problem
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/128983b8/attachment.html
From silviamarchesi at gmail.com  Thu Aug 28 12:20:17 2008
From: silviamarchesi at gmail.com (Silvia Marchesi)
Date: Thu Aug 28 12:20:19 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <001801c90928$dfc68140$9f5383c0$@com>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>
	<204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>
	<b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>
	<b1ccf1c10808280841o49031d69ka8101e958c8375b7@mail.gmail.com>
	<001801c90928$dfc68140$9f5383c0$@com>
Message-ID: <b1ccf1c10808280920i10e0d31of9a03593521f2565@mail.gmail.com>

Thanks a lot,
 now the problem is with libpng13-vc8, but I think I'll read the suggested
instructions from gdal website..

Silvia

2008/8/28 Martin Chapman <mchapman@fortifieddatacom.com>

>  Silvia,
>
>
>
> The d in gdal15d-vc8 means debug version.  Run your IDE in release mode
> and make sure the .dll file is in the same directory as your application
> .exe.  If you want to use the dll in debug mode, my suggestion is to get the
> source code via SVN and compile it locally.  It's really easy to do if you
> read the Windows build instructions on the gdal.org website.
>
>
>
> Martin
>
>
>
> *From:* Silvia Marchesi [mailto:silviamarchesi@gmail.com]
> *Sent:* Thursday, August 28, 2008 9:42 AM
> *To:* mchapman@fortifieddatacom.com
> *Cc:* gdal-dev-bounces@lists.osgeo.org; gdal-dev@lists.osgeo.org
> *Subject:* Re: [gdal-dev] geotiff image problem
>
>
>
> Sorry for my last post.. I have made a bit of confusion! In the folder
> 'bin' I have found the missed .dll, however I can't understand why does it
> not find it.
>
> Silvia
>
> 2008/8/28 Silvia Marchesi <silviamarchesi@gmail.com>
>
> Thanks a lot,!
> Now I can compile, but when I try to run the program a message appears:
> "This application has failed to start because gdal15d-vc8 was not found.
> Re-installing the application may fix the problem"
>
> I have checked and in the folder I have downloaded (pre-installed
> gdal151-vc8) there are only gdal_id-vc8.lib and gdal_i-vc8.lib.
>
> Best regards,
> Silvia
>
> 2008/8/28 <mchapman@fortifieddatacom.com>
>
>
>
> Silvia,
>
> In your project properties in vs under the "Link" tab you need to add the
> path to the file "gdal_i.lib".
>
> Martin
>
> Sent via BlackBerry by AT&T
>
> -----Original Message-----
> From: "Silvia Marchesi" <silviamarchesi@gmail.com>
>
> Date: Thu, 28 Aug 2008 16:30:25
> To: <gdal-dev@lists.osgeo.org>
> Subject: [gdal-dev] geotiff image problem
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/7ad73135/attachment.html
From mchapman at fortifieddatacom.com  Thu Aug 28 12:12:28 2008
From: mchapman at fortifieddatacom.com (Martin Chapman)
Date: Thu Aug 28 12:32:38 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <b1ccf1c10808280841o49031d69ka8101e958c8375b7@mail.gmail.com>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>	
	<204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>	
	<b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>
	<b1ccf1c10808280841o49031d69ka8101e958c8375b7@mail.gmail.com>
Message-ID: <001801c90928$dfc68140$9f5383c0$@com>

Silvia,

 

The d in gdal15d-vc8 means debug version.  Run your IDE in release mode and
make sure the .dll file is in the same directory as your application .exe.
If you want to use the dll in debug mode, my suggestion is to get the source
code via SVN and compile it locally.  It's really easy to do if you read the
Windows build instructions on the gdal.org website. 

 

Martin

 

From: Silvia Marchesi [mailto:silviamarchesi@gmail.com] 
Sent: Thursday, August 28, 2008 9:42 AM
To: mchapman@fortifieddatacom.com
Cc: gdal-dev-bounces@lists.osgeo.org; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] geotiff image problem

 

Sorry for my last post.. I have made a bit of confusion! In the folder 'bin'
I have found the missed .dll, however I can't understand why does it not
find it.

Silvia

2008/8/28 Silvia Marchesi <silviamarchesi@gmail.com>

Thanks a lot,!
Now I can compile, but when I try to run the program a message appears: 
"This application has failed to start because gdal15d-vc8 was not found.
Re-installing the application may fix the problem"

I have checked and in the folder I have downloaded (pre-installed
gdal151-vc8) there are only gdal_id-vc8.lib and gdal_i-vc8.lib.

Best regards,
Silvia

2008/8/28 <mchapman@fortifieddatacom.com>

 

Silvia,

In your project properties in vs under the "Link" tab you need to add the
path to the file "gdal_i.lib".

Martin

Sent via BlackBerry by AT&T

-----Original Message-----
From: "Silvia Marchesi" <silviamarchesi@gmail.com>

Date: Thu, 28 Aug 2008 16:30:25
To: <gdal-dev@lists.osgeo.org>
Subject: [gdal-dev] geotiff image problem


_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/70843750/attachment.html
From nowak at xpam.de  Thu Aug 28 12:50:06 2008
From: nowak at xpam.de (Adam Nowacki)
Date: Thu Aug 28 12:50:26 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <200808272359.32297.even.rouault@mines-paris.org>
References: <loom.20080804T125825-537@post.gmane.org>	<200808272326.46673.even.rouault@mines-paris.org>	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
Message-ID: <48B6D73E.7000306@xpam.de>

Even Rouault wrote:
> I don't know JPIP, but I can image that the driver would start a thread when 
> AsyncRasterIO() is called. It communicates with the server and receives the 
> updates with a polling loop. When it has received an update,it put the 
> received data as well as the parameters describing the window, etc... in a 
> structure (let's call it a ticket), pushes that ticket in a stack and goes on 
> pushing tickets, or wait for the ticket to be consumed by the reader (both 
> are possible, even if you can't push continuously new tickets as memory will 
> increase, so the working thread would have to go in idle mode until the queue 
> decreases a bit)
> 
> The NextAsyncRasterIOMessage() call will check that some message is available 
> and unstack the first ticket. In fact, the LockBuffer() / UnlockBuffer() 
> could probably be avoided at the API level. Of course the implementation of 
> NextAsyncRasterIOMessage() needs an internal mutex to protect the accesses to 
> the queue.

My idea was to update the data buffer given to AsyncRasterIO immediately 
after receiving data and write only window coordinates into the queued 
messages. That way the queue will remain small, a few KB's at most. This 
is also why LockBuffer() / UnlockBuffer() is there, to protect the 
buffer from async updates while we read from it. LockBuffer(xoff, yoff, 
xsize, ysize) allows almost no wait operation if used with coords from 
queue.
From mateusz at loskot.net  Thu Aug 28 16:35:44 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 28 16:36:24 2008
Subject: [gdal-dev] geotiff image problem
In-Reply-To: <b1ccf1c10808280920i10e0d31of9a03593521f2565@mail.gmail.com>
References: <b1ccf1c10808280730s3a3fb7ceoe6f04b13f32414dd@mail.gmail.com>	<204178344-1219934184-cardhu_decombobulator_blackberry.rim.net-1625110616-@bxe144.bisx.prod.on.blackberry>	<b1ccf1c10808280827q4315426dq89a7b209b945cd8e@mail.gmail.com>	<b1ccf1c10808280841o49031d69ka8101e958c8375b7@mail.gmail.com>	<001801c90928$dfc68140$9f5383c0$@com>
	<b1ccf1c10808280920i10e0d31of9a03593521f2565@mail.gmail.com>
Message-ID: <48B70C20.2000206@loskot.net>

Silvia Marchesi wrote:
> Thanks a lot,
>  now the problem is with libpng13-vc8, but I think I'll read the suggested
> instructions from gdal website..

Silvia,

You need to make all GDAL DLL binaries and all GDAL DLL dependencies 
"visible" to dynamic linker.
Each time your program is launched, dynamic loader tries to find DLL 
libraries your program uses.

Here you can find information where the loader searches for DLL and in 
what order, so it will suggest you where to put GDAL and other DLL files.

http://msdn.microsoft.com/en-us/library/ms682586.aspx

If some DLLs still can not be found, try to use dependency walker to 
find out what DLLs are missing:

http://www.dependencywalker.com/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From nbarker at ittvis.com  Thu Aug 28 17:05:13 2008
From: nbarker at ittvis.com (Norman Barker)
Date: Thu Aug 28 17:05:16 2008
Subject: [gdal-dev] RE: progressive rendering
References: <loom.20080804T125825-537@post.gmane.org>	<200808272326.46673.even.rouault@mines-paris.org>	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
	<48B6D73E.7000306@xpam.de>
Message-ID: <B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>

Hi Adam, Tamas, Even, all

I have updated the RFC 

http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support

And completely changed the pattern used to reflect the general consensus
to use an asynchronous queue for communication between threads.

Can you comment on this, and let me know if it is acceptable?

Can we iterate this is a few times, and then how is this RFC approved
(or rejected!)?

Many thanks,

Norman 

-----Original Message-----
From: Adam Nowacki [mailto:nowak@xpam.de] 
Sent: Thursday, August 28, 2008 10:50 AM
To: Even Rouault
Cc: Norman Barker; gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] RE: progressive rendering

Even Rouault wrote:
> I don't know JPIP, but I can image that the driver would start a 
> thread when
> AsyncRasterIO() is called. It communicates with the server and 
> receives the updates with a polling loop. When it has received an 
> update,it put the received data as well as the parameters describing 
> the window, etc... in a structure (let's call it a ticket), pushes 
> that ticket in a stack and goes on pushing tickets, or wait for the 
> ticket to be consumed by the reader (both are possible, even if you 
> can't push continuously new tickets as memory will increase, so the 
> working thread would have to go in idle mode until the queue decreases

> a bit)
> 
> The NextAsyncRasterIOMessage() call will check that some message is 
> available and unstack the first ticket. In fact, the LockBuffer() / 
> UnlockBuffer() could probably be avoided at the API level. Of course 
> the implementation of
> NextAsyncRasterIOMessage() needs an internal mutex to protect the 
> accesses to the queue.

My idea was to update the data buffer given to AsyncRasterIO immediately
after receiving data and write only window coordinates into the queued
messages. That way the queue will remain small, a few KB's at most. This
is also why LockBuffer() / UnlockBuffer() is there, to protect the
buffer from async updates while we read from it. LockBuffer(xoff, yoff,
xsize, ysize) allows almost no wait operation if used with coords from
queue.
From craig.miller at spatialminds.com  Thu Aug 28 18:07:48 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Thu Aug 28 18:08:02 2008
Subject: [gdal-dev] Topological Union?
Message-ID: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>

Are there any gdal/geos based utility out there that do a topological union
between two sets of geometry (shape files)?

 

A topological union results in existing geometry being split into multiple
pieces and each new resulting polygon having all of the attributes of both
source polygongs.  For example in a Venn diagram, 2 overlapping circles
would result in 3 polygons.

 

A non-topological union results in all geometry being in the same set, but
w/o any new areas being created where there is overlap.  For example, in a
Venn diagram, even though two circles are overlapping, the overlapped
portion would not result in a new polygon; there would only be the two
original circles as polygons.

 

Thanks for the help,

Craig

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080828/b0ed0268/attachment.html
From mateusz at loskot.net  Thu Aug 28 18:20:43 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 28 18:20:49 2008
Subject: [gdal-dev] Topological Union?
In-Reply-To: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>
References: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>
Message-ID: <48B724BB.8060503@loskot.net>

Craig Miller wrote:
> Are there any gdal/geos based utility out there that do a topological union
> between two sets of geometry (shape files)?

AFAIR, GEOSUnion is a topological union

// C API
g3 = GEOSUnion(g1, g2);

GEOS does not provide any Shapefile I/O features, but you can use OGR 
[1] to read Shapefile and access geomtry objects.

[1] http://www.gdal.org/ogr/

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From mateusz at loskot.net  Thu Aug 28 18:36:27 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu Aug 28 18:36:33 2008
Subject: [gdal-dev] Topological Union?
In-Reply-To: <00a001c9095d$41a63570$c4f2a050$@miller@spatialminds.com>
References: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>
	<48B724BB.8060503@loskot.net>
	<00a001c9095d$41a63570$c4f2a050$@miller@spatialminds.com>
Message-ID: <48B7286B.70104@loskot.net>

Craig Miller wrote:
> Thanks Mateusz.  That's exactly what I was thinking of doing if
> someone hasn't put it together already.

Craig,

BTW, you don't have to convert OGRGeometry (you play with it when 
reading Shapefile using OGR) to geos::geom::Geometry.

You can union OGRGeometry using OGRGeometry::Union()
or its C API equivalent OGR_G_Union

These operations are based on GEOSUnion function.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From even.rouault at mines-paris.org  Thu Aug 28 19:42:21 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Aug 28 19:42:28 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<48B6D73E.7000306@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
Message-ID: <200808290142.22060.even.rouault@mines-paris.org>

Hi Norman,

My comments :

- I'm wondering if we must really derive a new class GDALAsyncDataset from 
GDALDataset. We could as well add the new methods as new virtual methods in 
GDALDataset, and make a NULL-implementation of them in GDALDataset. The point 
of this remark is for the C API associated to the new C++ methods. We 
currently have only one "C object" for GDALDataset, namely GDALDatasetH. So, 
it means that people should know that this dataset is a GDALAsyncDataset* in 
fact in order to call the new C API. If we add the new methods to 
GDALDataset, they can call the C method without any risk.

- I don't think that Open() must be part of the API. There is already an 
Open() method, but it belongs to the C++ GDAL driver, not the dataset. What 
your proposed Open() method do can be hidden in the implementation of the 
driver. For example in the pfnOpen() method, or at the first 
ProgressiveRasterIO() call

- What is the signature and role of the pfnProgressIO and pProgressUserData 
arguments ? If they are those I proposed yesterday, they don't make sense in 
that pattern based on async messages.

- The SetMessageQueueLimit() is probably something that must not be exposed. 
I'm not convinced myself by my own idea of discarding messages indeed. 
In fact with the latest clarification from Adam about his proposal, I think 
the LockBuffer() / UnlockBuffer() is the right approach. The caller provides 
the buffer in the ProgressiveRasterIO() call and the driver updates it when 
receiving new data and thanks to the messages, notifies the updated area in 
it to the caller. 


In Adam's proposal, there was a GDALAsyncRasterIO* that was returned by the 
initial call and then used to identify it. I think this is a good idea too if 
we want to be able to send several requests at the same time.




So, here are my small adapatations to Adam's proposal :

class GDALDataset
{
	....

public:
	virtual GDALAsyncRasterIO*
			BeginAsyncRasterIO(int xOff, int yOff,
							int xSize, int ySize,
							void * pBuf,
							int bufXSize, int bufYSize,
							GDALDataType bufType,
							int nBandCount, int* bandMap,
							int nPixelSpace, int nLineSpace,
							int nBandSpace,
							char **papszOptions);

	/** @param papszOptions a list of name=value strings with special control 
	 * options.  Normally this is NULL.
	/* The idea of papszOptions is taken from GDALDataset::AdviseRead() */
	/* In fact BeginAsyncRasterIO does pretty much the same thing as */
	/* GDALDataset::AdviseRead */

	virtual void EndAsyncRasterIO(GDALAsyncRasterIO *);
}

class CPL_DLL GDALAsyncRasterIO
{
private:
        GDALDataset* poDS;
	int xOff;
	int yOff;
	int xSize;
	int ySize;
	void * pBuf;
	int bufXSize;
	int bufYSize;
	GDALDataType bufType;
	int nBandCount;
	int* bandMap;
	int nPixelSpace;
	int nLineSpace;
	int nBandSpace;
public:
	... accessors to above things ? ...
	
	/* Returns GARIO_UPDATE, GARIO_NO_MESSAGE (if wait==false and nothing in the 
queue or if wait==true && timeout != 0 and nothing in the queue at the end of 
the timeout), GARIO_COMPLETE, GARIO_ERROR */
	virtual int GetNextUpdatedRegion(bool wait, int timeout,
                                                   int* pnxbufoff,
                                                   int* pnybufoff,
                                                   int* pnxbufsize,
                                                   int* pnybufsize) = 0;
	/* if wait = true, we wait forever if timeout=0, for the timeout time 
otherwise */
	/* if wait = false, we return immediately */
	/* the int* are output values */

	// lock a whole buffer.
	virtual void LockBuffer() = 0;

	// lock only a block
        // the caller must relax a previous lock before asking for a new one
        virtual void LockBuffer(int xbufoff, int ybufoff, int xbufsize, int 
ybufsize) = 0;

        virtual void UnlockBuffer() = 0;
}

This should be rather easy to "C"-ify.


In fact I'm thinking that if we want, we could always provide a valid 
implementation of the new interface for all existing drivers, even for 
non-streaming formats. For example, let's assume that you do 
BeginAsyncRasterIO() on a GeoTIFF. The first call to GetNextUpdatedRegion() 
can just fill the first line of the buffer by doing a classic - blocking - 
RasterIO(). (That's just an example of what it can do. It could do more 
clever things depending on if the dataset is organized by strips or tiles, if 
there are overviews, etc etc). Something like the default 
GDALRasterBand::IRasterIO implementation, but in a progressive way.
That could be interesting as, currently, people must do a sequence of 
RasterIO() to get progressive rendering. They must also take into account the 
block size to get the better performances. That part of that work could be 
delegated to the GDALAsyncRasterIO* of the default implementation of 
GDALDataset::BeginAsyncRasterIO()


I'm also a bit worried that there will not be any real immediate 
implementation of the new interface done for this RFC. It makes it a bit hard 
too see if that really works in practice... We should avoid releasing a GDAL 
version with only the interface and then discovering when we implement it the 
first time that there's this little thing missing that prevent it from 
working. That's my "show-me-the-whole-thing-working" side...


As far as the process of adopting a RFC is concerned, 
http://trac.osgeo.org/gdal/wiki/rfc1_pmc gives the formal process.

Before asking for a vote on your proposal, I think you should get a positive 
feedback of your proposition from the people that have already taken part to 
the discussion and then extend it with the C API, as this is very important 
because of the requirement of its stability. I think that the SWIG people 
would be interested by your proposals in that domain too.

Best regards,

Even

Le Thursday 28 August 2008 23:05:13, vous avez ?crit?:
> Hi Adam, Tamas, Even, all
>
> I have updated the RFC
>
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support
>
> And completely changed the pattern used to reflect the general consensus
> to use an asynchronous queue for communication between threads.
>
> Can you comment on this, and let me know if it is acceptable?
>
> Can we iterate this is a few times, and then how is this RFC approved
> (or rejected!)?
>
> Many thanks,
>
> Norman
>
> -----Original Message-----
> From: Adam Nowacki [mailto:nowak@xpam.de]
> Sent: Thursday, August 28, 2008 10:50 AM
> To: Even Rouault
> Cc: Norman Barker; gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] RE: progressive rendering
>
> Even Rouault wrote:
> > I don't know JPIP, but I can image that the driver would start a
> > thread when
> > AsyncRasterIO() is called. It communicates with the server and
> > receives the updates with a polling loop. When it has received an
> > update,it put the received data as well as the parameters describing
> > the window, etc... in a structure (let's call it a ticket), pushes
> > that ticket in a stack and goes on pushing tickets, or wait for the
> > ticket to be consumed by the reader (both are possible, even if you
> > can't push continuously new tickets as memory will increase, so the
> > working thread would have to go in idle mode until the queue decreases
> >
> > a bit)
> >
> > The NextAsyncRasterIOMessage() call will check that some message is
> > available and unstack the first ticket. In fact, the LockBuffer() /
> > UnlockBuffer() could probably be avoided at the API level. Of course
> > the implementation of
> > NextAsyncRasterIOMessage() needs an internal mutex to protect the
> > accesses to the queue.
>
> My idea was to update the data buffer given to AsyncRasterIO immediately
> after receiving data and write only window coordinates into the queued
> messages. That way the queue will remain small, a few KB's at most. This
> is also why LockBuffer() / UnlockBuffer() is there, to protect the
> buffer from async updates while we read from it. LockBuffer(xoff, yoff,
> xsize, ysize) allows almost no wait operation if used with coords from
> queue.


From schut at sarvision.nl  Fri Aug 29 06:21:10 2008
From: schut at sarvision.nl (Vincent Schut)
Date: Fri Aug 29 06:21:14 2008
Subject: [gdal-dev] swig python install error
Message-ID: <48B7CD96.3070606@sarvision.nl>

After updating gdal from svn (15242), I get an error in swig/python when 
running the install target:

numpy include /usr/lib/python2.5/site-packages/numpy/core/include
running install
running bdist_egg
running egg_info
writing GDAL.egg-info/PKG-INFO
writing top-level names to GDAL.egg-info/top_level.txt
writing dependency_links to GDAL.egg-info/dependency_links.txt
Traceback (most recent call last):
   File "setup.py", line 228, in <module>
     ext_modules = ext_modules )
   File "/usr/lib/python2.5/distutils/core.py", line 151, in setup
     dist.run_commands()
   File "/usr/lib/python2.5/distutils/dist.py", line 974, in run_commands
     self.run_command(cmd)
   File "/usr/lib/python2.5/distutils/dist.py", line 994, in run_command
     cmd_obj.run()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/install.py", line 
76, in run
     self.do_egg_install()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/install.py", line 
96, in do_egg_install
     self.run_command('bdist_egg')
   File "/usr/lib/python2.5/distutils/cmd.py", line 333, in run_command
     self.distribution.run_command(command)
   File "/usr/lib/python2.5/distutils/dist.py", line 994, in run_command
     cmd_obj.run()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/bdist_egg.py", line 
167, in run
     self.run_command("egg_info")
   File "/usr/lib/python2.5/distutils/cmd.py", line 333, in run_command
     self.distribution.run_command(command)
   File "/usr/lib/python2.5/distutils/dist.py", line 994, in run_command
     cmd_obj.run()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/egg_info.py", line 
171, in run
     self.find_sources()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/egg_info.py", line 
252, in find_sources
     mm.run()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/egg_info.py", line 
306, in run
     self.add_defaults()
   File 
"/usr/lib/python2.5/site-packages/setuptools/command/egg_info.py", line 
333, in add_defaults
     rcfiles = list(walk_revctrl())
   File "/usr/lib/python2.5/site-packages/setuptools/command/sdist.py", 
line 45, in walk_revctrl
     for item in ep.load()(dirname):
   File "/usr/lib/python2.5/site-packages/setuptools/command/sdist.py", 
line 52, in _default_revctrl
     for path in finder(dirname,path):
   File "/usr/lib/python2.5/site-packages/setuptools/command/sdist.py", 
line 98, in entries_finder
     log.warn("unrecognized .svn/entries format in %s", dirname)
NameError: global name 'log' is not defined

I've made clean distclean beforehand, and even by hand removed the build 
and dist directories in the swig/python directory.

Is this a gdal problem or is something broken on my pc?

Cheers,
Vincent.
From szekerest at gmail.com  Fri Aug 29 08:11:54 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 29 08:11:56 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
	<48B6D73E.7000306@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
Message-ID: <f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>

Norman,


Honestly I didn't follow the observations that have turned the things
into a different approach, however I agree that doing callback on
different threads might not be the most reliable option in some cases.

By reviewing the current proposal I'm a bit uncertain about how the
objective described there is related to to the title of the document.
It seems like we are tending to swich to a sequential streaming
approach instead of providing an interface to the possible progressive
rendering modes. As far as I can see we would like to notify the user
about the section that have been (or should be) updated in the buffer,
then the user is responsible to put the image together from the chunks
in order to visually render it on the screen or do some other
interesting job with that.
Assuming that we would indeed like to support the progressive
rendering, in addition to the top-down image streaming mode we might
also consider that the data may be available in such order that may
not be described easily in the interface. For example i can imageine a
one-dimensional interlacing scheme where the every 8th, 4th, 2th.. row
arrives in the subsequent iterations. Or in a 2D interlacing mode the
resolution of the image may be enhanced during the iterations. How can
we describe the modified sections in these more esoteric cases? From
the user's perspective I would rather like to see a fully prepared
intermediary image to be created by the driver in every stage of the
process. User would provide the same buffer to the driver but the
diver would be responsible to modify the data incrementally according
to the incoming segments. In some cases the whole buffer may be
modified in every iteration.

The driver should also handle the required downsampling of the rasters
according to the requested resolution of the image, how this have been
addressed with the current proposal? How the driver would prepare a
1000x1000 image into a buffer having 300*300 pixels. Would the driver
store the whole image in an in-memory dataset and rely on the current
RasterIO to copy the data to the user for example?

It seems we would like to serialize the incoming data into a message
queue by using the same chunk structure as it have been received by
the driver, however from the user's perspective it's not too
interesting to receive the data in the same fragments as it have been
received. For example the user might want to set up a timer and render
the actual snapshot of the image in every 100ms. Therefore the driver
would be responsible to put the data together by collecting every
segments that have been arrived in the meantime. From this aspect
there's no need to collect every segment in a message queue, the
driver may also use an internal buffer to collect the data between the
stages and present the whole data together to the user.

We have switched the previous pattern to another because we afraid of
the negative impacts of the multiple threads. But do we really need to
use multiple threads at all? Does the driver need to read the incoming
buffers of the socket as soon as the data have been arrived and
provide some 'real-time' action afterwards? I assume the socket
library will safely buffer the incoming data and the transmission
control protocol will be able to pause the transfer if this buffer
will eventually become full temporarily. Therefore I guess it would be
sufficient for the driver to do all the action (like reading and
preprocessing the TCP buffers) only inside the RasterIO related
functions called by the client.

In the current approach we are using a fair amount of new functions at
the interface level and rename the existing RasterIO to
ProgressiveRasterIO which is quite annoying. At the moment I don't see
the real benefit of using those new functions instead of using the
existing one in this special way.
Related to the statements above - in my opinion - only the behaviour
of the existing RasterIO should be altered, which would provide an
alternative option (in a Win32 overlapped IO fashion), according to
the following example:

1. During the dataset creation the asynchronous behaviour of the
driver for this dataset could be specified as a new dataset creation
option (like RASTERIO_MODE=ASYNC)

2. The user would use the existing RasterIO method to initiate the
operation as well as to fetch the next available data. The RasterIO
would return immediately if the buffer contains a proper set of the
intermediary data. In this case RasterIO would return a special error
code (IO_PENDING) to denote that more data will be available and the
user will have to initiate a subsequent call to RasterIO. (If we don't
like to introduce new error codes we could also use a separate
function like GetAsyncResult for this purpose).

3. The RasterIO  (or GetAsyncResult) would return no error if the
operation have been finished and no more new update will be available
in the buffer.

4. We could introduce a separate function like CancelIO to allow the
user to cancel the pending IO operation at any time.


I admit I might have missed something related to the aims and the
functionality that the proposal may provide, but I would prefer a
simple and consistent interface instead of a brand new API to be
handled in a different way by the user. Moreover it would also be
beneficial if not only one function could be 'asynchronized', but the
framework would provide the option to bring more API functions like
GetHistorgam or ReprojectImage into this scope in the future.


Best regards,

Tamas




2008/8/28 Norman Barker <nbarker@ittvis.com>:
> Hi Adam, Tamas, Even, all
>
> I have updated the RFC
>
> http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support
>
> And completely changed the pattern used to reflect the general consensus
> to use an asynchronous queue for communication between threads.
>
> Can you comment on this, and let me know if it is acceptable?
>
> Can we iterate this is a few times, and then how is this RFC approved
> (or rejected!)?
>
> Many thanks,
>
> Norman
>
> -----Original Message-----
> From: Adam Nowacki [mailto:nowak@xpam.de]
> Sent: Thursday, August 28, 2008 10:50 AM
> To: Even Rouault
> Cc: Norman Barker; gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] RE: progressive rendering
>
> Even Rouault wrote:
>> I don't know JPIP, but I can image that the driver would start a
>> thread when
>> AsyncRasterIO() is called. It communicates with the server and
>> receives the updates with a polling loop. When it has received an
>> update,it put the received data as well as the parameters describing
>> the window, etc... in a structure (let's call it a ticket), pushes
>> that ticket in a stack and goes on pushing tickets, or wait for the
>> ticket to be consumed by the reader (both are possible, even if you
>> can't push continuously new tickets as memory will increase, so the
>> working thread would have to go in idle mode until the queue decreases
>
>> a bit)
>>
>> The NextAsyncRasterIOMessage() call will check that some message is
>> available and unstack the first ticket. In fact, the LockBuffer() /
>> UnlockBuffer() could probably be avoided at the API level. Of course
>> the implementation of
>> NextAsyncRasterIOMessage() needs an internal mutex to protect the
>> accesses to the queue.
>
> My idea was to update the data buffer given to AsyncRasterIO immediately
> after receiving data and write only window coordinates into the queued
> messages. That way the queue will remain small, a few KB's at most. This
> is also why LockBuffer() / UnlockBuffer() is there, to protect the
> buffer from async updates while we read from it. LockBuffer(xoff, yoff,
> xsize, ysize) allows almost no wait operation if used with coords from
> queue.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From nowak at xpam.de  Fri Aug 29 09:48:08 2008
From: nowak at xpam.de (Adam Nowacki)
Date: Fri Aug 29 09:48:33 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
References: <loom.20080804T125825-537@post.gmane.org>	
	<200808272326.46673.even.rouault@mines-paris.org>	
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>	
	<200808272359.32297.even.rouault@mines-paris.org>	
	<48B6D73E.7000306@xpam.de>	
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
	<f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
Message-ID: <48B7FE18.1070502@xpam.de>

Ill talk about my original proposal 
(http://lists.osgeo.org/pipermail/gdal-dev/2008-August/018088.html) 
instead of the one on trac 
(http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support).

Tamas Szekeres wrote:
> Honestly I didn't follow the observations that have turned the things
> into a different approach, however I agree that doing callback on
> different threads might not be the most reliable option in some cases.



> By reviewing the current proposal I'm a bit uncertain about how the
> objective described there is related to to the title of the document.
> It seems like we are tending to swich to a sequential streaming
> approach instead of providing an interface to the possible progressive
> rendering modes. As far as I can see we would like to notify the user
> about the section that have been (or should be) updated in the buffer,
> then the user is responsible to put the image together from the chunks
> in order to visually render it on the screen or do some other
> interesting job with that.

While this seems to be the case for Norman's proposal it is not in mine. 
A image buffer is provided to the AsyncRasterIO call, same as it would 
be with normal RasterIO call. This buffer is later asynchronously 
updated as more data is received. A AsyncRasterIO call followed by a 
loop waiting for GARM_COMPLETE message would be equal to a normal 
RasterIO call.

> Assuming that we would indeed like to support the progressive
> rendering, in addition to the top-down image streaming mode we might
> also consider that the data may be available in such order that may
> not be described easily in the interface. For example i can imageine a
> one-dimensional interlacing scheme where the every 8th, 4th, 2th.. row
> arrives in the subsequent iterations. Or in a 2D interlacing mode the
> resolution of the image may be enhanced during the iterations. How can
> we describe the modified sections in these more esoteric cases? From
> the user's perspective I would rather like to see a fully prepared
> intermediary image to be created by the driver in every stage of the
> process. User would provide the same buffer to the driver but the
> diver would be responsible to modify the data incrementally according
> to the incoming segments. In some cases the whole buffer may be
> modified in every iteration.

This is exactly what i have in mind. If we receive every 8th row the 
driver could update a whole 8 row block by copying the row 8 times.

> The driver should also handle the required downsampling of the rasters
> according to the requested resolution of the image, how this have been
> addressed with the current proposal? How the driver would prepare a
> 1000x1000 image into a buffer having 300*300 pixels. Would the driver
> store the whole image in an in-memory dataset and rely on the current
> RasterIO to copy the data to the user for example?

This is really internal to the driver. If the format has reduced 
resolution sets they should be used instead of the highest resolution image.

> It seems we would like to serialize the incoming data into a message
> queue by using the same chunk structure as it have been received by
> the driver, however from the user's perspective it's not too
> interesting to receive the data in the same fragments as it have been
> received. For example the user might want to set up a timer and render
> the actual snapshot of the image in every 100ms. Therefore the driver
> would be responsible to put the data together by collecting every
> segments that have been arrived in the meantime. From this aspect
> there's no need to collect every segment in a message queue, the
> driver may also use an internal buffer to collect the data between the
> stages and present the whole data together to the user.

In my proposal the user could:
1) LockBuffer()
2) display the current snapshot
3) UnlockBuffer()
4) sleep for 100ms ignoring the update messages (but 
NextAsyncRasterIOMessage() still has to be called to get the 
GARM_COMPLETE message)

> We have switched the previous pattern to another because we afraid of
> the negative impacts of the multiple threads. But do we really need to
> use multiple threads at all? Does the driver need to read the incoming
> buffers of the socket as soon as the data have been arrived and
> provide some 'real-time' action afterwards? I assume the socket
> library will safely buffer the incoming data and the transmission
> control protocol will be able to pause the transfer if this buffer
> will eventually become full temporarily. Therefore I guess it would be
> sufficient for the driver to do all the action (like reading and
> preprocessing the TCP buffers) only inside the RasterIO related
> functions called by the client.

My proposal also supports single threaded implementations. AsyncRasterIO 
would initialize the request while subsequent NextAsyncRasterIOMessage() 
calls would communicate with the server and update image buffer. 
NextAsyncRasterIOMessage() would either return as soon as possible, 
after all the data received since last call is processed or block 
waiting for more data to arrive with a optional timeout (so a slight 
change of my proposed interface).

// timeout < 0 : wait indefinitely for a new message
// timeout = 0 : no wait, return as soon as possible with or without new 
messages
// timeout > 0 : wait at most timeout milliseconds
GDALAsyncRasterIOMessage *NextAsyncRasterIOMessage(int timeout);

> In the current approach we are using a fair amount of new functions at
> the interface level and rename the existing RasterIO to
> ProgressiveRasterIO which is quite annoying. At the moment I don't see
> the real benefit of using those new functions instead of using the
> existing one in this special way.

The RasterIO function is not renamed. A new function is added 
(AsyncRasterIO) with different behavior than the current RasterIO 
function. RasterIO function doesnt change, a full backwards compatibility.

> Related to the statements above - in my opinion - only the behaviour
> of the existing RasterIO should be altered, which would provide an
> alternative option (in a Win32 overlapped IO fashion), according to
> the following example:
> 
> 1. During the dataset creation the asynchronous behaviour of the
> driver for this dataset could be specified as a new dataset creation
> option (like RASTERIO_MODE=ASYNC)

With my proposal you can mix normal blocking RasterIO calls with 
AsyncRasterIO calls.

> 2. The user would use the existing RasterIO method to initiate the
> operation as well as to fetch the next available data. The RasterIO
> would return immediately if the buffer contains a proper set of the
> intermediary data. In this case RasterIO would return a special error
> code (IO_PENDING) to denote that more data will be available and the
> user will have to initiate a subsequent call to RasterIO. (If we don't
> like to introduce new error codes we could also use a separate
> function like GetAsyncResult for this purpose).
>
> 3. The RasterIO  (or GetAsyncResult) would return no error if the
> operation have been finished and no more new update will be available
> in the buffer.
> 
> 4. We could introduce a separate function like CancelIO to allow the
> user to cancel the pending IO operation at any time.

While I like the simplicity there are a few 'problems'. Identifying 
subsequent calls to RasterIO belonging to the same operation. Would it 
be the buffer pointer, together with the offset and size maybe? Possibly 
a lot of variables that have to be remembered by both the driver and 
user side. Searching a list of all open async raster io operations ? 
Would the buffer be updated with data received since last RasterIO call 
or a current snapshot ? Each open async raster io would also require its 
own data buffer, later copied in whole (or only updated regions) into 
user buffer.
From bfraser at geoanalytic.com  Fri Aug 29 10:53:18 2008
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Fri Aug 29 10:53:36 2008
Subject: [gdal-dev] Topological Union?
In-Reply-To: <48B7286B.70104@loskot.net>
References: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>	<48B724BB.8060503@loskot.net>	<00a001c9095d$41a63570$c4f2a050$@miller@spatialminds.com>
	<48B7286B.70104@loskot.net>
Message-ID: <48B80D5E.8040302@geoanalytic.com>

Craig,

  I've had limited success with the Union function in Geos (via GDAL).  It's slow and fails on large polygon sets (some of my files have 10,000 polygons with some convoluted geometry), but if your sets are smaller, it may work.  FYI, Geos is derived (ported?) from JTS; Martin Davis has a good explanation of union strategies at http://lin-ear-th-inking.blogspot.com/2007/11/fast-polygon-merging-in-jts-using.html.  Currently, I'm considering using Geotools (http://geotools.codehaus.org/) as a framework to get at the JTS functionality.

  And there are other polygon processing libraries out there.  There's a nice summary at http://www.complex-a5.ru/polyboolean/comp.html, but I haven't tried any of those yet.

Good Luck!
Brent Fraser

Mateusz Loskot wrote:
> Craig Miller wrote:
>> Thanks Mateusz.  That's exactly what I was thinking of doing if
>> someone hasn't put it together already.
> 
> Craig,
> 
> BTW, you don't have to convert OGRGeometry (you play with it when 
> reading Shapefile using OGR) to geos::geom::Geometry.
> 
> You can union OGRGeometry using OGRGeometry::Union()
> or its C API equivalent OGR_G_Union
> 
> These operations are based on GEOSUnion function.
> 
> Best regards,
From cjanssen at iavo-rs.com  Fri Aug 29 11:30:15 2008
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Fri Aug 29 11:30:22 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
Message-ID: <29CC84F9-E0B0-47A8-813F-8CA7A8B64449@iavo-rs.com>

Could someone tell me the best/easiest way to create a copy of a GDALDataset from one format to another and specifying a projection different than what is contained in the source GDALDataset. I realize the CreateCopy does most of this but I'm forced to use the projection contained in the source which I could change temporarily for the copy but that brings up another issue. If I have a raster with no geotransform the copy will fail to insert any projection whatsoever and the only way to insert a geotransform is for the file to be writable which I definetly want to avoid since I'm not trying to change the source. Any suggestions or help would be greatly appreciated.

Christiaan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20080829/8c227903/attachment.html
From mateusz at loskot.net  Fri Aug 29 11:45:10 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 29 11:45:16 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
In-Reply-To: <29CC84F9-E0B0-47A8-813F-8CA7A8B64449@iavo-rs.com>
References: <29CC84F9-E0B0-47A8-813F-8CA7A8B64449@iavo-rs.com>
Message-ID: <48B81986.2050705@loskot.net>

Christiaan Janssen wrote:
> Could someone tell me the best/easiest way to create a copy of a
> GDALDataset from one format to another and specifying a projection
> different than what is contained in the source GDALDataset.

Have you tried to follow this [1] tutorial, see 
GDALCreateGenImgProjTransformer

[1] http://gdal.org/warptut.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From cjanssen at iavo-rs.com  Fri Aug 29 12:04:11 2008
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Fri Aug 29 12:04:25 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
In-Reply-To: <48B81986.2050705@loskot.net>
Message-ID: <29404CA7-707B-4187-876F-996BB2BA457C@iavo-rs.com>

My problem with this is that I'm not actually trying to reproject the data. The best example of what I'm doing is trying to create a GeoTIFF version of a standard TIFF (ie create a full raster copy but with GeoTIFF tags for the projection and transform embedded), at the same time not limiting myself to only outputting to a GeoTIFF format but other geospatially capable formats as well (ie NITF, Erdas Imagine, ...) some of which only support the CreateCopy function.

Christiaan

-----Original Message-----
From: Mateusz Loskot [mailto:mateusz@loskot.net] 
Sent: Friday, August 29, 2008 11:45 AM
To: Christiaan Janssen
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Injecting Projection information in CreateCopy

Christiaan Janssen wrote:
> Could someone tell me the best/easiest way to create a copy of a 
> GDALDataset from one format to another and specifying a projection 
> different than what is contained in the source GDALDataset.

Have you tried to follow this [1] tutorial, see GDALCreateGenImgProjTransformer

[1] http://gdal.org/warptut.html

Best regards,
--
Mateusz Loskot, http://mateusz.loskot.net Charter Member of OSGeo, http://osgeo.org


From ivan.lucena at pmldnet.com  Fri Aug 29 12:07:40 2008
From: ivan.lucena at pmldnet.com (Lucena, Ivan)
Date: Fri Aug 29 12:07:43 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
In-Reply-To: <29404CA7-707B-4187-876F-996BB2BA457C@iavo-rs.com>
References: <29404CA7-707B-4187-876F-996BB2BA457C@iavo-rs.com>
Message-ID: <48B81ECC.8060003@pmldnet.com>

I would take a look on how gdal_translate process the "-a_srs" 
parameter: 
http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L311


Christiaan Janssen wrote:
> My problem with this is that I'm not actually trying to reproject the data. The best example of what I'm doing is trying to create a GeoTIFF version of a standard TIFF (ie create a full raster copy but with GeoTIFF tags for the projection and transform embedded), at the same time not limiting myself to only outputting to a GeoTIFF format but other geospatially capable formats as well (ie NITF, Erdas Imagine, ...) some of which only support the CreateCopy function.
> 
> Christiaan
> 
> -----Original Message-----
> From: Mateusz Loskot [mailto:mateusz@loskot.net] 
> Sent: Friday, August 29, 2008 11:45 AM
> To: Christiaan Janssen
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Injecting Projection information in CreateCopy
> 
> Christiaan Janssen wrote:
>> Could someone tell me the best/easiest way to create a copy of a 
>> GDALDataset from one format to another and specifying a projection 
>> different than what is contained in the source GDALDataset.
> 
> Have you tried to follow this [1] tutorial, see GDALCreateGenImgProjTransformer
> 
> [1] http://gdal.org/warptut.html
> 
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net Charter Member of OSGeo, http://osgeo.org
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
From cjanssen at iavo-rs.com  Fri Aug 29 12:54:14 2008
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Fri Aug 29 12:54:30 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
In-Reply-To: <48B81ECC.8060003@pmldnet.com>
Message-ID: <96F90541-A056-48C7-B80A-DC05CA783722@iavo-rs.com>

VRTDatasets seem to be the best way to go in this case. Is there by chance a way to build a VRTDataset that is an exact copy of a GDALDataset or do I need to do it manually (not a big deal if I do). BTW, Thanks for all the help.

Christiaan 

-----Original Message-----
From: Lucena, Ivan [mailto:ivan.lucena@pmldnet.com] 
Sent: Friday, August 29, 2008 12:08 PM
To: Christiaan Janssen
Cc: Mateusz Loskot;gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Injecting Projection information in CreateCopy

I would take a look on how gdal_translate process the "-a_srs" 
parameter: 
http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L311


Christiaan Janssen wrote:
> My problem with this is that I'm not actually trying to reproject the data. The best example of what I'm doing is trying to create a GeoTIFF version of a standard TIFF (ie create a full raster copy but with GeoTIFF tags for the projection and transform embedded), at the same time not limiting myself to only outputting to a GeoTIFF format but other geospatially capable formats as well (ie NITF, Erdas Imagine, ...) some of which only support the CreateCopy function.
> 
> Christiaan
> 
> -----Original Message-----
> From: Mateusz Loskot [mailto:mateusz@loskot.net]
> Sent: Friday, August 29, 2008 11:45 AM
> To: Christiaan Janssen
> Cc: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] Injecting Projection information in CreateCopy
> 
> Christiaan Janssen wrote:
>> Could someone tell me the best/easiest way to create a copy of a 
>> GDALDataset from one format to another and specifying a projection 
>> different than what is contained in the source GDALDataset.
> 
> Have you tried to follow this [1] tutorial, see 
> GDALCreateGenImgProjTransformer
> 
> [1] http://gdal.org/warptut.html
> 
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net Charter Member of OSGeo, 
> http://osgeo.org
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 


From craig.miller at spatialminds.com  Fri Aug 29 12:56:37 2008
From: craig.miller at spatialminds.com (Craig Miller)
Date: Fri Aug 29 12:56:51 2008
Subject: [gdal-dev] Topological Union?
In-Reply-To: <48B80D5E.8040302@geoanalytic.com>
References: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>	<48B724BB.8060503@loskot.net>	<00a001c9095d$41a63570$c4f2a050$@miller@spatialminds.com>
	<48B7286B.70104@loskot.net> <48B80D5E.8040302@geoanalytic.com>
Message-ID: <026f01c909f8$337b0750$9a7115f0$@miller@spatialminds.com>

Thanks Brent.  I'm looking for a C/C++ solution.  I'll take a look at the other polygon processing libraries as well as the level of effort in porting JTS Cascaded Unions to Geos... that's a conversation for a different mailing list though.

Craig


-----Original Message-----
From: Brent Fraser [mailto:bfraser@geoanalytic.com] 
Sent: Friday, August 29, 2008 7:53 AM
To: Craig Miller
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] Topological Union?

Craig,

  I've had limited success with the Union function in Geos (via GDAL).  It's slow and fails on large polygon sets (some of my files have 10,000 polygons with some convoluted geometry), but if your sets are smaller, it may work.  FYI, Geos is derived (ported?) from JTS; Martin Davis has a good explanation of union strategies at http://lin-ear-th-inking.blogspot.com/2007/11/fast-polygon-merging-in-jts-using.html.  Currently, I'm considering using Geotools (http://geotools.codehaus.org/) as a framework to get at the JTS functionality.

  And there are other polygon processing libraries out there.  There's a nice summary at http://www.complex-a5.ru/polyboolean/comp.html, but I haven't tried any of those yet.

Good Luck!
Brent Fraser

Mateusz Loskot wrote:
> Craig Miller wrote:
>> Thanks Mateusz.  That's exactly what I was thinking of doing if
>> someone hasn't put it together already.
> 
> Craig,
> 
> BTW, you don't have to convert OGRGeometry (you play with it when 
> reading Shapefile using OGR) to geos::geom::Geometry.
> 
> You can union OGRGeometry using OGRGeometry::Union()
> or its C API equivalent OGR_G_Union
> 
> These operations are based on GEOSUnion function.
> 
> Best regards,

No virus found in this incoming message.
Checked by AVG - http://www.avg.com 
Version: 8.0.169 / Virus Database: 270.6.13/1641 - Release Date: 8/29/2008 7:07 AM



From mateusz at loskot.net  Fri Aug 29 13:21:45 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri Aug 29 13:21:50 2008
Subject: [gdal-dev] Topological Union?
In-Reply-To: <026f01c909f8$337b0750$9a7115f0$@miller@spatialminds.com>
References: <009201c9095a$824caee0$86e60ca0$@miller@spatialminds.com>	<48B724BB.8060503@loskot.net>	<00a001c9095d$41a63570$c4f2a050$@miller@spatialminds.com>	<48B7286B.70104@loskot.net>
	<48B80D5E.8040302@geoanalytic.com>
	<026f01c909f8$337b0750$9a7115f0$@miller@spatialminds.com>
Message-ID: <48B83029.3030404@loskot.net>

Craig Miller wrote:
> Thanks Brent.  I'm looking for a C/C++ solution.  I'll take a look at
> the other polygon processing libraries as well as the level of effort
> in porting JTS Cascaded Unions to Geos... that's a conversation for a
> different mailing list though.

Craig,

I agree with Brent that performance is/may not be very impressive.
In OGR, this is mostly caused by a need to convert OGRGeometry type to 
GEOS geometry type [1] - allocating & copying coordinates data is expansive.

However, if you are developing your own solution in C++, you can avoid 
this by defining your geometry in terms of interface of 
geos::geom::Geometry or - following design pattern called adapter,
you can provide a thin wrapper on your geometry type that will make it 
accessible to GEOS engine. This way you should get rid of major 
bottleneck of OGR<->GEOS interoperability.

[1] http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrgeometry.cpp#L2105

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From marc.jacquin at magellium.fr  Fri Aug 29 10:42:42 2008
From: marc.jacquin at magellium.fr (Marc Jacquin)
Date: Fri Aug 29 14:29:25 2008
Subject: [gdal-dev] Extending csharp binding for resampling 
In-Reply-To: <48B7FE18.1070502@xpam.de>
References: <loom.20080804T125825-537@post.gmane.org>	<200808272326.46673.even.rouault@mines-paris.org>	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>	<200808272359.32297.even.rouault@mines-paris.org>	<48B6D73E.7000306@xpam.de>	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com><f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
	<48B7FE18.1070502@xpam.de>
Message-ID: <001201c909e5$7e83afd0$9601a8c0@PC150>

Hi Gdal folks,

Let's say we would like to use GDAL warping capabilities for resampling a
dataset (without saving it on a file) at specific xcell and ycell with a
specific resampling method but in Csharp. What would be the best way to do
it? 
Let me guess:
- First maintain our own Gdal build (that's fine)
- Add the corresponding swig code to some .i files in the swig include
directory 
- recompile the whole swig csharp stuff 

OK, but I'm not familiar with swig. Has anybody some swig code similar on
the shelf? Wouldn't it be something useful to add to the official Gdal
release?

Regards,

Marc Jacquin  
+(33) 562 247 023  
marc.jacquin@magellium.fr

Magellium 
24, rue Herm?s
BP 12113
31521 RAMONVILLE Saint-Agne cedex
France
Phone: +(33) 562 247 000
Fax: +(33) 562 247 001
 

From szekerest at gmail.com  Fri Aug 29 15:01:22 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 29 15:01:24 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <48B7FE18.1070502@xpam.de>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
	<48B6D73E.7000306@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
	<f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
	<48B7FE18.1070502@xpam.de>
Message-ID: <f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>

2008/8/29 Adam Nowacki <nowak@xpam.de>:
>
> In my proposal the user could:
> 1) LockBuffer()
> 2) display the current snapshot
> 3) UnlockBuffer()
> 4) sleep for 100ms ignoring the update messages (but
> NextAsyncRasterIOMessage() still has to be called to get the GARM_COMPLETE
> message)
>

Adam,

It seems you consider a multi threaded driver behaviour by default,
Why should the driver tamper the contents the buffer of the user in
the meantime at all. Wouldn't it be sufficient to update the buffer
contents in the NextAsyncRasterIOMessage call? I've mentioned that I'm
not totally sure about the necessity of using multiple threads, but
the driver could eventually collect the data in an internal temporary
buffer and copy the contents to the user buffer upon the subsequent
NextAsyncRasterIOMessage. However for collecting the data in an
internal buffer I don't think we should duplicate what the TCP/IP
driver is actually doing at the OS level.

> The RasterIO function is not renamed. A new function is added
> (AsyncRasterIO) with different behavior than the current RasterIO function.
> RasterIO function doesnt change, a full backwards compatibility.
>

I see no problem if the original RasterIO behaves differently in some
cases controlled explicitly by the user. By specifying a global
setting that RasterIO will operate in asynchronous mode at dataset
level would be enough (like using the dataset creation option or a new
flag in the dataset). I guess the programmer should take care of the
fact how the dataset have been created before. We should indeed use
the synchronous mode as the default setting.


>> Related to the statements above - in my opinion - only the behaviour
>> of the existing RasterIO should be altered, which would provide an
>> alternative option (in a Win32 overlapped IO fashion), according to
>> the following example:
>>
>> 1. During the dataset creation the asynchronous behaviour of the
>> driver for this dataset could be specified as a new dataset creation
>> option (like RASTERIO_MODE=ASYNC)
>
> With my proposal you can mix normal blocking RasterIO calls with
> AsyncRasterIO calls.

Hmmm. I don't see the related use case when the the RasterIO should be
used in synchronous and asyncronous mode with the same dataset in
parallel. However the user have the freedom to create 2 datasets
specify different IO mode and use them simultaneously.


>
>> 2. The user would use the existing RasterIO method to initiate the
>> operation as well as to fetch the next available data. The RasterIO
>> would return immediately if the buffer contains a proper set of the
>> intermediary data. In this case RasterIO would return a special error
>> code (IO_PENDING) to denote that more data will be available and the
>> user will have to initiate a subsequent call to RasterIO. (If we don't
>> like to introduce new error codes we could also use a separate
>> function like GetAsyncResult for this purpose).
>>
>> 3. The RasterIO  (or GetAsyncResult) would return no error if the
>> operation have been finished and no more new update will be available
>> in the buffer.
>>
>> 4. We could introduce a separate function like CancelIO to allow the
>> user to cancel the pending IO operation at any time.
>
> While I like the simplicity there are a few 'problems'. Identifying
> subsequent calls to RasterIO belonging to the same operation. Would it be
> the buffer pointer, together with the offset and size maybe? Possibly a lot
> of variables that have to be remembered by both the driver and user side.
> Searching a list of all open async raster io operations ? Would the buffer
> be updated with data received since last RasterIO call or a current snapshot
> ? Each open async raster io would also require its own data buffer, later
> copied in whole (or only updated regions) into user buffer.
>

I consider the IO context should be stored in the dataset as member
variables by the driver. I don't see a pressing reason to support
multiple raster IO operations at the same time with the same dataset.
I think a similar operation could safely be utilized by creating 2 or
more datasets and invoke their rasterIO simultaneously.
In case if the user specifies a different buffer or image section in
RasterIO then the driver would return with an error or gracefully
initiate a new sequence to the server implicitly.


Best regards,

Tamas
From even.rouault at mines-paris.org  Fri Aug 29 15:37:56 2008
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Aug 29 15:38:01 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<48B7FE18.1070502@xpam.de>
	<f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
Message-ID: <200808292137.57087.even.rouault@mines-paris.org>

Tamas,

The only thing that was in Adam's proposal and that I don't find in yours is 
that, when the RasterIO in async mode returns something valid, the user has 
no way to know which part of the buffer has been updated by the driver. Thus, 
it introduces some extra cost for progressive image display since you then 
need to resend the whole buffer to your display window (before the first 
call, you must initialize the buffer to some default value too).

Question : do we expect that it is going to ruin performance and/or interest 
of progressive rendering ?

I agree that the driver implementation may not be multi-threaded. But it's 
just a choice of implementation from the driver writer. The LockBuffer() / 
UnlockBuffer() API doesn't necessarily imply that the driver must use an 
auxiliary thread. An empty implementation would do for a non multithreaded 
driver. It just makes it possible for the driver to update-in-place the user 
buffer without the need for an internal buffer. 
But... I agree that the need for the LockBuffer()/UnlockBuffer() API is  
arguable since you need the 3 following conditions to be met for it to be 
really usefull :
- a multi-threaded driver
- AND it does not use a temporary buffer
- AND the user doesn't lock for too long an area of the buffer that is going 
to be updated by the driver, otherwise the thread of the driver will be 
stalled by the mutex on the buffer.
All other cases do not need that API.

We could also imagine that the API exists but that the documentation of the 
driver explicitely says whether it is necessary to explictely Lock() / 
Unlock() the buffer, depending on how it is implemented.

Hum, I'm thinking that --enable-threading must be explicitely passed to 
configure. So it means that a multi-threaded driver should be disabled if 
threading is not enabled. Maybe not a big deal but until now, no GDAL driver 
had this requirement.


Le Friday 29 August 2008 21:01:22 Tamas Szekeres, vous avez ?crit?:
> 2008/8/29 Adam Nowacki <nowak@xpam.de>:
> > In my proposal the user could:
> > 1) LockBuffer()
> > 2) display the current snapshot
> > 3) UnlockBuffer()
> > 4) sleep for 100ms ignoring the update messages (but
> > NextAsyncRasterIOMessage() still has to be called to get the
> > GARM_COMPLETE message)
>
> Adam,
>
> It seems you consider a multi threaded driver behaviour by default,
> Why should the driver tamper the contents the buffer of the user in
> the meantime at all. Wouldn't it be sufficient to update the buffer
> contents in the NextAsyncRasterIOMessage call? I've mentioned that I'm
> not totally sure about the necessity of using multiple threads, but
> the driver could eventually collect the data in an internal temporary
> buffer and copy the contents to the user buffer upon the subsequent
> NextAsyncRasterIOMessage. However for collecting the data in an
> internal buffer I don't think we should duplicate what the TCP/IP
> driver is actually doing at the OS level.
>
> > The RasterIO function is not renamed. A new function is added
> > (AsyncRasterIO) with different behavior than the current RasterIO
> > function. RasterIO function doesnt change, a full backwards
> > compatibility.
>
> I see no problem if the original RasterIO behaves differently in some
> cases controlled explicitly by the user. By specifying a global
> setting that RasterIO will operate in asynchronous mode at dataset
> level would be enough (like using the dataset creation option or a new
> flag in the dataset). I guess the programmer should take care of the
> fact how the dataset have been created before. We should indeed use
> the synchronous mode as the default setting.
>
> >> Related to the statements above - in my opinion - only the behaviour
> >> of the existing RasterIO should be altered, which would provide an
> >> alternative option (in a Win32 overlapped IO fashion), according to
> >> the following example:
> >>
> >> 1. During the dataset creation the asynchronous behaviour of the
> >> driver for this dataset could be specified as a new dataset creation
> >> option (like RASTERIO_MODE=ASYNC)
> >
> > With my proposal you can mix normal blocking RasterIO calls with
> > AsyncRasterIO calls.
>
> Hmmm. I don't see the related use case when the the RasterIO should be
> used in synchronous and asyncronous mode with the same dataset in
> parallel. However the user have the freedom to create 2 datasets
> specify different IO mode and use them simultaneously.
>
> >> 2. The user would use the existing RasterIO method to initiate the
> >> operation as well as to fetch the next available data. The RasterIO
> >> would return immediately if the buffer contains a proper set of the
> >> intermediary data. In this case RasterIO would return a special error
> >> code (IO_PENDING) to denote that more data will be available and the
> >> user will have to initiate a subsequent call to RasterIO. (If we don't
> >> like to introduce new error codes we could also use a separate
> >> function like GetAsyncResult for this purpose).
> >>
> >> 3. The RasterIO  (or GetAsyncResult) would return no error if the
> >> operation have been finished and no more new update will be available
> >> in the buffer.
> >>
> >> 4. We could introduce a separate function like CancelIO to allow the
> >> user to cancel the pending IO operation at any time.
> >
> > While I like the simplicity there are a few 'problems'. Identifying
> > subsequent calls to RasterIO belonging to the same operation. Would it be
> > the buffer pointer, together with the offset and size maybe? Possibly a
> > lot of variables that have to be remembered by both the driver and user
> > side. Searching a list of all open async raster io operations ? Would the
> > buffer be updated with data received since last RasterIO call or a
> > current snapshot ? Each open async raster io would also require its own
> > data buffer, later copied in whole (or only updated regions) into user
> > buffer.
>
> I consider the IO context should be stored in the dataset as member
> variables by the driver. I don't see a pressing reason to support
> multiple raster IO operations at the same time with the same dataset.
> I think a similar operation could safely be utilized by creating 2 or
> more datasets and invoke their rasterIO simultaneously.
> In case if the user specifies a different buffer or image section in
> RasterIO then the driver would return with an error or gracefully
> initiate a new sequence to the server implicitly.
>
>
> Best regards,
>
> Tamas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From nowak at xpam.de  Fri Aug 29 16:01:47 2008
From: nowak at xpam.de (Adam Nowacki)
Date: Fri Aug 29 16:02:13 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
References: <loom.20080804T125825-537@post.gmane.org>	
	<200808272326.46673.even.rouault@mines-paris.org>	
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>	
	<200808272359.32297.even.rouault@mines-paris.org>	
	<48B6D73E.7000306@xpam.de>	
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>	
	<f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>	
	<48B7FE18.1070502@xpam.de>
	<f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
Message-ID: <48B855AB.805@xpam.de>

Tamas Szekeres wrote:
> 2008/8/29 Adam Nowacki <nowak@xpam.de>:
>> In my proposal the user could:
>> 1) LockBuffer()
>> 2) display the current snapshot
>> 3) UnlockBuffer()
>> 4) sleep for 100ms ignoring the update messages (but
>> NextAsyncRasterIOMessage() still has to be called to get the GARM_COMPLETE
>> message)
> It seems you consider a multi threaded driver behaviour by default,
> Why should the driver tamper the contents the buffer of the user in
> the meantime at all. Wouldn't it be sufficient to update the buffer
> contents in the NextAsyncRasterIOMessage call? I've mentioned that I'm
> not totally sure about the necessity of using multiple threads, but
> the driver could eventually collect the data in an internal temporary
> buffer and copy the contents to the user buffer upon the subsequent
> NextAsyncRasterIOMessage. However for collecting the data in an
> internal buffer I don't think we should duplicate what the TCP/IP
> driver is actually doing at the OS level.

Im trying to design a interface with lowest overhead possible. Driver 
doesnt have to keep its own buffer and later copy, received data can be 
directly dumped into user buffer.

>> The RasterIO function is not renamed. A new function is added
>> (AsyncRasterIO) with different behavior than the current RasterIO function.
>> RasterIO function doesnt change, a full backwards compatibility.
>>
> 
> I see no problem if the original RasterIO behaves differently in some
> cases controlled explicitly by the user. By specifying a global
> setting that RasterIO will operate in asynchronous mode at dataset
> level would be enough (like using the dataset creation option or a new
> flag in the dataset). I guess the programmer should take care of the
> fact how the dataset have been created before. We should indeed use
> the synchronous mode as the default setting.

The RasterIO function has been there for years. Changing its behavior by 
some hidden variable will definitely make it easier to use (or read) it 
the wrong way. Im trying to protect programmer's foots :)

>>> Related to the statements above - in my opinion - only the behaviour
>>> of the existing RasterIO should be altered, which would provide an
>>> alternative option (in a Win32 overlapped IO fashion), according to
>>> the following example:
>>>
>>> 1. During the dataset creation the asynchronous behaviour of the
>>> driver for this dataset could be specified as a new dataset creation
>>> option (like RASTERIO_MODE=ASYNC)
>> With my proposal you can mix normal blocking RasterIO calls with
>> AsyncRasterIO calls.
> 
> Hmmm. I don't see the related use case when the the RasterIO should be
> used in synchronous and asyncronous mode with the same dataset in
> parallel. However the user have the freedom to create 2 datasets
> specify different IO mode and use them simultaneously.

Being able to mix both blocking and async RasterIO calls sure would help 
to 'progressively' upgrade code from RasterIO to AsyncRasterIO.
Opening 2 datasets would be a real bad thing: no shared cache.

>>> 2. The user would use the existing RasterIO method to initiate the
>>> operation as well as to fetch the next available data. The RasterIO
>>> would return immediately if the buffer contains a proper set of the
>>> intermediary data. In this case RasterIO would return a special error
>>> code (IO_PENDING) to denote that more data will be available and the
>>> user will have to initiate a subsequent call to RasterIO. (If we don't
>>> like to introduce new error codes we could also use a separate
>>> function like GetAsyncResult for this purpose).
>>>
>>> 3. The RasterIO  (or GetAsyncResult) would return no error if the
>>> operation have been finished and no more new update will be available
>>> in the buffer.
>>>
>>> 4. We could introduce a separate function like CancelIO to allow the
>>> user to cancel the pending IO operation at any time.
>> While I like the simplicity there are a few 'problems'. Identifying
>> subsequent calls to RasterIO belonging to the same operation. Would it be
>> the buffer pointer, together with the offset and size maybe? Possibly a lot
>> of variables that have to be remembered by both the driver and user side.
>> Searching a list of all open async raster io operations ? Would the buffer
>> be updated with data received since last RasterIO call or a current snapshot
>> ? Each open async raster io would also require its own data buffer, later
>> copied in whole (or only updated regions) into user buffer.
>>
> 
> I consider the IO context should be stored in the dataset as member
> variables by the driver. I don't see a pressing reason to support
> multiple raster IO operations at the same time with the same dataset.
> I think a similar operation could safely be utilized by creating 2 or
> more datasets and invoke their rasterIO simultaneously.
> In case if the user specifies a different buffer or image section in
> RasterIO then the driver would return with an error or gracefully
> initiate a new sequence to the server implicitly.

Consider a simple image browsing app with a overview box in a corner. 
Having 2 simultaneously running asynchronous raster io operations on the 
same dataset would allow the driver to optimize requests to the server 
possibly even eliminating separate requests for the overview. Or after 
zooming in the previously cached data for main view could be used to 
service the overview view.


From szekerest at gmail.com  Fri Aug 29 17:25:16 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 29 17:25:18 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <200808292137.57087.even.rouault@mines-paris.org>
References: <loom.20080804T125825-537@post.gmane.org>
	<48B7FE18.1070502@xpam.de>
	<f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
	<200808292137.57087.even.rouault@mines-paris.org>
Message-ID: <f3b73b7d0808291425g5b8f243and6c66f1e8b971889@mail.gmail.com>

2008/8/29 Even Rouault <even.rouault@mines-paris.org>:
> Tamas,
>
> The only thing that was in Adam's proposal and that I don't find in yours is
> that, when the RasterIO in async mode returns something valid, the user has
> no way to know which part of the buffer has been updated by the driver. Thus,
> it introduces some extra cost for progressive image display since you then
> need to resend the whole buffer to your display window (before the first
> call, you must initialize the buffer to some default value too).
>
> Question : do we expect that it is going to ruin performance and/or interest
> of progressive rendering ?
>

Yes, this might be a crucial point. I've been considering that it's
more convenient for the user to do the same thing in all rendering
phase as retrieving the whole image than updating only sub-regions. I
consider only rectangle regions would play a role in this case.

However I should somewhat retract my statement here because of one
reason in my mind. Actually we cannot cosider the user can use the
same buffer as the driver with respect to some of the SWIG bindings.
In the RasterIO interface implementations the bindings might copy the
buffers between the target language and the GDAL core. Therefore we
cannot consider the buffer as read-write during the rasterio read
operation. BTW currently we only have ReadRaster/WriteRaster exposed
to the SWIG API.

In conclusion I'm tending to take over what Adam is proposing, however
we should have an additional method (or the synchronous version of the
RasterIO itself) to copy the region at the SWIG API.
This extra copy seems to be inevitable to me, because currently the
user (and the SWIG interface) is not required to keep the buffer
passed to RasterIO permanently. The external LockBuffer/ReleaseBuffer
by this means could be handled at driver level.


> I agree that the driver implementation may not be multi-threaded. But it's
> just a choice of implementation from the driver writer. The LockBuffer() /
> UnlockBuffer() API doesn't necessarily imply that the driver must use an
> auxiliary thread. An empty implementation would do for a non multithreaded
> driver. It just makes it possible for the driver to update-in-place the user
> buffer without the need for an internal buffer.
> But... I agree that the need for the LockBuffer()/UnlockBuffer() API is
> arguable since you need the 3 following conditions to be met for it to be
> really usefull :
> - a multi-threaded driver
> - AND it does not use a temporary buffer
> - AND the user doesn't lock for too long an area of the buffer that is going
> to be updated by the driver, otherwise the thread of the driver will be
> stalled by the mutex on the buffer.
> All other cases do not need that API.
>
> We could also imagine that the API exists but that the documentation of the
> driver explicitely says whether it is necessary to explictely Lock() /
> Unlock() the buffer, depending on how it is implemented.
>

This kind of stuff may lead to various kind of potential issues,
likewise I recall the introduction of of the smart pointers in the COM
world in order to avoid the mistakes when using AddRef, Release in the
right order.


> Hum, I'm thinking that --enable-threading must be explicitely passed to
> configure. So it means that a multi-threaded driver should be disabled if
> threading is not enabled. Maybe not a big deal but until now, no GDAL driver
> had this requirement.
>

Until this point GDAL could mainly avoid to trigger multiple threads
pretty well. I think only the warping code use threads at all.
Therefore using this global setting may affect quite unrelated parts
in GDAL which may be disadvantageous. By any means the multithreaded
behaviour of a driver should be kept internal as much as we can.


Best regards,

Tamas
From szekerest at gmail.com  Fri Aug 29 17:54:42 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 29 17:54:45 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <48B855AB.805@xpam.de>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
	<48B6D73E.7000306@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
	<f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
	<48B7FE18.1070502@xpam.de>
	<f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
	<48B855AB.805@xpam.de>
Message-ID: <f3b73b7d0808291454y7d9d9bbp5df3ade3b278fd67@mail.gmail.com>

2008/8/29 Adam Nowacki <nowak@xpam.de>:
>
> Im trying to design a interface with lowest overhead possible. Driver doesnt
> have to keep its own buffer and later copy, received data can be directly
> dumped into user buffer.
>

Adam,

As I have noted in the previous post we cannot easily consider this
"direct" manner realizable, because many of the SWIG wrappers may have
to copy the buffers between the target language and the GDAL core. To
mimic this behaviour of the interface would require to keep the buffer
at the API level which is almost equivalent as handling this at driver
level.

>
> The RasterIO function has been there for years. Changing its behavior by
> some hidden variable will definitely make it easier to use (or read) it the
> wrong way. Im trying to protect programmer's foots :)
>

The behaviour wouldn't change accidentally only upon the user's
explicit request.

>
> Being able to mix both blocking and async RasterIO calls sure would help to
> 'progressively' upgrade code from RasterIO to AsyncRasterIO.
> Opening 2 datasets would be a real bad thing: no shared cache.
>

Would the user be able to use both of the methods at the same time in
the original proposal?


>> I consider the IO context should be stored in the dataset as member
>> variables by the driver. I don't see a pressing reason to support
>> multiple raster IO operations at the same time with the same dataset.
>> I think a similar operation could safely be utilized by creating 2 or
>> more datasets and invoke their rasterIO simultaneously.
>> In case if the user specifies a different buffer or image section in
>> RasterIO then the driver would return with an error or gracefully
>> initiate a new sequence to the server implicitly.
>
> Consider a simple image browsing app with a overview box in a corner. Having
> 2 simultaneously running asynchronous raster io operations on the same
> dataset would allow the driver to optimize requests to the server possibly
> even eliminating separate requests for the overview. Or after zooming in the
> previously cached data for main view could be used to service the overview
> view.
>

Hmmm. It's quite difficult to imagine how the driver would operate to
achieve this. I don't think if it's equal to copy (and resample) a
region of a larger image than requesting the same region at the server
in many cases. The subsequent user requests would less likely require
the subset of an image in the same resolution and scale.

Best regards,

Tamas
From szekerest at gmail.com  Fri Aug 29 18:42:00 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Aug 29 18:42:10 2008
Subject: [gdal-dev] Extending csharp binding for resampling
In-Reply-To: <001201c909e5$7e83afd0$9601a8c0@PC150>
References: <loom.20080804T125825-537@post.gmane.org>
	<200808272326.46673.even.rouault@mines-paris.org>
	<B1B624F7C110834B96594065A74F3A540916B4BA@gemini.rsinc.com>
	<200808272359.32297.even.rouault@mines-paris.org>
	<48B6D73E.7000306@xpam.de>
	<B1B624F7C110834B96594065A74F3A540916B4BF@gemini.rsinc.com>
	<f3b73b7d0808290511g52de09cdq2fb08be3485cc39e@mail.gmail.com>
	<48B7FE18.1070502@xpam.de> <001201c909e5$7e83afd0$9601a8c0@PC150>
Message-ID: <f3b73b7d0808291542u2452d1a1waa2de053cc10d0fc@mail.gmail.com>

Marc,

Wouldn't it be sufficient to create a warped vrt dataset either by
opening the corresponding xml file or using the AutoCreateWarpedVRT
API?
Then you might want to use ReadRaster on that dataset so as to load
the stuff into an in-memory buffer.

Currently there's no native way to access the warp operations from the
SWIG interface.

Best regards,

Tamas



2008/8/29 Marc Jacquin <marc.jacquin@magellium.fr>:
> Hi Gdal folks,
>
> Let's say we would like to use GDAL warping capabilities for resampling a
> dataset (without saving it on a file) at specific xcell and ycell with a
> specific resampling method but in Csharp. What would be the best way to do
> it?
> Let me guess:
> - First maintain our own Gdal build (that's fine)
> - Add the corresponding swig code to some .i files in the swig include
> directory
> - recompile the whole swig csharp stuff
>
> OK, but I'm not familiar with swig. Has anybody some swig code similar on
> the shelf? Wouldn't it be something useful to add to the official Gdal
> release?
>
> Regards,
>
> Marc Jacquin
> +(33) 562 247 023
> marc.jacquin@magellium.fr
>
> Magellium
> 24, rue Herm?s
> BP 12113
> 31521 RAMONVILLE Saint-Agne cedex
> France
> Phone: +(33) 562 247 000
> Fax: +(33) 562 247 001
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From szekerest at gmail.com  Sat Aug 30 11:49:55 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug 30 11:49:59 2008
Subject: [gdal-dev] RE: progressive rendering
In-Reply-To: <f3b73b7d0808291425g5b8f243and6c66f1e8b971889@mail.gmail.com>
References: <loom.20080804T125825-537@post.gmane.org>
	<48B7FE18.1070502@xpam.de>
	<f3b73b7d0808291201p7a56d9a1n30b81507c310a52a@mail.gmail.com>
	<200808292137.57087.even.rouault@mines-paris.org>
	<f3b73b7d0808291425g5b8f243and6c66f1e8b971889@mail.gmail.com>
Message-ID: <f3b73b7d0808300849q19c61479wff953dff9d388d14@mail.gmail.com>

Hi All,


Upon thinking about the issues I've been come up with previously, I
consider the following approach could be implemented easily either at
driver or at SWIG interface level. Requires a new class to be
implemented by the async IO supported drivers and a new additional
method should be added to the GDALDataset and GDALRasterBand.
The user could implement the async IO by using the following pseudo sequence:

<Code>

GDALDataset *ds = GDALOpen( name, Access.GA_ReadOnly );

// create an IO context for the asynchronous operation
// the diver will initiate the transfer from the server and set:
ctx->status to IO_PENDING
// the diver will store the internal state of the transfer in the ctx object.
// GDALRasterBand may also implement the similar method by using the
proper arguments.
GDALRasterIOContext *ctx = ds->CreateRasterIOContext(GF_Read, xOff,
yOff, xSize, ySize, buf_xSize, buf_ySize,
       buf_dataType, bandCount, bandMap, pixelSpace, lineSpace, bandSpace);

while (ctx->status != IO_COMPLETE)
{
    // Update the buffer with the next stage of data. The driver is allowed to
    // modify the buffer within ReadNextBlock only.
    // ReadNextBlock will wait until the next displayable stage will arrive.
    ctx->ReadNextBlock(buffer);

    // update the view by using ctx->xOff, ctx->yOff, ctx->xSize, ctx->ySize
    ....


    // the user have pressed the cancel button in the user interface thread.
    if (bCancel)
    {
	// the driver will close the transfer from the server
        ctx->CancelIO();
        break;
    }
}

// The GDALRasterIOContext destructor will close the transfer if needed

</Code>


Best regards,

Tamas
From mateusz at loskot.net  Sat Aug 30 15:15:47 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug 30 15:15:52 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
Message-ID: <48B99C63.3030101@loskot.net>

Folks,

I'm experiencing heap corruption while calling OCIEnvCreate [1] function 
from OCI library. I build OCI driver in debug mode (with flags /D_DEBUG 
/MDd) using Visual C++ 8.0 linking against Oracle 10g Client.

The bug seems to be random, because first test I made was with minimal 
set of OGR drivers built-in. In this case OGR drivers registration 
failed with heap corruption error, precisely while deallocating string 
in this line [2].
Next, I built GDAL with default set of drivers + OCI driver
and in that case OCIEnvCreate causes heap corruption.

I spent a couple of hours debugging this issue, playing with MSVC Crt 
debugging utils, using memory checkpoints, etc. but without any 
reasonable findings, so far.

I'm interested in finding what causes this problem, so I'd be thankful 
if anyone who has experienced similar problem could report 
what/how/when/etc. here on the list, including version of Visual C++ 
compiler and compilation flags used.


[1] 
http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/oci/ogrocisession.cpp#L113

[2] 
http://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_vsil_win32.cpp#L496

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From szekerest at gmail.com  Sat Aug 30 16:32:38 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug 30 16:32:41 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
In-Reply-To: <48B99C63.3030101@loskot.net>
References: <48B99C63.3030101@loskot.net>
Message-ID: <f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>

Mateusz,

I could only mention http://trac.osgeo.org/gdal/ticket/2230 in this
topic but I'm not sure if it is related to this problem.
I have been using OCI compiled with MSVC2005 a couple of months ago,
but didn't find such issue. However I'm using /MD instead of /MDd most
of the time.

Best regards,

Tamas



2008/8/30 Mateusz Loskot <mateusz@loskot.net>:
> Folks,
>
> I'm experiencing heap corruption while calling OCIEnvCreate [1] function
> from OCI library. I build OCI driver in debug mode (with flags /D_DEBUG
> /MDd) using Visual C++ 8.0 linking against Oracle 10g Client.
>
> The bug seems to be random, because first test I made was with minimal set
> of OGR drivers built-in. In this case OGR drivers registration failed with
> heap corruption error, precisely while deallocating string in this line [2].
> Next, I built GDAL with default set of drivers + OCI driver
> and in that case OCIEnvCreate causes heap corruption.
>
> I spent a couple of hours debugging this issue, playing with MSVC Crt
> debugging utils, using memory checkpoints, etc. but without any reasonable
> findings, so far.
>
> I'm interested in finding what causes this problem, so I'd be thankful if
> anyone who has experienced similar problem could report what/how/when/etc.
> here on the list, including version of Visual C++ compiler and compilation
> flags used.
>
>
> [1]
> http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/oci/ogrocisession.cpp#L113
>
> [2]
> http://trac.osgeo.org/gdal/browser/trunk/gdal/port/cpl_vsil_win32.cpp#L496
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From frankie at debian.org  Sat Aug 30 16:31:20 2008
From: frankie at debian.org (Francesco Paolo Lovergine)
Date: Sat Aug 30 16:58:21 2008
Subject: [gdal-dev] Segmentation fault using gdal 1.4.4 and 1.5.2 on netcdf
In-Reply-To: <200808272341.44652.even.rouault@mines-paris.org>
References: <3C465A6646C7AD48B03EBF86127AA65437658369@winxbeus09.exchange.xchg>
	<200808272341.44652.even.rouault@mines-paris.org>
Message-ID: <20080830203120.GA6184@mithrandir>

On Wed, Aug 27, 2008 at 11:41:44PM +0200, Even Rouault wrote:
> Vishal,
> 
> you can use both netcdf and HDF4, but you'll have to uninstall the HDF4 
> library packaged by Ubuntu, and compile it from the source with the 
> instructions given in the wiki.
> 
> Maybe worth reporting that to Debian/Ubuntu packagers if there's something 
> they can do to build a compatible HDF4 library by default.
> 

It is already known and reported by me in BTS for Debian. 
HDF4 in Debian is fixed in experimental but it is too late for Lenny, sorry.

-- 
Francesco P. Lovergine
From mateusz at loskot.net  Sat Aug 30 17:13:57 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug 30 17:14:02 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
In-Reply-To: <f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>
References: <48B99C63.3030101@loskot.net>
	<f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>
Message-ID: <48B9B815.1000008@loskot.net>

Tamas Szekeres wrote:
> Mateusz,
> 
> I could only mention http://trac.osgeo.org/gdal/ticket/2230 in this
> topic but I'm not sure if it is related to this problem.
> I have been using OCI compiled with MSVC2005 a couple of months ago,
> but didn't find such issue. However I'm using /MD instead of /MDd most
> of the time.

Tamas,

Thanks for reminding me this ticket.
Yes, indeed it seems to be related.
However, as we are not linking against /MDd I suppose I shouldn't waste 
time on fixing it, though I'm not sure if I can't sleep well knowing 
GDAL might crash  ;-)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From szekerest at gmail.com  Sat Aug 30 17:41:09 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug 30 17:41:14 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
In-Reply-To: <48B9B815.1000008@loskot.net>
References: <48B99C63.3030101@loskot.net>
	<f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>
	<48B9B815.1000008@loskot.net>
Message-ID: <f3b73b7d0808301441h2587982dha2a5eeba6cf902f4@mail.gmail.com>

Mateusz,

I gave up monkeying with MDd after spending a couple of days to
eliminate these strange effects caused crashes in the windows builders
at the buildbot. My suspicion is that in this case we inevitably use
dll dependencies with different CRT setting may lead to unpredicted
problems (OCI lib might have been compiled with /MD I think). I guess
if you could compile all of the related dll with /MDd setting you
would probably gain a more stable debug package then, however I
consider we less likely need to debug into the CRT libraries itself,
so this is what you shouln't worry about. Sleep well :-)

Best regards,

Tamas



2008/8/30 Mateusz Loskot <mateusz@loskot.net>:
> Tamas Szekeres wrote:
>>
>> Mateusz,
>>
>> I could only mention http://trac.osgeo.org/gdal/ticket/2230 in this
>> topic but I'm not sure if it is related to this problem.
>> I have been using OCI compiled with MSVC2005 a couple of months ago,
>> but didn't find such issue. However I'm using /MD instead of /MDd most
>> of the time.
>
> Tamas,
>
> Thanks for reminding me this ticket.
> Yes, indeed it seems to be related.
> However, as we are not linking against /MDd I suppose I shouldn't waste time
> on fixing it, though I'm not sure if I can't sleep well knowing GDAL might
> crash  ;-)
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> Charter Member of OSGeo, http://osgeo.org
>
From mateusz at loskot.net  Sat Aug 30 17:49:40 2008
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sat Aug 30 17:49:44 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
In-Reply-To: <f3b73b7d0808301441h2587982dha2a5eeba6cf902f4@mail.gmail.com>
References: <48B99C63.3030101@loskot.net>	
	<f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>	
	<48B9B815.1000008@loskot.net>
	<f3b73b7d0808301441h2587982dha2a5eeba6cf902f4@mail.gmail.com>
Message-ID: <48B9C074.8020808@loskot.net>

Tamas Szekeres wrote:
> Mateusz,
> 
> I gave up monkeying with MDd after spending a couple of days to
> eliminate these strange effects caused crashes in the windows builders
> at the buildbot. My suspicion is that in this case we inevitably use
> dll dependencies with different CRT setting may lead to unpredicted
> problems (OCI lib might have been compiled with /MD I think). I guess
> if you could compile all of the related dll with /MDd setting you
> would probably gain a more stable debug package then, however I
> consider we less likely need to debug into the CRT libraries itself,
> so this is what you shouln't worry about. Sleep well :-)


Tamas,

Yes, you're probably right. GDAL is built with shared copy of CRT (/MD)
but as I see in Oracle samples for OCI, they use /MT flag and separate 
copies of CRT.

Mixing /MD and /MT may lead to big problems.

Hmm, looks like not solvable problem for OCI.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From szekerest at gmail.com  Sat Aug 30 18:15:15 2008
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Aug 30 18:15:17 2008
Subject: [gdal-dev] OCI driver and Heap Corruption under Visual C++
In-Reply-To: <48B9C074.8020808@loskot.net>
References: <48B99C63.3030101@loskot.net>
	<f3b73b7d0808301332p25a382b2ka4ed6e92d506ab92@mail.gmail.com>
	<48B9B815.1000008@loskot.net>
	<f3b73b7d0808301441h2587982dha2a5eeba6cf902f4@mail.gmail.com>
	<48B9C074.8020808@loskot.net>
Message-ID: <f3b73b7d0808301515s776bfe2m237c396a1b75281f@mail.gmail.com>

2008/8/30 Mateusz Loskot <mateusz@loskot.net>:
> Mixing /MD and /MT may lead to big problems.
>
> Hmm, looks like not solvable problem for OCI.
>

That's true. In this topic I can always point to the following
article, especially to the "MORE INFORMATION" section:

http://support.microsoft.com/kb/140584


But I'd mention that it highly depend on how those dll-s interact with
each other. Dll-s having properly isolated operations with respect to
the memory management may co-operate fairly well with different CRT
settings. However in my experience using the debug and non debug
version of the CRT libraries in parallel may cause further issues that
may not be enumerated as a possible reason in this article.
So I consider using /MT and /MD simultaneously is much better that
using /MD and /MDd in parallel. Lovely....

Best regards,

Tamas
From warmerdam at pobox.com  Sun Aug 31 23:52:17 2008
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sun Aug 31 23:52:31 2008
Subject: [gdal-dev] Injecting Projection information in CreateCopy
In-Reply-To: <96F90541-A056-48C7-B80A-DC05CA783722@iavo-rs.com>
References: <96F90541-A056-48C7-B80A-DC05CA783722@iavo-rs.com>
Message-ID: <48BB66F1.4070401@pobox.com>

Christiaan Janssen wrote:
> VRTDatasets seem to be the best way to go in this case. Is there by chance a
> way to build a VRTDataset that is an exact copy of a GDALDataset or do I
> need to do it manually (not a big deal if I do). BTW, Thanks for all the
> help.

Christiaan,

I believe gdal_translate creates the VRTDataset bit by bit because it
may need to alter some fundamental things (like number of bands, types
and size).  But if all you want to change is malliable stuff such as
coordinate system or geotransform you can just use the VRT CreateCopy()
and then modify the results.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

