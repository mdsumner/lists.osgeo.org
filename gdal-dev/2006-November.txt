From trale at centrum.cz  Wed Nov  1 05:36:14 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdal with kakadu_v5_2_2-00336C
Message-ID: <200611011136.7245@centrum.cz>

Hi list,

I have troubles with compiling the latest gdal13 with the mentioned vetsion of kakadu. There are bunch of errors. Any help ?

Thanks
Nick


From mbrudka at aster.pl  Wed Nov  1 05:46:07 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <45403F3E.307@pobox.com>
References: <45403F3E.307@pobox.com>
Message-ID: <45487AEF.3000801@aster.pl>

Hi,
    Recommended practice:
 > "All source code in SVN should be in Unix text format as opposed to 
DOS text mode."
is rather pointless, as subversion clients convert all text files on the 
fly. It is better thus to employ "svn:eol-style=native" property for all 
existing text files and configure svn clients to do the same when 
creating new ones. Please, see /etc/subversion/config.

Regards
Marek


From mbrudka at aster.pl  Wed Nov  1 06:04:49 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <45403F3E.307@pobox.com>
References: <45403F3E.307@pobox.com>
Message-ID: <45487F51.9090202@aster.pl>

Hi,

Practice:

"When committing new features or significant changes to existing source 
code, the committer should take reasonable measures to insure that the 
source code continues to build and work on the most commonly supported 
platforms (currently Linux and Windows), either by testing on those 
platforms directly, running buildbot tests, or by getting help from 
other developers working on those platforms."

sounds good, but is rather impractical. SVN is a kind of "communication 
medium" between developers and operating systems. Moving manually files 
between Linux/Windows to make tests as well as sending/receiving sources 
to/from developers always lead to troubles with versions/line ends etc. 
Moreover, efforts related with "new features or significant changes" 
usually require a lot of additional work which should be versioned by it 
own. A common practice for this case is to create and work on a private 
branch in repository. I propose then to modify the recommendation in the 
following way:

"New features or significant changes to existing source code should be 
commited to separate private branches. Merging to the main trunk is 
allowed only after testing them by separate developers on various 
platforms."


BTW. I do not think, that the requirement to have all branches 
compilable and valid is reasonable. It is enough the have good sources 
in the main trunk and/or in some important public branches.

Marek


From eric.doenges at gmx.net  Wed Nov  1 06:10:37 2006
From: eric.doenges at gmx.net (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 7: API Change for the VSIxxxL family
	of	file	functions
In-Reply-To: <45476CA0.7050609@pobox.com>
References: <5170F248-52A4-4C7E-9E8C-EC62B85A62E1@gmx.net>	<454655CE.6070809@pobox.com>
	<CFD0C2D4-07A5-4EB3-9A4D-11216DFEA8B7@gmx.net>
	<45476CA0.7050609@pobox.com>
Message-ID: <9EFF1209-4EE7-4F1A-B925-3D1F1C4E58C3@gmx.net>


Am 31.10.2006 um 16:32 schrieb Frank Warmerdam:

> VSIFOpenL() is not an across the board replacement for VSIFOpen().
> The non-L version of the functions continue to exist because
> some drivers use stdio functions that are not implemented for in
> the "L" api, such as VSIFGets().  In some cases driver code directly
> calls stdio functions using the FILE *.

I see. After looking at what VSIVirtualHandle provides, and what the  
drivers
in frmts and ogr need, what seems to be missing is equivalent  
functionality to fgets,
fgetc, ungetc, fprintf and fscanf. The first three would be fairly  
trivial to add, but
the next two ...

> Agreed.  One approach might be to make VSILFILE* a void pointer for  
> now
> with the intention of making it something else that would trigger type
> checking failures later - perhaps when we switch to GDAL 2.0 and are
> willing to sacrifice some backwards compatibility anyways.
>
> In the meantime applications can upgrade to the new mechanisms without
> too much disruption.

I reluctantly agree. I've updated the RFC accordingly. The short-term  
solution
should be much less work to do, since initially only two files need  
to be changed
(cpl_vsil.cpp and cpl_vsi.h).

--- snip ---

RFC 7: API Change for the VSIxxxL family of file functions

Author: Eric D?nges
Contact: Eric.Doenges@gmx.net
Status: Proposed


Purpose

To change the API for the VSIxxxL family of functions to use a new  
data-type
VSILFILE instead of the current FILE.

Background, Rationale

Currently, GDAL offers two APIs to abstract file access functions  
(referred to
as VSIxxx and VSIxxxL in this document). Both APIs claim to operate  
on FILE*;
however, the VSIxxxL functions can only operate on FILE* created by the
VSIOpenL function. This is because VSIOpenL returns a pointer to an  
internal
C++ class typecast to FILE*, not an actual FILE*. This makes it  
impossible
for the compiler to warn when the VSIxxx and VSIxxxL functions are
inappropriately mixed.

Proposed Fix

A new opaque data-type VSILFILE shall be declared. All VSIxxxL  
functions shall
be changed to use this new type instead of FILE. Additionally, any  
GDAL code
that uses the VSIxxxL functions must be changed to use this data-type  
as well.

Compatibility Issues, Transition timeline

In order to allow the compiler to detect inappropriate parameters  
passed to
any of the VSIxxxL functions, VSILFILE would have to be declared with  
the help
of an empty forward declaration, i.e. "typedef struct VSILFILE  
VSILFILE", with
the struct VSILFILE itself left undefined. However, this would break  
source
compatibility for any existing code using the VSIxxxL API.

Therefore, VSILFILE* will be declared as a void pointer for now, and  
the change
to a distinct pointer type deferred to a future release of gdal that  
is not
constrained with backward compatibility issues. While this will not  
solve the
primary issue (no warnings/errors from the compiler), looking at the  
declarations
of the VSIxxxL functions will at least make it immediately clear that  
these
functions cannot be expected to work if passed a FILE pointer.

--- snip ---

With kind regards,
Eric

From maovieira at gmail.com  Wed Nov  1 09:58:11 2006
From: maovieira at gmail.com (marco vieira)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdaladdo error: Wrong "StripByteCounts" field
Message-ID: <5becacd20611010658n6263e57eld04c826e9c7015f3@mail.gmail.com>

Hi folks:

I'm geting this error when using gdaladdo in a tif file created by other
gdal utilities

(1) gdal_translate -of GTiff -ot Int16 %s.asc %s.tif -quiet
(2) gdalwarp -tr 0.00232621 0.00232621 (...)
(3) gdaladdo -r average 1_50_Best_Server.dat.tif 2 4 8
Then:
0...10...20...31...40...51...60...70Warning 1:
TIFFReadDirectory:1_50_Best_Server.dat.tif: Wrong "StripByteCounts" field,
ignoring and calculating from imagelength
.Warning 1: TIFFReadDirectory:1_50_Best_Server.dat.tif: Wrong
"StripByteCounts" field, ignoring and calculating from imagelength
ERROR 1: 1_50_Best_Server.dat.tif:DumpModeDecode: Not enough data for
scanline 0
ERROR 1: TIFFReadEncodedTile() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 6
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 6
ERROR 1: 1_50_Best_Server.dat.tif:DumpModeDecode: Not enough data for
scanline 0
ERROR 1: TIFFReadEncodedTile() failed.
(...)

my gdaladdo is linked by:

ldd /usr/bin/gdaladdo
        linux-gate.so.1 =>  (0xffffe000)
        libgdal1.3.2.so.1 => /usr/lib/libgdal1.3.2.so.1 (0xa7a9b000)
        libxerces-c.so.27 => /usr/lib/libxerces-c.so.27 (0xa76cc000)
        libmfhdf.so.4 => /usr/lib/libmfhdf.so.4 (0xa76a9000)
        libdf.so.4 => /usr/lib/libdf.so.4 (0xa760a000)
        libungif.so.4 => /usr/lib/libungif.so.4 (0xa7602000)
        libpng12.so.0 => /usr/lib/libpng12.so.0 (0xa75de000)
        libnetcdf.so.3 => /usr/lib/libnetcdf.so.3 (0xa75a8000)
        libcfitsio.so.2 => /usr/lib/libcfitsio.so.2 (0xa743a000)
        libpq.so.4 => /usr/lib/libpq.so.4 (0xa741c000)
        librt.so.1 => /lib/tls/librt.so.1 (0xa7414000)
        libdl.so.2 => /lib/tls/libdl.so.2 (0xa7410000)
        libpthread.so.0 => /lib/tls/libpthread.so.0 (0xa73fe000)
        libz.so.1 => /usr/lib/libz.so.1 (0xa73ea000)
        libcrypt.so.1 => /lib/tls/libcrypt.so.1 (0xa73bc000)
        libnsl.so.1 => /lib/tls/libnsl.so.1 (0xa73a5000)
        libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0xa72c6000)
        libm.so.6 => /lib/tls/libm.so.6 (0xa72a1000)
        libgcc_s.so.1 => /lib/libgcc_s.so.1 (0xa7296000)
        libc.so.6 => /lib/tls/libc.so.6 (0xa7164000)
        libgeos.so.2 => /usr/lib/libgeos.so.2 (0xa7071000)
        libodbc.so.1 => /usr/lib/libodbc.so.1 (0xa7011000)
        libjasper-1.701.so.1 => /usr/lib/libjasper-1.701.so.1 (0xa6fc4000)
        libjpeg.so.62 => /usr/lib/libjpeg.so.62 (0xa6fa4000)
        libtiff.so.4 => /usr/lib/libtiff.so.4 (0xa6f50000)
        libmysqlclient.so.15 => /usr/lib/libmysqlclient.so.15 (0xa6d7e000)
        libicuuc.so.36 => /usr/lib/libicuuc.so.36 (0xa6c67000)
        libicudata.so.36 => /usr/lib/libicudata.so.36 (0xa62b7000)
        libssl.so.0.9.8 => /usr/lib/i686/cmov/libssl.so.0.9.8 (0xa6278000)
        libcrypto.so.0.9.8 => /usr/lib/i686/cmov/libcrypto.so.0.9.8
(0xa613e000)
        libkrb5.so.3 => /usr/lib/libkrb5.so.3 (0xa60c2000)
        libcom_err.so.2 => /lib/libcom_err.so.2 (0xa60be000)
        /lib/ld-linux.so.2 (0xa7f24000)
        libltdl.so.3 => /usr/lib/libltdl.so.3 (0xa60b7000)
        libk5crypto.so.3 => /usr/lib/libk5crypto.so.3 (0xa6092000)
        libresolv.so.2 => /lib/tls/libresolv.so.2 (0xa607f000)
        libkrb5support.so.0 => /usr/lib/libkrb5support.so.0 (0xa6079000)

I use debian testing:

uname -a
Linux spatialsv2 2.6.17-2-486 #1 Wed Sep 13 15:56:30 UTC 2006 i686 GNU/Linux

With GDAL 1.3.2:

dpkg -l |grep gdal
ii  gdal-bin                         1.3.2-2                     Geospatial
Data Abstraction Library - Utilit
rc  libgdal1-1.3.1                   1.3.1-6                     Geospatial
Data Abstraction Library
ii  libgdal1-1.3.2                   1.3.2-2                     Geospatial
Data Abstraction Library
ii  libgdal1-1.3.2-dev               1.3.2-2                     Geospatial
Data Abstraction Library - Develo

ldconfig -v|grep gdal
        libgdal1.3.2.so.1 -> libgdal1.3.2.so.1.10.0

I test gdaladdo in other tif files like drgncimq1926.tif from mapserver
workshop data with similar results (Segmentation Fault on 71% processed)

Any clue?
-- 
Marco Vieira
+55 21 9499-6800
e-mail: maovieira@gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061101/ff9f03de/attachment.html
From warmerdam at pobox.com  Wed Nov  1 10:57:22 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <45487F51.9090202@aster.pl>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
Message-ID: <4548C3E2.8070307@pobox.com>

Marek Brudka wrote:
> Hi,
> 
> Practice:
> 
> "When committing new features or significant changes to existing source 
> code, the committer should take reasonable measures to insure that the 
> source code continues to build and work on the most commonly supported 
> platforms (currently Linux and Windows), either by testing on those 
> platforms directly, running buildbot tests, or by getting help from 
> other developers working on those platforms."
> 
> sounds good, but is rather impractical. SVN is a kind of "communication 
> medium" between developers and operating systems. Moving manually files 
> between Linux/Windows to make tests as well as sending/receiving sources 
> to/from developers always lead to troubles with versions/line ends etc. 
> Moreover, efforts related with "new features or significant changes" 
> usually require a lot of additional work which should be versioned by it 
> own. A common practice for this case is to create and work on a private 
> branch in repository. I propose then to modify the recommendation in the 
> following way:
> 
> "New features or significant changes to existing source code should be 
> commited to separate private branches. Merging to the main trunk is 
> allowed only after testing them by separate developers on various 
> platforms."
> 
> 
> BTW. I do not think, that the requirement to have all branches 
> compilable and valid is reasonable. It is enough the have good sources 
> in the main trunk and/or in some important public branches.

Marek,

It was not my intention by the original paragraph to imply that the software
builds at all moments.  That is, I anticipated people commiting the code
when they are somewhat sure it works, and then promptly testing it on
other platforms from source control (as the buildbots do).  The point
being that if they commit something wrong, they should discover this soon
and have it fixed (say within an hour).  Rather than just waiting till
other developers update and complain.

If this aspect was unclear, and the PMC wishes, I can try and clarify this
in the text as an editorial clarification.

I'm personally not yet comfortable with this concept of private working
branches, and as such do not wish to incorporate their use into our documents
as standard practice.   I would agree that the "buildability" requirement
applies only to important public branches (ie. trunk and stable branches).

PS. The RFC was adopted.  I'd rather not re-open the issue for other than
editorial changes unless the need is fairly compelling.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov  1 11:01:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdaladdo error: Wrong "StripByteCounts" field
In-Reply-To: <5becacd20611010658n6263e57eld04c826e9c7015f3@mail.gmail.com>
References: <5becacd20611010658n6263e57eld04c826e9c7015f3@mail.gmail.com>
Message-ID: <4548C4CE.4090306@pobox.com>

marco vieira wrote:
> Hi folks:
> 
> I'm geting this error when using gdaladdo in a tif file created by other 
> gdal utilities
> 
> (1) gdal_translate -of GTiff -ot Int16 %s.asc %s.tif -quiet
> (2) gdalwarp -tr 0.00232621 0.00232621 (...)
> (3) gdaladdo -r average 1_50_Best_Server.dat.tif 2 4 8
> Then:
> 0...10...20...31...40...51...60...70Warning 1: 
> TIFFReadDirectory:1_50_Best_Server.dat.tif: Wrong "StripByteCounts" 
> field, ignoring and calculating from imagelength
> .Warning 1: TIFFReadDirectory:1_50_Best_Server.dat.tif: Wrong 
> "StripByteCounts" field, ignoring and calculating from imagelength
> ERROR 1: 1_50_Best_Server.dat.tif:DumpModeDecode: Not enough data for 
> scanline 0
> ERROR 1: TIFFReadEncodedTile() failed.
> 
> ERROR 1: IReadBlock failed at X offset 0, Y offset 6
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 6
> ERROR 1: 1_50_Best_Server.dat.tif:DumpModeDecode: Not enough data for 
> scanline 0
> ERROR 1: TIFFReadEncodedTile() failed.
> (...)


Marco,

There have been a number of fixes in this general area.  Could you download
and try reproducing the problem with FWTools 1.0.7 for linux?  I should
run fine on Debian on x86.  If the problem occurs with FWTools (essentially
build from GDAL and libtiff CVS) then please file a bug against GDAL with
all the details I will need to reproduce the problem.

It is also potentially possible you ran out of disk space and the file was
truncated.  The error checking for this isn't all what it ought to be.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov  1 11:04:39 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <45487AEF.3000801@aster.pl>
References: <45403F3E.307@pobox.com> <45487AEF.3000801@aster.pl>
Message-ID: <4548C597.1000606@pobox.com>

Marek Brudka wrote:
> Hi,
>    Recommended practice:
>  > "All source code in SVN should be in Unix text format as opposed to 
> DOS text mode."
> is rather pointless, as subversion clients convert all text files on the 
> fly. It is better thus to employ "svn:eol-style=native" property for all 
> existing text files and configure svn clients to do the same when 
> creating new ones. Please, see /etc/subversion/config.

Marek,

There are ways of committing code into SVN in DOS format.  The RFC says
this should not be done.  How folks ensure it gets converted into Unix
text format in SVN is up to them. If they can accomplish it with the
appropriate SVN settings, then more power to them.

I will admit the RFC (despite talking about SVN everywhere) is really
based on best practices established over years of using CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov  1 11:05:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdal with kakadu_v5_2_2-00336C
In-Reply-To: <200611011136.7245@centrum.cz>
References: <200611011136.7245@centrum.cz>
Message-ID: <4548C5CF.9040503@pobox.com>

trale@centrum.cz wrote:
> Hi list,
> 
> I have troubles with compiling the latest gdal13 with the mentioned vetsion of kakadu. There are bunch of errors. Any help ?

Nick,

You really need to provide more information than this.

If you are doing this on unix, please ensure you use --without-libtool
when configuring if you want to include Kakadu.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dmorissette at mapgears.com  Wed Nov  1 11:07:44 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <45487F51.9090202@aster.pl>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
Message-ID: <4548C650.9080805@mapgears.com>

Marek Brudka wrote:
> 
> "New features or significant changes to existing source code should be 
> commited to separate private branches. Merging to the main trunk is 
> allowed only after testing them by separate developers on various 
> platforms."
> 

Ouch... I don't want to imagine what the SVN repository will look like 
in a few years if we keep creating private branches for everything. Even 
just one private branch per committer (and likely per committer per 
software release) is likely to lead to quite a mess. That's assuming I 
understood Mateusz' explanation right and branching indeed means 
duplicating the whole directory tree on the server. (As I wrote before, 
in CVS a branch is just a tag and the cost IMO is lower than full 
duplication of everything so that would be less of an issue.)

Is it really common practive with SVN-based projects to create private 
branches and merge like this? Is this not abusing the features of the 
source code management system? Is there a way to physically delete a 
private branch from the SVN server and remove any trace from it in order 
to keep the repository clean?

Just thinking out loud...

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From dmorissette at mapgears.com  Wed Nov  1 11:15:46 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548C3E2.8070307@pobox.com>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C3E2.8070307@pobox.com>
Message-ID: <4548C832.2020101@mapgears.com>

Frank Warmerdam wrote:
> 
> It was not my intention by the original paragraph to imply that the 
> software
> builds at all moments.  That is, I anticipated people commiting the code
> when they are somewhat sure it works, and then promptly testing it on
> other platforms from source control (as the buildbots do).  The point
> being that if they commit something wrong, they should discover this soon
> and have it fixed (say within an hour).  Rather than just waiting till
> other developers update and complain.
> 

That's what I was thinking too and the way all other projects in which 
I'm involved work... and this does work very well in practice as long as 
committers are reasonably careful about what they do.


> If this aspect was unclear, and the PMC wishes, I can try and clarify this
> in the text as an editorial clarification.
> 

Maybe a clarification would help if we all agree. I would definitely not 
object to it even if the RFC has been adopted already.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From mbrudka at aster.pl  Wed Nov  1 11:47:34 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548C597.1000606@pobox.com>
References: <45403F3E.307@pobox.com> <45487AEF.3000801@aster.pl>
	<4548C597.1000606@pobox.com>
Message-ID: <4548CFA6.4080900@aster.pl>

Frank,
> Marek Brudka wrote:
>> Hi,
>>    Recommended practice:
>>  > "All source code in SVN should be in Unix text format as opposed 
>> to DOS text mode."
>> is rather pointless, as subversion clients convert all text files on 
>> the fly. It is better thus to employ "svn:eol-style=native" property 
>> for all existing text files and configure svn clients to do the same 
>> when creating new ones. Please, see /etc/subversion/config.
>
> Marek,
>
> There are ways of committing code into SVN in DOS format. 
The way the files are stored in SVN repository is the implementation 
detail of SVN, and does not depend on committer will. Please, read the 
chapter in svn guide about properties (metadata) and in particular about 
"svn:eol-style=native" to understand the way subversion handles text 
files. The practices from CSV are useless here, because the architecture 
of CSV is different than SVN.

Marek


From mbrudka at aster.pl  Wed Nov  1 11:57:45 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548C650.9080805@mapgears.com>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C650.9080805@mapgears.com>
Message-ID: <4548D209.70806@aster.pl>

Daniel Morissette wrote:
> Marek Brudka wrote:
>>
>> "New features or significant changes to existing source code should 
>> be commited to separate private branches. Merging to the main trunk 
>> is allowed only after testing them by separate developers on various 
>> platforms."
>>
>
> Ouch... I don't want to imagine what the SVN repository will look like 
> in a few years if we keep creating private branches for everything. 
> Even just one private branch per committer (and likely per committer 
> per software release) is likely to lead to quite a mess. 
I could show you such svn repo after 2 years in middle size company and 
believe me, nothing special happened there. In general creating 
developement branches is recommended practice both in csv and in svn.

> That's assuming I understood Mateusz' explanation right and branching 
> indeed means duplicating the whole directory tree on the server.
It's only a logical copy. Files and directories are physically copied on 
new commits only.
>
> Is it really common practive with SVN-based projects to create private 
> branches and merge like this? 
Yes, it is. Obviosly not for a single line patches, but for more serious 
works.
> Is this not abusing the features of the source code management system? 
Which features and how?
> Is there a way to physically delete a private branch from the SVN server
AFAIK no.
> and remove any trace from it in order to keep the repository clean?
What for? What does it mean clean?

Marek


From mbrudka at aster.pl  Wed Nov  1 12:10:54 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548C3E2.8070307@pobox.com>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C3E2.8070307@pobox.com>
Message-ID: <4548D51E.6080901@aster.pl>

Frank
Frank Warmerdam wrote:
>> "New features or significant changes to existing source code should 
>> be commited to separate private branches. Merging to the main trunk 
>> is allowed only after testing them by separate developers on various 
>> platforms."
>
> It was not my intention by the original paragraph to imply that the 
> software
> builds at all moments.  That is, I anticipated people commiting the code
> when they are somewhat sure it works, and then promptly testing it on
> other platforms from source control (as the buildbots do).  
Please notice, you introduce a transient state of svn repo when writing:
> The point being that if they commit something wrong, they should 
> discover this soon
> and have it fixed (say within an hour).  Rather than just waiting till
> other developers update and complain.
SVN ensures atomic commits, hence it is rather silly to allow such 
transient states.
It is better to state that the main trunk is at least compilable all the 
time rather usually.
>
> If this aspect was unclear, and the PMC wishes, I can try and clarify 
> this
> in the text as an editorial clarification.
>
> I'm personally not yet comfortable with this concept of private working
> branches, and as such do not wish to incorporate their use into our 
> documents
> as standard practice.
But you should, as this is important part of developement process. 
Private branches are good and *working* way to moderate  interactions 
between developers.
>    I would agree that the "buildability" requirement
> applies only to important public branches (ie. trunk and stable 
> branches).
Right!
>
> PS. The RFC was adopted.  I'd rather not re-open the issue for other than
> editorial changes unless the need is fairly compelling. 
As usual Frank. When you lack arguments you choose force solutions.

Marek


From warmerdam at pobox.com  Wed Nov  1 12:40:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Opening E00 files
In-Reply-To: <200610311854.k9VIshPX019478@liam.avenza.com>
References: <200610311854.k9VIshPX019478@liam.avenza.com>
Message-ID: <4548DC20.7080809@pobox.com>

Devon Noonan wrote:
> Here is my situation; I originally used the ogrinfo utility to see if there
> was support for the E00 sections that I am looking for. It opened the file
> (not a binary source but a single e00 file) and gave me the sections back.
> Excellent, no problems here. Now I have integrated it in to my program and
> tried to open a file, it continually tells me that the file could not be
> opened. I used the RegisterOGRAVCBin() call to initialize the driver. When
> the driver tries to open the file it throws the error. Do I need to call in
> to the AVC library before or after I try to open the file?
> 
> Any help would be appreciated!

Devon,

I'm sorry for not answering this earlier.  I was a bit uncertain about how
this works, and I thought perhaps Craig had covered things.

 From an inspection what I see is that there is one driver - AVCBin.  It
now supports both E00 and binary coverages.

I have removed the commented out e00 register call in ogrregisterall.cpp
in cvs just now.

Unfortunately, none of this answers why you aren't able to open the e00
files, since RegisterOGRAVCBin should be sufficient.

Is it possible that you are using a different build of OGR for your
program than was used in FWTools?  FWTools is build from the current
development versions.  For instance E00 support was not in GDAL 1.3.2.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov  1 14:42:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Sponsorship Program
Message-ID: <4548F8C2.3040305@pobox.com>

Folks,

I have wanted to put a formalized sponsorship program in place for
GDAL/OGR for some time.  The "Project Sponsorship" program has finally been
passed for OSGeo, and I'd like to apply it to GDAL/OGR.

I have attached a proposed solicitation page for sponsorship as applied
to this project.  I'd also encourage folks to re-read the Project
Responsibility section at:

   http://wiki.osgeo.org/index.php/Project_Sponsorship

For now I'm circulating this for discussion.  I'll make a formal motion
to the GDAL/OGR PSC in a day or two.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061101/9f6529df/sponsorship.html
From sy at perkins.net  Wed Nov  1 17:09:46 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548D51E.6080901@aster.pl>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C3E2.8070307@pobox.com> <4548D51E.6080901@aster.pl>
Message-ID: <1162418986.9459.274779154@webmail.messagingengine.com>


On Wed, 01 Nov 2006 18:10:54 +0100, "Marek Brudka" <mbrudka@aster.pl>
said:

> > PS. The RFC was adopted.  I'd rather not re-open the issue for other than
> > editorial changes unless the need is fairly compelling. 
> As usual Frank. When you lack arguments you choose force solutions.
> 
> Marek

Marek,

Insults are not called for here. The RFC was proposed and voted on by
the GDAL committee (not just Frank) in accordance with the RFC
procedure. You did not object at the time. Frank is one of the the most
careful and conscientious software maintainers I have ever encountered,
and he is merely pointing out that if something has already been voted
on and formally adopted, then it's not reasonable to substantially
change it. Which isn't to say that new procedures can't be voted in that
supercede the old ones. It seems to me that the detailed branching /
tagging policy is not really covered by RFC 3. If we want to come up
with a policy or set of guidelines for this, then we should open a new
RFC to discuss that. Feel free to do so, and let's discuss the issues
like civilized people.

Cheers,

Sy

P.S. For what it's worth, I've played around a bit with more frequent
branching under CVS, and I agree that there are times when it's useful.
For instance, when working on an experimental feature from multiple
different machines - the private branch gives you a convenient way to
check the half-finished code into a central repository without upsetting
anyone else. On the other hand, under CVS at least, it required a
certain amount of discipline to make sure you always made sure what
branch you had checked out, and were careful with merges and so forth.
I've screwed up and lost edits at least once by not beng careful.
Perhaps SVN makes things more robust, but in any case, if we do have an
official policy of encouraging branches for major changes, we should
carefully analyze the pros and cons, and we should explicitly describe
the explicit procedure for doing things properly using the most common
SVN clients.




From rayg at daylongraphics.com  Wed Nov  1 17:47:56 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 7: API Change for the VSIxxxL family	of	file
	functions
In-Reply-To: <9EFF1209-4EE7-4F1A-B925-3D1F1C4E58C3@gmx.net>
References: <5170F248-52A4-4C7E-9E8C-EC62B85A62E1@gmx.net>
	<454655CE.6070809@pobox.com>
	<CFD0C2D4-07A5-4EB3-9A4D-11216DFEA8B7@gmx.net>
	<45476CA0.7050609@pobox.com>
	<9EFF1209-4EE7-4F1A-B925-3D1F1C4E58C3@gmx.net>
Message-ID: <4549241C.8000302@daylongraphics.com>

> I see. After looking at what VSIVirtualHandle provides, and what the
>  drivers in frmts and ogr need, what seems to be missing is
> equivalent functionality to fgets, fgetc, ungetc, fprintf and fscanf.
> The first three would be fairly trivial to add, but the next two ...

fprintf can be handled with:

     int our_fprintf(our_file_t stream, const char* pszFormat, ...)
     {
         va_list argList;
         va_start(argList, pszFormat);
         int n;
         if(stream.small())
             n = vfprintf(stream.filep, pszFormat, argList);
         else
         {
             char sz[max_printf_len + 1]; // todo: unsafe
             n = vsprintf(sz, pszFormat, argList);
             large_file_write(stream.file, sz, n);
         }
         va_end(argList);
         return n;
     }

fscanf is admittedly non-trivial but there's open source to the rescue.
If you grab, e.g., 
http://gentoo.osuosl.org/distfiles/avr-libc-1.2.6.tar.bz2

it has open source implementations of CRT that you can borrow from. 
Their licence states:
"The contents of avr-libc are licensed with a Modified BSD License.
All of this is supposed to be Free Software, Open Source, DFSG-free,
GPL-compatible, and OK to use in both free and proprietary applications."

Ray




From warmerdam at pobox.com  Wed Nov  1 22:06:54 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 5 - Implications for Scripting
Message-ID: <454960CE.5030507@pobox.com>

Andrey,

When you get a chance to another pass on RFC 5, I'd appreciate you
addressing implications for scripting language.  Do we need to change
anything with our swig wrapping to map properly into script language UTF8
or multibyte string types?  It seems like we probably would.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sy at perkins.net  Thu Nov  2 00:58:13 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
Message-ID: <454988F5.8050401@perkins.net>

Hi,

I've just tried to use the GDAL C# SWIG bindings on Windows for the 
first time today and ran into a couple of problems. I'm using Visual 
Studio 2005 Express with SWIG 1.3.29.

I compiled GDAL and then typed:

 > cd swig\csharp
 > nmake /f makefile.vc interface
 > nmake /f makefile.vc
 > nmake /f makefile.vc test

The first two makes seem to work OK. The final test throws an exception 
and prints the following:

Unhandled Exception: System.TypeInitializationException: The type 
initializer fo
r 'OGR.ogr' threw an exception. ---> System.TypeInitializationException: 
The typ
e initializer for 'OGR.ogrPINVOKE' threw an exception. ---> 
System.TypeInitializ
ationException: The type initializer for 'SWIGExceptionHelper' threw an 
exceptio
n. ---> System.DllNotFoundException: Unable to load DLL 'gdal_ogr_wrap': 
The spe
cified module could not be found. (Exception from HRESULT: 0x8007007E)

...

As with so many VS 2005 problems, this turned out to be a manifest 
issue. Inserting a few lines into the makefile.vc to embed the manifest 
files into the DLLs fixed this. I'll check in these changes if nobody 
objects. I suspect that similar lines need to be added for other SWIG 
languages on windows if anyone else feels like doing that...

However, I'm still a little unclear about exactly how to use the SWIG 
libraries. My primary interest is in the GDAL RasterIO functions, which 
seem to be present as Band.ReadRaster() and Band.WriteRaster(). The C# 
function signatures for these are:

public int ReadRaster(int xoff, int yoff, int xsize, int ysize, 
SWIGTYPE_p_int buf_xsize, SWIGTYPE_p_int buf_ysize, SWIGTYPE_p_int buf_type)
 
public int WriteRaster(int xoff, int yoff, int xsize, int ysize, int 
buf_len, SWIGTYPE_p_int buf_xsize, SWIGTYPE_p_int buf_ysize, 
SWIGTYPE_p_int buf_type)

These functions seem to be missing some arguments. In particular, how do 
you pass in the buffer where data is to be read from / written to? What 
are those SWIGTYPE_P_int types? Can anyone give me an example of how to 
use these functions? Do they work? If not can anyone give me some 
pointers on fixing them?

Cheers,

Sy


From eric.doenges at gmx.net  Thu Nov  2 03:07:50 2006
From: eric.doenges at gmx.net (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 7: API Change for the VSIxxxL family	of	file
	functions
In-Reply-To: <4549241C.8000302@daylongraphics.com>
References: <5170F248-52A4-4C7E-9E8C-EC62B85A62E1@gmx.net>
	<454655CE.6070809@pobox.com>
	<CFD0C2D4-07A5-4EB3-9A4D-11216DFEA8B7@gmx.net>
	<45476CA0.7050609@pobox.com>
	<9EFF1209-4EE7-4F1A-B925-3D1F1C4E58C3@gmx.net>
	<4549241C.8000302@daylongraphics.com>
Message-ID: <00E72C63-4D35-477A-B419-0648598C7606@gmx.net>


Am 01.11.2006 um 23:47 schrieb Ray Gardener:

> fprintf can be handled with:
>
>     int our_fprintf(our_file_t stream, const char* pszFormat, ...)
>     {
>         va_list argList;
>         va_start(argList, pszFormat);
>         int n;
>         if(stream.small())
>             n = vfprintf(stream.filep, pszFormat, argList);
>         else
>         {
>             char sz[max_printf_len + 1]; // todo: unsafe
>             n = vsprintf(sz, pszFormat, argList);
>             large_file_write(stream.file, sz, n);
>         }
>         va_end(argList);
>         return n;
>     }

While this approach would certainly work, I think it would be better  
to take an
existing printf implementation (for instance from Cygnus newlib,  
located at
http://sources.redhat.com/newlib) and adapt that to be exactly what  
GDAL requires.
This would avoid the fixed length temporary buffer (which is ugly !)  
and allow us
to have a locale-independent printf. I have adapted newlib's sprintf  
to print directly
into a ringbuffer (and removed floating point to conserve space for  
an embedded
project) before, so I know this is doable with moderate effort.

IMO, the best way to do this would be to add an fgetc-like function  
to VSIVirtualHandle,
and have a custom fprintf function that calls this fputc-like  
function for every
character to output. While this does add the overhead of a function  
call for each
character output, on Unix system at least this shouldn't really be  
all that bad because
stdio is buffered, and the really expensive part of I/O is only  
triggered once the
system has to actually write the buffer to disk. However, I don't  
know anything about
Windows programming, so I can't comment on if it's feasible to do  
something like this
for the Windows implementation of VSIVirtualHandle. It would of  
course also be possible
to have separate printf functions for each of the concrete  
implementations of
VSIVirtualHandle (memory, Unix stdio, and Windows), but that would  
duplicate a lot of
code, and risk having the different printf functions behave slightly  
different from each
other.

> fscanf is admittedly non-trivial but there's open source to the  
> rescue.
> If you grab, e.g., http://gentoo.osuosl.org/distfiles/avr- 
> libc-1.2.6.tar.bz2
>
> it has open source implementations of CRT that you can borrow from.  
> Their licence states:
> "The contents of avr-libc are licensed with a Modified BSD License.
> All of this is supposed to be Free Software, Open Source, DFSG-free,
> GPL-compatible, and OK to use in both free and proprietary  
> applications."

Personally, I'm partial to newlib (which also has a BSD-like licence  
- actually, the
printf code itself is taken from BSD), because I've been using that  
in my day jobs for
the last 9 years or so.

With kind regards,
Eric

From dmorissette at mapgears.com  Thu Nov  2 08:52:22 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4548D209.70806@aster.pl>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C650.9080805@mapgears.com> <4548D209.70806@aster.pl>
Message-ID: <4549F816.7080704@mapgears.com>

Marek Brudka wrote:
> 
>> That's assuming I understood Mateusz' explanation right and branching 
>> indeed means duplicating the whole directory tree on the server.
> It's only a logical copy. Files and directories are physically copied on 
> new commits only.

Good to hear. That makes me feel a bit better.


>>
>> Is it really common practive with SVN-based projects to create private 
>> branches and merge like this? 
> Yes, it is. Obviosly not for a single line patches, but for more serious 
> works.
>> Is this not abusing the features of the source code management system? 
> Which features and how?
>> Is there a way to physically delete a private branch from the SVN server
> AFAIK no.
>> and remove any trace from it in order to keep the repository clean?
> What for? What does it mean clean?
> 

By clean I mean that I would like to see only branches and tags related 
to releases of the software in the repository. In a few year from now I 
won't be interested in seeing dozens of private branches all over the 
place... that's the mess I am referring to. Maybe your company's 
repository doesn't look too bad after 2 years, perhaps that's because 
there are only a few developers and release branches are not that 
frequent? We are talking about a project with 20+ developers, with a 
couple of significant releases (release means branch) per year, and that 
is going to be around for several years. The history in the current GDAL 
repository starts in 1998, that's 8 years ago ... add another 10 years 
to that and imagine what a repository would look like with 18 years of 
private branches.

I realize that private branches seem to be a new trend, but personally I 
find this is not proper use of the source code repository.

In my ideal world, the CVS/SVN repository would contain only release 
tags and branches, named in a systematic way so that we can easily track 
them, and exceptionally we may create dev branches for major feature 
development outside of the main trunk but that should be the exception, 
not the rule.

For instance, in the case of the MapServer project's CVS repository, all 
development always happens in the trunk and we use "branch-x-y" for 
stable release branches and "rel-x-y-z" to tag releases. This gives the 
following tag/branches history for the last 3 years for map.h which is 
probably the most frequently modified file in the whole project:

         rel-4-10-0: 1.469
         branch-4-10: 1.469.0.2
         rel-4-10-0-rc1: 1.468
         rel-4-10-0-beta3: 1.465
         rel-4-10-0-beta2: 1.462
         rel-4-10-0-beta1: 1.459
         rel-4-8-4: 1.437.2.9
         rel-4-8-3: 1.437.2.8
         rel-4-8-2: 1.437.2.7
         rel-4-8-1: 1.437.2.5
         rel-4-8-0: 1.437.2.4
         rel-4-8-0-rc3: 1.437.2.2
         branch-4-8: 1.437.0.2
         rel-4-8-0-rc2: 1.437
         rel-4-8-0-rc1: 1.436
         rel-4-8-0-beta3: 1.435
         rel-4-6-2: 1.416.2.2
         rel-4-8-0-beta2: 1.432
         rel-4-8-0-beta1: 1.430
         rel-4-6-1: 1.416.2.1
         branch-4-6: 1.416.0.2
         rel-4-6-0: 1.416
         rel-4-6-0-rc1: 1.414
         rel-4-6-0-beta3: 1.413
         rel-4-6-0-beta2: 1.407
         rel-4-6-0-beta1: 1.405
         rel-4-4-2: 1.382.2.2
         rel-4-4-1: 1.382.2.1
         branch-4-4: 1.382.0.2
         rel-4-4-0: 1.382
         rel-4-4-0-beta3: 1.381
         rel-4-4-0-beta2: 1.365
         rel-4-4-0-beta1: 1.361
         rel-4-2-5: 1.302.2.18
         rel-4-2-4: 1.302.2.17
         rel-4-2-3: 1.302.2.11
         rel-4-2-2: 1.302.2.10
         rel-4-2-1: 1.302.2.8
         rel-4-2-0: 1.302.2.7
         rel-4-2-0-beta3: 1.302.2.6
         rel-4-2-0-beta2: 1.302.2.1
         branch-4-2: 1.302.0.2
         rel-4-0-2: 1.255.2.2
         rel-3-6-7: 1.150.2.17
         rel-4-0-1: 1.255.2.1
         rel-4-0-0: 1.255
         branch-4-0: 1.255.0.2

This is what I call clean... add 3 years of private branches for 20+ 
developers to that and you get what I'd call a mess.

My 0.02$,

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From lists at b-open-solutions.it  Thu Nov  2 09:29:38 2006
From: lists at b-open-solutions.it (Alessandro Amici)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4549F816.7080704@mapgears.com>
References: <45403F3E.307@pobox.com> <4548D209.70806@aster.pl>
	<4549F816.7080704@mapgears.com>
Message-ID: <200611021529.38451.lists@b-open-solutions.it>


Daniel,

Alle 14:52, gioved? 2 novembre 2006, Daniel Morissette ha scritto:
> In my ideal world, the CVS/SVN repository would contain only release
> tags and branches, named in a systematic way so that we can easily
> track them, and exceptionally we may create dev branches for major
> feature development outside of the main trunk but that should be the
> exception, not the rule.

i understand your concerns, anyhow svn is much more friendly than cvs 
WRT tagging and branching and you have several alternatives to keep 
branch-creep under control, for example with svn you can:
 * delete old/stale tags/branches (still keeping the whoole history)
 * group developer tags/branches under some special folder out of the 
main 'branches' namespace

i'm not advocating branch-creep, but at least with svn you have a number 
of mitigating strategies not available to cvs.

cheers,
Alessandro

-- 
B-Open Solutions srl - http://www.bopen.it/


From warmerdam at pobox.com  Thu Nov  2 10:52:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 7: API Change for the VSIxxxL
	family	of	file	functions
In-Reply-To: <00E72C63-4D35-477A-B419-0648598C7606@gmx.net>
References: <5170F248-52A4-4C7E-9E8C-EC62B85A62E1@gmx.net>	<454655CE.6070809@pobox.com>	<CFD0C2D4-07A5-4EB3-9A4D-11216DFEA8B7@gmx.net>	<45476CA0.7050609@pobox.com>	<9EFF1209-4EE7-4F1A-B925-3D1F1C4E58C3@gmx.net>	<4549241C.8000302@daylongraphics.com>
	<00E72C63-4D35-477A-B419-0648598C7606@gmx.net>
Message-ID: <454A1440.3080400@pobox.com>

Eric D?nges wrote:
> 
> Am 01.11.2006 um 23:47 schrieb Ray Gardener:
> 
>> fprintf can be handled with:
>>
>>     int our_fprintf(our_file_t stream, const char* pszFormat, ...)
>>     {
>>         va_list argList;
>>         va_start(argList, pszFormat);
>>         int n;
>>         if(stream.small())
>>             n = vfprintf(stream.filep, pszFormat, argList);
>>         else
>>         {
>>             char sz[max_printf_len + 1]; // todo: unsafe
>>             n = vsprintf(sz, pszFormat, argList);
>>             large_file_write(stream.file, sz, n);
>>         }
>>         va_end(argList);
>>         return n;
>>     }
> 
> While this approach would certainly work, I think it would be better to 
> take an
> existing printf implementation (for instance from Cygnus newlib, located at
> http://sources.redhat.com/newlib) and adapt that to be exactly what GDAL 
> requires.
> This would avoid the fixed length temporary buffer (which is ugly !) and 
> allow us
> to have a locale-independent printf. I have adapted newlib's sprintf to 
> print directly
> into a ringbuffer (and removed floating point to conserve space for an 
> embedded
> project) before, so I know this is doable with moderate effort.
> 
> IMO, the best way to do this would be to add an fgetc-like function to 
> VSIVirtualHandle,
> and have a custom fprintf function that calls this fputc-like function 
> for every
> character to output.

Folks,

I would point out there is no need for any big complexity in this regard.
It is perfectly possible to implement printf style functionality on any
system with vsnprintf().  The CPLString::Printf() function demonstrates this.
Basically use vsnprintf(), and if the working buffer is too small, reset and
try again with a bigger buffer.

The discussions of a scanf() replacement are more significant.

I'd add there may still be a number of drivers that directly use a variety
of stdio functions with the FILE *'s returned by VSIFOpen().  A careful
review of existing usage would be required before it could be determined
whether this is still a problem, or if it will be hard to rectify.

I personally would feel much more comfortable to *not* try and change the
non-L VSI API, and stay focused on the VSI*L api.  It might be desirable
to review if some use of the small api can be replaced with the large but
this seems mostly orthagonal to the main discussion.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ludwigbrinckmann at gmail.com  Thu Nov  2 11:03:38 2006
From: ludwigbrinckmann at gmail.com (Ludwig Max Brinckmann)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Re: Changing colour in tif file
In-Reply-To: <3f7a6e1c0611020458u345363a9we304757db0371b6c@mail.gmail.com>
References: <3f7a6e1c0611020458u345363a9we304757db0371b6c@mail.gmail.com>
Message-ID: <3f7a6e1c0611020803k669f75bal8c6ecbec37321b4@mail.gmail.com>

I want to change one particular colour in a set of 3-band tif tiles
(basically change the colour used for no-data fields)

I have seen there is a gdal python contribution val_repl.py, but looking
through the code this will replace the same value in every band in the file.

I need to replace a value in three bands depending on a condition spanning
the three bands, e.g if RGB == 255,0,0 then RGB = 120,60,60 or some such.

Any good idea?

Ludwig
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061102/513a61d2/attachment.html
From szekerest at gmail.com  Thu Nov  2 11:23:19 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454988F5.8050401@perkins.net>
References: <454988F5.8050401@perkins.net>
Message-ID: <f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>

Simon,

>
> As with so many VS 2005 problems, this turned out to be a manifest
> issue. Inserting a few lines into the makefile.vc to embed the manifest
> files into the DLLs fixed this. I'll check in these changes if nobody
> objects. I suspect that similar lines need to be added for other SWIG
> languages on windows if anyone else feels like doing that...
>

Please give me the option to investigate the problem in more detail. I
would not keen to decorate the c# assemblies with embedded manifests
by default. I consider this as solely a VS2005 issue. I would also
keep up the support for the MONO runtime currently on Windows and on
Linux/OSX in the future.
As far as I remember the VS2005 linker is able to generate the
manifest files along with the binaries. Placing the manifests in the
same directory as the executable with the same name adding the
.manifest extension would be sufficient in most cases.
However for the ASP.NET applications (where the host process is
outside of the application, and the security context is different)
embedding the manifests might be required for the VS2005 builds.
For more details see our experiences for the mapscript libraries here:
http://mapserver.gis.umn.edu/docs/howto/mapscriptcscompile

> However, I'm still a little unclear about exactly how to use the SWIG
> libraries. My primary interest is in the GDAL RasterIO functions, which
> seem to be present as Band.ReadRaster() and Band.WriteRaster(). The C#
> function signatures for these are:
>

Well, I have dealt mostly with the OSR/OGR part of the interface so
far and we have some typemaps missing mostly at the GDAL part.
Therefore you cannot really use those functions with objects prefixed
by SWIGTYPE_
I'm continously adding the missing typemaps to the interface, and I
have to write test samples so see how GDAL handles the parameters and
the return values behind the scenes.
So as to speed up this work if would be helpful if I got some expected
C# examples to see how the folks would use the interface. Some of the
specific test samples could be placed into the \swig\csharp\apps
directory as well.

Best Regards,

Tamas Szekeres

From neteler at itc.it  Thu Nov  2 12:01:17 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GeoTIFF and CCITTRLE compression
Message-ID: <20061102170117.GM4556@bartok.itc.it>

Hi,

I was asked to fix some ArcInfo generated TIF/TWF files
to Geotiff to include the projection info.

Original header:

Driver: GTiff/GeoTIFF
Size is 26508, 22992
Coordinate System is `'
Origin = (1680792.312782,5091252.448363)
Pixel Size = (0.25000000,-0.25000000)
Metadata:
  AREA_OR_POINT=Point
  TIFFTAG_SOFTWARE=Arc/Info
  TIFFTAG_XRESOLUTION=0.039000001
  TIFFTAG_YRESOLUTION=0.039000001
  TIFFTAG_RESOLUTIONUNIT=3 (pixels/cm)
Image Structure Metadata:
  COMPRESSION=CCITTRLE
Corner Coordinates:
Upper Left  ( 1680792.313, 5091252.448) 
Lower Left  ( 1680792.313, 5085504.448) 
Upper Right ( 1687419.313, 5091252.448) 
Lower Right ( 1687419.313, 5085504.448) 
Center      ( 1684105.813, 5088378.448) 
Band 1 Block=26508x3 Type=Byte, ColorInterp=Palette
  Metadata:
    NBITS=1
  Color Table (RGB with 2 entries)
    0: 255,255,255,255
    1: 0,0,0,255

Using
gdal_translate -a_srs EPSG:26591 -co COMPRESSION=CCITTRLE ...
does not quite work since CCITTRLE isn't supported (AFAIK).
Also the color table is expanded a lot to 0..255.

My questions are:
- how to compress in a similar way (since we cannot preserve CCITTRLE)?
- is the color table expansion harmful (it looks ok, but will it be
  understood everywhere)?

thanks,
Markus

From warmerdam at pobox.com  Thu Nov  2 12:49:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GeoTIFF and CCITTRLE compression
In-Reply-To: <20061102170117.GM4556@bartok.itc.it>
References: <20061102170117.GM4556@bartok.itc.it>
Message-ID: <454A2FBC.5050403@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> I was asked to fix some ArcInfo generated TIF/TWF files
> to Geotiff to include the projection info.

...

> Using
> gdal_translate -a_srs EPSG:26591 -co COMPRESSION=CCITTRLE ...
> does not quite work since CCITTRLE isn't supported (AFAIK).
> Also the color table is expanded a lot to 0..255.
> 
> My questions are:
> - how to compress in a similar way (since we cannot preserve CCITTRLE)?
> - is the color table expansion harmful (it looks ok, but will it be
>   understood everywhere)?

Markus,

If you compress with something like "-co COMPRESS=DEFLATE" you should return
things relatively close to the original file size.

The color table change is not likely harmful to most applications, but of
course the core problem is that GDAL's GeoTIFF driver does not support
writing 1bit files, so things are expanded to 8bit.  This file is
quite different than the original.

If you want to preserve a file that is closer to the original you might want
to use the following steps.

  o Use listgeo on the file you produced with gdal_translate to capture the
    proper GeoTIFF tag values.
  o Use geotifcp with the original file as input, and the geotiff tags from
    the above listgeo command.  This *should* produce a file much like the
    original but with the geotiff tags updated.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ari.jolma at tkk.fi  Thu Nov  2 13:05:31 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 5 - Implications for Scripting
In-Reply-To: <454960CE.5030507@pobox.com>
References: <454960CE.5030507@pobox.com>
Message-ID: <454A336B.4060503@tkk.fi>

Frank Warmerdam kirjoitti:
> Andrey,
>
> When you get a chance to another pass on RFC 5, I'd appreciate you
> addressing implications for scripting language.  Do we need to change
> anything with our swig wrapping to map properly into script language UTF8
> or multibyte string types?  It seems like we probably would.

Swig docs do not seem to mention UTF8 at all, so it is probably up to 
every language to check and take care of this issue with their own 
tools. For example Perl has good tools for this. In general I think this 
would be a welcome thing but every time I have tried to understand well 
Unicode my head has started to hurt.

Ari

>
> Best regards,


-- 
Prof. Ari Jolma
Geoinformaatio- ja paikannustekniikka
Geoinformation and positioning technology
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From josegomez at gmx.net  Thu Nov  2 14:08:43 2006
From: josegomez at gmx.net (Jose Luis Gomez Dans)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
Message-ID: <20061102190843.19910@gmx.net>

Hi!
I have noticed that somebody else mentioned the release of numpy 1.0, and the implications for GDAL. My question is however different: at work, we use Enthought Python, a rather useful Python bundle with numpy, scipy, matplotlib and loads of extra packages. On top of that, we use the GDAL bindings. So far, we have made do with FWTools and Enthought, as they are compatible (python 2.3), but there's a sea change when Enthought upgrades from Numeric to Numpy and from python 2.3 to 2.4. Apart from compiling from source (we have no experience on this), what would be the "recommended best way" of using GDAL with Enthought be?

One nice thing would be for the Enthought guys to package GDAL with their Python. This is hard to do, and not something that ranks high as a priority for them. They have suggested that if users can provide a recipe to build an egg <http://www.python-eggs.org/> for Windows and Linux, they'd be happy to carry that and distribute it.

The question being whether anyone might be willing to do this :) I think it would be a very nice thing to have, as for many of us, GDAL is the only way to input data into our processing chains. Unfortunately, I have little or no experience of doing this sort of thing, and maybe it's so difficult that it is unfeasible. I just thought I'd mention it to see if someone suggests an easy and convenient way to have both up to date numpy, scipy (and friends) working together with the latest and greatest GDAL (specifically on Win32, in Linux compilation is straightforward and easy).

Cheers,
Jose
-- 
GMX DSL-Flatrate 0,- Euro* - ?berall, wo DSL verf?gbar ist!
NEU: Jetzt bis zu 16.000 kBit/s! http://www.gmx.net/de/go/dsl

From dylan.beaudette at gmail.com  Thu Nov  2 14:43:19 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] 
	StarSpan Progress, and quick question on OGR data sources
Message-ID: <200611021143.19660.dylan.beaudette@gmail.com>

Hi guys,

I was recently working on a project involving vector data stored in a PostGIS 
table, and raster data stored in GRASS - using starspan to perform the 
analysis. I noticed a (bug?) in starspan, where the --vector argument will 
only accept a single parameter. This becomes a problem when specifying an OGR 
PostGIS connection.

For example:
ogrinfo PG:"dbname=pinn  host=localhost" table_name

would return all the gory details from the spatial table 'table_name'  from 
the database 'pinn' .

note that there are two parameters on the command line: a DSN and the table 
(or in OGR terms, a layer).

In starspan it is not possible to pass in 2 items to the --vector argument.

I posted this question on the IRC channel yesterday, and was away from the 
computer when Frank responded. 

It sounds like there is no way to specify a 'table' in the PG datasource 
description line. Searching google, it sounds like there is some way to 
specify a 'schema' - but it is not clear how or if this would allow one to 
specify a specific table in a PostGIS data source. 

Therefore, I wonder if there is a simple modification to the starspan code 
which would allow for PG data sources to specify a table.

Note that starspan can correctly extract PG vector data, when there is only 1 
spatial table in the DB.

Any thoughts? 

PS: I think that the abilities of starspan really shine here: extracting data 
from postgis and GRASS, two drastically different data sources -- all though 
the magic which is GDAL. Good work everyone!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From hobu at iastate.edu  Thu Nov  2 14:26:00 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <20061102190843.19910@gmx.net>
References: <20061102190843.19910@gmx.net>
Message-ID: <6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>

A couple of (maybe) useful bits of info.

MS4W has an old-gen GDAL module for Windows 
Python 2.4.  It's broken up into a number of 
pieces, and it might not be that nice to pull 
together, but you should be able to get it to work with some elbow grease.

The "old-gen" GDAL bindings do not have support 
for numpy.  I will be looking into supporting 
this in the "next-gen" GDAL  Python bindings in 
the next couple of weeks.  I have a need for this 
also, and I would like to get it tucked in before 
the next release.  Hopefully, this will remove 
any need for folks to use the "old-gen" bindings 
for anything other than legacy apps.

Python eggs and setuptools support are something that would be nice.

Howard

At 01:08 PM 11/2/2006, Jose Luis Gomez Dans wrote:
>Hi!
>I have noticed that somebody else mentioned the 
>release of numpy 1.0, and the implications for 
>GDAL. My question is however different: at work, 
>we use Enthought Python, a rather useful Python 
>bundle with numpy, scipy, matplotlib and loads 
>of extra packages. On top of that, we use the 
>GDAL bindings. So far, we have made do with 
>FWTools and Enthought, as they are compatible 
>(python 2.3), but there's a sea change when 
>Enthought upgrades from Numeric to Numpy and 
>from python 2.3 to 2.4. Apart from compiling 
>from source (we have no experience on this), 
>what would be the "recommended best way" of using GDAL with Enthought be?
>
>One nice thing would be for the Enthought guys 
>to package GDAL with their Python. This is hard 
>to do, and not something that ranks high as a 
>priority for them. They have suggested that if 
>users can provide a recipe to build an egg 
><http://www.python-eggs.org/> for Windows and 
>Linux, they'd be happy to carry that and distribute it.
>
>The question being whether anyone might be 
>willing to do this :) I think it would be a very 
>nice thing to have, as for many of us, GDAL is 
>the only way to input data into our processing 
>chains. Unfortunately, I have little or no 
>experience of doing this sort of thing, and 
>maybe it's so difficult that it is unfeasible. I 
>just thought I'd mention it to see if someone 
>suggests an easy and convenient way to have both 
>up to date numpy, scipy (and friends) working 
>together with the latest and greatest GDAL 
>(specifically on Win32, in Linux compilation is straightforward and easy).
>
>Cheers,
>Jose
>--
>GMX DSL-Flatrate 0,- Euro* - ?berall, wo DSL verf?gbar ist!
>NEU: Jetzt bis zu 16.000 kBit/s! http://www.gmx.net/de/go/dsl
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev



From Chris.Barker at noaa.gov  Thu Nov  2 15:08:01 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
References: <20061102190843.19910@gmx.net>
	<6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
Message-ID: <454A5021.3060300@noaa.gov>

Howard Butler wrote:
> The "old-gen" GDAL bindings do not have support for numpy.  I will be 
> looking into supporting this in the "next-gen" GDAL  Python bindings in 
> the next couple of weeks.

Great to hear! Make sure you keep this list updated for help -- I have 
little time, but would love to help, with testing if nothing else.

Also as a note, that besides specific numpy support, support for the 
"array interface" would be nice -- nothing but num* uses it now, but I 
do think that's changing.

By the way, while you're at it, I hope you have a chance to re-structure 
the the python binding are installed. Dumping everything into 
site-packages is pretty messy -- it should all be a a single gdal package.

That being said, you can use the binding fairly effectively with numpy 
anyway, not directly, but by dumping data into numpy arrays with 
numpy.fromstring and ReadRaster and the like.

-Chris

-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From hobu at iastate.edu  Thu Nov  2 15:41:46 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <454A5021.3060300@noaa.gov>
References: <20061102190843.19910@gmx.net>
	<6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
	<454A5021.3060300@noaa.gov>
Message-ID: <6.2.3.4.2.20061102143853.030af568@hobu.mail.iastate.edu>

At 02:08 PM 11/2/2006, Christopher Barker wrote:
>Howard Butler wrote:
>>The "old-gen" GDAL bindings do not have support for numpy.  I will 
>>be looking into supporting this in the "next-gen" GDAL  Python 
>>bindings in the next couple of weeks.
>
>Great to hear! Make sure you keep this list updated for help -- I 
>have little time, but would love to help, with testing if nothing else.
>
>Also as a note, that besides specific numpy support, support for the 
>"array interface" would be nice -- nothing but num* uses it now, but 
>I do think that's changing.

Is the "array interface" something that's hoped to be in Python 
proper in the near to distant future?  I'm not aware of what this is...

>By the way, while you're at it, I hope you have a chance to 
>re-structure the the python binding are installed. Dumping 
>everything into site-packages is pretty messy -- it should all be a 
>a single gdal package.

Arranging things into a "package" is something I've wished for GDAL 
for quite a while.  The problem is that there are an unknown number 
of legacy things out there dependent on gdal.py and ogr.py and the 
way they import.  Re-arranging the deck chairs at this point could 
cause a lot of misery.  I don't know how we approach this other than 
to write and RFC, pass it, and just do it.

>That being said, you can use the binding fairly effectively with 
>numpy anyway, not directly, but by dumping data into numpy arrays 
>with numpy.fromstring and ReadRaster and the like.
>
>-Chris
>
>--
>Christopher Barker, Ph.D.
>Oceanographer
>
>NOAA/OR&R/HAZMAT         (206) 526-6959   voice
>7600 Sand Point Way NE   (206) 526-6329   fax
>Seattle, WA  98115       (206) 526-6317   main reception
>
>Chris.Barker@noaa.gov
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From sy at perkins.net  Thu Nov  2 15:42:09 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
Message-ID: <1162500129.7885.274867443@webmail.messagingengine.com>


On Thu, 2 Nov 2006 17:23:19 +0100, "Tamas Szekeres"
<szekerest@gmail.com> said:
> Simon,
> 
> >
> > As with so many VS 2005 problems, this turned out to be a manifest
> > issue. Inserting a few lines into the makefile.vc to embed the manifest
> > files into the DLLs fixed this. I'll check in these changes if nobody
> > objects. I suspect that similar lines need to be added for other SWIG
> > languages on windows if anyone else feels like doing that...
> >
> 
> Please give me the option to investigate the problem in more detail. I
> would not keen to decorate the c# assemblies with embedded manifests
> by default. I consider this as solely a VS2005 issue. I would also
> keep up the support for the MONO runtime currently on Windows and on
> Linux/OSX in the future.

The lines I added to the makefile check to see if the manifest file
exists before embedding it in the DLL, so AFAIK they would have no
effect on VS 2003. Would it have any effect on MONO builds?

If it only has an effect in VS 2005, why would you ever not want to
embed the manifest? It's one less file to worry about keeping around,
and in many cases you have to embed to get the DLL to work. In fact, I
couldn't get the swig C# test program to run without embedding the
manifest. My understanding is that putting the manifest in the same
directory as the assembly works OK for executables, but not for DLLs.
The OS seems to igore the .dll.manifest file. Sometimes it works OK,
because the libraries required by the DLL have already been loaded by
the calling executable, but not always. Is there any cost for embedding
manifests?


> As far as I remember the VS2005 linker is able to generate the
> manifest files along with the binaries. Placing the manifests in the
> same directory as the executable with the same name adding the
> .manifest extension would be sufficient in most cases.

The .manifest files are generated automatically, but not embedded. I
couldn't get the simplest test programs to work until I embedded the
manifest. This is with all the executables, DLLs, manifest files etc in
the same directory.


> > However, I'm still a little unclear about exactly how to use the SWIG
> > libraries. My primary interest is in the GDAL RasterIO functions, which
> > seem to be present as Band.ReadRaster() and Band.WriteRaster(). The C#
> > function signatures for these are:
> >
> 
> Well, I have dealt mostly with the OSR/OGR part of the interface so
> far and we have some typemaps missing mostly at the GDAL part.
> Therefore you cannot really use those functions with objects prefixed
> by SWIGTYPE_
> I'm continously adding the missing typemaps to the interface, and I
> have to write test samples so see how GDAL handles the parameters and
> the return values behind the scenes.
> So as to speed up this work if would be helpful if I got some expected
> C# examples to see how the folks would use the interface. Some of the
> specific test samples could be placed into the \swig\csharp\apps
> directory as well.

I'd be happy to help with this, since I need this one function ASAP -
ideally by the weekend... I'll take a look tonight and if I come up with
an obvious solution I'll run it by you. I'm not a SWIG expert by any
means, though I did write large chunks of the hand-rolled C# GDAL
bindings that were circulated on this list a few months back, including
this function.

Just off the type of my head, it would be nicest to have a generic
function with a signature that was something like:

  CPLErr ReadRaster<T>(int xOff, int yOff, int xSize, int ySize, T[]
  buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)

and similarly for Band.WriteRaster(). Overloads could be provided
without the last two arguments (or even the last four), for the most
common default cases. Is this kind of generic function possible with
SWIG? Or are you trying to preserve C# 1.x compatibility anyway (which
would preclude using generics)? Without the generic, we could either
have separate functions for each of the GDAL data types (my preference)
or have the user pass in some kind of void pointer and a type flag as in
the C function. What do you think? 

Actually, it may even be better to have the user pass in a pointer since
we often want to use GDAL to read/write from/to a Bitmap buffer, where
we can only access the internal buffer via a pointer. Either way, the
function is likely to have to be declared unsafe.

Cheers,

Sy

From Chris.Barker at noaa.gov  Thu Nov  2 16:45:08 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <6.2.3.4.2.20061102143853.030af568@hobu.mail.iastate.edu>
References: <20061102190843.19910@gmx.net>
	<6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
	<454A5021.3060300@noaa.gov>
	<6.2.3.4.2.20061102143853.030af568@hobu.mail.iastate.edu>
Message-ID: <454A66E4.7010702@noaa.gov>

Howard Butler wrote:
> At 02:08 PM 11/2/2006, Christopher Barker wrote:
> Is the "array interface" something that's hoped to be in Python proper 
> in the near to distant future?  I'm not aware of what this is...

The array interface is an interface for describing arrays in memory that 
you might want to efficiently pass around between different libraries. 
It was developed and implemented in numpy, and back-ported to Numeric 
and numarray:

http://numpy.scipy.org/array_interface.shtml

There is discussion right now on python-dev about including something 
like it in a future python standard library.

Until then, the most recent version of PIL supports it, and I hope to 
write some code for wxPython soon.

Is the plan for GDAL to depend on numpy? If so, then methods that return 
  batches of data can return numpy arrays, which conform to the array 
interface, and could be used by other libs that understand that, so it's 
no big deal.

On the other hand, if numpy is optional, it would be nice if those same 
methods would return an object that conforms to the array interface. 
They could conform to the standard lib buffer interface at the same 
time, I think.

Similar thinking for methods that take data as input.

> Arranging things into a "package" is something I've wished for GDAL for 
> quite a while.

It really needs to be done!

> The problem is that there are an unknown number of 
> legacy things out there dependent on gdal.py and ogr.py and the way they 
> import. Re-arranging the deck chairs at this point could cause a lot of
> misery. 

Aren't there going to be API changes anyway? editing import statements 
is a very minor task.

> I don't know how we approach this other than to write and RFC, 
> pass it, and just do it.

Nor do I. I say if you're writing the code, you have a lot of freedom to 
  structure it the way you want.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From izzybitsie at gmail.com  Thu Nov  2 17:05:40 2006
From: izzybitsie at gmail.com (Dorita)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdal_merge.py
Message-ID: <23e208430611021405h4f864250hfcdaf1361ab31cd4@mail.gmail.com>

Hi,

I am trying to compose  a couple of GeoTiff images into one GeoTiff image.
I run the command merge.py -o kk.tif -pct kk1.tif kk2.tif.  Running doesn't
complain, but the final image only shows kk1.tif.  I have tried to run
same command with different images with same results.

Both input files are in the same coordinate system and have one band.
The input images were downloaded from
http://www.hydro.gov.au/seafarer/geotiff/geotiff-sample/geotiff-sample.htm
for test purposes.

 I am using gdal 1.3.2.0 , Python 2.4.2 and the system is 2.4.32-gentoo-r4

Tx

izzy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061102/83918730/attachment.html
From hobu at iastate.edu  Thu Nov  2 17:07:46 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <454A66E4.7010702@noaa.gov>
References: <20061102190843.19910@gmx.net>
	<6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
	<454A5021.3060300@noaa.gov>
	<6.2.3.4.2.20061102143853.030af568@hobu.mail.iastate.edu>
	<454A66E4.7010702@noaa.gov>
Message-ID: <6.2.3.4.2.20061102160131.02d1d690@hobu.mail.iastate.edu>

At 03:45 PM 11/2/2006, Christopher Barker wrote:
>Is the plan for GDAL to depend on numpy? If so, then methods that 
>return  batches of data can return numpy arrays, which conform to 
>the array interface, and could be used by other libs that understand 
>that, so it's no big deal.

Is numpy "the winner" in the sense that numeric, numarray, etc have 
fallen to the wayside as far as developer momentum and general 
use?  I don't follow these communities close enough to know.  I think 
going forward, GDAL only wants to support one array library, and the 
array interface stuff looks like a great way to do it.  As of right 
now, there's nothing for the next-gen Python bindings, so if I'm able 
to get a numpy interface going, that's probably as far as it would go 
unless someone else steps in and develops something else.

>Aren't there going to be API changes anyway? editing import 
>statements is a very minor task.
>
>>I don't know how we approach this other than to write and RFC, pass 
>>it, and just do it.
>
>Nor do I. I say if you're writing the code, you have a lot of 
>freedom to  structure it the way you want.

The next-gen Python bindings are deliberately consistent with the 
old-gen ones.  API changes between the two are minimal to 
non-existent.  The biggest missing piece has been the 
numpy/numeric/numarray support, which for lots of people is a very 
key piece of missing functionality.  I hope to close this gap.

As far as the imports and package structure, I agree its impact is 
probably minimal, but some might find the churn annoying nonetheless.

Howard 


From Chris.Barker at noaa.gov  Thu Nov  2 18:30:54 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL and Python
In-Reply-To: <6.2.3.4.2.20061102160131.02d1d690@hobu.mail.iastate.edu>
References: <20061102190843.19910@gmx.net>
	<6.2.3.4.2.20061102131657.02e24920@hobu.mail.iastate.edu>
	<454A5021.3060300@noaa.gov>
	<6.2.3.4.2.20061102143853.030af568@hobu.mail.iastate.edu>
	<454A66E4.7010702@noaa.gov>
	<6.2.3.4.2.20061102160131.02d1d690@hobu.mail.iastate.edu>
Message-ID: <454A7FAE.6090008@noaa.gov>

Howard Butler wrote:
> Is numpy "the winner" in the sense that numeric, numarray, etc have 
> fallen to the wayside as far as developer momentum and general use?

In terms of anything new, yes. Legacy projects will probably be using 
Numeric or numarray for a while yet, but numpy is clearly the way to go 
for anything new.

>  I think going 
> forward, GDAL only wants to support one array library, and the array 
> interface stuff looks like a great way to do it.

Exactly. If you generate numpy arrays, then Numeric an numarray will be 
able to work with them efficiently anyway.

> The next-gen Python bindings are deliberately consistent with the 
> old-gen ones.

Well, that's probably a good thing.

> The biggest missing piece has been the numpy/numeric/numarray support, 
> which for lots of people is a very key piece of missing functionality.  
> I hope to close this gap.

I know it's a big gap for me.

> As far as the imports and package structure, I agree its impact is 
> probably minimal, but some might find the churn annoying nonetheless.

I still say go for it!

Are you using SWIG? If so, be sure to check out:

http://www.scipy.org/Cookbook/SWIG_and_NumPy

Also, the numpy mailing list folks are very helpful:

https://lists.sourceforge.net/lists/listinfo/numpy-discussion

You'll be well served by getting on that list and asking questions.

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From szekerest at gmail.com  Thu Nov  2 18:39:09 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <1162500129.7885.274867443@webmail.messagingengine.com>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
	<1162500129.7885.274867443@webmail.messagingengine.com>
Message-ID: <f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>

>
> The lines I added to the makefile check to see if the manifest file
> exists before embedding it in the DLL, so AFAIK they would have no
> effect on VS 2003. Would it have any effect on MONO builds?
>

It seems to be working with the MONO framework as well. In this regard
I have no objection to embed the manifests into the corresponding
dll-s using the mt tool after checking the existence of the manifest
files. If you have already modified the makefile.vc accordingly then
go ahead and commit the changes.


> > So as to speed up this work if would be helpful if I got some expected
> > C# examples to see how the folks would use the interface. Some of the
> > specific test samples could be placed into the \swig\csharp\apps
> > directory as well.
>
> I'd be happy to help with this, since I need this one function ASAP -
> ideally by the weekend... I'll take a look tonight and if I come up with
> an obvious solution I'll run it by you. I'm not a SWIG expert by any
> means, though I did write large chunks of the hand-rolled C# GDAL
> bindings that were circulated on this list a few months back, including
> this function.
>
> Just off the type of my head, it would be nicest to have a generic
> function with a signature that was something like:
>
>   CPLErr ReadRaster<T>(int xOff, int yOff, int xSize, int ySize, T[]
>   buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)
>
> and similarly for Band.WriteRaster(). Overloads could be provided
> without the last two arguments (or even the last four), for the most
> common default cases. Is this kind of generic function possible with
> SWIG? Or are you trying to preserve C# 1.x compatibility anyway (which
> would preclude using generics)? Without the generic, we could either
> have separate functions for each of the GDAL data types (my preference)
> or have the user pass in some kind of void pointer and a type flag as in
> the C function. What do you think?
>
> Actually, it may even be better to have the user pass in a pointer since
> we often want to use GDAL to read/write from/to a Bitmap buffer, where
> we can only access the internal buffer via a pointer. Either way, the
> function is likely to have to be declared unsafe.
>

Since I would support VS2003 with FW 1.x and MONO the template
approach is not realistic so far. Instead I would support overloading
the functions with the generic data types. It will be mostly a C#
interface specific solution. I will take care of it as soon as
possible.


Best Regards,

Tamas Szekeres

From sy at perkins.net  Thu Nov  2 19:56:03 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>	
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
Message-ID: <454A93A3.4050006@perkins.net>

Tamas Szekeres wrote:
> Since I would support VS2003 with FW 1.x and MONO the template
> approach is not realistic so far. Instead I would support overloading
> the functions with the generic data types. It will be mostly a C#
> interface specific solution. I will take care of it as soon as
> possible.

Fair enough. My initial thought was to suggest a signature like:

  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte* 
buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)

and similarly for other data types (short, ushort, int, uint, long, 
ulong, float, double). Using a pointer rather than an array for the 
buffer allows the method to be used to fill Bitmaps without having to 
copy into an intermediate array.

So, that would be 9 methods, and that's not even including signed bytes 
or complex data types...

It would also be nice not to have to specify all the arguments in common 
cases. Since we don't have default arguments in C#, we could use two 
more overloads for each of the above with signatures like:

  // bufXSize == xSize, bufYSize == ySize, pixelSpace == 
sizeof(datatype), lineSpace == sizeof(datatype) * bufXSize
  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte* 
buffer)

  // pixelSpace == sizeof(datatype), lineSpace == sizeof(datatype) * 
bufXSize
  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte* 
buffer, int bufXSize, int bufYSize)


So we're up to 27 different methods...

And then all over again for WriteRaster(). Making a grand total of 54 
different method signatures for reading and writing data - not covering 
all the possible data types! Hmmm...



OK, if that's way too many, how about this as an alternative: we follow 
the GDAL pattern and pass an IntPtr buffer, along with an enum argument 
that specifies the data type. We can probably also drop one of the above 
overloads, since this is a low level API. In that case, we would have a 
grand total of 4 signatures:

  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, 
IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)

 public void ReadRaster(int xOff, int yOff, int xSize, int ySize, IntPtr 
buffer, int bufXSize, int bufYSize, GDALDataType type, int pixelSpace, 
int lineSpace)

  public void WriteRaster(int xOff, int yOff, int xSize, int ySize, 
IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)

 public void WriteRaster(int xOff, int yOff, int xSize, int ySize, 
IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type, int 
pixelSpace, int lineSpace)


How does that sound? Maybe at some point in the future when generics are 
the norm, we can add templated versions to get a  modicum of type safety 
and avoid having to specify a data type explicitly.



Cheers!

Sy

P.S. I've just checked in my manifest embedding changes to makefile.vc



From sy at perkins.net  Thu Nov  2 20:29:30 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL Manifest Changes
In-Reply-To: <454A1CE6.6080506@loskot.net>
References: <45498AA0.1010207@perkins.net> <4549F66C.7040801@loskot.net>
	<1162484431.11038.274847930@webmail.messagingengine.com>
	<454A1CE6.6080506@loskot.net>
Message-ID: <454A9B7A.7000703@perkins.net>


Visual Studio / makefile.vc people:

I've just checked some small changes into makefile.vc, apps/makefile.vc 
and ogr/Makefile to automatically embed manifests into DLLs and EXEs, if 
they are generated. Shouldn't have any effect unless you're using VS 
2005. I also removed the lines I added a few months ago to install 
manifest files into the install directories for the install target, 
since this is no longer necessary. Manifest files are also cleaned up by 
the clean target.

This should eliminate some mysterious "MSVCR80.DLL not found" problems 
you may encounter when linking against GDAL built using VS 2005.

Basically, every DLL and EXE target now has an additional line that 
looks something like:

if exist $(SOME_DLL).manifest mt -manifest $(SOME_DLL).manifest -outputresource:$(SOME_DLL);2

or

if exist $(SOME_EXE).manifest mt -manifest $(SOME_EXE).manifest -outputresource:$(SOME_EXE);1


Note that this is a subset of the solution found here:

http://msdn2.microsoft.com/en-us/library/ms235591.aspx

That solution has a lot of extra bells and whistles to enable incremental linking. But full linking doesn't seem to take very long anyway, so I didn't bother including that stuff.


Please let me know if you encounter any problems.

Cheers,

Sy




From hobu at iastate.edu  Thu Nov  2 23:20:06 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Mac OSX Framework builds
Message-ID: <EF6ED7DD-C635-404D-9A93-7D3A2E5AFA74@iastate.edu>

All,

I have incorporated William's patches for OSX framework builds into  
CVS.  A bug tracking these developments can be found at <http:// 
bugzilla.remotesensing.org/show_bug.cgi?id=1297>.  A description of  
OSX Frameworks can be found at <http://www.kernelthread.com/mac/osx/ 
programming.html>.  These developments shouldn't have any impact on  
the normal build process, and they only (optionally) pertain to GDAL  
on OSX.

To try it out, configure your GDAL tree with --with-macosx-framework,  
and when you do 'make install', it will place the framework build in / 
Library/Frameworks/GDAL.framework.  This build option should allow  
you to work with GDAL inside of XCode in a way that it expects and  
provide some symmetry for other open source projects doing the  
framework thing on OSX like R and OSSIM.

Thanks for the detailed notes and patches William,

Howard

From woklist at kyngchaos.com  Thu Nov  2 23:28:33 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Re: Mac OSX Framework builds
In-Reply-To: <EF6ED7DD-C635-404D-9A93-7D3A2E5AFA74@iastate.edu>
References: <EF6ED7DD-C635-404D-9A93-7D3A2E5AFA74@iastate.edu>
Message-ID: <3D80AD3E-E589-48E8-B778-BF8919C6CFBA@kyngchaos.com>

Cool.  I'll try it out, and follow up in the bug track if there are  
any problems.

On Nov 2, 2006, at 10:20 PM, Howard Butler wrote:

> All,
>
> I have incorporated William's patches for OSX framework builds into  
> CVS.  A bug tracking these developments can be found at <http:// 
> bugzilla.remotesensing.org/show_bug.cgi?id=1297>.  A description of  
> OSX Frameworks can be found at <http://www.kernelthread.com/mac/osx/ 
> programming.html>.  These developments shouldn't have any impact on  
> the normal build process, and they only (optionally) pertain to  
> GDAL on OSX.
>
> To try it out, configure your GDAL tree with --with-macosx- 
> framework, and when you do 'make install', it will place the  
> framework build in /Library/Frameworks/GDAL.framework.  This build  
> option should allow you to work with GDAL inside of XCode in a way  
> that it expects and provide some symmetry for other open source  
> projects doing the framework thing on OSX like R and OSSIM.
>
> Thanks for the detailed notes and patches William,
>
> Howard

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

"Those people who most want to rule people are, ipso-facto, those  
least suited to do it."

- A rule of the universe, from the HitchHiker's Guide to the Galaxy



From mateusz at loskot.net  Fri Nov  3 03:40:59 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL Manifest Changes
In-Reply-To: <454A9B7A.7000703@perkins.net>
References: <45498AA0.1010207@perkins.net>
	<4549F66C.7040801@loskot.net>	<1162484431.11038.274847930@webmail.messagingengine.com>	<454A1CE6.6080506@loskot.net>
	<454A9B7A.7000703@perkins.net>
Message-ID: <454B009B.4000806@loskot.net>

Simon Perkins wrote:
> Visual Studio / makefile.vc people:
> 
> I've just checked some small changes into makefile.vc, apps/makefile.vc
> and ogr/Makefile to automatically embed manifests into DLLs and EXEs, if
> they are generated. Shouldn't have any effect unless you're using VS
> 2005. I also removed the lines I added a few months ago to install
> manifest files into the install directories for the install target,
> since this is no longer necessary. Manifest files are also cleaned up by
> the clean target.
> 
> This should eliminate some mysterious "MSVCR80.DLL not found" problems
> you may encounter when linking against GDAL built using VS 2005.
> 
> Basically, every DLL and EXE target now has an additional line that
> looks something like:
> 
> if exist $(SOME_DLL).manifest mt -manifest $(SOME_DLL).manifest
> -outputresource:$(SOME_DLL);2
> 
> or
> 
> if exist $(SOME_EXE).manifest mt -manifest $(SOME_EXE).manifest
> -outputresource:$(SOME_EXE);1
> [...]

Simon,

Today, I was asked for Windows XP version of some Shapelib utils,
so I decided to do small test of your idea.
I did build DLL and .exe utils from PROJ.4 4.5.0 and Shapelib 1.2.10,
according to this guidelines, using Visual C++ 2005.

I applied appropriate changes to makefile.vc files in PROJ.4 and
Shapelib sources and made .exe utils linking dynamically with DLLs.
Shortly, it works for me well.

Here are sources with my changes:

1) http://mateusz.loskot.net/tmp/proj-4.5.0-mloskot.zip
src\makefile.vc

2) http://mateusz.loskot.net/tmp/shapelib-1.2.10-mloskot.zip
makefile.vc
contrib\makefile.vc

Note, all makefile.vc files I changed got appropriate comment
at the beginning.

Here are binaries compiled and ready to test:
http://mateusz.loskot.net/tmp/proj-shapelib-bin-mloskot.zip

Note, all .exe files load dynamically shapelib.dll and/or proj.dll,
so check if there are no old versions of these libraries in your
environment.

I think this short test is good to touch & feel Simon's concept.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From szekerest at gmail.com  Fri Nov  3 05:34:27 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454A93A3.4050006@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
Message-ID: <f3b73b7d0611030234o31feb022x9a8c167ee6c452b3@mail.gmail.com>

>
> Fair enough. My initial thought was to suggest a signature like:
>
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)
>
> and similarly for other data types (short, ushort, int, uint, long,
> ulong, float, double). Using a pointer rather than an array for the
> buffer allows the method to be used to fill Bitmaps without having to
> copy into an intermediate array.
>
> So, that would be 9 methods, and that's not even including signed bytes
> or complex data types...
>
> It would also be nice not to have to specify all the arguments in common
> cases. Since we don't have default arguments in C#, we could use two
> more overloads for each of the above with signatures like:
>
>   // bufXSize == xSize, bufYSize == ySize, pixelSpace ==
> sizeof(datatype), lineSpace == sizeof(datatype) * bufXSize
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer)
>
>   // pixelSpace == sizeof(datatype), lineSpace == sizeof(datatype) *
> bufXSize
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer, int bufXSize, int bufYSize)
>
>
> So we're up to 27 different methods...
>
> And then all over again for WriteRaster(). Making a grand total of 54
> different method signatures for reading and writing data - not covering
> all the possible data types! Hmmm...
>
>
>
> OK, if that's way too many, how about this as an alternative: we follow
> the GDAL pattern and pass an IntPtr buffer, along with an enum argument
> that specifies the data type. We can probably also drop one of the above
> overloads, since this is a low level API. In that case, we would have a
> grand total of 4 signatures:
>
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)
>
>  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, IntPtr
> buffer, int bufXSize, int bufYSize, GDALDataType type, int pixelSpace,
> int lineSpace)
>
>   public void WriteRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)
>
>  public void WriteRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type, int
> pixelSpace, int lineSpace)
>
>
> How does that sound? Maybe at some point in the future when generics are
> the norm, we can add templated versions to get a  modicum of type safety
> and avoid having to specify a data type explicitly.
>
>
>
> Cheers!
>
> Sy
>
> P.S. I've just checked in my manifest embedding changes to makefile.vc
>
>
>

From szekerest at gmail.com  Fri Nov  3 06:04:37 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454A93A3.4050006@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
Message-ID: <f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>

>
> Fair enough. My initial thought was to suggest a signature like:
>
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)
>
> and similarly for other data types (short, ushort, int, uint, long,
> ulong, float, double). Using a pointer rather than an array for the
> buffer allows the method to be used to fill Bitmaps without having to
> copy into an intermediate array.
>

I'm afraid we will not be able to map pointers to the C# interface
easily. Instead we could
use the InPtr type but the marshaling code should be written
externally in that case.
At the first sight to keep the interface obvious I would suggest to
support the array types at the C# side like:

public int ReadRaster(int xOff, int yOff, int xSize, int ySize, byte[]
buffer, ref int bufXSize, ref int bufYSize)

or something like this.

I couldn't understand exactly your problem about the need of the
double copy of the arrays. Would you
post a sample that suffers from this issue?

> So, that would be 9 methods, and that's not even including signed bytes
> or complex data types...
>
> It would also be nice not to have to specify all the arguments in common
> cases. Since we don't have default arguments in C#, we could use two
> more overloads for each of the above with signatures like:
>
>   // bufXSize == xSize, bufYSize == ySize, pixelSpace ==
> sizeof(datatype), lineSpace == sizeof(datatype) * bufXSize
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer)
>
>   // pixelSpace == sizeof(datatype), lineSpace == sizeof(datatype) *
> bufXSize
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
> buffer, int bufXSize, int bufYSize)
>
>
> So we're up to 27 different methods...
>
> And then all over again for WriteRaster(). Making a grand total of 54
> different method signatures for reading and writing data - not covering
> all the possible data types! Hmmm...
>
>

I have no problem about the number of the overloads. It would be more
important to keep
the interface obvious and clear.
We have no one by one mapping between the C++ and C# blittable types.
For a mapping table see for example the blittable types section at:
 http://www.mono-project.com/Interop_with_Native_Libraries

>
> OK, if that's way too many, how about this as an alternative: we follow
> the GDAL pattern and pass an IntPtr buffer, along with an enum argument
> that specifies the data type. We can probably also drop one of the above
> overloads, since this is a low level API. In that case, we would have a
> grand total of 4 signatures:
>
>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)
>
>  public void ReadRaster(int xOff, int yOff, int xSize, int ySize, IntPtr
> buffer, int bufXSize, int bufYSize, GDALDataType type, int pixelSpace,
> int lineSpace)
>
>   public void WriteRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type)
>
>  public void WriteRaster(int xOff, int yOff, int xSize, int ySize,
> IntPtr buffer, int bufXSize, int bufYSize, GDALDataType type, int
> pixelSpace, int lineSpace)
>

It would require manual marshaling by the user and may result in high
number of problems.

>
> How does that sound? Maybe at some point in the future when generics are
> the norm, we can add templated versions to get a  modicum of type safety
> and avoid having to specify a data type explicitly.
>

How could we restrict the usage of the templates to the array of the
simple blittable types?
However in the future it might be an option but now it's supported
only by MS.NET FW 2.0 AFAIK.


Best Regards,

Tamas

From cplist at earthlink.net  Fri Nov  3 10:45:39 2006
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] geod: azimuth to degrees
Message-ID: <005a01c6ff5f$1d93cf80$0300a8c1@latitude>

Hi, all:

I have a painfully simple question to ask the group that will undoubtedly
expose my cartographic knowledge vacuum.  But be that as it may, I'm
stumped.  Fire some trig my way -- I can take it.  But going from an azimuth
to degrees is beyond my grasp today.

Let's take the geod man page example as our example:

geod +ellps=clrk66 <<EOF -I +units=us-mi
42d15'N 71d07'W 45d31'N 123d41'W
EOF 

which gives the results:

-66d31'50.141"   75d39'13.083"   2587.504

where the first two values are the azimuth from Boston to Portland, the back
azimuth from Portland to Boston followed by the distance.

Fantastic!

Now say that I'd like to draw a vector on top of Boston that points to
Portland.  (For my purpose, my points are located much closer together, so I
want to use geod to help me draw a vector that is scaled by distance / time
-- I'm drawing drifter buoys and tracks).

Don't I have enough info from geod to do that?  If so, how in the devil can
I get a single degree value to draw my little vector from -66d31'50.141"
75d39'13.083"?

Many thanks in advance.

Charlton



From epatton at nrcan.gc.ca  Fri Nov  3 11:16:52 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Error compiling gdal-1.3.2: libstdc++.la not found
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C15@s5-dar-r1.nrn.nrcan.gc.ca>

Hi,

I'm trying to compile gdal-1.3.2 on Ubuntu Dapper 6.06. The compile runs OK,
with no errors. Here's my configure line:

./configure \
--with-png=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-libz=internal \
--without-pg \
--without-ogdi \
--without-python \
--without-grass \
--without-libgrass

And the output from configure:

GDAL is now configured for i686-pc-linux-gnu

  Installation directory:    /usr/local
  C compiler:                gcc -O2
  C++ compiler:              g++ -O2

  LIBTOOL support:           yes

  LIBZ support:              internal
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  NETCDF support:            yes
  LIBPNG support:            internal
  LIBTIFF support:           internal
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  LIBGIF support:            internal
  OGDI support:              no
  HDF4 support:              no
  HDF5 support:              no
  KAKADU support:            no
  JASPER support:            yes (GeoJP2=no)
  ECW support:               no
  MrSID support:             no
  POSTGRESQL support:        no
  MySQL support:             no
  XERCES support:            no
  ODBC support:              yes
  OCI support:               no
  SDE support:               no
  DODS support:              no
  SQLite support:            no
  DWGdirect support          no
  PANORAMA GIS support:      no
  GEOS support:              yes

  Statically link PROJ.4:    no

  Traditional Python:        no
  NG SWIG Bindings:

  enable OGR building:       yes


When I run make, it ends prematurely with the following error (last several
lines from the output):

...<snip>
ranlib .libs/libgdal.a
creating libgdal.la
/bin/sed: can't read /usr/lib/libstdc++.la: No such file or directory
libtool: link: `/usr/lib/libstdc++.la' is not a valid libtool archive
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/usr/local/gdal-1.3.2'
make: *** [check-lib] Error 2

So, it's saying I'm missing libstdc++.la? As far as I can tell, I have the
lastest   libstdc++ installed:

$ cd /usr/lib
$ ls libstdc*

libstdc++-3-libc6.2-2-2.10.0.a
libstdc++-3-libc6.2-2-2.10.0.so
libstdc++-libc6.2-2.a.3 -> libstdc++-3-libc6.2-2-2.10.0.a
libstdc++-libc6.2-2.so.3 -> libstdc++-3-libc6.2-2-2.10.0.so
libstdc++.so -> libstdc++.so.5
libstdc++.so.0 -> libstdc++.so.5
libstdc++.so.5 -> libstdc++.so.6
libstdc++.so.5.0.7
libstdc++.so.6 -> libstdc++.so.6.0.7
libstdc++.so.6.0.7

Any ideas on how to get around this error?

~ Eric.






From mateusz at loskot.net  Fri Nov  3 11:35:29 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Error compiling gdal-1.3.2: libstdc++.la not found
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C15@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C26208C55C15@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <454B6FD1.1010007@loskot.net>

Patton, Eric wrote:
> 
> Any ideas on how to get around this error?

Eric,

You've likely not installed all required development packages.
Install this one and try again

 http://packages.ubuntu.com/dapper/libdevel/libstdc++6-dbg

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From nicky666 at gmail.com  Fri Nov  3 12:09:31 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
Message-ID: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>

Hello,

Refering to my previous post concerning gdal_merge.py, I now try to
use gdalwarp to warp several input images to produce one target image.
This target image is only a subset (a crop) of the the input images.

I noticed that when I call gdalwarp with several files, it reprojects
all of them even if they don't overlap (after transformation) the
target file bbox, leading to a very slow command when input files are
big (1 Go each).

In my script, I wrote a test to exclude from input images all the
images that don't intersect my target image (after having transformed
bbox in the same system)

Is there a way to do it automatically with gdalwarp ?

Thanx
Nicolas

(by the way, Franck, I did not find the post about gdalwarp and
merging in lists archives)

From warmerdam at pobox.com  Fri Nov  3 12:19:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdal_merge.py
In-Reply-To: <23e208430611021405h4f864250hfcdaf1361ab31cd4@mail.gmail.com>
References: <23e208430611021405h4f864250hfcdaf1361ab31cd4@mail.gmail.com>
Message-ID: <454B7A1D.6070109@pobox.com>

Dorita wrote:
> Hi,
>  
> I am trying to compose  a couple of GeoTiff images into one GeoTiff image. 
> I run the command merge.py -o kk.tif -pct kk1.tif kk2.tif.  Running 
> doesn't complain, but the final image only shows kk1.tif.  I have tried 
> to run same command with different images with same results.
>  
> Both input files are in the same coordinate system and have one band.
> The input images were downloaded from
> http://www.hydro.gov.au/seafarer/geotiff/geotiff-sample/geotiff-sample.htm
> for test purposes.
>  
> I am using gdal 1.3.2.0 <http://1.3.2.0> , Python 2.4.2 and the system 
> is 2.4.32-gentoo-r4

Izzy,

I tried downloading the pointed to sample data, and did the following
command:

   gdal_merge.py -o out.tif -pct B00605.tif C00605.tif

This seemed to work fine.  Note that C00605.tif is an inset, so it was
overlayed on B00605.tif.  Order of the files on the commandline is important
or the inset would have been obliterated by the main image.

Note that AUS00605.tif does not seem to have georeferencing and should not
be merged with the other files.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From bryan at geomega.com  Fri Nov  3 12:30:40 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
In-Reply-To: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
References: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
Message-ID: <454B7CC0.8030503@geomega.com>

Nicolas Ribot wrote:

> 
> (by the way, Franck, I did not find the post about gdalwarp and
> merging in lists archives)

Nicolas,

This thread was on the FWTools list:

http://lists.maptools.org/pipermail/fwtools/2006-October/000531.html

It was a response to a question I posted.

Bryan

> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

From warmerdam at pobox.com  Fri Nov  3 12:56:29 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
In-Reply-To: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
References: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
Message-ID: <454B82CD.8000706@pobox.com>

Nicolas Ribot wrote:
> Hello,
> 
> Refering to my previous post concerning gdal_merge.py, I now try to
> use gdalwarp to warp several input images to produce one target image.
> This target image is only a subset (a crop) of the the input images.
> 
> I noticed that when I call gdalwarp with several files, it reprojects
> all of them even if they don't overlap (after transformation) the
> target file bbox, leading to a very slow command when input files are
> big (1 Go each).
> 
> In my script, I wrote a test to exclude from input images all the
> images that don't intersect my target image (after having transformed
> bbox in the same system)
> 
> Is there a way to do it automatically with gdalwarp ?

Nicolas,

Looking in the code it seems there is an undocumented warp option called
SKIP_NOSOURCE that will cause gdalwarp to not attempt to actually warp
chunks where there is no input data.

eg
gdalwarp -wo SKIP_NOSOURCE=yes -te 400000 3720000 410000 3730000
      openev/utm.tif out.tif

I can't remember exactly why this isn't the default.  I think the issue
was that there was a risk of the output file not getting properly initialized
if blocks where skipped that shouldn't be skipped.   But I *think* it would
be safe for me to modify gdalwarp to set this option by default for the
second and subsequent files being processed.

Note the input files outside the target area were not actually having imagery
read.  But the warper was doing a great deal of work processing the whole
region only to discover none of the output pixels had any corresponding input
data.

Arg.  This does make gdalwarp a bit questionable for some mosaicing purposes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov  3 13:21:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
In-Reply-To: <454B82CD.8000706@pobox.com>
References: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
	<454B82CD.8000706@pobox.com>
Message-ID: <454B88A8.3040907@pobox.com>

Frank Warmerdam wrote:
> Arg.  This does make gdalwarp a bit questionable for some mosaicing 
> purposes.

Folks,

I have created a bug entry to track this issue, which I am unlikely to dig
more deeply into for some time.

   http://bugzilla.remotesensing.org/show_bug.cgi?id=1346

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From nhv at cape.com  Fri Nov  3 13:36:49 2006
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] geod: azimuth to degrees
In-Reply-To: <005a01c6ff5f$1d93cf80$0300a8c1@latitude>
Message-ID: <200611031836.kA3IagY8022898@smtp11.cape.com>

Charlton Purvis writes
> 
> I have a painfully simple question to ask the group that will 
> undoubtedly expose my cartographic knowledge vacuum.  But be 
> that as it may, I'm stumped.  Fire some trig my way -- I can 
> take it.  But going from an azimuth to degrees is beyond my 
> grasp today.
> 
> Let's take the geod man page example as our example:
> 
> geod +ellps=clrk66 <<EOF -I +units=us-mi 42d15'N 71d07'W 
> 45d31'N 123d41'W EOF 
> 
> which gives the results:
> 
> -66d31'50.141"   75d39'13.083"   2587.504
> 
> where the first two values are the azimuth from Boston to 
> Portland, the back azimuth from Portland to Boston followed 
> by the distance.
> 
> Fantastic!
> 
> Now say that I'd like to draw a vector on top of Boston that 
> points to Portland.  (For my purpose, my points are located 
> much closer together, so I want to use geod to help me draw a 
> vector that is scaled by distance / time
> -- I'm drawing drifter buoys and tracks).
> 
> Don't I have enough info from geod to do that?  If so, how in 
> the devil can I get a single degree value to draw my little 
> vector from -66d31'50.141"
> 75d39'13.083"?


Hmm  looks like you reading the geod man page  good  :-)

"""Geod may also be used to determine intermediate points along either a
geodesic line between two points or along an arc of specified distance from
a geographic point. In both cases an initial point must be specified with
+lat_1=lat and +lon_1=lon parameters and either a terminus point +lat_2=lat
and +lon_2=lon or a distance and azimuth from the initial point with
+S=distance and +A=azimuth must be specified."""

And use the azimuth as returned from your first invocation with an
appropriate
Distance arg to get the 'scaling effect' that you want

HTH

Norman


From cplist at earthlink.net  Fri Nov  3 14:32:34 2006
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] geod: azimuth to degrees
In-Reply-To: <200611031836.kA3IagY8022898@smtp11.cape.com>
Message-ID: <007801c6ff7e$d0cbd7e0$0300a8c1@latitude>

Thanks for getting back to me, Norman.  But I don't think that's what I'm
shopping for.

The geod command gives me the azimuth in lon,lat followed by a distance.  At
least I think that's right.  So for my little arrow that I want to draw, I
want to have a single degree value from 0 - 360 that is represents the
azimuth.  It's that conversion that I don't know how to do.  The scaling
part is a snap since geod gives that to me on a silver platter.

Thanks for the help.

Charlton



From epatton at nrcan.gc.ca  Fri Nov  3 14:58:39 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Error compiling gdal-1.3.2: libstdc++.la not found
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C17@s5-dar-r1.nrn.nrcan.gc.ca>

Thanks, Mateusz, that was exactly what was wrong!

Regards,

~ Eric.

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
To: gdal-dev@lists.maptools.org
Sent: 11/3/2006 11:35 AM
Subject: Re: [Gdal-dev] Error compiling gdal-1.3.2: libstdc++.la not found

Patton, Eric wrote:
> 
> Any ideas on how to get around this error?

Eric,

You've likely not installed all required development packages.
Install this one and try again

 http://packages.ubuntu.com/dapper/libdevel/libstdc++6-dbg

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

From wonder.sk at gmail.com  Fri Nov  3 15:34:42 2006
From: wonder.sk at gmail.com (Martin Dobias)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] OGR - set layer's spatial reference
Message-ID: <e8e7199c0611031234h79425d80uc92c4c7043e4d636@mail.gmail.com>

Hi,

I'm searching for a way how to change layer's spatial reference. It
seems that it can be set only when creating the layer with
OGRDataSource::CreateLayer(). Then, OGRLayer has function
GetSpatialRef(), but documentation says that the returned spatial
reference shouldn't be modified by application. Is there any way how
to modify it once layer has been created?

Thanks,
Martin Dobias

From warmerdam at pobox.com  Fri Nov  3 15:35:52 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Preliminary Developer Guidelines
Message-ID: <454BA828.3000404@pobox.com>


Folks,

I've started writing up a few notes on developer guidelines for GDAL/OGR.
It is grossly incomplete, but can be found at:

   http://www.gdal.org/rfc8_devguide.html

At some point (if/when) it is more complete, I'd like to bring it to the PSC
for vote, hence I've started it as an RFC.  Alternatively we could just make
it a regular document.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov  3 16:05:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] OGR - set layer's spatial reference
In-Reply-To: <e8e7199c0611031234h79425d80uc92c4c7043e4d636@mail.gmail.com>
References: <e8e7199c0611031234h79425d80uc92c4c7043e4d636@mail.gmail.com>
Message-ID: <454BAF24.6090702@pobox.com>

Martin Dobias wrote:
> Hi,
> 
> I'm searching for a way how to change layer's spatial reference. It
> seems that it can be set only when creating the layer with
> OGRDataSource::CreateLayer(). Then, OGRLayer has function
> GetSpatialRef(), but documentation says that the returned spatial
> reference shouldn't be modified by application. Is there any way how
> to modify it once layer has been created?

Martin,

No, I'm afraid not.

In some cases you can go around OGR to modify it, for instance with direct
SQL against postgis, or modifying the .prj for a shapefile.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Fri Nov  3 16:34:52 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] OGR - set layer's spatial reference
In-Reply-To: <454BAF24.6090702@pobox.com>
References: <e8e7199c0611031234h79425d80uc92c4c7043e4d636@mail.gmail.com>
	<454BAF24.6090702@pobox.com>
Message-ID: <454BB5FC.70203@loskot.net>

Frank Warmerdam wrote:
> Martin Dobias wrote:
>> Hi,
>>
>> I'm searching for a way how to change layer's spatial reference. It
>> seems that it can be set only when creating the layer with
>> OGRDataSource::CreateLayer(). Then, OGRLayer has function
>> GetSpatialRef(), but documentation says that the returned spatial
>> reference shouldn't be modified by application. Is there any way how
>> to modify it once layer has been created?
> 
> Martin,
> 
> No, I'm afraid not.
> 
> In some cases you can go around OGR to modify it, for instance with direct
> SQL against postgis, or modifying the .prj for a shapefile.

Another, a kind of brute-force but not very fast solution
is to create new empty layer of the same geometry type, recreate
attributes schema, assign new SRS and rewrite all features from the
source layer to new one.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From sy at perkins.net  Fri Nov  3 17:05:23 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>	
	<1162500129.7885.274867443@webmail.messagingengine.com>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
Message-ID: <454BBD23.4080503@perkins.net>



Tamas Szekeres wrote:
>>
>> Fair enough. My initial thought was to suggest a signature like:
>>
>>   public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte*
>> buffer, int bufXSize, int bufYSize, int pixelSpace, int lineSpace)
>>
>> and similarly for other data types (short, ushort, int, uint, long,
>> ulong, float, double). Using a pointer rather than an array for the
>> buffer allows the method to be used to fill Bitmaps without having to
>> copy into an intermediate array.
>>
>
> I'm afraid we will not be able to map pointers to the C# interface
> easily.

Is this a SWIG limitation? Pointers are a valid C# type though, aren't they?


> I couldn't understand exactly your problem about the need of the
> double copy of the arrays. Would you
> post a sample that suffers from this issue?
Let's say you want to do the simplest thing: use GDAL to read RGB data 
from a file, stick it into an image and then display that image. Off the 
top of my head, one way of doing this (starting with a GDAL dataset 
object) would look something like:

{
  ...
 
  // Get the GDAL Band objects from the Dataset
  Gdal.Band redBand = dataset.GetRasterBand(1);
  Gdal.Band greenBand = dataset.GetRasterBand(2);
  Gdal.Band blueBand = dataset.GetRasterBand(3);

  // Get the width and height of the Dataset
  int width = dataset.RasterXSize;
  int height = dataset.RasterYSize;

  // Create a Bitmap to store the GDAL image in
  Bitmap bitmap = new Bitmap(width, height, PixelFormat.Format24bppRgb);

  // Use GDAL raster reading methods to read the image data directly 
into the Bitmap
  BitmapData bitmapData = bitmap.LockBits(new Rectangle(0, 0, width, 
height),
       ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
  try {
    int stride = bitmapData.Stride;
    byte* buf = (byte*)bitmapData.Scan0.ToPointer();
    // ReadRaster() here takes a byte* argument for the data pointer
    redBand.ReadRaster(0, 0, width, height, buf, width, height, 3, stride);
    greenBand.ReadRaster(0, 0, width, height, buf+1, width, height, 3, 
stride);
    blueBand.ReadRaster(0, 0, width, height, buf+2, width, height, 3, 
stride);
  }
  finally {
    bitmap.UnlockBits(bitmapData);
  }

  // Display the image by putting it into a PictureBox
  pictureBox.Image = bitmap;

  ...
}


If ReadRaster() took a byte[] rather than a byte* as an argument, then 
you would have to use GDAL to copy the band data first into a byte[] 
array, and then from there use InteropServices.Marshal.Copy() to copy 
the data into the Bitmap, which is inefficient in time and memory.

If you do want to read into an array, then you can do something like:

  byte[] buffer = new byte[width * height];
  fixed (byte* ptr = buffer) {
    band.ReadRaster(0, 0, width, height, ptr, width, height, 1, width);
  }

However, if the functions are setup to read directly into arrays, then 
I'm not sure how one could read data from GDAL directly into a Bitmap, 
where the buffer is only accessible via a pointer.

As a compromise, how about we have a high and a low level interface? So 
you can have type safe versions with byte[], int[] etc, and low level 
versions that use an IntPtr and an argument specifying the data type. We 
could call the lower level version RasterIO to correspond to the C 
function in GDAL.


> I have no problem about the number of the overloads. It would be more
> important to keep
> the interface obvious and clear.
> We have no one by one mapping between the C++ and C# blittable types.
> For a mapping table see for example the blittable types section at:
> http://www.mono-project.com/Interop_with_Native_Libraries

OK. FWIW, I imagine that 99.9% of people's needs can be addressed by 
overloads for the data types byte, short, ushort, int, uint and float.


>>
>> How does that sound? Maybe at some point in the future when generics are
>> the norm, we can add templated versions to get a  modicum of type safety
>> and avoid having to specify a data type explicitly.
>>
>
> How could we restrict the usage of the templates to the array of the
> simple blittable types?
> However in the future it might be an option but now it's supported
> only by MS.NET FW 2.0 AFAIK.

In order to work with the underlying GDAL code you would need to turn 
the type into a GDAL type flag, so you could throw a runtime exception 
if an invalid type is used.

But, if you're happy with many overloads, then let's go with that.

Cheers,

Sy


From szekerest at gmail.com  Fri Nov  3 19:07:03 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454BBD23.4080503@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
Message-ID: <f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>

> >
> > I'm afraid we will not be able to map pointers to the C# interface
> > easily.
>
> Is this a SWIG limitation? Pointers are a valid C# type though, aren't they?
>

I mean that the C style pointers has no exact mapping to C# we have to
use the untyped IntPtr-s or HandleRef-s instead.


> Let's say you want to do the simplest thing: use GDAL to read RGB data
> from a file, stick it into an image and then display that image. Off the
> top of my head, one way of doing this (starting with a GDAL dataset
> object) would look something like:
>
> {
>   ...
>
>   // Get the GDAL Band objects from the Dataset
>   Gdal.Band redBand = dataset.GetRasterBand(1);
>   Gdal.Band greenBand = dataset.GetRasterBand(2);
>   Gdal.Band blueBand = dataset.GetRasterBand(3);
>
>   // Get the width and height of the Dataset
>   int width = dataset.RasterXSize;
>   int height = dataset.RasterYSize;
>
>   // Create a Bitmap to store the GDAL image in
>   Bitmap bitmap = new Bitmap(width, height, PixelFormat.Format24bppRgb);
>
>   // Use GDAL raster reading methods to read the image data directly
> into the Bitmap
>   BitmapData bitmapData = bitmap.LockBits(new Rectangle(0, 0, width,
> height),
>        ImageLockMode.ReadWrite, PixelFormat.Format24bppRgb);
>   try {
>     int stride = bitmapData.Stride;
>     byte* buf = (byte*)bitmapData.Scan0.ToPointer();
>     // ReadRaster() here takes a byte* argument for the data pointer
>     redBand.ReadRaster(0, 0, width, height, buf, width, height, 3, stride);
>     greenBand.ReadRaster(0, 0, width, height, buf+1, width, height, 3,
> stride);
>     blueBand.ReadRaster(0, 0, width, height, buf+2, width, height, 3,
> stride);
>   }
>   finally {
>     bitmap.UnlockBits(bitmapData);
>   }
>
>   // Display the image by putting it into a PictureBox
>   pictureBox.Image = bitmap;
>
>   ...
> }
>
>
> If ReadRaster() took a byte[] rather than a byte* as an argument, then
> you would have to use GDAL to copy the band data first into a byte[]
> array, and then from there use InteropServices.Marshal.Copy() to copy
> the data into the Bitmap, which is inefficient in time and memory.
>
> If you do want to read into an array, then you can do something like:
>
>   byte[] buffer = new byte[width * height];
>   fixed (byte* ptr = buffer) {
>     band.ReadRaster(0, 0, width, height, ptr, width, height, 1, width);
>   }
>
> However, if the functions are setup to read directly into arrays, then
> I'm not sure how one could read data from GDAL directly into a Bitmap,
> where the buffer is only accessible via a pointer.
>
> As a compromise, how about we have a high and a low level interface? So
> you can have type safe versions with byte[], int[] etc, and low level
> versions that use an IntPtr and an argument specifying the  data type. We
> could call the lower level version RasterIO to correspond to the C
> function in GDAL.
>

Well, with the example above I am curious to know how if works in
practice. So as to support this kind of usage we gonna have to
establish a generic version of the ReadRaster/WriteRaster having
IntPtr compatible argument holding the memory to be handled at the
unmanaged part of the interface. It would be useful to know how
LockBits and Scan0 works, will the managed memory segment be prevented
from the relocation or GC collection during the unmanaged call. I will
create a sample app. for testing this issue.

BTW, I wonder how we can get the byte* notation work in general. Is it
related to an unsafe code block specification?

>
> > I have no problem about the number of the overloads. It would be more
> > important to keep
> > the interface obvious and clear.
> > We have no one by one mapping between the C++ and C# blittable types.
> > For a mapping table see for example the blittable types section at:
> > http://www.mono-project.com/Interop_with_Native_Libraries
>
> OK. FWIW, I imagine that 99.9% of people's needs can be addressed by
> overloads for the data types byte, short, ushort, int, uint and float.
>

I think we should support the generic functions first. If it works, we
will create the specializations using Marshal.Copy and calling the
generic fn-s internally.

> >
> > How could we restrict the usage of the templates to the array of the
> > simple blittable types?
> > However in the future it might be an option but now it's supported
> > only by MS.NET FW 2.0 AFAIK.
>
> In order to work with the underlying GDAL code you would need to turn
> the type into a GDAL type flag, so you could throw a runtime exception
> if an invalid type is used.
>

I hope we shall not have to bring  GDALRWFlag and GDALDataType into
the C# interface if it is possible.


I would like to get something working this weekend.

Best Regards,

Tamas


PS: Thanks, for your efforts about the manifest embedding stuff  :-)

From craig.miller at spatialminds.com  Fri Nov  3 19:55:48 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Refresh a datasource?
Message-ID: <001d01c6ffab$f7b19a20$3301a8c0@vaio>

Is there a way to tell an OGRDataSource to refresh it's list of layers to
reflect additional tables added to a postgis database, feature types added
to a file based format, etc?  It seems like it would be kind of expensive to
close and re-open the connection to the database just to get a current list
of tables.

Thanks,
Craig


From jcleary at email.unc.edu  Fri Nov  3 19:58:03 2006
From: jcleary at email.unc.edu (Jesse Cleary)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] geod: azimuth to degrees
In-Reply-To: <007801c6ff7e$d0cbd7e0$0300a8c1@latitude>
References: <007801c6ff7e$d0cbd7e0$0300a8c1@latitude>
Message-ID: <454BE59B.6050501@email.unc.edu>

Hey Charlton -

I think you've already got what you need?  Geod outputs an azimuth, then 
a back azimuth, followed by distance.  The two azimuths are different 
(i.e. not complimentary like you might expect) because along a great 
circle route the azimuth changes throughout.  So you're given an initial 
azimuth beginning the route to Portland (-66d31'50.141", maybe better 
expressed as 360 - 66d31'50.141") and then the initial azimuth to begin 
a great circle route from Portland back to Boston (75d39'13.083").  At 
least that's what makes sense to me...

I've been using the perl Math::Trig module to do something similar and 
it works pretty well so far.  Might give geod a try to compare my 
results now though...

Jesse





Charlton Purvis wrote:
> Thanks for getting back to me, Norman.  But I don't think that's what I'm
> shopping for.
>
> The geod command gives me the azimuth in lon,lat followed by a distance.  At
> least I think that's right.  So for my little arrow that I want to draw, I
> want to have a single degree value from 0 - 360 that is represents the
> azimuth.  It's that conversion that I don't know how to do.  The scaling
> part is a snap since geod gives that to me on a silver platter.
>
> Thanks for the help.
>
> Charlton
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>   

From szekerest at gmail.com  Fri Nov  3 20:05:14 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] GDAL Manifest Changes
In-Reply-To: <454A9B7A.7000703@perkins.net>
References: <45498AA0.1010207@perkins.net> <4549F66C.7040801@loskot.net>
	<1162484431.11038.274847930@webmail.messagingengine.com>
	<454A1CE6.6080506@loskot.net> <454A9B7A.7000703@perkins.net>
Message-ID: <f3b73b7d0611031705j23f94ce2wb997d8ca47eeb8a0@mail.gmail.com>

Simon,

I've tested the solution and works pretty well for the C# interface.
>From the C#'s point of view it would be enough to embed this kind of
manifests only for the
root dll to be loaded first having dependencies to the CRT assembly wrapper.
However it is not harmful to embed the manifests as a resource into
each of  the corresponding dll-s and executables.

Thanks, for your work, I think we would have to make similar solutions
for the mapserver project.

Best Regards,

Tamas


2006/11/3, Simon Perkins <sy@perkins.net>:
>
> Visual Studio / makefile.vc people:
>
> I've just checked some small changes into makefile.vc, apps/makefile.vc
> and ogr/Makefile to automatically embed manifests into DLLs and EXEs, if
> they are generated. Shouldn't have any effect unless you're using VS
> 2005. I also removed the lines I added a few months ago to install
> manifest files into the install directories for the install target,
> since this is no longer necessary. Manifest files are also cleaned up by
> the clean target.
>
> This should eliminate some mysterious "MSVCR80.DLL not found" problems
> you may encounter when linking against GDAL built using VS 2005.
>
> Basically, every DLL and EXE target now has an additional line that
> looks something like:
>
> if exist $(SOME_DLL).manifest mt -manifest $(SOME_DLL).manifest -outputresource:$(SOME_DLL);2
>
> or
>
> if exist $(SOME_EXE).manifest mt -manifest $(SOME_EXE).manifest -outputresource:$(SOME_EXE);1
>
>
> Note that this is a subset of the solution found here:
>
> http://msdn2.microsoft.com/en-us/library/ms235591.aspx
>
> That solution has a lot of extra bells and whistles to enable incremental linking. But full linking doesn't seem to take very long anyway, so I didn't bother including that stuff.
>
>
> Please let me know if you encounter any problems.
>
> Cheers,
>
> Sy
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From sy at perkins.net  Fri Nov  3 21:19:05 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>	
	<1162500129.7885.274867443@webmail.messagingengine.com>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
Message-ID: <454BF899.3030201@perkins.net>

Tamas Szekeres wrote:
>> >
>> > I'm afraid we will not be able to map pointers to the C# interface
>> > easily.
>>
>> Is this a SWIG limitation? Pointers are a valid C# type though, 
>> aren't they?
>
> I mean that the C style pointers has no exact mapping to C# we have to
> use the untyped IntPtr-s or HandleRef-s instead.

I don't know how SWIG works at all, but if we implement one low level 
function that, say, uses IntPtr and a GDALDataType flag, then we can add 
all the type safe versions as forwarding functions, e.g.:

private void ReadRasterImp(int xOff, int yOff, int xSize, int ySize, 
IntPtr buf,
                           int bufXsize, int bufYSize, GDALDataType type) {
  // Call GDAL external function directly
  ....
}

public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte* 
buf, int bufXSize, int bufYSize) {
  ReadRasterImp(xOff, yOff, xSize, ySize, new IntPtr(buf), bufXSize, 
bufYSize, GDALDataType.BYTE);
}

public void ReadRaster(int xOff, int yOff, int xSize, int ySize, byte[] 
buf, int bufXSize, int bufYSize) {
  fixed (byte* ptr = buf) {
    ReadRaster(xOff, yOff, xSize, ySize, ptr, bufXSize, bufYSize, 
GDALDataType.BYTE);
  }
}

I've omitted the pixelSpace and lineSpace args here.

Is that kind of thing doable with SWIG?


Couple of other questions / requests:

 - For any functions that use an array as a buffer, it would be 
convenient to add a bufferOffset int argument that says at what point in 
the buffer reading/writing should begin. This allows people to use GDAL 
to read into arrays that contain pixels in "packed" format. This only 
needs to appear in the overload of these functions that has the 
pixelSpace and lineSpace args, since packed format buffers require these 
to be specified as well.

- How are we dealing with errors? The original GDAL functions return 
CPLErr. Are we going to do the same? Or are we going to throw exceptions?



> Well, with the example above I am curious to know how if works in
> practice. So as to support this kind of usage we gonna have to
> establish a generic version of the ReadRaster/WriteRaster having
> IntPtr compatible argument holding the memory to be handled at the
> unmanaged part of the interface. It would be useful to know how
> LockBits and Scan0 works, will the managed memory segment be prevented
> from the relocation or GC collection during the unmanaged call. I will
> create a sample app. for testing this issue.
>
> BTW, I wonder how we can get the byte* notation work in general. Is it
> related to an unsafe code block specification?

The LockBits function must be called to prevent the GC moving the Bitmap 
buffer while you're working on it. See the MSDN docs on 
Bitmap.LockBits() for an example of usage.

Scan0 is simply an IntPtr that points to the start of the Bitmap data 
buffer.

Not sure I understand your last question. In general, you can only use 
pointers within a fixed() { } block, since that's the only safe way you 
can get a pointer to a managed object. The fixed() statement prevents 
the GC moving the object being pointed to. Needless to say, anything 
using pointers has to be declared unsafe. But I think it's hard to avoid 
that when interfaceing to unmanaged code that manipulates memory.


In case it helps, I've attached the hand-rolled GDAL C# interface that I 
worked on a while back, along with a simple image display program that 
uses that interface. You should just be able to unzip the file, load it 
into VS 2005, edit the file GDAL/Interop.cs to reflect the name of the 
GDAL DLL installed on your machine (make sure the DLL has the manifests 
embedded or you'll get DLL loading errors!), build the solution, ensure 
that the GDAL DLL is on your PATH, and then hit F5 to run the test 
program. Go to File->Open... and load any image...

This might clarify some of the locking / unlocking / Interop issues.

Note that this code implements RasterIO following the GDAL pattern very 
closely, so it's probably lower level than what you want to do.


> I think we should support the generic functions first. If it works, we
> will create the specializations using Marshal.Copy and calling the
> generic fn-s internally.

When you say "generic", I'm guessing you're not using it in the sense of 
"C# generics" (AKA C# templates)? That's the sense I've been using it in 
my e-mails... Not exactly sure what you have in mind here, but I'd 
prefer to avoid uncecessary copies of data if possible. I use GDAL to 
access some very large rasters, and so efficiency is important to me.


> I hope we shall not have to bring  GDALRWFlag and GDALDataType into
> the C# interface if it is possible.

Agreed.


> I would like to get something working this weekend.

Groovy.

> PS: Thanks, for your efforts about the manifest embedding stuff  :-)

No problem - the only tricky thing is finding decent documentation from 
Microsoft on any of this stuff...




Cheers,

Sy


From mbrudka at aster.pl  Sat Nov  4 05:17:34 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RFC 3: GDAL Commiter Guildlines
In-Reply-To: <4549F816.7080704@mapgears.com>
References: <45403F3E.307@pobox.com> <45487F51.9090202@aster.pl>
	<4548C650.9080805@mapgears.com> <4548D209.70806@aster.pl>
	<4549F816.7080704@mapgears.com>
Message-ID: <454C68BE.8010401@aster.pl>

Hi Daniel,

    Mess is somehow subjective term, however in a sense SVN allows to 
control it easily . To be more specific:

1. Tags and different than branches on semantical level, though they are 
just folders from svn point of view. Stable releases, milestone etc. are 
tags and by SVN convention enter *tags* folder only.

2. Branches are not related with tags, though some stable releases can 
be prepared in branches.

3. SVN guide proposes to create three main folders: *trunk*, *tags* and 
*branches*. It does not forbid to create some additional ones. If one 
wants to distinct between "private" and "public" branches, though for me 
this is at least questionable, then svn admin may easily create folder 
eg. *experimental*.

Marek


From warmerdam at pobox.com  Sat Nov  4 17:34:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Refresh a datasource?
In-Reply-To: <001d01c6ffab$f7b19a20$3301a8c0@vaio>
References: <001d01c6ffab$f7b19a20$3301a8c0@vaio>
Message-ID: <454D1583.4020301@pobox.com>

Craig Miller wrote:
> Is there a way to tell an OGRDataSource to refresh it's list of layers to
> reflect additional tables added to a postgis database, feature types added
> to a file based format, etc?  It seems like it would be kind of expensive to
> close and re-open the connection to the database just to get a current list
> of tables.

Craig,

Unfortunately there is no mechanism to do this.  Basically you are left
having to destroy and recreate the datasource.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From szekerest at gmail.com  Sat Nov  4 17:48:18 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454BF899.3030201@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
Message-ID: <f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>

Simon,

I've added the base implementation with the following signature into the CVS:

public int ReadRasterInternal(int xOff, int yOff, int xSize, int
ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
pixelSpace, int lineSpace);

public int WriteRasterInternal(int xOff, int yOff, int xSize, int
ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
pixelSpace, int lineSpace);


And tested the code with the following sample:

// Get the GDAL Band objects from the Dataset
            Band redBand = ds.GetRasterBand(1);
            Band greenBand = ds.GetRasterBand(2);
            Band blueBand = ds.GetRasterBand(3);

            // Get the width and height of the Dataset
            int width = ds.RasterXSize;
            int height = ds.RasterYSize;

            // Create a Bitmap to store the GDAL image in
            Bitmap bitmap = new Bitmap(ds.RasterXSize, ds.RasterYSize,
PixelFormat.Format24bppRgb);

            // Use GDAL raster reading methods to read the image data
directly into the Bitmap
            BitmapData bitmapData = bitmap.LockBits(new Rectangle(0,
0, width, height), ImageLockMode.ReadWrite,
PixelFormat.Format32bppRgb);

            try {
                int stride = bitmapData.Stride;
                IntPtr buf = bitmapData.Scan0;

                blueBand.ReadRasterInternal(0, 0, width, height, buf,
width, height, 1, 4, stride);
                greenBand.ReadRasterInternal(0, 0, width, height, new
IntPtr(buf.ToInt32()+1), width, height, 1, 4, stride);
                redBand.ReadRasterInternal(0, 0, width, height, new
IntPtr(buf.ToInt32()+2), width, height, 1, 4, stride);
            }
            finally {
                bitmap.UnlockBits(bitmapData);
            }

            bitmap.Save("Data/myfile.bmp");


At this point I would avoid creating /unsafe code into the interface
so I will leave the user alone with the pointers and the fixed
statements.
However I would add the specializations depending on the array types
using Marshal.Copy
between the managed and the unmanaged memory.

How about supporting ReadBlock/WriteBlock? Would it be required?

According to your questions:

> - For any functions that use an array as a buffer, it would be
> convenient to add a bufferOffset int argument that says at what point in
> the buffer reading/writing should begin. This allows people to use GDAL
> to read into arrays that contain pixels in "packed" format. This only
> needs to appear in the overload of these functions that has the
> pixelSpace and lineSpace args, since packed format buffers require these
> to be specified as well.

Would you describe an expected signature and a test sample for this
issue? At which side of the interface should we implement this? I
guess at the C side it would be easier.

> - How are we dealing with errors? The original GDAL functions return
> CPLErr. Are we going to do the same? Or are we going to throw exceptions?

Both of them is available. The function returns CPLErr and throws
exception on error. This behaviour is similar for most of the
interface functions.


Best Regards,

Tamas

PS: I've got your attachment in the last email.

From sy at perkins.net  Sat Nov  4 19:31:08 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>	
	<1162500129.7885.274867443@webmail.messagingengine.com>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>	
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
Message-ID: <454D30CC.4040502@perkins.net>

Tamas Szekeres wrote:
> I've added the base implementation with the following signature into 
> the CVS:
>
> public int ReadRasterInternal(int xOff, int yOff, int xSize, int
> ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
> pixelSpace, int lineSpace);
>
> public int WriteRasterInternal(int xOff, int yOff, int xSize, int
> ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
> pixelSpace, int lineSpace);

That seems fine. Though I guess it feels slightly odd to me for a public 
function to be called "Internal". How about just calling these functions 
ReadRaster() and WriteRaster(), same as the more type safe functions, 
but just using a different set of arguments?

> And tested the code with the following sample:

And it worked? Hmm, I notice that you use Format24bppRgb when creating 
the Bitmap, and then Format32bppRgb when locking it. I'm surprised that 
didn't throw an exception. Also the pixelspace of 4 is appropriate for 
32bpp, but not for 24bpp. Perhaps windows uses 4 bytes per pixel even 
when you specify 24bpp?

>
> At this point I would avoid creating /unsafe code into the interface
> so I will leave the user alone with the pointers and the fixed
> statements.
> However I would add the specializations depending on the array types
> using Marshal.Copy
> between the managed and the unmanaged memory.

So how does this work? i.e. where does the unmanaged buffer that 
GDALRasterIO initially reads into get allocated? In C code somewhere? Or 
is there some way of getting an IntPtr pointing to an allocated buffer 
in C#? And then you copy it into a C# array in some CS code? And then 
switch back to C to free the unmanaged memory? And you can do all this 
without using the unsafe keyword? Guess it'll be easier to visualize it 
when you've written it.

FWIW, my personal feeling is that writing code like this that doesn't 
use the unsafe keyword makes you feel better, but when you look more 
closely it's a pretty dubious benefit. At the end of the day, you're 
passing pointers to buffers into unmanaged C code, and so really, that 
SHOULD be declared as unsafe. That C code could do all kinds of nasty 
things to your C# data structures, outside of your control. The fact 
that you can get around it by using IntPtr seems to me to be more a 
failing of the language, than a genuinely "safe" way to do things. 
Unless I'm missing something.

Anyway, I'm still not especially keen on any extra copying of buffers. 
As long as the direct interface using IntPtr is available, I guess users 
can always choose to write their own more efficient methods to read GDAL 
data into arrays, using fixed() { }. But still, seems a shame to build 
in inefficiency just to avoid using the unsafe keyword, when in my 
opinion, the code should not be considered "safe" anyway.



> How about supporting ReadBlock/WriteBlock? Would it be required?

I think this is a pretty low priority. Most C++ apps use RasterIO() 
directly, which in turn makes calls to ReadBlock() and WriteBlock() 
(actually IReadBlock() and IWriteBlock()), which are implemented by the 
author of the particular GDAL driver being used. If people really want 
to read and write blocks, then can always get the block width and height 
using GDALGetBlockXSize(), and so forth, and then use RasterIO() with 
windows of that size.

>
> According to your questions:
>
>> - For any functions that use an array as a buffer, it would be
>> convenient to add a bufferOffset int argument that says at what point in
>> the buffer reading/writing should begin. This allows people to use GDAL
>> to read into arrays that contain pixels in "packed" format. This only
>> needs to appear in the overload of these functions that has the
>> pixelSpace and lineSpace args, since packed format buffers require these
>> to be specified as well.
>
> Would you describe an expected signature and a test sample for this
> issue? At which side of the interface should we implement this? I
> guess at the C side it would be easier.

The signature would be something like:

  int ReadRaster(int xOff, int yOff, int xSize, int ySize, byte[] buf, 
int bufXSize, int bufYSize,
                 int bufOffset, int pixelSpace, int lineSpace);

Test code (untested!):

           // Get the GDAL Band objects from the Dataset
           Band redBand = ds.GetRasterBand(1);
           Band greenBand = ds.GetRasterBand(2);
           Band blueBand = ds.GetRasterBand(3);

           // Get the width and height of the Dataset
           int width = ds.RasterXSize;
           int height = ds.RasterYSize;

           // Create a byte buffer to store the pixel data in "packed" 
format
           byte[] buffer = new byte[width * height * 4];

           // Use GDAL raster reading methods to read the image data 
directly into the buffer
           // We use the bufferOffset argument to begin reading at 
different start indices in
           // the buffer.
           blueBand.ReadRasterInternal(0, 0, width, height, buffer, 
width, height, 1, 0, 4, width);
           greenBand.ReadRasterInternal(0, 0, width, height, buffer, 
width, height, 1, 1, 4, width);
           redBand.ReadRasterInternal(0, 0, width, height, buffer, 
width, height, 1, 2, 4, width);

           // Create a Bitmap to store the GDAL image in
           Bitmap bitmap = new Bitmap(width, height, 
PixelFormat.Format32bppRgb);

           // Copy the data from the packed buffer into Bitmap
           BitmapData bitmapData = bitmap.LockBits(new Rectangle(0, 0, 
width, height), ImageLockMode.ReadWrite,
                PixelFormat.Format32bppRgb);
           try {
             Marshal.Copy(buffer, bitmapData.Scan0, 0, width * height * 4);
           }
           finally {
             bitmap.UnlockBits(bitmapData);
           }

           bitmap.Save("Data/myfile.bmp");


Thinking about it some more, I think even for the IntPtr overload of 
ReadRaster / WriteRaster, it would make sense to add the bufferOffset 
argument, whenever we use the pixelSpace and lineSpace arguments. This 
avoids having to use that "new IntPtr(buf.ToInt32() + 1)" stuff. All 
three args are only really used when dealing with packed pixel format 
buffers.

For convenience, it would be nice to have overloads that assume default 
values for the last three parameters (bufferOffset, pixelSpace and 
lineSpace) for the common case where we're not dealing with packed 
buffers. In these cases, bufferOffset = 0, pixelSpace = 
sizeof(datatype), and lineSpace = bufXSize * pixelSpace.


Cheers,

Sy


From warmerdam at pobox.com  Sat Nov  4 23:21:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454D30CC.4040502@perkins.net>
References: <454988F5.8050401@perkins.net>		<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>		<1162500129.7885.274867443@webmail.messagingengine.com>		<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>		<454A93A3.4050006@perkins.net>		<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>		<454BBD23.4080503@perkins.net>		<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>		<454BF899.3030201@perkins.net>	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
Message-ID: <454D66CF.3090305@pobox.com>

Simon Perkins wrote:
> So how does this work? i.e. where does the unmanaged buffer that 
> GDALRasterIO initially reads into get allocated? In C code somewhere? Or 
> is there some way of getting an IntPtr pointing to an allocated buffer 
> in C#? And then you copy it into a C# array in some CS code? And then 
> switch back to C to free the unmanaged memory? And you can do all this 
> without using the unsafe keyword? Guess it'll be easier to visualize it 
> when you've written it.

Simon,

Tamas just did "IntPtr buf = bitmapData.Scan0".  I assumed Scan0 was
a buffer in the bitmapData object, and that it was previously allocated.
So there is no apparent copying of the buffer, or allocation within
the rasterio.  I could be missing lots of stuff though.

>> How about supporting ReadBlock/WriteBlock? Would it be required?
> 
> I think this is a pretty low priority.

Calling ReadBlock and WriteBlock is now also discouraged for C
and C++ applications.  I don't see any need to binding them in
the swig wrapped languages.

> For convenience, it would be nice to have overloads that assume default 
> values for the last three parameters (bufferOffset, pixelSpace and 
> lineSpace) for the common case where we're not dealing with packed 
> buffers. In these cases, bufferOffset = 0, pixelSpace = 
> sizeof(datatype), and lineSpace = bufXSize * pixelSpace.

The default should be all zeros and then values are computed internally.
This should already be documented in the rasterio docs.

By the way, if there is a way of doing pointer arithmetic with the
IntPtr, then I think you should avoid this BufOffset idea. It seems
like a hack to me.

PS. I'm very excited by the progress on the c# bindings!  I made a
feeble attempt at this some time ago and failed because I didn't
know enough about c# and swig typemaps.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From nicky666 at gmail.com  Sun Nov  5 05:53:38 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
In-Reply-To: <454B7CC0.8030503@geomega.com>
References: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
	<454B7CC0.8030503@geomega.com>
Message-ID: <28de5e310611050253l6f14eb94y36463fc257b9ff57@mail.gmail.com>

> This thread was on the FWTools list:
>
> http://lists.maptools.org/pipermail/fwtools/2006-October/000531.html
>

Thanx to pointing it out.
I definitively have to improve my search method in lists ;-)

From nicky666 at gmail.com  Sun Nov  5 06:11:36 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdalwarp to merge several images
In-Reply-To: <454B82CD.8000706@pobox.com>
References: <28de5e310611030909v65b0d1d2xbb35cb1e27b47afa@mail.gmail.com>
	<454B82CD.8000706@pobox.com>
Message-ID: <28de5e310611050311l4fe31959x7e790667faaa169b@mail.gmail.com>

> Nicolas,
>
> Looking in the code it seems there is an undocumented warp option called
> SKIP_NOSOURCE that will cause gdalwarp to not attempt to actually warp
> chunks where there is no input data.
>
> eg
> gdalwarp -wo SKIP_NOSOURCE=yes -te 400000 3720000 410000 3730000
>       openev/utm.tif out.tif

Hello Franck.
This undocumented option works like a charm !
It effectively skips input images outside target area.
And it is much clearer in my script to integrate this option in the
command line instead of writing some lines of code to exclude input
images based on bbox comparison... ;-)

>
> I can't remember exactly why this isn't the default.  I think the issue
> was that there was a risk of the output file not getting properly initialized
> if blocks where skipped that shouldn't be skipped.   But I *think* it would
> be safe for me to modify gdalwarp to set this option by default for the
> second and subsequent files being processed.
>
> Note the input files outside the target area were not actually having imagery
> read.  But the warper was doing a great deal of work processing the whole
> region only to discover none of the output pixels had any corresponding input
> data.
>
> Arg.  This does make gdalwarp a bit questionable for some mosaicing purposes.
>

Yes, work processing done by the warper is heavy.
I noticed that it takes about the same time for gdalwarp to process an
image that would fit outsite the target area than to process an image
with data in target area.
(for small images, about 5 MB each)

Thank you for the support

Nicolas

From odhiambogeorge at yahoo.com  Wed Nov  1 06:38:08 2006
From: odhiambogeorge at yahoo.com (odhiambo george)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RE: shaded relief utility (DIY)
Message-ID: <20061101113808.53508.qmail@web54514.mail.yahoo.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: Equation2.doc
Type: application/msword
Size: 23552 bytes
Desc: 481547643-Equation2.doc
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061101/4eb47fa6/Equation2.doc
From zhaobi at microsoft.com  Wed Nov  1 18:48:36 2006
From: zhaobi at microsoft.com (Zhaoqiang Bi)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] how to use GDAL MEM driver
Message-ID: <28DB05FEF288134D9FD92FC9FB3513362122B2EE4B@NA-EXMSG-C102.redmond.corp.microsoft.com>

Hi,

I am trying to create an array in memory as a GDAL dataset. Below is the code snippet to do it, but it crashes at the functions which uses dataset as inputs. Any help is appreciated!

Bi
-------------------------------------------------------------

     char gdal_driver[20] = "GTiff";

    GDALAllRegister();
    int lines = _lines;
    int pixels = _pixels;

    GDALDataType datatype = get_datatype();
    pixelbytes = GDALGetDataTypeSize(datatype)/8;
    mode = 2;
    seedmode=1;
    modified = 0;

    /*reset datatype to float if not specified*/
    if (datatype == GDT_Unknown)
       datatype = GDT_Float32;

    /* Allocate memory for block */
    dat=(type *)malloc(block_lines*block_pixels*pixelbytes);
    if(dat==NULL)
       throw "No memory";

    dat2=(type **)malloc(block_lines*sizeof(type *));
    if(dat2==NULL)
    {
        free(dat);
        throw "No memory";
    }
    tmp=(type *)dat;
    for(i=0;i<block_lines;i++) dat2[i]=&tmp[i*block_pixels];

    /* Create a GDAL object */
    long int datpt =(long int) &dat2;
    char* filename = (char*) malloc(1024);
        sprintf(filename,"MEM:::DATAPOINTER=%d,PIXELS=%d,LINES=%d,BANDS=1,DATATYPE=%d,PIXELOFFSET=0,LINEOFFSET=0,BANDOFFSET=0",datpt,pixels,lines,datatype);
    dataset = GDALOpen(filename,GA_Update);

    if (dataset == NULL)
      printf("Failed to create file %s. Might exist already.\n",filename);
      throw "fail";
        }
    band = GDALGetRasterBand(dataset,1);
    for (i = 0; i<lines; i++)
        GDALRasterIO(band, GF_Write,0,i,pixels,1, dat, pixels,1, datatype,0,0);

    GDALFlushCache(dataset); //crash here
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061101/622a6799/attachment.html
From yunjm2005 at gmail.com  Thu Nov  2 02:51:45 2006
From: yunjm2005 at gmail.com (=?gb2312?B?2k+9qMP3?=)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Beginner problem - can't load DLL
Message-ID: <200611021551387032029@gmail.com>

what is the detail to set up my IDE to work with the FWTools's python version?
I have modify my set up by it still report can't load Dll. 

I have Edit all the value under Tools|Edit python path|  to 'C:\\FWTools' like
but when i check the sys.path it's value like the following message:

PythonWin 2.3.5 (#62, Feb  9 2005, 16:17:08) [MSC v.1200 32 bit (Intel)] on win32.
Portions Copyright 1994-2004 Mark Hammond (mhammond@skippinet.com.au) - see 'Help/About PythonWin' for further copyright information.
>>> import sys
>>> print(sys.path)
['', 'C:\\WINDOWS\\system32\\python23.zip', 'C:\\FWTools\\bin', 'C:\\FWTools\\pymod', 'C:\\Python23\\DLLs', 'C:\\Python23\\lib', 'C:\\Python23\\lib\\plat-win', 'C:\\Python23\\lib\\lib-tk', 'C:\\Python23\\Lib\\site-packages\\pythonwin', 'C:\\Python23', 'C:\\Python23\\lib\\site-packages', 'C:\\Python23\\lib\\site-packages\\win32', 'C:\\Python23\\lib\\site-packages\\win32\\lib']
>>> import gdal
Traceback (most recent call last):
  File "<interactive input>", line 1, in ?
  File "C:\FWTools\pymod\gdal.py", line 191, in ?
    import _gdal
ImportError: DLL load failed: 
>>> 






O
2006-11-02
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061102/27694cfc/attachment.html
From debeaudette at ucdavis.edu  Thu Nov  2 15:06:21 2006
From: debeaudette at ucdavis.edu (Dylan Beaudette)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] StarSpan Progress,
	and quick question on OGR data sources [update]
Message-ID: <200611021206.21247.debeaudette@ucdavis.edu>

Quick update, based on some quick analysis by Hobu:

http://rafb.net/paste/results/ZmlZmv65.html

reveals that starspan is only using the _first_ layer from an OGR data source. 
Hobu suggests that "starspan needs an option that does GetLayerByName and 
takes in a layer name".

Any ideas on who I can implement this Carlos ? 

Cheers,


> Hi guys,
>
> I was recently working on a project involving vector data stored in a
> PostGIS table, and raster data stored in GRASS - using starspan to perform
> the analysis. I noticed a (bug?) in starspan, where the --vector argument
> will only accept a single parameter. This becomes a problem when specifying
> an OGR PostGIS connection.
>
> For example:
> ogrinfo PG:"dbname=pinn  host=localhost" table_name
>
> would return all the gory details from the spatial table 'table_name'  from
> the database 'pinn' .
>
> note that there are two parameters on the command line: a DSN and the table
> (or in OGR terms, a layer).
>
> In starspan it is not possible to pass in 2 items to the --vector argument.
>
> I posted this question on the IRC channel yesterday, and was away from the
> computer when Frank responded.
>
> It sounds like there is no way to specify a 'table' in the PG datasource
> description line. Searching google, it sounds like there is some way to
> specify a 'schema' - but it is not clear how or if this would allow one to
> specify a specific table in a PostGIS data source.
>
> Therefore, I wonder if there is a simple modification to the starspan code
> which would allow for PG data sources to specify a table.
>
> Note that starspan can correctly extract PG vector data, when there is only
> 1 spatial table in the DB.
>
> Any thoughts?
>
> PS: I think that the abilities of starspan really shine here: extracting
> data from postgis and GRASS, two drastically different data sources -- all
> though the magic which is GDAL. Good work everyone!


-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From zbcumtdx at 163.com  Fri Nov  3 00:52:53 2006
From: zbcumtdx at 163.com (=?gb2312?B?1cWx8w==?=)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] why can't create huge IMA format Image
Message-ID: <200611031352531564934@163.com>

Dear
    I use GDAL to Create Huge Img image.but i broswer it in Erdas.I found all pixel is 0.I don't known why.can you tell me  thanks.





2006-11-03
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061103/f2058391/attachment.html
From szekerest at gmail.com  Sun Nov  5 10:56:15 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454D30CC.4040502@perkins.net>
References: <454988F5.8050401@perkins.net>
	<1162500129.7885.274867443@webmail.messagingengine.com>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
Message-ID: <f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>

> > I've added the base implementation with the following signature into
> > the CVS:
> >
> > public int ReadRasterInternal(int xOff, int yOff, int xSize, int
> > ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
> > pixelSpace, int lineSpace);
> >
> > public int WriteRasterInternal(int xOff, int yOff, int xSize, int
> > ySize, IntPtr buffer, int buf_xSize, int buf_ySize, int buf_type, int
> > pixelSpace, int lineSpace);
>
> That seems fine. Though I guess it feels slightly odd to me for a public
> function to be called "Internal". How about just calling these functions
> ReadRaster() and WriteRaster(), same as the more type safe functions,
> but just using a different set of arguments?

I see your option but to achieve this i shall have to change the common Band.i
interface file a bit for hiding the original ReadRaster and
WriteRaster implementation from the C# interface.
The current approach uses %ignore GDALRasterBandShadow::ReadRaster;
might prevent from
creating another implementation for these items.
But I will take care of this issue, since I've finally left these
functions public.

BTW, how about Dataset.WriteRaster? Is it necessary to implement?

>
> And it worked? Hmm, I notice that you use Format24bppRgb when creating
> the Bitmap, and then Format32bppRgb when locking it. I'm surprised that
> didn't throw an exception. Also the pixelspace of 4 is appropriate for
> 32bpp, but not for 24bpp. Perhaps windows uses 4 bytes per pixel even
> when you specify 24bpp?
>

Indeed. But it works. And the resulting image differs in bit depth
depending on the
pixelformat selection when creating the Bitmap. ;-)

> >
> > At this point I would avoid creating /unsafe code into the interface
> > so I will leave the user alone with the pointers and the fixed
> > statements.
> > However I would add the specializations depending on the array types
> > using Marshal.Copy
> > between the managed and the unmanaged memory.
>
> So how does this work? i.e. where does the unmanaged buffer that
> GDALRasterIO initially reads into get allocated? In C code somewhere? Or
> is there some way of getting an IntPtr pointing to an allocated buffer
> in C#? And then you copy it into a C# array in some CS code? And then
> switch back to C to free the unmanaged memory? And you can do all this
> without using the unsafe keyword? Guess it'll be easier to visualize it
> when you've written it.
>

With this solution the unmanaged memory would be allocated using
Marshal.AllocHGlobal at the marshaling
code and released after the call as for example (untested):

IntPtr ptr = Marshal.AllocHGlobal(buffer.length);
Mashal.Copy(buffer, 0, ptr, buffer.length);
WriteRasterInternal(xOff, yOff, xSize, ySize, ptr, pixelSpace, lineSpace);
Marshal.FreeHGlobal(ptr);

or

IntPtr ptr = Marshal.AllocHGlobal(buffer.length);
ReadRasterInternal(xOff, yOff, xSize, ySize, ptr, pixelSpace, lineSpace);
Mashal.Copy(ptr, buffer, 0, buffer.length);
Marshal.FreeHGlobal(ptr);


> FWIW, my personal feeling is that writing code like this that doesn't
> use the unsafe keyword makes you feel better, but when you look more
> closely it's a pretty dubious benefit. At the end of the day, you're
> passing pointers to buffers into unmanaged C code, and so really, that
> SHOULD be declared as unsafe. That C code could do all kinds of nasty
> things to your C# data structures, outside of your control. The fact
> that you can get around it by using IntPtr seems to me to be more a
> failing of the language, than a genuinely "safe" way to do things.
> Unless I'm missing something.
>

I consider your motion is conceptionally different, since it implies
the usage the garbage collected
'managed' memory at the unmanaged side requiring to prevent the memory
from unexpected
relocations and GC collections by using the fixed statement. In this
regard I really
feel better passing the memory to ReadRaster/WriteRaster allocated by
CPLMalloc for example.
The default behaviour of the SWIG generated wappers is that allocating
and freeing
the unmanaged memory takes place at the unmanaged side.
Since I cannot see the actual implementation how the several MS.NET FW
variations and MONO on
different platforms implement this issue and what potential problems
it may involve. It might
perform pretty well but not the 'safest' way from my aspect. It might
also require to compile the
interface assemblies using the /unsafe option.

Although we can do almost anything with SWIG I would not keen to go
too far with theese
variations. However I would not discourage the folks to use the C#
interface that way.
I think we would also require to make a documentation describing this
kind 'advanced' usage of the
interface and some sample apps would also be appreciated.

> Anyway, I'm still not especially keen on any extra copying of buffers.
> As long as the direct interface using IntPtr is available, I guess users
> can always choose to write their own more efficient methods to read GDAL
> data into arrays, using fixed() { }. But still, seems a shame to build
> in inefficiency just to avoid using the unsafe keyword, when in my
> opinion, the code should not be considered "safe" anyway.
>
>

Since I am not an expert in the usage of the GDAL part of the
interface it's much difficult for me
to think over the most efficient use cases. As you have mentioned
copying the buffers will produce
much of overhead during the processing of the image, I would consider
it was most efficient
to prolong the lifetime of the "processing" buffer by introducing a
new class (GDALBuffer for example)
This class could safely handle an internal unmanaged memory (being
allocated and freed at the unmanaged
side by using CPLMalloc and CPLFree). In addition we could use this
class passing the internal buffer to
WriteRasterInternal / ReadRasterInternal respectively. This class
would also contain the GDALDataType that makes up the
buffer and could reduce the number of overloads mentioned before in this thread.
We could access the elements of the array using an indexer with a GDALDataType
compliant C# type.
How do you like this idea?

>
> > How about supporting ReadBlock/WriteBlock? Would it be required?
>
> I think this is a pretty low priority. Most C++ apps use RasterIO()
> directly, which in turn makes calls to ReadBlock() and WriteBlock()
> (actually IReadBlock() and IWriteBlock()), which are implemented by the
> author of the particular GDAL driver being used. If people really want
> to read and write blocks, then can always get the block width and height
> using GDALGetBlockXSize(), and so forth, and then use RasterIO() with
> windows of that size.
>

OK. But the documentation notes that using RasterIO is less efficient, isn't it?


>
> Thinking about it some more, I think even for the IntPtr overload of
> ReadRaster / WriteRaster, it would make sense to add the bufferOffset
> argument, whenever we use the pixelSpace and lineSpace arguments. This
> avoids having to use that "new IntPtr(buf.ToInt32() + 1)" stuff. All
> three args are only really used when dealing with packed pixel format
> buffers.
>
> For convenience, it would be nice to have overloads that assume default
> values for the last three parameters (bufferOffset, pixelSpace and
> lineSpace) for the common case where we're not dealing with packed
> buffers. In these cases, bufferOffset = 0, pixelSpace =
> sizeof(datatype), and lineSpace = bufXSize * pixelSpace.
>

Would it be a requirement to access the buffer as a 2D array and specify
the offset accordingly?


Best Regards,

Tamas

From szekerest at gmail.com  Sun Nov  5 11:23:33 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454D66CF.3090305@pobox.com>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>
	<454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net> <454D66CF.3090305@pobox.com>
Message-ID: <f3b73b7d0611050823n22391addo46fd0149025e2525@mail.gmail.com>

Frank,

>
> Tamas just did "IntPtr buf = bitmapData.Scan0".  I assumed Scan0 was
> a buffer in the bitmapData object, and that it was previously allocated.
> So there is no apparent copying of the buffer, or allocation within
> the rasterio.  I could be missing lots of stuff though.
>

Would RasterIO reallocate the underlying buffer in some cases? It would
bring in some further problems should be handled at the interface.


> >> How about supporting ReadBlock/WriteBlock? Would it be required?
> >
> > I think this is a pretty low priority.
>
> Calling ReadBlock and WriteBlock is now also discouraged for C
> and C++ applications.  I don't see any need to binding them in
> the swig wrapped languages.
>

The documentation says it is more effective than using RasterIO instead.
How should I understand this?

> > For convenience, it would be nice to have overloads that assume default
> > values for the last three parameters (bufferOffset, pixelSpace and
> > lineSpace) for the common case where we're not dealing with packed
> > buffers. In these cases, bufferOffset = 0, pixelSpace =
> > sizeof(datatype), and lineSpace = bufXSize * pixelSpace.
>
> The default should be all zeros and then values are computed internally.
> This should already be documented in the rasterio docs.
>

We can see it exactly. But for a conventional C# user it would be more
affordable
to select a proper function overload instead of taking care of the
expected default values.

> By the way, if there is a way of doing pointer arithmetic with the
> IntPtr, then I think you should avoid this BufOffset idea. It seems
> like a hack to me.
>

Unless we would use /unsafe code fragments it will require to recreate the
InPtr object. And it might be handled differently on a 64 bit platform.

> PS. I'm very excited by the progress on the c# bindings!  I made a
> feeble attempt at this some time ago and failed because I didn't
> know enough about c# and swig typemaps

Since was not an expert in using the gdal part of the interface so far, I really
appreciate Simon's work by making clear some of the aspects to me.
But I feel happy digging into it in more detail as I can see the
features in action.  :-)


Best Regards,

Tamas

From mateusz at loskot.net  Sun Nov  5 11:35:48 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] Beginner problem - can't load DLL
In-Reply-To: <200611021551387032029@gmail.com>
References: <200611021551387032029@gmail.com>
Message-ID: <454E12E4.6080604@loskot.net>

O wrote:
> what is the detail to set up my IDE to work with the FWTools's python
> version?

What do you mean "my IDE"?

> I have modify my set up by it still report can't load Dll.
>  
> I have Edit all the value under Tools|Edit python path|  to
> 'C:\\FWTools' like
> but when i check the sys.path it's value like the following message:

What's Tools|Edit?

> PythonWin 2.3.5 (#62, Feb  9 2005, 16:17:08) [MSC v.1200 32 bit (Intel)]
> on win32.
> Portions Copyright 1994-2004 Mark Hammond (mhammond@skippinet.com.au
> <mailto:mhammond@skippinet.com.au>) - see 'Help/About PythonWin' for
> further copyright information.
>>>> import sys
>>>> print(sys.path)
> ['', 'C:\\WINDOWS\\system32\\python23.zip', 'C:\\FWTools\\bin',
> 'C:\\FWTools\\pymod', 'C:\\Python23\\DLLs', 'C:\\Python23\\lib',
> 'C:\\Python23\\lib\\plat-win', 'C:\\Python23\\lib\\lib-tk',
> 'C:\\Python23\\Lib\\site-packages\\pythonwin', 'C:\\Python23',
> 'C:\\Python23\\lib\\site-packages',
> 'C:\\Python23\\lib\\site-packages\\win32',
> 'C:\\Python23\\lib\\site-packages\\win32\\lib']
>>>> import gdal
> Traceback (most recent call last):
>   File "<interactive input>", line 1, in ?
>   File "C:\FWTools\pymod\gdal.py", line 191, in ?
>     import _gdal
> ImportError: DLL load failed: 

I suppose the problem is that GDAL DLL can't be found by your IDE,
whatever the IDE means.
Try to add path where GDAL DLL file lives to system-wide or user's
PATH environment variable.
sys.path represents Python's PYTHONPATH, not Windows PATH where exe and
dll files are searched for.

Alternatively, you can try to open FWTools command line (use shortcut in
Start Menu -> FWTools) and run your IDE from command line, then it should
inherit PATH settings from FWTools shell.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From trale at centrum.cz  Sun Nov  5 11:58:58 2006
From: trale at centrum.cz (trale@centrum.cz)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] gdal with kakadu_v5_2_2-00336C
In-Reply-To: <4548C5CF.9040503@pobox.com>
References: 200611011136.7245@centrum.cz> <200611011136.7245@centrum.cz>
	<4548C5CF.9040503@pobox.com>
Message-ID: <200611051758.20327@centrum.cz>

Hi Frank,

I am building this on Windows ... what info more do you need ?

thanks

Nick

>trale@centrum.cz wrote:<br>
>> Hi list,<br>
>> <br>
>> I have troubles with compiling the latest gdal13 with the
mentioned vetsion of kakadu. There are bunch of errors. Any help ?<br>
><br>
>Nick,<br>
><br>
>You really need to provide more information than this.<br>
><br>
>If you are doing this on unix, please ensure you use
--without-libtool<br>
>when configuring if you want to include Kakadu.<br>
><br>
>Best regards,<br>
>-- <br>
>---------------------------------------+--------------------------------------<br>
>I set the clouds in motion - turn up ? | Frank Warmerdam,
warmerdam@pobox.com<br>
>light and sound - activate the windows | <A
HREF="http://pobox.com/~warmerdam">http://pobox.com/~warmerdam</A><br>
>and watch the world go round - Rush ? ?| President OSGeo, <A
HREF="http://osgeo.org">http://osgeo.org</A><br>
><br>
>


From mateusz at loskot.net  Sun Nov  5 12:45:36 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] StarSpan Progress,	and quick question on OGR data
	sources [update]
In-Reply-To: <200611021206.21247.debeaudette@ucdavis.edu>
References: <200611021206.21247.debeaudette@ucdavis.edu>
Message-ID: <454E2340.9060108@loskot.net>

Dylan Beaudette wrote:
> Quick update, based on some quick analysis by Hobu:
> 
> http://rafb.net/paste/results/ZmlZmv65.html

Note, that rafb.net stores pastes for 24h.
Now, as I see this pasts has been removed.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From sy at perkins.net  Sun Nov  5 12:47:04 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454D66CF.3090305@pobox.com>
References: <454988F5.8050401@perkins.net>		<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>		<1162500129.7885.274867443@webmail.messagingengine.com>		<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>		<454A93A3.4050006@perkins.net>		<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>		<454BBD23.4080503@perkins.net>		<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>		<454BF899.3030201@perkins.net>	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net> <454D66CF.3090305@pobox.com>
Message-ID: <454E2398.4080008@perkins.net>



Frank Warmerdam wrote:
>> So how does this work? i.e. where does the unmanaged buffer that 
>> GDALRasterIO initially reads into get allocated? In C code somewhere? 
>> Or is there some way of getting an IntPtr pointing to an allocated 
>> buffer in C#? And then you copy it into a C# array in some CS code? 
>> And then switch back to C to free the unmanaged memory? And you can 
>> do all this without using the unsafe keyword? Guess it'll be easier 
>> to visualize it when you've written it.
>
> Tamas just did "IntPtr buf = bitmapData.Scan0".  I assumed Scan0 was
> a buffer in the bitmapData object, and that it was previously allocated.
> So there is no apparent copying of the buffer, or allocation within
> the rasterio.  I could be missing lots of stuff though.


I think we're talking about two different things here. Tamas and I have 
no disagreement over the "low level" version of the Read/WriteRaster() 
method that uses an IntPtr and a GDALDataType flag (which corresponds 
very closely to the original C GDALRasterIO() function). As you say, 
this involves no copying. However, the question is how to provide more 
typesafe versions of this method that allow one to read directly into 
arrays of bytes, ints, and so on. If I understand correctly, Tamas has 
proposed a solution that involves invoking the low level 
Read/WriteRaster() method to read/write data from/into an intermediate 
buffer, and then to copy the data from there to the array. I prefer a 
solution that uses the "fixed" keyword to read/write data directly 
from/to the buffer without any intermediate copying. The drawback to 
this is that the method would have to be declared with the "unsafe" 
keyword, and code using this method would have to be compiled with the 
/UNSAFE flag. So that's the tradeoff: efficiency vs. /UNSAFE. My 
personal feeling is that in reality, both methods are equally "unsafe" 
in the C# sense, so I don't mind using the /UNSAFE flag. But I can also 
see Tamas' point of view that this is aesthetically less appealing. 
Anyone else have any opinons on this?


>> For convenience, it would be nice to have overloads that assume 
>> default values for the last three parameters (bufferOffset, 
>> pixelSpace and lineSpace) for the common case where we're not dealing 
>> with packed buffers. In these cases, bufferOffset = 0, pixelSpace = 
>> sizeof(datatype), and lineSpace = bufXSize * pixelSpace.
>
> The default should be all zeros and then values are computed internally.
> This should already be documented in the rasterio docs.

Yes, that would be the sensible way to do it. I was just trying to be 
explicit about what the zero defaults are actually equivalent to.


> By the way, if there is a way of doing pointer arithmetic with the
> IntPtr, then I think you should avoid this BufOffset idea. It seems
> like a hack to me.

The pointer arithmetic with IntPtr() is a bit ugly. You have to do 
something like "new IntPtr(ptr.ToInt64() + 1)" to get a pointer one 
greater than ptr, for instance. I thought that the bufferOffset would be 
a neat way of hiding this.

But more significantly, if we're going to have versons of 
Read/WriteRaster() that use arrays as buffers, then you can't do pointer 
arithmetic with the array variable. So the only way to work with packed 
pixel buffer formats (i.e. "pixel interleaved" / BIP formats) is to 
specify a bufferOffset. What do you think?



Cheers,

Sy


From warmerdam at pobox.com  Sun Nov  5 13:18:22 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E2398.4080008@perkins.net>
References: <454988F5.8050401@perkins.net>		<f3b73b7d0611020823j61d2511fi9a21c385db15b830@mail.gmail.com>		<1162500129.7885.274867443@webmail.messagingengine.com>		<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>		<454A93A3.4050006@perkins.net>		<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>		<454BBD23.4080503@perkins.net>		<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>		<454BF899.3030201@perkins.net>	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net> <454D66CF.3090305@pobox.com>
	<454E2398.4080008@perkins.net>
Message-ID: <454E2AEE.5020004@pobox.com>

Simon Perkins wrote:
> But more significantly, if we're going to have versons of 
> Read/WriteRaster() that use arrays as buffers, then you can't do pointer 
> arithmetic with the array variable. So the only way to work with packed 
> pixel buffer formats (i.e. "pixel interleaved" / BIP formats) is to 
> specify a bufferOffset. What do you think?

Simon,

I see you point.  I had missed this whole distinction between higher and lower
level api.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Sun Nov  5 13:30:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] why can't create huge IMA format Image
In-Reply-To: <200611031352531564934@163.com>
References: <200611031352531564934@163.com>
Message-ID: <454E2DAF.9010209@pobox.com>

 wrote:
> Dear
>     I use GDAL to Create Huge Img image.but i broswer it in Erdas.I 
> found all pixel is 0.I don't known why.can you tell me  thanks.


Hi,

I think you will need to be more specific about what you are doing.
Normally it is possible to create large .img files (>4GB) with GDAL
and to have the imagery put into them visible in Erdas tools.  So I
think you need to explain the particulars of what you are doing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Sun Nov  5 13:36:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611050823n22391addo46fd0149025e2525@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>	
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	
	<454BF899.3030201@perkins.net>	
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>	
	<454D30CC.4040502@perkins.net> <454D66CF.3090305@pobox.com>
	<f3b73b7d0611050823n22391addo46fd0149025e2525@mail.gmail.com>
Message-ID: <454E2F45.8080809@pobox.com>

Tamas Szekeres wrote:
> Frank,
> 
>>
>> Tamas just did "IntPtr buf = bitmapData.Scan0".  I assumed Scan0 was
>> a buffer in the bitmapData object, and that it was previously allocated.
>> So there is no apparent copying of the buffer, or allocation within
>> the rasterio.  I could be missing lots of stuff though.
>>
> 
> Would RasterIO reallocate the underlying buffer in some cases? It would
> bring in some further problems should be handled at the interface.

Tamas,

GDALRasterBand::RasterIO() does not reallocate the memory.

> The documentation says it is more effective than using RasterIO instead.
> How should I understand this?

In theory, for some drivers, fetching the blocks directly can result in
slightly faster performance.   However, I now discourage this approach
with the possible exception of the most performance sensitive applications.

>> > For convenience, it would be nice to have overloads that assume default
>> > values for the last three parameters (bufferOffset, pixelSpace and
>> > lineSpace) for the common case where we're not dealing with packed
>> > buffers. In these cases, bufferOffset = 0, pixelSpace =
>> > sizeof(datatype), and lineSpace = bufXSize * pixelSpace.
>>
>> The default should be all zeros and then values are computed internally.
>> This should already be documented in the rasterio docs.
>>
> 
> We can see it exactly. But for a conventional C# user it would be more
> affordable
> to select a proper function overload instead of taking care of the
> expected default values.

I'm afraid I don't understand what you are telling me.  I am
suggesting that you should pass zeros into the C++ RasterIO()
method when the no particulars are provided by the caller.  And
then the C++ computes appropriate values.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sy at perkins.net  Sun Nov  5 13:38:19 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<1162500129.7885.274867443@webmail.messagingengine.com>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>	
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	
	<454BF899.3030201@perkins.net>	
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>	
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
Message-ID: <454E2F9B.8090707@perkins.net>

Tamas Szekeres wrote:
> BTW, how about Dataset.WriteRaster? Is it necessary to implement?

I personally never use it, but it's a reasonable candidate for the 
future. It would allow you to fill the packed format Bitmap buffers 
we've been talking about with a single GDAL call, for instance, since 
you can read multiple bands at once into a buffer.

I would suggest that we nail down the Band.Read/WriteRaster() methods 
first and then see where we are with the Dataset method.

> With this solution the unmanaged memory would be allocated using
> Marshal.AllocHGlobal at the marshaling
> code and released after the call as for example (untested):
>
> IntPtr ptr = Marshal.AllocHGlobal(buffer.length);
> Mashal.Copy(buffer, 0, ptr, buffer.length);
> WriteRasterInternal(xOff, yOff, xSize, ySize, ptr, pixelSpace, 
> lineSpace);
> Marshal.FreeHGlobal(ptr);
>
> or
>
> IntPtr ptr = Marshal.AllocHGlobal(buffer.length);
> ReadRasterInternal(xOff, yOff, xSize, ySize, ptr, pixelSpace, lineSpace);
> Mashal.Copy(ptr, buffer, 0, buffer.length);
> Marshal.FreeHGlobal(ptr);

OK, I see how this would work now. As you might guess, I still don't 
like the extra copying just to use a typesafe version of the method and 
to avoid the /UNSAFE keyword, but that's a personal preference. As long 
as the high performance IntPtr version of Read/WriteRaster() is 
available, I'll be happy...


> Since I am not an expert in the usage of the GDAL part of the
> interface it's much difficult for me
> to think over the most efficient use cases. As you have mentioned
> copying the buffers will produce
> much of overhead during the processing of the image, I would consider
> it was most efficient
> to prolong the lifetime of the "processing" buffer by introducing a
> new class (GDALBuffer for example)
> This class could safely handle an internal unmanaged memory (being
> allocated and freed at the unmanaged
> side by using CPLMalloc and CPLFree). In addition we could use this
> class passing the internal buffer to
> WriteRasterInternal / ReadRasterInternal respectively. This class
> would also contain the GDALDataType that makes up the
> buffer and could reduce the number of overloads mentioned before in 
> this thread.
> We could access the elements of the array using an indexer with a 
> GDALDataType
> compliant C# type.
> How do you like this idea?

Hmmm, I don't think I really like it... :)

We could create this new data structure and read and write data from it 
directly, but I would imagine that (a) indexing into this structure will 
not be as fast as indexing into an array, and (b) you're often going to 
want to copy the data into a proper array anwyay, for interoperability 
with other code that doesn't know anything about GDALBuffers. It just 
doesn't feel right to me...


OK, how's this for a suggestion:

We write Read/WriteRaster() methods for typed arrays that you've 
proposed, that use an intermediate buffer for copying. But in addition, 
we also write FastReadRaster() and FastWriteRaster() methods that use 
the "fixed" keyword to read/write directly to/from array buffers. These 
methods will be declared "unsafe". Code that we don't want to compile 
with /UNSAFE can just use the basic Read/WriteRaster() methods, while 
code that wants to achieve maximum efficiency can use the Fast/usafe 
variants of the method. Note that there's no actual difference in the 
safety of these methods!


Anyway, at the end of the day, as long as I have my IntPtr version that 
I can use for efficient I/O, I don't really mind what other type safe 
versions we put in there...


>> I think this is a pretty low priority. Most C++ apps use RasterIO()
>> directly, which in turn makes calls to ReadBlock() and WriteBlock()
>> (actually IReadBlock() and IWriteBlock()), which are implemented by the
>> author of the particular GDAL driver being used. If people really want
>> to read and write blocks, then can always get the block width and height
>> using GDALGetBlockXSize(), and so forth, and then use RasterIO() with
>> windows of that size.
>>
>
> OK. But the documentation notes that using RasterIO is less efficient, 
> isn't it?

I think the docs only say that RasterIO is _potentially_ less efficient. 
And even that's a bit misleading. Basically, if you use RasterIO() to 
read data using buffers that are the natural block size of your image, 
with no resampling, and that have the same type as  the raw data type of 
the image file, then RasterIO() is just as efficient as ReadBlock(). The 
point is that RasterIO() is a more flexible function that allows you to 
do all kinds of extra stuff, e.g. resampling, data type conversion, that 
take extra computation. So ReadBlock() is not more efficient than 
rasterIO() - it just doesn't permit some of the more complicated slower 
things that RasterIO() can do.


>> Thinking about it some more, I think even for the IntPtr overload of
>> ReadRaster / WriteRaster, it would make sense to add the bufferOffset
>> argument, whenever we use the pixelSpace and lineSpace arguments. This
>> avoids having to use that "new IntPtr(buf.ToInt32() + 1)" stuff. All
>> three args are only really used when dealing with packed pixel format
>> buffers.
>>
>> For convenience, it would be nice to have overloads that assume default
>> values for the last three parameters (bufferOffset, pixelSpace and
>> lineSpace) for the common case where we're not dealing with packed
>> buffers. In these cases, bufferOffset = 0, pixelSpace =
>> sizeof(datatype), and lineSpace = bufXSize * pixelSpace.
>>
>
> Would it be a requirement to access the buffer as a 2D array and specify
> the offset accordingly?

The buffer offset would just be a single starting index into the array.



Cheers,

Sy


From sy at perkins.net  Sun Nov  5 13:52:52 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E2F9B.8090707@perkins.net>
References: <454988F5.8050401@perkins.net>	
	<1162500129.7885.274867443@webmail.messagingengine.com>	
	<f3b73b7d0611021539g36437fd2tcdfc3536f10f3fd3@mail.gmail.com>	
	<454A93A3.4050006@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>	
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	
	<454BF899.3030201@perkins.net>	
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>	
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
	<454E2F9B.8090707@perkins.net>
Message-ID: <454E3304.7030003@perkins.net>

Simon Perkins wrote:
> OK, I see how this would work now. As you might guess, I still don't 
> like the extra copying just to use a typesafe version of the method 
> and to avoid the /UNSAFE keyword, but that's a personal preference. As 
> long as the high performance IntPtr version of Read/WriteRaster() is 
> available, I'll be happy...

Just to play devil's advocate a little, I'm going to point out that the 
extra cost involved with allocating an intermediate buffer and copying 
data for the typesafe versions of Read/WriteRaster() might actually not 
be that significant...

 GDAL already does some intermediate copying of data since internally it 
reads blocks of data, stores those in a cache, and then copies from 
there to the user's buffer. In addition, if the block data has to be 
fetched from disk, the cost of the disk I/O is certain to dwarf the cost 
of a few extra memory copies...

Cheers!

Sy


From szekerest at gmail.com  Sun Nov  5 14:31:09 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E2F45.8080809@pobox.com>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net> <454D66CF.3090305@pobox.com>
	<f3b73b7d0611050823n22391addo46fd0149025e2525@mail.gmail.com>
	<454E2F45.8080809@pobox.com>
Message-ID: <f3b73b7d0611051131o62bc9ddchf8700c6fb016d7aa@mail.gmail.com>

> >
> > We can see it exactly. But for a conventional C# user it would be more
> > affordable
> > to select a proper function overload instead of taking care of the
> > expected default values.
>
> I'm afraid I don't understand what you are telling me.  I am
> suggesting that you should pass zeros into the C++ RasterIO()
> method when the no particulars are provided by the caller.  And
> then the C++ computes appropriate values.
>

It's just an aesthetic issue not a technical. For C# we cannot use the
conventional notation when declaring with default values as:

public int MyFunction(int value1, int value2, int value3 = 23);

Instead we have to use overloads like:

public int MyFunction(int value1, int value2, int value3);
public int MyFunction(int value1, int value2);

But of course the user could keep in mind that passing 23 as value3
will result the same
as having the second one.


Best Regards,

Tamas

From sy at perkins.net  Sun Nov  5 14:45:38 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611051131o62bc9ddchf8700c6fb016d7aa@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	<454BBD23.4080503@perkins.net>	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	<454BF899.3030201@perkins.net>	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>	<454D30CC.4040502@perkins.net>
	<454D66CF.3090305@pobox.com>	<f3b73b7d0611050823n22391addo46fd0149025e2525@mail.gmail.com>	<454E2F45.8080809@pobox.com>
	<f3b73b7d0611051131o62bc9ddchf8700c6fb016d7aa@mail.gmail.com>
Message-ID: <454E3F62.9010209@perkins.net>

Tamas Szekeres wrote:
>> >
>> > We can see it exactly. But for a conventional C# user it would be more
>> > affordable
>> > to select a proper function overload instead of taking care of the
>> > expected default values.
>>
>> I'm afraid I don't understand what you are telling me.  I am
>> suggesting that you should pass zeros into the C++ RasterIO()
>> method when the no particulars are provided by the caller.  And
>> then the C++ computes appropriate values.
>>
>
> It's just an aesthetic issue not a technical. For C# we cannot use the
> conventional notation when declaring with default values as:
>
> public int MyFunction(int value1, int value2, int value3 = 23);
>
> Instead we have to use overloads like:
>
> public int MyFunction(int value1, int value2, int value3);
> public int MyFunction(int value1, int value2);

Agreed, but Frank was just pointing out that in the overload where the 
pixelSpace and lineSpace args are not specified, it's better to pass 
those parameters on to the underlying GDAL function as zeros, rather 
than the values I suggested in my e-mail. The zeros tell GDAL to assume 
default values for those parameters - which are the same as the ones I 
explcitly suggested.

Sy


From szekerest at gmail.com  Sun Nov  5 14:54:58 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E2F9B.8090707@perkins.net>
References: <454988F5.8050401@perkins.net> <454A93A3.4050006@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
	<454E2F9B.8090707@perkins.net>
Message-ID: <f3b73b7d0611051154x5b1ca5u605190c4dc7204cc@mail.gmail.com>

Simon,

>
> I personally never use it, but it's a reasonable candidate for the
> future. It would allow you to fill the packed format Bitmap buffers
> we've been talking about with a single GDAL call, for instance, since
> you can read multiple bands at once into a buffer.
>
> I would suggest that we nail down the Band.Read/WriteRaster() methods
> first and then see where we are with the Dataset method.
>

Agreed.

>
> > Since I am not an expert in the usage of the GDAL part of the
> > interface it's much difficult for me
> > to think over the most efficient use cases. As you have mentioned
> > copying the buffers will produce
> > much of overhead during the processing of the image, I would consider
> > it was most efficient
> > to prolong the lifetime of the "processing" buffer by introducing a
> > new class (GDALBuffer for example)
> > This class could safely handle an internal unmanaged memory (being
> > allocated and freed at the unmanaged
> > side by using CPLMalloc and CPLFree). In addition we could use this
> > class passing the internal buffer to
> > WriteRasterInternal / ReadRasterInternal respectively. This class
> > would also contain the GDALDataType that makes up the
> > buffer and could reduce the number of overloads mentioned before in
> > this thread.
> > We could access the elements of the array using an indexer with a
> > GDALDataType
> > compliant C# type.
> > How do you like this idea?
>
> Hmmm, I don't think I really like it... :)
>
> We could create this new data structure and read and write data from it
> directly, but I would imagine that (a) indexing into this structure will
> not be as fast as indexing into an array, and (b) you're often going to
> want to copy the data into a proper array anwyay, for interoperability
> with other code that doesn't know anything about GDALBuffers. It just
> doesn't feel right to me...
>

Depends on how we are using the buffer most of the time.
I we would sequentially invoke GDAL with the same buffer and modify
a particular array item rarely it would be an option. Certainly, we could also
have the necessary Copy options between GDALBuffer and the
corresponding C# buffer.

>
> OK, how's this for a suggestion:
>
> We write Read/WriteRaster() methods for typed arrays that you've
> proposed, that use an intermediate buffer for copying. But in addition,
> we also write FastReadRaster() and FastWriteRaster() methods that use
> the "fixed" keyword to read/write directly to/from array buffers. These
> methods will be declared "unsafe". Code that we don't want to compile
> with /UNSAFE can just use the basic Read/WriteRaster() methods, while
> code that wants to achieve maximum efficiency can use the Fast/usafe
> variants of the method. Note that there's no actual difference in the
> safety of these methods!
>

Well, it's not so difficult to convince me. In this case we shall have to add
an option to sharp.opt and makefile.vc should be modified so as to
apply the /unsafe option conditionally and notify SWIG whether not create
the Fast.. methods. Disabling unsafe code would be the default option
if you don't mind.

Best Regards,

Tamas

From szekerest at gmail.com  Sun Nov  5 14:57:27 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E3304.7030003@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>
	<454BBD23.4080503@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
	<454E2F9B.8090707@perkins.net> <454E3304.7030003@perkins.net>
Message-ID: <f3b73b7d0611051157p38aa7f03u4357f61bb52af340@mail.gmail.com>

2006/11/5, Simon Perkins <sy@perkins.net>:
> Simon Perkins wrote:
> > OK, I see how this would work now. As you might guess, I still don't
> > like the extra copying just to use a typesafe version of the method
> > and to avoid the /UNSAFE keyword, but that's a personal preference. As
> > long as the high performance IntPtr version of Read/WriteRaster() is
> > available, I'll be happy...
>
> Just to play devil's advocate a little, I'm going to point out that the
> extra cost involved with allocating an intermediate buffer and copying
> data for the typesafe versions of Read/WriteRaster() might actually not
> be that significant...
>
>  GDAL already does some intermediate copying of data since internally it
> reads blocks of data, stores those in a cache, and then copies from
> there to the user's buffer. In addition, if the block data has to be
> fetched from disk, the cost of the disk I/O is certain to dwarf the cost
> of a few extra memory copies...
>

Would it mean that the requirement about the unsafe methods is obsoleted?


Best Regards,

Tamas

From sy at perkins.net  Sun Nov  5 15:00:59 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611051157p38aa7f03u4357f61bb52af340@mail.gmail.com>
References: <454988F5.8050401@perkins.net>	
	<f3b73b7d0611030304hb9fd59m441838a7c86ed7b7@mail.gmail.com>	
	<454BBD23.4080503@perkins.net>	
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>	
	<454BF899.3030201@perkins.net>	
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>	
	<454D30CC.4040502@perkins.net>	
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>	
	<454E2F9B.8090707@perkins.net> <454E3304.7030003@perkins.net>
	<f3b73b7d0611051157p38aa7f03u4357f61bb52af340@mail.gmail.com>
Message-ID: <454E42FB.2090705@perkins.net>


>> Just to play devil's advocate a little, I'm going to point out that the
>> extra cost involved with allocating an intermediate buffer and copying
>> data for the typesafe versions of Read/WriteRaster() might actually not
>> be that significant...
>>
>>  GDAL already does some intermediate copying of data since internally it
>> reads blocks of data, stores those in a cache, and then copies from
>> there to the user's buffer. In addition, if the block data has to be
>> fetched from disk, the cost of the disk I/O is certain to dwarf the cost
>> of a few extra memory copies...
>>
>
> Would it mean that the requirement about the unsafe methods is obsoleted?

Right. So, for now, let's leave out the unsafe methods then. At some 
point, I might do some speed comparisons between the IntPtr version and 
the typesafe version. If there's a significant speed penalty (which I 
doubt) then we can revisit the idea of adding optional unsafe/fast methods.

Cheers!

Sy


From warmerdam at pobox.com  Sun Nov  5 15:18:23 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] how to use GDAL MEM driver
In-Reply-To: <28DB05FEF288134D9FD92FC9FB3513362122B2EE4B@NA-EXMSG-C102.redmond.corp.microsoft.com>
References: <28DB05FEF288134D9FD92FC9FB3513362122B2EE4B@NA-EXMSG-C102.redmond.corp.microsoft.com>
Message-ID: <454E470F.6060808@pobox.com>

Zhaoqiang Bi wrote:
 >     dat=(type *)malloc(block_lines*block_pixels*pixelbytes);
...
>     dat2=(type **)malloc(block_lines*sizeof(type *));
...
>     tmp=(type *)dat;
> 
>     for(i=0;i<block_lines;i++) dat2[i]=&tmp[i*block_pixels];
> 
>    
> 
>     /* Create a GDAL object */
> 
>     long int datpt =(long int) &dat2;
...
>     sprintf(filename,"MEM:::DATAPOINTER=%d,PIXELS=%d,LINES=%d,BANDS=1,DATATYPE=%d,PIXELOFFSET=0,LINEOFFSET=0,BANDOFFSET=0",datpt,pixels,lines,datatype);
> 
>     dataset = GDALOpen(filename,GA_Update);

Zhaoqiang Bi,

The buffer referenced by DATAPOINTER should be one continuous
buffer of the desired size.  In your case dat2 appears to be an
array of pointers to scanlines in the "dat" buffer.

It isn't completely clear to me, but I think you wanted to use the original
data as the memory array associated with the GDALDataset.  To do that
it should be sufficient to do something like:

   sprintf(filename,
         "MEM:::DATAPOINTER=%p,PIXELS=%d,LINES=%d,BANDS=1,DATATYPE=%d,"
         "PIXELOFFSET=%d,LINEOFFSET=%d,BANDOFFSET=0",
         dat, pixels, lines, datatype,
	pixelbytes, pixelbytes * block_pixels );

I have used the %p printf formatter for a somewhat more portable
handling of 64bit platforms.  Also, I have set the PIXELOFFSET,
LINEOFFSET and BANDOFFSET values more appropriately.

Later in the code you had this:
 >    band = GDALGetRasterBand(dataset,1);
 >    for (i = 0; i<lines; i++)
 >        GDALRasterIO(band, GF_Write,0,i,pixels,1,
 >                     dat, pixels,1, datatype,0,0);
 >
 >    GDALFlushCache(dataset); //crash here

This seems a bit off base to me.  You are essentially writing the
contents of the "dat" array into the band.  But the band is in
fact attached to the dat buffer already, so it is really writing
over itself. So this part should not be necessary.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ari.jolma at tkk.fi  Sun Nov  5 15:53:20 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:26 2007
Subject: [Gdal-dev] RE: shaded relief utility (DIY)
In-Reply-To: <20061101113808.53508.qmail@web54514.mail.yahoo.com>
References: <20061101113808.53508.qmail@web54514.mail.yahoo.com>
Message-ID: <454E4F40.6000309@tkk.fi>

Odhiambo,

Probably you are looking for how to compute an estimate of the slope and 
aspect, from which you can compute the shading.

Usually a fit of 9-term quadratic polynomial is used. C code for 
computing that is for example here: 
http://libral.cvs.sourceforge.net/libral/libral/ral_catchment.c?revision=1.29&view=markup 
(see lines 94-260) z_factor is for cases when the unit of x and y 
differs from the unit of z.

Regards,

Ari Jolma

odhiambo george kirjoitti:
> Dear Sir,
>  
> I'm trying to write a MATLAB program for calculating or creating 
> shaded relief from a DEM. I have come across the equation attached to 
> this e-mail which i believe represents calculation of the cell values 
> heights.
>  
> What I don't undersyand is how to handle the DEM, for example, how do 
> I use the DEM together with the equation  ?
>  
> Kindly assist by shedding some light on the procedure used
>  
> Kind regards,
> George
>
> ------------------------------------------------------------------------
> Access over 1 million songs - Yahoo! Music Unlimited Try it today. 
> <http://pa.yahoo.com/*http://us.rd.yahoo.com/evt=36035/*http://music.yahoo.com/unlimited/> 
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


-- 
Prof. Ari Jolma
Geoinformaatio- ja paikannustekniikka
Geoinformation and positioning technology
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From henhiskan at gmail.com  Sun Nov  5 19:43:29 2006
From: henhiskan at gmail.com (Richard Rossel)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] ogr2ogr generate SQL sintax error
Message-ID: <73478880611051643k4fddc51el36517ce2f91cb636@mail.gmail.com>

Hi list, am newbie here and I bring a big problem with me :(

I try to convert my shapefile into Postgres with ogr2ogr:

ogr2ogr -select "ID,FRC,FOW" -where "FEATTYP = '4110' AND ROUTENUM !=
''" -f "PostgreSQL" PG:"host=localhost user=atlas dbname=atlas"
cheche________nw.shp

ERROR 1: INSERT command for new feature failed.
ERROR:  syntax error at or near "INTO" at character 83

Command: INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id", "frc",
"fow") VALUES (INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id",
"frc", "fow") VALUES
('\\001\\002\\000\\000\\000\\003\\000\\000\\0000|3\\0401\\300\\041@\\205\\204\\336\\321\\265\\026G@\\374\\264\\212\\376\\320\\300\\041@\\304D\\336\\315\\256\\026G@\\024\\031\\014d,\\301\\041@\\242\\250}\\204\\253\\026G@',
 17561001781772, 4, 3)
ERROR 1: Terminating translation prematurely after failed
translation of layer cheche________nw

I found that the problem is that ogr write "INSERT INTO" twice times.
I take that sentence, drop the exra "INSERT INTO" and charge into DB
without problem.
How can fix it, and populate my DB with shapefile date.

I try with shp2pgsql with no result either ;(

Please help

thanks.-





-- 
Richard Rossel
Software Enginneer, WOS
Valparaiso - Chile

From yunjm2005 at gmail.com  Sun Nov  5 22:24:23 2006
From: yunjm2005 at gmail.com (=?gb2312?B?2k+9qMP3?=)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Beginner problem - can't load DLL
References: <200611021551387032029@gmail.com> <454E12E4.6080604@loskot.net>
	<200611061119387032698@gmail.com>
Message-ID: <200611061124212653188@gmail.com>

to Mateusz Loskot:

thank you very much!
I'm sorry to my unclearly language.
I use the IDE PythonWin.
According to your direction i have solved my problem.
It's really like you say,i have set the Python path but not set the OS's Path to search my dll,so the problem occur.
Thanks again!




O
2006-11-06



 Mateusz Loskot
 2006-11-06 00:35:48
 gdal-dev@lists.maptools.org
 
 Re: [Gdal-dev] Beginner problem - can't load DLL

O wrote:
> what is the detail to set up my IDE to work with the FWTools's python
> version?

What do you mean "my IDE"?

> I have modify my set up by it still report can't load Dll.
>  
> I have Edit all the value under Tools|Edit python path|  to
> 'C:\\FWTools' like
> but when i check the sys.path it's value like the following message:

What's Tools|Edit?

> PythonWin 2.3.5 (#62, Feb  9 2005, 16:17:08) [MSC v.1200 32 bit (Intel)]
> on win32.
> Portions Copyright 1994-2004 Mark Hammond (mhammond@skippinet.com.au
>  <mailto:mhammond@skippinet.com.au >) - see 'Help/About PythonWin' for
> further copyright information.
> > > > import sys
> > > > print(sys.path)
> ['', 'C:\\WINDOWS\\system32\\python23.zip', 'C:\\FWTools\\bin',
> 'C:\\FWTools\\pymod', 'C:\\Python23\\DLLs', 'C:\\Python23\\lib',
> 'C:\\Python23\\lib\\plat-win', 'C:\\Python23\\lib\\lib-tk',
> 'C:\\Python23\\Lib\\site-packages\\pythonwin', 'C:\\Python23',
> 'C:\\Python23\\lib\\site-packages',
> 'C:\\Python23\\lib\\site-packages\\win32',
> 'C:\\Python23\\lib\\site-packages\\win32\\lib']
> > > > import gdal
> Traceback (most recent call last):
>   File " <interactive input >", line 1, in ?
>   File "C:\FWTools\pymod\gdal.py", line 191, in ?
>     import _gdal
> ImportError: DLL load failed: 

I suppose the problem is that GDAL DLL can't be found by your IDE,
whatever the IDE means.
Try to add path where GDAL DLL file lives to system-wide or user's
PATH environment variable.
sys.path represents Python's PYTHONPATH, not Windows PATH where exe and
dll files are searched for.

Alternatively, you can try to open FWTools command line (use shortcut in
Start Menu - > FWTools) and run your IDE from command line, then it should
inherit PATH settings from FWTools shell.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061106/467ea086/attachment.html
From warmerdam at pobox.com  Sun Nov  5 23:26:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] ogr2ogr generate SQL sintax error
In-Reply-To: <73478880611051643k4fddc51el36517ce2f91cb636@mail.gmail.com>
References: <73478880611051643k4fddc51el36517ce2f91cb636@mail.gmail.com>
Message-ID: <454EB992.4080802@pobox.com>

Richard Rossel wrote:
> Hi list, am newbie here and I bring a big problem with me :(
> 
> I try to convert my shapefile into Postgres with ogr2ogr:
> 
> ogr2ogr -select "ID,FRC,FOW" -where "FEATTYP = '4110' AND ROUTENUM !=
> ''" -f "PostgreSQL" PG:"host=localhost user=atlas dbname=atlas"
> cheche________nw.shp
> 
> ERROR 1: INSERT command for new feature failed.
> ERROR:  syntax error at or near "INTO" at character 83
> 
> Command: INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id", "frc",
> "fow") VALUES (INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id",
> "frc", "fow") VALUES
> ('\\001\\002\\000\\000\\000\\003\\000\\000\\0000|3\\0401\\300\\041@\\205\\204\\336\\321\\265\\026G@\\374\\264\\212\\376\\320\\300\\041@\\304D\\336\\315\\256\\026G@\\024\\031\\014d,\\301\\041@\\242\\250}\\204\\253\\026G@', 
> 
> 17561001781772, 4, 3)
> ERROR 1: Terminating translation prematurely after failed
> translation of layer cheche________nw
> 
> I found that the problem is that ogr write "INSERT INTO" twice times.
> I take that sentence, drop the exra "INSERT INTO" and charge into DB
> without problem.
> How can fix it, and populate my DB with shapefile date.

Richard,

This sounds like an ugly bug in the postgis driver, but I'm pretty
surprised.  Could you submit a detailed bug report via bugzilla with
information on the GDAL/OGR version you are using, data files and
the command?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jnovak at novacell.com  Mon Nov  6 02:50:40 2006
From: jnovak at novacell.com (John Novak)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdaladdo question
Message-ID: <454EE950.1080704@novacell.com>

Is it a Bad Thing to run the same gdaladdo command over a TIFF file more 
than once ?

John Novak



From mateusz at loskot.net  Mon Nov  6 03:34:54 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Beginner problem - can't load DLL
In-Reply-To: <200611061124212653188@gmail.com>
References: <200611021551387032029@gmail.com>
	<454E12E4.6080604@loskot.net>	<200611061119387032698@gmail.com>
	<200611061124212653188@gmail.com>
Message-ID: <454EF3AE.8040001@loskot.net>

O wrote:
> to Mateusz Loskot:
> 
> thank you very much! I'm sorry to my unclearly language. I use the
> IDE PythonWin. According to your direction i have solved my problem. 
> It's really like you say,i have set the Python path but not set the
> OS's Path to search my dll,so the problem occur.

I'm glad it's solved.
In future, be aware that if you will install new Python version,
not shipped with FWTools, then you will have two python versions
"visible" in PATH, so conflicts are possible.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mirhassanali at gmail.com  Mon Nov  6 04:51:38 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Compiling GDAL/OGR for C#
Message-ID: <b41d86b30611060151u1d94f371h13060774be269477@mail.gmail.com>

Hi

I am new to the GDAL/OGR development. I want to read MapInfo/ESRI files from
my application in C#. Please can anyone guide me in the right direction so
that I can compile GDAL/OGR for C# and use it in my application. Any help
will be highly appreciated.

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061106/7679e95b/attachment.html
From guillaume.huby.lists at gmail.com  Mon Nov  6 05:08:26 2006
From: guillaume.huby.lists at gmail.com (guillaume huby)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal_merge.py resample method
Message-ID: <ddc797c30611060208r3767ac9cqd7168730da10a1d@mail.gmail.com>

Hello,

I'm using FWTools 1.6.0

I wondered about resample method used in gdal_merge.py when different
resolution are in inputs images.

In the script I found the following documentation :
"However,
        if the destination file is a different resolution, or different
        image pixel type, the appropriate resampling and conversions will
        be done (using normal GDAL promotion/demotion rules)."

Is the rule nearest neighbour, bilinear or some other resample method ?

Thanks in advance for replies.

Best regards,
Guillaume.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061106/6eeb6a8e/attachment.html
From szekerest at gmail.com  Mon Nov  6 05:40:00 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Compiling GDAL/OGR for C#
In-Reply-To: <b41d86b30611060151u1d94f371h13060774be269477@mail.gmail.com>
References: <b41d86b30611060151u1d94f371h13060774be269477@mail.gmail.com>
Message-ID: <f3b73b7d0611060240v12e4784bqb318084080c0fcfc@mail.gmail.com>

Hi,

At first you should compile gdal with the desired options.
After compiling gdal, step into the gdal /swig/csharp directory and use:

1. nmake -f makefile.vc interface
2. nmake -f makefile.vc
3. nmake -f makefile.vc test

The latter will run the sample applications. These apps would show you how to
use the OGR libraries.

You should use the latest CVS version.

Best Regards,

Tamas


2006/11/6, Mir Hassan Ali <mirhassanali@gmail.com>:
> Hi
>
> I am new to the GDAL/OGR development. I want to read MapInfo/ESRI files from
> my application in C#. Please can anyone guide me in the right direction so
> that I can compile GDAL/OGR for C# and use it in my application. Any help
> will be highly appreciated.
>
> Best Regards
>
> Mir Hassan Ali
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From henhiskan at gmail.com  Mon Nov  6 06:20:37 2006
From: henhiskan at gmail.com (Richard Rossel)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] ogr2ogr generate SQL sintax error
In-Reply-To: <454EB992.4080802@pobox.com>
References: <73478880611051643k4fddc51el36517ce2f91cb636@mail.gmail.com>
	<454EB992.4080802@pobox.com>
Message-ID: <73478880611060320t2132a4c2k3146260c8edcfdf7@mail.gmail.com>

Ok thanks, I will report this bug.
BTW, what I am trying to do is to create a new shapefile from another
one, i.e., I must add, erase, rename fields from current shapeifle and
save it into new one . I wanted to do with Postgres, but  I have had
many problems with this. The question is: Can do that by another way?
Thanks a lot.-

On 11/6/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Richard Rossel wrote:
> > Hi list, am newbie here and I bring a big problem with me :(
> >
> > I try to convert my shapefile into Postgres with ogr2ogr:
> >
> > ogr2ogr -select "ID,FRC,FOW" -where "FEATTYP = '4110' AND ROUTENUM !=
> > ''" -f "PostgreSQL" PG:"host=localhost user=atlas dbname=atlas"
> > cheche________nw.shp
> >
> > ERROR 1: INSERT command for new feature failed.
> > ERROR:  syntax error at or near "INTO" at character 83
> >
> > Command: INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id", "frc",
> > "fow") VALUES (INSERT INTO "cheche________nw" (WKB_GEOMETRY , "id",
> > "frc", "fow") VALUES
> > ('\\001\\002\\000\\000\\000\\003\\000\\000\\0000|3\\0401\\300\\041@\\205\\204\\336\\321\\265\\026G@\\374\\264\\212\\376\\320\\300\\041@\\304D\\336\\315\\256\\026G@\\024\\031\\014d,\\301\\041@\\242\\250}\\204\\253\\026G@',
> >
> > 17561001781772, 4, 3)
> > ERROR 1: Terminating translation prematurely after failed
> > translation of layer cheche________nw
> >
> > I found that the problem is that ogr write "INSERT INTO" twice times.
> > I take that sentence, drop the exra "INSERT INTO" and charge into DB
> > without problem.
> > How can fix it, and populate my DB with shapefile date.
>
> Richard,
>
> This sounds like an ugly bug in the postgis driver, but I'm pretty
> surprised.  Could you submit a detailed bug report via bugzilla with
> information on the GDAL/OGR version you are using, data files and
> the command?
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>


-- 
Richard Rossel
Software Enginneer, WOS
Valparaiso - Chile

From kkirubanantham at yahoo.com  Mon Nov  6 06:34:47 2006
From: kkirubanantham at yahoo.com (kiruba nantham)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL building for Windows CE
Message-ID: <20061106113447.22740.qmail@web52209.mail.yahoo.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: Error_report.rtf
Type: application/msword
Size: 4664 bytes
Desc: 3934220780-Error_report.rtf
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061106/1d9ccccb/Error_report.dot
From mateusz at loskot.net  Mon Nov  6 07:39:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL building for Windows CE
In-Reply-To: <20061106113447.22740.qmail@web52209.mail.yahoo.com>
References: <20061106113447.22740.qmail@web52209.mail.yahoo.com>
Message-ID: <454F2CFA.40505@loskot.net>

kiruba nantham wrote:
> Hai Frank,
>     I am kiruba, i had completed my s57 file reader(ENC file format)
> sucessfully.

kiruba,

S57 driver is not available for Windows CE yet.

>     Now i am trying to build *gdal13.dll* to work for pocket PC
> 2003(*WINDOWS CE*)  but i am getting following errors.

What GDAL version do you use?
There are some issues in 1.3.2, so it's recommended to use GDAL from CVS
to build it for Windows CE.

>        1) When i am compiling from command prompt i am able to set
> environment
>            and  i checked for *Platform*  and *OSVersion* as you
> explained i am
>            getting same that is *POCKET PC 2003* and *WCE420*. but when i am
>            doing *nmake /f makefile.evc4 *i am getting this errors.
>                         cannot open include file windows.h
>                         cannot open include file stdio.h 

You've likely not configure your environment as described in secton
"Building GDAL port using eVC++ and makefiles", step 2nd, in this howto
http://gdal.org/wince.html

>        2)Then i tried to build evc4_gdalce_dll.vcw *using embedded VC++ 4.0*
>           i was getting around 95 errors. after including paths finally
> i am getting
>           22 errors, some errors are
>             i)  error C2065: 'wce_findfirst' : undeclared identifier.
>             ii) error C2065: 'wce_findnext' : undeclared identifier. 
> *etc... *
>         i attached the full error report with this mail, if it is
> possible check this out.


This is one of the issues I mentioned, so GDAL CVS is recommended.
While GDAL 1.3.2 was releasing, in port for Windows CE functions naming
has changed, the wce_ prefix was changed to wceex_ because of names
clashes with MFC functions.
For Windows CE port, GDAL 1.3.2 should be considered as alpha version.
So, please use GDAL from CVS.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From Charles.Wivell at dnr.state.mn.us  Mon Nov  6 09:21:37 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] RE: shaded relief utility (DIY)
In-Reply-To: <20061101113808.53508.qmail@web54514.mail.yahoo.com>
References: <20061101113808.53508.qmail@web54514.mail.yahoo.com>
Message-ID: <454EF09102000056000011AC@co5.dnr.state.mn.us>

Hi George;

The equation you have is the gradient of z in either the x or y
direction (the matrix can also be used to calculate an edge image (Sobal
edge image)).

The equation will give you elevation between postings. However, to
create a shaded relief, you need to calculate the illumination angles.
To do that you first need to find the normal vector to the elevation
surface = tangent at a point. You then need to create a vector from your
point to your light source (the Sun?). The angle between these two
vectors is the zenith angle. A brightness value can then be calculated
using B = Acos(zenith_angle). Where A is just a scalar to get your
brightness in the range you want.

You could use the gradient equation to find the tangent vector in the x
direction and the tangent vector in the y direction and then cross the
two vectors to get the normal vector at that point.

Usually a shaded relief is just a qualitative thing, so a good
approximation is just to create two vectors between one positing (the
posting of interest) and the next posting in the x direction and the
next posting in the y direction. If you then cross these two vectors,
you get the approximate normal at the posting of interest.

Chuck

=====================================
Charles Wivell
MN DNR Forestry/Resource Assessment
413 SE 13th Street
Grand Rapids, MN 55744
218-327-4449 x 233
=====================================

>>> odhiambo george <odhiambogeorge@yahoo.com> 11/1/2006 5:38 AM >>>
Dear Sir,
   
  I'm trying to write a MATLAB program for calculating or creating
shaded relief from a DEM. I have come across the equation attached to
this e-mail which i believe represents calculation of the cell values
heights.
   
  What I don't undersyand is how to handle the DEM, for example, how do
I use the DEM together with the equation  ?
   
  Kindly assist by shedding some light on the procedure used
   
  Kind regards,
  George

 
---------------------------------
Access over 1 million songs - Yahoo! Music Unlimited Try it today.

From yjacolin at free.fr  Mon Nov  6 09:59:33 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
Message-ID: <200611061559.33992.yjacolin@free.fr>

Hi,

I tried to export raster data from GRASS to GTiff with r.out.gdal, I get this 
error message :
GRASS 6.2.0RC1 (Lambert2Nord):~ > r.out.gdal input=C03r type=Byte 
output=C03.tiff
Writing format: GTiff
Writing type:   Byte
Input file size is 2159, 1574
0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
...10...20...30...40...50...60...70...80...90...100 - done.
/usr/local/grass-6.2.0RC1/scripts/r.out.gdal: line 136: 25674 Erreur de 
segmentation  gdal_translate -of $FORMAT -ot $TYPE $CREATEKEY $METAKEY 
$CELLHD $OUTPUT

I posted a message in the grass list but I got no answer. Have you got any 
ideas ? Thank you.

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org

From cplist at earthlink.net  Mon Nov  6 10:15:43 2006
From: cplist at earthlink.net (Charlton Purvis)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] geod: azimuth to degrees
In-Reply-To: <454BE59B.6050501@email.unc.edu>
Message-ID: <014301c701b6$6e1cb800$0300a8c1@latitude>

Hey, Jesse:

> I think you've already got what you need?  Geod outputs an azimuth, then
> a back azimuth, followed by distance.  The two azimuths are different

Yes, it was an i d 10 t error, for sure.  Even though I poured over the man
page over and over again, I thought the 1st two #'s were part of a lon,lat
pair.  So the rest of the time I just spent slamming my head against the
wall.

> I've been using the perl Math::Trig module to do something similar and
> it works pretty well so far.  Might give geod a try to compare my
> results now though...

I'm good to go now!  I had been using PostGIS's azimuth w/ great results and
I wanted to avoid calling the db for each of these computations.  I, too,
have noticed very small % differences among the results, but they are well
w/i our tolerance.

Thanks, all!

Charlton



From warmerdam at pobox.com  Mon Nov  6 10:17:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal_merge.py resample method
In-Reply-To: <ddc797c30611060208r3767ac9cqd7168730da10a1d@mail.gmail.com>
References: <ddc797c30611060208r3767ac9cqd7168730da10a1d@mail.gmail.com>
Message-ID: <454F5225.5080307@pobox.com>

guillaume huby wrote:
> Hello,
> 
> I'm using FWTools 1.6.0
> 
> I wondered about resample method used in gdal_merge.py when different 
> resolution are in inputs images.
> 
> In the script I found the following documentation :
> "However,
>         if the destination file is a different resolution, or different
>         image pixel type, the appropriate resampling and conversions will
>         be done (using normal GDAL promotion/demotion rules)."
> 
> Is the rule nearest neighbour, bilinear or some other resample method ?
> 
> Thanks in advance for replies.

Guillame,

Perhaps you meant FWTools 1.0.6?

In any event, gdal_merge.py uses nearest neighbour resampling.  If you
want control over the resampling used, you should use gdalwarp instead.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Nov  6 10:53:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <200611061559.33992.yjacolin@free.fr>
References: <200611061559.33992.yjacolin@free.fr>
Message-ID: <454F5A78.2090505@pobox.com>

Yves Jacolin wrote:
> Hi,
> 
> I tried to export raster data from GRASS to GTiff with r.out.gdal, I get this 
> error message :
> GRASS 6.2.0RC1 (Lambert2Nord):~ > r.out.gdal input=C03r type=Byte 
> output=C03.tiff
> Writing format: GTiff
> Writing type:   Byte
> Input file size is 2159, 1574
> 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> ...10...20...30...40...50...60...70...80...90...100 - done.
> /usr/local/grass-6.2.0RC1/scripts/r.out.gdal: line 136: 25674 Erreur de 
> segmentation  gdal_translate -of $FORMAT -ot $TYPE $CREATEKEY $METAKEY 
> $CELLHD $OUTPUT
> 
> I posted a message in the grass list but I got no answer. Have you got any 
> ideas ? Thank you.

Yves,

I would guess that there is a large color table associated with the input
raster and it is overflowing the size of a TIFF tag.  I don't know why
this is resulting in a segmentation fault in r.out.gdal though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From John.C.Cartwright at noaa.gov  Mon Nov  6 11:00:52 2006
From: John.C.Cartwright at noaa.gov (John Cartwright)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal tool for generating statistics on geotiff?
Message-ID: <454F5C34.2010607@noaa.gov>

Hello All,

is there a gdal tool that will allow me to generate statistics (min, 
max, etc.) on the values in a geotiff?

Thanks!

-- john
 

From warmerdam at pobox.com  Mon Nov  6 11:05:34 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdaladdo question
In-Reply-To: <454EE950.1080704@novacell.com>
References: <454EE950.1080704@novacell.com>
Message-ID: <454F5D4E.1030605@pobox.com>

John Novak wrote:
> Is it a Bad Thing to run the same gdaladdo command over a TIFF file more 
> than once ?

John,

It should be harmless.  I believe it will spend quite a bit of time
recomputing the overviews.  In particular, you should not end up with
duplicate overviews in the file, though you might want to use tiffinfo
on the file to verify that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From yjacolin at free.fr  Mon Nov  6 11:01:41 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <454F5A78.2090505@pobox.com>
References: <200611061559.33992.yjacolin@free.fr> <454F5A78.2090505@pobox.com>
Message-ID: <200611061701.41331.yjacolin@free.fr>

Le Lundi 6 Novembre 2006 16:53, Frank Warmerdam a ?crit?:
> Yves Jacolin wrote:
> > Hi,
> >
> > I tried to export raster data from GRASS to GTiff with r.out.gdal, I get
> > this error message :
> > GRASS 6.2.0RC1 (Lambert2Nord):~ > r.out.gdal input=C03r type=Byte
> > output=C03.tiff
> > Writing format: GTiff
> > Writing type:   Byte
> > Input file size is 2159, 1574
> > 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> > ...10...20...30...40...50...60...70...80...90...100 - done.
> > /usr/local/grass-6.2.0RC1/scripts/r.out.gdal: line 136: 25674 Erreur de
> > segmentation  gdal_translate -of $FORMAT -ot $TYPE $CREATEKEY $METAKEY
> > $CELLHD $OUTPUT
> >
> > I posted a message in the grass list but I got no answer. Have you got
> > any ideas ? Thank you.
>
> Yves,
>
> I would guess that there is a large color table associated with the input
> raster and it is overflowing the size of a TIFF tag.  I don't know why
> this is resulting in a segmentation fault in r.out.gdal though.
>
> Best regards,
Thank you Frank,

The files are really created but the color are not good ! You are right.
Do you think if I change the color table in GRASS, I can sucess to export 
them ? The raster came from tif files extracted from PDF files and 
georeferenced inside GRASS.

Thank you,

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From warmerdam at pobox.com  Mon Nov  6 11:34:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal tool for generating statistics on geotiff?
In-Reply-To: <454F5C34.2010607@noaa.gov>
References: <454F5C34.2010607@noaa.gov>
Message-ID: <454F6423.20301@pobox.com>

John Cartwright wrote:
> Hello All,
> 
> is there a gdal tool that will allow me to generate statistics (min, 
> max, etc.) on the values in a geotiff?

John,

The -stats option to gdalinfo should report stuff like the following:

Band 1 Block=512x16 Type=Byte, ColorInterp=Gray
   Minimum=0.000, Maximum=255.000, Mean=104.135, StdDev=58.308
   Metadata:
     STATISTICS_MINIMUM=0
     STATISTICS_MAXIMUM=255
     STATISTICS_MEAN=104.13526916504
     STATISTICS_STDDEV=58.308455229198

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Nov  6 12:03:00 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <200611061701.41331.yjacolin@free.fr>
References: <200611061559.33992.yjacolin@free.fr> <454F5A78.2090505@pobox.com>
	<200611061701.41331.yjacolin@free.fr>
Message-ID: <454F6AC4.8090006@pobox.com>

Yves Jacolin wrote:
> The files are really created but the color are not good ! You are right.
> Do you think if I change the color table in GRASS, I can sucess to export 
> them ? The raster came from tif files extracted from PDF files and 
> georeferenced inside GRASS.

Yves,

I think r.out.gdal writes out color rules metadata (which is overflowing),
but I think these color rules metadata items are only used by QGIS.  I don't
know if r.out.gdal is also attempting to write a color table or not.  I also
don't know if the data is 8bit or not.  So it is hard for me to say.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From yjacolin at free.fr  Mon Nov  6 12:35:42 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <454F6AC4.8090006@pobox.com>
References: <200611061559.33992.yjacolin@free.fr>
	<200611061701.41331.yjacolin@free.fr> <454F6AC4.8090006@pobox.com>
Message-ID: <200611061835.42916.yjacolin@free.fr>

Le Lundi 6 Novembre 2006 18:03, Frank Warmerdam a ?crit?:
> Yves Jacolin wrote:
> > The files are really created but the color are not good ! You are right.
> > Do you think if I change the color table in GRASS, I can sucess to export
> > them ? The raster came from tif files extracted from PDF files and
> > georeferenced inside GRASS.
>
> Yves,
>
> I think r.out.gdal writes out color rules metadata (which is overflowing),
> but I think these color rules metadata items are only used by QGIS.  I
> don't know if r.out.gdal is also attempting to write a color table or not. 
> I also don't know if the data is 8bit or not.  So it is hard for me to say.
>
> Best regards,
Hi,

Thank you for your help. I success to export my raster using r.out.tiff.

Regards,

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From neteler at itc.it  Mon Nov  6 13:45:06 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <200611061701.41331.yjacolin@free.fr>
References: <200611061559.33992.yjacolin@free.fr> <454F5A78.2090505@pobox.com>
	<200611061701.41331.yjacolin@free.fr>
Message-ID: <20061106184506.GC29514@bartok.itc.it>

On Mon, Nov 06, 2006 at 05:01:41PM +0100, Yves Jacolin wrote:
> Le Lundi 6 Novembre 2006 16:53, Frank Warmerdam a ?crit?:
> > Yves Jacolin wrote:
> > > Hi,
> > >
> > > I tried to export raster data from GRASS to GTiff with r.out.gdal, I get
> > > this error message :
> > > GRASS 6.2.0RC1 (Lambert2Nord):~ > r.out.gdal input=C03r type=Byte
> > > output=C03.tiff
> > > Writing format: GTiff
> > > Writing type:   Byte
> > > Input file size is 2159, 1574
> > > 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in tag.
> > > ...10...20...30...40...50...60...70...80...90...100 - done.
> > > /usr/local/grass-6.2.0RC1/scripts/r.out.gdal: line 136: 25674 Erreur de
> > > segmentation  gdal_translate -of $FORMAT -ot $TYPE $CREATEKEY $METAKEY
> > > $CELLHD $OUTPUT
> > >
> > > I posted a message in the grass list but I got no answer. Have you got
> > > any ideas ? Thank you.
> >
> > Yves,
> >
> > I would guess that there is a large color table associated with the input
> > raster and it is overflowing the size of a TIFF tag.  I don't know why
> > this is resulting in a segmentation fault in r.out.gdal though.
> >
> > Best regards,
> Thank you Frank,
> 
> The files are really created but the color are not good ! You are right.
> Do you think if I change the color table in GRASS, I can sucess to export 
> them ? The raster came from tif files extracted from PDF files and 
> georeferenced inside GRASS.

Another possibility could be that you need to rebuild the
GRASS-GDAL-OGR plugin. Using

ldd `which gdal_translate`
you could check if the right plugin is used.

Markus

From warmerdam at pobox.com  Mon Nov  6 14:02:04 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
Message-ID: <454F86AC.5020003@pobox.com>

GDAL/OGR PSC Members,

I hearby motion for the GDAL/OGR Project to join the OSGeo Project
Sponsorship program described at:

   http://wiki.osgeo.org/index.php/Project_Sponsorship

I am attaching the public web page I would publish describing GDAL/OGR
sponsorship if the motion is adopted.

Voting will be open till 2:00pm EST on Wednesday.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061106/c691780f/sponsorship.html
From sjahputerao at missouri.edu  Mon Nov  6 15:17:02 2006
From: sjahputerao at missouri.edu (Ozy Sjahputera)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Extracting subimage in GDAL
In-Reply-To: <20061106184506.GC29514@bartok.itc.it>
References: <200611061559.33992.yjacolin@free.fr>
	<454F5A78.2090505@pobox.com>	<200611061701.41331.yjacolin@free.fr>
	<20061106184506.GC29514@bartok.itc.it>
Message-ID: <454F983E.6070307@missouri.edu>

Greetings,

I am new to GDAL so I apologize if this topic has been discussed 
before.  I used Google to search for several key words -- like 
"subimage" -- in the list archives.  The only one I found to be close is 
this: http://lists.maptools.org/pipermail/gdal-dev/2004-May/002776.html 
where Frank pointed out the use of GDAL utility gdal_translate() to 
extract sub-images.

I need to extract subimage by specifying the new UL and LR coordinates 
(in UTM).  I understand that gdal_translate with -projwin option can do 
this.  However, I need to do this as a function call within a CPP 
program.  Is there a function in GDAL library that is equivalent to the 
utility gdal_translate?  Or where can I find the source code for 
gdal_translate if I want to learn more about how gdal_translate is 
implemented?

Thanks

Oz





From hobu at iastate.edu  Mon Nov  6 15:30:21 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <454F86AC.5020003@pobox.com>
References: <454F86AC.5020003@pobox.com>
Message-ID: <6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>

+1 on joining the OSGeo Project Sponsorship program.

I hereby move that any disbursements of project sponsorship funds be 
accompanied by a motion to the PSC.

I hereby move that all motions to the PSC be documented on a page on 
the website for historical and accounting reasons and to pluck them 
out of the rigamarole of day-to-day list traffic.

Howard



At 01:02 PM 11/6/2006, Frank Warmerdam wrote:
>GDAL/OGR PSC Members,
>
>I hearby motion for the GDAL/OGR Project to join the OSGeo Project
>Sponsorship program described at:
>
>   http://wiki.osgeo.org/index.php/Project_Sponsorship
>
>I am attaching the public web page I would publish describing GDAL/OGR
>sponsorship if the motion is adopted.
>
>Voting will be open till 2:00pm EST on Wednesday.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>
>
>    * <index.htm>Main Page
>    * <annotated.htm>Classes
>    * <files.htm>Files
>    * <pages.htm>Related Pages
>
>
>Sponsoring GDAL/OGR
>
>
>
>Development and maintenance of GDAL/OGR is supported by 
>organizations contracting developers, organizations contributing 
>improvements, users contributing improvements, and volunteers. 
>Generally speaking this works well, and GDAL/OGR has improved 
>substantially over the years.
>
>However, there are still many tasks which do not receive the 
>attention they should. Processing bug reports, writing 
>documentation, writing test scripts, evaluating test script failures 
>and user support often receive less attention than would be desired. 
>Some new features of broad interest are not implemented because they 
>aren't important enough to any one person or organization.
>
>In order to provide sustained funding to support the maintenance, 
>improvement and promotion of the GDAL/OGR project, the project seeks 
>project sponsors to provide financial support. Sponsorship would be 
>accomplished via the 
><http://wiki.osgeo.org/index.php/Project_Sponsorship>OSGeo Project 
>Sponsorship program. Funds are held by OSGeo for disposition on 
>behalf of the project, and dispersed at the discretion of the 
>GDAL/OGR Project Steering Committee.
>
>Sponsorship Uses
>
>
>
>The primary intended use of the sponsorship funds is to hire a 
>maintainer on a contract basis. The responsibilities would include:
>
>    * Addressing bug reports - reproducing then fixing or passing on 
> to another developer.
>    * Extending, and running the test suite.
>    * Improving documentation.
>    * Other improvements to the software.
>    * General user support on the mailing list.
>
>Sponsorship funds may also be used to contract for specific 
>improvements to GDAL, provision of resources such as web hosting, 
>funding code sprints, or funding project promotion. Decisions on 
>spending of sponsorship funds will be made by the GDAL/OGR Project 
>Steering Committee.
>
>Sponsorship Benefits
>
>
>
>Sponsoring GDAL/OGR provides the following benefits:
>
>    * Ensures the sustainability and health of the GDAL/OGR project.
>    * All sponsors will be listed on the project 
> <credits.htm>Credits page, ordered by contribution class (Platinum, 
> Gold, Silver) with a link back to the sponsor. Silver sponsors and 
> above may include a logo. Platinum sponsors may also have a logo 
> appearing on the OSGeo main page.
>    * Sponsors will be permitted to indicate they are project 
> sponsors in web and other promotional materials, and use the GDAL/OGR logo.
>    * Sponsors will received a degree of priority in processing of 
> bug reports by any maintainer hired with sponsorship funds.
>    * Sponsors will receive a detailed report annually on the use of 
> sponsorship funds.
>
>
>Sponsorship Process
>
>
>
>Sponsors can sponsor GDAL for any amount of money of at least $500 
>USD. At or above the following levels a sponsor will be designated 
>as being one of the following class:
>
>    * $27000+ USD: Platinum Sponsor
>    * $9000+ USD: Gold Sponsor
>    * $3000+ USD: Silver Sponsor
>
>Sponsorships last one year, after which they may be continuing with 
>a new payment, or allowed to lapse. OSGeo is a US 501(c)3 charity 
>and sponsorships are eligible as a charitable contribution for US 
>taxpayers. Appropriate receipts can be issued when needed.
>
>Organizations or individuals interested in sponsoring the GDAL/OGR 
>project should contact Frank Warmerdam 
>(<mailto:warmerdam@pobox.com>warmerdam@pobox.com) with questions, or 
>to make arrangements.
>
>$Id: credits.dox,v 1.8 2006/10/17 22:30:22 mloskot Exp $
>
>----------
>Generated for GDAL by <http://www.doxygen.org/index.html>
>doxygen
> 1.4.6.
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From dmorissette at mapgears.com  Mon Nov  6 15:52:43 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <454F86AC.5020003@pobox.com>
References: <454F86AC.5020003@pobox.com>
Message-ID: <454FA09B.5020004@mapgears.com>

Frank Warmerdam wrote:
> GDAL/OGR PSC Members,
> 
> I hearby motion for the GDAL/OGR Project to join the OSGeo Project
> Sponsorship program described at:
> 
>   http://wiki.osgeo.org/index.php/Project_Sponsorship
> 
> I am attaching the public web page I would publish describing GDAL/OGR
> sponsorship if the motion is adopted.
> 
> Voting will be open till 2:00pm EST on Wednesday.
> 


I vote -0.

I am not completely objected to the idea and won't veto it, but I am a 
bit worried about the impact that having to manage sponsorship money can 
have on the PSC members. I have already explained my point of view on 
this whole sponsorship idea on the mapserver-dev list so I won't repeat 
it here. The thread can be found in the mapserver-dev archives at:
http://www.nabble.com/Re%3A-Fwd%3A--OSGeo-Discuss--Project-Sponsorship-Proposal-%28call-for-feedback%29-p6104462.html

I realize that the GDAL situation is a bit different since Frank has 
been funding people to do maintenance work on GDAL in the past and the 
hope is probably that sponsorship money can pay for that kind of support 
in the future (which would make complete sense). However, as GDAL grows 
from a benevolent-dictatorship to a PSC-driven project the concerns that 
I expressed about sponsorship vs MapServer will also apply to GDAL.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From warmerdam at pobox.com  Mon Nov  6 15:53:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>
References: <454F86AC.5020003@pobox.com>
	<6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>
Message-ID: <454FA0DC.3090704@pobox.com>

Howard Butler wrote:
> +1 on joining the OSGeo Project Sponsorship program.

Howard,

Thanks

> I hereby move that any disbursements of project sponsorship funds be 
> accompanied by a motion to the PSC.

I had assumed this as the meaning of decisions on dispersements having
to be made by the PSC.  I meant for this to be via an official motion to the
list.  This is also covered in the project sponsorship proposal with the
line "To pass well documented motions for any expenditure of funds from
the project sponsorship fund."

> I hereby move that all motions to the PSC be documented on a page on the 
> website for historical and accounting reasons and to pluck them out of 
> the rigamarole of day-to-day list traffic.

I'd rule this motion out of order because it doesn't comply with it's own
requirement to be documented on a web page.  But instead, I have created
said page.

  gdal/rfc/psc_motions.dox

Appearing on the web as:

  http://www.gdal.org/psc_motions.html

So, lets put any motions we consider worth remembering in there.  If you want
your motion to be official, then add it there, and update it after the two
day voting period.   I do think that real motions to the mailing list ought
to be issued as their own thread prefixed with Motion:

I'm +0 on your motion.  I basically think the idea is good, but that it
would be sufficient to document this at some future date in an RFC 1
revision.  For now we can just make your suggestion part of our approach
without it being officially mandated.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Nov  6 15:56:29 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Extracting subimage in GDAL
In-Reply-To: <454F983E.6070307@missouri.edu>
References: <200611061559.33992.yjacolin@free.fr>	<454F5A78.2090505@pobox.com>	<200611061701.41331.yjacolin@free.fr>	<20061106184506.GC29514@bartok.itc.it>
	<454F983E.6070307@missouri.edu>
Message-ID: <454FA17D.7000805@pobox.com>

Ozy Sjahputera wrote:
> Greetings,
> 
> I am new to GDAL so I apologize if this topic has been discussed 
> before.  I used Google to search for several key words -- like 
> "subimage" -- in the list archives.  The only one I found to be close is 
> this: http://lists.maptools.org/pipermail/gdal-dev/2004-May/002776.html 
> where Frank pointed out the use of GDAL utility gdal_translate() to 
> extract sub-images.
> 
> I need to extract subimage by specifying the new UL and LR coordinates 
> (in UTM).  I understand that gdal_translate with -projwin option can do 
> this.  However, I need to do this as a function call within a CPP 
> program.  Is there a function in GDAL library that is equivalent to the 
> utility gdal_translate?  

Ozy,

No.  But if you know the source window in pixel/line coordinates you
can load it into a buffer with the GDALRasterBand::RasterIO() method
or the GDALDataset::RasterIO() method.

> Or where can I find the source code for 
> gdal_translate if I want to learn more about how gdal_translate is 
> implemented?

The gdal_translate source can be found in gdal/apps/gdal_translate.c
or on the web:
   http://www.gdal.org/srctree/apps/gdal_translate.c

The pertinent portion for -projwin is:

/* -------------------------------------------------------------------- */
/*      Compute the source window from the projected source window      */
/*      if the projected coordinates were provided.  Note that the      */
/*      projected coordinates are in ulx, uly, lrx, lry format,         */
/*      while the anSrcWin is xoff, yoff, xsize, ysize with the         */
/*      xoff,yoff being the ulx, uly in pixel/line.                     */
/* -------------------------------------------------------------------- */
     if( dfULX != 0.0 || dfULY != 0.0
         || dfLRX != 0.0 || dfLRY != 0.0 )
     {
         double	adfGeoTransform[6];

         GDALGetGeoTransform( hDataset, adfGeoTransform );

         if( adfGeoTransform[2] != 0.0 || adfGeoTransform[4] != 0.0 )
         {
             fprintf( stderr,
                      "The -projwin option was used, but the geotransform is\n"
                      "rotated.  This configuration is not supported.\n" );
             GDALClose( hDataset );
             CPLFree( panBandList );
             GDALDestroyDriverManager();
             exit( 1 );
         }

         anSrcWin[0] = (int)
             ((dfULX - adfGeoTransform[0]) / adfGeoTransform[1] + 0.001);
         anSrcWin[1] = (int)
             ((dfULY - adfGeoTransform[3]) / adfGeoTransform[5] + 0.001);

         anSrcWin[2] = (int) ((dfLRX - dfULX) / adfGeoTransform[1] + 0.5);
         anSrcWin[3] = (int) ((dfLRY - dfULY) / adfGeoTransform[5] + 0.5);

         if( !bQuiet )
             fprintf( stdout,
                      "Computed -srcwin %d %d %d %d from projected window.\n",
                      anSrcWin[0],
                      anSrcWin[1],
                      anSrcWin[2],
                      anSrcWin[3] );

         if( anSrcWin[0] < 0 || anSrcWin[1] < 0
             || anSrcWin[0] + anSrcWin[2] > GDALGetRasterXSize(hDataset)
             || anSrcWin[1] + anSrcWin[3] > GDALGetRasterYSize(hDataset) )
         {
             fprintf( stderr,
                      "Computed -srcwin falls outside raster size of %dx%d.\n",
                      GDALGetRasterXSize(hDataset),
                      GDALGetRasterYSize(hDataset) );
             exit( 1 );
         }
     }


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From hobu at iastate.edu  Mon Nov  6 16:36:34 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <454FA09B.5020004@mapgears.com>
References: <454F86AC.5020003@pobox.com>
 <454FA09B.5020004@mapgears.com>
Message-ID: <6.2.3.4.2.20061106151041.031c5250@hobu.mail.iastate.edu>

At 02:52 PM 11/6/2006, Daniel Morissette wrote:
>I vote -0.
>
>I am not completely objected to the idea and won't veto it, but I am 
>a bit worried about the impact that having to manage sponsorship 
>money can have on the PSC members. I have already explained my point 
>of view on this whole sponsorship idea on the mapserver-dev list so 
>I won't repeat it here. The thread can be found in the mapserver-dev 
>archives at:
>http://www.nabble.com/Re%3A-Fwd%3A--OSGeo-Discuss--Project-Sponsorship-Proposal-%28call-for-feedback%29-p6104462.html
>
>I realize that the GDAL situation is a bit different since Frank has 
>been funding people to do maintenance work on GDAL in the past and 
>the hope is probably that sponsorship money can pay for that kind of 
>support in the future (which would make complete sense). However, as 
>GDAL grows from a benevolent-dictatorship to a PSC-driven project 
>the concerns that I expressed about sponsorship vs MapServer will 
>also apply to GDAL.

I myself doubt that the OSGeo project sponsorship program will 
attract the fire hose of funding that Paul Ramsey speaks of, but it 
would be nice to have a garden hose of opportunity available to us.

Fogel makes some great points in his money chapter that you might 
find relevant <http://producingoss.com/html-chunk/money.html> and 
<http://producingoss.com/html-chunk/contracting.html>.  I discussed 
some of these things in my Open Development spiel 
<http://hobu.biz/index_html/open-development>.

Howard 


From mirhassanali at gmail.com  Tue Nov  7 06:08:06 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] How to use SetSpatialFilter()
Message-ID: <b41d86b30611070308i7160e5a0rdf7b88cd498da439@mail.gmail.com>

Hi

I am using the C# wrapper for GDAL in my application. I want to use
SetSpatialFilter() method on a layer. I have an area defined by the
coordinates
<extent>  * *      <type>*area*</type>
 * *      <coord-string>*
393546-377079;393544-377081;393542-377079;393544-377077*</coord-string>
</extent>

I am trying to set this area as spatial filter for the layer by using the
following code

layer.SetSpatialFilter(new Geometry(ogr.wkbGeometryCollection ,
"RECTANGLE(393546 377079 393544 377081 393542 377079 393544 377077)", 0,
null, null));

But doing this does not return the desired result. It returns feature count
as zero, rather than returning the features. Could someone please guide me
how to use this function correctly.
I apologise for asking such a basic question, but I am new to the GIS stuff
so I hope you won't mind.
Any help will be appreciated.

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061107/5baed314/attachment.html
From yjacolin at free.fr  Tue Nov  7 06:42:11 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <20061106184506.GC29514@bartok.itc.it>
References: <200611061559.33992.yjacolin@free.fr>
	<200611061701.41331.yjacolin@free.fr>
	<20061106184506.GC29514@bartok.itc.it>
Message-ID: <200611071242.12040.yjacolin@free.fr>

Le Lundi 6 Novembre 2006 19:45, Markus Neteler a ?crit?:
> On Mon, Nov 06, 2006 at 05:01:41PM +0100, Yves Jacolin wrote:
> > Le Lundi 6 Novembre 2006 16:53, Frank Warmerdam a ?crit?:
> > > Yves Jacolin wrote:
> > > > Hi,
> > > >
> > > > I tried to export raster data from GRASS to GTiff with r.out.gdal, I
> > > > get this error message :
> > > > GRASS 6.2.0RC1 (Lambert2Nord):~ > r.out.gdal input=C03r type=Byte
> > > > output=C03.tiff
> > > > Writing format: GTiff
> > > > Writing type:   Byte
> > > > Input file size is 2159, 1574
> > > > 0Warning 1: Lost metadata writing to GeoTIFF ... too large to fit in
> > > > tag. ...10...20...30...40...50...60...70...80...90...100 - done.
> > > > /usr/local/grass-6.2.0RC1/scripts/r.out.gdal: line 136: 25674 Erreur
> > > > de segmentation  gdal_translate -of $FORMAT -ot $TYPE $CREATEKEY
> > > > $METAKEY $CELLHD $OUTPUT
> > > >
> > > > I posted a message in the grass list but I got no answer. Have you
> > > > got any ideas ? Thank you.
> > >
> > > Yves,
> > >
> > > I would guess that there is a large color table associated with the
> > > input raster and it is overflowing the size of a TIFF tag.  I don't
> > > know why this is resulting in a segmentation fault in r.out.gdal
> > > though.
> > >
> > > Best regards,
> >
> > Thank you Frank,
> >
> > The files are really created but the color are not good ! You are right.
> > Do you think if I change the color table in GRASS, I can sucess to export
> > them ? The raster came from tif files extracted from PDF files and
> > georeferenced inside GRASS.
>
> Another possibility could be that you need to rebuild the
> GRASS-GDAL-OGR plugin. Using
>
> ldd `which gdal_translate`
> you could check if the right plugin is used.
>
> Markus

Thanks Markus,

I did what you suggested  to do yesterday. I get this (I don't understand what 
it means) :
	linux-gate.so.1 =>  (0xffffe000)
	libgdal.so.1 => /usr/local/lib/libgdal.so.1 (0xb7ac4000)
	libpthread.so.0 => /lib/tls/libpthread.so.0 (0xb7ab1000)
	libogdi31.so => /usr/local/lib/libogdi31.so (0xb7a93000)
	libungif.so.4 => /usr/lib/libungif.so.4 (0xb7a8b000)
	libgeotiff.so.1.2.2 => /usr/lib/libgeotiff.so.1.2.2 (0xb78bb000)
	libtiff.so.3 => /usr/lib/libtiff.so.3 (0xb786b000)
	libpng.so.3 => /usr/lib/libpng.so.3 (0xb7845000)
	libpq.so.4 => /usr/lib/libpq.so.4 (0xb7828000)
	libz.so.1 => /lib/libz.so.1 (0xb7815000)
	librt.so.1 => /lib/tls/librt.so.1 (0xb780c000)
	libdl.so.2 => /lib/libdl.so.2 (0xb7808000)
	libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0xb772c000)
	libm.so.6 => /lib/tls/libm.so.6 (0xb7707000)
	libgcc_s.so.1 => /lib/libgcc_s.so.1 (0xb76fb000)
	libc.so.6 => /lib/tls/libc.so.6 (0xb75c9000)
	libgeos.so.2 => /usr/local/lib/libgeos.so.2 (0xb74d0000)
	libodbc.so.1 => /usr/lib/libodbc.so.1 (0xb7467000)
	libNCSEcw.so.0 => /usr/local/lib/libNCSEcw.so.0 (0xb7334000)
	libNCSCnet.so.0 => /usr/local/lib/libNCSCnet.so.0 (0xb731f000)
	libNCSUtil.so.0 => /usr/local/lib/libNCSUtil.so.0 (0xb72fe000)
	libjasper-1.701.so.1 => /usr/lib/libjasper-1.701.so.1 (0xb72b2000)
	libjpeg.so.62 => /usr/lib/libjpeg.so.62 (0xb7292000)
	/lib/ld-linux.so.2 (0xb7fdf000)
	libexpat.so.0 => /usr/lib/libexpat.so.0 (0xb7272000)
	libproj.so.0 => /usr/local/lib/libproj.so.0 (0xb723d000)
	libSM.so.6 => /usr/X11R6/lib/libSM.so.6 (0xb7234000)
	libICE.so.6 => /usr/X11R6/lib/libICE.so.6 (0xb721c000)
	libX11.so.6 => /usr/X11R6/lib/libX11.so.6 (0xb7150000)
	libssl.so.0.9.7 => /usr/lib/libssl.so.0.9.7 (0xb711f000)
	libcrypto.so.0.9.7 => /usr/lib/libcrypto.so.0.9.7 (0xb7014000)
	libcrypt.so.1 => /lib/libcrypt.so.1 (0xb6fe6000)
	libresolv.so.2 => /lib/libresolv.so.2 (0xb6fd4000)
	libnsl.so.1 => /lib/libnsl.so.1 (0xb6fc0000)

Is it correct ? Is it normal that gdal-grass doesn't appear ?

Y.
PS : is it the right list to post this problem ?
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From mateusz at loskot.net  Tue Nov  7 07:45:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL building for Windows CE
In-Reply-To: <20061107100701.94464.qmail@web52207.mail.yahoo.com>
References: <20061107100701.94464.qmail@web52207.mail.yahoo.com>
Message-ID: <45507FE2.8060203@loskot.net>

kiruba nantham wrote:
> Yes first i was trying to build gdal-1.3.2. but now i tried with
> GDAL from CVS too, still i am getting same error (fatal error 
> c1083:cannot open include file stdio.h:nosuch file or directory).

First, the stdio.h file comes from Windows CE/Mobile SDK,
so check if you have SDK installed and if INCLUDE and LIB paths are
configured and accessible from command line.
On my box, I have Visual C++ 2005 with Windows Mobile 5.0 SDK and this
file is here:

"C:\Program Files\Windows CE Tools\wce500\Windows Mobile 5.0 Pocket PC
SDK\Include\Armv4i\stdio.h"

I have not instaled eVC++ 4.0 so I can't check it at the moment.
I'll try to install this compiler during the weekend and see what happen.

Second, I don't know where stdio.h file can not be included, in what
file, because I couldn't open the build log you attached.
Please, next time use portable format like plain TXT or HTML,
so it's easier to open it with text editor but not with Microsoft
Office. Thanks!

> I am following exactly same as you said to build the GDAL for Windows
> CE at wince.html ("Building GDAL port using eVC++ and makefiles") but
> still i am getting this error.


> Workspace of  GDAL from
> CVS(evc4_gdalce_dll.vcw)  is not opening in *Embedded c++ 4.0 *at
> all.

Hmm, that's strange.
What errors you get?
I suppose there may be a problem with end-of-line characters, LF instead
of CRLF.
Try to convert EOL in all .vcp and .vcw files and see if it works.

As I said, I am not able to check it with eVC++ 4.0 now.
I'll do it in the weekend.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Nov  7 07:48:06 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL building for Windows CE
In-Reply-To: <20061107100701.94464.qmail@web52207.mail.yahoo.com>
References: <20061107100701.94464.qmail@web52207.mail.yahoo.com>
Message-ID: <45508086.5060802@loskot.net>

kiruba,

One note, as I see there have been some changes applied to the GDAL
CVS that made it not building for Windows CE.
I'll fix it tonight and let you know.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From szekerest at gmail.com  Tue Nov  7 08:24:30 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] How to use SetSpatialFilter()
In-Reply-To: <b41d86b30611070308i7160e5a0rdf7b88cd498da439@mail.gmail.com>
References: <b41d86b30611070308i7160e5a0rdf7b88cd498da439@mail.gmail.com>
Message-ID: <f3b73b7d0611070524h3e59a284mb0bc8ce1c2fabdd0@mail.gmail.com>

Hi,

If you would create a geometry from a WKT string you should not
specify the geom type explicitly, like:

Geometry geom = new Geometry(ogr.wkbUnknown, "POINT(47.0 19.2)", 0, null, null);

See the createdata.cs as a working example.


Best Regards,

Tamas Szekeres




2006/11/7, Mir Hassan Ali <mirhassanali@gmail.com>:
> Hi
>
> I am using the C# wrapper for GDAL in my application. I want to use
> SetSpatialFilter() method on a layer. I have an area defined by the
> coordinates
> <extent>
>
>
>        <type> area</type>
>
>        <coord-string>
> 393546-377079;393544-377081;393542-377079;393544-377077</coord-string>
> </extent>
>
> I am trying to set this area as spatial filter for the layer by using the
> following code
>
> layer.SetSpatialFilter(new Geometry(ogr.wkbGeometryCollection ,
> "RECTANGLE(393546 377079 393544 377081 393542 377079 393544 377077)", 0,
> null, null));
>
> But doing this does not return the desired result. It returns feature count
> as zero, rather than returning the features. Could someone please guide me
> how to use this function correctly.
> I apologise for asking such a basic question, but I am new to the GIS stuff
> so I hope you won't mind.
> Any help will be appreciated.
>
> Best Regards
>
> Mir Hassan Ali
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From neteler at itc.it  Tue Nov  7 15:07:22 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <200611071242.12040.yjacolin@free.fr>
References: <200611061559.33992.yjacolin@free.fr>
	<200611061701.41331.yjacolin@free.fr>
	<20061106184506.GC29514@bartok.itc.it>
	<200611071242.12040.yjacolin@free.fr>
Message-ID: <20061107200722.GU916@bartok.itc.it>

On Tue, Nov 07, 2006 at 12:42:11PM +0100, Yves Jacolin wrote:
...
> Is it correct ? Is it normal that gdal-grass doesn't appear ?

Ah, yes, I think that it doesn't appear there since it is loaded
only on demand.

> Y.
> PS : is it the right list to post this problem ?

Hope so :-)

Please have a look at
http://grass.gdf-hannover.de/wiki/Compile_and_install_GRASS_and_QGIS_with_GDAL/OGR_Plugin#Troubleshooting

Markus

From matt.pettis at thomson.com  Tue Nov  7 17:26:57 2006
From: matt.pettis at thomson.com (matt.pettis@thomson.com)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Calculating Polyline lengths in a file
Message-ID: <89C159F45B13A24682D98BDEF58E451F08C108@TLRUSMNEAGMBX28.ERF.THOMSON.COM>

Is there an easy way to calculate the lengths of polyline objects in a shapefile (i have a shapefile of roads for a county, and want to find the total length)?  Is there an OGR tool to do this, or does anybody know of another tool?
 
I have done this halfway a hard way... I imported my file into PostgreSQL/PostGIS, and applied length2d to it, and got a number.  However, I can't find documentation for what the units of the result are in.  Does anybody know the answer to this question as well, as long as I am here?
 
TIA,
Matt


From RMcCulley at county24.com  Tue Nov  7 17:48:39 2006
From: RMcCulley at county24.com (Rob McCulley)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Calculating Polyline lengths in a file
Message-ID: <8563B9D6767C904A912272A2D56548E4096248@vermilion.County24.local>

I needed to do this recently.  I wound up using python mapscript.  Here
is a snippet of the code that did it for me:

shpfile = mapscript.shapefileObj(gpsfilelocation)
totalLength = 0
for i in range(shpfile.numshapes):
    shp = shpfile.getShape(i)
    length = shp.getLength()
    totalLength = totalLength + length




-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of
matt.pettis@thomson.com
Sent: Tuesday, November 07, 2006 3:27 PM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Calculating Polyline lengths in a file

Is there an easy way to calculate the lengths of polyline objects in a
shapefile (i have a shapefile of roads for a county, and want to find
the total length)?  Is there an OGR tool to do this, or does anybody
know of another tool?
 
I have done this halfway a hard way... I imported my file into
PostgreSQL/PostGIS, and applied length2d to it, and got a number.
However, I can't find documentation for what the units of the result are
in.  Does anybody know the answer to this question as well, as long as I
am here?
 
TIA,
Matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.
MailScanner thanks transtec Computers for their support.



From dylan.beaudette at gmail.com  Tue Nov  7 18:17:50 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Calculating Polyline lengths in a file
In-Reply-To: <89C159F45B13A24682D98BDEF58E451F08C108@TLRUSMNEAGMBX28.ERF.THOMSON.COM>
References: <89C159F45B13A24682D98BDEF58E451F08C108@TLRUSMNEAGMBX28.ERF.THOMSON.COM>
Message-ID: <200611071517.51029.dylan.beaudette@gmail.com>

Hi Matt,

the results from most PostGIS operations are in the same units as your 
geometry is in.

On Tuesday 07 November 2006 14:26, matt.pettis@thomson.com wrote:
> Is there an easy way to calculate the lengths of polyline objects in a
> shapefile (i have a shapefile of roads for a county, and want to find the
> total length)?  Is there an OGR tool to do this, or does anybody know of
> another tool?
>
> I have done this halfway a hard way... I imported my file into
> PostgreSQL/PostGIS, and applied length2d to it, and got a number.  However,
> I can't find documentation for what the units of the result are in.  Does
> anybody know the answer to this question as well, as long as I am here?
>
> TIA,
> Matt
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From John.C.Cartwright at noaa.gov  Tue Nov  7 18:38:43 2006
From: John.C.Cartwright at noaa.gov (John Cartwright)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal tool for generating statistics on geotiff?
In-Reply-To: <454F6423.20301@pobox.com>
References: <454F5C34.2010607@noaa.gov> <454F6423.20301@pobox.com>
Message-ID: <45511903.6010908@noaa.gov>

Thanks Frank, that was exactly what I was looking for! 

Out of curiosity, is that option documented anywhere? I didn't see it.

-- john



Frank Warmerdam wrote:
> John Cartwright wrote:
>> Hello All,
>>
>> is there a gdal tool that will allow me to generate statistics (min, 
>> max, etc.) on the values in a geotiff?
>
> John,
>
> The -stats option to gdalinfo should report stuff like the following:
>
> Band 1 Block=512x16 Type=Byte, ColorInterp=Gray
>   Minimum=0.000, Maximum=255.000, Mean=104.135, StdDev=58.308
>   Metadata:
>     STATISTICS_MINIMUM=0
>     STATISTICS_MAXIMUM=255
>     STATISTICS_MEAN=104.13526916504
>     STATISTICS_STDDEV=58.308455229198
>
> Best regards,

From taka_www at sinaman.com  Tue Nov  7 21:01:59 2006
From: taka_www at sinaman.com (taka_www@sinaman.com)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Performance on using Oracle Client XE
Message-ID: <20061108020159.26371.qmail@mysinamail.com>

Dear All
 
I am now studing a project about using mapserver to display map.
In this map, points would be also shown. These points' XY and other info are stored in relational Oracle XE DB. For displaying, these point can be generated in acceptable time. 
 
However, when I retrieve the Points' attributes by grab the point in map. I found that the loading time is quite long. I have tried to add a index in Oracle XE for the XY in the table. It seems indifferent in performance.
 
Are there any smart way to improve the performance? e.g. did fastCGI work? since I am using IIS to run Mapserver. I wonder.
 
Thank you very much.
 
by the way, I think this post should be post on MAPSERVER mail list, and I have tried also, but it always bound my post back. -_-"
 
Regards
Taka 

______________________________________

===================================================================
FU@UAAn^C$8
http://adimages.sina.com.hk/ET_0611a.html
eA Robbie WilliamsiRudeboxj 
http://adimages.sina.com.hk/RB_0611.html
eAm`O:Wrnqv~
http://adimages.sina.com.hk/MV1_0611.html
===================================================================

From mirhassanali at gmail.com  Wed Nov  8 05:01:14 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Using SetSpatialFilter() on MapInfo .tab files
Message-ID: <b41d86b30611080201o1f2d5df9gc7c8e56cdf95bebe@mail.gmail.com>

Hi,

I am trying to set Spatial Filter on a MapInfo tab file (using the C#
wrapper for GDAL). I am working with Projected Coordinate System and want to
set the filter for the point defined by coordinates

393544.0 377079.0

I am using the following code to set the filter

layer.SetSpatialFilter(new Geometry(ogr.wkbUnknown , "POINT(393544.0
377079.0)", 0, null, null));
But after settign the filter I get feature count = 0 whereas it should be 2
for the particular point.
I am getting this pair of coordinates from a LLPG(Local land and property
gazetteer). Do I need to transform these coordinates in some way before
setting the filter or is there something else I am doing wrong?
Please will someone guide me regarding this problem.

Thanks and Kind Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061108/23c7e5a7/attachment.html
From szekerest at gmail.com  Wed Nov  8 06:00:12 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Using SetSpatialFilter() on MapInfo .tab files
In-Reply-To: <b41d86b30611080201o1f2d5df9gc7c8e56cdf95bebe@mail.gmail.com>
References: <b41d86b30611080201o1f2d5df9gc7c8e56cdf95bebe@mail.gmail.com>
Message-ID: <f3b73b7d0611080300j10dcc07cu23e5a27dea15ba@mail.gmail.com>

AFAIK you should set a rectangle area as a spatial filter, and you
will get the features falling onto this area.

Tamas


2006/11/8, Mir Hassan Ali <mirhassanali@gmail.com>:
> Hi,
>
> I am trying to set Spatial Filter on a MapInfo tab file (using the C#
> wrapper for GDAL). I am working with Projected Coordinate System and want to
> set the filter for the point defined by coordinates
>
> 393544.0 377079.0
>
> I am using the following code to set the filter
>
>
> layer.SetSpatialFilter(new Geometry(ogr.wkbUnknown , "POINT(393544.0
> 377079.0)", 0, null , null));
> But after settign the filter I get feature count = 0 whereas it should be 2
> for the particular point.
> I am getting this pair of coordinates from a LLPG(Local land and property
> gazetteer). Do I need to transform these coordinates in some way before
> setting the filter or is there something else I am doing wrong?
> Please will someone guide me regarding this problem.
>
> Thanks and Kind Regards
>
> Mir Hassan Ali
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From yjacolin at free.fr  Wed Nov  8 05:38:15 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <20061107200722.GU916@bartok.itc.it>
References: <200611061559.33992.yjacolin@free.fr>
	<200611071242.12040.yjacolin@free.fr>
	<20061107200722.GU916@bartok.itc.it>
Message-ID: <200611081138.15876.yjacolin@free.fr>

Le Mardi 7 Novembre 2006 21:07, Markus Neteler a ?crit?:
> On Tue, Nov 07, 2006 at 12:42:11PM +0100, Yves Jacolin wrote:
> ...
>
> > Is it correct ? Is it normal that gdal-grass doesn't appear ?
>
> Ah, yes, I think that it doesn't appear there since it is loaded
> only on demand.
>
> > Y.
> > PS : is it the right list to post this problem ?
>
> Hope so :-)
>
> Please have a look at
> http://grass.gdf-hannover.de/wiki/Compile_and_install_GRASS_and_QGIS_with_G
>DAL/OGR_Plugin#Troubleshooting
>
> Markus
Hi,

All seems fine! BTW I found another way to export my raster. Thank you very 
much for your help.

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From warmerdam at pobox.com  Wed Nov  8 10:58:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Using SetSpatialFilter() on MapInfo .tab files
In-Reply-To: <b41d86b30611080201o1f2d5df9gc7c8e56cdf95bebe@mail.gmail.com>
References: <b41d86b30611080201o1f2d5df9gc7c8e56cdf95bebe@mail.gmail.com>
Message-ID: <4551FE94.4070606@pobox.com>

Mir Hassan Ali wrote:
> layer.SetSpatialFilter(
> 
> new Geometry(ogr.wkbUnknown , "POINT(393544.0 377079.0)", 0, null , null));
> But after settign the filter I get feature count = 0 whereas it should 
> be 2 for the particular point.
> I am getting this pair of coordinates from a LLPG(Local land and 
> property gazetteer). Do I need to transform these coordinates in some 
> way before setting the filter or is there something else I am doing wrong?
> Please will someone guide me regarding this problem.

Mir,

I think Tamas has already addressed some particulars of how to create the
geometry.  I just wanted to mention that:

  o SetSpatialFilter geometries need to be in the same coordinate system as
    the layer to work properly.  Internally OGR does not checking on this,
    and will just assume they match.  So as long as the above coordinates
    match the coordinate system of the layer (compare to the layer geometries
    with ogrinfo) you should be ok.

  o Most of the time OGR just uses an MBR of the geometry you give it for
    spatial filtering purposes, but when GEOS is enabled it will also do
    an extra intersection test with geometries that are not obvious
    rectangles (simple five vertex closed polygons).  So you using
    non-rectangular polygons as the filter can result in quite a bit of extra
    computation expense in some scenarios.  I see that SetSpatialFilterRect()
    is exposed in C#, and so you should use that most of the time.  For a point
    just set the minx=maxx=x, miny=maxy=y.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From matt.pettis at thomson.com  Wed Nov  8 11:14:02 2006
From: matt.pettis at thomson.com (matt.pettis@thomson.com)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Calculating Polyline lengths in a file
References: <8563B9D6767C904A912272A2D56548E4096248@vermilion.County24.local>
Message-ID: <89C159F45B13A24682D98BDEF58E451F08C111@TLRUSMNEAGMBX28.ERF.THOMSON.COM>

I also received an email about determining units of the output by the SRS... as I am a newbie, can anyone point me to how I use the SRS (I assume it can be gleaned, or is the sum total of what is in the .prj file) to get my units?
 
tia,
matt

________________________________

From: gdal-dev-bounces@lists.maptools.org on behalf of Rob McCulley
Sent: Tue 11/7/2006 4:48 PM
To: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] Calculating Polyline lengths in a file



I needed to do this recently.  I wound up using python mapscript.  Here
is a snippet of the code that did it for me:

shpfile = mapscript.shapefileObj(gpsfilelocation)
totalLength = 0
for i in range(shpfile.numshapes):
    shp = shpfile.getShape(i)
    length = shp.getLength()
    totalLength = totalLength + length




-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of
matt.pettis@thomson.com
Sent: Tuesday, November 07, 2006 3:27 PM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Calculating Polyline lengths in a file

Is there an easy way to calculate the lengths of polyline objects in a
shapefile (i have a shapefile of roads for a county, and want to find
the total length)?  Is there an OGR tool to do this, or does anybody
know of another tool?

I have done this halfway a hard way... I imported my file into
PostgreSQL/PostGIS, and applied length2d to it, and got a number.
However, I can't find documentation for what the units of the result are
in.  Does anybody know the answer to this question as well, as long as I
am here?

TIA,
Matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

--
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.
MailScanner thanks transtec Computers for their support.


_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev




From warmerdam at pobox.com  Wed Nov  8 11:33:33 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal tool for generating statistics on geotiff?
In-Reply-To: <45511903.6010908@noaa.gov>
References: <454F5C34.2010607@noaa.gov> <454F6423.20301@pobox.com>
	<45511903.6010908@noaa.gov>
Message-ID: <455206DD.9070807@pobox.com>

John Cartwright wrote:
> Thanks Frank, that was exactly what I was looking for!
> Out of curiosity, is that option documented anywhere? I didn't see it.

John,

No, it's top secret.

Seriously, I hacked it in to test the underlying statistics support and
at the time didn't think of it as being of much interest.  But I will
document it now.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dylan.beaudette at gmail.com  Wed Nov  8 12:08:37 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <200611081138.15876.yjacolin@free.fr>
References: <200611061559.33992.yjacolin@free.fr>
	<20061107200722.GU916@bartok.itc.it>
	<200611081138.15876.yjacolin@free.fr>
Message-ID: <200611080908.37962.dylan.beaudette@gmail.com>

On Wednesday 08 November 2006 02:38, Yves Jacolin wrote:
> Le Mardi 7 Novembre 2006 21:07, Markus Neteler a ?crit?:
> > On Tue, Nov 07, 2006 at 12:42:11PM +0100, Yves Jacolin wrote:
> > ...
> >
> > > Is it correct ? Is it normal that gdal-grass doesn't appear ?
> >
> > Ah, yes, I think that it doesn't appear there since it is loaded
> > only on demand.
> >
> > > Y.
> > > PS : is it the right list to post this problem ?
> >
> > Hope so :-)
> >
> > Please have a look at
> > http://grass.gdf-hannover.de/wiki/Compile_and_install_GRASS_and_QGIS_with
> >_G DAL/OGR_Plugin#Troubleshooting
> >
> > Markus
>
> Hi,
>
> All seems fine! BTW I found another way to export my raster. Thank you very
> much for your help.
>
> Y.

Hi,

I have encountered some problems in creating an ESRI-friendly geotiff using 
r.out.gdal directly. Fortunately I was able to use the following to get a 
workable file:

# export to AAIgrid with nodata set to -9999
r.out.arc in=ca_90m_dem_meters out=ca_90m

# convert to geotiff with gdal_translate
gdal_translate -a_srs "+proj=aea +x_0=0.0 +y_0=0 +lon_0=-96 +lat_0=40.0 
+lat_1=20 +lat_2=60.0 +datum=NAD83 +units=m" \
-a_nodata -9999 \
-co INTERLEAVE=PIXEL \
-co TFW=YES \
-co COMPRESS=DEFLATE \
ca_90m ca_90m.tif

I wonder if there is a better way? The main problem lies in the fact that 
r.out.gdal encodes GRASS NULL values as NaN, which doesn't seem to carry over 
to other programs...

Cheers,

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341


From izzybitsie at gmail.com  Wed Nov  8 13:08:09 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal_merge.py / gdalwarp usage issues
Message-ID: <23e208430611081008g2c79c3d8me0fbf13ecd0f77c8@mail.gmail.com>

Hi,

I am new to this area and I have some experience programming on Python.

I tried to use gdalwarp with no much success to compose satellite Geotiff
images so far.  I would like to use it but I can't find explanations on how
to use many of the options.
I wouldn't mind using gdal_merge.py if I can get the correct results.
I need to stitch together satellite images received from various satellites
that have been converted into GeoTiffs. The composite image needs to keep
same resolution of original images.  So, I tried first to use gdal_merge.py,
but since many areas from original tiffs are black, I keep getting portions
of some satellite pictures covered by the black portion of their neighbor
maps.  Besides, the colors in the final image look like very fainted
compared to the original images.

I can't figure out how to solve this two issues neither with gdal_merge.py
nor with gdal_warp.

This is what I used for gdal_merge.py:
gdal_merge.py -o $ofn -v -n 0 AS_*.tif EP_*.tif EU_*.tif US_*.tif IO_*.tif
where $ofn= output file name.  Only one input image per region is available
at any given time.  I used the * to avoid having to write a very long
portion of the map name which includes a date/time stamp.

This is what I used for gdal_warp:
gdalwarp -of GTiff EP_*tif $ofn
gdalwarp -of GTiff US_*tif $ofn
gdalwarp -of GTiff EU_*tif $ofn
gdalwarp -of GTiff IO_*tif $ofn
gdalwarp -of GTiff AS_*tif $ofn

I get errors after the second image is warped.  I did try sizing the output
image using "-tr <out_size>" with no luck
out_size=12000 800 since each image was 2400 800

Does anyone know where I could find examples using all the options for
merge_gdal.py and gdalwarp?  I visited the obvious gdal sites I found while
searching with Google.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061108/be7f1a76/attachment.html
From dylan.beaudette at gmail.com  Wed Nov  8 13:38:17 2006
From: dylan.beaudette at gmail.com (Dylan Beaudette)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL error exporting grass raster to Gtiff
In-Reply-To: <20061108171127.GC8822@bartok.itc.it>
References: <200611061559.33992.yjacolin@free.fr>
	<200611080908.37962.dylan.beaudette@gmail.com>
	<20061108171127.GC8822@bartok.itc.it>
Message-ID: <200611081038.17227.dylan.beaudette@gmail.com>

On Wednesday 08 November 2006 09:11, Markus Neteler wrote:
> On Wed, Nov 08, 2006 at 09:08:37AM -0800, Dylan Beaudette wrote:
> ...
>
> > I wonder if there is a better way? The main problem lies in the fact that
> > r.out.gdal encodes GRASS NULL values as NaN, which doesn't seem to carry
> > over to other programs...
>
> Dylan,
>
> you mean that
>
> GRASS 6.3.cvs (spearfish60):~ > r.out.gdal input=slope format=AAIGrid
> type=Float32 output=slope.arc Writing format: AAIGrid
> Writing type:   Float32
> Input file size is 634, 478
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> GRASS 6.3.cvs (spearfish60):~ > head slope.arc
> ncols        634
> nrows        478
> xllcorner    589980.000000000000
> yllcorner    4913690.000000000000
> cellsize     30.000000000000
> NODATA_value    nan
>     nan    nan    nan    nan
> [...]
>
> should be better a number instead of nan?
>
> Maybe it's a bug in the program since
>
>         if (datatype==GDT_Unknown) {
>                 /* ... determine raster data type from first GRASS raster
> in a group */ maptype = G_raster_map_type(ref.file[0].name,
> ref.file[0].mapset); if (     maptype==FCELL_TYPE) { datatype=GDT_Float32;
> nodataval = -1E37f; } else if (maptype==DCELL_TYPE) { datatype=GDT_Float64;
> nodataval = -1E37f; } else {                          datatype=GDT_Int32;  
> nodataval = (double)(int) 0x80000000; } }
>
> is conditionalized and won't be always picked up?
>
> Markus

Correct. Exporting to GeoTIFF results in the same type of problem. Is that 
source from the new r.out.gdal ?

thanks!

-- 
Dylan Beaudette
Soils and Biogeochemistry Graduate Group
University of California at Davis
530.754.7341

From simboss1 at gmail.com  Wed Nov  8 17:19:10 2006
From: simboss1 at gmail.com (Simone Giannecchini)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Problems building GDAL with .NET 2003
Message-ID: <961f4d9e0611081419m31e6daa0vcc6ddf02c7721c82@mail.gmail.com>

Hi List,
I have built gdal from sources on my xp box many times using nmake
from command line. I am now trying to build it from sources inside
VC++ Net 2003 in order to do some debugging, but I am getting strange
linking errors.

I am following the instructions I found on the Virtual terrain website
but I am getting the following errors:

gdal error LNK2019: unresolved external symbol "public: __thiscall
OGRAVCE00DataSource::OGRAVCE00DataSource(void)"
(??0OGRAVCE00DataSource@@QAE@XZ) referenced in function "public:
virtual class OGRDataSource * __thiscall OGRAVCBinDriver::Open(char
const *,int)" (?Open@OGRAVCBinDriver@@UAEPAVOGRDataSource@@PBDH@Z)
gdal error LNK2019: unresolved external symbol "public: int __thiscall
OGRAVCE00DataSource::Open(char const *,int)"
(?Open@OGRAVCE00DataSource@@QAEHPBDH@Z) referenced in function
"public: virtual class OGRDataSource * __thiscall
OGRAVCBinDriver::Open(char const *,int)"
(?Open@OGRAVCBinDriver@@UAEPAVOGRDataSource@@PBDH@Z)
gdal error LNK2019: unresolved external symbol
_GDALCreateGeoLocTransformer referenced in function
_GDALCreateGenImgProjTransformer
gdal error LNK2019: unresolved external symbol
_GDALDestroyGeoLocTransformer referenced in function
_GDALDestroyGenImgProjTransformer
gdal error LNK2019: unresolved external symbol _GDALGeoLocTransform
referenced in function _GDALGenImgProjTransform


I am sure I am doing something wrong but I have not idea what at the
moment, hence any suggestion is highly appreciated.


Thx,
Simone.
-- 
-------------------------------------------------------
Eng. Simone Giannecchini
President /CEO GeoSolutions

http://www.geo-solutions.it

-------------------------------------------------------

From szekerest at gmail.com  Wed Nov  8 18:11:31 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <454E42FB.2090705@perkins.net>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
	<454E2F9B.8090707@perkins.net> <454E3304.7030003@perkins.net>
	<f3b73b7d0611051157p38aa7f03u4357f61bb52af340@mail.gmail.com>
	<454E42FB.2090705@perkins.net>
Message-ID: <f3b73b7d0611081511w26596d4ev41463901dc473e0@mail.gmail.com>

>
> Right. So, for now, let's leave out the unsafe methods then. At some
> point, I might do some speed comparisons between the IntPtr version and
> the typesafe version. If there's a significant speed penalty (which I
> doubt) then we can revisit the idea of adding optional unsafe/fast methods.
>

Simon,

I've added some of the typesafe overloads so you can make the comparison easily.
I've tested the code with the following sample:


        // Get the width and height of the Dataset
        int width = ds.RasterXSize;
        int height = ds.RasterYSize;

        // Create a Bitmap to store the GDAL image in
        Bitmap bitmap = new Bitmap(width, height, PixelFormat.Format32bppRgb);

        double[] r = new double[width * height];
        double[] g = new double[width * height];
        double[] b = new double[width * height];

        // Get the GDAL Band objects from the Dataset
        Band redBand = ds.GetRasterBand(1);
        Band greenBand = ds.GetRasterBand(2);
        Band blueBand = ds.GetRasterBand(3);

        redBand.ReadRaster(0, 0, width, height, r, width, height, 0, 0);
        greenBand.ReadRaster(0, 0, width, height, g, width, height, 0, 0);
        blueBand.ReadRaster(0, 0, width, height, b, width, height, 0, 0);

        int i, j;
        for (i = 0; i< width; i++)
        {
            for (j=0; j<height; j++)
            {
                Color newColor =
Color.FromArgb(Convert.ToInt32(r[i+j*width]),Convert.ToInt32(g[i+j*width]),
Convert.ToInt32(b[i+j*width]));
                bitmap.SetPixel(i, j, newColor);
            }
        }

        bitmap.Save("Data/myfile1.bmp");


At this point I'm a bit uncertain about the proper handling of the
following types:

GDT_UInt16
GDT_UInt32
GDT_CInt16
GDT_CInt32
GDT_CFloat32
GDT_CFloat64

And also I couldn't ignore a serious bug in the SWIG default
implementation caused access violations and I've made a temporary fix
exclusively for the GDAL C# binding.
However it must be noted that this issue exists for some of the other
bindings like Java as well. It have involved the need of
reimplementing how the SWIG wrapper classes handle the internal C
memory segments.

Did you mean that the buffer offset parameter should be added only to
the IntPtr overloads?


Best Regards,

Tamas

From sy at perkins.net  Wed Nov  8 19:15:18 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] C# Bindings
In-Reply-To: <f3b73b7d0611081511w26596d4ev41463901dc473e0@mail.gmail.com>
References: <454988F5.8050401@perkins.net>
	<f3b73b7d0611031607haea011cx8cd51b6fe1e1786f@mail.gmail.com>
	<454BF899.3030201@perkins.net>
	<f3b73b7d0611041448p79599701sdb9ccd0d355e43ed@mail.gmail.com>
	<454D30CC.4040502@perkins.net>
	<f3b73b7d0611050756j3418c56ejbf26564632544d61@mail.gmail.com>
	<454E2F9B.8090707@perkins.net> <454E3304.7030003@perkins.net>
	<f3b73b7d0611051157p38aa7f03u4357f61bb52af340@mail.gmail.com>
	<454E42FB.2090705@perkins.net>
	<f3b73b7d0611081511w26596d4ev41463901dc473e0@mail.gmail.com>
Message-ID: <1163031318.8923.275362951@webmail.messagingengine.com>


On Thu, 9 Nov 2006 00:11:31 +0100, "Tamas Szekeres"
<szekerest@gmail.com> said:

> I've added some of the typesafe overloads so you can make the comparison
> easily.

Thanks!

> Did you mean that the buffer offset parameter should be added only to
> the IntPtr overloads?

Actually, I think it's most important that the buffer offset parameter
(thinking about it, perhaps "startIndex" would be a better name) is
present in the array versions. For consistency, let's add it to all
versions.

Cheers,

Sy

From vagvince at voila.fr  Thu Nov  9 03:38:34 2006
From: vagvince at voila.fr (vuilleumier vincent)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Problem with geometry
Message-ID: <19363237.1163061514457.JavaMail.www@wwinf4205>

Hi,
I'm making a little GIS application in python using wxPython for the layout. To do this, I need to read the (x, y) of each feature on a layer. With a point's feature I use the GetX and GetY's methods, but I don't know how to do with a polygon's feature or line's feature. For this two features, I need to read the x, y of all the points to draw them back on a canvas. Knows someone the methods to use ?

thanks
Vincent


From neteler at itc.it  Thu Nov  9 08:30:45 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Joining DBF to SHAPE: Unrecognised primary field
Message-ID: <20061109133045.GF15282@bartok.itc.it>

Hi,

I received the CORINE landcover map and want to join text attributes
from a DBF table to the landcover codes in the SHAPE file. Something
goes wrong, however:

# Figure out the column names:
ogrinfo -so 100kmE44N25.shp 100kmE44N25
...
 PROJCS["ETRS_1989_LAEA",
...
 CODE_00: String (3.0)
 AREA_HA: Real (17.5)
 SHAPE_area: Real (19.11)
 SHAPE_len: Real (19.11)

# Check table clc2000legendEEA15355I.DBF
ogrinfo -so clc2000legendEEA15355I.DBF clc2000legendEEA15355I
...
 Layer name: clc2000legendEEA15355I
 Geometry: None
...
 GRID_CODE: String (254.0)
 LEVEL1: String (254.0)
 LEVEL2: String (254.0)
 LEVEL3: String (254.0)
 CLC_CODE: String (254.0)
 LABEL1: String (254.0)
 LABEL2: String (254.0)
 LABEL3: String (254.0)
 RGB: String (254.0)

# The "join" columns are CLC_CODE in both files.

# doing it:
ogr2ogr -sql "SELECT 100kmE44N25.*,clc2000leg.LABEL2 FROM 100kmE44N25 LEFT JOIN \
        '/tmp/clc2000leg.dbf'.clc2000leg ON \
        100kmE44N25.CLC_CODE = clc2000leg.CLC_CODE" \
        100kmE44N25_leg.shp 100kmE44N25.shp

Is the string type a problem? If so, how to work around that?

Thanks
Markus

From warmerdam at pobox.com  Thu Nov  9 09:22:11 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Joining DBF to SHAPE: Unrecognised primary field
In-Reply-To: <20061109133045.GF15282@bartok.itc.it>
References: <20061109133045.GF15282@bartok.itc.it>
Message-ID: <45533993.8070603@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> I received the CORINE landcover map and want to join text attributes
> from a DBF table to the landcover codes in the SHAPE file. Something
> goes wrong, however:
...

# The "join" columns are CLC_CODE in both files.
> 
> # doing it:
> ogr2ogr -sql "SELECT 100kmE44N25.*,clc2000leg.LABEL2 FROM 100kmE44N25 LEFT JOIN \
>         '/tmp/clc2000leg.dbf'.clc2000leg ON \
>         100kmE44N25.CLC_CODE = clc2000leg.CLC_CODE" \
>         100kmE44N25_leg.shp 100kmE44N25.shp
> 
> Is the string type a problem? If so, how to work around that?

Markus,

String fields should work, and your construction looks ok.  I'm not sure
why it isn't working.  Can I download these files to try it myself?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mirhassanali at gmail.com  Thu Nov  9 09:43:36 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Download GEOS
In-Reply-To: <b41d86b30611090633u2be4d730vfe63435be3e71c82@mail.gmail.com>
References: <b41d86b30611090633u2be4d730vfe63435be3e71c82@mail.gmail.com>
Message-ID: <b41d86b30611090643q7914a64enec7eab4d02eaf80f@mail.gmail.com>

 Hi

Can anyone tell me where to dowload the latest GEOS library from. I want to
build it with GDAL. I am trying to download it from
http://geos.refractions.net but my browser does not open the website and
says connection timed out. I think there might be some problem with this
website.

Best Regards
Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061109/fc2205f9/attachment.html
From warmerdam at pobox.com  Thu Nov  9 09:46:37 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Problem with geometry
In-Reply-To: <19363237.1163061514457.JavaMail.www@wwinf4205>
References: <19363237.1163061514457.JavaMail.www@wwinf4205>
Message-ID: <45533F4D.1080006@pobox.com>

vuilleumier vincent wrote:
> Hi, I'm making a little GIS application in python using wxPython for the
> layout. To do this, I need to read the (x, y) of each feature on a layer.
> With a point's feature I use the GetX and GetY's methods, but I don't know
> how to do with a polygon's feature or line's feature. For this two
> features, I need to read the x, y of all the points to draw them back on a
> canvas. Knows someone the methods to use ?

Vincent,

You would use the GetX() and GetY().  These methods include a vertex #.  For
lines you would need to pass this.   You can find how many vertices there are
by calling the Geometry.GetPointCount() method.

For polygons you need to fetch back the ring geometries, and then fetch the
points from them in the same way you would with a line.  You can use the
Geometry.GetGeometryCount() method to find how many geometries there are, and
the Geometry.GetGeometryRef() method to fetch back the rings.

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From wegmann at biozentrum.uni-wuerzburg.de  Thu Nov  9 09:57:58 2006
From: wegmann at biozentrum.uni-wuerzburg.de (Martin Wegmann)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
Message-ID: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>

Hello,

I tried on a fresh debian testing system to install the official gdal 1.3.2 
source code and the cvs code (today), both resulted in the error messages 
below when executing make.

Any hint, how to fix it is appreciated. 

regards, Martin

./configure --with-grass=/usr/local/grass-6.3.cvs/  
[...]
GDAL is now configured for i686-pc-linux-gnu

  Installation directory:    /usr/local
  C compiler:                gcc -O2
  C++ compiler:              g++ -O2

  LIBTOOL support:           yes

  LIBZ support:              external
  GRASS support:             grass57+
  CFITSIO support:           no
  PCRaster support:          internal
  NETCDF support:            no
  LIBPNG support:            internal
  LIBTIFF support:           internal
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  LIBGIF support:            internal
  OGDI support:              no
  HDF4 support:              no
  HDF5 support:              no
  KAKADU support:            no
  JASPER support:            no
  ECW support:               no
  MrSID support:             no
  CURL support (wcs):        no
  POSTGRESQL support:        yes
  MySQL support:             no
  XERCES support:            no
  ODBC support:              no
  PGEO support:              no
  OCI support:               no
  SDE support:               no
  DODS support:              no
  SQLite support:            no
  DWGdirect support          no
  PANORAMA GIS support:      no
  GEOS support:

  Statically link PROJ.4:    no

  Traditional Python:        yes
  NG SWIG Bindings:

  enable OGR building:       yes


#make
[...]

make[2]: Nothing to be done for `install-obj'.
make[2]: Leaving directory 
`/home/baliola/software/gdal_cvs/gdal/frmts/pcraster'
make -C grass install-obj
make[2]: Entering directory `/home/baliola/software/gdal_cvs/gdal/frmts/grass'
/bin/sh /home/baliola/software/gdal_cvs/gdal/libtool --mode=compile 
g++ -Wall  -O2   -I/usr/local/grass-6.3.cvs//include -I/home/baliola/software/gdal_cvs/gdal/port -I/home/baliola/software/gdal_cvs/gdal/gcore -I/home/baliola/software/gdal_cvs/gdal/alg -I/home/baliola/software/gdal_cvs/gdal/ogr -I/home/baliola/software/gdal_cvs/gdal/ogr/ogrsf_frmts -DOGR_ENABLED -I/home/baliola/software/gdal_cvs/gdal/port  -c -o ../o/grass57dataset.o 
grass57dataset.cpp
 
g++ -Wall -O2 -I/usr/local/grass-6.3.cvs//include -I/home/baliola/software/gdal_cvs/gdal/port -I/home/baliola/software/gdal_cvs/gdal/gcore -I/home/baliola/software/gdal_cvs/gdal/alg -I/home/baliola/software/gdal_cvs/gdal/ogr -I/home/baliola/software/gdal_cvs/gdal/ogr/ogrsf_frmts -DOGR_ENABLED -I/home/baliola/software/gdal_cvs/gdal/port -c 
grass57dataset.cpp  -fPIC -DPIC -o ../o/.libs/grass57dataset.o
grass57dataset.cpp: In static member function 'static GDALDataset* 
GRASSDataset::Open(GDALOpenInfo*)':
grass57dataset.cpp:948: error: 'GPJ_grass_to_wkt' was not declared in this 
scope
make[2]: *** [../o/grass57dataset.o] Error 1
make[2]: Leaving directory `/home/baliola/software/gdal_cvs/gdal/frmts/grass'
make[1]: *** [grass-install-obj] Error 2
make[1]: Leaving directory `/home/baliola/software/gdal_cvs/gdal/frmts'
make: *** [frmts-target] Error 2

From yjacolin at free.fr  Thu Nov  9 10:05:39 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
Message-ID: <200611091605.39889.yjacolin@free.fr>

Le Jeudi 9 Novembre 2006 15:57, Martin Wegmann a ?crit?:
> Hello,
>
> I tried on a fresh debian testing system to install the official gdal 1.3.2
> source code and the cvs code (today), both resulted in the error messages
> below when executing make.
>
> Any hint, how to fix it is appreciated.
>
> regards, Martin
>
> ./configure --with-grass=/usr/local/grass-6.3.cvs/
> [...]
> GDAL is now configured for i686-pc-linux-gnu
>
>   Installation directory:    /usr/local
>   C compiler:                gcc -O2
>   C++ compiler:              g++ -O2
>
>   LIBTOOL support:           yes
>
>   LIBZ support:              external
>   GRASS support:             grass57+
>   CFITSIO support:           no
>   PCRaster support:          internal
>   NETCDF support:            no
>   LIBPNG support:            internal
>   LIBTIFF support:           internal
>   LIBGEOTIFF support:        internal
>   LIBJPEG support:           internal
>   LIBGIF support:            internal
>   OGDI support:              no
>   HDF4 support:              no
>   HDF5 support:              no
>   KAKADU support:            no
>   JASPER support:            no
>   ECW support:               no
>   MrSID support:             no
>   CURL support (wcs):        no
>   POSTGRESQL support:        yes
>   MySQL support:             no
>   XERCES support:            no
>   ODBC support:              no
>   PGEO support:              no
>   OCI support:               no
>   SDE support:               no
>   DODS support:              no
>   SQLite support:            no
>   DWGdirect support          no
>   PANORAMA GIS support:      no
>   GEOS support:
>
>   Statically link PROJ.4:    no
>
>   Traditional Python:        yes
>   NG SWIG Bindings:
>
>   enable OGR building:       yes
>
>
> #make
> [...]
>
> make[2]: Nothing to be done for `install-obj'.
> make[2]: Leaving directory
> `/home/baliola/software/gdal_cvs/gdal/frmts/pcraster'
> make -C grass install-obj
> make[2]: Entering directory
> `/home/baliola/software/gdal_cvs/gdal/frmts/grass' /bin/sh
> /home/baliola/software/gdal_cvs/gdal/libtool --mode=compile g++ -Wall  -O2 
>  -I/usr/local/grass-6.3.cvs//include
> -I/home/baliola/software/gdal_cvs/gdal/port
> -I/home/baliola/software/gdal_cvs/gdal/gcore
> -I/home/baliola/software/gdal_cvs/gdal/alg
> -I/home/baliola/software/gdal_cvs/gdal/ogr
> -I/home/baliola/software/gdal_cvs/gdal/ogr/ogrsf_frmts -DOGR_ENABLED
> -I/home/baliola/software/gdal_cvs/gdal/port  -c -o ../o/grass57dataset.o
> grass57dataset.cpp
>
> g++ -Wall -O2 -I/usr/local/grass-6.3.cvs//include
> -I/home/baliola/software/gdal_cvs/gdal/port
> -I/home/baliola/software/gdal_cvs/gdal/gcore
> -I/home/baliola/software/gdal_cvs/gdal/alg
> -I/home/baliola/software/gdal_cvs/gdal/ogr
> -I/home/baliola/software/gdal_cvs/gdal/ogr/ogrsf_frmts -DOGR_ENABLED
> -I/home/baliola/software/gdal_cvs/gdal/port -c grass57dataset.cpp  -fPIC
> -DPIC -o ../o/.libs/grass57dataset.o
> grass57dataset.cpp: In static member function 'static GDALDataset*
> GRASSDataset::Open(GDALOpenInfo*)':
> grass57dataset.cpp:948: error: 'GPJ_grass_to_wkt' was not declared in this
> scope
> make[2]: *** [../o/grass57dataset.o] Error 1
> make[2]: Leaving directory
> `/home/baliola/software/gdal_cvs/gdal/frmts/grass' make[1]: ***
> [grass-install-obj] Error 2
> make[1]: Leaving directory `/home/baliola/software/gdal_cvs/gdal/frmts'
> make: *** [frmts-target] Error 2
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
Hi,

In the installation doc about grass, it is wrote to 
1/ build gdal with the --without-grass flag
2/ build Grass
3/ build gdal-grass

I advice you to follow the documentation.

Regards,

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From warmerdam at pobox.com  Thu Nov  9 10:18:42 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Download GEOS
In-Reply-To: <b41d86b30611090643q7914a64enec7eab4d02eaf80f@mail.gmail.com>
References: <b41d86b30611090633u2be4d730vfe63435be3e71c82@mail.gmail.com>
	<b41d86b30611090643q7914a64enec7eab4d02eaf80f@mail.gmail.com>
Message-ID: <455346D2.8060708@pobox.com>

Mir Hassan Ali wrote:
> Hi
>  
> Can anyone tell me where to dowload the latest GEOS library from. I want 
> to build it with GDAL. I am trying to download it from 
> http://geos.refractions.net <http://geos.refractions.net/> but my 
> browser does not open the website and says connection timed out. I think 
> there might be some problem with this website.

Mir Hassan Ali,

That is the right place, and the site isn't working for me either just now.
I'm sure the problem is temporary and will be corrected within a few hours.

I don't seem to have a copy lying around.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Thu Nov  9 10:27:33 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
Message-ID: <455348E5.5080507@pobox.com>

Martin Wegmann wrote:
> Hello,
> 
> I tried on a fresh debian testing system to install the official gdal 1.3.2 
> source code and the cvs code (today), both resulted in the error messages 
> below when executing make.
> 
> Any hint, how to fix it is appreciated. 
> 
> regards, Martin

Martin,

Could you try this with a CVS snapshot to verify this isn't already fixed
since spring?  You might also try installing GDAL without GRASS support,
and then building and installing the grass driver as a plugin.  This can
be done using:

   http://www.gdal.org/dl/gdal-grass-1.3.2.tar.gz

The plugin is more used, and better tested these days.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From yjacolin at free.fr  Thu Nov  9 10:37:13 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Download GEOS
In-Reply-To: <455346D2.8060708@pobox.com>
References: <b41d86b30611090633u2be4d730vfe63435be3e71c82@mail.gmail.com>
	<b41d86b30611090643q7914a64enec7eab4d02eaf80f@mail.gmail.com>
	<455346D2.8060708@pobox.com>
Message-ID: <200611091637.13694.yjacolin@free.fr>

Le Jeudi 9 Novembre 2006 16:18, Frank Warmerdam a ?crit?:
> Mir Hassan Ali wrote:
> > Hi
> >
> > Can anyone tell me where to dowload the latest GEOS library from. I want
> > to build it with GDAL. I am trying to download it from
> > http://geos.refractions.net <http://geos.refractions.net/> but my
> > browser does not open the website and says connection timed out. I think
> > there might be some problem with this website.
>
> Mir Hassan Ali,
>
> That is the right place, and the site isn't working for me either just now.
> I'm sure the problem is temporary and will be corrected within a few hours.
>
> I don't seem to have a copy lying around.
>
> Best regards,
Mir Hassan Ali,

I got the geos 2.2.3 tar.gzip. Do you want I send it to you ?

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From wegmann at biozentrum.uni-wuerzburg.de  Thu Nov  9 11:32:59 2006
From: wegmann at biozentrum.uni-wuerzburg.de (Martin Wegmann)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <455348E5.5080507@pobox.com>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
	<455348E5.5080507@pobox.com>
Message-ID: <200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>

Hello,

On Thursday 09 November 2006 16:27, you wrote:
> Martin Wegmann wrote:
> > Hello,
> >
> > I tried on a fresh debian testing system to install the official gdal
> > 1.3.2 source code and the cvs code (today), both resulted in the error
> > messages below when executing make.
> >
> > Any hint, how to fix it is appreciated.
> >
> > regards, Martin
>
> Martin,
>
> Could you try this with a CVS snapshot to verify this isn't already fixed
> since spring?  
 
I tried it with this cvs snapshot:
% export CVSROOT=:pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot
% cvs login
Password: *enter*
% cvs checkout gdal

> You might also try installing GDAL without GRASS support, 
> and then building and installing the grass driver as a plugin.  This can
> be done using:

without grass support

It works so far:
[...]
g++ 
gdal_rasterize.o -o .libs/gdal_rasterize  /home/baliola/software/gdal_cvs/gdal/.libs/libgdal.so -lpthread -lmfhdf -ldf -lgif -lpng -lnetcdf -lcfitsio -L/usr/lib -lpq -lz -lrt -ldl -Wl,--rpath -Wl,/usr/local/lib
creating gdal_rasterize
make[1]: Leaving directory `/home/baliola/software/gdal_cvs/gdal/apps'


but when I install gdal-grass:
./configure --with-gdal=/usr/local/bin/gdal-config --with-grass=/usr/local/grass-6.3.cvs/                 
make

grass57dataset.cpp: In static member function ?static GDALDataset* 
GRASSDataset::Open(GDALOpenInfo*)?:
grass57dataset.cpp:948: error: ?GPJ_grass_to_wkt? was not declared in this 
scope
make: *** [grass57dataset.o] Error 1

it's the same error message like with grass-support, isn't it?

thanks for your help, regards, Martin

>    http://www.gdal.org/dl/gdal-grass-1.3.2.tar.gz
>
> The plugin is more used, and better tested these days.
>
> Best regards,


From neteler at itc.it  Thu Nov  9 12:09:22 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <455348E5.5080507@pobox.com>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
	<455348E5.5080507@pobox.com>
Message-ID: <20061109170921.GN16574@bartok.itc.it>

On Thu, Nov 09, 2006 at 10:27:33AM -0500, Frank Warmerdam wrote:
> Martin Wegmann wrote:
> >Hello,
> >
> >I tried on a fresh debian testing system to install the official gdal 
> >1.3.2 source code and the cvs code (today), both resulted in the error 
> >messages below when executing make.
> >
> >Any hint, how to fix it is appreciated. 
> >
> >regards, Martin
> 
> Martin,
> 
> Could you try this with a CVS snapshot to verify this isn't already fixed
> since spring?  You might also try installing GDAL without GRASS support,
> and then building and installing the grass driver as a plugin.  This can
> be done using:
> 
>   http://www.gdal.org/dl/gdal-grass-1.3.2.tar.gz
> 
> The plugin is more used, and better tested these days.

I have put my configure scripts here, if that helps:

http://mpa.itc.it/markus/useful/
->  conf_gdal_64bit.sh  (easy to "downgrade" to 32bit)
->  conf_install_gdal_ogr_grass_plugin.sh

The second does configure including compilation.

Some RPM SPEC files are here:
http://grass.itc.it/grass62/binary/linux/spec/

cheers
Markus

From thomas.hottendorff at web.de  Thu Nov  9 16:00:36 2006
From: thomas.hottendorff at web.de (Thomas Hottendorff)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Setting ModelPixelScale in a GeoTIFF Elevation Model?
Message-ID: <455396F4.3000305@web.de>

Dear all,

I'm creating geotiffs from arc-ascii grids using gdal_translate. Now I'm
facing the problem that the third value of the ModelPixelScale tag 
(height scale) does not get set to 1 as I would expect but stays 0.

Can anybody give me a hint on how to set it to 1 with gdal_translate? (I 
figured
that option -mo might be used for this but couldn't get it to work).

Alternatively, maybe somebody can post a few lines of python code to do 
the job?.

Secondly, I'd also like to set the vertical reference system in the GeoTIFF.
Can this be done with gdal_translate or likewise with some python code?

Many thanks in advance,

Thomas

From warmerdam at pobox.com  Thu Nov  9 16:44:26 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Setting ModelPixelScale in a GeoTIFF Elevation Model?
In-Reply-To: <455396F4.3000305@web.de>
References: <455396F4.3000305@web.de>
Message-ID: <4553A13A.4020503@pobox.com>

Thomas Hottendorff wrote:
> Dear all,
> 
> I'm creating geotiffs from arc-ascii grids using gdal_translate. Now I'm
> facing the problem that the third value of the ModelPixelScale tag 
> (height scale) does not get set to 1 as I would expect but stays 0.

Thomas,

GDAL hardcodes the Z value in ModelPixelScale as zero all the time.  It's
use as a scaling value for elevation pixel values has not achieved any
degree of use as far as I know.

> Can anybody give me a hint on how to set it to 1 with gdal_translate? (I 
> figured
> that option -mo might be used for this but couldn't get it to work).
> 
> Alternatively, maybe somebody can post a few lines of python code to do 
> the job?.

I can't think of a way of doing this from python.

If you really, really want to set this, then use listgeo to dump out
the geotiff tags, modify the Z scale in that text file, and then use
geotifcp to reapply the updated geotiff values.

> Secondly, I'd also like to set the vertical reference system in the 
> GeoTIFF.
> Can this be done with gdal_translate or likewise with some python code?

I'm afraid that GDAL has no support for vertical reference systems at
this time.  The closest it gets to any of this is the concept of a
Units value for pixel values which can meaningfully be "ft" or "m" for
elevation values.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From taka_www at yahoo.com.hk  Tue Nov  7 08:09:44 2006
From: taka_www at yahoo.com.hk (Wong Taka)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Performance on using Oracle Client XE
Message-ID: <20061107130945.38796.qmail@web53214.mail.yahoo.com>

Dear All
   
  I am now studing a project about using mapserver to display map.
  In this map, points would be also shown. These points' XY and other info are stored in relational Oracle XE DB. For displaying, these point can be generated in acceptable time. 
   
  However, when I retrieve the Points' attributes by grab the point in map. I found that the loading time is quite long. I have tried to add a index in Oracle XE for the XY in the table. It seems indifferent in performance.
   
  Are there any smart way to improve the performance? e.g. did fastCGI work? since I am using IIS to run Mapserver. I wonder.
   
  Thank you very much.
   
  by the way, I think this post should be post on MAPSERVER mail list, and I have tried also, but it always bound my post back. -_-"
   
  Regards
  Taka 

 _______________________________________
 YM - uT
 NASWAABiHdUTAAAWNYANC
 http://messenger.yahoo.com.hk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061107/8fc97507/attachment.html
From sjahputerao at missouri.edu  Thu Nov  9 17:39:06 2006
From: sjahputerao at missouri.edu (Ozy Sjahputera)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Conflicts when using GDAL with minGW
Message-ID: <4553AE0A.7070903@missouri.edu>

I have been getting the following error messages when compiling a 
program (with GDAL) using Eclipse with minGW compilers & libraries.

Severity and Description    Path    Resource    Location    Creation 
Time    Id
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/c++/3.4.2/cstdio 
error: `__gnu_cxx::snprintf' has not been declared      
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/c++/3.4.2/cstdio 
error: `__gnu_cxx::vsnprintf' has not been declared    
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/c++/3.4.2/cstdio 
error: `::snprintf' has not been declared 
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/c++/3.4.2/cstdio 
error: `::vsnprintf' has not been declared
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/c++/3.4.2/mingw32/bits/c++locale.h 
error: `snprintf' is not a member of `std'
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
declaration of C function `float _copysign(float, float)' conflicts with 
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
declaration of C function `long double _copysign(long double, long 
double)' conflicts with
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
previous declaration `double _copysign(double, double)' here 
e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
previous declaration `float _copysign(float, float)' here

The following is my GDAL headers included:
#include <gdal_priv.h>
#include <cpl_string.h>
#include <ogr_spatialref.h>
#include <gdalwarper.h>

It seems that the GDAL library is causing some functions in the minGW 
C++ library (cstdio) to be undeclared.

Has anyone experienced this kind of conflict?

Thanks
Ozy


From matt.wilkie at gov.yk.ca  Thu Nov  9 17:57:53 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Re: Changing colour in tif file
In-Reply-To: <3f7a6e1c0611020803k669f75bal8c6ecbec37321b4@mail.gmail.com>
References: <3f7a6e1c0611020458u345363a9we304757db0371b6c@mail.gmail.com>
	<3f7a6e1c0611020803k669f75bal8c6ecbec37321b4@mail.gmail.com>
Message-ID: <4553B271.6080308@gov.yk.ca>

> I need to replace a value in three bands depending on a condition 
> spanning the three bands, e.g if RGB == 255,0,0 then RGB = 120,60,60 or 
> some such.

If you're lucky enough for the desired data to be a the top or bototm of 
the range you can use the scale command (need to split out the bands 
into separate files first):

	gdal_translate -b 1 rgb-image.tif red.tif
	gdal_translate -scale 0 255 0 254 red.tif ...

where 255 is the value to get rid of. The result unfortunately is not 
the same as converting 255 to nodata.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From matt.wilkie at gov.yk.ca  Thu Nov  9 17:52:47 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>
References: <454F86AC.5020003@pobox.com>
	<6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>
Message-ID: <4553B13F.7080106@gov.yk.ca>

> I hereby move that all motions to the PSC be documented on a page on the 
> website for historical and accounting reasons and to pluck them out of 
> the rigamarole of day-to-day list traffic.

So long as a web page is not the -sole- posting. Websites can vanish, be 
re-organised and silently updated for a variety of reasons (not 
necessarily maliciously, mistakes happen too). This is precisely why 
some of the security mailing lists require there be no web-only records 
of exploits, fixes etc.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From warmerdam at pobox.com  Thu Nov  9 21:14:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Motion: Adopt OSGeo Project Sponsorship Program
In-Reply-To: <4553B13F.7080106@gov.yk.ca>
References: <454F86AC.5020003@pobox.com>
	<6.2.3.4.2.20061106141343.03261228@hobu.mail.iastate.edu>
	<4553B13F.7080106@gov.yk.ca>
Message-ID: <4553E09D.7000109@pobox.com>

Matt Wilkie wrote:
>> I hereby move that all motions to the PSC be documented on a page on 
>> the website for historical and accounting reasons and to pluck them 
>> out of the rigamarole of day-to-day list traffic.
> 
> So long as a web page is not the -sole- posting. Websites can vanish, be 
> re-organised and silently updated for a variety of reasons (not 
> necessarily maliciously, mistakes happen too). This is precisely why 
> some of the security mailing lists require there be no web-only records 
> of exploits, fixes etc.

Matt,

The website is generated from the GDAL CVS tree (eg gdal/doc, gdal/rfc).  So
as long as the GDAL source tree exists then the records will exist.

I agree that web-only records (for instance in a CMS) make me nervous.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From rainer.spittel at terralink.co.nz  Thu Nov  9 22:18:55 2006
From: rainer.spittel at terralink.co.nz (Rainer Spittel)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Installation problems: GDAL 1.3.2 on Fedora5 (64Bit)
Message-ID: <12B8F225666F99489CEFA8B3F261540C5F2E9E@geneva.local.terralink>

Hi
 
  Some weeks ago I tried to compile GDAL 1.3.2 on Fedora 5 32Bit and had
some compiling errors. I got the advise to take the CVS version. That
helped a lot and the compiling process went through without any
problems.
 
  Now I try to update the server, installing the same GDAL environment
on a Fedora 5 64Bit OS and have compiling errors again. GDAL can not
locate the libidn.so in /usr/lib. This library is in /usr/lib64.
 
  What I tried if to copy the libidn.so file from the /usr/lib64 to the
/usr/lib folder. It works - but I don't like it! ;-) This is a very
scary approach to solve those problems. 
 
  Does anyone have a better suggestion to solve this problem?
 
Cheers
Rainer
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061110/98c7ea10/attachment.html
From warmerdam at pobox.com  Thu Nov  9 22:47:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Installation problems: GDAL 1.3.2 on Fedora5 (64Bit)
In-Reply-To: <12B8F225666F99489CEFA8B3F261540C5F2E9E@geneva.local.terralink>
References: <12B8F225666F99489CEFA8B3F261540C5F2E9E@geneva.local.terralink>
Message-ID: <4553F667.9020105@pobox.com>

Rainer Spittel wrote:
> Hi
>  
>   Some weeks ago I tried to compile GDAL 1.3.2 on Fedora 5 32Bit and had 
> some compiling errors. I got the advise to take the CVS version. That 
> helped a lot and the compiling process went through without any problems.
>  
>   Now I try to update the server, installing the same GDAL environment 
> on a Fedora 5 64Bit OS and have compiling errors again. GDAL can not 
> locate the libidn.so in /usr/lib. This library is in /usr/lib64.
>  
>   What I tried if to copy the libidn.so file from the /usr/lib64 to the 
> /usr/lib folder. It works - but I don't like it! ;-) This is a very 
> scary approach to solve those problems.

Rainer,

If you can provide temporary ssh access to such a system, I could look
into the problem.  I am not aware of any problems on my 64bit ubuntu system.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From rainer.spittel at terralink.co.nz  Thu Nov  9 22:54:35 2006
From: rainer.spittel at terralink.co.nz (Rainer Spittel)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Installation problems: GDAL 1.3.2 on Fedora5 (64Bit)
Message-ID: <12B8F225666F99489CEFA8B3F261540C5F2E9F@geneva.local.terralink>

Hi Frank

  Unfortunately I can not open a ssh port at the moment. :-( After
making the copy of the shared object from the lib64 to the lib folder,
ldconfig throws a warning: 

  ldconfig: libraries libidn.so.11 and libidn.so in directory /usr/lib
have same soname but different type.

  Hmmm, this copy-solution seems to make trouble. 

  Now, I just tried to compile PHP and get a similar error message with
another library:

  checking for fabsf... yes
  checking for floorf... yes
  configure: error: libjpeg.(a|so) not found.

  The libjpeg.so is located in the /usr/lib64 folder :-(

  Cheers

Rainer

P.S.: By the way, it's a Fedora 5, not Ubuntu system. 

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, 10 November 2006 4:48 p.m.
To: Rainer Spittel
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Installation problems: GDAL 1.3.2 on Fedora5
(64Bit)


Rainer Spittel wrote:
> Hi
>  
>   Some weeks ago I tried to compile GDAL 1.3.2 on Fedora 5 32Bit and 
> had
> some compiling errors. I got the advise to take the CVS version. That 
> helped a lot and the compiling process went through without any
problems.
>  
>   Now I try to update the server, installing the same GDAL environment
> on a Fedora 5 64Bit OS and have compiling errors again. GDAL can not 
> locate the libidn.so in /usr/lib. This library is in /usr/lib64.
>  
>   What I tried if to copy the libidn.so file from the /usr/lib64 to 
> the
> /usr/lib folder. It works - but I don't like it! ;-) This is a very 
> scary approach to solve those problems.

Rainer,

If you can provide temporary ssh access to such a system, I could look
into the problem.  I am not aware of any problems on my 64bit ubuntu
system.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org



From mirhassanali at gmail.com  Fri Nov 10 06:23:48 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Building GDAL with GEOS support
Message-ID: <b41d86b30611100323y29f29e42ib07b3881f90866af@mail.gmail.com>

Hi

I am trying to build GDAL with GEOS support. The problem is I downloaded the
latest release of GEOS (3.0.0) . But when I try to build it gives me a lot
of errors. Does someone have a precompiled library of GEOS or can I download
it from somewhere so that I can build GDAL with it. Do I need any specific
version of GEOS?

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061110/d495b08d/attachment.html
From jdgonon at gi-lemans.com  Fri Nov 10 10:09:23 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] errors with gdal-1.3.2 under MS Visual C++ 2003
Message-ID: <001001c704da$354d52b0$6469850a@gi.com>

Hi all, 


I had some problems with compilation of GDAL/OGR : problems are compatibility between "gdal13d.dll" (generated by GDAL/OGR) and ogrinfo.exe because none format (dgn, ...) is recognized.

So I start a new compilation with GDAL/OGR 1.3.2, compiled in command lines without errors.

I had to add " xerces-c_2_3_0-win32 " in gdal-1.3.2\frmts\ folder.

Now I have new errors in Visual C++ : " gdal error LNK2019: symbole externe non r?solu _ObjectName r?f?renc? dans la fonction _ObjectFunction "

My configuration : gdal1.3.2 under MS Visual C++ 2003 (version 7).

I don't know what I can do ?


Thanck you

Jean-Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061110/533c4bdf/attachment.html
From mirhassanali at gmail.com  Fri Nov 10 11:00:21 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Building GDAL with GEOS
Message-ID: <b41d86b30611100800k7dd2bfbfm5994d9e524b85d86@mail.gmail.com>

Hi

I am trying to build GDAL with GEOS support and I am getting these linker
errors

 Microsoft (R) Incremental Linker Version 7.10.3077
Copyright (C) Microsoft Corporation.  All rights reserved.

   Creating library gdal_i.lib and object gdal_i.exp
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSGeomFr
omWKB_buf referenced in function "public: virtual struct GEOSGeom_t *
__thiscall
 OGRGeometry::exportToGEOS(void)const " (
?exportToGEOS@OGRGeometry@@UBEPAUGEOSGe
om_t@@XZ)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSConvex
Hull referenced in function "public: virtual class OGRGeometry * __thiscall
OGRG
eometry::ConvexHull(void)const " (?ConvexHull@OGRGeometry@@UBEPAV1@XZ)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSBounda
ry referenced in function "public: virtual class OGRGeometry * __thiscall
OGRGeo
metry::getBoundary(void)const " (?getBoundary@OGRGeometry@@UBEPAV1@XZ)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSBuffer
 referenced in function "public: virtual class OGRGeometry * __thiscall
OGRGeome
try::Buffer(double,int)const " (?Buffer@OGRGeometry@@UBEPAV1@NH@Z)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSInters
ection referenced in function "public: virtual class OGRGeometry *
__thiscall OG
RGeometry::Intersection(class OGRGeometry const *)const " (
?Intersection@OGRGeom
etry@@UBEPAV1@PBV1@@Z)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSUnion
referenced in function "public: virtual class OGRGeometry * __thiscall
OGRGeomet
ry::Union(class OGRGeometry const *)const " (
?Union@OGRGeometry@@UBEPAV1@PBV1@@Z
)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSDiffer
ence referenced in function "public: virtual class OGRGeometry * __thiscall
OGRG
eometry::Difference(class OGRGeometry const *)const " (
?Difference@OGRGeometry@@
UBEPAV1@PBV1@@Z)
ogr.lib(ogrgeometry.obj) : error LNK2019: unresolved external symbol
_GEOSSymDif
ference referenced in function "public: virtual class OGRGeometry *
__thiscall O
GRGeometry::SymmetricDifference(class OGRGeometry const *)const "
(?SymmetricDif
ference@OGRGeometry@@UBEPAV1@PBV1@@Z)
ogr.lib(ogrpolygon.obj) : error LNK2019: unresolved external symbol
_GEOSGetCent
roid referenced in function "public: virtual int __thiscall
OGRPolygon::Centroid
(class OGRPoint *)const " (?Centroid@OGRPolygon@@UBEHPAVOGRPoint@@@Z)
gdal13.dll : fatal error LNK1120: 9 unresolved externals
NMAKE : fatal error U1077: 'link' : return code '0x460'
Stop.

Does anyone knows how to resolve these issues. I am using the latest GDAL
and GEOS releases.

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061110/ef6fd8ee/attachment.html
From warmerdam at pobox.com  Fri Nov 10 16:31:39 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] FWTools 1.0.8 (Windows)
Message-ID: <4554EFBB.5030404@pobox.com>

Folks,

I have built and released a new FWTools 1.0.8 for Windows built from
the latest GDAL, and MapServer source.  This build includes the new GDAL
WCS driver, for those interested in testing it.

   http://www.gdal.org/frmt_wcs.html

The installer can be found at:

   http://www.gdal.org/dl/fwtools/FWTools108.exe

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 10 17:09:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Performance on using Oracle Client XE
In-Reply-To: <20061107130945.38796.qmail@web53214.mail.yahoo.com>
References: <20061107130945.38796.qmail@web53214.mail.yahoo.com>
Message-ID: <4554F89F.8020101@pobox.com>

Wong Taka wrote:
> Dear All
>  
> I am now studing a project about using mapserver to display map.
> In this map, points would be also shown. These points' XY and other info 
> are stored in relational Oracle XE DB. For displaying, these point can 
> be generated in acceptable time.
>  
> However, when I retrieve the Points' attributes by grab the point in 
> map. I found that the loading time is quite long. I have tried to add a 
> index in Oracle XE for the XY in the table. It seems indifferent in 
> performance.

Taka,

I'm not sure what you mean by retreiving the points attribute
by grabbing the point in the map.   Also, are you using the Oracle
OCI driver in OGR, or the CONNECTIONTYPE ORACLE support built into
MapServer?

I will note that the MapServer "query" mechanism is two pass, and
that if going through OCI it requires a seperate SQL SELECT
statement to be executed for each feature fetched.  This is
needless to say fairly expensive.  This is in contrast to how
layers are drawn where a single select is done, and all the
rows are pulled in sequence.

I suspect this is the pit you are falling into.

> Are there any smart way to improve the performance? e.g. did fastCGI 
> work? since I am using IIS to run Mapserver. I wonder.

If it is the problem above, then you are best off avoiding the
two pass query mechanism.  How to do this will depend on your
particulars.  If you are writing a mapscript application, you
may find it better to do something kinds of queries to oracle
directly from your scripting language of choice rather than
through mapserver.

> by the way, I think this post should be post on MAPSERVER mail list, 
> and I have tried also, but it always bound my post back. -_-"

You need to be very careful to subscribe using the email
address you will post from.   I suspect the same thing
happened to you with gdal-dev, and the post was held till
I approved it manually.  There is no manual approval for
the mapserver list as far as I know.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sjahputerao at missouri.edu  Fri Nov 10 17:55:03 2006
From: sjahputerao at missouri.edu (Ozy Sjahputera)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL conflicts (copysign() and snprintf() )
Message-ID: <45550347.4010409@missouri.edu>

I am trying to build a C++ project that uses GDAL by including 
gdal_priv.h, cpl_string.h, ogr_spatialref.h and gdalwarper.h.  The 
project was initially created in a Linux environment (Gentoo) and was 
running fine.  While the linux box is being rebuilt, I have to work 
using an XP machine.  The project compiles and runs fine when built 
using VC .NET (2003).  But it throws errors when built using MinGW (with 
Eclipse CDT IDE). 

The two functions cited for these errors are copysign and snprintf. 
After some digging I found that cpl_config.h contains some constants 
that indicates whether these functions are present. 
I am guessing that the settings in cpl_config.h are designed to work 
with VC++ libraries, but problems arises when one uses MinGW libraries.

Any idea how to resolve these conflicts? 

Thanks

oz

From warmerdam at pobox.com  Fri Nov 10 18:41:15 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] GDAL conflicts (copysign() and snprintf() )
In-Reply-To: <45550347.4010409@missouri.edu>
References: <45550347.4010409@missouri.edu>
Message-ID: <45550E1B.5050405@pobox.com>

Ozy Sjahputera wrote:
> I am trying to build a C++ project that uses GDAL by including 
> gdal_priv.h, cpl_string.h, ogr_spatialref.h and gdalwarper.h.  The 
> project was initially created in a Linux environment (Gentoo) and was 
> running fine.  While the linux box is being rebuilt, I have to work 
> using an XP machine.  The project compiles and runs fine when built 
> using VC .NET (2003).  But it throws errors when built using MinGW (with 
> Eclipse CDT IDE).
> The two functions cited for these errors are copysign and snprintf. 
> After some digging I found that cpl_config.h contains some constants 
> that indicates whether these functions are present. I am guessing that 
> the settings in cpl_config.h are designed to work with VC++ libraries, 
> but problems arises when one uses MinGW libraries.
> 
> Any idea how to resolve these conflicts?

Oz,

When you build with Visual Studio the gdal/port/cpl_config.h.vc file is
copied over gdal/port/cpl_config.h.  When building on linux, or cygwin
the configure generates the gdal/port/cpl_config.h.

Are you using Cygwin's make, and related stuff for your mingw build?  If
so, you have to be careful to rerun configure after building in the same
tree with visual studio.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From geoff.zeiss at autodesk.com  Sat Nov 11 12:30:50 2006
From: geoff.zeiss at autodesk.com (Geoff Zeiss)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 30, Issue 25
Message-ID: <4187BAA24A3D094F925AEE0BE39B7077027A3C5E@msgusaemb01.autodesk.com>

Tyler
I expect that I'll be able to help as well, but I don't know my schedule yet.
Geoff
www.geospatial.blogs.com

----- Original Message -----
From: gdal-dev-bounces@lists.maptools.org <gdal-dev-bounces@lists.maptools.org>
To: gdal-dev@lists.maptools.org <gdal-dev@lists.maptools.org>
Sent: Sat Nov 11 12:01:58 2006
Subject: Gdal-dev Digest, Vol 30, Issue 25

Send Gdal-dev mailing list submissions to
	gdal-dev@lists.maptools.org

To subscribe or unsubscribe via the World Wide Web, visit
	http://lists.maptools.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
	gdal-dev-request@lists.maptools.org

You can reach the person managing the list at
	gdal-dev-owner@lists.maptools.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of Gdal-dev digest..."


Today's Topics:

   1. FWTools 1.0.8 (Windows) (Frank Warmerdam)
   2. Re: Performance on using Oracle Client XE (Frank Warmerdam)
   3. GDAL conflicts (copysign() and snprintf() ) (Ozy Sjahputera)
   4. Re: GDAL conflicts (copysign() and snprintf() ) (Frank Warmerdam)


----------------------------------------------------------------------

Message: 1
Date: Fri, 10 Nov 2006 16:31:39 -0500
From: Frank Warmerdam <warmerdam@pobox.com>
Subject: [Gdal-dev] FWTools 1.0.8 (Windows)
To: FWTools <fwtools@lists.maptools.org>
Cc: gdal-dev <gdal-dev@lists.maptools.org>
Message-ID: <4554EFBB.5030404@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Folks,

I have built and released a new FWTools 1.0.8 for Windows built from
the latest GDAL, and MapServer source.  This build includes the new GDAL
WCS driver, for those interested in testing it.

   http://www.gdal.org/frmt_wcs.html

The installer can be found at:

   http://www.gdal.org/dl/fwtools/FWTools108.exe

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



------------------------------

Message: 2
Date: Fri, 10 Nov 2006 17:09:35 -0500
From: Frank Warmerdam <warmerdam@pobox.com>
Subject: Re: [Gdal-dev] Performance on using Oracle Client XE
To: Wong Taka <taka_www@yahoo.com.hk>
Cc: gdal-dev@lists.maptools.org
Message-ID: <4554F89F.8020101@pobox.com>
Content-Type: text/plain; charset=Big5

Wong Taka wrote:
> Dear All
>  
> I am now studing a project about using mapserver to display map.
> In this map, points would be also shown. These points' XY and other info 
> are stored in relational Oracle XE DB. For displaying, these point can 
> be generated in acceptable time.
>  
> However, when I retrieve the Points' attributes by grab the point in 
> map. I found that the loading time is quite long. I have tried to add a 
> index in Oracle XE for the XY in the table. It seems indifferent in 
> performance.

Taka,

I'm not sure what you mean by retreiving the points attribute
by grabbing the point in the map.   Also, are you using the Oracle
OCI driver in OGR, or the CONNECTIONTYPE ORACLE support built into
MapServer?

I will note that the MapServer "query" mechanism is two pass, and
that if going through OCI it requires a seperate SQL SELECT
statement to be executed for each feature fetched.  This is
needless to say fairly expensive.  This is in contrast to how
layers are drawn where a single select is done, and all the
rows are pulled in sequence.

I suspect this is the pit you are falling into.

> Are there any smart way to improve the performance? e.g. did fastCGI 
> work? since I am using IIS to run Mapserver. I wonder.

If it is the problem above, then you are best off avoiding the
two pass query mechanism.  How to do this will depend on your
particulars.  If you are writing a mapscript application, you
may find it better to do something kinds of queries to oracle
directly from your scripting language of choice rather than
through mapserver.

> by the way, I think this post should be post on MAPSERVER mail list, 
> and I have tried also, but it always bound my post back. -_-"

You need to be very careful to subscribe using the email
address you will post from.   I suspect the same thing
happened to you with gdal-dev, and the post was held till
I approved it manually.  There is no manual approval for
the mapserver list as far as I know.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



------------------------------

Message: 3
Date: Fri, 10 Nov 2006 16:55:03 -0600
From: Ozy Sjahputera <sjahputerao@missouri.edu>
Subject: [Gdal-dev] GDAL conflicts (copysign() and snprintf() )
To: gdal-dev@lists.maptools.org
Message-ID: <45550347.4010409@missouri.edu>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

I am trying to build a C++ project that uses GDAL by including 
gdal_priv.h, cpl_string.h, ogr_spatialref.h and gdalwarper.h.  The 
project was initially created in a Linux environment (Gentoo) and was 
running fine.  While the linux box is being rebuilt, I have to work 
using an XP machine.  The project compiles and runs fine when built 
using VC .NET (2003).  But it throws errors when built using MinGW (with 
Eclipse CDT IDE). 

The two functions cited for these errors are copysign and snprintf. 
After some digging I found that cpl_config.h contains some constants 
that indicates whether these functions are present. 
I am guessing that the settings in cpl_config.h are designed to work 
with VC++ libraries, but problems arises when one uses MinGW libraries.

Any idea how to resolve these conflicts? 

Thanks

oz


------------------------------

Message: 4
Date: Fri, 10 Nov 2006 18:41:15 -0500
From: Frank Warmerdam <warmerdam@pobox.com>
Subject: Re: [Gdal-dev] GDAL conflicts (copysign() and snprintf() )
To: Ozy Sjahputera <sjahputerao@missouri.edu>
Cc: gdal-dev@lists.maptools.org
Message-ID: <45550E1B.5050405@pobox.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed

Ozy Sjahputera wrote:
> I am trying to build a C++ project that uses GDAL by including 
> gdal_priv.h, cpl_string.h, ogr_spatialref.h and gdalwarper.h.  The 
> project was initially created in a Linux environment (Gentoo) and was 
> running fine.  While the linux box is being rebuilt, I have to work 
> using an XP machine.  The project compiles and runs fine when built 
> using VC .NET (2003).  But it throws errors when built using MinGW (with 
> Eclipse CDT IDE).
> The two functions cited for these errors are copysign and snprintf. 
> After some digging I found that cpl_config.h contains some constants 
> that indicates whether these functions are present. I am guessing that 
> the settings in cpl_config.h are designed to work with VC++ libraries, 
> but problems arises when one uses MinGW libraries.
> 
> Any idea how to resolve these conflicts?

Oz,

When you build with Visual Studio the gdal/port/cpl_config.h.vc file is
copied over gdal/port/cpl_config.h.  When building on linux, or cygwin
the configure generates the gdal/port/cpl_config.h.

Are you using Cygwin's make, and related stuff for your mingw build?  If
so, you have to be careful to rerun configure after building in the same
tree with visual studio.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



------------------------------

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

End of Gdal-dev Digest, Vol 30, Issue 25
****************************************

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061111/be20c0f7/attachment.html
From s_larosa at libero.it  Sat Nov 11 11:23:36 2006
From: s_larosa at libero.it (Salvatore Larosa)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
	<455348E5.5080507@pobox.com>
	<200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
Message-ID: <7294124.post@talk.nabble.com>


Even I get it same error!
Have you resolved it?
-- 
View this message in context: http://www.nabble.com/gdal-install-errors-tf2602238.html#a7294124
Sent from the GDAL - Dev mailing list archive at Nabble.com.


From epk.lists at gmail.com  Sat Nov 11 20:29:49 2006
From: epk.lists at gmail.com (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] foss-GIS rpm's for Fedora 5
Message-ID: <2d1782780611111729y5e763fe4k70ba08147cb3bc7c@mail.gmail.com>

Hi folks,

At my downloads
sections<http://www.webmapit.com.br/index.php?option=com_content&task=blogsection&id=19&Itemid=108&lang=en>I
have published some RPM's for ShapeLib, PROJ, GEOS, PostGIS, GDAL,
GRASS
and MapServer.

Currently I only tested these pack under two different machines but both
running FC5.

Let me know if is there any license restrictions within any package.

-- 
Eduardo Patto Kanegae
http://www.webmapit.com.br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061111/4381ec0c/attachment.html
From mirhassanali at gmail.com  Mon Nov 13 08:31:09 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Visual Studio project files for GDAL
Message-ID: <b41d86b30611130531u58eae9afn1285bd622b720bd@mail.gmail.com>

Hi

Does anyone know where I can get the Visual Studio 2003 project files for
the GDAL CSV?

Any help will be highly appreciated.

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/9c36d209/attachment.html
From elavazhagan.mouniandy at kcubeconsulting.com  Mon Nov 13 09:02:20 2006
From: elavazhagan.mouniandy at kcubeconsulting.com (Elavazhagan.M)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Visual Studio project files for GDAL
In-Reply-To: <b41d86b30611130531u58eae9afn1285bd622b720bd@mail.gmail.com>
Message-ID: <200611131402.kADE2UkX009247@duke.maptools.org>

 

Please refer the following link:

 

http://vterrain.org/Distrib/gdal.html

 

Best Regards,

Ela

  _____  

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mir Hassan Ali
Sent: Monday, November 13, 2006 7:01 PM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Visual Studio project files for GDAL

 

Hi

 

Does anyone know where I can get the Visual Studio 2003 project files for
the GDAL CSV?

 

Any help will be highly appreciated.

 

Best Regards

 

Mir Hassan Ali

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/434a0f07/attachment.html
From craig.miller at spatialminds.com  Mon Nov 13 11:55:21 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Memory Leak?  OGRGeometryFactory::forcetoMultiPolygon
Message-ID: <005001c70744$81ab82a0$3301a8c0@vaio>

Is there any cleanup code necessary when working with
OGRGeometryFactory::forceToMultiPolygon?

The following snippit appears to cause a leak:
pDstFeature->SetGeometryDirectly(
OGRGeometryFactory::forceToMultiLineString(pDstFeature->StealGeometry()));

And just to verify that it wasn't the StealGeometry/SetGeometryDirectly
portion I verified that replacing the above code with this does not leak:
pDstFeature->SetGeometryDirectly( pDstFeature->StealGeometry());

Thanks for taking a look.
--Craig


From warmerdam at pobox.com  Mon Nov 13 12:07:30 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Release 1.4.0
Message-ID: <4558A652.2080404@pobox.com>

Folks,

Following up on Ari's suggestion, I'd like to plan on a new GDAL release
by mid December, perhaps with a first official beta December 1st.

What work are people hoping to get into a next GDAL release?

I believe Howard is hoping to have incorporated numpy support into the
next generation python bindings by the end of this month.

I would like to incorporate PDS (Planetary Data) support.

I would like to see Tamas' OGR SQL changes approved and incorporated.

I would like to do a substantial review of outstanding bug reports, but to
be honest I can't imagine "clearing the plate" in any meaningful way.  At
best, picking off a few of the easier problems and fixing them.

I am also hopeful that we would have our transition to SVN immediately
following a GDAL 1.3.3 release,

In fact, I would like to call the next release 1.4.0 instead of 1.3.3,
and thereafter using point releases (1.4.1, 1.4.2) as simple bug fixes
releases against a 1.4 stable branch while new development occurs in a
trunk that would eventually become 1.5.0.  This is more in keeping with
the approach used very successfully in mapserver.  It also follows Daniel's
past suggestion that new version numbers aren't really all that expensive.
:-)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Mon Nov 13 12:30:07 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <4558A652.2080404@pobox.com>
References: <4558A652.2080404@pobox.com>
Message-ID: <4558AB9F.60908@loskot.net>

Frank Warmerdam wrote:
> Folks,
> 
> Following up on Ari's suggestion, I'd like to plan on a new GDAL release
> by mid December, perhaps with a first official beta December 1st.
> 
> What work are people hoping to get into a next GDAL release?
> [...]

What about Simon's proposal with manifest embedding for VC++ 8.0?

> I am also hopeful that we would have our transition to SVN immediately
> following a GDAL 1.3.3 release,

+1

> In fact, I would like to call the next release 1.4.0 instead of 1.3.3,
> and thereafter using point releases (1.4.1, 1.4.2) as simple bug fixes
> releases against a 1.4 stable branch while new development occurs in a
> trunk that would eventually become 1.5.0.  This is more in keeping with
> the approach used very successfully in mapserver.  It also follows Daniel's
> past suggestion that new version numbers aren't really all that expensive.
> :-)

+1

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dmorissette at mapgears.com  Mon Nov 13 12:40:08 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <4558A652.2080404@pobox.com>
References: <4558A652.2080404@pobox.com>
Message-ID: <4558ADF8.7070509@mapgears.com>

Frank Warmerdam wrote:
> 
> In fact, I would like to call the next release 1.4.0 instead of 1.3.3,
> and thereafter using point releases (1.4.1, 1.4.2) as simple bug fixes
> releases against a 1.4 stable branch while new development occurs in a
> trunk that would eventually become 1.5.0.  This is more in keeping with
> the approach used very successfully in mapserver.  It also follows Daniel's
> past suggestion that new version numbers aren't really all that expensive.
> :-)
> 

w00t! +1.4 on the new release numbering of course!

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From warmerdam at pobox.com  Mon Nov 13 12:57:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Memory Leak?  OGRGeometryFactory::forcetoMultiPolygon
In-Reply-To: <005001c70744$81ab82a0$3301a8c0@vaio>
References: <005001c70744$81ab82a0$3301a8c0@vaio>
Message-ID: <4558B1F8.1010906@pobox.com>

Craig Miller wrote:
> Is there any cleanup code necessary when working with
> OGRGeometryFactory::forceToMultiPolygon?
> 
> The following snippit appears to cause a leak:
> pDstFeature->SetGeometryDirectly(
> OGRGeometryFactory::forceToMultiLineString(pDstFeature->StealGeometry()));
> 
> And just to verify that it wasn't the StealGeometry/SetGeometryDirectly
> portion I verified that replacing the above code with this does not leak:
> pDstFeature->SetGeometryDirectly( pDstFeature->StealGeometry());

Craig,

I have reviewed the code, and it appears that there is a memory leak when
the input is a simple OGRLineString.  I have applied the following patch
in CVS.

@@ -809,7 +806,7 @@
          return poGeom;

      OGRMultiLineString *poMP = new OGRMultiLineString();
-    poMP->addGeometryDirectly( poGeom );
+    poMP->addGeometry( poGeom );

      return poMP;
  }

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jdgonon at gi-lemans.com  Mon Nov 13 12:28:05 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Operations to add new OGR format
Message-ID: <002201c70749$15304340$6469850a@gi.com>

Hi

Which are the operations to add new OGR format in GDAL/OGR (under windows XP) ?
It's an evolution of DGN format to version 8.

I already start by making a copy of the gdal/ogr/ogrsf_frmts/old_format directory as gdal/ogr/ogrsf_frmts/new_format, and modify (filenames and functions names) accordingly.

After I add the new registration entry point at the bottom of gdal/ogr/ogrsf_frmts/ogrsf_frmts.h, and call it from gda/ogr/ogrsf_frmts/generic/ogrregisterall.cpp.

But the new format isn't detected by ogrinfo.exe when I want to open a DGN version 8 file.

What I must then declare or modify ?


Thanck you

Jean-Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/995247bf/attachment.html
From jmp at geosys.com  Mon Nov 13 14:15:06 2006
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Create Images with GDAL in C#
Message-ID: <006001c70758$075b9f30$2201a8c0@pcjmp>

Hi,

 

I've just tried to use the GDAL C#, it's ok to read images,   

But i have problem to create images, all my created images are empty.

 

public static void create(string file)

{

Driver dv;

      Dataset ds;

      Band ba;

 

      int bXSize, bYSize;

      int w, h;

 

      string [] options;

 

      w = 100;

      h = 100;

 

      bXSize = w;

      bYSize = 1;

 

      dv = gdal.GetDriverByName("GTiff");

      options = new string [] {"BLOCKXSIZE=" + bXSize, "BLOCKYSIZE=" +
bYSize};

 

      ds = dv.Create(file, w, h, 1, gdalconst.GDT_Float32, options);

      ba = ds.GetRasterBand(1);

 

      float [] buffer;

      buffer = new float [w * h];

      for (int i = 0; i < buffer.Length; i++)

            buffer[i] = i;

 

      b.WriteRaster(0, 0, w, h, buffer, w, h, 0, 0);

 

      b.FlushCache();

      d.FlushCache();

 

      b.Dispose();

      d.Dispose();

}

 

Thanks for your help and all your work on c# bindings.

 

PIERRET Jean michel.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/4589b000/attachment.html
From sy at perkins.net  Mon Nov 13 15:20:25 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <4558AB9F.60908@loskot.net>
References: <4558A652.2080404@pobox.com> <4558AB9F.60908@loskot.net>
Message-ID: <1163449225.22533.275716375@webmail.messagingengine.com>


On Mon, 13 Nov 2006 18:30:07 +0100, "Mateusz Loskot"
<mateusz@loskot.net> said:
> Frank Warmerdam wrote:
> > Folks,
> > 
> > Following up on Ari's suggestion, I'd like to plan on a new GDAL release
> > by mid December, perhaps with a first official beta December 1st.
> > 
> > What work are people hoping to get into a next GDAL release?
> > [...]
> 
> What about Simon's proposal with manifest embedding for VC++ 8.0?

Actually, that's already been in there for a couple of weeks...

Cheers,

Sy

From mhanson at photon.com  Mon Nov 13 17:33:13 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Library function for listing formats
Message-ID: <0719BE42F22E0A46857DF72644EC5D70461169@pj-exchange.photon.com>

It seems that there should be a function for listing all the suported formats GDAL was compiled with.  I can't find one, does such a think exist?

I have an exe file that uses GDAL.  When the user calls my exe with --help I want to be able to print a list of supported formats.




Matt Hanson

 

Photon Research Associates, Inc.

A Raytheon Company

155 Fleet Street, Suite 13

Portsmouth, NH 03801

(603) 570-4854


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/b624b2eb/attachment.html
From szekerest at gmail.com  Mon Nov 13 17:34:59 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Create Images with GDAL in C#
In-Reply-To: <006001c70758$075b9f30$2201a8c0@pcjmp>
References: <006001c70758$075b9f30$2201a8c0@pcjmp>
Message-ID: <f3b73b7d0611131434o260f4098g16d9411047164bc2@mail.gmail.com>

I've tested the following code with success:

public static void Main(string[] args)
{
          create(args[0]);
}

public static void create(string file)
    {
        Driver dv;
        Dataset ds;
        Band ba;

        int bXSize, bYSize;
        int w, h;

        string [] options;

        w = 100;
        h = 100;

        bXSize = w;
        bYSize = 1;

        gdal.AllRegister();

        dv = gdal.GetDriverByName("GTiff");
        options = new string [] {"BLOCKXSIZE=" + bXSize, "BLOCKYSIZE="
+ bYSize};

        ds = dv.Create(file, w, h, 1, gdalconst.GDT_Byte, options);

        ba = ds.GetRasterBand(1);

        float [] buffer;

        buffer = new float [w * h];

        for (int i = 0; i < buffer.Length; i++)

            buffer[i] = i*256/buffer.Length;

        ba.WriteRaster(0, 0, w, h, buffer, w, h, 0, 0);

        ba.FlushCache();
        ds.FlushCache();

        ba.Dispose();
        ds.Dispose();
    }


Are you using the latest CVS version?

Best Regards,

Tamas Szekeres




2006/11/13, Jean Michel PIERRET <jmp@geosys.com>:
>
>
>
>
> Hi,
>
>
> I've just tried to use the GDAL C#, it's ok to read images,
>
> But i have problem to create images, all my created images are empty.
>
>
>
> public static void create(string file)
>
> {
>
> Driver dv;
>
>       Dataset ds;
>
>       Band ba;
>
>
>
>       int bXSize, bYSize;
>
>       int w, h;
>
>
>
>       string [] options;
>
>
>
>       w = 100;
>
>       h = 100;
>
>
>
>       bXSize = w;
>
>       bYSize = 1;
>
>
>
>       dv = gdal.GetDriverByName("GTiff");
>
>       options = new string [] {"BLOCKXSIZE=" + bXSize, "BLOCKYSIZE=" +
> bYSize};
>
>
>
>       ds = dv.Create(file, w, h, 1, gdalconst.GDT_Float32, options);
>
>       ba = ds.GetRasterBand(1);
>
>
>
>       float [] buffer;
>
>       buffer = new float [w * h];
>
>       for (int i = 0; i < buffer.Length; i++)
>
>             buffer[i] = i;
>
>
>
>       b.WriteRaster(0, 0, w, h, buffer, w, h, 0, 0);
>
>
>
>       b.FlushCache();
>
>       d.FlushCache();
>
>
>
>       b.Dispose();
>
>       d.Dispose();
>
> }
>
>
>
> Thanks for your help and all your work on c# bindings.
>
>
>
> PIERRET Jean michel.
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From warmerdam at pobox.com  Mon Nov 13 18:05:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:27 2007
Subject: [Gdal-dev] Library function for listing formats
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70461169@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70461169@pj-exchange.photon.com>
Message-ID: <4558FA44.9000600@pobox.com>

Matt Hanson wrote:
> It seems that there should be a function for listing all the suported 
> formats GDAL was compiled with.  I can't find one, does such a think exist?
> 
> I have an exe file that uses GDAL.  When the user calls my exe with 
> --help I want to be able to print a list of supported formats.

Matt,

This is the implementation of the --formats help option for most
GDAL programs:

         else if( EQUAL(papszArgv[iArg], "--formats") )
         {
             int iDr;

             printf( "Supported Formats:\n" );
             for( iDr = 0; iDr < GDALGetDriverCount(); iDr++ )
             {
                 GDALDriverH hDriver = GDALGetDriver(iDr);
                 const char *pszRWFlag;

                 if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) )
                     pszRWFlag = "rw+";
                 else if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATECOPY,
                                               NULL ) )
                     pszRWFlag = "rw";
                 else
                     pszRWFlag = "ro";

                 printf( "  %s (%s): %s\n",
                         GDALGetDriverShortName( hDriver ),
                         pszRWFlag,
                         GDALGetDriverLongName( hDriver ) );
             }

             CSLDestroy( papszReturn );
             return 0;
         }

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From rayg at daylongraphics.com  Mon Nov 13 18:12:34 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Library function for listing formats
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70461169@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70461169@pj-exchange.photon.com>
Message-ID: <4558FBE2.2000809@daylongraphics.com>

Matt Hanson wrote:
> It seems that there should be a function for listing all the suported 
> formats GDAL was compiled with.  I can't find one, does such a think exist?
> 
> I have an exe file that uses GDAL.  When the user calls my exe with 
> --help I want to be able to print a list of supported formats.

You can use something like the code below (you'll need to tweak some 
items for your platform, and implement some funcs like dashed_line(), 
but the basic listing feature should be obvious):


	logfile.printf("Using GDAL %d.%d.%d.%d\r\n",
		GDAL_VERSION_MAJOR,
		GDAL_VERSION_MINOR,
		GDAL_VERSION_REV,
		GDAL_VERSION_BUILD);

	logfile.printf("GDAL drivers registered:\r\n");

	GDALDriverManager* drivers = GetGDALDriverManager();
	const size_t numGDALdrivers = drivers->GetDriverCount();

	size_t i, longestDesc = 0, longestName = 0, longestExt = 0;

	for(i = 0; i < numGDALdrivers; i++)
	{
		GDALDriver* driver = drivers->GetDriver(i);
		char** papszMetadata = driver->GetMetadata();
		const char* psz = driver->GetDescription();
		if(psz != NULL)
			longestDesc = max(longestDesc, strlen(psz));
		psz = driver->GetMetadataItem(GDAL_DMD_LONGNAME);
		if(psz != NULL)
			longestName = max(longestName, strlen(psz));
		psz = driver->GetMetadataItem(GDAL_DMD_EXTENSION);
		if(psz != NULL)
			longestExt = max(longestExt, strlen(psz));
	}

	logfile.printf("    %-*s  %-*s  %-*s  %s\r\n",
		longestDesc, "Name",
		longestName, "Description",
		longestExt, "Ext(s)",
		"Capabilities");

	std::vector<char> buf[4];
	buf[0].resize(1 + longestDesc);
	buf[1].resize(1 + longestName);
	buf[2].resize(1 + longestExt);
	buf[3].resize(1 + 15);
	logfile.printf("    %s  %s  %s  %s\r\n",
		dashed_line(longestDesc, buf[0].begin()),
		dashed_line(longestName, buf[1].begin()),
		dashed_line(longestExt, buf[2].begin()),
		dashed_line(15, buf[3].begin()));

	for(i = 0; i < numGDALdrivers; i++)
	{
		GDALDriver* driver = drivers->GetDriver(i);

		CString strCaps = "read-only";
		char** papszMetadata = driver->GetMetadata();
		const BOOL bCopy = CSLFetchBoolean(
			papszMetadata, GDAL_DCAP_CREATECOPY, FALSE);
		const BOOL bCreate = CSLFetchBoolean(
			papszMetadata, GDAL_DCAP_CREATE, FALSE);
		if(bCopy && bCreate)
			strCaps = "create and copy";
		else if(bCopy)
			strCaps = "copy";
		else if(bCreate)
			strCaps = "create";

		logfile.printf(
			"    %-*s  %-*s  %-*s  %s\r\n",
			longestDesc, driver->GetDescription(),
			longestName, driver->GetMetadataItem(GDAL_DMD_LONGNAME),
			longestExt, driver->GetMetadataItem(GDAL_DMD_EXTENSION),
			(const char*)strCaps);
	}
	logfile.printf("\r\n");



Ray

From warmerdam at pobox.com  Mon Nov 13 23:38:56 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray Gardener
Message-ID: <45594860.4030104@pobox.com>


Motion:

I motion to extend commiter priveledges to Ray Gardner.  Ray developed the
Leveller driver, and has made substantial improvements to the BMP driver.
He has also provided a few other fixes, and has an interest in improving
the photometric handling in GDAL.  He has also reviewed and agreed to the
RFC 3 Commiter Guidelines.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From kkirubanantham at yahoo.com  Tue Nov 14 00:20:43 2006
From: kkirubanantham at yahoo.com (kiruba nantham)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Problem : Building GDAL for windows CE 
Message-ID: <20061114052043.35834.qmail@web52203.mail.yahoo.com>

    Hello Mr.  Mateusz,         
                                                          I am sorry to disturb you again and  again, when you are busy.
              Now I am building gdal-cvs-2006.11.13  I have copied all the required headers and libraries to gdal-cvs-2006.11.13  folder. Then I started to build gdal-cvs-2006.11.13 from command  prompt but now it?s throwing this error fatal error LNK1112: module machine  type ?X86? conflicts with target machine type ?ARM?.
             If I  build gdal-cvs-2006.11.13 (evc4_gdalce_dll.vcw workspace) using  EVC++ 4.0. I am getting gdalce_evc4.dll but when I am building gdal-cvs-2006.11.13  source I am getting 130 warnings
  Warnings  are:
     Warning C4530: C++ exception handler used,  but unwind semantics are not  
                            enabled. Specify ?GX.
     Warning C4275: non dll-interface class  'std::basic_string<char,struct 
                            std::char_traits<char>, class  std::allocator<char> >' used as 
                             base for dll-interface class  'CPLString'.
           These two warnings are repeating and
  Linker  Warnings are:
     mitab_feature.obj: warning LNK1166: cannot  adjust code at offset=0x00001000,                                rva=0x0001C7DC.
     mitab_feature_mif.obj: warning LNK1166:  cannot adjust code at 
                                offset=0x00001000, rva=0x000326C0
     ogr_srs_proj4.obj: warning LNK1166: cannot  adjust code at   
                                offset=0x00001000, rva=0x000947D0
     ogrspatialreference.obj: warning LNK1166:  cannot adjust code at 
                                offset=0x00001000, rva=0x000C5794
            And also when it is connecting to emulator it?s prompting  this error (The intel 80486 CPU does not support configuration evc4_gdalce_dll-Win32  (WCE ARMV4) Debug! Executable will not run on device. Continue?) If I give OK  to continue it is building this gdalce_evc4.dll but it is of no use.  Please can you tell me how to solve this?
  Thank  you,
  Kirubanantham.K.  
 
---------------------------------
Everyone is raving about the all-new Yahoo! Mail beta.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061113/73a8d157/attachment.html
From warmerdam at pobox.com  Tue Nov 14 02:03:10 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] swig/python/setup.py
Message-ID: <45596A2E.5040005@pobox.com>

Howard,

The file gdal/swig/python/setup.py includes the line:

os.environ['CFLAGS'] = '-dynamic -g -O3 -Wall'

The -dynamic flag seems to cause terrible problems on my ubuntu
system and at the very least the gcc 3.4.3 info docs indicate it is
a darwin only flag.  Should it be hardcoded in setup.py?  In fact, I
also also a bit dubious about the other options.  What will happen if
the compiler isn't gcc?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jmp at geosys.com  Tue Nov 14 02:55:10 2006
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Create Images with GDAL in C#
In-Reply-To: <f3b73b7d0611131434o260f4098g16d9411047164bc2@mail.gmail.com>
Message-ID: <007601c707c2$361cb790$2201a8c0@pcjmp>


Hi,

I'm using the CVS of 2006.11.09 and it's doesn't work with your new version
of code, but with the CVS of this morning (2006.11.13) it's ok, my images
are good and I can read these with arcview.        

Thanks a lot, for your reactivity and efficiency.

PIERRET Jean michel

-----Message d'origine-----
De?: Tamas Szekeres [mailto:szekerest@gmail.com] 
Envoy??: lundi 13 novembre 2006 23:35
??: Jean Michel PIERRET
Cc?: gdal-dev@lists.maptools.org
Objet?: Re: [Gdal-dev] Create Images with GDAL in C#

I've tested the following code with success:

public static void Main(string[] args)
{
          create(args[0]);
}

public static void create(string file)
    {
        Driver dv;
        Dataset ds;
        Band ba;

        int bXSize, bYSize;
        int w, h;

        string [] options;

        w = 100;
        h = 100;

        bXSize = w;
        bYSize = 1;

        gdal.AllRegister();

        dv = gdal.GetDriverByName("GTiff");
        options = new string [] {"BLOCKXSIZE=" + bXSize, "BLOCKYSIZE="
+ bYSize};

        ds = dv.Create(file, w, h, 1, gdalconst.GDT_Byte, options);

        ba = ds.GetRasterBand(1);

        float [] buffer;

        buffer = new float [w * h];

        for (int i = 0; i < buffer.Length; i++)

            buffer[i] = i*256/buffer.Length;

        ba.WriteRaster(0, 0, w, h, buffer, w, h, 0, 0);

        ba.FlushCache();
        ds.FlushCache();

        ba.Dispose();
        ds.Dispose();
    }


Are you using the latest CVS version?

Best Regards,

Tamas Szekeres




2006/11/13, Jean Michel PIERRET <jmp@geosys.com>:
>
>
>
>
> Hi,
>
>
> I've just tried to use the GDAL C#, it's ok to read images,
>
> But i have problem to create images, all my created images are empty.
>
>
>
> public static void create(string file)
>
> {
>
> Driver dv;
>
>       Dataset ds;
>
>       Band ba;
>
>
>
>       int bXSize, bYSize;
>
>       int w, h;
>
>
>
>       string [] options;
>
>
>
>       w = 100;
>
>       h = 100;
>
>
>
>       bXSize = w;
>
>       bYSize = 1;
>
>
>
>       dv = gdal.GetDriverByName("GTiff");
>
>       options = new string [] {"BLOCKXSIZE=" + bXSize, "BLOCKYSIZE=" +
> bYSize};
>
>
>
>       ds = dv.Create(file, w, h, 1, gdalconst.GDT_Float32, options);
>
>       ba = ds.GetRasterBand(1);
>
>
>
>       float [] buffer;
>
>       buffer = new float [w * h];
>
>       for (int i = 0; i < buffer.Length; i++)
>
>             buffer[i] = i;
>
>
>
>       b.WriteRaster(0, 0, w, h, buffer, w, h, 0, 0);
>
>
>
>       b.FlushCache();
>
>       d.FlushCache();
>
>
>
>       b.Dispose();
>
>       d.Dispose();
>
> }
>
>
>
> Thanks for your help and all your work on c# bindings.
>
>
>
> PIERRET Jean michel.
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>



From schut at sarvision.nl  Tue Nov 14 04:36:43 2006
From: schut at sarvision.nl (Vincent Schut)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal does not write gcp projection
Message-ID: <45598E2B.4020004@sarvision.nl>

Hi Frank, list,

I just filed a bug report 
(http://bugzilla.remotesensing.org/show_bug.cgi?id=1354) on an issue 
we're running into since gdal 1.3.2: when creating a geotiff file with 
gcp's, the gcp projection is not written to the file. In 1.3.1 this was 
working correctly, but in 1.3.2 and cvs from today it is not.

See the bug report for a simple python test case.

Cheers,
Vincent.

From jordi at geoquadtree.org  Tue Nov 14 05:25:06 2006
From: jordi at geoquadtree.org (Jordi Gilabert Vall)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for storing georeferenced
	images
Message-ID: <6d26117e0611140225m6688e380i7aa11e5cf541e5a1@mail.gmail.com>

Hi,

Some time ago I needed the retrieval from very large georeferenced raster
images in a OGC WMS server, and I wanted to avoid the use of tile indexes or
catalogues of images, neither a database. I started thinking of an open
format for storing arbitrarily large georeferenced images. I named this
format "GeoQuadTree", as it would be based on a quadtree of rectangular
tiles, each in PNG format on the filesystem, in a simple hierarchical
structure of folders. I wrote a command line utility for creating it,
importing from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also
wrote a GDAL driver for this format. I tested successfully with my own WMS
server software, and on MapServer compiled with GDAL support. It worked very
well on Blue Marble Next Generation at a resolution of 15 arc-seconds, i.e.
86400x43200 pixels.

You can find more information on the project web site:

http://geoquadtree.org/

I'm testing the release 1.0.0, you can test it on the subversion repository
if you want (I haven't packaged it yet).

I think it's a useful format, open, very easy to use, and very efficient (in
terms of response time).

Do you think it could be useful for you ? Would you like to include it on
GDAL's next release ?

jordi at geoquadtree org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/94011eb4/attachment.html
From mateusz at loskot.net  Tue Nov 14 07:53:38 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Re: Problem : Building GDAL for windows CE
In-Reply-To: <20061114052043.35834.qmail@web52203.mail.yahoo.com>
References: <20061114052043.35834.qmail@web52203.mail.yahoo.com>
Message-ID: <4559BC52.8050807@loskot.net>

kiruba,

Please, give me a day till tomorrow night (Wednesday)
I'm on my way to investigate it in details.
I appologize to for the delay.

Cheers
Mateusz


kiruba nantham wrote:
> Hello Mr. Mateusz,       
> I am sorry to disturb you again and again, when you are busy.
>             Now I am building *gdal-cvs-2006.11.13 *I have copied all
> the required headers and libraries to gdal-cvs-2006.11.13* *folder. Then
> I started to build *gdal-cvs-2006.11.13 *from* *command prompt but now
> it?s throwing this error *fatal error LNK1112: module machine type ?X86?
> conflicts with target machine type ?ARM?*.
>            If I build *gdal-cvs-2006.11.13 (*evc4_gdalce_dll.vcw
> workspace*)* using EVC++ 4.0. I am getting *gdalce_evc4.dll* but when I
> am building *gdal-cvs-2006.11.13 *source I am getting 130 warnings
> Warnings are:
>    Warning C4530: C++ exception handler used, but unwind semantics are not 
>                          enabled. Specify ?GX.
>    Warning C4275: non dll-interface class 'std::basic_string<char,struct
>                          std::char_traits<char>, class
> std::allocator<char> >' used as
>                          base for dll-interface class 'CPLString'.
>          These two warnings are repeating and
> Linker Warnings are:
>    mitab_feature.obj: warning LNK1166: cannot adjust code at
> offset=0x00001000,                               rva=0x0001C7DC.
>    mitab_feature_mif.obj: warning LNK1166: cannot adjust code at
>                              offset=0x00001000, rva=0x000326C0
>    ogr_srs_proj4.obj: warning LNK1166: cannot adjust code at  
>                              offset=0x00001000, rva=0x000947D0
>    ogrspatialreference.obj: warning LNK1166: cannot adjust code at
>                              offset=0x00001000, rva=0x000C5794
>           And also when it is connecting to emulator it?s prompting this
> error (The intel 80486 CPU does not support configuration
> evc4_gdalce_dll-Win32 (WCE ARMV4) Debug! Executable will not run on
> device. Continue?) If I give OK to continue it is building this
> *gdalce_evc4.dll *but it is of no use. Please can you tell me how to
> solve this?
> Thank you,
> Kirubanantham.K.
> 
> ------------------------------------------------------------------------
> Everyone is raving about the all-new Yahoo! Mail beta.
> <http://us.rd.yahoo.com/evt=45083/*http://advision.webevents.yahoo.com/mailbeta>
> 


-- 
Mateusz Loskot
http://mateusz.loskot.net

From usergstat at yahoo.co.uk  Tue Nov 14 08:22:08 2006
From: usergstat at yahoo.co.uk (G C)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] ogr2ogr shapefile to S-57 and AML
Message-ID: <20061114132208.71551.qmail@web28005.mail.ukl.yahoo.com>

Hi,

I am trying to use ogr2ogr to convert a shapefile to S-57 but receive 
the 
following error:

"Layer Anobj not found, and CreateLayer not supported by driver"

The command lines I entered are:

set OGR_S57_OPTIONS 
="RETURN_PRIMITIVES=ON,RETURN_LINKAGES=ON,LNAM_REFS=ON"

and then

ogr2ogr -skipfailures -f S57 eg.000 c:\hurmjr1020\humjr1020.shp

Is it possible to do this type of conversion? If so does anyone know 
what the 
problem might be?
   
  Also, can anyone tell me if Additional MIlitary Layers (AML) is supported by GDAL, if so is that reading and creation?  I see some references to it in the NEWS section of the GDAL website but it does not appear under the supported formats.

Thanks in advance,

Gary



 		
---------------------------------
 Try the all-new Yahoo! Mail . "The New Version is radically easier to use" ? The Wall Street Journal
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/536a36dd/attachment.html
From hobu at iastate.edu  Tue Nov 14 08:22:57 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] swig/python/setup.py
In-Reply-To: <45596A2E.5040005@pobox.com>
References: <45596A2E.5040005@pobox.com>
Message-ID: <9C711841-BD83-4355-A75A-7BF6DCB7C2C6@iastate.edu>

Frank,

Oops.  That's just a spurious commit. I was trying to influence  
distutil's compiler flags on a system install of Python on OSX.  For  
Python 2.3, at least, that hack only causes the flags to go on the  
end instead of replacing them outright.  I was attempting to shut off  
the strict prototypes squawking that OSX defaults to.

Howard



On Nov 14, 2006, at 1:03 AM, Frank Warmerdam wrote:

> Howard,
>
> The file gdal/swig/python/setup.py includes the line:
>
> os.environ['CFLAGS'] = '-dynamic -g -O3 -Wall'
>
> The -dynamic flag seems to cause terrible problems on my ubuntu
> system and at the very least the gcc 3.4.3 info docs indicate it is
> a darwin only flag.  Should it be hardcoded in setup.py?  In fact, I
> also also a bit dubious about the other options.  What will happen if
> the compiler isn't gcc?
>
> Best regards,
> -- 
> --------------------------------------- 
> +--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,  
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http:// 
> osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


From yjacolin at free.fr  Tue Nov 14 09:11:55 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <1163449225.22533.275716375@webmail.messagingengine.com>
References: <4558A652.2080404@pobox.com> <4558AB9F.60908@loskot.net>
	<1163449225.22533.275716375@webmail.messagingengine.com>
Message-ID: <200611141511.55750.yjacolin@free.fr>

Le Lundi 13 Novembre 2006 21:20, Frank Warmerdam wrote:
> Folks,
>
> Following up on Ari's suggestion, I'd like to plan on a new GDAL
> release by mid December, perhaps with a first official beta December
> 1st.
> [...]

Just a question/suggestion, is it possible to allow ogr to clip a region from 
a box or from another vector file like gdal-translate does for raster ? May 
be it already exists ?!

Thanks,

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org

From support at geoimage.fr  Tue Nov 14 10:20:04 2006
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
References: <4558A652.2080404@pobox.com>
Message-ID: <0d2501c70800$5cc0a620$0a01a8c0@pili>

Hello,

> Following up on Ari's suggestion, I'd like to plan on a new GDAL release
> by mid December, perhaps with a first official beta December 1st.
>
> What work are people hoping to get into a next GDAL release?
>

The GDAL ecw driver uses the default 'maximum cache size' value which is 1/4 of RAM.
In some applications it should be nice to be able to specify the amount of memory dedicated to the ECW cache.

The maximum size of the cache can be controlled using
NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, <size in bytes>);

Perhaps a configuration option should be used for that.
The option could be be processed during the driver registration.

void GDALRegister_ECW()
{
#ifdef FRMT_ecw
    GDALDriver *poDriver;

    if( GDALGetDriverByName( "ECW" ) == NULL )
    {
        // Is a Maximum cache size specified in the options ?
       //
        char *szEcwCacheSize = CPLGetConfigOption( "GDAL_ECW_CACHE_MAXMEM", "USE_DEFAULT") ;
        if( ! EQUAL( szEcwCacheSize , "USE_DEFAULT" )
            NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, atoi(szEcwCacheSize) );

        ...

Best regards,

Fr?d?ric.
_________________________________________________________________
Fr?d?ric Trastour - GEOIMAGE - dev@geoimage.fr


From jdgonon at gi-lemans.com  Tue Nov 14 10:27:07 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] 2 problems on GDAL/OGR-1.3.2
References: <mailman.402.1163517656.4069.gdal-dev@lists.maptools.org>
Message-ID: <008001c70801$58bb5510$6469850a@gi.com>

Hi,

nobody has ideas or solutions for my problems in these 2 mails ?


1?    > I had some problems with compilation of GDAL/OGR : problems are 
compatibility between
> "gdal13d.dll" (generated by GDAL/OGR) and ogrinfo.exe because none format 
> (dgn, ...) is recognized.
>
> So I start a new compilation with GDAL/OGR 1.3.2, compiled in command 
> lines without errors.
>
> I had to add " xerces-c_2_3_0-win32 " in gdal-1.3.2\frmts\folder.
>
> Now I have 90 errors in Visual C++ : " gdal error LNK2019: symbole externe 
> non r?solu _ObjectName
> r?f?renc? dans la fonction _ObjectFunction "
>
> My configuration : gdal1.3.2 under MS Visual C++ 2003 (version 7).
>
> I don't know what I can do ?



2?    > Which are the operations to add new OGR format in GDAL/OGR (under 
windows XP) ?
> It's an evolution of DGN format to version 8.
>
> I already start by making a copy of the gdal/ogr/ogrsf_frmts/old_format 
> directory as gdal/ogr/ogrsf_frmts/new_format, and modify (filenames and 
> functions names) accordingly.
>
> After I add the new registration entry point at the bottom of 
> gdal/ogr/ogrsf_frmts/ogrsf_frmts.h, and call it from 
> gda/ogr/ogrsf_frmts/generic/ogrregisterall.cpp.
>
> But the new format isn't detected by ogrinfo.exe when I want to open a DGN 
> version 8 file.
>
> What I must then declare or modify ?


thank you in advance
Jean-Daniel 



From warmerdam at pobox.com  Tue Nov 14 10:55:02 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <200611141511.55750.yjacolin@free.fr>
References: <4558A652.2080404@pobox.com>
	<4558AB9F.60908@loskot.net>	<1163449225.22533.275716375@webmail.messagingengine.com>
	<200611141511.55750.yjacolin@free.fr>
Message-ID: <4559E6D6.9060404@pobox.com>

Yves Jacolin wrote:
> Le Lundi 13 Novembre 2006 21:20, Frank Warmerdam wrote:
>> Folks,
>>
>> Following up on Ari's suggestion, I'd like to plan on a new GDAL
>> release by mid December, perhaps with a first official beta December
>> 1st.
>> [...]
> 
> Just a question/suggestion, is it possible to allow ogr to clip a region from 
> a box or from another vector file like gdal-translate does for raster ? May 
> be it already exists ?!

Yves,

The ogr2ogr program includes a -spat flag that allows you to select a
particular rectangular region of a vector layer.  However, it doesn't
actually clip the returned geometries to the rectangle.  It just selects
all features whose geometries MBR touches the indicated box.

It is possible to do clipping from Python using GEOS through OGR.  You
would need to use the Intersection() method to clip geometries to your
box area of interest.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From yjacolin at free.fr  Tue Nov 14 10:46:41 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <4559E6D6.9060404@pobox.com>
References: <4558A652.2080404@pobox.com> <200611141511.55750.yjacolin@free.fr>
	<4559E6D6.9060404@pobox.com>
Message-ID: <200611141646.41828.yjacolin@free.fr>

Le Mardi 14 Novembre 2006 16:55, Frank Warmerdam a ?crit?:
> Yves Jacolin wrote:
> > Le Lundi 13 Novembre 2006 21:20, Frank Warmerdam wrote:
> >> Folks,
> >>
> >> Following up on Ari's suggestion, I'd like to plan on a new GDAL
> >> release by mid December, perhaps with a first official beta December
> >> 1st.
> >> [...]
> >
> > Just a question/suggestion, is it possible to allow ogr to clip a region
> > from a box or from another vector file like gdal-translate does for
> > raster ? May be it already exists ?!
>
> Yves,
>
> The ogr2ogr program includes a -spat flag that allows you to select a
> particular rectangular region of a vector layer.  However, it doesn't
> actually clip the returned geometries to the rectangle.  It just selects
> all features whose geometries MBR touches the indicated box.
>
> It is possible to do clipping from Python using GEOS through OGR.  You
> would need to use the Intersection() method to clip geometries to your
> box area of interest.
>
> Best regards,
Thank you for your answer. I will study it.

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org


From epatton at nrcan.gc.ca  Tue Nov 14 11:13:45 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Error compiling gdal: libgrass_I.so: cannot open shared
	object file
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C2B@s5-dar-r1.nrn.nrcan.gc.ca>

I receive the following error after trying to run gdalinfo/translate after having successfully running configure, make, and make install on gdal 1.3.2:

libgrass_I.so: cannot open shared object file: No such file or directory

The only errors/warnings that occurred at the end of make was:

/usr/bin/ld: warning: libstdc++.so.5, needed by /usr/local/gdal-1.3.2/.libs/libgdal.so, may conflict with libstdc++.so.6

Note that I specifically complied without Grass support:

./configure \
--without-grass \
--with-png=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-libz=internal \
--with-proj-share=/usr/local/share/proj \
--without-pg \
--with-hdf \
--with-hdf-includes=/usr/include/hdf \
--without-ogdi \
--with-python \
--with-sqlite \
--with-threads=yes

Here's my output from configure:

GDAL is now configured for i686-pc-linux-gnu

  Installation directory:    /usr/local
  C compiler:                gcc -O2
  C++ compiler:              g++ -O2

  LIBTOOL support:           yes

  LIBZ support:              internal
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  NETCDF support:            yes
  LIBPNG support:            internal
  LIBTIFF support:           internal
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  LIBGIF support:            internal
  OGDI support:              no
  HDF4 support:              yes
  HDF5 support:              yes
  KAKADU support:            no
  JASPER support:            yes (GeoJP2=no)
  ECW support:               no
  MrSID support:             no
  POSTGRESQL support:        no
  MySQL support:             no
  XERCES support:            no
  ODBC support:              yes
  OCI support:               no
  SDE support:               no
  DODS support:              no
  SQLite support:            yes
  DWGdirect support          no
  PANORAMA GIS support:      no
  GEOS support:              yes

  Statically link PROJ.4:    no

  Traditional Python:        yes
  NG SWIG Bindings:

  enable OGR building:       yes


Any ideas on what is going wrong? 


Thanks,

~ Eric.


From sy at perkins.net  Tue Nov 14 11:58:01 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <0d2501c70800$5cc0a620$0a01a8c0@pili>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
Message-ID: <1163523481.10018.275798419@webmail.messagingengine.com>



> > What work are people hoping to get into a next GDAL release?

I have one quick question: if we're planning more frequent increments of
the minor version numbers, does that have any impacts on the naming of
the libraries? And beyond that, are we happy with the library naming
scheme we currently use?

It seems that we have rather different approaches on windows and linux.
On windows, the default makefiles incorporate the version number into
the DLL name, so more frequent minor version number changes will mean
more frequent DLL name changes. Probably not a problem since on windows
people typically package the latest version of GDAL along with their
apps. Though what do we do when we reach GDAL 1.10? gdal110.dll?

On linux where it's more common to use a central shared GDAL library, it
seems that we typically don't change the library soname. It's been
libgdal.so.1 for a long time now. I have no idea if the latest GDAL is
actually binary compatible with the earliest version that used that
name. Has that been a problem for anyone?

Anyway, just thinking out loud and wondering if anybody wants to tweak
the current naming scheme. Personally, I'm happy with it as is...

Cheers,

Sy

From warmerdam at pobox.com  Tue Nov 14 12:33:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <0d2501c70800$5cc0a620$0a01a8c0@pili>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
Message-ID: <4559FDF8.4010102@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
>> Following up on Ari's suggestion, I'd like to plan on a new GDAL release
>> by mid December, perhaps with a first official beta December 1st.
>>
>> What work are people hoping to get into a next GDAL release?
>>
> 
> The GDAL ecw driver uses the default 'maximum cache size' value which is 1/4 of RAM.
> In some applications it should be nice to be able to specify the amount of memory dedicated to the ECW cache.
> 
> The maximum size of the cache can be controlled using
> NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, <size in bytes>);
> 
> Perhaps a configuration option should be used for that.
> The option could be be processed during the driver registration.
> 
> void GDALRegister_ECW()
> {
> #ifdef FRMT_ecw
>     GDALDriver *poDriver;
> 
>     if( GDALGetDriverByName( "ECW" ) == NULL )
>     {
>         // Is a Maximum cache size specified in the options ?
>        //
>         char *szEcwCacheSize = CPLGetConfigOption( "GDAL_ECW_CACHE_MAXMEM", "USE_DEFAULT") ;
>         if( ! EQUAL( szEcwCacheSize , "USE_DEFAULT" )
>             NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, atoi(szEcwCacheSize) );

Fr?d?ric,

I have applied this change, but I put it in the ECWInitialize() function
(which is called for use of the SDK for either ecw or jpeg2000 files).
I haven't yet tested it.  What units is the NCSCFG_CACHE_MAXMEM?  Bytes?
I would like to document this in the appropriate driver pages.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dmorissette at mapgears.com  Tue Nov 14 12:13:24 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray Gardener
In-Reply-To: <45594860.4030104@pobox.com>
References: <45594860.4030104@pobox.com>
Message-ID: <4559F934.30101@mapgears.com>

Frank Warmerdam wrote:
> 
> Motion:
> 
> I motion to extend commiter priveledges to Ray Gardner.  Ray developed the
> Leveller driver, and has made substantial improvements to the BMP driver.
> He has also provided a few other fixes, and has an interest in improving
> the photometric handling in GDAL.  He has also reviewed and agreed to the
> RFC 3 Commiter Guidelines.
> 

I don't know Ray, but I'll vote +1 based on Frank's recommendation. 
Welcome Ray!

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From warmerdam at pobox.com  Tue Nov 14 12:38:15 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] 2 problems on GDAL/OGR-1.3.2
In-Reply-To: <008001c70801$58bb5510$6469850a@gi.com>
References: <mailman.402.1163517656.4069.gdal-dev@lists.maptools.org>
	<008001c70801$58bb5510$6469850a@gi.com>
Message-ID: <4559FF07.8010709@pobox.com>

Jean-Daniel GONON wrote:
> Hi,
> 
> nobody has ideas or solutions for my problems in these 2 mails ?
...
>> Now I have 90 errors in Visual C++ : " gdal error LNK2019: symbole 
>> externe non r?solu _ObjectName
>> r?f?renc? dans la fonction _ObjectFunction "

Jean-Daniel,

I have no idea about this.


> 2?    > Which are the operations to add new OGR format in GDAL/OGR 
> (under windows XP) ?
>> It's an evolution of DGN format to version 8.
>>
>> I already start by making a copy of the 
>> gdal/ogr/ogrsf_frmts/old_format directory as 
>> gdal/ogr/ogrsf_frmts/new_format, and modify (filenames and functions 
>> names) accordingly.
>>
>> After I add the new registration entry point at the bottom of 
>> gdal/ogr/ogrsf_frmts/ogrsf_frmts.h, and call it from 
>> gda/ogr/ogrsf_frmts/generic/ogrregisterall.cpp.
>>
>> But the new format isn't detected by ogrinfo.exe when I want to open a 
>> DGN version 8 file.
>>
>> What I must then declare or modify ?

I also don't know why this isn't working.  But I would suggest you
figure out whether your new driver is listed when you do "ogrinfo --formats".

If not, then investigate whether the registration call is actually being
called in ogrregisterall.cpp.  If so, then I would suggest adding debug
messages in your open function to see if it is being invoked at all.  If
not, perhaps a previous driver is trying to open the file, and failing.
Normally each driver is tried in turn till one either succeeds or one
fails issuing an error.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From hobu at iastate.edu  Tue Nov 14 12:20:31 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray
  Gardener
In-Reply-To: <4559F934.30101@mapgears.com>
References: <45594860.4030104@pobox.com>
 <4559F934.30101@mapgears.com>
Message-ID: <6.2.3.4.2.20061114112013.02ca0048@hobu.mail.iastate.edu>

At 11:13 AM 11/14/2006, Daniel Morissette wrote:
>Frank Warmerdam wrote:
>>Motion:
>>I motion to extend commiter priveledges to Ray Gardner.  Ray developed the
>>Leveller driver, and has made substantial improvements to the BMP driver.
>>He has also provided a few other fixes, and has an interest in improving
>>the photometric handling in GDAL.  He has also reviewed and agreed to the
>>RFC 3 Commiter Guidelines.
>
>I don't know Ray, but I'll vote +1 based on Frank's recommendation. 
>Welcome Ray!

+1

Howard 


From warmerdam at pobox.com  Tue Nov 14 12:56:50 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Error compiling gdal: libgrass_I.so: cannot open shared
	object file
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C2B@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C26208C55C2B@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <455A0362.5070306@pobox.com>

Patton, Eric wrote:
> I receive the following error after trying to run gdalinfo/translate after
> having successfully running configure, make, and make install on gdal 1.3.2:
> 
> 
> libgrass_I.so: cannot open shared object file: No such file or directory
> 
> The only errors/warnings that occurred at the end of make was:
> 
> /usr/bin/ld: warning: libstdc++.so.5, needed by
> /usr/local/gdal-1.3.2/.libs/libgdal.so, may conflict with libstdc++.so.6
> 
> Note that I specifically complied without Grass support:

Eric,

I'm guessing you are either not running the version of GDAL you just
installed, or you have a grass driver plugin sitting out there.  If
gdalinfo still works despite the message then it is likely a plugin.
Look in /usr/local/lib/gdalplugins and delete any grass plugins you
find.  Otherwise check to see if there are any old libgdal.so type files
sitting somewhere on your system.  "local libgdal.so" should be your friend
for this.

It is also possible that you didn't do a make clean from a previous
build.  GDAL's build is very sloppy about reacting to configure changes.
If you reconfigure you should also do a "make clean".

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From Chris.Barker at noaa.gov  Tue Nov 14 13:26:41 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <1163523481.10018.275798419@webmail.messagingengine.com>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
	<1163523481.10018.275798419@webmail.messagingengine.com>
Message-ID: <455A0A61.1060804@noaa.gov>

Simon Perkins wrote:

> On linux where it's more common to use a central shared GDAL library, it
> seems that we typically don't change the library soname. It's been
> libgdal.so.1 for a long time now. I have no idea if the latest GDAL is
> actually binary compatible with the earliest version that used that
> name. Has that been a problem for anyone?

Ideally,

libgdal.so.1 would be a link to libgdal.so.1.4, which would be a link to 
libgdal.so.1.4.0 ---

The libgdal.so.1 link would change to the latest version, as newer ones 
were installed, but the older ones could stick around, and could be 
linked to if need be.

In general, the goal is for binary compatibility between minor version 
number changes. (i.e 1.4.1 should be binary compatible with 1.4.0)

-Chris





-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From ILucena at clarku.edu  Tue Nov 14 13:47:39 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray Gardener
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455022550E3@Iris.ad.clarku.edu>

Well,

I don't know Daniel either but I agree with him:

+1 to Ray. Be welcome!

+1 to Commiter Guidelines. I examined it, I have followed the discussion
and I agree with it.

---
Ivan Lucena


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Daniel
Morissette
Sent: Tuesday, November 14, 2006 12:13 PM
To: gdal-dev
Subject: Re: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray
Gardener

Frank Warmerdam wrote:
> 
> Motion:
> 
> I motion to extend commiter priveledges to Ray Gardner.  Ray developed
the
> Leveller driver, and has made substantial improvements to the BMP
driver.
> He has also provided a few other fixes, and has an interest in
improving
> the photometric handling in GDAL.  He has also reviewed and agreed to
the
> RFC 3 Commiter Guidelines.
> 

I don't know Ray, but I'll vote +1 based on Frank's recommendation. 
Welcome Ray!

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From matt.wilkie at gov.yk.ca  Tue Nov 14 14:29:18 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for storing georeferenced
	images
In-Reply-To: <6d26117e0611140225m6688e380i7aa11e5cf541e5a1@mail.gmail.com>
References: <6d26117e0611140225m6688e380i7aa11e5cf541e5a1@mail.gmail.com>
Message-ID: <455A190E.8050909@gov.yk.ca>

Hi Jordi, geoquadtree sounds interesting. I've been wondering about 
something similar myself (as an end user, I can't program my way out of 
a wet paper bag) as I've been trying to efficiently use OnEarth imagery 
and elevation data over a large area (c.f. earlier msg re how to "for 
each poly do X").

My only question at this point, until a binary is available for me to 
play with, is how are you retaining georeferencing? PNG does not allow 
for it. Does this mean the only way to access the proper position for 
any given tile will be through the geoquadtree driver?

While I've long been a png afficionado, for spatial data I much prefer 
geotiff because the referencing can never be orphaned by simply 
forgetting to copy it along with the image file itself.


cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From bfraser at geoanalytic.com  Tue Nov 14 15:05:23 2006
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for storing
	georeferencedimages
References: <6d26117e0611140225m6688e380i7aa11e5cf541e5a1@mail.gmail.com>
Message-ID: <00f301c70828$385f6b40$160002c0@shark>

For those interested tiling,

  There is similar tiling related discussion/work going on at:

        http://lists.eogeo.org/mailman/listinfo/tiling (do they have a web page?)

    and 
            http://www.stereofx.org/terrain.html, implemented in http://vterrain.org/, particularly VTBuilder (http://vterrain.org/Doc/VTBuilder/overview.html)

Brent Fraser
  ----- Original Message ----- 
  From: Jordi Gilabert Vall 
  To: gdal-dev@lists.maptools.org 
  Sent: Tuesday, November 14, 2006 3:25 AM
  Subject: [Gdal-dev] GeoQuadTree - an open format for storing georeferencedimages


  Hi,

  Some time ago I needed the retrieval from very large georeferenced raster images in a OGC WMS server, and I wanted to avoid the use of tile indexes or catalogues of images, neither a database. I started thinking of an open format for storing arbitrarily large georeferenced images. I named this format "GeoQuadTree", as it would be based on a quadtree of rectangular tiles, each in PNG format on the filesystem, in a simple hierarchical structure of folders. I wrote a command line utility for creating it, importing from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also wrote a GDAL driver for this format. I tested successfully with my own WMS server software, and on MapServer compiled with GDAL support. It worked very well on Blue Marble Next Generation at a resolution of 15 arc-seconds, i.e. 86400x43200 pixels. 
  You can find more information on the project web site:

  http://geoquadtree.org/ 

  I'm testing the release 1.0.0, you can test it on the subversion repository if you want (I haven't packaged it yet).


  I think it's a useful format, open, very easy to use, and very efficient (in terms of response time).

  Do you think it could be useful for you ? Would you like to include it on GDAL's next release ?

  jordi at geoquadtree org



------------------------------------------------------------------------------


  _______________________________________________
  Gdal-dev mailing list
  Gdal-dev@lists.maptools.org
  http://lists.maptools.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/c92e66ae/attachment.html
From ed at topozone.com  Tue Nov 14 15:35:35 2006
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for
	storinggeoreferencedimages
Message-ID: <4BF377919225F449BB097CB76FFE9BC801987BAD@ptolemy.topozone.com>

Jordi -
 
You said you wanted to "avoid the use of tile indexes or catalogues of
images", but isn't that exactly what your XML catalogue/index does?  It
seems that the GeoQuadTree format is a different form of that same sort
of structure.  There are several different ways of doing this now,
including the TILEINDEX mechanism, tiled TIFF files, etc.  I'm sure
there are limitations to each, but I'm not sure that yet another tiling
scheme will help.
 
In particular, PNG is not the best format for all images, and it's
important to support other encoding mechanisms, especially JPEG.
Photographic images are huge when stored in PNG format, and JPEG is
usually a much better choice.  Conversely, scanned line art and
synthetic images generally compress and store better as PNG images.
 
    - Ed
Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 


________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Brent Fraser
Sent: Tuesday, November 14, 2006 3:05 PM
To: Jordi Gilabert Vall; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GeoQuadTree - an open format for
storinggeoreferencedimages


For those interested tiling,
 
  There is similar tiling related discussion/work going on at:
 
        http://lists.eogeo.org/mailman/listinfo/tiling
<http://lists.eogeo.org/mailman/listinfo/tiling>  (do they have a web
page?)
 
    and 
            http://www.stereofx.org/terrain.html, implemented in
http://vterrain.org/, particularly VTBuilder
(http://vterrain.org/Doc/VTBuilder/overview.html)
 
Brent Fraser

	----- Original Message ----- 
	From: Jordi Gilabert Vall <mailto:jordi@geoquadtree.org>  
	To: gdal-dev@lists.maptools.org 
	Sent: Tuesday, November 14, 2006 3:25 AM
	Subject: [Gdal-dev] GeoQuadTree - an open format for storing
georeferencedimages

	Hi,
	
	Some time ago I needed the retrieval from very large
georeferenced raster images in a OGC WMS server, and I wanted to avoid
the use of tile indexes or catalogues of images, neither a database. I
started thinking of an open format for storing arbitrarily large
georeferenced images. I named this format "GeoQuadTree", as it would be
based on a quadtree of rectangular tiles, each in PNG format on the
filesystem, in a simple hierarchical structure of folders. I wrote a
command line utility for creating it, importing from PNG/JPEG/TIFF and
exporting to PNG/JPEG/TIFF/GDAL. I also wrote a GDAL driver for this
format. I tested successfully with my own WMS server software, and on
MapServer compiled with GDAL support. It worked very well on Blue Marble
Next Generation at a resolution of 15 arc-seconds, i.e. 86400x43200
pixels. 

	You can find more information on the project web site:

	http://geoquadtree.org/ 

	I'm testing the release 1.0.0, you can test it on the subversion
repository if you want (I haven't packaged it yet).
	

	I think it's a useful format, open, very easy to use, and very
efficient (in terms of response time).

	Do you think it could be useful for you ? Would you like to
include it on GDAL's next release ?

	jordi at geoquadtree org

	
________________________________


	

	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@lists.maptools.org
	http://lists.maptools.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/af96b2e9/attachment.html
From rrossel at airsage.com  Tue Nov 14 15:37:07 2006
From: rrossel at airsage.com (Richard Rossel)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] ogr2ogr convertion data type problem
Message-ID: <73478880611141237r7deb4e08k878d093db70b7730@mail.gmail.com>

Hi fellows,
I have a problem with ogr2ogr -f "ESRI Shapefile". I have an Atlas
data with a field as:
ID: Real (15.0)
Well, input file has a large ID, for example 17560002064459
but, after ogr2ogr, the new shapefile has all ID as : -2147483648

I think that is a convertion data type problem, but I don't know how
can I fix this problem.
This is the ogr2ogr script:
 ogr2ogr -f "ESRI Shapefile"  -where "FEATTYP = '4110' AND ONEWAY
!='N'" -select "ID,FEATTYP,METERS,FRC,ROUTENUM"  suiza
cheche________nw.shp

Help please!
thanks.-

-- 
Richard Rossel
Valparaiso - Chile

From s_larosa at libero.it  Sat Nov 11 11:23:36 2006
From: s_larosa at libero.it (Salvatore Larosa)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
	<455348E5.5080507@pobox.com>
	<200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
Message-ID: <7294124.post@talk.nabble.com>



Even I get it same error!
Have you resolved it?
-- 
View this message in context: http://www.nabble.com/gdal-install-errors-tf2602238.html#a7294124
Sent from the GDAL - Dev mailing list archive at Nabble.com.


From barnaby.burman at ntlworld.com  Tue Nov 14 18:35:09 2006
From: barnaby.burman at ntlworld.com (Barnaby Burman)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Newbie Question - setting projection when using ogr2ogr
	utility
Message-ID: <20061114233505.EJID15733.aamtaout04-winn.ispmail.ntl.com@athlon>

Hi,

I am new to using org2ogr, and wish to use it to translate some ArcView
Shape files into MapInfo Table format. The translation works fine when using
the standard commands, but I want to set the projection to OSGB 1936.

At present, I'm quite stuck on the setting the projection type using SRS -
has anyone got an idea as to how this can be set?

This works example string works for the conversion, but doesn't set the
projection:

ogr2ogr -f "MapInfo File" -select XSP r1-xsp.tab r1-xsp.shp

Thanks if anyone can be of assistance,

Regards,

Barnaby Burman


From craig.miller at spatialminds.com  Tue Nov 14 19:21:32 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Geodatabase drive and layer types
Message-ID: <009701c7084c$014cb710$3301a8c0@vaio>

The ESRI Geodatabase driver always returns wkbUnknown as the layer type.  It
originally returned the type as described in the Geodatabase but when I
discovered that some wkbPoint layers also had wkbMultipoints Frank updated
the code to always return wkbUnknown.  At the time this seemed like the most
reasonable solution.  Since then I've done a bit of thinking and have a few
ideas for possible workarounds:

3 separate ideas from the simplest to the most complex:

- Return wkbGeometry instead of wkbUnknown:  ESRI describes the datatype for
each layer but then goes on to mix the datatype.  E.g. in a point layer you
see point/multipoint values.  So, the description they provide is enough to
confirm that it is in fact geometry in the table and not just tabular data.
This seems to align better with the wkbGeometry type.

- Inspect Geometry:  Force the driver to inspect all geometry and decide for
itself what the type is.  This is expensive, but is consistent with the
layer extent function.  Once inspected it would be returned as wkbPoint,
wkbMultipoint, etc, or wkbGeometry if mixed Type/multiType.

- Force to one type:  return the layer type as is described in the meta data
table.  When fetching geometry the driver could automatically force the type
to the one described.  This is my favorite because everything behaves as
expected and is transparent to the user of OGR which is the primary reason
for using a library like this (to get the same view onto all data sources).

--Craig





From epk.lists at gmail.com  Tue Nov 14 20:31:01 2006
From: epk.lists at gmail.com (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] ODBC can't connect using SQL statement
Message-ID: <2d1782780611141731x77074ffcub6a2b787fa9357e1@mail.gmail.com>

Hi,

I'm trying to access a point data table using MapServer through OGR VRT
driver but I'm having errors.

My data table is at SQL Server 2000 and I already created a system dns for
this database.

If I run:
$ ogrinfo ODBC:myuser/mypassword@MYDSN -sql "SELECT * FROM PointTable WHERE
themonth > 10"
this works fine

But when I try in MapServer:

    LAYER
        CONNECTION "<OGRVRTDataSource>
    <OGRVRTLayer name='pts'>
        <SrcDataSource>ODBC:myuser/mypassword@MYDSN</SrcDataSource>
        <SrcSQL>SELECT PointTable.* FROM PointTable WHERE themonth >
10</SrcSQL>
        <GeometryField encoding='PointFromColumns' x='Long' y='Lat'/>
        <GeometryType>wkbPoint</GeometryType>
    </OGRVRTLayer>
</OGRVRTDataSource>"
        CONNECTIONTYPE OGR
        DATA "pts"
        NAME "ptsodbc"
        STATUS DEFAULT
        TYPE POINT
        CLASS
            COLOR 255 0 0
            SIZE 6
            SYMBOL "sym_basic"
        END
    END

Then I got:
/* -----
msDrawMap(): Image handling error. Failed to draw layer named 'ptsodbc'.
msOGRFileNextShape(): OGR error. SetAttributeFilter() not supported on
ExecuteSQL() results.
msEvalContext: Expression parser error. Failed to parse context
msyyparse(): Expression parser error. syntax error
--- */

I only was able to filter data at this point table using FILTER and
FILTERITEM keywords at mapfile, but only using regular expressions . Logical
expressions does not show any point.

Is that something wrong at my connection string or is this a bug to be
solved using GDAL CVS ?

best,

-- 
Eduardo Patto Kanegae
http://www.webmapit.com.br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/66f95a0e/attachment.html
From warmerdam at pobox.com  Tue Nov 14 21:23:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Geodatabase drive and layer types
In-Reply-To: <009701c7084c$014cb710$3301a8c0@vaio>
References: <009701c7084c$014cb710$3301a8c0@vaio>
Message-ID: <455A7A34.4070801@pobox.com>

Craig Miller wrote:
> The ESRI Geodatabase driver always returns wkbUnknown as the layer type.  It
> originally returned the type as described in the Geodatabase but when I
> discovered that some wkbPoint layers also had wkbMultipoints Frank updated
> the code to always return wkbUnknown.  At the time this seemed like the most
> reasonable solution.  Since then I've done a bit of thinking and have a few
> ideas for possible workarounds:
> 
> 3 separate ideas from the simplest to the most complex:
> 
> - Return wkbGeometry instead of wkbUnknown:  ESRI describes the datatype for
> each layer but then goes on to mix the datatype.  E.g. in a point layer you
> see point/multipoint values.  So, the description they provide is enough to
> confirm that it is in fact geometry in the table and not just tabular data.
> This seems to align better with the wkbGeometry type.
> 
> - Inspect Geometry:  Force the driver to inspect all geometry and decide for
> itself what the type is.  This is expensive, but is consistent with the
> layer extent function.  Once inspected it would be returned as wkbPoint,
> wkbMultipoint, etc, or wkbGeometry if mixed Type/multiType.
> 
> - Force to one type:  return the layer type as is described in the meta data
> table.  When fetching geometry the driver could automatically force the type
> to the one described.  This is my favorite because everything behaves as
> expected and is transparent to the user of OGR which is the primary reason
> for using a library like this (to get the same view onto all data sources).

Craig,

There is currently no such thing as wkbGeometry, and I'm leery about adding
new fake types.  Also, wkbGeometry doesn't really provide much additional
information over wkbUnknown.

I am really unwilling to read and process all geometries in the table.  This
is very expensive.  Note that layer type must be established at open time
when all the OGRLayer objects are initialized, so we would be faced with
reading every geometry in the database to establish all the layers types.
Ouch!  Note that layer extents are different in that the application has to
specifically ask for them.  We also provide means for applications to ask for
them only if they are cheap to compute.

Force to one type (ie. always promote to "multi" types) would be reasonable
but I have to think there are lots and lots of applications and even
OGR drivers that don't know how to handle geometry container types gracefully
or efficiently.  I'd really rather not have to do this though of the three
options I think it is the most plausible.

But I prefer to stick with option 4 which is don't indicate the geometry
type.

Perhaps we should consider adding a "return a list of possible concrete
geometry types" method that could be invoked on a layer as an extension?
This could return a list such as "wkbPoint,wkbMultiPoint".  It would give
applications that really want to know more about the geometry types that
occur something to call.  And potentially we could even scan the database
for some formats if appropriate.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sy at perkins.net  Tue Nov 14 20:51:37 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	for	storinggeoreferencedimages
In-Reply-To: <4BF377919225F449BB097CB76FFE9BC801987BAD@ptolemy.topozone.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BAD@ptolemy.topozone.com>
Message-ID: <455A72A9.5070706@perkins.net>


TIFF has some pretty serious file size limitations so wouldn't be good 
for these kinds of large rasters. I'm not familiar with TILEINDEX, but 
is this a MapServer related thing? Is that applicable to local image 
storage on the desktop?

I think the GeoQuadTree idea is interesting - it doesn't rely on large 
file support on the OS (not that that's a serious problem for any modern 
OSes), and dealing with lots of small files could be more efficient than 
one large file in some cases I would think.

As for PNG vs JPEG, it depends on whether you're happy to accept lossy 
compression or not. For many applications, customers are averse to 
losing any resolution. It might make sense to make the underlying file 
format in GeoQuadTree flexible acording to application. Actually, I'd 
prefer to see a format that can handle multispectral files - PNG and 
JPEG are both limited to 1 or 3 bands, aren't they? Or are multiple 
bands stored as separate grayscale images?

I would guess that with very large rasters, some sort of pyramid scheme 
becomes important in addition to the tiling, so that if you just want to 
get an overview of the whole image, you don't have to read every single 
file. Does GeoQuadTree handle that?

But, Ed is right that storing very large rasters is a not a new problem. 
So, what do people do? I guess that at the high end, outfits like Google 
Earth use a spatial database to organize multiple individual raster 
files and then stich them together. Could somebody outline the solution 
used by the Virtual Terrain project?

Cheers,

Sy


Ed McNierney wrote:
> Jordi -
>  
> You said you wanted to "avoid the use of tile indexes or catalogues of 
> images", but isn't that exactly what your XML catalogue/index does?  
> It seems that the GeoQuadTree format is a different form of that same 
> sort of structure.  There are several different ways of doing this 
> now, including the TILEINDEX mechanism, tiled TIFF files, etc.  I'm 
> sure there are limitations to each, but I'm not sure that yet another 
> tiling scheme will help.
>  
> In particular, PNG is not the best format for all images, and it's 
> important to support other encoding mechanisms, especially JPEG.  
> Photographic images are huge when stored in PNG format, and JPEG is 
> usually a much better choice.  Conversely, scanned line art and 
> synthetic images generally compress and store better as PNG images.
>  
>     - Ed
>
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA  01863
> ed@topozone.com
> (978) 251-4242
>
>
> ------------------------------------------------------------------------
> *From:* gdal-dev-bounces@lists.maptools.org 
> [mailto:gdal-dev-bounces@lists.maptools.org] *On Behalf Of *Brent Fraser
> *Sent:* Tuesday, November 14, 2006 3:05 PM
> *To:* Jordi Gilabert Vall; gdal-dev@lists.maptools.org
> *Subject:* Re: [Gdal-dev] GeoQuadTree - an open format for 
> storinggeoreferencedimages
>
> For those interested tiling,
>  
>   There is similar tiling related discussion/work going on at:
>  
>         http://lists.eogeo.org/mailman/listinfo/tiling (do they have a 
> web page?)
>  
>     and
>             http://www.stereofx.org/terrain.html, implemented in 
> http://vterrain.org/, particularly VTBuilder 
> (http://vterrain.org/Doc/VTBuilder/overview.html)
>  
> Brent Fraser
>
>     ----- Original Message -----
>     *From:* Jordi Gilabert Vall <mailto:jordi@geoquadtree.org>
>     *To:* gdal-dev@lists.maptools.org
>     <mailto:gdal-dev@lists.maptools.org>
>     *Sent:* Tuesday, November 14, 2006 3:25 AM
>     *Subject:* [Gdal-dev] GeoQuadTree - an open format for storing
>     georeferencedimages
>
>     Hi,
>
>     Some time ago I needed the retrieval from very large georeferenced
>     raster images in a OGC WMS server, and I wanted to avoid the use
>     of tile indexes or catalogues of images, neither a database. I
>     started thinking of an open format for storing arbitrarily large
>     georeferenced images. I named this format "GeoQuadTree", as it
>     would be based on a quadtree of rectangular tiles, each in PNG
>     format on the filesystem, in a simple hierarchical structure of
>     folders. I wrote a command line utility for creating it, importing
>     from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also
>     wrote a GDAL driver for this format. I tested successfully with my
>     own WMS server software, and on MapServer compiled with GDAL
>     support. It worked very well on Blue Marble Next Generation at a
>     resolution of 15 arc-seconds, i.e. 86400x43200 pixels.
>
>     You can find more information on the project web site:
>
>     http://geoquadtree.org/ <http://geoquadtree.org/>
>
>     I'm testing the release 1.0.0, you can test it on the subversion
>     repository if you want (I haven't packaged it yet).
>
>     I think it's a useful format, open, very easy to use, and very
>     efficient (in terms of response time).
>
>     Do you think it could be useful for you ? Would you like to
>     include it on GDAL's next release ?
>
>     jordi at geoquadtree org
>
>     ------------------------------------------------------------------------
>     _______________________________________________
>     Gdal-dev mailing list
>     Gdal-dev@lists.maptools.org
>     http://lists.maptools.org/mailman/listinfo/gdal-dev
>
> ------------------------------------------------------------------------
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/37871a68/attachment.html
From warmerdam at pobox.com  Tue Nov 14 21:54:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Newbie Question - setting projection when using ogr2ogr
	utility
In-Reply-To: <20061114233505.EJID15733.aamtaout04-winn.ispmail.ntl.com@athlon>
References: <20061114233505.EJID15733.aamtaout04-winn.ispmail.ntl.com@athlon>
Message-ID: <455A8159.9080705@pobox.com>

Barnaby Burman wrote:
> Hi,
> 
> I am new to using org2ogr, and wish to use it to translate some ArcView
> Shape files into MapInfo Table format. The translation works fine when using
> the standard commands, but I want to set the projection to OSGB 1936.
> 
> At present, I'm quite stuck on the setting the projection type using SRS -
> has anyone got an idea as to how this can be set?
> 
> This works example string works for the conversion, but doesn't set the
> projection:
> 
> ogr2ogr -f "MapInfo File" -select XSP r1-xsp.tab r1-xsp.shp
> 
> Thanks if anyone can be of assistance,

Barnaby,

I think you would want to add an -a_srs option something like:

ogr2ogr -a_srs '+proj=latlong 
+towgs84=446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894 +ellps=airy'
...

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ed at topozone.com  Tue Nov 14 21:06:04 2006
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	for	storinggeoreferencedimages
Message-ID: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>

Simon -
 
TILEINDEX is a MapServer/quasi-GDAL mechanism for handling a large
number of rasters as a single unit.  The rasters don't need to be the
same size, and can overlap - I suspect they can even be different file
formats, although I've never tried, and they can be stored anywhere in
the file system.
 
The TILEINDEX scheme uses an ESRI shapefile (with an optional quadtree
index on it) as a spatial index for the rasters.  One polygon is
generated for each raster, with that polygon representing the bounding
box of that file.  The path to the raster file itself is stored as a
string attribute of the polygon.  Applications use the spatial/geometry
features of the polygon to determine which input image(s) if any
intersect the area of interest for drawing.
 
It's not the same sort of thing, exactly, and there are no tools I'm
aware of for managing the individual image organization on disk.  But it
works well for me.  I use TILEINDEX structures to manage about 500,000
individual raster files that are about 40 terabytes altogether (haven't
counted lately <g>).  It could certainly use enhancement, but it might
be a good starting point for such a project.
 
    - Ed
Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
Phone: +1 (978) 251-4242
Fax: +1 (978) 251-1396
ed@topozone.com 


________________________________

From: Simon Perkins [mailto:sy@perkins.net] 
Sent: Tuesday, November 14, 2006 8:52 PM
To: Ed McNierney
Cc: Brent Fraser; Jordi Gilabert Vall; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GeoQuadTree - an open format for
storinggeoreferencedimages



TIFF has some pretty serious file size limitations so wouldn't be good
for these kinds of large rasters. I'm not familiar with TILEINDEX, but
is this a MapServer related thing? Is that applicable to local image
storage on the desktop?

I think the GeoQuadTree idea is interesting - it doesn't rely on large
file support on the OS (not that that's a serious problem for any modern
OSes), and dealing with lots of small files could be more efficient than
one large file in some cases I would think.

As for PNG vs JPEG, it depends on whether you're happy to accept lossy
compression or not. For many applications, customers are averse to
losing any resolution. It might make sense to make the underlying file
format in GeoQuadTree flexible acording to application. Actually, I'd
prefer to see a format that can handle multispectral files - PNG and
JPEG are both limited to 1 or 3 bands, aren't they? Or are multiple
bands stored as separate grayscale images?

I would guess that with very large rasters, some sort of pyramid scheme
becomes important in addition to the tiling, so that if you just want to
get an overview of the whole image, you don't have to read every single
file. Does GeoQuadTree handle that?

But, Ed is right that storing very large rasters is a not a new problem.
So, what do people do? I guess that at the high end, outfits like Google
Earth use a spatial database to organize multiple individual raster
files and then stich them together. Could somebody outline the solution
used by the Virtual Terrain project?

Cheers,

Sy


Ed McNierney wrote: 

	Jordi -
	 
	You said you wanted to "avoid the use of tile indexes or
catalogues of images", but isn't that exactly what your XML
catalogue/index does?  It seems that the GeoQuadTree format is a
different form of that same sort of structure.  There are several
different ways of doing this now, including the TILEINDEX mechanism,
tiled TIFF files, etc.  I'm sure there are limitations to each, but I'm
not sure that yet another tiling scheme will help.
	 
	In particular, PNG is not the best format for all images, and
it's important to support other encoding mechanisms, especially JPEG.
Photographic images are huge when stored in PNG format, and JPEG is
usually a much better choice.  Conversely, scanned line art and
synthetic images generally compress and store better as PNG images.
	 
	    - Ed
	Ed McNierney
	President and Chief Mapmaker
	TopoZone.com / Maps a la carte, Inc.
	73 Princeton Street, Suite 305
	North Chelmsford, MA  01863
	ed@topozone.com
	(978) 251-4242 


________________________________

	From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Brent Fraser
	Sent: Tuesday, November 14, 2006 3:05 PM
	To: Jordi Gilabert Vall; gdal-dev@lists.maptools.org
	Subject: Re: [Gdal-dev] GeoQuadTree - an open format for
storinggeoreferencedimages
	
	
	For those interested tiling,
	 
	  There is similar tiling related discussion/work going on at:
	 
	        http://lists.eogeo.org/mailman/listinfo/tiling
<http://lists.eogeo.org/mailman/listinfo/tiling>  (do they have a web
page?)
	 
	    and 
	            http://www.stereofx.org/terrain.html, implemented in
http://vterrain.org/, particularly VTBuilder
(http://vterrain.org/Doc/VTBuilder/overview.html)
	 
	Brent Fraser

		----- Original Message ----- 
		From: Jordi Gilabert Vall <mailto:jordi@geoquadtree.org>

		To: gdal-dev@lists.maptools.org 
		Sent: Tuesday, November 14, 2006 3:25 AM
		Subject: [Gdal-dev] GeoQuadTree - an open format for
storing georeferencedimages

		Hi,
		
		Some time ago I needed the retrieval from very large
georeferenced raster images in a OGC WMS server, and I wanted to avoid
the use of tile indexes or catalogues of images, neither a database. I
started thinking of an open format for storing arbitrarily large
georeferenced images. I named this format "GeoQuadTree", as it would be
based on a quadtree of rectangular tiles, each in PNG format on the
filesystem, in a simple hierarchical structure of folders. I wrote a
command line utility for creating it, importing from PNG/JPEG/TIFF and
exporting to PNG/JPEG/TIFF/GDAL. I also wrote a GDAL driver for this
format. I tested successfully with my own WMS server software, and on
MapServer compiled with GDAL support. It worked very well on Blue Marble
Next Generation at a resolution of 15 arc-seconds, i.e. 86400x43200
pixels. 

		You can find more information on the project web site:

		http://geoquadtree.org/ 

		I'm testing the release 1.0.0, you can test it on the
subversion repository if you want (I haven't packaged it yet).
		

		I think it's a useful format, open, very easy to use,
and very efficient (in terms of response time).

		Do you think it could be useful for you ? Would you like
to include it on GDAL's next release ?

		jordi at geoquadtree org

		

________________________________

		_______________________________________________
		Gdal-dev mailing list
		Gdal-dev@lists.maptools.org
		http://lists.maptools.org/mailman/listinfo/gdal-dev

	
________________________________


	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@lists.maptools.org
	http://lists.maptools.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061114/5a3102e9/attachment.html
From craig.miller at spatialminds.com  Tue Nov 14 21:10:32 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Geodatabase drive and layer types
In-Reply-To: <455A7A34.4070801@pobox.com>
Message-ID: <009c01c7085b$3ac0d2b0$3301a8c0@vaio>

My mistake.  I meant wkbGeometryCollection not wkbGeometry.  While not
solving my particular problem I believe this is a more accurate description
of what is happening in the Personal Geodatabase driver right now.

Your suggestion for a method to get all possible types would be ideal.
Thinking out loud...
  
Pros:
- wkbMultiPoint layers won't be downgraded to wkbPoint.
- Many benefits for displaying layers in a GUI.
- Potentially low computational cost when type is known out-right, or is
known by observation (e.g. personal geodatabase point layer is mixed
wkbPoint and wkbMultiPoint).  Would wkbGeometryCollection layers return all
possible types or only the actual types in the layer?  The latter seems to
be more expensive.

Cons:
- Requires an implementation from all drivers.  Default implementation could
just return GetType() result.  
- Like #2, this seems potentially expensive to compute. 

--Craig


-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, November 14, 2006 6:24 PM
To: Craig Miller
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Geodatabase drive and layer types

Craig Miller wrote:
> The ESRI Geodatabase driver always returns wkbUnknown as the layer 
> type.  It originally returned the type as described in the Geodatabase 
> but when I discovered that some wkbPoint layers also had 
> wkbMultipoints Frank updated the code to always return wkbUnknown.  At 
> the time this seemed like the most reasonable solution.  Since then 
> I've done a bit of thinking and have a few ideas for possible workarounds:
> 
> 3 separate ideas from the simplest to the most complex:
> 
> - Return wkbGeometry instead of wkbUnknown:  ESRI describes the 
> datatype for each layer but then goes on to mix the datatype.  E.g. in 
> a point layer you see point/multipoint values.  So, the description 
> they provide is enough to confirm that it is in fact geometry in the table
and not just tabular data.
> This seems to align better with the wkbGeometry type.
> 
> - Inspect Geometry:  Force the driver to inspect all geometry and 
> decide for itself what the type is.  This is expensive, but is 
> consistent with the layer extent function.  Once inspected it would be 
> returned as wkbPoint, wkbMultipoint, etc, or wkbGeometry if mixed
Type/multiType.
> 
> - Force to one type:  return the layer type as is described in the 
> meta data table.  When fetching geometry the driver could 
> automatically force the type to the one described.  This is my 
> favorite because everything behaves as expected and is transparent to 
> the user of OGR which is the primary reason for using a library like this
(to get the same view onto all data sources).

Craig,

There is currently no such thing as wkbGeometry, and I'm leery about adding
new fake types.  Also, wkbGeometry doesn't really provide much additional
information over wkbUnknown.

I am really unwilling to read and process all geometries in the table.  This
is very expensive.  Note that layer type must be established at open time
when all the OGRLayer objects are initialized, so we would be faced with
reading every geometry in the database to establish all the layers types.
Ouch!  Note that layer extents are different in that the application has to
specifically ask for them.  We also provide means for applications to ask
for them only if they are cheap to compute.

Force to one type (ie. always promote to "multi" types) would be reasonable
but I have to think there are lots and lots of applications and even OGR
drivers that don't know how to handle geometry container types gracefully or
efficiently.  I'd really rather not have to do this though of the three
options I think it is the most plausible.

But I prefer to stick with option 4 which is don't indicate the geometry
type.

Perhaps we should consider adding a "return a list of possible concrete
geometry types" method that could be invoked on a layer as an extension?
This could return a list such as "wkbPoint,wkbMultiPoint".  It would give
applications that really want to know more about the geometry types that
occur something to call.  And potentially we could even scan the database
for some formats if appropriate.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From rayg at daylongraphics.com  Tue Nov 14 23:54:33 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Motion: Extend Commiter Priveledges to Ray Gardener
In-Reply-To: <4559F934.30101@mapgears.com>
References: <45594860.4030104@pobox.com> <4559F934.30101@mapgears.com>
Message-ID: <455A9D89.4090105@daylongraphics.com>

Daniel Morissette wrote:
  > I don't know Ray, but I'll vote +1 based on Frank's recommendation.
> Welcome Ray!

Thank you. It's both an honor and a privilege (assuming it goes forward).

Admittedly my contributions stem from integration work being done on 
Daylon products and will likely taper off greatly once that is done, but 
never quite zero since the connection has been made. I see great 
possibilities in the farther future, e.g., GDAL 2, fueled by the 
experiences gained.

Ray

From hellik at web.de  Wed Nov 15 02:18:07 2006
From: hellik at web.de (Helmut Kudrnovsky)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdalwarp - from Monte_Mario_Italy_1 to
 ETRF_1989_UTM_Zone_32N - offset ca. 120 m
Message-ID: <891570797@web.de>

hi,

i have a tif-file with a world-file and warped the file with prj-files from arcgis for source and target.

-s_srs sourcep.prj

PROJCS["Monte_Mario_Italy_1",
GEOGCS["GCS_Monte_Mario",
DATUM["D_Monte_Mario",
SPHEROID["International_1924",6378388.0,297.0]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",500000.0],
PARAMETER["False_Northing",-5000000.0],
PARAMETER["Central_Meridian",9.0],
PARAMETER["Scale_Factor",0.9996],
PARAMETER["Latitude_Of_Origin",0.0],
UNIT["Meter",1.0]]

-t_srs targetp.prj

PROJCS["ETRF_1989_UTM_Zone_32N",
GEOGCS["GCS_ETRF_1989",
DATUM["D_ETRF_1989",
SPHEROID["WGS_1984",6378137.0,298.257223563]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",500000.0],
PARAMETER["False_Northing",0.0],
PARAMETER["Central_Meridian",9.0],
PARAMETER["Scale_Factor",0.9996],
PARAMETER["Latitude_Of_Origin",0.0],
UNIT["Meter",1.0]]

i`ve looked into the warped tif-file. there is an offset of about 120 m in north-south-direction.
should i try gdalwarp maybe with the according epsg-code for source and target?

gdalwarp of fwtools 1.0.8 on win 2000-machine

with greetings from austria and thanks in advance
helli


______________________________________________________________________________
"Ein Herz f?r Kinder" - Ihre Spende hilft! Aktion: www.deutschlandsegelt.de
Unser Dankesch?n: Ihr Name auf dem Segel der 1. deutschen America's Cup-Yacht!



From jordi at geoquadtree.org  Wed Nov 15 03:51:05 2006
From: jordi at geoquadtree.org (Jordi Gilabert Vall)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for
	storinggeoreferencedimages
In-Reply-To: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>
Message-ID: <6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>

As far as I know, TILEINDEX is a MapServer related thing. Can a GDAL-linked
application access to it ?

In TILEINDEX, the list of files forming a layer are stored in a shapefile
with polygons representing the footprint of each file, and the name of the
files. In GeoQuadTree there is no need of a spatial index, tile index,
catalog of images, or a database. There is a simple algorithm that
calculates the specific level of the pyramid, and the specific tiles to
access. The algorithm calculates the path in the filesystem needed to
retrieve the tiles. The XML file in the GeoQuadTree doesn't include a
catalogue/index, it only need 6 attributes: the name of the tile file names,
the number of levels in the pyramid of overviews, the size of the pixel in
CRS units, and the size of the tile in pixels. If you import overlapped
images into the same GeoQuadTree image, the common region of one will be
overwritten with the other.

As an example, I loaded NASA's Blue Marble Next Generation at a resolution
of 15-arc-seconds. This is an image of 86400x43200 pixels in size, that is
about 2.5 GB on disk. I chose the size of the tiles as 270x270 pixels. There
were built 52015 tiles. When I said that i wanted to "avoid  the use of tile
indexes or catalogues of images", I meant that in order to manage a so huge
quantity of tiles, you need a database. The database can be very efficient,
but it's sure that it's even more efficient if you don't need one, and of
course much simpler. For instance, you can write a simple web viewer that
can do all this calculations, without a database. You only need a web
server. I wrote a viewer like similar to Google Maps or Windows Live Maps,
and you could view almost instantaneously images of 2000x2000 pixels in
size, or greater. The response time was only affected by the time needed by
the web server to send the tile images to your browser.

I only wanted a lossless compression, so I chose PNG format for tiles, but
many people also wants a lossless compression, so I'm going to support two
types of compression, PNG and maybe JPEG or JPEG2000. I like the PNG format
because with 4-bands PNGs (RGBA), the alpha channel allows me to store
non-data pixels. With JPEG format, I would "sacrifice" a RGB color to
represent non-data values. There is also the need of supporting multi-band
images, this could be accomplished with as many PNGs as bands. These are
small changes, I will try to make it on the next release.

On the other side, I think storage space is not the big problem nowadays. I
prefer more efficient algorithms in terms of CPU usage, than efficient in
terms of storage space. If someone prefer the reduction of storage space,
the wavelet compression approach could be preferred (LizardTech's MrSID, ER
Mapper's...). I want the freedom to choose a simpler, efficient an FREE
approach.

GeoQuadTree handles a pyramid of overviews. When you create a GeoQuadTree
image, you specifiy the number of levels in the pyramid. Every time you
import a image into a GeoQuadTree, the utility builds the pyramid of
overviews (only updates the tiles affected upside in the pyramid).

Thank you for your interest all you comments,

Jordi


On 11/15/06, Ed McNierney <ed@topozone.com> wrote:
>
>  Simon -
>
> TILEINDEX is a MapServer/quasi-GDAL mechanism for handling a large number
> of rasters as a single unit.  The rasters don't need to be the same size,
> and can overlap - I suspect they can even be different file formats,
> although I've never tried, and they can be stored anywhere in the file
> system.
>
> The TILEINDEX scheme uses an ESRI shapefile (with an optional quadtree
> index on it) as a spatial index for the rasters.  One polygon is generated
> for each raster, with that polygon representing the bounding box of that
> file.  The path to the raster file itself is stored as a string attribute of
> the polygon.  Applications use the spatial/geometry features of the polygon
> to determine which input image(s) if any intersect the area of interest for
> drawing.
>
> It's not the same sort of thing, exactly, and there are no tools I'm aware
> of for managing the individual image organization on disk.  But it works
> well for me.  I use TILEINDEX structures to manage about 500,000 individual
> raster files that are about 40 terabytes altogether (haven't counted lately
> <g>).  It could certainly use enhancement, but it might be a good starting
> point for such a project.
>
>     - Ed
>
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA  01863
> Phone: +1 (978) 251-4242
> Fax: +1 (978) 251-1396
> ed@topozone.com
>
>  ------------------------------
> *From:* Simon Perkins [mailto:sy@perkins.net]
> *Sent:* Tuesday, November 14, 2006 8:52 PM
> *To:* Ed McNierney
> *Cc:* Brent Fraser; Jordi Gilabert Vall; gdal-dev@lists.maptools.org
> *Subject:* Re: [Gdal-dev] GeoQuadTree - an open format for
> storinggeoreferencedimages
>
>
> TIFF has some pretty serious file size limitations so wouldn't be good for
> these kinds of large rasters. I'm not familiar with TILEINDEX, but is this a
> MapServer related thing? Is that applicable to local image storage on the
> desktop?
>
> I think the GeoQuadTree idea is interesting - it doesn't rely on large
> file support on the OS (not that that's a serious problem for any modern
> OSes), and dealing with lots of small files could be more efficient than one
> large file in some cases I would think.
>
> As for PNG vs JPEG, it depends on whether you're happy to accept lossy
> compression or not. For many applications, customers are averse to losing
> any resolution. It might make sense to make the underlying file format in
> GeoQuadTree flexible acording to application. Actually, I'd prefer to see a
> format that can handle multispectral files - PNG and JPEG are both limited
> to 1 or 3 bands, aren't they? Or are multiple bands stored as separate
> grayscale images?
>
> I would guess that with very large rasters, some sort of pyramid scheme
> becomes important in addition to the tiling, so that if you just want to get
> an overview of the whole image, you don't have to read every single file.
> Does GeoQuadTree handle that?
>
> But, Ed is right that storing very large rasters is a not a new problem.
> So, what do people do? I guess that at the high end, outfits like Google
> Earth use a spatial database to organize multiple individual raster files
> and then stich them together. Could somebody outline the solution used by
> the Virtual Terrain project?
>
> Cheers,
>
> Sy
>
>
> Ed McNierney wrote:
>
> Jordi -
>
> You said you wanted to "avoid the use of tile indexes or catalogues of
> images", but isn't that exactly what your XML catalogue/index does?  It
> seems that the GeoQuadTree format is a different form of that same sort of
> structure.  There are several different ways of doing this now, including
> the TILEINDEX mechanism, tiled TIFF files, etc.  I'm sure there are
> limitations to each, but I'm not sure that yet another tiling scheme will
> help.
>
> In particular, PNG is not the best format for all images, and it's
> important to support other encoding mechanisms, especially JPEG.
> Photographic images are huge when stored in PNG format, and JPEG is usually
> a much better choice.  Conversely, scanned line art and synthetic images
> generally compress and store better as PNG images.
>
>     - Ed
>
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA  01863
> ed@topozone.com
> (978) 251-4242
>
>  ------------------------------
> *From:* gdal-dev-bounces@lists.maptools.org [
> mailto:gdal-dev-bounces@lists.maptools.org<gdal-dev-bounces@lists.maptools.org>]
> *On Behalf Of *Brent Fraser
> *Sent:* Tuesday, November 14, 2006 3:05 PM
> *To:* Jordi Gilabert Vall; gdal-dev@lists.maptools.org
> *Subject:* Re: [Gdal-dev] GeoQuadTree - an open format for
> storinggeoreferencedimages
>
> For those interested tiling,
>
>   There is similar tiling related discussion/work going on at:
>
>         http://lists.eogeo.org/mailman/listinfo/tiling (do they have a web
> page?)
>
>     and
>             http://www.stereofx.org/terrain.html, implemented in
> http://vterrain.org/, particularly VTBuilder (
> http://vterrain.org/Doc/VTBuilder/overview.html)
>
> Brent Fraser
>
> ----- Original Message -----
> *From:* Jordi Gilabert Vall <jordi@geoquadtree.org>
> *To:* gdal-dev@lists.maptools.org
> *Sent:* Tuesday, November 14, 2006 3:25 AM
> *Subject:* [Gdal-dev] GeoQuadTree - an open format for storing
> georeferencedimages
>
> Hi,
>
> Some time ago I needed the retrieval from very large georeferenced raster
> images in a OGC WMS server, and I wanted to avoid the use of tile indexes or
> catalogues of images, neither a database. I started thinking of an open
> format for storing arbitrarily large georeferenced images. I named this
> format "GeoQuadTree", as it would be based on a quadtree of rectangular
> tiles, each in PNG format on the filesystem, in a simple hierarchical
> structure of folders. I wrote a command line utility for creating it,
> importing from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also
> wrote a GDAL driver for this format. I tested successfully with my own WMS
> server software, and on MapServer compiled with GDAL support. It worked very
> well on Blue Marble Next Generation at a resolution of 15 arc-seconds, i.e.
> 86400x43200 pixels.
>
> You can find more information on the project web site:
>
> http://geoquadtree.org/
>
> I'm testing the release 1.0.0, you can test it on the subversion
> repository if you want (I haven't packaged it yet).
>
> I think it's a useful format, open, very easy to use, and very efficient
> (in terms of response time).
>
> Do you think it could be useful for you ? Would you like to include it on
> GDAL's next release ?
>
> jordi at geoquadtree org
>
> ------------------------------
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
> ------------------------------
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.orghttp://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/f9711214/attachment.html
From neteler at itc.it  Wed Nov 15 04:08:49 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdalwarp - from Monte_Mario_Italy_1 to
	ETRF_1989_UTM_Zone_32N - offset ca. 120 m
In-Reply-To: <891570797@web.de>
References: <891570797@web.de>
Message-ID: <20061115090849.GB14441@bartok.itc.it>

On Wed, Nov 15, 2006 at 08:18:07AM +0100, Helmut Kudrnovsky wrote:
> hi,
> 
> i have a tif-file with a world-file and warped the file with prj-files from arcgis for source and target.
> 
> -s_srs sourcep.prj
> 
> PROJCS["Monte_Mario_Italy_1",
> GEOGCS["GCS_Monte_Mario",
> DATUM["D_Monte_Mario",
> SPHEROID["International_1924",6378388.0,297.0]],
> PRIMEM["Greenwich",0.0],
> UNIT["Degree",0.0174532925199433]],
> PROJECTION["Transverse_Mercator"],
> PARAMETER["False_Easting",500000.0],
> PARAMETER["False_Northing",-5000000.0],
> PARAMETER["Central_Meridian",9.0],
> PARAMETER["Scale_Factor",0.9996],
> PARAMETER["Latitude_Of_Origin",0.0],
> UNIT["Meter",1.0]]
> 
> -t_srs targetp.prj
> 
> PROJCS["ETRF_1989_UTM_Zone_32N",
> GEOGCS["GCS_ETRF_1989",
> DATUM["D_ETRF_1989",
> SPHEROID["WGS_1984",6378137.0,298.257223563]],
> PRIMEM["Greenwich",0.0],
> UNIT["Degree",0.0174532925199433]],
> PROJECTION["Transverse_Mercator"],
> PARAMETER["False_Easting",500000.0],
> PARAMETER["False_Northing",0.0],
> PARAMETER["Central_Meridian",9.0],
> PARAMETER["Scale_Factor",0.9996],
> PARAMETER["Latitude_Of_Origin",0.0],
> UNIT["Meter",1.0]]
> 
> i`ve looked into the warped tif-file. there is an offset of about 120 m in north-south-direction.
> should i try gdalwarp maybe with the according epsg-code for source and target?
> 
> gdalwarp of fwtools 1.0.8 on win 2000-machine
> 
> with greetings from austria and thanks in advance

helli,

you are lacking the datum information for Monte Mario:
(grep'ed from GRASS):

rome40 "towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68" "Italy (Peninsular Part)" "Accuracy 3-4m"
rome40 "towgs84=-168.6,-34.0,38.6,-0.374,-0.679,-1.379,-9.48" "Italy (Sardinia)" "Accuracy 3-4m"
rome40 "towgs84=-50.2,-50.4,84.8,-0.690,-2.012,0.459,-28.08" "Italy (Sicily)" "Accuracy 3-4m"

which needs to be added as additional parameter.

Markus

-- 
Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
MPBA - Predictive Models for Biol. & Environ. Data Analysis
Via Sommarive, 18        -       38050 Povo (Trento), Italy

From nhv at cape.com  Wed Nov 15 04:58:13 2006
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	forstoringgeoreferencedimages
In-Reply-To: <6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>
Message-ID: <200611150958.kAF9wHUc017881@smtp10.cape.com>

Jordi Gilabert Vall wrote:
>
> In GeoQuadTree there is no 
> need of a spatial index, tile index, catalog of images, or a 
> database. There is a simple algorithm that calculates the 
> specific level of the pyramid, and the specific tiles to 
> access. The algorithm calculates the path in the filesystem 
> needed to retrieve the tiles. The XML file in the GeoQuadTree 
> doesn't include a catalogue/index, it only need 6 attributes: 
> the name of the tile file names, the number of levels in the 
> pyramid of overviews, the size of the pixel in CRS units, and 
> the size of the tile in pixels. If you import overlapped 
> images into the same GeoQuadTree image, the common region of 
> one will be overwritten with the other. 

Jordi

Nice work.  

This is very similar to several tile caches used for programs such as 
NASA's World Wind and ossimPlanet

Several comments

1) It 'might' be useful if this was made to appear as a GeoTiff
   e.g. if there were a mechanism to support the same metadata that
        is stored in the required GeoTiff GeoTags

2) If when constructing the quadtree one could pass in the desired 
   levels to be 'constructed'.  This could be just the minimum level
   one wants built where the maximum level was determined by the 
   'pixel ground footprint size'

I have collected bits of older similar code used to build similar caches
that I am willing to share if you are interested 

The exciting part of your work is the attempt to GDAL'ize this concept.

Cheers

Norman



From support at geoimage.fr  Wed Nov 15 06:56:01 2006
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
Message-ID: <0ffc01c708ad$05aa9be0$0a01a8c0@pili>

Hello,

should it be possible to include the correction of this bug
http://bugzilla.remotesensing.org/show_bug.cgi?id=1009
in release 1.4 ?

Fr?d?ric.


From cgonzalez at cepropa.com.ar  Wed Nov 15 07:37:22 2006
From: cgonzalez at cepropa.com.ar (Christian M. Gonzalez)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] C# Bindings Error
Message-ID: <!&!AAAAAAAAAAAYAAAAAAAAANLXt1zFQQVEuOhN3zURNNfigAAAEAAAAMo9L2LqwHxCnPLHwPaxvVIBAAAAAA==@cepropa.com.ar>

Hello,

 

I downloaded the cvs zip from 2006-11-14.

I had success in building the gdal library, but when I tried to build the C#
bindings, I got the following errors:

 

--- BEGIN: COPY OF SCREEN ----------------------------

 

C:\gdal\swig\csharp>nmake -f makefile.vc interface

 

Microsoft (R) Program Maintenance Utility Version 8.00.50727.42

Copyright (C) Microsoft Corporation.  All rights reserved.

 

        cd const

        C:\swig\swigwin-1.3.30\swig.exe -csharp -namespace GDAL -dllimport
gdal_gdalconst_wrap -o gdalconst_wrap.c ../../include/gdalconst.i

        cd ..

        cd gdal

        C:\swig\swigwin-1.3.30\swig.exe -c++ -csharp -namespace GDAL
-dllimport  gdal_gdal_wrap -I../../include/csharp -o gdal_wrap.cpp
../../include/gdal.i

..\..\include\MajorObject.i(54): Error: No methodmodifiers attribute defined
in csdestruct typemap for MajorObject.

..\..\include\Driver.i(97): Error: No methodmodifiers attribute defined in
csdestruct_derived typemap for Driver.

..\..\include\gdal.i(324): Error: No methodmodifiers attribute defined in
csdestruct typemap for GCP.

..\..\include\Dataset.i(225): Error: No methodmodifiers attribute defined in
csdestruct_derived typemap for Dataset.

../../include/csharp\gdal_csharp_extend.i(34): Error: No methodmodifiers
attribute defined in csdestruct_derived typemap for Band.

..\..\include\ColorTable.i(57): Error: No methodmodifiers attribute defined
in csdestruct typemap for ColorTable.

NMAKE : fatal error U1077: 'C:\swig\swigwin-1.3.30\swig.exe' : return code
'0x6'

 

Stop.

 

--- END: COPY OF SCREEN ----------------------------

 

Could anyone tell me if I made a mistake in the process?

Thanks a lot.

 

Christian Gonzalez

CEPROPA

Patagonia - Argentina

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/27777bcc/attachment.html
From warmerdam at pobox.com  Wed Nov 15 09:32:51 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <0ffc01c708ad$05aa9be0$0a01a8c0@pili>
References: <0ffc01c708ad$05aa9be0$0a01a8c0@pili>
Message-ID: <455B2513.1010203@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> should it be possible to include the correction of this bug
> http://bugzilla.remotesensing.org/show_bug.cgi?id=1009
> in release 1.4 ?

Fr?d?ric,

The bug requests a OGRStyleTool destruction method to ensure
the delete occurs in the same heap where they are created.  It seems
like a very good idea.

Would you like to propose a patch I can apply?  I make relatively little
use of the ogr style classes and methods and am generally hesitant to
change them.

Andrey - since you are working in this area currently perhaps you would
be willing to take this bug report?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 09:51:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdalwarp - from Monte_Mario_Italy_1
	to	ETRF_1989_UTM_Zone_32N - offset ca. 120 m
In-Reply-To: <20061115090849.GB14441@bartok.itc.it>
References: <891570797@web.de> <20061115090849.GB14441@bartok.itc.it>
Message-ID: <455B2974.7090801@pobox.com>

> On Wed, Nov 15, 2006 at 08:18:07AM +0100, Helmut Kudrnovsky wrote:
>> hi,
>>
>> i have a tif-file with a world-file and warped the file with prj-files from arcgis for source and target.
>>
>> -s_srs sourcep.prj
>>
>> PROJCS["Monte_Mario_Italy_1",
>> GEOGCS["GCS_Monte_Mario",
>> DATUM["D_Monte_Mario",
>> SPHEROID["International_1924",6378388.0,297.0]],
>> PRIMEM["Greenwich",0.0],
>> UNIT["Degree",0.0174532925199433]],
>> PROJECTION["Transverse_Mercator"],
>> PARAMETER["False_Easting",500000.0],
>> PARAMETER["False_Northing",-5000000.0],
>> PARAMETER["Central_Meridian",9.0],
>> PARAMETER["Scale_Factor",0.9996],
>> PARAMETER["Latitude_Of_Origin",0.0],
>> UNIT["Meter",1.0]]
...

Markus Neteler wrote:
> helli,
> 
> you are lacking the datum information for Monte Mario:
> (grep'ed from GRASS):
> 
> rome40 "towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68" "Italy (Peninsular Part)" "Accuracy 3-4m"
> rome40 "towgs84=-168.6,-34.0,38.6,-0.374,-0.679,-1.379,-9.48" "Italy (Sardinia)" "Accuracy 3-4m"
> rome40 "towgs84=-50.2,-50.4,84.8,-0.690,-2.012,0.459,-28.08" "Italy (Sicily)" "Accuracy 3-4m"
> 
> which needs to be added as additional parameter.

I would add that the datum shift info can be merged into the Well Known Text
.prj file.  I assume the above parameters apply to D_Monte_Mario in which
case source.prj might look like:

PROJCS["Monte_Mario_Italy_1",
GEOGCS["GCS_Monte_Mario",
DATUM["D_Monte_Mario",
SPHEROID["International_1924",6378388.0,297.0],
TOWGS84[-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",500000.0],
PARAMETER["False_Northing",-5000000.0],
PARAMETER["Central_Meridian",9.0],
PARAMETER["Scale_Factor",0.9996],
PARAMETER["Latitude_Of_Origin",0.0],
UNIT["Meter",1.0]]

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 10:07:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	for	storinggeoreferencedimages
In-Reply-To: <6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>
	<6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>
Message-ID: <455B2D40.8030006@pobox.com>

Jordi Gilabert Vall wrote:
> I only wanted a lossless compression, so I chose PNG format for tiles, 
> but many people also wants a lossless compression, so I'm going to 
> support two types of compression, PNG and maybe JPEG or JPEG2000. I like 
> the PNG format because with 4-bands PNGs (RGBA), the alpha channel 
> allows me to store non-data pixels. With JPEG format, I would 
> "sacrifice" a RGB color to represent non-data values. There is also the 
> need of supporting multi-band images, this could be accomplished with as 
> many PNGs as bands. These are small changes, I will try to make it on 
> the next release.
> 
> On the other side, I think storage space is not the big problem 
> nowadays. I prefer more efficient algorithms in terms of CPU usage, than 
> efficient in terms of storage space. If someone prefer the reduction of 
> storage space, the wavelet compression approach could be preferred 
> (LizardTech's MrSID, ER Mapper's...). I want the freedom to choose a 
> simpler, efficient an FREE approach.
> 
> GeoQuadTree handles a pyramid of overviews. When you create a 
> GeoQuadTree image, you specifiy the number of levels in the pyramid. 
> Every time you import a image into a GeoQuadTree, the utility builds the 
> pyramid of overviews (only updates the tiles affected upside in the 
> pyramid).

Jordi,

I would be interested in incorporating your geoquadtree gdal driver into
the mainline GDAL source tree, but I see that it is licensed under the GPL.
In the interest of simplicity of licensing I prefer to keep all the core
GDAL source tree to the MIT/X license already used.  So, unless you are
interested in licensing the driver in a GDAL compatible form, I think it
will need to stay as a plugin.

I would like to see the XML metadata file for geoquadtree format include
a coordinate system element with the coordinate system in Well Known Text
format.  An alternative might be in anything supported for SRS names in the
OGC WxS specifications (such like EPSG:4326 or the OGC URN specifications).

I also would like to see some flexibility in the format of the tiles.  At
the very least png, and jpeg.  JPEG2000, and TIFF might also be desirable.
TIFF I mention because of the flexibility of pixel data types, and
multispectral support.  Of course TIFF is a bit heavy for very small tiles.

You mentioned above about having to sacrifice an RGB color for a nodata
marker with jpeg format, but this doesn't really work because jpeg is so
lossy.  So it is essentially impossible to use nodata values with jpeg.

Overall I would have preferred to see a GeoQuadTree format that was also
a valid instance of the url view of a "standard tile cache" per all the
"tile cache standard" work being done by various folks.  That would be
super-cool, but perhaps not a high priority for you.

PS. A very nice professional job on the geoquadtree.org web site.  But it
lacks in ... humanity.  Perhaps an FAQ on who did the work and why?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 10:10:16 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GDAL on koders.com
Message-ID: <455B2DD8.1020701@pobox.com>

Folks,

Apprently I submitted GDAL to the koders.com "code search" web site.  They
report:

"""
Hello, Frank Warmerdam

We'd like to inform you that we've added the GDAL project to our index.  Some 
helpful tips are below:

1) Enter GDAL into the Koders search box and you will be able to browse and 
search your project by clicking on its name in the list to the right.

2) Here is the direct link to the project: 
http://koders.com/info.aspx?c=ProjectInfo&pid=RNTRP1H6RPT2UALTHTDUP3ZYWE

3) To add a search box that is scoped to this project only, follow the 
instructions at this link:

http://www.koders.com/info.aspx?c=tools#Scoped

We are moving to a weekly update cycle, so any future submissions will be 
applied to our index within 7 days. Thank you for your submission and continued 
support.

Regards,
The Koders Team
"""

I see GeoTools, OSSIM, openscenegraph, OGDI and a few other community projects
are also in their code search database.  Perhaps folks will find it a useful
capability.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 10:19:37 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] ODBC can't connect using SQL statement
In-Reply-To: <2d1782780611141731x77074ffcub6a2b787fa9357e1@mail.gmail.com>
References: <2d1782780611141731x77074ffcub6a2b787fa9357e1@mail.gmail.com>
Message-ID: <455B3009.2030502@pobox.com>

Eduardo Patto Kanegae wrote:
> Hi,
> 
> I'm trying to access a point data table using MapServer through OGR VRT 
> driver but I'm having errors.
> 
> My data table is at SQL Server 2000 and I already created a system dns 
> for this database.
> 
> If I run:
> $ ogrinfo ODBC:myuser/mypassword@MYDSN -sql "SELECT * FROM PointTable 
> WHERE themonth > 10"
> this works fine
> 
> But when I try in MapServer:
...
> Then I got:
> /* -----
> msDrawMap(): Image handling error. Failed to draw layer named 'ptsodbc'.
> msOGRFileNextShape(): OGR error. SetAttributeFilter() not supported on 
> ExecuteSQL() results.
> msEvalContext: Expression parser error. Failed to parse context
> msyyparse(): Expression parser error. syntax error
> --- */
> 
> I only was able to filter data at this point table using FILTER and 
> FILTERITEM keywords at mapfile, but only using regular expressions . 
> Logical expressions does not show any point.
> 
> Is that something wrong at my connection string or is this a bug to be 
> solved using GDAL CVS ?

Eduardo,

In gda/ogr/ogrsf_frmts/odbc/ogrodbcselectlayer.cpp I see:

  * Revision 1.4  2006/05/15 18:14:31  fwarmerdam
  * Use generic mechanism for SetAttributeFilter() (bug 1185)

Unfortunately this was shortly after the GDAL 1.3.2 release.  So yes,
I believe you need to update to GDAL CVS (well a nightly snapshot is fine).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 10:55:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <455A0A61.1060804@noaa.gov>
References: <4558A652.2080404@pobox.com>
	<0d2501c70800$5cc0a620$0a01a8c0@pili>	<1163523481.10018.275798419@webmail.messagingengine.com>
	<455A0A61.1060804@noaa.gov>
Message-ID: <455B3867.3060802@pobox.com>

Christopher Barker wrote:
> Simon Perkins wrote:
> 
>> On linux where it's more common to use a central shared GDAL library, it
>> seems that we typically don't change the library soname. It's been
>> libgdal.so.1 for a long time now. I have no idea if the latest GDAL is
>> actually binary compatible with the earliest version that used that
>> name. Has that been a problem for anyone?
> 
> Ideally,
> 
> libgdal.so.1 would be a link to libgdal.so.1.4, which would be a link to 
> libgdal.so.1.4.0 ---
> 
> The libgdal.so.1 link would change to the latest version, as newer ones 
> were installed, but the older ones could stick around, and could be 
> linked to if need be.
> 
> In general, the goal is for binary compatibility between minor version 
> number changes. (i.e 1.4.1 should be binary compatible with 1.4.0)

Christopher / Simon,

Currently there are three naming conventions used.  The one that Christopher
describes is used on Unix when GDAL is built --without-libtool.   When
built with libtool something somewhat similar is used but with funkier
verison numbers that don't correspond directly to release numbers.

On windows the DLL is always called GDAL13.DLL since the GDAL 1.3.0 release.

I'm not planning any changes for the unix versioning.

But for windows, I can't help but think we should be doing something smarter.
However, lacking soft links I'm not sure how to get the same flexiblity as
we have on unix.  I'd like to have windows DLLs with names like
GDAL140.DLL but I'd also like a way of understanding that applications using
the GDAL C API can generally use any relatively recent GDAL DLL.  Is there
a normal way of handling this sort of thing on windows?  Is it goig to be
a lot of work?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 11:03:04 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Geodatabase drive and layer types
In-Reply-To: <009c01c7085b$3ac0d2b0$3301a8c0@vaio>
References: <009c01c7085b$3ac0d2b0$3301a8c0@vaio>
Message-ID: <455B3A38.7050705@pobox.com>

Craig Miller wrote:
> My mistake.  I meant wkbGeometryCollection not wkbGeometry.  While not
> solving my particular problem I believe this is a more accurate description
> of what is happening in the Personal Geodatabase driver right now.
> 
> Your suggestion for a method to get all possible types would be ideal.
> Thinking out loud...
>   
> Pros:
> - wkbMultiPoint layers won't be downgraded to wkbPoint.

Craig,

Note - I had expected to have to go the other way, promoting points
to multipoint.

> - Many benefits for displaying layers in a GUI.
> - Potentially low computational cost when type is known out-right, or is
> known by observation (e.g. personal geodatabase point layer is mixed
> wkbPoint and wkbMultiPoint).  Would wkbGeometryCollection layers return all
> possible types or only the actual types in the layer?  The latter seems to
> be more expensive.

This is a bit uncertain.  Do we want to restrict drivers to only returning
the types that *actually* appear in a layer?  Or to try?  For instance for
our geodatabase case I would expect it to return wkbPoint + wkbMultiPoint even
if no actual multipoints occured.

> Cons:
> - Requires an implementation from all drivers.  Default implementation could
> just return GetType() result.  

Note, we can easily supply a default implementation that returns the existing
layer type if it is specific or else falls back to scanning the layer.  So
we would only need to implement it for drivers that can do something smarter.

> - Like #2, this seems potentially expensive to compute. 

I think the key is that expensive computation is deferred to a method that
only applications that really care would call.  Rather than paying it for
all layers up front at open time.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mirhassanali at gmail.com  Wed Nov 15 10:15:04 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Generating images from .tab and .shp files
Message-ID: <b41d86b30611150715r392f52deie9a587a20d94da19@mail.gmail.com>

Hi

I want to generate map images from .tab or .shp files for the given envelope
in my application in C#.
Is it possible using GDAL?

Could anyone guide me in the right direction, as I am new to GIS stuff.

Thanks and Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/06274897/attachment.html
From bfraser at geoanalytic.com  Wed Nov 15 10:27:22 2006
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for storing georeferenced
	images
References: <4BF377919225F449BB097CB76FFE9BC801987BAD@ptolemy.topozone.com>
	<455A72A9.5070706@perkins.net>
Message-ID: <02d301c708ca$8be539a0$160002c0@shark>

Simon,

    VTP http://vterrain.org/ (to paraphrase Schuyler Erle "the best kept secret open source geo app on the net") uses libmini ( http://www.stereofx.org/terrain.html) an open source library for tiling images (textures) and elevations models ("height fields").

    In the VTP implementation, the authoring tool VTBuilder takes a user-specified set of images and creates a tileset.  the Tileset has an "INI" file to describe it's properties:

[TilesetDescription]
Columns=12
Rows=16
LOD0_Size=1024
Extent_Left=370826.6795802761
Extent_Right=391921.9795802761
Extent_Bottom=2408667.927330024
Extent_Top=2436626.127330024
CRS=PROJCS["NAD83 / UTM zone 4N",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.2572221010002]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",-159],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1]]

>From the libmini doc, the tiles "can be saved in the PNM format (PGM/PPM for grayscale/RGB images), but the native DB format of the Mini Library should be preferred."

The tile files are named (for the db format):
    tile.0-0.db         - first row, first column, highest level of detail
    tile.0-0.db1 
    tile.0-0.db2 
    tile.0-0.db3       - first row, first column, lowest level of detail
    tile.1-0.db         - second row, first column, highest level of detail
        :

Brent Fraser

  . Could somebody outline the solution used by the Virtual Terrain project?

  Cheers,

  Sy

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/876e7616/attachment.html
From stephan.holl at intevation.de  Wed Nov 15 11:04:03 2006
From: stephan.holl at intevation.de (Stephan Holl)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] OGR: VRT
Message-ID: <200611151704.04125.stephan.holl@intevation.de>

Dear List,

I am connecting to  a mysql-table using OGRs VRT-driver.

My ovt-file:
OGRVRTDataSource>
    <OGRVRTLayer name='values'> 
<SrcDataSource>MYSQL:usr_web1_1,user=web1,host=localhost,port=3306,tables=n2n_flmflaeche</SrcDataSource>
    <SrcSQL>select n2n_wert, n2n_idflm, n2n_wertdat, n2n_idflaeche, frmt_wert, 
replace(replace(replace(format(n2n_wert,3),'.',';'),',','.'),';',',') as 
format_wert from n2n_flmflaeche
        where n2n_idflm = 1207
        and n2n_wertdat between '2004-01-01' and '2004-12-31'
        order by n2n_wertdat</SrcSQL>
    </OGRVRTLayer>
</OGRVRTDataSource>


The Database-query using mysql commandline-tools results in in 1 row:
select n2n_wert, frmt_wert, 
replace(replace(replace(format(n2n_wert,3),'.',';'),',','.'),';',',') as 
format_wert from n2n_flmflaeche
 where n2n_idflm = 1207
 and n2n_wertdat between '2004-01-01' and '2004-12-31'
 order by n2n_wertdat;
+----------+-----------+-------------+
| n2n_wert | frmt_wert | format_wert |
+----------+-----------+-------------+
|   95.600 | 95,600    | 95,600      |
+----------+-----------+-------------+
1 row in set (0.01 sec)

The datatype of n2n_wert is decimal.

All good for now.

Using ogrinfo on my ovf-file it gives a strange rounding value
Layer name: values
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
n2n_wert: Real (0.0)
n2n_idflm: Integer (0.0)
n2n_wertdat: String (0.0)
n2n_idflaeche: String (0.0)
frmt_wert: String (0.0)
format_wert: String (0.0)
OGRFeature(values):0
  n2n_wert (Real) = 95.59999999999999   <--- strange, should be 95.600
  n2n_idflm (Integer) = 1207
  n2n_wertdat (String) = 2004-12-31
  n2n_idflaeche (String) = 04000000
  frmt_wert (String) = 95,600
  format_wert (String) = 95,600

Is this a known problem?

I am on Debian with gdal-1.2.6

Best regards

	Stephan



-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/15ee1c15/attachment.bin
From epatton at nrcan.gc.ca  Wed Nov 15 11:05:38 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Error compiling gdal: libgrass_I.so: cannot open
	shared object file
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C2B@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C31@s5-dar-r1.nrn.nrcan.gc.ca>

Thanks for the pointers, Frank.

I removed existing Grass plugins in /usr/local/lib/gdalplugins, ran make distclean, reconfigured, and installed again. The libgrass error mentioned in the subject header is now gone, however, it's replaced by "Segmentation Fault" when I try to run any gdal program.

I don't get any obvious errors during configure or make. I'm installing in /usr/local/gdal-1.3.2, and my $LD_LIBRARY_PATH and $PATH seem OK:

$ echo $LD_LIBRARY_PATH
/usr/local/lib:/usr/lib:/usr/local/IVS/lib

$ echo $PATH/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/bin/X11: \ /usr/games:/usr/local/IVS/bin:/opt/bin:/opt/grass-6.3.cvs/bin_tcl: \ /opt/grass-6.3.cvs/bin_extra:/home/epatton/coderepo

My libgeos and libproj files all exist in /usr/local/lib, which is included in /etc/ld.so.conf:

$ cat /etc/ld.so.conf
/usr/X11R6/lib
/usr/local/lib
/usr/lib
/usr/lib/atlas

Maybe try compliing without libtool?

Regards,

~ Eric. 



>Eric,

>I'm guessing you are either not running the version of GDAL you just
>installed, or you have a grass driver plugin sitting out there.  If
>gdalinfo still works despite the message then it is likely a plugin.
>Look in /usr/local/lib/gdalplugins and delete any grass plugins you
>find.  Otherwise check to see if there are any old libgdal.so type files
>sitting somewhere on your system.  "local libgdal.so" should be your
>friend
>for this.

>It is also possible that you didn't do a make clean from a previous
>build.  GDAL's build is very sloppy about reacting to configure changes.
>If you reconfigure you should also do a "make clean".




From jordi at geoquadtree.org  Wed Nov 15 12:00:50 2006
From: jordi at geoquadtree.org (Jordi Gilabert Vall)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for
	storinggeoreferencedimages
In-Reply-To: <455B2D40.8030006@pobox.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>
	<6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>
	<455B2D40.8030006@pobox.com>
Message-ID: <6d26117e0611150900q301f44d0tbaafb123d9901ee4@mail.gmail.com>

Frank,

I agree that the GeoQuadTree GDAL driver should be under the MIT/X license
used in the rest of the project.

At first I included the CRS definition in the same XML metadata file, but
later I thought it would be more useful as a separate file, with .prj
extension. This CRS file IS the definition in Well Known Text format, as is
returned from PROJ.4 library. Do you think it would be better to include it
in the same XML metadata file ?

I've started working on including the choice for JPEG, JPEG2000 or TIFF as
alternatives to PNG for the format of the tiles. I would like also to
support multi-bands with TIFF or with multiple PNGs/JPGs.

You are absolutely right that sacrificing a RGB color for nondata is not a
good idea in JPEG.

I don't know if I understand what you mean about a "standard tile cache".
I'm sorry that I didn't study enough the GDAL core, and I didn't know about
the block cache. I'll try to use it: I implemented my own tile cache, but
only as a consequence of my ignorance in GDAL internals.

I will include some information on the web about who did the work and why,
as you suggest.

Best regards,

Jordi


On 11/15/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>
> Jordi Gilabert Vall wrote:
> > I only wanted a lossless compression, so I chose PNG format for tiles,
> > but many people also wants a lossless compression, so I'm going to
> > support two types of compression, PNG and maybe JPEG or JPEG2000. I like
> > the PNG format because with 4-bands PNGs (RGBA), the alpha channel
> > allows me to store non-data pixels. With JPEG format, I would
> > "sacrifice" a RGB color to represent non-data values. There is also the
> > need of supporting multi-band images, this could be accomplished with as
> > many PNGs as bands. These are small changes, I will try to make it on
> > the next release.
> >
> > On the other side, I think storage space is not the big problem
> > nowadays. I prefer more efficient algorithms in terms of CPU usage, than
> > efficient in terms of storage space. If someone prefer the reduction of
> > storage space, the wavelet compression approach could be preferred
> > (LizardTech's MrSID, ER Mapper's...). I want the freedom to choose a
> > simpler, efficient an FREE approach.
> >
> > GeoQuadTree handles a pyramid of overviews. When you create a
> > GeoQuadTree image, you specifiy the number of levels in the pyramid.
> > Every time you import a image into a GeoQuadTree, the utility builds the
> > pyramid of overviews (only updates the tiles affected upside in the
> > pyramid).
>
> Jordi,
>
> I would be interested in incorporating your geoquadtree gdal driver into
> the mainline GDAL source tree, but I see that it is licensed under the
> GPL.
> In the interest of simplicity of licensing I prefer to keep all the core
> GDAL source tree to the MIT/X license already used.  So, unless you are
> interested in licensing the driver in a GDAL compatible form, I think it
> will need to stay as a plugin.
>
> I would like to see the XML metadata file for geoquadtree format include
> a coordinate system element with the coordinate system in Well Known Text
> format.  An alternative might be in anything supported for SRS names in
> the
> OGC WxS specifications (such like EPSG:4326 or the OGC URN
> specifications).
>
> I also would like to see some flexibility in the format of the tiles.  At
> the very least png, and jpeg.  JPEG2000, and TIFF might also be desirable.
> TIFF I mention because of the flexibility of pixel data types, and
> multispectral support.  Of course TIFF is a bit heavy for very small
> tiles.
>
> You mentioned above about having to sacrifice an RGB color for a nodata
> marker with jpeg format, but this doesn't really work because jpeg is so
> lossy.  So it is essentially impossible to use nodata values with jpeg.
>
> Overall I would have preferred to see a GeoQuadTree format that was also
> a valid instance of the url view of a "standard tile cache" per all the
> "tile cache standard" work being done by various folks.  That would be
> super-cool, but perhaps not a high priority for you.
>
> PS. A very nice professional job on the geoquadtree.org web site.  But it
> lacks in ... humanity.  Perhaps an FAQ on who did the work and why?
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/b2baa86c/attachment.html
From warmerdam at pobox.com  Wed Nov 15 13:12:20 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Generating images from .tab and .shp files
In-Reply-To: <b41d86b30611150715r392f52deie9a587a20d94da19@mail.gmail.com>
References: <b41d86b30611150715r392f52deie9a587a20d94da19@mail.gmail.com>
Message-ID: <455B5884.2000601@pobox.com>

Mir Hassan Ali wrote:
> Hi
>  
> I want to generate map images from .tab or .shp files for the given 
> envelope in my application in C#.
> Is it possible using GDAL?
>  
> Could anyone guide me in the right direction, as I am new to GIS stuff.

Mir,

GDAL/OGR does not provide a rendering engine for feature data.  You would
need to look at higher level components - perhaps MapServer.  GDAL/OGR
do provide the feature access capability to lots of rendering engines.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From hellik at web.de  Wed Nov 15 12:07:21 2006
From: hellik at web.de (Helmut Kudrnovsky)
Date: Wed Nov 21 11:50:28 2007
Subject: =?iso-8859-15?Q?Re:_[Gdal-dev]_gdalwarp_-_from_Monte=5FMario=5FItaly=5F?=
	=?iso-8859-15?Q?1_to_ETRF=5F1989=5FUTM=5FZone=5F32N_-_offset_ca._120_m?=
Message-ID: <892801093@web.de>

hi markus, hi frank,

thanks for the tip, everything worked well .... i merged the data shift info in the wkt-file and gdal did the job perfectly :o)

helli

>>Markus Neteler wrote:
>> helli,
>>
>> you are lacking the datum information for Monte Mario:
>> (grep'ed from GRASS):
>>
>> rome40 "towgs84=-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68" "Italy (Peninsular Part)" "Accuracy 3-4m"
>> rome40 "towgs84=-168.6,-34.0,38.6,-0.374,-0.679,-1.379,-9.48" "Italy (Sardinia)" "Accuracy 3-4m"
>> rome40 "towgs84=-50.2,-50.4,84.8,-0.690,-2.012,0.459,-28.08" "Italy (Sicily)" "Accuracy 3-4m"
>>
>> which needs to be added as additional parameter.

>I would add that the datum shift info can be merged into the Well Known Text
>.prj file. I assume the above parameters apply to D_Monte_Mario in which
>case source.prj might look like:

>PROJCS["Monte_Mario_Italy_1",
>GEOGCS["GCS_Monte_Mario",
>DATUM["D_Monte_Mario",
>SPHEROID["International_1924",6378388.0,297.0],
>TOWGS84[-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68]],
>PRIMEM["Greenwich",0.0],
>UNIT["Degree",0.0174532925199433]],
>PROJECTION["Transverse_Mercator"],
>PARAMETER["False_Easting",500000.0],
>PARAMETER["False_Northing",-5000000.0],
>PARAMETER["Central_Meridian",9.0],
>PARAMETER["Scale_Factor",0.9996],
>PARAMETER["Latitude_Of_Origin",0.0],
>UNIT["Meter",1.0]]

______________________________________________________________________________
"Ein Herz f?r Kinder" - Ihre Spende hilft! Aktion: www.deutschlandsegelt.de
Unser Dankesch?n: Ihr Name auf dem Segel der 1. deutschen America's Cup-Yacht!



From wegmann at biozentrum.uni-wuerzburg.de  Wed Nov 15 12:12:09 2006
From: wegmann at biozentrum.uni-wuerzburg.de (Martin Wegmann)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal install errors
In-Reply-To: <200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
References: <200611091557.59001.wegmann@biozentrum.uni-wuerzburg.de>
	<455348E5.5080507@pobox.com>
	<200611091732.59917.wegmann@biozentrum.uni-wuerzburg.de>
Message-ID: <200611151812.10014.wegmann@biozentrum.uni-wuerzburg.de>

On Thursday 09 November 2006 17:32, Martin Wegmann wrote:
> Hello,
>
> On Thursday 09 November 2006 16:27, you wrote:
> > Martin Wegmann wrote:
> > > Hello,
> > >
> > > I tried on a fresh debian testing system to install the official gdal
> > > 1.3.2 source code and the cvs code (today), both resulted in the error
> > > messages below when executing make.
> > >
> > > Any hint, how to fix it is appreciated.
> > >
> > > regards, Martin
> >
> > Martin,
> >
> > Could you try this with a CVS snapshot to verify this isn't already fixed
> > since spring?
>
> I tried it with this cvs snapshot:
> % export CVSROOT=:pserver:cvsanon@cvs.maptools.org:/cvs/maptools/cvsroot
> % cvs login
> Password: *enter*
> % cvs checkout gdal
>
> > You might also try installing GDAL without GRASS support,
> > and then building and installing the grass driver as a plugin.  This can
> > be done using:
>
> without grass support
>
> It works so far:
> [...]
> g++
> gdal_rasterize.o -o .libs/gdal_rasterize 
> /home/baliola/software/gdal_cvs/gdal/.libs/libgdal.so -lpthread -lmfhdf
> -ldf -lgif -lpng -lnetcdf -lcfitsio -L/usr/lib -lpq -lz -lrt -ldl
> -Wl,--rpath -Wl,/usr/local/lib creating gdal_rasterize
> make[1]: Leaving directory `/home/baliola/software/gdal_cvs/gdal/apps'
>
>
> but when I install gdal-grass:
> ./configure --with-gdal=/usr/local/bin/gdal-config
> --with-grass=/usr/local/grass-6.3.cvs/ make
>
> grass57dataset.cpp: In static member function ?static GDALDataset*
> GRASSDataset::Open(GDALOpenInfo*)?:
> grass57dataset.cpp:948: error: ?GPJ_grass_to_wkt? was not declared in this
> scope
> make: *** [grass57dataset.o] Error 1
>
> it's the same error message like with grass-support, isn't it?
>
> thanks for your help, regards, Martin
>
> >    http://www.gdal.org/dl/gdal-grass-1.3.2.tar.gz
> >
> > The plugin is more used, and better tested these days.

just for the archive:

fetched fresh cvs source code of GRASS 6.3 and gdal
recompilation of gdal and GRASS with gdal support worked fine

however:
"libgdal.so.1" could not be found even though it was located using  `locate 
libgdal` but in /usr/local/lib

hence I added /usr/local/lib/ in
/etc/ld.so.conf and executed "ldconfig"

now GRASS is working with gdal support.

Martin

> >
> > Best regards,
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Wed Nov 15 13:50:11 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for
	storinggeoreferencedimages
In-Reply-To: <a95e8c1c0611150857w48792c3bxaf2fb213b6faf49d@mail.gmail.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>	
	<6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>	
	<455B2D40.8030006@pobox.com>
	<a95e8c1c0611150857w48792c3bxaf2fb213b6faf49d@mail.gmail.com>
Message-ID: <455B6163.8090902@pobox.com>

Jordi wrote:
> Frank,
> 
> I agree that the GeoQuadTree GDAL driver should be under the MIT/X 
> license used in the rest of the project.

Jordi,

Ah, cool.  Then inclusion should be no problem.  Lets make sure it
makes it in before 1.4.0 release.

> At first I included the CRS definition in the same XML metadata file, 
> but later I thought it would be more useful as a separate file, with 
> .prj extension. This CRS file IS the definition in Well Known Text 
> format, as is returned from PROJ.4 library. Do you think it would be 
> better to include it in the same XML metadata file ?

Ah.  I just read the FAQ entry on the format, which I don't think
mentions the CRS file.  A seperate .prj file with the wkt coordinate system
should be fine.

You say "in Well Known Text format, as returned from PROJ.4 library".
The well known text format is not used or produced by the PROJ.4 library
so either you are really using PROJ.4 definitions (not WKT) or you really
mean as returned by OGRSpatialReference.

WKT usually starts with PROJCS or GEOGCS while PROJ.4 strings include
something like +proj=.

I think we should be using WKT as it is not so software specific.

> I've started working on including the choice for JPEG, JPEG2000 or TIFF 
> as alternatives to PNG for the format of the tiles. I would like also to 
> support multi-bands with TIFF or with multiple PNGs/JPGs.

cool

> You are absolutely right that sacrificing a RGB color for nondata is not 
> a good idea in JPEG.
> 
> I don't know if I understand what you mean about a "standard tile 
> cache". I'm sorry that I didn't study enough the GDAL core, and I didn't 
> know about the block cache. I'll try to use it: I implemented my own 
> tile cache, but only as a consequence of my ignorance in GDAL internals.

This isn't a GDAL thing at all.  Various web obsessed folks from projects
like OpenLayers, ka-map, and others have been trying to hash out a standard
approach to web accessable tile caches such as those used by Google maps,
and WorldWind.  So that web tile caches could be shared more effectively
by different software packages.  I think the following urls capture some
of that planning/discussion/thinking though I haven't been following it
closely myself.

   http://wiki.osgeo.org/index.php/WMS_Tile_Caching
   http://wiki.osgeo.org/index.php/Distributed_Tile_Caching
   http://wiki.osgeo.org/index.php/Tile_Map_Service_Specification

My thinking is that if they hammer this out it would be nice if the
geoquadtree cache format sitting on a web server would adhere to their
specification making it directly usable.  I don't know enough about this
to be sure if this is reasonable or not.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 15 14:09:22 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] OGR: VRT
In-Reply-To: <200611151704.04125.stephan.holl@intevation.de>
References: <200611151704.04125.stephan.holl@intevation.de>
Message-ID: <455B65E2.8060804@pobox.com>

Stephan Holl wrote:
>   n2n_wert (Real) = 95.59999999999999   <--- strange, should be 95.600
>   n2n_idflm (Integer) = 1207
>   n2n_wertdat (String) = 2004-12-31
>   n2n_idflaeche (String) = 04000000
>   frmt_wert (String) = 95,600
>   format_wert (String) = 95,600
> 
> Is this a known problem?
> 
> I am on Debian with gdal-1.2.6

Stephan,

I'd suggest trying again with the latest version (ie. a nightly cvs
snapshot) and see if the problem persists.  There have been a lot of
changes and improvements since 1.2.6.  If the problem persists you can
file a bug report, hopefully with an sql script we can execute in mysql
to initialize an example table showing the problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jordi at geoquadtree.org  Wed Nov 15 12:57:10 2006
From: jordi at geoquadtree.org (Jordi Gilabert Vall)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open format for
	storinggeoreferencedimages
Message-ID: <6d26117e0611150957y771d511cm5c1efb805a183672@mail.gmail.com>

Frank,

Sorry for the mistake, the Well Known Text format I write on the CRS
definition file comes from the OSRExportToWkt function, in OGR, not in
PROJ.4. I agree that WKT is the best option, as it is not software specific.


I will read about tile caching proposals, as you suggest, it sounds
interesting.

Best regards,

Jordi



2006/11/15, Frank Warmerdam <warmerdam@pobox.com>:
>
> Jordi wrote:
> > Frank,
> >
> > I agree that the GeoQuadTree GDAL driver should be under the MIT/X
> > license used in the rest of the project.
>
> Jordi,
>
> Ah, cool.  Then inclusion should be no problem.  Lets make sure it
> makes it in before 1.4.0 release.
>
> > At first I included the CRS definition in the same XML metadata file,
> > but later I thought it would be more useful as a separate file, with
> > .prj extension. This CRS file IS the definition in Well Known Text
> > format, as is returned from PROJ.4 library. Do you think it would be
> > better to include it in the same XML metadata file ?
>
> Ah.  I just read the FAQ entry on the format, which I don't think
> mentions the CRS file.  A seperate .prj file with the wkt coordinate
> system
> should be fine.
>
> You say "in Well Known Text format, as returned from PROJ.4 library".
> The well known text format is not used or produced by the PROJ.4 library
> so either you are really using PROJ.4 definitions (not WKT) or you really
> mean as returned by OGRSpatialReference.
>
> WKT usually starts with PROJCS or GEOGCS while PROJ.4 strings include
> something like +proj=.
>
> I think we should be using WKT as it is not so software specific.
>
> > I've started working on including the choice for JPEG, JPEG2000 or TIFF
> > as alternatives to PNG for the format of the tiles. I would like also to
> > support multi-bands with TIFF or with multiple PNGs/JPGs.
>
> cool
>
> > You are absolutely right that sacrificing a RGB color for nondata is not
> > a good idea in JPEG.
> >
> > I don't know if I understand what you mean about a "standard tile
> > cache". I'm sorry that I didn't study enough the GDAL core, and I didn't
>
> > know about the block cache. I'll try to use it: I implemented my own
> > tile cache, but only as a consequence of my ignorance in GDAL internals.
>
> This isn't a GDAL thing at all.  Various web obsessed folks from projects
> like OpenLayers, ka-map, and others have been trying to hash out a
> standard
> approach to web accessable tile caches such as those used by Google maps,
> and WorldWind.  So that web tile caches could be shared more effectively
> by different software packages.  I think the following urls capture some
> of that planning/discussion/thinking though I haven't been following it
> closely myself.
>
>    http://wiki.osgeo.org/index.php/WMS_Tile_Caching
>    http://wiki.osgeo.org/index.php/Distributed_Tile_Caching
>    http://wiki.osgeo.org/index.php/Tile_Map_Service_Specification
>
> My thinking is that if they hammer this out it would be nice if the
> geoquadtree cache format sitting on a web server would adhere to their
> specification making it directly usable.  I don't know enough about this
> to be sure if this is reasonable or not.
>
> Best regards,
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam<http://pobox.com/%7Ewarmerdam>
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/81da01ba/attachment.html
From neteler at itc.it  Wed Nov 15 12:59:41 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <0ffc01c708ad$05aa9be0$0a01a8c0@pili>
References: <0ffc01c708ad$05aa9be0$0a01a8c0@pili>
Message-ID: <20061115175941.GE12011@bartok.itc.it>

Frank, all,

I would be interested in this wish:
  http://bugzilla.remotesensing.org/show_bug.cgi?id=511
  "gdalwarp: suggestion for '-kr' (keep resolution) flag"

to simplify bulk warp of LANDSAT scenes which come as
multi-resolution files.

Another problem is:
  http://bugzilla.remotesensing.org/show_bug.cgi?id=809
  "shape driver no longer recognizes INT columns in DBF file"

Best regards
Markus

On Wed, Nov 15, 2006 at 12:56:01PM +0100, Fr?d?ric Trastour wrote:
> Hello,
> 
> should it be possible to include the correction of this bug
> http://bugzilla.remotesensing.org/show_bug.cgi?id=1009
> in release 1.4 ?
> 
> Fr?d?ric.
> 
> 

-- 
Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
MPBA - Predictive Models for Biol. & Environ. Data Analysis
Via Sommarive, 18        -       38050 Povo (Trento), Italy

From szekerest at gmail.com  Wed Nov 15 14:39:44 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] C# Bindings Error
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAANLXt1zFQQVEuOhN3zURNNfigAAAEAAAAMo9L2LqwHxCnPLHwPaxvVIBAAAAAA==@cepropa.com.ar>
References: <!&!AAAAAAAAAAAYAAAAAAAAANLXt1zFQQVEuOhN3zURNNfigAAAEAAAAMo9L2LqwHxCnPLHwPaxvVIBAAAAAA==@cepropa.com.ar>
Message-ID: <f3b73b7d0611151139g56684a0et94429314fce3a391@mail.gmail.com>

Hi Christian,

SWIG 1.3.30 is a fairly new version that haven't been tested so far.
We have found many of the backward incompatible changes when a new
version of SWIG was issued in in the past
and I think it applies to this version as well. So you might want to
try with 1.3.29 for now and I will look into this problem ASAP.

Best Regads,

Tamas


2006/11/15, Christian M. Gonzalez <cgonzalez@cepropa.com.ar>:
>
>
>
>
> Hello,
>
>
>
> I downloaded the cvs zip from 2006-11-14.
>
> I had success in building the gdal library, but when I tried to build the C#
> bindings, I got the following errors:
>
>
>
> --- BEGIN: COPY OF SCREEN ----------------------------
>
>
>
> C:\gdal\swig\csharp>nmake -f makefile.vc interface
>
>
>
> Microsoft (R) Program Maintenance Utility Version 8.00.50727.42
>
> Copyright (C) Microsoft Corporation.  All rights reserved.
>
>
>
>         cd const
>
>         C:\swig\swigwin-1.3.30\swig.exe -csharp -namespace GDAL -dllimport
> gdal_gdalconst_wrap -o gdalconst_wrap.c ../../include/gdalconst.i
>
>         cd ..
>
>         cd gdal
>
>         C:\swig\swigwin-1.3.30\swig.exe -c++ -csharp -namespace GDAL
> -dllimport  gdal_gdal_wrap -I../../include/csharp -o gdal_wrap.cpp
> ../../include/gdal.i
>
> ..\..\include\MajorObject.i(54): Error: No methodmodifiers
> attribute defined in csdestruct typemap for MajorObject.
>
> ..\..\include\Driver.i(97): Error: No methodmodifiers attribute defined in
> csdestruct_derived typemap for Driver.
>
> ..\..\include\gdal.i(324): Error: No methodmodifiers attribute defined in
> csdestruct typemap for GCP.
>
> ..\..\include\Dataset.i(225): Error: No methodmodifiers attribute defined in
> csdestruct_derived typemap for Dataset.
>
> ../../include/csharp\gdal_csharp_extend.i(34): Error: No
> methodmodifiers attribute defined in csdestruct_derived typemap for Band.
>
> ..\..\include\ColorTable.i(57): Error: No methodmodifiers attribute defined
> in csdestruct typemap for ColorTable.
>
> NMAKE : fatal error U1077: 'C:\swig\swigwin-1.3.30\swig.exe' : return code
> '0x6'
>
>
>
> Stop.
>
>
>
> --- END: COPY OF SCREEN ----------------------------
>
>
>
> Could anyone tell me if I made a mistake in the process?
>
> Thanks a lot.
>
>
>
> Christian Gonzalez
>
> CEPROPA
>
> Patagonia ? Argentina
>
>
>
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>


From stephan.holl at intevation.de  Wed Nov 15 14:52:39 2006
From: stephan.holl at intevation.de (Stephan Holl)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] OGR: VRT
In-Reply-To: <455B65E2.8060804@pobox.com>
References: <200611151704.04125.stephan.holl@intevation.de>
	<455B65E2.8060804@pobox.com>
Message-ID: <20061115205239.34075886@localhost>

Hello Frank, 

thanks for your fast reply.

On Wed, 15 Nov 2006 14:09:22 -0500 Frank Warmerdam
<warmerdam@pobox.com> wrote:

> Stephan Holl wrote:
> >   n2n_wert (Real) = 95.59999999999999   <--- strange, should be
> > 95.600 n2n_idflm (Integer) = 1207
> >   n2n_wertdat (String) = 2004-12-31
> >   n2n_idflaeche (String) = 04000000
> >   frmt_wert (String) = 95,600
> >   format_wert (String) = 95,600
> > 
> > Is this a known problem?
> > 
> > I am on Debian with gdal-1.2.6
> 
> Stephan,
> 
> I'd suggest trying again with the latest version (ie. a nightly cvs
> snapshot) and see if the problem persists.  There have been a lot of
> changes and improvements since 1.2.6.  If the problem persists you can
> file a bug report, hopefully with an sql script we can execute in
> mysql to initialize an example table showing the problem.

Thanks for the hint about the new changes. I backported my app since
1.3.2 does not work at all with vrt stuff in conjunction with MySQL.
So I decided to use 1.2.6 for this app. But I will give a nighly build
a shot and report back.

Best regards

	Stephan


-- 
Stephan Holl   : www.intevation.de/~stephan | GISpatcher:
www.gispatcher.de Intevation GmbH: www.intevation.de          | GAV
e.V.: www.grass-verein.de Georgstr.4     : 49074 Osnabr?ck            | 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/89c53ec0/signature.bin
From izzybitsie at gmail.com  Wed Nov 15 15:56:47 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal newbie-merge geotiff images
Message-ID: <23e208430611151256p4efa78d6wbb3e2e1533ca31e2@mail.gmail.com>

I am trying to stitch together several satellite geotiff images to obtain a
world image.
The individual images display the satellite picture with black areas on the
sides of the picture itself.
So, when merging the images using gdal_merge.py some pictures are hidden
underneath the black portion of neighbour images.  Couldn't use -pct option
due to images characteristics. Pls. see below the color tables in the input
images.

The original images do not have a no-data value assigned to pixels to avoid
copying them.
So, for now my only option would be to crop the black areas that are always
the same size around the image.  I am trying to do this using gdalwarp, but
I still can't figure out how to obtain the georeferenced box to be used
along with -projwin option.

BTW.  I haven't been able to see these images using OpenEV although I can
see them with ImageMagick.  Any idea on what I may be doing wrong in
OpenEV?  I do need to run openev with the "-h" option since it quits on me
when opening an image otherwise.  I have been able to see other geotiffs
downloaded from Internet in openev though.

Any help on how to cut the black areas is appreciated.



Some info on 2 of the input images and the output images:

Input number 1

Origin = (45.833333,75.000000)
Pixel Size = (0.08055556,-0.08055556)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  45.8333333,  75.0000000) (142d30'0.03"E,  0d 0'0.04"N)
Lower Left  (  45.8333333, -70.0000000) (142d30'0.03"E,  0d 0'0.04"S)
Upper Right (     239.167,      75.000) (142d30'0.14"E,  0d 0'0.04"N)
Lower Right (     239.167,     -70.000) (142d30'0.14"E,  0d 0'0.04"S)
Center      ( 142.5000000,   2.5000000) (142d30'0.08"E,  0d 0'0.00"N)
Band 1 Block=2400x3 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 0,0,0,255
    1: 0,0,0,255
    2: 0,0,0,255
    3: 0,0,0,255
    4: 0,0,0,255
    5: 0,0,0,255
    6: 0,0,0,255
    7: 0,0,0,255
    8: 0,0,0,255
    9: 0,0,0,255
   10: 0,0,0,255
   11: 0,0,0,255
   12: 0,0,0,255
   13: 0,0,0,255
   14: 0,0,0,255
   15: 0,0,0,255
   16: 0,0,0,255
   17: 0,0,0,255
   18: 0,0,0,255
   19: 0,0,0,255
   20: 0,0,0,255
...............................................................rest of
values in color table look the same

Input number 2
Driver: GTiff/GeoTIFF
Size is 2400, 1800
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT[,0.0174532925199433]],
    PROJECTION["Equirectangular"],
    PARAMETER["latitude_of_origin",2.5],
    PARAMETER["central_meridian",-155],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9102"]]]
Origin = (-251.537842,74.963768)
Pixel Size = (0.08051530,-0.08051530)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (    -251.538,      74.964) (155d 0'0.14"W,  0d 0'0.04"N)
Lower Left  (    -251.538,     -69.964) (155d 0'0.14"W,  0d 0'0.04"S)
Upper Right ( -58.3011272,  74.9637681) (155d 0'0.03"W,  0d 0'0.04"N)
Lower Right ( -58.3011272, -69.9637681) (155d 0'0.03"W,  0d 0'0.04"S)
Center      (-154.9194847,   2.5000000) (155d 0'0.09"W,  0d 0'0.00"N)
Band 1 Block=2400x3 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 0,0,0,255
    1: 0,0,0,255
    2: 0,0,0,255
    3: 0,0,0,255
    4: 0,0,0,255
    5: 0,0,0,255
    6: 0,0,0,255
    7: 0,0,0,255
    8: 0,0,0,255
    9: 0,0,0,255
   10: 0,0,0,255
   11: 0,0,0,255
   12: 0,0,0,255
   13: 0,0,0,255
   14: 0,0,0,255
   15: 0,0,0,255
   16: 0,0,0,255
   17: 0,0,0,255
   18: 0,0,0,255
   19: 0,0,0,255
   20: 0,0,0,255
.................................................................. rest of
values in color table look the same


Output from gdal_merge.py -o <outpiut> <Input number 1>  <Input number 2>
Driver: GTiff/GeoTIFF
Size is 6067, 1800
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Equirectangular"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",135],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["unknown",1]]
Origin = (-243.264249,69.948187)
Pixel Size = (0.07772021,-0.07772021)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (    -243.264,      69.948) (134d59'52.13"E,  0d 0'2.28"N)
Lower Left  (    -243.264,     -69.948) (134d59'52.13"E,  0d 0'2.28"S)
Upper Right (     228.264,      69.948) (135d 0'7.38"E,  0d 0'2.28"N)
Lower Right (     228.264,     -69.948) (135d 0'7.38"E,  0d 0'2.28"S)
Center      (  -7.5000000,  -0.0000000) (134d59'59.76"E,  0d 0'0.00"S)
Band 1 Block=6067x1 Type=Byte, ColorInterp=Gray
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061115/a9d9a82d/attachment.html
From szekerest at gmail.com  Wed Nov 15 16:04:11 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] C# Bindings Error
In-Reply-To: <!&!AAAAAAAAAAAYAAAAAAAAANLXt1zFQQVEuOhN3zURNNfigAAAEAAAAMo9L2LqwHxCnPLHwPaxvVIBAAAAAA==@cepropa.com.ar>
References: <!&!AAAAAAAAAAAYAAAAAAAAANLXt1zFQQVEuOhN3zURNNfigAAAEAAAAMo9L2LqwHxCnPLHwPaxvVIBAAAAAA==@cepropa.com.ar>
Message-ID: <f3b73b7d0611151304q3dad3f1ne35f65518487b71c@mail.gmail.com>

I've just committed the changes for supporting the SWIG 1.3.30 C# builds.
Checkout and try the latest CVS.

Best Regards,


Tamas Szekeres



2006/11/15, Christian M. Gonzalez <cgonzalez@cepropa.com.ar>:
>
>
>
>
> Hello,
>
>
>
> I downloaded the cvs zip from 2006-11-14.
>
> I had success in building the gdal library, but when I tried to build the C#
> bindings, I got the following errors:
>
>
>
> --- BEGIN: COPY OF SCREEN ----------------------------
>
>
>
> C:\gdal\swig\csharp>nmake -f makefile.vc interface
>
>
>
> Microsoft (R) Program Maintenance Utility Version 8.00.50727.42
>
> Copyright (C) Microsoft Corporation.  All rights reserved.
>
>
>
>         cd const
>
>         C:\swig\swigwin-1.3.30\swig.exe -csharp -namespace GDAL -dllimport
> gdal_gdalconst_wrap -o gdalconst_wrap.c ../../include/gdalconst.i
>
>         cd ..
>
>         cd gdal
>
>         C:\swig\swigwin-1.3.30\swig.exe -c++ -csharp -namespace GDAL
> -dllimport  gdal_gdal_wrap -I../../include/csharp -o gdal_wrap.cpp
> ../../include/gdal.i
>
> ..\..\include\MajorObject.i(54): Error: No methodmodifiers
> attribute defined in csdestruct typemap for MajorObject.
>
> ..\..\include\Driver.i(97): Error: No methodmodifiers attribute defined in
> csdestruct_derived typemap for Driver.
>
> ..\..\include\gdal.i(324): Error: No methodmodifiers attribute defined in
> csdestruct typemap for GCP.
>
> ..\..\include\Dataset.i(225): Error: No methodmodifiers attribute defined in
> csdestruct_derived typemap for Dataset.
>
> ../../include/csharp\gdal_csharp_extend.i(34): Error: No
> methodmodifiers attribute defined in csdestruct_derived typemap for Band.
>
> ..\..\include\ColorTable.i(57): Error: No methodmodifiers attribute defined
> in csdestruct typemap for ColorTable.
>
> NMAKE : fatal error U1077: 'C:\swig\swigwin-1.3.30\swig.exe' : return code
> '0x6'
>
>
>
> Stop.
>
>
>
> --- END: COPY OF SCREEN ----------------------------
>
>
>
> Could anyone tell me if I made a mistake in the process?
>
> Thanks a lot.
>
>
>
> Christian Gonzalez
>
> CEPROPA
>
> Patagonia ? Argentina
>
>
>
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>


From matt.wilkie at gov.yk.ca  Wed Nov 15 16:12:13 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GeoQuadTree - an open
	format	for	storinggeoreferencedimages
In-Reply-To: <455B2D40.8030006@pobox.com>
References: <4BF377919225F449BB097CB76FFE9BC801987BB3@ptolemy.topozone.com>	<6d26117e0611150051m3cca3083x12214cd026ca3a5e@mail.gmail.com>
	<455B2D40.8030006@pobox.com>
Message-ID: <455B82AD.7030102@gov.yk.ca>

hi all, dunno if this relates directly to this interesting discussion, 
but from this post and it's comments there appear to be a lot active 
development on tiling and caching schemes going on: 
http://tinyurl.com/y3dj8s
(-->
http://www.spatiallyadjusted.com/2006/11/10/arc2earth-now-creates-map-tiles-for-google-maps-and-virtual-earth/ 
)


cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From warmerdam at pobox.com  Wed Nov 15 18:01:14 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Dataset.i - ReadRaster/WriteRaster
Message-ID: <455B9C3A.9040209@pobox.com>

Tamas,

I am now trying to primarily run with the next generation swig bindings.
In doing so I have discovered that the ReadRaster() method was never
implemented in Dataset.i.  Also, though WriteRaster was done, it does not
seem to work the same as in Band.i.  Since you have recently dealing with
these methods at the Band level, would you be willing to do the same for the
Dataset?

Currently the lack of these is breaking the tiff_write.py autotest script.
If you can implement it, I'll give it a try.  If you don't have time to
address this let me know, and I'll find some other solution.  I took a
brief run at it, but got confused.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sy at perkins.net  Wed Nov 15 17:02:58 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <455B3867.3060802@pobox.com>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
	<1163523481.10018.275798419@webmail.messagingengine.com>
	<455A0A61.1060804@noaa.gov> <455B3867.3060802@pobox.com>
Message-ID: <1163628178.20032.275935627@webmail.messagingengine.com>


On Wed, 15 Nov 2006 10:55:19 -0500, "Frank Warmerdam"
<warmerdam@pobox.com> said:

> But for windows, I can't help but think we should be doing something
> smarter. However, lacking soft links I'm not sure how to get the same
> flexiblity as we have on unix.  I'd like to have windows DLLs with
> names like GDAL140.DLL but I'd also like a way of understanding that
> applications using the GDAL C API can generally use any relatively
> recent GDAL DLL.  Is there a normal way of handling this sort of thing
> on windows?  Is it goig to be a lot of work?

Installed windows applications mostly seem to ship with their own copies
of the shared libraries that they need, and so GDAL is not usually
installed in a central location that can be picked up automatically by
other applications. Developers will likely have a GDAL directory tree
from which the applications they're working on pick up the GDAL headers
and binaries, so they will need to change the library name used in their
application whenever the GDAL version changes. But this is generally not
a huge deal. Having said that, that small deal could be avoided by not
incorporating the version in the GDAL library name.

I believe that the convention of naming windows DLLs with the version
number in the name dates back to the days when it was common for
applications to put installed DLLs into the windows system folder.
Without the version-specific naming scheme, it was possible for one
application to install an older version of a library over a newer one,
and so break any installed applications that depended on features of the
newer library. This is I think the most common version of "DLL Hell". 

Since about Windows 2000 (I think), DLLs have had version numbers
embedded in them, and installers are generally configured to not install
earlier versions of DLLs over earlier ones. This avoids the problem
above, and works fine, as long as libraries are always binary backwards
compatible with earlier versions. But it still breaks when this is not
the case, e.g. due to API changes, behavioral changes, etc). So
libraries still needed to change their names if they were going to
install in the system folder, whenever API changes occur - much as the
soname of linux libraries needs to change in this case.

With Windows XP, and particularly with Visual Studio 2005, things have
evolved a bit, and it now seems to be pretty taboo to install any DLLs
in the system folder. Instead, most apps simply keep their DLLs in their
local application folders. This solves all library compatiblity problems
and eliminates DLL Hell (at the expense of disk space, but that's
cheap), but, for instance, doesn't allow you to fix bugs in GDAL,
install it, and have any applications that depend upon it automatically
pick the new version up. 

There is in fact a way to install a shared version of GDAL in safe way,
using the notion of "shared side-by-side assemblies" and the global
cache. This basically allows multiple versions of the same library to be
installed centrally, and ties applications to specific versions,
avoiding compatibility problems. In addition, you can use "publisher
overrides" if you want to install a bug fix and redirect existing
applications to a new version. However, it's all a bit complicated. By
default different versions are presumed to be incompatible (which is
fairly sensible). You can read all about it at:

http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwxp/html/sidexsidewinxp.asp

Anyway, all this to say that I think most developers are happy using
private installations of GDAL, so the library name is not a big deal.
I'm happy to leave things as they are...

Sy

From szekerest at gmail.com  Wed Nov 15 17:34:19 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Re: Dataset.i - ReadRaster/WriteRaster
In-Reply-To: <455B9C3A.9040209@pobox.com>
References: <455B9C3A.9040209@pobox.com>
Message-ID: <f3b73b7d0611151434u7144561bhc22170e36871aaad@mail.gmail.com>

Frank,

It seems to be compelling to implement this kind of functions. I have
already seen a WriteRaster implementation in Dataset.i but it's a bit
unfriendly for the C# interface.

It must be noted that I had to pull out the WriteRaster/ReadRaster
implementation of band.i for C# because of the following reasons:

1. The default argument handling was not suitable for the C# binding.
The default implementation in band.i highly diverges from the original
GDALRasterIO concept.
2. The default implementation of ReadRaster alters the GDALRasterIO
allocation scheme, since it attepts to pass a newly allocated memory
to C# which is difficult to support safely.
(I would have to set up some kind of callback mechanism so as to support it)

I did not want to alter the original implementation in band.i because
I am not aware of the backward incompatible effects for the other
bindings. For C# the following simple implementation was sufficient:

%extend GDALRasterBandShadow
{
	%apply (void *buffer_ptr) {void *buffer};
	CPLErr ReadRaster(int xOff, int yOff, int xSize, int ySize, void* buffer,
                          int buf_xSize, int buf_ySize, GDALDataType buf_type,
                          int pixelSpace, int lineSpace) {
       return GDALRasterIO( self, GF_Read, xOff, yOff, xSize, ySize,
		        buffer, buf_xSize, buf_ySize, buf_type, pixelSpace, lineSpace );
    }
    CPLErr WriteRaster(int xOff, int yOff, int xSize, int ySize, void* buffer,
                          int buf_xSize, int buf_ySize, GDALDataType buf_type,
                          int pixelSpace, int lineSpace) {
       return GDALRasterIO( self, GF_Write, xOff, yOff, xSize, ySize,
		        buffer, buf_xSize, buf_ySize, buf_type, pixelSpace, lineSpace );
    }
    %clear void *buffer;
}



To support ReadRaster/WriteRaster for the dataset I would also suggest
to keep the original behaviour of GDALDatasetRasterIO method by not
altering the memory allocation mechanism and not bringing in esoteric
default value handling.

However I would support some extra code to give default implementation
for some of the unspecified arguments like the current WriteRaster
code. And all of the bindings will have to implement the typemaps for
'void * pData' and 'int *panBandMap'.

And certainly I can add the common part of the implementation into
dataset.i if needed but it will be an overload of the current
WriteRaster function if it should be kept.


Best Regards,


Tamas



2006/11/16, Frank Warmerdam <warmerdam@pobox.com>:
> Tamas,
>
> I am now trying to primarily run with the next generation swig bindings.
> In doing so I have discovered that the ReadRaster() method was never
> implemented in Dataset.i.  Also, though WriteRaster was done, it does not
> seem to work the same as in Band.i.  Since you have recently dealing with
> these methods at the Band level, would you be willing to do the same for the
> Dataset?
>
> Currently the lack of these is breaking the tiff_write.py autotest script.
> If you can implement it, I'll give it a try.  If you don't have time to
> address this let me know, and I'll find some other solution.  I took a
> brief run at it, but got confused.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>

From lists at b-open-solutions.it  Thu Nov 16 04:11:23 2006
From: lists at b-open-solutions.it (Alessandro Amici)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <1163523481.10018.275798419@webmail.messagingengine.com>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
	<1163523481.10018.275798419@webmail.messagingengine.com>
Message-ID: <200611161011.23804.lists@b-open-solutions.it>


Alle 17:58, marted? 14 novembre 2006, Simon Perkins ha scritto:
> On linux where it's more common to use a central shared GDAL library,
> it seems that we typically don't change the library soname. It's been
> libgdal.so.1 for a long time now. I have no idea if the latest GDAL
> is actually binary compatible with the earliest version that used
> that name. Has that been a problem for anyone?

yes, just yesterday. a customer had a 1.3.2 install (with libtool and 
including python), but the linker found an older 1.3.1 install 
somewhere, so 'import gdal.py' was failing due to a binary incompatible 
change in an init fuction of ogr :( (can't remember the details).

so, no the current scheme for so-versions on unix/linux (with and 
without libtool) is completely bogus. or to be more precise, binary 
incompatibilities are not reflected by the actual so-version of the 
library as they sould be, so you can't count on that for library with 
incomaptible binary interfaces to coexist.

the libtool suggested so-versioning is explained in the libtool 
documentation:
$ sudo apt-get isntall libtool-doc
$ info libtool Versioning

you can find a down to the earth explanation in my 2004 post (i was 
speaking about version numbers but i really meant so-version, that as 
in the current libtool build are independent from the library official 
version):
http://lists.maptools.org/pipermail/gdal-dev/2004-February/002032.html

as far as i know binary compatibility has not been a priority in gdal, 
if this becomes a priority probably it deserves an RFC (ugh!).

cheers,
alessandro

-- 
B-Open Solutions srl - http://www.bopen.it/


From mirhassanali at gmail.com  Thu Nov 16 06:22:17 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] GDAL reentrancy issue
Message-ID: <b41d86b30611160322y315d94a7u29177b3583c73163@mail.gmail.com>

Hi

I am building a small web application in C# that uses a custom assembly(dll)
which in-turn uses the C# wrappers for gdal to read the .shp files (only
read not write).

My question is, since OGR/GDAL is not reentrant (this is what I assume after
reading the post
http://lists.maptools.org/pipermail/gdal-dev/2006-September/010160.html), is
it going to cause any problems to the web application as obviously multiple
users will be using the applications at the same time.

Best Regards

Mir
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061116/9f1fa1ea/attachment.html
From dron at ak4719.spb.edu  Thu Nov 16 07:39:05 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <455B2513.1010203@pobox.com>
References: <0ffc01c708ad$05aa9be0$0a01a8c0@pili> <455B2513.1010203@pobox.com>
Message-ID: <20061116123904.GA661@ak4719.spb.edu>

On Wed, Nov 15, 2006 at 09:32:51AM -0500, Frank Warmerdam wrote:
> >should it be possible to include the correction of this bug
> >http://bugzilla.remotesensing.org/show_bug.cgi?id=1009
> >in release 1.4 ?
> 
> The bug requests a OGRStyleTool destruction method to ensure
> the delete occurs in the same heap where they are created.  It seems
> like a very good idea.
> 
> Would you like to propose a patch I can apply?  I make relatively little
> use of the ogr style classes and methods and am generally hesitant to
> change them.
> 
> Andrey - since you are working in this area currently perhaps you would
> be willing to take this bug report?

Ok, I did a change to deallocate objects in the destructor. Also I have
made a change in the ogr_featurestyle.h to hide data members from the
public sections, so, folks, you will probably need to make clean before
rebuilding the fresh cvs tree.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From R.Beck at m4com.de  Thu Nov 16 08:38:55 2006
From: R.Beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal_translate: Floating point exception when trying to
 convert NSIF image (JPG)
Message-ID: <455C69EF.40603@m4com.de>

Hello,

I get a floating point exception when I try to convert a JPG compressed
NSIF image. The message
    Warning 1: Image with 0 bits per sample will not be interpreted
properly.
can be seen.

> gdal_translate test.nsf test.tif
   Warning 1: Image with 0 bits per sample will not be interpreted properly.
   Input file size is 936, 749
   0Floating point exception

However, I am able to display the image with a different piece of
software correctly.

This happens with gdal from CVS (gdal-cvs-2006.11.07) on a Suse Linux
10.1 (kernel 2.6.16.21-0.25-smp).

Any ideas?

Cheers
Reiner

PS: Here's what gdalinfo reports:
> gdalinfo test.nsf
Warning 1: Image with 0 bits per sample will not be interpreted properly.
Driver: NITF/National Imagery Transmission Format
Size is 936, 749
Coordinate System is:
PROJCS["UTM Zone 33, Northern Hemisphere",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9108"]],
        AXIS["Lat",NORTH],
        AXIS["Long",EAST],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",15],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
GeoTransform =
  351170.7239973262, 0.2732620320856883, -0.2212566844919099
  5782613.220454544, -0.1347593582872143, -0.306149732618176
Metadata:
  NITF_IMAGE_COMMENTS=Test commentary...
  NITF_IC=C3
  NITF_IMODE=
Image Structure Metadata:
  COMPRESSION=JPEG
Corner Coordinates:
Upper Left  (  351170.724, 5782613.220) ( 12d49'24.61"E, 52d10'26.03"N)
Lower Left  (  351005.003, 5782383.914) ( 12d49'16.25"E, 52d10'18.46"N)
Upper Right (  351426.497, 5782487.086) ( 12d49'38.26"E, 52d10'22.20"N)
Lower Right (  351260.776, 5782257.780) ( 12d49'29.90"E, 52d10'14.62"N)
Center      (  351215.750, 5782435.500) ( 12d49'27.26"E, 52d10'20.33"N)
Band 1 Block=9x0 Type=Byte, ColorInterp=YCbCr_Y
Band 2 Block=9x0 Type=Byte, ColorInterp=YCbCr_Cb
Band 3 Block=9x0 Type=Byte, ColorInterp=YCbCr_Cr


From Jukka.Rahkonen at mmmtike.fi  Thu Nov 16 08:51:31 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Benchmarks about LUT colour correction and JPEG2000
	drivers
References: <CC197224AC75CE4DB23F739B16891B866E728B@tikka.haapa.mmm.fi>
	<45540813.3060108@pobox.com>
	<CC197224AC75CE4DB23F739B16891B866684A2@tikka.haapa.mmm.fi>
	<4554ED6E.9080709@pobox.com>
	<CC197224AC75CE4DB23F739B16891B866684B4@tikka.haapa.mmm.fi>
	<455A289B.1070406@pobox.com>
	<CC197224AC75CE4DB23F739B16891B866684B9@tikka.haapa.mmm.fi>
Message-ID: <CC197224AC75CE4DB23F739B16891B866684C4@tikka.haapa.mmm.fi>

Hi,
 
I did some benchmarking while making an acceptance test for a new feature in MapServer, LUT colour correction on-the-fly by using predefined LUT-tables.  More information about this fine feature here:
http://mapserver.gis.umn.edu/docs/howto/raster_data/#special-processing-directives <http://mapserver.gis.umn.edu/docs/howto/raster_data/#special-processing-directives> 
Downloadable ready made MapServer -version for Windows can be found here:
 http://www.gdal.org/dl/fwtools/FWTools109.exe

Frank W. supposed my findings might interest the people reading mapserver-users or even gdal-dev lists, so I cross post this short kind of a test report to both.  
 
I had already checked that the new feature worked as supposed and next I was willing to see how big an effect applying LUT tables on-the-fly has on the efficiency of MapServer.  I set up a Jmeter project to send series of individual WMS requests to MapServer and recorder the server throughput with or without PROSESSING "LUT=..." argument.  Because I have the same images in GeoTIFF, JPEG2000 and ECW formats I desided to make also a quick test to see how MapServer performs with those.  There were actually four members in the format test because FWTools MapServer ships with two JPEG2000 drivers, JP2KAK and JP2ECW.
 
Here are the results in brief:
 
LUT-correction has a negligible effect on MapServer efficiency
   - server throughput without LUT-correction: 271 requests per minute
   - server throughput without LUT-correction: 268 requests per minute
 
There is a really significant difference between the two JPEG2000 drivers, JP2KAK and JP2ECW
   - server throughput with JP2ECW driver: 80 requests per minute
   - server throughput with JP2KAK driver: 24 requests per minute
 
MapServer likes ECW more than JPEG2000
  - server throughput with ECW images: 120 requests per minute
 
My tests should be otherwise quite reliable, but I am not sure if my test set is suitable for straight comparison between JPEG2000 and ECW because my JPEG2000 images were lossless and ECW images were compressed about to the ratio of 1 to 5.  However I am not aware of lossless JPEG2000 files being much harder to decompress than lossy ones even the file size is bigger if JPEG2000 codestreams are organised in a reasonable way, and that should be the case with my JPEG2000 files.
 
I believe that the results about ECW and JPEG2000 can not be generalised but they just tell what I was testing: how MapServer (or perhaps it is GDAL?) utilises them with certain drivers.  I have not found that big difference between ECW and JPEG2000 with other software, and to my experience Kakadu is about (or at least) as fast as ECW JPEG2000.   But for sure it seems to be so that MapServer performance with the current JP2KAK driver is quite bad compared to JP2ECW driver.  It should be no surprise that tiled TIFFs with overviews really suit MapServer best.
 
-Jukka Rahkonen-


From warmerdam at pobox.com  Thu Nov 16 22:52:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal_translate: Floating point exception when trying
	to convert NSIF image (JPG)
In-Reply-To: <455C69EF.40603@m4com.de>
References: <455C69EF.40603@m4com.de>
Message-ID: <455D31E7.1020201@pobox.com>

Reiner Beck wrote:
> Hello,
> 
> I get a floating point exception when I try to convert a JPG compressed
> NSIF image. The message
>     Warning 1: Image with 0 bits per sample will not be interpreted
> properly.
> can be seen.
> 
>> gdal_translate test.nsf test.tif
>    Warning 1: Image with 0 bits per sample will not be interpreted properly.
>    Input file size is 936, 749
>    0Floating point exception
> 
> However, I am able to display the image with a different piece of
> software correctly.
> 
> This happens with gdal from CVS (gdal-cvs-2006.11.07) on a Suse Linux
> 10.1 (kernel 2.6.16.21-0.25-smp).

Reiner,

If you can supply the image, I can look into what is going wrong.  But if
the image header actually has the bits per sample set to 0, then I think the
image is not properly compliant with the NITF specification.  Nevertheless,
there should be something that can be done.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From R.Beck at m4com.de  Thu Nov 16 10:12:36 2006
From: R.Beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal_translate: Floating point exception when trying
	to convert NSIF image (JPG)
In-Reply-To: <455D31E7.1020201@pobox.com>
References: <455C69EF.40603@m4com.de> <455D31E7.1020201@pobox.com>
Message-ID: <455C7FE4.2000208@m4com.de>

Frank Warmerdam wrote:
> Reiner,
>
> If you can supply the image, I can look into what is going wrong.  But if
> the image header actually has the bits per sample set to 0, then I
> think the
> image is not properly compliant with the NITF specification. 
> Nevertheless,
> there should be something that can be done.
>
> Best regards,

Frank,

the NITF image header says:
- Rows (nrows): 749
- Columns (ncols): 936
- Actual Bits/Pixel: 8

I will forward the image in a pm to you.

Another NSIF/NITF related questions: are you aware of the BLOCKA geo
extension? Are there plans to support it, as it is supposed to be more
accurate than the IGEOLO?

Thanks
Reiner

From Ken.Boss at dnr.state.mn.us  Thu Nov 16 10:20:41 2006
From: Ken.Boss at dnr.state.mn.us (Ken Boss)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal newbie-merge geotiff images
In-Reply-To: <23e208430611151256p4efa78d6wbb3e2e1533ca31e2@mail.gmail.com>
References: <23e208430611151256p4efa78d6wbb3e2e1533ca31e2@mail.gmail.com>
Message-ID: <455C2D6902000021000016A5@co5.dnr.state.mn.us>

Hello Izzy--

If using gdal_merge.py, you can simply specify the nodata value on the
command line with the -n option.  So if those black background pixels
are all zeroes, just add -n 0 to your command line.

I would point out, though, that tiff images are limited to a maximum of
4 GB, and that gdal_merge.py reads entire input images into memory, so
you may be constrained by one or both of these.

gdalwarp is likely the better option.  There you can use the -srcnodata
option to specify the nodata value(s) to be ignored from the input
images.  If you're working with a limited number of images, you might
obtain the bounding boxes for the images using the gdalinfo utility.

HTH,

--Ken

>>> Izzy <izzybitsie@gmail.com> 11/15/2006 2:56:47 PM >>>
I am trying to stitch together several satellite geotiff images to
obtain a
world image.
The individual images display the satellite picture with black areas on
the
sides of the picture itself.
So, when merging the images using gdal_merge.py some pictures are
hidden
underneath the black portion of neighbour images.  Couldn't use -pct
option
due to images characteristics. Pls. see below the color tables in the
input
images.

The original images do not have a no-data value assigned to pixels to
avoid
copying them.
So, for now my only option would be to crop the black areas that are
always
the same size around the image.  I am trying to do this using gdalwarp,
but
I still can't figure out how to obtain the georeferenced box to be
used
along with -projwin option.

BTW.  I haven't been able to see these images using OpenEV although I
can
see them with ImageMagick.  Any idea on what I may be doing wrong in
OpenEV?  I do need to run openev with the "-h" option since it quits on
me
when opening an image otherwise.  I have been able to see other
geotiffs
downloaded from Internet in openev though.

Any help on how to cut the black areas is appreciated.



Some info on 2 of the input images and the output images:

Input number 1

Origin = (45.833333,75.000000)
Pixel Size = (0.08055556,-0.08055556)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (  45.8333333,  75.0000000) (142d30'0.03"E,  0d 0'0.04"N)
Lower Left  (  45.8333333, -70.0000000) (142d30'0.03"E,  0d 0'0.04"S)
Upper Right (     239.167,      75.000) (142d30'0.14"E,  0d 0'0.04"N)
Lower Right (     239.167,     -70.000) (142d30'0.14"E,  0d 0'0.04"S)
Center      ( 142.5000000,   2.5000000) (142d30'0.08"E,  0d 0'0.00"N)
Band 1 Block=2400x3 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 0,0,0,255
    1: 0,0,0,255
    2: 0,0,0,255
    3: 0,0,0,255
    4: 0,0,0,255
    5: 0,0,0,255
    6: 0,0,0,255
    7: 0,0,0,255
    8: 0,0,0,255
    9: 0,0,0,255
   10: 0,0,0,255
   11: 0,0,0,255
   12: 0,0,0,255
   13: 0,0,0,255
   14: 0,0,0,255
   15: 0,0,0,255
   16: 0,0,0,255
   17: 0,0,0,255
   18: 0,0,0,255
   19: 0,0,0,255
   20: 0,0,0,255
...............................................................rest of
values in color table look the same

Input number 2
Driver: GTiff/GeoTIFF
Size is 2400, 1800
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT[,0.0174532925199433]],
    PROJECTION["Equirectangular"],
    PARAMETER["latitude_of_origin",2.5],
    PARAMETER["central_meridian",-155],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9102"]]]
Origin = (-251.537842,74.963768)
Pixel Size = (0.08051530,-0.08051530)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (    -251.538,      74.964) (155d 0'0.14"W,  0d 0'0.04"N)
Lower Left  (    -251.538,     -69.964) (155d 0'0.14"W,  0d 0'0.04"S)
Upper Right ( -58.3011272,  74.9637681) (155d 0'0.03"W,  0d 0'0.04"N)
Lower Right ( -58.3011272, -69.9637681) (155d 0'0.03"W,  0d 0'0.04"S)
Center      (-154.9194847,   2.5000000) (155d 0'0.09"W,  0d 0'0.00"N)
Band 1 Block=2400x3 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 0,0,0,255
    1: 0,0,0,255
    2: 0,0,0,255
    3: 0,0,0,255
    4: 0,0,0,255
    5: 0,0,0,255
    6: 0,0,0,255
    7: 0,0,0,255
    8: 0,0,0,255
    9: 0,0,0,255
   10: 0,0,0,255
   11: 0,0,0,255
   12: 0,0,0,255
   13: 0,0,0,255
   14: 0,0,0,255
   15: 0,0,0,255
   16: 0,0,0,255
   17: 0,0,0,255
   18: 0,0,0,255
   19: 0,0,0,255
   20: 0,0,0,255
.................................................................. rest
of
values in color table look the same


Output from gdal_merge.py -o <outpiut> <Input number 1>  <Input number
2>
Driver: GTiff/GeoTIFF
Size is 6067, 1800
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Equirectangular"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",135],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["unknown",1]]
Origin = (-243.264249,69.948187)
Pixel Size = (0.07772021,-0.07772021)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  (    -243.264,      69.948) (134d59'52.13"E,  0d 0'2.28"N)
Lower Left  (    -243.264,     -69.948) (134d59'52.13"E,  0d 0'2.28"S)
Upper Right (     228.264,      69.948) (135d 0'7.38"E,  0d 0'2.28"N)
Lower Right (     228.264,     -69.948) (135d 0'7.38"E,  0d 0'2.28"S)
Center      (  -7.5000000,  -0.0000000) (134d59'59.76"E,  0d 0'0.00"S)
Band 1 Block=6067x1 Type=Byte, ColorInterp=Gray

From warmerdam at pobox.com  Fri Nov 17 01:37:47 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal_translate: Floating point exception when trying
	to convert NSIF image (JPG)
In-Reply-To: <455C7FE4.2000208@m4com.de>
References: <455C69EF.40603@m4com.de> <455D31E7.1020201@pobox.com>
	<455C7FE4.2000208@m4com.de>
Message-ID: <455D58BB.1070605@pobox.com>

Reiner Beck wrote:
> Frank,
> 
> the NITF image header says:
> - Rows (nrows): 749
> - Columns (ncols): 936
> - Actual Bits/Pixel: 8
> 
> I will forward the image in a pm to you.
> 
> Another NSIF/NITF related questions: are you aware of the BLOCKA geo
> extension? Are there plans to support it, as it is supposed to be more
> accurate than the IGEOLO?

Reiner,

I am only vaguely aware of it and hadn't had any plans to support it.
Georeferencing information is read from an RPF TRE in preference to
IGEOLO if available.   If I had a sample image, and a bug report it might
get implemented but it isn't clear to me how useful/important this would
be.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 17 01:54:41 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal_translate: Floating point exception when trying
	to convert NSIF image (JPG)
In-Reply-To: <455C7FE4.2000208@m4com.de>
References: <455C69EF.40603@m4com.de> <455D31E7.1020201@pobox.com>
	<455C7FE4.2000208@m4com.de>
Message-ID: <455D5CB1.9050904@pobox.com>

Reiner Beck wrote:
> Frank,
> 
> the NITF image header says:
> - Rows (nrows): 749
> - Columns (ncols): 936
> - Actual Bits/Pixel: 8
> 
> I will forward the image in a pm to you.
> 
> Another NSIF/NITF related questions: are you aware of the BLOCKA geo
> extension? Are there plans to support it, as it is supposed to be more
> accurate than the IGEOLO?

Reiner,

I am only vaguely aware of it and hadn't had any plans to support it.
Georeferencing information is read from an RPF TRE in preference to
IGEOLO if available.   If I had a sample image, and a bug report it might
get implemented but it isn't clear to me how useful/important this would
be.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From support at geoimage.fr  Thu Nov 16 10:45:58 2006
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Release 1.4.0
References: <0ffc01c708ad$05aa9be0$0a01a8c0@pili> <455B2513.1010203@pobox.com>
	<20061116123904.GA661@ak4719.spb.edu>
Message-ID: <157c01c70996$5002e5a0$0a01a8c0@pili>

Andrey,

> Ok, I did a change to deallocate objects in the destructor. Also I have
> made a change in the ogr_featurestyle.h to hide data members from the
> public sections, so, folks, you will probably need to make clean before
> rebuilding the fresh cvs tree.
> 

I can't see any changes in the cvs; have already put this correction in the cvs ?

Thanks anyway for the bug correction,

Frederic.

From epatton at nrcan.gc.ca  Thu Nov 16 10:12:14 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] Configuring for GeoJP2 support
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C36@s5-dar-r1.nrn.nrcan.gc.ca>

Hi,

I've installed the jasper-1.701.0.uuid package in /usr/local successfully, but I'm not sure what my configure line should be to enable GeoJP2 support. What changes should I make to my gdal-1.3.2 config to enable this package?

Current gdal-1.3.2 configure line:

sudo ./configure \
--without-libtool \
--without-grass \
--with-png=internal \
--with-jpeg=internal \
--with-gif=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-libz=internal \
--with-proj-share=/usr/local/share/proj \
--without-pg \
--with-hdf \
--with-hdf-includes=/usr/include/hdf \
--without-ogdi \
--with-python \
--with-sqlite \
--with-threads=yes

Thanks,

~ Eric.


From R.Beck at m4com.de  Thu Nov 16 11:54:58 2006
From: R.Beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] *** glibc detected *** gdalinfo: free(): invalid
 pointer: 0x08053f7e ***
Message-ID: <455C97E2.7070302@m4com.de>

Frank,

sorry for bothering you again:

gdalinfo crashes badly on a different NITF/NSIF image. The image is not
compressed.

Oh, and the Geo Coordinates are wrong: the IGEOLO contains
'+41.284+020.075+41.319+020.078+41.317+020.126+41.282+020.123'.

Cheers
Reiner



> gdalinfo test.ntf
Driver: NITF/National Imagery Transmission Format
Size is 987, 1000
Coordinate System is `'
Origin = (0.000000,0.000000)
Pixel Size = (0.00000000,0.00000000)
Metadata:
  NITF_IC=NC
  NITF_IMODE=P
Corner Coordinates:
Upper Left  (   0.0000000,   0.0000000)
Lower Left  (   0.0000000,   0.0000000)
Upper Right (   0.0000000,   0.0000000)
Lower Right (   0.0000000,   0.0000000)
Center      (   0.0000000,   0.0000000)
Band 1 Block=987x1 Type=Byte, ColorInterp=Undefined
*** glibc detected *** gdalinfo: free(): invalid pointer: 0x08053f7e ***
======= Backtrace: =========
/lib/libc.so.6[0xb7474911]
/lib/libc.so.6(__libc_free+0x84)[0xb7475f84]
/opt/m4com/util/lib/libgdal.so.1(VSIFree+0x21)[0xb7aecb51]
/opt/m4com/util/lib/libgdal.so.1(NITFImageDeaccess+0xa8)[0xb7a75918]
/opt/m4com/util/lib/libgdal.so.1(NITFClose+0x6f)[0xb7a70f4f]
/opt/m4com/util/lib/libgdal.so.1(_ZN11NITFDatasetD0Ev+0x5b)[0xb7a6d3db]
/opt/m4com/util/lib/libgdal.so.1(GDALClose+0x98)[0xb7ac5f78]
gdalinfo[0x804a835]
/lib/libc.so.6(__libc_start_main+0xdc)[0xb742687c]
gdalinfo[0x8049831]
...

From izzybitsie at gmail.com  Thu Nov 16 11:56:32 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] gdal newbie-merge/gdalwarp geotiff
Message-ID: <23e208430611160856s37581a26yb0064b97eb804f70@mail.gmail.com>

Hi,
I am trying to stitch together geotiff satellite images to obtain a world
satellite picture.

I experience problems with the colors in the output image when using
gdal_merge.py.  All the colors are fainted.  I suspect this has to do with
the fact that the input images have ColorInterp=palette but the palette has
values:0,0,0,255 for all 256 elements.  I have been looking around to
determine how I could use the the input images colors for the output with no
luck so far.  If I use -pct option with gdal_merge.py then my output image
is all black.
I tried using gdalwarp but I obtained a black output image even if I try to
just place one input image in the output.  Since I am not familiar with GDAL
or GIS area at all, I suspect I am not using gdalwarp correctly.  I tried:
gdalwarp input.tif output.tif
gdalwarp -s_srs 'ULx ULy LRx LRy' input.tif output.tif where the values
enclosed in quotes are the gdalinfo UL and LR coordinates for input.tif.
gdalwarp -t_srs '+proj=equirectangular +datum=WGS84' input.tif output.tif
input image projection=equirectangular

Is there any way to set the output color table that would give me an output
image with same colors I have on input images?

Are there documentation websites I could use to learn more about the usage
of the options to run gdal_merge.py or gdalwarp?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061116/eaef60b5/attachment.html
From warmerdam at pobox.com  Thu Nov 16 15:18:13 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:28 2007
Subject: [Gdal-dev] *** glibc detected *** gdalinfo: free(): invalid
	pointer: 0x08053f7e ***
In-Reply-To: <455C97E2.7070302@m4com.de>
References: <455C97E2.7070302@m4com.de>
Message-ID: <455CC785.9080403@pobox.com>

Reiner Beck wrote:
> Frank,
> 
> sorry for bothering you again:
> 
> gdalinfo crashes badly on a different NITF/NSIF image. The image is not
> compressed.
> 
> Oh, and the Geo Coordinates are wrong: the IGEOLO contains
> '+41.284+020.075+41.319+020.078+41.317+020.126+41.282+020.123'.

Reiner,

My initial inspection of the previous file suggests that the NITF 1.0
header reading logic is broken in some regard.  I'll try and let you know
if/when I fix this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ILucena at clarku.edu  Thu Nov 16 13:57:52 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	forstoringgeoreferencedimages
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455022555B8@Iris.ad.clarku.edu>

Excellent work Jordi,

I really like it, but I am just curious about one comment that you made:

>> ... In GeoQuadTree there is no need of a spatial index, tile 
>> index, catalog of images, or a database. There is a simple 
>> algorithm that calculates the specific level of the pyramid, 
>> and the specific tiles to access. ...

I guess that you didn't pick the "Quad Tree" name in vain; And Quad Tree is considered as a spatial indexing technique by some (*Spatial Access Method* Chapter 6 in "Spatial Databases, with Application to GIS" by Rigaux, Scholl and Voisard). I hope you don't have a copyright issue with Hannan Samet :-) Just kidding!

Does your algorithm include the Quad Tree's concept of having four initial quadrants NW, NE, SW and SE to breakdown your images and repeat it recursively until the desired level of details? I guess that the four quadrants are translated into four folders in "GeoQuadTree". That is really clever!

And what happens if in one quadrant of your image there is only NODATA value? You just skip that folder's subfolders creation just like Quad Tree does with tree nodes? 

In this case I can see how important the NODATA is to your technique and why you picked PNG. You are concerned about the format that a web browser can display and that is what you need at that point of the process.

Very very good. I am looking forward to try it out.

Best regards,

---
Ivan Lucena


________________________________________
From: gdal-dev-bounces@lists.maptools.org [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Jordi Gilabert Vall
Sent: Wednesday, November 15, 2006 3:51 AM
To: Ed McNierney
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GeoQuadTree - an open format forstoringgeoreferencedimages

As far as I know, TILEINDEX is a MapServer related thing. Can a GDAL-linked application access to it ?

In TILEINDEX, the list of files forming a layer are stored in a shapefile with polygons representing the footprint of each file, and the name of the files. In GeoQuadTree there is no need of a spatial index, tile index, catalog of images, or a database. There is a simple algorithm that calculates the specific level of the pyramid, and the specific tiles to access. The algorithm calculates the path in the filesystem needed to retrieve the tiles. The XML file in the GeoQuadTree doesn't include a catalogue/index, it only need 6 attributes: the name of the tile file names, the number of levels in the pyramid of overviews, the size of the pixel in CRS units, and the size of the tile in pixels. If you import overlapped images into the same GeoQuadTree image, the common region of one will be overwritten with the other. 

As an example, I loaded NASA's Blue Marble Next Generation at a resolution of 15-arc-seconds. This is an image of 86400x43200 pixels in size, that is about 2.5 GB on disk. I chose the size of the tiles as 270x270 pixels. There were built 52015 tiles. When I said that i wanted to "avoid? the use of tile indexes or catalogues of images", I meant that in order to manage a so huge quantity of tiles, you need a database. The database can be very efficient, but it's sure that it's even more efficient if you don't need one, and of course much simpler. For instance, you can write a simple web viewer that can do all this calculations, without a database. You only need a web server. I wrote a viewer like similar to Google Maps or Windows Live Maps, and you could view almost instantaneously images of 2000x2000 pixels in size, or greater. The response time was only affected by the time needed by the web server to send the tile images to your browser. 

I only wanted a lossless compression, so I chose PNG format for tiles, but many people also wants a lossless compression, so I'm going to support two types of compression, PNG and maybe JPEG or JPEG2000. I like the PNG format because with 4-bands PNGs (RGBA), the alpha channel allows me to store non-data pixels. With JPEG format, I would "sacrifice" a RGB color to represent non-data values. There is also the need of supporting multi-band images, this could be accomplished with as many PNGs as bands. These are small changes, I will try to make it on the next release.

On the other side, I think storage space is not the big problem nowadays. I prefer more efficient algorithms in terms of CPU usage, than efficient in terms of storage space. If someone prefer the reduction of storage space, the wavelet compression approach could be preferred (LizardTech's MrSID, ER Mapper's...). I want the freedom to choose a simpler, efficient an FREE approach.

GeoQuadTree handles a pyramid of overviews. When you create a GeoQuadTree image, you specifiy the number of levels in the pyramid. Every time you import a image into a GeoQuadTree, the utility builds the pyramid of overviews (only updates the tiles affected upside in the pyramid).

Thank you for your interest all you comments,

Jordi

On 11/15/06, Ed McNierney <ed@topozone.com> wrote:
Simon -
?
TILEINDEX is a MapServer/quasi-GDAL mechanism for handling a large number of rasters as a single unit.? The rasters don't need to be the same size, and can overlap - I suspect they can even be different file formats, although I've never tried, and they can be stored anywhere in the file system.
?
The TILEINDEX scheme uses an ESRI shapefile (with an optional quadtree index on it) as a spatial index for the rasters.? One polygon is generated for each raster, with that polygon representing the bounding box of that file.? The path to the raster file itself is stored as a string attribute of the polygon.? Applications use the spatial/geometry features of the polygon to determine which input image(s) if any intersect the area of interest for drawing.
?
It's not the same sort of thing, exactly, and there are no tools I'm aware of for managing the individual image organization on disk.? But it works well for me.? I use TILEINDEX structures to manage about 500,000 individual raster files that are about 40 terabytes altogether (haven't counted lately <g>).? It could certainly use enhancement, but it might be a good starting point for such a project.
?
??? - Ed
Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA? 01863
Phone: +1 (978) 251-4242
Fax: +1 (978) 251-1396
ed@topozone.com 

________________________________________
From: Simon Perkins [mailto:sy@perkins.net] 
Sent: Tuesday, November 14, 2006 8:52 PM
To: Ed McNierney
Cc: Brent Fraser; Jordi Gilabert Vall; gdal-dev@lists.maptools.org

Subject: Re: [Gdal-dev] GeoQuadTree - an open format for storinggeoreferencedimages



TIFF has some pretty serious file size limitations so wouldn't be good for these kinds of large rasters. I'm not familiar with TILEINDEX, but is this a MapServer related thing? Is that applicable to local image storage on the desktop?

I think the GeoQuadTree idea is interesting - it doesn't rely on large file support on the OS (not that that's a serious problem for any modern OSes), and dealing with lots of small files could be more efficient than one large file in some cases I would think.

As for PNG vs JPEG, it depends on whether you're happy to accept lossy compression or not. For many applications, customers are averse to losing any resolution. It might make sense to make the underlying file format in GeoQuadTree flexible acording to application. Actually, I'd prefer to see a format that can handle multispectral files - PNG and JPEG are both limited to 1 or 3 bands, aren't they? Or are multiple bands stored as separate grayscale images?

I would guess that with very large rasters, some sort of pyramid scheme becomes important in addition to the tiling, so that if you just want to get an overview of the whole image, you don't have to read every single file. Does GeoQuadTree handle that?

But, Ed is right that storing very large rasters is a not a new problem. So, what do people do? I guess that at the high end, outfits like Google Earth use a spatial database to organize multiple individual raster files and then stich them together. Could somebody outline the solution used by the Virtual Terrain project?

Cheers,

Sy


Ed McNierney wrote: 
Jordi -
?
You said you wanted to "avoid the use of tile indexes or catalogues of images", but isn't that exactly what your XML catalogue/index does?? It seems that the GeoQuadTree format is a different form of that same sort of structure.? There are several different ways of doing this now, including the TILEINDEX mechanism, tiled TIFF files, etc.? I'm sure there are limitations to each, but I'm not sure that yet another tiling scheme will help.
?
In particular, PNG is not the best format for all images, and it's important to support other encoding mechanisms, especially JPEG.? Photographic images are huge when stored in PNG format, and JPEG is usually a much better choice.? Conversely, scanned line art and synthetic images generally compress and store better as PNG images.
?
??? - Ed
Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA? 01863
ed@topozone.com
(978) 251-4242 

________________________________________
From: gdal-dev-bounces@lists.maptools.org [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Brent Fraser
Sent: Tuesday, November 14, 2006 3:05 PM
To: Jordi Gilabert Vall; gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GeoQuadTree - an open format for storinggeoreferencedimages
For those interested tiling,
?
? There is similar tiling related?discussion/work going on at:
?
??????? http://lists.eogeo.org/mailman/listinfo/tiling ?(do they have a web page?)
?
??? and 
??? ??? ??? http://www.stereofx.org/terrain.html, implemented in http://vterrain.org/, particularly VTBuilder (http://vterrain.org/Doc/VTBuilder/overview.html)
?
Brent Fraser
----- Original Message ----- 
From: Jordi Gilabert Vall 
To: gdal-dev@lists.maptools.org 
Sent: Tuesday, November 14, 2006 3:25 AM
Subject: [Gdal-dev] GeoQuadTree - an open format for storing georeferencedimages

Hi,

Some time ago I needed the retrieval from very large georeferenced raster images in a OGC WMS server, and I wanted to avoid the use of tile indexes or catalogues of images, neither a database. I started thinking of an open format for storing arbitrarily large georeferenced images. I named this format "GeoQuadTree", as it would be based on a quadtree of rectangular tiles, each in PNG format on the filesystem, in a simple hierarchical structure of folders. I wrote a command line utility for creating it, importing from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also wrote a GDAL driver for this format. I tested successfully with my own WMS server software, and on MapServer compiled with GDAL support. It worked very well on Blue Marble Next Generation at a resolution of 15 arc-seconds, i.e. 86400x43200 pixels. 
You can find more information on the project web site:
http://geoquadtree.org/ 
I'm testing the release 1.0.0, you can test it on the subversion repository if you want (I haven't packaged it yet).
I think it's a useful format, open, very easy to use, and very efficient (in terms of response time).
Do you think it could be useful for you ? Would you like to include it on GDAL's next release ?
jordi at geoquadtree org
________________________________________
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev
________________________________________

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org

http://lists.maptools.org/mailman/listinfo/gdal-dev



From com at navicon.dk  Thu Nov 16 14:06:20 2006
From: com at navicon.dk (oland)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Layer for OpenMap using GDAL
Message-ID: <7384494.post@talk.nabble.com>


Here is code for displaying GDAL rasters in OpenMap.org

http://www.navicon.dk/GDALLayer.java.html GDALLayer.java 

regards
/carsten
-- 
View this message in context: http://www.nabble.com/Layer-for-OpenMap-using-GDAL-tf2645240.html#a7384494
Sent from the GDAL - Dev mailing list archive at Nabble.com.


From jordi at geoquadtree.org  Thu Nov 16 14:59:58 2006
From: jordi at geoquadtree.org (Jordi Gilabert Vall)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GeoQuadTree - an open format
	forstoringgeoreferencedimages
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455022555B8@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455022555B8@Iris.ad.clarku.edu>
Message-ID: <6d26117e0611161159i3b46b8a5id75c7266457ebf55@mail.gmail.com>

Thank you Ivan,

You are right, a quadtree can be considered and IS a spatial indexing
technique, I wish I could expressed myself better. I meant that the spatial
indexing can be inherent to the structure of the folders.

If in one quadrant there is only NODATA, its folder simply doesn't exist. As
an example, if I want to access the quadrant NW/NE/SE/NE/SE/NW, then i look
up the tile /1/2/3/2/3/1/gqt.png on the filesystem, but it doesn't exist,
then I know that there is only NODATA pixels in that quadrant. When you
import an image into an existing GeoQuadTree, only the tiles affected by
pixels with data should be rewritten, fusioning the existing ones on the
filesystem with the new pixels. If the tile doesn't exist, you simply create
all the list of parent folders and the tile image. If the tile exists, you
read it to memory, overwrite its pixels with the pixels of the image you are
importing, and write the new tile to the same location.

Some people would like to have the freedom to choose other image formats for
tiles, like JPEG, TIFF or JPEG2000. I'm working on this. For instance, if
you choose JPG format for tiles, the non-data pixels must be translated to a
fixed color, say black, or white, or whatever, but the importing process is
the same.

Regards,

Jordi

On 11/16/06, Ivan Lucena <ILucena@clarku.edu> wrote:
>
> Excellent work Jordi,
>
> I really like it, but I am just curious about one comment that you made:
>
> >> ... In GeoQuadTree there is no need of a spatial index, tile
> >> index, catalog of images, or a database. There is a simple
> >> algorithm that calculates the specific level of the pyramid,
> >> and the specific tiles to access. ...
>
> I guess that you didn't pick the "Quad Tree" name in vain; And Quad Tree
> is considered as a spatial indexing technique by some (*Spatial Access
> Method* Chapter 6 in "Spatial Databases, with Application to GIS" by Rigaux,
> Scholl and Voisard). I hope you don't have a copyright issue with Hannan
> Samet :-) Just kidding!
>
> Does your algorithm include the Quad Tree's concept of having four initial
> quadrants NW, NE, SW and SE to breakdown your images and repeat it
> recursively until the desired level of details? I guess that the four
> quadrants are translated into four folders in "GeoQuadTree". That is really
> clever!
>
> And what happens if in one quadrant of your image there is only NODATA
> value? You just skip that folder's subfolders creation just like Quad Tree
> does with tree nodes?
>
> In this case I can see how important the NODATA is to your technique and
> why you picked PNG. You are concerned about the format that a web browser
> can display and that is what you need at that point of the process.
>
> Very very good. I am looking forward to try it out.
>
> Best regards,
>
> ---
> Ivan Lucena
>
>
> ________________________________________
> From: gdal-dev-bounces@lists.maptools.org [mailto:
> gdal-dev-bounces@lists.maptools.org] On Behalf Of Jordi Gilabert Vall
> Sent: Wednesday, November 15, 2006 3:51 AM
> To: Ed McNierney
> Cc: gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] GeoQuadTree - an open format
> forstoringgeoreferencedimages
>
> As far as I know, TILEINDEX is a MapServer related thing. Can a
> GDAL-linked application access to it ?
>
> In TILEINDEX, the list of files forming a layer are stored in a shapefile
> with polygons representing the footprint of each file, and the name of the
> files. In GeoQuadTree there is no need of a spatial index, tile index,
> catalog of images, or a database. There is a simple algorithm that
> calculates the specific level of the pyramid, and the specific tiles to
> access. The algorithm calculates the path in the filesystem needed to
> retrieve the tiles. The XML file in the GeoQuadTree doesn't include a
> catalogue/index, it only need 6 attributes: the name of the tile file names,
> the number of levels in the pyramid of overviews, the size of the pixel in
> CRS units, and the size of the tile in pixels. If you import overlapped
> images into the same GeoQuadTree image, the common region of one will be
> overwritten with the other.
>
> As an example, I loaded NASA's Blue Marble Next Generation at a resolution
> of 15-arc-seconds. This is an image of 86400x43200 pixels in size, that is
> about 2.5 GB on disk. I chose the size of the tiles as 270x270 pixels.
> There were built 52015 tiles. When I said that i wanted to "avoid the use of
> tile indexes or catalogues of images", I meant that in order to manage a so
> huge quantity of tiles, you need a database. The database can be very
> efficient, but it's sure that it's even more efficient if you don't need
> one, and of course much simpler. For instance, you can write a simple web
> viewer that can do all this calculations, without a database. You only need
> a web server. I wrote a viewer like similar to Google Maps or Windows Live
> Maps, and you could view almost instantaneously images of 2000x2000 pixels
> in size, or greater. The response time was only affected by the time needed
> by the web server to send the tile images to your browser.
>
> I only wanted a lossless compression, so I chose PNG format for tiles, but
> many people also wants a lossless compression, so I'm going to support two
> types of compression, PNG and maybe JPEG or JPEG2000. I like the PNG format
> because with 4-bands PNGs (RGBA), the alpha channel allows me to store
> non-data pixels. With JPEG format, I would "sacrifice" a RGB color to
> represent non-data values. There is also the need of supporting multi-band
> images, this could be accomplished with as many PNGs as bands. These are
> small changes, I will try to make it on the next release.
>
> On the other side, I think storage space is not the big problem nowadays.
> I prefer more efficient algorithms in terms of CPU usage, than efficient in
> terms of storage space. If someone prefer the reduction of storage space,
> the wavelet compression approach could be preferred (LizardTech's MrSID, ER
> Mapper's...). I want the freedom to choose a simpler, efficient an FREE
> approach.
>
> GeoQuadTree handles a pyramid of overviews. When you create a GeoQuadTree
> image, you specifiy the number of levels in the pyramid. Every time you
> import a image into a GeoQuadTree, the utility builds the pyramid of
> overviews (only updates the tiles affected upside in the pyramid).
>
> Thank you for your interest all you comments,
>
> Jordi
>
> On 11/15/06, Ed McNierney <ed@topozone.com> wrote:
> Simon -
>
> TILEINDEX is a MapServer/quasi-GDAL mechanism for handling a large number
> of rasters as a single unit. The rasters don't need to be the same size, and
> can overlap - I suspect they can even be different file formats, although
> I've never tried, and they can be stored anywhere in the file system.
>
> The TILEINDEX scheme uses an ESRI shapefile (with an optional quadtree
> index on it) as a spatial index for the rasters. One polygon is generated
> for each raster, with that polygon representing the bounding box of that
> file. The path to the raster file itself is stored as a string attribute of
> the polygon. Applications use the spatial/geometry features of the polygon
> to determine which input image(s) if any intersect the area of interest for
> drawing.
>
> It's not the same sort of thing, exactly, and there are no tools I'm aware
> of for managing the individual image organization on disk. But it works well
> for me. I use TILEINDEX structures to manage about 500,000 individual raster
> files that are about 40 terabytes altogether (haven't counted lately <g>).
> It could certainly use enhancement, but it might be a good starting point
> for such a project.
>
> - Ed
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA 01863
> Phone: +1 (978) 251-4242
> Fax: +1 (978) 251-1396
> ed@topozone.com
>
> ________________________________________
> From: Simon Perkins [mailto:sy@perkins.net]
> Sent: Tuesday, November 14, 2006 8:52 PM
> To: Ed McNierney
> Cc: Brent Fraser; Jordi Gilabert Vall; gdal-dev@lists.maptools.org
>
> Subject: Re: [Gdal-dev] GeoQuadTree - an open format for
> storinggeoreferencedimages
>
>
>
> TIFF has some pretty serious file size limitations so wouldn't be good for
> these kinds of large rasters. I'm not familiar with TILEINDEX, but is this a
> MapServer related thing? Is that applicable to local image storage on the
> desktop?
>
> I think the GeoQuadTree idea is interesting - it doesn't rely on large
> file support on the OS (not that that's a serious problem for any modern
> OSes), and dealing with lots of small files could be more efficient than one
> large file in some cases I would think.
>
> As for PNG vs JPEG, it depends on whether you're happy to accept lossy
> compression or not. For many applications, customers are averse to losing
> any resolution. It might make sense to make the underlying file format in
> GeoQuadTree flexible acording to application. Actually, I'd prefer to see a
> format that can handle multispectral files - PNG and JPEG are both limited
> to 1 or 3 bands, aren't they? Or are multiple bands stored as separate
> grayscale images?
>
> I would guess that with very large rasters, some sort of pyramid scheme
> becomes important in addition to the tiling, so that if you just want to get
> an overview of the whole image, you don't have to read every single file.
> Does GeoQuadTree handle that?
>
> But, Ed is right that storing very large rasters is a not a new problem.
> So, what do people do? I guess that at the high end, outfits like Google
> Earth use a spatial database to organize multiple individual raster files
> and then stich them together. Could somebody outline the solution used by
> the Virtual Terrain project?
>
> Cheers,
>
> Sy
>
>
> Ed McNierney wrote:
> Jordi -
>
> You said you wanted to "avoid the use of tile indexes or catalogues of
> images", but isn't that exactly what your XML catalogue/index does? It seems
> that the GeoQuadTree format is a different form of that same sort of
> structure. There are several different ways of doing this now, including the
> TILEINDEX mechanism, tiled TIFF files, etc. I'm sure there are limitations
> to each, but I'm not sure that yet another tiling scheme will help.
>
> In particular, PNG is not the best format for all images, and it's
> important to support other encoding mechanisms, especially JPEG.
> Photographic images are huge when stored in PNG format, and JPEG is usually
> a much better choice. Conversely, scanned line art and synthetic images
> generally compress and store better as PNG images.
>
> - Ed
> Ed McNierney
> President and Chief Mapmaker
> TopoZone.com / Maps a la carte, Inc.
> 73 Princeton Street, Suite 305
> North Chelmsford, MA 01863
> ed@topozone.com
> (978) 251-4242
>
> ________________________________________
> From: gdal-dev-bounces@lists.maptools.org [mailto:
> gdal-dev-bounces@lists.maptools.org] On Behalf Of Brent Fraser
> Sent: Tuesday, November 14, 2006 3:05 PM
> To: Jordi Gilabert Vall; gdal-dev@lists.maptools.org
> Subject: Re: [Gdal-dev] GeoQuadTree - an open format for
> storinggeoreferencedimages
> For those interested tiling,
>
> There is similar tiling relateddiscussion/work going on at:
>
> http://lists.eogeo.org/mailman/listinfo/tiling (do they have a web page?)
>
> and
>   http://www.stereofx.org/terrain.html, implemented in
> http://vterrain.org/, particularly VTBuilder (
> http://vterrain.org/Doc/VTBuilder/overview.html)
>
> Brent Fraser
> ----- Original Message -----
> From: Jordi Gilabert Vall
> To: gdal-dev@lists.maptools.org
> Sent: Tuesday, November 14, 2006 3:25 AM
> Subject: [Gdal-dev] GeoQuadTree - an open format for storing
> georeferencedimages
>
> Hi,
>
> Some time ago I needed the retrieval from very large georeferenced raster
> images in a OGC WMS server, and I wanted to avoid the use of tile indexes or
> catalogues of images, neither a database. I started thinking of an open
> format for storing arbitrarily large georeferenced images. I named this
> format "GeoQuadTree", as it would be based on a quadtree of rectangular
> tiles, each in PNG format on the filesystem, in a simple hierarchical
> structure of folders. I wrote a command line utility for creating it,
> importing from PNG/JPEG/TIFF and exporting to PNG/JPEG/TIFF/GDAL. I also
> wrote a GDAL driver for this format. I tested successfully with my own WMS
> server software, and on MapServer compiled with GDAL support. It worked very
> well on Blue Marble Next Generation at a resolution of 15 arc-seconds, i.e.
> 86400x43200 pixels.
> You can find more information on the project web site:
> http://geoquadtree.org/
> I'm testing the release 1.0.0, you can test it on the subversion
> repository if you want (I haven't packaged it yet).
> I think it's a useful format, open, very easy to use, and very efficient
> (in terms of response time).
> Do you think it could be useful for you ? Would you like to include it on
> GDAL's next release ?
> jordi at geoquadtree org
> ________________________________________
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> ________________________________________
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
>
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061116/e2c59078/attachment.html
From izzybitsie at gmail.com  Thu Nov 16 15:34:45 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdalinfo - color table issue
Message-ID: <23e208430611161234u13b3dc57jb827e69ef5e9377e@mail.gmail.com>

"gdalinfo input.tif" prints a color table with all elements  set to 0,0,0 .
input.tif is a GTiff satellite image
However, when I look at the image info using ImageMagick the color table is
not even close to these values.
Any idea on what could be happening?
I am trying to compose images of this type into one world image and whenever
I use merge_gdal.py -pct input1.tif input2.tif output.tif, the image
output.tif is all black. I originally thought the problem was the color
table was not stored properly in the GTiff image, but I am confused now.

Tx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061116/dbb78a86/attachment.html
From mateusz at loskot.net  Thu Nov 16 15:49:26 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: Problem : Building GDAL for windows CE
In-Reply-To: <4559BC52.8050807@loskot.net>
References: <20061114052043.35834.qmail@web52203.mail.yahoo.com>
	<4559BC52.8050807@loskot.net>
Message-ID: <455CCED6.9020102@loskot.net>

Hi,

Today, I applied a few small fixes for Windows CE to the GDAL CVS.
I successfully compiled gdal for Pocket PC 2003 and Windows Mobile 5.0
using Visual C++ 2005.
Unfortunately, I don't have any free Windows box where I could
install eVC++ 4.0 at the moment.

That's all I can help for now.

Cheers
Mateusz

Mateusz Loskot wrote:
> kiruba,
> 
> Please, give me a day till tomorrow night (Wednesday)
> I'm on my way to investigate it in details.
> I appologize to for the delay.
> 
> Cheers
> Mateusz
> 
> 
> kiruba nantham wrote:
>> Hello Mr. Mateusz,       
>> I am sorry to disturb you again and again, when you are busy.
>>             Now I am building *gdal-cvs-2006.11.13 *I have copied all
>> the required headers and libraries to gdal-cvs-2006.11.13* *folder. Then
>> I started to build *gdal-cvs-2006.11.13 *from* *command prompt but now
>> it?s throwing this error *fatal error LNK1112: module machine type ?X86?
>> conflicts with target machine type ?ARM?*.
>>            If I build *gdal-cvs-2006.11.13 (*evc4_gdalce_dll.vcw
>> workspace*)* using EVC++ 4.0. I am getting *gdalce_evc4.dll* but when I
>> am building *gdal-cvs-2006.11.13 *source I am getting 130 warnings
>> Warnings are:
>>    Warning C4530: C++ exception handler used, but unwind semantics are not 
>>                          enabled. Specify ?GX.
>>    Warning C4275: non dll-interface class 'std::basic_string<char,struct
>>                          std::char_traits<char>, class
>> std::allocator<char> >' used as
>>                          base for dll-interface class 'CPLString'.
>>          These two warnings are repeating and
>> Linker Warnings are:
>>    mitab_feature.obj: warning LNK1166: cannot adjust code at
>> offset=0x00001000,                               rva=0x0001C7DC.
>>    mitab_feature_mif.obj: warning LNK1166: cannot adjust code at
>>                              offset=0x00001000, rva=0x000326C0
>>    ogr_srs_proj4.obj: warning LNK1166: cannot adjust code at  
>>                              offset=0x00001000, rva=0x000947D0
>>    ogrspatialreference.obj: warning LNK1166: cannot adjust code at
>>                              offset=0x00001000, rva=0x000C5794
>>           And also when it is connecting to emulator it?s prompting this
>> error (The intel 80486 CPU does not support configuration
>> evc4_gdalce_dll-Win32 (WCE ARMV4) Debug! Executable will not run on
>> device. Continue?) If I give OK to continue it is building this
>> *gdalce_evc4.dll *but it is of no use. Please can you tell me how to
>> solve this?
>> Thank you,
>> Kirubanantham.K.
>>
>> ------------------------------------------------------------------------
>> Everyone is raving about the all-new Yahoo! Mail beta.
>> <http://us.rd.yahoo.com/evt=45083/*http://advision.webevents.yahoo.com/mailbeta>
>>
> 
> 


-- 
Mateusz Loskot
http://mateusz.loskot.net

From epatton at nrcan.gc.ca  Fri Nov 17 12:00:05 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdalinfo on JP2 uses 100% of RAM, then crashes
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C3D@s5-dar-r1.nrn.nrcan.gc.ca>

I'm trying to convert  JP2 to GTiff format. Before I use gdal_translate for this, I just want to see the projection info for the JP2. Running gdalinfo on the JP2 causes RAM usage to increase to 100%, soon after which "killed" is printed to the command prompt.

I can see that JPEG2000 is among the supported formats in my GDAL 1.3.2 installation:

$ gdalinfo --formats | grep JPEG
JPEG (rw): JPEG JFIF
JPEG2000 (rw): JPEG-2000 part 1 (ISO/IEC 15444-1)

I installed the jasper-1.701-1.uuid.tar.gz package, and it seemed to install without errors. However, the GeoJP2 support is conspicuously absent from my compile output:

<snip>
LIBJPEG support:   internal
KAKADU support:    no
JASPER support:    yes (GeoJP2=no)
<snip>

Could that be the problem? If so, is there anything else I need to do during ./configure to enable this functionality?

~ Eric.




From warmerdam at pobox.com  Fri Nov 17 16:52:26 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdalinfo on JP2 uses 100% of RAM, then crashes
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C3D@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C26208C55C3D@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <455E2F1A.30904@pobox.com>

Patton, Eric wrote:
> I'm trying to convert  JP2 to GTiff format. Before I use gdal_translate for
> this, I just want to see the projection info for the JP2. Running gdalinfo
> on the JP2 causes RAM usage to increase to 100%, soon after which "killed"
> is printed to the command prompt.
> 
> I can see that JPEG2000 is among the supported formats in my GDAL 1.3.2
> installation:
> 
> $ gdalinfo --formats | grep JPEG JPEG (rw): JPEG JFIF JPEG2000 (rw):
> JPEG-2000 part 1 (ISO/IEC 15444-1)
> 
> I installed the jasper-1.701-1.uuid.tar.gz package, and it seemed to install
> without errors. However, the GeoJP2 support is conspicuously absent from my
> compile output:
> 
> <snip> LIBJPEG support:   internal KAKADU support:    no JASPER support:
> yes (GeoJP2=no) <snip>
> 
> Could that be the problem? If so, is there anything else I need to do during
> ./configure to enable this functionality?

Eric,

In my experience the JasPer based driver uses a lot of memory.  It decompresses
the whole image into memory to access it, but in my experience it actually
uses on the order of 10x the memory required to hold the *uncompressed*
image during the decoding process.

I would guess your image is non-trivial in size, and that the driver is
running out of memory during decoding.

I would discourage use of the JasPer based driver except for "consumer sized
images" (ie. from your digital camera) - the task for which the library
was intended.

I would suggest building with the ECW SDK instead for reasonably efficient
jpeg2000 support that will scale up to very large image sizes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Fri Nov 17 13:17:08 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
Message-ID: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>

Hi,
 
I'm reading in a GDAL dataset, doing some processing, and outputting it to another file.  The output file is created using the Create() function, but I want to make sure I copy over all the metadata from the source.
 
What do I need to do to ensure I've copied over all metadata and geographic info?    Is GetMetaData(), GetProjectionRef(), and GetGeoTransform() all I need, followed by subsequent calls to SetMetaData(), SetProjectionRef(), and SetGeoTransform() ?    
 
Thanks in advance!
 
matt


From mhanson at photon.com  Fri Nov 17 13:18:52 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Release 1.4.0
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
Message-ID: <0719BE42F22E0A46857DF72644EC5D702785F9@pj-exchange.photon.com>

> Following up on Ari's suggestion, I'd like to plan on a new GDAL release
> by mid December, perhaps with a first official beta December 1st.
>
> What work are people hoping to get into a next GDAL release?
>

I would like to see Statistics for RasterBand's include the row/col location for the min and max of the band, requiring 4 more parameters to GDALRasterBand::GetStatistics().   The information would already be available from scanning the image, just a matter of storing it.
 
matt

 


From epatton at nrcan.gc.ca  Fri Nov 17 13:31:52 2006
From: epatton at nrcan.gc.ca (Patton, Eric)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdalinfo on JP2 uses 100% of RAM, then crashes
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C3D@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <0E5A77B55A57D511BB3F0002A537C26208C55C41@s5-dar-r1.nrn.nrcan.gc.ca>

Thanks, Frank. I have just installed the ER Mapper ECW SDK; what is that proper configure line to include it?

Something like

--with-ecw (?)
--with-ecw-includes=(?)

Will gdal pick the 'best' driver for importing JP2 files, or do I have to uninstall the jasper libraries then recompile so it only uses the ecw driver?

Thanks,

~ Eric.

 



Eric,

In my experience the JasPer based driver uses a lot of memory.  It
decompresses
the whole image into memory to access it, but in my experience it
actually
uses on the order of 10x the memory required to hold the *uncompressed*
image during the decoding process.

I would guess your image is non-trivial in size, and that the driver is
running out of memory during decoding.

I would discourage use of the JasPer based driver except for "consumer
sized
images" (ie. from your digital camera) - the task for which the library
was intended.

I would suggest building with the ECW SDK instead for reasonably
efficient
jpeg2000 support that will scale up to very large image sizes.

Best regards,

Frank


From warmerdam at pobox.com  Fri Nov 17 18:02:03 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdalinfo on JP2 uses 100% of RAM, then crashes
In-Reply-To: <0E5A77B55A57D511BB3F0002A537C26208C55C41@s5-dar-r1.nrn.nrcan.gc.ca>
References: <0E5A77B55A57D511BB3F0002A537C26208C55C41@s5-dar-r1.nrn.nrcan.gc.ca>
Message-ID: <455E3F6B.3060601@pobox.com>

Patton, Eric wrote:
> Thanks, Frank. I have just installed the ER Mapper ECW SDK; what is that
> proper configure line to include it?
> 
> Something like
> 
> --with-ecw (?) --with-ecw-includes=(?)

Eric,

If you do a default install into /usr/local then just using --with-ecw
should be sufficient.

> Will gdal pick the 'best' driver for importing JP2 files, or do I have to
> uninstall the jasper libraries then recompile so it only uses the ecw
> driver?

I believe the JP2ECW driver is registered before the JPEG2000 driver and
so should be used in preference.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 17 18:14:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
Message-ID: <455E4241.4040600@pobox.com>

Matt Hanson wrote:
> Hi,
> 
> I'm reading in a GDAL dataset, doing some processing, and outputting it to
> another file.  The output file is created using the Create() function, but I
> want to make sure I copy over all the metadata from the source.
> 
> What do I need to do to ensure I've copied over all metadata and geographic
> info?    Is GetMetaData(), GetProjectionRef(), and GetGeoTransform() all I
> need, followed by subsequent calls to SetMetaData(), SetProjectionRef(), and
> SetGeoTransform() ?

Matt,

That will mostly do the trick, with the caveat that bands can also have
metadata, so it should also be done for them.

Note that most formats do not actually support writing metadata.  GeoTIFF
and VRT being the two exceptions that come to mind.  If you want a general
mechanism to preserve metadata, coordinate systems and other auxilary
information for formats that don't normally support it, you can use
"persistent auxilary metadata" files.  Set the configuration option
GDAL_PAM_ENABLED to YES (via environment, or CPLSetConfigOption()) and
you will find that GDAL starts writing out .aux.xml files to store
info like metadata that can't be stored in the target files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 17 18:10:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D702785F9@pj-exchange.photon.com>
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
	<0719BE42F22E0A46857DF72644EC5D702785F9@pj-exchange.photon.com>
Message-ID: <455E414E.2070908@pobox.com>

Matt Hanson wrote:
>> Following up on Ari's suggestion, I'd like to plan on a new GDAL release 
>> by mid December, perhaps with a first official beta December 1st.
>> 
>> What work are people hoping to get into a next GDAL release?
>> 
> 
> I would like to see Statistics for RasterBand's include the row/col location
> for the min and max of the band, requiring 4 more parameters to
> GDALRasterBand::GetStatistics().   The information would already be
> available from scanning the image, just a matter of storing it.

Matt,

That seems like a very specific need, and not one I have seen reflected
in the statistics reporting of any package in the past.  I doubt that this
will be incorporated into the existing statistics api.

Of course, developers can always write their own image scanning function
to figure this sort of thing out.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Fri Nov 17 14:25:31 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Release 1.4.0
References: <4558A652.2080404@pobox.com> <0d2501c70800$5cc0a620$0a01a8c0@pili>
	<0719BE42F22E0A46857DF72644EC5D702785F9@pj-exchange.photon.com>
	<455E414E.2070908@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D702785FB@pj-exchange.photon.com>

Ok, fair enough - I'll put together my own scanning routine to do this.

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Fri 11/17/2006 6:10 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Release 1.4.0



Matt Hanson wrote:
>> Following up on Ari's suggestion, I'd like to plan on a new GDAL release
>> by mid December, perhaps with a first official beta December 1st.
>>
>> What work are people hoping to get into a next GDAL release?
>>
>
> I would like to see Statistics for RasterBand's include the row/col location
> for the min and max of the band, requiring 4 more parameters to
> GDALRasterBand::GetStatistics().   The information would already be
> available from scanning the image, just a matter of storing it.

Matt,

That seems like a very specific need, and not one I have seen reflected
in the statistics reporting of any package in the past.  I doubt that this
will be incorporated into the existing statistics api.

Of course, developers can always write their own image scanning function
to figure this sort of thing out.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From mhanson at photon.com  Fri Nov 17 14:27:12 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
References: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
	<455E4241.4040600@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D702785FC@pj-exchange.photon.com>

Ok, good to know.  I'm currently using ENVI as an output file now, but one of my colleagues had written a driver for our own format I haven't tested yet.  Hopefully it supports writing metadata.
 
So if I set GDAL_PAM_ENABLED then when I call SetMetaData, SetGeoTransform, or SetProjectionRef, then it will automatically just output it to an aux.xml file?   If I have GDAL_PAM_ENABLED set to no then will it generate an error?
 
matt

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Fri 11/17/2006 6:14 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Copying meta data



Matt Hanson wrote:
> Hi,
>
> I'm reading in a GDAL dataset, doing some processing, and outputting it to
> another file.  The output file is created using the Create() function, but I
> want to make sure I copy over all the metadata from the source.
>
> What do I need to do to ensure I've copied over all metadata and geographic
> info?    Is GetMetaData(), GetProjectionRef(), and GetGeoTransform() all I
> need, followed by subsequent calls to SetMetaData(), SetProjectionRef(), and
> SetGeoTransform() ?

Matt,

That will mostly do the trick, with the caveat that bands can also have
metadata, so it should also be done for them.

Note that most formats do not actually support writing metadata.  GeoTIFF
and VRT being the two exceptions that come to mind.  If you want a general
mechanism to preserve metadata, coordinate systems and other auxilary
information for formats that don't normally support it, you can use
"persistent auxilary metadata" files.  Set the configuration option
GDAL_PAM_ENABLED to YES (via environment, or CPLSetConfigOption()) and
you will find that GDAL starts writing out .aux.xml files to store
info like metadata that can't be stored in the target files.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From mhanson at photon.com  Fri Nov 17 14:46:28 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
References: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
	<455E4241.4040600@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D702785FC@pj-exchange.photon.com>
	<455E4BC4.6010105@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D702785FE@pj-exchange.photon.com>

Are GDALDataset and GDALPamDataset fairly interchangeable?  Would it be as simple as changing the base classes to turn on support for PAM ?

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Fri 11/17/2006 6:54 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Copying meta data



Matt Hanson wrote:
> Ok, good to know.  I'm currently using ENVI as an output file now, but one
> of my colleagues had written a driver for our own format I haven't tested
> yet.  Hopefully it supports writing metadata.
>
> So if I set GDAL_PAM_ENABLED then when I call SetMetaData, SetGeoTransform,
> or SetProjectionRef, then it will automatically just output it to an aux.xml
> file?   If I have GDAL_PAM_ENABLED set to no then will it generate an error?

Matt,

Well, whether an error will actually be generated or not, I'm not so sure.
Generally SetMetadata() never fails because the default implementation is
to dump the metadata into the base class datastructure for metadata, but the
metadata will not get written to disk.

I would also note that the GDAL_PAM_ENABLED flag only affects drivers that
have been updated to support the PAM mechanism.  This includes most core
drivers but if you have written your own format driver, and it does not
derive the classes from GDALPamDataset and GDALPamRasterBand then the PAM
mechanism will likely *not* work for your driver.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From warmerdam at pobox.com  Fri Nov 17 18:54:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D702785FC@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
	<455E4241.4040600@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D702785FC@pj-exchange.photon.com>
Message-ID: <455E4BC4.6010105@pobox.com>

Matt Hanson wrote:
> Ok, good to know.  I'm currently using ENVI as an output file now, but one
> of my colleagues had written a driver for our own format I haven't tested
> yet.  Hopefully it supports writing metadata.
> 
> So if I set GDAL_PAM_ENABLED then when I call SetMetaData, SetGeoTransform,
> or SetProjectionRef, then it will automatically just output it to an aux.xml
> file?   If I have GDAL_PAM_ENABLED set to no then will it generate an error?

Matt,

Well, whether an error will actually be generated or not, I'm not so sure.
Generally SetMetadata() never fails because the default implementation is
to dump the metadata into the base class datastructure for metadata, but the
metadata will not get written to disk.

I would also note that the GDAL_PAM_ENABLED flag only affects drivers that
have been updated to support the PAM mechanism.  This includes most core
drivers but if you have written your own format driver, and it does not
derive the classes from GDALPamDataset and GDALPamRasterBand then the PAM
mechanism will likely *not* work for your driver.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 17 19:23:10 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D702785FE@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D702785F8@pj-exchange.photon.com>
	<455E4241.4040600@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D702785FC@pj-exchange.photon.com>
	<455E4BC4.6010105@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D702785FE@pj-exchange.photon.com>
Message-ID: <455E526E.1090307@pobox.com>

Matt Hanson wrote:
> Are GDALDataset and GDALPamDataset fairly interchangeable?  Would it be as
> simple as changing the base classes to turn on support for PAM ?

Matt,

GDALDataset is a base class for GDALPamDataset.  You will need to include
gdal_pam.h (where gdal_priv.h was normally included).  But yes, it should
generally be sufficient to change which case you use as a base class for
your format specific dataset and band classes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ILucena at clarku.edu  Fri Nov 17 15:53:58 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
Message-ID: <6FD7C9DB26540B42A1207C69BF92D455022557E9@Iris.ad.clarku.edu>

Frank,

Sorry for my ignorance in this matter, but where can I found the full
description (documentation) for the "aux.xml"?

Thanks in advance.

Ivan

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Friday, November 17, 2006 6:55 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Copying meta data

Matt Hanson wrote:
> Ok, good to know.  I'm currently using ENVI as an output file now, but
one
> of my colleagues had written a driver for our own format I haven't
tested
> yet.  Hopefully it supports writing metadata.
> 
> So if I set GDAL_PAM_ENABLED then when I call SetMetaData,
SetGeoTransform,
> or SetProjectionRef, then it will automatically just output it to an
aux.xml
> file?   If I have GDAL_PAM_ENABLED set to no then will it generate an
error?

Matt,

Well, whether an error will actually be generated or not, I'm not so
sure.
Generally SetMetadata() never fails because the default implementation
is
to dump the metadata into the base class datastructure for metadata, but
the
metadata will not get written to disk.

I would also note that the GDAL_PAM_ENABLED flag only affects drivers
that
have been updated to support the PAM mechanism.  This includes most core
drivers but if you have written your own format driver, and it does not
derive the classes from GDALPamDataset and GDALPamRasterBand then the
PAM
mechanism will likely *not* work for your driver.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From sy at perkins.net  Fri Nov 17 17:05:09 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: your GDAL in C#
In-Reply-To: <e798b640f6ef.455dd059@wiscmail.wisc.edu>
References: <e798b640f6ef.455dd059@wiscmail.wisc.edu>
Message-ID: <455E3215.2080604@perkins.net>

It's been a while since I looked at that code - the standard thing to do 
now is to migrate to using the SWIG generated C# bindings, though those 
are far from complete.

OK, just looked at the code. GDALGetMetadaExt() is the declaration of 
the external (to C#) native GDAL function GDALGetMetadata(), that uses 
raw strings and pointers and so forth. However, to make the function 
easier from C#, the C# GDALGetMetadata() function has an API that uses a 
Dictionary object. The C# GDALGetMetadata() method simply calls 
GDALGetMetadataExt() to do the work, which in turn calls the underlying 
GDAL function.

If you're getting zeros, I would check that you can use GDAL withe the 
C++ API first. Note that most file formats don't support metadata and 
will silently return null pointers. The "domain" flag should generally 
be null - it allows different metadata namespaces to be set up but I 
don't think any formats support that.

BTW, the gdal-dev list is the place to ask questions like this. I've 
copied the list with my answer, for the record.

Cheers,

Sy

MIKAH JAMES TRENT wrote:
> Hi Simon,
> I am working with the UW-Madison ecology labs as a student programmer.  I am trying to use your C# code that you posted on 
>
> http://article.gmane.org/gmane.comp.gis.gdal.devel/6177
>
> to see if we can use or extend your C# wrapper to incorporate GDAL into our own projects (see http://www.landis.forest.wisc.edu).
>
> Could you help me understand what the function "GDALGetMetadataExt" does, or maybe just point me to where it is defined??  The following line of code (from InterOp.cs, in your function GDALGetMetaData):
>
> void** stringList = (void**) GDALGetMetadataExt(hDataset, domain);
>
> always returns 0 for me, even when I am certain the dataset is not empty.  You also have 'domain' set to "null" (in Dataset.cs) when you call GDALGetMetaData.  Could this have something to do with it??
>
> I'm a little new to the whole system, so any help you could provide, even if it's just pointing me somewhere, would be great.  Thanks a bunch,
> -Mikah
>   

From dfriberg23 at gmail.com  Fri Nov 17 19:46:56 2006
From: dfriberg23 at gmail.com (David Friberg)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL nix build configuration
Message-ID: <481948e30611171646r697b64aaj5674c734d0a3e03c@mail.gmail.com>

I would like to request a change to the rpath (hard-coded library
search path) used in the shared libraries produced by the GDAL build
system.  The rpath currently used is problematic for us because it
contains the major version number, but not the revision number or age
(e.g. /usr/local/lib/libgdal.1.dylib).  This search path is also
propagated to every executable and shared library that links to GDAL.
An incompatible version of GDAL may exist in /usr/local/lib, so the
dynamic linker will use that if present.  Since we do not want to
install GDAL to /usr/local/lib, overwriting what's there, our
executables fail to work due to the incompatible libgdal.

There are two solutions I can think of for this issue:

1) change the rpath to include the full version string.

This was my solution to the problem; I hack the libtool that came with
GDAL as follows:

soname_spec="\${libname}\${release}\${major}\$shared_ext"

Change both lines that look like this to:

soname_spec="\${libname}\${release}\${versuffix}\$shared_ext"

That forces the issue of having the full version number in the rpath.
If it doesn't find the specified library, the dynamic linker will
continue to the next search path until it finds the correct version.

2) don't use an rpath

I haven't figured out how to do this.  Probably could hack libtool.

Or maybe there's a much better way to do these things?

David Friberg
MicroImages, Inc.

From quickstuff at altern.org  Fri Nov 17 21:21:14 2006
From: quickstuff at altern.org (Quentin S.)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <4558A652.2080404@pobox.com>
References: <4558A652.2080404@pobox.com>
Message-ID: <1764.89.80.63.73.1163816474.squirrel@altern.org>

Frank Warmerdam wrote:
> I would like to do a substantial review of outstanding bug reports, but to
> be honest I can't imagine "clearing the plate" in any meaningful way.  At
> best, picking off a few of the easier problems and fixing them.

Hi everybody,

Would some 'feature requests' be adressed too in such a new version ?
(#1174 for instance)
Agreed on all other points.

Keep up the good work,
Quentin S.




From warmerdam at pobox.com  Sat Nov 18 03:07:39 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Release 1.4.0
In-Reply-To: <1764.89.80.63.73.1163816474.squirrel@altern.org>
References: <4558A652.2080404@pobox.com>
	<1764.89.80.63.73.1163816474.squirrel@altern.org>
Message-ID: <455EBF4B.9060600@pobox.com>

Quentin S. wrote:
> Frank Warmerdam wrote:
>> I would like to do a substantial review of outstanding bug reports, but to
>> be honest I can't imagine "clearing the plate" in any meaningful way.  At
>> best, picking off a few of the easier problems and fixing them.
> 
> Hi everybody,
> 
> Would some 'feature requests' be adressed too in such a new version ?
> (#1174 for instance)
> Agreed on all other points.

Quentin,

I see 1174 is requesting a deflate compression level parameter
for TIFF.  Providing the description or url to the bug would make
life somewhat easier for folks reading!

   http://bugzilla.remotesensing.org/show_bug.cgi?id=1174

My original question was more to GDAL developers, asking what they were
working on and hoping to have completed.  Not so much a request for more
work for myself. :-)

So, I'm not adverse to a fix for 1174 if you wanted to propose a patch.
It isn't too high on my priority list though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From woklist at kyngchaos.com  Fri Nov 17 21:05:34 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL nix build configuration
In-Reply-To: <481948e30611171646r697b64aaj5674c734d0a3e03c@mail.gmail.com>
References: <481948e30611171646r697b64aaj5674c734d0a3e03c@mail.gmail.com>
Message-ID: <429131D6-4D73-461C-90D4-81F3F8B57524@kyngchaos.com>

On OSX (I assume because of the dylib), it's simple to do without any  
patching of the GDAL make setup.  Let it build how it wants to and  
install it.  Then postprocess the library with install_name_tool.   
Assuming the default /usr/local install (and assuming that the  
compatibility problem is really that bad - Frank might know better on  
that score), that would be:

install_name_tool -id /usr/local/lib/libgdal.1.X.Y.dylib /usr/local/ 
lib/libgdal.1.X.Y.dylib

where X and Y are the minor and revision numbers matching what was  
installed.

You can change existing programs to match the new name with  
install_name_tool.  Like the GDAL tools, since they're built with the  
simpler version names.  Use otool first to verify the names:

otool -L /path/to/program

use the libgdal name there in install_name_tool:

install_name_tool -change /existing/libgdal/name /usr/local/lib/ 
libgdal.1.X.Y.dylib /path/to/program


On Nov 17, 2006, at 6:46 PM, David Friberg wrote:

> I would like to request a change to the rpath (hard-coded library
> search path) used in the shared libraries produced by the GDAL build
> system.  The rpath currently used is problematic for us because it
> contains the major version number, but not the revision number or age
> (e.g. /usr/local/lib/libgdal.1.dylib).  This search path is also
> propagated to every executable and shared library that links to GDAL.
> An incompatible version of GDAL may exist in /usr/local/lib, so the
> dynamic linker will use that if present.  Since we do not want to
> install GDAL to /usr/local/lib, overwriting what's there, our
> executables fail to work due to the incompatible libgdal.
>

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

[Trillian]  What are you supposed to do WITH a maniacally depressed  
robot?

[Marvin]  You think you have problems?  What are you supposed to do  
if you ARE a maniacally depressed robot?  No, don't try and answer,  
I'm 50,000 times more intelligent than you and even I don't know the  
answer...

- HitchHiker's Guide to the Galaxy



From ari.jolma at tkk.fi  Sat Nov 18 06:01:17 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Perl interface now in Geo:: namespace by default
Message-ID: <455EE7FD.9000709@tkk.fi>

I've commited changes which put the Perl wrappers by default to the 
Geo:: namespace. It is still possible to build modules with the old 
names (gdal, gdalconst, ogr, and osr), but one needs to remove the 
symbol PERL_CPAN_NAMESPACE  from GNUMakefile, rebuild the wrappers, edit 
Makefile.PL, and probably do some other things.

I also added to the swig/perl directory some things to make it possible 
to "make dist" the CPAN module. Right now it makes Geo-GDAL-0.20.tar.gz, 
but it is not the same as in CPAN since the one in CPAN is built with 
GDAL 1.3.2.

I also fixed a bug in the bindings, which made SetField(field_name, 
value) silently fail even in a case where field with field_name did not 
exist. Now it calls CPLError, which can be propagated upstream.

Ari

-- 
Prof. Ari Jolma
Geoinformaatio- ja paikannustekniikka
Geoinformation and positioning technology
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From kkirubanantham at yahoo.com  Sat Nov 18 07:04:00 2006
From: kkirubanantham at yahoo.com (kiruba nantham)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Problem Building GDAL for Windows CE using EVC++ 4.0
Message-ID: <20061118120401.98652.qmail@web52209.mail.yahoo.com>

    Hello Friends,
                                               I am trying to build  gdal-cvs-2006.11.16 using embedded c++ 4.0 for Windows CE. I am able  to build the gdalce_evc4d.dll without any errors. But it is throwing  around 160 warnings and also it is not working in my device.
  
  Warnings  are:
  
  Warning  C4275: non  dll-interface class 'std::basic_string<char,struct  std::char_traits<char>, class std::allocator<char> >' used as  base for dll-interface class 'CPLString'
                               -This Warning at cpl_string.h( Line - 211)
  Warning  C4530: C++  exception handler used, but unwind semantics are not enabled.     Specify ?GX
                               -This Warning at xstring( Line - 724)
  
                and  also Only in these two Warnings are repeating.
  
                                  Linker  Warnings Are:
        mitab_feature.obj  : warning LNK1166: cannot adjust code at  
                      offset=0x00001000, rva=0x0001C7DC.
        mitab_feature_mif.obj  : warning LNK1166: cannot adjust code at 
                      offset=0x00001000, rva=0x000326C0.
        ogr_srs_proj4.obj  : warning LNK1166: cannot adjust code at  
                     offset=0x00001000, rva=0x000947D0.
        ogrspatialreference.obj  : warning LNK1166: cannot adjust code at 
                      offset=0x00001000, rva=0x000C5794.
        If I run  this form command prompt it is not building the DLL and its Shows this error.
  Error is:
         fatal error LNK1112: module machine type  ?X86? conflicts with target 
                                        machine type ?ARM?*.
         Please Help me to Solve this.
      Thank  you.
  Kirubanantham.K
  
 
---------------------------------
Check out the all-new Yahoo! Mail beta - Fire up a more powerful email and get things done faster.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061118/c44b0b5a/attachment.html
From warmerdam at pobox.com  Sat Nov 18 21:07:34 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D455022557E9@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D455022557E9@Iris.ad.clarku.edu>
Message-ID: <455FBC66.4070209@pobox.com>

Ivan Lucena wrote:
> Frank,
> 
> Sorry for my ignorance in this matter, but where can I found the full
> description (documentation) for the "aux.xml"?

Ivan,

I'm embarrassed to admit there is no documentation for the PAM mechanism
to speak of.  The PAM mechanism was implemented before there was a PSC
to keep me honest.

I'll, um, put documenting this on my list of things to do.  If you have
specific questions feel free to ask.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ILucena at clarku.edu  Sat Nov 18 11:49:29 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Copying meta data
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45502255817@Iris.ad.clarku.edu>

Don't worry about it Frank and sorry for my grammar too (found!). I just
need to make one of the GDAL drivers to give me a sample file with all
the possible tags and I will figure out the rest.

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Saturday, November 18, 2006 9:08 PM
To: Ivan Lucena
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Copying meta data

Ivan Lucena wrote:
> Frank,
> 
> Sorry for my ignorance in this matter, but where can I found the full
> description (documentation) for the "aux.xml"?

Ivan,

I'm embarrassed to admit there is no documentation for the PAM mechanism
to speak of.  The PAM mechanism was implemented before there was a PSC
to keep me honest.

I'll, um, put documenting this on my list of things to do.  If you have
specific questions feel free to ask.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org



From szekerest at gmail.com  Sat Nov 18 15:32:51 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: your GDAL in C#
In-Reply-To: <455E3215.2080604@perkins.net>
References: <e798b640f6ef.455dd059@wiscmail.wisc.edu>
	<455E3215.2080604@perkins.net>
Message-ID: <f3b73b7d0611181232u3a437991g93c35d727ca51789@mail.gmail.com>

It would be considerable to use the GDAL SWIG C# interface since it
seems to be easier to support along with the evolution of the GDAL
core. We are planning to expose most of the required functionality for
the next release.

However if you decide to use this interface feel free to share your
experiences and help us to discover the missing but required
functionalities and the possible problems. So as to collect these
problems we have also created a bugzilla component dedicated
exclusively to the C# interface.


Best Regards,


Tamas Szekeres



2006/11/17, Simon Perkins <sy@perkins.net>:
> It's been a while since I looked at that code - the standard thing to do
> now is to migrate to using the SWIG generated C# bindings, though those
> are far from complete.
>
> OK, just looked at the code. GDALGetMetadaExt() is the declaration of
> the external (to C#) native GDAL function GDALGetMetadata(), that uses
> raw strings and pointers and so forth. However, to make the function
> easier from C#, the C# GDALGetMetadata() function has an API that uses a
> Dictionary object. The C# GDALGetMetadata() method simply calls
> GDALGetMetadataExt() to do the work, which in turn calls the underlying
> GDAL function.
>
> If you're getting zeros, I would check that you can use GDAL withe the
> C++ API first. Note that most file formats don't support metadata and
> will silently return null pointers. The "domain" flag should generally
> be null - it allows different metadata namespaces to be set up but I
> don't think any formats support that.
>
> BTW, the gdal-dev list is the place to ask questions like this. I've
> copied the list with my answer, for the record.
>
> Cheers,
>
> Sy
>
> MIKAH JAMES TRENT wrote:
> > Hi Simon,
> > I am working with the UW-Madison ecology labs as a student programmer.  I am trying to use your C# code that you posted on
> >
> > http://article.gmane.org/gmane.comp.gis.gdal.devel/6177
> >
> > to see if we can use or extend your C# wrapper to incorporate GDAL into our own projects (see http://www.landis.forest.wisc.edu).
> >
> > Could you help me understand what the function "GDALGetMetadataExt" does, or maybe just point me to where it is defined??  The following line of code (from InterOp.cs, in your function GDALGetMetaData):
> >
> > void** stringList = (void**) GDALGetMetadataExt(hDataset, domain);
> >
> > always returns 0 for me, even when I am certain the dataset is not empty.  You also have 'domain' set to "null" (in Dataset.cs) when you call GDALGetMetaData.  Could this have something to do with it??
> >
> > I'm a little new to the whole system, so any help you could provide, even if it's just pointing me somewhere, would be great.  Thanks a bunch,
> > -Mikah
> >
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From stephan.holl at intevation.de  Sun Nov 19 08:10:30 2006
From: stephan.holl at intevation.de (Stephan Holl)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] OGR: VRT
In-Reply-To: <455B65E2.8060804@pobox.com>
References: <200611151704.04125.stephan.holl@intevation.de>
	<455B65E2.8060804@pobox.com>
Message-ID: <20061119141030.61ef6b97@localhost>

Hello Frank, 

On Wed, 15 Nov 2006 14:09:22 -0500 Frank Warmerdam
<warmerdam@pobox.com> wrote:

> Stephan Holl wrote:
> >   n2n_wert (Real) = 95.59999999999999   <--- strange, should be
> > 95.600 n2n_idflm (Integer) = 1207
> >   n2n_wertdat (String) = 2004-12-31
> >   n2n_idflaeche (String) = 04000000
> >   frmt_wert (String) = 95,600
> >   format_wert (String) = 95,600
> > 
> > Is this a known problem?
> > 
> > I am on Debian with gdal-1.2.6
> 
> Stephan,
> 
> I'd suggest trying again with the latest version (ie. a nightly cvs
> snapshot) and see if the problem persists.  

I have done this (with gdal-CVS from 17.11.2006). There are several
results which I try to summarize now:
The described problem above is away now, but another problem appears
which I stumbled over in gdal 1.3.2 as well. Therefor I decided to use
gdal 1.2.6 which works as expected in my app.

When using the latest CVS with my join example I received this error:
ogrinfo -al join_together.ovf
ERROR 4: Update access not supported for VRT datasources.
Had to open data source read-only.
INFO: Open of `join_together.ovf'
      using driver `VRT' successful.

Layer name: join
Geometry: Polygon
Feature Count: 16
ERROR 1: Not enough tokens to complete expression.
Segmentation fault

This was know to work with 1.2.6 except the rounding problem.

> There have been a lot of
> changes and improvements since 1.2.6.  If the problem persists you can
> file a bug report, hopefully with an sql script we can execute in
> mysql to initialize an example table showing the problem.

I have bundled up a minimal example with a Mysql-Dump (containig one
table with 3 rows) and an unfree sampledataset where you can reproduce
the problem.
I have sent you the dataset via PM.

Best regards

	Stephan

-- 
Stephan Holl   : www.intevation.de/~stephan | GISpatcher:
www.gispatcher.de Intevation GmbH: www.intevation.de          | GAV
e.V.: www.grass-verein.de Georgstr.4     : 49074 Osnabr?ck            | 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061119/c7884394/signature.bin
From mateusz at loskot.net  Sun Nov 19 12:07:10 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: Problem : Building GDAL for windows CE
In-Reply-To: <881569.96801.qm@web52201.mail.yahoo.com>
References: <881569.96801.qm@web52201.mail.yahoo.com>
Message-ID: <45608F3E.5020001@loskot.net>

kiruba nantham wrote:
> Hello Mr. Mateusz, I hope you are busy but you helped me a lot Thank 
> you very much. Even I built gdal-cvs-2006.11.16. without out any 
> error  but I am getting around 160 warnings saying what I said in 
> last mail and also Only in these two file and at these two lines 
> (cpl_string.h(211), xstring(724) ) after same warnings are repeating.

Have you installed STLport?
I recommend it in README file, point 5, because STLport is much better
and complete implementation of STL than the one shipped with eVC++.

>From README:
5. I also recommend to use STLport
Here is some introduction:
http://mateusz.loskot.net/2005/12/25/how-to-use-stlport-with-evc/
it refers to my article on http://www.pocketpcdn.com

With eVC++, I *never* use Microsoft's STL, because it's a real crap
and I always use STLport. The sitaution is better with Visual C++ 8.0,
where STL (and C++ Standard Library) is in much better shape.

> But this dll is not working on my device. Ok let me ask our *gdal 
> group*, whether any of them built gdal using EVC++ 4.0.

BTW, eVC++ is very old compiler, it's from 1998, so I strongly
recommend to move to Visual C++ 8.0.

I'm also going to move completely to Visual C++ 8.0, so I'm inclined to
say I won't be able to maintain eVC++ projects, unless I have some free
Windows box where I can install eVC++ (I'm nervous about mesing my
Windows workstation with eVC++, because I prefer to keep its environment
clean.).


Recently, I've been working on Unit Test Suite for Windows CE,
so in more than a week it should be published.
Currently, I compile GDAL DLL and Unit Tests with VC++ 8.0 and run on
Windows CE 5.0 system with success, but Command Prompt is required (at
least ATM).

Finally, at the beginning of December, when new GDAL release will be
out, you may expect improved GDAL port for Windows CE.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ari.jolma at tkk.fi  Sun Nov 19 13:50:10 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:29 2007
Subject: More GetFieldIndex cases in ogr.i (was Re: [Gdal-dev] Perl interface
	now in Geo:: namespace by default)
In-Reply-To: <455EE7FD.9000709@tkk.fi>
References: <455EE7FD.9000709@tkk.fi>
Message-ID: <4560A762.7050908@tkk.fi>

I wrote:
> I also fixed a bug in the bindings, which made SetField(field_name, 
> value) silently fail even in a case where field with field_name did 
> not exist. Now it calls CPLError, which can be propagated upstream.
Seems that there were many more of these. I added to all of them checks 
and CPLError calls in case of not passing the check for non-nullness of 
the field name and for the validity of the field name.

This prevents countless seg faults and silent failures at least in Perl. 
Seg faults, because it is easy to feed an undef by accident to Perl 
subs, and swig translates these to NULL char pointers, which are poison 
to OGR's GetFieldIndex.

I also renamed GetFieldAsString to GetField in Perl bindings since it 
makes no sense to have typed methods in a typeless language.

Ari


From warmerdam at pobox.com  Mon Nov 20 02:05:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] OGR: VRT
In-Reply-To: <20061119141030.61ef6b97@localhost>
References: <200611151704.04125.stephan.holl@intevation.de>	<455B65E2.8060804@pobox.com>
	<20061119141030.61ef6b97@localhost>
Message-ID: <456153C8.1080007@pobox.com>

Stephan Holl wrote:
> I have done this (with gdal-CVS from 17.11.2006). There are several
> results which I try to summarize now:
> The described problem above is away now, but another problem appears
> which I stumbled over in gdal 1.3.2 as well. Therefor I decided to use
> gdal 1.2.6 which works as expected in my app.
> 
> When using the latest CVS with my join example I received this error:
> ogrinfo -al join_together.ovf
> ERROR 4: Update access not supported for VRT datasources.
> Had to open data source read-only.
> INFO: Open of `join_together.ovf'
>       using driver `VRT' successful.
> 
> Layer name: join
> Geometry: Polygon
> Feature Count: 16
> ERROR 1: Not enough tokens to complete expression.
> Segmentation fault
> 
> This was know to work with 1.2.6 except the rounding problem.

Stephan,

I have confirmed and fixed a serious double free in
OGRVRTLayer::SetAttributeFilter().   It only bites in
cases where one non-NULL attribute filter is being applied
in place of another - so relatively rare.

I found I had to change the 'bld' to 'sta' in the following
part of join_together.ovf, but I assume that was a typo on your
part.

       <SrcSQL>select  n2n_wert, n2n_idflm, n2n_wertdat, frmt_wert, format_wert
         from bld join 'join.ovf'.values
         on AGS = n2n_idflaeche
                 where AGS like '%'
       </SrcSQL>

If you can give tomorrows cvs snapshot a run sometime and verify the
fix I'd appreciate it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From stephan.holl at intevation.de  Mon Nov 20 03:03:13 2006
From: stephan.holl at intevation.de (Stephan Holl)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] OGR: VRT
In-Reply-To: <456153C8.1080007@pobox.com>
References: <200611151704.04125.stephan.holl@intevation.de>
	<20061119141030.61ef6b97@localhost> <456153C8.1080007@pobox.com>
Message-ID: <200611200903.13595.stephan.holl@intevation.de>

Hello Frank,

Am Montag, 20. November 2006 08:05 schrieb Frank Warmerdam:
> Stephan Holl wrote:
> > I have done this (with gdal-CVS from 17.11.2006). There are several
> > results which I try to summarize now:
> > The described problem above is away now, but another problem appears
> > which I stumbled over in gdal 1.3.2 as well. Therefor I decided to use
> > gdal 1.2.6 which works as expected in my app.
> >
> > When using the latest CVS with my join example I received this error:
> > ogrinfo -al join_together.ovf
> > ERROR 4: Update access not supported for VRT datasources.
> > Had to open data source read-only.
> > INFO: Open of `join_together.ovf'
> >       using driver `VRT' successful.
> >
> > Layer name: join
> > Geometry: Polygon
> > Feature Count: 16
> > ERROR 1: Not enough tokens to complete expression.
> > Segmentation fault
> >
> > This was know to work with 1.2.6 except the rounding problem.
>
> Stephan,
>
> I have confirmed and fixed a serious double free in
> OGRVRTLayer::SetAttributeFilter().   It only bites in
> cases where one non-NULL attribute filter is being applied
> in place of another - so relatively rare.

I have patched ogr/ogrsf_frmts/vrt/ogrvrtlayer.cpp with your changes and 
recompiled, the result is fine!

> I found I had to change the 'bld' to 'sta' in the following
> part of join_together.ovf, but I assume that was a typo on your
> part.

Yes, thank you, typo.

>
>        <SrcSQL>select  n2n_wert, n2n_idflm, n2n_wertdat, frmt_wert,
> format_wert from bld join 'join.ovf'.values
>          on AGS = n2n_idflaeche
>                  where AGS like '%'
>        </SrcSQL>
>
> If you can give tomorrows cvs snapshot a run sometime and verify the
> fix I'd appreciate it.

Working here again.

Best regards and thank you for the quick fix!!

	Stephan

-- 
Stephan Holl   : www.intevation.de/~stephan | GISpatcher: www.gispatcher.de
Intevation GmbH: www.intevation.de          | GAV e.V.: www.grass-verein.de
Georgstr.4     : 49074 Osnabr?ck            | 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061120/a0b94028/attachment.bin
From jmp at geosys.com  Mon Nov 20 03:59:07 2006
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] ColorTable in C#
Message-ID: <000b01c70c82$23469ae0$2201a8c0@pcjmp>

Hi,

 

How can I create a new ColorTable in C# for a new image.

 

Thank.

 

PIERRET Jean michel.

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061120/36cdbcbd/attachment.html
From support at geoimage.fr  Mon Nov 20 06:21:56 2006
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Bug in doc. for WCS Client Driver
References: <4523EB88.4040601@pobox.com>
Message-ID: <062101c70c96$16fbfff0$0a01a8c0@pili>

Hello,

I'am experimenting with the WCS driver and I have discovered a little inconsistency
in the driver doc :

The example in the doc about the WCS driver talks about a GDAL_WCS :
<GDAL_WCS>
  <ServiceURL>http://maps.gdal.org/cgi-bin/mapserv_dem?</ServiceURL>
  <CoverageName>srtmplus_raw</CoverageName>
</GDAL_WCS>

But the driver search for the xml tag WCS_GDAL...

Fr?d?ric.
_________________________________________________________________
Fr?d?ric Trastour - GEOIMAGE - dev@geoimage.fr


From mirhassanali at gmail.com  Mon Nov 20 07:26:43 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] MapScript C# wrapper
Message-ID: <b41d86b30611200426p600ece33w14fc57dc724c5b69@mail.gmail.com>

Hi

I want to read the MapInfo tab files and display a map using the MapScript
C# wrappers.

1. Is this possible?
2. Are there any sample applications that I can have a look at?

Thank and Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061120/abeedd1d/attachment.html
From support at geoimage.fr  Mon Nov 20 07:47:25 2006
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WCS Driver problem
Message-ID: <0ba301c70ca2$081b4a70$0a01a8c0@pili>

Hello,

I have noticed the following problem with the WCS driver :

Input file (test1.xml) :

<WCS_GDAL>
   <ServiceURL>http://laits.gmu.edu/cgi-bin/NWGISS/NWGISS?</ServiceURL>

<CoverageName>/export/home0/GeoData/AIRDAS-CA-Fire-2003NOV/CEDAR_LINE1SCFM_UTM_3B_2.hdf:Grid:GeoTIFFGrid:G</CoverageName
>
</WCS_GDAL>

 Command :

 gdalinfo test1.xml

 The generated request is :

 http://laits.gmu.edu/cgi-bin/NWGISS/NWGISS?SERVICE=WCS&VERSION=1.0.0
&REQUEST=GetCoverage&COVERAGE=/export/home0/GeoData/AIRDAS-CA-Fire-2003NOV/CEDAR_LINE1SCFM_UTM_3B_2.hdf:Grid:GeoTIFFGrid
:G
&FORMAT=GeoTIFF
&BBOX=505516,3.64845e+006,505528,3.64847e+006
&WIDTH=2&HEIGHT=2&CRS=EPSG:32611

It seems that the server fails to interpret the BBOX arguments when the 'scientific' notation is used.
If I replace the concerned values 3.64845e+006 and 3.64847e+006 with the corresponding plain
numbers, it works.

I don't know if the server should be able to interpret this notation...
Perhaps you should envisage to used %f instead of %g in the related printf statements.

Best regards,

Fr?d?ric.
 _________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From szekerest at gmail.com  Mon Nov 20 08:06:04 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] ColorTable in C#
In-Reply-To: <000b01c70c82$23469ae0$2201a8c0@pcjmp>
References: <000b01c70c82$23469ae0$2201a8c0@pcjmp>
Message-ID: <f3b73b7d0611200506n1f4828ds1a5dc546fe08f14e@mail.gmail.com>

Hi,

I've just added the ColorEntry struct for the SWIG C# interface. Now you can use

the ColorTable and ColorEntry classes along with
Band.SetRasterColorTable and Band.GetRasterColorTable.

Checkout the latest CVS and notify me how it works.


Best Regards,

Tamas Szekeres



2006/11/20, Jean Michel PIERRET <jmp@geosys.com>:
>
>
>
>
> Hi,
>
>
>
> How can I create a new ColorTable in C# for a new image.
>
>
>
> Thank.
>
>
>
> PIERRET Jean michel.
>
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From szekerest at gmail.com  Mon Nov 20 08:17:49 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] MapScript C# wrapper
In-Reply-To: <b41d86b30611200426p600ece33w14fc57dc724c5b69@mail.gmail.com>
References: <b41d86b30611200426p600ece33w14fc57dc724c5b69@mail.gmail.com>
Message-ID: <f3b73b7d0611200517h6301be4fy63689bb571f7341f@mail.gmail.com>

Hi,

You can use the OGR MapInfo driver to accomplish this task. Here is a
sample LAYER entry in the mapfile to use this functionality:

LAYER	
		PROJECTION
  			"AUTO"
		END
		NAME "park"
		METADATA
    		"wms_title"	 "park"
  		END
		CONNECTIONTYPE OGR
                CONNECTION "park.TAB"
		STYLEITEM "AUTO"
		STATUS default
		TYPE POLYGON
		CLASS
			TEMPLATE "query.html"
			NAME "park"
		END
	END

You can use new mapObj('mapfile.map") to create the map object and
mapObj.draw to draw the map image as usual.

Best Regards,

Tamas Szekeres



2006/11/20, Mir Hassan Ali <mirhassanali@gmail.com>:
> Hi
>
> I want to read the MapInfo tab files and display a map using the MapScript
> C# wrappers.
>
> 1. Is this possible?
> 2. Are there any sample applications that I can have a look at?
>
> Thank and Best Regards
>
> Mir Hassan Ali
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>

From warmerdam at pobox.com  Mon Nov 20 15:34:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Bug in doc. for WCS Client Driver
In-Reply-To: <062101c70c96$16fbfff0$0a01a8c0@pili>
References: <4523EB88.4040601@pobox.com> <062101c70c96$16fbfff0$0a01a8c0@pili>
Message-ID: <45621160.4000801@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> I'am experimenting with the WCS driver and I have discovered a little inconsistency
> in the driver doc :
> 
> The example in the doc about the WCS driver talks about a GDAL_WCS :
> <GDAL_WCS>
>   <ServiceURL>http://maps.gdal.org/cgi-bin/mapserv_dem?</ServiceURL>
>   <CoverageName>srtmplus_raw</CoverageName>
> </GDAL_WCS>
> 
> But the driver search for the xml tag WCS_GDAL...

Fr?d?ric,

I have fixed the documentation.

Thanks,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Mon Nov 20 11:25:30 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>

I apologize for bringing up an issue that I know has been covered/answered before, I just can't remember what the answer was!  (and there's no web-based search for the list archives).
 
How does GDAL decide which format to use to open a file?   In some cases there might be multiple methods: such as a raw binary file but also an ENVI header file.  Or in our case, we have an ENVI style aux file, but an ENVI header may also be present.    I suspect it runs through the list of formats and opens it with the first one that works.   Assuming this is so, how can I force opening a file with a specific format?  
 
In the case of ENVI files (and similar formats that use secondary files) it seems that it would make more sense to allow the user to open the hdr file rather then the binary file, because while the binary file format could be ambiguous, the hdr file would not be.
 
thanks, matt


From jluis at ualg.pt  Mon Nov 20 12:08:33 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
Message-ID: <4561E111.8070606@ualg.pt>

Matt Hanson wrote:
> I apologize for bringing up an issue that I know has been covered/answered before, I just can't remember what the answer was!  (and there's no web-based search for the list archives).
>   
Matt,
You can do web searches here.
http://www.nabble.com/GDAL---Dev-f1192.html

Joaquim Luis


From ILucena at clarku.edu  Mon Nov 20 12:41:04 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WMO raster format
Message-ID: <6FD7C9DB26540B42A1207C69BF92D4550225594D@Iris.ad.clarku.edu>

- Does anybody know how to import/export this raster format?
"GRIB is the World Meteorological Organization's (WMO) standard for
grid-based meteorological data."


From mbrudka at aster.pl  Mon Nov 20 13:10:52 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL reentrancy issue
In-Reply-To: <b41d86b30611160322y315d94a7u29177b3583c73163@mail.gmail.com>
References: <b41d86b30611160322y315d94a7u29177b3583c73163@mail.gmail.com>
Message-ID: <4561EFAC.9040100@aster.pl>

Hi Mir,
Mir Hassan Ali wrote:
> I am building a small web application in C# that uses a custom 
> assembly(dll) which in-turn uses the C# wrappers for gdal to read the 
> .shp files (only read not write).
>  
> My question is, since OGR/GDAL is not reentrant (this is what I assume 
> after reading the post 
> http://lists.maptools.org/pipermail/gdal-dev/2006-September/010160.html 
> <http://lists.maptools.org/pipermail/gdal-dev/2006-September/010160.html>), 
> is it going to cause any problems to the web application as obviously 
> multiple users will be using the applications at the same time.
It depends on the architecture of this web application. If the 
application is launched per HTTP connection (simple CGI) then it really 
doesn't matter if OGR is or is not thread safe. But if the application 
is a service with pool of threads or even with thread per connection 
model, then you should expect problems.

The simple patch is "one mutex to rule them all" (tm),  namely before 
each call to the custom assembly you mentioned above the mutex should be 
locked. However, if you need more concurrent and really faster solution 
you should be prepared to modify OGR..

HTH
Marek Brudka


From warmerdam at pobox.com  Mon Nov 20 20:29:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
Message-ID: <45625663.3090309@pobox.com>

Matt Hanson wrote:
> I apologize for bringing up an issue that I know has been covered/answered
> before, I just can't remember what the answer was!  (and there's no
> web-based search for the list archives).
> 
> How does GDAL decide which format to use to open a file?   In some cases
> there might be multiple methods: such as a raw binary file but also an ENVI
> header file.  Or in our case, we have an ENVI style aux file, but an ENVI
> header may also be present.    I suspect it runs through the list of formats
> and opens it with the first one that works.

Matt,

Drivers are tried in the order they are registered.

 > Assuming this is so, how can I
> force opening a file with a specific format?

Currently the only way is to unregister all drivers from the driver manager
except the one you want to use (or only register the desired driver on
startup).

> In the case of ENVI files (and similar formats that use secondary files) it
> seems that it would make more sense to allow the user to open the hdr file
> rather then the binary file, because while the binary file format could be
> ambiguous, the hdr file would not be.

Perhaps.   But changing something like this would cause a lot of disruption
to existing users.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Nov 20 20:32:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WCS Driver problem
In-Reply-To: <0ba301c70ca2$081b4a70$0a01a8c0@pili>
References: <0ba301c70ca2$081b4a70$0a01a8c0@pili>
Message-ID: <45625729.6080705@pobox.com>

Fr?d?ric Trastour wrote:
>  http://laits.gmu.edu/cgi-bin/NWGISS/NWGISS?SERVICE=WCS&VERSION=1.0.0
> &REQUEST=GetCoverage&COVERAGE=/export/home0/GeoData/AIRDAS-CA-Fire-2003NOV/CEDAR_LINE1SCFM_UTM_3B_2.hdf:Grid:GeoTIFFGrid
> :G
> &FORMAT=GeoTIFF
> &BBOX=505516,3.64845e+006,505528,3.64847e+006
> &WIDTH=2&HEIGHT=2&CRS=EPSG:32611
> 
> It seems that the server fails to interpret the BBOX arguments when the 'scientific' notation is used.
> If I replace the concerned values 3.64845e+006 and 3.64847e+006 with the corresponding plain
> numbers, it works.
> 
> I don't know if the server should be able to interpret this notation...
> Perhaps you should envisage to used %f instead of %g in the related printf statements.

Fr?d?ric,

I have updated the code to use %.15g which appears to give reasonable values
at different value sizes.  I don't like using something like %.15f because
it introduces many bogus digits of accurancy for coordinate systems with
large values like UTM.  But %.15g seems to mean 15 digits of accuracy rather
than 15 decimal places.

The GMU server is now working properly for me.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From fabrice.lallauret at thalesgroup.com  Mon Nov 20 11:51:08 2006
From: fabrice.lallauret at thalesgroup.com (LALLAURET Fabrice - <SSII>)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] saving Raster Attribute Table in HFA format
Message-ID: <4561DCFC.4010108@thalesgroup.com>

I need to save some attributes in a thematic img file like class name 
and histogram values. In gdal 1.3.2, only the colortable is saved in the 
img file.
I've made some modifications in the HFA format code in order to be able 
to save the RAT data and it seems to work (I've open my new files with 
success in ERDAS Imagine).
I can send my modifications but I think  it's too "hardcoded" to be 
incorporated "as is" and not philosophically correct with the other 
module format.

What can I do ?

Regards

-- 
     .--.    Fabrice LALLAURET - PSV Team
    |o_o |   Tel: (33) (01 34) 22 84 33
    |:_/ |   Thales Training & Simulation
   //   \ \  1, rue du General de Gaulle
  (|     | ) Z.I. les beaux soleils
 /'\_   _/`\ Osny. B.P. 226
 \___)=(___/ 95523 Cergy-Pontoise Cedex
 E-mail: fabrice.lallauret@thalesgroup.com
 "Power corrupts. PowerPoint corrupts absolutely."
 My personnal (french) Websites: http://www.xbee.net
 and http://www.french-comics-zone.fr.st



From mhanson at photon.com  Mon Nov 20 14:13:42 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
References: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
	<45625663.3090309@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027860B@pj-exchange.photon.com>

>> Matt Wrote:
>> In the case of ENVI files (and similar formats that use secondary files) it
>> seems that it would make more sense to allow the user to open the hdr file
>> rather then the binary file, because while the binary file format could be
>> ambiguous, the hdr file would not be.

> Frank Wrote:
> Perhaps.   But changing something like this would cause a lot of disruption
> to existing users.

What about adding the ability to pass in the hdr file OR the binary file name?   This wouldn't affect current users, but would add a little more control in those cases where files would work with multiple formats.

Of course, unregistering extra drivers will certainly work too which is what I'll use for now.




 


From warmerdam at pobox.com  Mon Nov 20 21:36:35 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WMO raster format
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D4550225594D@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D4550225594D@Iris.ad.clarku.edu>
Message-ID: <45626633.8070106@pobox.com>

Ivan Lucena wrote:
> - Does anybody know how to import/export this raster format?
> "GRIB is the World Meteorological Organization's (WMO) standard for
> grid-based meteorological data."

Ivan,

GRIB is not currently supported by GDAL though it is possible it will be
added in the not too distant future.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Mon Nov 20 14:40:17 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
References: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>
	<45625663.3090309@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027860D@pj-exchange.photon.com>

In thinking about this more, it would be really easy to specify a format if there was a way to register drivers using text string.   Is there a way to do this?   So, instead of having to call
Register_VRT  
you call
RegisterDriver("VRT")
Easy enough for me to write my own function to do this with all the drivers, but it may be useful enough for other users.
 
This way you can write an exe that takes in format as a string, and you only Register that format and read in that file.  Follow it up with a RegisterAll() if the program makes use of other formats.    A similar UnregisterDriver(string format) would be userful as well.

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Mon 11/20/2006 8:29 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] input format



Matt Hanson wrote:
> I apologize for bringing up an issue that I know has been covered/answered
> before, I just can't remember what the answer was!  (and there's no
> web-based search for the list archives).
>
> How does GDAL decide which format to use to open a file?   In some cases
> there might be multiple methods: such as a raw binary file but also an ENVI
> header file.  Or in our case, we have an ENVI style aux file, but an ENVI
> header may also be present.    I suspect it runs through the list of formats
> and opens it with the first one that works.

Matt,

Drivers are tried in the order they are registered.

 > Assuming this is so, how can I
> force opening a file with a specific format?

Currently the only way is to unregister all drivers from the driver manager
except the one you want to use (or only register the desired driver on
startup).

> In the case of ENVI files (and similar formats that use secondary files) it
> seems that it would make more sense to allow the user to open the hdr file
> rather then the binary file, because while the binary file format could be
> ambiguous, the hdr file would not be.

Perhaps.   But changing something like this would cause a lot of disruption
to existing users.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From warmerdam at pobox.com  Mon Nov 20 23:41:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] input format
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027860D@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D7027860A@pj-exchange.photon.com>	<45625663.3090309@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D7027860D@pj-exchange.photon.com>
Message-ID: <4562838C.8060400@pobox.com>

Matt Hanson wrote:
> In thinking about this more, it would be really easy to specify a format if
> there was a way to register drivers using text string.   Is there a way to
> do this?   So, instead of having to call Register_VRT you call 
> RegisterDriver("VRT") Easy enough for me to write my own function to do this
> with all the drivers, but it may be useful enough for other users.
> 
> This way you can write an exe that takes in format as a string, and you only
> Register that format and read in that file.  Follow it up with a
> RegisterAll() if the program makes use of other formats.    A similar
> UnregisterDriver(string format) would be userful as well.

Matt,

You cannot register drivers by name.  Till they are actually registered
there is no master list of drivers.

You can unregister them by name doing something like:

   GDALDeregisterDriver( GDALGetDriverByName( "VRT" ) );

You can call GDALRegisterAll(), then fetch the list of all drivers and
unregister them, keeping them in some sort of associative array indexed
by name if you want.  Note you can use GDALGetDriverShortName() to fetch
the name of a driver pulled back from GDALGetDriver().

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From Chris.Barker at noaa.gov  Mon Nov 20 16:28:51 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WMO raster format
In-Reply-To: <45626633.8070106@pobox.com>
References: <6FD7C9DB26540B42A1207C69BF92D4550225594D@Iris.ad.clarku.edu>
	<45626633.8070106@pobox.com>
Message-ID: <45621E13.3010202@noaa.gov>

> Ivan Lucena wrote:
>> - Does anybody know how to import/export this raster format?
>> "GRIB is the World Meteorological Organization's (WMO) standard for
>> grid-based meteorological data."

Maybe this will help:

http://www.nws.noaa.gov/mdl/NDFD_GRIB2Decoder/

-Chris



-- 
Christopher Barker, Ph.D.
Oceanographer

Emergency Response Division
NOAA/NOS/OR&R            (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From szekerest at gmail.com  Mon Nov 20 17:00:22 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL reentrancy issue
In-Reply-To: <4561EFAC.9040100@aster.pl>
References: <b41d86b30611160322y315d94a7u29177b3583c73163@mail.gmail.com>
	<4561EFAC.9040100@aster.pl>
Message-ID: <f3b73b7d0611201400v2fd87ca1v915a8a804090a961@mail.gmail.com>

Hi,

2006/11/20, Marek Brudka <mbrudka@aster.pl>:
> It depends on the architecture of this web application. If the
> application is launched per HTTP connection (simple CGI) then it really
> doesn't matter if OGR is or is not thread safe. But if the application
> is a service with pool of threads or even with thread per connection
> model, then you should expect problems.
>

Yes, the latter is the case with the ASP.NET applications. Every
request might be
handled by different thread from a pool of threads within the host process
(ti w3wp.exe or aspnet_wp.exe).

> The simple patch is "one mutex to rule them all" (tm),  namely before
> each call to the custom assembly you mentioned above the mutex should be
> locked. However, if you need more concurrent and really faster solution
> you should be prepared to modify OGR..
>

This kind of synchronization might be utilized at the SWIG interface
level only since
multiple application domains may exist within the same process.
There's not too much
chance to syncronize between application domains.

So in effect we could create a big lock to protect the global
variables from the multiple
simultaneous access by the different threads at the SWIG interface.
However this approach would highly degrade the performance of the application.

Alternatively you could create a set of multiple worker processes to
do the GDAL specific task in
the middleware and establish some kind of out of process communication
between the ASP.NET
application and worker processes.


Best Regards,

Tamas Szekeres

From simboss1 at gmail.com  Mon Nov 20 20:21:44 2006
From: simboss1 at gmail.com (Simone Giannecchini)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WMO raster format
In-Reply-To: <45621E13.3010202@noaa.gov>
References: <6FD7C9DB26540B42A1207C69BF92D4550225594D@Iris.ad.clarku.edu>
	<45626633.8070106@pobox.com> <45621E13.3010202@noaa.gov>
Message-ID: <961f4d9e0611201721t670fc142sc8ae11d404cc2390@mail.gmail.com>

To whom it may concern,
GeoTools (www.geotools.org) has an experimental plugin for
reading/writing GriB files edition 1 with pluggable support for
external oraganization table. This support is built around JGriB1
(http://code.google.com/p/jgrib1).

For more information feel free to contact me.

Regards,
Simone.

-------------------------------------------------------
Eng. Simone Giannecchini
President /CEO GeoSolutions

http://www.geo-solutions.it

-------------------------------------------------------

From ILucena at clarku.edu  Tue Nov 21 09:52:04 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] WMO raster format
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45502255A82@Iris.ad.clarku.edu>

Frank,
Christopher,
Simone.

It doesn't look like WMO is a very popular data format in order to make
someone spends time developing a GDAL driver. I may be wrong, and I just
need to help someone to convert a few files. So I will check "jbrib1"
and "gribdecoder" to see if they have a simple Win or Linux conversion
solution.

Thanks and grazie.

Ivan


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Simone
Giannecchini
Sent: Monday, November 20, 2006 8:22 PM
To: Christopher Barker
Cc: gdal-dev@lists.maptools.org; Ivan Lucena
Subject: Re: [Gdal-dev] WMO raster format

To whom it may concern,
GeoTools (www.geotools.org) has an experimental plugin for
reading/writing GriB files edition 1 with pluggable support for
external oraganization table. This support is built around JGriB1
(http://code.google.com/p/jgrib1).

For more information feel free to contact me.

Regards,
Simone.

-------------------------------------------------------
Eng. Simone Giannecchini
President /CEO GeoSolutions

http://www.geo-solutions.it

-------------------------------------------------------
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From dsampson at NRCan.gc.ca  Tue Nov 21 10:01:06 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdal_translate. Scaling, sizing, georeferencing
Message-ID: <2FAA57395C1F914DB27CAA4C376058F2011202B9@S0-OTT-X2.nrn.nrcan.gc.ca>

Hey Folks,

Synopsis.
---------------
 I am using gdal_translate within a VB application to georeference
photos. The X Y are grabbed by user input and Long Lat is grabbed from a
database. The outcome is pretty close to what I need but a few
behaviours I did not expect.

1. When I am using outsize I was hoping that this would decrease my
resolution and keep a georefed image, but it seems to make the photos
smaller (which makes sense I guess)
2. It appears as though I am maintaining my resoltuion, which I want to
drop without affecting geo-referencing
3. Whether I use a factor of 1 (100%), 1.5 (66%) or 4 (25%) I would
expect that all three geo-referenced images would accupy the same space,
but different resolutions.
4. The goal is to have a near perfect overlap with images that were
created using an old script that I hope to replace with gdal.

I have provided some info bellow.

What other bits of info do I need.

Thanks

The Command line so far:
-------------------------------------
gdal_translate -gcp 394.15 212.23 -76.777261  45.67899 -gcp 6001.45
272.87 -76.744739  45.678655 -gcp 5888.83 7561.67 -76.745361  45.649344
-gcp 285.87 7488.04 -76.777866  45.649679 -scale  -ot byte  -outsize
25% 25% -a_srs WGS84  -mo "Area_or_Point = Area "  A38_001.tif
oA38_001.tif

Disection:
--------------
 four control points
Scaling to keep 8 bit histogram 0 to 255
Output Type as byte (moving from 16 bit to 8 bit)
Outsize, either 25% or 66%, based on scaling factor of 4 or 1.5
respectively
Defining projection with generic WGS84 (a small assumption right now,
but I believe this is what the long lat is based on in the DB)
A single metadata tag
Source and destination images

Images:

These are aerial images with aprox 60 percent overlap

(Screen captures removed, Available upon request in a direct mail)

In the screen captures (if they came through) it shows what should be
geo-reffed photos. The large overlapping ones were created in an old
script that I'm trying to replace using gdal_translate

Gdal_info
---------------

Old Script (66%)
============
Driver: GTiff/GeoTIFF
Size is 4162, 5238
Coordinate System is:
GEOGCS["unnamed",
    DATUM["unknown",
        SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4201"]]
Origin = (-76.779526,45.680473)
Pixel Size = (0.00000878,-0.00000624)
Metadata:
  AREA_OR_POINT=Area
Corner Coordinates:
Upper Left  ( -76.7795258,  45.6804733) ( 76d46'46.29"W, 45d40'49.70"N)
Lower Left  ( -76.7795258,  45.6477890) ( 76d46'46.29"W, 45d38'52.04"N)
Upper Right ( -76.7429962,  45.6804733) ( 76d44'34.79"W, 45d40'49.70"N)
Lower Right ( -76.7429962,  45.6477890) ( 76d44'34.79"W, 45d38'52.04"N)
Center      ( -76.7612610,  45.6641312) ( 76d45'40.54"W, 45d39'50.87"N)
Band 1 Block=4162x1 Type=Byte, ColorInterp=Gray

New script (66%)
==============
Driver: GTiff/GeoTIFF
Size is 4183, 5264
Coordinate System is `'
GCP Projection = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.2572235630016,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG"
,"6326"]],PRIM
EM["Greenwich",0],UNIT["degree",0.0174532925199433],AUTHORITY["EPSG","43
26"]]
GCP[  0]: Id=1, Info=
          (394.15,212.23) -> (-76.7773,45.679,0)
GCP[  1]: Id=2, Info=
          (6001.45,272.87) -> (-76.7447,45.6787,0)
GCP[  2]: Id=3, Info=
          (5888.83,7561.67) -> (-76.7454,45.6493,0)
GCP[  3]: Id=4, Info=
          (285.87,7488.04) -> (-76.7779,45.6497,0)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_XRESOLUTION=800
  TIFFTAG_YRESOLUTION=800
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  Area_or_Point =Area
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 5264.0)
Upper Right ( 4183.0,    0.0)
Lower Right ( 4183.0, 5264.0)
Center      ( 2091.5, 2632.0)
Band 1 Block=4183x1 Type=Byte, ColorInterp=Gray


Problems:
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061121/c5eef88b/attachment.html
From jmp at geosys.com  Tue Nov 21 10:24:50 2006
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] ColorTable in C#
In-Reply-To: <f3b73b7d0611200506n1f4828ds1a5dc546fe08f14e@mail.gmail.com>
Message-ID: <000001c70d81$2fd0bde0$2201a8c0@pcjmp>


Hi, 

I'm using the CVS : "gdal-cvs-2006.11.21.tar.gz", I see well the new Class
ColorEntry, but I still can't create a new ColorTable with 256 ColorEntry.


public static void test(string file, string file_out)
{
	Driver dv = null;
	Dataset ds = null, ds_out = null;
	Band ba = null, ba_out = null;
	ColorTable ct = null, ct_out = null;
	byte [] buffer;

	ds = gdal.Open(file, gdalconst.GA_ReadOnly);
	ba = ds.GetRasterBand(1);
	ct = ba.GetRasterColorTable();

	buffer = new byte [ds.RasterXSize * ds.RasterYSize];
	ba.ReadRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
ds.RasterXSize, ds.RasterYSize, 0, 0);

	dv = gdal.GetDriverByName("GTiff");

	ds_out = dv.Create(file_out, ds.RasterXSize, ds.RasterYSize,
ds.RasterCount, ba.DataType, new string [] {});
	ba_out = ds_out.GetRasterBand(1);
    ct_out = new ColorTable(ct.GetCount());

	ba_out.WriteRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
ds.RasterXSize, ds.RasterYSize, 0, 0);

	for (int i = 0; i < ct.GetCount(); i++)
	{
		ColorEntry ce = null, ce_out = null;

		ce = ct.GetColorEntry(i);
		ce_out = new ColorEntry();

		ce_out.c1 = ce.c1;
		ce_out.c2 = ce.c2;
		ce_out.c3 = ce.c3;
		ce_out.c4 = ce.c4;

		ct_out.SetColorEntry(i, ce_out);

		ce.Dispose();
		ce_out.Dispose();
	}

	ba_out.SetRasterColorTable(ct_out);

	ct_out.Dispose();
	ba_out.Dispose();
	ds_out.Dispose();

	ct.Dispose();
	ba.Dispose();
	ds.Dispose();
}

-----Message d'origine-----
De?: Tamas Szekeres [mailto:szekerest@gmail.com] 
Envoy??: lundi 20 novembre 2006 14:06
??: Jean Michel PIERRET
Cc?: gdal-dev@lists.maptools.org
Objet?: Re: [Gdal-dev] ColorTable in C#

Hi,

I've just added the ColorEntry struct for the SWIG C# interface. Now you can
use

the ColorTable and ColorEntry classes along with
Band.SetRasterColorTable and Band.GetRasterColorTable.

Checkout the latest CVS and notify me how it works.


Best Regards,

Tamas Szekeres



2006/11/20, Jean Michel PIERRET <jmp@geosys.com>:
>
>
>
>
> Hi,
>
>
>
> How can I create a new ColorTable in C# for a new image.
>
>
>
> Thank.
>
>
>
> PIERRET Jean michel.
>
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>



From yjacolin at free.fr  Tue Nov 21 11:46:32 2006
From: yjacolin at free.fr (Yves Jacolin)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Question about Website
Message-ID: <200611211746.33224.yjacolin@free.fr>

Hi,

Is it normal that the documentation about gdal_merge.py is wrote twice in this 
page :
http://gdal.maptools.org/gdal_merge.html ?

Y.
-- 
Yves Jacolin
---
http://yjacolin.gloobe.org

From warmerdam at pobox.com  Tue Nov 21 19:28:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Question about Website
In-Reply-To: <200611211746.33224.yjacolin@free.fr>
References: <200611211746.33224.yjacolin@free.fr>
Message-ID: <456399C9.7010904@pobox.com>

Yves Jacolin wrote:
> Hi,
> 
> Is it normal that the documentation about gdal_merge.py is wrote twice in this 
> page :
> http://gdal.maptools.org/gdal_merge.html ?
> 
> Y.

Yves,

Good point.  I have corrected this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dfriberg23 at gmail.com  Tue Nov 21 16:24:54 2006
From: dfriberg23 at gmail.com (David Friberg)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL nix build configuration
In-Reply-To: <429131D6-4D73-461C-90D4-81F3F8B57524@kyngchaos.com>
References: <481948e30611171646r697b64aaj5674c734d0a3e03c@mail.gmail.com>
	<429131D6-4D73-461C-90D4-81F3F8B57524@kyngchaos.com>
Message-ID: <481948e30611211324h5ae5512cg22750c91dccb5d04@mail.gmail.com>

That should work, thanks for the info.

Dave


On 11/17/06, William Kyngesburye <woklist@kyngchaos.com> wrote:
> On OSX (I assume because of the dylib), it's simple to do without any
> patching of the GDAL make setup.  Let it build how it wants to and
> install it.  Then postprocess the library with install_name_tool.
> Assuming the default /usr/local install (and assuming that the
> compatibility problem is really that bad - Frank might know better on
> that score), that would be:
>
> install_name_tool -id /usr/local/lib/libgdal.1.X.Y.dylib /usr/local/
> lib/libgdal.1.X.Y.dylib
>
> where X and Y are the minor and revision numbers matching what was
> installed.
>
> You can change existing programs to match the new name with
> install_name_tool.  Like the GDAL tools, since they're built with the
> simpler version names.  Use otool first to verify the names:
>
> otool -L /path/to/program
>
> use the libgdal name there in install_name_tool:
>
> install_name_tool -change /existing/libgdal/name /usr/local/lib/
> libgdal.1.X.Y.dylib /path/to/program
>
>
> On Nov 17, 2006, at 6:46 PM, David Friberg wrote:
>
> > I would like to request a change to the rpath (hard-coded library
> > search path) used in the shared libraries produced by the GDAL build
> > system.  The rpath currently used is problematic for us because it
> > contains the major version number, but not the revision number or age
> > (e.g. /usr/local/lib/libgdal.1.dylib).  This search path is also
> > propagated to every executable and shared library that links to GDAL.
> > An incompatible version of GDAL may exist in /usr/local/lib, so the
> > dynamic linker will use that if present.  Since we do not want to
> > install GDAL to /usr/local/lib, overwriting what's there, our
> > executables fail to work due to the incompatible libgdal.
> >
>
> -----
> William Kyngesburye <kyngchaos@kyngchaos.com>
> http://www.kyngchaos.com/
>
> [Trillian]  What are you supposed to do WITH a maniacally depressed
> robot?
>
> [Marvin]  You think you have problems?  What are you supposed to do
> if you ARE a maniacally depressed robot?  No, don't try and answer,
> I'm 50,000 times more intelligent than you and even I don't know the
> answer...
>
> - HitchHiker's Guide to the Galaxy
>
>
>

From szekerest at gmail.com  Tue Nov 21 16:42:29 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] ColorTable in C#
In-Reply-To: <000001c70d81$2fd0bde0$2201a8c0@pcjmp>
References: <f3b73b7d0611200506n1f4828ds1a5dc546fe08f14e@mail.gmail.com>
	<000001c70d81$2fd0bde0$2201a8c0@pcjmp>
Message-ID: <f3b73b7d0611211342t4f5ddc88g319f0ffd67c72230@mail.gmail.com>

Hi,

When constructing the ColorTable you have to use the GDALPaletteInterp
constants as the parameter like:

ct_out = new ColorTable(gdalconst.GPI_RGB);

Here is the complete code:

public static void test(string file, string file_out)
    {
        gdal.AllRegister();

        Driver dv = null;
        Dataset ds = null, ds_out = null;
        Band ba = null, ba_out = null;
        ColorTable ct = null, ct_out = null;
        byte [] buffer;

        ds = gdal.Open(file, gdalconst.GA_ReadOnly);
        ba = ds.GetRasterBand(1);
        ct = ba.GetRasterColorTable();

        buffer = new byte [ds.RasterXSize * ds.RasterYSize];
        ba.ReadRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
            ds.RasterXSize, ds.RasterYSize, 0, 0);

        dv = gdal.GetDriverByName("GTiff");

        ds_out = dv.Create(file_out, ds.RasterXSize, ds.RasterYSize,
            ds.RasterCount, ba.DataType, new string [] {});
        ba_out = ds_out.GetRasterBand(1);
        ct_out = new ColorTable(gdalconst.GPI_RGB);

        ba_out.WriteRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
            ds.RasterXSize, ds.RasterYSize, 0, 0);

        for (int i = 0; i < ct.GetCount(); i++)
        {
            ColorEntry ce = null, ce_out = null;

            ce = ct.GetColorEntry(i);
            ce_out = new ColorEntry();

            ce_out.c1 = ce.c1;
            ce_out.c2 = ce.c2;
            ce_out.c3 = ce.c3;
            ce_out.c4 = ce.c4

            ct_out.SetColorEntry(i, ce_out);

            ce.Dispose();
            ce_out.Dispose();
        }

        ba_out.SetRasterColorTable(ct_out);
    }


Best Regards,

Tamas Szekeres







2006/11/21, Jean Michel PIERRET <jmp@geosys.com>:
>
> Hi,
>
> I'm using the CVS : "gdal-cvs-2006.11.21.tar.gz", I see well the new Class
> ColorEntry, but I still can't create a new ColorTable with 256 ColorEntry.
>
>
> public static void test(string file, string file_out)
> {
>         Driver dv = null;
>         Dataset ds = null, ds_out = null;
>         Band ba = null, ba_out = null;
>         ColorTable ct = null, ct_out = null;
>         byte [] buffer;
>
>         ds = gdal.Open(file, gdalconst.GA_ReadOnly);
>         ba = ds.GetRasterBand(1);
>         ct = ba.GetRasterColorTable();
>
>         buffer = new byte [ds.RasterXSize * ds.RasterYSize];
>         ba.ReadRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
> ds.RasterXSize, ds.RasterYSize, 0, 0);
>
>         dv = gdal.GetDriverByName("GTiff");
>
>         ds_out = dv.Create(file_out, ds.RasterXSize, ds.RasterYSize,
> ds.RasterCount, ba.DataType, new string [] {});
>         ba_out = ds_out.GetRasterBand(1);
>     ct_out = new ColorTable(ct.GetCount());
>
>         ba_out.WriteRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
> ds.RasterXSize, ds.RasterYSize, 0, 0);
>
>         for (int i = 0; i < ct.GetCount(); i++)
>         {
>                 ColorEntry ce = null, ce_out = null;
>
>                 ce = ct.GetColorEntry(i);
>                 ce_out = new ColorEntry();
>
>                 ce_out.c1 = ce.c1;
>                 ce_out.c2 = ce.c2;
>                 ce_out.c3 = ce.c3;
>                 ce_out.c4 = ce.c4;
>
>                 ct_out.SetColorEntry(i, ce_out);
>
>                 ce.Dispose();
>                 ce_out.Dispose();
>         }
>
>         ba_out.SetRasterColorTable(ct_out);
>
>         ct_out.Dispose();
>         ba_out.Dispose();
>         ds_out.Dispose();
>
>         ct.Dispose();
>         ba.Dispose();
>         ds.Dispose();
> }
>
> -----Message d'origine-----
> De: Tamas Szekeres [mailto:szekerest@gmail.com]
> Envoy?: lundi 20 novembre 2006 14:06
> ?: Jean Michel PIERRET
> Cc: gdal-dev@lists.maptools.org
> Objet: Re: [Gdal-dev] ColorTable in C#
>
> Hi,
>
> I've just added the ColorEntry struct for the SWIG C# interface. Now you can
> use
>
> the ColorTable and ColorEntry classes along with
> Band.SetRasterColorTable and Band.GetRasterColorTable.
>
> Checkout the latest CVS and notify me how it works.
>
>
> Best Regards,
>
> Tamas Szekeres
>
>
>
> 2006/11/20, Jean Michel PIERRET <jmp@geosys.com>:
> >
> >
> >
> >
> > Hi,
> >
> >
> >
> > How can I create a new ColorTable in C# for a new image.
> >
> >
> >
> > Thank.
> >
> >
> >
> > PIERRET Jean michel.
> >
> >
> >
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
> >
>
>


From jmp at geosys.com  Wed Nov 22 02:48:45 2006
From: jmp at geosys.com (Jean Michel PIERRET)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] ColorTable in C#
In-Reply-To: <f3b73b7d0611211342t4f5ddc88g319f0ffd67c72230@mail.gmail.com>
Message-ID: <000201c70e0a$a3e6c420$2201a8c0@pcjmp>

Hi,

It works very well, thanks.

Best Regards,

PIERRET Jean michel


-----Message d'origine-----
De : Tamas Szekeres [mailto:szekerest@gmail.com] 
Envoy? : mardi 21 novembre 2006 22:42
? : Jean Michel PIERRET
Cc : gdal-dev@lists.maptools.org
Objet : Re: RE : [Gdal-dev] ColorTable in C#

Hi,

When constructing the ColorTable you have to use the GDALPaletteInterp
constants as the parameter like:

ct_out = new ColorTable(gdalconst.GPI_RGB);

Here is the complete code:

public static void test(string file, string file_out)
    {
        gdal.AllRegister();

        Driver dv = null;
        Dataset ds = null, ds_out = null;
        Band ba = null, ba_out = null;
        ColorTable ct = null, ct_out = null;
        byte [] buffer;

        ds = gdal.Open(file, gdalconst.GA_ReadOnly);
        ba = ds.GetRasterBand(1);
        ct = ba.GetRasterColorTable();

        buffer = new byte [ds.RasterXSize * ds.RasterYSize];
        ba.ReadRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
            ds.RasterXSize, ds.RasterYSize, 0, 0);

        dv = gdal.GetDriverByName("GTiff");

        ds_out = dv.Create(file_out, ds.RasterXSize, ds.RasterYSize,
            ds.RasterCount, ba.DataType, new string [] {});
        ba_out = ds_out.GetRasterBand(1);
        ct_out = new ColorTable(gdalconst.GPI_RGB);

        ba_out.WriteRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
            ds.RasterXSize, ds.RasterYSize, 0, 0);

        for (int i = 0; i < ct.GetCount(); i++)
        {
            ColorEntry ce = null, ce_out = null;

            ce = ct.GetColorEntry(i);
            ce_out = new ColorEntry();

            ce_out.c1 = ce.c1;
            ce_out.c2 = ce.c2;
            ce_out.c3 = ce.c3;
            ce_out.c4 = ce.c4

            ct_out.SetColorEntry(i, ce_out);

            ce.Dispose();
            ce_out.Dispose();
        }

        ba_out.SetRasterColorTable(ct_out);
    }


Best Regards,

Tamas Szekeres







2006/11/21, Jean Michel PIERRET <jmp@geosys.com>:
>
> Hi,
>
> I'm using the CVS : "gdal-cvs-2006.11.21.tar.gz", I see well the new Class
> ColorEntry, but I still can't create a new ColorTable with 256 ColorEntry.
>
>
> public static void test(string file, string file_out)
> {
>         Driver dv = null;
>         Dataset ds = null, ds_out = null;
>         Band ba = null, ba_out = null;
>         ColorTable ct = null, ct_out = null;
>         byte [] buffer;
>
>         ds = gdal.Open(file, gdalconst.GA_ReadOnly);
>         ba = ds.GetRasterBand(1);
>         ct = ba.GetRasterColorTable();
>
>         buffer = new byte [ds.RasterXSize * ds.RasterYSize];
>         ba.ReadRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
> ds.RasterXSize, ds.RasterYSize, 0, 0);
>
>         dv = gdal.GetDriverByName("GTiff");
>
>         ds_out = dv.Create(file_out, ds.RasterXSize, ds.RasterYSize,
> ds.RasterCount, ba.DataType, new string [] {});
>         ba_out = ds_out.GetRasterBand(1);
>     ct_out = new ColorTable(ct.GetCount());
>
>         ba_out.WriteRaster(0, 0, ds.RasterXSize, ds.RasterYSize, buffer,
> ds.RasterXSize, ds.RasterYSize, 0, 0);
>
>         for (int i = 0; i < ct.GetCount(); i++)
>         {
>                 ColorEntry ce = null, ce_out = null;
>
>                 ce = ct.GetColorEntry(i);
>                 ce_out = new ColorEntry();
>
>                 ce_out.c1 = ce.c1;
>                 ce_out.c2 = ce.c2;
>                 ce_out.c3 = ce.c3;
>                 ce_out.c4 = ce.c4;
>
>                 ct_out.SetColorEntry(i, ce_out);
>
>                 ce.Dispose();
>                 ce_out.Dispose();
>         }
>
>         ba_out.SetRasterColorTable(ct_out);
>
>         ct_out.Dispose();
>         ba_out.Dispose();
>         ds_out.Dispose();
>
>         ct.Dispose();
>         ba.Dispose();
>         ds.Dispose();
> }
>
> -----Message d'origine-----
> De: Tamas Szekeres [mailto:szekerest@gmail.com]
> Envoy?: lundi 20 novembre 2006 14:06
> ?: Jean Michel PIERRET
> Cc: gdal-dev@lists.maptools.org
> Objet: Re: [Gdal-dev] ColorTable in C#
>
> Hi,
>
> I've just added the ColorEntry struct for the SWIG C# interface. Now you can
> use
>
> the ColorTable and ColorEntry classes along with
> Band.SetRasterColorTable and Band.GetRasterColorTable.
>
> Checkout the latest CVS and notify me how it works.
>
>
> Best Regards,
>
> Tamas Szekeres
>
>
>
> 2006/11/20, Jean Michel PIERRET <jmp@geosys.com>:
> >
> >
> >
> >
> > Hi,
> >
> >
> >
> > How can I create a new ColorTable in C# for a new image.
> >
> >
> >
> > Thank.
> >
> >
> >
> > PIERRET Jean michel.
> >
> >
> >
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
> >
>
>



From jdgonon at gi-lemans.com  Wed Nov 22 04:20:54 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] still errors for compiling GDAL/OGR-1.3.2 with DGNDirect
Message-ID: <000c01c70e17$82fa0ad0$6469850a@gi.com>

Hi

I compile OGR/GDAL-1.3.2 with DGN v8 format using DGNDirect librairies.
I use Visual C++ 2003 for source code, but I use commands lines for compiling my DLL.

I included "dgntk.h" in my hearder file without errors.
I declared DGNDirect librairies (zlibMD8.lib, dgntkMD8.lib, olessMD8.lib) in "nmake.opt" (in attachement file).

According to the DGNDirect librairies included (MD/MT/ST/v7/v8), I have various types of errors :

either "fatal error LNK1262: l'?dition de liens a ?chou? ? cause de l'incompatibilit? des versions de 'C:\Program Files\Microsoft Visual Studio .NET 2003\VC7\BIN\c2.dll' et de LINK.EXE", or "error LNK2019: symbole externe non r?solu "public: static class dgn::IDgnFile * __cdecl dgn::IDgnFile::Load(char *)" (?Load@IDgnFile@dgn@@SAPAV12@PAD@Z) r?f?renc? dans la fonction _DGNOpen_V8".
The error on compilation is always on the call of the function "static IDgnFile* Load(char* pFileName)" in "IDgnFile" class (in "IDgnFile.h" file).

I think I have included bad librairies DGNDirect

What can I do ?

Thank you in advance
JD
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061122/6fb18425/attachment.html
From gbourel at ago.fr  Wed Nov 22 09:11:13 2006
From: gbourel at ago.fr (Guillaume Bourel)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDALWarpOptions - Destination dataset issue
In-Reply-To: <200611211702.kALH2THh020499@duke.maptools.org>
References: <200611211702.kALH2THh020499@duke.maptools.org>
Message-ID: <45645A81.3020001@ago.fr>

Hi,

I am currently trying to warp GeoTiff data with any geographic 
coordinate system into WGS84 with Mercator projection, within a C++ project.

I do believe this should be done by using GDALWarpRegionToBuffer, which 
needs a GDALWarpOperation, which, itself, needs a GDALWarpOptions.


GDALWarpOptions reference explains :

    GDALDatasetH GDALWarpOptions::hDstDS
    <http://gdal.maptools.org/structGDALWarpOptions.html#o5>
    Destination image dataset - may be NULL if only using
    GDALWarpOperation::WarpRegionToBuffer()
    <http://gdal.maptools.org/classGDALWarpOperation.html#a7>.

but GDALWarpOperation::Initialize or GDALCreateWarpOperation both 
returns CE_Failure, if hDstDS is set to NULL
(behavior due to ValidateOptions() call, which checks hDstDS isn't 
NULL). Therefore, creation of the GDALWarpOperation fails.
And, as I don't have any destination file, my destination dataset is NULL.

I don't understand what I'm doing wrong,
if someone could explain me the way I should follow to successfully 
create a GDALWarpOperation in order to use it with GDALWarpRegionToBuffer.


Best regards,
Guillaume.

-- 
BOUREL Guillaume - ATLANTIDE
consultant
Tel. : +33 (0)2 98 05 43 21
http://www.ago.fr/
--
Technop?le Brest Iroise
Site du Vernis - CS 23866
29238 Brest Cedex 3 - France
Tel. : +33 (0)2 98 05 43 21
Fax. : +33 (0)2 98 05 20 34
e-mail: atlantide-brest@ago.fr



From dsampson at NRCan.gc.ca  Wed Nov 22 09:51:57 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp resolution
Message-ID: <2FAA57395C1F914DB27CAA4C376058F2011206D1@S0-OTT-X2.nrn.nrcan.gc.ca>

Hey folks,

I am trying to move a 800 dpi to a 300 dpi image. The src image was
created using gdal_translate to assign SRS, 4 GCP's and change from
16bit to 8bit image. Src image has the following meta_tags

Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_XRESOLUTION=800
  TIFFTAG_YRESOLUTION=800
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  Area_or_Point =Area 


The command line I am using is:

gdalwarp -tr 300 300 oA38_001.tif S_A38_001.tif

But I get this error

Creating output file that is 0P x 0L.
ERROR 1: Attempt to create 0x0x1 TIFF file, but width, height and bands
must be positive.

Any ideas?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061122/f1aa2e3b/attachment.html
From warmerdam at pobox.com  Wed Nov 22 10:25:10 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDALWarpOptions - Destination dataset issue
In-Reply-To: <45645A81.3020001@ago.fr>
References: <200611211702.kALH2THh020499@duke.maptools.org>
	<45645A81.3020001@ago.fr>
Message-ID: <45646BD6.2060208@pobox.com>

Guillaume Bourel wrote:
> Hi,
> 
> I am currently trying to warp GeoTiff data with any geographic 
> coordinate system into WGS84 with Mercator projection, within a C++ 
> project.
> 
> I do believe this should be done by using GDALWarpRegionToBuffer, which 
> needs a GDALWarpOperation, which, itself, needs a GDALWarpOptions.
> 
> 
> GDALWarpOptions reference explains :
> 
>    GDALDatasetH GDALWarpOptions::hDstDS
>    <http://gdal.maptools.org/structGDALWarpOptions.html#o5>
>    Destination image dataset - may be NULL if only using
>    GDALWarpOperation::WarpRegionToBuffer()
>    <http://gdal.maptools.org/classGDALWarpOperation.html#a7>.
> 
> but GDALWarpOperation::Initialize or GDALCreateWarpOperation both 
> returns CE_Failure, if hDstDS is set to NULL
> (behavior due to ValidateOptions() call, which checks hDstDS isn't 
> NULL). Therefore, creation of the GDALWarpOperation fails.
> And, as I don't have any destination file, my destination dataset is NULL.
> 
> I don't understand what I'm doing wrong,
> if someone could explain me the way I should follow to successfully 
> create a GDALWarpOperation in order to use it with GDALWarpRegionToBuffer.

Guillaume,

It appears that support for null hDstDS has "rotted" through disuse.  I
have made a few changes to the Validate() method that I hope will fix the
problem, but I currently have no uses for this style of use of the warper
so it is hard for me to check.  Can you grab the latest from CVS and
see if this helps?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 22 10:47:13 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp resolution
In-Reply-To: <2FAA57395C1F914DB27CAA4C376058F2011206D1@S0-OTT-X2.nrn.nrcan.gc.ca>
References: <2FAA57395C1F914DB27CAA4C376058F2011206D1@S0-OTT-X2.nrn.nrcan.gc.ca>
Message-ID: <45647101.8050100@pobox.com>

Sampson, David wrote:
> Hey folks,
> 
> I am trying to move a 800 dpi to a 300 dpi image. The src image was 
> created using gdal_translate to assign SRS, 4 GCP's and change from 
> 16bit to 8bit image. Src image has the following meta_tags
> 
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_XRESOLUTION=800
>   TIFFTAG_YRESOLUTION=800
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>   Area_or_Point =Area
> 
> 
> The command line I am using is:
> 
> gdalwarp -tr 300 300 oA38_001.tif S_A38_001.tif
> 
> But I get this error
> 
> Creating output file that is 0P x 0L.
> ERROR 1: Attempt to create 0x0x1 TIFF file, but width, height and bands 
> must be positive.

Dave,

The "dpi printing resolution" information kept in some TIFF files is
completely disconnected from the georeferencing model of GDAL.  So
the -tr flag to gdalwarp is about setting the resolution in the
geo coordinate system of the image, but this image likely has none.

If you just want to downsample the image, you could try:

  gdal_translate -outsize 37.5% 37.5% in.tif out.tif

If you also want to override the resolution metadata tags (possibly
necessary to make printing software print properly) try:

  gdal_translate -outsize 37.5% 37.5% \
      -mo TIFFTAG_XRESOLUTION=300 -mo TIFFTAG_YRESOLUTION=300 \
      in.tif out.tif

Best regards,
-------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From neteler at itc.it  Wed Nov 22 10:54:54 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
Message-ID: <20061122155454.GA10564@bartok.itc.it>

Hi,

after a new installation of Mandriva 2007 I found some fancy bug (or whatever),
apparently related to the LOCALE:

1. DE LOCALE:

GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
         ?berschrieben.
A datum name etrs89 (European_Terrestrial_Reference_System_1989) was specified without transformation parameters.
Note that the GRASS default for etrs89 is towgs84=0.000,0.000,0.000.
Die Projektionsinformationen des Eingabedatensatzes und der aktuellen Location stimmen ?berein.
Fahre mit dem Import fort...
WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
         ?berschrieben.
Layer: europe_countries_LAEA
WARNUNG: Spaltenname 'cat' wurde in 'cat_' ge?ndert.
Importiere 3356 Objekte der Karte...
Speicherzugriffsfehler

-> "Segmentation fault"


2. Switching LOCALE:

GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export LANGUAGE=en_US
GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export LANG=en_US
GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export LC_ALL=en_US
GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
WARNING: The vector 'europe_countries' already exists and will be
         overwritten.
A datum name etrs89 (European_Terrestrial_Reference_System_1989) was specified without transformation parameters.
Note that the GRASS default for etrs89 is towgs84=0.000,0.000,0.000.
Projection of input dataset and current location appear to match.
Proceeding with import...
WARNING: The vector 'europe_countries' already exists and will be
         overwritten.
WARNING: Table 'europe_countries' linked to vector did not exist.
Layer: europe_countries_LAEA
WARNING: Column name changed: 'cat' -> 'cat_'
Importing map 3356 features...
-----------------------------------------------------
Building topology ...
3360 primitives registered
Building areas:  100%
3352 areas built
3329 isles built
Attaching islands:   17%
...

-> works.

############ System
uname -a
Linux localhost 2.6.17-5mdv #1 SMP Wed Sep 13 14:32:31 EDT 2006 i686 Intel(R) Pentium(R) 4 CPU 2.53GHz GNU/Linux

gcc -v
Using built-in specs.
Target: i586-mandriva-linux-gnu
Configured with: ...
gcc version 4.1.1 20060724 (prerelease) (4.1.1-3mdk)

############# Debugging in gdb:

Back to DE LOCALE:

gdb `which v.in.ogr`
GNU gdb 6.3-8mdv2007.0 (Mandriva Linux release 2007.0)
...
This GDB was configured as "i586-mandriva-linux-gnu"...Using host libthread_db library "/lib/i686/libthread_db.so.1".
(gdb) r europe_countries_LAEA.shp out=europe_countries --o

Starting program: /home/neteler/soft/63grass_cvsexp/dist.i686-pc-linux-gnu/bin/v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
Reading symbols from shared object read from target memory...done.
Loaded system supplied DSO at 0xbfffe000
[Thread debugging using libthread_db enabled]
[New Thread -1224276272 (LWP 14949)]
Detaching after fork from child process 14952.
Detaching after fork from child process 14953.
WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
         ?berschrieben.
A datum name etrs89 (European_Terrestrial_Reference_System_1989) was specified without transformation parameters.
Note that the GRASS default for etrs89 is towgs84=0.000,0.000,0.000.
Die Projektionsinformationen des Eingabedatensatzes und der aktuellen Location stimmen ?berein.
Fahre mit dem Import fort...
Detaching after fork from child process 14954.
WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
         ?berschrieben.
Detaching after fork from child process 14955.
Detaching after fork from child process 14956.
WARNUNG: Table 'europe_countries' linked to vector did not exist.
Layer: europe_countries_LAEA
Detaching after fork from child process 14957.
WARNUNG: Spaltenname 'cat' wurde in 'cat_' ge?ndert.
Detaching after fork from child process 14958.
Importiere 3356 Objekte der Karte...

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread -1224276272 (LWP 14949)]
0xb7cdded9 in OGRSpatialReference::Release (this=0x8073948) at ogrspatialreference.cpp:399
399             delete this;
Current language:  auto; currently c++
(gdb) bt full
#0  0xb7cdded9 in OGRSpatialReference::Release (this=0x8073948) at ogrspatialreference.cpp:399
No locals.
#1  0xb7cd37af in ~OGRGeometry (this=0x80818e0) at ogrgeometry.cpp:204
No locals.
#2  0xb7cd0ff3 in ~OGRPolygon (this=0x80818e0) at ogr_geometry.h:556
No locals.
#3  0xb7cd7c31 in ~OGRFeature (this=0x8080070) at ogrfeature.cpp:188
No locals.
#4  0xb7cd6755 in OGR_F_Destroy (hFeat=0x8080070) at ogrfeature.cpp:250
No locals.
#5  0x0804d5dc in main (argc=4, argv=0xbfa2c474) at main.c:748
        i = Variable "i" is not available.


I updated from GDAL-CVS a few minutes ago. The bt result doesn't tell me
much unfortunately...

Suggestions are welcome,
Markus


From janeen at splash.princeton.edu  Wed Nov 22 11:03:33 2006
From: janeen at splash.princeton.edu (Janeen)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] how is yllcorner determined and why
Message-ID: <456474D5.4000800@splash.princeton.edu>

Hello All,

I've just tried the gdal_translate utility on a NetCDF file, converting 
it to the AAIGrid format.  I'm new to the world of GIS and NetCDF also.  
So in using the utility, I want to be sure that I understand how all the 
data from  the  .nc file  makes it over to the ascii file.

I can't quite figure out how the yllcorner value being reported is 
calculated, and why it is transformed the way it is.  I've looked at the 
code and gotten as far as this line in aaigriddataset.cpp:

   adfGeoTransform[3]- nYSize * adfGeoTransform[1]

I can't quite get what the variable adfGeoTransform[3] represents from 
the original .nc file.  The part of the equation:
    nYSize * adfGeoTransform[1]  

I understand where those values  come from in my sample file (i.e. 180 
*  0.994444444444  = 179 ).  Given that yllcorner is being reported as 
-269, that means that the value for adfGeoTransform[3] would be -90.   
But what does that value represent in my original netCDF file given the 
info below?

If anyone can give me a description of what is going on here, I would 
appreciate it.  Below is header  and gdalinfo.

Janeen


Here is the gdal header info from my converted .nc file:

   cols        360
   nrows        180
   xllcorner    0.500000000000
   yllcorner    -269.000000000000
   dx           0.997222222222
   dy           0.994444444444
   NODATA_value -10000000000

Here is (relevant) gdalinfo from my .nc file
   Driver: netCDF/Network Common Data Format
   Size is 360, 180
   Coordinate System is `'
   Origin = (0.500000,-89.500000)
   Pixel Size = (0.99722222,0.99444444)
   Corner Coordinates:
   Upper Left  (   0.5000000, -89.5000000)
   Lower Left  (   0.5000000,  89.5000000)
   Upper Right (     359.500,     -89.500)
   Lower Right (     359.500,      89.500)
   Center      ( 180.0000000,   0.0000000)




From stephan.holl at intevation.de  Wed Nov 22 13:47:30 2006
From: stephan.holl at intevation.de (Stephan Holl)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 30, Issue 54
In-Reply-To: <200611221701.kAMH1GuR005326@duke.maptools.org>
References: <200611221701.kAMH1GuR005326@duke.maptools.org>
Message-ID: <20061122194730.4ac53c19@localhost>

Hello Markus,

On Wed, 22 Nov 2006 12:01:16 -0500 gdal-dev-request@lists.maptools.org
wrote:

> 2. Switching LOCALE:
> 
> GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export
> LANGUAGE=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
> export LANG=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
> export LC_ALL=en_US 

Have your tried just to export LC_NUMERIC=C and import afterwards?

I *could* imagine that this might break something about the decimal
delimiter?!

Just a guess.

I thought Bernhard told me that he has filed a bug against a similar
issue, but I cannot recheck because the bugzilla is dead somehow ATM.

Best regards

	Stephan


-- 
Stephan Holl   : www.intevation.de/~stephan | GISpatcher:
www.gispatcher.de Intevation GmbH: www.intevation.de          | GAV
e.V.: www.grass-verein.de Georgstr.4     : 49074 Osnabr?ck            | 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061122/b704ffa6/signature.bin
From steve.hagen at unh.edu  Wed Nov 22 14:38:37 2006
From: steve.hagen at unh.edu (Stephen Hagen)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] warping MODIS data with gdal
Message-ID: <1164224317.32483.23.camel@selva.sr.unh.edu>

Hello,


I'm trying to reproject raw MODIS data (MOD09A1 Level 3 reflectance data
in HDF-EOS format) from its original SINUSOIDAL projection to UTM using
gdal in FWTools. I have encountered several problems. And I need help. I
put the hdf file that I am working with here: 

ftp://eos.sr.unh.edu/pub/outgoing/Frolking/Hagen/
MOD09A1.A2001289.h08v05.004.2003162200605.hdf.gz


1) gdalinfo does not recognize the projection information in the MOD09A1
hdf file:


$>gdalinfo MOD09A1.A2001289.h08v05.004.2003162200605.hdf


Driver: HDF4/Hierarchical Data Format Release 4
Size is 512, 512
Coordinate System is `'
Metadata:.....
Subdatasets:
1_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":0
SUBDATASET_1_DESC=[2400x2400] sur_refl_b01 (16-bit integer)

2_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":1
SUBDATASET_2_DESC=[2400x2400] sur_refl_b02 (16-bit integer)

3_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":2
SUBDATASET_3_DESC=[2400x2400] sur_refl_b03 (16-bit integer)

4_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":3
SUBDATASET_4_DESC=[2400x2400] sur_refl_b04 (16-bit integer)

5_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":4
SUBDATASET_5_DESC=[2400x2400] sur_refl_b05 (16-bit integer)

6_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":5
SUBDATASET_6_DESC=[2400x2400] sur_refl_b06 (16-bit integer)

7_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":6
SUBDATASET_7_DESC=[2400x2400] sur_refl_b07 (16-bit integer)

8_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":7
SUBDATASET_8_DESC=[2400x2400] sur_refl_qc_500m (32-bit unsigned integer)

9_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":8
SUBDATASET_9_DESC=[2400x2400] sur_refl_szen (16-bit integer)

10_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":9
SUBDATASET_10_DESC=[2400x2400] sur_refl_vzen (16-bit integer)

11_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":10
SUBDATASET_11_DESC=[2400x2400] sur_refl_raz (16-bit integer)

12_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":11
12_DESC=[2400x2400] sur_refl_state_500m (16-bit unsigned integer)

13_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":12
13_DESC=[2400x2400] sur_refl_day_of_year (16-bit unsigned integer)

Corner Coordinates:
Upper Left ( 0.0, 0.0)
Lower Left ( 0.0, 512.0)
Upper Right ( 512.0, 0.0)
Lower Right ( 512.0, 512.0)
Center ( 256.0, 256.0)


2. gdalinfo does not recognize the sub data set projection information
either:

$>gdalinfo HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.
hdf":0

Driver: HDF4Image/HDF4 Dataset
Size is 2400, 2400
Coordinate System is `'.....
Corner Coordinates:
Upper Left ( 0.0, 0.0)
Lower Left ( 0.0, 2400.0)
Upper Right ( 2400.0, 0.0)
Lower Right ( 2400.0, 2400.0)
Center ( 1200.0, 1200.0)

Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
Offset: -0, Scale:0.0001


3. I know the projection information from the hdf-eos header. It is
sinusoidal with a radius of 6371007.181 m. I also know the bounding box
coordinates from the header. So, I'll use gdal_translate to "force" in
projection information.


(As a side note, I found this information about the MODIS sphere in
ellipsoid.csv:


7048,GRS 1980 Authalic Sphere,6371007,9001,,6371007,0,Authalic sphere
derived from GRS 1980 ellipsoid (code 7019). (An authalic sphere is one
with a surface area equal to the surface area of the ellipsoid). 1/f is
infinite.,EPSG,EPSG,2001-06-25,,0

But I don't know how to use this information.)


$>gdal_translate -of GTiff -a_srs '+proj=sinu +lon_0=0 +x_0=0 +y_0=0
a=6371007.181 +b=6371007.181 +units=m no_defs' -a_ullr -11119505.196667
4447802.078667 -10007554.677000 3335851.559000 -sds
MOD09A1.A2001289.h08v05.004.2003162200605.hdf
MOD09A1.A2001289.h08v05.004.2003162200605.tif


Using gdalinfo again, this appears to have worked:

$>gdalinfo MOD09A1.A2001289.h08v05.004.2003162200605.tif1

Driver: GTiff/GeoTIFF
Size is 2400, 2400
Coordinate System is:
PROJCS["unnamed",
GEOGCS["unnamed ellipse",
DATUM["unknown",
SPHEROID["unnamed",6371007.181,0]],
PRIMEM["Greenwich",0],
UNIT["degree",0.0174532925199433]],
PROJECTION["Sinusoidal"],
PARAMETER["longitude_of_center",0],
PARAMETER["false_easting",0],
PARAMETER["false_northing",0],
UNIT["metre",1,
AUTHORITY["EPSG","9001"]]]
Origin = (-11119505.196667,4447802.078667)
Pixel Size = (463.31271653,-463.31271653).....

Corner Coordinates:
Upper Left (-11119505.197, 4447802.079) (130d32'26.62"W, 40d 0'0.00"N)
Lower Left (-11119505.197, 3335851.559) (115d28'12.19"W, 30d 0'0.00"N)
Upper Right (-10007554.677, 4447802.079) (117d29'11.96"W, 40d 0'0.00"N)
Lower Right (-10007554.677, 3335851.559) (103d55'22.97"W, 30d 0'0.00"N)
Center (-10563529.937, 3891826.819) (115d58'24.91"W, 35d 0'0.00"N)

Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
Offset: -0, Scale:0.0001


4) However, when I warp this file into UTM or geographic, the resulting
map is shifted by about 19 km in the latitudinal direction.

$>gdalwarp -t_srs "EPSG:26912" -tr 463.3127 463.3127
MOD09A1.A2001289.h08v05.004.2003162200605.tif1
MOD09A1.A2001289.h08v05.004.2003162200605_utm.tif1

I've tried subsetting the data first to avoid having an image cross
several UTM zones. The results are no better.


I know I can use HEG or MRT. Those work fine and accurately. But I love 
GDAL and want to use it in every step of my giant processing stream.
MODIS data (and the file formats and projection that comes along) are
commonly used. Shouldn't gdal be able to do this? Have I missed
something?

So, my ultimate question:

WHY CAN'T GDAL ACCURATELY WARP A MODIS FILE FROM ITS ORIGINAL SINUSOIDAL
PROJECTION INTO ANOTHER PROJECTION?


OR


WHAT HAVE I DONE WRONG?


Any insights would be very much appreciated.


Best regards,

Steve


From izzybitsie at gmail.com  Wed Nov 22 15:00:49 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] gdal_merge.py set output image Channel Depth
Message-ID: <23e208430611221200j26f4c50lc88f04f9007e79ee@mail.gmail.com>

I tried the GDAl utility 'gdal-merge.py' that stitches geotiff images
preserving the pseudo color table that is what I want: a mosaic of satellite
images.  The problem is that the image produced with '-pct' option is 1 bit
grey-scale while the input images are 8 bit.
Could anyone let me know how I can keep the inputs' Channel Depth for the
output image?

Tx
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061122/f716c9d8/attachment.html
From Charles.Wivell at dnr.state.mn.us  Wed Nov 22 15:20:51 2006
From: Charles.Wivell at dnr.state.mn.us (Charles Wivell)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <1164224317.32483.23.camel@selva.sr.unh.edu>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
Message-ID: <45645CC302000056000015CF@co5.dnr.state.mn.us>

Hi Steve;


Usually a shift in (mostly) the latitudinal direction is a sign of a
problem in converting between datums. My guess would be (and it is only
a guess) is that GDAL is having a problem with converting from a sphere
to an ellipsoid. Map projection routines (like GCTP) convert from
projection coord.s to lat, lon. But the lat is the geocentric lat in
this case. This latitude when converted to WGS84 (or what ever) must be
change to geodetic latitude. Although, 19 km seems large for just a
problem with the datum convertion, but I'd have to do some calculations
to see if that makes sense.

BTW, I just saw the LDCM Science Team has been picked. Please contact
them and tell them that the users don't want a "standard file format"
and a "standard map projection" or we'll end up like what the EOS
Science Team determined was good for us (HDF, Sinusoidal).....


Chuck



=====================================
Charles Wivell
MN DNR Forestry/Resource Assessment
413 SE 13th Street
Grand Rapids, MN 55744
218-327-4449 x 233
=====================================

>>> Stephen Hagen <steve.hagen@unh.edu> 11/22/2006 1:38 PM >>>
Hello,


I'm trying to reproject raw MODIS data (MOD09A1 Level 3 reflectance
data
in HDF-EOS format) from its original SINUSOIDAL projection to UTM
using
gdal in FWTools. I have encountered several problems. And I need help.
I
put the hdf file that I am working with here: 

ftp://eos.sr.unh.edu/pub/outgoing/Frolking/Hagen/ 
MOD09A1.A2001289.h08v05.004.2003162200605.hdf.gz


1) gdalinfo does not recognize the projection information in the
MOD09A1
hdf file:


$>gdalinfo MOD09A1.A2001289.h08v05.004.2003162200605.hdf


Driver: HDF4/Hierarchical Data Format Release 4
Size is 512, 512
Coordinate System is `'
Metadata:.....
Subdatasets:
1_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":0
SUBDATASET_1_DESC=[2400x2400] sur_refl_b01 (16-bit integer)

2_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":1
SUBDATASET_2_DESC=[2400x2400] sur_refl_b02 (16-bit integer)

3_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":2
SUBDATASET_3_DESC=[2400x2400] sur_refl_b03 (16-bit integer)

4_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":3
SUBDATASET_4_DESC=[2400x2400] sur_refl_b04 (16-bit integer)

5_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":4
SUBDATASET_5_DESC=[2400x2400] sur_refl_b05 (16-bit integer)

6_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":5
SUBDATASET_6_DESC=[2400x2400] sur_refl_b06 (16-bit integer)

7_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":6
SUBDATASET_7_DESC=[2400x2400] sur_refl_b07 (16-bit integer)

8_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":7
SUBDATASET_8_DESC=[2400x2400] sur_refl_qc_500m (32-bit unsigned
integer)

9_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":8
SUBDATASET_9_DESC=[2400x2400] sur_refl_szen (16-bit integer)

10_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":9
SUBDATASET_10_DESC=[2400x2400] sur_refl_vzen (16-bit integer)

11_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":10
SUBDATASET_11_DESC=[2400x2400] sur_refl_raz (16-bit integer)

12_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":11
12_DESC=[2400x2400] sur_refl_state_500m (16-bit unsigned integer)

13_NAME=HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":12
13_DESC=[2400x2400] sur_refl_day_of_year (16-bit unsigned integer)

Corner Coordinates:
Upper Left ( 0.0, 0.0)
Lower Left ( 0.0, 512.0)
Upper Right ( 512.0, 0.0)
Lower Right ( 512.0, 512.0)
Center ( 256.0, 256.0)


2. gdalinfo does not recognize the sub data set projection information
either:

$>gdalinfo
HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.
hdf":0

Driver: HDF4Image/HDF4 Dataset
Size is 2400, 2400
Coordinate System is `'.....
Corner Coordinates:
Upper Left ( 0.0, 0.0)
Lower Left ( 0.0, 2400.0)
Upper Right ( 2400.0, 0.0)
Lower Right ( 2400.0, 2400.0)
Center ( 1200.0, 1200.0)

Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
Offset: -0, Scale:0.0001


3. I know the projection information from the hdf-eos header. It is
sinusoidal with a radius of 6371007.181 m. I also know the bounding
box
coordinates from the header. So, I'll use gdal_translate to "force" in
projection information.


(As a side note, I found this information about the MODIS sphere in
ellipsoid.csv:


7048,GRS 1980 Authalic Sphere,6371007,9001,,6371007,0,Authalic sphere
derived from GRS 1980 ellipsoid (code 7019). (An authalic sphere is
one
with a surface area equal to the surface area of the ellipsoid). 1/f
is
infinite.,EPSG,EPSG,2001-06-25,,0

But I don't know how to use this information.)


$>gdal_translate -of GTiff -a_srs '+proj=sinu +lon_0=0 +x_0=0 +y_0=0
a=6371007.181 +b=6371007.181 +units=m no_defs' -a_ullr
-11119505.196667
4447802.078667 -10007554.677000 3335851.559000 -sds
MOD09A1.A2001289.h08v05.004.2003162200605.hdf
MOD09A1.A2001289.h08v05.004.2003162200605.tif


Using gdalinfo again, this appears to have worked:

$>gdalinfo MOD09A1.A2001289.h08v05.004.2003162200605.tif1

Driver: GTiff/GeoTIFF
Size is 2400, 2400
Coordinate System is:
PROJCS["unnamed",
GEOGCS["unnamed ellipse",
DATUM["unknown",
SPHEROID["unnamed",6371007.181,0]],
PRIMEM["Greenwich",0],
UNIT["degree",0.0174532925199433]],
PROJECTION["Sinusoidal"],
PARAMETER["longitude_of_center",0],
PARAMETER["false_easting",0],
PARAMETER["false_northing",0],
UNIT["metre",1,
AUTHORITY["EPSG","9001"]]]
Origin = (-11119505.196667,4447802.078667)
Pixel Size = (463.31271653,-463.31271653).....

Corner Coordinates:
Upper Left (-11119505.197, 4447802.079) (130d32'26.62"W, 40d 0'0.00"N)
Lower Left (-11119505.197, 3335851.559) (115d28'12.19"W, 30d 0'0.00"N)
Upper Right (-10007554.677, 4447802.079) (117d29'11.96"W, 40d
0'0.00"N)
Lower Right (-10007554.677, 3335851.559) (103d55'22.97"W, 30d
0'0.00"N)
Center (-10563529.937, 3891826.819) (115d58'24.91"W, 35d 0'0.00"N)

Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
Offset: -0, Scale:0.0001


4) However, when I warp this file into UTM or geographic, the
resulting
map is shifted by about 19 km in the latitudinal direction.

$>gdalwarp -t_srs "EPSG:26912" -tr 463.3127 463.3127
MOD09A1.A2001289.h08v05.004.2003162200605.tif1
MOD09A1.A2001289.h08v05.004.2003162200605_utm.tif1

I've tried subsetting the data first to avoid having an image cross
several UTM zones. The results are no better.


I know I can use HEG or MRT. Those work fine and accurately. But I love

GDAL and want to use it in every step of my giant processing stream.
MODIS data (and the file formats and projection that comes along) are
commonly used. Shouldn't gdal be able to do this? Have I missed
something?

So, my ultimate question:

WHY CAN'T GDAL ACCURATELY WARP A MODIS FILE FROM ITS ORIGINAL
SINUSOIDAL
PROJECTION INTO ANOTHER PROJECTION?


OR


WHAT HAVE I DONE WRONG?


Any insights would be very much appreciated.


Best regards,

Steve

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org 
http://lists.maptools.org/mailman/listinfo/gdal-dev

From dsampson at NRCan.gc.ca  Wed Nov 22 16:14:56 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp resolution
In-Reply-To: <2FAA57395C1F914DB27CAA4C376058F2011206D1@S0-OTT-X2.nrn.nrcan.gc.ca>
Message-ID: <2FAA57395C1F914DB27CAA4C376058F2012717D7@S0-OTT-X2.nrn.nrcan.gc.ca>

Frank,
 
Thanks for the suggestion for down sampling....
 
I think I am confused or trying to do too much...  this is my CLI call 
 
gdal_translate -gcp 378.19 196.43 -76.777261  45.67899 -gcp 6013.13
282.36 -76.744739  45.678655 -gcp 5890.36 7537.81 -76.745361  45.649344
-gcp 279.98 
7464.15 -76.777866  45.649679 -scale  -ot byte -a_srs EPSG:4201 -outsize
37.5% 37.5% -mo TIFFTAG_XRESOLUTION=300 -mo TIFFTAG_YRESOLUTION=300 -mo 
"Area_or_Point = Area" A38_001.tif oA38_001.tif
 
however I have the same issue as I outlined in MSG  [Gdal-dev]
Gdal_translate. Scaling, sizing, georeferencing
 
the issue that I assume that after the above I should have a
geo-referenced image. Two images side by side should overlap 60%
 
When I compare with a photo of same area processed using an older script
in Open EV the old images overlap, and the new gdal_translate images are
simply SMALLER pictures. The goal is for me to duplicate these
previously geo-refed images. Both the new and old images line up for the
Upper left corner, but then it falls apart. What happened to the other
three control points I passed it? A smaller resolution image should
occupy the same physical space, right?
 
Some other posts have asked the same question but I never find the
answer.
 
As a final product I will be using a -outsize of  25% or 66.7% whatever
resolution they come out as.
 
The solution I have come across is the following.
 
1.
gdal_translate -gcp 378.19 196.43 -76.777261  45.67899 -gcp 6013.13
282.36 -76.744739  45.678655 -gcp 5890.36 7537.81 -76.745361  45.649344
-gcp 279.98 
7464.15 -76.777866  45.649679 -scale  -ot byte -a_srs EPSG:4201  -mo
"Area_or_Point = Area" A38_001.tif oA38_001.tif
 
2.
gdalwarp -tr 0.0000116774 -0.0000082992 oA38_001.tif RoA38_001.tif
 
For this second stage I took info from gdalinfo of an image from step
one using the 67%. I passed that image through gdalwarp without options
to set the GCP's to the UL LL etc etc. I took the resolution and
multiplied in by 1.33. I guess I am not achieving a 300 dpi image after
all, but I got the file size I am looking for.
 
So these new resolution factors were passed again on the same image from
step one and it seemed to work. But it is messy and I can't evaluate
each photo.
 
The end result with this two step process is a geo-refed image that is
the same size that I am trying to duplicate and matches all four
corners.
 
Unfortunately I partialy don't realy know what all is ahppening or how I
could have predicted this outcome.
 
How can I get to the final product quicker and cleaner?
 
Did I goof somewhere along the way?
 
As usual, thanks
 
Cheers
 
===============
If you just want to downsample the image, you could try:

  gdal_translate -outsize 37.5% 37.5% in.tif out.tif

If you also want to override the resolution metadata tags (possibly
necessary to make printing software print properly) try:

  gdal_translate -outsize 37.5% 37.5% \
      -mo TIFFTAG_XRESOLUTION=300 -mo TIFFTAG_YRESOLUTION=300 \
      in.tif out.tif
========================

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Sampson, David
Sent: November 22, 2006 09:52
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Gdalwarp resolution



Hey folks, 

I am trying to move a 800 dpi to a 300 dpi image. The src image was
created using gdal_translate to assign SRS, 4 GCP's and change from
16bit to 8bit image. Src image has the following meta_tags

Metadata: 
  AREA_OR_POINT=Area 
  TIFFTAG_XRESOLUTION=800 
  TIFFTAG_YRESOLUTION=800 
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch) 
  Area_or_Point =Area 


The command line I am using is: 

gdalwarp -tr 300 300 oA38_001.tif S_A38_001.tif 

But I get this error 

Creating output file that is 0P x 0L. 
ERROR 1: Attempt to create 0x0x1 TIFF file, but width, height and bands
must be positive. 

Any ideas? 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061122/0093a2b4/attachment.html
From neteler at itc.it  Thu Nov 23 06:00:14 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 30, Issue 54
In-Reply-To: <20061122194730.4ac53c19@localhost>
References: <200611221701.kAMH1GuR005326@duke.maptools.org>
	<20061122194730.4ac53c19@localhost>
Message-ID: <45657F3E.1040203@itc.it>

Stephan Holl wrote on 11/22/2006 07:47 PM:
> Hello Markus,
>
> On Wed, 22 Nov 2006 12:01:16 -0500 gdal-dev-request@lists.maptools.org
> wrote:
>
>   
>> 2. Switching LOCALE:
>>
>> GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export
>> LANGUAGE=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
>> export LANG=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
>> export LC_ALL=en_US 
>>     
>
> Have your tried just to export LC_NUMERIC=C and import afterwards?
>
> I *could* imagine that this might break something about the decimal
> delimiter?!
>
> Just a guess.
>   

Well, my scope in general is not to switch the LOCALE (but to be able to
use whatever settings). GDAL should operate LOCALE independent.
I am not sure if this is a GDAL or gcc 4.x problem.

> I thought Bernhard told me that he has filed a bug against a similar
> issue, but I cannot recheck because the bugzilla is dead somehow ATM.
>   
I observed the same with the GDAL bugtracker
http://bugzilla.remotesensing.org:
"Bugzilla has suffered an internal error..."

thanks
Markus

From dron at ak4719.spb.edu  Thu Nov 23 06:01:50 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061122155454.GA10564@bartok.itc.it>
References: <20061122155454.GA10564@bartok.itc.it>
Message-ID: <20061123110150.GA9121@ak4719.spb.edu>

On Wed, Nov 22, 2006 at 04:54:54PM +0100, Markus Neteler wrote:
> after a new installation of Mandriva 2007 I found some fancy bug (or
> whatever), apparently related to the LOCALE:

Markus,

I think it is related to decimal point problem. It seems that De locale
uses comma as a decimal delimiter:

$ LC_NUMERIC=de_DE locale -k LC_NUMERIC
decimal_point=","
thousands_sep="."
grouping=3;3
numeric-decimal-point-wc=44
numeric-thousands-sep-wc=46
numeric-codeset="ISO-8859-1"

There are many atof() calls spreaded around in OGR core and in drivers
and I am a bit hesitant to convert all of them to CPLAtof() which is
locale independent. Could you upload your shape file somewhere? Probably
it will be enough to change atof() in the shape driver only. Also it is
starnge thar OGR is not resistant to this kind of problem, probably we
have different isssue here.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mirhassanali at gmail.com  Thu Nov 23 07:19:25 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Creating map using MapScript
Message-ID: <b41d86b30611230419la815e19j8a49986208c9b964@mail.gmail.com>

Hi

I am creating a map image using the C Sharp wrapper for MapScript using the
following code


m_obj.setExtent(minX,minY,maxX,maxY);

imageObj i_obj = m_obj.draw();

Is there any way that I can add a marker(something like a red dot etc) for
the point (x, y) on the generated map image. Point (x, y) will be the centre
of the image.

Best Regards

Mir
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061123/c14e8d8f/attachment.html
From dsampson at NRCan.gc.ca  Thu Nov 23 08:11:08 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp resolution
In-Reply-To: <45647101.8050100@pobox.com>
Message-ID: <2FAA57395C1F914DB27CAA4C376058F201271826@S0-OTT-X2.nrn.nrcan.gc.ca>

Could the following message be related to my issue. It would make sense
since the GCP's seem to disapear.

[Gdal-dev] gdal does not write gcp projection

Just a thought

Cheers

 

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: November 22, 2006 10:47
To: Sampson, David
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Gdalwarp resolution

Sampson, David wrote:
> Hey folks,
> 
> I am trying to move a 800 dpi to a 300 dpi image. The src image was 
> created using gdal_translate to assign SRS, 4 GCP's and change from 
> 16bit to 8bit image. Src image has the following meta_tags
> 
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_XRESOLUTION=800
>   TIFFTAG_YRESOLUTION=800
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>   Area_or_Point =Area
> 
> 
> The command line I am using is:
> 
> gdalwarp -tr 300 300 oA38_001.tif S_A38_001.tif
> 
> But I get this error
> 
> Creating output file that is 0P x 0L.
> ERROR 1: Attempt to create 0x0x1 TIFF file, but width, height and 
> bands must be positive.

Dave,

The "dpi printing resolution" information kept in some TIFF files is
completely disconnected from the georeferencing model of GDAL.  So the
-tr flag to gdalwarp is about setting the resolution in the geo
coordinate system of the image, but this image likely has none.

If you just want to downsample the image, you could try:

  gdal_translate -outsize 37.5% 37.5% in.tif out.tif

If you also want to override the resolution metadata tags (possibly
necessary to make printing software print properly) try:

  gdal_translate -outsize 37.5% 37.5% \
      -mo TIFFTAG_XRESOLUTION=300 -mo TIFFTAG_YRESOLUTION=300 \
      in.tif out.tif

Best regards,
-------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org



From Jukka.Rahkonen at mmmtike.fi  Thu Nov 23 09:39:14 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
Message-ID: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>

Hi,
 
I have noticed that there is quite a big difference between using ECW and JPEG2000 format images through GDAL and MapServer path.  While I could get in a quite well controlled test some 120 images per minute ripped out from  ECW layer it was just 80 image per minute from JPEG2000 layer with JP2ECW driver and miserly 25 images/min with JP2KAK driver.
I wonder if there is any chance to improve the JPEG2000 even close to ECW efficiency?  Slow results with JP2KAK driver is propably due to not so optimal implementation, but is there some explanation for the difference between ECW and JPEG2000 with the ER Mapper driver?
I do know the great variety in how JPEG2000 files can be written. My images are created with the normal Kakadu recipe, RPCL progression order, lossless, without tiles but with precincts etc.  If someone could suggest most suitable compression options for JP2ECW driver I am willing to do a quick test and report about the results.
For us this has practical meaning because we archive images as lossless and therefore we need to use JPEG2000.  Images in everyday use are in TIF format but every now and then we need the archived images as well.
 
Regards,
 
-Jukka Rahkonen-


From dron at ak4719.spb.edu  Thu Nov 23 09:49:25 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <1164224317.32483.23.camel@selva.sr.unh.edu>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
Message-ID: <20061123144925.GB9121@ak4719.spb.edu>

Stephen,

On Wed, Nov 22, 2006 at 02:38:37PM -0500, Stephen Hagen wrote:
> I'm trying to reproject raw MODIS data (MOD09A1 Level 3 reflectance data
> in HDF-EOS format) from its original SINUSOIDAL projection to UTM using
> gdal in FWTools. I have encountered several problems. And I need help. I
> put the hdf file that I am working with here: 
> 
> 1) gdalinfo does not recognize the projection information in the MOD09A1
> hdf file:
> 
> 
> $>gdalinfo MOD09A1.A2001289.h08v05.004.2003162200605.hdf
> 
> 
> Driver: HDF4/Hierarchical Data Format Release 4
> Size is 512, 512
> Coordinate System is `'

That is right. HDF file is just container for several different images,
so it is pointless to report size or projection info for the main HDF
dataset.

> 2. gdalinfo does not recognize the sub data set projection information
> either:
> 
> $>gdalinfo HDF4_SDS:UNKNOWN:"MOD09A1.A2001289.h08v05.004.2003162200605.
> hdf":0
> 
> Driver: HDF4Image/HDF4 Dataset
> Size is 2400, 2400
> Coordinate System is `'.....
> Corner Coordinates:
> Upper Left ( 0.0, 0.0)
> Lower Left ( 0.0, 2400.0)
> Upper Right ( 2400.0, 0.0)
> Lower Right ( 2400.0, 2400.0)
> Center ( 1200.0, 1200.0)
> 
> Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
> Offset: -0, Scale:0.0001

That is fixed now in CVS. Your dataset does not contain "HDFEOSVersion"
metadata record, which is used by GDAL to deduce whether we have HDF-EOS
or just plain HDF file. I added more logic to guess HDF-EOS variants.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From gbourel at ago.fr  Thu Nov 23 10:45:03 2006
From: gbourel at ago.fr (Guillaume Bourel)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDALWarpOptions - Destination dataset issue
In-Reply-To: <45646BD6.2060208@pobox.com>
References: <200611211702.kALH2THh020499@duke.maptools.org>
	<45645A81.3020001@ago.fr> <45646BD6.2060208@pobox.com>
Message-ID: <4565C1FF.10702@ago.fr>

Frank Warmerdam wrote :
> Guillaume Bourel wrote:
>> Hi,
>>
>> I am currently trying to warp GeoTiff data with any geographic 
>> coordinate system into WGS84 with Mercator projection, within a C++ 
>> project.
>>
>> I do believe this should be done by using GDALWarpRegionToBuffer, 
>> which needs a GDALWarpOperation, which, itself, needs a GDALWarpOptions.
>>
>>
>> GDALWarpOptions reference explains :
>>
>>    GDALDatasetH GDALWarpOptions::hDstDS
>>    <http://gdal.maptools.org/structGDALWarpOptions.html#o5>
>>    Destination image dataset - may be NULL if only using
>>    GDALWarpOperation::WarpRegionToBuffer()
>>    <http://gdal.maptools.org/classGDALWarpOperation.html#a7>.
>>
>> but GDALWarpOperation::Initialize or GDALCreateWarpOperation both 
>> returns CE_Failure, if hDstDS is set to NULL
>> (behavior due to ValidateOptions() call, which checks hDstDS isn't 
>> NULL). Therefore, creation of the GDALWarpOperation fails.
>> And, as I don't have any destination file, my destination dataset is 
>> NULL.
>>
>> I don't understand what I'm doing wrong,
>> if someone could explain me the way I should follow to successfully 
>> create a GDALWarpOperation in order to use it with 
>> GDALWarpRegionToBuffer.
>
> Guillaume,
>
> It appears that support for null hDstDS has "rotted" through disuse.  I
> have made a few changes to the Validate() method that I hope will fix the
> problem, but I currently have no uses for this style of use of the warper
> so it is hard for me to check.  Can you grab the latest from CVS and
> see if this helps?
>
> Best regards,

Thanks a lot Frank,

I've made an update from CVS this morning and everything is now working 
well.

Guillaume.

-- 
BOUREL Guillaume - ATLANTIDE
consultant
Tel. : +33 (0)2 98 05 43 21
http://www.ago.fr/
--
Technop?le Brest Iroise
Site du Vernis - CS 23866
29238 Brest Cedex 3 - France
Tel. : +33 (0)2 98 05 43 21
Fax. : +33 (0)2 98 05 20 34
e-mail: atlantide-brest@ago.fr


From John.C.Cartwright at noaa.gov  Thu Nov 23 14:06:17 2006
From: John.C.Cartwright at noaa.gov (John.C.Cartwright@noaa.gov)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] support for Oracle GeoRaster?
Message-ID: <ad1efaf7e0.af7e0ad1ef@noaa.gov>

Hello All,

anyone know of support for Oracle's GeoRaster format in gdal?  I didn't
see it on the list.

Thanks!

--john
 

From neteler at itc.it  Thu Nov 23 15:49:32 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061123110150.GA9121@ak4719.spb.edu>
References: <20061122155454.GA10564@bartok.itc.it>
	<20061123110150.GA9121@ak4719.spb.edu>
Message-ID: <20061123204932.GC6312@bartok.itc.it>

Andrey,

On Thu, Nov 23, 2006 at 02:01:50PM +0300, Andrey Kiselev wrote:
> On Wed, Nov 22, 2006 at 04:54:54PM +0100, Markus Neteler wrote:
> > after a new installation of Mandriva 2007 I found some fancy bug (or
> > whatever), apparently related to the LOCALE:
> 
> Markus,
> 
> I think it is related to decimal point problem. It seems that De locale
> uses comma as a decimal delimiter:

yes, that's right.
 
> $ LC_NUMERIC=de_DE locale -k LC_NUMERIC
> decimal_point=","
> thousands_sep="."
> grouping=3;3
> numeric-decimal-point-wc=44
> numeric-thousands-sep-wc=46
> numeric-codeset="ISO-8859-1"
> 
> There are many atof() calls spreaded around in OGR core and in drivers
> and I am a bit hesitant to convert all of them to CPLAtof() which is
> locale independent. Could you upload your shape file somewhere?

Sure:
http://mpa.itc.it/markus/tmp/ogr/

> Probably
> it will be enough to change atof() in the shape driver only. Also it is
> starnge thar OGR is not resistant to this kind of problem, probably we
> have different isssue here.

The strange part is that I am using the DE locale for years on my
laptop. Only, after the recent new installation (disk change) I have
found this problem.

It seems to stumble over this "delete this" lines (whatever they do).

Best regards,
Markus


From szekerest at gmail.com  Thu Nov 23 18:05:11 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] C# ExportToWKB support
Message-ID: <f3b73b7d0611231505p7a136344o4bb978e7ee984ea1@mail.gmail.com>

Hi,

I've just added support for C# ExportToWKB. The following prototypes
were added to the Geometry class:

public int ExportToWkb(int bufLen, IntPtr buffer, int byte_order);
public int ExportToWkb( byte[] buffer, int byte_order );
public int ExportToWkb( byte[] buffer );

The latter internally uses ogr.wkbXDR as the byte_order.

I've also added a test sample (wkt2wkb) to test the conversion between
the wkt and the wkb representation.

It would be appreciated is someone confirmed me whether the resulting
wkb is correct.


Thanks,

Tamas Szekeres

From hobu at iastate.edu  Thu Nov 23 21:13:50 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] support for Oracle GeoRaster?
In-Reply-To: <ad1efaf7e0.af7e0ad1ef@noaa.gov>
References: <ad1efaf7e0.af7e0ad1ef@noaa.gov>
Message-ID: <F99C2AC4-2376-4B5D-8350-9EB795FC2A85@iastate.edu>

This is not available, but there has been some interest. However, no  
proposal to incorporate it into GDAL has yet been written AFAIK.  Its  
development would like require direct sponsorship of someone to do  
so, as it would be quite a task.

Howard

On Nov 23, 2006, at 1:06 PM, John.C.Cartwright@noaa.gov wrote:

> Hello All,
>
> anyone know of support for Oracle's GeoRaster format in gdal?  I  
> didn't
> see it on the list.
>
> Thanks!
>
> --john
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


From tflynch at gmail.com  Fri Nov 24 02:11:07 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
Message-ID: <c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>

On 11/24/06, Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi> wrote:
> Hi,
>
> I have noticed that there is quite a big difference between using ECW and JPEG2000 format images through GDAL and MapServer path.  While I could get in a quite well controlled test some 120 images per minute ripped out from  ECW layer it was just 80 image per minute from JPEG2000 layer with JP2ECW driver and miserly 25 images/min with JP2KAK driver.
> I wonder if there is any chance to improve the JPEG2000 even close to ECW efficiency?  Slow results with JP2KAK driver is propably due to not so optimal implementation, but is there some explanation for the difference between ECW and JPEG2000 with the ER Mapper driver?

Hi Jukka,

The performance difference you observe between ECW and JPEG 2000 with
the JP2ECW driver is a consequence of the differences between the
formats and our implementations of their codecs.  We're actively
trying to improve performance on both sides of the equation but the
additional flexibility of JPEG 2000, and the computational cost of its
decoder do impose an additional overhead.  Further effort into JPEG
2000 decoder optimisation is producing diminishing returns as we
continue.

Also, if you're working on a platform other than Windows there are
still some hardware-based optimisations for JPEG 2000 (SSE stuff) that
don't make it into the build.

The default compression settings for the GDAL JP2ECW driver in the
absence of other options specified are those of the underlying ECW
JPEG 2000 SDK itself - RPCL progression order, no tiles, precinct size
determined as a function of dataset dimension.  These should be pretty
much optimal for GIS-interactive usage pattern of the data, so there
may not be much room for improvement here either.

Regards

Tom Lynch
ER Mapper

From nicky666 at gmail.com  Fri Nov 24 05:22:14 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp and memory optimization
Message-ID: <28de5e310611240222v6557bfb8oaceea7b6e90f75d8@mail.gmail.com>

Hi all,

I'm warping several big tiff images to produce images for each
canadian provinces with the gdalwarp utility.

The complete process takes about 8 hours (warping image, cutting the
result in small JPEG tiles)

During the warp process, neither the CPU nor the memory are increasing a lot.
(1 Gb memory on centrino 1.6 ghz, Ubuntu Edgy).

Is there a way to tell gdalwarp to take more memory to work ?
I see the -wo option, but can't find an option related to memory.

In the GDAL warp api tutorial, there is a
GDALWarpOptions::dfWarpMemoryLimit option.
Can I use the same kind of option in the command line ?

Thanx
Nicolas

From nhv at cape.com  Fri Nov 24 05:41:59 2006
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp and memory optimization
In-Reply-To: <28de5e310611240222v6557bfb8oaceea7b6e90f75d8@mail.gmail.com>
Message-ID: <200611241042.kAOAfxu4025098@smtp11.cape.com>

Nicolas Ribot writes:
> 
> 
> Is there a way to tell gdalwarp to take more memory to work ?
> I see the -wo option, but can't find an option related to memory.
> 
> In the GDAL warp api tutorial, there is a 
> GDALWarpOptions::dfWarpMemoryLimit option.
> Can I use the same kind of option in the command line ?

http://www.gdal.org/gdalwarp.html

-wm memory_in_mb:
    Set the amount of memory (in megabytes) that the warp API is allowed to
use for caching.

HTH

Norman


From nicky666 at gmail.com  Fri Nov 24 06:28:22 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp and memory optimization
In-Reply-To: <200611241042.kAOAfxu4025098@smtp11.cape.com>
References: <28de5e310611240222v6557bfb8oaceea7b6e90f75d8@mail.gmail.com>
	<200611241042.kAOAfxu4025098@smtp11.cape.com>
Message-ID: <28de5e310611240328o4a327082pa16334d9dddb24b0@mail.gmail.com>

> -wm memory_in_mb:
>     Set the amount of memory (in megabytes) that the warp API is allowed to
> use for caching.
>

Doh !
I must be really tired !
This option is clearly indicated in the documentation page...

Sorry for the noise and thanx for your prompt reply.

Nicolas.

From mirhassanali at gmail.com  Fri Nov 24 07:46:57 2006
From: mirhassanali at gmail.com (Mir Hassan Ali)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL licensing
Message-ID: <b41d86b30611240446q28c971d4kc0f92435ebbf8fad@mail.gmail.com>

Hi

If I am using GDAL C# wrappers and MapScript C# wrappers in my application
then what will be the licensing issues? Do I need to make my application
open source?

Best Regards

Mir Hassan Ali
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061124/506b5678/attachment.html
From dpinte at itae.be  Fri Nov 24 09:22:25 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061123204932.GC6312@bartok.itc.it>
References: <20061122155454.GA10564@bartok.itc.it>
	<20061123110150.GA9121@ak4719.spb.edu>
	<20061123204932.GC6312@bartok.itc.it>
Message-ID: <1164378145.5652.4.camel@geru-itae>

Skipped content of type multipart/mixed-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061124/66f3e0fa/attachment.bin
From dpinte at itae.be  Fri Nov 24 09:29:27 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <1157365525.23753.33.camel@geru-itae>
References: <1157365525.23753.33.camel@geru-itae>
Message-ID: <1164378567.5652.7.camel@geru-itae>

Le lundi 04 septembre 2006 ? 12:25 +0200, Didrik Pinte a ?crit :
> Hi,
> 
> Since the update of my debian package to the latest python-gdal bindings
> (1.3.2-2). I have the following problem when reading features from a
> shapefile :
> 
> ERROR 1: GEOSException: ParseException: Expected number but encountered
> ','
> 
> when my code calling :
> 
> found = gbuffer.is_disjoint(geometry)
> 
> or
> 
> intersection = gbuffer.intersect(geometry)
> 
> I have googled a bit about the problem but found nothing. The libgdal1
> is linked with geos 2.2.1-1 (that did not change since January 2006
> according to the changelog). I suppose there was a change on the ogr
> part. 
> 
> Any hint to solve the problem ?

... 

Problem is solved using a locale with a point as decimal delimiter.

Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061124/0e50806b/attachment.bin
From dron at ak4719.spb.edu  Fri Nov 24 10:43:35 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061122155454.GA10564@bartok.itc.it>
References: <20061122155454.GA10564@bartok.itc.it>
Message-ID: <20061124154335.GA28777@ak4719.spb.edu>

On Wed, Nov 22, 2006 at 04:54:54PM +0100, Markus Neteler wrote:
> after a new installation of Mandriva 2007 I found some fancy bug (or
> whatever), apparently related to the LOCALE:

Markus,

I have tried to reproduce your problem without success. Also I read your
message more carefully and have few notes.

> 1. DE LOCALE:
> 
> GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
> WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
>          ?berschrieben.

The message above is localized, so the process printing that message
calls setlocale() function.

> A datum name etrs89 (European_Terrestrial_Reference_System_1989) was specified without transformation parameters.
> Note that the GRASS default for etrs89 is towgs84=0.000,0.000,0.000.

These messages are not localized, so the process which prints them
either does not call setlocale() or these messages just do not
translated. It looks like the former is right, because numbers in
towgs84 list are dot delimited. In De locale they should be comma
delimited.

> Die Projektionsinformationen des Eingabedatensatzes und der aktuellen Location stimmen ?berein.
> Fahre mit dem Import fort...
> WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
>          ?berschrieben.
> Layer: europe_countries_LAEA
> WARNUNG: Spaltenname 'cat' wurde in 'cat_' ge?ndert.
> Importiere 3356 Objekte der Karte...
> Speicherzugriffsfehler

This is localized again.

Actually I do not understand why you have a mix of localized and
non-localized processes here. My own GRASS build (6.3cvs) does not
localized at all, I have EN messages in any locale (probably I should
build GRASS with some option enabled?).

So I am lost here. Markus, do you have any clues on this?

Best regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517

From warmerdam at pobox.com  Fri Nov 24 10:49:54 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL licensing
In-Reply-To: <b41d86b30611240446q28c971d4kc0f92435ebbf8fad@mail.gmail.com>
References: <b41d86b30611240446q28c971d4kc0f92435ebbf8fad@mail.gmail.com>
Message-ID: <456714A2.9060303@pobox.com>

Mir Hassan Ali wrote:
> Hi
>  
> If I am using GDAL C# wrappers and MapScript C# wrappers in my 
> application then what will be the licensing issues? Do I need to make my 
> application open source?

Mir,

No.  MapServer and GDAL are under an MIT/X style license that allows for
building proprietary applications on top of them.  I am not aware of any
special licensing for the c# wrappers, so you should be fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Fri Nov 24 10:49:55 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Problem Building GDAL for Windows CE using EVC++ 4.0
In-Reply-To: <20061118120401.98652.qmail@web52209.mail.yahoo.com>
References: <20061118120401.98652.qmail@web52209.mail.yahoo.com>
Message-ID: <456714A3.7070508@loskot.net>

kiruba nantham wrote:
> Hello Friends,
>              I am trying to build gdal-cvs-2006.11.16 using *embedded
> c++ 4.0* for Windows CE. I am able to build the *gdalce_evc4d.dll
> *without any errors. But it is throwing around 160 warnings and also it
> is not working in my device.
> Warnings are:
> *Warning C4275*: non dll-interface class 'std::basic_string<char,struct
> std::char_traits<char>, class std::allocator<char> >' used as base for
> dll-interface class 'CPLString'

1. It's highly recommended to use STLport instead of STL from eVC++, if
you are building using eVC++.
2. This warning can be safely ignored

> *                            -This Warning at cpl_string.h( Line - 211)
> **Warning C4530*: C++ exception handler used, but unwind semantics are
> not enabled.     Specify ?GX
>                             -*This Warning at xstring( Line - 724)*
>       and also Only in these two Warnings are repeating.

You need to apply patch to your eVC++, please follow these guidelines:

http://support.microsoft.com/kb/830482


> Linker Warnings Are:
>       mitab_feature.obj : warning LNK1166: cannot adjust code at 
>                    offset=0x00001000, rva=0x0001C7DC.
>       mitab_feature_mif.obj : warning LNK1166: cannot adjust code at
>                    offset=0x00001000, rva=0x000326C0.
>       ogr_srs_proj4.obj : warning LNK1166: cannot adjust code at 
>                    offset=0x00001000, rva=0x000947D0.
>       ogrspatialreference.obj : warning LNK1166: cannot adjust code at
>                    offset=0x00001000, rva=0x000C5794.

These warnings can be safely ignored.

>       If I run this form command prompt it is not building the DLL and
> its Shows this error.
> Error is:
>        fatal error LNK1112: module machine type ?X86? conflicts with target
>                                      machine type ?ARM?*.

I don't know what you're trying to run on what machine, but this message
clearly says there is mismatch of target platform of the binary and
actual platform.

Probably, you use incorrect SDK.

Note, in README there is a step for makefile.vc:

2. Run configuration script for ARM target.

that suggests only ARM platform is supported.

I've never used emulator with eVC++ 4.0 because it is x86 instead of
real ARM emulator. Project files are not prepared for emulator target.
So, I can't help you with using emulator with eVC++ 4.0.

I appologize if README file and instructions are not clear enough.
I will update it for GDAL 1.4.0 release.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Fri Nov 24 10:59:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] Gdalwarp and memory optimization
In-Reply-To: <28de5e310611240328o4a327082pa16334d9dddb24b0@mail.gmail.com>
References: <28de5e310611240222v6557bfb8oaceea7b6e90f75d8@mail.gmail.com>
	<200611241042.kAOAfxu4025098@smtp11.cape.com>
	<28de5e310611240328o4a327082pa16334d9dddb24b0@mail.gmail.com>
Message-ID: <456716E4.9020007@pobox.com>

Nicolas Ribot wrote:
>> -wm memory_in_mb:
>>     Set the amount of memory (in megabytes) that the warp API is 
>> allowed to
>> use for caching.
>>
> 
> Doh !
> I must be really tired !
> This option is clearly indicated in the documentation page...
> 
> Sorry for the noise and thanx for your prompt reply.

Nicolas,

I would also note that setting the GDAL_CACHEMAX parameter higher
can be helpful.  The -wm flag sets the amount of memory used for the
big working buffers (the chunks) when warping.  But down within GDAL
itself the format drivers use a block cache which comes from a seperate
memory pool controlled by GDAL_CACHEMAX.   So on a 1GB system you might
do something like:

   gdalwarp -wm 400 --config GDAL_CACHEMAX 150 ...

This would allocate up to 550MB of RAM between the warping chunk arrays
and the generic cache.  In fact, GDAL_CACHEMAX can also be set as an
environment variable.  And I'd encourage folks with lots of RAM to set
this in their environment normally.   The default small cachesize can
kill performance in some fairly common situations with large files
(such as gdal_translate conversions between line oriented and tiled files).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From woklist at kyngchaos.com  Fri Nov 24 12:21:37 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:29 2007
Subject: [Gdal-dev] GDAL Xcode project
Message-ID: <044120AC-97D8-436D-AE7D-6D4FD28A7830@kyngchaos.com>

I finished a GDAL Xcode project, available for download on my site.   
This is an alternative to the new framework build option in CVS.

It's much easier to package the framework this way - the build name  
doesn't have to go thru libtool, and thus have to be changed at  
install, and the folder structure is all automatic.

It's also possible to do a Universal build without fuss.  The  
configure method would need fussing with the libtool configuration or  
using other workarounds to get both architectures.  In Xcode it's  
automatic.  Though it does still need a cpl_config.h patch to switch  
endians on the fly (included in the project).

There are sub-projects included to deal with optional formats that  
need external libraries.  You should be able to drop all the sources  
(GDAL and deps) into the project and easily build a full-featured,  
Universal GDAL framework.

See the readme for details.  Note that configuration is manual, but  
hopefully easy to understand.  You just change build Settings at the  
project level for versions, and prefixes for a few dependencies I  
decided didn't belong as sub-projects.


There is also a PROJ framework available.  It also takes care of  
Universal build and packaging issues.


-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

First Pogril: Why is life like sticking your head in a bucket filled  
with hyena offal?
Second Pogril: I don't know.  Why IS life like sticking your head in  
a bucket filled with hyena offal?
First Pogril: I don't know either.  Wretched, isn't it?

-HitchHiker's Guide to the Galaxy



From neteler at itc.it  Fri Nov 24 12:41:17 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061124154335.GA28777@ak4719.spb.edu>
References: <20061122155454.GA10564@bartok.itc.it>
	<20061124154335.GA28777@ak4719.spb.edu>
Message-ID: <20061124174117.GA31278@bartok.itc.it>

Andrey,

On Fri, Nov 24, 2006 at 06:43:35PM +0300, Andrey Kiselev wrote:
> On Wed, Nov 22, 2006 at 04:54:54PM +0100, Markus Neteler wrote:
> > after a new installation of Mandriva 2007 I found some fancy bug (or
> > whatever), apparently related to the LOCALE:
> 
> Markus,
> 
> I have tried to reproduce your problem without success. Also I read your
> message more carefully and have few notes.
> 
> > 1. DE LOCALE:
> > 
> > GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
> > WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
> >          ?berschrieben.
> 
> The message above is localized, so the process printing that message
> calls setlocale() function.
> 
> > A datum name etrs89 (European_Terrestrial_Reference_System_1989) was specified without transformation parameters.
> > Note that the GRASS default for etrs89 is towgs84=0.000,0.000,0.000.
> 
> These messages are not localized, so the process which prints them
> either does not call setlocale() or these messages just do not
> translated. It looks like the former is right, because numbers in
> towgs84 list are dot delimited. In De locale they should be comma
> delimited.

In GRASS, we are in a transition of changing all relevant fprintf(stdXXX,"...")
to G_message(_("...")) with gettext macro. In the case of the
datum message it's still the old fprintf() without macro.
 
> > Die Projektionsinformationen des Eingabedatensatzes und der aktuellen Location stimmen ?berein.
> > Fahre mit dem Import fort...
> > WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
> >          ?berschrieben.
> > Layer: europe_countries_LAEA
> > WARNUNG: Spaltenname 'cat' wurde in 'cat_' ge?ndert.
> > Importiere 3356 Objekte der Karte...
> > Speicherzugriffsfehler
> 
> This is localized again.

Right.

> Actually I do not understand why you have a mix of localized and
> non-localized processes here.

Sorry for that confusion. It is because we are only half through
with changing all messages to gettext macros. Since GRASS is
huge this is a long lasting task.

> My own GRASS build (6.3cvs) does not
> localized at all, I have EN messages in any locale (probably I should
> build GRASS with some option enabled?).

Yes, you need to 'make distclean' and 
 ./configure --with-nls ...
to activate the language support.

Best regards,
Markus

From szekerest at gmail.com  Fri Nov 24 13:09:58 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL licensing
In-Reply-To: <456714A2.9060303@pobox.com>
References: <b41d86b30611240446q28c971d4kc0f92435ebbf8fad@mail.gmail.com>
	<456714A2.9060303@pobox.com>
Message-ID: <f3b73b7d0611241009w3fa24b75rb96e51c76968845b@mail.gmail.com>

I don't think if SWIG would determine how the generated wrappers are
licensed. Therefore I think the wrappers will inherit the license
style of the underlying project that is: MIT/X.
(http://www.opensource.org/licenses/mit-license)

Best Regards,

Tamas


2006/11/24, Frank Warmerdam <warmerdam@pobox.com>:
> Mir Hassan Ali wrote:
> > Hi
> >
> > If I am using GDAL C# wrappers and MapScript C# wrappers in my
> > application then what will be the licensing issues? Do I need to make my
> > application open source?
>
> Mir,
>
> No.  MapServer and GDAL are under an MIT/X style license that allows for
> building proprietary applications on top of them.  I am not aware of any
> special licensing for the c# wrappers, so you should be fine.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From dsampson at NRCan.gc.ca  Fri Nov 24 13:22:37 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Gdalwarp resolution
In-Reply-To: <45647101.8050100@pobox.com>
Message-ID: <2FAA57395C1F914DB27CAA4C376058F201271C66@S0-OTT-X2.nrn.nrcan.gc.ca>

Hey list,

Just trying to tighten up my GDAL command line calls.

The -outsize option noted bellow changes the size and geographic
position of the image. The upper left corner locks into the right place,
but the smaller image produced by the -outsize option is then no longer
geo-refed on the other three points.

This is my solution so far.

gdal_translate -gcp 378.19 196.43 -76.777261  45.67899 -gcp 6013.13
282.36 -76.744739  45.678655 -gcp 5890.36 7565.55 -76.745361  45.649344
-gcp 290.14 7492.18 -76.777866  45.649679 -scale  -ot byte  -a_srs
epsg:4326 -mo "Area_or_Point = Area"  A38_001.tif .\work\iA38_001.tif

then

gdalwarp -tr 0.0000116774 -0.0000082992 -s_srs epsg:4326 -t_srs
epsg:4326 .\work\iA38_001.tif .\gdal_geo\oA38_001.tif


Has the bug with geo-referencing using GCP's been fixed that was
reported as a bug in the following message?


It would be great if the -outsize % % option worked and kept the
geograhic co-ordinates of all four corners.

Has this approach actualy worked for anyone georeferencing images using
FWTools Windows v 1.0.7 or v 1.0.9?  It uses gdal 1.3.2 I believe, which
is connected to the bug report listed bellow.



===============
[Gdal-dev] gdal does not write gcp projection
Vincent Schut schut at sarvision.nl
Tue Nov 14 04:36:43 EST 2006

    * Previous message: [Gdal-dev] swig/python/setup.py
    * Next message: [Gdal-dev] GeoQuadTree - an open format for storing
georeferenced images
    * Messages sorted by: [ date ] [ thread ] [ subject ] [ author ]

Hi Frank, list,

I just filed a bug report 
(http://bugzilla.remotesensing.org/show_bug.cgi?id=1354) on an issue 
we're running into since gdal 1.3.2: when creating a geotiff file with 
gcp's, the gcp projection is not written to the file. In 1.3.1 this was 
working correctly, but in 1.3.2 and cvs from today it is not.

See the bug report for a simple python test case.

Cheers,
Vincent.
===============
 

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: November 22, 2006 10:47
To: Sampson, David
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Gdalwarp resolution

Sampson, David wrote:
> Hey folks,
> 
> I am trying to move a 800 dpi to a 300 dpi image. The src image was 
> created using gdal_translate to assign SRS, 4 GCP's and change from 
> 16bit to 8bit image. Src image has the following meta_tags
> 
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_XRESOLUTION=800
>   TIFFTAG_YRESOLUTION=800
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>   Area_or_Point =Area
> 
> 
> The command line I am using is:
> 
> gdalwarp -tr 300 300 oA38_001.tif S_A38_001.tif
> 
> But I get this error
> 
> Creating output file that is 0P x 0L.
> ERROR 1: Attempt to create 0x0x1 TIFF file, but width, height and 
> bands must be positive.

Dave,

The "dpi printing resolution" information kept in some TIFF files is
completely disconnected from the georeferencing model of GDAL.  So the
-tr flag to gdalwarp is about setting the resolution in the geo
coordinate system of the image, but this image likely has none.

If you just want to downsample the image, you could try:

  gdal_translate -outsize 37.5% 37.5% in.tif out.tif

If you also want to override the resolution metadata tags (possibly
necessary to make printing software print properly) try:

  gdal_translate -outsize 37.5% 37.5% \
      -mo TIFFTAG_XRESOLUTION=300 -mo TIFFTAG_YRESOLUTION=300 \
      in.tif out.tif

Best regards,
-------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org



From bthoen at gisnet.com  Fri Nov 24 16:38:11 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
Message-ID: <20061124213811.GA16816@www.gisnet.com>

Ogr2ogr doesn't appear to work correctly for MapInfo output. I have a
PostGIS table of polygons, but when I issue the following:

ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial1" -sql "select
the_geom, id, gridcode from adams_v1 where gridcode=72 limit 50"

I get a MapInfo table with 50 records, but no map features. When I dump
this same selection as a shape file, the associated polygons come through
just fine. So, is this a known bug? Is there a newer version of GDAL since
1.3.2? Can I get a newer version of just ogr2ogr? 

Any help would be appreciated!

- Bill Thoen


From warmerdam at pobox.com  Fri Nov 24 18:13:05 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] FWTools 1.1.0 Released
Message-ID: <45677C81.1010202@pobox.com>

Folks,

I have prepared new FWTools 1.1.0 binaries for linux and win32.  The
windows binaries are up to date, but the configuration is essentially
unchanged.

The Linux version includes the addition of Postgres support in OGR, and
SOS Server support in MapServer.  I also rebuilt a bunch of the libraries
that previous had debug info (unrealized by me) so the whole release tar.gz
is quite a bit smaller.

This release also includes he new, experimental, PDS (Planetary Data) format
support.   We can also think of it as a sort of "alpha" release for GDAL.
So testing is appreciated leading up to the GDAL 1.4.0 release.

   http://www.gdal.org/dl/fwtools/FWTools110.exe
   http://www.gdal.org/dl/fwtools/FWTools-linux-1.1.0.tar.gz

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Nov 24 18:51:45 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <20061124213811.GA16816@www.gisnet.com>
References: <20061124213811.GA16816@www.gisnet.com>
Message-ID: <45678591.8020704@pobox.com>

Bill Thoen wrote:
> Ogr2ogr doesn't appear to work correctly for MapInfo output. I have a
> PostGIS table of polygons, but when I issue the following:
> 
> ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial1" -sql "select
> the_geom, id, gridcode from adams_v1 where gridcode=72 limit 50"
> 
> I get a MapInfo table with 50 records, but no map features. When I dump
> this same selection as a shape file, the associated polygons come through
> just fine. So, is this a known bug? Is there a newer version of GDAL since
> 1.3.2? Can I get a newer version of just ogr2ogr? 
> 
> Any help would be appreciated!

Bill,

I'm not sure why this would be happening.  Can you translate the shapefile to
a mapinfo file?  If not, then perhaps you could file a bug with the shapefile
attached as the example?

BTW, getting a new ogr2ogr executable would likely not help as I presume any
meaningful changes would be in the GDAL dll/shared library, not the mainline
executable.  You might want to try using the FWTools ogr2ogr to see if it
helps - it is built from the very latest CVS source code.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Sat Nov 25 00:29:45 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Windwos CE note
Message-ID: <4567D4C9.1030600@loskot.net>

Hi,

To all of Windows CE port users.
Currently, in the CVS, GDAL port for Windows CE is not compilable due to
latest changes.
I have it fixed partially but some features are still missing.
Everything will be working well back for GDAL 1.4.0.
Also new features and GDAL drivers will be included.

So, please wait with testing and using GDAL port for Windows CE
till next release GDAL 1.4.0, in the middle of December.

I appologize for inconvenience and thanks for your patience!

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From neteler at itc.it  Sat Nov 25 05:31:09 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Re: Gdal-dev Digest, Vol 30, Issue 54
In-Reply-To: <20061122194730.4ac53c19@localhost>
References: <200611221701.kAMH1GuR005326@duke.maptools.org>
	<20061122194730.4ac53c19@localhost>
Message-ID: <20061125103109.GA16939@bartok.itc.it>

On Wed, Nov 22, 2006 at 07:47:30PM +0100, Stephan Holl wrote:
> Hello Markus,
> 
> On Wed, 22 Nov 2006 12:01:16 -0500 gdal-dev-request@lists.maptools.org
> wrote:
> 
> > 2. Switching LOCALE:
> > 
> > GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape > export
> > LANGUAGE=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
> > export LANG=en_US GRASS 6.3.cvs (eu_laea):~/data/vmap0_europe_shape >
> > export LC_ALL=en_US 
> 
> Have your tried just to export LC_NUMERIC=C and import afterwards?
> 
> I *could* imagine that this might break something about the decimal
> delimiter?!

Hi Stephan,

I tried:

export LC_NUMERIC=C
v.in.ogr europe_countries_LAEA.shp out=europe_countries --o
WARNUNG: Die Vektorkarte 'europe_countries' existiert bereits und wird
         ??berschrieben
...
WARNUNG: Spaltenname 'cat' wurde in 'cat_' ge??ndert.
Importiere 3356 Objekte der Karte...
Speicherzugriffsfehler


Does not help... but using
export LC_ALL=C
it works (which was not needed before my operating system update).

At least I have a 1 line workaround :-)

Markus
 

From hellik at web.de  Sat Nov 25 08:54:33 2006
From: hellik at web.de (Helmut Kudrnovsky)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr with reprojecting: DHDN to MGI Austria
Message-ID: <920811791@web.de>

hi,

i have a question about ogr2ogr from shape-file to shape-file with reprojecting (fwtools 1.0.9 on win xp).

ogr2ogr -f "ESRI Shapefile" -s_srs natura2000.prj -t_srs Austria_BMN_MGI_M31.prj target.shp source.shp

both shape-files have included a prj-file, but without an TOWGS84-parameter. 

from an earlier question on this list i have learned about the importance of the TOWGS84-parameter for a correct reprojecting. 

so i searched epsg (in C:\Programme\FWTools1.0.9\proj_lib\epsg) for the missing value; for the target-srs i found the TOWGS84-parameter and included it into the -t_srs Austria_BMN_MGI_M31.prj ( i hope in a correct way). but for the source-srs i couldn't find anything in epsg. 

my question: do i need also for the source an TOWGS84-parameter? if yes, do you have maybe a hint for me where i can find this?

-s_srs natura2000.prj

PROJCS["Germany_Zone_4",
GEOGCS["GCS_Deutsches_Hauptdreiecksnetz",
DATUM["D_Deutsches_Hauptdreiecksnetz",
SPHEROID["Bessel_1841",6377397.155,299.1528128]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",4500000.0],
PARAMETER["False_Northing",0.0],
PARAMETER["Central_Meridian",12.0],
PARAMETER["Scale_Factor",1.0],
PARAMETER["Latitude_Of_Origin",0.0],
UNIT["Meter",1.0]]

epsg source
# DHDN / Gauss-Kruger zone 4
<31468> +proj=tmerc +lat_0=0 +lon_0=12 +k=1.000000 +x_0=4500000 +y_0=0 +ellps=bessel +datum=potsdam +units=m +no_defs  <>

-t_srs Austria_BMN_MGI_M31.prj

PROJCS["Austria_BMN_MGI_M31",
GEOGCS["GCS_MGI",
DATUM["D_MGI",
SPHEROID["Bessel_1841",6377397.155,299.1528128],
TOWGS84[577.326,90.129,463.919,5.137,1.474,5.297,2.4232]],
PRIMEM["Greenwich",0.0],
UNIT["Degree",0.0174532925199433]],
PROJECTION["Transverse_Mercator"],
PARAMETER["False_Easting",450000.0],
PARAMETER["False_Northing",-5000000.0],
PARAMETER["Central_Meridian",13.33333333333333],
PARAMETER["Scale_Factor",1.0],
PARAMETER["Latitude_Of_Origin",0.0],
UNIT["Meter",1.0]]

epsg target
# MGI / M31
<31285> +proj=tmerc +lat_0=0 +lon_0=13.33333333333333 +k=1.000000 +x_0=450000 +y_0=0 +ellps=bessel +towgs84=577.326,90.129,463.919,5.137,1.474,5.297,2.4232 +units=m +no_defs  <>

with greetings from austria and thanks in advance
helli

oxoxoxoxoxoxoxoxoxoxoxoxoxoxoxoxoxo
helmut kudrnovsky
internet: www.alectoria.at
__________________________________________________________________________
Erweitern Sie FreeMail zu einem noch leistungsst?rkeren E-Mail-Postfach!		
Mehr Infos unter http://freemail.web.de/home/landingpad/?mc=021131



From bthoen at gisnet.com  Sat Nov 25 10:47:07 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <45678591.8020704@pobox.com>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
Message-ID: <20061125154707.GA20888@www.gisnet.com>

Frank,

It does appear to be a bug. When I try to create a shapefile using the same
parameters, the result appears to have no geometry associated with it. But
when I use the PostGIS dumper to create the shapefile, I get good results.

I've got samples of both results -- how do I go about filing a bug report?

If I install FWtools will it cause any issues with the Proj4 and GDAL
libraries I've already installed? Also, I'm using GEOS and Proj4 with
PostGIS, so I don't want to break anything there either.


On Fri, Nov 24, 2006 at 06:51:45PM -0500, Frank Warmerdam wrote:
> Bill Thoen wrote:
> >Ogr2ogr doesn't appear to work correctly for MapInfo output. I have a
> >PostGIS table of polygons, but when I issue the following:
> >
> >ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial1" -sql "select
> >the_geom, id, gridcode from adams_v1 where gridcode=72 limit 50"
> >
> >I get a MapInfo table with 50 records, but no map features. When I dump
> >this same selection as a shape file, the associated polygons come through
> >just fine. So, is this a known bug? Is there a newer version of GDAL since
> >1.3.2? Can I get a newer version of just ogr2ogr? 
> >
> >Any help would be appreciated!
> 
> Bill,
> 
> I'm not sure why this would be happening.  Can you translate the shapefile 
> to
> a mapinfo file?  If not, then perhaps you could file a bug with the 
> shapefile
> attached as the example?
> 
> BTW, getting a new ogr2ogr executable would likely not help as I presume any
> meaningful changes would be in the GDAL dll/shared library, not the mainline
> executable.  You might want to try using the FWTools ogr2ogr to see if it
> helps - it is built from the very latest CVS source code.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
> 

From warmerdam at pobox.com  Sat Nov 25 11:24:42 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <20061125154707.GA20888@www.gisnet.com>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
	<20061125154707.GA20888@www.gisnet.com>
Message-ID: <45686E4A.10709@pobox.com>

Bill Thoen wrote:
> Frank,
> 
> It does appear to be a bug. When I try to create a shapefile using the same
> parameters, the result appears to have no geometry associated with it. But
> when I use the PostGIS dumper to create the shapefile, I get good results.

Bill,

Ah, so the problem is, presumably, that OGR isn't seeing the geometry
of the PostGIS tables properly.  You might want to verify this with ogrinfo
against the postgis table.

> I've got samples of both results -- how do I go about filing a bug report?

Well, for filing a bug to be useful, I would really need to be able to
setup or access a postgis dataset setup the same as you have it.  So if
you want to file a bug make sure you will be including enough information
to reproduce the problem database.

> If I install FWtools will it cause any issues with the Proj4 and GDAL
> libraries I've already installed? Also, I'm using GEOS and Proj4 with
> PostGIS, so I don't want to break anything there either.

FWTools is a self-contained environment, and doesn't affect any other software
on your system - by design.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Sat Nov 25 11:29:31 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr with reprojecting: DHDN to MGI Austria
In-Reply-To: <920811791@web.de>
References: <920811791@web.de>
Message-ID: <45686F6B.3060808@pobox.com>

Helmut Kudrnovsky wrote:
> my question: do i need also for the source an TOWGS84-parameter? if yes, do
> you have maybe a hint for me where i can find this?
> 
> -s_srs natura2000.prj
> 
> PROJCS["Germany_Zone_4", GEOGCS["GCS_Deutsches_Hauptdreiecksnetz", 
> DATUM["D_Deutsches_Hauptdreiecksnetz",

Helmut,

You need the TOWGS84 value for the source unless the source is very close
to WGS84 (as is the case with NAD83 for instance).

You may be able to find reasonable values in places like national mapping
agency web sites, or Cliff Mungier's past columns in the ASPRS magazine.
It may also exist in the original EPSG database (http://www.epsg.org).  In
many cases multiple TOWGS84 values exist in the EPSG database, and the
PROJ.4 translation includes none of them in order to avoid making an
arbitrary decision.

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From woklist at kyngchaos.com  Sat Nov 25 12:02:44 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] autoload drivers doesn't load some (bugzilla down)
Message-ID: <0E7696D7-1F1D-4EEB-9F46-1500E51328E4@kyngchaos.com>

(I thought the remotesensing.org bugzilla would be back up by now.  I  
hope you don't mind a bug report on the list.)

Some GDAL drivers include multiple formats, with separate  
GDALRegister_* functions for each.  When built into GDAL, they are  
properly loaded by GDALAllRegister().  As a plugin, only the format  
of the plugin name is loaded by AutoLoadDrivers(), and any secondary  
formats are not.  This affects NetCDF (NetCDF + GMT), HDF4 (HDF4 +  
HDF4Image), HDF5 (HDF5 + HDF5Image), and ECW (ECW + JP2ECW).  There  
is also one similar case in OGR: ILI.

I don't know how correct this is, but I was able to solve the problem  
by calling the secondary GDALRegister_ from the primary  
GDALRegister_.  ie for HDF4, within GDALRegister_HDF4(), call  
GDALRegister_HDF4Image() after HDF4 is registered.

In case GDAL is built with the drivers within GDAL, the secondary  
driver calls should then be removed from GDALAllRegister(), to  
eliminate unnecessary redundant calls to those.


-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

"Those people who most want to rule people are, ipso-facto, those  
least suited to do it."

- A rule of the universe, from the HitchHiker's Guide to the Galaxy



From bthoen at gisnet.com  Sat Nov 25 12:54:12 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <45686E4A.10709@pobox.com>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
	<20061125154707.GA20888@www.gisnet.com> <45686E4A.10709@pobox.com>
Message-ID: <20061125175412.GA21284@www.gisnet.com>

On Sat, Nov 25, 2006 at 11:24:42AM -0500, Frank Warmerdam wrote:
> 
> Ah, so the problem is, presumably, that OGR isn't seeing the geometry
> of the PostGIS tables properly.  You might want to verify this with ogrinfo
> against the postgis table.

It looks like using an sql statement with ogr2ogr is causing it to miss the
geometry. When I try ogrinfo on one record, I get these results:

$ ogrinfo -sql "select * from counties where fips='17055'" 
  "PG:dbname=spatial1"

INFO: Open of `PG:dbname=spatial1'
using driver `PostgreSQL' successful.

Layer name: sql_statement
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
Geometry Column = the_geom
gid: Integer (0.0)
fips: String (0.0)
state: String (0.0)
county: String (0.0)
OGRFeature(sql_statement):0
  gid (Integer) = 576
  fips (String) = 17055
  state (String) = Illinois
  county (String) = Franklin

But when I try ogrinfo using the -where switch, I get a geometry, like so:

$ ogrinfo -where "fips='17055'" "PG:dbname=spatial1" counties

INFO: Open of `PG:dbname=spatial1'
using driver `PostgreSQL' successful.

Layer name: counties
Geometry: Multi Polygon
Feature Count: 1
Extent: (-124.817940, 24.521049) - (-66.949829, 49.384361)
Layer SRS WKT:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Geometry Column = the_geom
county: String (66.0)
fips: String (5.0)
gid: Integer (0.0)
state: String (66.0)
OGRFeature(counties):0
  county (String) = Franklin
  fips (String) = 17055
  gid (Integer) = 576
  state (String) = Illinois
  MULTIPOLYGON (((-88.918323999999998 37.862324999999998,
-88.921287000000007 37.862295000000003,
-88.923396999999994 37.862273000000002,
-88.923800999999997 37.862273000000002,
-88.925372999999993 37.862260999999997,
-88.928235999999998 37.862239000000002, ... and so on.

So I'm not sure if this is a bug or I'm just not using the -sql switch
properly. Can you tell me what's going on and how to fix it?

- Bill Thoen


From steve2 at rawlinson.ca  Sat Nov 25 13:12:21 2006
From: steve2 at rawlinson.ca (Steve Rawlinson)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Unable to open JasPer JPEG2000 images
Message-ID: <Pine.BSO.4.62.0611251259280.23376@gamma.206-248-136-119.dsl.teksavvy.com>


Greetings,

I'm not able to open JPEG2000 JasPer images that were created by JasPer 
itself using gdal_translate.

For example, if I convert a GeoTiff to jp2 (with CPL_DEBUG=ON):

D:\devel\gdal-1.3.2\apps>gdal_translate -of JPEG2000 testiq.tif test.jp2

   GDAL: GDALOpen(testiq.tif) succeeds as GTiff.

   Input file size is 500, 450
   0...10...20...30...40...50...60...70...80...90...100 - done.

   JPEG2000: Parameters, delivered to the JasPer library:
   JPEG2000:

   JPEG2000: IHDR box found. Dump: width=14, height=500, numcmpts=450, 
bpp=1

   GDAL: GDALClose()

   JPEG2000: Unable to read JP2 header boxes.

   ERROR 4: `test.jp2' not recognised as a supported file format.

   GDAL: GDALClose(testiq.tif)

   GDAL: GDALDeregister_GTiff() called.

[Despite the error, the image test.jp2 that was created seems fine and I 
can view it in other programs.]

D:\devel\gdal-1.3.2\apps>gdalinfo test.jp2

   JPEG2000: IHDR box found. Dump: width=14, height=500, numcmpts=450, 
bpp=1
   GDAL: GDALClose()

   JPEG2000: Unable to read JP2 header boxes.

   ERROR 4: `test.jp2' not recognised as a supported file format.

   GDALOpen failed - 4
   `test.jp2' not recognised as a supported file format.

   GDAL: GDALDeregister_GTiff() called.


I built GDAL version 1.3.2 using Microsoft Visual C++ 2005 Express 
Edition. I built JasPer from the recommended source 
ftp://ftp.remotesensing.org/gdal/jasper-1.701.0.uuid.tar.gz.  And set the 
build opt flags to match the GDAL build opt flags (using /MD).  gdalinfo 
--formats reports "JPEG2000 (rw): JPEG-2000 part 1 (ISO/IEC 15444-1)". 
I'm not using any other external libraries/formats.

Using some printfs in jpeg2000dataset.cpp the problem seems to be that 
box->data.ihdr.bpc=0 (at line 659), so the paiDepth and pabSignedness 
variables are not getting set.  You can see this from the CPL Debug 
messages as well, the IHDR box is found, but the next debug statement 
inside the if statement, "Component bpp signedness" is never reached.

The test Jasper image I created above is available if anyone is interested 
at http://www.rawlinson.ca/test.jp2.  You may also be able to replicate 
the problem yourself by using gdal_translate to create a .jp2 images, and 
then trying to open it using gdalinfo.

Searching this mailing list it looks like others have had this same 
problem in the past but no resolution was reported.

http://lists.maptools.org/pipermail/gdal-dev/2004-April/002469.html

http://lists.maptools.org/pipermail/gdal-dev/2005-December/007449.html

If anyone can provide any insight I would greatly appreciate it.  I am 
also be curious to know if anyone else can replicate this problem to 
determine if there is a bug in jpeg2000dataset.cpp or something in my 
build environment that may be causing the problem.

Thanks!
Steve

--
Steve Rawlinson
Rawlinson Geospatial Inc.
http://www.rawlinson.ca/

From Roger.Bivand at nhh.no  Sat Nov 25 15:16:38 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL raster output to GE Add -> Image overlay ...
Message-ID: <Pine.LNX.4.44.0611252104010.10403-100000@reclus.nhh.no>

Hi,

Does anyone have any experience of outputting rasters for adding as image
overlays to Google Earth? I have success with a Byte type GTiff (just
integers in the 0-255 range), but have to type the bounding box into the
form directly. 

Attempts to set an alpha channel crash GE when reading the file (it does
say alpha only with PNG, so I'm not surprised - my GE 4.0.2413 (beta) on
RHEL). I have not tried an RGB GTiff yet. Because PNG is a CreateCopy, and
we've used Create in writing from R, I haven't tried that route yet. The
target is to provide gridded interpolations in a readily distributable
format for users without access to GIS.

Thanks for any insights,

Roger

PS. Trial single band file at:

http://spatial.nhh.no/misc/grey.tif

is IDW of Meuse bank zinc ppm soil pollution, with bbox:

       min     max
s1  5.7209  5.7649
s2 50.9555 50.9879


-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no


From mateusz at loskot.net  Sat Nov 25 15:27:42 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <20061125175412.GA21284@www.gisnet.com>
References: <20061124213811.GA16816@www.gisnet.com>	<45678591.8020704@pobox.com>	<20061125154707.GA20888@www.gisnet.com>
	<45686E4A.10709@pobox.com> <20061125175412.GA21284@www.gisnet.com>
Message-ID: <4568A73E.7070504@loskot.net>

Bill Thoen wrote:
> On Sat, Nov 25, 2006 at 11:24:42AM -0500, Frank Warmerdam wrote:
>> Ah, so the problem is, presumably, that OGR isn't seeing the geometry
>> of the PostGIS tables properly.  You might want to verify this with ogrinfo
>> against the postgis table.
> 
> It looks like using an sql statement with ogr2ogr is causing it to miss the
> geometry. When I try ogrinfo on one record, I get these results:
> 
> $ ogrinfo -sql "select * from counties where fips='17055'" 
>   "PG:dbname=spatial1"
> 
> INFO: Open of `PG:dbname=spatial1'
> using driver `PostgreSQL' successful.
> 
> Layer name: sql_statement
> Geometry: Unknown (any)
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> Geometry Column = the_geom
> gid: Integer (0.0)
> fips: String (0.0)
> state: String (0.0)
> county: String (0.0)
> OGRFeature(sql_statement):0
>   gid (Integer) = 576
>   fips (String) = 17055
>   state (String) = Illinois
>   county (String) = Franklin
> [...]
>
> So I'm not sure if this is a bug or I'm just not using the -sql switch
> properly. Can you tell me what's going on and how to fix it?

I tested current GDAL CVS using two versions of PostGIS databases and
layers:

1. When geometry does not include SRID, it is not PostGIS EWKB/EWKT
format, then using -sql option geometry is returned properly but
with Unknown type:

mloskot:~$ ogrinfo -sql "select * from point where ogc_fid=1"
PG:dbname=gdal_test
INFO: Open of `PG:dbname=gdal_test'
      using driver `PostgreSQL' successful.

Layer name: sql_statement
Geometry: Unknown (any)
Feature Count: 1
Extent: (19.769250, 51.446583) - (19.769250, 51.446583)
Layer SRS WKT:
(unknown)
FID Column = ogc_fid
Geometry Column = wkb_geometry
recnum: String (0.0)
name: String (0.0)
lat: String (0.0)
lon: String (0.0)
altitude: String (0.0)
longname: String (0.0)
OGRFeature(sql_statement):1
  recnum (String) = 1
  name (String) = STATOIL
  lat (String) = +51,4465833
  lon (String) = +19,7692500
  altitude (String) = 215
  longname (String) = STACJA BENZ
  POINT (19.76925 51.446583333333336)


But then I query the same layer and feature using -where option,
it returns geometry type properly:

mloskot:~$ ogr/ogrinfo PG:dbname=gdal_test -where "ogc_fid=1" point
INFO: Open of `PG:dbname=gdal_test'
      using driver `PostgreSQL' successful.

Layer name: point
Geometry: Point
Feature Count: 1
Extent: (11.660233, 48.320915) - (21.675484, 53.763435)
Layer SRS WKT:
(unknown)
FID Column = ogc_fid
Geometry Column = wkb_geometry
altitude: String (6.0)
lat: String (12.0)
lon: String (12.0)
longname: String (17.0)
name: String (17.0)
recnum: String (6.0)
OGRFeature(point):1
  altitude (String) = 215
  lat (String) = +51,4465833
  lon (String) = +19,7692500
  longname (String) = STACJA BENZ
  name (String) = STATOIL
  recnum (String) = 1
  POINT (19.76925 51.446583333333301)


2. The second test I did was against layer with SRID definition, so
EWKB/EWKT stream is returned:


mloskot:~/dev/gdal/_cvs/gdal$ ogr/ogrinfo PG:dbname=ewkb_test ewkt_srid
-sql "select * from ewkt_srid where id=9"
INFO: Open of `PG:dbname=ewkb_test'
      using driver `PostgreSQL' successful.
layer names ignored in combination with -sql.

Layer name: sql_statement
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
Geometry Column = egeom
id: Integer (0.0)
OGRFeature(sql_statement):0
  id (Integer) = 9


As yo can see, Geometry is still Unknown.
Next,after I define export CPL_DEBUG=ON environment variable, I get
debug message:

OGR: OGRGeometryFactory::createFromWkb() - got corrupt data.

Frank, I suppose the problem is that -sql query with asterix retrieves
data as EWKB, because OGC functions AsBinary or AsText are not used,
so PostGIS internal format is returned.
Do you have similar considerations?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Sat Nov 25 18:04:33 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <4568A73E.7070504@loskot.net>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>	<20061125154707.GA20888@www.gisnet.com>
	<45686E4A.10709@pobox.com> <20061125175412.GA21284@www.gisnet.com>
	<4568A73E.7070504@loskot.net>
Message-ID: <4568CC01.4040906@pobox.com>

Mateusz Loskot wrote:
> Frank, I suppose the problem is that -sql query with asterix retrieves
> data as EWKB, because OGC functions AsBinary or AsText are not used,
> so PostGIS internal format is returned.
> Do you have similar considerations?

Mateusz,

I believe your analysis is correct.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From yunjm2005 at gmail.com  Sat Nov 25 22:30:29 2006
From: yunjm2005 at gmail.com (=?gb2312?B?2k+9qMP3?=)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Re: your GDAL in C#
References: <e798b640f6ef.455dd059@wiscmail.wisc.edu>
	<455E3215.2080604@perkins.net>
	<f3b73b7d0611181232u3a437991g93c35d727ca51789@mail.gmail.com>
Message-ID: <200611261130263288752@gmail.com>

Hi,Tamas 

I have read this mail today, and have download the GDAL_CSharp.zip C# bindings from http://article.gmane.org/gmane.comp.gis.gdal.devel/6177 .
but it is posted"Date: 2006-01-09 02:33:03 GMT (45 weeks, 6 days and 56 minutes ago)
".so i want to find the latest version, where can i find it.
thinks your work!




O
2006-11-26



 Tamas Szekeres
 2006-11-19 04:32:51
 Simon Perkins
 gdal-dev@lists.maptools.org; MIKAH JAMES TRENT
 Re: [Gdal-dev] Re: your GDAL in C#

It would be considerable to use the GDAL SWIG C# interface since it
seems to be easier to support along with the evolution of the GDAL
core. We are planning to expose most of the required functionality for
the next release.

However if you decide to use this interface feel free to share your
experiences and help us to discover the missing but required
functionalities and the possible problems. So as to collect these
problems we have also created a bugzilla component dedicated
exclusively to the C# interface.


Best Regards,


Tamas Szekeres



2006/11/17, Simon Perkins  <sy@perkins.net >:
> It's been a while since I looked at that code - the standard thing to do
> now is to migrate to using the SWIG generated C# bindings, though those
> are far from complete.
>
> OK, just looked at the code. GDALGetMetadaExt() is the declaration of
> the external (to C#) native GDAL function GDALGetMetadata(), that uses
> raw strings and pointers and so forth. However, to make the function
> easier from C#, the C# GDALGetMetadata() function has an API that uses a
> Dictionary object. The C# GDALGetMetadata() method simply calls
> GDALGetMetadataExt() to do the work, which in turn calls the underlying
> GDAL function.
>
> If you're getting zeros, I would check that you can use GDAL withe the
> C++ API first. Note that most file formats don't support metadata and
> will silently return null pointers. The "domain" flag should generally
> be null - it allows different metadata namespaces to be set up but I
> don't think any formats support that.
>
> BTW, the gdal-dev list is the place to ask questions like this. I've
> copied the list with my answer, for the record.
>
> Cheers,
>
> Sy
>
> MIKAH JAMES TRENT wrote:
>  > Hi Simon,
>  > I am working with the UW-Madison ecology labs as a student programmer.  I am trying to use your C# code that you posted on
>  >
>  > http://article.gmane.org/gmane.comp.gis.gdal.devel/6177
>  >
>  > to see if we can use or extend your C# wrapper to incorporate GDAL into our own projects (see http://www.landis.forest.wisc.edu).
>  >
>  > Could you help me understand what the function "GDALGetMetadataExt" does, or maybe just point me to where it is defined??  The following line of code (from InterOp.cs, in your function GDALGetMetaData):
>  >
>  > void** stringList = (void**) GDALGetMetadataExt(hDataset, domain);
>  >
>  > always returns 0 for me, even when I am certain the dataset is not empty.  You also have 'domain' set to "null" (in Dataset.cs) when you call GDALGetMetaData.  Could this have something to do with it??
>  >
>  > I'm a little new to the whole system, so any help you could provide, even if it's just pointing me somewhere, would be great.  Thanks a bunch,
>  > -Mikah
>  >
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061126/09b756dd/attachment.html
From dfriberg23 at gmail.com  Sun Nov 26 00:26:52 2006
From: dfriberg23 at gmail.com (David Friberg)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Reading from Overviews with GDALDataset
Message-ID: <481948e30611252126n2c9964c2y5fd57cfe9626d73c@mail.gmail.com>

Hi,

I need a way to read from Overviews using GDALDataset::RasterIO or
similar, i.e. one call to read retrieves data for bands.  I don't see
a way to do this without getting each band and reading separately.

Am I missing something, or is this the only way to do it?

Thanks
Dave Friberg

From Roger.Bivand at nhh.no  Sun Nov 26 05:45:16 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL raster output to GE Add -> Image overlay ...
In-Reply-To: <Pine.LNX.4.44.0611252104010.10403-100000@reclus.nhh.no>
Message-ID: <Pine.LNX.4.44.0611261138250.5451-100000@reclus.nhh.no>

On Sat, 25 Nov 2006, Roger Bivand wrote:

> Hi,
> 
> Does anyone have any experience of outputting rasters for adding as image
> overlays to Google Earth? I have success with a Byte type GTiff (just
> integers in the 0-255 range), but have to type the bounding box into the
> form directly. 
> 
> Attempts to set an alpha channel crash GE when reading the file (it does
> say alpha only with PNG, so I'm not surprised - my GE 4.0.2413 (beta) on
> RHEL). I have not tried an RGB GTiff yet. Because PNG is a CreateCopy, and
> we've used Create in writing from R, I haven't tried that route yet. The
> target is to provide gridded interpolations in a readily distributable
> format for users without access to GIS.

Doing:

gdal_translate -of PNG grey_a.tif grey_a.png

(http://spatial.nhh.no/misc/grey_a.png)

on the grey/alpha GTiff that crashed GE gives a usable PNG that GE 
displays without problems, displaying only the study area for which 
interpolation was made. The remaining question is then whether GE can read 
any format of world file or other metadata for a PNG to fix the bounding 
box without manual entry - any experience? I guess that an RGB+A GTiff 
will gdal_translate to PNG successfully, will check.

Roger

> 
> Thanks for any insights,
> 
> Roger
> 
> PS. Trial single band file at:
> 
> http://spatial.nhh.no/misc/grey.tif
> 
> is IDW of Meuse bank zinc ppm soil pollution, with bbox:
> 
>        min     max
> s1  5.7209  5.7649
> s2 50.9555 50.9879
> 
> 
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no



From szekerest at gmail.com  Sun Nov 26 06:17:39 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Re: your GDAL in C#
In-Reply-To: <200611261130263288752@gmail.com>
References: <e798b640f6ef.455dd059@wiscmail.wisc.edu>
	<455E3215.2080604@perkins.net>
	<f3b73b7d0611181232u3a437991g93c35d727ca51789@mail.gmail.com>
	<200611261130263288752@gmail.com>
Message-ID: <f3b73b7d0611260317n37542536p6ad26960c7e2b389@mail.gmail.com>

Hi,

The attachment you have referred is a separate project and I don't
know whether it was developed further or not. Maybe Simon Perkins
knows more about it.

However you can also use the GDAL C# SWIG interface contained by the
gdal project
and can be accessed from the CVS.
For more details about the CVS access see:
http://www.gdal.org/download.html

Best Regards,

Tamas Szekeres



2006/11/26, O <yunjm2005@gmail.com>:
>
>
> Hi,Tamas
>
> I have read this mail today, and have download the GDAL_CSharp.zip C#
> bindings from
> http://article.gmane.org/gmane.comp.gis.gdal.devel/6177 .
> but it is posted"Date: 2006-01-09 02:33:03 GMT (45 weeks, 6 days and 56
> minutes ago)
> ".so i want to find the latest version, where can i find it.
> thinks your work!
>
>
>  ________________________________
>
> O
> 2006-11-26
>  ________________________________
>
>  Tamas Szekeres
>  2006-11-19 04:32:51
>  Simon Perkins
>  gdal-dev@lists.maptools.org; MIKAH JAMES TRENT
>  Re: [Gdal-dev] Re: your GDAL in C#
>
>
>
> It would be considerable to use the GDAL SWIG C#
> interface since it
> seems to be easier to support along with the evolution
> of the GDAL
> core. We are planning to expose most of the
> required functionality for
> the next release.
>
> However if you decide to use this interface feel free
> to share your
> experiences and help us to discover the missing
> but required
> functionalities and the possible problems. So as
> to collect these
> problems we have also created a bugzilla component
> dedicated
> exclusively to the C# interface.
>
>
> Best Regards,
>
>
> Tamas Szekeres
>
>
>
> 2006/11/17, Simon Perkins  <sy@perkins.net >:
> > It's been a while since I looked at that code -
> the standard thing to do
> > now is to migrate to using the SWIG generated C#
> bindings, though those
> > are far from complete.
> >
> > OK, just looked at the code. GDALGetMetadaExt() is
> the declaration of
> > the external (to C#) native GDAL function
> GDALGetMetadata(), that uses
> > raw strings and pointers and so forth. However, to
> make the function
> > easier from C#, the C# GDALGetMetadata()
> function has an API that uses a
> > Dictionary object. The C# GDALGetMetadata()
> method simply calls
> > GDALGetMetadataExt() to do the work, which in turn
> calls the underlying
> > GDAL function.
> >
> > If you're getting zeros, I would check that you can
> use GDAL withe the
> > C++ API first. Note that most file formats
> don't support metadata and
> > will silently return null pointers. The "domain"
> flag should generally
> > be null - it allows different metadata namespaces to be
> set up but I
> > don't think any formats support that.
> >
> > BTW, the gdal-dev list is the place to ask
> questions like this. I've
> > copied the list with my answer, for the record.
> >
> > Cheers,
> >
> > Sy
> >
> > MIKAH JAMES TRENT wrote:
> >  > Hi Simon,
> >  > I am working with the UW-Madison ecology labs as
> a student programmer.  I am trying to use
> your C# code that you posted on
> >  >
> >  >
> http://article.gmane.org/gmane.comp.gis.gdal.devel/6177
> >  >
> >  > to see if we can use or extend your C# wrapper
> to incorporate GDAL into our own projects
> (see http://www.landis.forest.wisc.edu).
> >  >
> >  > Could you help me understand what the function
> "GDALGetMetadataExt" does, or maybe just
> point me to where it is defined??  The following
> line of code (from InterOp.cs, in your function
> GDALGetMetaData):
> >  >
> >  > void** stringList = (void**)
> GDALGetMetadataExt(hDataset, domain);
> >  >
> >  > always returns 0 for me, even when I am certain
> the dataset is not empty.  You also have
> 'domain' set to "null" (in Dataset.cs) when you call
> GDALGetMetaData.  Could this have
> something to do with it??
> >  >
> >  > I'm a little new to the whole system, so any help
> you could provide, even if it's just
> pointing me somewhere, would be great.  Thanks
> a bunch,
> >  > -Mikah
> >  >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
> >
>
>


From bthoen at gisnet.com  Sun Nov 26 11:24:10 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <4568A73E.7070504@loskot.net>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
	<20061125154707.GA20888@www.gisnet.com> <45686E4A.10709@pobox.com>
	<20061125175412.GA21284@www.gisnet.com>
	<4568A73E.7070504@loskot.net>
Message-ID: <20061126162410.GA3996@www.gisnet.com>

Mateusz, Frank,

Thanks for looking into this. I don't really understand what the issue is,
but even when I don't use the asterisk with the -sql switch, I still get an
"unknown" geometry. My Postgres/PostGIS table does have an SRID associated
with it and the geometry column is properly referenced in the
geometry_columns table.

Also, there is still an additional problem with MapInfo output. For
example, when I try the -where switch with the output being MapInfo Tab,
the resulting table has no data in the *.id file (the map feature index). 

This produces a MapInfo table with a corrupt *.id file:
ogr2ogr -f "MapInfo File" -where "fips='17055'" -a_srs WGS84 test.tab
  "PG:dbname=spatial1" counties

But if I issue the same command with the output set to shape file, it
works. The following command works perfectly:

ogr2ogr -f "ESRI Shapefile" -where "fips='17055'" -a_srs WGS84 test.shp
  "PG:dbname=spatial1" counties

What do you recommend I do at this point? Is there a workaround for MapInfo
output?  Should I submit a bug report?  It sounds like you know more about
what's happening here than I do, but I just wanted to know if I need to do
anything else.

- Bill Thoen
 

On Sat, Nov 25, 2006 at 09:27:42PM +0100, Mateusz Loskot wrote:
> Bill Thoen wrote:
> > On Sat, Nov 25, 2006 at 11:24:42AM -0500, Frank Warmerdam wrote:
> >> Ah, so the problem is, presumably, that OGR isn't seeing the geometry
> >> of the PostGIS tables properly.  You might want to verify this with ogrinfo
> >> against the postgis table.
> > 
> > It looks like using an sql statement with ogr2ogr is causing it to miss the
> > geometry. When I try ogrinfo on one record, I get these results:
> > 
> > $ ogrinfo -sql "select * from counties where fips='17055'" 
> >   "PG:dbname=spatial1"
> > 
> > INFO: Open of `PG:dbname=spatial1'
> > using driver `PostgreSQL' successful.
> > 
> > Layer name: sql_statement
> > Geometry: Unknown (any)
> > Feature Count: 1
> > Layer SRS WKT:
> > (unknown)
> > Geometry Column = the_geom
> > gid: Integer (0.0)
> > fips: String (0.0)
> > state: String (0.0)
> > county: String (0.0)
> > OGRFeature(sql_statement):0
> >   gid (Integer) = 576
> >   fips (String) = 17055
> >   state (String) = Illinois
> >   county (String) = Franklin
> > [...]
> >
> > So I'm not sure if this is a bug or I'm just not using the -sql switch
> > properly. Can you tell me what's going on and how to fix it?
> 
> I tested current GDAL CVS using two versions of PostGIS databases and
> layers:
> 
> 1. When geometry does not include SRID, it is not PostGIS EWKB/EWKT
> format, then using -sql option geometry is returned properly but
> with Unknown type:
> 
> mloskot:~$ ogrinfo -sql "select * from point where ogc_fid=1"
> PG:dbname=gdal_test
> INFO: Open of `PG:dbname=gdal_test'
>       using driver `PostgreSQL' successful.
> 
> Layer name: sql_statement
> Geometry: Unknown (any)
> Feature Count: 1
> Extent: (19.769250, 51.446583) - (19.769250, 51.446583)
> Layer SRS WKT:
> (unknown)
> FID Column = ogc_fid
> Geometry Column = wkb_geometry
> recnum: String (0.0)
> name: String (0.0)
> lat: String (0.0)
> lon: String (0.0)
> altitude: String (0.0)
> longname: String (0.0)
> OGRFeature(sql_statement):1
>   recnum (String) = 1
>   name (String) = STATOIL
>   lat (String) = +51,4465833
>   lon (String) = +19,7692500
>   altitude (String) = 215
>   longname (String) = STACJA BENZ
>   POINT (19.76925 51.446583333333336)
> 
> 
> But then I query the same layer and feature using -where option,
> it returns geometry type properly:
> 
> mloskot:~$ ogr/ogrinfo PG:dbname=gdal_test -where "ogc_fid=1" point
> INFO: Open of `PG:dbname=gdal_test'
>       using driver `PostgreSQL' successful.
> 
> Layer name: point
> Geometry: Point
> Feature Count: 1
> Extent: (11.660233, 48.320915) - (21.675484, 53.763435)
> Layer SRS WKT:
> (unknown)
> FID Column = ogc_fid
> Geometry Column = wkb_geometry
> altitude: String (6.0)
> lat: String (12.0)
> lon: String (12.0)
> longname: String (17.0)
> name: String (17.0)
> recnum: String (6.0)
> OGRFeature(point):1
>   altitude (String) = 215
>   lat (String) = +51,4465833
>   lon (String) = +19,7692500
>   longname (String) = STACJA BENZ
>   name (String) = STATOIL
>   recnum (String) = 1
>   POINT (19.76925 51.446583333333301)
> 
> 
> 2. The second test I did was against layer with SRID definition, so
> EWKB/EWKT stream is returned:
> 
> 
> mloskot:~/dev/gdal/_cvs/gdal$ ogr/ogrinfo PG:dbname=ewkb_test ewkt_srid
> -sql "select * from ewkt_srid where id=9"
> INFO: Open of `PG:dbname=ewkb_test'
>       using driver `PostgreSQL' successful.
> layer names ignored in combination with -sql.
> 
> Layer name: sql_statement
> Geometry: Unknown (any)
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> Geometry Column = egeom
> id: Integer (0.0)
> OGRFeature(sql_statement):0
>   id (Integer) = 9
> 
> 
> As yo can see, Geometry is still Unknown.
> Next,after I define export CPL_DEBUG=ON environment variable, I get
> debug message:
> 
> OGR: OGRGeometryFactory::createFromWkb() - got corrupt data.
> 
> Frank, I suppose the problem is that -sql query with asterix retrieves
> data as EWKB, because OGC functions AsBinary or AsText are not used,
> so PostGIS internal format is returned.
> Do you have similar considerations?
> 
> Cheers
> -- 
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 

From szekerest at gmail.com  Sun Nov 26 13:23:00 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] RFC 6: OGR support for querying and selection by
	geometry and feature style
In-Reply-To: <453F9291.40705@pobox.com>
References: <f3b73b7d0610201645t3c8b5a6bq5a63fd07b0deb7b8@mail.gmail.com>
	<453EDEDF.2030502@pobox.com>
	<f3b73b7d0610250902n38b526b3wcd96b9141e47abe7@mail.gmail.com>
	<453F9291.40705@pobox.com>
Message-ID: <f3b73b7d0611261023h643b1addu59f1f9e5bf09778f@mail.gmail.com>

Frank,

I've added the proposed changes to RFC6_QUERYGEOM.dox, and prepared
the necessary patch against the current CVS version, and made the
corresponding tests.

To make the things easier I've slightly changed the negotiated concept as:

1. Instead of adding the new functions GetSpecialFieldAs* I've added the special
field accessors to the existing GetFieldAs* functions.
2. I've made the necessary changes to transfer the static string in
GetFieldAsString
to a member value so as to make the code thread safe. The destructor
of the OGRFeature
will finally destroy this string.
3. According to #2 I've changed your responsibility during the
implementation. And you might want to consider how the
OGRFeature::GetFieldAsString changes will affect the other parts of
the OGR code.

Since the necessary changes are ready to commit if I get the green
lamp the feature can be added to the upcoming 4.10.0.

Best Regards,

Tamas Szekeres



2006/10/25, Frank Warmerdam <warmerdam@pobox.com>:
> Tamas Szekeres wrote:
> >>   2) I'd like to be able to register a function to fetch the special
> >>      fields so we don't have to have the special fetch code appearing
> >>      in so many places.  At the very least a way of registering a
> >> function
> >>      in an array parallel to the SpecialFieldNames[] and
> >> SpecialFieldTypes[]
> >>      arrays. But perhaps it would be better to actually have methods
> >> on the
> >>      OGRFeature like:
> >>         const char *GetSpecialFieldAsString( int nSpecialFieldCode );
> >>         int         GetSpecialFieldAsInteger( int nSpecialFieldCode );
> >>
> >
> > No problem about adding the field value accessor function for every special
> > field. I have already been thinking of it but would not want to
> > disturb the existing
> > code so much. Anyway it would make the things more clear with the overhead
> > of an extra function call.
>
> Tamas,
>
> I'll let you take a first crack at updating the RFC to reflect this.  I'd
> suggest not updating your patches for the time being in case there is any
> other changes suggested.
>
> > It causes much of pain figuring out how GDAL/OGR handles the ownership
> > of the function parameters and return values. In this case the
> > difference of
> > the usage between exportToWkt and GetStyleString/getGeometryName scared
> > me highly. I would be the happiest if we eliminated the need of the
> > StringFinalizer class. The current solution preserves the returned wkt
> > within the
> > scope of the function. However it will not cause problems if the subsequent
> > Get*AsString() overrides the value because we are using the returned
> > value just
> > after the funcion call.
> > At this point I will leave you the task to consider how it will affect
> > the other
> > part of the OGR library. But I like this idea as being the warrior
> > against unnecessary
> > allocations and static variables.
>
> Excellent.  Lets go with this process.
>
> By the way, the documentation for methods like exportToWkt() should make
> it clear that the call gets ownership of the returned string.  For methods
> that return a "const char *" and that don't talk about ownership, it should
> be assumed that this is a pointer to an internal string that should not
> be altered by the caller and that may be altered in the future.
>
> >>   5) I'd like to see a section in the RFC describing the test suite items
> >>      you will add to the GDAL autotest.
> >>
> >
> > I'm afraid I'm not too familiar with GDAL autotest but I'm keen to dig
> > into it
> > more deeply if i have time. But now I can provide only the data (in
> > mapinfo format) and
> > the SQL query samples if needed. Currently I am testing the code using
> > step by step execution of ogrinfo in debug mode.
>
> OK, I've added a note in the RFC on this topic, and will implement the test
> script myself.  I've also taken the liberty of adding a section addressing
> "who does what".
>
> >>   6) I think the backward compatibility section of the RFC should mention
> >>      that the new special fields will potentially conflict with regard
> >>      fields with the given names, and to describe which will take
> >> precidence
> >>      when there is a conflict.
> >>
> >
> > No problem with this either. I would suggest a preceding control
> > character like '@' but it
> > will break my existing mapfiles (~500)  ;-)
>
> I don't mind there being a conflict as long as the circumstances are
> clear.
>
> I have also taken the liberty of adding a note in the RFC that the OGR SQL
> document (gdal/ogr/ogr_sql.dox) needs to be updated, and changing the overall
> name of the RFC to be briefer.  It should be updated on the web site by the
> time this email arrives anywhere.
>
>    http://www.gdal.org/rfc6_sqlgeom.html
>
> I've left the rest of the updates to you.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>

From warmerdam at pobox.com  Sun Nov 26 20:08:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature style as
 OGR Special Fields
Message-ID: <456A3A8C.80709@pobox.com>

Folks,

Motion: To approve RFC 6 - Geometry and Feature style as OGR Special Fields.

While I have not done a detailed review of the patch, I'm very pleased with
the new capability, and the approach taken.  I will take responsibility for
some post-patch integration testing as well as writing script(s) for the test
suite.

I'm keen to get this in place with a few days to shake things out before the
first GDAL/OGR 1.4.0 Beta (circa December 1st).

I'll start voting with a "+1".

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Sun Nov 26 20:10:12 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Re: Motion: To approve RFC 6 - Geometry and Feature
 style as OGR Special Fields
In-Reply-To: <456A3A8C.80709@pobox.com>
References: <456A3A8C.80709@pobox.com>
Message-ID: <456A3AF4.2040304@pobox.com>

Frank Warmerdam wrote:
> Folks,
> 
> Motion: To approve RFC 6 - Geometry and Feature style as OGR Special 
> Fields.

Doh!

For convenience I meant to include a direct pointer to the RFC:

   http://www.gdal.org/rfc6_sqlgeom.html

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Sun Nov 26 20:18:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Reading from Overviews with GDALDataset
In-Reply-To: <481948e30611252126n2c9964c2y5fd57cfe9626d73c@mail.gmail.com>
References: <481948e30611252126n2c9964c2y5fd57cfe9626d73c@mail.gmail.com>
Message-ID: <456A3CCF.10502@pobox.com>

David Friberg wrote:
> Hi,
> 
> I need a way to read from Overviews using GDALDataset::RasterIO or
> similar, i.e. one call to read retrieves data for bands.  I don't see
> a way to do this without getting each band and reading separately.
> 
> Am I missing something, or is this the only way to do it?

David,

Normally if you do a RasterIO() call against a normal band at a reduced
resolution, the GDAL machinery will automatically use appropriate overviews.

If you want to specifically control which overview you use, you can fetch
back the overview GDALRasterBand object, and access it yourself.  But this
is very rarely necessary.

I did write a little application in gdal/apps called dumpoverviews for
dumping out the overviews, but it mainly useful for various kinds of
detailed testing of overviews in new file formats.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From fniles at mitre.org  Sun Nov 26 20:04:54 2006
From: fniles at mitre.org (Niles, Rick)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Announcing Beam
Message-ID: <C75475395FBA894DB4C9C306D5A5C34E39AC05@IMCSRV1.MITRE.ORG>


I've used the GDAL library at MITRE for a number of years in a program
I wrote to determine the coverage of aeronautical radio navigation aids
and RADAR.  I've just received permission to release this code as Free
Softare and have uploaded it to SourceForge.  The programs are called
Beam and I-Beam, but they're listed under the keyword "raybeam" since
the other two were already taken.   Also, please understand this
program has mostly been used by myself and only a few other individuals
and that I'm the only one that has set it up.  Therefore, please be
patient with it.  It has lots of dependancies and it still quite
fragile to things not going as expected.  However, I'm really hoping
someone else here might be interested enough to not only check it out,
but help improve it.

  Thanks for checking it out in advance and thanks for GDAL.  

Note: it's stored under subversion, and I'm new to this, so hopefully
you'll be able to check it out from the repository, if not, let me know
and I'll try to fix it ASAP.

   Rick Niles.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061126/ba29a7f3/attachment.html
From nicky666 at gmail.com  Mon Nov 27 08:05:24 2006
From: nicky666 at gmail.com (Nicolas Ribot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Gdalwarp and memory optimization
In-Reply-To: <456716E4.9020007@pobox.com>
References: <28de5e310611240222v6557bfb8oaceea7b6e90f75d8@mail.gmail.com>
	<200611241042.kAOAfxu4025098@smtp11.cape.com>
	<28de5e310611240328o4a327082pa16334d9dddb24b0@mail.gmail.com>
	<456716E4.9020007@pobox.com>
Message-ID: <28de5e310611270505g1d911a7al5238cba69d2279ff@mail.gmail.com>

> Nicolas,
>
> I would also note that setting the GDAL_CACHEMAX parameter higher
> can be helpful.  The -wm flag sets the amount of memory used for the
> big working buffers (the chunks) when warping.  But down within GDAL
> itself the format drivers use a block cache which comes from a seperate
> memory pool controlled by GDAL_CACHEMAX.   So on a 1GB system you might
> do something like:
>
>    gdalwarp -wm 400 --config GDAL_CACHEMAX 150 ...
>
> This would allocate up to 550MB of RAM between the warping chunk arrays
> and the generic cache.  In fact, GDAL_CACHEMAX can also be set as an
> environment variable.  And I'd encourage folks with lots of RAM to set
> this in their environment normally.   The default small cachesize can
> kill performance in some fairly common situations with large files
> (such as gdal_translate conversions between line oriented and tiled files).
>

Hi Franck and thank you very much for these details.

I will try this parameter and must precise that increasing cache size
with the -wm switch reduced a lot the processing time for my dataset

Best regards

nicolas

From Jukka.Rahkonen at mmmtike.fi  Mon Nov 27 08:20:10 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
Message-ID: <CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>

L?hett?j?: Tom Lynch [mailto:tflynch@gmail.com]
L?hetetty: pe 24.11.2006 9:11

>On 11/24/06, Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi> wrote:
>> Hi,
>
> >I have noticed that there is quite a big difference between using ECW and JPEG2000 format images through GDAL and MapServer path.  While I could get in a quite well controlled test some 120 images per minute ripped out from  ECW layer it was just 80 image per minute from JPEG2000 layer with JP2ECW driver and miserly 25 images/min with JP2KAK driver.
> >I wonder if there is any chance to improve the JPEG2000 even close to ECW efficiency?  Slow results with JP2KAK driver is propably due to not so optimal implementation, but is there some explanation for the difference between ECW and JPEG2000 with the ER Mapper driver?

>Hi Jukka,

>The performance difference you observe between ECW and JPEG 2000 with
the JP2ECW driver is a consequence of the differences between the
formats and our implementations of their codecs.  We're actively
trying to improve performance on both sides of the equation but the
additional flexibility of JPEG 2000, and the computational cost of its
decoder do impose an additional overhead.  Further effort into JPEG
2000 decoder optimisation is producing diminishing returns as we
continue.

>Also, if you're working on a platform other than Windows there are
still some hardware-based optimisations for JPEG 2000 (SSE stuff) that
don't make it into the build.

>The default compression settings for the GDAL JP2ECW driver in the
absence of other options specified are those of the underlying ECW
JPEG 2000 SDK itself - RPCL progression order, no tiles, precinct size
determined as a function of dataset dimension.  These should be pretty
much optimal for GIS-interactive usage pattern of the data, so there
may not be much room for improvement here either.

Hi Tom,,
 
I wondered if there was something wrong in my compression options and I made an additional test by compressing my test images once more, now with GDAL using JP2ECW driver with default settings.  Now  I think I can continue with my old system because the existing Kakadu set was effectively just as fast as the new JP2ECW set.
 
I noticed some change in the general speed of my system from what it used to be so I repeated the test for other image formats as well to be sure I am comparing the same thing.   Here is the summary:
 
Speed (throughput from server to client hard disk as images/minute)
GeoTIFF                                  246
ECW                                        123
JPEG2000 with JP2ECW         77
(own parameters)
JPEG2000 with JP2ECW         73
(GDAL JP2ECW defaults)
JPEG2000 with JP2KAK         23
(own parameters)
JPEG2000 with JP2KAK         23
(GDAL JP2ECW defaults)     21
 
My test measures just the random access to full resolution and does not tell anything about the possible differences in utilising overviews.  I have also noticed that the differences are not at all this big in operations like translating the whole image to other formats. And I am almost sure that JP2KAK driver is not tuned even close to the limits now.
 
-Jukka Rahkonen-


From janeen at splash.princeton.edu  Mon Nov 27 09:18:33 2006
From: janeen at splash.princeton.edu (Janeen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] how is yllcorner determined and why
In-Reply-To: <456474D5.4000800@splash.princeton.edu>
References: <456474D5.4000800@splash.princeton.edu>
Message-ID: <456AF3B9.2050801@splash.princeton.edu>

All,

I've a correction to my original post.  I discovered that in trying to 
figure out how the value for yllcorner is calculated by gdal_translate, 
I was using the dy value NOT the dx value, as the line of code states.  
See corrections within mail.

But that leaves me with 2 new questions:

   Why is the dx value used to calculate the yllcorner in the Ascii Grid?
   And what in the original .nc file is the yllcorner  = -269 related to?

Any light shed on this would be appreciated.

Janeen

Janeen wrote:
> Hello All,
>
> I've just tried the gdal_translate utility on a NetCDF file, 
> converting it to the AAIGrid format.  I'm new to the world of GIS and 
> NetCDF also.  So in using the utility, I want to be sure that I 
> understand how all the data from  the  .nc file  makes it over to the 
> ascii file.
>
> I can't quite figure out how the yllcorner value being reported is 
> calculated, and why it is transformed the way it is.  I've looked at 
> the code and gotten as far as this line in aaigriddataset.cpp:
>
>   adfGeoTransform[3]- nYSize * adfGeoTransform[1]
>
> I can't quite get what the variable adfGeoTransform[3] represents from 
> the original .nc file.  The part of the equation:
>    nYSize * adfGeoTransform[1] 
> I understand where those values  come from in my sample file (i.e. 180 
> *  0.994444444444  = 179 ).
  in my example this should be 180 * 0.997222222222 = 179.5

> Given that yllcorner is being reported as -269, that means that the 
> value for adfGeoTransform[3] would be -90.   But what does that value 
> represent in my original netCDF file given the info below?
>

the actual value for adfGeoTransform[3] becomes -89.5  which is the 
southern most latitude value in the .nc file.


> If anyone can give me a description of what is going on here, I would 
> appreciate it.  Below is header  and gdalinfo.
>
> Janeen
>
>
> Here is the gdal header info from my converted .nc file:
>
>   cols        360
>   nrows        180
>   xllcorner    0.500000000000
>   yllcorner    -269.000000000000
>   dx           0.997222222222
>   dy           0.994444444444
>   NODATA_value -10000000000
>
> Here is (relevant) gdalinfo from my .nc file
>   Driver: netCDF/Network Common Data Format
>   Size is 360, 180
>   Coordinate System is `'
>   Origin = (0.500000,-89.500000)
>   Pixel Size = (0.99722222,0.99444444)
>   Corner Coordinates:
>   Upper Left  (   0.5000000, -89.5000000)
>   Lower Left  (   0.5000000,  89.5000000)
>   Upper Right (     359.500,     -89.500)
>   Lower Right (     359.500,      89.500)
>   Center      ( 180.0000000,   0.0000000)
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev

From dmorissette at mapgears.com  Mon Nov 27 09:52:02 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature style
	as OGR Special Fields
In-Reply-To: <456A3A8C.80709@pobox.com>
References: <456A3A8C.80709@pobox.com>
Message-ID: <456AFB92.20300@mapgears.com>

I'll vote +1.

However, the fact that the special fields take precedence over other 
fields with the same names in the data file bugs me a little bit. I do 
not have a better suggestion to make, but at a minimum the special field 
names and this behavior should be well documented in a prominent place 
to avoid users getting caught by this magic.

Perhaps ogrinfo could also be modified to detect this case and issue a 
warning if it finds those special fields in a dataset?

Daniel


Frank Warmerdam wrote:
> Folks,
> 
> Motion: To approve RFC 6 - Geometry and Feature style as OGR Special 
> Fields.
> 
> While I have not done a detailed review of the patch, I'm very pleased with
> the new capability, and the approach taken.  I will take responsibility for
> some post-patch integration testing as well as writing script(s) for the 
> test
> suite.
> 
> I'm keen to get this in place with a few days to shake things out before 
> the
> first GDAL/OGR 1.4.0 Beta (circa December 1st).
> 
> I'll start voting with a "+1".
> 
> Best regards,


-- 
Daniel Morissette
http://www.mapgears.com/

From hobu at iastate.edu  Mon Nov 27 10:56:14 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature
	style as OGR Special Fields
In-Reply-To: <456AFB92.20300@mapgears.com>
References: <456A3A8C.80709@pobox.com>
 <456AFB92.20300@mapgears.com>
Message-ID: <6.2.3.4.2.20061127094216.02f22058@hobu.mail.iastate.edu>

+0.

At 08:52 AM 11/27/2006, Daniel Morissette wrote:
>I'll vote +1.
>
>However, the fact that the special fields take precedence over other 
>fields with the same names in the data file bugs me a little bit. I 
>do not have a better suggestion to make, but at a minimum the 
>special field names and this behavior should be well documented in a 
>prominent place to avoid users getting caught by this magic.
>
>Perhaps ogrinfo could also be modified to detect this case and issue 
>a warning if it finds those special fields in a dataset?
>
>Daniel
>
>
>Frank Warmerdam wrote:
>>Folks,
>>Motion: To approve RFC 6 - Geometry and Feature style as OGR Special Fields.
>>While I have not done a detailed review of the patch, I'm very pleased with
>>the new capability, and the approach taken.  I will take responsibility for
>>some post-patch integration testing as well as writing script(s) for the test
>>suite.
>>I'm keen to get this in place with a few days to shake things out before the
>>first GDAL/OGR 1.4.0 Beta (circa December 1st).
>>I'll start voting with a "+1".
>>Best regards,
>
>
>--
>Daniel Morissette
>http://www.mapgears.com/
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From dron at ak4719.spb.edu  Mon Nov 27 11:16:20 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature style
	as OGR Special Fields
In-Reply-To: <456A3A8C.80709@pobox.com>
References: <456A3A8C.80709@pobox.com>
Message-ID: <20061127161620.GA15696@ak4719.spb.edu>

On Sun, Nov 26, 2006 at 08:08:28PM -0500, Frank Warmerdam wrote:
> Motion: To approve RFC 6 - Geometry and Feature style as OGR Special
> Fields.
> 
> While I have not done a detailed review of the patch, I'm very pleased
> with the new capability, and the approach taken.  I will take
> responsibility for some post-patch integration testing as well as
> writing script(s) for the test suite.
> 
> I'm keen to get this in place with a few days to shake things out
> before the first GDAL/OGR 1.4.0 Beta (circa December 1st).

+1

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From dron at ak4719.spb.edu  Mon Nov 27 11:19:58 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Unable to open JasPer JPEG2000 images
In-Reply-To: <Pine.BSO.4.62.0611251259280.23376@gamma.206-248-136-119.dsl.teksavvy.com>
References: <Pine.BSO.4.62.0611251259280.23376@gamma.206-248-136-119.dsl.teksavvy.com>
Message-ID: <20061127161958.GB15696@ak4719.spb.edu>

On Sat, Nov 25, 2006 at 01:12:21PM -0500, Steve Rawlinson wrote:
> I'm not able to open JPEG2000 JasPer images that were created by
> JasPer itself using gdal_translate.

Steve,

I fixed that problem. When jasper-uuid used with GDAL we need
-DHAVE_JASPER_UUID variable defined. I added appropriate line to the
nmake.opt, so you should uncomment it and rebuild GDAL with new
parameters.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From jdgonon at gi-lemans.com  Mon Nov 27 10:00:02 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL/OGR_1.3.2 and XERCES-C_2.7.0
Message-ID: <001201c71234$b7971640$6469850a@gi.com>

Hi,

I compile GDAL/OGR_1.3.2 under Visual C++ 2003, and "Xerces-C++ Parser Version 2.7.0".

Xerces-C++ Parser is called in header file "gdal-1.3.2\ogr\ogrsf_frmts\gml\gmlreaderp.h" :
        #include <xercesc/util/PlatformUtils.hpp>
        #include <xercesc/sax2/DefaultHandler.hpp>
        #include <xercesc/sax2/ContentHandler.hpp>
        #include <xercesc/sax2/SAX2XMLReader.hpp>
        #include <xercesc/sax2/XMLReaderFactory.hpp>

But I have 82 errors because of "Xerces-C++ Parser Version 2.7.0".
I have these 2 errors :
        - gdal error LNK2005: _calloc d?j? d?fini(e) dans LIBCD.lib(dbgheap.obj)
        - gdal error LNK2005: _free d?j? d?fini(e) dans LIBCD.lib(dbgheap.obj)


and I have 80 errors like those :
        - gdal error LNK2001: symbole externe non r?solu "__declspec(dllimport) public: static class xercesc_2_7::MemoryManager * xercesc_2_7::XMLPlatformUtils::fgMemoryManager" (__imp_?fgMemoryManager@XMLPlatformUtils@xercesc_2_7@@2PAVMemoryManager@2@A)
        - gdal error LNK2001: symbole externe non r?solu "public: virtual class xercesc_2_7::InputSource * __thiscall xercesc_2_7::DefaultHandler::resolveEntity(unsigned short const * const,unsigned short const * const)" (?resolveEntity@DefaultHandler@xercesc_2_7@@UAEPAVInputSource@2@QBG0@Z)

        - gdal error LNK2001: symbole externe non r?solu "public: virtual void __thiscall xercesc_2_7::DefaultHandler::attributeDecl(unsigned short const * const,unsigned short const * const,unsigned short const * const,unsigned short const * const,unsigned short const * const)" (?attributeDecl@DefaultHandler@xercesc_2_7@@UAEXQBG0000@Z)


What I must do to correct this problem ?

Does there exist complete version of GDAL/OGR_1.3.2 (with "Xerces-C++ Parser Version 2.7.0") ?
Can I download this version for my work ?

Thancks in advance
Jean-Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061127/9ae5181b/attachment.html
From szekerest at gmail.com  Mon Nov 27 13:04:57 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature style
	as OGR Special Fields
In-Reply-To: <20061127161620.GA15696@ak4719.spb.edu>
References: <456A3A8C.80709@pobox.com> <20061127161620.GA15696@ak4719.spb.edu>
Message-ID: <f3b73b7d0611271004n59f581a1q2630f1b15c78befb@mail.gmail.com>

Hi Folks,

Since we have not too much time to waste, according to RFC 1 I declare
that all of the PSC members were give a vote and no -1 were got. I
announce that the proposal was accepted as receiving +3 with the
following voting history:

Frank +1
Daniel +1
Howard +0
Andrey +1


Daniel,

Certainly the OGR SQL documentation (ogr_sql.dox) will be updated
according to these changes. This beaviour (that the special field
supersedes the original with the same name) is the same as FID behaves
in the current implementation.

This RFC did not address to change any of the existing applications
like ogrinfo and I think it would not give us more help than reading
the docs carefully. Currently the possibility that FID conflicts is
much higher than the newly introduced OGR_ prefixed fields.
But hopefully implementing an alias functionality would help to handle
this issue properly.


Best Regards,

Tamas Szekeres





2006/11/27, Andrey Kiselev <dron@ak4719.spb.edu>:
> On Sun, Nov 26, 2006 at 08:08:28PM -0500, Frank Warmerdam wrote:
> > Motion: To approve RFC 6 - Geometry and Feature style as OGR Special
> > Fields.
> >
> > While I have not done a detailed review of the patch, I'm very pleased
> > with the new capability, and the approach taken.  I will take
> > responsibility for some post-patch integration testing as well as
> > writing script(s) for the test suite.
> >
> > I'm keen to get this in place with a few days to shake things out
> > before the first GDAL/OGR 1.4.0 Beta (circa December 1st).
>
> +1
>
> Best regards,
> Andrey
>
> --
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From warmerdam at pobox.com  Mon Nov 27 16:46:34 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Bugzilla is operational again
Message-ID: <456B5CBA.6040902@pobox.com>

Folks,

Howard Butler has repaired the mysql database and bugzilla is now operating
again.  Sorry for any inconvenience.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Mon Nov 27 17:24:36 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>

Hi, I recently got hung up on tracking down an GDAL error because I'm not handling errors from CPLError.   I'd like to be able to handle those errors and create C++ Exceptions but I'm not clear on how to do so.   Anyone have any code examples for how I might turn CPLErrors into Exceptions?   It looks like I should probably set the error handler, but what should that function look like?   Would it simply examine the contents of the GDAL Error number and message and decide to throw or not throw an exception? (which would then be presumably caught in a user's application).
 
Thanks !
 
matt


From MChapman at sanz.com  Mon Nov 27 18:25:58 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
Message-ID: <ED3A48B9840E594890A2BC172D119465092FC70F@mailman.san.com>

Here ya go dude,

if (err != OGRERR_NONE) 
	throw exception(CPLGetLastErrorMsg());


Martin Chapman
Software Developer
http://www.earthwhere.com
W - 303.495.6326
C  - 303.898.0397
-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Monday, November 27, 2006 3:25 PM
To: Gdal-dev@lists.maptools.org
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions

Hi, I recently got hung up on tracking down an GDAL error because I'm
not handling errors from CPLError.   I'd like to be able to handle those
errors and create C++ Exceptions but I'm not clear on how to do so.
Anyone have any code examples for how I might turn CPLErrors into
Exceptions?   It looks like I should probably set the error handler, but
what should that function look like?   Would it simply examine the
contents of the GDAL Error number and message and decide to throw or not
throw an exception? (which would then be presumably caught in a user's
application).
 
Thanks !
 
matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From MChapman at sanz.com  Mon Nov 27 18:30:07 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
Message-ID: <ED3A48B9840E594890A2BC172D119465092FC719@mailman.san.com>

One more thing.  A gdal error is either because the gdal function
returned an error code of type OGRErr, or a function returned NULL.
Handle each case as follows:

// example of a GDALSpatialReference function that returns an error code
OGRErr err = spatialRef.exportToWkt(&pszWks);

// or something that returns null
pDataset = pDriver->Create((const char*) sConnectString.c_str(), nWidth,
nHeight, (int) pBands->size(), eDataType, papszOptions);
if (!pDataset) 
	throw (char*) CPLGetLastErrorMsg();

Martin Chapman
Software Developer
http://www.earthwhere.com
W - 303.495.6326
C  - 303.898.0397

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Monday, November 27, 2006 3:25 PM
To: Gdal-dev@lists.maptools.org
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions

Hi, I recently got hung up on tracking down an GDAL error because I'm
not handling errors from CPLError.   I'd like to be able to handle those
errors and create C++ Exceptions but I'm not clear on how to do so.
Anyone have any code examples for how I might turn CPLErrors into
Exceptions?   It looks like I should probably set the error handler, but
what should that function look like?   Would it simply examine the
contents of the GDAL Error number and message and decide to throw or not
throw an exception? (which would then be presumably caught in a user's
application).
 
Thanks !
 
matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From MChapman at sanz.com  Mon Nov 27 18:32:08 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature
	styleas OGR Special Fields
In-Reply-To: <f3b73b7d0611271004n59f581a1q2630f1b15c78befb@mail.gmail.com>
Message-ID: <ED3A48B9840E594890A2BC172D119465092FC71E@mailman.san.com>

I vote yes.

Martin Chapman
Software Developer
http://www.earthwhere.com
W - 303.495.6326
C  - 303.898.0397

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Tamas Szekeres
Sent: Monday, November 27, 2006 11:05 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Motion: To approve RFC 6 - Geometry and Feature
styleas OGR Special Fields

Hi Folks,

Since we have not too much time to waste, according to RFC 1 I declare
that all of the PSC members were give a vote and no -1 were got. I
announce that the proposal was accepted as receiving +3 with the
following voting history:

Frank +1
Daniel +1
Howard +0
Andrey +1


Daniel,

Certainly the OGR SQL documentation (ogr_sql.dox) will be updated
according to these changes. This beaviour (that the special field
supersedes the original with the same name) is the same as FID behaves
in the current implementation.

This RFC did not address to change any of the existing applications
like ogrinfo and I think it would not give us more help than reading
the docs carefully. Currently the possibility that FID conflicts is
much higher than the newly introduced OGR_ prefixed fields.
But hopefully implementing an alias functionality would help to handle
this issue properly.


Best Regards,

Tamas Szekeres





2006/11/27, Andrey Kiselev <dron@ak4719.spb.edu>:
> On Sun, Nov 26, 2006 at 08:08:28PM -0500, Frank Warmerdam wrote:
> > Motion: To approve RFC 6 - Geometry and Feature style as OGR Special
> > Fields.
> >
> > While I have not done a detailed review of the patch, I'm very
pleased
> > with the new capability, and the approach taken.  I will take
> > responsibility for some post-patch integration testing as well as
> > writing script(s) for the test suite.
> >
> > I'm keen to get this in place with a few days to shake things out
> > before the first GDAL/OGR 1.4.0 Beta (circa December 1st).
>
> +1
>
> Best regards,
> Andrey
>
> --
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From szekerest at gmail.com  Mon Nov 27 19:23:07 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wrong nmake.opt in CVS
Message-ID: <f3b73b7d0611271623r289ddd50mbc3b2b6def22ee87@mail.gmail.com>

Hi,

The recent changes in nmake.opt made this file wrong in the CVS. At
the end of the file the CVS conflicts should be resolved manually.


Tamas

From warmerdam at pobox.com  Mon Nov 27 20:21:15 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wrong nmake.opt in CVS
In-Reply-To: <f3b73b7d0611271623r289ddd50mbc3b2b6def22ee87@mail.gmail.com>
References: <f3b73b7d0611271623r289ddd50mbc3b2b6def22ee87@mail.gmail.com>
Message-ID: <456B8F0B.5090205@pobox.com>

Tamas Szekeres wrote:
> Hi,
> 
> The recent changes in nmake.opt made this file wrong in the CVS. At
> the end of the file the CVS conflicts should be resolved manually.

Tamas,

Sorry about that, I have fixed it up in CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Nov 27 20:35:26 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
Message-ID: <456B925E.8020806@pobox.com>

Matt Hanson wrote:
> Hi, I recently got hung up on tracking down an GDAL error because I'm not
> handling errors from CPLError.   I'd like to be able to handle those errors
> and create C++ Exceptions but I'm not clear on how to do so.   Anyone have
> any code examples for how I might turn CPLErrors into Exceptions?   It looks
> like I should probably set the error handler, but what should that function
> look like?   Would it simply examine the contents of the GDAL Error number
> and message and decide to throw or not throw an exception? (which would then
> be presumably caught in a user's application).

Matt,

I just wanted to add a couple things:

  o You can also install your own error handlers to be called by CPLError().
    You can find some more information about this at:

      http://www.gdal.org/cpl__error_8h.html

  o However, you should generally *not* throw exceptions from within such
    an error handler, as GDAL does not guarantee proper cleanup in the face
    of an exception deep in the internals.  At the very least you are likely
    to see memory leaks, and quite possible data structures could be left
    in an improper state.  If you want to throw exceptions, it is best to do
    it after the GDAL calls, as shown in the other email.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ruckc at yahoo.com  Mon Nov 27 21:28:06 2006
From: ruckc at yahoo.com (Curtis W. Ruck)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Automatically creating raster tiles from overlapping
	rasters?
Message-ID: <20061128022806.18500.qmail@web32215.mail.mud.yahoo.com>

Anyone have a suggestion on how to automatically create raster tiles from 40+ gbs of raster images that have non-standard overlapping?

I have raster data (you can see the tile index shp file at http://orbyn.mine.nu/intersections/rasters.png ) and i want to create a non-overlapping standard-size set of raster tiles, any suggestions.  Its too much data for gdal_merge to handle at once to merge into one file and then separate tiles out of from the single file.

Curtis

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061127/13293a86/attachment.html
From craigfeuerherdt at gmail.com  Mon Nov 27 22:50:14 2006
From: craigfeuerherdt at gmail.com (Craig Feuerherdt)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Error accessing Pgeo through ODBC
In-Reply-To: <442163630611271603n6155ba9dk6339018c4348c2e2@mail.gmail.com>
References: <442163630611271603n6155ba9dk6339018c4348c2e2@mail.gmail.com>
Message-ID: <442163630611271950u36a366e5o86b514640647b9d8@mail.gmail.com>

Have configured OGR to access Personal Geodatabase using the instructions
provided on the web site.
I am using Gentoo Linux.

This is a copy of my .odbc.ini file:
[b_pgeo]
Description = Boundaries PGeo Database
Driver      = Microsoft Access Driver (*.mdb)
Database    = /data/software/ORIENTEERING/boundaries.mdb
Host        = localhost
Port        = 1360
User        = craig
Password    =
Trace       = Yes
TraceFile   = /home/craig/odbc.log

When I attempt to use ogrinfo I get the following errors:

ogrinfo PGeo:b_pgeo
ERROR 1: /usr/grass-6.1.0/lib/libgrass_vask.so: undefined symbol: stdscr
ERROR 1: /usr/grass- 6.1.0/lib/libgrass_vask.so: undefined symbol: stdscr
Segmentation fault

I can not work out why the error involves GRASS?

Thanks in advance,

Craig Feuerherdt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/40a793d2/attachment.html
From dsampson at NRCan.gc.ca  Tue Nov 28 08:09:50 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Gdal_translate BUG?
Message-ID: <2FAA57395C1F914DB27CAA4C376058F2012720A8@S0-OTT-X2.nrn.nrcan.gc.ca>

Hey Folks,

I have been having trouble using the -outsize option in gdal translate.

I have been told this is my solution for downsizing.  The following is
what I had to do in order for it to work.

First: Translate using GCP's
=====================
gdal_translate -gcp 378.19 196.43 -76.777261  45.67899 -gcp 6013.13
282.36 -76.744739  45.678655 -gcp 5890.36 7565.55 -76.745361  45.649344
-gcp 290.14 7492.18 -76.777866  45.649679 A38_001.tif tiA38_001.tif

Second: Warp to set projecton info and set GCP's to corners
===============================================
gdalwarp -s_srs epsg:4326 -t_srs epsg:4326 tiA38_001.tif woA38_001.tif

Third: translate again to set all image criteria including -outsize.
==============================================
gdal_translate -scale  -ot byte  -outsize 67% 67% -mo "Area_or_Point =
Area" woA38_001.tif  oA38_001.tif


Is it a bug that I have to split up the gdal_translate processes? 


The ideal: Everything on one line (DOES NOT WORK)
========================================
gdal_translate -gcp 378.19 196.43 -76.777261  45.67899 -gcp 6013.13
282.36 -76.744739  45.678655 -gcp 5890.36 7565.55 -76.745361  45.649344
-gcp 290.14 7492.18 -76.777866  45.649679 -scale  -ot byte  -outsize 67%
67% -mo "Area_or_Point = Area" -a_srs epsg:4326 A38_001.tif
tiA38_001.tif
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/80d93804/attachment.html
From steve.hagen at unh.edu  Tue Nov 28 09:12:53 2006
From: steve.hagen at unh.edu (Stephen Hagen)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <20061123144925.GB9121@ak4719.spb.edu>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
	<20061123144925.GB9121@ak4719.spb.edu>
Message-ID: <1164723173.6758.3.camel@selva.sr.unh.edu>

On Thu, 2006-11-23 at 17:49 +0300, Andrey Kiselev wrote:
> Stephen,
>
> That is fixed now in CVS. Your dataset does not contain "HDFEOSVersion"
> metadata record, which is used by GDAL to deduce whether we have HDF-EOS
> or just plain HDF file. I added more logic to guess HDF-EOS variants.
> 
> Best regards,
> Andrey


Thank you, Andrey. The HDF-EOS file (MOD09A1) and the projection
information is now recognized by gdalinfo. 

Unfortunately, gdalwarp still fails to reproject this MODIS data
accurately. I looked into Charles Wivell's suggestion that this might be
related to confusion between geodetic and geocentric latitudes. I used
the +geoc parameter in proj4, but I still have incorrectly reprojected
data.

I'm at a dead-end. If anyone figures out a fix to this, please post!
Thanks for the responses.


Best regards,

Steve


From guillaume.huby.lists at gmail.com  Tue Nov 28 09:45:13 2006
From: guillaume.huby.lists at gmail.com (guillaume huby)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
Message-ID: <ddc797c30611280645r7cedee35ic63a91071bd8b56e@mail.gmail.com>

>
> Unfortunately, gdalwarp still fails to reproject this MODIS data
> accurately. I looked into Charles Wivell's suggestion that this might be
> related to confusion between geodetic and geocentric latitudes. I used
> the +geoc parameter in proj4, but I still have incorrectly reprojected
> data.
>
> I'm at a dead-end. If anyone figures out a fix to this, please post!
> Thanks for the responses.
>
>
Hi Steve,

I also met this problem using different MODIS products with gdal. My
solution was to switch to MRT or HEG.
HDF-EOS switched from Integerized sinuso?dal projection to sinuso?dal
projection between release 3 and release 4 of HDF-EOS.
Maybe the shift is linked to this change ?

Guillaume.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/35a7f942/attachment.html
From mhanson at photon.com  Tue Nov 28 10:17:13 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
	<456B925E.8020806@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>

Ok thanks, that answers my question.   I was thinking I could write my own error handlers but sounds like that is not a good idea and I just need to simply check error status after each GDAL call.  Martin - thanks for the tips in the other posts.

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Mon 11/27/2006 8:35 PM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDAL CPLError and C++ Exceptions



Matt Hanson wrote:
> Hi, I recently got hung up on tracking down an GDAL error because I'm not
> handling errors from CPLError.   I'd like to be able to handle those errors
> and create C++ Exceptions but I'm not clear on how to do so.   Anyone have
> any code examples for how I might turn CPLErrors into Exceptions?   It looks
> like I should probably set the error handler, but what should that function
> look like?   Would it simply examine the contents of the GDAL Error number
> and message and decide to throw or not throw an exception? (which would then
> be presumably caught in a user's application).

Matt,

I just wanted to add a couple things:

  o You can also install your own error handlers to be called by CPLError().
    You can find some more information about this at:

      http://www.gdal.org/cpl__error_8h.html

  o However, you should generally *not* throw exceptions from within such
    an error handler, as GDAL does not guarantee proper cleanup in the face
    of an exception deep in the internals.  At the very least you are likely
    to see memory leaks, and quite possible data structures could be left
    in an improper state.  If you want to throw exceptions, it is best to do
    it after the GDAL calls, as shown in the other email.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From ILucena at clarku.edu  Tue Nov 28 10:45:19 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
Message-ID: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>

Hi Matt, Martin, Frank, all,

>> simply check error status after each GDAL call...

That looks like that is the right thing to do. I just want to share the
following piece of code with you guys where I am trying to use the same
approach. I would like to know if I am going in the right direction, if
you don't mind to take a quick look.

// A C++ method:
{
    try
    {
        m_Dataset = (GDALDataset*) GDALOpen(pszFileName, GA_ReadOnly);

        if (m_Dataset == NULL)
        {
            return E_FAIL;
        }

        return S_OK;
    }
    catch(...)
    {
        return E_FAIL;
    }
}

I have debugged it a lot, forcing the error with invalid inputs (null
pointer, invalid file name, invalid network address, etc.), and the
result is that the caller of that method receives the exception nicely
jumping to his own exception handler to do his own stuff as I would like
it to do.

Thanks in advance,

Ivan 


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Tuesday, November 28, 2006 10:17 AM
To: Gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] GDAL CPLError and C++ Exceptions

Ok thanks, that answers my question.   I was thinking I could write my
own error handlers but sounds like that is not a good idea and I just
need to simply check error status after each GDAL call.  Martin - thanks
for the tips in the other posts.

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Mon 11/27/2006 8:35 PM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDAL CPLError and C++ Exceptions



Matt Hanson wrote:
> Hi, I recently got hung up on tracking down an GDAL error because I'm
not
> handling errors from CPLError.   I'd like to be able to handle those
errors
> and create C++ Exceptions but I'm not clear on how to do so.   Anyone
have
> any code examples for how I might turn CPLErrors into Exceptions?   It
looks
> like I should probably set the error handler, but what should that
function
> look like?   Would it simply examine the contents of the GDAL Error
number
> and message and decide to throw or not throw an exception? (which
would then
> be presumably caught in a user's application).

Matt,

I just wanted to add a couple things:

  o You can also install your own error handlers to be called by
CPLError().
    You can find some more information about this at:

      http://www.gdal.org/cpl__error_8h.html

  o However, you should generally *not* throw exceptions from within
such
    an error handler, as GDAL does not guarantee proper cleanup in the
face
    of an exception deep in the internals.  At the very least you are
likely
    to see memory leaks, and quite possible data structures could be
left
    in an improper state.  If you want to throw exceptions, it is best
to do
    it after the GDAL calls, as shown in the other email.

Best regards,
--
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org <http://osgeo.org/> 




_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From neteler at itc.it  Tue Nov 28 11:16:06 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <1164723173.6758.3.camel@selva.sr.unh.edu>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
	<20061123144925.GB9121@ak4719.spb.edu>
	<1164723173.6758.3.camel@selva.sr.unh.edu>
Message-ID: <20061128161606.GD24526@bartok.itc.it>

On Tue, Nov 28, 2006 at 09:12:53AM -0500, Stephen Hagen wrote:
> On Thu, 2006-11-23 at 17:49 +0300, Andrey Kiselev wrote:
> > Stephen,
> >
> > That is fixed now in CVS. Your dataset does not contain "HDFEOSVersion"
> > metadata record, which is used by GDAL to deduce whether we have HDF-EOS
> > or just plain HDF file. I added more logic to guess HDF-EOS variants.
> > 
> > Best regards,
> > Andrey
> 
> 
> Thank you, Andrey. The HDF-EOS file (MOD09A1) and the projection
> information is now recognized by gdalinfo. 
> 
> Unfortunately, gdalwarp still fails to reproject this MODIS data
> accurately. I looked into Charles Wivell's suggestion that this might be
> related to confusion between geodetic and geocentric latitudes. I used
> the +geoc parameter in proj4, but I still have incorrectly reprojected
> data.
> 
> I'm at a dead-end. If anyone figures out a fix to this, please post!
> Thanks for the responses.

Steve,

I didn't read the entire thread but maybe the information helps
that the MODIS Sphere differs from the standard sphere:

MODIS does not use the "Normal Sphere (r=6370997) but 6371007.181
I got this from:
 http://edcdaac.usgs.gov/landdaac/tools/mrtswath/info/ReleaseNotes.pdf

I found some dirty trick to tell GDAL about it, see my script at:
http://mpa.itc.it/markus/useful/modis_hdf2erdas_ll_wgs84.sh

Please let me know if this works for you.

cheers,
markus



From abhay.menon at gmail.com  Tue Nov 28 11:18:46 2006
From: abhay.menon at gmail.com (abhay menon)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] MapInfo Tab Merger
Message-ID: <7a30cd70611280818s1f26f669h6167d9700fc02891@mail.gmail.com>

Hello List,

I have a dataset in MapInfo Tab  format which has multi geometry (point,
linestring and polygon) stored in it. I have to append multiple tab files
outside MapInfo since this dataset is heavy and take a lot of time in
processing (also the table structure for all the files are same in MapInfo
Tab format)

Is there a way I can do this using OGR?

I have tried to store this data in SQLite and then thru SQLite3.exe I merge
the tables into one new table but I lose the MapInfo Tab Table
Structure(especially the field size) in this process which is important for
further purpose.

Also tried that with GML too. but it increase the number fields in data
structure available (FID of all the TAB's are also inserted as FIELD's) and
also it seem to induce some extra feature.. even thought they are not
visible..

So I need that data final MapInfo TAB. Can anyone help me with this..

-- 
Thanks and Regards

Abhay Menon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/d61a2d8c/attachment.html
From Shawn.Gong at drdc-rddc.gc.ca  Tue Nov 28 11:52:31 2006
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] gdalwarp reprojection error
Message-ID: <2E58C246F17003499C141D334794D049D58732@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Hi list,

I tried to reproject an IKONOS image from UTM to lat/lon using gdalwarp.

The following error message appeared:
gdalwarp -t_srs "+proj=latlong +datum=WGS84" src.tif target.tif
ERROR 1: Too many points (441 out of 441) failed to transform, unable to
compute output bounds.
Any ideas?
Thanks.

SG

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/153c0ff1/attachment.html
From warmerdam at pobox.com  Tue Nov 28 12:06:56 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>
Message-ID: <456C6CB0.7030004@pobox.com>

Ivan Lucena wrote:
> Hi Matt, Martin, Frank, all,
> 
>>> simply check error status after each GDAL call...
> 
> That looks like that is the right thing to do. I just want to share the
> following piece of code with you guys where I am trying to use the same
> approach. I would like to know if I am going in the right direction, if
> you don't mind to take a quick look.
> 
> // A C++ method:
> {
>     try
>     {
>         m_Dataset = (GDALDataset*) GDALOpen(pszFileName, GA_ReadOnly);
> 
>         if (m_Dataset == NULL)
>         {
>             return E_FAIL;
>         }
> 
>         return S_OK;
>     }
>     catch(...)
>     {
>         return E_FAIL;
>     }
> }
> 
> I have debugged it a lot, forcing the error with invalid inputs (null
> pointer, invalid file name, invalid network address, etc.), and the
> result is that the caller of that method receives the exception nicely
> jumping to his own exception handler to do his own stuff as I would like
> it to do.

Ivan,

In theory GDALOpen() should never throw an exception, so I'm not sure
why the try block is needed around GDALOpen().  Are you encountering
circumstances where GDALOpen() does throw an exception?  Can you provide
details?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Nov 28 12:09:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
	<456B925E.8020806@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>
Message-ID: <456C6D3D.8020602@pobox.com>

Matt Hanson wrote:
> Ok thanks, that answers my question.   I was thinking I could write my own
> error handlers but sounds like that is not a good idea and I just need to
> simply check error status after each GDAL call.  Martin - thanks for the
> tips in the other posts.

Matt,

I want to stress that writing your own error handlers is fine, but that they
shouldn't do any non-local control changes (exceptions, longjmp) if you want
to be safe.  Overiding the error handlers is mostly done to control where
the errors get reported - the default being to stderr.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Tue Nov 28 12:17:16 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>
Message-ID: <456C6F1C.1090207@loskot.net>

Ivan Lucena wrote:
> Hi Matt, Martin, Frank, all,
> 
>>> simply check error status after each GDAL call...
> 
> That looks like that is the right thing to do. I just want to share the
> following piece of code with you guys where I am trying to use the same
> approach. I would like to know if I am going in the right direction, if
> you don't mind to take a quick look.
> 
> // A C++ method:
> {
>     try
>     {
>         m_Dataset = (GDALDataset*) GDALOpen(pszFileName, GA_ReadOnly);
> 
>         if (m_Dataset == NULL)
>         {
>             return E_FAIL;
>         }
> 
>         return S_OK;
>     }
>     catch(...)
>     {
>         return E_FAIL;
>     }
> }
> 
> I have debugged it a lot, forcing the error with invalid inputs (null
> pointer, invalid file name, invalid network address, etc.), and the
> result is that the caller of that method receives the exception nicely
> jumping to his own exception handler to do his own stuff as I would like
> it to do.

Ivan,

I'd like to share my comments:

1. GDAL calls do not throw C++ exceptions.
2. GDAL calls do not use C++ Standard Library features throwing
exceptions. OK, std::string class is used.
3. Even if GDALOpen will throw anything, your version is not exception
safe, unless
3.1 GDALOpen promises to release all resources on throw
3.2 You call GDALClose on catch, before return E_FAIL


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From jdgonon at gi-lemans.com  Tue Nov 28 10:58:27 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL/OGR_1.3.2 and XERCES-C_2.7.0
Message-ID: <001c01c71306$0bbd37f0$6469850a@gi.com>

Hi,

Yesterday, I sent mail to GDAL list for compatibility errors between GDAL/OGR_1.3.2 (under Visual C++ 2003) and "Xerces-C++ Parser Version 2.7.0".

I succeeded to correct some errors (by correcting library inclusion), but I have still errors like these :

        gdal error LNK2019: symbole externe non r?solu _png_get_image_width r?f?renc? dans la fonction "public: static class GDALDataset * __cdecl PNGDataset::Open(class GDALOpenInfo *)" (?Open@PNGDataset@@SAPAVGDALDataset@@PAVGDALOpenInfo@@@Z)

I don't know what I must do to correct this problem ...

An other question : does there exist complete version of GDAL/OGR_1.3.2 (with "Xerces-C++ Parser Version 2.7.0") ?
Can I download this version for my work ?

Thancks in advance
Jean-Daniel

jdgonon@gi-lemans.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/af66eb0d/attachment.html
From dmorissette at mapgears.com  Tue Nov 28 12:46:53 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] MapInfo Tab Merger
In-Reply-To: <7a30cd70611280818s1f26f669h6167d9700fc02891@mail.gmail.com>
References: <7a30cd70611280818s1f26f669h6167d9700fc02891@mail.gmail.com>
Message-ID: <456C760D.9060108@mapgears.com>

Unfortunately the .TAB driver in OGR doesn't support appending data to 
existing files, so you have to write the whole output file in a single 
pass... and I don't think ogr2ogr supports multiple input layers at once 
so you'll have to do a bit of gymnastic to get the result you want.

Here are a couple of options using the MITAB library 
(http://mitab.maptools.org/) directly, which is what OGR uses under the 
hood to read/write TAB datasets. The advantage of working directly with 
MITAB in your case is that it reduces the chances of losing information 
(pen/brush styles, field types, etc) when going from one format to 
another with OGR.

1- If you can write your own little program in VB or in C then use the 
MITAB C API to write a program that reads in features from multiple 
files and copies them to a single output file. The file mitabc_test.c 
contains sample code that shows how to open files for reading and 
writing. Mapping this code to VB shouldn't be too hard either.

2- If you don't want to do any programming, then you can use the tab2tab 
program to convert all your source .tab datasets to .mif/.mid. Then 
merge all the .mid files to a single .mid file, do the same with all the 
.mif files, merging them all to a single .mif file after stripping the 
headers of all the .mif files except the first one. If you merge the 
.mid and .mif files in the same order then you can convert the resulting 
.mif/.mid dataset to .tab using tab2tab and you won't have lost any 
information.


Oh wait... now that I have written all that, there is an easier 
solution: if you can then create a seamless table in MapInfo (a virtual 
dataset that contains all your indiviual .TAB files) ... then use 
OGR2OGR to convert the seamless .TAB dataset to a single .TAB file

Daniel

abhay menon wrote:
> Hello List,
> 
> I have a dataset in MapInfo Tab  format which has multi geometry (point, 
> linestring and polygon) stored in it. I have to append multiple tab 
> files outside MapInfo since this dataset is heavy and take a lot of time 
> in processing (also the table structure for all the files are same in 
> MapInfo Tab format)
> 
> Is there a way I can do this using OGR?
> 
> I have tried to store this data in SQLite and then thru SQLite3.exe I 
> merge the tables into one new table but I lose the MapInfo Tab Table 
> Structure(especially the field size) in this process which is important 
> for further purpose.
> 
> Also tried that with GML too. but it increase the number fields in data 
> structure available (FID of all the TAB's are also inserted as FIELD's) 
> and also it seem to induce some extra feature.. even thought they are 
> not visible..
> 
> So I need that data final MapInfo TAB. Can anyone help me with this..
> 
> -- 
> Thanks and Regards
> 
> Abhay Menon
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


-- 
Daniel Morissette
http://www.mapgears.com/

From dhoffman at prologic-inc.com  Tue Nov 28 15:49:47 2006
From: dhoffman at prologic-inc.com (Derrick Hoffman)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping NITF file with RPCs and losing color
Message-ID: <2DBB9F887DAA394FA75D98474EA5730D02FC5C54@vader.prologic-inc.com>

Hello all,

 

I am trying to warp an NITF file using GDAL warp.  The file has RPCs and
the coordinate warping itself works just fine.  The problem is that
after the warp occurs, the result image is now grayscale.  Is there any
way to preserve each band's colors in the output file?

 

Thanks a lot

 

Derrick Hoffman

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/73283895/attachment.html
From matt.wilkie at gov.yk.ca  Tue Nov 28 15:57:49 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
	<CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
Message-ID: <456CA2CD.70501@gov.yk.ca>

Hi Jukka, I note from your stats that the TIFF process at 246 images per 
minute is double the closest competitor, ECW at 123. Is that tiff with 
or without compression? What I'm wondering is if for archival purposes 
tiff might be the best lossless route.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From ILucena at clarku.edu  Tue Nov 28 16:30:48 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
Message-ID: <6FD7C9DB26540B42A1207C69BF92D4550231D874@Iris.ad.clarku.edu>

Matt, Frank,

Your both comments are great, thank.

I understand that try/catch is useless around GDAL API calls. The point
is well taken. But if there is a possibility that somebody could place a
GDALnn.DLL in the system and in that GDALL built there is a custom error
handling that *does* throws exception, then I think that I should keep
my extra-precautious try/catch. Is it possible? And what is worth?

Matt, I didn't mention that but I am developing a wrapper, so in this
case I am expecting that the application developers will take some of
the release-resource responsibility to themselves. But I understand your
point. If I really needed to release any *direct dependent resources*
that should be done before "return E_FAIL". The caller will receive it
as an exception.

Thank you very much that was very helpful.

Ivan

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Tuesday, November 28, 2006 12:17 PM
To: gdal
Subject: Re: [Gdal-dev] GDAL CPLError and C++ Exceptions
Ivan,

I'd like to share my comments:

1. GDAL calls do not throw C++ exceptions.
2. GDAL calls do not use C++ Standard Library features throwing
exceptions. OK, std::string class is used.
3. Even if GDALOpen will throw anything, your version is not exception
safe, unless
3.1 GDALOpen promises to release all resources on throw
3.2 You call GDALClose on catch, before return E_FAIL



From tflynch at gmail.com  Tue Nov 28 17:09:47 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
	<CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
Message-ID: <c39b2a650611281409yee77adcsf62a470840b37e1c@mail.gmail.com>

On 11/28/06, Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi> wrote:
> Hi Tom,,
>
> I wondered if there was something wrong in my compression options and I made an additional test by compressing my test images once more, now with GDAL using JP2ECW driver with default settings.  Now  I think I can continue with my old system because the existing Kakadu set was effectively just as fast as the new JP2ECW set.

Jukka,

I'm not sure exactly what the figures below represent in relation to
the paragraph above, but what I take you to mean is that the
compression scheme you were using, taken from Kakadu recommendations,
gave comparable decoder performance to the JP2ECW default compression
scheme.  I don't find that too surprising given they are definitely
similar (use of RPCL progression order etc.).

I can't comment about the tuning of the JP2KAK driver except to say it
could probably perform a bit better.  The relative performance of our
codecs against Kakadu is usually more comparable, whereas in your
tests you're observing a 3:1 performance ratio in our favour.  Of
course that's not a bad thing from our point of view.  There is also a
possibility that GDAL is better able to exploit our libraries because
of built-in resampling for example (I'm unsure if Kakadu provides
this).

There's more than one factor that could be affecting the variation
between JP2ECW / JP2KAK
- tuning of the compression parameters (maybe not such a big effect)
- GDAL read implementation w.r.t. the interface of the underlying libraries
- implementation of the codecs Kakadu vs. ECW
- platform-specific decoder optimisations (I'm unsure how much
variation this causes for Kakadu)

Finally as you mention the usage pattern represented by your test
probably doesn't reflect a typical MapServer use case.  For example
your testing uses full-res image subsets whereas a typical interactive
map request will not drill down to maximum resolution.

The one thing that doesn't surprise me is that ECW is outperforming
JPEG 2000.  The ECW format sacrifices a lot of flexibility for
excellent performance in this type of application and our ECW codec
has always been a bit ahead of the game as compared to our JP2 codec.

> I noticed some change in the general speed of my system from what it used to be so I repeated the test for other image formats as well to be sure I am comparing the same thing.   Here is the summary:
>
> Speed (throughput from server to client hard disk as images/minute)
> GeoTIFF                                  246
> ECW                                        123
> JPEG2000 with JP2ECW         77
> (own parameters)
> JPEG2000 with JP2ECW         73
> (GDAL JP2ECW defaults)
> JPEG2000 with JP2KAK         23
> (own parameters)
> JPEG2000 with JP2KAK         23
> (GDAL JP2ECW defaults)     21
>
> My test measures just the random access to full resolution and does not tell anything about the possible differences in utilising overviews.  I have also noticed that the differences are not at all this big in operations like translating the whole image to other formats. And I am almost sure that JP2KAK driver is not tuned even close to the limits now.

--
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From tflynch at gmail.com  Tue Nov 28 17:17:19 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <c39b2a650611281408y56eca012s518ce7cc56b5c24a@mail.gmail.com>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
	<CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
	<c39b2a650611281408y56eca012s518ce7cc56b5c24a@mail.gmail.com>
Message-ID: <c39b2a650611281417q3392b06cu303fea6a2fdbc5f8@mail.gmail.com>

On 11/28/06, Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi> wrote:
> Hi Tom,,
>
> I wondered if there was something wrong in my compression options and I made an additional test by compressing my test images once more, now with GDAL using JP2ECW driver with default settings.  Now  I think I can continue with my old system because the existing Kakadu set was effectively just as fast as the new JP2ECW set.

Jukka,

I'm not sure exactly what the figures below represent in relation to
the paragraph above, but what I take you to mean is that the
compression scheme you were using, taken from Kakadu recommendations,
gave comparable decoder performance to the JP2ECW default compression
scheme.  I don't find that too surprising given they are definitely
similar (use of RPCL progression order etc.).

I can't comment about the tuning of the JP2KAK driver except to say it
could probably perform a bit better.  The relative performance of our
codecs against Kakadu is usually more comparable, whereas in your
tests you're observing a 3:1 performance ratio in our favour.  Of
course that's not a bad thing from our point of view.  There is also a
possibility that GDAL is better able to exploit our libraries because
of built-in resampling for example (I'm unsure if Kakadu provides
this).

There's more than one factor that could be affecting the variation
between JP2ECW / JP2KAK
- tuning of the compression parameters (maybe not such a big effect)
- GDAL read implementation w.r.t. the interface of the underlying libraries
- implementation of the codecs Kakadu vs. JP2ECW
- platform-specific decoder optimisations (I'm unsure how much
variation this causes for Kakadu)

Finally as you mention the usage pattern represented by your test
probably doesn't reflect a typical MapServer use case.  For example
your testing uses full-res image subsets whereas a typical interactive
map request will not drill down to maximum resolution.

One thing that certainly doesn't surprise me is that ECW is outperforming
JPEG 2000.  The ECW format sacrifices a lot of flexibility for
excellent performance in this type of application and our ECW codec
has always been a bit ahead of the game as compared to our JP2 codec.

> I noticed some change in the general speed of my system from what it used to be so I repeated the test for other image formats as well to be sure I am comparing the same thing.   Here is the summary:
>
> Speed (throughput from server to client hard disk as images/minute)
> GeoTIFF                                  246
> ECW                                        123
> JPEG2000 with JP2ECW         77
> (own parameters)
> JPEG2000 with JP2ECW         73
> (GDAL JP2ECW defaults)
> JPEG2000 with JP2KAK         23
> (own parameters)
> JPEG2000 with JP2KAK         23
> (GDAL JP2ECW defaults)     21
>
> My test measures just the random access to full resolution and does not tell anything about the possible differences in utilising overviews.  I have also noticed that the differences are not at all this big in operations like translating the whole image to other formats. And I am almost sure that JP2KAK driver is not tuned even close to the limits now.

--
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From warmerdam at pobox.com  Wed Nov 29 01:08:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <c39b2a650611281417q3392b06cu303fea6a2fdbc5f8@mail.gmail.com>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
	<CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
	<c39b2a650611281408y56eca012s518ce7cc56b5c24a@mail.gmail.com>
	<c39b2a650611281417q3392b06cu303fea6a2fdbc5f8@mail.gmail.com>
Message-ID: <456D23EC.2050501@pobox.com>

Tom Lynch wrote:
> I can't comment about the tuning of the JP2KAK driver except to say it
> could probably perform a bit better.

Tom / Jukka,

This is definately the case.  The JP2KAK driver *only* supports a block
oriented access to data while the JP2ECW driver has an implementation of
the RasterIO() interface that will handle single large reads in a single
underlying library windowing which can make a big difference.

Differences in the performance of jpeg2000 access through the various
drivers in GDAL should not be taken as a reflection of the underlying
library efficiency.  More often it reflects varying implementation
strategies in GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From tflynch at gmail.com  Tue Nov 28 19:28:39 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <456D23EC.2050501@pobox.com>
References: <CC197224AC75CE4DB23F739B16891B866684E4@tikka.haapa.mmm.fi>
	<c39b2a650611232311q3a46054u82a76c116f5c0238@mail.gmail.com>
	<CC197224AC75CE4DB23F739B16891B866684FD@tikka.haapa.mmm.fi>
	<c39b2a650611281408y56eca012s518ce7cc56b5c24a@mail.gmail.com>
	<c39b2a650611281417q3392b06cu303fea6a2fdbc5f8@mail.gmail.com>
	<456D23EC.2050501@pobox.com>
Message-ID: <c39b2a650611281628n4e8e5c65ib341c26b039168ed@mail.gmail.com>

On 11/29/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Tom Lynch wrote:
> > I can't comment about the tuning of the JP2KAK driver except to say it
> > could probably perform a bit better.
>
> Differences in the performance of jpeg2000 access through the various
> drivers in GDAL should not be taken as a reflection of the underlying
> library efficiency.  More often it reflects varying implementation
> strategies in GDAL.

Thanks for the insight Frank - this was more or less my expectation
given personal experience of the relative performance of our codec and
the Kakadu codec in other contexts.

Cheers

--
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From warmerdam at pobox.com  Tue Nov 28 20:46:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping NITF file with RPCs and losing color
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730D02FC5C54@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730D02FC5C54@vader.prologic-inc.com>
Message-ID: <456CE66D.5080102@pobox.com>

Derrick Hoffman wrote:
> Hello all,
> 
>  
> 
> I am trying to warp an NITF file using GDAL warp.  The file has RPCs and 
> the coordinate warping itself works just fine.  The problem is that 
> after the warp occurs, the result image is now grayscale.  Is there any 
> way to preserve each band?s colors in the output file?

Derrick,

First, I'd warn you that GDAL warps using RPCs aren't very accuracy since
I believe an elevation of zero is assumed everywhere.

I'm not sure why you are losing the color of your file.  Generally speaking
current versions of gdalwarp will try and copy a pseudocolor table to the
output file if the source has one, and 3-band RGB files should be fine.
Can you provide a gdalinfo report on the input file and output file, and
the version of GDAL you are using?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Nov 28 20:47:56 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] gdalwarp reprojection error
In-Reply-To: <2E58C246F17003499C141D334794D049D58732@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <2E58C246F17003499C141D334794D049D58732@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <456CE6CC.7020007@pobox.com>

Gong, Shawn wrote:
> Hi list,
> 
> I tried to reproject an IKONOS image from UTM to lat/lon using gdalwarp. 
> 
> The following error message appeared:
> 
> gdalwarp -t_srs "+proj=latlong +datum=WGS84" src.tif target.tif
> 
> ERROR 1: Too many points (441 out of 441) failed to transform, unable to 
> compute output bounds.

Shawn,

Can you provide a gdalinfo report on the input file?

Is there any chance you don't have PROJ.4 built on your system?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Nov 28 21:57:30 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL/OGR Sponsorship 
Message-ID: <456CF71A.10002@pobox.com>

Folks,

The project sponsorship program is now in place, and accepting sponsorships.
The details are at:

   http://www.gdal.org/sponsorship.html

Sponsorships are primarily intended for organizations that are substantial
users of GDAL/OGR directly, or through applications, and that want to help
sustain the project.  Sponsors also have some input on project directions,
and some precedence on bug fixing from a maintainer hired with sponsorship
funds.  There is also a marketing benefit from being associated with the
project as a sponsor.

Sponsorship is not really aimed at individuals.  Individuals can best
contribute to the project by helping with development, documentation,
supporting other users, and promoting the project.

Any organizations interested in sponsoring are encouraged to contact me
for details and to make arrangements.  If anyone has suggestions of
organizations I should personally approach, also feel free to drop me a
line.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 29 03:39:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Re: Gdal_translate issues
In-Reply-To: <2FAA57395C1F914DB27CAA4C376058F20127218D@S0-OTT-X2.nrn.nrcan.gc.ca>
References: <2FAA57395C1F914DB27CAA4C376058F20127218D@S0-OTT-X2.nrn.nrcan.gc.ca>
Message-ID: <456D4759.3070108@pobox.com>

Sampson, David wrote:
> Do you have any fresh ideas of how I can go about my gdal_translate 
> block. To knock my three step process (as posted to the list) to a one 
> step process.

Dave,

I've gone through some of your emails, but I got a bit mixed up about what
is the current issue.  First a few clarifications on points that seemed
to be raised.

  1) If you use -outsize to reduce the size of the image at the same time
     as you are attaching gcps, you will also need to adjust the pixel/line
     locations of the gcps to be in terms of the reduced image size, not
     the original.  I think this is the core of your problem.

  2) On review, gdal_translate never adjusts the GCP pixel/line locations,
     though I think it should.  So this should be considered a bug in
     gdal_translate and I'd encourage you to file a bug on the issue,
     especially if it is affecting your ability to function.

  3) You asked if Vincent's bug about GCP projections could be affecting
     you (http://bugzilla.remotesensing.org/show_bug.cgi?id=1354).  I'm
     not sure - it is possible.  So as to feel like I've accomplished something
     I dug into this issue tonight and fixed it in CVS.

Could you summarize what is still going wrong, with an exact report of
the commands you are using, the gdalinfo reports before and after
transformation and what you think isn't as you would expect it to be?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From guillaume.huby.lists at gmail.com  Wed Nov 29 04:19:01 2006
From: guillaume.huby.lists at gmail.com (guillaume huby)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
Message-ID: <ddc797c30611290119mdfa09efy7bca838505ba0be2@mail.gmail.com>

>
> I found some dirty trick to tell GDAL about it, see my script at:
> http://mpa.itc.it/markus/useful/modis_hdf2erdas_ll_wgs84.sh
>
>
Dirty trick, but working trick ! I used the same commands on a MOD09GQK
product and get the same result than using MRT.

Thank you for this nice job.

Guillaume.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/37e17410/attachment.html
From Jukka.Rahkonen at mmmtike.fi  Wed Nov 29 04:20:23 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:30 2007
Subject: VS: [Gdal-dev] Wanted: More speed to JPEG2000
In-Reply-To: <c39b2a650611281408y56eca012s518ce7cc56b5c24a@mail.gmail.com>
Message-ID: <CC197224AC75CE4DB23F739B16891B866E72C4@tikka.haapa.mmm.fi>

> L?hett?j?: Tom Lynch 

> On 11/28/06, Rahkonen Jukka <Jukka.Rahkonen@mmmtike.fi> wrote:
> > Hi Tom,,
> >
> > I wondered if there was something wrong in my compression 
> options and I made an additional test by compressing my test 
> images once more, now with GDAL using JP2ECW driver with 
> default settings.  Now  I think I can continue with my old 
> system because the existing Kakadu set was effectively just 
> as fast as the new JP2ECW set.
> 
> Jukka,
> 
> I'm not sure exactly what the figures below represent in relation to
> the paragraph above, but what I take you to mean is that the
> compression scheme you were using, taken from Kakadu recommendations,
> gave comparable decoder performance to the JP2ECW default compression
> scheme.  I don't find that too surprising given they are definitely
> similar (use of RPCL progression order etc.).
> 
> I can't comment about the tuning of the JP2KAK driver except to say it
> could probably perform a bit better.  The relative performance of our
> codecs against Kakadu is usually more comparable, whereas in your
> tests you're observing a 3:1 performance ratio in our favour.  Of
> course that's not a bad thing from our point of view.  There is also a
> possibility that GDAL is better able to exploit our libraries because
> of built-in resampling for example (I'm unsure if Kakadu provides
> this).
> 
> There's more than one factor that could be affecting the variation
> between JP2ECW / JP2KAK
> - tuning of the compression parameters (maybe not such a big effect)
> - GDAL read implementation w.r.t. the interface of the 
> underlying libraries
> - implementation of the codecs Kakadu vs. ECW
> - platform-specific decoder optimisations (I'm unsure how much
> variation this causes for Kakadu)
> 
> Finally as you mention the usage pattern represented by your test
> probably doesn't reflect a typical MapServer use case.  For example
> your testing uses full-res image subsets whereas a typical interactive
> map request will not drill down to maximum resolution.
> 
> The one thing that doesn't surprise me is that ECW is outperforming
> JPEG 2000.  The ECW format sacrifices a lot of flexibility for
> excellent performance in this type of application and our ECW codec
> has always been a bit ahead of the game as compared to our JP2 codec.


Tom,

You had got the main information out of my figures even they included a typo. Different packages are making similarly behaving JPEG2000 images when the same compression instructions are used (not really a big surprise) and the combination of GDAL and JP2KAK driver is no good in reading full resolution subsets.

I think I am now quite satisfied with the information about today's situation with using ECW and JPEG2000 through GDAL and MapServer. My interpretation for our own environment is that with Mapserver around 50% of the speed can be achieved with 10-20% of disk space by using compressed,  high quality ECW images. Using JPEG2000 compression is throttling the Mapserver output to 30% of the optimal but unlike ECW it gives a possibility to use lossless compression with some 50% savings in disk space (comparison between uncompressed TIFF with overviews and lossless JPEG2000).  I think that the formala is not very favourable for JPEG2000.  That's sad because it will mean having our imagery in at least two different formats, JPEG2000 for archive and TIFF for daily use, or possibly ECW for not-so-often-requested layers.


Regards,

-Jukka-

 
> > I noticed some change in the general speed of my system 
> from what it used to be so I repeated the test for other 
> image formats as well to be sure I am comparing the same 
> thing.   Here is the summary:
> >
> > Speed (throughput from server to client hard disk as images/minute)
> > GeoTIFF                                  246
> > ECW                                        123
> > JPEG2000 with JP2ECW         77
> > (own parameters)
> > JPEG2000 with JP2ECW         73
> > (GDAL JP2ECW defaults)
> > JPEG2000 with JP2KAK         23
> > (own parameters)
> > JPEG2000 with JP2KAK         23  <<<<<this number should not exist here!
> > (GDAL JP2ECW defaults)     21
> >
> > My test measures just the random access to full resolution 
> and does not tell anything about the possible differences in 
> utilising overviews.  I have also noticed that the 
> differences are not at all this big in operations like 
> translating the whole image to other formats. And I am almost 
> sure that JP2KAK driver is not tuned even close to the limits now.
> 
> -- 
> Tom Lynch
> Development, ER Mapper
> Phone:      +61 8 93882900
> Fax:        +61 8 93882901
> Email:      tom.lynch@ermapper.com
> Web:        http://www.ermapper.com
> Forums:     http://forum.ermapper.com
> 


From Jukka.Rahkonen at mmmtike.fi  Wed Nov 29 04:42:40 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Wanted: More speed to JPEG2000
Message-ID: <CC197224AC75CE4DB23F739B16891B866E72C5@tikka.haapa.mmm.fi>

Matt wrote:
>Hi Jukka, I note from your stats that the TIFF process at 246 images
per 
>minute is double the closest competitor, ECW at 123. Is that tiff with 
>or without compression? What I'm wondering is if for archival purposes 
>tiff might be the best lossless route.

Hi Matt,
Those are tiled, without compression, and with overviews even those do
not matter in my test because I am hitting the full resolution to keep
things as simple as possible.  For archiving I am satisfield with
JPEG2000. The slow performance of JPEG2000 discussed in this thread
concerns just the use through server and especially GDAL/MapServer
route.  In local use JPEG2000 performs great.  Well, unfortunately not
with all software, including many market leading GIS-packages.  But if
you are willing to serve lossless archive images with Mapserver I
believe compressed TIFFs would be better choice that JPEG2000.  I am
awaiting with my archive for the streaming geospatial JPIP server and
usable JPIP clients :)
 
-Jukka-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/70dc5468/attachment.html
From neteler at itc.it  Wed Nov 29 04:49:11 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <ddc797c30611290119mdfa09efy7bca838505ba0be2@mail.gmail.com>
References: <ddc797c30611290119mdfa09efy7bca838505ba0be2@mail.gmail.com>
Message-ID: <20061129094911.GA14587@bartok.itc.it>

On Wed, Nov 29, 2006 at 10:19:01AM +0100, guillaume huby wrote:
>  I found some dirty trick to tell GDAL about it, see my script at:
>  [1]http://mpa.itc.it/markus/useful/modis_hdf2erdas_ll_wgs84.sh
> 
>    Dirty trick, but working trick ! I used the same commands on a MOD09GQK
>    product and get the same result than using MRT.
> 
>    Thank you for this nice job.
> 
>    Guillaume.

Glad to hear that!

Now we only have to figure out why we need the dirty trick.
See also related problem with MODIS LAI:
 http://bugzilla.remotesensing.org/show_bug.cgi?id=1239

(dirty trick also works with that)

cheers,
Markus

-- 
Markus Neteler  <neteler itc it>  http://mpa.itc.it/markus/
ITC-irst -  Centro per la Ricerca Scientifica e Tecnologica
MPBA - Predictive Models for Biol. & Environ. Data Analysis
Via Sommarive, 18        -       38050 Povo (Trento), Italy

From rayg at daylongraphics.com  Wed Nov 29 06:38:29 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <456C6D3D.8020602@pobox.com>
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
	<456B925E.8020806@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>
	<456C6D3D.8020602@pobox.com>
Message-ID: <456D7135.3030003@daylongraphics.com>

fwiw, for those preferring exception-based error reporting all around:

Since GDAL implements return code based error reporting, if you don't 
mind wrapping the GDAL APIs, you can create an exceptions-based 
interface, e.g. if using the GDAL C++ API:

class GDALDataset_plus
{
   public:
     // After normally instancing a dataset, instance a myDataset
     // and assign the original dataset to this member var
     // (or if instancing locally, use the second ctor).
     GDALDataset* m_pDataset;

     GDALDataset_plus() : m_pDataset(NULL) {}
     GDALDataset_plus(GDALDataset* p) : m_pDataset(p) {}
     virtual ~GDALDataset_plus() { if(m_pDataset) delete m_pDataset; }

     void AddBand(type, options)
     {
         assert_ptr(m_pDataset);
         if(CE_None != m_pDataset->AddBand(type, options))
            throw gdal_exception();
     }

     // ... wrappers around remaining GDALDataset methods
};

// ... GDALxxx_plus class versions of remaining GDAL classes


And then you can do stuff like:

   GDALDataset dataset_org;
   GDALDataset_plus dataset(&dataset_org);
   try
   {
      dataset.AddBand(type, options);
      // other stuff, with no checking of return codes
      // since the _plus classes return 'void'
   }
   catch(gdal_exception& e) { msg("GDAL exception occurred"); }
   catch(...) { msg("Unknown error"); }

The wrappers can also be standardized and, if maintained, offered as a 
standard component of the library for those wanting an exception-based 
system. Then one could #include "gdal_plus.h", etc.

The wrappers also enable other niceties, like avoiding having to include 
error variables as arguments (if you always prefer such cases to just 
throw an exception instead), and having the return type of a function 
always be non-error-related. e.g.,
   int foo(void) instead of errcode foo(int* p)

Ray



From dsampson at NRCan.gc.ca  Wed Nov 29 08:03:50 2006
From: dsampson at NRCan.gc.ca (Sampson, David)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] RE: Gdal_translate issues
In-Reply-To: <456D4759.3070108@pobox.com>
Message-ID: <2FAA57395C1F914DB27CAA4C376058F201272478@S0-OTT-X2.nrn.nrcan.gc.ca>

Frank,

Thanks for the feedback.

I guess number one sums up my problem. I would expect the GCP's valid
for the original would be used and re-calculated for the -outsize image
result. However, with it not being the case I now have to figure out the
math to choose new theoretical points.

In my process the GCP's are a combination of identification of the first
image in an aerial flight line. The points to translate them to are
grabbed from a DB and then matched. I have generated code to produce a
batch file that gives a unique coomand line to manupulate each image. As
the scaling factor changes between photo types I was hoping all I had to
replace wast the -outsize % % values given by the user.

Re-computing pixel values will be an interesting endevour.

I will do a test case and see if that resolves my issue.

For number two. Just to clarify, are we both in agreance that in
gdal_translate you should be able to determine the GCP's based on the
origanl and IF the -outsize option is selected then GDAL_translate
calculates what the output GCP's should be?  This would be perfect for
my application. Is there documentatio of how I should prioritize the
bug?  Mainly what P value to use (eg p1 or p4)


About the math. Quick question. I would have to calculate new GCP's for
ALL FOUR point or just three, excluding the upper left?

I don't have a firm grasp of what happens to the pixels when -outsize is
used. It looks like that both pixel numbers and pixel resolution drops.

Cheers



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: November 29, 2006 03:40
To: Sampson, David
Cc: gdal-dev
Subject: Re: Gdal_translate issues

Sampson, David wrote:
> Do you have any fresh ideas of how I can go about my gdal_translate 
> block. To knock my three step process (as posted to the list) to a one

> step process.

Dave,

I've gone through some of your emails, but I got a bit mixed up about
what is the current issue.  First a few clarifications on points that
seemed to be raised.

  1) If you use -outsize to reduce the size of the image at the same
time
     as you are attaching gcps, you will also need to adjust the
pixel/line
     locations of the gcps to be in terms of the reduced image size, not
     the original.  I think this is the core of your problem.

  2) On review, gdal_translate never adjusts the GCP pixel/line
locations,
     though I think it should.  So this should be considered a bug in
     gdal_translate and I'd encourage you to file a bug on the issue,
     especially if it is affecting your ability to function.

  3) You asked if Vincent's bug about GCP projections could be affecting
     you (http://bugzilla.remotesensing.org/show_bug.cgi?id=1354).  I'm
     not sure - it is possible.  So as to feel like I've accomplished
something
     I dug into this issue tonight and fixed it in CVS.

Could you summarize what is still going wrong, with an exact report of
the commands you are using, the gdalinfo reports before and after
transformation and what you think isn't as you would expect it to be?

Best regards,

-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org



From jdgonon at gi-lemans.com  Wed Nov 29 11:14:41 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL/OGR-1.3.2 and ogrinfo.exe
Message-ID: <000f01c713d1$79ad1f70$6469850a@gi.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/jpeg
Size: 21788 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/3ca7c8a5/attachment.jpe
From abhay.menon at gmail.com  Wed Nov 29 12:52:07 2006
From: abhay.menon at gmail.com (abhay menon)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] MapInfo Tab Merger
In-Reply-To: <456C760D.9060108@mapgears.com>
References: <7a30cd70611280818s1f26f669h6167d9700fc02891@mail.gmail.com>
	<456C760D.9060108@mapgears.com>
Message-ID: <7a30cd70611290952i3a71026bk224fe045d51ebb96@mail.gmail.com>

On 11/28/06, Daniel Morissette <dmorissette@mapgears.com> wrote:
>
> Unfortunately the .TAB driver in OGR doesn't support appending data to
> existing files, so you have to write the whole output file in a single
> pass... and I don't think ogr2ogr supports multiple input layers at once
> so you'll have to do a bit of gymnastic to get the result you want.
>
> Here are a couple of options using the MITAB library
> (http://mitab.maptools.org/) directly, which is what OGR uses under the
> hood to read/write TAB datasets. The advantage of working directly with
> MITAB in your case is that it reduces the chances of losing information
> (pen/brush styles, field types, etc) when going from one format to
> another with OGR.
>
> 1- If you can write your own little program in VB or in C then use the
> MITAB C API to write a program that reads in features from multiple
> files and copies them to a single output file. The file mitabc_test.c
> contains sample code that shows how to open files for reading and
> writing. Mapping this code to VB shouldn't be too hard either.
>
> 2- If you don't want to do any programming, then you can use the tab2tab
> program to convert all your source .tab datasets to .mif/.mid. Then
> merge all the .mid files to a single .mid file, do the same with all the
> .mif files, merging them all to a single .mif file after stripping the
> headers of all the .mif files except the first one. If you merge the
> .mid and .mif files in the same order then you can convert the resulting
> .mif/.mid dataset to .tab using tab2tab and you won't have lost any
> information.
>
>
> Oh wait... now that I have written all that, there is an easier
> solution: if you can then create a seamless table in MapInfo (a virtual
> dataset that contains all your indiviual .TAB files) ... then use
> OGR2OGR to convert the seamless .TAB dataset to a single .TAB file
>
> Daniel
>
> abhay menon wrote:
> > Hello List,
> >
> > I have a dataset in MapInfo Tab  format which has multi geometry (point,
> > linestring and polygon) stored in it. I have to append multiple tab
> > files outside MapInfo since this dataset is heavy and take a lot of time
> > in processing (also the table structure for all the files are same in
> > MapInfo Tab format)
> >
> > Is there a way I can do this using OGR?
> >
> > I have tried to store this data in SQLite and then thru SQLite3.exe I
> > merge the tables into one new table but I lose the MapInfo Tab Table
> > Structure(especially the field size) in this process which is important
> > for further purpose.
> >
> > Also tried that with GML too. but it increase the number fields in data
> > structure available (FID of all the TAB's are also inserted as FIELD's)
> > and also it seem to induce some extra feature.. even thought they are
> > not visible..
> >
> > So I need that data final MapInfo TAB. Can anyone help me with this..
> >
> > --
> > Thanks and Regards
> >
> > Abhay Menon
> >
> >
> > ------------------------------------------------------------------------
> >
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@lists.maptools.org
> > http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
> --
> Daniel Morissette
> http://www.mapgears.com/
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


Thanks Daniel,

Well I tried the last option and it worked really well..


-- 
Best Regards

Abhay Menon
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/66d3c568/attachment.html
From matt.wilkie at gov.yk.ca  Wed Nov 29 12:59:30 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] RFE 1369: reading gzipped files in situ (raster.tif.gz)
Message-ID: <456DCA82.9090002@gov.yk.ca>

Hello All, I've run into a fair amount of raster imagery, OnEarth for 
example, which is available gzipped instead of using an internal 
compression. It would be very convenient if gdal could read gzipped 
files in situ. Having to decompress the files to a scratch space first 
means having to keep a lot extra room around to manouver as well writing 
a lot of little throughway scripts. In other applications which do read 
.gz files such as VTP it also seems to be a lot faster to read/write a 
.gz than an uncompressed file. Perhaps because of less disk use (?).

Request For Enhancement #1369
http://bugzilla.remotesensing.org/show_bug.cgi?id=1369

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From mateusz at loskot.net  Wed Nov 29 13:34:51 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL/OGR-1.3.2 and ogrinfo.exe
In-Reply-To: <000f01c713d1$79ad1f70$6469850a@gi.com>
References: <000f01c713d1$79ad1f70$6469850a@gi.com>
Message-ID: <456DD2CB.1040607@loskot.net>

Jean-Daniel GONON wrote:
> Hi
> 
> I could solve my last problem, I thought  it was because of XERCES-C
> 2.7.0 (but it was a bad include library).
> 
> Now, I have an other problem, still about GDAL/OGR-1.3.2 (in original
> version, with XERCES-C 2.7.0 moreover).
> Compilation of gdal.DLL is good, but using of gdal.dll by ogrinfo.exe
> generates two errors in "C:\Program Files\Microsoft Visual Studio .NET
> 2003\Vc7\crt\src\dbgheap.c" file (at the lines 1132 and 1138).

Jean,

This error indicates there must be a bug somewhere that causes heap
corruption. The assertion caught in dbgheap.c file comes from free()
function and says something like this:
"you're trying to free block of memory that can't be deallocated because
of invalid type - not deallocable block."

Unfortunately, without more details, I can't see how to track the
problem down and to find where is the problem in GDAL/ogrinfo.exe.

Could you provide more details about:
1. How did you compile GDAL? Using provided makefile.vc?
2. What operation do you do using ogrinfo.exe?
3. What dataset do you use and can you provide them for testing?


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Wed Nov 29 14:04:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D4550231D874@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D4550231D874@Iris.ad.clarku.edu>
Message-ID: <456DD9C5.50000@loskot.net>

Ivan Lucena wrote:
> I understand that try/catch is useless around GDAL API calls. The
> point is well taken. But if there is a possibility that somebody
> could place a GDALnn.DLL in the system and in that GDALL built there
> is a custom error handling that *does* throws exception, then I think
> that I should keep my extra-precautious try/catch. Is it possible?
> And what is worth?

Ivan,

Yes, in such case your approach is OK.
Here, you can following one of exception safety rule in C++:
"if function can throw an exception, you have to assume it will throw".
So, if someone wraps GDAL adding features/handlers/whatever that can
throw C++ exception, and you're the user of such solution, then you can
assume that you have to catch these exceptions.
Without discussing if such throwing wrapper is designed well and safe or
not.

> Matt, I didn't mention that but I am developing a wrapper, so in this
>  case I am expecting that the application developers will take some
> of the release-resource responsibility to themselves.

Yes, I've supposed it's something like a wrapper.
I think it's a COM, am I right? :-)

> But I understand your point. If I really needed to release any
> *direct dependent resources* that should be done before "return
> E_FAIL". The caller will receive it as an exception.

The most important thing here is that if an exception occurs,
everything that can be released by automatic destructor calls caused by
the exception will be released.
But if there is anything what can't be released that way, then
user/developer has to do it on his own, on exception.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From jmckenna at dmsolutions.ca  Wed Nov 29 14:06:16 2006
From: jmckenna at dmsolutions.ca (Jeff McKenna)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Virtual Spatial connection to PostgreSQL ODBC driver
Message-ID: <456DDA28.3040503@dmsolutions.ca>

I'm attempting to connect to X/Y data stored in a PostgreSQL table (no 
geometry) through OGR:ODBC, and getting the following errors:


ogrinfo ODBC:@mydsn xxx -summary
ERROR 1: No column definitions found for table 'sql_features', layer not 
usable.

ERROR 1: No column definitions found for table 
'sql_implementation_info', layer
not usable.
ERROR 1: No column definitions found for table 'sql_languages', layer 
not usable
.
ERROR 1: No column definitions found for table 'sql_packages', layer not 
usable.

ERROR 1: No column definitions found for table 'sql_sizing', layer not 
usable.
ERROR 1: No column definitions found for table 'sql_sizing_profiles', 
layer not
usable.
INFO: Open of `ODBC:@mydsn'
using driver `ODBC' successful.

Layer name: xxx
Geometry: Unknown (any)
Feature Count: 840
Layer SRS WKT:
(unknown)
nf: Integer (10.0)
pe: Integer (10.0)
ns: Integer (10.0)
nb: Integer (10.0)
qc: Integer (10.0)
on_: Integer (10.0)
...

So for some reason the ODBC:OGR connection cannot find the 
information_schema tables, even though they exist, shown here in psql:


                         List of relations
        Schema       |          Name           | Type  |  Owner
--------------------+-------------------------+-------+----------
  information_schema | sql_features            | table | postgres
  information_schema | sql_implementation_info | table | postgres
  information_schema | sql_languages           | table | postgres
  information_schema | sql_packages            | table | postgres
  information_schema | sql_sizing              | table | postgres
  information_schema | sql_sizing_profiles     | table | postgres
  public             | xxx                     | table | postgres

This becomes a show-stopper when trying to display the layer in MapServer:

   msDrawMap(): Image handling error. Failed to draw layer named 'xxx'. <br>
msOGRFileNextShape(): OGR error. No column definitions found for table 
'sql_sizi
ng_profiles', layer not usable. <br>

These same errors occur with GDAL 1.3.2 and CVS-head.  I'm connecting as 
the postgres user, which owns the information_schema tables and my x/y 
table.

Anyone see what I am doing wrong?

thanks.

jeff


-- 
Jeff McKenna
DM Solutions Group Inc.
http://www.dmsolutions.ca

From jmckenna at dmsolutions.ca  Wed Nov 29 14:12:45 2006
From: jmckenna at dmsolutions.ca (Jeff McKenna)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Virtual Spatial connection to PostgreSQL ODBC driver
In-Reply-To: <456DDA28.3040503@dmsolutions.ca>
References: <456DDA28.3040503@dmsolutions.ca>
Message-ID: <456DDBAD.8030101@dmsolutions.ca>

and all information_schema tables have proper column definitions, for 
example:

   Table "information_schema.sql_sizing_profiles"
      Column     |      Type       | Modifiers
----------------+-----------------+-----------
  sizing_id      | cardinal_number |
  sizing_name    | character_data  |
  profile_id     | character_data  |
  required_value | cardinal_number |
  comments       | character_data  |


jeff




Jeff McKenna wrote:
> I'm attempting to connect to X/Y data stored in a PostgreSQL table (no 
> geometry) through OGR:ODBC, and getting the following errors:
> 
> 
> ogrinfo ODBC:@mydsn xxx -summary
> ERROR 1: No column definitions found for table 'sql_features', layer not 
> usable.
> 
> ERROR 1: No column definitions found for table 
> 'sql_implementation_info', layer
> not usable.
> ERROR 1: No column definitions found for table 'sql_languages', layer 
> not usable
> .
> ERROR 1: No column definitions found for table 'sql_packages', layer not 
> usable.
> 
> ERROR 1: No column definitions found for table 'sql_sizing', layer not 
> usable.
> ERROR 1: No column definitions found for table 'sql_sizing_profiles', 
> layer not
> usable.
> INFO: Open of `ODBC:@mydsn'
> using driver `ODBC' successful.
> 
> Layer name: xxx
> Geometry: Unknown (any)
> Feature Count: 840
> Layer SRS WKT:
> (unknown)
> nf: Integer (10.0)
> pe: Integer (10.0)
> ns: Integer (10.0)
> nb: Integer (10.0)
> qc: Integer (10.0)
> on_: Integer (10.0)
> ...
> 
> So for some reason the ODBC:OGR connection cannot find the 
> information_schema tables, even though they exist, shown here in psql:
> 
> 
>                         List of relations
>        Schema       |          Name           | Type  |  Owner
> --------------------+-------------------------+-------+----------
>  information_schema | sql_features            | table | postgres
>  information_schema | sql_implementation_info | table | postgres
>  information_schema | sql_languages           | table | postgres
>  information_schema | sql_packages            | table | postgres
>  information_schema | sql_sizing              | table | postgres
>  information_schema | sql_sizing_profiles     | table | postgres
>  public             | xxx                     | table | postgres
> 
> This becomes a show-stopper when trying to display the layer in MapServer:
> 
>   msDrawMap(): Image handling error. Failed to draw layer named 'xxx'. <br>
> msOGRFileNextShape(): OGR error. No column definitions found for table 
> 'sql_sizi
> ng_profiles', layer not usable. <br>
> 
> These same errors occur with GDAL 1.3.2 and CVS-head.  I'm connecting as 
> the postgres user, which owns the information_schema tables and my x/y 
> table.
> 
> Anyone see what I am doing wrong?
> 
> thanks.
> 
> jeff
> 
> 

From izzybitsie at gmail.com  Wed Nov 29 14:14:05 2006
From: izzybitsie at gmail.com (Izzy)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] gdal_merge.py Gtiff files with -pct losing color
Message-ID: <23e208430611291114v1f536f19td82af47081121a48@mail.gmail.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: AS_GMSNO_IMinfo.dat
Type: chemical/x-mopac-input
Size: 11043 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/bf60990e/AS_GMSNO_IMinfo.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: AS_GMSNO_gdalinfo.dat
Type: chemical/x-mopac-input
Size: 5501 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/bf60990e/AS_GMSNO_gdalinfo.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: out-pct_gdalinfo.dat
Type: chemical/x-mopac-input
Size: 5495 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/bf60990e/out-pct_gdalinfo.bin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: out_gdalinfo.dat
Type: chemical/x-mopac-input
Size: 1103 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061129/bf60990e/out_gdalinfo.bin
From mateusz at loskot.net  Wed Nov 29 14:57:57 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <456D7135.3030003@daylongraphics.com>
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>	<456B925E.8020806@pobox.com>	<0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>	<456C6D3D.8020602@pobox.com>
	<456D7135.3030003@daylongraphics.com>
Message-ID: <456DE645.50900@loskot.net>

Ray Gardener wrote:
> fwiw, for those preferring exception-based error reporting all around:
> 
> Since GDAL implements return code based error reporting, if you don't
> mind wrapping the GDAL APIs, you can create an exceptions-based
> interface, e.g. if using the GDAL C++ API:
> 
> class GDALDataset_plus
> {
>   public:
>     // After normally instancing a dataset, instance a myDataset
>     // and assign the original dataset to this member var
>     // (or if instancing locally, use the second ctor).
>     GDALDataset* m_pDataset;
> 
>     GDALDataset_plus() : m_pDataset(NULL) {}
>     GDALDataset_plus(GDALDataset* p) : m_pDataset(p) {}
>     virtual ~GDALDataset_plus() { if(m_pDataset) delete m_pDataset; }
> 
>     void AddBand(type, options)
>     {
>         assert_ptr(m_pDataset);
>         if(CE_None != m_pDataset->AddBand(type, options))
>            throw gdal_exception();
>     }
> 
>     // ... wrappers around remaining GDALDataset methods
> };
> 
> // ... GDALxxx_plus class versions of remaining GDAL classes
> 
> 
> And then you can do stuff like:
> 
>   GDALDataset dataset_org;
>   GDALDataset_plus dataset(&dataset_org);

Ray,

This code of usage is ill-formed.
dataset_org is an object with automatic storage duration.
Now, pointer to dataset_org is passed to constructor of
GDALDataset_plus, with implicit *ownership transfer*.
So, it results in m_pDataset pointing to automatic object.

Next, 1) destructor of GDALDataset_plus calls delete on pointer to
automatic object (dataset_org),
2) dataset_org will be destroyed automatically on the scope exit (EOF
object lifetime).

You must not call delete on automatic storage duration objects.

>   try
>   {
>      dataset.AddBand(type, options);
>      // other stuff, with no checking of return codes
>      // since the _plus classes return 'void'
>   }
>   catch(gdal_exception& e) { msg("GDAL exception occurred"); }
>   catch(...) { msg("Unknown error"); }

OK, but the GDALDataset is allocated dynamically and returned by pointer
from GDAL and it needs to be closed and destroyed explicitly by the wrapper.
In the example above, 'dataset' of type of GDALDataset is presented
as local object what's very rare or even impossible situation when using
GDAL.

> The wrappers also enable other niceties, like avoiding having to include
> error variables as arguments (if you always prefer such cases to just
> throw an exception instead), and having the return type of a function
> always be non-error-related. e.g.,
>   int foo(void) instead of errcode foo(int* p)

It's also possible to use smart pointers like shared_ptr with custom
deleter, as a simple wrapper:

boost::shared_ptr<OGRFeature> feature(layer->GetFeature(0),
                                      OGRFeature::DestroyFeature);

Feature object returned by GetFeature will be destroyed properly
by DestroyFeature call.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Wed Nov 29 18:02:26 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] gdal_merge.py Gtiff files with -pct losing color
In-Reply-To: <23e208430611291114v1f536f19td82af47081121a48@mail.gmail.com>
References: <23e208430611291114v1f536f19td82af47081121a48@mail.gmail.com>
Message-ID: <456E1182.8020405@pobox.com>

Izzy wrote:
> Hi,
> I am trying to compose a geotiff satellite image by stitching several 
> satellite geotiff images.
> All of them are one band images with same pseudo color table. 
> When merging the images with -pct to preserve the color table, I get a 
> black image.  When I don't use this option, I get a fainted final 
> picture since the color is now Grey Scale.
> 
> I noticed that the pseudo color table for each of the input images look 
> different if I use gdalinfo and ImageMagick command identify. 
> I attached the gdalinfo and IM info files for one of the input 
> images:AS_GMSNO_gdalinfo.dat and AS_GMSNO_IMinfo.dat and the gdalinfo of 
> the output image obtained using gdal_merge.py  with and without "-pct" 
> option(out-pct_gdalinfo.dat and out_gdalinfo.dat).

Izzy,

The gdalinfo report of the color table in AS_GMSNO_gdalinfo.dat is clearly
badly messed up.  Is this your input file?  Can you provide it to me for
closer inspection?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Nov 29 18:18:59 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] Motion: Commiter Access for Swapnil Hajare
Message-ID: <456E1563.2000903@pobox.com>

Folks,

Motion: Commiter Access for Swapnil Hajare

Swapnil has contributed some fixes to the AIGrid driver and a test script,
and has been hired (by me) for general GDAL maintenance.  Based on his work
for me so far I'm pleased with his ability as a developer, and I'm prepared
to monitor his work until he gets comfortable with GDAL development.  He
has reviewed RFC 3 and agreed to abide by it's guidelines.

Swapnil will also be committing changes on behalf of the other Indictrans
developers and will be responsible for a first level vetting of any changes
they offer.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From MChapman at sanz.com  Wed Nov 29 17:01:31 2006
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D4550231D777@Iris.ad.clarku.edu>
Message-ID: <ED3A48B9840E594890A2BC172D119465092FD1C7@mailman.san.com>

Ivan,

Looks good to me.  If you're using COM though, what might be better is
if you return an error message with something like Error() if your
object implements ISupportErrorInfo.  That way you know what GDAL didn't
like about your file name.

// example pseudo code
if (m_Dataset == NULL)
{
	Error((char*) CPLGetLastErrorMsg(), __uuidof(Ixxxxx));	
      return E_FAIL;
}

Martin Chapman
Software Developer
http://www.earthwhere.com
W - 303.495.6326
C  - 303.898.0397
-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Ivan Lucena
Sent: Tuesday, November 28, 2006 8:45 AM
To: Gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] GDAL CPLError and C++ Exceptions

Hi Matt, Martin, Frank, all,

>> simply check error status after each GDAL call...

That looks like that is the right thing to do. I just want to share the
following piece of code with you guys where I am trying to use the same
approach. I would like to know if I am going in the right direction, if
you don't mind to take a quick look.

// A C++ method:
{
    try
    {
        m_Dataset = (GDALDataset*) GDALOpen(pszFileName, GA_ReadOnly);

        if (m_Dataset == NULL)
        {
            return E_FAIL;
        }

        return S_OK;
    }
    catch(...)
    {
        return E_FAIL;
    }
}

I have debugged it a lot, forcing the error with invalid inputs (null
pointer, invalid file name, invalid network address, etc.), and the
result is that the caller of that method receives the exception nicely
jumping to his own exception handler to do his own stuff as I would like
it to do.

Thanks in advance,

Ivan 


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Tuesday, November 28, 2006 10:17 AM
To: Gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] GDAL CPLError and C++ Exceptions

Ok thanks, that answers my question.   I was thinking I could write my
own error handlers but sounds like that is not a good idea and I just
need to simply check error status after each GDAL call.  Martin - thanks
for the tips in the other posts.

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Mon 11/27/2006 8:35 PM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDAL CPLError and C++ Exceptions



Matt Hanson wrote:
> Hi, I recently got hung up on tracking down an GDAL error because I'm
not
> handling errors from CPLError.   I'd like to be able to handle those
errors
> and create C++ Exceptions but I'm not clear on how to do so.   Anyone
have
> any code examples for how I might turn CPLErrors into Exceptions?   It
looks
> like I should probably set the error handler, but what should that
function
> look like?   Would it simply examine the contents of the GDAL Error
number
> and message and decide to throw or not throw an exception? (which
would then
> be presumably caught in a user's application).

Matt,

I just wanted to add a couple things:

  o You can also install your own error handlers to be called by
CPLError().
    You can find some more information about this at:

      http://www.gdal.org/cpl__error_8h.html

  o However, you should generally *not* throw exceptions from within
such
    an error handler, as GDAL does not guarantee proper cleanup in the
face
    of an exception deep in the internals.  At the very least you are
likely
    to see memory leaks, and quite possible data structures could be
left
    in an improper state.  If you want to throw exceptions, it is best
to do
    it after the GDAL calls, as shown in the other email.

Best regards,
--
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org <http://osgeo.org/> 




_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From rayg at daylongraphics.com  Wed Nov 29 17:24:34 2006
From: rayg at daylongraphics.com (Ray Gardener)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] GDAL CPLError and C++ Exceptions
In-Reply-To: <456DE645.50900@loskot.net>
References: <0719BE42F22E0A46857DF72644EC5D7027861C@pj-exchange.photon.com>
	<456B925E.8020806@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D70278620@pj-exchange.photon.com>
	<456C6D3D.8020602@pobox.com> <456D7135.3030003@daylongraphics.com>
	<456DE645.50900@loskot.net>
Message-ID: <456E08A2.9020203@daylongraphics.com>

Yes, you're absolutely right; my bad, sorry about that. That's what I 
get for hastily coding examples after midnight. :)  The ownership policy 
on original objects needs to be defined better.

Ray


Mateusz Loskot wrote:
> Ray Gardener wrote:
>> fwiw, for those preferring exception-based error reporting all around:
>>
>> Since GDAL implements return code based error reporting, if you don't
>> mind wrapping the GDAL APIs, you can create an exceptions-based
>> interface, e.g. if using the GDAL C++ API:
>>
>> class GDALDataset_plus
>> {
>>   public:
>>     // After normally instancing a dataset, instance a myDataset
>>     // and assign the original dataset to this member var
>>     // (or if instancing locally, use the second ctor).
>>     GDALDataset* m_pDataset;
>>
>>     GDALDataset_plus() : m_pDataset(NULL) {}
>>     GDALDataset_plus(GDALDataset* p) : m_pDataset(p) {}
>>     virtual ~GDALDataset_plus() { if(m_pDataset) delete m_pDataset; }
>>
>>     void AddBand(type, options)
>>     {
>>         assert_ptr(m_pDataset);
>>         if(CE_None != m_pDataset->AddBand(type, options))
>>            throw gdal_exception();
>>     }
>>
>>     // ... wrappers around remaining GDALDataset methods
>> };
>>
>> // ... GDALxxx_plus class versions of remaining GDAL classes
>>
>>
>> And then you can do stuff like:
>>
>>   GDALDataset dataset_org;
>>   GDALDataset_plus dataset(&dataset_org);
> 
> Ray,
> 
> This code of usage is ill-formed.
> dataset_org is an object with automatic storage duration.
> Now, pointer to dataset_org is passed to constructor of
> GDALDataset_plus, with implicit *ownership transfer*.
> So, it results in m_pDataset pointing to automatic object.
> 
> Next, 1) destructor of GDALDataset_plus calls delete on pointer to
> automatic object (dataset_org),
> 2) dataset_org will be destroyed automatically on the scope exit (EOF
> object lifetime).
> 
> You must not call delete on automatic storage duration objects.
> 
>>   try
>>   {
>>      dataset.AddBand(type, options);
>>      // other stuff, with no checking of return codes
>>      // since the _plus classes return 'void'
>>   }
>>   catch(gdal_exception& e) { msg("GDAL exception occurred"); }
>>   catch(...) { msg("Unknown error"); }
> 
> OK, but the GDALDataset is allocated dynamically and returned by pointer
> from GDAL and it needs to be closed and destroyed explicitly by the wrapper.
> In the example above, 'dataset' of type of GDALDataset is presented
> as local object what's very rare or even impossible situation when using
> GDAL.
> 
>> The wrappers also enable other niceties, like avoiding having to include
>> error variables as arguments (if you always prefer such cases to just
>> throw an exception instead), and having the return type of a function
>> always be non-error-related. e.g.,
>>   int foo(void) instead of errcode foo(int* p)
> 
> It's also possible to use smart pointers like shared_ptr with custom
> deleter, as a simple wrapper:
> 
> boost::shared_ptr<OGRFeature> feature(layer->GetFeature(0),
>                                       OGRFeature::DestroyFeature);
> 
> Feature object returned by GetFeature will be destroyed properly
> by DestroyFeature call.
> 
> Cheers


From warmerdam at pobox.com  Thu Nov 30 15:00:50 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug?
In-Reply-To: <20061126162410.GA3996@www.gisnet.com>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
	<20061125154707.GA20888@www.gisnet.com> <45686E4A.10709@pobox.com>
	<20061125175412.GA21284@www.gisnet.com>
	<4568A73E.7070504@loskot.net>
	<20061126162410.GA3996@www.gisnet.com>
Message-ID: <456F3872.10906@pobox.com>

Bill Thoen wrote:
> Mateusz, Frank,
> 
> Thanks for looking into this. I don't really understand what the issue is,
> but even when I don't use the asterisk with the -sql switch, I still get an
> "unknown" geometry. My Postgres/PostGIS table does have an SRID associated
> with it and the geometry column is properly referenced in the
> geometry_columns table.

Bill,

As a work around you should be able to use the AsBinary() function on the
geometry field.  I have dug into this and discovered that the default
return format is Extended WKB (a postgis extension).  I have modified
the  GDAL code in CVS to support this, so now the -sql results work
much better.

> Also, there is still an additional problem with MapInfo output. For
> example, when I try the -where switch with the output being MapInfo Tab,
> the resulting table has no data in the *.id file (the map feature index). 
> 
> This produces a MapInfo table with a corrupt *.id file:
> ogr2ogr -f "MapInfo File" -where "fips='17055'" -a_srs WGS84 test.tab
>   "PG:dbname=spatial1" counties
> 
> But if I issue the same command with the output set to shape file, it
> works. The following command works perfectly:
> 
> ogr2ogr -f "ESRI Shapefile" -where "fips='17055'" -a_srs WGS84 test.shp
>   "PG:dbname=spatial1" counties

In my experience this indicates that no features matchedd the query.
Is it possible fips is a numeric field?  Or perhaps the field name is
actually FIPS?  I believe postgres will  be picky about stuff like this.
And I'm not certain you will get good error messages.

> What do you recommend I do at this point? Is there a workaround for MapInfo
> output?  Should I submit a bug report?  It sounds like you know more about
> what's happening here than I do, but I just wanted to know if I need to do
> anything else.

If you can verify that the -where isn't working, please provide a detailed
bug report.  If you would like an FWTools build with the geometry fix let
me know and I'll prepare one.  If you are building from source you should
be able to grab the nightly cvs snapshot.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dron at ak4719.spb.edu  Wed Nov 29 06:16:07 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061124174117.GA31278@bartok.itc.it>
References: <20061122155454.GA10564@bartok.itc.it>
	<20061124154335.GA28777@ak4719.spb.edu>
	<20061124174117.GA31278@bartok.itc.it>
Message-ID: <20061129111607.GB28881@ak4719.spb.edu>

On Fri, Nov 24, 2006 at 06:41:17PM +0100, Markus Neteler wrote:
> Sorry for that confusion. It is because we are only half through
> with changing all messages to gettext macros. Since GRASS is
> huge this is a long lasting task.
> 
> > My own GRASS build (6.3cvs) does not
> > localized at all, I have EN messages in any locale (probably I should
> > build GRASS with some option enabled?).
> 
> Yes, you need to 'make distclean' and 
>  ./configure --with-nls ...
> to activate the language support.

It seems I am doing something wrong, but I can't get the localization
stuff working! Even with that option enabled...

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From dron at ak4719.spb.edu  Wed Nov 29 06:08:16 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <20061128161606.GD24526@bartok.itc.it>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
	<20061123144925.GB9121@ak4719.spb.edu>
	<1164723173.6758.3.camel@selva.sr.unh.edu>
	<20061128161606.GD24526@bartok.itc.it>
Message-ID: <20061129110816.GA28881@ak4719.spb.edu>

On Tue, Nov 28, 2006 at 05:16:06PM +0100, Markus Neteler wrote:
> MODIS does not use the "Normal Sphere (r=6370997) but 6371007.181
> I got this from:
>  http://edcdaac.usgs.gov/landdaac/tools/mrtswath/info/ReleaseNotes.pdf

GDAL fetches the sphere parameter just fine. For above file I have:

$ gdalinfo -nomd HDF4_EOS:EOS_GRID:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":MOD_Grid_500m_Surface_Reflectance:sur_refl_b01
Driver: HDF4Image/HDF4 Dataset
Size is 2400, 2400
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["Unknown datum based upon the custom spheroid",
        DATUM["Not specified (based on custom spheroid)",
            SPHEROID["Custom spheroid",6371007.181,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Sinusoidal"],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["Meter",1]]
Origin = (-11119505.196667000651360,4447802.078666999936104)
Pixel Size = (463.312716527917246,-463.312716527916677)
Corner Coordinates:
Upper Left  (-11119505.197, 4447802.079) (130d32'26.62"W, 40d 0'0.00"N)
Lower Left  (-11119505.197, 3335851.559) (115d28'12.19"W, 30d 0'0.00"N)
Upper Right (-10007554.677, 4447802.079) (117d29'11.96"W, 40d 0'0.00"N)
Lower Right (-10007554.677, 3335851.559) (103d55'22.97"W, 30d 0'0.00"N)
Center      (-10563529.937, 3891826.819) (115d58'24.91"W, 35d 0'0.00"N)
Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray

> I found some dirty trick to tell GDAL about it, see my script at:
> http://mpa.itc.it/markus/useful/modis_hdf2erdas_ll_wgs84.sh

That looks strange for me. The script overrides sphere parameter in
output file, does it mean that after gdalwarp output file has incorrect
sphere? Or it means that gdalwarp actually warps to WGS84 ellipsoid
instead of normal sphere specified in PROJ.4 string? I am not sure that
the problem is in HDF driver here.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From radim.blazek at gmail.com  Thu Nov 30 04:26:34 2006
From: radim.blazek at gmail.com (Radim Blazek)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] gdal_grass.dll
Message-ID: <340505ef0611300126p56cb0203h38b379e51d2f6715@mail.gmail.com>

Hi.

Where should we place the gdal_grass.dll so that gdal can find it
and register?

Thanks
Radim

From neteler at itc.it  Thu Nov 30 04:30:26 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] warping MODIS data with gdal
In-Reply-To: <20061129110816.GA28881@ak4719.spb.edu>
References: <1164224317.32483.23.camel@selva.sr.unh.edu>
	<20061123144925.GB9121@ak4719.spb.edu>
	<1164723173.6758.3.camel@selva.sr.unh.edu>
	<20061128161606.GD24526@bartok.itc.it>
	<20061129110816.GA28881@ak4719.spb.edu>
Message-ID: <20061130093026.GD25466@bartok.itc.it>

On Wed, Nov 29, 2006 at 02:08:16PM +0300, Andrey Kiselev wrote:
> On Tue, Nov 28, 2006 at 05:16:06PM +0100, Markus Neteler wrote:
> > MODIS does not use the "Normal Sphere (r=6370997) but 6371007.181
> > I got this from:
> >  http://edcdaac.usgs.gov/landdaac/tools/mrtswath/info/ReleaseNotes.pdf
> 
> GDAL fetches the sphere parameter just fine. For above file I have:
> 
> $ gdalinfo -nomd HDF4_EOS:EOS_GRID:"MOD09A1.A2001289.h08v05.004.2003162200605.hdf":MOD_Grid_500m_Surface_Reflectance:sur_refl_b01
> Driver: HDF4Image/HDF4 Dataset
> Size is 2400, 2400
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["Unknown datum based upon the custom spheroid",
>         DATUM["Not specified (based on custom spheroid)",
>             SPHEROID["Custom spheroid",6371007.181,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Sinusoidal"],
>     PARAMETER["longitude_of_center",0],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["Meter",1]]
> Origin = (-11119505.196667000651360,4447802.078666999936104)
> Pixel Size = (463.312716527917246,-463.312716527916677)
> Corner Coordinates:
> Upper Left  (-11119505.197, 4447802.079) (130d32'26.62"W, 40d 0'0.00"N)
> Lower Left  (-11119505.197, 3335851.559) (115d28'12.19"W, 30d 0'0.00"N)
> Upper Right (-10007554.677, 4447802.079) (117d29'11.96"W, 40d 0'0.00"N)
> Lower Right (-10007554.677, 3335851.559) (103d55'22.97"W, 30d 0'0.00"N)
> Center      (-10563529.937, 3891826.819) (115d58'24.91"W, 35d 0'0.00"N)
> Band 1 Block=2400x1 Type=Int16, ColorInterp=Gray
> 
> > I found some dirty trick to tell GDAL about it, see my script at:
> > http://mpa.itc.it/markus/useful/modis_hdf2erdas_ll_wgs84.sh
> 
> That looks strange for me. The script overrides sphere parameter in
> output file, does it mean that after gdalwarp output file has incorrect
> sphere? Or it means that gdalwarp actually warps to WGS84 ellipsoid
> instead of normal sphere specified in PROJ.4 string? I am not sure that
> the problem is in HDF driver here.

Hi Andrey,

I also suspect a problem in gdalwarp rather than the HDF driver.

My bugtracker report contains a link to MODIS for testing which seems to
become shifted if I use the standard gdalwarp procedure while
it works with sphere parameter overriding.

Best regards,
Markus


From neteler at itc.it  Thu Nov 30 04:31:06 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:30 2007
Subject: [Gdal-dev] LOCALE dependent segfault in OGR
In-Reply-To: <20061129111607.GB28881@ak4719.spb.edu>
References: <20061122155454.GA10564@bartok.itc.it>
	<20061124154335.GA28777@ak4719.spb.edu>
	<20061124174117.GA31278@bartok.itc.it>
	<20061129111607.GB28881@ak4719.spb.edu>
Message-ID: <20061130093106.GE25466@bartok.itc.it>

On Wed, Nov 29, 2006 at 02:16:07PM +0300, Andrey Kiselev wrote:
> On Fri, Nov 24, 2006 at 06:41:17PM +0100, Markus Neteler wrote:
> > Sorry for that confusion. It is because we are only half through
> > with changing all messages to gettext macros. Since GRASS is
> > huge this is a long lasting task.
> > 
> > > My own GRASS build (6.3cvs) does not
> > > localized at all, I have EN messages in any locale (probably I should
> > > build GRASS with some option enabled?).
> > 
> > Yes, you need to 'make distclean' and 
> >  ./configure --with-nls ...
> > to activate the language support.
> 
> It seems I am doing something wrong, but I can't get the localization
> stuff working! Even with that option enabled...

... answered offlist since this problem is GRASS related.

Markus

From fabrice.lallauret at thalesgroup.com  Thu Nov 30 04:57:06 2006
From: fabrice.lallauret at thalesgroup.com (LALLAURET Fabrice - <SSII>)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] problem with polygonz shapefile and ArcExplorer ...
Message-ID: <456EAAF2.7090201@thalesgroup.com>

Hi,
I have a problem with the shapefile driver in the 1.3.2 release of OGR. 
The shapefiles seems good with ArcMap or ogrinfo but can't be display 
with ArcExplorer 9.1 (Linux & windows)
(the console of ArcExplorer display the following message : > Nov 29, 
2006 6:28:41 PM:    com.esri.mo.file.shp.db 
com.esri.mo.file.shp.InvalidShapeException: 1 invalid shape/s were 
detected in ...)
I've tried with ogr 1.3.1 and it works.
The problem seems to be the addition of the "bMeasureIsUsed" in the 
shpopen.c file. When I force it to TRUE, the generated shapefile can be 
succefully display in ArcExplorer.
Why this flag act on SHPT_POLYGONZ type ?

I have attached to create a small shapefile which I can't display on 
ArcExplorer

Regards

-- 
     .--.    Fabrice LALLAURET - PSV Team
    |o_o |   Tel: (33) (01 34) 22 84 33
    |:_/ |   Thales Training & Simulation
   //   \ \  1, rue du General de Gaulle
  (|     | ) Z.I. les beaux soleils
 /'\_   _/`\ Osny. B.P. 226
 \___)=(___/ 95523 Cergy-Pontoise Cedex
 E-mail: fabrice.lallauret@thalesgroup.com
 "Power corrupts. PowerPoint corrupts absolutely."
 My personnal (french) Websites: http://www.xbee.net
 and http://www.french-comics-zone.fr.st


-------------- next part --------------
#include "ogrsf_frmts.h"
#include "cpl_conv.h"
#include "cpl_string.h"

/************************************************************************/
/*                                main()                                */
/************************************************************************/

int main( int nArgc, char ** papszArgv )

{
    const char *pszFormat = "ESRI Shapefile";
    const char *pszOutputName = "test.shp";

    OGRRegisterAll();

    OGRDataSource *poDstDS;
    OGRLayer *poDstLayer = NULL;

    OGRSFDriverRegistrar     *poR = OGRSFDriverRegistrar::GetRegistrar();
    OGRSFDriver              *poDriver = NULL;
    int                      iDriver;

    for( iDriver = 0;
            iDriver < poR->GetDriverCount() && poDriver == NULL;
            iDriver++ )
    {
        if( EQUAL(poR->GetDriver(iDriver)->GetName(),pszFormat) )
        {
            poDriver = poR->GetDriver(iDriver);
        }
    }


    poDstDS = poDriver->CreateDataSource( pszOutputName, NULL );

    OGREnvelope sExtents;
    OGRPolygon oRegion;
    OGRLinearRing oRing;

    /*
       oRing.addPoint( -1.0, -1.0 , 0.0 );
       oRing.addPoint( -1.0, 1.0 , 0.0 );
       oRing.addPoint( 1.0, -1.0 , 0.0 );
       oRing.addPoint( -1.0, -1.0 , 0.0 );
       */

    /*
       oRing.addPoint( 9.080074, 52.269425, 0.000000 );
       oRing.addPoint( 9.080936, 52.268975, 0.000000 );
       oRing.addPoint( 9.081471, 52.269088, 0.000000 );
       oRing.addPoint( 9.080074, 52.269425, 0.000000 );
       */

    oRing.addPoint( 0.0, 0.0 , 0.0 );
    oRing.addPoint( 0.0, 0.1 , 0.0 );
    oRing.addPoint( 0.1, 0.0 , 0.0 );
    oRing.addPoint( 0.0, 0.0 , 0.0 );

    oRegion.addRing( &oRing );

    poDstLayer = poDstDS->CreateLayer( "tileindex" );
    OGRFeature  oTileFeat( poDstLayer->GetLayerDefn() );

    oTileFeat.SetGeometry( &oRegion );

    if( poDstLayer->CreateFeature( &oTileFeat ) != OGRERR_NONE )
    {
        printf( "Failed to create feature on tile index ... terminating." );
        delete poDstDS;
        exit( 1 );
    }

    delete poDstDS;

    return 0;
}

From mseiler at uni-bonn.de  Thu Nov 30 05:23:40 2006
From: mseiler at uni-bonn.de (mseiler@uni-bonn.de)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] make fails with [ogr-target] Error 2
Message-ID: <web-39729892@uni-bonn.de>

Hi all,

I encounter difficulties with compiling gdal 1.3.2 on my 
SuSE 10.0 machine.  Make fails with the following error. 
 Since I am quite unexperienced with compiling myself I 
can't figure out what goes wrong here- and couldn't find 
anything online...

Any help is appreciated!

Thanks in advance!

Martin

In file included from ogrgeometryfactory.cpp:127:
ogr_geos.h:49:25: error: geos/geom.h: No such file or 
directory
ogr_geos.h:50:23: error: geos/io.h: No such file or 
directory
ogr_geos.h:51:25: error: geos/util.h: No such file or 
directory
ogrgeometryfactory.cpp: In static member function 'static 
OGRGeometry* 
OGRGeometryFactory::createFromGEOS(GEOSGeom_t*)':
ogrgeometryfactory.cpp:853: error: 'geos' has not been 
declared
ogrgeometryfactory.cpp:853: error: 'WKTWriter' was not 
declared in this scope
ogrgeometryfactory.cpp:853: error: expected `;' before 
'oWKTWriter'
ogrgeometryfactory.cpp:858: error: 'oWKTWriter' was not 
declared in this scope
ogrgeometryfactory.cpp:858: error: 'geos' has not been 
declared
ogrgeometryfactory.cpp:858: error: 'Geometry' was not 
declared in this scope
ogrgeometryfactory.cpp:858: error: expected 
primary-expression before ')' token
ogrgeometryfactory.cpp:860: error: 'geos' has not been 
declared
ogrgeometryfactory.cpp:860: error: expected type-specifier
ogrgeometryfactory.cpp:860: error: expected `)' before '*' 
token
ogrgeometryfactory.cpp:860: error: expected `{' before '*' 
token
ogrgeometryfactory.cpp:860: error: 'e' was not declared in 
this scope
ogrgeometryfactory.cpp:860: error: expected `;' before ')' 
token
ogrgeometryfactory.cpp: In static member function 'static 
void* OGRGeometryFactory::getGEOSGeometryFactory()':
ogrgeometryfactory.cpp:889: error: 'geos' has not been 
declared
ogrgeometryfactory.cpp:889: error: expected initializer 
before '*' token
ogrgeometryfactory.cpp:891: error: 'poSavedFactory' was 
not declared in this scope
ogrgeometryfactory.cpp:892: error: 'geos' has not been 
declared
ogrgeometryfactory.cpp:892: error: expected type-specifier
ogrgeometryfactory.cpp:892: error: expected `;'
ogrgeometryfactory.cpp:894: error: 'poSavedFactory' was 
not declared in this scope
make[1]: *** [ogrgeometryfactory.o] Error 1
make[1]: Leaving directory 
`/media/tc/progs/grass/gdal-1.3.2/ogr'
make: *** [ogr-target] Error 2


From dmorissette at mapgears.com  Thu Nov 30 08:46:06 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Motion: Commiter Access for Swapnil Hajare
In-Reply-To: <456E1563.2000903@pobox.com>
References: <456E1563.2000903@pobox.com>
Message-ID: <456EE09E.7040303@mapgears.com>

Frank Warmerdam wrote:
> 
> Motion: Commiter Access for Swapnil Hajare
> 
> Swapnil has contributed some fixes to the AIGrid driver and a test script,
> and has been hired (by me) for general GDAL maintenance.  Based on his work
> for me so far I'm pleased with his ability as a developer, and I'm prepared
> to monitor his work until he gets comfortable with GDAL development.  He
> has reviewed RFC 3 and agreed to abide by it's guidelines.
> 
> Swapnil will also be committing changes on behalf of the other Indictrans
> developers and will be responsible for a first level vetting of any changes
> they offer.
> 

+1

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From warmerdam at pobox.com  Thu Nov 30 09:21:22 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] gdal_grass.dll
In-Reply-To: <340505ef0611300126p56cb0203h38b379e51d2f6715@mail.gmail.com>
References: <340505ef0611300126p56cb0203h38b379e51d2f6715@mail.gmail.com>
Message-ID: <456EE8E2.2030002@pobox.com>

Radim Blazek wrote:
> Hi.
> 
> Where should we place the gdal_grass.dll so that gdal can find it
> and register?

Radim,

Looking at the code, it would appear that you can out plugins in a
gdalplugins subdirectory of whatever directory the current executable
comes from.  If you want to put it somewhere else, you will need to
define the GDAL_DRIVER_PATH environment variable or config variable
to point to the directory to be searched.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From andrey.kiselev at gmail.com  Thu Nov 30 09:56:27 2006
From: andrey.kiselev at gmail.com (Andrey Kiselev)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Motion: Commiter Access for Swapnil Hajare
In-Reply-To: <456E1563.2000903@pobox.com>
References: <456E1563.2000903@pobox.com>
Message-ID: <29bcc0df0611300656s3c09cad1p411385d934a70ae8@mail.gmail.com>

On 11/30/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Motion: Commiter Access for Swapnil Hajare
>
> Swapnil has contributed some fixes to the AIGrid driver and a test script,
> and has been hired (by me) for general GDAL maintenance.  Based on his work
> for me so far I'm pleased with his ability as a developer, and I'm prepared
> to monitor his work until he gets comfortable with GDAL development.  He
> has reviewed RFC 3 and agreed to abide by it's guidelines.
>
> Swapnil will also be committing changes on behalf of the other Indictrans
> developers and will be responsible for a first level vetting of any changes
> they offer.

+1

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From bthoen at gisnet.com  Thu Nov 30 11:23:24 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Error making GDAL CVS daily "snapshot"
Message-ID: <20061130162324.GA28690@www.gisnet.com>

I just tried to build the latest version of GDAL from the CVS daily
snapshot and got this error:

[stuff clipped]...
g++: /usr/lib/libidn.so: No such file or directory
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/home/bthoen/gdal-cvs-2006.11.30'
make: *** [check-lib] Error 2

Sure enough, when I look in /usr/local/lib, libidn.so is not there. but the
gdal libraries from when I last built the official 1.10.0 release are
there.

$ ls -al /usr/local/lib | grep gdal
-rw-r--r--  1 root root  7629336 Sep 11 13:09 libgdal.a
-rwxr-xr-x  1 root root      912 Sep 11 13:09 libgdal.la
lrwxrwxrwx  1 root root       17 Sep 11 13:09 libgdal.so -> libgdal.so.1.10.0
lrwxrwxrwx  1 root root       17 Sep 11 13:09 libgdal.so.1 -> libgdal.so.1.10.0
-rwxr-xr-x  1 root root  4355642 Sep 11 13:09 libgdal.so.1.10.0

I've also set LD_LIBRARY_PATH to /usr/local/lib and run ldconfig (just
wildly stabbing at anything that looks good) and tried 'make install'
again. No luck. 

Does anyone know how I can fix this?

- Bill Thoen

From mateusz at loskot.net  Thu Nov 30 11:51:23 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Re: [FWTools] Debugging under Windows XP and Visual
	Studio .Net
In-Reply-To: <791EC13C703A664DB577C3763273F6018D9A81@ska-wn-e07.ptv.ptv.de>
References: <791EC13C703A664DB577C3763273F6018D9A81@ska-wn-e07.ptv.ptv.de>
Message-ID: <456F0C0B.1010203@loskot.net>

Martin Fix wrote:
 > How could I build a solution for VC7 or VC8 to debug the GDAL code
> itself? I then can make a small test program just to test the things
> I need to know. Has anybody done this before?

I compile GDAL on Windows (nmake /f makefile.vc + debug flags inside
nmake.opt) and leave GDAL DLL and import library inside the gdal
directory, the sources tree.
Next, I create program under VC++ 2005 and configure project file to
link against library inside the gdal directory:

1. Add path to 'gdal' directory to:

Properties -> Linker -> Additional Library Directories

2. Add gdal_i.lib to:

Properties -> Linker -> Input -> Additional Dependencies

Next, add the path to 'gdal' directory, where also GDAL DLL lives,
to PATH environment from the Visual C++ IDE, so the GDAL DLL can be
found when executing your program from the IDE:

Go to project Properties -> Debugging -> Environment
and into the textbox put something like this:

PATH=D:\my\path\to\gdal

Then, you can set breakpoints directly inside GDAL sources.
You can also use F11 to step into the GDAL function calls from your
application.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Nov 30 14:01:36 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Error making GDAL CVS daily "snapshot"
In-Reply-To: <20061130162324.GA28690@www.gisnet.com>
References: <20061130162324.GA28690@www.gisnet.com>
Message-ID: <456F2A90.8060207@pobox.com>

Bill Thoen wrote:
> I just tried to build the latest version of GDAL from the CVS daily
> snapshot and got this error:
> 
> [stuff clipped]...
> g++: /usr/lib/libidn.so: No such file or directory
> make[1]: *** [libgdal.la] Error 1
> make[1]: Leaving directory `/home/bthoen/gdal-cvs-2006.11.30'
> make: *** [check-lib] Error 2

Bill,

You might try editing GDALmake.opt and removing libidn (or -lidn) from the
link library list.  I had never heard of it before, but a google search
suggests:

   http://www.gnu.org/software/libidn/

I imagine it is a dependency of one of the things that gdal depends on,
though I don't know why this would have changed from 1.3.2.

Best regards,
-----------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From bthoen at gisnet.com  Thu Nov 30 16:29:06 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Error making GDAL CVS daily "snapshot"
In-Reply-To: <456F2A90.8060207@pobox.com>
References: <20061130162324.GA28690@www.gisnet.com>
	<456F2A90.8060207@pobox.com>
Message-ID: <20061130212906.GA30571@www.gisnet.com>

Apparently lidn is a curl thing. I tried ./configure --without-curl, but
that didn't work. Then I tried removing $(CURL_LIB) from the LIBS list in
GDALmake.opt, and that didn't work because several other things wanted to
reference those libraries. SO I finally uninstalled curl, and probably broke
a bunch of other stuff in OpenOffice (sigh! 'yum remove' seems to be very
thorough) but then GDAL built just fine.

On Thu, Nov 30, 2006 at 02:01:36PM -0500, Frank Warmerdam wrote:
> Bill Thoen wrote:
> >I just tried to build the latest version of GDAL from the CVS daily
> >snapshot and got this error:
> >
> >[stuff clipped]...
> >g++: /usr/lib/libidn.so: No such file or directory
> >make[1]: *** [libgdal.la] Error 1
> >make[1]: Leaving directory `/home/bthoen/gdal-cvs-2006.11.30'
> >make: *** [check-lib] Error 2
> 
> Bill,
> 
> You might try editing GDALmake.opt and removing libidn (or -lidn) from the
> link library list.  I had never heard of it before, but a google search
> suggests:
> 
>   http://www.gnu.org/software/libidn/
> 
> I imagine it is a dependency of one of the things that gdal depends on,
> though I don't know why this would have changed from 1.3.2.
> 
> Best regards,
> -----------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
> 

From warmerdam at pobox.com  Thu Nov 30 19:32:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Error making GDAL CVS daily "snapshot"
In-Reply-To: <20061130212906.GA30571@www.gisnet.com>
References: <20061130162324.GA28690@www.gisnet.com>
	<456F2A90.8060207@pobox.com>
	<20061130212906.GA30571@www.gisnet.com>
Message-ID: <456F7815.505@pobox.com>

Bill Thoen wrote:
> Apparently lidn is a curl thing. I tried ./configure --without-curl, but
> that didn't work. Then I tried removing $(CURL_LIB) from the LIBS list in
> GDALmake.opt, and that didn't work because several other things wanted to
> reference those libraries. SO I finally uninstalled curl, and probably broke
> a bunch of other stuff in OpenOffice (sigh! 'yum remove' seems to be very
> thorough) but then GDAL built just fine.

Bill,

Configuring --without-curl should have fixed the problem, but after
changing your configuration it is generally necessary to do a
manual "make clean" before you rebuild.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From bthoen at gisnet.com  Thu Nov 30 17:46:10 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] ogr2ogr MapINfo bug? - FIXED!
In-Reply-To: <456F3872.10906@pobox.com>
References: <20061124213811.GA16816@www.gisnet.com>
	<45678591.8020704@pobox.com>
	<20061125154707.GA20888@www.gisnet.com> <45686E4A.10709@pobox.com>
	<20061125175412.GA21284@www.gisnet.com>
	<4568A73E.7070504@loskot.net>
	<20061126162410.GA3996@www.gisnet.com> <456F3872.10906@pobox.com>
Message-ID: <20061130224610.GA30806@www.gisnet.com>

Thanks Frank,

Whatever you changed in yesterday's daily GDAL build worked! Now when I try:

ogr2ogr -f "MapInfo File" 
  -sql "select * from counties where fips in ('17055','17199','17077');"
  -a_srs WGS84 test.tab "PG:dbname=spatial1"

or 

ogr2ogr -f "MapInfo File" 
  -where "fips in ('17055','17199','17077')" 
  -a_srs WGS84 test.tab "PG:dbname=spatial1" counties

I now get all the map features with the data. This was not producing map
features before. I think one still needs to specify an output SRS, because
ogrinfo still says that the geometry and SRS are unknown when you use an
asterisk with the -sql switch, but valid geometries are produced now
nevertheless.

But there is still one glitch with the data. The size of all the output
text fields goes up to 255 characters, even if they were specified as
varchar(5), varchar(30), etc. in the Postgres data file. If I stored these
as char(5), char(30), etc. would the sizes be preserved?

Thanks for the speedy fix!! 

- Bill Thoen


From dfriberg23 at gmail.com  Thu Nov 30 19:06:36 2006
From: dfriberg23 at gmail.com (David Friberg)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Reading from Overviews with GDALDataset
In-Reply-To: <456A3CCF.10502@pobox.com>
References: <481948e30611252126n2c9964c2y5fd57cfe9626d73c@mail.gmail.com>
	<456A3CCF.10502@pobox.com>
Message-ID: <481948e30611301606ke60ac5en18523aa15959bd39@mail.gmail.com>

So it sounds like you are saying that if I read using
GDALDataset::RasterIO, passing the same number for both PixelSpace and
LineSpace, an attempt will be made to use an overview sampled at the
requested rate to fullfill that read request.  Correct?

For my purposes, I want to read portions of external image files at
some resolution only if those files actually contain image data at
that resolution; I do not want GDAL to do any sampling.  So I suppose
I will also need to query one of the GDALRasterBands comprising the
dataset in order to get the number of overviews (presumably could use
the first band in the dataset?).

Dave

On 11/26/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> David Friberg wrote:
> > Hi,
> >
> > I need a way to read from Overviews using GDALDataset::RasterIO or
> > similar, i.e. one call to read retrieves data for bands.  I don't see
> > a way to do this without getting each band and reading separately.
> >
> > Am I missing something, or is this the only way to do it?
>
> David,
>
> Normally if you do a RasterIO() call against a normal band at a reduced
> resolution, the GDAL machinery will automatically use appropriate overviews.
>
> If you want to specifically control which overview you use, you can fetch
> back the overview GDALRasterBand object, and access it yourself.  But this
> is very rarely necessary.
>
> I did write a little application in gdal/apps called dumpoverviews for
> dumping out the overviews, but it mainly useful for various kinds of
> detailed testing of overviews in new file formats.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>

From warmerdam at pobox.com  Thu Nov 30 19:40:13 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Reading from Overviews with GDALDataset
In-Reply-To: <481948e30611301606ke60ac5en18523aa15959bd39@mail.gmail.com>
References: <481948e30611252126n2c9964c2y5fd57cfe9626d73c@mail.gmail.com>
	<456A3CCF.10502@pobox.com>
	<481948e30611301606ke60ac5en18523aa15959bd39@mail.gmail.com>
Message-ID: <456F79ED.9090705@pobox.com>

David Friberg wrote:
> So it sounds like you are saying that if I read using
> GDALDataset::RasterIO, passing the same number for both PixelSpace and
> LineSpace, an attempt will be made to use an overview sampled at the
> requested rate to fullfill that read request.  Correct?

Dave,

Your basic idea is right, but what overview is used is determined based
on the ratio of the nXSize * nYSize region on file relative to the
nBufXSize * nBufYSize buffer size.  The pixel and line spacing values
are just to control how data is organized in the buffer.

> For my purposes, I want to read portions of external image files at
> some resolution only if those files actually contain image data at
> that resolution; I do not want GDAL to do any sampling.  So I suppose
> I will also need to query one of the GDALRasterBands comprising the
> dataset in order to get the number of overviews (presumably could use
> the first band in the dataset?).

You would likely be best grabbing the overview GDALRasterBand objects
and reading at full resolution from them if you want to be sure that
no sampling takes place.

Note that for some file formats there may actually be different
overviews built on different bands though this is quite uncommon.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From benkelman at yahoo.com  Thu Nov 30 19:49:54 2006
From: benkelman at yahoo.com (Cody Benkelman)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Support for LIDAR data, LAS format?
Message-ID: <002501c714e2$9e780a60$0e19000a@Asimov>


Apologies for cross-posting - I posted this previously on the GeoTIFF
list...

Has anyone added support for LIDAR data in LAS format?

Thanks 

Cody Benkelman


> -----Original Message-----
> From: Cody Benkelman [mailto:benkelman@yahoo.com]
> Sent: Monday, November 27, 2006 10:55 AM
> To: geotiff@lists.maptools.org
> Subject: Support for LIDAR data, LAS format?
> 
> I'm seeking an update with regard to LIDAR data, in LAS format.  I 
> found the exchange copied at bottom in the archive:
> http://lists.maptools.org/pipermail/gdal-dev/2004-June/003599.html
> 
> ...but I don't see LAS or LIDAR in the current GDAL format list.  May 
> I assume support for LAS format has not yet been added to GDAL?
> 
> Thanks
> 
> Cody A. Benkelman
> ASPRS Certified Mapping Scientist - Remote Sensing (#RS-144) 
> Whitefish, Montana  59937 cell (406) 270-1176
> 
> 
> 
> [Gdal-dev] Re: LIDAR .las file format
> John Nipper jnipper at bhinc.com
> Thu Jun 24 18:44:48 EDT 2004
> 
> Previous message: [Gdal-dev] LIDAR .las file format Next message: 
> [Gdal-dev] reprojecting Messages sorted by: [ date ] [ thread ] [ 
> subject ] [ author ]
> 
> --------------------------------------------------------------
> ----------
> --------
> 
> Chapman, Martin <MChapman <at> sanz.com> writes:
> 
> > 
> > 
> > All,
> >  
> > Has anyone written a
> > driver for the LIDAR (.las) file format for GDAL?  
> >  
> > 
> > Martin Chapman
> > Cell 303-885-1936
> > Office
> > 303-660-3933 x226
> > mchapman <at> sanz.com
> > http://www.sanz.com
> > 
> >  
> >  
> > 
> > 
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev <at> remotesensing.org
> > http://xserve.flids.com/mailman/listinfo/gdal-dev
> > 
> 
> I have written utilities that read/write las format.  I have not seen 
> anything that is open source, or for GDAL yet.  I would be happy to 
> help out with such a driver, if I can get permission to do so ...  At 
> a minimum, I can answer questions about the format if anyone needs.
> 
> Thanks,
> John Nipper
> 505 798-7907 direct office line
> jnipper at bhinc.com
> 
> 
> 


From opcode at telus.net  Wed Nov 29 19:11:54 2006
From: opcode at telus.net (opcode@telus.net)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Newbie needs help with RGB images
Message-ID: <1164845514.456e21ca54cfe@webmail.telus.net>

I'm just getting started with GDAL in my code( 1 day under my belt :-) ) and 
am looking for some direction on how to load a GeoTiff (or other ) image and 
convert it to a RGB image buffer. The tiff image is 20,000 x 24000 x 3 and I 
want to downsample it into a 1024 x 1024 x 3 RGB image. 

I am thinking I can get it one band at a time with the dataset->RasterIO 
method and changing the offset each pass but this is likely to be very slow as 
it will downsample the entire image for each band. Is there any way to 
directly create the interleaved RGB?

Thanks
Frank




From Shawn.Gong at drdc-rddc.gc.ca  Mon Nov 27 15:54:47 2006
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] gdalwarp problem
Message-ID: <2E58C246F17003499C141D334794D049D5872A@ottawaex02.Ottawa.drdc-rddc.gc.ca>

Hi list,

When I tried to reproject a tiff file from UTM to lat/lon, the following
error message appeared:

Command: gdalwarp -t_srs "+proj=latlong +datum=WGS84" src.tif target.tif

ERROR 1: Too many points (441 out of 441) failed to transform, unable to
compute output bounds.

Please help.

SG



From craigfeuerherdt at gmail.com  Mon Nov 27 19:03:00 2006
From: craigfeuerherdt at gmail.com (Craig Feuerherdt)
Date: Wed Nov 21 11:50:31 2007
Subject: [Gdal-dev] Error accessing Pgeo through ODBC
Message-ID: <442163630611271603n6155ba9dk6339018c4348c2e2@mail.gmail.com>

Have configured OGR to access Personal Geodatabase using the instructions
provided on the web site.
I am using Gentoo Linux.

This is a copy of my .odbc.ini file:
[b_pgeo]
Description = Boundaries PGeo Database
Driver      = Microsoft Access Driver (*.mdb)
Database    = /data/software/ORIENTEERING/boundaries.mdb
Host        = localhost
Port        = 1360
User        = craig
Password    =
Trace       = Yes
TraceFile   = /home/craig/odbc.log

When I attempt to use ogrinfo I get the following errors:

ogrinfo PGeo:b_pgeo
ERROR 1: /usr/grass-6.1.0/lib/libgrass_vask.so: undefined symbol: stdscr
ERROR 1: /usr/grass-6.1.0/lib/libgrass_vask.so: undefined symbol: stdscr
Segmentation fault

I can not work out why the error involves GRASS?

Thannks in advance,

Craig Feuerherdt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20061128/5d7ac61e/attachment.html
