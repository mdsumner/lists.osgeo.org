From ben at vterrain.org  Fri Oct  1 04:04:10 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] GDAL 1.2.3 Formally Released
In-Reply-To: <415ABB6F.6080705@pobox.com>
Message-ID: <009501c4a78d$3bcf86a0$f400fe0a@TOPP2>


For those interested, i have created a new revision of the VC7.1 project
files for GDAL 1.2.3.  To use them, just unzip it to your GDAL source
directory, load the solution and build.
  http://vterrain.org/dist/gdal_123_vc71.zip  (26k)

-Ben


From dem at acri-st.fr  Fri Oct  1 09:50:10 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] TIFF with JPEG compression on Win32
Message-ID: <6.1.1.1.0.20041001153954.06415ae8@pop3>

Hi,

I don't know why but my gdal Win32 build doesn't support read or write TIFF 
with JPEG compression, but my Linux and Solaris builds work well :

read error:
Input file size is 2044, 1704
0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
464, caller expects 432
Assertion failed: sp->cinfo.comm.is_decompressor, file tif_jpeg.c, line 606

write error:
Input file size is 2044, 1704
0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
376, caller expects 360
ERROR 1: JPEGLib:Improper call to JPEG library in state 0
ERROR 1: TIFFWriteScanline failed.
ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
376, caller expects 360

I compile my Win32 build with VC6 with netCDF, MrSID 4 and Kakadu support 
and with /Ox /MD /EHsc flags and /NODEFAULTLIB:LIBC linker flag.

I've tested with the OpenEV_FW 1.8.2 package and it works well...

If anyone has ideas of the causes, or similar problem....

Thanks in advance,

Julien


From warmerdam at pobox.com  Fri Oct  1 09:53:29 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] TIFF with JPEG compression on Win32
In-Reply-To: <6.1.1.1.0.20041001153954.06415ae8@pop3>
References: <6.1.1.1.0.20041001153954.06415ae8@pop3>
Message-ID: <415D6159.7000304@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> I don't know why but my gdal Win32 build doesn't support read or write 
> TIFF with JPEG compression, but my Linux and Solaris builds work well :
> 
> read error:
> Input file size is 2044, 1704
> 0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size 
> is 464, caller expects 432
> Assertion failed: sp->cinfo.comm.is_decompressor, file tif_jpeg.c, line 606
> 
> write error:
> Input file size is 2044, 1704
> 0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size 
> is 376, caller expects 360
> ERROR 1: JPEGLib:Improper call to JPEG library in state 0
> ERROR 1: TIFFWriteScanline failed.
> ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
> 376, caller expects 360
> 
> I compile my Win32 build with VC6 with netCDF, MrSID 4 and Kakadu 
> support and with /Ox /MD /EHsc flags and /NODEFAULTLIB:LIBC linker flag.
> 
> I've tested with the OpenEV_FW 1.8.2 package and it works well...
> 
> If anyone has ideas of the causes, or similar problem....

Julien,

This is a common problem.  Are you building with an external libjpeg or
the built in copy?  The built-in copy is supposed to work fine but there
are things that need to be tweaked with an external copy.  Andrey knows the
details but he may not be able to answer email today.

I ended up hacking tif_jpeg.c for my OpenEV_FW 1.8.2 build a bit but Andrey's
suggestion was actually to slightly modify the jconfig.h file in libjpeg.
However, I didn't keep track of the details.

It all relates to differing sizes for the bool type, and the need to keep
them consistent between how things are built for tif_jpeg.c and within libjpeg
itself.   If you search for "boolean" in tif_jpeg.c you will see some
discussion of the issue.  There is also at least one bugzilla report on
the problem though I don't have a link off hand.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From nhv at cape.com  Fri Oct  1 09:57:03 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] TIFF with JPEG compression on Win32
In-Reply-To: <6.1.1.1.0.20041001153954.06415ae8@pop3>
Message-ID: <EKEJIKAILPONGGENMBGAIEELIPAA.nhv@cape.com>

Julien Demaria writes:
> 
> I don't know why but my gdal Win32 build doesn't support read or write TIFF 
> with JPEG compression, but my Linux and Solaris builds work well :
> 
> read error:
> Input file size is 2044, 1704
> 0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
> 464, caller expects 432
> Assertion failed: sp->cinfo.comm.is_decompressor, file tif_jpeg.c, line 606
> 
> write error:
> Input file size is 2044, 1704
> 0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
> 376, caller expects 360
> ERROR 1: JPEGLib:Improper call to JPEG library in state 0
> ERROR 1: TIFFWriteScanline failed.
> ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
> 376, caller expects 360
> 
> I compile my Win32 build with VC6 with netCDF, MrSID 4 and Kakadu support 
> and with /Ox /MD /EHsc flags and /NODEFAULTLIB:LIBC linker flag.
> 
> I've tested with the OpenEV_FW 1.8.2 package and it works well...
> 
> If anyone has ideas of the causes, or similar problem....

You are compiling against two different jpeg installations
see thread starting here
http://mapserver.gis.umn.edu/data2/wilma/mapserver-users/0304/msg00023.html

HTH

Norman

From route at cae.com  Fri Oct  1 11:31:10 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] rotations in Get/SetGeoTransform
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D173@caemsx03.cae.ca>

Hi,

I have questions about the parameters of the Get/StegetTransform method.
As reminder :
    adfGeoTransform[0] /* top left x */
    adfGeoTransform[1] /* w-e pixel resolution */
    adfGeoTransform[2] /* rotation, 0 if image is "north up" */
    adfGeoTransform[3] /* top left y */
    adfGeoTransform[4] /* rotation, 0 if image is "north up" */
    adfGeoTransform[5] /* n-s pixel resolution */


void GDALApplyGeoTransform( double *padfGeoTransform, 
                            double dfPixel, double dfLine, 
                            double *pdfGeoX, double *pdfGeoY )
{
    *pdfGeoX = padfGeoTransform[0] + dfPixel * padfGeoTransform[1]
                                   + dfLine  * padfGeoTransform[2];
    *pdfGeoY = padfGeoTransform[3] + dfPixel * padfGeoTransform[4]
                                   + dfLine  * padfGeoTransform[5];
}




I need to make a driver for GDAL, where the georeferencement of the image is
defined in an XML file with the 4 corners of the image in decimal degrees.
So, I need to transform those 4 points into this transformation matrix.

The other problem I have is that the image can be "stretched". Basically, it
means that I can have the 4 points like :
P1(0,0)
P2(-2,2)
P3(2,3)
P4(4,1)

In this case, the image is not just rectangular and rotated anymore, because
the angle between the x-axis an P1-P4 is different than the angle betwen the
y-axis and P1-P2

what can I do ?

Thanks a lot for your comments.

Stephane

From warmerdam at pobox.com  Fri Oct  1 13:06:38 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] rotations in Get/SetGeoTransform
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D173@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D173@caemsx03.cae.ca>
Message-ID: <415D8E9E.5090201@pobox.com>

Stephane Routelous wrote:
> I need to make a driver for GDAL, where the georeferencement of the image is
> defined in an XML file with the 4 corners of the image in decimal degrees.
> So, I need to transform those 4 points into this transformation matrix.
> 
> The other problem I have is that the image can be "stretched". Basically, it
> means that I can have the 4 points like :
> P1(0,0)
> P2(-2,2)
> P3(2,3)
> P4(4,1)
> 
> In this case, the image is not just rectangular and rotated anymore, because
> the angle between the x-axis an P1-P4 is different than the angle betwen the
> y-axis and P1-P2

Stephane,

The normal approach to this is to leave the GetGeoTransform() method defaulted,
and instead implement this as an image with 4 ground control points (GCPs).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gdal at geoworld.de  Fri Oct  1 14:18:33 2004
From: gdal at geoworld.de (Nicol Hermann)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error compiling gdal 1.2.3 with mingw
Message-ID: <1096654712.4583.11.camel@katrin>

Hi List,

i'am trying to compile gdal 1.2.3 with mingw 3.3.1 on my Debian box
During the make process i got the following error:

i586-mingw32msvc-gcc -c -I../../../port -Wall -O2 -DZIP_SUPPORT
-DPIXARLOG_SUPPORT -I../../zlib -DJPEG_SUPPORT -I../../jpeg/libjpeg
tif_jpeg.c  -DDLL_EXPORT -DPIC -o ../../o/.libs/tif_jpeg.o
In file included from ../../jpeg/libjpeg/jpeglib.h:24,
                 from tif_jpeg.c:76:
../../jpeg/libjpeg/jconfig.h:12:1: warning: "HAVE_STDLIB_H" redefined
In file included from tif_config.h:2,
                 from tiffiop.h:33,
                 from tif_jpeg.c:27:
../../../port/cpl_config.h:66:1: warning: this is the location of the
previous definition
In file included from tif_jpeg.c:76:
../../jpeg/libjpeg/jpeglib.h:94: error: parse error before "boolean"
../../jpeg/libjpeg/jpeglib.h:94: warning: no semicolon at end of struct
or union
../../jpeg/libjpeg/jpeglib.h:95: warning: type defaults to `int' in
declaration of `JQUANT_TBL'
../../jpeg/libjpeg/jpeglib.h:95: warning: data definition has no type or
storage class
../../jpeg/libjpeg/jpeglib.h:110: error: parse error before "boolean"
../../jpeg/libjpeg/jpeglib.h:110: warning: no semicolon at end of struct
or union
../../jpeg/libjpeg/jpeglib.h:111: warning: type defaults to `int' in
declaration of `JHUFF_TBL'
../../jpeg/libjpeg/jpeglib.h:111: warning: data definition has no type
or storage class
../../jpeg/libjpeg/jpeglib.h:160: error: parse error before "boolean"

... more errors ...

Any hints how to fix this are appreciate
Thanks Nicol
-- 
          \\://
          (o -)      Dipl.-Geogr. Nicol Hermann
-------ooO-(_)-Ooo-----------------------------------------------
                     Chattenstra?e 67  
  .oooO              55130 Mainz 
  (   )   Oooo.      Tel. 06131/6007550  
---\ (----(   )---------------------------------------------------
    \_)    ) /       http://www.nicol.info
          (_/        E-Mail: nicol@nicol.info


WWW-Tip!
--------
Geographisches Informationssystem
http://www.geoworld.de/


From route at cae.com  Fri Oct  1 14:21:44 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] rotations in Get/SetGeoTransform
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D176@caemsx03.cae.ca>

Hi Frank,

thanks a lot for your answer. I didn't thought about that.
But I have another question :
what if I want to convert my image format with the GCPs to a gdal originaly
supported format( ex : asciigrid ), or reverse ?
How can I convert those GCPs into/from geotransform ?
I checked the aaigriddataset.cpp file (as example), and there is no
reference or conversion from GCPs.

thanks a lot for your time.

Stephane

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Friday, October 01, 2004 1:07 PM
To: Stephane Routelous
Cc: 'Gdal-Dev (E-mail)
Subject: Re: [Gdal-dev] rotations in Get/SetGeoTransform


Stephane Routelous wrote:
> I need to make a driver for GDAL, where the georeferencement of the image
is
> defined in an XML file with the 4 corners of the image in decimal degrees.
> So, I need to transform those 4 points into this transformation matrix.
> 
> The other problem I have is that the image can be "stretched". Basically,
it
> means that I can have the 4 points like :
> P1(0,0)
> P2(-2,2)
> P3(2,3)
> P4(4,1)
> 
> In this case, the image is not just rectangular and rotated anymore,
because
> the angle between the x-axis an P1-P4 is different than the angle betwen
the
> y-axis and P1-P2

Stephane,

The normal approach to this is to leave the GetGeoTransform() method
defaulted,
and instead implement this as an image with 4 ground control points (GCPs).

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Oct  1 14:38:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] rotations in Get/SetGeoTransform
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D176@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D176@caemsx03.cae.ca>
Message-ID: <415DA40F.3030700@pobox.com>

Stephane Routelous wrote:
> Hi Frank,
> 
> thanks a lot for your answer. I didn't thought about that.
> But I have another question :
> what if I want to convert my image format with the GCPs to a gdal originaly
> supported format( ex : asciigrid ), or reverse ?
> How can I convert those GCPs into/from geotransform ?
> I checked the aaigriddataset.cpp file (as example), and there is no
> reference or conversion from GCPs.

Stephane,

You fundamentally cannot represent the geometry of your data in an ESRI
ascii grid.  The GCPs will be discarded on an export to asciigrid.

You could run your dataset through gdalwarp, and the export the result
to asciigrid.  That is rectify your data into a geometric form that can
be exported to asciigrid.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Sat Oct  2 05:16:02 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] problem/bug about GDAL
In-Reply-To: <12574077.1096338194765.JavaMail.postfix@mx55.mail.sohu.com>
References: <12574077.1096338194765.JavaMail.postfix@mx55.mail.sohu.com>
Message-ID: <20041002091602.GA12043@ak4719.spb.edu>

On Tue, Sep 28, 2004 at 10:23:14AM +0800, wjimage@sohu.com wrote:
> I have developed a FFT program based on GDAL,when read the geo.
> infomation using GetProjectionRef,it's ok, then i write it to the
> result file,the function return CE_None(read the geo. infomation
> immediatelly to another char * variable, it's ok,except that UTM is
> known as unnamed (why?,ERDAS img format)),but in the ERDAS system, the
> geo. information is NULL. In fact ,the geo. information is NULL when i
> use the output file of previous result as the input file. That means,
> the geo. information can't be written(i have tried GTiff and HFA)!
> Another bug: the input file and the output file is upside-down when
> using HFA format!

It is possible that the projection record in your ERDAS files did not
recognized properly by the GDAL. Could you upload the sample file
somewhere?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Sat Oct  2 05:16:02 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] problem/bug about GDAL
In-Reply-To: <12574077.1096338194765.JavaMail.postfix@mx55.mail.sohu.com>
References: <12574077.1096338194765.JavaMail.postfix@mx55.mail.sohu.com>
Message-ID: <20041002091602.GA12043@ak4719.spb.edu>

On Tue, Sep 28, 2004 at 10:23:14AM +0800, wjimage@sohu.com wrote:
> I have developed a FFT program based on GDAL,when read the geo.
> infomation using GetProjectionRef,it's ok, then i write it to the
> result file,the function return CE_None(read the geo. infomation
> immediatelly to another char * variable, it's ok,except that UTM is
> known as unnamed (why?,ERDAS img format)),but in the ERDAS system, the
> geo. information is NULL. In fact ,the geo. information is NULL when i
> use the output file of previous result as the input file. That means,
> the geo. information can't be written(i have tried GTiff and HFA)!
> Another bug: the input file and the output file is upside-down when
> using HFA format!

It is possible that the projection record in your ERDAS files did not
recognized properly by the GDAL. Could you upload the sample file
somewhere?

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dem at acri-st.fr  Mon Oct  4 05:24:00 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] TIFF with JPEG compression on Win32
In-Reply-To: <415D6159.7000304@pobox.com>
References: <6.1.1.1.0.20041001153954.06415ae8@pop3>
	<415D6159.7000304@pobox.com>
Message-ID: <6.1.1.1.0.20041004110617.06b32410@pop3>

At 15:53 01/10/2004, you wrote:
>Julien Demaria wrote:
>>Hi,
>>I don't know why but my gdal Win32 build doesn't support read or write 
>>TIFF with JPEG compression, but my Linux and Solaris builds work well :
>>read error:
>>Input file size is 2044, 1704
>>0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
>>464, caller expects 432
>>Assertion failed: sp->cinfo.comm.is_decompressor, file tif_jpeg.c, line 606
>>write error:
>>Input file size is 2044, 1704
>>0.ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
>>376, caller expects 360
>>ERROR 1: JPEGLib:Improper call to JPEG library in state 0
>>ERROR 1: TIFFWriteScanline failed.
>>ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 
>>376, caller expects 360
>>I compile my Win32 build with VC6 with netCDF, MrSID 4 and Kakadu support 
>>and with /Ox /MD /EHsc flags and /NODEFAULTLIB:LIBC linker flag.
>>I've tested with the OpenEV_FW 1.8.2 package and it works well...
>>If anyone has ideas of the causes, or similar problem....
>
>Julien,
>
>This is a common problem.  Are you building with an external libjpeg or
>the built in copy?  The built-in copy is supposed to work fine but there
>are things that need to be tweaked with an external copy.  Andrey knows the
>details but he may not be able to answer email today.

Frank,

I am building with the built in copy


>I ended up hacking tif_jpeg.c for my OpenEV_FW 1.8.2 build a bit but Andrey's
>suggestion was actually to slightly modify the jconfig.h file in libjpeg.
>However, I didn't keep track of the details.
>
>It all relates to differing sizes for the bool type, and the need to keep
>them consistent between how things are built for tif_jpeg.c and within libjpeg
>itself.   If you search for "boolean" in tif_jpeg.c you will see some
>discussion of the issue.  There is also at least one bugzilla report on
>the problem though I don't have a link off hand.

On my configuration, tif_jpeg.c uses "boolean" type from RPCNDR.H as 
"unsigned char", but jpeg/libjpeg/jmorecfg.h uses it as "int"...

Changing in jmorecfg.h

#ifndef HAVE_BOOLEAN
typedef int boolean;
#endif

to

#ifndef HAVE_BOOLEAN
typedef unsigned char boolean;
#endif

works for me.

Are you sure the actual CVS GDAL built with built in JPEG lib works well 
about JPEG-in-TIFF ? because it seems libjpeg and tif_jpeg.c are compiled 
with different sizes for booleans on Win32...

Best Regards,

Julien


From route at cae.com  Mon Oct  4 14:53:02 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is valid ?
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D182@caemsx03.cae.ca>

Hi,

according to the documentation of GDALOpen, "Many drivers support only read
only access".
How do I know if a driver only has read access ?

Because, if I really need to open a raster in read/write mode, if the driver
does not support write, I need to use a in-memory raster if the driver
supports createcopy.

ex : (pseudo-code)

GDALDataset* ds = GDALOpen(filename,GA_Update); //let's say the driver for
"filename" has only read access
GDALRasterBand* band = ds->GetRasterBand(1);
band->RasterIO( GF_Write,whatever the other parameters are);//here, problem.


Thanks in advance,

Stephane



From warmerdam at pobox.com  Mon Oct  4 16:27:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is valid ?
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D182@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D182@caemsx03.cae.ca>
Message-ID: <4161B233.4020705@pobox.com>

Stephane Routelous wrote:
> Hi,
> 
> according to the documentation of GDALOpen, "Many drivers support only read
> only access".
> How do I know if a driver only has read access ?
> 
> Because, if I really need to open a raster in read/write mode, if the driver
> does not support write, I need to use a in-memory raster if the driver
> supports createcopy.
> 
> ex : (pseudo-code)
> 
> GDALDataset* ds = GDALOpen(filename,GA_Update); //let's say the driver for
> "filename" has only read access
> GDALRasterBand* band = ds->GetRasterBand(1);
> band->RasterIO( GF_Write,whatever the other parameters are);//here, problem.

Stephane,

Currently there is no way to know if a driver supports read-only or read-write
for existing files other than to open the file in update mode, and if that
succeeds to try and write some data.  I am afraid that many drivers that
don't really support update mode will still allow an update mode open to
succeed, though that is clearly a bug.

Sorry,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Mon Oct  4 17:19:26 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is val
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D184@caemsx03.cae.ca>

I entered it in bugzilla ( Bug 627 ).

thanks again.

Stephane

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Monday, October 04, 2004 4:28 PM
To: Stephane Routelous
Cc: 'gdal-dev@xserve.flids.com'
Subject: Re: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is
valid ?


Stephane Routelous wrote:
> Hi,
> 
> according to the documentation of GDALOpen, "Many drivers support only
read
> only access".
> How do I know if a driver only has read access ?
> 
> Because, if I really need to open a raster in read/write mode, if the
driver
> does not support write, I need to use a in-memory raster if the driver
> supports createcopy.
> 
> ex : (pseudo-code)
> 
> GDALDataset* ds = GDALOpen(filename,GA_Update); //let's say the driver for
> "filename" has only read access
> GDALRasterBand* band = ds->GetRasterBand(1);
> band->RasterIO( GF_Write,whatever the other parameters are);//here,
problem.

Stephane,

Currently there is no way to know if a driver supports read-only or
read-write
for existing files other than to open the file in update mode, and if that
succeeds to try and write some data.  I am afraid that many drivers that
don't really support update mode will still allow an update mode open to
succeed, though that is clearly a bug.

Sorry,

-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From chodgson at refractions.net  Mon Oct  4 17:42:45 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Problem compiling with kakadu
Message-ID: <4161C3D5.9030703@refractions.net>

I'm working with gdal 1.2.1 and kakadu 4.2.

I've compiled kakadu, and copied the libraries into my /usr/local/lib as so:

-rw-r--r--   1 root root   630536 Oct  4 12:29 libkdu.a
lrwxrwxrwx   1 root root       14 Oct  4 12:25 libkdu.so -> libkdu_v42R.so
-rwxr-xr-x   1 root root   548605 Oct  4 12:29 libkdu_v42R.so

I tried only copying "libkdu_v42R.so" but that didn't work so I added 
the symlink and that seemed to get my compile process a bit further at 
least... I'm guessing my problem is somewhere in here...

When I try to compile gdal and I get the following at the end of the 
make output:

...
(cd ogr; make apps)
make[1]: Entering directory `/usr/local/src/gdal-1.2.1/ogr'
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so /usr/lib/libjpeg.so 
-lz -ldl -lkdu -L/opt/pgsql/7.4/lib -lpq
../.libs/libgdal.so: undefined reference to 
`jp2_channels::set_colour_mapping(int, int, int, int)'
../.libs/libgdal.so: undefined reference to 
`jp2_colour::init(jp2_colour_space)'
../.libs/libgdal.so: undefined reference to `jp2_channels::init(int)'
../.libs/libgdal.so: undefined reference to `vtable for jp2_input_box'
../.libs/libgdal.so: undefined reference to `jp2_target::access_palette()'
../.libs/libgdal.so: undefined reference to `jp2_family_tgt::open(char 
const*)'
../.libs/libgdal.so: undefined reference to `jp2_source::access_palette()'
../.libs/libgdal.so: undefined reference to `vtable for jp2_target'
../.libs/libgdal.so: undefined reference to 
`jp2_target::access_dimensions()'
../.libs/libgdal.so: undefined reference to `vtable for jp2_source'
../.libs/libgdal.so: undefined reference to `jp2_target::write_header()'
../.libs/libgdal.so: undefined reference to `jp2_palette::get_num_luts()'
../.libs/libgdal.so: undefined reference to 
`jp2_channels::get_premult_mapping(int, int&, int&, int&)'
../.libs/libgdal.so: undefined reference to `jp2_family_src::open(char 
const*, bool)'
../.libs/libgdal.so: undefined reference to `jp2_input_box::close()'
../.libs/libgdal.so: undefined reference to `jp2_target::access_colour()'
../.libs/libgdal.so: undefined reference to `jp2_source::access_channels()'
../.libs/libgdal.so: undefined reference to `jp2_family_tgt::close()'
../.libs/libgdal.so: undefined reference to `jp2_source::read_header()'
../.libs/libgdal.so: undefined reference to `jp2_palette::get_lut(int, 
float*)'
../.libs/libgdal.so: undefined reference to `jp2_palette::get_num_entries()'
../.libs/libgdal.so: undefined reference to 
`jp2_dimensions::init(siz_params*, bool)'
../.libs/libgdal.so: undefined reference to 
`kdu_roi_rect::kdu_roi_rect[in-charge](kdu_codestream, kdu_dims)'
../.libs/libgdal.so: undefined reference to `jp2_output_box::close()'
../.libs/libgdal.so: undefined reference to `jp2_palette::set_lut(int, 
int*, int, bool)'
../.libs/libgdal.so: undefined reference to `jp2_input_box::open_next()'
../.libs/libgdal.so: undefined reference to 
`jp2_input_box::open(jp2_family_src*, jp2_locator)'
../.libs/libgdal.so: undefined reference to 
`jp2_channels::get_opacity_mapping(int, int&, int&, int&)'
../.libs/libgdal.so: undefined reference to 
`jp2_channels::get_colour_mapping(int, int&, int&, int&)'
../.libs/libgdal.so: undefined reference to 
`jp2_target::open_codestream(bool)'
../.libs/libgdal.so: undefined reference to 
`jp2_channels::get_num_colours()'
../.libs/libgdal.so: undefined reference to 
`jp2_input_box::jp2_input_box[in-charge]()'
../.libs/libgdal.so: undefined reference to `jp2_family_src::close()'
../.libs/libgdal.so: undefined reference to 
`jp2_input_box::read(unsigned char*, int)'
../.libs/libgdal.so: undefined reference to `jp2_palette::init(int, int)'
../.libs/libgdal.so: undefined reference to `jp2_target::~jp2_target 
[in-charge]()'
../.libs/libgdal.so: undefined reference to 
`jp2_target::open(jp2_family_tgt*)'
../.libs/libgdal.so: undefined reference to 
`jp2_input_box::jp2_input_box[not-in-charge]()'
../.libs/libgdal.so: undefined reference to `jp2_target::access_channels()'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/usr/local/src/gdal-1.2.1/ogr'
make: *** [ogr-apps] Error 2



From dem at acri-st.fr  Tue Oct  5 04:09:27 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is valid ?
In-Reply-To: <4161B233.4020705@pobox.com>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D182@caemsx03.cae.ca>
	<4161B233.4020705@pobox.com>
Message-ID: <6.1.1.1.0.20041005100250.06996858@pop3>

At 22:27 04/10/2004, Frank Warmerdam wrote:
>Stephane Routelous wrote:
>>Hi,
>>according to the documentation of GDALOpen, "Many drivers support only read
>>only access".
>>How do I know if a driver only has read access ?
>>Because, if I really need to open a raster in read/write mode, if the driver
>>does not support write, I need to use a in-memory raster if the driver
>>supports createcopy.
>>ex : (pseudo-code)
>>GDALDataset* ds = GDALOpen(filename,GA_Update); //let's say the driver for
>>"filename" has only read access
>>GDALRasterBand* band = ds->GetRasterBand(1);
>>band->RasterIO( GF_Write,whatever the other parameters are);//here, problem.
>
>Stephane,
>
>Currently there is no way to know if a driver supports read-only or read-write
>for existing files other than to open the file in update mode, and if that
>succeeds to try and write some data.  I am afraid that many drivers that
>don't really support update mode will still allow an update mode open to
>succeed, though that is clearly a bug.
>
>Sorry,

Hi,

In gdal_translate.cpp I see the following code :

     printf( "The following format drivers are configured and support 
output:\n" );
     for( iDr = 0; iDr < GDALGetDriverCount(); iDr++ )
     {
         GDALDriverH hDriver = GDALGetDriver(iDr);

         if( GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATE, NULL ) != NULL
             || GDALGetMetadataItem( hDriver, GDAL_DCAP_CREATECOPY,
                                     NULL ) != NULL )
         {
             printf( "  %s: %s\n",
                     GDALGetDriverShortName( hDriver ),
                     GDALGetDriverLongName( hDriver ) );
         }
     }


I understand that each driver as special meta-datas GDAL_DCAP_CREATE and 
GDAL_DCAP_CREATECOPY if it support them ? and if a driver as a Create 
method, it must support the GA_Update mode, isn't it ?

Regards,

Julien


From warmerdam at pobox.com  Tue Oct  5 09:02:15 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] how to know if GDALOpen(filename,GA_Update) is valid ?
In-Reply-To: <6.1.1.1.0.20041005100250.06996858@pop3>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D182@caemsx03.cae.ca>	<4161B233.4020705@pobox.com>
	<6.1.1.1.0.20041005100250.06996858@pop3>
Message-ID: <41629B57.4030309@pobox.com>

Julien Demaria wrote:
> I understand that each driver as special meta-datas GDAL_DCAP_CREATE and 
> GDAL_DCAP_CREATECOPY if it support them ? and if a driver as a Create 
> method, it must support the GA_Update mode, isn't it ?

Julien,

For the most part formats with a Create() method also support update but there
are a number off formats that support imagery update that do no have
Create() methods.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From alexamici at fastwebnet.it  Tue Oct  5 14:28:17 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Problem compiling with kakadu
In-Reply-To: <4161C3D5.9030703@refractions.net>
References: <4161C3D5.9030703@refractions.net>
Message-ID: <200410052028.17637.alexamici@fastwebnet.it>


Chris,

On Monday 04 October 2004 23:42, Chris Hodgson wrote:
> I'm working with gdal 1.2.1 and kakadu 4.2.

[...]

> I tried only copying "libkdu_v42R.so" but that didn't work so I added
> the symlink and that seemed to get my compile process a bit further at
> least... I'm guessing my problem is somewhere in here...
>
> When I try to compile gdal and I get the following at the end of the
> make output:

i don't have the possibility to test the kakadu driver directly, but to the 
best of my knowledge you need to (at least) do:
 $ ./configure ... --with-kakadu=$KAKADU_SOURCE_DIR --without-libtool
where the $KAKADU_SOURCE_DIR is the source directory with the object files.

cheers,
alessandro

From alexamici at fastwebnet.it  Tue Oct  5 14:28:17 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Problem compiling with kakadu
In-Reply-To: <4161C3D5.9030703@refractions.net>
References: <4161C3D5.9030703@refractions.net>
Message-ID: <200410052028.17637.alexamici@fastwebnet.it>


Chris,

On Monday 04 October 2004 23:42, Chris Hodgson wrote:
> I'm working with gdal 1.2.1 and kakadu 4.2.

[...]

> I tried only copying "libkdu_v42R.so" but that didn't work so I added
> the symlink and that seemed to get my compile process a bit further at
> least... I'm guessing my problem is somewhere in here...
>
> When I try to compile gdal and I get the following at the end of the
> make output:

i don't have the possibility to test the kakadu driver directly, but to the 
best of my knowledge you need to (at least) do:
 $ ./configure ... --with-kakadu=$KAKADU_SOURCE_DIR --without-libtool
where the $KAKADU_SOURCE_DIR is the source directory with the object files.

cheers,
alessandro

From chodgson at refractions.net  Tue Oct  5 14:59:21 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Problem compiling with kakadu
In-Reply-To: <200410052028.17637.alexamici@fastwebnet.it>
References: <4161C3D5.9030703@refractions.net>
	<200410052028.17637.alexamici@fastwebnet.it>
Message-ID: <4162EF09.1000908@refractions.net>

Thanks, yah, it was the "--without-libtool" that I was missing.

Chris

Alessandro Amici wrote:

>Chris,
>
>On Monday 04 October 2004 23:42, Chris Hodgson wrote:
>  
>
>>I'm working with gdal 1.2.1 and kakadu 4.2.
>>    
>>
>
>[...]
>
>  
>
>>I tried only copying "libkdu_v42R.so" but that didn't work so I added
>>the symlink and that seemed to get my compile process a bit further at
>>least... I'm guessing my problem is somewhere in here...
>>
>>When I try to compile gdal and I get the following at the end of the
>>make output:
>>    
>>
>
>i don't have the possibility to test the kakadu driver directly, but to the 
>best of my knowledge you need to (at least) do:
> $ ./configure ... --with-kakadu=$KAKADU_SOURCE_DIR --without-libtool
>where the $KAKADU_SOURCE_DIR is the source directory with the object files.
>
>cheers,
>alessandro
>  
>


From dem at acri-st.fr  Wed Oct  6 03:50:39 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] MrSID Driver performances
Message-ID: <6.1.1.1.0.20041006093212.06badde0@pop3>

Hi,

First, Andrey thanks a lot for implementing block caching in the driver for 
DSDK 4.xx, now decompress an RGB MrSID file is very faster ! :-)

I've made some tests on performances with the 4.xx driver on a big 
10000x10000 MrSID RGB file.
The file has the version 1.0.1 (with mrsidinfo) and I suppose this is an 
MG2 file ; I haven't got any big MrSID MG3 file for testing...

I found that the driver can be improved a lot simply by changing the blocks 
size to 256x256 instead strips calculated with the 
poImageReader->getStripHeight() DSDK method.
With this changes my tests seem to be between 2 and 3 times more faster !

My tests are (on Win32 and Solaris) :
- gdal_translate execution time
- OpenEV visualisation (it's faster and more reactive)
- a sort of gdal_translate in our software
- visualisation time in our software

Maybe it should be interesting to do theses tests with an MG3 file...

The diff with the current CVS version for change the blocks size :

 >         GInt32          nCol = nBlockXOff * nBlockXSize;
1390,1391c1391,1393
<                                 nBlockXOff * nBlockXSize, nLine,
<                                 nBlockXSize,
---
 >                                 nCol, nLine,
 >                                 (nCol+nBlockXSize>poGDS->GetRasterXSize())?
 >                                 (poGDS->GetRasterXSize()-nCol):nBlockXSize,
1768,1769c1770,1771
<     nBlockXSize = nRasterXSize;
<     nBlockYSize = poImageReader->getStripHeight();
---
 >     nBlockXSize = 256;
 >     nBlockYSize = 256;



Best Regards,

Julien


From support at geoimage.fr  Wed Oct  6 05:22:20 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] GDAL 1.2.3 - Solaris - ECW
Message-ID: <087a01c4ab85$fb5de010$3801a8c0@pili>

Hello,

on solaris, when i specify "--with-ecw=<dir>", the include directory "<dir>/include" is added
to the CPPFLAGS variable in GDALmake.opt.

The problem is that variable is reaffected in the GNUmakefile of frmts/ecw and the ECW
headers are not found.

If i change the line (in frmts/ecw/GNUmakefile) :

CPPFLAGS =  $(GDAL_INCLUDE) -DFRMT_ecw

by

CPPFLAGS +=  $(GDAL_INCLUDE) -DFRMT_ecw

the corrects the problem.

Perhaps this should be corrected for the next release...

Regards.
_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr




From dev at spaceyes.fr  Wed Oct  6 05:20:55 2004
From: dev at spaceyes.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal1.2.3 - ecw - solaris
Message-ID: <086e01c4ab85$c8b65890$3801a8c0@pili>

Hello,

on solaris, when i specify "--with-ecw=<dir>", the include directory "<dir>/include" is added
to the CPPFLAGS variable in GDALmake.opt.

The problem is that variable is reaffected in the GNUmakefile of frmts/ecw and the ECW
headers are not found.

If i change the line (in frmts/ecw/GNUmakefile) :

CPPFLAGS =  $(GDAL_INCLUDE) -DFRMT_ecw

by

CPPFLAGS +=  $(GDAL_INCLUDE) -DFRMT_ecw

the corrects the problem.

Perhaps this should be corrected for the next release...

Regards.
_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From warmerdam at pobox.com  Wed Oct  6 09:13:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] GDAL 1.2.3 - Solaris - ECW
In-Reply-To: <087a01c4ab85$fb5de010$3801a8c0@pili>
References: <087a01c4ab85$fb5de010$3801a8c0@pili>
Message-ID: <4163EF7A.4080000@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> on solaris, when i specify "--with-ecw=<dir>", the include directory "<dir>/include" is added
> to the CPPFLAGS variable in GDALmake.opt.
> 
> The problem is that variable is reaffected in the GNUmakefile of frmts/ecw and the ECW
> headers are not found.
> 
> If i change the line (in frmts/ecw/GNUmakefile) :
> 
> CPPFLAGS =  $(GDAL_INCLUDE) -DFRMT_ecw
> 
> by
> 
> CPPFLAGS +=  $(GDAL_INCLUDE) -DFRMT_ecw
> 
> the corrects the problem.
> 
> Perhaps this should be corrected for the next release...

Fr?d?ric,

I have reviewed all the gdal/frmts/*/GNUmakefile's and altered any that
changed CPPFLAGS similarly to the above to preserve the CPPFLAGS.  I don't
use the += operator though, otherwise it can easiliy occur that the
GDAL_INCLUDE path (generally the path to the various local build tree
directories with GDAL include files) can be overridden by other includes
such as /usr/local/include resulting in picking up the wrong version of
GDAL include files.

Thanks for the feedback.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dmorissette at dmsolutions.ca  Wed Oct  6 09:54:58 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] ECW on Linux
Message-ID: <4163F932.9040001@dmsolutions.ca>

I just read the post about building GDAL with ECW on Solaris and I was 
wondering if there were any news on the availability of the ECW SDK for 
Linux.

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From support at geoimage.fr  Wed Oct  6 10:04:03 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Solaris build with static proj4.
Message-ID: <097501c4abad$56890a10$3801a8c0@pili>

Hello,

version 1.2.3 has the same configure problem than the previous ones ( since 1.2.0 ) regarding the static link of
the PROJ4 Library.

Only the first possible directory is tested and the result is cached.

Here is a patch for the configure.in file.

Do you plan to integrate it for the future ?

Regards.
__________________________________________________________________________________________

dnl ---------------------------------------------------------------------------
dnl PROJ.4 related stuff.
dnl ---------------------------------------------------------------------------

AC_MSG_CHECKING([how to link PROJ.4 library])

AC_ARG_WITH(static_proj4,[  --with-static-proj4=ARG Compile with PROJ.4 statically (ARG=no or path)],,)

if test "x$with_static_proj4" = "xno" -o "x$with_static_proj4" = "x"; then

  PROJ_STATIC=no
  AC_MSG_RESULT([link dynamically.])

else

  PROJ_STATIC=yes
  AC_MSG_RESULT([link statically.])

  ORIG_LIBS="$LIBS"
  PROJ_LIB="-lproj"

  if test "x$with_static_proj4" = "xyes" ; then
    LIBS="$PROJ_LIB $ORIG_LIBS"
    AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
  else

    LIBS="-L$with_static_proj4/src $PROJ_LIB $ORIG_LIBS"
    AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)

    if test "$PROJ_STATIC" = "no"; then

      dnl Disable previous value cached by the previous AC_CHECK_LIB test :
      dnl AC_CHECK_LIB caches the result value for a couple (function, library)
      dnl in a variable named "ac_cv_lib_<library name>_<function name>".
      dnl In order to try to locate the library in different locations, using
      dnl different values of LIBS, we have to 'unset' this variable after
      dnl each negative test.

      unset ac_cv_lib_proj_pj_init

      LIBS="-L$with_static_proj4/lib $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="-L$with_static_proj4/src/.libs $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="-L$with_static_proj4 $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="$PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

  fi

  if test "$PROJ_STATIC" = "no"; then
    LIBS="$ORIG_LIBS"
  fi

  if test -r "$with_static_proj4/src/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4/src"
  elif test -r "$with_static_proj4/include/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4/include"
  elif test -r "$with_static_proj4/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4"
  fi

fi

AC_SUBST(PROJ_STATIC)
AC_SUBST(PROJ_INCLUDE)

_________________________________________________________________________________________________________


_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From warmerdam at pobox.com  Wed Oct  6 10:27:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] ECW on Linux
In-Reply-To: <4163F932.9040001@dmsolutions.ca>
References: <4163F932.9040001@dmsolutions.ca>
Message-ID: <416400DE.4040503@pobox.com>

Daniel Morissette wrote:
> I just read the post about building GDAL with ECW on Solaris and I was 
> wondering if there were any news on the availability of the ECW SDK for 
> Linux.

Daniel,

A new ECW SDK 3.0 beta was recently made available, and I verified it did not
include source - only windows binaries.  I don't know when the final 3.0
release with source will occur.  The beta seems to be going on pretty long.
It's too bad they don't provide the source in betas as well so we could give
them feedback on porting issues.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Oct  6 10:41:00 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Solaris build with static proj4.
In-Reply-To: <097501c4abad$56890a10$3801a8c0@pili>
References: <097501c4abad$56890a10$3801a8c0@pili>
Message-ID: <416403FC.7010903@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> version 1.2.3 has the same configure problem than the previous ones ( since 1.2.0 ) regarding the static link of
> the PROJ4 Library.
> 
> Only the first possible directory is tested and the result is cached.
> 
> Here is a patch for the configure.in file.
> 
> Do you plan to integrate it for the future ?

Fr?d?ric,

I am guessing you have sent this patch before but that I ignored/missed/forgot
about it.  I would encourage you to file such worthwhile patches or even just
the report of the problem in bugzilla.  Perhaps this came up last during
the length bugzilla interruption this summer.

I have applied your patch, thanks!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From chodgson at refractions.net  Wed Oct  6 12:59:21 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] warp and translate problems
Message-ID: <41642469.3080403@refractions.net>

I'm working with TIF orthophoto files, warping them from UTM to BC 
Albers projection, and converting them to JPEG-2000 format.
I have a few questions:

1) it seems that it is not possible to do this in one step using 
gdalwarp and specifying the output format -  I'm guessing the same is 
true for gdal_translate and specifying the  output projection?  I 
suppose this is just a limitation of the more complicated output format 
drivers?

2) I'm starting with .tif and .tfw files, then gdalwarp gives me single 
geotiff file. then when I use gdal_translate to convert to jp2 format, I 
don't have any georeferencing (no wld file)... do I need to compile with 
jasper as well so that I can output geojp2 files, or is there some way 
to tell gdal_translate to output a .wld file for the output file?

3) My intent is to build a tileindex of the output files and serve them 
up using mapserver. I'm worried about the black "collar" that I'm left 
with around the images after I've reprojected them - will mapserver be 
able to deal with the fact that these all overlap with data from the 
neighboring tile? Can mapserver deal with tileindexes that have 
overlaps? How about tiles that aren't square in the given coordinate 
system - if I use the grid from the original orthophoto files, will it 
use those boundaries to select which tile to get the data from? That 
would be the optimal solution, if it works that way. Tell me if this is 
a question better posted to the MapServer list but I know it is gdal 
doing most of this work anyway.

Thanks in advance for any answers you can offer.

Chris

From warmerdam at pobox.com  Wed Oct  6 15:28:54 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] warp and translate problems
In-Reply-To: <41642469.3080403@refractions.net>
References: <41642469.3080403@refractions.net>
Message-ID: <41644776.8090204@pobox.com>

Chris Hodgson wrote:
> I'm working with TIF orthophoto files, warping them from UTM to BC 
> Albers projection, and converting them to JPEG-2000 format.
> I have a few questions:
> 
> 1) it seems that it is not possible to do this in one step using 
> gdalwarp and specifying the output format -  I'm guessing the same is 
> true for gdal_translate and specifying the  output projection?  I 
> suppose this is just a limitation of the more complicated output format 
> drivers?

Chris,

Generally speaking programs like gdalwarp can't output to formats which
only support making a copy of an existing dataset.  That is, many drivers
only have a CreateCopy() method for making new files, and you need to
pass them an existing dataset to clone.  The JP2KAK driver falls into this
category.

You can actually use gdal_translate to subset to something like jpeg2000,
but what happens inside gdal_translate is that it makes up a "virtual dataset"
with the desired characteristics that fetches image data from the real
source file as needed.

Recently the virtual file format was also extended to support warping on
the fly, but gdalwarp does not (yet) utilize this transparently to write
to formats like JPEG2000.  If it is important to avoid making the intermediate
file you could use gdalwarp to write a VRT file and then gdal_translate that
to JPEG2000 format.  The .vrt file will just be an XML description of the
transformation to apply.

> 2) I'm starting with .tif and .tfw files, then gdalwarp gives me single 
> geotiff file. then when I use gdal_translate to convert to jp2 format, I 
> don't have any georeferencing (no wld file)... do I need to compile with 
> jasper as well so that I can output geojp2 files, or is there some way 
> to tell gdal_translate to output a .wld file for the output file?

The JP2KAK driver writes out GeoJP2 (tm) files as long as the input is
georeferenced.  If you really need .wld files for some reason you could
write a little python script to do it.  I don't believe the JP2KAK driver
supports generating .wld files directly.

> 3) My intent is to build a tileindex of the output files and serve them 
> up using mapserver. I'm worried about the black "collar" that I'm left 
> with around the images after I've reprojected them - will mapserver be 
> able to deal with the fact that these all overlap with data from the 
> neighboring tile? Can mapserver deal with tileindexes that have 
> overlaps? How about tiles that aren't square in the given coordinate 
> system - if I use the grid from the original orthophoto files, will it 
> use those boundaries to select which tile to get the data from? That 
> would be the optimal solution, if it works that way. Tell me if this is 
> a question better posted to the MapServer list but I know it is gdal 
> doing most of this work anyway.

Hmm, this will indeed be a problem.  MapServer doesn't mind overlapping
images, but it is just going to draw them in some arbitrary order and the
black stuff will get written over valid imagery in some cases.  Normally
I would suggest using the MapServer OFFSITE keyword to indicate that the
black should be ignored (treated as transparent), but with a lossy
compression format like JPEG2000 you will find the black pixels vary a
bit from 0/0/0 and thus you won't be able to use OFFSET effectively.

My suggestion would be to generate output tiles that are not related 1:1
to your input files.  Instead, pick a tile size and then fill it completely
by gdalwarping multiple images into it.

My understanding is you have 2TB of imagery.  If you broke your region
down into 100000 x 100000 chunks (roughly 30GB each assuming RGB uncompressed)
then you could just compress each of those chunks.  To warp the input
images into the you would need to use gdalwarp to exactly create the
correct output tiles with the -tr and -ts switches to gdalwarp.  Then just
warp each file that intersects the region into the working file (or all
the files if it is to much trouble to work out which ones intersect).
This should give you (big) resulting files with no black areas with the
possible exception of areas that have no data.

Another possibility would be to work with me to add alpha band support
to gdalwarp.  Then you could warp each file to an RGBA file with a=0
for pixels that are not set, and a=255 for pixels that are set.
MapServer knows how to utilize per-pixel alpha information when available.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From sewell at dramail.com  Wed Oct  6 16:14:53 2004
From: sewell at dramail.com (Ken Sewell)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Help handling image with gcp.
Message-ID: <Pine.LNX.4.53.0410061607470.5784@server.dramail.com>


I just started receiving some NITF files that only have GCP's.  I need the
ability to query the pixel's lat/lon.  Can I do this with GCP's or is
there a utility in GDAL that will georegister the image from the GCP?
This what gdalinfo shows:

Driver: NITF/National Imagery Transmission Format
Size is 640, 473
Coordinate System is `'
GCP Projection = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","
6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORI
TY["EPSG","4326"]]
GCP[  0]: Id=UpperLeft, Info=
          (0,0) -> (-116.633,35.2542,0)
GCP[  1]: Id=UpperRight, Info=
          (640,0) -> (-116.66,35.2758,0)
GCP[  2]: Id=LowerLeft, Info=
          (0,473) -> (-116.608,35.2736,0)
GCP[  3]: Id=LowerRight, Info=
          (640,473) -> (-116.624,35.2889,0)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  473.0)
Upper Right (  640.0,    0.0)
Lower Right (  640.0,  473.0)
Center      (  320.0,  236.5)
Band 1 Block=640x1 Type=Byte, ColorInterp=Undefined


Ken Sewell                   Defense Research Associates
Project Engineer             3915 Germany Lane, Suite 102
937-656-4899 x3004           Beavercreek, Ohio 45431-1608
sewell@dramail.com

From warmerdam at pobox.com  Wed Oct  6 16:12:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Help handling image with gcp.
In-Reply-To: <Pine.LNX.4.53.0410061607470.5784@server.dramail.com>
References: <Pine.LNX.4.53.0410061607470.5784@server.dramail.com>
Message-ID: <416451AF.8040203@pobox.com>

Ken Sewell wrote:
> I just started receiving some NITF files that only have GCP's.  I need the
> ability to query the pixel's lat/lon.  Can I do this with GCP's or is
> there a utility in GDAL that will georegister the image from the GCP?
> This what gdalinfo shows:
> 
> Driver: NITF/National Imagery Transmission Format
> Size is 640, 473
> Coordinate System is `'
> GCP Projection = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","
> 6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORI
> TY["EPSG","4326"]]
> GCP[  0]: Id=UpperLeft, Info=
>           (0,0) -> (-116.633,35.2542,0)
> GCP[  1]: Id=UpperRight, Info=
>           (640,0) -> (-116.66,35.2758,0)
> GCP[  2]: Id=LowerLeft, Info=
>           (0,473) -> (-116.608,35.2736,0)
> GCP[  3]: Id=LowerRight, Info=
>           (640,473) -> (-116.624,35.2889,0)

Ken,

You could run the image through "gdalwarp" which would rectify it giving
you an image with a nice geotransform.  It would build a 1st order transformation
to accomplish the image warp.

Alternatively you could build an approximate geotransform (the same as it
would use for a warp) from the GCPs.  This can be accomplished with the
function GDALGCPsToGeoTransform().  Note that you will need to pass bApproxOK
as TRUE.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From chodgson at refractions.net  Wed Oct  6 16:34:48 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] warp and translate problems
In-Reply-To: <41644776.8090204@pobox.com>
References: <41642469.3080403@refractions.net> <41644776.8090204@pobox.com>
Message-ID: <416456E8.2050101@refractions.net>


> You can actually use gdal_translate to subset to something like jpeg2000,
> but what happens inside gdal_translate is that it makes up a "virtual 
> dataset"
> with the desired characteristics that fetches image data from the real
> source file as needed.

So I should be able to use the "-a_srs" option on gdal_translate to do a 
"one-pass" conversion from TIF/UTM to JP2/BCALB - even though I can't 
use the "-of" option in  gdalwarp to do the same thing - just due to the 
different architectures of the programs? I'll have to try it. Though, it 
may not help considering the answer to question #3 :-(

I don't really mind the intermediate step, I just thought that if I can 
read the data from disk fewer times, it should speed things up.

>> 2) I'm starting with .tif and .tfw files, then gdalwarp gives me 
>> single geotiff file. then when I use gdal_translate to convert to jp2 
>> format, I don't have any georeferencing (no wld file)... do I need to 
>> compile with jasper as well so that I can output geojp2 files, or is 
>> there some way to tell gdal_translate to output a .wld file for the 
>> output file?
>
> The JP2KAK driver writes out GeoJP2 (tm) files as long as the input is
> georeferenced.  If you really need .wld files for some reason you could
> write a little python script to do it.  I don't believe the JP2KAK driver
> supports generating .wld files directly.

I think the real problem was that gdaltindex wasn't recognizing the 
GeoJP2 georeferencing - it complained that my jp2 files weren't 
georeferenced. However, they loaded just fine in ArcMap - wow, GeoJP2 
must be a real standard if even ESRI recognizes it :-)

>> 3) My intent is to build a tileindex of the output files and serve 
>> them up using mapserver. I'm worried about the black "collar" that 
>> I'm left with around the images after I've reprojected them - will 
>> mapserver be able to deal with the fact that these all overlap with 
>> data from the neighboring tile? Can mapserver deal with tileindexes 
>> that have overlaps? How about tiles that aren't square in the given 
>> coordinate system - if I use the grid from the original orthophoto 
>> files, will it use those boundaries to select which tile to get the 
>> data from? That would be the optimal solution, if it works that way. 
>> Tell me if this is a question better posted to the MapServer list but 
>> I know it is gdal doing most of this work anyway.
>
> Hmm, this will indeed be a problem.  MapServer doesn't mind overlapping
> images, but it is just going to draw them in some arbitrary order and the
> black stuff will get written over valid imagery in some cases.  Normally
> I would suggest using the MapServer OFFSITE keyword to indicate that the
> black should be ignored (treated as transparent), but with a lossy
> compression format like JPEG2000 you will find the black pixels vary a
> bit from 0/0/0 and thus you won't be able to use OFFSET effectively.

Yah, this is what I figured.

> My suggestion would be to generate output tiles that are not related 1:1
> to your input files.  Instead, pick a tile size and then fill it 
> completely
> by gdalwarping multiple images into it.

I was contemplating exactly this over lunch...

> My understanding is you have 2TB of imagery.  If you broke your region
> down into 100000 x 100000 chunks (roughly 30GB each assuming RGB 
> uncompressed)
> then you could just compress each of those chunks.  To warp the input
> images into the you would need to use gdalwarp to exactly create the
> correct output tiles with the -tr and -ts switches to gdalwarp.  Then 
> just
> warp each file that intersects the region into the working file (or all
> the files if it is to much trouble to work out which ones intersect).
> This should give you (big) resulting files with no black areas with the
> possible exception of areas that have no data.

An annoyance is that some of our orthos are at different resolutions, 
some are in colour (most B&W), and some are already reprojected to 
albers... this can all be overcome, but causes additional trouble... 
this was supposed to be a simple task, it has become a nightmare (and 
that never happens...)

> Another possibility would be to work with me to add alpha band support
> to gdalwarp.  Then you could warp each file to an RGBA file with a=0
> for pixels that are not set, and a=255 for pixels that are set.
> MapServer knows how to utilize per-pixel alpha information when 
> available.

This actually seems like the best solution, since we want to be able to 
add new orthos easily (without having to rebuild the tiles for that 
area...), and we're not really worried about edge artifacts, or which 
ortho gets used on slightly-overlapping edge cases...

Let me know if I'm missing something, but this doesn't seem too 
difficult... Let me know off-list how long this would take you to do, 
and how soon you could do it...

Thanks,
Chris

From warmerdam at pobox.com  Wed Oct  6 16:44:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] warp and translate problems
In-Reply-To: <416456E8.2050101@refractions.net>
References: <41642469.3080403@refractions.net> <41644776.8090204@pobox.com>
	<416456E8.2050101@refractions.net>
Message-ID: <41645933.2020504@pobox.com>

Chris Hodgson wrote:
> 
>> You can actually use gdal_translate to subset to something like jpeg2000,
>> but what happens inside gdal_translate is that it makes up a "virtual 
>> dataset"
>> with the desired characteristics that fetches image data from the real
>> source file as needed.
> 
> 
> So I should be able to use the "-a_srs" option on gdal_translate to do a 
> "one-pass" conversion from TIF/UTM to JP2/BCALB - even though I can't 
> use the "-of" option in  gdalwarp to do the same thing - just due to the 
> different architectures of the programs? I'll have to try it. Though, it 
> may not help considering the answer to question #3 :-(
> 
> I don't really mind the intermediate step, I just thought that if I can 
> read the data from disk fewer times, it should speed things up.

Chris,

You can use -a_srs with gdal_translate, but it doesn't warp the imagery.
It just assigns an srs.


> I think the real problem was that gdaltindex wasn't recognizing the 
> GeoJP2 georeferencing - it complained that my jp2 files weren't 
> georeferenced. However, they loaded just fine in ArcMap - wow, GeoJP2 
> must be a real standard if even ESRI recognizes it :-)

Perhaps you have an old/incompatible gdaltindex?  Does your gdalinfo
properly report georeferencing?
> 
> An annoyance is that some of our orthos are at different resolutions, 
> some are in colour (most B&W), and some are already reprojected to 
> albers... this can all be overcome, but causes additional trouble... 
> this was supposed to be a simple task, it has become a nightmare (and 
> that never happens...)

lol

Well, given an assortment of input data your task isn't simple.

>> Another possibility would be to work with me to add alpha band support
>> to gdalwarp.  Then you could warp each file to an RGBA file with a=0
>> for pixels that are not set, and a=255 for pixels that are set.
>> MapServer knows how to utilize per-pixel alpha information when 
>> available.
> 
> 
> This actually seems like the best solution, since we want to be able to 
> add new orthos easily (without having to rebuild the tiles for that 
> area...), and we're not really worried about edge artifacts, or which 
> ortho gets used on slightly-overlapping edge cases...
> 
> Let me know if I'm missing something, but this doesn't seem too 
> difficult... Let me know off-list how long this would take you to do, 
> and how soon you could do it...

OK. I have been intending to make this work for a while, so I think now is
the time.  I will try to hack it into gdalwarp this week.  The low level
hooks already exist.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From chodgson at refractions.net  Wed Oct  6 17:07:39 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] warp and translate problems
In-Reply-To: <41645933.2020504@pobox.com>
References: <41642469.3080403@refractions.net> <41644776.8090204@pobox.com>
	<416456E8.2050101@refractions.net> <41645933.2020504@pobox.com>
Message-ID: <41645E9B.1010809@refractions.net>


>> I think the real problem was that gdaltindex wasn't recognizing the 
>> GeoJP2 georeferencing - it complained that my jp2 files weren't 
>> georeferenced. However, they loaded just fine in ArcMap - wow, GeoJP2 
>> must be a real standard if even ESRI recognizes it :-)
>
> Perhaps you have an old/incompatible gdaltindex?  Does your gdalinfo
> properly report georeferencing?

There was actually only one file that gave this error, and I think the 
original source was corrupt in some way... I don't think it's anything 
to worry about as I've just created a couple of tile indexes of jp2s 
using gdaltindex without any problems.

Chris

From route at cae.com  Wed Oct  6 17:27:34 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Help handling image with gcp.
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D192@caemsx03.cae.ca>


> Alternatively you could build an approximate geotransform (the same as it
> would use for a warp) from the GCPs.  This can be accomplished with the
> function GDALGCPsToGeoTransform().  Note that you will need to pass
bApproxOK
> as TRUE.

Hi Frank,

is that different than using 
void* transformer = GDALCreateGCPTransformer(...)
followed by 
GDALGCPTransform(transformer,...) for the 4 corner points and from those
points computing the transformation with
	georef[0] = m_upperLeftX;
	georef[3] = m_upperLeftY;
	georef[2] = 0;
	georef[4] = 0;
	georef[1]= (m_lowerRightX - m_lowerLeftX)/((double)m_nSizeX);
	georef[5]= -(m_upperRightY - m_lowerRightY)/((double)m_nSizeY);
?
In this case, there is no approximation ?
Am I wrong ?

Thanks,

Stephane

From Jeff.Collins at vexcel.com  Wed Oct  6 18:35:23 2004
From: Jeff.Collins at vexcel.com (Jeffery D. Collins)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
Message-ID: <200410061635.23577.Jeff.Collins@vexcel.com>



Below are diffs (against CVS) necessary for compiling gdal on Solaris 8 using 
gcc (3.2.2).  There are likely better ways to solve these problems, and I may 
have broken something else without realizing it.  Please point out my 
blunders:-) 


Had to build with: CFLAGS='-fPIC -DPIC' make


The change present in the first diff below was due to the compiler viewing 
CPPFLAGS as recursive.  The change in the second diff was due to the 
inability of the compiler to find jerror.h.  The final change failed to wrap 
OGR_G_Centroid in extern "C"{}.


Index: frmts/fit/GNUmakefile
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/frmts/fit/GNUmakefile,v
retrieving revision 1.6
diff -r1.6 GNUmakefile
7c7
< CPPFLAGS      =       $(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
---
> CPPFLAGS      :=      $(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
Index: frmts/gtiff/libtiff/GNUmakefile
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/frmts/gtiff/libtiff/GNUmakefile,v
retrieving revision 1.17
diff -r1.17 GNUmakefile
44c44
< ALL_C_FLAGS   =       $(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT 
-I../../zlib
---
> ALL_C_FLAGS   =       $(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT 
-I../../zlib 
-I../../../frmts/jpeg/libjpeg
Index: ogr/ogr_api.h
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/ogr/ogr_api.h,v
retrieving revision 1.20
diff -r1.20 ogr_api.h
383a384,385
> int OGR_G_Centroid( OGRGeometryH hPolygon, OGRGeometryH hCentroidPoint );
>  

Thanks!

-- 
Jeff


From warmerdam at pobox.com  Wed Oct  6 23:13:14 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Help handling image with gcp.
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D192@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D192@caemsx03.cae.ca>
Message-ID: <4164B44A.30404@pobox.com>

Stephane Routelous wrote:
>>Alternatively you could build an approximate geotransform (the same as it
>>would use for a warp) from the GCPs.  This can be accomplished with the
>>function GDALGCPsToGeoTransform().  Note that you will need to pass
> 
> bApproxOK
> 
>>as TRUE.
> 
> 
> Hi Frank,
> 
> is that different than using 
> void* transformer = GDALCreateGCPTransformer(...)
> followed by 
> GDALGCPTransform(transformer,...) for the 4 corner points and from those
> points computing the transformation with
> 	georef[0] = m_upperLeftX;
> 	georef[3] = m_upperLeftY;
> 	georef[2] = 0;
> 	georef[4] = 0;
> 	georef[1]= (m_lowerRightX - m_lowerLeftX)/((double)m_nSizeX);
> 	georef[5]= -(m_upperRightY - m_lowerRightY)/((double)m_nSizeY);
> ?
> In this case, there is no approximation ?
> Am I wrong ?

Stephane,

The "gcp transformer" just builds an approximate 1st order polynomial
internally so the approximation is just moved somewhere else.

Furthermore, the geotransform you show computing is "north up" while
my proposed solution can also account for shear and rotation.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Jeff.Collins at vexcel.com  Wed Oct  6 18:27:36 2004
From: Jeff.Collins at vexcel.com (Jeffery D. Collins)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
Message-ID: <200410061627.36856.Jeff.Collins@vexcel.com>

Below are diffs (against CVS) necessary for compiling gdal on Solaris 8 using 
gcc (3.2.2).  There are likely better ways to solve these problems, and I may 
have broken something else without realizing it.  Please point out my 
blunders:-) 


Had to build with: CFLAGS='-fPIC -DPIC' make


The change present in the first diff below was due to the compiler viewing 
CPPFLAGS as recursive.  The change in the second diff was due to the 
inability of the compiler to find jerror.h.  The final change failed to wrap 
OGR_G_Centroid in extern "C"{}.


Index: frmts/fit/GNUmakefile
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/frmts/fit/GNUmakefile,v
retrieving revision 1.6
diff -r1.6 GNUmakefile
7c7
< CPPFLAGS	=	$(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
---
> CPPFLAGS	:=	$(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
Index: frmts/gtiff/libtiff/GNUmakefile
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/frmts/gtiff/libtiff/GNUmakefile,v
retrieving revision 1.17
diff -r1.17 GNUmakefile
44c44
< ALL_C_FLAGS	=	$(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib
---
> ALL_C_FLAGS	=	$(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib 
-I../../../frmts/jpeg/libjpeg
Index: ogr/ogr_api.h
===================================================================
RCS file: /cvs/maptools/cvsroot/gdal/ogr/ogr_api.h,v
retrieving revision 1.20
diff -r1.20 ogr_api.h
383a384,385
> int OGR_G_Centroid( OGRGeometryH hPolygon, OGRGeometryH hCentroidPoint );
>  

Thanks!

-- 
Jeff


From warmerdam at pobox.com  Thu Oct  7 09:21:06 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <200410061627.36856.Jeff.Collins@vexcel.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
Message-ID: <416542C2.3020901@pobox.com>

Jeffery D. Collins wrote:
> Below are diffs (against CVS) necessary for compiling gdal on Solaris 8 using 
> gcc (3.2.2).  There are likely better ways to solve these problems, and I may 
> have broken something else without realizing it.  Please point out my 
> blunders:-) 
> 
> 
> Had to build with: CFLAGS='-fPIC -DPIC' make

Jeff,

Did you use --without-libtool?  If you build with libtool, then libtool
is supposed to take care of providing the -fPIC and any related flags.  If
you build without libtool, then configure should call the AC_COMPILER_PIC
flag which would set the CXX_PIC and C_PIC macros.

BTW, do you know what the -DPIC is supposed to accomplish?  I have never
seen a need for that before.

> The change present in the first diff below was due to the compiler viewing 
> CPPFLAGS as recursive.  The change in the second diff was due to the 
> inability of the compiler to find jerror.h.  The final change failed to wrap 
> OGR_G_Centroid in extern "C"{}.
> 
> 
> Index: frmts/fit/GNUmakefile
> ===================================================================
> RCS file: /cvs/maptools/cvsroot/gdal/frmts/fit/GNUmakefile,v
> retrieving revision 1.6
> diff -r1.6 GNUmakefile
> 7c7
> < CPPFLAGS	=	$(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
> ---
> 
>>CPPFLAGS	:=	$(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)

Yes, this is my fault - introduced yesterday afternoon.  I had to fix it
in several other drivers as well I found.

> Index: frmts/gtiff/libtiff/GNUmakefile
> ===================================================================
> RCS file: /cvs/maptools/cvsroot/gdal/frmts/gtiff/libtiff/GNUmakefile,v
> retrieving revision 1.17
> diff -r1.17 GNUmakefile
> 44c44
> < ALL_C_FLAGS	=	$(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib
> ---
> 
>>ALL_C_FLAGS	=	$(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT -I../../zlib 
> 
> -I../../../frmts/jpeg/libjpeg

The GNUmakefile includes this statement:

ifeq ($(JPEG_SETTING),internal)
ALL_C_FLAGS 	:=	$(ALL_C_FLAGS) -I../../jpeg/libjpeg
endif

This is supposed to add the gdal local libjpeg directory into the
include path if building with an internal copy of libjpeg.  Otherwise
we want to avoid forcing the use of the local libjpeg as the external
one is presumably the one that is being linked with.  I imagine any
include path for it should be in CPPFLAGS or GDAL_INCLUDE already.

I have *not* applied this change, so if there is a real requirement we
should discuss what is happening in more detail.

> Index: ogr/ogr_api.h
> ===================================================================
> RCS file: /cvs/maptools/cvsroot/gdal/ogr/ogr_api.h,v
> retrieving revision 1.20
> diff -r1.20 ogr_api.h
> 383a384,385
> 
>>int OGR_G_Centroid( OGRGeometryH hPolygon, OGRGeometryH hCentroidPoint );

Sorry about that ... I had done this but neglected to commit it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From pdooley at pyxisinnovation.com  Thu Oct  7 10:25:33 2004
From: pdooley at pyxisinnovation.com (Patrick Dooley)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] OGRCoordinateTransformation::Transform problem
Message-ID: <20041007142522.UBSS1698.tomts23-srv.bellnexxia.net@IOSDEV1>

Hello,

 

I am relatively new to GDAL.

 

I have two issues.  I would first like to set up a geocentric
OGRSpatialReference source as opposed to any specific datum.


I am currently attempting to convert WGS84 lat lon coordinates to UTM
coordinates.  However when the lat lon coordinates falls outside the valid
range of the UTM zone,  I get invalid utm coordinates.  However the
transform() method reports through its error handling that the conversion
was successfull.   

 

I have checked the bug list and did not see anything pertaining to this
issue.   

I did think of doing the inverse conversion to see if the resulting lat lon
coordinates match the input, but that is a hack.  I was hoping that there
might be a isValidPoint() method on the OGRSpatialReference object but I
didn't find any.  

 

If anyone can provide any suggestions I would be extremely grateful.

 

Sincerely,

 

Patrick Dooley.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041007/e1ee69c4/attachment.html
From warmerdam at pobox.com  Thu Oct  7 12:55:24 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalwarp and RGBA generation
Message-ID: <416574FC.5040807@pobox.com>

Chris,

I have implmented very preliminary support for generating output images
with an alpha band.  Use the -dstalpha option to gdalwarp to indicate that
it should add an alpha band to the output.

I also found that the JP2KAK driver was not writing RGBA images with the
proper band color interpretation.  So I made a change in there to fix that.

Make sure you do a clean build.  The GDALWarpOptions structure has changed,
and this sort of change is not properly recognised by the Makefiles.

With this change I was able to reproject an RGB image to an output RGBA
file with an alpha band as shown below.  This also took care of setting
alpha values for pre-existing "nodata" areas marked as zero.

   gdalwarp -dstalpha -srcnodata 0 landsat_rgb.tif l2.tif \
        -t_srs '+proj=utm +zone=21 +datum=WGS84'

The alpha support work isn't really complete, but I will need to return to
it in the future.  Currently "source alpha" isn't handled.  Also, I don't
think that destination alpha values are properly used when blending.

Finally, this works fine for RGB images, but using -dstalpha with
greyscale images isn't likely going to be to useful yet.  The output file
will be generated properly with the exception that I don't think the
alpha band will be properly marked as alpha in the .tif. Also, the jp2kak
driver doesn't yet support generating greyscale (or paletted) images with
alpha bands.  On top of all that, I don't think mapserver supports greyscale
images with alpha bands unless you specifically control things with a
PROCESSING "BAND=1,1,1,2" type directive.  In the meantime you could
just convert greyscale images to RGB before warping if that is acceptable
to you.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jeff.collins at vexcel.com  Thu Oct  7 14:38:07 2004
From: jeff.collins at vexcel.com (Jeffery D. Collins)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <416542C2.3020901@pobox.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
	<416542C2.3020901@pobox.com>
Message-ID: <41658D0F.1040708@vexcel.com>

Frank Warmerdam wrote:

> Jeffery D. Collins wrote:
>
>> Below are diffs (against CVS) necessary for compiling gdal on Solaris 
>> 8 using gcc (3.2.2).  There are likely better ways to solve these 
>> problems, and I may have broken something else without realizing it.  
>> Please point out my blunders:-)
>>
>> Had to build with: CFLAGS='-fPIC -DPIC' make
>
>
> Jeff,
>
> Did you use --without-libtool?  If you build with libtool, then libtool
> is supposed to take care of providing the -fPIC and any related 
> flags.  If
> you build without libtool, then configure should call the AC_COMPILER_PIC
> flag which would set the CXX_PIC and C_PIC macros.

No, I did not try this. 

>
> BTW, do you know what the -DPIC is supposed to accomplish?  I have never
> seen a need for that before.
>
No.  I saw it somewhere in a related build (proj, maybe?).  The build 
machine is pretty slow, so I tried to include everything that might 
possibly be necessary to avoid yet another rebuild.  

>> The change present in the first diff below was due to the compiler 
>> viewing CPPFLAGS as recursive.  The change in the second diff was due 
>> to the inability of the compiler to find jerror.h.  The final change 
>> failed to wrap OGR_G_Centroid in extern "C"{}.
>>
>>
>> Index: frmts/fit/GNUmakefile
>> ===================================================================
>> RCS file: /cvs/maptools/cvsroot/gdal/frmts/fit/GNUmakefile,v
>> retrieving revision 1.6
>> diff -r1.6 GNUmakefile
>> 7c7
>> < CPPFLAGS    =    $(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
>> ---
>>
>>> CPPFLAGS    :=    $(GDAL_INCLUDE) $(XTRA_OPT) $(CPPFLAGS)
>>
>
> Yes, this is my fault - introduced yesterday afternoon.  I had to fix it
> in several other drivers as well I found.
>
>> Index: frmts/gtiff/libtiff/GNUmakefile
>> ===================================================================
>> RCS file: /cvs/maptools/cvsroot/gdal/frmts/gtiff/libtiff/GNUmakefile,v
>> retrieving revision 1.17
>> diff -r1.17 GNUmakefile
>> 44c44
>> < ALL_C_FLAGS    =    $(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT 
>> -I../../zlib
>> ---
>>
>>> ALL_C_FLAGS    =    $(CFLAGS) -DZIP_SUPPORT -DPIXARLOG_SUPPORT 
>>> -I../../zlib 
>>
>>
>> -I../../../frmts/jpeg/libjpeg
>

This was due to a slightly broken jpeglib installation.  Apparently, 
jerror.h was missing from it.  This is no longer a problem.

>
> The GNUmakefile includes this statement:
>
> ifeq ($(JPEG_SETTING),internal)
> ALL_C_FLAGS     :=    $(ALL_C_FLAGS) -I../../jpeg/libjpeg
> endif
>
> This is supposed to add the gdal local libjpeg directory into the
> include path if building with an internal copy of libjpeg.  Otherwise
> we want to avoid forcing the use of the local libjpeg as the external
> one is presumably the one that is being linked with.  I imagine any
> include path for it should be in CPPFLAGS or GDAL_INCLUDE already.
>
> I have *not* applied this change, so if there is a real requirement we
> should discuss what is happening in more detail.


>
>> Index: ogr/ogr_api.h
>> ===================================================================
>> RCS file: /cvs/maptools/cvsroot/gdal/ogr/ogr_api.h,v
>> retrieving revision 1.20
>> diff -r1.20 ogr_api.h
>> 383a384,385
>>
>>> int OGR_G_Centroid( OGRGeometryH hPolygon, OGRGeometryH 
>>> hCentroidPoint );
>>
>
> Sorry about that ... I had done this but neglected to commit it.
>
> Best regards,


I updated my local copy from CVS, configured without libtool, recompiled 
and now everything works fine.  Thanks for the help!

-- 
Jeff



From warmerdam at pobox.com  Thu Oct  7 14:44:44 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <41658D0F.1040708@vexcel.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
	<416542C2.3020901@pobox.com> <41658D0F.1040708@vexcel.com>
Message-ID: <41658E9C.1060607@pobox.com>

Jeffery D. Collins wrote:
> I updated my local copy from CVS, configured without libtool, recompiled 
> and now everything works fine.  Thanks for the help!


Jeff,

OK, the only outstanding issue is why you needed to explicitly provide
the -fPIC when libtool is supposed to pick it up automatically where needed.
I really have no idea how to dig into that, so I think we can just leave
it unless you are really curious (or unless Alessandro has some ideas).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From alexamici at fastwebnet.it  Thu Oct  7 14:51:37 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <416542C2.3020901@pobox.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
	<416542C2.3020901@pobox.com>
Message-ID: <200410072051.37516.alexamici@fastwebnet.it>


Frank,

On Thursday 07 October 2004 15:21, Frank Warmerdam wrote:
> BTW, do you know what the -DPIC is supposed to accomplish?  I have never
> seen a need for that before.

my best guess is that the PIC macros is meant to be used into asm code by 
developers to distinguish (#ifdef) between pic and non-pic assembly paths 
(where needed).

no need to worry in a C++/C/python project ;-)

cheers,
alessandro

From Jeff.Collins at vexcel.com  Thu Oct  7 14:59:03 2004
From: Jeff.Collins at vexcel.com (Jeffery D. Collins)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <41658E9C.1060607@pobox.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
	<41658D0F.1040708@vexcel.com> <41658E9C.1060607@pobox.com>
Message-ID: <200410071259.03298.Jeff.Collins@vexcel.com>

On Thursday 07 October 2004 12:44 pm, Frank Warmerdam wrote:
> Jeffery D. Collins wrote:
> > I updated my local copy from CVS, configured without libtool, recompiled
> > and now everything works fine.  Thanks for the help!
>
> Jeff,
>
> OK, the only outstanding issue is why you needed to explicitly provide
> the -fPIC when libtool is supposed to pick it up automatically where
> needed. I really have no idea how to dig into that, so I think we can just
> leave it unless you are really curious (or unless Alessandro has some
> ideas).

After configuring with the switch --without-libtool, it was no longer 
necessary to explicitly include -fPIC.  Now, it's just:

./configure --prefix=<whatever> --without-libtool
make install

I edited my previous response over a period of several hours and must not have 
proofread it carefully enough.  Sorry for the confusion!

--
Jeff


From warmerdam at pobox.com  Thu Oct  7 23:49:05 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] OGRCoordinateTransformation::Transform problem
In-Reply-To: <20041007142522.UBSS1698.tomts23-srv.bellnexxia.net@IOSDEV1>
References: <20041007142522.UBSS1698.tomts23-srv.bellnexxia.net@IOSDEV1>
Message-ID: <41660E31.7080906@pobox.com>

Patrick Dooley wrote:
> I have two issues.  I would first like to set up a geocentric 
> OGRSpatialReference source as opposed to any specific datum.

Patrick,

While the underlying PROJ.4 library supports geocentric coordinate
systems, it appears I have not propagated that support into the
OGRSpatialReference at this time.

> I am currently attempting to convert WGS84 lat lon coordinates to UTM 
> coordinates.  However when the lat lon coordinates falls outside the 
> valid range of the UTM zone,  I get invalid utm coordinates.  However 
> the transform() method reports through its error handling that the 
> conversion was successfull.  

The transverse mercator math used in PROJ.4 degrades very seriously
when you get far away from the central meridian (say 30 degrees for
instance).  How far out of the zone are you?

In situations where the accuracy of the math degrades but can still
be evaluated the projection operation will generally seem to succeed
even if the results may not be very useful.

> I did think of doing the inverse conversion to see if the resulting lat 
> lon coordinates match the input, but that is a hack.  I was hoping that 
> there might be a isValidPoint() method on the OGRSpatialReference object 
> but I didn't find any. 

I'm afraid not.  Your suggestion of projecting back is a respectible
(if hacky) way of identifying whether the equations have broken down
pretty badly.

You might also want to raise this issue on the PROJ.4 list where you
will find folks with a deeper understanding of the projection issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Martin.Daly at cadcorp.com  Fri Oct  8 05:38:56 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA032200@dev001_pdc.Dev.cadcorp.net>

Frank,

I did a cvs update this morning, and the Windows build was broken.  I
had to change two files as follows, both attached:

frmts\airsar\airsardataset.cpp

Lines 358-361 from:

        M[M13] = byte[4] * fabs(byte[4]) * M[M11] / (127*127);
        M[M14] = byte[5] * fabs(byte[5]) * M[M11] / (127*127);
        M[M23] = byte[6] * fabs(byte[6]) * M[M11] / (127*127);
        M[M24] = byte[7] * fabs(byte[7]) * M[M11] / (127*127);

To:

        M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / (127*127);
        M[M14] = byte[5] * fabs((double) byte[5]) * M[M11] / (127*127);
        M[M23] = byte[6] * fabs((double) byte[6]) * M[M11] / (127*127);
        M[M24] = byte[7] * fabs((double) byte[7]) * M[M11] / (127*127);

VC++ .NET has multiple fabs-s (float, double and long double),and can't
choose which one without a cast.

frmts\hdf4\hdf-eos\makefile.vc

This did not have CRLF endings, and nmake was choking on it as a result.

Regards,
Martin
-------------- next part --------------
A non-text attachment was scrubbed...
Name: makefile.vc
Type: application/octet-stream
Size: 239 bytes
Desc: makefile.vc
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041008/5664f223/makefile.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: airsardataset.cpp
Type: application/octet-stream
Size: 23262 bytes
Desc: airsardataset.cpp
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041008/5664f223/airsardataset.obj
From Martin.Daly at cadcorp.com  Fri Oct  8 05:58:11 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] RE: Windows build from CVS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA032201@dev001_pdc.Dev.cadcorp.net>

And another one: nmake.opt

On further inspection, it looks like there were LFCRLF triplets for each
line.

Regards,
Martin

> -----Original Message-----
> From: Martin Daly 
> Sent: 08 October 2004 10:39
> To: 'gdal-dev@remotesensing.org'
> Subject: Windows build from CVS
> 
> 
> Frank,
> 
> I did a cvs update this morning, and the Windows build was 
> broken.  I had to change two files as follows, both attached:
> 
> frmts\airsar\airsardataset.cpp
> 
> Lines 358-361 from:
> 
>         M[M13] = byte[4] * fabs(byte[4]) * M[M11] / (127*127);
>         M[M14] = byte[5] * fabs(byte[5]) * M[M11] / (127*127);
>         M[M23] = byte[6] * fabs(byte[6]) * M[M11] / (127*127);
>         M[M24] = byte[7] * fabs(byte[7]) * M[M11] / (127*127);
> 
> To:
> 
>         M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / 
> (127*127);
>         M[M14] = byte[5] * fabs((double) byte[5]) * M[M11] / 
> (127*127);
>         M[M23] = byte[6] * fabs((double) byte[6]) * M[M11] / 
> (127*127);
>         M[M24] = byte[7] * fabs((double) byte[7]) * M[M11] / 
> (127*127);
> 
> VC++ .NET has multiple fabs-s (float, double and long 
> double),and can't 
> VC++ choose which one without a cast.
> 
> frmts\hdf4\hdf-eos\makefile.vc
> 
> This did not have CRLF endings, and nmake was choking on it 
> as a result.
> 
> Regards,
> Martin
> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: nmake.opt
Type: application/octet-stream
Size: 6814 bytes
Desc: nmake.opt
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041008/be17609f/nmake.obj
From tdobmeye at ball.com  Thu Oct  7 12:17:48 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887EF@daytonmsg2k3.AERO.BALL.COM>

I have a .tif file showing the western the western half of the world.
The file is 246 MB in size which is way too huge to deal with. I want to
be able to type in the latitude and longitude coordinates of the area
that I would like to use instead of using the whole picture. I type in
the command:

 

C:\Support Libraries\gdal-1.2.0\apps> gdalwarp -te 30 135 45 60
land_shallow_topo_west.tif usa.tif

 

Land_shallow_topo_west.tif is the file that contains the western
hemisphere and usa.tif is the file that I would like to be created. 30,
135 is the latitude and longitude that I would like to put the
lower-left corner at and 45, 60 is the upper right corner. But when I
try this command with the .tif file in the apps folder, I receive this
error.

 

ERROR 1: Unable to compute a transformation between pixel/line

and georeferenced coordinates for land_shallow_topo_west.tif.

There is no affine transformation and no GCPs.

 

What does this error mean? Is there a way to type in two latitudes and
longitudes to cut out a section of my picture? Thanks for your help.

 

Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041007/22f96c57/attachment.html
From warmerdam at pobox.com  Fri Oct  8 09:11:56 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
In-Reply-To: <DE8A435707FBA24392E5C67F58E294AA032200@dev001_pdc.Dev.cadcorp.net>
References: <DE8A435707FBA24392E5C67F58E294AA032200@dev001_pdc.Dev.cadcorp.net>
Message-ID: <4166921C.8090701@pobox.com>

Martin Daly wrote:
> Frank,
> 
> I did a cvs update this morning, and the Windows build was broken.  I
> had to change two files as follows, both attached:
...
>         M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / (127*127);
>         M[M14] = byte[5] * fabs((double) byte[5]) * M[M11] / (127*127);
>         M[M23] = byte[6] * fabs((double) byte[6]) * M[M11] / (127*127);
>         M[M24] = byte[7] * fabs((double) byte[7]) * M[M11] / (127*127);
> 
> VC++ .NET has multiple fabs-s (float, double and long double),and can't
> choose which one without a cast.

Martin,

Thanks, I have applied the above.

> frmts\hdf4\hdf-eos\makefile.vc
> 
> This did not have CRLF endings, and nmake was choking on it as a result.

I have recommitted with DOS CRLF text conventions.

 > And another one: nmake.opt
 >
 > On further inspection, it looks like there were LFCRLF triplets for each
 > line.

Hmm, I took a look at this and I don't see this problem.  Any idea why yours
might come out of CVS different than mine?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Oct  8 09:36:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34058680@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34058680@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416697C4.2050203@pobox.com>

Clay, Bruce wrote:
> This is one of those really trivial things but since some of the
> operations in GDAL are performed millions or billions of times wouldn't
> it make since to not perform redundant operations where possible.
> 
> Example: in the code shown below the operation 127 * 127 is performed 4
> times X the number of times this method is called.  If the number was
> changed to 16129 several cycles could be saved.  While it is true that
> computers are getting faster and faster the databases are getting larger
> as well.
 >
 >        M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / (127*127);

Bruce,

All but the most brain dead of modern optimizing compilers will compute
constant expressions at compile time and the emitted code will have the
resulting value.  I often like to leave expressions like the above in
the code as it is easier to relate it to the original documented
equations or in general to understand the meaning.

I think a more compelling case could be made that I should have optimized
the fabs() call to just mask off the sign bit of the byte[4] which did not
occur to me when I was writing the code.  Converting a signed byte to
floating point and then invoking a floating point function just to clear
the sign deep in per-pixel calculations is pretty pricey.

In this same source file I also used pow() to compute powers of two and the
very general purpose pow() can be very expensive for something that should be
achievable with left integer bit shifts.  However, a brief attempt to
replace the pow() didn't work out, so I abandoned that effort.

I do try to be sensitive to performance issues but ultimately I only
apply careful optimization in code that I feel will be heavily used or
where a client has emphasized the importance of performance.

The good news is that AIRSAR images aren't getting any bigger.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ed at topozone.com  Fri Oct  8 09:42:07 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
In-Reply-To: <416697C4.2050203@pobox.com>
Message-ID: <20041008094207.df0ef469@strabo11>

Frank -

Actually, internal optimizations in pow() are quite common, too, for 0, 1, and 2, although the conversions do of course occur.  I agree in making clear, readable code perform well and letting the compilers do their jobs.  I am not aware of ANY compiler on the market that would fail to the constant folding required here.

     - Ed

----- Original Message -----
From: Frank Warmerdam <warmerdam@pobox.com>
To: "Clay, Bruce" <bclay@ball.com>
Cc: gdal-dev <gdal-dev@remotesensing.org>
Sent: Fri,  8 Oct 2004 09:36:04 -0400
Subject: Re: [Gdal-dev] Windows build from CVS


> Clay, Bruce wrote:
> > This is one of those really trivial things but since some of the
> > operations in GDAL are performed millions or billions of times wouldn't
> > it make since to not perform redundant operations where possible.
> > 
> > Example: in the code shown below the operation 127 * 127 is performed 4
> > times X the number of times this method is called.  If the number was
> > changed to 16129 several cycles could be saved.  While it is true that
> > computers are getting faster and faster the databases are getting larger
> > as well.
>  >
>  >        M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / (127*127);
> 
> Bruce,
> 
> All but the most brain dead of modern optimizing compilers will compute
> constant expressions at compile time and the emitted code will have the
> resulting value.  I often like to leave expressions like the above in
> the code as it is easier to relate it to the original documented
> equations or in general to understand the meaning.
> 
> I think a more compelling case could be made that I should have optimized
> the fabs() call to just mask off the sign bit of the byte[4] which did not
> occur to me when I was writing the code.  Converting a signed byte to
> floating point and then invoking a floating point function just to clear
> the sign deep in per-pixel calculations is pretty pricey.
> 
> In this same source file I also used pow() to compute powers of two and the
> very general purpose pow() can be very expensive for something that should be
> achievable with left integer bit shifts.  However, a brief attempt to
> replace the pow() didn't work out, so I abandoned that effort.
> 
> I do try to be sensitive to performance issues but ultimately I only
> apply careful optimization in code that I feel will be heavily used or
> where a client has emphasized the importance of performance.
> 
> The good news is that AIRSAR images aren't getting any bigger.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> 


From dmorissette at dmsolutions.ca  Fri Oct  8 11:49:27 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
In-Reply-To: <4166921C.8090701@pobox.com>
References: <DE8A435707FBA24392E5C67F58E294AA032200@dev001_pdc.Dev.cadcorp.net>
	<4166921C.8090701@pobox.com>
Message-ID: <4166B707.5070809@dmsolutions.ca>

Frank Warmerdam wrote:
> 
>> frmts\hdf4\hdf-eos\makefile.vc
>>
>> This did not have CRLF endings, and nmake was choking on it as a result.
> 
> 
> I have recommitted with DOS CRLF text conventions.
> 
>  > And another one: nmake.opt
>  >
>  > On further inspection, it looks like there were LFCRLF triplets for each
>  > line.
> 
> Hmm, I took a look at this and I don't see this problem.  Any idea why 
> yours
> might come out of CVS different than mine?
> 

This may have something to do with the fact that the Windows CVS client 
does some linefeed conversions as you checkout or commit a file. All 
text files in the CVS server are stored in Unix format, and the Windows 
CVS client takes care of linefeed conversions for Windows users. If you 
commit files with funky linefeeds from Linux then that could lead to the 
kind of problems you see here. (I've seen that problem before, I'm just 
not sure what had happened exactly.)

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From debian at adkgis.org  Fri Oct  8 23:36:28 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] geojp2 heavy resource use
Message-ID: <1097292988.3944.34.camel@marcy>

Hi,

I see huge cpu and memory use when invoking gdalinfo on these
jpeg200/geojp2 files:

ftp://ftp.remotesensing.org/jpeg2000/doq.jp2
ftp://ftp.remotesensing.org/jpeg2000/gtopo.jp2

These rasters don't seem that big either.

Steve


From dron at ak4719.spb.edu  Sat Oct  9 04:44:58 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] geojp2 heavy resource use
In-Reply-To: <1097292988.3944.34.camel@marcy>
References: <1097292988.3944.34.camel@marcy>
Message-ID: <20041009084458.GA15637@ak4719.spb.edu>

On Fri, Oct 08, 2004 at 11:36:28PM -0400, Steve Halasz wrote:
> I see huge cpu and memory use when invoking gdalinfo on these
> jpeg200/geojp2 files:
> 
> ftp://ftp.remotesensing.org/jpeg2000/doq.jp2
> ftp://ftp.remotesensing.org/jpeg2000/gtopo.jp2
> 
> These rasters don't seem that big either.

It seems that you are using JasPer based driver. That is normal for that
driver, because the library don't have a call to fetch the image
parameters (width, height etc.) without decoding the whole image in the
buffer. Also this library has a poor perfomance.

Consider using Kakadu or MrSID drivers. Recent MrSID decoding SDKs are
available without charge fro variety of platforms and have JPEG2000
support built-in.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Sat Oct  9 04:44:58 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] geojp2 heavy resource use
In-Reply-To: <1097292988.3944.34.camel@marcy>
References: <1097292988.3944.34.camel@marcy>
Message-ID: <20041009084458.GA15637@ak4719.spb.edu>

On Fri, Oct 08, 2004 at 11:36:28PM -0400, Steve Halasz wrote:
> I see huge cpu and memory use when invoking gdalinfo on these
> jpeg200/geojp2 files:
> 
> ftp://ftp.remotesensing.org/jpeg2000/doq.jp2
> ftp://ftp.remotesensing.org/jpeg2000/gtopo.jp2
> 
> These rasters don't seem that big either.

It seems that you are using JasPer based driver. That is normal for that
driver, because the library don't have a call to fetch the image
parameters (width, height etc.) without decoding the whole image in the
buffer. Also this library has a poor perfomance.

Consider using Kakadu or MrSID drivers. Recent MrSID decoding SDKs are
available without charge fro variety of platforms and have JPEG2000
support built-in.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From gbuckmaster at cox.net  Sat Oct  9 11:20:09 2004
From: gbuckmaster at cox.net (Gerald Buckmaster)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] GDAL 1.2.3 Formally Released
In-Reply-To: <009501c4a78d$3bcf86a0$f400fe0a@TOPP2>
Message-ID: <20041009152345.ZHRN21535.fed1rmmtao09.cox.net@bennetcourt>

Does anyone have VC6SP6 project files for GDAL 1.2.3?  Or is it possible the
VC7.1 project files below could work in VC6?  Thanks!

Buck

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Ben Discoe
Sent: Friday, October 01, 2004 1:04 AM
To: 'gdal-dev'
Subject: RE: [Gdal-dev] GDAL 1.2.3 Formally Released


For those interested, i have created a new revision of the VC7.1 project
files for GDAL 1.2.3.  To use them, just unzip it to your GDAL source
directory, load the solution and build.
  http://vterrain.org/dist/gdal_123_vc71.zip  (26k)

-Ben

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

---
Incoming mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.771 / Virus Database: 518 - Release Date: 9/28/2004
 

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.774 / Virus Database: 521 - Release Date: 10/7/2004
 


From alexamici at fastwebnet.it  Sat Oct  9 17:22:04 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] compiling gdal from CVS on solaris
In-Reply-To: <41658E9C.1060607@pobox.com>
References: <200410061627.36856.Jeff.Collins@vexcel.com>
	<41658D0F.1040708@vexcel.com> <41658E9C.1060607@pobox.com>
Message-ID: <200410092322.04377.alexamici@fastwebnet.it>


Frank,

On Thursday 07 October 2004 20:44, Frank Warmerdam wrote:
> (or unless Alessandro has some ideas).

no idea and no solaris box at hand ;-/.

cheers,
alessandro

From debian at adkgis.org  Sun Oct 10 15:17:00 2004
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Are there plans to integrate geojp2 with main jasper
	source?
Message-ID: <1097435820.4200.56.camel@marcy>

Hi,

I've requested[1] inclusion of the geojp2 modifications for jasper[2] to
debian's version of that library. The debian maintainer of jasper has
asked:

> * When I include the feature now only for Debian, I'm responsible for
> supporting it in future versions. I hope you understand that it's hard
> to track different derived upstream versions (patches) and that it would
> be much more appreciated to see such features included in the main
> jasper distribution. Have you asked Michael D. Adams yet? I understand
> that he seems to be busy and doesn't have much time for maintaining it.
> What about a joint effort of maintaining jasper collaboratively (like a
> sourceforge project) with him?

Has any petition been made to Michael D. Adams along these lines?

Thanks,
Steve

[1] http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=275619
[2] ftp://ftp.remotesensing.org/gdal/jasper-1.701.0.uuid.tar.gz


From dron at ak4719.spb.edu  Sun Oct 10 16:20:28 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Are there plans to integrate geojp2 with main jasper
	source?
In-Reply-To: <1097435820.4200.56.camel@marcy>
References: <1097435820.4200.56.camel@marcy>
Message-ID: <20041010202028.GA16976@ak4719.spb.edu>

On Sun, Oct 10, 2004 at 03:17:00PM -0400, Steve Halasz wrote:
> I've requested[1] inclusion of the geojp2 modifications for jasper[2]
> to debian's version of that library. The debian maintainer of jasper
> has asked:
> 
> > * When I include the feature now only for Debian, I'm responsible
> > for supporting it in future versions. I hope you understand that
> > it's hard to track different derived upstream versions (patches) and
> > that it would be much more appreciated to see such features included
> > in the main jasper distribution. Have you asked Michael D. Adams
> > yet? I understand that he seems to be busy and doesn't have much
> > time for maintaining it. What about a joint effort of maintaining
> > jasper collaboratively (like a sourceforge project) with him?
> 
> Has any petition been made to Michael D. Adams along these lines?

I sent him my patch two years ago, but don't ask to include it in the
main distribution. I'm not sure it should be included in the JasPer,
there are much more important issues with that library beside the
GeoJP2. It will be more helpful to ask him to make his project more open
(i.e. grant the public access to the development source tree). Right now
we even don't know whether he still works on library or not.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dron at ak4719.spb.edu  Sun Oct 10 16:20:28 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Are there plans to integrate geojp2 with main jasper
	source?
In-Reply-To: <1097435820.4200.56.camel@marcy>
References: <1097435820.4200.56.camel@marcy>
Message-ID: <20041010202028.GA16976@ak4719.spb.edu>

On Sun, Oct 10, 2004 at 03:17:00PM -0400, Steve Halasz wrote:
> I've requested[1] inclusion of the geojp2 modifications for jasper[2]
> to debian's version of that library. The debian maintainer of jasper
> has asked:
> 
> > * When I include the feature now only for Debian, I'm responsible
> > for supporting it in future versions. I hope you understand that
> > it's hard to track different derived upstream versions (patches) and
> > that it would be much more appreciated to see such features included
> > in the main jasper distribution. Have you asked Michael D. Adams
> > yet? I understand that he seems to be busy and doesn't have much
> > time for maintaining it. What about a joint effort of maintaining
> > jasper collaboratively (like a sourceforge project) with him?
> 
> Has any petition been made to Michael D. Adams along these lines?

I sent him my patch two years ago, but don't ask to include it in the
main distribution. I'm not sure it should be included in the JasPer,
there are much more important issues with that library beside the
GeoJP2. It will be more helpful to ask him to make his project more open
(i.e. grant the public access to the development source tree). Right now
we even don't know whether he still works on library or not.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From ksa-nil5 at yandex.ru  Mon Oct 11 10:54:01 2004
From: ksa-nil5 at yandex.ru (ksa)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Feature Style problem
Message-ID: <05f501c4afa3$5a4e0890$0b01a8c0@nil5>

Hi, Frank.

I'm using OGR 1.2.3 for working with MapInfo files.

I have found that OGRFeature::GetStyleString() returns not accurate
information.
And that is why.
I have MIF file with follow information

-- start of MIF file
Version 300
Charset "WindowsCyrillic"
Delimiter ","
CoordSys Earth Projection 1, 0
Columns 1
  asd Char(10)
Data

Region  1
  5
0.152334 -0.130221
0.82064 0.547912
1.282556 0.159705
0.84521 -0.601966
0.152334 -0.130221
    Pen (1,2,0)
    Brush (60,16711680)
    Center 0.717445 -0.027027
--end of MIF file

how you can see, Brush is transparent (has no background color).
But OGRFeature::GetStyleString() returns follow style string:
"BRUSH(fc:#ff0000,bc:#ffffff,id:"mapinfo-brush-60.ogr-brush-0");PEN(...)".
So, that say current feature has white background color. But that not
represent the facts!.

I have found in MITAB module (file mitab_feature.cpp) in
ITABFeatureBrush::GetBrushStyleString() follow lines:

<...>
       pszStyle
=CPLSPrintf("BRUSH(fc:#%6.6x,bc:#%6.6x,id:\"mapinfo-brush-%d.ogr-brush-%d\")
",
                            m_sBrushDef.rgbFGColor,
                            m_sBrushDef.rgbBGColor,
                            m_sBrushDef.nFillPattern,nOGRStyle);
<...>

in other words, brush ALWAYS has background color!
I have found, that ITABFeatureBrush has method GetBrushTransparent(). So, I
suggest remake that method as follow:

<...>
    if(GetBrushTransparent())
       pszStyle
=CPLSPrintf("BRUSH(fc:#%6.6x,id:\"mapinfo-brush-%d.ogr-brush-%d\")",
                            m_sBrushDef.rgbFGColor,
                            m_sBrushDef.nFillPattern,nOGRStyle);
    else
       pszStyle
=CPLSPrintf("BRUSH(fc:#%6.6x,bc:#%6.6x,id:\"mapinfo-brush-%d.ogr-brush-%d\")
",
                            m_sBrushDef.rgbFGColor,
                            m_sBrushDef.rgbBGColor,
                            m_sBrushDef.nFillPattern,nOGRStyle);
<...>

Sergey A. Karin


From dmorissette at dmsolutions.ca  Mon Oct 11 15:42:53 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Feature Style problem
In-Reply-To: <05f501c4afa3$5a4e0890$0b01a8c0@nil5>
References: <05f501c4afa3$5a4e0890$0b01a8c0@nil5>
Message-ID: <416AE23D.7050700@dmsolutions.ca>

ksa wrote:
> 
> I'm using OGR 1.2.3 for working with MapInfo files.
> 
> I have found that OGRFeature::GetStyleString() returns not accurate
> information.
> And that is why.
> I have MIF file with follow information
> 

Um... this would be a bug in the MITAB library which is used by OGR.

I have filed a bug and will try to have a look:

http://maptools.org/bugzilla/show_bug.cgi?id=693

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From dron at ak4719.spb.edu  Mon Oct 11 15:44:40 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] geojp2 heavy resource use
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DB798AD@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DB798AD@vader.prologic-inc.com>
Message-ID: <20041011194440.GA8853@ak4719.spb.edu>

On Mon, Oct 11, 2004 at 02:35:05PM -0400, William Lyons wrote:
> >Consider using Kakadu or MrSID drivers. Recent MrSID decoding SDKs
> >are available without charge fro variety of platforms and have
> >JPEG2000 support built-in.
> 
> Would you happen to have any hints on how or where to get a recent
> MrSID decoding SDK?

It should be available at the

 http://developer.lizardtech.com


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dmorissette at dmsolutions.ca  Mon Oct 11 16:27:14 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Feature Style problem
In-Reply-To: <416AE23D.7050700@dmsolutions.ca>
References: <05f501c4afa3$5a4e0890$0b01a8c0@nil5>
	<416AE23D.7050700@dmsolutions.ca>
Message-ID: <416AECA2.8000801@dmsolutions.ca>

Daniel Morissette wrote:
> 
> I have filed a bug and will try to have a look:
> 
> http://maptools.org/bugzilla/show_bug.cgi?id=693
> 

Thanks for the test file and the patch, I tested it and it works great. 
I have applied it to the MITAB library and also to the copy that comes 
with OGR.

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------

From Martin.Daly at cadcorp.com  Tue Oct 12 03:18:55 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Windows build from CVS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA04E8FA@dev001_pdc.Dev.cadcorp.net>

Frank,
 
It's all smoke and mirrors to me.  (And pretty p*ss-poor of nmake to choke.  We also spent a long time recently infuriated by the VS .NET debugger, which refused to step onto a block of code.  It turned out the code had LF not CRLF which *displayed* OK in VS.NET, but the debugger thought was all one long line.  What joy.)
 
I was using cvs 1.11.2, from www.cvshome.org, which is way out of date.  I'll try again with 1.11.17, the current stable version.
 
Regards,
Martin

	-----Original Message----- 
	From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
	Sent: Fri 08/10/2004 14:11 
	To: Martin Daly 
	Cc: gdal-dev@remotesensing.org 
	Subject: Re: [Gdal-dev] Windows build from CVS
	
	

	Martin Daly wrote:
	> Frank,
	>
	> I did a cvs update this morning, and the Windows build was broken.  I
	> had to change two files as follows, both attached:
	...
	>         M[M13] = byte[4] * fabs((double) byte[4]) * M[M11] / (127*127);
	>         M[M14] = byte[5] * fabs((double) byte[5]) * M[M11] / (127*127);
	>         M[M23] = byte[6] * fabs((double) byte[6]) * M[M11] / (127*127);
	>         M[M24] = byte[7] * fabs((double) byte[7]) * M[M11] / (127*127);
	>
	> VC++ .NET has multiple fabs-s (float, double and long double),and can't
	> choose which one without a cast.
	
	Martin,
	
	Thanks, I have applied the above.
	
	> frmts\hdf4\hdf-eos\makefile.vc
	>
	> This did not have CRLF endings, and nmake was choking on it as a result.
	
	I have recommitted with DOS CRLF text conventions.
	
	 > And another one: nmake.opt
	 >
	 > On further inspection, it looks like there were LFCRLF triplets for each
	 > line.
	
	Hmm, I took a look at this and I don't see this problem.  Any idea why yours
	might come out of CVS different than mine?
	
	Best regards,
	--
	---------------------------------------+--------------------------------------
	I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
	light and sound - activate the windows | http://pobox.com/~warmerdam
	and watch the world go round - Rush    | Geospatial Programmer for Rent
	
	
	

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041012/40f2bdb0/attachment.html
From tdobmeye at ball.com  Tue Oct 12 08:22:37 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887F3@daytonmsg2k3.AERO.BALL.COM>

I have a .tif file showing the western the western half of the world.
The file is 246 MB in size which is way too huge to deal with. I want to
be able to type in the latitude and longitude coordinates of the area
that I would like to use instead of using the whole picture. I type in
the command:
 
C:\Support Libraries\gdal-1.2.0\apps> gdalwarp -te 30 135 45 60
land_shallow_topo_west.tif usa.tif
 
Land_shallow_topo_west.tif is the file that contains the western
hemisphere and usa.tif is the file that I would like to be created. 30,
135 is the latitude and longitude that I would like to put the
lower-left corner at and 45, 60 is the upper right corner. But when I
try this command with the .tif file in the apps folder, I receive this
error.
 
ERROR 1: Unable to compute a transformation between pixel/line
 
and georeferenced coordinates for land_shallow_topo_west.tif.
 
There is no affine transformation and no GCPs.
 
What does this error mean? Is there a way to type in two latitudes and
longitudes to cut out a section of my picture? Thanks for your help.
 
Todd Dobmeyer

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041012/2ab5e54c/attachment.html
From m.massing at warped-space.de  Tue Oct 12 08:57:43 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340887F3@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340887F3@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <200410121457.43865.m.massing@warped-space.de>

Todd,

you'll have to georeference your data appropriately.

The attached cpp program should work for the western hemisphere. 
Otherwise, you'll have to adjust the affine transform offsets in lines 
30 and 31.

cheers,

 Manuel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: add_transform.cpp
Type: text/x-c++src
Size: 1213 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041012/acd49ea7/add_transform.bin
From m.massing at warped-space.de  Tue Oct 12 09:02:40 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
In-Reply-To: <200410121457.43865.m.massing@warped-space.de>
References: <C482FF98AE985A47B8C982FD429C9E340887F3@daytonmsg2k3.AERO.BALL.COM>
	<200410121457.43865.m.massing@warped-space.de>
Message-ID: <200410121502.40617.m.massing@warped-space.de>

Oh, I forgot:

you're better off using gdal_translate (instead of gdalwarp), no need to 
reproject the dataset.

bye,
 Manuel

From tdobmeye at ball.com  Tue Oct 12 09:13:04 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887F6@daytonmsg2k3.AERO.BALL.COM>

Sorry but I am new to this stuff. Why do I want to use gdal_translate
instead of gdal_warp? I want to be able to input a min and max of
latitude and longitude, and I do not see where gdal_translate will allow
this. Also, where do I put that file you sent me? Does it go in the
gcore folder? Thanks.

Todd

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Manuel Massing
Sent: Tuesday, October 12, 2004 9:03 AM
To: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Error Message with gdalwarp

Oh, I forgot:

you're better off using gdal_translate (instead of gdalwarp), no need to

reproject the dataset.

bye,
 Manuel
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From m.massing at warped-space.de  Tue Oct 12 09:30:10 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340887F6@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340887F6@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <200410121530.10964.m.massing@warped-space.de>

Hi Todd,

> Sorry but I am new to this stuff. Why do I want to use gdal_translate
> instead of gdal_warp? I want to be able to input a min and max of
> latitude and longitude, and I do not see where gdal_translate will allow
> this. Also, where do I put that file you sent me? Does it go in the
> gcore folder? Thanks.

No, this is a standalone utility, you just need to have gdal in the 
include/link path of your C++ compiler. Assuming you do not have a C++
compiler set up, you can find the appropriate pixel coordinates by hand
(one pixel covers 1/120 deg in the mentioned dataset):

 x_pixel = (desired_longitude+180)*120
 y_pixel = (desired_lattitude+90)*120

 x_size = long_extent*120
 y_size = lat_extent*120

Then: gdal_translate -srcwin <x_pixel> <y_pixel> <x_size> <y_size> western.tif 
output.tif

For georeferenced files, you can use -projwin instead of -srcwin.

hth,

 Manuel

From tdobmeye at ball.com  Tue Oct 12 09:55:33 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887F7@daytonmsg2k3.AERO.BALL.COM>

My files are geo-referenced so I assume I do not need to use that
utility you sent me. My .tif file is 21600x21600. I want to go from 135
W to 60 W and from 30 N to 45 N. I converted these to pixels like you
said and came out to my x_pixel being 37,800, my y_pixel to be 14,400,
my x_size to 9000, and my y_size to be 1800. When I type in my command,
I get this following error.

Input file size is 21600, 21600
Computed -srcwin 37800 14400 -28799 -12599 from projected window.
0.ERROR 2: CPLMalloc(): Out of memory allocating -28799 bytes.


This application has requested the Runtime to terminate it in an unusual
way.
Please contact the application's support team for more information.

What does this mean? Am I finding something incorrectly? Thanks for your
help again!

Todd

-----Original Message-----
From: Manuel Massing [mailto:m.massing@warped-space.de] 
Sent: Tuesday, October 12, 2004 9:30 AM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Error Message with gdalwarp

Hi Todd,

> Sorry but I am new to this stuff. Why do I want to use gdal_translate
> instead of gdal_warp? I want to be able to input a min and max of
> latitude and longitude, and I do not see where gdal_translate will
allow
> this. Also, where do I put that file you sent me? Does it go in the
> gcore folder? Thanks.

No, this is a standalone utility, you just need to have gdal in the 
include/link path of your C++ compiler. Assuming you do not have a C++
compiler set up, you can find the appropriate pixel coordinates by hand
(one pixel covers 1/120 deg in the mentioned dataset):

 x_pixel = (desired_longitude+180)*120
 y_pixel = (desired_lattitude+90)*120

 x_size = long_extent*120
 y_size = lat_extent*120

Then: gdal_translate -srcwin <x_pixel> <y_pixel> <x_size> <y_size>
western.tif 
output.tif

For georeferenced files, you can use -projwin instead of -srcwin.

hth,

 Manuel

From pdooley at pyxisinnovation.com  Fri Oct  8 09:58:44 2004
From: pdooley at pyxisinnovation.com (Patrick Dooley)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Re: OGRCoordinateTransformation::Transform problem
References: <20041007142522.UBSS1698.tomts23-srv.bellnexxia.net@IOSDEV1>
	<41660E31.7080906@pobox.com>
Message-ID: <ck66as$5vf$1@sea.gmane.org>


"Frank Warmerdam" <warmerdam@pobox.com> wrote in message
news:41660E31.7080906@pobox.com...
> Patrick Dooley wrote:
> > I have two issues.  I would first like to set up a geocentric
> > OGRSpatialReference source as opposed to any specific datum.
>
> Patrick,
>
> While the underlying PROJ.4 library supports geocentric coordinate
> systems, it appears I have not propagated that support into the
> OGRSpatialReference at this time.
>
> > I am currently attempting to convert WGS84 lat lon coordinates to UTM
> > coordinates.  However when the lat lon coordinates falls outside the
> > valid range of the UTM zone,  I get invalid utm coordinates.  However
> > the transform() method reports through its error handling that the
> > conversion was successfull.
>
> The transverse mercator math used in PROJ.4 degrades very seriously
> when you get far away from the central meridian (say 30 degrees for
> instance).  How far out of the zone are you?
>
> In situations where the accuracy of the math degrades but can still
> be evaluated the projection operation will generally seem to succeed
> even if the results may not be very useful.
>
Dear Frank,

I could be way out,  I am essentially walking the globe and attempting to
try to convert these various points to the utm points.

> > I did think of doing the inverse conversion to see if the resulting lat
> > lon coordinates match the input, but that is a hack.  I was hoping that
> > there might be a isValidPoint() method on the OGRSpatialReference object
> > but I didn't find any.
>
> I'm afraid not.  Your suggestion of projecting back is a respectible
> (if hacky) way of identifying whether the equations have broken down
> pretty badly.
>
> You might also want to raise this issue on the PROJ.4 list where you
> will find folks with a deeper understanding of the projection issues.

Is there an easy way to get the geocentric lat lon limits of an
OGRSpatialReference object.  This way I could do a sanity check before
attempting to do the conversion?

Thanks for the fast response.
>
> Best regards,
> --
> ---------------------------------------+----------------------------------
----
> I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent




From perl.bj at 126.com  Mon Oct 11 00:01:38 2004
From: perl.bj at 126.com (perl.bj)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] hello, a question of static link proj4
Message-ID: <416A05A2.4010704@126.com>

hello, How do you static link proj4? I want to static link gdal, what 
should i do?

Thanks




From moradi at inco.ac.ir  Tue Oct 12 09:28:27 2004
From: moradi at inco.ac.ir (moradi)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Visualize Gdal supported formats
Message-ID: <200410120928.AA101777646@inco.ac.ir>

Hi,
 I am new to GDAL. I would like to know how can I visualize the raster and vector GDAL's supported formats in a MFC application.
Thanks in advance.

Best Regards

Masoud

From superbla3000 at gmx.net  Sun Oct 10 11:44:12 2004
From: superbla3000 at gmx.net (joerg p)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] adjust colors
Message-ID: <ckbl4l$lv4$1@sea.gmane.org>

hello,

is there actually a tool to adjust the colors of a geotiff? I have 
several 1.2 GB geotiffs and would like to have the red values more blue 
and the green not so strong...

I could open them with Photoshop, but this will take ages...

Thanks
Joerg


From warmerdam at pobox.com  Tue Oct 12 10:11:57 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340887F7@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340887F7@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416BE62D.6040805@pobox.com>

Dobmeyer, Todd wrote:
> My files are geo-referenced so I assume I do not need to use that
> utility you sent me. My .tif file is 21600x21600. I want to go from 135
> W to 60 W and from 30 N to 45 N. I converted these to pixels like you
> said and came out to my x_pixel being 37,800, my y_pixel to be 14,400,
> my x_size to 9000, and my y_size to be 1800. When I type in my command,
> I get this following error.
> 
> Input file size is 21600, 21600
> Computed -srcwin 37800 14400 -28799 -12599 from projected window.
> 0.ERROR 2: CPLMalloc(): Out of memory allocating -28799 bytes.

Todd,

The arguments to the -srcwin are "xoff yoff xsize ysize".  So the first
two arguments are the pixel/line location of the top left corner of your
source window (zero based) and the next two arguments are the window
of the requested window in pixels and lines.

Assuming the top left corner is 37800,14400 you would use:

   -srcwin 37800 14400 9000 1800

Clearly the error checking in the application should be better so the
code wouldn't end up blowing a gasket down in the guts.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 12 10:18:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Visualize Gdal supported formats
In-Reply-To: <200410120928.AA101777646@inco.ac.ir>
References: <200410120928.AA101777646@inco.ac.ir>
Message-ID: <416BE7BA.9050206@pobox.com>

moradi wrote:
> Hi,
>  I am new to GDAL. I would like to know how can I visualize the raster and vector GDAL's supported formats in a MFC application.
> Thanks in advance.

Masoud,

The GDAL web page lists a number of projects using GDAL, some of which are
viewers.  You might want to check there.  I will suggest OpenEV which
supports both GDAL raster formats and OGR vector formats.   A kit for
windows with lots of formats built in is available at:

   http://gdal.org/dl/openev/OpenEV_FW_182.zip

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 12 10:22:24 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] hello, a question of static link proj4
In-Reply-To: <416A05A2.4010704@126.com>
References: <416A05A2.4010704@126.com>
Message-ID: <416BE8A0.2010500@pobox.com>

perl.bj wrote:
> hello, How do you static link proj4? I want to static link gdal, what 
> should i do?

Perl.BJ,

If you use the GDAL configure option "--with-static-proj" you can
statically link PROJ.4 into the GDAL shared library instead of having it
uses dynamic loading to find the PROJ shared library at run time.  Now this
still will generally mean that the PROJ shared library is used, but it will
be done using normal shared library mechanisms rather than dynamic loading
(using dlopen() and dlsym()).  I am assuming you are interested in Linux/Unix
since you didn't specify.

You also state that you want to "static link gdal".  Do you mean that you
want to link gdal static libraries into your application?  This can be
pretty tricky, but in theory the "gdal-config --dep-libs" output plus
adding libgdal.a to your link should accomplish this.  This isn't something
that I often attempt.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 12 10:26:00 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Re: OGRCoordinateTransformation::Transform problem
In-Reply-To: <ck66as$5vf$1@sea.gmane.org>
References: <20041007142522.UBSS1698.tomts23-srv.bellnexxia.net@IOSDEV1>	<41660E31.7080906@pobox.com>
	<ck66as$5vf$1@sea.gmane.org>
Message-ID: <416BE978.4040602@pobox.com>

Patrick Dooley wrote:
> Is there an easy way to get the geocentric lat lon limits of an
> OGRSpatialReference object.  This way I could do a sanity check before
> attempting to do the conversion?

Patrick,

Sorry ... no there is not.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From m.massing at warped-space.de  Tue Oct 12 10:32:07 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340887F7@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340887F7@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <200410121632.07878.m.massing@warped-space.de>

Hello Todd,

> W to 60 W and from 30 N to 45 N. I converted these to pixels like you
> said and came out to my x_pixel being 37,800, my y_pixel to be 14,400,
> my x_size to 9000, and my y_size to be 1800. When I type in my command,
> I get this following error.

use negative longitude for western hemisphere in the formulas
(note that they only pertrain to the specific dataset you mentioned!)...  
I also made a small mistake, y_pixel should be (90 - latitude)*120.

I.e.  x_pixel = (-135+180)*120 = 5400 
and  y_pixel = (90-45)*120 = 5400.

This gives you the offset in pixels, so you have to use the -srcwin option.

Use -projwin for projected coordinates only (i.e., in your case
longitude+latitude). This will only work if the input file is
georeferenced, however.

Manuel

From ealpert at digitalglobe.com  Tue Oct 12 10:44:24 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] adjust colors
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B181D@COMAIL01.digitalglobe.com>


You may want to look at Imagemagick. The one caveat is you'll need to
save your projection information and use gdal_translate/gdalwarp to
reapply the projection information. Another caveat is I've found that
NODATA values are can cause some of imagemagicks functionality to behave
abnormally.

-e

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of joerg p
Sent: Sunday, October 10, 2004 9:44 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] adjust colors


hello,

is there actually a tool to adjust the colors of a geotiff? I have 
several 1.2 GB geotiffs and would like to have the red values more blue 
and the green not so strong...

I could open them with Photoshop, but this will take ages...

Thanks
Joerg

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From Eric.Doenges at rcs.ei.tum.de  Tue Oct 12 10:48:18 2004
From: Eric.Doenges at rcs.ei.tum.de (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] hello, a question of static link proj4
In-Reply-To: <416BE8A0.2010500@pobox.com>
References: <416A05A2.4010704@126.com> <416BE8A0.2010500@pobox.com>
Message-ID: <416BEEB2.4020100@rcs.ei.tum.de>

Frank Warmerdam wrote:

> perl.bj wrote:
>
>> hello, How do you static link proj4? I want to static link gdal, what 
>> should i do?
>
>
> Perl.BJ,
>
> If you use the GDAL configure option "--with-static-proj" you can
> statically link PROJ.4 into the GDAL shared library instead of having it
> uses dynamic loading to find the PROJ shared library at run time.  Now 
> this
> still will generally mean that the PROJ shared library is used, but it 
> will
> be done using normal shared library mechanisms rather than dynamic 
> loading
> (using dlopen() and dlsym()).  I am assuming you are interested in 
> Linux/Unix
> since you didn't specify.

I'ld like to point out one more thing - when you configure gdal this 
way, make sure
that you've already built libproj.a and that it can be linked with. 
Otherwise, the gdal
configure script will (semi-)silently ignore your request to statically 
link libproj.a.
In fact, make sure all required libraries are linkable, since having one 
of them
not linkable during configure can cause the configure to fail in 
mysterious ways
(well, mysterious until you read the config.log file that is).

With kind regards,
Eric

From gillian.walter at atlantis-scientific.com  Tue Oct 12 11:37:44 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] adjust colors
References: <1FB6937A87F9074C9A2B8F9D9137EB16017B181D@COMAIL01.digitalglobe.com>
Message-ID: <416BFA48.4D3BA7E3@atlantis-scientific.com>

You might be able to use gdal_translate with the "-scale" option instead,
if you knew in advance how much you wanted to rescale by (eg. if you opened
the image in OpenEV, played with the scale min/max settings until you liked
them, and used those).  You might have to split the bands out first though,
since I don't know if you can specify separate scaling ranges for each
band.  You could use vrt as an intermediate format to save space:

eg.
gdal_translate -of VRT -b 1 -scale 100 200 test.tif b1.vrt
gdal_translate -of VRT -b 2 -scale 50 200 test.tif b2.vrt
gdal_translate -of VRT -b 3 -scale 10 200 test.tif b3.vrt
<edit b1.vrt to contain the VRTRasterBand sections of b2.vrt and b3.vrt as
well>
gdal_translate -of GTiff b1.vrt output.tif

Note: the above would translate the a source value of 100 to a destination
value of 0 and 200 to 255 for the first band, a source value of 50 to a
destination value of 0 for the second band, etc.

- Gillian

Ethan Alpert wrote:

> You may want to look at Imagemagick. The one caveat is you'll need to
> save your projection information and use gdal_translate/gdalwarp to
> reapply the projection information. Another caveat is I've found that
> NODATA values are can cause some of imagemagicks functionality to behave
> abnormally.
>
> -e
>
> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com
> [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of joerg p
> Sent: Sunday, October 10, 2004 9:44 AM
> To: gdal-dev@remotesensing.org
> Subject: [Gdal-dev] adjust colors
>
> hello,
>
> is there actually a tool to adjust the colors of a geotiff? I have
> several 1.2 GB geotiffs and would like to have the red values more blue
> and the green not so strong...
>
> I could open them with Photoshop, but this will take ages...
>
> Thanks
> Joerg
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From tdobmeye at ball.com  Tue Oct 12 12:40:53 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Error Message with gdalwarp
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887F9@daytonmsg2k3.AERO.BALL.COM>

Manuel

Thank you for your continued help. I have gotten it set up so it can
create the file that I would like it to do. But when I try to open the
file, it says that the Drawing Failed. I am just using Windows Picture
and Fax Viewer, but it is able to show the original picture. Why is this
picture then undrawable? I typed in my line correctly.

gdal_translate -srcwin 5400 5400 9000 1800 land_shallow_topo_west.tif
test.tif

Am I typing something incorrectly? Thanks again for your help.

Todd


-----Original Message-----
From: Manuel Massing [mailto:m.massing@warped-space.de] 
Sent: Tuesday, October 12, 2004 10:32 AM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] Error Message with gdalwarp

Hello Todd,

> W to 60 W and from 30 N to 45 N. I converted these to pixels like you
> said and came out to my x_pixel being 37,800, my y_pixel to be 14,400,
> my x_size to 9000, and my y_size to be 1800. When I type in my
command,
> I get this following error.

use negative longitude for western hemisphere in the formulas
(note that they only pertrain to the specific dataset you mentioned!)...

I also made a small mistake, y_pixel should be (90 - latitude)*120.

I.e.  x_pixel = (-135+180)*120 = 5400 
and  y_pixel = (90-45)*120 = 5400.

This gives you the offset in pixels, so you have to use the -srcwin
option.

Use -projwin for projected coordinates only (i.e., in your case
longitude+latitude). This will only work if the input file is
georeferenced, however.

Manuel

From warmerdam at pobox.com  Tue Oct 12 16:02:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Readonly MySQL Support
Message-ID: <416C385A.1020700@pobox.com>

Folks,

I have implemented read-only support for non-spatial MySQL databases using
the mysql C API.  This is pretty easy to build in and use on Unix/Linux
(--with-mysql=.../mysql_config).  On Windows it is somewhat tricker since
you seem to need to build with /MT /GX in order to use the libraries provided
with MySQL 4.1.

Use a datasource name something like:

   MYSQL:dbname,user=warmerda,password=fancypass,host=home.gdal.org,port=3603

All the stuff from user= on can be ignored, or set in your .my.cnf configuration
file.

If anyone has questions read over the driver docs and then feel free to ask
questions.

Note that I do not currently support the new MySQL spatial objects, though that
is quite desirable.  I also do not support writing to MySQL at this time though
I would like to implement that at some point as well.

This work was mostly done to avoid the hassles of ODBC configuration on Linux
for the fairly common use of non-spatial MySQL data, or MySQL data in which
the spatial relationship is established via a .vrt file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From norbert.thieme at ilmenau.baw.de  Wed Oct 13 09:01:23 2004
From: norbert.thieme at ilmenau.baw.de (Norbert Thieme)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] problem compiling GDAL1.2.3 with Xerces2.5.0
Message-ID: <416D2723.5050104@ilmenau.baw.de>

Hello,

I have a problem compiling gdal 1.2.3 with xerces 2.5.0 on Linux. I
tried --with-xerces and got:

"configure: error: Please correct Xerces options, or don't enable Xerces."

The default Paths should be fine. For example the xerces include path:
"-I/usr/local/include/xercesc"

Some time ago I compiled gdal 1.2.0b with xerces 2.5.0 and it worked. Is
there a problem with the version of xerces? Which version will be better?

Any help will be appreciated.

Thanks in advance,
Norbert


From tdobmeye at ball.com  Wed Oct 13 10:19:52 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal_translate new picture won't draw
Message-ID: <C482FF98AE985A47B8C982FD429C9E340887FA@daytonmsg2k3.AERO.BALL.COM>

Thank you for your continued help. I have gotten it set up so it can
create the file that I would like it to do. But when I try to open the
file, it says that the Drawing Failed. I am just using Windows Picture
and Fax Viewer, but it is able to show the original picture. Why is this
picture then undrawable? I typed in my line correctly.

 

gdal_translate -srcwin 5400 5400 9000 1800 land_shallow_topo_west.tif
test.tif

 

Am I typing something incorrectly? Thanks again for your help.

 

Todd

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/fbbe9dc0/attachment.html
From warmerdam at pobox.com  Wed Oct 13 10:31:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal_translate new picture won't draw
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340887FA@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340887FA@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416D3C42.1040301@pobox.com>

Dobmeyer, Todd wrote:
> Thank you for your continued help. I have gotten it set up so it can 
> create the file that I would like it to do. But when I try to open the 
> file, it says that the Drawing Failed. I am just using Windows Picture 
> and Fax Viewer, but it is able to show the original picture. Why is this 
> picture then undrawable? I typed in my line correctly.
> 
>  
> 
> gdal_translate -srcwin 5400 5400 9000 1800 land_shallow_topo_west.tif 
> test.tif

Todd,

There are a variety of possible reasons, and you haven't provided much
detail on the nature of the file you are producing.  I *suspect* it is
a multi-band (ie. RGB) file and is using the default GDAL band interleaving.
Try the following and see if it helps.


gdal_translate -srcwin 5400 5400 9000 1800 -co "INTERLEAVE=PIXEL" \
                land_shallow_topo_west.tif test.tif

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gillian.walter at atlantis-scientific.com  Wed Oct 13 11:23:46 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal cache
Message-ID: <416D4882.22CE6DBE@atlantis-scientific.com>

Hi,

Is there any way to force gdal to flush its read cache? I've looked at
the dataset and raster band FlushCache methods, but they just seem to
write out any changes that have been made via gdal.  I am wondering if
there is any way to tell gdal that an external application has altered a
dataset.

Gillian



From warmerdam at pobox.com  Wed Oct 13 11:45:40 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal cache
In-Reply-To: <416D4882.22CE6DBE@atlantis-scientific.com>
References: <416D4882.22CE6DBE@atlantis-scientific.com>
Message-ID: <416D4DA4.8070407@pobox.com>

Gillian Walter wrote:
> Hi,
> 
> Is there any way to force gdal to flush its read cache? I've looked at
> the dataset and raster band FlushCache methods, but they just seem to
> write out any changes that have been made via gdal.  I am wondering if
> there is any way to tell gdal that an external application has altered a
> dataset.

Gillian,

The GDALRasterBand::FlushBlock() method will write out the block data if
the block is dirty (altered in memory since reading from disk), and then
it does "delete poBlock" which removes the block from the cache and recovers
the memory.

So, normal flushing should also get rid of the readcached block information.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gillian.walter at atlantis-scientific.com  Wed Oct 13 12:05:59 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal cache
References: <416D4882.22CE6DBE@atlantis-scientific.com>
	<416D4DA4.8070407@pobox.com>
Message-ID: <416D5266.4D86F68B@atlantis-scientific.com>

Hi,

I've done a test in python, and it doesn't seem to be flushing:

>>> import gdal
>>> jnk = gdal.Open('/tmp/tmptqTlGV')
>>> arr=jnk.GetRasterBand(1).ReadAsArray()
>>> arr[10,10]
(77+151j)
[copied a new same-size, same type file over /tmp/tmptqT1GV at this point]
>>>  jnk.FlushCache()
>>>  arr2=jnk.GetRasterBand(1).ReadAsArray()
>>> arr2[10,10]
(77+151j)
>>> jnk2=gdal.Open('/tmp/tmptqT1GV')
>>> arr3=jnk2.GetRasterBand(1).ReadAsArray()
>>> arr3[10,10]
(16+50j)
>>> jnk.GetRasterBand(1).FlushCache()
0
>>> arr2=jnk.GetRasterBand(1).ReadAsArray()
>>> arr2[10,10]
(77+151j)

Am I missing something else?

Thanks,

Gillian

Frank Warmerdam wrote:

> Gillian Walter wrote:
> > Hi,
> >
> > Is there any way to force gdal to flush its read cache? I've looked at
> > the dataset and raster band FlushCache methods, but they just seem to
> > write out any changes that have been made via gdal.  I am wondering if
> > there is any way to tell gdal that an external application has altered a
> > dataset.
>
> Gillian,
>
> The GDALRasterBand::FlushBlock() method will write out the block data if
> the block is dirty (altered in memory since reading from disk), and then
> it does "delete poBlock" which removes the block from the cache and recovers
> the memory.
>
> So, normal flushing should also get rid of the readcached block information.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Oct 13 12:20:38 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdal cache
In-Reply-To: <416D5266.4D86F68B@atlantis-scientific.com>
References: <416D4882.22CE6DBE@atlantis-scientific.com>
	<416D4DA4.8070407@pobox.com>
	<416D5266.4D86F68B@atlantis-scientific.com>
Message-ID: <416D55D6.8000607@pobox.com>

Gillian Walter wrote:
> Hi,
> 
> I've done a test in python, and it doesn't seem to be flushing:

Gillian,

How was the file externally updated?  Was it completely re-written?  If so
it is likely that GDAL still has the old file open even though it doesn't
show up in the file system.  For instance, you can open a file with GDAL
and then delete it from the operating system but GDAL will continue to access
the data till the file is closed at which point the operating system really
deletes it.

I suspect something like this is going on in your case.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tdobmeye at ball.com  Wed Oct 13 12:19:43 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088800@daytonmsg2k3.AERO.BALL.COM>

Is there any way to retrieve geo-reference information from gdalinfo?
All I have been able to figure out is getting the information that can
be easily obtained such as the corner locations of a 21600 x 21600
picture. I want information such as what are the coordinates at the
corners and how many pixels per degree or something along that line so I
can figure out how many pixels there are per degree. Thanks for your
help.

 

Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/d4375fd3/attachment.html
From ealpert at digitalglobe.com  Wed Oct 13 12:22:00 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B1834@COMAIL01.digitalglobe.com>

What image format do you have? If you have GeoTiff GDAL info gives you
the projection and coordinate information. 
 
-e

	-----Original Message-----
	From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Dobmeyer, Todd
	Sent: Wednesday, October 13, 2004 10:20 AM
	To: gdal-dev@xserve.flids.com
	Subject: [Gdal-dev] gdalinfo
	
	

	Is there any way to retrieve geo-reference information from
gdalinfo? All I have been able to figure out is getting the information
that can be easily obtained such as the corner locations of a 21600 x
21600 picture. I want information such as what are the coordinates at
the corners and how many pixels per degree or something along that line
so I can figure out how many pixels there are per degree. Thanks for
your help.

	 

	Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/a7c05f0c/attachment.html
From tdobmeye at ball.com  Wed Oct 13 12:32:05 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088802@daytonmsg2k3.AERO.BALL.COM>

They are .tif files. I am using files from Blue Marble. They are
land_shallow_topo_east.tif and land_shallow_topo_west.tif. Here is the
output I am receiving from these files in their 21600x21600 format.

 

Driver: GTiff/GeoTIFF

Size is 21600, 21600

Coordinate System is `'

Metadata:

  TIFFTAG_XRESOLUTION=72

  TIFFTAG_YRESOLUTION=72

  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)

Corner Coordinates:

Upper Left  (    0.0,    0.0)

Lower Left  (    0.0,21600.0)

Upper Right (21600.0,    0.0)

Lower Right (21600.0,21600.0)

Center      (10800.0,10800.0)

Band 1 Block=21600x1 Type=Byte, ColorInterp=Red

Band 2 Block=21600x1 Type=Byte, ColorInterp=Green

Band 3 Block=21600x1 Type=Byte, ColorInterp=Blue

 

This doesn't appear to me what I am looking for. Any help again is
greatly appreciated. Thanks!

 

Todd Dobmeyer

 

 

-----Original Message-----
From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
Sent: Wednesday, October 13, 2004 12:22 PM
To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] gdalinfo

 

What image format do you have? If you have GeoTiff GDAL info gives you
the projection and coordinate information. 

 

-e

	-----Original Message-----
	From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Dobmeyer, Todd
	Sent: Wednesday, October 13, 2004 10:20 AM
	To: gdal-dev@xserve.flids.com
	Subject: [Gdal-dev] gdalinfo

	Is there any way to retrieve geo-reference information from
gdalinfo? All I have been able to figure out is getting the information
that can be easily obtained such as the corner locations of a 21600 x
21600 picture. I want information such as what are the coordinates at
the corners and how many pixels per degree or something along that line
so I can figure out how many pixels there are per degree. Thanks for
your help.

	 

	Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/a4875b8d/attachment.html
From ealpert at digitalglobe.com  Wed Oct 13 12:41:58 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B1835@COMAIL01.digitalglobe.com>

Does the image come with a tfw? Your output suggests there's no
projection associated with your tif.
 
Here's what my gdalinfo looks like on GeoTiff's I create:
 
Driver: GTiff/GeoTIFF
Size is 1039, 3628
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235629972,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree (supplier to define
representation)",0.01745329251994328],
    AUTHORITY["EPSG","4326"]]
Origin = (-105.220222,40.261786)
Pixel Size = (0.00020000,-0.00020000)
Corner Coordinates:
Upper Left  (-105.2202222,  40.2617861) (105d13'12.80"W, 40d15'42.43"N)
Lower Left  (-105.2202222,  39.5361861) (105d13'12.80"W, 39d32'10.27"N)
Upper Right (-105.0124222,  40.2617861) (105d 0'44.72"W, 40d15'42.43"N)
Lower Right (-105.0124222,  39.5361861) (105d 0'44.72"W, 39d32'10.27"N)
Center      (-105.1163222,  39.8989861) (105d 6'58.76"W, 39d53'56.35"N)
Band 1 Block=1039x7 Type=Byte, ColorInterp=Red
Band 2 Block=1039x7 Type=Byte, ColorInterp=Green
Band 3 Block=1039x7 Type=Byte, ColorInterp=Blue


	

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/7727a033/attachment.html
From tdobmeye at ball.com  Wed Oct 13 13:03:41 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088804@daytonmsg2k3.AERO.BALL.COM>

Did you create your own tfw file or find one? I do not seem to have any
tfw files with my tif files. This is why I cannot find the information I
want? Thanks again!

 

Todd

 

-----Original Message-----
From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
Sent: Wednesday, October 13, 2004 12:42 PM
To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] gdalinfo

 

Does the image come with a tfw? Your output suggests there's no
projection associated with your tif.

 

Here's what my gdalinfo looks like on GeoTiff's I create:

 

Driver: GTiff/GeoTIFF
Size is 1039, 3628
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235629972,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree (supplier to define
representation)",0.01745329251994328],
    AUTHORITY["EPSG","4326"]]
Origin = (-105.220222,40.261786)
Pixel Size = (0.00020000,-0.00020000)
Corner Coordinates:
Upper Left  (-105.2202222,  40.2617861) (105d13'12.80"W, 40d15'42.43"N)
Lower Left  (-105.2202222,  39.5361861) (105d13'12.80"W, 39d32'10.27"N)
Upper Right (-105.0124222,  40.2617861) (105d 0'44.72"W, 40d15'42.43"N)
Lower Right (-105.0124222,  39.5361861) (105d 0'44.72"W, 39d32'10.27"N)
Center      (-105.1163222,  39.8989861) (105d 6'58.76"W, 39d53'56.35"N)
Band 1 Block=1039x7 Type=Byte, ColorInterp=Red
Band 2 Block=1039x7 Type=Byte, ColorInterp=Green
Band 3 Block=1039x7 Type=Byte, ColorInterp=Blue

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/887ff7a7/attachment.html
From ramagnus at kde.org  Wed Oct 13 13:15:11 2004
From: ramagnus at kde.org (Rolf Magnus)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Floating point pixel coordinates and scaling
Message-ID: <200410131915.12536.ramagnus@kde.org>

Hi!

I'm currently writing a moving map program for KDE that uses gdal. Basically, 
I just use GDALDataSet::RasterIO in my paint event handler to get the pixels 
that I need to redraw when some parts of my view get exposed. This is very 
fast, even when I let gdal scale it on a slow PC.
Anyway, I've got one specific problem with the scaling. When the image is to 
be scaled up, the input coordinates might not lie on an exact pixel boundary. 
I would need a way to specify e.g.  that I want to start at pixel coordinates 
200.125/150.25, which is not possible, because RasterIO wants integer 
coordinates. I can work around that problem somehow, but I think it might be 
a good idea to solve it in gdal itself. What do you people think about that?


From warmerdam at pobox.com  Wed Oct 13 13:24:26 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] Floating point pixel coordinates and scaling
In-Reply-To: <200410131915.12536.ramagnus@kde.org>
References: <200410131915.12536.ramagnus@kde.org>
Message-ID: <416D64CA.6030207@pobox.com>

Rolf Magnus wrote:
> Hi!
> 
> I'm currently writing a moving map program for KDE that uses gdal. Basically, 
> I just use GDALDataSet::RasterIO in my paint event handler to get the pixels 
> that I need to redraw when some parts of my view get exposed. This is very 
> fast, even when I let gdal scale it on a slow PC.
> Anyway, I've got one specific problem with the scaling. When the image is to 
> be scaled up, the input coordinates might not lie on an exact pixel boundary. 
> I would need a way to specify e.g.  that I want to start at pixel coordinates 
> 200.125/150.25, which is not possible, because RasterIO wants integer 
> coordinates. I can work around that problem somehow, but I think it might be 
> a good idea to solve it in gdal itself. What do you people think about that?

Rolf,

I see the issue, and it has caused me headaches sometimes myself.  But the
use of integer windowing in the GDAL RasterIO() API is pretty deeply
embedded, and I am not planning to change it.

The warp api addresses issues like this in a more correct manner but I
think you would find the warp api quite a bit slower and not appropriate
for use in a repaint-proc.

In fact, for some file formats that don't support caching in GDAL you may
also find performance suffers dramatically - or in cases where the cache
isn't set high enough.  But I'm pleased to hear that it is working well for
you in most cases.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tdobmeye at ball.com  Thu Oct 14 08:58:07 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088808@daytonmsg2k3.AERO.BALL.COM>

Did you create your own tfw file or find one? I do not seem to have any
tfw files with my tif files. This is why I cannot find the information I
want? Thanks again!
 
Todd

 

 

-----Original Message-----
From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
Sent: Wednesday, October 13, 2004 12:42 PM
To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] gdalinfo

 

Does the image come with a tfw? Your output suggests there's no
projection associated with your tif.

 

Here's what my gdalinfo looks like on GeoTiff's I create:

 

Driver: GTiff/GeoTIFF
Size is 1039, 3628
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235629972,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree (supplier to define
representation)",0.01745329251994328],
    AUTHORITY["EPSG","4326"]]
Origin = (-105.220222,40.261786)
Pixel Size = (0.00020000,-0.00020000)
Corner Coordinates:
Upper Left  (-105.2202222,  40.2617861) (105d13'12.80"W, 40d15'42.43"N)
Lower Left  (-105.2202222,  39.5361861) (105d13'12.80"W, 39d32'10.27"N)
Upper Right (-105.0124222,  40.2617861) (105d 0'44.72"W, 40d15'42.43"N)
Lower Right (-105.0124222,  39.5361861) (105d 0'44.72"W, 39d32'10.27"N)
Center      (-105.1163222,  39.8989861) (105d 6'58.76"W, 39d53'56.35"N)
Band 1 Block=1039x7 Type=Byte, ColorInterp=Red
Band 2 Block=1039x7 Type=Byte, ColorInterp=Green
Band 3 Block=1039x7 Type=Byte, ColorInterp=Blue

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/0f04c6b6/attachment.html
From sevilla_lui at gva.es  Thu Oct 14 09:34:36 2004
From: sevilla_lui at gva.es (Luis W. Sevilla)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] gdalinfo
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34088808@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34088808@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416E806C.7050003@gva.es>

Dobmeyer, Todd wrote:

> Did you create your own tfw file or find one? I do not seem to have any
> tfw files with my tif files. This is why I cannot find the information I
> want? Thanks again!
>  
>
You must have tfw files already, with the georeferencing info. Your tiff 
sims to be a plain
one, with no georef info at all.

By the way ... why I'm unable to get any georef info from bsb files 
(nos/geo and kap) ?
   Luis


Todd





-----Original Message-----
From: Ethan Alpert [mailto:ealpert@digitalglobe.com] Sent: Wednesday, 
October 13, 2004 12:42 PM
To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] gdalinfo


From warmerdam at pobox.com  Thu Oct 14 10:19:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] GDAL and Security Issues
Message-ID: <416E8AE1.5070700@pobox.com>

Folks,

I just read a new security notice about an image file being a potential
security hole, this time with Solaris and Xpm files.  Past alerts have included
jpeg files and png files (via libz) and a few others I can't recall.  The
libtiff team has also received and corrected a number of security related
issues with libtiff.

The point I would like to make in this email is that GDAL format drivers are
likely to contain bugs that would allow "hostile" image files to cause a stack
overrun, and potentially result in a security breach.

Folks who are opening files from untrusted sources should take this risk into
account.  In normal day to day use this isn't likely a big risk, but it does
exist.  The risk is likely greater in cases where GDAL is used in a server
that accepts arbitrary input files from untrusted users over the Internet.

In addition to the risk of attackers preparing hostile files specifically
intended to exploit holes in GDAL, there are also likely to be holes in the
various supporting libraries such as libtiff, libpng, libjpeg and even the
commercial libraries such as those used for ECW, MrSID and JPEG2000.  The
chance of bugs in these more widely used libraries being exploited is
proportionately higher.

While it is image files that have gotten most of the attention in security
alerts lately, similar issues could occur with vector files and OGR.

I will take reasonable steps to avoid problems in code I write, and to
updated to fixed versions of public libraries after a fix but ultimately
I take no responsibility for the "safety" of GDAL.  I also welcome feedback
on perceived security issues in GDAL or supporting libraries, or even funding
for a more indepth audit of GDAL code for security issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From neteler at itc.it  Thu Oct 14 10:58:06 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:25 2007
Subject: [Gdal-dev] OGR and ODGI: reprojection problem
Message-ID: <20041014145806.GN28441@thuille.itc.it>

Hi,

for a long time I am trying to convert/reproject the
VMAP0 to SHAPE/PostGIS/WGS84.

Today I have updated another time OGDI and compiled with:
 ./configure --with-proj --with-zlib --with-expat

This should use the external PROJ4 as far as I understand.
Still no hope:

ogr2ogr -t_srs +init=epsg:4326 -nlt LINESTRING coastl_eurnasia_wgs84.shp gltp:/vrf/grass0/warmerdam/v0eur/vmaplv0/eurnasia 'coastl@bnd(*)_line'
ERROR 6: Failed to initialize PROJ.4 with `+proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs '.
unknown projection id
Failed to create coordinate transformation between the
following coordinate systems.  This may be because they
are not transformable, or because projection services
(PROJ.4 DLL/.so) could not be loaded.
Source:
GEOGCS["NAD83",
    DATUM["North_American_Datum_1983",
        SPHEROID["GRS 1980",6378137,298.257222101,
            AUTHORITY["EPSG","7019"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6269"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9108"]],
    AXIS["Lat",NORTH],
    AXIS["Long",EAST],
    AUTHORITY["EPSG","4269"]]
Target:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]


But: I have recompiled PROJ4 with the NAD files:
ls /usr/local/share/proj/
alaska  epsg  FL    hawaii  nad27  nad.lst       null          prvi      stlrnc  TN  WO
conus   esri  GL27  MD      nad83  ntv1_can.dat  proj_def.dat  stgeorge  stpaul  WI  world

Trying the command line version of 'cs2cs':

cs2cs -v +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs +to +proj=longlat +ellps=WGS84
# ---- From Coordinate System ----
#Lat/long (Geodetic)
#
# +proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs +towgs84=0,0,0
#--- following specified but NOT used
# +ellps=GRS80
# ---- To Coordinate System ----
#Lat/long (Geodetic)
#
# +proj=longlat +ellps=WGS84
10.0001E 10.0001N
10d0'0.36"E     10d0'0.36"N -0.000

It's at least doing something.

Checking with 'ldd' reports:

ldd /usr/local/bin/ogr2ogr | grep 'ogdi\|proj'
        libogdi31.so => /usr/local/lib/libogdi31.so (0x40367000)
        libzlib_ogdi31.so => /usr/local/lib/libzlib_ogdi31.so (0x4063c000)
        libexpat_ogdi31.so => /usr/local/lib/libexpat_ogdi31.so (0x40649000)

ldd /usr/local/lib/libgdal.so | grep 'ogdi\|proj'
        libogdi31.so => /usr/local/lib/libogdi31.so (0x4033a000)
        libzlib_ogdi31.so => /usr/local/lib/libzlib_ogdi31.so (0x40626000)
        libexpat_ogdi31.so => /usr/local/lib/libexpat_ogdi31.so (0x40633000)

ldd /usr/local/lib/libogdi.so | grep 'ogdi\|proj'
        libzlib_ogdi31.so => /usr/local/lib/libzlib_ogdi31.so (0x40052000)
        libexpat_ogdi31.so => /usr/local/lib/libexpat_ogdi31.so (0x4005f000)

No indication that libproj.so is used (which is there as well).

Any ideas what could be wrong? I'm getting desperated now... :-)

Best regards

 Markus Neteler


From ealpert at digitalglobe.com  Thu Oct 14 11:11:54 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B1840@COMAIL01.digitalglobe.com>

Do you know the projection and coordinates? If so you can use
gdal_translate and gdal_warp to generate one but you have to know the
corner points of your image.
 
-e

	-----Original Message-----
	From: Dobmeyer, Todd [mailto:tdobmeye@ball.com] 
	Sent: Thursday, October 14, 2004 6:58 AM
	To: Ethan Alpert; gdal-dev@xserve.flids.com
	Subject: RE: [Gdal-dev] gdalinfo
	
	
	Did you create your own tfw file or find one? I do not seem to
have any
	tfw files with my tif files. This is why I cannot find the
information I
	want? Thanks again!
	 
	Todd

	 

	 

	-----Original Message-----
	From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
	Sent: Wednesday, October 13, 2004 12:42 PM
	To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
	Subject: RE: [Gdal-dev] gdalinfo

	 

	Does the image come with a tfw? Your output suggests there's no
projection associated with your tif.

	 

	Here's what my gdalinfo looks like on GeoTiff's I create:

	 

	Driver: GTiff/GeoTIFF
	Size is 1039, 3628
	Coordinate System is:
	GEOGCS["WGS 84",
	    DATUM["WGS_1984",
	        SPHEROID["WGS 84",6378137,298.2572235629972,
	            AUTHORITY["EPSG","7030"]],
	        AUTHORITY["EPSG","6326"]],
	    PRIMEM["Greenwich",0],
	    UNIT["degree (supplier to define
representation)",0.01745329251994328],
	    AUTHORITY["EPSG","4326"]]
	Origin = (-105.220222,40.261786)
	Pixel Size = (0.00020000,-0.00020000)
	Corner Coordinates:
	Upper Left  (-105.2202222,  40.2617861) (105d13'12.80"W,
40d15'42.43"N)
	Lower Left  (-105.2202222,  39.5361861) (105d13'12.80"W,
39d32'10.27"N)
	Upper Right (-105.0124222,  40.2617861) (105d 0'44.72"W,
40d15'42.43"N)
	Lower Right (-105.0124222,  39.5361861) (105d 0'44.72"W,
39d32'10.27"N)
	Center      (-105.1163222,  39.8989861) (105d 6'58.76"W,
39d53'56.35"N)
	Band 1 Block=1039x7 Type=Byte, ColorInterp=Red
	Band 2 Block=1039x7 Type=Byte, ColorInterp=Green
	Band 3 Block=1039x7 Type=Byte, ColorInterp=Blue

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/b97ededb/attachment.html
From mhanson at photon.com  Thu Oct 14 11:35:34 2004
From: mhanson at photon.com (Matthew Hanson)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] VC++ Wrapper
Message-ID: <004401c4b203$72eae820$643210ac@photon.com>

Hi, 

I'm working on a managed wrapper for GDAL to create a .NET assembly. 

I just wanted to clarify a few things.  The C++ API (in gdal_priv.h) looks
like it's a C++ wrapper to the underlying C code.  Is this true?  If so, I
think I'd rather interface with the C API then end up having a wrapper
around a wrapper.   Are there any benefits to using the C++ API?  

Also, there looks like there's some parts of GDAL (like the warp API) that
are only in C++.  In this case I'd have to use the C++ API.  Are there any
other parts of GDAL that only have a C++ API?

Thanks in advance!

matt


From tdobmeye at ball.com  Thu Oct 14 12:07:15 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalinfo
Message-ID: <C482FF98AE985A47B8C982FD429C9E3408880C@daytonmsg2k3.AERO.BALL.COM>

That is the problem. I do not know if the tif files start at the very
top of the globe, or if they are at say 80 or 85 degrees North. If I
could figure this out, how would I use gdal_translate and gdal_warp to
make a .tfw file? Thanks.

 

Todd

 

-----Original Message-----
From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
Sent: Thursday, October 14, 2004 11:12 AM
To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] gdalinfo

 

Do you know the projection and coordinates? If so you can use
gdal_translate and gdal_warp to generate one but you have to know the
corner points of your image.

 

-e

	-----Original Message-----
	From: Dobmeyer, Todd [mailto:tdobmeye@ball.com] 
	Sent: Thursday, October 14, 2004 6:58 AM
	To: Ethan Alpert; gdal-dev@xserve.flids.com
	Subject: RE: [Gdal-dev] gdalinfo

	Did you create your own tfw file or find one? I do not seem to
have any
	tfw files with my tif files. This is why I cannot find the
information I
	want? Thanks again!
	 
	Todd

	 

	 

	-----Original Message-----
	From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
	Sent: Wednesday, October 13, 2004 12:42 PM
	To: Dobmeyer, Todd; gdal-dev@xserve.flids.com
	Subject: RE: [Gdal-dev] gdalinfo

	 

	Does the image come with a tfw? Your output suggests there's no
projection associated with your tif.

	 

	Here's what my gdalinfo looks like on GeoTiff's I create:

	 

	Driver: GTiff/GeoTIFF
	Size is 1039, 3628
	Coordinate System is:
	GEOGCS["WGS 84",
	    DATUM["WGS_1984",
	        SPHEROID["WGS 84",6378137,298.2572235629972,
	            AUTHORITY["EPSG","7030"]],
	        AUTHORITY["EPSG","6326"]],
	    PRIMEM["Greenwich",0],
	    UNIT["degree (supplier to define
representation)",0.01745329251994328],
	    AUTHORITY["EPSG","4326"]]
	Origin = (-105.220222,40.261786)
	Pixel Size = (0.00020000,-0.00020000)
	Corner Coordinates:
	Upper Left  (-105.2202222,  40.2617861) (105d13'12.80"W,
40d15'42.43"N)
	Lower Left  (-105.2202222,  39.5361861) (105d13'12.80"W,
39d32'10.27"N)
	Upper Right (-105.0124222,  40.2617861) (105d 0'44.72"W,
40d15'42.43"N)
	Lower Right (-105.0124222,  39.5361861) (105d 0'44.72"W,
39d32'10.27"N)
	Center      (-105.1163222,  39.8989861) (105d 6'58.76"W,
39d53'56.35"N)
	Band 1 Block=1039x7 Type=Byte, ColorInterp=Red
	Band 2 Block=1039x7 Type=Byte, ColorInterp=Green
	Band 3 Block=1039x7 Type=Byte, ColorInterp=Blue

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/f0a54114/attachment.html
From warmerdam at pobox.com  Thu Oct 14 12:53:23 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] VC++ Wrapper
In-Reply-To: <004401c4b203$72eae820$643210ac@photon.com>
References: <004401c4b203$72eae820$643210ac@photon.com>
Message-ID: <416EAF03.60003@pobox.com>

Matthew Hanson wrote:
> Hi, 
> 
> I'm working on a managed wrapper for GDAL to create a .NET assembly. 
> 
> I just wanted to clarify a few things.  The C++ API (in gdal_priv.h) looks
> like it's a C++ wrapper to the underlying C code.  Is this true?  If so, I
> think I'd rather interface with the C API then end up having a wrapper
> around a wrapper.   Are there any benefits to using the C++ API?  

Matt,

The C++ API is actually the "real" implementation.  The C API is just
thin wrappers around it.  Nevertheless, I encourage you to target the C API
because it is much less "fragile" than the C++ API.  It becomes almost
impossible to substitute new versions of GDAL DLLs into an application that
calls the C++ API directly because of minor changes in method signatures
(like const correctness changes) or any change in the internal layout of
C++ objects (add new data members for instance).

So my experience has been that wrappers and applications written against
the C API are less tightly linked to a specific version of GDAL than C++
API callers.

> Also, there looks like there's some parts of GDAL (like the warp API) that
> are only in C++.  In this case I'd have to use the C++ API.  Are there any
> other parts of GDAL that only have a C++ API?

Alternatively, you can point out these issues to me, and I can look into
preparing C wrappers.  My intent with the warp api would be that a C API should
exist for applications that want to instantiate and invoke a GDALWarpOperation
from an input GDALWarpOptions.  The GDALWarpOptions is deliberately kept as a
simple C structure so it can be created and manipulated smoothly in C.
However, it has alot of callback functions which might be tricky to implement
in a .NET binding.  I have not tried to implement the full warp API in Python
for instance.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From nhv at cape.com  Thu Oct 14 13:28:30 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalinfo
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E3408880C@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <EKEJIKAILPONGGENMBGAMEKHJBAA.nhv@cape.com>

Dobmeyer, Todd writes:

> That is the problem. I do not know if the tif files start at the very top of the globe, 
> or if they are at say 80 or 85 degrees North. If I could figure this out, how would I 
> use gdal_translate and gdal_warp to make a .tfw file? Thanks.

see attached readme for 'official' info about the NASA BlueMarble Files

Hopefully the info below should be sufficient for you to georeference these

HTH

Norman

=============

eastern_hemisphere

Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
         0                0                0
         0.0      90.0       0
      ModelPixelScaleTag (1,3):
         0.00833333334   0.00833333334   0
      End_Of_Tags.
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeGeographic
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GeographicTypeGeoKey (Short,1): GCS_WGS_84
      GeogLinearUnitsGeoKey (Short,1): Linear_Meter
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
      End_Of_Keys.
   End_Of_Geotiff.

western_hemisphere:

Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
         0                0                0
         -180.0      90.0       0
      ModelPixelScaleTag (1,3):
         0.00833333334   0.00833333334   0
      End_Of_Tags.
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeGeographic
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GeographicTypeGeoKey (Short,1): GCS_WGS_84
      GeogLinearUnitsGeoKey (Short,1): Linear_Meter
      GeogAngularUnitsGeoKey (Short,1): Angular_Degree
      End_Of_Keys.
   End_Of_Geotiff.

-------------- next part --------------
Dear User,

This site features a series of consistently processed datasets (land, sea
ice and clouds) from TERRA MODIS and related datasets (topography, land
cover, city lights), all at the 1km resolution. They all originate from processing of
this sensor's data through the years 2000-2001 and originate in the final version
from January 2002. You can find the blue
marble and related files at this site for public download:

ftp://gloria2-f.gsfc.nasa.gov/pub/stockli/


It follows a short description of the datasets
----------------------------------------------

All datasets are in the regular lat-lon grid with a grid spacing of
0.008333 degrees per pixel. This projection results in heavy distortion
over the poles, but is suitable for most imaging purposes and needs
least explication to the user. Once mapped onto a globe or reprojected
to a more suitable global map the distortions are no longer visible. The
files are all split into the western and eastern hemisphere with a pixel
dimension 21600x21600 each. This way people using Photoshop can read and
look at the files. Most are in the byte grayscale other in the
interleaved RGB 24bit space, but also some in the signed 16bit integer
data format (I am not sure if photoshop can handle signed integer...?). 

A lot more re-touching could be applied to the blue marble land+ocean
dataset, but considering the time constraints we have for the Olympics
display, I think that this is the best we can provide and I look forward
to hear your comments on the images and on the visualizations that are
going to be made with it. I will render some hi-res globes myself with
the new datasets when I find some time.


Blue Marble terrestrial data
---------------------------- 
Dataset: MOD09A1, MOD12Q1
Format: raw 8bit-per-channel RGB interleaved, 21600x21600
Compositing period: Day 145-241/2001 with 2-3 weeks gaps

flat unshaded:
MOD09A1.E.interpol.cyl.retouched.3x21600x21600.gz
MOD09A1.W.interpol.cyl.retouched.3x21600x21600.gz

topography hill-shaded (3x scaled) - light from 45degNW
MOD09A1.E.interpol.cyl.retouched.topo.3x21600x21600.gz
MOD09A1.W.interpol.cyl.retouched.topo.3x21600x21600.gz

topography + bathymetry hill-shaded (3x on land and 6x seafloor)
MOD09A1.E.interpol.cyl.retouched.topo.bathymetry.3x21600x21600.gz
MOD09A1.W.interpol.cyl.retouched.topo.bathymetry.3x21600x21600.gz

The Blue Marble Antarctica data origins from the NOAA AVHRR sensor and was
compiled at 1km by: Jane G. Ferrigno and Pat S. Chavez Jr., USGS
http://TerraWeb.wr.usgs.gov/TRS/projects/Antarctica/AVHRR.html

Problem areas: west Africa, central China, Indonesia, West coast of
Ecuador


Blue Marble Sea Ice data
------------------------
Dataset: Dataset: MOD29P1D
Format: Byte sea ice mask, 21600x21600
Compositing Period: Spring 100-108/2001 Autumn 240-248/2001

MOD29P1D.E.autumn.21600x21600.gz
MOD29P1D.W.autumn.21600x21600.gz

MOD29P1D.E.spring.21600x21600.gz
MOD29P1D.W.spring.21600x21600.gz

Problem areas: Some cloud mask artifacts. At all, polar sea ice is not
really looking nice on a rectangular cylindrical projection!


Blue Marble Cloud layer
-----------------------
Dataset: MOD021KM, MOD03, MOD35_L2, MOD06_L2
Format: 8bit cloud reflectance, 21600x21600
Compositing period: Day 210/2001 (day 320/2001 stitched at the south)

cloud.E.2001210.21600x21600.06.zip
cloud.W.2001210.21600x21600.06.zip

Problem areas: No data over the poles.


World City Lights
-----------------
Format: 8bit light reflectance mask (intensity scaled exponentially)

world_lights_cities.E.21600x21600.gz
world_lights_cities.W.21600x21600.gz

Attention: The world lights dataset should be directly downloaded at the source:
http://dmsp.ngdc.noaa.gov/html/projects/lights.html


Land Cover map (also land/ocean mask)
-------------------------------------
Format 8bit map (values 0-13, 0 is water >0 is land)
Classification see DeFries. et al. (1998) and 
Hansen et al. (2001)

landcover.E.21600x21600.gz
landcover.W.21600x21600.gz

Attention: The land cover dataset should be directly downloaded at the source: http://www.geog.umd.edu/landcover/1km-map.html


Topography maps
---------------
Format: 2-byte unsigned integer. Topgraphy has been shifted by 32768 so that all values
remain positive. Dimensions: 21600x21600
Units: meters

Land and Ocean:
topo.bathymetry.E.21600x21600.gz
topo.bathymetry.W.21600x21600.gz

Land only:
topo.E.21600x21600.gz
topo.W.21600x21600.gz

Ocean only:
bathymetry.E.21600x21600.gz
bathymetry.W.21600x21600.gz

Attention: The topography dataset should be directly downloaded at the source:
http://edcdaac.usgs.gov/gtopo30/gtopo30.html


When using these datasets please give credits to:
-------------------------------------------------
Author: 
Reto Stckli, NASA/Goddard Space Flight Center, stockli@cyberlink.ch

Address of correspondance:
Reto Stckli                    Phone:  +41 (0)1 271 8463
NASA GSFC/ SSAI                 Email:  stockli@cyberlink.ch
Landenbergstr. 16a              Web:    http://visibleearth.nasa.gov
8037 Zrich Switzerland                 http://earthobservatory.nasa.gov

Supervisors: 
Fritz Hasler and David Herring, NASA/Goddard Space Flight Center

Funding:
This project was realized under the SSAI subcontract 2101-01-027 (NAS5-01070)


Original data sources
---------------------
1. Land,ocean,sea ice and clouds: MODIS Atmosphere, Land and Ocean Discipline Groups
   http://modarch.gsfc.nasa.gov/

2. Antarctica: Pat S. Chavez, Jr., USGS, 2255 N. Gemini Dr., Flagstaff, AZ 86001
   http://TerraWeb.wr.usgs.gov/TRS/projects/Antarctica/AVHRR.html

3. Topography (Land and ocean): USGS EROS data center
   http://edcdaac.usgs.gov/gtopo30/gtopo30.html

4. Land Cover: UMD 1km Land Cover, Hansen et al. (2000)
   http://www.geog.umd.edu/landcover/1km-map.html

5. City lights: World Stable Lights Images - October 1994 to March 1995
   Derived from DMSP OLS Nighttime Imagery, produced at NOAA/NGDC.
   http://dmsp.ngdc.noaa.gov/html/projects/lights.html
From tdobmeye at ball.com  Thu Oct 14 13:43:16 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
Message-ID: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>

I am trying to take my red, blue, and green geotiff files and turn them
into one tif file. I assume I need to use pct2rgb.py to do this. I went
and downloaded python 2.3.4 and loaded up pct2rgb.py. When I tell it to
RUN, in the shell, it complains that in the file gdal.py it cannot find
the module named _gdal. Am I not running this correctly in python, or
why is this not running correctly? Thanks for your help!

 

Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/2fd713c2/attachment.html
From warmerdam at pobox.com  Thu Oct 14 13:51:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416EBC95.4090905@pobox.com>

Dobmeyer, Todd wrote:
> I am trying to take my red, blue, and green geotiff files and turn them 
> into one tif file. I assume I need to use pct2rgb.py to do this. I went 
> and downloaded python 2.3.4 and loaded up pct2rgb.py. When I tell it to 
> RUN, in the shell, it complains that in the file gdal.py it cannot find 
> the module named _gdal. Am I not running this correctly in python, or 
> why is this not running correctly? Thanks for your help!

Todd,

I'm not sure how you built your GDAL.  Was it built with python support
enabled?  You also didn't mention what platform you are on.  If you are
on windows or Linux you could just use one of the recent OpenEV_FW builds
which include python and with all paths and environment variables setup
properly.

All that said, if you have red, green and blue bands in seperate files
and you want to merge them into a single multi-band file you don't want
pct2rgb.py anyways.  pct2rgb.py is for making a 24bit RGB image from an
8 bit image with a color table (pct == pseudo-color table in my lingo).

What you want to do can be accomplished with gdal_merge.py like this:

   gdal_merge.py -o rgb.tif red.tif green.tif blue.tif -seperate

The "-seperate" flag indicates that each file should be placed
in a different band.  Of course, this is a python script too, so you will
need to resolve your python issues.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tdobmeye at ball.com  Thu Oct 14 13:59:00 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
Message-ID: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>

I honestly do not remember how I built gdal, if I did it with python
support or not. I might rebuild this to make sure that I do add python
support. I am on Windows XP Pro and am very new to gdal yet. To make
sure I get python support, I should go out and find one of the OpenEV_FW
builds? Or what exactly should I do? Thanks for your continued help and
I am glad I chose to work with gdal!

Todd Dobmeyer

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Thursday, October 14, 2004 1:51 PM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] pct2rgb.py

Dobmeyer, Todd wrote:
> I am trying to take my red, blue, and green geotiff files and turn
them 
> into one tif file. I assume I need to use pct2rgb.py to do this. I
went 
> and downloaded python 2.3.4 and loaded up pct2rgb.py. When I tell it
to 
> RUN, in the shell, it complains that in the file gdal.py it cannot
find 
> the module named _gdal. Am I not running this correctly in python, or 
> why is this not running correctly? Thanks for your help!

Todd,

I'm not sure how you built your GDAL.  Was it built with python support
enabled?  You also didn't mention what platform you are on.  If you are
on windows or Linux you could just use one of the recent OpenEV_FW
builds
which include python and with all paths and environment variables setup
properly.

All that said, if you have red, green and blue bands in seperate files
and you want to merge them into a single multi-band file you don't want
pct2rgb.py anyways.  pct2rgb.py is for making a 24bit RGB image from an
8 bit image with a color table (pct == pseudo-color table in my lingo).

What you want to do can be accomplished with gdal_merge.py like this:

   gdal_merge.py -o rgb.tif red.tif green.tif blue.tif -seperate

The "-seperate" flag indicates that each file should be placed
in a different band.  Of course, this is a python script too, so you
will
need to resolve your python issues.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 14 14:05:22 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <416EBC95.4090905@pobox.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>
	<416EBC95.4090905@pobox.com>
Message-ID: <Pine.SUN.4.58.0410141055240.6536@eskimo.com>


OGR questions:  Since OGR is part of GDAL, this list ok for these
questions too?

Code snippet.  Using the C API:


  if (transformH == NULL) fprintf(stderr,"T2=0\n");

  // Loop through all of the features in the layer.
  //
  while ( (featureH = OGR_L_GetNextFeature( layerH )) != NULL) {
    OGRGeometryH geometryH;
    int num = 0;

  // Just before this we lose the handle to our transform
  if (transformH == NULL) fprintf(stderr,"T3=0\n");



Results:
T3=0


By this point in the code I've already got a transform and a reverse
transform computed and ready for use.

1) Why does OGR_L_GetNextFeature() waste my transform?

2) How do I preserve transformH and reverse_transformH in this case?

3) These transforms are computed at the start of each layer loop.
Overkill?  Can I get away with just once per dataset, or might there
be different spatial references on each layer in some datasets?

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From ealpert at digitalglobe.com  Thu Oct 14 14:02:15 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16017B1845@COMAIL01.digitalglobe.com>

You'll also need pynumeric installed to run the pct2rgb.py and
rgb2pct.py functions. This required a fortran compiler too.

-e

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Dobmeyer, Todd
Sent: Thursday, October 14, 2004 11:59 AM
To: Frank Warmerdam
Cc: gdal-dev@xserve.flids.com
Subject: RE: [Gdal-dev] pct2rgb.py


I honestly do not remember how I built gdal, if I did it with python
support or not. I might rebuild this to make sure that I do add python
support. I am on Windows XP Pro and am very new to gdal yet. To make
sure I get python support, I should go out and find one of the OpenEV_FW
builds? Or what exactly should I do? Thanks for your continued help and
I am glad I chose to work with gdal!

Todd Dobmeyer

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Thursday, October 14, 2004 1:51 PM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] pct2rgb.py

Dobmeyer, Todd wrote:
> I am trying to take my red, blue, and green geotiff files and turn
them 
> into one tif file. I assume I need to use pct2rgb.py to do this. I
went 
> and downloaded python 2.3.4 and loaded up pct2rgb.py. When I tell it
to 
> RUN, in the shell, it complains that in the file gdal.py it cannot
find 
> the module named _gdal. Am I not running this correctly in python, or
> why is this not running correctly? Thanks for your help!

Todd,

I'm not sure how you built your GDAL.  Was it built with python support
enabled?  You also didn't mention what platform you are on.  If you are
on windows or Linux you could just use one of the recent OpenEV_FW
builds which include python and with all paths and environment variables
setup properly.

All that said, if you have red, green and blue bands in seperate files
and you want to merge them into a single multi-band file you don't want
pct2rgb.py anyways.  pct2rgb.py is for making a 24bit RGB image from an
8 bit image with a color table (pct == pseudo-color table in my lingo).

What you want to do can be accomplished with gdal_merge.py like this:

   gdal_merge.py -o rgb.tif red.tif green.tif blue.tif -seperate

The "-seperate" flag indicates that each file should be placed in a
different band.  Of course, this is a python script too, so you will
need to resolve your python issues.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Thu Oct 14 14:21:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <Pine.SUN.4.58.0410141055240.6536@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>	<416EBC95.4090905@pobox.com>
	<Pine.SUN.4.58.0410141055240.6536@eskimo.com>
Message-ID: <416EC3B6.8050007@pobox.com>

Curt, WE7U wrote:
> OGR questions:  Since OGR is part of GDAL, this list ok for these
> questions too?

Curt,

OGR questions are also welcome here.  Someday I may need to split things
up into a few lists, but for now I think traffic is still managable.

> Code snippet.  Using the C API:
> 
> 
>   if (transformH == NULL) fprintf(stderr,"T2=0\n");
> 
>   // Loop through all of the features in the layer.
>   //
>   while ( (featureH = OGR_L_GetNextFeature( layerH )) != NULL) {
>     OGRGeometryH geometryH;
>     int num = 0;
> 
>   // Just before this we lose the handle to our transform
>   if (transformH == NULL) fprintf(stderr,"T3=0\n");
> 
> Results:
> T3=0
> 
> 
> By this point in the code I've already got a transform and a reverse
> transform computed and ready for use.
> 
> 1) Why does OGR_L_GetNextFeature() waste my transform?

I have no idea.  From what I can see, and guessing at the rest I would
say that transformH becoming NULL on it's own suggests stack corruption
has occured.

> 2) How do I preserve transformH and reverse_transformH in this case?

If you can provide a modest standalone mini-application that demonstrates
the code, I could look into it more closely.

> 3) These transforms are computed at the start of each layer loop.
> Overkill?  Can I get away with just once per dataset, or might there
> be different spatial references on each layer in some datasets?

In some datasources different layers can indeed have different coordinate
systems.  In some datasources it will not occur.  Creating the transformation
object isn't really all that expensive so doing it once per layer should be
fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Oct 14 14:25:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416EC480.6080302@pobox.com>

Dobmeyer, Todd wrote:
> I honestly do not remember how I built gdal, if I did it with python
> support or not. I might rebuild this to make sure that I do add python
> support. I am on Windows XP Pro and am very new to gdal yet. To make
> sure I get python support, I should go out and find one of the OpenEV_FW
> builds? Or what exactly should I do? Thanks for your continued help and
> I am glad I chose to work with gdal!

Todd,

If you don't need to build everything yourself, I would suggest just
using the OpenEV_FW release for this task.

   http://gdal.org/dl/openev/OpenEV_FW_182.zip

It includes everything built nicely together, including the Python numeric
package which would be needed for gdal_merge.py to work (as noted by another
user).  On Windows when building GDAL you need to explitely set the PYDIR
in nmake.opt to get python support working.  I think there are some additional
complications related to the numeric support.  This is within your ability to
handle, but unless you need to build things yourself for some reason I would
suggest you avoid it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From mhanson at photon.com  Thu Oct 14 14:29:23 2004
From: mhanson at photon.com (Matthew Hanson)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] VC++ Wrapper
In-Reply-To: <416EAF03.60003@pobox.com>
Message-ID: <005f01c4b21b$bb3c7860$643210ac@photon.com>

Ok, I was looking through the OSSIM code and it looks like it also uses the
C API instead of the C++ API.  
So basically, you recommend developers to use the C API over C++.  In what
situations would you recommend an application to use the native C++ API
directly?

Also, I'm trying to figure out how the code is put together and I see
CPL_DLL in the function declarations for GDAL, and is OSSIM.  I'm not really
sure what this does (though I do understand CPL is used to make GDAL
portable to different platforms).
Could you briefly comment on how CPL is used in GDAL and the CPL_DLL syntax
in function and class declarations?

Thanks!

matt



> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Thursday, October 14, 2004 12:53 PM
> To: Matthew Hanson
> Cc: gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] VC++ Wrapper
> 
> Matthew Hanson wrote:
> > Hi,
> >
> > I'm working on a managed wrapper for GDAL to create a .NET assembly.
> >
> > I just wanted to clarify a few things.  The C++ API (in gdal_priv.h)
> looks
> > like it's a C++ wrapper to the underlying C code.  Is this true?  If so,
> I
> > think I'd rather interface with the C API then end up having a wrapper
> > around a wrapper.   Are there any benefits to using the C++ API?
> 
> Matt,
> 
> The C++ API is actually the "real" implementation.  The C API is just
> thin wrappers around it.  Nevertheless, I encourage you to target the C
> API
> because it is much less "fragile" than the C++ API.  It becomes almost
> impossible to substitute new versions of GDAL DLLs into an application
> that
> calls the C++ API directly because of minor changes in method signatures
> (like const correctness changes) or any change in the internal layout of
> C++ objects (add new data members for instance).
> 
> So my experience has been that wrappers and applications written against
> the C API are less tightly linked to a specific version of GDAL than C++
> API callers.
> 
> > Also, there looks like there's some parts of GDAL (like the warp API)
> that
> > are only in C++.  In this case I'd have to use the C++ API.  Are there
> any
> > other parts of GDAL that only have a C++ API?
> 
> Alternatively, you can point out these issues to me, and I can look into
> preparing C wrappers.  My intent with the warp api would be that a C API
> should
> exist for applications that want to instantiate and invoke a
> GDALWarpOperation
> from an input GDALWarpOptions.  The GDALWarpOptions is deliberately kept
> as a
> simple C structure so it can be created and manipulated smoothly in C.
> However, it has alot of callback functions which might be tricky to
> implement
> in a .NET binding.  I have not tried to implement the full warp API in
> Python
> for instance.
> 
> Best regards,
> --
> ---------------------------------------+----------------------------------
> ----
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent


From gillian.walter at atlantis-scientific.com  Thu Oct 14 14:26:43 2004
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
Message-ID: <416EC4E3.F417EF19@atlantis-scientific.com>

Hi Frank,

Does openev 1.82 include the latest compose.py tool?  If it does, I think the
compose and export tools could also be used to do the merge (load the three
images up in openev, launch the compose tool, set the three output bands, display
the result, then run the export tool- it should be able to export the vrt lines
created by the compose tool).  This is more steps than gdal_merge, but avoids the
command line for those who prefer gui's.

Gillian

Frank Warmerdam wrote:

> Dobmeyer, Todd wrote:
> > I honestly do not remember how I built gdal, if I did it with python
> > support or not. I might rebuild this to make sure that I do add python
> > support. I am on Windows XP Pro and am very new to gdal yet. To make
> > sure I get python support, I should go out and find one of the OpenEV_FW
> > builds? Or what exactly should I do? Thanks for your continued help and
> > I am glad I chose to work with gdal!
>
> Todd,
>
> If you don't need to build everything yourself, I would suggest just
> using the OpenEV_FW release for this task.
>
>    http://gdal.org/dl/openev/OpenEV_FW_182.zip
>
> It includes everything built nicely together, including the Python numeric
> package which would be needed for gdal_merge.py to work (as noted by another
> user).  On Windows when building GDAL you need to explitely set the PYDIR
> in nmake.opt to get python support working.  I think there are some additional
> complications related to the numeric support.  This is within your ability to
> handle, but unless you need to build things yourself for some reason I would
> suggest you avoid it.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Thu Oct 14 15:17:36 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] VC++ Wrapper
In-Reply-To: <005f01c4b21b$bb3c7860$643210ac@photon.com>
References: <005f01c4b21b$bb3c7860$643210ac@photon.com>
Message-ID: <416ED0D0.2090900@pobox.com>

Matthew Hanson wrote:
> Ok, I was looking through the OSSIM code and it looks like it also uses the
> C API instead of the C++ API.  
> So basically, you recommend developers to use the C API over C++.  In what
> situations would you recommend an application to use the native C++ API
> directly?

Matthew,

I would use the C++ API if implementing utilities being distributed as
part of GDAL.  I would also (potentially) use it if implementing an application
that I knew would also have GDAL built custom as part of it's build process.
Finally, the C++ API must be used if you want to extend GDAL with new drivers.

But if you are distributing something where you would potentially like people
to be able to substitute in a new GDAL DLL built with different options or bug
fixes, then targeting the C API saves alot of grief.

> Also, I'm trying to figure out how the code is put together and I see
> CPL_DLL in the function declarations for GDAL, and is OSSIM.  I'm not really
> sure what this does (though I do understand CPL is used to make GDAL
> portable to different platforms).
> Could you briefly comment on how CPL is used in GDAL and the CPL_DLL syntax
> in function and class declarations?

The gdal/port directory contains a bunch of stuff Daniel and I call the
Common Portability Library.  It is basically low level porting stuff, and
various convenience services (such as path parsing, string handling, etc).
It also includes the error handling code.  You will likely find you want
to wrap a bit of it, possibly including the CPL error handling, CPL
"ConfigOption" functions, and CPL "FileFinder" functions.

The CPL_DLL macro is used to mark all functions that we want exported from the
DLL under windows.  On unix it does nothing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 14 15:17:53 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <416EC3B6.8050007@pobox.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880E@daytonmsg2k3.AERO.BALL.COM>
	<416EBC95.4090905@pobox.com>
	<Pine.SUN.4.58.0410141055240.6536@eskimo.com>
	<416EC3B6.8050007@pobox.com>
Message-ID: <Pine.SUN.4.58.0410141216420.6536@eskimo.com>

On Thu, 14 Oct 2004, Frank Warmerdam wrote:

> > 1) Why does OGR_L_GetNextFeature() waste my transform?
>
> I have no idea.  From what I can see, and guessing at the rest I would
> say that transformH becoming NULL on it's own suggests stack corruption
> has occured.

Pointers got me again!  Have it solved.  Thanks for your response,
your answers will help immensely as I flush out the rest of the
code.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Thu Oct 14 15:19:37 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <416EC4E3.F417EF19@atlantis-scientific.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
Message-ID: <416ED149.5000001@pobox.com>

Gillian Walter wrote:
> Hi Frank,
> 
> Does openev 1.82 include the latest compose.py tool?  If it does, I think the
> compose and export tools could also be used to do the merge (load the three
> images up in openev, launch the compose tool, set the three output bands, display
> the result, then run the export tool- it should be able to export the vrt lines
> created by the compose tool).  This is more steps than gdal_merge, but avoids the
> command line for those who prefer gui's.

Gillian,

I think it would include all compose updates.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 14 15:41:13 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR transforms
In-Reply-To: <416ED149.5000001@pobox.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
	<416ED149.5000001@pobox.com>
Message-ID: <Pine.SUN.4.58.0410141229390.6536@eskimo.com>


Next set of questions (making progress getting some nice map
displays!).

ESRI Shapefiles are looking good via OGR, and in fact SDTS contours
are displaying too, but I'm getting this currently on USGS
SDTS-format DLG contours:


Opening datasource
/usr/local/share/xastir/maps/World/USA/WA/SDTS/24k/darrington/hypsography/HP01CATD.DDF
Features Processed: 1
ERROR 1: geocentric transformation missing z or ellps
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 1
ERROR 1: geocentric transformation missing z or ellps
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 1
ERROR 1: geocentric transformation missing z or ellps
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 4
ERROR 1: failed to load NAD27-83 correction file
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 49
ERROR 1: failed to load NAD27-83 correction file
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 433
ERROR 1: failed to load NAD27-83 correction file
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 782
ERROR 1: failed to load NAD27-83 correction file
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 1082
ERROR 1: failed to load NAD27-83 correction file
Couldn't convert points from WGS84 to map's spatial reference
Features Processed: 434


Am using CVS GDAL/OGR from some months back.  Was there something I
forgot to load?  I'm assuming that the "geocentric transformation
missing" messages are due to those layers not having any sort of
spatial reference.  I'll look into that further (as in: Don't try to
convert my view edges to the map coordinate system if there isn't
one for that layer!).

The ones that worry me more are the "NAD27-83 correction file"
messages.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Thu Oct 14 15:52:24 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR transforms
In-Reply-To: <Pine.SUN.4.58.0410141229390.6536@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>	<416EC480.6080302@pobox.com>	<416EC4E3.F417EF19@atlantis-scientific.com>	<416ED149.5000001@pobox.com>
	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>
Message-ID: <416ED8F8.30309@pobox.com>

Curt, WE7U wrote:
> Opening datasource
> /usr/local/share/xastir/maps/World/USA/WA/SDTS/24k/darrington/hypsography/HP01CATD.DDF
> Features Processed: 1
> ERROR 1: geocentric transformation missing z or ellps
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 1
> ERROR 1: geocentric transformation missing z or ellps
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 1
> ERROR 1: geocentric transformation missing z or ellps
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 4
> ERROR 1: failed to load NAD27-83 correction file
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 49
> ERROR 1: failed to load NAD27-83 correction file
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 433
> ERROR 1: failed to load NAD27-83 correction file
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 782
> ERROR 1: failed to load NAD27-83 correction file
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 1082
> ERROR 1: failed to load NAD27-83 correction file
> Couldn't convert points from WGS84 to map's spatial reference
> Features Processed: 434
> 
> Am using CVS GDAL/OGR from some months back.  Was there something I
> forgot to load?  I'm assuming that the "geocentric transformation
> missing" messages are due to those layers not having any sort of
> spatial reference.  I'll look into that further (as in: Don't try to
> convert my view edges to the map coordinate system if there isn't
> one for that layer!).
> 
> The ones that worry me more are the "NAD27-83 correction file"
> messages.

Curt,

I'm not sure exactly what is happening. All the errors are coming from
PROJ.4.  The geocentric one could be result of an improperly specified
ellipsoid.  What are your source and destination coordinate systems
(in WKT)?  The NAD27-83 correction issue presumably means you are trying
to convert from WGS84 (essentially the same as NAD83 for my purposes) to
NAD27.  If you want to do this you need to install the grid shift files
as part of the PROJ.4 installation process.  This can be accomplished
by overlaying the grid shift files on the PROJ distribution (they go
in the proj/nad directory) before configuring PROJ.4.

   ftp://ftp.remotesensing.org/pub/proj/proj-nad27-1.1.tar.gz

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 14 16:09:02 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR transforms
In-Reply-To: <416ED8F8.30309@pobox.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
	<416ED149.5000001@pobox.com>
	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>
	<416ED8F8.30309@pobox.com>
Message-ID: <Pine.SUN.4.58.0410141252400.6536@eskimo.com>

On Thu, 14 Oct 2004, Frank Warmerdam wrote:

> I'm not sure exactly what is happening. All the errors are coming from
> PROJ.4.  The geocentric one could be result of an improperly specified
> ellipsoid.  What are your source and destination coordinate systems
> (in WKT)?  The NAD27-83 correction issue presumably means you are trying
> to convert from WGS84 (essentially the same as NAD83 for my purposes) to
> NAD27.  If you want to do this you need to install the grid shift files
> as part of the PROJ.4 installation process.  This can be accomplished
> by overlaying the grid shift files on the PROJ distribution (they go
> in the proj/nad directory) before configuring PROJ.4.
>
>    ftp://ftp.remotesensing.org/pub/proj/proj-nad27-1.1.tar.gz

Ok.  Our code already uses libgeotiff/libshp/libproj and I'm used to
installing that set of files into proj for that, but didn't install
them into the CVS GDAL that I'm trying to use now.  I'd assumed
they'd be in CVS as well.  Thanks.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From bclay at ball.com  Thu Oct 14 16:55:21 2004
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalinfo question
Message-ID: <C482FF98AE985A47B8C982FD429C9E340586A4@daytonmsg2k3.AERO.BALL.COM>

Dumb question time.

 

Given the gdalinfo dump shown below, how does one find the latitude and
longitude values this patch covers.

The "Corner Coordinate" numbers do not look like UTM values from my
untrained eye.  Are they?

 

Thanks in advance

 

Bruce

 

C:\Terrain\Landsat\p020\R032>gdalinfo p020r032_7t20010821_z16_nn1.tif

Driver: GTiff/GeoTIFF

Size is 8624, 7637

Coordinate System is:

PROJCS["unnamed",

    GEOGCS["WGS 84",

        DATUM["WGS_1984",

            SPHEROID["WGS 84",6378137,298.2572235630016,

                AUTHORITY["EPSG","7030"]],

            AUTHORITY["EPSG","6326"]],

        PRIMEM["Greenwich",0],

        UNIT["degree",0.0174532925199433],

        AUTHORITY["EPSG","4326"]],

    PROJECTION["Transverse_Mercator"],

    PARAMETER["latitude_of_origin",0],

    PARAMETER["central_meridian",-87],

    PARAMETER["scale_factor",0.9996],

    PARAMETER["false_easting",500000],

    PARAMETER["false_northing",0],

    UNIT["metre",1,

        AUTHORITY["EPSG","9001"]],

    AUTHORITY["EPSG","32616"]]

Origin = (616341.000000,4577385.000000)

Pixel Size = (28.50000000,-28.50000000)

Metadata:

  TIFFTAG_XRESOLUTION=72

  TIFFTAG_YRESOLUTION=72

  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)

Corner Coordinates:

Upper Left  (  616341.000, 4577385.000)

Lower Left  (  616341.000, 4359730.500)

Upper Right (  862125.000, 4577385.000)

Lower Right (  862125.000, 4359730.500)

Center      (  739233.000, 4468557.750)

Band 1 Block=8624x1 Type=Byte, ColorInterp=Gray

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/4643f40e/attachment.html
From archer at eskimo.com  Thu Oct 14 16:58:16 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR transforms
In-Reply-To: <Pine.SUN.4.58.0410141252400.6536@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
	<416ED149.5000001@pobox.com>
	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>
	<416ED8F8.30309@pobox.com>
	<Pine.SUN.4.58.0410141252400.6536@eskimo.com>
Message-ID: <Pine.SUN.4.58.0410141347210.6536@eskimo.com>

On Thu, 14 Oct 2004, Curt, WE7U wrote:

> Ok.  Our code already uses libgeotiff/libshp/libproj and I'm used to
> installing that set of files into proj for that, but didn't install
> them into the CVS GDAL that I'm trying to use now.  I'd assumed
> they'd be in CVS as well.  Thanks.

Looks like GDAL doesn't include proj.  My memory was just fuzzy on
which libs are in there.

Recompiled proj.4.  Files were already in there.  Recompiled CVS
GDAL.  Recompiled Xastir.  Same errors.

Is there a tutorial/example code somewhere on the minimum necessary
steps in order to create a boundary rectangle for use in spatial
filtering?  It's likely that the steps I took were not sufficient.
The filtering appears to work with the Shapefiles I've tried, but
not with SDTS files.

It appears to be this particular OCTTransform() that is causing the
warnings spelled out earlier.  I'll try the latest release of GDAL
to see if the warnings go away.


  if (reverse_transformH) {
    // Convert our view coordinates from WGS84 to this map
    // layer's coordinates.
//  if (!OCTTransform(reverse_transformH, 2, ViewX, ViewY, ViewZ)) {
    if (!OCTTransform(reverse_transformH, 2, ViewX, ViewY, NULL)) {
      fprintf(stderr,
        "Couldn't convert points from WGS84 to map's spatial reference\n");
    }
    OCTDestroyCoordinateTransformation(reverse_transformH);
    reverse_transformH = NULL;
  }

  // Add these converted points to the spatial_filter_geometry so
  // that we can set our spatial filter in the layer loop below.
  // Snag the spatial reference from the map dataset 'cuz they
  // should match now.
  //
  spatial_filter_geometryH = OGR_G_CreateGeometry(2); // LineString Type

  // Use the map spatial geometry so that we match the map
  OGR_G_AssignSpatialReference(spatial_filter_geometryH, map_spatialH);

  // Add the converted corners of the viewport
  OGR_G_AddPoint(spatial_filter_geometryH, ViewX[0], ViewY[0], ViewZ[0]);
  OGR_G_AddPoint(spatial_filter_geometryH, ViewX[0], ViewY[1], ViewZ[1]);
  OGR_G_AddPoint(spatial_filter_geometryH, ViewX[1], ViewY[1], ViewZ[0]);
  OGR_G_AddPoint(spatial_filter_geometryH, ViewX[1], ViewY[0], ViewZ[1]);

// Establishing this filter causes problems with SDTS contours at
// present (they disappear).
//  OGR_L_SetSpatialFilter( layerH, spatial_filter_geometryH);



--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Thu Oct 14 17:09:56 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalinfo question
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340586A4@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340586A4@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <416EEB24.4090808@pobox.com>

Clay, Bruce wrote:
> Dumb question time.
> 
>  
> 
> Given the gdalinfo dump shown below, how does one find the latitude and 
> longitude values this patch covers.
> 
> The ?Corner Coordinate? numbers do not look like UTM values from my 
> untrained eye.  Are they?
>
Bruce,

The corner coordinates look like perfectly normal to me.

> Corner Coordinates:
> 
> Upper Left  (  616341.000, 4577385.000)
> 
> Lower Left  (  616341.000, 4359730.500)
> 
> Upper Right (  862125.000, 4577385.000)
> 
> Lower Right (  862125.000, 4359730.500)
> 
> Center      (  739233.000, 4468557.750)
> 
> Band 1 Block=8624x1 Type=Byte, ColorInterp=Gray

If you have PROJ.4 properly installed, gdalinfo should use it to reproject
the corners to lat/long for.  The results would look something like this
(from a file of my own):

Corner Coordinates:
Upper Left  (  440720.000, 3751320.000) (117d38'28.21"W, 33d54'8.47"N)
Lower Left  (  440720.000, 3720600.000) (117d38'20.79"W, 33d37'31.04"N)
Upper Right (  471440.000, 3751320.000) (117d18'32.07"W, 33d54'13.08"N)
Lower Right (  471440.000, 3720600.000) (117d18'28.50"W, 33d37'35.61"N)
Center      (  456080.000, 3735960.000) (117d28'27.39"W, 33d45'52.46"N)

If you have PROJ.4, but it isn't being picked by GDAL for some reason, you
can fallback on doing the conversion by hand:

eg.
   warmerda@gdal2200[393]% proj -I +proj=utm +zone=16 +datum=WGS84
   616341 4577385                                    <-- input
   85d36'34.262"W  41d20'22.412"N                    <-- output

If you don't have PROJ ... well, you will need something to do the
reprojection.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dylan at iici.no-ip.org  Thu Oct 14 17:15:01 2004
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] conversion from different AEA projections
Message-ID: <200410141415.01113.dylan@iici.no-ip.org>

Greetings!

I would first like to thank all those that have helped to make GDAL a reality 
- it is an extremely powerfull set of tools that make GIS with opensource 
software a possibility. 

I am having unexpected results when converting a raster dataset between two 
versions of the AEA projection. The resulting image is offset about 35km to 
the north of where it should be.

Here are the details:

1. the command i have been using to project the raster image is;
gdalwarp \
-t_srs '+proj=aea +x_0=0.0 +y_0=0 +lon_0=-96 +lat_0=40.0 +lat_1=20 +lat_2=60.0 
+datum=NAD83'  \
-s_srs '+proj=aea +x_0=0.0 +y_0=-4000000 +lon_0=-120.0 +lat_0=0.0 +lat_1=34.0 
+lat_2=45.5 +datum=NAD83'  \
-multi original.tiff test.tiff

This is essentially (attempting to) convert between 2 different AEA 
projections.

2. the output looks somthing like this:
http://169.237.35.250/~dylan/temp/offset.png

It is quite obvious in the image that the original.tiff (the landsat image 
behind the vector polygons) is offset mostly to the north...

3. here is what gdalinfo says about the input image:

The original image, original.tiff, has the following projection parameters:
 `gdalinfo original.tiff `:
---------------------------
GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010042,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Albers_Conic_Equal_Area"],
    PARAMETER["standard_parallel_1",34],
    PARAMETER["standard_parallel_2",40.5],
    PARAMETER["latitude_of_center",0],
    PARAMETER["longitude_of_center",-120],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",-4000000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
---------------------------

It might be useful to note that this data is coming from gis.ca.gov, formerly 
known as the TEAL data center. The source projection is what they call the 
"California Albers" projection. 

Also, I can get the raster image *close* to where it should be by using a 
-s_srs '+y_0=-3973800' instead of -s_srs '+y_0=-4000000' .. but there is 
still some residual distortion near the top of the image

Any ideas would be greatly appreciated!

Dylan Beaudette
Soil Science Graduate Group
University of California at Davis

From archer at eskimo.com  Thu Oct 14 17:20:42 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR transforms
In-Reply-To: <Pine.SUN.4.58.0410141347210.6536@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
	<416ED149.5000001@pobox.com>
	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>
	<416ED8F8.30309@pobox.com>
	<Pine.SUN.4.58.0410141252400.6536@eskimo.com>
	<Pine.SUN.4.58.0410141347210.6536@eskimo.com>
Message-ID: <Pine.SUN.4.58.0410141418060.6536@eskimo.com>

On Thu, 14 Oct 2004, Curt, WE7U wrote:

> It appears to be this particular OCTTransform() that is causing the
> warnings spelled out earlier.  I'll try the latest release of GDAL
> to see if the warnings go away.
>
>
>   if (reverse_transformH) {
>     // Convert our view coordinates from WGS84 to this map
>     // layer's coordinates.
> //  if (!OCTTransform(reverse_transformH, 2, ViewX, ViewY, ViewZ)) {
>     if (!OCTTransform(reverse_transformH, 2, ViewX, ViewY, NULL)) {
>       fprintf(stderr,
>         "Couldn't convert points from WGS84 to map's spatial reference\n");
>     }
>     OCTDestroyCoordinateTransformation(reverse_transformH);
>     reverse_transformH = NULL;
>   }

Yep, that was the problem all right!  I needed to copy the original
WGS84 lat/long values into the ViewX/Y/Z arrays before doing the
transform each time.  Originally I had that code outside the layer
loop and so didn't have to worry about converting the same values
twice/three/XXX times.

So...   It's a never-mind sort of an issue.  ;-)

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From starged at videotron.ca  Thu Oct 14 19:47:08 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Merging bands (was: pct2rgb.py)
In-Reply-To: <416EC4E3.F417EF19@atlantis-scientific.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
Message-ID: <en2um0p446ukee19qkqc38giajf1d1mdie@4ax.com>

Hi,

On Thu, 14 Oct 2004 14:26:43 -0400, Gillian Walter <gillian.walter@atlantis-scientific.com> wrote:

>Does openev 1.82 include the latest compose.py tool?  If it does, I think the
>compose and export tools could also be used to do the merge (load the three
>images up in openev, launch the compose tool, set the three output bands, display
>the result, then run the export tool- it should be able to export the vrt lines
>created by the compose tool).  This is more steps than gdal_merge, but avoids the
>command line for those who prefer gui's.

May I suggest a method I added to gvviewwindow.py to merge bands without using the compose tool?

It goes like this:

def open_rgb_gdal_dataset(self, datasets):
    import vrtutils
    
    self.make_active()

    vrt_opts = vrtutils.VRTCreationOptions(3)
    vrt_tree = vrtutils.serializeCombinedDatasets(datasets,vrt_opts)
    ds = gdal.OpenShared(gdal.SerializeXMLTree(vrt_tree))
    rgbDS = gview.manager.add_dataset(ds)
    rgbDS.SetDescription('VRTDataset')

    red_raster = gview.manager.get_dataset_raster(rgbDS,1)
    green_raster = gview.manager.get_dataset_raster(rgbDS,2)
    blue_raster = gview.manager.get_dataset_raster(rgbDS,3)

    rgb_layer = gview.GvRasterLayer(red_raster, rl_mode = gview.RLM_RGBA)
    rgb_layer.set_source(1,green_raster)
    rgb_layer.set_source(2,blue_raster)
    rgb_layer.set_name('RGB layer')

    self.viewarea.add_layer(rgb_layer)
    self.viewarea.set_active_layer(rgb_layer)
    self.rawgeo_update()

The resulting VRTDataset can then be exported normally. Note that 2 other methods are needed to open
3 files at once. A dialog for selecting the bands would have been nice but I didn't feel it was
necessary at that time :)

def rgb_open_cb(self, *args):
    self.make_active()
    dlg = filedlg.FileDialog(dialog_type=filedlg.FILE_OPEN, multiselect = 1 )
    dlg.ok_button.connect('clicked', self.rgb_files_open_by_name, dlg)
    dlg.show()

def rgb_files_open_by_name(self, widget, dlg, *args):
    filenames = dlg.get_filenames()
    if len(filenames) != 3:
        gvutils.error('3 files needed for band merging')
        return
    datasets = []
    for file in filenames:
       datasets.append(gview.manager.get_dataset(file))
    
    self.open_rgb_gdal_dataset(datasets)


Does this procedure look good to you guys? Would it be better to use the new
vrtutils.VRTDatasetConstructor class (great class!) to do this?

Thanks for your attention.
--
Mario B.

From chodgson at refractions.net  Thu Oct 14 20:01:16 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Add srs info to existing JP2 file
Message-ID: <416F134C.1030309@refractions.net>

I have a JPEG-2000 file that was created using gdal/kakadu - it has it's 
bounding box, but not it's srs. How can I add the srs info to the file, 
without changing the image data at all - will gdal_translate do this for 
me? I'm worried it will resample/re-compress and lose quality (I'm using 
JP2 lossy compression).

Thanks,
Chris

From warmerdam at pobox.com  Thu Oct 14 22:05:51 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Add srs info to existing JP2 file
In-Reply-To: <416F134C.1030309@refractions.net>
References: <416F134C.1030309@refractions.net>
Message-ID: <416F307F.8030605@pobox.com>

Chris Hodgson wrote:
> I have a JPEG-2000 file that was created using gdal/kakadu - it has it's 
> bounding box, but not it's srs. How can I add the srs info to the file, 
> without changing the image data at all - will gdal_translate do this for 
> me? I'm worried it will resample/re-compress and lose quality (I'm using 
> JP2 lossy compression).

Chris,

GDAL does not contain the ability to rewrite a JPEG2000 file with a coordinate
system definition without having to decompress and recompress the image.
It would be best to go back to your original image, and re-convert to JPEG2000
applying the SRS in that process if possible.

Note you can use the -a_srs switch to gdal_translate to apply an SRS to the
output file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From EZS at Syncera-ITSolutions.NL  Fri Oct 15 04:20:09 2004
From: EZS at Syncera-ITSolutions.NL (Emil Zegers)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdalsplit windows binary available? Raster splitting
	program
Message-ID: <s16fa468.013@syncera.nl>

Hello,

On september 15 Homme Zwaagstra posted the source code for a gdalsplit utility program.

Does anybody have a Windows binary available? (since I cannnot compile it myself).

Best regards,

Emil Zegers



From bluecarto at free.fr  Fri Oct 15 08:21:05 2004
From: bluecarto at free.fr (GIRAUD Pierre)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
Message-ID: <416FC0B1.5070207@free.fr>

  Hello,

I'm having to use an Oracle Spatial data base containing many feature
within Mapserver. And I'm in front of performance issues while spatial
indexes don't seem to work.
Trying to identify the problem at its source, I wrote those following
queries :

----->in sqlplus :
SQL> SELECT count(*) FROM ref_batiment a WHERE sdo_filter(a.geometry,
mdsys.sdo_geometry(2003,NULL,NULL, mdsys.sdo_elem_info_array(1,1003,3),
mdsys.sdo_ordinate_array(58750573,13847995,58751000,13900000)),
'querytype=window') = 'TRUE';

  COUNT(*)
----------
         8

----> with ogrinfo :
aneto:~$ ogrinfo OCI:scott/tiger@aneto/orcl -sql "select a.geometry from
ref_batiment a" -spat 58750573 13847995 58751000 13900000
INFO: Open of `OCI:pierre/xbe9a51h@aneto.oco/orcl'
using driver `OCI' successful.

Layer name: select a.geometry, a.genre from ref_batiment a
Geometry: Unknown (any)
Feature Count: 97587

....

The time to get the info is obviously not the same.
What is the way I missed to get it working ?

Thx

Regards.

Pierre GIRAUD
camptocamp.com


From warmerdam at pobox.com  Fri Oct 15 08:27:49 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
In-Reply-To: <416FC0B1.5070207@free.fr>
References: <416FC0B1.5070207@free.fr>
Message-ID: <416FC245.1040602@pobox.com>

GIRAUD Pierre wrote:
> ----> with ogrinfo :
> aneto:~$ ogrinfo OCI:scott/tiger@aneto/orcl -sql "select a.geometry from
> ref_batiment a" -spat 58750573 13847995 58751000 13900000
> INFO: Open of `OCI:pierre/xbe9a51h@aneto.oco/orcl'
> using driver `OCI' successful.
> 
> Layer name: select a.geometry, a.genre from ref_batiment a
> Geometry: Unknown (any)
> Feature Count: 97587
> 
> ....
> 
> The time to get the info is obviously not the same.
> What is the way I missed to get it working ?

Pierre,

I have reviewed the OCI driver code, and it seems that the spatial query
information is currently ignored in the case of an SQL query against oracle.
For now you will either have to include the spatial query within your SQL
statement or do spatial queries directly against the table like this:

   ogrinfo OCI:scott/tiger@aneto/orcl ref_batiment -spat 58750573 13847995 58751000 13900000

I would encourage you to submit a Buzgilla bug report on this issue if you would
like it resolved.  I don't have access to a working Oracle instance at this time
so it may be a while before I can resolve the issue.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From bluecarto at free.fr  Fri Oct 15 10:21:01 2004
From: bluecarto at free.fr (bluecarto@free.fr)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
In-Reply-To: <416FC245.1040602@pobox.com>
References: <416FC0B1.5070207@free.fr> <416FC245.1040602@pobox.com>
Message-ID: <1097850061.416fdccd63f39@imp1-q.free.fr>

That works, although this limits in some way.
Is there any way to use the views in oracle with OGR ?

Regards

Pierre

Selon Frank Warmerdam <warmerdam@pobox.com>:

> GIRAUD Pierre wrote:
> > ----> with ogrinfo :
> > aneto:~$ ogrinfo OCI:scott/tiger@aneto/orcl -sql "select a.geometry from
> > ref_batiment a" -spat 58750573 13847995 58751000 13900000
> > INFO: Open of `OCI:pierre/xbe9a51h@aneto.oco/orcl'
> > using driver `OCI' successful.
> >
> > Layer name: select a.geometry, a.genre from ref_batiment a
> > Geometry: Unknown (any)
> > Feature Count: 97587
> >
> > ....
> >
> > The time to get the info is obviously not the same.
> > What is the way I missed to get it working ?
>
> Pierre,
>
> I have reviewed the OCI driver code, and it seems that the spatial query
> information is currently ignored in the case of an SQL query against oracle.
> For now you will either have to include the spatial query within your SQL
> statement or do spatial queries directly against the table like this:
>
>    ogrinfo OCI:scott/tiger@aneto/orcl ref_batiment -spat 58750573 13847995
> 58751000 13900000
>
> I would encourage you to submit a Buzgilla bug report on this issue if you
> would
> like it resolved.  I don't have access to a working Oracle instance at this
> time
> so it may be a while before I can resolve the issue.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>



From warmerdam at pobox.com  Fri Oct 15 10:50:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
In-Reply-To: <1097850061.416fdccd63f39@imp1-q.free.fr>
References: <416FC0B1.5070207@free.fr> <416FC245.1040602@pobox.com>
	<1097850061.416fdccd63f39@imp1-q.free.fr>
Message-ID: <416FE3B6.9030106@pobox.com>

bluecarto@free.fr wrote:
> That works, although this limits in some way.
> Is there any way to use the views in oracle with OGR ?

Pierre,

Currently the OCI driver does the following query to get the list of
tables to be treated as layers:

   SELECT TABLE_NAME, COLUMN_NAME, SRID, OWNER FROM ALL_SDO_GEOM_METADATA

If views appear in ALL_SDO_GEOM_METADATA then they should be usable as
layers.  If not, they wont.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From mhanson at photon.com  Fri Oct 15 11:06:52 2004
From: mhanson at photon.com (Matthew Hanson)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] DriverManager
Message-ID: <00a501c4b2c8$a0b33940$643210ac@photon.com>

Hi,

When is the global DriverManager object created?  I thought it would be
created in the GDALAllRegister function.  What I wanted to do is make the
AllRegister function happen in the background in my wrapper.  

- If the AllRegister function has not been called will GetGDALDriverManager
return a 0?
- The declaration for GetGDALDriverManager does not occur in gdal.h (but
DestroyDriverManager does), but instead is in gdal_priv.h.  Shouldn't it be
in the C API header?
- There's one global instance of DriverManager which (sorta) holds/manages
one instance of GDALDriver for each format type. Does calling
DestroyDriverManager end up destroying all these instances and deregistering
all the drivers?
- I'm trying to figure out the C wrapper works, there's the gdal.h with the
declarations, but how is it linked to the native C++ object functions?


Matt
http://www.omnium-gatherum.org
http://www.photon.com



From warmerdam at pobox.com  Fri Oct 15 11:11:44 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] DriverManager
In-Reply-To: <00a501c4b2c8$a0b33940$643210ac@photon.com>
References: <00a501c4b2c8$a0b33940$643210ac@photon.com>
Message-ID: <416FE8B0.8020305@pobox.com>

Matthew Hanson wrote:
> Hi,
> 
> When is the global DriverManager object created?  

Matt,

It is created by the first call to GetGDALDriverManager().  This usually
happens in the all register function.

 > I thought it would be
> created in the GDALAllRegister function.  What I wanted to do is make the
> AllRegister function happen in the background in my wrapper.  
> 
> - If the AllRegister function has not been called will GetGDALDriverManager
> return a 0?

No, it never returns NULL.

> - The declaration for GetGDALDriverManager does not occur in gdal.h (but
> DestroyDriverManager does), but instead is in gdal_priv.h.  Shouldn't it be
> in the C API header?

The driver manager class is a singleton, and so it's existance as a descrete
object is masked by the C API.  There is little point in exposing it.

> - There's one global instance of DriverManager which (sorta) holds/manages
> one instance of GDALDriver for each format type. Does calling
> DestroyDriverManager end up destroying all these instances and deregistering
> all the drivers?

Yes.

> - I'm trying to figure out the C wrapper works, there's the gdal.h with the
> declarations, but how is it linked to the native C++ object functions?

Linked?

The gdal.h declares all the C API functions.  The implementation of the
C functions is normally found in the source files right next to the
corresponding C++ method implementation.  The produced GDAL DLL exports
the C and C++ interface.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From mhanson at photon.com  Fri Oct 15 11:20:53 2004
From: mhanson at photon.com (Matthew Hanson)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] DriverManager
In-Reply-To: <416FE8B0.8020305@pobox.com>
Message-ID: <00a801c4b2ca$9b58ea10$643210ac@photon.com>

Thanks Frank,

I see the C implementation now, missed it before, duh.

So, is there a way to tell if GDALAllRegister has already been called?

matt


> -----Original Message-----
> From: Frank Warmerdam [mailto:warmerdam@pobox.com]
> Sent: Friday, October 15, 2004 11:12 AM
> To: Matthew Hanson
> Cc: Gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] DriverManager
> 
> Matthew Hanson wrote:
> > Hi,
> >
> > When is the global DriverManager object created?
> 
> Matt,
> 
> It is created by the first call to GetGDALDriverManager().  This usually
> happens in the all register function.
> 
>  > I thought it would be
> > created in the GDALAllRegister function.  What I wanted to do is make
> the
> > AllRegister function happen in the background in my wrapper.
> >
> > - If the AllRegister function has not been called will
> GetGDALDriverManager
> > return a 0?
> 
> No, it never returns NULL.
> 
> > - The declaration for GetGDALDriverManager does not occur in gdal.h (but
> > DestroyDriverManager does), but instead is in gdal_priv.h.  Shouldn't it
> be
> > in the C API header?
> 
> The driver manager class is a singleton, and so it's existance as a
> descrete
> object is masked by the C API.  There is little point in exposing it.
> 
> > - There's one global instance of DriverManager which (sorta)
> holds/manages
> > one instance of GDALDriver for each format type. Does calling
> > DestroyDriverManager end up destroying all these instances and
> deregistering
> > all the drivers?
> 
> Yes.
> 
> > - I'm trying to figure out the C wrapper works, there's the gdal.h with
> the
> > declarations, but how is it linked to the native C++ object functions?
> 
> Linked?
> 
> The gdal.h declares all the C API functions.  The implementation of the
> C functions is normally found in the source files right next to the
> corresponding C++ method implementation.  The produced GDAL DLL exports
> the C and C++ interface.
> 
> Best regards,
> --
> ---------------------------------------+----------------------------------
> ----
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Oct 15 11:22:48 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] DriverManager
In-Reply-To: <00a801c4b2ca$9b58ea10$643210ac@photon.com>
References: <00a801c4b2ca$9b58ea10$643210ac@photon.com>
Message-ID: <416FEB48.80500@pobox.com>

Matthew Hanson wrote:
> Thanks Frank,
> 
> I see the C implementation now, missed it before, duh.
> 
> So, is there a way to tell if GDALAllRegister has already been called?

Matt,

No, not really.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From bluecarto at free.fr  Fri Oct 15 12:35:10 2004
From: bluecarto at free.fr (bluecarto@free.fr)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
In-Reply-To: <416FE3B6.9030106@pobox.com>
References: <416FC0B1.5070207@free.fr> <416FC245.1040602@pobox.com>
	<1097850061.416fdccd63f39@imp1-q.free.fr>
	<416FE3B6.9030106@pobox.com>
Message-ID: <1097858110.416ffc3eb8614@imp6-q.free.fr>


> bluecarto@free.fr wrote:
> > That works, although this limits in some way.
> > Is there any way to use the views in oracle with OGR ?
>
> Pierre,
>
> Currently the OCI driver does the following query to get the list of
> tables to be treated as layers:
>
>    SELECT TABLE_NAME, COLUMN_NAME, SRID, OWNER FROM ALL_SDO_GEOM_METADATA
>
> If views appear in ALL_SDO_GEOM_METADATA then they should be usable as
> layers.  If not, they wont.
>
> Best regards,

This way I can produce working views. Hopelessly, the spatial index of the
parent table is useless, and I can't create any one on the view :

create index Q_VIEW_PARCELLE on view_parcelle(geometry)
                                *

ERROR at line 1:
ORA-01702: a view is not appropriate here

Any idea ?

Regards.

From warmerdam at pobox.com  Fri Oct 15 12:46:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR spatial indexes in Oracle
In-Reply-To: <1097858110.416ffc3eb8614@imp6-q.free.fr>
References: <416FC0B1.5070207@free.fr> <416FC245.1040602@pobox.com>
	<1097850061.416fdccd63f39@imp1-q.free.fr>
	<416FE3B6.9030106@pobox.com>
	<1097858110.416ffc3eb8614@imp6-q.free.fr>
Message-ID: <416FFEF2.3070501@pobox.com>

bluecarto@free.fr wrote:
> create index Q_VIEW_PARCELLE on view_parcelle(geometry)
>                                 *
> 
> ERROR at line 1:
> ORA-01702: a view is not appropriate here

Sorry ... nothing clever.
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From starged at videotron.ca  Fri Oct 15 14:38:33 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] About the VRTWarpedRasterBand subclass
Message-ID: <ku50n0p0e1b35ud3rno2i0me0j20j0o5vk@4ax.com>

Hi all,

I was wondering why this happens:

$ gdalwarp -of VRT -rc -tr 10 10 test.tif test.vrt
ERROR 1: Attempt to serialize unrecognised transformer.

What is missing from that command?

I'm using OpenEV_FW 1.82.

Thanks for your attention.
--
Mario B.

From warmerdam at pobox.com  Fri Oct 15 14:52:22 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] About the VRTWarpedRasterBand subclass
In-Reply-To: <ku50n0p0e1b35ud3rno2i0me0j20j0o5vk@4ax.com>
References: <ku50n0p0e1b35ud3rno2i0me0j20j0o5vk@4ax.com>
Message-ID: <41701C66.80705@pobox.com>

Mario Beauchamp wrote:
> Hi all,
> 
> I was wondering why this happens:
> 
> $ gdalwarp -of VRT -rc -tr 10 10 test.tif test.vrt
> ERROR 1: Attempt to serialize unrecognised transformer.
> 
> What is missing from that command?
> 
> I'm using OpenEV_FW 1.82.

Mario,

I'm not sure.  This is on Linux right?  There are some special
issues with the VRT serialization on windows.

Anything odd about your input file?  Could you provide a gdalinfo on it?

I would suggest you file this in Bugzilla with enough information for me
to reproduce it rather than hash it out here on the list.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From starged at videotron.ca  Fri Oct 15 16:23:33 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] About the VRTWarpedRasterBand subclass
In-Reply-To: <41701C66.80705@pobox.com>
References: <ku50n0p0e1b35ud3rno2i0me0j20j0o5vk@4ax.com>
	<41701C66.80705@pobox.com>
Message-ID: <fsa0n09sc72a54uuc92ljn75nof6nrnrh0@4ax.com>

Hi Frank,

On Fri, 15 Oct 2004 14:52:22 -0400, Frank Warmerdam <warmerdam@pobox.com> wrote:

>> $ gdalwarp -of VRT -rc -tr 10 10 test.tif test.vrt
>> ERROR 1: Attempt to serialize unrecognised transformer.

>I'm not sure.  This is on Linux right?  There are some special
>issues with the VRT serialization on windows.

I was not aware of those issues. This is actually in Msys, a mingw bash for win32. Anyway, same
result in a DOS window.

So you are saying that the command line is correct? Then what should be the line <Transformer/> in
the vrt file? Because if I try to open the file in OpenEV, I get the error message:
"GDALWarpOptions.Validate() pfnTransformer is NULL".

>Anything odd about your input file?  Could you provide a gdalinfo on it?

Nothing special about it or any other I tested.

>I would suggest you file this in Bugzilla with enough information for me
>to reproduce it rather than hash it out here on the list.

I am not sure it's a bug now... I guess the question should be: is the VRTWarpedRasterBand fully
operational? If so, then my problem is the VRT serialization on windows issue.

Thanks.
--
Mario B.

From warmerdam at pobox.com  Fri Oct 15 16:37:25 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] About the VRTWarpedRasterBand subclass
In-Reply-To: <fsa0n09sc72a54uuc92ljn75nof6nrnrh0@4ax.com>
References: <ku50n0p0e1b35ud3rno2i0me0j20j0o5vk@4ax.com>
	<41701C66.80705@pobox.com>
	<fsa0n09sc72a54uuc92ljn75nof6nrnrh0@4ax.com>
Message-ID: <41703505.7090201@pobox.com>

Mario Beauchamp wrote:
> I was not aware of those issues. This is actually in Msys, a mingw bash for win32. Anyway, same
> result in a DOS window.

Mario,

The problem is that internally I actually compare the transformer function
pointer to determine how to serialize the transformer.  But the pointer to
a function will vary depending on whether you are "in the DLL" where it is
defined, or outside the DLL.  That relates to the way that DLLs function call
indirection is handled.  Apparently you actually link in a stub function into
your calling .exe (or .dll) and then this stub function looks up the real
function and calls it.  This makes my whole approach to serializing transformer
fall apart unless you happen to statically link one big giant executable (or
form your GDALWarpOptions within the GDAL DLL itself I suppose).

As far as I know this would affect MSYS built software just the same as it
would affect Visual C++ built apps.

> I am not sure it's a bug now... I guess the question should be: is the VRTWarpedRasterBand fully
> operational? If so, then my problem is the VRT serialization on windows issue.

Please file the bug in bugzilla, and add my explanation up above into the report
as well so I will remember the details when I get to fixing it.  In the
meantime, I *think* the VRT warper serialization stuff is essentially
broken on Windows.  I will likely need a fundamental rewrite of how transformers
are encapsulated to make this work properly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From CaronR at AGR.GC.CA  Wed Oct 13 11:39:03 2004
From: CaronR at AGR.GC.CA (Caron, Roberto)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Information about GML to WKT/WKB to GML
Message-ID: <A71388C2B6C9784B9511CD3832EFA7C2981B24@onncrxms2.agr.gc.ca>

Hi guys,

 

      I'm working for Agriculture Canada on a GIS Project. I am involved
to develop a component that will be an interface to some systems who
will request information in GML format to ArcSDE and another product
using Open Source Geometry JTS/JUMP. I've been told these products only
accept WKT/WKB format. To make a long story short, here are all possible
scenarios and my component should take care all of them:

 

      - Receive GMLs from client, convert to WKT or WKB, call ArcSDE to
produce an Intersection let's say and return back the result in GML to
client;

 

      - Receive GMLs from client, convert to WKT or WKB, call JTS/JUMP
to produce an Intersection let's say and return back the result in GML
to client;

 

      - Receive WKT or WKB from client, call JTS/JUMP to produce an
Intersection let's say and return back the result in GML to client;

 

      - Receive WKT or WKB from client, call ArcSDE to produce an
Intersection let's say and return back the result in GML to client;

 

      - Receive WKT or WKB from client, call JTS/JUMP to produce an
Intersection let's say and return back the result in WKT or WKB to
client;

 

      - Receive WKT or WKB from client, call ArcSDE to produce an
Intersection let's say and return back the result in WKT or WKB to
client;

 

 

      In hoping this will explain a little more what I wish to do. 

 

      Thank you in advance

      Best Regards

      Roberto Caron

      Fujitsu Consulting

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041013/e8a85911/attachment.html
From MChapman at sanz.com  Thu Oct 14 13:42:23 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFDD7@mailman.san.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: proj_problem_aea_to_merc.jpg
Type: image/jpeg
Size: 87360 bytes
Desc: proj_problem_aea_to_merc.jpg
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/6d4579de/proj_problem_aea_to_merc.jpg
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CNTRY92_AEC.prj
Type: application/octet-stream
Size: 466 bytes
Desc: CNTRY92_AEC.prj
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/6d4579de/CNTRY92_AEC.obj
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Mercator (world).prj
Type: application/octet-stream
Size: 333 bytes
Desc: Mercator (world).prj
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041014/6d4579de/Mercatorworld.obj
From MChapman at sanz.com  Sat Oct 16 15:52:23 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <ED3A48B9840E594890A2BC172D119465E63BC3@mailman.san.com>

Ok, I figured it out.  I had numerous things wrong in my code outside
this function.  I still have one problem though.  The Transform method
of the OGRCoordinateTransformation class doesn't like it when I pass in
coordinates that are outside the valid limit for certain projections
(i.e. Mercator).  My new question is, how do I calculate what the valid
limits are for a projection like mercator?  Is it a matter of
subtracting False Easting and Northing or something like that?  Any help
on understanding how to calculate these limits for a projection would be
much appreciated.
 
Thanks,
Martin

	-----Original Message-----
	From: Chapman, Martin 
	Sent: Thursday, October 14, 2004 11:42 AM
	To: gdal-dev@remotesensing.org
	Subject: [Gdal-dev] Coordinate transform problem
	
	
	I recently switched my projection support from Proj4 to OGR and
I'm having some issues when using the OGRCoordinateTransformation
object.  Basically, it looks like not all of my points are being
transformed correctly when converting from one projection to the other.
(ie. AEA to MERC).  I check for errors when converting but no errors are
being thrown.  Basically my code looks like this:
	 
	OGRCoordinateTransformation* pCT = NULL;
	  pCT = OGRCreateCoordinateTransformation(&sourceSRS,
&targetSRS);
	  if ((CPLGetLastErrorNo() != OGRERR_NONE) || (!pCT)) throw
(char*) CPLGetLastErrorMsg();
	 
	  if (pGeometry->GetGeometryTypeId() == VPWkbPolygon)
	  {
	   CVPPtr< IVPPolygon> spPolygon = (IVPPolygon*) pGeometry;
	   spPolygon->GetExteriorRing()->GetCoords(&pXCoords,
&pYCoords);
	 
	   vector< double>* pNewXCoords = new vector<
double>(*pXCoords);
	   vector< double>* pNewYCoords = new vector<
double>(*pYCoords);
	   if (pCT->Transform((int) pNewXCoords->size(),
&(*pNewXCoords)[0], &(*pNewYCoords)[0]))
	
((CVPLinearRing*)(spPolygon.p->GetExteriorRing()))->SetCoords(pNewXCoord
s, pNewYCoords);
	 
	   for (int i = 0; i < spPolygon->GetNumInteriorRing(); i++)
	   {
	    spPolygon->GetInteriorRingN(i)->GetCoords(&pXCoords,
&pYCoords);
	    vector< double>* pNewXCoords = new vector<
double>(*pXCoords);
	    vector< double>* pNewYCoords = new vector<
double>(*pYCoords);
	    if (pCT->Transform((int) pNewXCoords->size(),
&(*pNewXCoords)[0], &(*pNewYCoords)[0]))
	
((CVPLinearRing*)(spPolygon.p->GetInteriorRingN(i)))->SetCoords(pNewXCoo
rds, pNewYCoords);
	   }
	  }
	 
	  if (pCT) delete pCT;
	 
	I understand that some projections have valid lat/lon ranges
that can be less than others (ie. Merc vs. latlong), should I not be
passing points that are greater than a certain range?  I was thinking
that the proj library would wrap any longitudes if they needed wrapping.
Is this a wrong assumption?  Can anyone see what I'm doing wrong.  I've
attached a screen shot to show what the half/baked transform looks like
when converting from AEA to MERC, and the .prj files I'm using for the
projection info...I load them using importFromESRI().  Also, I'm using
GDAL 1.19.  I know you're going to say upgrade...ok, I'll get on that.
	 
	Thanks for any help!
	 
	
	Martin Chapman
	Cell 303-885-1936
	Office 303-495-6300 x326
	mchapman@sanz.com
	http://www.sanz.com <http://www.sanz.com/> 
	 
	 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041016/7d4af8b5/attachment.html
From warmerdam at pobox.com  Sat Oct 16 17:29:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63BC3@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63BC3@mailman.san.com>
Message-ID: <417192BF.5080208@pobox.com>

Chapman, Martin wrote:
> Ok, I figured it out.  I had numerous things wrong in my code outside 
> this function.  I still have one problem though.  The Transform method 
> of the OGRCoordinateTransformation class doesn't like it when I pass in 
> coordinates that are outside the valid limit for certain projections 
> (i.e. Mercator).  My new question is, how do I calculate what the valid 
> limits are for a projection like mercator?  Is it a matter of 
> subtracting False Easting and Northing or something like that?  Any help 
> on understanding how to calculate these limits for a projection would be 
> much appreciated.

Martin,

I am not aware of any systematic way of determining bounds of validity
for projections.  Note that in many cases the projectinos equations
degrade gradually so there is no obvious bound.  It depends on your
error tolerance.  But even at that, there is no GDAL/OGR/PROJ support
for determining error or regions of appropriateness.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Sat Oct 16 17:47:54 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <ED3A48B9840E594890A2BC172D119465E63BC4@mailman.san.com>

Frank,

Ok, that makes sense, but I am a little at a loss at how to use the
transform method then.  Previously, I used the Inverse and Forward calls
for each point, which let me handle "bad points" on a case by case
basis, thus allowing me to convert as many coordinates as feasible...a
kind of test the limit as you go type algorithm.  I could resort back to
that, but in essence then I am rewriting the Transform method.  Would it
make sense for me to modify or extend the Transform function to do this.
In other words, maybe add another optional parameter to Transform that
tells the function to drop bad points, or something like that.  Is that
a flawed strategy?  The problem with the way Transform works now is that
I have to scrub my points up front, not, really knowing what points will
process correctly and what ones won't, which leads to several
inefficiencies.  What did you mean by "error tolerance"?

Thanks for your help,
Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Saturday, October 16, 2004 3:30 PM
To: Chapman, Martin
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Coordinate transform problem


Chapman, Martin wrote:
> Ok, I figured it out.  I had numerous things wrong in my code outside
> this function.  I still have one problem though.  The Transform method

> of the OGRCoordinateTransformation class doesn't like it when I pass
in 
> coordinates that are outside the valid limit for certain projections 
> (i.e. Mercator).  My new question is, how do I calculate what the
valid 
> limits are for a projection like mercator?  Is it a matter of 
> subtracting False Easting and Northing or something like that?  Any
help 
> on understanding how to calculate these limits for a projection would
be 
> much appreciated.

Martin,

I am not aware of any systematic way of determining bounds of validity
for projections.  Note that in many cases the projectinos equations
degrade gradually so there is no obvious bound.  It depends on your
error tolerance.  But even at that, there is no GDAL/OGR/PROJ support
for determining error or regions of appropriateness.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Sat Oct 16 21:58:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63BC4@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63BC4@mailman.san.com>
Message-ID: <4171D1AF.2030009@pobox.com>

Chapman, Martin wrote:
> Frank,
> 
> Ok, that makes sense, but I am a little at a loss at how to use the
> transform method then.  Previously, I used the Inverse and Forward calls
> for each point, which let me handle "bad points" on a case by case
> basis, thus allowing me to convert as many coordinates as feasible...a
> kind of test the limit as you go type algorithm.  I could resort back to
> that, but in essence then I am rewriting the Transform method.  Would it
> make sense for me to modify or extend the Transform function to do this.
> In other words, maybe add another optional parameter to Transform that
> tells the function to drop bad points, or something like that.  Is that
> a flawed strategy?  The problem with the way Transform works now is that
> I have to scrub my points up front, not, really knowing what points will
> process correctly and what ones won't, which leads to several
> inefficiencies.  What did you mean by "error tolerance"?

Martin,

I'm afraid I am not sure what forward and inverse calls you were previously
using or how that is different from what you do now.

You asked about an optional parameter to Transform that would tell the
function to drop bad points.  Are you aware of the TransformEx() method
on the OGRCoordinateTransformation?

     /**
      * Transform points from source to destination space.
      *
      * This method is the same as the C function OCTTransformEx().
      *
      * @param nCount number of points to transform.
      * @param x array of nCount X vertices, modified in place.
      * @param y array of nCount Y vertices, modified in place.
      * @param z array of nCount Z vertices, modified in place.
      * @param pabSuccess array of per-point flags set to TRUE if that point
      * transforms, or FALSE if it does not.
      *
      * @return TRUE if some or all points transform successfully, or FALSE if
      * if none transform.
      */
     virtual int TransformEx( int nCount,
                              double *x, double *y, double *z = NULL,
                              int *pabSuccess = NULL ) = 0;


The pabSuccess array is returned indicating which points successfully
transformed.  Now this only tests whether the underlying PROJ transformation
completely failed - not whether the transformation has become very lossy.
So it won't detect that a Mercator transformation is degrading as you move
far from the central meridian, but it can detect some complete failures
as might happen if you moved "over the horizon" or if there was no grid
shift available for a datum shift.

When I referred to error tolerance, I was thinking of actually transforming
and then inverse transforming the points and checking how much deviation
has occured.  The deviation could be compared to some error tolerance to
decide if a transformation is not longer working well enough to trust.

But some projections might still invert nearly losslessly but still not be
operating sensibly in a real world sense.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From tylermitchell at shaw.ca  Mon Oct 18 01:43:25 2004
From: tylermitchell at shaw.ca (Tyler Mitchell)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Python checks fail during configure
Message-ID: <200410172243.25750.tylermitchell@shaw.ca>

./configure is giving me some strange results around the python support.   
This is from CVS version a few minutes ago.
Log snippit below.

Tyler
...............
checking GDAL version... 1.2.3
checking for python... python
checking where python Makefiles are...   File "<string>", line 1
    import
         ^
SyntaxError: invalid syntax
  File "<string>", line 1
    import
         ^
SyntaxError: invalid syntax
  File "<string>", line 1
    import
         ^
SyntaxError: invalid syntax
found
checking Python makefile... missing, python disabled.

From archer at eskimo.com  Mon Oct 18 11:52:00 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  SDTS Elevation
In-Reply-To: <Pine.SUN.4.58.0410141418060.6536@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>
	<416EC480.6080302@pobox.com>
	<416EC4E3.F417EF19@atlantis-scientific.com>
	<416ED149.5000001@pobox.com>
	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>
	<416ED8F8.30309@pobox.com>
	<Pine.SUN.4.58.0410141252400.6536@eskimo.com>
	<Pine.SUN.4.58.0410141347210.6536@eskimo.com>
	<Pine.SUN.4.58.0410141418060.6536@eskimo.com>
Message-ID: <Pine.SUN.4.58.0410180827110.6541@eskimo.com>


USGS SDTS-format DLG vector contours have field names labeled
"ELEVATION".  Some maps have these in meters, others are in feet.
The difference appears to be whether they have an AHPT layer (feet)
or an AHPR layer (meters).

What is the proper (fast!) way to determine which I have?

Must I run through all the layer names once to determine this?

Should I use GetLayerByName() to see which layer is present first,
then use that to decide whether to draw "ft" or "m" after the
elevation label?

Will any of this slow me down due to accessing layers more than
once, or is this info cached in the driver so that I'm not really
taking a hit?

I'm not sure whether the driver is combining SDTS elements together
into OGR layers so that I get elevation and vectors together in the
layers that I'm drawing, or whether I'm drawing layers as they're
being read from file.  Depending on how that is done it might make a
difference in the techniques to use to determine how to draw things
quickly at the OGR API level.

I'm using the "C" interface.  Speed is very important to us:  This
is a tracking application and we can load a lot of maps at a time to
cover an area, plus if we're tracking a moving object we can be
reloading maps constantly.  The spatial filtering does appear to be
helping so far to keep things fast.

Below is what I'm seeing.  This is one that has elevation in feet,
so it has an AHPT layer.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"


Layer 0: 'AHPF'
  Field 0: RCID (Integer)
  Field 1: ENTITY_LABEL (String)
  Field 2: SUPPLEMENTARY (String)
  Field 3: AMENDED (String)
  Field 4: APPROXIMATE (String)
  Field 5: DEPRESSION (String)
  Field 6: GLACIER_OR_SNOW (String)
  Field 7: UNDERWATER (String)
  Field 8: BEST_ESTIMATE (String)
  Field 9: SPOT_CATEGORY (String)
  Field 10: PHOTOREVISED (String)
  Field 11: RISE (String)
  Field 12: FILL (String)

Layer 1: 'AHPT'
  Field 0: RCID (Integer)
  Field 1: ELEVATION (Real)

Layer 2: 'AHDR'
  Field 0: RCID (Integer)
  Field 1: BANNER (String)
  Field 2: SOURCE_DATE (String)
  Field 3: DATE_QUALIFIER (String)
  Field 4: QUAD_NUMBER (String)
  Field 5: L_PRIM_INTERVAL (Real)
  Field 6: L_PB_INTERVAL (Real)
  Field 7: S_PRIM_INTERVAL (Real)
  Field 8: S_PB_INTERVAL (Real)
  Field 9: CODED_FLAG (String)
  Field 10: EDGEWS (String)
  Field 11: EDGEWR (String)
  Field 12: EDGENS (String)
  Field 13: EDGENR (String)
  Field 14: EDGEES (String)
  Field 15: EDGEER (String)
  Field 16: EDGESS (String)
  Field 17: EDGESR (String)
  Field 18: VERTICAL_DATUM (String)
  Field 19: SW_LATITUDE (Real)
  Field 20: SW_LONGITUDE (Real)
  Field 21: NW_LATITUDE (Real)
  Field 22: NW_LONGITUDE (Real)
  Field 23: NE_LATITUDE (Real)
  Field 24: NE_LONGITUDE (Real)
  Field 25: SE_LATITUDE (Real)
  Field 26: SE_LONGITUDE (Real)

Layer 3: 'NP01'
  Field 0: RCID (Integer)

Layer 4: 'NE01'
  Field 0: RCID (Integer)
  Field 1: ENTITY_LABEL (String)
  Field 2: SUPPLEMENTARY (String)
  Field 3: AMENDED (String)
  Field 4: APPROXIMATE (String)
  Field 5: DEPRESSION (String)
  Field 6: GLACIER_OR_SNOW (String)
  Field 7: UNDERWATER (String)
  Field 8: BEST_ESTIMATE (String)
  Field 9: SPOT_CATEGORY (String)
  Field 10: PHOTOREVISED (String)
  Field 11: RISE (String)
  Field 12: FILL (String)
  Field 13: ELEVATION (Real)

Layer 5: 'NA01'
  Field 0: RCID (Integer)

Layer 6: 'NO01'
  Field 0: RCID (Integer)

Layer 7: 'LE01'
  Field 0: RCID (Integer)
  Field 1: SNID (Integer)
  Field 2: ENID (Integer)
  Field 3: ENTITY_LABEL (String)
  Field 4: SUPPLEMENTARY (String)
  Field 5: AMENDED (String)
  Field 6: APPROXIMATE (String)
  Field 7: DEPRESSION (String)
  Field 8: GLACIER_OR_SNOW (String)
  Field 9: UNDERWATER (String)
  Field 10: BEST_ESTIMATE (String)
  Field 11: SPOT_CATEGORY (String)
  Field 12: PHOTOREVISED (String)
  Field 13: RISE (String)
  Field 14: FILL (String)
  Field 15: ELEVATION (Real)

Layer 8: 'PC01'
  Field 0: RCID (Integer)


From route at cae.com  Mon Oct 18 14:37:10 2004
From: route at cae.com (route@cae.com)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20041018173208.18B133CB4FA@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041018/768013f7/attachment.wav
From warmerdam at pobox.com  Mon Oct 18 15:04:25 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  SDTS Elevation
In-Reply-To: <Pine.SUN.4.58.0410180827110.6541@eskimo.com>
References: <C482FF98AE985A47B8C982FD429C9E3408880F@daytonmsg2k3.AERO.BALL.COM>	<416EC480.6080302@pobox.com>	<416EC4E3.F417EF19@atlantis-scientific.com>	<416ED149.5000001@pobox.com>	<Pine.SUN.4.58.0410141229390.6536@eskimo.com>	<416ED8F8.30309@pobox.com>	<Pine.SUN.4.58.0410141252400.6536@eskimo.com>	<Pine.SUN.4.58.0410141347210.6536@eskimo.com>	<Pine.SUN.4.58.0410141418060.6536@eskimo.com>
	<Pine.SUN.4.58.0410180827110.6541@eskimo.com>
Message-ID: <417413B9.20903@pobox.com>

Curt, WE7U wrote:
> USGS SDTS-format DLG vector contours have field names labeled
> "ELEVATION".  Some maps have these in meters, others are in feet.
> The difference appears to be whether they have an AHPT layer (feet)
> or an AHPR layer (meters).
> 
> What is the proper (fast!) way to determine which I have?
> 
> Must I run through all the layer names once to determine this?
> 
> Should I use GetLayerByName() to see which layer is present first,
> then use that to decide whether to draw "ft" or "m" after the
> elevation label?
 >
 > Will any of this slow me down due to accessing layers more than
 > once, or is this info cached in the driver so that I'm not really
 > taking a hit?

Curt,

Using GetLayerByName() should be fast.  The layer list is created and
maintained in memory at datasource open time, so it isn't expensive
to do a GetLayerByName() (basically a linear scan of the layer list
with a string compare for each till a match is found).

Of course, you should try to do this only once per redraw/layer
not for every feature.

> I'm not sure whether the driver is combining SDTS elements together
> into OGR layers so that I get elevation and vectors together in the
> layers that I'm drawing, or whether I'm drawing layers as they're
> being read from file.  Depending on how that is done it might make a
> difference in the techniques to use to determine how to draw things
> quickly at the OGR API level.

I think that the features for each layer are just created from records
in the .DDF file but I am not sure.  It has been quite a while since
I worked in depth on the SDTS vector driver.

> I'm using the "C" interface.  Speed is very important to us:  This
> is a tracking application and we can load a lot of maps at a time to
> cover an area, plus if we're tracking a moving object we can be
> reloading maps constantly.  The spatial filtering does appear to be
> helping so far to keep things fast.

To be honest, if speed is of the essence and memory is of little concern
you would be best copying the features into an OGR memory layer or even
reading the data into your own memory structures keeping only the elements
critical to you (toss unused attributes for instance).  While I try not to
do too many stupidly slow things in OGR the basic model is to re-read from
disk for each pass through the features, and generally spatial and
attribute queries are applied by reading all features and then testing the
features to see if they fit the criteria.  Furthermore, OGR has no mechanism
for reading cached read-only features so each pass through requires, at the
very least, creation of the OGRFeature from scratch.

OGR is intended to be reasonably fast by comparison to other translators,
but without a real objective of render-speed.  GDAL on the other hand uses
agressive caching and block orientation to try and be essentially fast
enough for slow rendering (ie. a few renders per second as opposed to
60hz rendering which pretty much needs something like keeping the imagery
loaded on a video card).

PS. OGR is also quite weak on returning metadata such as units for fields.
When I overhaul OGR to use the GDAL driver model, I hope to carry info like
units information around in a more normalized manner as I do for the elevation
units of SDTS DEMs.  No ETA on this though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From bfraser at geoanalytic.com  Mon Oct 18 16:55:28 2004
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Angular units in GeoTiffs
Message-ID: <0c8701c4b554$cca82b30$020002c0@SHARK>

Frank,

  Is there any way to create a GeoTiff with the GeogAngularUnitsGeoKey set
using gdalwarp?  I want to create LatLong geotiffs with the tag set to
Angular_Degree.  The GeoTiff spec doesn't say if there is any default units
setting (maybe I missed it) and some applications don't like it when it is
missing.

Thanks!
Brent Fraser
GeoAnalytic Inc.
Tel:(403) 213-2700
bfraser@geoanalytic.com
www.geoanalytic.com


From warmerdam at pobox.com  Mon Oct 18 17:13:45 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Re: Angular units in GeoTiffs
In-Reply-To: <0c8701c4b554$cca82b30$020002c0@SHARK>
References: <0c8701c4b554$cca82b30$020002c0@SHARK>
Message-ID: <41743209.3010700@pobox.com>

Brent Fraser wrote:
> Frank,
> 
>   Is there any way to create a GeoTiff with the GeogAngularUnitsGeoKey set
> using gdalwarp?  I want to create LatLong geotiffs with the tag set to
> Angular_Degree.  The GeoTiff spec doesn't say if there is any default units
> setting (maybe I missed it) and some applications don't like it when it is
> missing.

Brent,

In my not-so-humble opinion any software that doesn't assume degrees for
unstated angular units is *trying* to make life difficult for users.
Sometimes I wish I could bash software developes with a clue stick.  Of course
sometimes I could stand a good clue-whack or two.

There is currently no way to force GDAL to write out this tag except to
change the source.  You could, of course, accomplish this in an extra
translation step using geotifcp but that would be tedious.

Since you feel it would be helpful, I have modified the GDAL GeoTIFF
driver in CVS to always emit GeogAngularUnitsGeoKey (as Angular_Degree).
The change is now in CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From bfraser at geoanalytic.com  Mon Oct 18 17:53:21 2004
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Re: Angular units in GeoTiffs
References: <0c8701c4b554$cca82b30$020002c0@SHARK> <41743209.3010700@pobox.com>
Message-ID: <0cc301c4b55c$e2cc1220$020002c0@SHARK>

Frank,

  Many thanks.  I can't connect to CVS (is it still cvs.maptools.org?), but
I guess I can wait for the nightly snapshot...

Brent


----- Original Message ----- 
From: "Frank Warmerdam" <warmerdam@pobox.com>
To: "Brent Fraser" <bfraser@geoanalytic.com>
Cc: "GDAL Dev" <gdal-dev@remotesensing.org>
Sent: Monday, October 18, 2004 3:13 PM
Subject: Re: Angular units in GeoTiffs


> Brent Fraser wrote:
> > Frank,
> >
> >   Is there any way to create a GeoTiff with the GeogAngularUnitsGeoKey
set
> > using gdalwarp?  I want to create LatLong geotiffs with the tag set to
> > Angular_Degree.  The GeoTiff spec doesn't say if there is any default
units
> > setting (maybe I missed it) and some applications don't like it when it
is
> > missing.
>
> Brent,
>
> In my not-so-humble opinion any software that doesn't assume degrees for
> unstated angular units is *trying* to make life difficult for users.
> Sometimes I wish I could bash software developes with a clue stick.  Of
course
> sometimes I could stand a good clue-whack or two.
>
> There is currently no way to force GDAL to write out this tag except to
> change the source.  You could, of course, accomplish this in an extra
> translation step using geotifcp but that would be tedious.
>
> Since you feel it would be helpful, I have modified the GDAL GeoTIFF
> driver in CVS to always emit GeogAngularUnitsGeoKey (as Angular_Degree).
> The change is now in CVS.
>
> Best regards,
> -- 
> ---------------------------------------+----------------------------------
----
> I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>


From MChapman at sanz.com  Mon Oct 18 17:57:13 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <ED3A48B9840E594890A2BC172D119465E63BC8@mailman.san.com>

Frank,

Thanks for your reply.  I upgraded to proj 4.4.8 and gdal 1.2.3 and the
TransformEx function works perfectly.

New question:  I installed gdal 1.2.3 on windows and it compiled with no
problem.  Now I'm installing on Linux and I'm getting the following
compiler error listed below.  Basically it can't find the geos libs (I
think).  I already have geos loaded on my linux box with
PostGIS/Postgres and I'm wondering if that could be causing the problem
(older geos version).  Question is...do I also need to load geos
seperately from gdal in 1.2.3, or is that part of the gdal source now?

Compile error:

make[1]: Entering directory `/downloads/gdal-1.2.3/ogr'
/bin/sh ../libtool --mode=compile g++ -Wall  -O2    -Iogrsf_frmts -I.
-I../port
-I../gcore -I../ogr -I../alg   -DHAVE_GEOS=1 -I/usr/include -I../port
-c -o ogr
info.o ogrinfo.cpp
 g++ -Wall -O2 -Iogrsf_frmts -I. -I../port -I../gcore -I../ogr -I../alg
-DHAVE_G
EOS=1 -I/usr/include -I../port -c ogrinfo.cpp  -fPIC -DPIC -o
.libs/ogrinfo.o
 g++ -Wall -O2 -Iogrsf_frmts -I. -I../port -I../gcore -I../ogr -I../alg
-DHAVE_G
EOS=1 -I/usr/include -I../port -c ogrinfo.cpp -o ogrinfo.o >/dev/null
2>&1
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -L/usr/lib -lgeos
-logdi31 -
lgif /usr/lib/libjpeg.so -lpng -lz -ldl -lpq -Wl,--rpath
-Wl,/usr/local/lib
../.libs/libgdal.so: undefined reference to
`geos::WKTReader::WKTReader[in-charg
e](geos::GeometryFactory const*)'
../.libs/libgdal.so: undefined reference to
`geos::DistanceOp::distance()'
../.libs/libgdal.so: undefined reference to
`geos::WKTReader::read(std::basic_st
ring<char, std::char_traits<char>, std::allocator<char> >)'
../.libs/libgdal.so: undefined reference to
`geos::ConvexHull::getConvexHull()'
../.libs/libgdal.so: undefined reference to
`geos::GeometryFactory::GeometryFact
ory[in-charge]()'
../.libs/libgdal.so: undefined reference to
`geos::WKTWriter::WKTWriter[in-charg
e]()'
../.libs/libgdal.so: undefined reference to
`geos::DistanceOp::~DistanceOp [in-c
harge]()'
../.libs/libgdal.so: undefined reference to `typeinfo for
geos::GEOSException'
../.libs/libgdal.so: undefined reference to
`geos::DistanceOp::DistanceOp[in-cha
rge](geos::Geometry const*, geos::Geometry const*)'
../.libs/libgdal.so: undefined reference to
`geos::ConvexHull::~ConvexHull [in-c
harge]()'
../.libs/libgdal.so: undefined reference to
`geos::BufferOp::BufferOp[in-charge]
(geos::Geometry*)'
../.libs/libgdal.so: undefined reference to
`geos::WKTWriter::write(geos::Geomet
ry const*)'
../.libs/libgdal.so: undefined reference to
`geos::ConvexHull::ConvexHull[in-cha
rge](geos::Geometry const*)'
../.libs/libgdal.so: undefined reference to
`geos::BufferOp::getResultGeometry(d
ouble, int)'
../.libs/libgdal.so: undefined reference to `geos::WKTWriter::~WKTWriter
[in-cha
rge]()'
../.libs/libgdal.so: undefined reference to `geos::WKTReader::~WKTReader
[in-cha
rge]()'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/downloads/gdal-1.2.3/ogr'
make: *** [ogr-apps] Error 2
[root@martinlinux gdal-1.2.3]#

Thanks,
Martin



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Saturday, October 16, 2004 7:58 PM
To: Chapman, Martin
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Coordinate transform problem


Chapman, Martin wrote:
> Frank,
> 
> Ok, that makes sense, but I am a little at a loss at how to use the 
> transform method then.  Previously, I used the Inverse and Forward 
> calls for each point, which let me handle "bad points" on a case by 
> case basis, thus allowing me to convert as many coordinates as 
> feasible...a kind of test the limit as you go type algorithm.  I could

> resort back to that, but in essence then I am rewriting the Transform 
> method.  Would it make sense for me to modify or extend the Transform 
> function to do this. In other words, maybe add another optional 
> parameter to Transform that tells the function to drop bad points, or 
> something like that.  Is that a flawed strategy?  The problem with the

> way Transform works now is that I have to scrub my points up front, 
> not, really knowing what points will process correctly and what ones 
> won't, which leads to several inefficiencies.  What did you mean by 
> "error tolerance"?

Martin,

I'm afraid I am not sure what forward and inverse calls you were
previously using or how that is different from what you do now.

You asked about an optional parameter to Transform that would tell the
function to drop bad points.  Are you aware of the TransformEx() method
on the OGRCoordinateTransformation?

     /**
      * Transform points from source to destination space.
      *
      * This method is the same as the C function OCTTransformEx().
      *
      * @param nCount number of points to transform.
      * @param x array of nCount X vertices, modified in place.
      * @param y array of nCount Y vertices, modified in place.
      * @param z array of nCount Z vertices, modified in place.
      * @param pabSuccess array of per-point flags set to TRUE if that
point
      * transforms, or FALSE if it does not.
      *
      * @return TRUE if some or all points transform successfully, or
FALSE if
      * if none transform.
      */
     virtual int TransformEx( int nCount,
                              double *x, double *y, double *z = NULL,
                              int *pabSuccess = NULL ) = 0;


The pabSuccess array is returned indicating which points successfully
transformed.  Now this only tests whether the underlying PROJ
transformation completely failed - not whether the transformation has
become very lossy. So it won't detect that a Mercator transformation is
degrading as you move far from the central meridian, but it can detect
some complete failures as might happen if you moved "over the horizon"
or if there was no grid shift available for a datum shift.

When I referred to error tolerance, I was thinking of actually
transforming and then inverse transforming the points and checking how
much deviation has occured.  The deviation could be compared to some
error tolerance to decide if a transformation is not longer working well
enough to trust.

But some projections might still invert nearly losslessly but still not
be operating sensibly in a real world sense.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Mon Oct 18 20:12:15 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  GetName function for Layer?
In-Reply-To: <Pine.SUN.4.58.0410180827110.6541@eskimo.com>
Message-ID: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>


Is this the only method of determining the name of an SDTS layer
from within OGR?


  if (layerH == OGR_DS_GetLayerByName(datasourceH, "AHPF"))
  {
    hypsography_layer++;    // Topo contours
    fprintf(stderr,"Hypsography Layer (topo contours)\n");
  }


I'm using the GetNextLayer function, iterating through the layers.
I can't seem to find a GetName function for the layer.  Am using the
C API.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From warmerdam at pobox.com  Mon Oct 18 20:22:25 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63BC8@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63BC8@mailman.san.com>
Message-ID: <41745E41.4060702@pobox.com>

Chapman, Martin wrote:
> New question:  I installed gdal 1.2.3 on windows and it compiled with no
> problem.  Now I'm installing on Linux and I'm getting the following
> compiler error listed below.  Basically it can't find the geos libs (I
> think).  I already have geos loaded on my linux box with
> PostGIS/Postgres and I'm wondering if that could be causing the problem
> (older geos version).  Question is...do I also need to load geos
> seperately from gdal in 1.2.3, or is that part of the gdal source now?

Martin,

GDAL requires GEOS 2.0 or newer if you want GEOS support.  The GEOS source
is not part of GDAL so you need to pre-build and install GEOS if you
want to configure GDAL with it.   I don't know if PostGIS is using
GEOS 2.0 yet or not. I haven't actually tried to GEOS enable my PostGIS
installation yet.

Best regards,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Mon Oct 18 21:23:18 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  Can't find IREF module
In-Reply-To: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
Message-ID: <Pine.LNX.4.44.0410181819190.31332-100000@wapiti>


Most of the USGS SDTS-format DLG layers give me this error when I
try to use them with OGR:


  ERROR 1: Can't find IREF module in transfer
  `/usr/local/share/xastir/maps/SDTS/100k/HI/kapaa-e/hydrography/DLG3MDIR.DDF'.


That's _with_ downloading the 1:100k master dictionary that goes
with them and installing/exploding it in the same directories as the
map files.

A few of these types of maps work fine, but most don't.  Is it a
problem with map creation at USGS, or a bug in OGR?

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From randy.page at terraverge.com  Mon Oct 18 21:55:33 2004
From: randy.page at terraverge.com (Randy Page)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] ogr2ogr Datum Shift
Message-ID: <200410182155324.SM02772@rpage>

Hi All,

 

I am using ogr2ogr to convert street data from GDT/Tiger format to PostGIS.
In the process, I would like to convert the data from GCS NAD27 to GCS
NAD83.   Below is a sample command line string I am using:

 

ogr2ogr -f PostgreSQL PG:"dbname=tiger host=localhost" d:\usa\06\06047
-where "cfcc like 'A%'" -lco OVERWRITE=yes -s_srs epsg:4267 -t_srs epsg:4269
-nln datumTest CompleteChain

 

When I execute this, I get the following error:

Error 1: failed to load NAD27-83 correction file

Failed to transform feature 46.

Error 1:  Terminationg translation prematurely after failed translation of
layer CompleteChain

 

Any suggestions as to what might be wrong here?

 

Thanks in advance,

 

Randy

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041018/90e2a3e2/attachment.html
From archer at eskimo.com  Mon Oct 18 23:22:36 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] ogr2ogr Datum Shift
In-Reply-To: <200410182155324.SM02772@rpage>
Message-ID: <Pine.LNX.4.44.0410182021380.28310-100000@wapiti>

On Mon, 18 Oct 2004, Randy Page wrote:

> When I execute this, I get the following error:
>
> Error 1: failed to load NAD27-83 correction file
>
> Failed to transform feature 46.
>
> Error 1:  Terminationg translation prematurely after failed translation of
> layer CompleteChain

That's an indication that you didn't load the NAD27 to NAD83
conversion files into Proj.4 before you compiled it, which would
have been before you compiled/installed GDAL.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From randy.page at terraverge.com  Mon Oct 18 23:38:21 2004
From: randy.page at terraverge.com (Randy Page)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] ogr2ogr Datum Shift
In-Reply-To: <Pine.LNX.4.44.0410182021380.28310-100000@wapiti>
Message-ID: <20041018233716.SM02772@rpage>

Hi Curt,

I'm using OpenEV as compiled by FW for Windows, so I'm guessing that the
conversion files were included in the compile...but maybe not.

Thanks,

Randy

-----Original Message-----
From: Curt Mills [mailto:archer@eskimo.com] 
Sent: Monday, October 18, 2004 11:23 PM
To: Randy Page
Cc: Gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] ogr2ogr Datum Shift

On Mon, 18 Oct 2004, Randy Page wrote:

> When I execute this, I get the following error:
>
> Error 1: failed to load NAD27-83 correction file
>
> Failed to transform feature 46.
>
> Error 1:  Terminationg translation prematurely after failed translation of
> layer CompleteChain

That's an indication that you didn't load the NAD27 to NAD83
conversion files into Proj.4 before you compiled it, which would
have been before you compiled/installed GDAL.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"





From archer at eskimo.com  Mon Oct 18 23:46:47 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] ogr2ogr Datum Shift
In-Reply-To: <20041018233716.SM02772@rpage>
Message-ID: <Pine.LNX.4.44.0410182045530.1483-100000@wapiti>

On Mon, 18 Oct 2004, Randy Page wrote:

> I'm using OpenEV as compiled by FW for Windows, so I'm guessing that the
> conversion files were included in the compile...but maybe not.

Did you have to install Proj.4 separately before you installed
OpenEV, or did OpenEV come with Proj.4 support?

I don't run Windows, so I can't help you directly.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From archer at eskimo.com  Tue Oct 19 01:31:43 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  Can't find IREF module
In-Reply-To: <Pine.LNX.4.44.0410181819190.31332-100000@wapiti>
Message-ID: <Pine.LNX.4.44.0410182230340.22424-100000@wapiti>

On Mon, 18 Oct 2004, Curt Mills wrote:

> Most of the USGS SDTS-format DLG layers give me this error when I
> try to use them with OGR:
>
>
>   ERROR 1: Can't find IREF module in transfer
>   `/usr/local/share/xastir/maps/SDTS/100k/HI/kapaa-e/hydrography/DLG3MDIR.DDF'.

Got it solved.  Thanks.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From warmerdam at pobox.com  Tue Oct 19 01:52:27 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  GetName function for Layer?
In-Reply-To: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
Message-ID: <4174AB9B.2020100@pobox.com>

Curt Mills wrote:
> Is this the only method of determining the name of an SDTS layer
> from within OGR?
> 
> 
>   if (layerH == OGR_DS_GetLayerByName(datasourceH, "AHPF"))
>   {
>     hypsography_layer++;    // Topo contours
>     fprintf(stderr,"Hypsography Layer (topo contours)\n");
>   }
> 
> 
> I'm using the GetNextLayer function, iterating through the layers.
> I can't seem to find a GetName function for the layer.  Am using the
> C API.

Curt,

The name is on the OGRFeatureDefn associated with the layer.

eg.

OGR_FD_GetName( OGR_L_GetLayerDefn( hLayer ) );

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cgt at navicon.dk  Tue Oct 19 06:42:58 2004
From: cgt at navicon.dk (Christian G. Tveen)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] S57 attribute values / descriptions
Message-ID: <4174EFB2.8010307@navicon.dk>

Hi,

I'm trying to describe some values of attributes, e.g. like 
http://www.caris.com/S-57/attribut/natsur.htm . Is anybody aware of a 
file that relates attribute values to description; maybe like 
s57objectclasses.csv ?

Best regards Christian
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3695 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/974bff78/smime.bin
From nhv at cape.com  Tue Oct 19 07:10:53 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] S57 attribute values / descriptions
In-Reply-To: <4174EFB2.8010307@navicon.dk>
Message-ID: <EKEJIKAILPONGGENMBGAOEFJJCAA.nhv@cape.com>

Christian G. Tveen writes:
> 
> I'm trying to describe some values of attributes, e.g. like 
> http://www.caris.com/S-57/attribut/natsur.htm . Is anybody aware of a 
> file that relates attribute values to description; maybe like 
> s57objectclasses.csv ?

Maybe 
http://www.openecdis.org/objclasses/index.html

HTH

Norman

From Martin.Daly at cadcorp.com  Tue Oct 19 07:09:35 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: MapServer WCS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA04E914@dev001_pdc.Dev.cadcorp.net>

Frank,

> I have used PLANARCONFIG_SEPERATE within GDAL (and PCI's GDB 
> before that) by default because it is more efficient for 
> access given the band-by-band approach of GDAL.  This makes 
> some sense when GDAL is used to produce TIFFs for consumption 
> in GDAL, but it is true when aiming for maximum 
> interoperability it would be better to use PLANARCONFIG_CONTIG.
> 
> Steve ... I would suggest you add the FORMATOPTION 
> "INTERLEAVE=BAND" line in the OUTPUTFORMAT declaration in 
> your mapfile to improve interoperability of the TIFF files.
> 
> Martin ... I would encourage you to support 
> planarconfig_seperate files in your built-in TIFF reader if 
> possible.  They aren't too hard ... just yet another case.

What I would like to do is support these files (and some other more
esoteric TIFFs) using the GDAL Plug-in for SIS.  But I'd like to keep
our current internal support as well, for backward compatibility and
other reasons.  SIS offers files to Plug-ins before attempting to use
them itself, so what I'd like to be able to do is allow the GDAL Plug-in
to determine whether or not to accept the file.

All of which is a long-winded way of saying, what do you think about
giving public access to the GTiffDataset hTIFF member (it is currently
private)?  This way I could interrogate the underlying TIFF file to see
if it was, for example, PLANARCONFIG_SEPERATE.  My nuclear alternative
is to use libtiff directly, but I'd end up having to open the file using
GDAL as well just to check that GDAL was happy with it.

Regards,
Martin

From cgt at navicon.dk  Tue Oct 19 07:28:39 2004
From: cgt at navicon.dk (Christian G. Tveen)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] S57 attribute values / descriptions
In-Reply-To: <EKEJIKAILPONGGENMBGAOEFJJCAA.nhv@cape.com>
References: <EKEJIKAILPONGGENMBGAOEFJJCAA.nhv@cape.com>
Message-ID: <4174FA67.4000304@navicon.dk>

Thanks a lot!

Best regards Christian

Norman Vine wrote:

>Christian G. Tveen writes:
>  
>
>>I'm trying to describe some values of attributes, e.g. like 
>>http://www.caris.com/S-57/attribut/natsur.htm . Is anybody aware of a 
>>file that relates attribute values to description; maybe like 
>>s57objectclasses.csv ?
>>    
>>
>
>Maybe 
>http://www.openecdis.org/objclasses/index.html
>
>HTH
>
>Norman
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev
>  
>

-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/x-pkcs7-signature
Size: 3695 bytes
Desc: S/MIME Cryptographic Signature
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/300bf85f/smime.bin
From tdobmeye at ball.com  Tue Oct 19 09:02:01 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088813@daytonmsg2k3.AERO.BALL.COM>

Frank

I downloaded the OPENEV_FW zip file that you recommended. I unzipped it
into the same folder that has the gdal folder. So both OpenEV_FW and
gdal are in their own folders inside the same "parent" folder. I typed
in the command:

gdal_merge.py -o rgb.tif blue.tif green.tif red.tif -separate

With the proper filenames of course. When I press Enter in command
prompt, I receive the following errors. What do they mean?

Traceback (most recent call last):
  File "C:\Support Libraries\OpenEV_FW\pymod\gdal_merge.py", line 76, in
?
    import gdal
  File "C:\Support Libraries\OpenEV_FW\pymod\gdal.py", line 152, in ?
    import _gdal
ImportError: DLL load failed: The specified procedure could not be
found.

Thanks again for your help!

Todd

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Thursday, October 14, 2004 2:25 PM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] pct2rgb.py

Dobmeyer, Todd wrote:
> I honestly do not remember how I built gdal, if I did it with python
> support or not. I might rebuild this to make sure that I do add python
> support. I am on Windows XP Pro and am very new to gdal yet. To make
> sure I get python support, I should go out and find one of the
OpenEV_FW
> builds? Or what exactly should I do? Thanks for your continued help
and
> I am glad I chose to work with gdal!

Todd,

If you don't need to build everything yourself, I would suggest just
using the OpenEV_FW release for this task.

   http://gdal.org/dl/openev/OpenEV_FW_182.zip

It includes everything built nicely together, including the Python
numeric
package which would be needed for gdal_merge.py to work (as noted by
another
user).  On Windows when building GDAL you need to explitely set the
PYDIR
in nmake.opt to get python support working.  I think there are some
additional
complications related to the numeric support.  This is within your
ability to
handle, but unless you need to build things yourself for some reason I
would
suggest you avoid it.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 19 09:14:03 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34088813@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34088813@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <4175131B.9010601@pobox.com>

Dobmeyer, Todd wrote:
> Frank
> 
> I downloaded the OPENEV_FW zip file that you recommended. I unzipped it
> into the same folder that has the gdal folder. So both OpenEV_FW and
> gdal are in their own folders inside the same "parent" folder. I typed
> in the command:
> 
> gdal_merge.py -o rgb.tif blue.tif green.tif red.tif -separate
> 
> With the proper filenames of course. When I press Enter in command
> prompt, I receive the following errors. What do they mean?
> 
> Traceback (most recent call last):
>   File "C:\Support Libraries\OpenEV_FW\pymod\gdal_merge.py", line 76, in
> ?
>     import gdal
>   File "C:\Support Libraries\OpenEV_FW\pymod\gdal.py", line 152, in ?
>     import _gdal
> ImportError: DLL load failed: The specified procedure could not be
> found.

Todd,

Had you edited the setfw.bat to reflect the path to where you unpacked it?
Had you then run setfw.bat in the shell?

Also, I see you have a space in a parent directory.  This could possibly
be a problem, so you might want to try moving the tree temporarily to the
root (ie. C:\OpenEV_FW) and see if that works better.  If there is an issue
with spaces in the path I will dig into it at my end, but I would appreciate
hearing about it.

Hmm, the other thing I see is that you are running it as gdal_merge.py.  With
the OpenEV_FW package there is a .bat file in the bin directory that should
normally be used instead of running the python scripts directly.  In fact, I'm
a bit surprised you could run gdal_merge.py directly.  Normally the WinXP
command shell does not know how to launch them with python.  Are you running
this from Cygwin or do you have a regular python installation on your system?
To ensure that everything in OpenEV_FW works properly it is best to only run
stuff from the regular CMD.EXE shell, and to ensure you get the environment
setup by setfw.bat.  This is intended to ensure that the OpenEV_FW versions of
everything get used, and that the environment is setup properly to find
everything.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 19 09:22:01 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Re: MapServer WCS
In-Reply-To: <DE8A435707FBA24392E5C67F58E294AA04E914@dev001_pdc.Dev.cadcorp.net>
References: <DE8A435707FBA24392E5C67F58E294AA04E914@dev001_pdc.Dev.cadcorp.net>
Message-ID: <417514F9.1010502@pobox.com>

Martin Daly wrote:
> What I would like to do is support these files (and some other more
> esoteric TIFFs) using the GDAL Plug-in for SIS.  But I'd like to keep
> our current internal support as well, for backward compatibility and
> other reasons.  SIS offers files to Plug-ins before attempting to use
> them itself, so what I'd like to be able to do is allow the GDAL Plug-in
> to determine whether or not to accept the file.
> 
> All of which is a long-winded way of saying, what do you think about
> giving public access to the GTiffDataset hTIFF member (it is currently
> private)?  This way I could interrogate the underlying TIFF file to see
> if it was, for example, PLANARCONFIG_SEPERATE.  My nuclear alternative
> is to use libtiff directly, but I'd end up having to open the file using
> GDAL as well just to check that GDAL was happy with it.

Martin,

Well, an extra TIFFOpen() isn't that expensive; however, it happens there is
a very nice mechanism for handling this.  The GDALDataset class has a
GetInternalHandle() method specifically intended to make it possible to
get internal access handles for "extended access" by applications with very
specific needs.  I have added an implementation for the GTiffDataset that
returns hTIFF.

void *GTiffDataset::GetInternalHandle( const char * pszHandleName )

{
     return hTIFF;
}

To future proof you code I would encourage you to pass the handle name
"hTIFF".

Does this give you what you need?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Martin.Daly at cadcorp.com  Tue Oct 19 09:29:33 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: MapServer WCS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA03223D@dev001_pdc.Dev.cadcorp.net>

Frank,

> Well, an extra TIFFOpen() isn't that expensive; however, it 
> happens there is a very nice mechanism for handling this.  
> The GDALDataset class has a
> GetInternalHandle() method specifically intended to make it 
> possible to get internal access handles for "extended access" 
> by applications with very specific needs.  I have added an 
> implementation for the GTiffDataset that returns hTIFF.
> 
> void *GTiffDataset::GetInternalHandle( const char * pszHandleName )
> 
> {
>      return hTIFF;
> }
> 
> To future proof you code I would encourage you to pass the 
> handle name "hTIFF".
> 
> Does this give you what you need?

It does indeed.

Thanks.
Martin

From tdobmeye at ball.com  Tue Oct 19 09:30:26 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] pct2rgb.py
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088814@daytonmsg2k3.AERO.BALL.COM>

Frank

> Had you edited the setfw.bat to reflect the path to where you unpacked
it?
> Had you then run setfw.bat in the shell?

I hadn't set the path, but I have now and have run the setfw.bat file
with no problem. Should I run the openev.bat file? I tried to and it
complained that python22.dll was not found.

> I'm a bit surprised you could run gdal_merge.py directly.  Normally
the 
> WinXP command shell does not know how to launch them with python.  Are
you > running this from Cygwin or do you have a regular python
installation on 
> your system?

I don't know what Cygwin is, so I am not running from that. I did
install python onto my machine, but have done nothing with it yet. Now
when I try the gdal_merge.py command that I tried before, I get a pop-up
box saying dynamic link library gdal12.dll could not be located.

> Also, I see you have a space in a parent directory.  This could
possibly
> be a problem, so you might want to try moving the tree temporarily to
the
> root (ie. C:\OpenEV_FW) and see if that works better.  If there is an 
> issue with spaces in the path I will dig into it at my end, but I
would
> appreciate hearing about it.

I get the same error no matter if it is in the C:\OpenEv_Fw or in my
other folder with a space.

I am running everything through Command Prompt. I go to Run and type in
CMD, so I believe I am doing that stuff correctly. Thanks again for your
help.

Todd


-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Tuesday, October 19, 2004 9:14 AM
To: Dobmeyer, Todd
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] pct2rgb.py

Dobmeyer, Todd wrote:
> Frank
> 
> I downloaded the OPENEV_FW zip file that you recommended. I unzipped
it
> into the same folder that has the gdal folder. So both OpenEV_FW and
> gdal are in their own folders inside the same "parent" folder. I typed
> in the command:
> 
> gdal_merge.py -o rgb.tif blue.tif green.tif red.tif -separate
> 
> With the proper filenames of course. When I press Enter in command
> prompt, I receive the following errors. What do they mean?
> 
> Traceback (most recent call last):
>   File "C:\Support Libraries\OpenEV_FW\pymod\gdal_merge.py", line 76,
in
> ?
>     import gdal
>   File "C:\Support Libraries\OpenEV_FW\pymod\gdal.py", line 152, in ?
>     import _gdal
> ImportError: DLL load failed: The specified procedure could not be
> found.

Todd,

Had you edited the setfw.bat to reflect the path to where you unpacked
it?
Had you then run setfw.bat in the shell?

Also, I see you have a space in a parent directory.  This could possibly
be a problem, so you might want to try moving the tree temporarily to
the
root (ie. C:\OpenEV_FW) and see if that works better.  If there is an
issue
with spaces in the path I will dig into it at my end, but I would
appreciate
hearing about it.

Hmm, the other thing I see is that you are running it as gdal_merge.py.
With
the OpenEV_FW package there is a .bat file in the bin directory that
should
normally be used instead of running the python scripts directly.  In
fact, I'm
a bit surprised you could run gdal_merge.py directly.  Normally the
WinXP
command shell does not know how to launch them with python.  Are you
running
this from Cygwin or do you have a regular python installation on your
system?
To ensure that everything in OpenEV_FW works properly it is best to only
run
stuff from the regular CMD.EXE shell, and to ensure you get the
environment
setup by setfw.bat.  This is intended to ensure that the OpenEV_FW
versions of
everything get used, and that the environment is setup properly to find
everything.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ealpert at digitalglobe.com  Tue Oct 19 09:44:32 2004
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB16147AA5@COMAIL01.digitalglobe.com>

Keep in mind if you install GEOS 2.x you'll need to upgrade to postgis 0.9.0 or keep two versions of GEOS installed.
 
-e

________________________________

From: gdal-dev-bounces@xserve.flids.com on behalf of Frank Warmerdam
Sent: Mon 10/18/2004 6:22 PM
To: Chapman, Martin
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Coordinate transform problem



Chapman, Martin wrote:
> New question:  I installed gdal 1.2.3 on windows and it compiled with no
> problem.  Now I'm installing on Linux and I'm getting the following
> compiler error listed below.  Basically it can't find the geos libs (I
> think).  I already have geos loaded on my linux box with
> PostGIS/Postgres and I'm wondering if that could be causing the problem
> (older geos version).  Question is...do I also need to load geos
> seperately from gdal in 1.2.3, or is that part of the gdal source now?

Martin,

GDAL requires GEOS 2.0 or newer if you want GEOS support.  The GEOS source
is not part of GDAL so you need to pre-build and install GEOS if you
want to configure GDAL with it.   I don't know if PostGIS is using
GEOS 2.0 yet or not. I haven't actually tried to GEOS enable my PostGIS
installation yet.

Best regards,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/6565c535/attachment.html
From pviroulet at yahoo.fr  Tue Oct 19 10:16:33 2004
From: pviroulet at yahoo.fr (Viroulet Patrick)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] GDAL, .net and C#
Message-ID: <20041019141633.85824.qmail@web26008.mail.ukl.yahoo.com>

Hello everybody!
 
I am currentl using GDAL and OGR with Visual studio 6.
I plan to make a new application using the .net environnement, and C#.
 
Did anybody work on (or just think about) the Gdal lib port to C#?
Is there a fast and/or trivial solution to use the most OGR classes (OGRDataSet, OGRLayer, and OGRFeature) under C# ??
 
I know it is a huge topic ! 
If anybody could just give some ideas, to show me the way...
Thank you in advance!
 
Patrick Viroulet

		
---------------------------------
Cr?ez gratuitement votre Yahoo! Mail avec 100 Mo de stockage !
Cr?ez votre Yahoo! Mail

Le nouveau Yahoo! Messenger est arriv? ! D?couvrez toutes les nouveaut?s pour dialoguer instantan?ment avec vos amis.T?l?chargez GRATUITEMENT ici !
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/640dacf9/attachment.html
From archer at eskimo.com  Tue Oct 19 10:43:40 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  GetName function for Layer?
In-Reply-To: <4174AB9B.2020100@pobox.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<4174AB9B.2020100@pobox.com>
Message-ID: <Pine.SUN.4.58.0410190741020.25568@eskimo.com>

On Tue, 19 Oct 2004, Frank Warmerdam wrote:

> The name is on the OGRFeatureDefn associated with the layer.
>
> eg.
>
> OGR_FD_GetName( OGR_L_GetLayerDefn( hLayer ) );

Method above works great.  Thanks!

Seems to be a bit faster too, which makes sense.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From marco.hugentobler at autoform.ch  Tue Oct 19 11:00:18 2004
From: marco.hugentobler at autoform.ch (Marco Hugentobler)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR: opening shapefiles with no records
Message-ID: <41752C02.1030308@autoform.ch>

Dear OGR developers,

When i open a shapefile with no records i receive a crash in the 
GetDBFCount method (it seems, that the dbf-handle is a null pointer). Is 
it not possible to open empty shapefiles with OGR or am i doing 
something wrong? At the moment, i insert a dummy feature for empty 
layers as a workaround, but it would of course be nicer without this. 
The version i am using is 1.2.3 on Suse-9.1

Thanks,
Marco



From warmerdam at pobox.com  Tue Oct 19 11:34:39 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR: opening shapefiles with no records
In-Reply-To: <41752C02.1030308@autoform.ch>
References: <41752C02.1030308@autoform.ch>
Message-ID: <4175340F.5040303@pobox.com>

Marco Hugentobler wrote:
> Dear OGR developers,
> 
> When i open a shapefile with no records i receive a crash in the 
> GetDBFCount method (it seems, that the dbf-handle is a null pointer). Is 
> it not possible to open empty shapefiles with OGR or am i doing 
> something wrong? At the moment, i insert a dummy feature for empty 
> layers as a workaround, but it would of course be nicer without this. 
> The version i am using is 1.2.3 on Suse-9.1
> 
> Thanks,
> Marco

Marco,

Can you provide a zip or tar file of such a problem dataset?   This definately
should not happen.  Best to submit it to the GDAL bugzilla if you don't mind.

Thanks,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Martin.Daly at cadcorp.com  Tue Oct 19 11:33:31 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: MapServer WCS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA04E915@dev001_pdc.Dev.cadcorp.net>

Frank,

> > Does this give you what you need?
> 
> It does indeed.

I spoke too soon.  Just this week I changed from linking with gdal.lib
(i.e. statically), to linking with gdal_i.lib (i.e. dynamically).  In
the dynamic link there is no DLL entry point for the libtiff function
that I want to use: TIFFGetField.

In the short term I have worked around it by adding the following to
frmts\gtiff\geotiff.cpp:

int CPL_DLL GDAL_TIFFGetField(TIFF* tif, ttag_t tag, ...)
{
	int status;
	va_list ap;

	va_start(ap, tag);
	status = TIFFVGetField(tif, tag, ap);
	va_end(ap);
	return (status);
}

That is copied TIFFGetField (inside CPL_C_START/CPL_C_END), prefixed it
with GDAL_, and added CPL_DLL.  Not nice.

Regards,
Martin

From warmerdam at pobox.com  Tue Oct 19 11:40:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Re: MapServer WCS
In-Reply-To: <DE8A435707FBA24392E5C67F58E294AA04E915@dev001_pdc.Dev.cadcorp.net>
References: <DE8A435707FBA24392E5C67F58E294AA04E915@dev001_pdc.Dev.cadcorp.net>
Message-ID: <41753561.8030601@pobox.com>

Martin Daly wrote:
> int CPL_DLL GDAL_TIFFGetField(TIFF* tif, ttag_t tag, ...)
> {
> 	int status;
> 	va_list ap;
> 
> 	va_start(ap, tag);
> 	status = TIFFVGetField(tif, tag, ap);
> 	va_end(ap);
> 	return (status);
> }
> 
> That is copied TIFFGetField (inside CPL_C_START/CPL_C_END), prefixed it
> with GDAL_, and added CPL_DLL.  Not nice.

Martin,

If you want an externally accessable libtiff API the best way is to build
libtiff seperately from GDAL and then link GDAL against that.  The normal
libtiff build mechanisms do export all the entry points (using a .def file)
while GDAL does not.  One could argue whether GDAL should, or whether it is
better for GDAL to "hide" it's copy of libtiff internally, but I am not keen
to try and change this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From CaronR at AGR.GC.CA  Tue Oct 19 11:41:50 2004
From: CaronR at AGR.GC.CA (Caron, Roberto)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] GDAL Information
Message-ID: <A71388C2B6C9784B9511CD3832EFA7C2981B51@onncrxms2.agr.gc.ca>

Hi,

 

            GDAL seems to me the best product for what I would like to
do: 

-          Import WKT and Export to WKB

-          Import WKB and Export to WKT

-          Import WKT and Export to GML2 

-          Import GML2 and Export to WKT (by standard we will have one
and only one feature by GML)

-          Import ESRI Shapefile and Export to WKT??? (please, just give
me the restriction)

 

Is there a java utility that will do exactly the same thing?

 

Thanks

 

Roberto

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/80fcef00/attachment.html
From MChapman at sanz.com  Tue Oct 19 11:55:40 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Coordinate transform problem
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFDF5@mailman.san.com>

Ethan and Frank,
 
Thanks very much for your help.  After some debugging I think it is the
environment I'm using rather than anything related to GDAL/GEOS...which
is kind of what I figured since both of those libraries usually compile
without problems.
 
Thanks again,
Martin

	-----Original Message-----
	From: Ethan Alpert [mailto:ealpert@digitalglobe.com] 
	Sent: Tuesday, October 19, 2004 7:45 AM
	To: Frank Warmerdam; Chapman, Martin
	Cc: gdal-dev@remotesensing.org
	Subject: RE: [Gdal-dev] Coordinate transform problem
	
	
	Keep in mind if you install GEOS 2.x you'll need to upgrade to
postgis 0.9.0 or keep two versions of GEOS installed.
	 
	-e

  _____  

	From: gdal-dev-bounces@xserve.flids.com on behalf of Frank
Warmerdam
	Sent: Mon 10/18/2004 6:22 PM
	To: Chapman, Martin
	Cc: gdal-dev@remotesensing.org
	Subject: Re: [Gdal-dev] Coordinate transform problem
	
	

	Chapman, Martin wrote:
	> New question:  I installed gdal 1.2.3 on windows and it
compiled with no
	> problem.  Now I'm installing on Linux and I'm getting the
following
	> compiler error listed below.  Basically it can't find the geos
libs (I
	> think).  I already have geos loaded on my linux box with
	> PostGIS/Postgres and I'm wondering if that could be causing
the problem
	> (older geos version).  Question is...do I also need to load
geos
	> seperately from gdal in 1.2.3, or is that part of the gdal
source now?
	
	Martin,
	
	GDAL requires GEOS 2.0 or newer if you want GEOS support.  The
GEOS source
	is not part of GDAL so you need to pre-build and install GEOS if
you
	want to configure GDAL with it.   I don't know if PostGIS is
using
	GEOS 2.0 yet or not. I haven't actually tried to GEOS enable my
PostGIS
	installation yet.
	
	Best regards,
	
	
---------------------------------------+--------------------------------
------
	I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
	light and sound - activate the windows |
http://pobox.com/~warmerdam
	and watch the world go round - Rush    | Geospatial Programmer
for Rent
	
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/989f604b/attachment.html
From Martin.Daly at cadcorp.com  Tue Oct 19 12:23:44 2004
From: Martin.Daly at cadcorp.com (Martin Daly)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: MapServer WCS
Message-ID: <DE8A435707FBA24392E5C67F58E294AA04E917@dev001_pdc.Dev.cadcorp.net>

Frank,

> If you want an externally accessable libtiff API the best way 
> is to build libtiff seperately from GDAL and then link GDAL 
> against that.  The normal libtiff build mechanisms do export 
> all the entry points (using a .def file) while GDAL does not. 
>  One could argue whether GDAL should, or whether it is better 
> for GDAL to "hide" it's copy of libtiff internally, but I am 
> not keen to try and change this.

Done.  Works a treat.

Thanks,
Martin

From tdobmeye at ball.com  Tue Oct 19 13:34:11 2004
From: tdobmeye at ball.com (Dobmeyer, Todd)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdal_merge
Message-ID: <C482FF98AE985A47B8C982FD429C9E34088819@daytonmsg2k3.AERO.BALL.COM>

I have finally gotten gdal_merge to work by putting OpenEv_Fw into
C:\OpenEv_Fw. I cannot seem to find a specific order in which the red,
green, and blue colors need to be put for the inputs. I am using:

 

gdal_merge -o outputRGB.tif inputRed.tif inputBlue.tif inputGreen.tif
-separate

 

I have tried all 6 combinations to type in Red, Blue, and Green and have
looked though the gdal_merge.py code and cannot figure out which way the
three files should be give. I have had my RGB output file look Red,
Blue, 2 shades of Purple, Teal, and Green. Am I missing a parameter?
Thanks once again!

 

Todd Dobmeyer

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041019/e463d5b3/attachment.html
From warmerdam at pobox.com  Tue Oct 19 15:39:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] gdal_merge
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E34088819@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E34088819@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <41756D5B.7060201@pobox.com>

Dobmeyer, Todd wrote:
> I have finally gotten gdal_merge to work by putting OpenEv_Fw into 
> C:\OpenEv_Fw. I cannot seem to find a specific order in which the red, 
> green, and blue colors need to be put for the inputs. I am using:
> 
>  
> 
> gdal_merge ?o outputRGB.tif inputRed.tif inputBlue.tif inputGreen.tif 
> ?separate
> 
>  
> 
> I have tried all 6 combinations to type in Red, Blue, and Green and have 
> looked though the gdal_merge.py code and cannot figure out which way the 
> three files should be give. I have had my RGB output file look Red, 
> Blue, 2 shades of Purple, Teal, and Green. Am I missing a parameter? 
> Thanks once again!

Todd,

You should provide them in the order red first, green second, and blue third.
Have you considered that the composite image might really be reddish?  Have
you check that the three bands are individually correct and seem to have
similar intensities?  If you want to make the files available for download
somewhere I can composite them and verify that I think things are working
properly.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From werchowyna at pf.pl  Tue Oct 19 16:04:09 2004
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] (no subject)
Message-ID: <012d01c4b616$e037b720$70e063d9@podyadeck>

on an old CVS GDAL (1.2.1.0, released 2004/08/27) I'm getting following
troubles

fixed in a newer version? (sorry for bugging you then!)

a segfault on deflate compression in gdal_warp and gdal_merge.py:

    [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
    COMPRESS=DEFLATE ~/danecz/ZABAGED2/*.tif
    Segmentation fault

no support for PackBits (and same for LZW)

    [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
    COMPRESS=PACKBITS ~/danecz/ZABAGED2/*.tif
    ERROR 1: krnap_cmp.tif:PackBits compression support is not configured
    (...)

a troble with JPEG compression

    [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
    COMPRESS=JPEG ~/danecz/ZABAGED2/*.tif
    python: tif_jpeg.c:651: JPEGPreDecode: Assertion
    `sp->cinfo.comm.is_decompressor' failed.
    Aborted

and with gcps2wld.py

    [ziutek@localhost ziutek]$ gcps2wld.py /home/ziutek/Desktop/krnap.tif
    Traceback (most recent call last):
    File "/usr/local/bin/gcps2wld.py", line 63, in ?
    print geotransform[1]
    TypeError: unsubscriptable object[ziutek@localhost ziutek]$

gdalinfo on the problematic file (negative values because it's a S-JTSK
Krovak East North projection, epsg <102067>):

    [ziutek@localhost ziutek]$ gdalinfo /home/ziutek/Desktop/krnap.tif
    Driver: GTiff/GeoTIFF
    Size is 14173, 6299
    Coordinate System is `'
    Origin = (-650000.635000,-977999.365000)
    Pixel Size = (1.27000000,-1.27000000)
    Corner Coordinates:
    Upper Left  ( -650000.635, -977999.365)
    Lower Left  ( -650000.635, -985999.095)
    Upper Right ( -632000.925, -977999.365)
    Lower Right ( -632000.925, -985999.095)
    Center      ( -641000.780, -981999.230)
    Band 1 Block=14173x1 Type=Byte, ColorInterp=Red
    Band 2 Block=14173x1 Type=Byte, ColorInterp=Green
    Band 3 Block=14173x1 Type=Byte, ColorInterp=Blue

Maciek

From warmerdam at pobox.com  Tue Oct 19 16:18:51 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] (no subject)
In-Reply-To: <012d01c4b616$e037b720$70e063d9@podyadeck>
References: <012d01c4b616$e037b720$70e063d9@podyadeck>
Message-ID: <417576AB.3020603@pobox.com>

Maciek Sieczka wrote:
> on an old CVS GDAL (1.2.1.0, released 2004/08/27) I'm getting following
> troubles

Maciek,

1.2.1?  That is ancient.  I take no responsible for the code I produced when I
was a kid ... back in ... September.

> fixed in a newer version? (sorry for bugging you then!)
> 
> a segfault on deflate compression in gdal_warp and gdal_merge.py:
> 
>     [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
>     COMPRESS=DEFLATE ~/danecz/ZABAGED2/*.tif
>     Segmentation fault

I wasn't able to reproduce this crash, but I wasn't able to gdal_merge.py
to a compressed TIFF file because gdal_merge.py uses random update to place
the chunks of imagery as they are read in.  You will pretty much need to
write an uncompressed file with gdal_merge.py and then compress it with
gdal_translate.

Andrey is apparently working on update-in-place support for compressed
TIFF files, and once that is working smoothly through GDAL you might well
be able to do what you want.

> no support for PackBits (and same for LZW)
> 
>     [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
>     COMPRESS=PACKBITS ~/danecz/ZABAGED2/*.tif
>     ERROR 1: krnap_cmp.tif:PackBits compression support is not configured
>     (...)

I believe it was GDAL 1.2.1 (or 1.2.2?) that had serious issues with
configuring in various compression types for TIFF.  Upgrade to 1.2.3 please.

> a troble with JPEG compression
> 
>     [ziutek@localhost ziutek]$ gdal_merge.py -o krnap_cmp.tif -of GTiff -co
>     COMPRESS=JPEG ~/danecz/ZABAGED2/*.tif
>     python: tif_jpeg.c:651: JPEGPreDecode: Assertion
>     `sp->cinfo.comm.is_decompressor' failed.
>     Aborted

I believe this is the issue with writing compressed files randomly, though
I didn't see the same message with the current code. Instead I get alot
of "ERROR 1: TIFFWriteEncodedStrip:out.tif: File not open for writing"
messages.

> and with gcps2wld.py
> 
>     [ziutek@localhost ziutek]$ gcps2wld.py /home/ziutek/Desktop/krnap.tif
>     Traceback (most recent call last):
>     File "/usr/local/bin/gcps2wld.py", line 63, in ?
>     print geotransform[1]
>     TypeError: unsubscriptable object[ziutek@localhost ziutek]$

Looking through the code it seems that this happens if the function
completely fails ... for instance if there are no GCPs.  I have made
some changes to the script to report such problems more appropriately.
If you think the script should be working on your file (no sign of GCPs in
the gdalinfo report) then let me know.

If you still get the same error messages after upgrading to GDAL 1.2.3 please
let me know (ideally via bugzilla).  Of course if you get the "file not open
for writing" messages with gdal_merge to a compressed format then that is
just to be expected for now.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From paul at toolscenter.org  Tue Oct 19 17:31:18 2004
From: paul at toolscenter.org (Paul Selormey)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] GDAL, .net and C#
References: <20041019141633.85824.qmail@web26008.mail.ukl.yahoo.com>
Message-ID: <001601c4b622$fc053700$030ba8c0@SWEETJESUS>

The easiest way is to provide a C# wrapper for the GDAL exposed C interfaces.
I think this should be the recommended way, since no matter how much resources
you have to invest (see the next option below), third party libraries like MrSID, ECW
etc are not likely to be ported to native Java or .NET soon.

If you have enough time and resources, you can invest in MC++. Use the MC++
to compile the GDAL to .NET assembly and add some managed wrapper classes
for the OGRDataSet, OGRLayer etc.

Unfortunately, MC++ is being replaced with C++/CLR, which means you have
to consider carefully whether it is worth investing in MC++ now or waiting for
the C++/CLR release in .NET 2.0.

Best regards,
Paul.

  ----- Original Message ----- 
  From: Viroulet Patrick 
  To: gdal-dev@xserve.flids.com 
  Sent: Tuesday, October 19, 2004 11:16 PM
  Subject: [Gdal-dev] GDAL, .net and C#


  Hello everybody!

  I am currentl using GDAL and OGR with Visual studio 6.
  I plan to make a new application using the .net environnement, and C#.

  Did anybody work on (or just think about) the Gdal lib port to C#?
  Is there a fast and/or trivial solution to use the most OGR classes (OGRDataSet, OGRLayer, and OGRFeature) under C# ??

  I know it is a huge topic ! 
  If anybody could just give some ideas, to show me the way...
  Thank you in advance!

  Patrick Viroulet


------------------------------------------------------------------------------
  Cr?ez gratuitement votre Yahoo! Mail avec 100 Mo de stockage ! 
  Cr?ez votre Yahoo! Mail

  Le nouveau Yahoo! Messenger est arriv? ! D?couvrez toutes les nouveaut?s pour dialoguer instantan?ment avec vos amis. T?l?chargez GRATUITEMENT ici !


------------------------------------------------------------------------------


  _______________________________________________
  Gdal-dev mailing list
  Gdal-dev@xserve.flids.com
  http://xserve.flids.com/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041020/aa024b56/attachment.html
From ben at vterrain.org  Tue Oct 19 23:14:24 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: too precise projection comparison
In-Reply-To: <417217A8.30406@polarcom.com>
Message-ID: <01e201c4b652$e69e6410$f400fe0a@TOPP2>


Matt,

I debugged into it, and found that GDAL (or OGR in this case) is actually
very picky about projection parameters matching exactly.

It's not the text in the "degree" field, and it's not the cell size.  It's
this:
  PARAMETER["standard_parallel_1",61.66666666666672]
  PARAMETER["standard_parallel_1",61.66666666666673]

Yes, that's enough to cause OGRSpatialReference::IsSame to return false.

So, Matt, in lieu of OGR adding some kind of epsilon test, i'd recommend
that you track the changes back to find where the projections diverged in
your tool chain, and/or simply fix the text in your .prj files.  For
example, it's certain that the correct value above is actually:
  PARAMETER["standard_parallel_1",61.66666666666666]

-Ben

> -----Original Message-----
> From: Matt, Kim, Cole & Danni [mailto:patawi@polarcom.com] 
> Sent: Sunday, October 17, 2004 2:57 AM
> To: Ben Discoe
> Subject: Re: too precise projection comparison
> 
> >>Bug (sort of): VTBuilder comparing projections is too 
> >>precise. It offers to convert projections when the
> >>mismatch is down on the 14th decimal place:
> 
> Ahh, I was led astray by the error message. I assumed that 
> because there was a difference in the numbers in the message,
> that was the entire extent of the difference. After manually
> comparing the .prj files I found another difference:
> 
> A.prj:
> UNIT["degree"
> 
> B.prj:
> UNIT["degree (supplier to define representation)"
> 
> And of course the cell sizes differ. There must be another 
> one in there too though because when I manually edit the
> "supplier..." text I didn't get the message. Sample data
> attached.
> 
> I can't remember how I generated B, it was either vtconvert or 
> gdal_translate back in early May.
> 
> -matt


From ed at topozone.com  Tue Oct 19 23:17:26 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] RE: too precise projection comparison
Message-ID: <C60FA9D8-C4EA-40EA-B911-EC2FB304C650@topozone.com>

Ben -

Certainty is risky business <g>.  One might very reasonably expect the "correct" value here to be:

PARAMETER["standard_parallel_1",61.66666666666667]

Which is why this sort of business is the minefield that it is, and why, for all their faults, I find EPSG projection codes very reassuring to deal with <g>.

     - Ed

Ed McNierney
TopoZone.com

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Ben Discoe
Sent: Tuesday, October 19, 2004 11:14 PM
To: 'Matt, Kim, Cole & Danni'
Cc: 'gdal-dev'
Subject: [Gdal-dev] RE: too precise projection comparison


Matt,

I debugged into it, and found that GDAL (or OGR in this case) is actually very picky about projection parameters matching exactly.

It's not the text in the "degree" field, and it's not the cell size.  It's
this:
  PARAMETER["standard_parallel_1",61.66666666666672]
  PARAMETER["standard_parallel_1",61.66666666666673]

Yes, that's enough to cause OGRSpatialReference::IsSame to return false.

So, Matt, in lieu of OGR adding some kind of epsilon test, i'd recommend that you track the changes back to find where the projections diverged in your tool chain, and/or simply fix the text in your .prj files.  For example, it's certain that the correct value above is actually:
  PARAMETER["standard_parallel_1",61.66666666666666]

-Ben

> -----Original Message-----
> From: Matt, Kim, Cole & Danni [mailto:patawi@polarcom.com]
> Sent: Sunday, October 17, 2004 2:57 AM
> To: Ben Discoe
> Subject: Re: too precise projection comparison
> 
> >>Bug (sort of): VTBuilder comparing projections is too precise. It 
> >>offers to convert projections when the mismatch is down on the 14th 
> >>decimal place:
> 
> Ahh, I was led astray by the error message. I assumed that because 
> there was a difference in the numbers in the message, that was the 
> entire extent of the difference. After manually comparing the .prj 
> files I found another difference:
> 
> A.prj:
> UNIT["degree"
> 
> B.prj:
> UNIT["degree (supplier to define representation)"
> 
> And of course the cell sizes differ. There must be another one in 
> there too though because when I manually edit the "supplier..." text I 
> didn't get the message. Sample data attached.
> 
> I can't remember how I generated B, it was either vtconvert or 
> gdal_translate back in early May.
> 
> -matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev


From norbert.thieme at ilmenau.baw.de  Wed Oct 20 04:56:09 2004
From: norbert.thieme at ilmenau.baw.de (Norbert Thieme)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR_SQL question
Message-ID: <41762829.3050904@ilmenau.baw.de>

Hello,

I want to try out the new functions in OGR that come from GEOS and use 
that for a shapefile or a gml in Mapserver. Can anyone tell me how a sql 
string using functions like (buffer, union ..) might look like?

Thanks in advance,
Norbert




From warmerdam at pobox.com  Wed Oct 20 09:38:16 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR_SQL question
In-Reply-To: <41762829.3050904@ilmenau.baw.de>
References: <41762829.3050904@ilmenau.baw.de>
Message-ID: <41766A48.5050806@pobox.com>

Norbert Thieme wrote:
> Hello,
> 
> I want to try out the new functions in OGR that come from GEOS and use 
> that for a shapefile or a gml in Mapserver. Can anyone tell me how a sql 
> string using functions like (buffer, union ..) might look like?

Norbert,

OGR SQL does not include any spatial operators. In fact, the geometry of
a feature is inaccessable from OGR SQL and is handled via different data
paths.  The OGR SQL can only get at non-spatial attributes of the features.

The GEOS capabilities are exposed via the C, C++ and Python APIs though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Wed Oct 20 11:29:51 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
Message-ID: <Pine.SUN.4.58.0410200826260.10553@eskimo.com>


Is there a chance that OGR will support TIGER/Line polygons at some
point?  For that particular file format it looks like I'll have to
do a lot of special coding just to get to the polygons, due to TIGER
having represented them as polylines instead.  Seems OGR should hide
the implementation details of various file formats from me, but in
this case it doesn't.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From wlyons at prologic-inc.com  Wed Oct 20 12:35:28 2004
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] Compiling with OGDI on Window$
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DB79C07@vader.prologic-inc.com>

	Hi gdal list,

	 

	Has anyone out there successfully compiled gdal with ogdi on
window$?

	 

	Thanks,

	 

	William Lyons

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041020/20577862/attachment.html
From archer at eskimo.com  Wed Oct 20 13:04:45 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:26 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410200826260.10553@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
Message-ID: <Pine.SUN.4.58.0410201002400.13761@eskimo.com>

On Wed, 20 Oct 2004, Curt, WE7U wrote:

> Is there a chance that OGR will support TIGER/Line polygons at some
> point?  For that particular file format it looks like I'll have to
> do a lot of special coding just to get to the polygons, due to TIGER
> having represented them as polylines instead.  Seems OGR should hide
> the implementation details of various file formats from me, but in
> this case it doesn't.

And while I'm at it, what's the expected timeframe for integrating
the OGR API into the GDAL API?  Does it make sense for me to be
writing to the OGR API right now?  Will the OGR API go away at GDAL
integration time?

Thanks!

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Wed Oct 20 13:03:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Compiling with OGDI on Window$
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DB79C07@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DB79C07@vader.prologic-inc.com>
Message-ID: <41769A50.6000904@pobox.com>

William Lyons wrote:
>     Hi gdal list,
> 
>      
> 
>     Has anyone out there successfully compiled gdal with ogdi on window$?

William,

Yes, I have.

Were you able to build the OGDI tree without problems?  Once that is done,
OGDI enabling GDAL should be pretty easy.  Just uncomment and update the
appropriate OGDI entries in nmake.opt.  You might well need to copy the
OGDI DLLs to somewhere in your path.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Oct 20 13:11:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410201002400.13761@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<Pine.SUN.4.58.0410201002400.13761@eskimo.com>
Message-ID: <41769C2B.1090509@pobox.com>

Curt, WE7U wrote:
> On Wed, 20 Oct 2004, Curt, WE7U wrote:
> 
> 
>>Is there a chance that OGR will support TIGER/Line polygons at some
>>point?  For that particular file format it looks like I'll have to
>>do a lot of special coding just to get to the polygons, due to TIGER
>>having represented them as polylines instead.  Seems OGR should hide
>>the implementation details of various file formats from me, but in
>>this case it doesn't.

Curt,

There is no real plan to implement polygon assembly within the TIGER/Line
driver.  I'm not really adverse to having this happen, but it is critical
that it be done in a way that can be easily disabled as it was a design
goal that the TIGER/Line code be able to defer polygon assembly to later
stages in the FME processing pipeline when used in FME.  And Safe Software
funded all the TIGER/Line work.

I don't forsee having the time to do tiger polygon assembly myself within
the driver in the near future.  I have provided scripts (assemblypolygon.py)
that shows how it can be done as a utility translation step.

> And while I'm at it, what's the expected timeframe for integrating
> the OGR API into the GDAL API?  Does it make sense for me to be
> writing to the OGR API right now?  Will the OGR API go away at GDAL
> integration time?

There is no established timeline for OGR being more tightly integrated
into GDAL.  I would hope it would happen within a year, but that is by
no means certain.

Most of the OGR API will remain but code dealing with the OGRDriver, using
TestCapability() or possibly some interactions with the datasource and layer
classes will change a bit.  All the stuff from OGRFeature down will be
completely unchanged.

My goal is that most OGR applications can be migrated to the new API with
little or no source changes.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From route at cae.com  Wed Oct 20 14:10:29 2004
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] strange problem with ECW ( performance and quality) when
	getting 
	the scanlines from SizeY-1 to 0 instead of from 0 to SizeY-1
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D1CC@caemsx03.cae.ca>

Hi,

I faced a real strange problem with ecw.
You can reproduce it with gdal_translate modifying the code of
gdaldriver.cpp
I'm using GDAL 1.2.3.0, released 2004/08/25

First, get the testdata image from ERMapper (Greyscale.ecw)

1/ run gdal_translate.exe GreyScale.ecw output1.bmp -of BMP

2/ modify the code in gdaldriver.cpp line 333 (in the CreateCopy method)
from 	for( int iLine = 0; iLine < nYSize; iLine++ )
to	for( int iLine = nYSize-1; iLine >=0 ; iLine-- )

3/ recompile gdal

4/ run gdal_translate.exe GreyScale.ecw output2.bmp -of BMP

the second version is *a lot* slower, and the result is quite strange.

Do somebody has an idea what can be wrong ?

http://exotk.org/ecw/Greyscale.ecw
http://exotk.org/ecw/output1.bmp
http://exotk.org/ecw/output2.bmp


Thanks in advance,

Stephane Routelous




From sevilla_lui at gva.es  Wed Oct 20 14:30:50 2004
From: sevilla_lui at gva.es (Luis W. Sevilla)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Bands and overviews; BSB
Message-ID: <4176AEDA.9080802@gva.es>

Hi!

   I've two questions
       - how must use overviews on bands (MrSIG, Erdas .img) ?
       - how must user Control Points on BSB (.kap) to obtain
    georeferencing?

    Thanks in advance:

        Luis

-- 
  Luis W. Sevilla
  Equipo de desarrollo gvSIG
  http://www.gvsig.gva.es
  Conselleria de Infraestructures i Transport
  Generalitat Valenciana
  Valencia - Spain



From schuyler at nocat.net  Wed Oct 20 14:32:42 2004
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410200826260.10553@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
Message-ID: <20041020183242.GZ29226@vishnu.tridity.org>

* On 20-Oct-2004 at  8:22AM PDT, Curt, WE7U said:
> 
> Is there a chance that OGR will support TIGER/Line polygons at some
> point?  For that particular file format it looks like I'll have to
> do a lot of special coding just to get to the polygons, due to TIGER
> having represented them as polylines instead.  Seems OGR should hide
> the implementation details of various file formats from me, but in
> this case it doesn't.

Have you looked at the tigerpoly.py script that comes with GDAL in the
pymod/samples/ directory? Works great for me vis a vis extracting
polygons from TIGER/Line - the polygons are a little dirty, but
GRASS's v.clean fixes that up right away.

SDE

From warmerdam at pobox.com  Wed Oct 20 14:45:11 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] strange problem with ECW ( performance and quality)
	when	getting the scanlines from SizeY-1 to 0 instead of from 0 to
	SizeY-1
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D1CC@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D1CC@caemsx03.cae.ca>
Message-ID: <4176B237.3080201@pobox.com>

Stephane Routelous wrote:
> Hi,
> 
> I faced a real strange problem with ecw.
> You can reproduce it with gdal_translate modifying the code of
> gdaldriver.cpp
> I'm using GDAL 1.2.3.0, released 2004/08/25
> 
> First, get the testdata image from ERMapper (Greyscale.ecw)
> 
> 1/ run gdal_translate.exe GreyScale.ecw output1.bmp -of BMP
> 
> 2/ modify the code in gdaldriver.cpp line 333 (in the CreateCopy method)
> from 	for( int iLine = 0; iLine < nYSize; iLine++ )
> to	for( int iLine = nYSize-1; iLine >=0 ; iLine-- )
> 
> 3/ recompile gdal
> 
> 4/ run gdal_translate.exe GreyScale.ecw output2.bmp -of BMP
> 
> the second version is *a lot* slower, and the result is quite strange.

Stephane,

I don't know why the results are visually different.  I would guess this is a
problem the low level ECW SDK but we are calling it in a very peculiar way in
the 2nd case.

The reason things are much slower is that the ECW driver tries to guess
what you are going to want to read.  Within the GDAL ECW code, it needs to set
a "view window" on the ECW file.  This is a fairly expensive operation, so if
the application is asking for data one scanline at a time it is important that
we not set a one scanline view window each time.  So the code guesses that if
you are accessing one scanline that it should setup a view window that starts
at the requested scanline and continues down the image to the bottom at the
same resolution.  If your next request is for the next scanline it can just
get it from the ECW SDK.  If it is very different it will need to set a new
view window.

In the case of your altered code, each scanline requested results in a new
view being set (starting one line sooner), so it is very slow.

But this still doesn't explain the streakiness unless it is the nature of the
ECW decoder to experience mild artifacts at view window boundaries.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Wed Oct 20 15:37:08 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <20041020183242.GZ29226@vishnu.tridity.org>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<20041020183242.GZ29226@vishnu.tridity.org>
Message-ID: <Pine.SUN.4.58.0410201232110.13761@eskimo.com>

On Wed, 20 Oct 2004, Schuyler Erle wrote:

> Have you looked at the tigerpoly.py script that comes with GDAL in the
> pymod/samples/ directory? Works great for me vis a vis extracting
> polygons from TIGER/Line - the polygons are a little dirty, but
> GRASS's v.clean fixes that up right away.

Frank just put me onto that one.  I evidently haven't gotten the
correct invocation for it yet, as the resulting file included every
darn polyline in one county's TIGER set, not just the polygons!

Have a sample invocation that works for you?  Unfortunately I'm not
familiar with Python or I'd figure it out myself.  I'll still try to
anyway.

That will solve one problem we're having, which is the missing
polygons from TIGER 2003 data that's been converted to Shapefiles
for our project.

I still need to solve a second problem, which is how to display
polygons directly from raw TIGER data (not the shapefiles).  I'm
working on that one.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Wed Oct 20 15:47:33 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410201232110.13761@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>	<20041020183242.GZ29226@vishnu.tridity.org>
	<Pine.SUN.4.58.0410201232110.13761@eskimo.com>
Message-ID: <4176C0D5.2040901@pobox.com>

Curt, WE7U wrote:
> Have a sample invocation that works for you?  Unfortunately I'm not
> familiar with Python or I'd figure it out myself.  I'll still try to
> anyway.

Curt,

warmerda@gdal2200[226]% ~/gdal/pymod/samples/tigerpoly.py . poly.shp
OGR: Tiger Version Code=1102, Classified as TIGER_2002
OGR: OGROpen(.) succeeded (0xa1804f8).
ERROR 1: poly.shp does not appear to be a file or directory.
Got 31883 lines in 1 modules.
Processed 31883 links.
Built 10608 polygons.
warmerda@gdal2200[227]% rm poly.*
warmerda@gdal2200[228]% ~/gdal/pymod/samples/tigerpoly.py TGR06047.RT2
OGR: Tiger Version Code=1102, Classified as TIGER_2002
OGR: OGROpen(TGR06047.RT2) succeeded (0x955e7a8).
ERROR 1: poly.shp does not appear to be a file or directory.
Got 31883 lines in 1 modules.
Processed 31883 links.
Built 10608 polygons.

> 
> That will solve one problem we're having, which is the missing
> polygons from TIGER 2003 data that's been converted to Shapefiles
> for our project.
> 
> I still need to solve a second problem, which is how to display
> polygons directly from raw TIGER data (not the shapefiles).  I'm
> working on that one.

You can write C++ code that does essentially the same thing as the tigerpoly.py.
In particular, there is a C and C++ analog to the ogr.BuildPolygonFromEdges()
call used by that script.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Oct 20 15:55:38 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Bands and overviews; BSB
In-Reply-To: <4176AEDA.9080802@gva.es>
References: <4176AEDA.9080802@gva.es>
Message-ID: <4176C2BA.2090101@pobox.com>

Luis W. Sevilla wrote:
> Hi!
> 
>   I've two questions
>       - how must use overviews on bands (MrSIG, Erdas .img) ?

Luis,

You can build overviews for most file formats using the gdaladdo utility
or the corresponding BuildOverviews() method on the GDALDataset.  For most
formats the overviews are built as an external TIFF file given the extension
.ovr (a GDAL convention).

If you read data with the RasterIO() calls the overviews will be automatically
used to satisfy requests where your file window size is much larger than the
size of the buffer you are copying too.  You can also explicitly fetch the
overviews as GDALRasterBand objects and read from them.

>       - how must user Control Points on BSB (.kap) to obtain
>    georeferencing?

It is up to the application to decide how to use the GCPs to georeference
an image with GCPs.  Two common ways GDAL based applications approach this
are to derive an approximate affine transformation (with GDALGCPsToGeoTransform())
or to build higher order polynomials with the GDALCreateGCPTransformer().

For BSB files the approximate geotransform is usually ok if you accuracy needs
are not high.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From wlyons at prologic-inc.com  Wed Oct 20 16:32:28 2004
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] JasPer download
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DC93112@vader.prologic-inc.com>

Hi gdal list,

 

I am attempting to enable jpeg2000 support in my gdal build and tried to
download the "Modified version"
ftp://ftp.remotesensing.org/gdal/jasper-1.701.0.uuid.tar.gz

 

Is there a server issue or dead link or something?

 

Thanks,

 

William Lyons

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041020/2b93c2dc/attachment.html
From archer at eskimo.com  Wed Oct 20 16:45:43 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <4176C0D5.2040901@pobox.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<20041020183242.GZ29226@vishnu.tridity.org>
	<Pine.SUN.4.58.0410201232110.13761@eskimo.com>
	<4176C0D5.2040901@pobox.com>
Message-ID: <Pine.SUN.4.58.0410201344000.13761@eskimo.com>

On Wed, 20 Oct 2004, Frank Warmerdam wrote:

> warmerda@gdal2200[226]% ~/gdal/pymod/samples/tigerpoly.py . poly.shp

That's exactly the invocation that came the closest to working for
me, but with Tiger2003 data I ended up with a very large shapefile
that contained all of the roads, rivers, and lakes.


> You can write C++ code that does essentially the same thing as the tigerpoly.py.
> In particular, there is a C and C++ analog to the ogr.BuildPolygonFromEdges()
> call used by that script.

Yep, I'll work on something like that in C next, once I understand
what it's doing.

Thanks.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Wed Oct 20 16:39:50 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] JasPer download
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DC93112@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DC93112@vader.prologic-inc.com>
Message-ID: <4176CD16.2020101@pobox.com>

William Lyons wrote:
> Hi gdal list,
> 
>  
> 
> I am attempting to enable jpeg2000 support in my gdal build and tried to 
> download the ?Modified version? 
> ftp://ftp.remotesensing.org/gdal/jasper-1.701.0.uuid.tar.gz
> 
>  
> 
> Is there a server issue or dead link or something?

William,

The ftp.remotesensing.org server seems to be inaccessable today.  Grab it from
a mirror:

   http://gdal.org/dl/jasper-1.701.0.uuid.tar.gz

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Oct 20 17:01:44 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410201344000.13761@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<20041020183242.GZ29226@vishnu.tridity.org>
	<Pine.SUN.4.58.0410201232110.13761@eskimo.com>
	<4176C0D5.2040901@pobox.com>
	<Pine.SUN.4.58.0410201344000.13761@eskimo.com>
Message-ID: <4176D238.806@pobox.com>

Curt, WE7U wrote:
> On Wed, 20 Oct 2004, Frank Warmerdam wrote:
> 
> 
>>warmerda@gdal2200[226]% ~/gdal/pymod/samples/tigerpoly.py . poly.shp
> 
> 
> That's exactly the invocation that came the closest to working for
> me, but with Tiger2003 data I ended up with a very large shapefile
> that contained all of the roads, rivers, and lakes.

Curt,

You ended up with all the roads, rivers and lakes as just line features,
not polygons?  That would be really weird.  Of course, the resulting polygons
are going to have all the roads, rivers and lakes as their borders.  It is a
topological coverage for the area in questions.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Wed Oct 20 17:41:11 2004
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <4176D238.806@pobox.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<20041020183242.GZ29226@vishnu.tridity.org>
	<Pine.SUN.4.58.0410201232110.13761@eskimo.com>
	<4176C0D5.2040901@pobox.com>
	<Pine.SUN.4.58.0410201344000.13761@eskimo.com> <4176D238.806@pobox.com>
Message-ID: <Pine.SUN.4.58.0410201434000.13761@eskimo.com>

On Wed, 20 Oct 2004, Frank Warmerdam wrote:

> >>warmerda@gdal2200[226]% ~/gdal/pymod/samples/tigerpoly.py . poly.shp

> You ended up with all the roads, rivers and lakes as just line features,
> not polygons?  That would be really weird.  Of course, the resulting polygons
> are going to have all the roads, rivers and lakes as their borders.  It is a
> topological coverage for the area in questions.

  > shpinfo poly
  Info for poly
  Polygon(5), 12155 Records in file
  File Bounds: (              0,              0)
          (    -120.906211,      48.299232)


I end up with a LOT of polygons.  Upon drawing that shapefile
polygon file to my display it looks very similar to what it would
look like if I had drawn all of the individual line features from
multiple layers of the original raw tiger file.  So far I'm no
closer to getting a Shapefile with just the lake polygons in it.
I'll keep studying the TIGER docs and the Python script and will
learn more about it.

--
Curt, WE7U			         http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From mcoletti at gmail.com  Wed Oct 20 18:18:45 2004
From: mcoletti at gmail.com (Mark Coletti)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Problem with reading GXF files?
Message-ID: <1200950804102015185c3f55c5@mail.gmail.com>

I'm having difficulties reading a GXF file in qgis.  Part of the
problem seems to be in calculating the minimum and maximum values.

For example:

qgsrasterlayer.cpp : 2062 myGdalBand->GetMinimum() failed
qgsrasterlayer.cpp : 2070 myGdalBand->GetMaximum() failed
GDALminium:     -4.29497e+09
GDALmaxium:     4.29497e+09

By "failed" I mean that the pbSuccess flag was set to zero with each
of those function calls.  However, the documentation for those
functions is a bit unclear as to exactly what it means with the
pbSuccess flag is zero.

pbSuccess:
    pointer to a boolean to use to indicate if the returned value
    is a tight maximum or not. May be NULL (default).

What is a "tight maximum?"

I've made the test file available at:

http://lychnobite.org/qgis/grvcba_gxf.gz:

Cheers,

Mark
-- 
I'm taking reality in small doses to build immunity.

From warmerdam at pobox.com  Wed Oct 20 18:50:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Problem with reading GXF files?
In-Reply-To: <1200950804102015185c3f55c5@mail.gmail.com>
References: <1200950804102015185c3f55c5@mail.gmail.com>
Message-ID: <4176EBA9.6020407@pobox.com>

Mark Coletti wrote:
> I'm having difficulties reading a GXF file in qgis.  Part of the
> problem seems to be in calculating the minimum and maximum values.
> 
> For example:
> 
> qgsrasterlayer.cpp : 2062 myGdalBand->GetMinimum() failed
> qgsrasterlayer.cpp : 2070 myGdalBand->GetMaximum() failed
> GDALminium:     -4.29497e+09
> GDALmaxium:     4.29497e+09
> 
> By "failed" I mean that the pbSuccess flag was set to zero with each
> of those function calls.  However, the documentation for those
> functions is a bit unclear as to exactly what it means with the
> pbSuccess flag is zero.
> 
> pbSuccess:
>     pointer to a boolean to use to indicate if the returned value
>     is a tight maximum or not. May be NULL (default).
> 
> What is a "tight maximum?"

Mark,

The methods GetMinimum() and GetMaximum() are supposedly guaranteed
to return a minimum value less than or equal to all actual pixels values, and
GetMaximum() gets a value >= all pixel values.

If the format intrinsicly knows the min and max of the pixels these values
are returned, otherwise the min and max for the data type is returned.  So a
tight min/max means they are tightest range for the pixel data.  But if we
can only return the min/max for the data type (ie 0-65535 for UInt16) then
then the success flag is returned FALSe.

It sounds like things are working properly.

You might want to look at GDALComputeRasterMinMax().

   http://www.gdal.org/gdal_8h.html#a144

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From schuyler at nocat.net  Wed Oct 20 18:48:20 2004
From: schuyler at nocat.net (Schuyler Erle)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.SUN.4.58.0410201434000.13761@eskimo.com>
References: <Pine.LNX.4.44.0410181709540.29582-100000@wapiti>
	<Pine.SUN.4.58.0410200826260.10553@eskimo.com>
	<20041020183242.GZ29226@vishnu.tridity.org>
	<Pine.SUN.4.58.0410201232110.13761@eskimo.com>
	<4176C0D5.2040901@pobox.com>
	<Pine.SUN.4.58.0410201344000.13761@eskimo.com>
	<4176D238.806@pobox.com>
	<Pine.SUN.4.58.0410201434000.13761@eskimo.com>
Message-ID: <20041020224820.GA29226@vishnu.tridity.org>

* On 20-Oct-2004 at  2:33PM PDT, Curt, WE7U said:
> 
> I end up with a LOT of polygons.  Upon drawing that shapefile
> polygon file to my display it looks very similar to what it would
> look like if I had drawn all of the individual line features from
> multiple layers of the original raw tiger file. 

Yes, that is what you get - TIGER/Line, frankly, contains a lot of
polygons! If you do a topological cleanup - removing spurs and bridges
and so on - you get the actual polygons, one per census block - which
is typically a pretty small area.  Like I said earlier, I use GRASS
for this.

> So far I'm no closer to getting a Shapefile with just the lake
> polygons in it.  I'll keep studying the TIGER docs and the Python
> script and will learn more about it.

The one thing tigerpoly.py doesn't do is connect area landmarks with
the polygons - I've been pondering how to do this. However, if hydro
features are all you're after, you can try selecting and merging the
polygons from TIGER/Line that have a ZCTA5 attribute ending in 'HH' -
this seems to select all of the water polygons in my vector layers.

SDE

From Mike.Elstermann at itc-halle.de  Thu Oct 21 05:15:56 2004
From: Mike.Elstermann at itc-halle.de (Elstermann, Mike)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] DGN2SHAPE - problems with annotations/text
Message-ID: <8BC0EAF5B383D711B69E0006293896C701756F5B@ZEVHNT6>


hi,
I'm a gdal-beginner.

my first problem:
I have DGN-Files an I want to convert these to ESRI-Shape-Files.
I try:
/usr/local/bin/ogr2ogr -skipfailures -f "ESRI Shapefile" -nlt POLYGON \
   /susepool2/xxxpolygon.shp /test.dgn
/usr/local/bin/ogr2ogr -skipfailures -f "ESRI Shapefile" -nlt LINESTRING \
   /susepool2/xxxline.shp /test.dgn
/usr/local/bin/ogr2ogr -skipfailures -f "ESRI Shapefile" -nlt POINT \
   /susepool2/xxxpoint.shp /test.dgn

the results are ok, but who can I get annotations/text in the shapes.

A look into the DGNs with ArcView show me the annotations/text right.
where is the trick?

F?r R?ckfragen stehe ich Ihnen gern zur Verf?gung.

::: mfg. Mike Elstermann [mikeE.], Teamleiter GIS/e-Solutions
::: IT-Consult Halle GmbH, Bornknechtstra?e 5, 06108 Halle (Saale)
::: Tel.: +49 345 581 7128, Fax: +49 345 581 1737, mobil: +49 160 71 545 02
::: mike.elstermann@itc-halle.de ::: http://www.itc-halle.de
::: GeoDaten Online? -> http://halgis.halle.de; http://umweltatlas.halle.de


From chris at alchemedia.jp  Thu Oct 21 08:07:04 2004
From: chris at alchemedia.jp (Chris Campbell)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp,
	using GCPs with pixel positions outside the input image
Message-ID: <000c01c4b766$7b1ad600$5200a8c0@chris>

Hi

I am generating very large images which I rectify with gdalwarp, using 
lat-lon GCPs. Because of the size of the input images, it is much more 
practical to generate them in smaller sections, but I want each one of these 
smaller images to go through the same transformation as it it's 
corresponding part of the larger image would. Since the only pixel values 
for the GCPs I have are relative to the large image, and I want to use all 
available GCPs, I tried warping the smaller images by adding an offset to 
the pixel value depending on where the smaller image is within the large 
image..... of course this gives me some pixel values outside the image to be 
warped.
For example say my large image would be 50,000x50,000 pixels with GCPs 
spread fairly evenly through it. I generate a 2000x2000 section of it that 
covers the area say from (bottomleft-topright) 6000,6000 - 8000,8000. Now I 
warp this using GCPs which have their pixel values shifted by -6000,-6000. 
The GCPs that had pixel values less than 6000 will now be negative, and GCPs 
that had pixel values above 8000 likewise will not actually be in the image 
to be warped..... hope this all makes sense!
Anyway, this method runs fine and without errors etc, but the small 
rectified file is just not _quite_ the same as it's corresponding section in 
the large file. It is very close, but seems to have different coefficients 
for the warping calcluation.
So my question is, does using GCPs with pixel positions outside the image to 
be warped screw up the transformation?
Thanks for any comments....
Chris



From warmerdam at pobox.com  Thu Oct 21 09:20:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp,	using GCPs with pixel positions outside
	the input image
In-Reply-To: <000c01c4b766$7b1ad600$5200a8c0@chris>
References: <000c01c4b766$7b1ad600$5200a8c0@chris>
Message-ID: <4177B7AA.9070503@pobox.com>

Chris Campbell wrote:
> So my question is, does using GCPs with pixel positions outside the 
> image to be warped screw up the transformation?
> Thanks for any comments....

Chris,

I think your approach is correct and the problem is likely due to
inaccuracies and differing round-off errors in the polynomial calculation
code.  What order polynmomial are you using?   In general I am not impressed
with the numerical quality of the GDAL polynomial solver and transformer.

I'm not really sure why you need to do things in chunks though.  GDAL warp
is intended to be usable for large images, and I have personally processed
images up to 40GB without any apparent issues other than that it takes quite
a while.  It should scale up to hundreds of GB images at least.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From chris at alchemedia.jp  Thu Oct 21 22:52:00 2004
From: chris at alchemedia.jp (Chris Campbell)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp,
	using GCPs with pixel positions outside the input image
References: <000c01c4b766$7b1ad600$5200a8c0@chris> <4177B7AA.9070503@pobox.com>
Message-ID: <005a01c4b7e2$1aa5c560$5200a8c0@chris>


> I think your approach is correct and the problem is likely due to
> inaccuracies and differing round-off errors in the polynomial calculation
> code.  What order polynmomial are you using?   In general I am not 
> impressed
> with the numerical quality of the GDAL polynomial solver and transformer.

I see... I am using order = 1.

> I'm not really sure why you need to do things in chunks though.  GDAL warp
> is intended to be usable for large images, and I have personally processed
> images up to 40GB without any apparent issues other than that it takes 
> quite
> a while.  It should scale up to hundreds of GB images at least.

I thought this might be pointed out :)
The scalability problem is not with gdal but with the generation process, 
which needs more than a reasonable amount of memory to generate a 
50,000x50,000 pixel image. I can generate it in smaller tiles and then join 
these together in a much less memory demanding way and then warp, but it 
takes a long time and a lot of redundant disk space until I can finally get 
a look at some rectified output.
I don't know too much about these kind of matrices, but is it possible to 
calculate the transformation coefficients using the original set of GCPs and 
then alter some values in the matrix to get a desired pixel offset?

Chris 



From warmerdam at pobox.com  Fri Oct 22 09:21:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp,	using GCPs with pixel positions outside
	the input image
In-Reply-To: <005a01c4b7e2$1aa5c560$5200a8c0@chris>
References: <000c01c4b766$7b1ad600$5200a8c0@chris> <4177B7AA.9070503@pobox.com>
	<005a01c4b7e2$1aa5c560$5200a8c0@chris>
Message-ID: <4179095B.8030404@pobox.com>

Chris Campbell wrote:
> 
>> I think your approach is correct and the problem is likely due to
>> inaccuracies and differing round-off errors in the polynomial calculation
>> code.  What order polynmomial are you using?   In general I am not 
>> impressed
>> with the numerical quality of the GDAL polynomial solver and transformer.
> 
> 
> I see... I am using order = 1.

Chris,

Well, it is hard to imagine that first order would have significant
computational difference based on a shift.   This should be the most
stable case.


> I thought this might be pointed out :)
> The scalability problem is not with gdal but with the generation 
> process, which needs more than a reasonable amount of memory to generate 
> a 50,000x50,000 pixel image. I can generate it in smaller tiles and then 
> join these together in a much less memory demanding way and then warp, 
> but it takes a long time and a lot of redundant disk space until I can 
> finally get a look at some rectified output.
> I don't know too much about these kind of matrices, but is it possible 
> to calculate the transformation coefficients using the original set of 
> GCPs and then alter some values in the matrix to get a desired pixel 
> offset?

Of course it is, in theory, possible to do this.  But it is the nature of
object encapsulation that makes this somewhat hard to accomplish in practice.
Note that the matrix is never stored anywhere.  It is generated in memory from
the GCPs by gdalwarp.  You could write an altered gdalwarp that uses a under
defined transformation that takes care of applying offsets before in turn
calling the normal GCP based transformer, but this would require a bunch of
programming.

All told though, I am surprised you are even running into a noticable problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Fri Oct 22 10:05:40 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] HDF4 Driver
Message-ID: <6.1.1.1.0.20041022154140.02385a40@pop3>

Hi,

I've some questions about the HDF4 support on GDAL (on Win32, Solaris and 
Linux) :

- HDF library use libjpeg and libzip I believe : should I compile them 
separately, or should/can I use the jpeg and zip library embedded and used 
internally by GDAL ? (there aren't conflicts between libjpeg/zip used by 
HDFlib and libjpeg/zip used internally by GDAL ?)

- I read on the mailing list some problem with reading HDF4 Aster file 
georeferencing and I've just tested with OpenEV_FW_182 with theses files :
ftp://e0dps01u.ecs.nasa.gov/ASTT/AST_L1B.003/2000.03.10/
I can read data, but not the georeferencing.
Are there plans to solve these problems with Aster files ?


Thanks in advance,

Julien


From chen at yinyue123.com  Fri Oct 22 08:35:09 2004
From: chen at yinyue123.com (Fu Chen)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Can gdal help get proj4 string from geotiff?
In-Reply-To: <4177B7AA.9070503@pobox.com>
Message-ID: <HLENLPCAGDEHMNMNLIDJEECDCIAA.chen@yinyue123.com>

Hi!
I am designing a program to show a lot of raster images on webgis mapserver. And I try to set the map projection as the projection of  the raster file.
My idea is to dynamicly generate a map file or dynamicly change some part of mapfile by php mapscript.
But they all need to get a PROJ4 PROJECTION description like

  "proj=tmerc"
  "ellps=WGS84"
  "lon_0=117"
  "x_0=500000"

from the information inside raster images such like geotiff.
Can GDAL api help me?

Any idea?
Thank you!
From hrz at geodata.soton.ac.uk  Fri Oct 22 11:10:24 2004
From: hrz at geodata.soton.ac.uk (hrz@geodata.soton.ac.uk)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20041022140519.AA6173E7EE7@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041022/b5cb875c/attachment.wav
From warmerdam at pobox.com  Fri Oct 22 10:28:53 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] HDF4 Driver
In-Reply-To: <6.1.1.1.0.20041022154140.02385a40@pop3>
References: <6.1.1.1.0.20041022154140.02385a40@pop3>
Message-ID: <41791925.2080606@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> I've some questions about the HDF4 support on GDAL (on Win32, Solaris 
> and Linux) :
> 
> - HDF library use libjpeg and libzip I believe : should I compile them 
> separately, or should/can I use the jpeg and zip library embedded and 
> used internally by GDAL ? (there aren't conflicts between libjpeg/zip 
> used by HDFlib and libjpeg/zip used internally by GDAL ?)

Julien,

I was able to build against the HDF DLL which I think had an embedded
copy of libjpeg and libzip.  This seemed to work even though a heap
of code was duplicated.

Since then I wanted to build the HDF library with /MD (and without the
pseudo netcdf interface), so I did it all from the original source, building
libz and libjpeg seperately.  This was a nightmare of a job, possibly
because I approached it wrong, but I would caution against trying it unless
you have a strong need.

Note that copies of code in different DLLs is often not a bit issue on
windows as long as it isn't exported from the DLL.

Ahh, I see you are interested in solaris and linux too. I think on these
platforms the HDF libraries are willing to use external copies of libz and
libjpeg.  I have it built and it seems to be working ok.  However, on these
platforms (linux at least) duplicate copies of a library linked into the
same executable can be quite bad.

Hmm, I don't know if I have really helped very much.

I'll leave the question about georeferencing fixes to Andrey.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Oct 22 11:01:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Can gdal help get proj4 string from geotiff?
In-Reply-To: <HLENLPCAGDEHMNMNLIDJEECDCIAA.chen@yinyue123.com>
References: <HLENLPCAGDEHMNMNLIDJEECDCIAA.chen@yinyue123.com>
Message-ID: <417920B8.6080603@pobox.com>

Fu Chen wrote:
> Hi!
> I am designing a program to show a lot of raster images on webgis mapserver. And I try to set the map projection as the projection of  the raster file.
> My idea is to dynamicly generate a map file or dynamicly change some part of mapfile by php mapscript.
> But they all need to get a PROJ4 PROJECTION description like
> 
>   "proj=tmerc"
>   "ellps=WGS84"
>   "lon_0=117"
>   "x_0=500000"
> 
> from the information inside raster images such like geotiff.
> Can GDAL api help me?

Fu Chen,

The OGRSpatialReference class can be used to convert OpenGIS WKT
coordinate system definitions into PROJ.4 format.  OGC WKT is what
is returned by the GDALDataset::GetProjectionRef() method.  Briefly,
you would call importFromWkt() to apply the WKT definition from the
dataset to an OGRSpatialReference, and then exportToProj4() to convert
into a proj.4 string.

Note that this would result in something like "+proj=utm +zone=11 +datum=WGS84"
which you can use directly in MapServer.  You don't need to split things into
a bunch of subentries.

PROJECTION
   "+proj=utm +zone=11 +datum=WGS84"
END

is how I always define projections in MapServer.

Note that while there is a PHP OGR API, I don't *think* it includes all the
OGRSpatialReference stuff, and it doesn't include GDAL, so you will need to
do this from C, C++ or Python.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From publi at infonegocio.com  Fri Oct 22 14:33:28 2004
From: publi at infonegocio.com (publi@infonegocio.com)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] problems with shapefiles produced with fme translator
Message-ID: <41795278.3060505@infonegocio.com>

Hi all,
   I'm working in a city map, and i have an autocad files with all 
information. I'm using fme to translate AutoCad -> Shapefile, but i have 
a problem. Fme work perfectly and i can see all the files generated by 
it with ForestyGis, Arcview 3.3 and MapMaker 3.5. But when i copy this 
file to linux and i try to do "#ogrinfo -al Textos1_line.shp", the 
result is the next:
           Unable to open datasource 'Textos1_line.shp with the 
following drivers:
         -> ESRI Shapefile
         -> UK .NTF
         ..........
         ..........

   When i make shapefile with ArcView, no problem, ogrinfo works, and i 
can see it with mapserver. But when the shapefile was maden with fme, it 
doesn't work. The file produced by fme have 13888 features and the .shp 
file have 2.34 MB, Are too many????. I have installed gdal-1.2.3 and i'm 
working with mapserver 4.2.5 and Maplab 2.2. Why can i see it with gdal 
and OGR??????????. Thanks to all.


From ed at topozone.com  Fri Oct 22 14:35:07 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] problems with shapefiles produced with fme translator
Message-ID: <F45FD794-E2BD-4003-AAD7-B2F4517B27B4@topozone.com>

Are you copying all three components of the shapefile - the .shp, .dbf, and .shx files?  A shapefile isn't only one file.

	- Ed

Ed McNierney
TopoZone.com 

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of publi@infonegocio.com
Sent: Friday, October 22, 2004 2:33 PM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] problems with shapefiles produced with fme translator

Hi all,
   I'm working in a city map, and i have an autocad files with all information. I'm using fme to translate AutoCad -> Shapefile, but i have a problem. Fme work perfectly and i can see all the files generated by it with ForestyGis, Arcview 3.3 and MapMaker 3.5. But when i copy this file to linux and i try to do "#ogrinfo -al Textos1_line.shp", the result is the next:
           Unable to open datasource 'Textos1_line.shp with the following drivers:
         -> ESRI Shapefile
         -> UK .NTF
         ..........
         ..........

   When i make shapefile with ArcView, no problem, ogrinfo works, and i can see it with mapserver. But when the shapefile was maden with fme, it doesn't work. The file produced by fme have 13888 features and the .shp file have 2.34 MB, Are too many????. I have installed gdal-1.2.3 and i'm working with mapserver 4.2.5 and Maplab 2.2. Why can i see it with gdal and OGR??????????. Thanks to all.

_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Fri Oct 22 15:08:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] problems with shapefiles produced with fme translator
In-Reply-To: <41795278.3060505@infonegocio.com>
References: <41795278.3060505@infonegocio.com>
Message-ID: <41795AB2.5020607@pobox.com>

publi@infonegocio.com wrote:
> Hi all,
>   I'm working in a city map, and i have an autocad files with all 
> information. I'm using fme to translate AutoCad -> Shapefile, but i have 
> a problem. Fme work perfectly and i can see all the files generated by 
> it with ForestyGis, Arcview 3.3 and MapMaker 3.5. But when i copy this 
> file to linux and i try to do "#ogrinfo -al Textos1_line.shp", the 
> result is the next:
>           Unable to open datasource 'Textos1_line.shp with the following 
> drivers:
>         -> ESRI Shapefile
>         -> UK .NTF
>         ..........
>         ..........
> 
>   When i make shapefile with ArcView, no problem, ogrinfo works, and i 
> can see it with mapserver. But when the shapefile was maden with fme, it 
> doesn't work. The file produced by fme have 13888 features and the .shp 
> file have 2.34 MB, Are too many????. I have installed gdal-1.2.3 and i'm 
> working with mapserver 4.2.5 and Maplab 2.2. Why can i see it with gdal 
> and OGR??????????. Thanks to all.

Hi,

I think you will need to make the files in question available for me to
diagnose the problem.  Submitting by bugzilla should be fine for that
amount of data.  Just submit the .shp, .shx, and .dbf along with a
description of the issue.

Thanks,

---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fniles at mitre.org  Fri Oct 22 17:20:18 2004
From: fniles at mitre.org (fniles@mitre.org)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20041022201513.2DA553EB1D1@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041022/937a191a/attachment.wav
From publi at infonegocio.com  Sat Oct 23 06:19:04 2004
From: publi at infonegocio.com (publi@infonegocio.com)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] problems with shapefiles produced with fme translator
In-Reply-To: <F45FD794-E2BD-4003-AAD7-B2F4517B27B4@topozone.com>
References: <F45FD794-E2BD-4003-AAD7-B2F4517B27B4@topozone.com>
Message-ID: <417A3018.5090804@infonegocio.com>

Hi Ed,
    Yes, i have copied .shp, .dbf and .shx. Thanks.

Ed McNierney wrote:

>Are you copying all three components of the shapefile - the .shp, .dbf, and .shx files?  A shapefile isn't only one file.
>
>	- Ed
>
>Ed McNierney
>TopoZone.com 
>
>-----Original Message-----
>From: gdal-dev-bounces@xserve.flids.com [mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of publi@infonegocio.com
>Sent: Friday, October 22, 2004 2:33 PM
>To: gdal-dev@xserve.flids.com
>Subject: [Gdal-dev] problems with shapefiles produced with fme translator
>
>Hi all,
>   I'm working in a city map, and i have an autocad files with all information. I'm using fme to translate AutoCad -> Shapefile, but i have a problem. Fme work perfectly and i can see all the files generated by it with ForestyGis, Arcview 3.3 and MapMaker 3.5. But when i copy this file to linux and i try to do "#ogrinfo -al Textos1_line.shp", the result is the next:
>           Unable to open datasource 'Textos1_line.shp with the following drivers:
>         -> ESRI Shapefile
>         -> UK .NTF
>         ..........
>         ..........
>
>   When i make shapefile with ArcView, no problem, ogrinfo works, and i can see it with mapserver. But when the shapefile was maden with fme, it doesn't work. The file produced by fme have 13888 features and the .shp file have 2.34 MB, Are too many????. I have installed gdal-1.2.3 and i'm working with mapserver 4.2.5 and Maplab 2.2. Why can i see it with gdal and OGR??????????. Thanks to all.
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev
>
>
>
>  
>



From r.beck at m4com.de  Sun Oct 24 14:25:47 2004
From: r.beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGRSpatialReference: ERROR 1: geocentric transformation
 missing z or ellps
Message-ID: <417BF3AB.4080304@m4com.de>

Hello,

I try to transform WGS84 Lat/Long coordinates to the swiss coordinate 
system (Swiss Oblique Cylindrical) (see 
www.remotesensing.org/geotiff/proj_list/swiss_oblique_cylindrical.html.)

Using the OGRCoordinateTransformation Object produces the following 
error: ERROR 1: geocentric transformation missing z or ellps.

- the GDAL_DATA environment is set (see below)
- the PROJ_LIB environment is set (see below) (I tried with and without 
this env variable, is it needed?)

- I use GDAL 1.2.3 downloaded last friday (October, 22 2004)
- I use proj4 4.4.8 downloaded today (October, 24 2004) (not sure if 
GDAL uses an intenal copy)
- I tried to link proj.4 statically into GDAL 
(--with-static-proj4=/opt/m4com/util/lib/) and without this option
- Everything is installed into the directory "/opt/m4com/util"

The funny thing is, I upgraded Proj.4 because the second (LV95) 
transformation didn't work (the LV03 did, before upgrading to the latest 
versions ...).
With the new versions, unsetting the GDAL_DATA environment variable will 
produce the correct? output for the LV03 transformation (with the GEOGCS 
part missing in the WKT), while the LV95 still doesn't work. (Result in 
this case: Swiss Geo: LV03: 7.4189 46.6358 0 -> 598416 164808 0ERROR 1: 
latitude or longitude exceeded limits)

Any ideas?
Thanks!

Reiner

Here's the code:
--- code ---
...
OGRCoordinateTransformation* toSwissLV03 = NULL;
OGRCoordinateTransformation* toSwissLV95 = NULL;
OGRSpatialReference wgs84SR;
char* sw;
char* wg;

      wgs84SR.SetWellKnownGeogCS("WGS84");
      wgs84SR.exportToWkt(&wg);
      cerr << "OGRSpatialReference WGS84: " << wg << endl;

      OGRSpatialReference swissSR;
      swissSR.SetProjCS("Schweizer Landeskoordinaten LV03");
      swissSR.SetWellKnownGeogCS("EPSG:4149");
      swissSR.SetHOM(46.95240555555556, 7.439583333333333, 90.0, 90.0, 
1.0, 600000, 200000);

      swissSR.exportToWkt(&sw);
      cerr << "OGRSpatialReference LV03: " << sw << endl;
      toSwissLV03 = OGRCreateCoordinateTransformation(&wgs84SR, &swissSR);

      swissSR.SetProjCS("Schweizer Landeskoordinaten LV95");
      swissSR.SetWellKnownGeogCS("EPSG:4150");
      swissSR.SetHOM(46.95240555555556, 7.439583333333333, 90.0, 90.0, 
1.0, 2600000, 1200000);

      swissSR.exportToWkt(&sw);
      cerr << "OGRSpatialReference LV95: " << sw << endl;
      toSwissLV95 = OGRCreateCoordinateTransformation(&wgs84SR, &swissSR);
  
   VisCoordGeo3d swissGeo = geoOut;
   cerr << "Swiss Geo: LV03: " << swissGeo;
   if ((toSwissLV03) && (toSwissLV03->Transform(1, &swissGeo.geoLong, 
&swissGeo.geoLat, &swissGeo.height) == TRUE))
      cerr << " -> " << swissGeo;
   else
      cerr << "FAIL";
   if ((toSwissLV95) && (toSwissLV95->Transform(1, &swissGeo.geoLong, 
&swissGeo.geoLat, &swissGeo.height) == TRUE))
      cerr << " LV95 -> " << swissGeo;
   else
      cerr << "FAIL";
   cerr << endl;
...
--- code ---
(Note: the structure VisCoordGeo3d contains 3 doubles geoLong, geoLat, 
and height)

The output for the OGRSpatialReference's is:
OGRSpatialReference WGS84:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],
        TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],
        
UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG","4326"]]

OGRSpatialReference LV03:
PROJCS["Schweizer Landeskoordinaten LV03",
    GEOGCS["CH1903",
        DATUM["CH1903",
            SPHEROID["Bessel 
1841",6377397.155,299.1528128,AUTHORITY["EPSG","7004"]],AUTHORITY["EPSG","6149"]],
        PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],
        
UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4149"]],
    PROJECTION["Hotine_Oblique_Mercator"],
        PARAMETER["latitude_of_center",46.95240555555556],
        PARAMETER["longitude_of_center",7.439583333333333],
        PARAMETER["azimuth",90],
        PARAMETER["rectified_grid_angle",90],
        PARAMETER["scale_factor",1],
        PARAMETER["false_easting",600000],
        PARAMETER["false_northing",200000]]

OGRSpatialReference LV95:
PROJCS["Schweizer Landeskoordinaten LV95",
    GEOGCS["CH1903+",
        DATUM["CH1903",
            SPHEROID["Bessel 
1841",6377397.155,299.1528128,AUTHORITY["EPSG","7004"]],
            
TOWGS84[674.374,15.056,405.346,0,0,0,0],AUTHORITY["EPSG","6150"]],
        PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],
        
UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4150"]],
    PROJECTION["Hotine_Oblique_Mercator"],
        PARAMETER["latitude_of_center",46.95240555555556],
        PARAMETER["longitude_of_center",7.439583333333333],
        PARAMETER["azimuth",90],
        PARAMETER["rectified_grid_angle",90],
        PARAMETER["scale_factor",1],
        PARAMETER["false_easting",2600000],
        PARAMETER["false_northing",1200000]]

Using the OGRCoordinateTransformation object produces the following error:
Swiss Geo: LV03: 10.5249 43.9997 0
ERROR 1: geocentric transformation missing z or ellps
FAIL
ERROR 1: geocentric transformation missing z or ellps
FAIL

An "ls $GDAL_DATA" produces the follwoing output:
cubewerx_extra.wkt  epsg.wkt        gdal_datum.csv  prime_meridian.csv  
s57expectedinput.csv  seed_3d.dgn
ecw_cs.dat          esri_extra.wkt  gdalicon.png    projop_wparm.csv    
s57objectclasses.csv  stateplane.csv
ellipsoid.csv       gcs.csv         pcs.csv         s57attributes.csv   
seed_2d.dgn           unit_of_measure.csv

A "ls $PROJ_LIB" produces the follwoing output:
epsg  esri  GL27  nad27  nad83  nad.lst  proj_def.dat  world


From r.beck at m4com.de  Mon Oct 25 09:59:56 2004
From: r.beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGRSpatialReference: ERROR 1: geocentric transformation
	missing z or ellps
In-Reply-To: <417BF3AB.4080304@m4com.de>
References: <417BF3AB.4080304@m4com.de>
Message-ID: <417D06DC.5080402@m4com.de>

Hello List,

digging further into the reported problem, it appears that the 
previously reported error was due to naming conflicts between a method 
in the Proj.4 Library and another lib on my system (geotrans). The 
function "Set_Geocentric_Parameters(double, double)" is apparently 
defined in both libraries. (It seems that the Proj.4 code originates 
from the geotrans code.)  And the executable used the wrong version ...

- Is it possible to introduce a name space (at least for C++ users) and 
the Proj.4 library/functions?

- In addition to that, there's an issue with the Proj.4 lib creation:
  The README states: "Programmers may use projection library with calls 
to pj_init, pj_fwd, pj_inv and pj_transform."
  However, the shared library does not contain those functions. I have 
to manually add the objects (geod_inv.lo geod_set.lo geod_for.lo) to the 
"libproj_la_LIBADD" parameter ...

Cheers
Reiner

-- 
Reiner Beck
M4Com
Gesch?ftsf?hrer
Forsthof 1
88682 Salem
Tel.: +49 (0) 7553 / 9175-20
Fax.: +49 (0) 7553 / 9175-29
Mail: R.Beck@m4com.de

From warmerdam at pobox.com  Mon Oct 25 10:29:29 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGRSpatialReference: ERROR 1: geocentric transformation
	missing z or ellps
In-Reply-To: <417D06DC.5080402@m4com.de>
References: <417BF3AB.4080304@m4com.de> <417D06DC.5080402@m4com.de>
Message-ID: <417D0DC9.2090205@pobox.com>

Reiner Beck wrote:
> Hello List,
> 
> digging further into the reported problem, it appears that the 
> previously reported error was due to naming conflicts between a method 
> in the Proj.4 Library and another lib on my system (geotrans). The 
> function "Set_Geocentric_Parameters(double, double)" is apparently 
> defined in both libraries. (It seems that the Proj.4 code originates 
> from the geotrans code.)  And the executable used the wrong version ...
> 
> - Is it possible to introduce a name space (at least for C++ users) and 
> the Proj.4 library/functions?

Reiner,

Yikes!  Sorry about that.  I have added a pj_ prefix for all the functions
in geocent.c.  This will be in the next release.

> - In addition to that, there's an issue with the Proj.4 lib creation:
>  The README states: "Programmers may use projection library with calls 
> to pj_init, pj_fwd, pj_inv and pj_transform."
>  However, the shared library does not contain those functions. I have to 
> manually add the objects (geod_inv.lo geod_set.lo geod_for.lo) to the 
> "libproj_la_LIBADD" parameter ...

I don't understand.  The geod_ files are for geodetic distance calculations.
I'm not sure what they have to do with pj_init, pj_fwd, pj_inv and pj_transform.
Are you saying that functions like pj_init() don't make it into your library
unless you add the geod files?  I find this very surprising, and I will need
more information on this before I can do anything.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From MChapman at sanz.com  Mon Oct 25 11:23:48 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ESRI projection (prj) format problems
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFE0A@mailman.san.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: prj.zip
Type: application/x-zip-compressed
Size: 1029 bytes
Desc: prj.zip
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041025/6800cf23/prj.bin
From lorenzo.sassolini at maior.it  Fri Oct 22 12:00:33 2004
From: lorenzo.sassolini at maior.it (Lorenzo Maior.it)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Memory leak in OCI
Message-ID: <BD9EFB41.1111%lorenzo.sassolini@maior.it>



Hello,
I've used the standard loop:

    while ((aOGRFeatureH = OGR_L_GetNextFeature(aLayerH)) != NULL)
        OGR_F_Destroy(aOGRFeatureH);

with an OCILayer containing only geometries of type "wkbLineString".

It seams that memory isn't freed.
 
If I read the same geometries with the same loop but from a shapefile I
don't have any memory problem.

Do anyone know the problem?
Thanks!

Lorenzo


-- 
Lorenzo Sassolini
Lorenzo.Sassolini@maior.it

Maior srl
Via XXIV Maggio, 3 
50100 Firenze (ITALY)
Tel. +39 055 482959
Fax. +39 055 476891
info@maior.it
http://www.maior.it



From warmerdam at pobox.com  Mon Oct 25 13:04:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Memory leak in OCI
In-Reply-To: <BD9EFB41.1111%lorenzo.sassolini@maior.it>
References: <BD9EFB41.1111%lorenzo.sassolini@maior.it>
Message-ID: <417D321F.1090102@pobox.com>

Lorenzo Maior.it wrote:
> 
> Hello,
> I've used the standard loop:
> 
>     while ((aOGRFeatureH = OGR_L_GetNextFeature(aLayerH)) != NULL)
>         OGR_F_Destroy(aOGRFeatureH);
> 
> with an OCILayer containing only geometries of type "wkbLineString".
> 
> It seams that memory isn't freed.
>  
> If I read the same geometries with the same loop but from a shapefile I
> don't have any memory problem.

Lorenzo,

I have looked into this briefly, but I don't see the issue.  Unfortunately,
I don't have an Oracle instance running currently, so it is hard for me to
dig into the problem.  I tried to install Oracle10g on my FC2 system but
filed do some sort of shared memory failure.

I would encourage you to file a bug in bugzilla explaining what version of
GDAL/OGR you did this with, how many records were in the table, how you
determined there was a memory leak and how much memory was being apparently
leaked.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Oct 25 13:33:32 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ESRI projection (prj) format problems
In-Reply-To: <ED3A48B9840E594890A2BC172D11946501CFFE0A@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D11946501CFFE0A@mailman.san.com>
Message-ID: <417D38EC.7080005@pobox.com>

Chapman, Martin wrote:
> All,
>  
> I am trying to use OGR to load some shape files with the following esri 
> projections (.prj).  As I understand it, OGR/Proj should be able to 
> convert the following projection names to the corresponding proj4 
> names.  I have used both the importFromWKT and importFromESRI functions 
> but keep getting the error - "projection not named" error.  I have 
> attached some of the prj files.
>  
> 1.  North_America_Albers_Equal_Area_Conic - Albers
> 2.  Bonne - bonne
> 3.  North_America_Lambert_Conformal_Conic - Lambert_Conformal_Conic
> 4.  World_Mercator - Mercator
> 5.  World_Van_der_Grinten_I - Van_der_Grinten_I

Martin,

I tried the Bonne, Van der Grinten and Mercator .prj files (it seems
those there the only ones in the zip file) and the VDG and Mercator ones
seemed to work OK for me.

For instance:

   testepsg ESRI::Mercator\ \(world\).prj
   ...
   PROJ.4 rendering of [ESRI::Mercator (world).prj] = +proj=merc +lat_ts=0
   +lon_0=0 +k=1.000000 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs

The Bonne does not translate, and I don't know what the equilvelent PROJ.4
string would be.  I don't recognise this projection.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dylan at iici.no-ip.org  Mon Oct 25 15:03:05 2004
From: dylan at iici.no-ip.org (Dylan Beaudette)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ogr2ogr -where "attribute=value" no spaces allowed?
Message-ID: <200410251203.05887.dylan@iici.no-ip.org>

Hi,

I am using the ogr2ogr command to extract features from a shapefile, based on 
a specific value for an attribute in the DBF by specifying a -where argument:

ogr2ogr -f "ESRI Shapefile" -where "DESCRIPT=Blue Oak Woodland" 
Blue_Oak_Woodland.shp ../vegetation_polygon.shp

however, it seems like any spaces in the "DESCRIPT=Blue Oak Woodland" argument 
causes the following error;

ERROR 1: Syntax error, 2 extra tokens

...which seems to match the number of spaces in the "DESCRIPT=Blue Oak 
Woodland" argument..

is there any way to get around this problem?

thanks in advance,
-- 
Dylan Beaudette
Soil Science Graduate Group
University of California at Davis

From warmerdam at pobox.com  Mon Oct 25 15:37:52 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ogr2ogr -where "attribute=value" no spaces allowed?
In-Reply-To: <200410251203.05887.dylan@iici.no-ip.org>
References: <200410251203.05887.dylan@iici.no-ip.org>
Message-ID: <417D5610.4010500@pobox.com>

Dylan Beaudette wrote:
> Hi,
> 
> I am using the ogr2ogr command to extract features from a shapefile, based on 
> a specific value for an attribute in the DBF by specifying a -where argument:
> 
> ogr2ogr -f "ESRI Shapefile" -where "DESCRIPT=Blue Oak Woodland" 
> Blue_Oak_Woodland.shp ../vegetation_polygon.shp
> 
> however, it seems like any spaces in the "DESCRIPT=Blue Oak Woodland" argument 
> causes the following error;
> 
> ERROR 1: Syntax error, 2 extra tokens
> 
> ...which seems to match the number of spaces in the "DESCRIPT=Blue Oak 
> Woodland" argument..
> 
> is there any way to get around this problem?

Dylan,

You need to quote the value you are comparing the DESCRIPT field to, much as
you would have to if you were doing this in SQL.

eg.
ogr2ogr -f "ESRI Shapefile" -where 'DESCRIPT="Blue Oak Woodland"' \
            Blue_Oak_Woodland.shp ../vegetation_polygon.shp

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Mon Oct 25 16:12:32 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ESRI projection (prj) format problems
Message-ID: <ED3A48B9840E594890A2BC172D119465E63BD4@mailman.san.com>

Frank,

What version of gdal/ogr/proj4 are you using when doing the test (I am
using the latest of all three)?  I used the following code (source is a
latlong projection and target is the mercator projection):

err = m_pOGRSourceSRS->importFromESRI(pszSourceWks);
if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();

err = m_pOGRTargetSRS->importFromESRI(pszTargetWks);
if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();

m_pCT = OGRCreateCoordinateTransformation(m_pOGRSourceSRS,
m_pOGRTargetSRS);
if (!m_pCT)
	throw (char*) CPLGetLastErrorMsg();

OGRCreateCoordinateTransformation always returns null and
CPLGetLastErrorMsg() returns:
"Failed to initialize PROJ.4 with `+ellps=WGS84 +units=m +no_defs '."

If I hard code the proj4 mercator string it works ok.  It appears as
though the OGR parser is having problems parsing the mercator projection
string (ESRI).  As far as Bonne goes, I found it in the Proj4 docs.  The
name of the projection is "bonne".  How do I get the testepsg.cpp code
to build when I build gdal?  I will test it using that code and see what
I get.

Thanks for your help,
Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Monday, October 25, 2004 11:34 AM
To: Chapman, Martin
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] ESRI projection (prj) format problems


Chapman, Martin wrote:
> All,
>  
> I am trying to use OGR to load some shape files with the following 
> esri
> projections (.prj).  As I understand it, OGR/Proj should be able to 
> convert the following projection names to the corresponding proj4 
> names.  I have used both the importFromWKT and importFromESRI
functions 
> but keep getting the error - "projection not named" error.  I have 
> attached some of the prj files.
>  
> 1.  North_America_Albers_Equal_Area_Conic - Albers
> 2.  Bonne - bonne
> 3.  North_America_Lambert_Conformal_Conic - Lambert_Conformal_Conic 4.

> World_Mercator - Mercator 5.  World_Van_der_Grinten_I - 
> Van_der_Grinten_I

Martin,

I tried the Bonne, Van der Grinten and Mercator .prj files (it seems
those there the only ones in the zip file) and the VDG and Mercator ones
seemed to work OK for me.

For instance:

   testepsg ESRI::Mercator\ \(world\).prj
   ...
   PROJ.4 rendering of [ESRI::Mercator (world).prj] = +proj=merc
+lat_ts=0
   +lon_0=0 +k=1.000000 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m
+no_defs

The Bonne does not translate, and I don't know what the equilvelent
PROJ.4 string would be.  I don't recognise this projection.

Best regards,

-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Oct 25 16:28:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ESRI projection (prj) format problems
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63BD4@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63BD4@mailman.san.com>
Message-ID: <417D61F9.4010302@pobox.com>

Chapman, Martin wrote:
> Frank,
> 
> What version of gdal/ogr/proj4 are you using when doing the test (I am
> using the latest of all three)?  I used the following code (source is a
> latlong projection and target is the mercator projection):
> 
> err = m_pOGRSourceSRS->importFromESRI(pszSourceWks);
> if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();
> 
> err = m_pOGRTargetSRS->importFromESRI(pszTargetWks);
> if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();
> 
> m_pCT = OGRCreateCoordinateTransformation(m_pOGRSourceSRS,
> m_pOGRTargetSRS);
> if (!m_pCT)
> 	throw (char*) CPLGetLastErrorMsg();
> 
> OGRCreateCoordinateTransformation always returns null and
> CPLGetLastErrorMsg() returns:
> "Failed to initialize PROJ.4 with `+ellps=WGS84 +units=m +no_defs '."
> 
> If I hard code the proj4 mercator string it works ok.  It appears as
> though the OGR parser is having problems parsing the mercator projection
> string (ESRI).  As far as Bonne goes, I found it in the Proj4 docs.  The
> name of the projection is "bonne".  How do I get the testepsg.cpp code
> to build when I build gdal?  I will test it using that code and see what
> I get.


Martin,

To build testepsg, just cd into gdal/ogr after a regular build, and do:

   make testepsg

I took an existing shapefile and use your Mercator and VDG .prj files with
it, and did an ogr2ogr -t_srs WGS84 translation on them.  That worked, though
it is hard for me to know if the results are correct.

For the Bonne, if you submit a bug report in the GDAL/OGR Bugzilla (include
the .prj file since I have deleted it) along with a any reference point
reprojected from Bonne to lat/long that you can find, and I will add Bonne
support to GDAL/OGR using the ESRI WKT formulation.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Mon Oct 25 16:30:07 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ESRI projection (prj) format problems
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFE12@mailman.san.com>

Frank,

Ok, thanks again.  I will try to use testepsg to figure it out and I'll
submit the bug for bonne into bugzilla.  

Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Monday, October 25, 2004 2:29 PM
To: Chapman, Martin
Cc: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] ESRI projection (prj) format problems


Chapman, Martin wrote:
> Frank,
> 
> What version of gdal/ogr/proj4 are you using when doing the test (I am

> using the latest of all three)?  I used the following code (source is 
> a latlong projection and target is the mercator projection):
> 
> err = m_pOGRSourceSRS->importFromESRI(pszSourceWks);
> if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();
> 
> err = m_pOGRTargetSRS->importFromESRI(pszTargetWks);
> if (err != OGRERR_NONE) throw (char*) CPLGetLastErrorMsg();
> 
> m_pCT = OGRCreateCoordinateTransformation(m_pOGRSourceSRS,
> m_pOGRTargetSRS);
> if (!m_pCT)
> 	throw (char*) CPLGetLastErrorMsg();
> 
> OGRCreateCoordinateTransformation always returns null and
> CPLGetLastErrorMsg() returns:
> "Failed to initialize PROJ.4 with `+ellps=WGS84 +units=m +no_defs '."
> 
> If I hard code the proj4 mercator string it works ok.  It appears as 
> though the OGR parser is having problems parsing the mercator 
> projection string (ESRI).  As far as Bonne goes, I found it in the 
> Proj4 docs.  The name of the projection is "bonne".  How do I get the 
> testepsg.cpp code to build when I build gdal?  I will test it using 
> that code and see what I get.


Martin,

To build testepsg, just cd into gdal/ogr after a regular build, and do:

   make testepsg

I took an existing shapefile and use your Mercator and VDG .prj files
with it, and did an ogr2ogr -t_srs WGS84 translation on them.  That
worked, though it is hard for me to know if the results are correct.

For the Bonne, if you submit a bug report in the GDAL/OGR Bugzilla
(include the .prj file since I have deleted it) along with a any
reference point reprojected from Bonne to lat/long that you can find,
and I will add Bonne support to GDAL/OGR using the ESRI WKT formulation.

Best regards,

-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From r.beck at m4com.de  Mon Oct 25 11:03:01 2004
From: r.beck at m4com.de (Reiner Beck)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGRSpatialReference: ERROR 1: geocentric transformation
	missing z or ellps
In-Reply-To: <417D0DC9.2090205@pobox.com>
References: <417BF3AB.4080304@m4com.de> <417D06DC.5080402@m4com.de>
	<417D0DC9.2090205@pobox.com>
Message-ID: <417D15A5.406@m4com.de>

Frank,

> Yikes!  Sorry about that.  I have added a pj_ prefix for all the 
> functions
> in geocent.c.  This will be in the next release.
>
Great!

>> - In addition to that, there's an issue with the Proj.4 lib creation:
>>  The README states: "Programmers may use projection library with 
>> calls to pj_init, pj_fwd, pj_inv and pj_transform."
>>  However, the shared library does not contain those functions. I have 
>> to manually add the objects (geod_inv.lo geod_set.lo geod_for.lo) to 
>> the "libproj_la_LIBADD" parameter ...
>
>
> I don't understand.  The geod_ files are for geodetic distance 
> calculations.
> I'm not sure what they have to do with pj_init, pj_fwd, pj_inv and 
> pj_transform.
> Are you saying that functions like pj_init() don't make it into your 
> library
> unless you add the geod files?  I find this very surprising, and I 
> will need
> more information on this before I can do anything.
>
Ooops, sorry about that. I mixed up the names ... The pj_init etc. are 
in the library. The geod_ functions are not, but I use those in my 
application. Maybe it's worth to add these functions to the library? Or 
does OGR support geodetic distance calculations?
BTW:
- Are the geod_ functions thread safe?
- Is it safe to use geod_set() only once to set e.g. WGS84? Or does OGR 
override the settings?

And, do I set up the coordinate system correctly:
      OGRSpatialReference swissSR;
      swissSR.SetProjCS("Schweizer Landeskoordinaten LV03");
      swissSR.SetWellKnownGeogCS("EPSG:4149");
      swissSR.SetHOM(46.95240555555556, 7.439583333333333, 90.0, 90.0, 
1.0, 600000, 200000);

      OGRSpatialReference swissSR2;
      swissSR2.SetProjCS("Schweizer Landeskoordinaten LV95");
      swissSR2.SetWellKnownGeogCS("EPSG:4150");
      swissSR2.SetHOM(46.95240555555556, 7.439583333333333, 90.0, 90.0, 
1.0, 2600000, 1200000);

I found in the csv file "pcs.cvs" the EPSG entries 2056 (CH1903+) and 
21781 (CH1903). But how can I use those entries? The call
      swissSR.SetWellKnownGeogCS("EPSG:2056");
produces only an empty string with exportToWkt.

Thanks!
Cheers
Reiner


From tylermitchell at shaw.ca  Tue Oct 26 00:35:27 2004
From: tylermitchell at shaw.ca (Tyler Mitchell)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp failing on proj=ortho
Message-ID: <200410252135.27549.tylermitchell@shaw.ca>

Sorry to bring up orthographic projections again, I know you looked into these 
earlier this year.  I really want to show this one off though!  I'm trying to 
convert a lat/long image into ortho - but I think I'm missing something.

Here is my command line:

gdalwarp -s_srs '+proj=latlong' 
	-t_srs '+proj=ortho +ellps=WGS84 +lat_0=60 +lon_0=-95' 
	globe.tif globe_ortho.tif

The output error I get is:	

ERROR 1: tolerance condition error
ERROR 1: GDALWarperOperation::ComputeSourceWindow() failed because
the pfnTransformer failed.

I'm running proj-4.4.7 and gdal from cvs a couple weeks ago.  Any ideas why 
this doesn't work?

Tyler

From neteler at itc.it  Tue Oct 26 07:27:24 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
Message-ID: <20041026112724.GA7942@thuille.itc.it>

Hi,

when using 'gdalwarp' on a HFA image with a large
color table, the resulting file get's a corrupted
colot tbale (almost white):

gdalinfo hanoi_lsat7_brovey_UTM48N.img | grep   'Color Table'
  Color Table (RGB with 32764 entries)

gdalwarp -of HFA -t_srs '+init=epsg:4326'  hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.img
Creating output file is that 9404P x 5964L.
:0...10...20...30...40...50...60...70...80...90...100 - done.

gdalinfo hanoi_lsat7_brovey_LL.img
...
Band 1 Block=64x64 Type=Int16, ColorInterp=Palette
  Color Table (RGB with 256 entries)
    0: 0,0,0,255
    1: 6,0,0,255
    2: 14,0,0,255
...
  254: 246,57,0,255
  255: 255,57,0,255

Is there a trick to avoid this problem?

When writing to GeoTIFF instead, it segfaults:
gdalwarp  -t_srs '+init=epsg:4326'  hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.tif
Creating output file is that 9404P x 5964L.
Segmentation fault

Program received signal SIGSEGV, Segmentation fault.
0x4207c5fc in memcpy () from /lib/tls/libc.so.6
(gdb) bt
#0  0x4207c5fc in memcpy () from /lib/tls/libc.so.6
#1  0x4019dc51 in _TIFFmemcpy () from /usr/local/lib/libgdal.so.1
#2  0x4017be7f in _TIFFsetByteArray () from /usr/local/lib/libgdal.so.1
#3  0x4017bf18 in _TIFFsetShortArray () from /usr/local/lib/libgdal.so.1
#4  0x4017c91d in _TIFFVSetField () from /usr/local/lib/libgdal.so.1
#5  0x4017d104 in TIFFVSetField () from /usr/local/lib/libgdal.so.1
#6  0x4017d0ca in TIFFSetField () from /usr/local/lib/libgdal.so.1
#7  0x40110a77 in GTiffRasterBand::SetColorTable(GDALColorTable*) () from /usr/local/lib/libgdal.so.1
#8  0x401b366a in GDALSetRasterColorTable () from /usr/local/lib/libgdal.so.1
#9  0x0804aa30 in GDALWarpCreateOutput(void*, char const*, char const*, char const*, char const*, int, char**, GDALDataType) ()
#10 0x0804a015 in main ()
#11 0x42015704 in __libc_start_main () from /lib/tls/libc.so.6


It seems to be a problem of the large color table.
I have stored the file here:
 http://mpa.itc.it/markus/tmp/hanoi_lsat7_brovey_UTM48N.img.gz
 (64 MB)

Thanks for any advice

Markus

From chen at yinyue123.com  Tue Oct 26 07:47:56 2004
From: chen at yinyue123.com (Fu Chen)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Why small image cost more time in mapserver's warping
In-Reply-To: <200410252135.27549.tylermitchell@shaw.ca>
Message-ID: <HLENLPCAGDEHMNMNLIDJIEELCIAA.chen@yinyue123.com>

Hi!
I operate on some landsat7's images and try to warp them to another projection dynamicly in mapserver. The image already have several level overviews. But I find it very weird that if i zoom it out to be a very small thumbtail like image, it still cost a lot of time to warp. On the other hand, if i zoom in inside the image, it responds very quickly cost much less than the thumbtail one.
I am not clear about the reason inside. Can anybody give me an hint?
Thank you!
From warmerdam at pobox.com  Tue Oct 26 09:22:44 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Why small image cost more time in mapserver's warping
In-Reply-To: <HLENLPCAGDEHMNMNLIDJIEELCIAA.chen@yinyue123.com>
References: <HLENLPCAGDEHMNMNLIDJIEELCIAA.chen@yinyue123.com>
Message-ID: <417E4FA4.3030003@pobox.com>

Fu Chen wrote:
> Hi!
> I operate on some landsat7's images and try to warp them to another projection 
 > dynamicly in mapserver. The image already have several level overviews. But I
 > find it very weird that if i zoom it out to be a very small thumbtail like image,
 > it still cost a lot of time to warp. On the other hand, if i zoom in inside the
 > image, it responds very quickly cost much less than the thumbtail one.
> I am not clear about the reason inside. Can anybody give me an hint?
> Thank you!

Fu Chen,

You didn't make clear how many levels of overviews exist.  Generally speaking
the warper will try and load the required region at double the resolution that
will be needed for the rendering though never loading at more than 1:1.  If
there are no image overviews pre-built, loading a small overview of a big file
can be very expensive but it seems that this should not be the case for your
file if you have a good set of overviews built and being used.

You can turn on layer level debugging to see a bit of information about
what is happening when a warped layer is rendered.  It should produce output
something like:

   msResampleGDALToMap in effect: cellsize = 10.000000
   msDrawGDAL(grey): using RAW_WINDOW=0 0 40 30

If you really want to dig into it, then dump out information about sDummyMap
(extents and size) and the srcImage near the msDrawRasterLayerGDAL() call in
mapresample.c.  It is possible too much imagery is being forcable loaded.

If you aren't in a position to dig through the code yourself, you can prepare
a case that demonstrates the slowness and submit it as a bug report.  I would
need a shp2img or mapserv invocation that demonstrates the problem as well
as a minimal map and set of data files to execute it.  Don't submit large
data files into bugzilla though ... just put them somewhere I can download
them and record the location in bugzilla.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 26 09:48:44 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp failing on proj=ortho
In-Reply-To: <200410252135.27549.tylermitchell@shaw.ca>
References: <200410252135.27549.tylermitchell@shaw.ca>
Message-ID: <417E55BC.5060904@pobox.com>

Tyler Mitchell wrote:
> Sorry to bring up orthographic projections again, I know you looked into these 
> earlier this year.  I really want to show this one off though!  I'm trying to 
> convert a lat/long image into ortho - but I think I'm missing something.
> 
> Here is my command line:
> 
> gdalwarp -s_srs '+proj=latlong' 
> 	-t_srs '+proj=ortho +ellps=WGS84 +lat_0=60 +lon_0=-95' 
> 	globe.tif globe_ortho.tif
> 
> The output error I get is:	
> 
> ERROR 1: tolerance condition error
> ERROR 1: GDALWarperOperation::ComputeSourceWindow() failed because
> the pfnTransformer failed.
> 
> I'm running proj-4.4.7 and gdal from cvs a couple weeks ago.  Any ideas why 
> this doesn't work?

Tyler,

The tolerence condition error is coming out of PROJ.4. I don't know exactly
what it means, but I presume it indicates some sort of mathematical error
in transforming "over the horizon" or off the earth.

If you can make globe.tif available to me I can see why gdalwarp isn't more
adaptive when only subregions of the target area support reprojection.  I
did a bunch of work on global scale transformations in MapServer but I don't
think the same capabilities were implemented in GDAL itself.  In fact, I
would appreciate it if you could submit this problem via the GDAL bugzilla.

I would add that you should specify an ellipe or datum with all projections
that don't implicitly contain one.  For instance you should have
'+proj=latlong +ellps=WGS84' in this case.  I doubt this has anything to do
with the problem though.  I presume it is using WGS84 internally as a default.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 26 13:04:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
In-Reply-To: <20041026112724.GA7942@thuille.itc.it>
References: <20041026112724.GA7942@thuille.itc.it>
Message-ID: <417E83A2.3060108@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> when using 'gdalwarp' on a HFA image with a large
> color table, the resulting file get's a corrupted
> colot tbale (almost white):
> 
> gdalinfo hanoi_lsat7_brovey_UTM48N.img | grep   'Color Table'
>   Color Table (RGB with 32764 entries)
> 
> gdalwarp -of HFA -t_srs '+init=epsg:4326'  hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.img
> Creating output file is that 9404P x 5964L.
> :0...10...20...30...40...50...60...70...80...90...100 - done.
> 

Markus,

I have confirmed that color table output is broken in general in GDAL currently.
This seems to relate to some other bugs fixes I did some months ago.  I will
try and fix this in time for the GDAL 1.2.4 release.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Oct 26 13:50:40 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
In-Reply-To: <20041026112724.GA7942@thuille.itc.it>
References: <20041026112724.GA7942@thuille.itc.it>
Message-ID: <417E8E70.6010404@pobox.com>

Markus Neteler wrote:
> Hi,
> 
> when using 'gdalwarp' on a HFA image with a large
> color table, the resulting file get's a corrupted
> colot tbale (almost white):
> 
> gdalinfo hanoi_lsat7_brovey_UTM48N.img | grep   'Color Table'
>   Color Table (RGB with 32764 entries)
> 
> gdalwarp -of HFA -t_srs '+init=epsg:4326'  hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.img
> Creating output file is that 9404P x 5964L.
> :0...10...20...30...40...50...60...70...80...90...100 - done.

Markus,

I have done a number of changes in the GDAL HFA driver now that correct this
and some related problems.  If you get a chance please try from CVS and let me
know if it still fails.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From neteler at itc.it  Tue Oct 26 17:02:56 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
In-Reply-To: <417E8E70.6010404@pobox.com>
References: <20041026112724.GA7942@thuille.itc.it> <417E8E70.6010404@pobox.com>
Message-ID: <20041026210256.GA27525@thuille.itc.it>

On Tue, Oct 26, 2004 at 01:50:40PM -0400, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >Hi,
> >
> >when using 'gdalwarp' on a HFA image with a large
> >color table, the resulting file get's a corrupted
> >colot tbale (almost white):
> >
> >gdalinfo hanoi_lsat7_brovey_UTM48N.img | grep   'Color Table'
> >  Color Table (RGB with 32764 entries)
> >
> >gdalwarp -of HFA -t_srs '+init=epsg:4326'  hanoi_lsat7_brovey_UTM48N.img 
> >hanoi_lsat7_brovey_LL.img
> >Creating output file is that 9404P x 5964L.
> >:0...10...20...30...40...50...60...70...80...90...100 - done.
> 
> Markus,
> 
> I have done a number of changes in the GDAL HFA driver now that correct this
> and some related problems.  If you get a chance please try from CVS and let 
> me know if it still fails.

Frank,
thanks for the quick response. I did an complete recompilation, but still
no luck. However, some changes now:

gdalwarp -of HFA -t_srs '+init=epsg:4326' hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.img
Creating output file is that 9404P x 5964L.
:0...10...20...30...40...50...60...70...80...90...100 - done.

gdalinfo  hanoi_lsat7_brovey_LL.img
Driver: HFA/Erdas Imagine Images (.img)
Size is 9404, 5964
Coordinate System is:
GEOGCS["WGS_1984",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.2572235629972],
        TOWGS84[0,0,0,0,0,0,0]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433]]
Origin = (105.072584,21.537953)
Pixel Size = (0.00013460,-0.00013460)
Corner Coordinates:
Upper Left  ( 105.0725836,  21.5379527) (105d 4'21.30"E, 21d32'16.63"N)
Lower Left  ( 105.0725836,  20.7351738) (105d 4'21.30"E, 20d44'6.63"N)
Upper Right ( 106.3384006,  21.5379527) (106d20'18.24"E, 21d32'16.63"N)
Lower Right ( 106.3384006,  20.7351738) (106d20'18.24"E, 20d44'6.63"N)
Center      ( 105.7054921,  21.1365633) (105d42'19.77"E, 21d 8'11.63"N)
Band 1 Block=64x64 Type=Int16, ColorInterp=Palette
  Color Table (RGB with 32764 entries)
    0: 0,0,0,255
    1: 6,0,0,255
    2: 14,0,0,255
[... now long table with 32764 entires, was 256 before, but: ]
  252: 230,57,0,255
  253: 238,57,0,255
  254: 246,57,0,255
  255: 255,57,0,255
  256: 0,0,0,0
  257: 0,0,0,0
  258: 0,0,0,0
  259: 0,0,0,0
  260: 0,0,0,0
...
  31897: 0,0,0,0
  31898: 0,0,0,0
  31899: 0,0,0,0
  31900: 0,0,0,0
  31901: 7171,0,0,0
  31902: -509,0,0,0
  31903: 1066,0,0,0
  31904: 3971,0,0,0
  31905: -32768,0,0,0
  31906: 0,0,0,0
  31907: 0,0,0,0
...
  32751: 0,0,0,0
  32752: 0,0,0,0
  32753: 0,0,0,0
  32754: 7186,0,0,0
  32755: 680,0,0,0
  32756: 7171,0,0,0
  32757: 0,0,0,0
  32758: 534,0,0,0
  32759: 0,0,0,0
  32760: 557,0,0,0
  32761: 1092,0,0,0
  32762: 555,0,0,0
  32763: -509,0,0,0


There is still something not reaching the new color table as
the resulting image appears almost black.

And
gdalwarp -t_srs '+init=epsg:4326' hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.tif
Creating output file is that 1482P x 2770L.
Segmentation fault

as before (in GDALSetRasterColorTable(), GDALWarpCreateOutput()).

If I should upload this file somewhere please let me know.
Otherwise it is still in the web site as indicated in the previous
mail.

Thanks again and sorry for now better news

 Markus


From warmerdam at pobox.com  Tue Oct 26 19:47:22 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
In-Reply-To: <20041026210256.GA27525@thuille.itc.it>
References: <20041026112724.GA7942@thuille.itc.it> <417E8E70.6010404@pobox.com>
	<20041026210256.GA27525@thuille.itc.it>
Message-ID: <417EE20A.9080305@pobox.com>

Markus Neteler wrote:
> On Tue, Oct 26, 2004 at 01:50:40PM -0400, Frank Warmerdam wrote:
>
> Frank,
> thanks for the quick response. I did an complete recompilation, but still
> no luck. However, some changes now:
...
> There is still something not reaching the new color table as
> the resulting image appears almost black.

Markus,

I found one serious botch in my SetColorTable() code.  You might want to check
out the latest and try again.

> And
> gdalwarp -t_srs '+init=epsg:4326' hanoi_lsat7_brovey_UTM48N.img hanoi_lsat7_brovey_LL.tif
> Creating output file is that 1482P x 2770L.
> Segmentation fault
> 
> as before (in GDALSetRasterColorTable(), GDALWarpCreateOutput()).
> 
> If I should upload this file somewhere please let me know.
> Otherwise it is still in the web site as indicated in the previous
> mail.

I am not getting this crash but looking through the code I can see how it
could happen.  I have committed a bunch of changes in geotiff.cpp to support
writing colormaps for *16bit* data.  You will find you need to force your
band type to UInt16 for this though.  How a TIFF colormap should be applied
to a signed 16bit band was too confusing for me, so I stipulate in the code
that the band must be UInt16.  You can use the "-ot UInt16" in your gdalwarp
call to make this happen.

I also added better error checking so datatypes for which I don't support
colormaps properly will report errors instead of doing weird and dangerous things.

All this exercise for  16bit colormaps is uncovering lots of issues!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt at matthewharmon.com  Tue Oct 26 12:28:06 2004
From: matt at matthewharmon.com (Matthew Harmon)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Scaling a dataset
Message-ID: <001c01c4bb78$c65f23d0$6401a8c0@dell4600>

Is there a simple (if not simple, best practice) way to open a dataset and
scale it up to a different resolution?  Do I essentially have to do a
complete warp?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041026/22d7616e/attachment.html
From warmerdam at pobox.com  Wed Oct 27 23:05:33 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] ORACLE driver fails to fetch a VARCHAR2(4000) column
In-Reply-To: <Pine.GSO.4.58.0408261355530.24478@cs>
References: <Pine.GSO.4.58.0408261355530.24478@cs>
Message-ID: <418061FD.8020803@pobox.com>

Petteri Packalen wrote:
> Hi,
> 
> I encountered some problems when trying to convert ORACLE table to some
> other format by using ogr2ogr. The table has a column of type
> VARCHAR2(4000). There seems to be some sort of buffer problem relating
> long text fields.
>
> When I give a command like "ogr2ogr -f "ESRI Shapefile"
> out_kohteet OCI:user/passw@db KOHTEET" I get a message "ERROR 1:
> ORA-01406: fetched column value was truncated in OCIStmtFetch". The
> shapefile is created but it is empty. I don't actually need this
> VARCHAR2(4000) column. I know that the maximum length of the string in dbf
> file is 254 characters. Anyway, it doesn't help if I try to restrict the
> columns fetched by using the switch "-select". It still produces the same
> error code. Also the geometry type in created shapefile is not correct
> ('line' instead of (2D) 'point'). I assume that in this case OGR first
> fetches all columns from ORACLE and then internally retsricts which
> columns are written to output file. The switch -sql "SELECT attr1, attr2,
> ..." fetches all attributes properly but the geometry type (and actual
> geometries) is still wrong ('line' instead of (2D) 'point'). I assume that
> in this case -sql statement is actually passed to ORACLE because it
> doesn't produce the same error code.

Petteri,

I see in gdal/ogr/ogrsf_frmts/oci/ogrocistatement.cpp in the Execute() method
there is a default buffer width of 256 for fields other than a few specific
types.  I would suggest hacking this to 4500 and see if it helps.  Search
for the line with "nBufWidth = 256".

It is killing me that I don't have an oracle instance running here that I can
work with.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 28 00:45:08 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <20041020224820.GA29226@vishnu.tridity.org>
Message-ID: <Pine.LNX.4.44.0410272142520.7792-100000@wapiti>

On Wed, 20 Oct 2004, Schuyler Erle wrote:

> * On 20-Oct-2004 at  2:33PM PDT, Curt, WE7U said:
> >
> > I end up with a LOT of polygons.  Upon drawing that shapefile
> > polygon file to my display it looks very similar to what it would
> > look like if I had drawn all of the individual line features from
> > multiple layers of the original raw tiger file.
>
> Yes, that is what you get - TIGER/Line, frankly, contains a lot of
> polygons! If you do a topological cleanup - removing spurs and bridges
> and so on - you get the actual polygons, one per census block - which
> is typically a pretty small area.  Like I said earlier, I use GRASS
> for this.

And I'm trying to do it in straight C.  It's looking pretty good so
far, except for the "hole" polygon thing I just posted about.  The
maps look very good on the screen anyway.


> > So far I'm no closer to getting a Shapefile with just the lake
> > polygons in it.  I'll keep studying the TIGER docs and the Python
> > script and will learn more about it.
>
> The one thing tigerpoly.py doesn't do is connect area landmarks with
> the polygons - I've been pondering how to do this. However, if hydro
> features are all you're after, you can try selecting and merging the
> polygons from TIGER/Line that have a ZCTA5 attribute ending in 'HH' -
> this seems to select all of the water polygons in my vector layers.

I've got all of the polygon pieces connected together now (via
C-code), including the Landmarks/AreaLandmarks stuff.  It's a bit of
a pain.  One of our other developers tweaked tigerpoly.py so that it
does this as well.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From archer at eskimo.com  Thu Oct 28 00:42:13 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <4176C0D5.2040901@pobox.com>
Message-ID: <Pine.LNX.4.44.0410272130480.7792-100000@wapiti>

On Wed, 20 Oct 2004, Frank Warmerdam wrote:

> Curt, WE7U wrote:
> >
> > That will solve one problem we're having, which is the missing
> > polygons from TIGER 2003 data that's been converted to Shapefiles
> > for our project.
> >
> > I still need to solve a second problem, which is how to display
> > polygons directly from raw TIGER data (not the shapefiles).  I'm
> > working on that one.
>
> You can write C++ code that does essentially the same thing as the tigerpoly.py.
> In particular, there is a C and C++ analog to the ogr.BuildPolygonFromEdges()
> call used by that script.

Thanks!  I've implemented that now, plus added a nice generic set of
hash table functions to use while recombining the Tiger data sets
into polygons that I can draw.

As always, once I get into the code, more questions arise.

When I implemented direct Shapelib support before, I implemented
support for filled polygons w/holes.  I rewrote portions of that
slightly for the OGR part of our code.

With the Tiger polygons it appears that the filled polygons and the
hole polygons are not necessarily connected in the files.  Might I
need sort the polygons somehow before drawing, then try to merge the
filled polygon geometries with the hole polygon geometries before
attempting to draw them?

What appears to be happening right now is that I sometimes pass
filled polygons to the draw routine, sometimes filled w/holes, and
sometimes hole polygons.  It's that last type that doesn't end up
getting drawn.  I assume that they should be somehow merged with one
of the other two types before any drawing occurs.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From warmerdam at pobox.com  Thu Oct 28 00:51:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.LNX.4.44.0410272130480.7792-100000@wapiti>
References: <Pine.LNX.4.44.0410272130480.7792-100000@wapiti>
Message-ID: <41807AC5.9030308@pobox.com>

Curt Mills wrote:
> Thanks!  I've implemented that now, plus added a nice generic set of
> hash table functions to use while recombining the Tiger data sets
> into polygons that I can draw.
> 
> As always, once I get into the code, more questions arise.
> 
> When I implemented direct Shapelib support before, I implemented
> support for filled polygons w/holes.  I rewrote portions of that
> slightly for the OGR part of our code.
> 
> With the Tiger polygons it appears that the filled polygons and the
> hole polygons are not necessarily connected in the files.  Might I
> need sort the polygons somehow before drawing, then try to merge the
> filled polygon geometries with the hole polygon geometries before
> attempting to draw them?
> 
> What appears to be happening right now is that I sometimes pass
> filled polygons to the draw routine, sometimes filled w/holes, and
> sometimes hole polygons.  It's that last type that doesn't end up
> getting drawn.  I assume that they should be somehow merged with one
> of the other two types before any drawing occurs.

Curt,

I'm afraid you lost me here.   The OGR Shapefile driver should sometimes
return polygon geometries which would be an outer ring and zero or more
inner rings (holes).  It can also return Multipolygons, which is a list
of polygons.  So one feature with a multipolygon geometry is essentially a
set of islands.

I don't know how you would get into a situation where you have just "holes"
unless you are taking about the polygons that belong inside the holes of
other polygons which aren't strictly holes in the sense I think of them.

Perhaps you could provide a shapefile that demonstrates the issue?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 28 01:01:28 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <41807AC5.9030308@pobox.com>
Message-ID: <Pine.LNX.4.44.0410272154250.9075-100000@wapiti>

On Thu, 28 Oct 2004, Frank Warmerdam wrote:

> I'm afraid you lost me here.   The OGR Shapefile driver should sometimes
> return polygon geometries which would be an outer ring and zero or more
> inner rings (holes).  It can also return Multipolygons, which is a list
> of polygons.  So one feature with a multipolygon geometry is essentially a
> set of islands.
>
> I don't know how you would get into a situation where you have just "holes"
> unless you are taking about the polygons that belong inside the holes of
> other polygons which aren't strictly holes in the sense I think of them.
>
> Perhaps you could provide a shapefile that demonstrates the issue?

Sorry, I think I led you astray.  I talked about implementing the
"holey" polygons using direct Shapelib support, then talked about
porting that code over to the OGR driver, and using it on TIGER/Line
data.  SDTS and Shapefiles appear to work just fine with OGR right
now.  It's the TIGER polygons that I'm working on now, which require
a bit more... finesse.

So... I'm snagging a bunch of the TIGER layers:  Polygon/ PIP/
AreaLandmarks/ Landmarks/ CompleteChain/PolyChainLink.  I combine
all of the pieces together, create a geometryCollection just like
tigerpoly.py does, then call BuildPolygonFromEdges.  I pass that off
to my Polygon draw routine for OGR that I used for SDTS and
Shapefiles, but again I'm passing TIGER polygons this time, not
Shapefile polygons.  I get these three types passed into the
routine:

    Filled polygons
    Filled polygons w/holes
    Hole polygons

I handle the first two cases just fine, but something tells me that
I missed a step somewhere and shouldn't be finding that third type.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From warmerdam at pobox.com  Thu Oct 28 01:10:11 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <Pine.LNX.4.44.0410272154250.9075-100000@wapiti>
References: <Pine.LNX.4.44.0410272154250.9075-100000@wapiti>
Message-ID: <41807F33.8080909@pobox.com>

Curt Mills wrote:
>     Filled polygons
>     Filled polygons w/holes
>     Hole polygons
> 
> I handle the first two cases just fine, but something tells me that
> I missed a step somewhere and shouldn't be finding that third type.

Curt,

I'm not sure how you can identify something as a "hole polygon".  For instance,
it is not possible to create an OGRPolygon with a hole but no outer ring since
it always treats the first ring as the outer ring.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From archer at eskimo.com  Thu Oct 28 01:20:36 2004
From: archer at eskimo.com (Curt Mills)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] OGR:  TIGER/Line polygons
In-Reply-To: <41807F33.8080909@pobox.com>
Message-ID: <Pine.LNX.4.44.0410272216280.9181-100000@wapiti>

On Thu, 28 Oct 2004, Frank Warmerdam wrote:

> I'm not sure how you can identify something as a "hole polygon".  For instance,
> it is not possible to create an OGRPolygon with a hole but no outer ring since
> it always treats the first ring as the outer ring.

That gives me some starting points as to where the problem might be.
I'll assume for now that the polygon geometries themselves can't be
the problem, then look downstream from there in the processing.

I'll check whether the processing of that first ring (to make an X11
Region) had a problem, therefore it had no X11 region to make a hole
in with the 2nd and succeeding rings.  That appears to be what it's
complaining about.

Thanks.

-- 
Curt, WE7U.				archer at eskimo dot com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From neteler at itc.it  Thu Oct 28 01:53:23 2004
From: neteler at itc.it (neteler@itc.it)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] gdalwarp HFA color problem
In-Reply-To: <417EE20A.9080305@pobox.com>
References: <417EE20A.9080305@pobox.com>
Message-ID: <33075.81.211.210.175.1098942803.squirrel@webmail.itc.it>

> Markus Neteler wrote:
>> On Tue, Oct 26, 2004 at 01:50:40PM -0400, Frank Warmerdam wrote:
>>
>> Frank,
>> thanks for the quick response. I did an complete recompilation, but
>> still
>> no luck. However, some changes now:
> ...
>> There is still something not reaching the new color table as
>> the resulting image appears almost black.
>
> Markus,
>
> I found one serious botch in my SetColorTable() code.  You might want to
> check
> out the latest and try again.

Frank,

excellent. Now it works perfectly.

>> And
>> gdalwarp -t_srs '+init=epsg:4326' hanoi_lsat7_brovey_UTM48N.img
>> hanoi_lsat7_brovey_LL.tif
>> Creating output file is that 1482P x 2770L.
>> Segmentation fault
>>
>> as before (in GDALSetRasterColorTable(), GDALWarpCreateOutput()).
>>
>> If I should upload this file somewhere please let me know.
>> Otherwise it is still in the web site as indicated in the previous
>> mail.
>
> I am not getting this crash but looking through the code I can see how it
> could happen.  I have committed a bunch of changes in geotiff.cpp to
> support
> writing colormaps for *16bit* data.  You will find you need to force your
> band type to UInt16 for this though.

Also tested: Instead of crash now a message appears - thanks.

>  How a TIFF colormap should be applied
> to a signed 16bit band was too confusing for me, so I stipulate in the
> code
> that the band must be UInt16.  You can use the "-ot UInt16" in your
> gdalwarp call to make this happen.

Works as well now.

> I also added better error checking so datatypes for which I don't support
> colormaps properly will report errors instead of doing weird and dangerous
> things.
>
> All this exercise for  16bit colormaps is uncovering lots of issues!

Thanks for resolving them!

best regards

 Markus


From dem at acri-st.fr  Thu Oct 28 11:43:20 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] GTiff driver memory map
Message-ID: <6.1.1.1.0.20041028170056.02443878@pop3>

Hi,

Memory map in GDAL's GeoTIFF driver seems to be disabled :

in gdal/frmts/gtiff/libtiff/tif_vsi.c :

static int
_tiffMapProc(thandle_t fd, tdata_t* pbase, toff_t* psize)
{
	(void) fd; (void) pbase; (void) psize;
	return (0);
}

and in libtiff/libtiff/tif_unix.c :

static int
_tiffMapProc(thandle_t fd, tdata_t* pbase, toff_t* psize)
{
	toff_t size = _tiffSizeProc(fd);
	if (size != (toff_t) -1) {
		*pbase = (tdata_t)
		    mmap(0, size, PROT_READ, MAP_SHARED, (int) fd, 0);
		if (*pbase != (tdata_t) -1) {
			*psize = size;
			return (1);
		}
	}
	return (0);
}

are there reasons to this ?

Thanks,

Julien


From chodgson at refractions.net  Thu Oct 28 14:46:53 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] No python support for x86_64 with kakadu?
Message-ID: <41813E9D.8080509@refractions.net>

I have compiled gdal successfully with kakadu on my machine, which is an 
Athlon 64 FX. However, I didn't get python support for some reason.so, 
going back to try to add it, I try this:

[root@dragonfly gdal]# python setup.py build
['pymod/gdal_wrap.c', 'pymod/numpydataset.cpp', 'pymod/gdalnumeric.cpp']
running build
running build_py
running build_ext
building '_gdalmodule' extension
c++ -pthread -shared build/temp.linux-x86_64-2.3/pymod/gdal_wrap.o 
build/temp.linux-x86_64-2.3/pymod/numpydataset.o 
build/temp.linux-x86_64-2.3/pymod/gdalnumeric.o -L./.libs -lgdal -o 
build/lib.linux-x86_64-2.3/_gdalmodule.so
/usr/bin/ld: /usr/local/lib/libgdal.a(jp2.o): relocation R_X86_64_32 can 
not be used when making a shared object; recompile with -fPIC
/usr/local/lib/libgdal.a: could not read symbols: Bad value
collect2: ld returned 1 exit status
error: command 'c++' failed with exit status 1

hmm... something isn't kosher with the 64-bit relocation. I did compile 
kakadu with -fPIC.

Here I see what is probably part of the problem:

[root@dragonfly gdal]# ./configure 
--with-kakadu=/usr/local/src/v4_2_1-00488N --without-geos 
--without-libtool --with-python --with-pic
...
configure: creating libtool
appending configuration tag "CXX" to libtool
checking for ld used by g++... /usr/bin/ld -m elf_x86_64
checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports 
shared libraries... yes
checking for g++ option to produce PIC... -fPIC
checking if g++ PIC flag -fPIC works... yes
checking if g++ supports -c -o file.o... yes
checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports 
shared libraries... yes
checking dynamic linker characteristics... GNU/Linux ld.so
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
appending configuration tag "F77" to libtool
checking for ranlib... (cached) ranlib
/usr/bin/ld: conftest2.o: relocation R_X86_64_32 can not be used when 
making a shared object; recompile with -fPIC
conftest2.o: could not read symbols: Bad value
collect2: ld returned 1 exit status
checking for g++ -shared ... no(1)
checking for ld -shared ... no
checking for dlopen in -ldl... yes
checking for main in -lm... yes

It does seem to find the fPIC option, but something else in conftest.o 
fails... do I need to run autoconf myself to generate 64-bit compatible 
configure tests? How can I do this? Is this likely to be part of my problem?

How can I tell if my existing libgdal.a was compiled with -fPIC? Or does 
that even make any sense... I don't have a libgdal.so, because configure 
doesn't think I have support for gcc -shared... something's icky here...

Help! Please!

Thanks,
Chris



From jnielsen at aero-graphics.com  Thu Oct 28 18:02:14 2004
From: jnielsen at aero-graphics.com (jnielsen@aero-graphics.com)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Re: Sex pictures
Message-ID: <20041028205712.9B72542186B@xserve.flids.com>

My favourite page.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: www.myx4free.zip
Type: application/octet-stream
Size: 29832 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041029/be869fb6/www.myx4free.obj
From alexamici at fastwebnet.it  Thu Oct 28 17:58:03 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] No python support for x86_64 with kakadu?
In-Reply-To: <41813E9D.8080509@refractions.net>
References: <41813E9D.8080509@refractions.net>
Message-ID: <200410282358.04125.alexamici@fastwebnet.it>


Chris,

On Thursday 28 October 2004 20:46, Chris Hodgson wrote:
> I have compiled gdal successfully with kakadu on my machine, which is an
> Athlon 64 FX. However, I didn't get python support for some reason.so,
> going back to try to add it, I try this:
>
> [root@dragonfly gdal]# python setup.py build

good, the use of the setup.py script is not the standard procedure to build 
the python module, but in normal circumstances it has a good chance to 
work ;). your problem is elsewhere.

> ['pymod/gdal_wrap.c', 'pymod/numpydataset.cpp', 'pymod/gdalnumeric.cpp']
> running build
> running build_py
> running build_ext
> building '_gdalmodule' extension
> c++ -pthread -shared build/temp.linux-x86_64-2.3/pymod/gdal_wrap.o
> build/temp.linux-x86_64-2.3/pymod/numpydataset.o
> build/temp.linux-x86_64-2.3/pymod/gdalnumeric.o -L./.libs -lgdal -o
> build/lib.linux-x86_64-2.3/_gdalmodule.so
> /usr/bin/ld: /usr/local/lib/libgdal.a(jp2.o): relocation R_X86_64_32 can
> not be used when making a shared object; recompile with -fPIC
> /usr/local/lib/libgdal.a: could not read symbols: Bad value
> collect2: ld returned 1 exit status
> error: command 'c++' failed with exit status 1
>
> hmm... something isn't kosher with the 64-bit relocation. I did compile
> kakadu with -fPIC.
>
> Here I see what is probably part of the problem:
>
> [root@dragonfly gdal]# ./configure
> --with-kakadu=/usr/local/src/v4_2_1-00488N --without-geos
> --without-libtool --with-python --with-pic
> ...
> configure: creating libtool
> appending configuration tag "CXX" to libtool
> checking for ld used by g++... /usr/bin/ld -m elf_x86_64
> checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
> checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports
> shared libraries... yes
> checking for g++ option to produce PIC... -fPIC
> checking if g++ PIC flag -fPIC works... yes
> checking if g++ supports -c -o file.o... yes
> checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports
> shared libraries... yes
> checking dynamic linker characteristics... GNU/Linux ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... yes
> appending configuration tag "F77" to libtool
> checking for ranlib... (cached) ranlib 
> /usr/bin/ld: conftest2.o: relocation R_X86_64_32 can not be used when
> making a shared object; recompile with -fPIC
> conftest2.o: could not read symbols: Bad value
> collect2: ld returned 1 exit status
> checking for g++ -shared ... no(1)
> checking for ld -shared ... no
> checking for dlopen in -ldl... yes
> checking for main in -lm... yes
>
> It does seem to find the fPIC option, but something else in conftest.o
> fails... do I need to run autoconf myself to generate 64-bit compatible
> configure tests? How can I do this? Is this likely to be part of my
> problem?

you used the --without-libtool option (correct, if you want to build kakadu 
support, but then the --with-pic option will probably be ignored, please 
don't add it) and in fact the error come from the gdal self-made check for 
'g++ -shared'.

Frank, this is for you ;-). It has nothing to do with libtool.

> How can I tell if my existing libgdal.a was compiled with -fPIC? Or does
> that even make any sense... I don't have a libgdal.so, because configure
> doesn't think I have support for gcc -shared... something's icky here...

as a workaround you may try to hand edit GDALmake.opt (after configure) adding 
the support for shared libraries. search fo LD_SHARED and change it to:
LD_SHARED = g++ -shared
(better if you make distclean before ;)

cheers,
alessandro

From alexamici at fastwebnet.it  Thu Oct 28 17:58:03 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] No python support for x86_64 with kakadu?
In-Reply-To: <41813E9D.8080509@refractions.net>
References: <41813E9D.8080509@refractions.net>
Message-ID: <200410282358.04125.alexamici@fastwebnet.it>


Chris,

On Thursday 28 October 2004 20:46, Chris Hodgson wrote:
> I have compiled gdal successfully with kakadu on my machine, which is an
> Athlon 64 FX. However, I didn't get python support for some reason.so,
> going back to try to add it, I try this:
>
> [root@dragonfly gdal]# python setup.py build

good, the use of the setup.py script is not the standard procedure to build 
the python module, but in normal circumstances it has a good chance to 
work ;). your problem is elsewhere.

> ['pymod/gdal_wrap.c', 'pymod/numpydataset.cpp', 'pymod/gdalnumeric.cpp']
> running build
> running build_py
> running build_ext
> building '_gdalmodule' extension
> c++ -pthread -shared build/temp.linux-x86_64-2.3/pymod/gdal_wrap.o
> build/temp.linux-x86_64-2.3/pymod/numpydataset.o
> build/temp.linux-x86_64-2.3/pymod/gdalnumeric.o -L./.libs -lgdal -o
> build/lib.linux-x86_64-2.3/_gdalmodule.so
> /usr/bin/ld: /usr/local/lib/libgdal.a(jp2.o): relocation R_X86_64_32 can
> not be used when making a shared object; recompile with -fPIC
> /usr/local/lib/libgdal.a: could not read symbols: Bad value
> collect2: ld returned 1 exit status
> error: command 'c++' failed with exit status 1
>
> hmm... something isn't kosher with the 64-bit relocation. I did compile
> kakadu with -fPIC.
>
> Here I see what is probably part of the problem:
>
> [root@dragonfly gdal]# ./configure
> --with-kakadu=/usr/local/src/v4_2_1-00488N --without-geos
> --without-libtool --with-python --with-pic
> ...
> configure: creating libtool
> appending configuration tag "CXX" to libtool
> checking for ld used by g++... /usr/bin/ld -m elf_x86_64
> checking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes
> checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports
> shared libraries... yes
> checking for g++ option to produce PIC... -fPIC
> checking if g++ PIC flag -fPIC works... yes
> checking if g++ supports -c -o file.o... yes
> checking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports
> shared libraries... yes
> checking dynamic linker characteristics... GNU/Linux ld.so
> checking how to hardcode library paths into programs... immediate
> checking whether stripping libraries is possible... yes
> appending configuration tag "F77" to libtool
> checking for ranlib... (cached) ranlib 
> /usr/bin/ld: conftest2.o: relocation R_X86_64_32 can not be used when
> making a shared object; recompile with -fPIC
> conftest2.o: could not read symbols: Bad value
> collect2: ld returned 1 exit status
> checking for g++ -shared ... no(1)
> checking for ld -shared ... no
> checking for dlopen in -ldl... yes
> checking for main in -lm... yes
>
> It does seem to find the fPIC option, but something else in conftest.o
> fails... do I need to run autoconf myself to generate 64-bit compatible
> configure tests? How can I do this? Is this likely to be part of my
> problem?

you used the --without-libtool option (correct, if you want to build kakadu 
support, but then the --with-pic option will probably be ignored, please 
don't add it) and in fact the error come from the gdal self-made check for 
'g++ -shared'.

Frank, this is for you ;-). It has nothing to do with libtool.

> How can I tell if my existing libgdal.a was compiled with -fPIC? Or does
> that even make any sense... I don't have a libgdal.so, because configure
> doesn't think I have support for gcc -shared... something's icky here...

as a workaround you may try to hand edit GDALmake.opt (after configure) adding 
the support for shared libraries. search fo LD_SHARED and change it to:
LD_SHARED = g++ -shared
(better if you make distclean before ;)

cheers,
alessandro

From chodgson at refractions.net  Thu Oct 28 18:49:57 2004
From: chodgson at refractions.net (Chris Hodgson)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] No python support for x86_64 with kakadu?
In-Reply-To: <200410282358.04125.alexamici@fastwebnet.it>
References: <41813E9D.8080509@refractions.net>
	<200410282358.04125.alexamici@fastwebnet.it>
Message-ID: <41817795.8020803@refractions.net>


>as a workaround you may try to hand edit GDALmake.opt (after configure) adding 
>the support for shared libraries. search fo LD_SHARED and change it to:
>LD_SHARED = g++ -shared
>(better if you make distclean before ;)
>  
>
Ok, here is the end of the compile output after setting LD_SHARED = g++ 
-shared (and running a make clean beforehand):

make ./libgdal.a ./libgdal.so
make[1]: Entering directory `/usr/local/src/gdal'
ar r ./libgdal.a ./frmts/o/*.o ./gcore/*.o ./port/*.o ./alg/*.o 
./ogr/ogrsf_frmts/o/*.o ./ogr/ogrgeometryfactory.o ./ogr/ogrpoint.o 
./ogr/ogrcurve.o ./ogr/ogrlinestring.o ./ogr/ogrlinearring.o 
./ogr/ogrpolygon.o ./ogr/ogrutils.o ./ogr/ogrgeometry.o 
./ogr/ogrgeometrycollection.o ./ogr/ogrmultipolygon.o ./ogr/ogrsurface.o 
./ogr/ogrmultipoint.o ./ogr/ogrmultilinestring.o ./ogr/ogr_api.o 
./ogr/ogrfeature.o ./ogr/ogrfeaturedefn.o ./ogr/ogrfeaturequery.o 
./ogr/ogrfeaturestyle.o ./ogr/ogrfielddefn.o ./ogr/ogrspatialreference.o 
./ogr/ogr_srsnode.o ./ogr/ogr_srs_proj4.o ./ogr/ogr_fromepsg.o 
./ogr/ogrct.o ./ogr/ogr_opt.o ./ogr/ogr_srs_esri.o ./ogr/ogr_srs_pci.o 
./ogr/ogr_srs_usgs.o ./ogr/ogr_srs_dict.o ./ogr/swq.o 
./ogr/ogr_srs_validate.o ./ogr/ogr_srs_xml.o ./ogr/ograssemblepolygon.o 
./ogr/ogr2gmlgeometry.o ./ogr/gml2ogrgeometry.o
ar: creating ./libgdal.a
ranlib ./libgdal.a
g++ -shared  ./frmts/o/*.o ./gcore/*.o ./port/*.o ./alg/*.o 
./ogr/ogrsf_frmts/o/*.o ./ogr/ogrgeometryfactory.o ./ogr/ogrpoint.o 
./ogr/ogrcurve.o ./ogr/ogrlinestring.o ./ogr/ogrlinearring.o 
./ogr/ogrpolygon.o ./ogr/ogrutils.o ./ogr/ogrgeometry.o 
./ogr/ogrgeometrycollection.o ./ogr/ogrmultipolygon.o ./ogr/ogrsurface.o 
./ogr/ogrmultipoint.o ./ogr/ogrmultilinestring.o ./ogr/ogr_api.o 
./ogr/ogrfeature.o ./ogr/ogrfeaturedefn.o ./ogr/ogrfeaturequery.o 
./ogr/ogrfeaturestyle.o ./ogr/ogrfielddefn.o ./ogr/ogrspatialreference.o 
./ogr/ogr_srsnode.o ./ogr/ogr_srs_proj4.o ./ogr/ogr_fromepsg.o 
./ogr/ogrct.o ./ogr/ogr_opt.o ./ogr/ogr_srs_esri.o ./ogr/ogr_srs_pci.o 
./ogr/ogr_srs_usgs.o ./ogr/ogr_srs_dict.o ./ogr/swq.o 
./ogr/ogr_srs_validate.o ./ogr/ogr_srs_xml.o ./ogr/ograssemblepolygon.o 
./ogr/ogr2gmlgeometry.o ./ogr/gml2ogrgeometry.o ./libgdal.a 
-L/usr/local/pgsql/lib -lpq  ./libgdal.a -lgif -ljpeg -lpng -lz -lm -ldl 
-lkdu -L/usr/local/pgsql/lib -lpq \
        -o ./libgdal.so
/usr/bin/ld: ./frmts/o/args.o: relocation R_X86_64_32 can not be used 
when making a shared object; recompile with -fPIC
./frmts/o/args.o: could not read symbols: Bad value
collect2: ld returned 1 exit status
make[1]: *** [libgdal.so] Error 1
make[1]: Leaving directory `/usr/local/src/gdal'
make: *** [check-lib] Error 2

I re-made kakadu, and made certain that -fPIC was in the CC_OPTS, and it 
seems to wrk correct, with -fPIC on every command line shown during the 
make. Kakadu succesfully builds as a 64-bit shared library... or at 
least AFAICT:

[root@dragonfly gdal]# ldd /usr/local/lib64/libkdu_v42R.so
        libstdc++.so.5 => /usr/lib64/libstdc++.so.5 (0x0000002a956df000)
        libm.so.6 => /lib64/tls/libm.so.6 (0x0000002a958ba000)
        libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x0000002a959bd000)
        libc.so.6 => /lib64/tls/libc.so.6 (0x0000002a95ac8000)
        /lib64/ld-linux-x86-64.so.2 => /lib64/ld-linux-x86-64.so.2 
(0x000000552aaaa000)

I really don't know much about this stuff... being in 64-bit land makes 
everything more complicated. Any more ideas or help would be great!

Thanks,
Chris




From archer at eskimo.com  Fri Oct 29 12:15:00 2004
From: archer at eskimo.com (archer@eskimo.com)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20041029150958.359B04262B4@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20041029/f346e1cf/attachment.wav
From dem at acri-st.fr  Fri Oct 29 11:28:33 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] libtiff in GDAL - append mode
Message-ID: <6.1.1.1.0.20041029165320.0255e5a8@pop3>

Hi,

I try to create a multi-directory TIFF file with the libtiff embedded in 
GDAL, but this code which works well with the standard libtiff 3.7.0 
creates only one directory with GDAL's libtiff.... (tested only on Linux) :

Thanks in advance for help,

Julien


#include "tiff.h"
#include "tiffio.h"

int main(int argc, char **argv) {
     char *fout = argv[1];
     TIFF *tif;
     unsigned char buf[24] = {0};

     buf[0] = 22;
     buf[1] = 44;
     buf[2] = 55;

     tif = TIFFOpen(fout, "w");
     TIFFSetField( tif, TIFFTAG_BITSPERSAMPLE, 8 );
     TIFFSetField( tif, TIFFTAG_SAMPLESPERPIXEL, 1 );
     TIFFSetField( tif, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_MINISBLACK );
     TIFFSetField( tif, TIFFTAG_IMAGEWIDTH, 4 );
     TIFFSetField( tif, TIFFTAG_IMAGELENGTH, 6 );
     TIFFSetField( tif, TIFFTAG_ROWSPERSTRIP, 6 );
     TIFFSetField( tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG );
     TIFFWriteEncodedStrip(tif, 0, buf, 24);
     TIFFClose(tif);

     tif = TIFFOpen(fout, "a");
     TIFFSetField( tif, TIFFTAG_BITSPERSAMPLE, 8 );
     TIFFSetField( tif, TIFFTAG_SAMPLESPERPIXEL, 1 );
     TIFFSetField( tif, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_MINISBLACK );
     TIFFSetField( tif, TIFFTAG_IMAGEWIDTH, 2 );
     TIFFSetField( tif, TIFFTAG_IMAGELENGTH, 3 );
     TIFFSetField( tif, TIFFTAG_ROWSPERSTRIP, 3 );
     TIFFSetField( tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG );
     TIFFWriteEncodedStrip(tif, 0, buf, 6);
     TIFFWriteDirectory(tif);
     TIFFClose(tif);

     return 0;
}


From dron at ak4719.spb.edu  Fri Oct 29 13:56:20 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Re: [Tiff] libtiff in GDAL - append mode
In-Reply-To: <6.1.1.1.0.20041029165320.0255e5a8@pop3>
References: <6.1.1.1.0.20041029165320.0255e5a8@pop3>
Message-ID: <20041029175620.GD9308@ak4719.spb.edu>

On Fri, Oct 29, 2004 at 05:28:33PM +0200, Julien Demaria wrote:
> I try to create a multi-directory TIFF file with the libtiff embedded in 
> GDAL, but this code which works well with the standard libtiff 3.7.0 
> creates only one directory with GDAL's libtiff.... (tested only on Linux) :

Have you tried the latest GDAL form CVS? I have sinchronized libtiff and
GDAL trees few days ago.

					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dem at acri-st.fr  Fri Oct 29 11:28:33 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] [Tiff] libtiff in GDAL - append mode
Message-ID: <6.1.1.1.0.20041029165320.0255e5a8@pop3>

Hi,

I try to create a multi-directory TIFF file with the libtiff embedded in 
GDAL, but this code which works well with the standard libtiff 3.7.0 
creates only one directory with GDAL's libtiff.... (tested only on Linux) :

Thanks in advance for help,

Julien


#include "tiff.h"
#include "tiffio.h"

int main(int argc, char **argv) {
     char *fout = argv[1];
     TIFF *tif;
     unsigned char buf[24] = {0};

     buf[0] = 22;
     buf[1] = 44;
     buf[2] = 55;

     tif = TIFFOpen(fout, "w");
     TIFFSetField( tif, TIFFTAG_BITSPERSAMPLE, 8 );
     TIFFSetField( tif, TIFFTAG_SAMPLESPERPIXEL, 1 );
     TIFFSetField( tif, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_MINISBLACK );
     TIFFSetField( tif, TIFFTAG_IMAGEWIDTH, 4 );
     TIFFSetField( tif, TIFFTAG_IMAGELENGTH, 6 );
     TIFFSetField( tif, TIFFTAG_ROWSPERSTRIP, 6 );
     TIFFSetField( tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG );
     TIFFWriteEncodedStrip(tif, 0, buf, 24);
     TIFFClose(tif);

     tif = TIFFOpen(fout, "a");
     TIFFSetField( tif, TIFFTAG_BITSPERSAMPLE, 8 );
     TIFFSetField( tif, TIFFTAG_SAMPLESPERPIXEL, 1 );
     TIFFSetField( tif, TIFFTAG_PHOTOMETRIC, PHOTOMETRIC_MINISBLACK );
     TIFFSetField( tif, TIFFTAG_IMAGEWIDTH, 2 );
     TIFFSetField( tif, TIFFTAG_IMAGELENGTH, 3 );
     TIFFSetField( tif, TIFFTAG_ROWSPERSTRIP, 3 );
     TIFFSetField( tif, TIFFTAG_PLANARCONFIG, PLANARCONFIG_CONTIG );
     TIFFWriteEncodedStrip(tif, 0, buf, 6);
     TIFFWriteDirectory(tif);
     TIFFClose(tif);

     return 0;
}

_______________________________________________
Tiff mailing list
Tiff@remotesensing.org
http://xserve.flids.com/mailman/listinfo/tiff




From dron at ak4719.spb.edu  Fri Oct 29 13:56:20 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] Re: [Tiff] libtiff in GDAL - append mode
In-Reply-To: <6.1.1.1.0.20041029165320.0255e5a8@pop3>
References: <6.1.1.1.0.20041029165320.0255e5a8@pop3>
Message-ID: <20041029175620.GD9308@ak4719.spb.edu>

On Fri, Oct 29, 2004 at 05:28:33PM +0200, Julien Demaria wrote:
> I try to create a multi-directory TIFF file with the libtiff embedded in 
> GDAL, but this code which works well with the standard libtiff 3.7.0 
> creates only one directory with GDAL's libtiff.... (tested only on Linux) :

Have you tried the latest GDAL form CVS? I have sinchronized libtiff and
GDAL trees few days ago.

					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
_______________________________________________
Tiff mailing list
Tiff@remotesensing.org
http://xserve.flids.com/mailman/listinfo/tiff




From gigi_lala2002 at yahoo.com  Sun Oct 31 03:48:05 2004
From: gigi_lala2002 at yahoo.com (Bodoh)
Date: Wed Nov 21 11:49:27 2007
Subject: [Gdal-dev] line of sight
Message-ID: <20041031084805.90019.qmail@web13423.mail.yahoo.com>

Hi all

Is GDAL able to find the line of sight between 2
points?

Thanks

Richard


		
_______________________________
Do you Yahoo!?
Express yourself with Y! Messenger! Free. Download now. 
http://messenger.yahoo.com

