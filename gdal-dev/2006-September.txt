From hydromap at gmail.com  Fri Sep  1 03:14:13 2006
From: hydromap at gmail.com (Shoaib Burq)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: ruby bindings proj4 stangeness
In-Reply-To: <44F5298D.7030206@savagexi.com>
References: <60c6835d0608220548n472ae28sd97afb19860f7885@mail.gmail.com>
	<44F5298D.7030206@savagexi.com>
Message-ID: <60c6835d0609010014j7ecbc2dax2a273f359a906e26@mail.gmail.com>

Hi Charlie

Sorry about the delayed response. The osr_warp.cxxx does contain the
import/export_to_proj4 definitions.

just did a hand compile of gdal-cvs on my laptop using --with-ruby
config option and it works. While on the problem server i used an
ebuild with a gdal-ruby patch that just modifies the RubyMakefile.mk
to add ${RUBY_MODULES} to the install target -- something bad happens
without it -- if my memory serves me correctly it couldn't find
gdal.o. I am now thinking the problem maybe with my ebuild. I am
investigating this. will keep you posted.

regards
Shoaib

On 8/30/06, Charlie Savage <cfis@savagexi.com> wrote:
> Are you regenerating the SWIG bindings or using the ones in CVS?
>
> Either way, open the appropriate cxx file (osr_wrap.cxx maybe) and
> scroll to the bottom.  Do you see these missing methods being registered
> (I'm guessing no)?
>
> Charlie
>
>
> Shoaib Burq wrote:
> > I have been banging my head against this for a few hours now with
> > little success. I have gdal-1.3.2 build with ruby bindings on gentoo.
> >
> > So far while scripting all had been well until i got to proj4 import
> > and export functions in osr.
> >
> > It appears that that osr ruby bindings aren't registering the proj4
> > functions.
> >
> > the strange thing is everything else works fine. Also in python these
> > functions is working fine. Below is the run of the osr test suite to
> > demonstrate the problem
> >
> > $ ruby ts_osr.rb
> > Loaded suite ts_osr
> > Started
> > ...E........EE..
> > Finished in 0.077001 seconds.
> >
> >  1) Error:
> > test_translate_nad_shift(TestOsrBasic):
> > NoMethodError: undefined method `set_towgs84' for
> > #<Gdal::Osr::SpatialReference:0xb7b2930c>
> >    ./tc_osr_basic.rb:109:in `test_translate_nad_shift'
> >
> >  2) Error:
> > test_exponents(TestOsrProj4):
> > NoMethodError: undefined method `import_from_proj4' for
> > :Gdal::Osr::SpatialReference
> >    ./tc_osr_proj4.rb:18:in `test_exponents'
> >
> >  3) Error:
> > test_k_0_flag(TestOsrProj4):
> > NoMethodError: undefined method `import_from_proj4' for
> > :Gdal::Osr::SpatialReference
> >    ./tc_osr_proj4.rb:9:in `test_k_0_flag'
> >
> > 16 tests, 79 assertions, 0 failures, 3 errors
> > ------------------
> > So i am running gentoo. gdal was built using the most recent ebuild
> > (with ruby flags) and everything compiled fine.
> >
> > any thoughts?
> > -shoaib
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From frederic.claudel at magellium.fr  Fri Sep  1 04:05:28 2006
From: frederic.claudel at magellium.fr (Frederic Claudel)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] gdal_translate for reframing?
In-Reply-To: <44F5BFE9.30805@pobox.com>
Message-ID: <001801c6cd9d$63929c30$a401a8c0@pc164>


Hi all,
I'm considering reframing an image with a "NoData" edge, which can also be
seen as a translation of the image (using an integer shift).
That would allow aligning GDAL native blocks together for faster access,
when using GDALRasterBand::ReadBlock()

I've tried experimenting with GDAL command line utilities, but so far the
only way do do it is:
- add a GeoTransform to my file
- use gdalwarp to change frame
This is not a direct way, and sometimes I lose a pixel in the process (maybe
because of nearest neighbour resampling).

I was hoping that gdal_translate could do it, but the -srcwin option only
accepts boundaries that fall within the input image's extent, so I cannot
extend the image frame.
Hacking with the source to remove that lock didn' lead me anywhere - the
resulting images were destroyed, and I got a few warnings from GDAL.

Has someone wrote a command line tool to do it? Do you think it's possible
to extend gdal_translate -srcwin ?

Thanks,
Frederic Claudel



From anders.moe at geocap.no  Fri Sep  1 05:15:24 2006
From: anders.moe at geocap.no (Anders Moe)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Link error on Windows  XP64
Message-ID: <008a01c6cda7$29036a40$6b00a8c0@xeon>

Hi all

 

I'm building gdal 1.3.2  in a win 64XP using MSVC 2005. However, I'm getting
linking errors, given below. Can anyone see whats wrong ? This is my first
time building gdal, and I find it rather difficult to navigate all the
makefiles etc. 

 

Thanks, 

 

Anders

 

 

--- - - - - - 

 

C:\Documents and Settings\Anders\My Documents\src\gdal-1.3.2\frmts>cd netcdf
&& nmake /NOLOGO /f makefile.vc   && cd .. 

            copy *.obj ..\o

gmtdataset.obj

netcdfdataset.obj

        2 file(s) copied.

            cd ..

            cd vb6

            nmake /nologo /f makefile.vc

            cd ..

            if exist gdal.lib del gdal.lib

            lib /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj
ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib vb6\vb6_support.obj

Microsoft (R) Library Manager Version 8.00.50727.42

Copyright (C) Microsoft Corporation.  All rights reserved.

 

ogrsf_frmts.lib(parsexsd.obj) : warning LNK4221: no public symbols found;
archive member will be inaccessible

            link /dll /debug /INCLUDE:_OGRFeatureStylePuller
/INCLUDE:_OSRValidate  /INCLUDE:_OPTGetProjectionMethods
/INCLUDE:_OGR_G_GetPointCount  /INCLUDE:_OGRRegisterAll
/INCLUDE:_GDALSimpleImageWarp@36  /INCLUDE:_GDALReprojectImage@48
/INCLUDE:_GDALComputeMedianCutPCT@32  /INCLUDE:_GDALDitherRGB2PCT@28
/INCLUDE:_vbSafeArrayToPtr@16  /INCLUDE:_OCTNewCoordinateTransformation@8
port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj
ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib vb6\vb6_support.obj
odbc32.lib           "C:\Documents and Settings\Anders\My
Documents\src\netcdf-3.6.1\src\win32\NET\x64\debug\netcdf.lib"
gcore\Version.res  /out:gdal13.dll /implib:gdal_i.lib 

Microsoft (R) Incremental Linker Version 8.00.50727.42

Copyright (C) Microsoft Corporation.  All rights reserved.

 

   Creating library gdal_i.lib and object gdal_i.exp

LINK : error LNK2001: unresolved external symbol
_OCTNewCoordinateTransformation@8

LINK : error LNK2001: unresolved external symbol _vbSafeArrayToPtr@16

LINK : error LNK2001: unresolved external symbol _GDALDitherRGB2PCT@28

LINK : error LNK2001: unresolved external symbol _GDALComputeMedianCutPCT@32

LINK : error LNK2001: unresolved external symbol _GDALReprojectImage@48

LINK : error LNK2001: unresolved external symbol _GDALSimpleImageWarp@36

LINK : error LNK2001: unresolved external symbol _OGRRegisterAll

LINK : error LNK2001: unresolved external symbol _OGR_G_GetPointCount

LINK : error LNK2001: unresolved external symbol _OPTGetProjectionMethods

LINK : error LNK2001: unresolved external symbol _OSRValidate

LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller

gdal13.dll : fatal error LNK1120: 11 unresolved externals

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060901/a81dcdaf/attachment.html
From ricardoluis at ufs.br  Fri Sep  1 09:17:37 2006
From: ricardoluis at ufs.br (Ricardo)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC 
Message-ID: <20060901130617.M33681@ufs.br>

Hi all,

I'm trying to use the sample code posted to this topic but I don't know how 
to define or where find the definitions for classes:

IVPMap, IVPLayer, IVPVectorLayer. 

The same problem happn with the enum type NAVIGATIONMODE.

May some one help me, thanks you all

Ricardo Lu?s.

From mhanson at photon.com  Fri Sep  1 10:53:23 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>
	<44F6FCDD.50308@loskot.net>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>

Well I'm glad to see my post started a discussion about these things but I don't have much to add because I'm having a hard time following some of it.  My background's in Imaging Science, not Computer Science...and while I'm ok at programming I'm no blackbelt.
To clarify what I'm doing, I'm creating an Geospatial Image Processing library.   The underlying dataset resides on disk and is interfaced through GDAL, and is read and processed in chunks, and written out.   My goal is to make the file I/O and chunking process as transparent as possible to the developer.  I'm essentially applying the power and ease of use of the CImg library to Geospatial imagery.   My hope is to make is publicly available but as both libraries are LGPL it is ultimately up to my boss to make that decision.

________________________________

From: gdal-dev-bounces@lists.maptools.org on behalf of Mateusz Loskot
Sent: Thu 8/31/2006 11:14 AM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDALDataset as a Base Class



Ivan Lucena wrote:
> Hi there,
>
> Mateusz Loskot wrote:
>> And? Something wrong with those wrappers? I've never seen them, but
> again
>> I'm not sure what is the problem here, if any.
>
> That is ok. I understand. The issue is more sensible to Frank. So I
> believe his answer is good enough for both of us.

OK, it's clear.

>> Pointers are nothing bad, even good, but only if used correctly.
>> I'm not sure what to try to observe there.
>
> I am showing a piece of my C++ implementation that uses GDALDataset
> pointer as an attribute of my class. The things that Matt Hanson tried
> to do in C++ I've tried too a year ago. But I finally give it up to the
> "good use of pointer". It works and it is robust and I encouraging Matt
> to keep doing this way.

I understand, yes this seems reasonable for me too.

> We both agree with that. I just have a sense
> that the use of this kind of class-pointers is an indicator that
> something is lacking. IMHO you should be able o develop in C++ without
> ever looking to the GDAL C API.

I'd try to develop smart pointers for GDALDataset and other
types to expose underlying types in reference-line style
and garbage collecting provided.

> But that leads to the discussion about the proliferation of GDAL
> wrapper. So Frank had thought about that a long time ago, by adoption
> SWIG. My questions is: Are we relying too much in SWIG and wrapper and
> maybe there is something that could me done at once in GDAL?

Personally, I don't see anything better for "done at once" idea
for scripting languages than SWIG.

>> Idea about what?
>> COM wrapper would good for Windows environment because COM provides
>> highest flexibility of reuse -> scripting languages, .NET, VC6, and
>> even C/C++ -  without additional wrapping layer.
>> So, personally if I'd need a GDAL wrapper for .NET, I'd go with COM.
>> Also COM-CORBA bridging is possible, but I don't see any
>> application here.
>
> So Mateusz, Now that you've got the "Idea", let's talk:

Note, my COM idea is a non-portable idea.

> If you look around what the "competitors" (the GDAL's analogous) are
> doing (there is a bunch of SDK to deal with geo-spatial data and
> functionality out there,MapXtreme,

in Java for Windows

> ArcObject,

C++/.NET for Windows and Unix though I've no idea how it's portable

> BlueMarble,

C++ or VB -> for Windows

> TatukGIS,

Borland technologies (C++/Delphi) -> for Windows

> Abaco,

no idea

> They are developing in a "component" oriented fashion.
> Don't you think so?

Yes, but in highly not portable fashion at the same time.
What's the best portable technology of writing
software in your opinion?

> Or whatever name you like to put on it. By doing
> this way they can easily take the advantage of implementing the API
> trough technologies like COM and have it done only once. Document once
> too. For example, browsing at edn.esri.com I don't need to see only
> Delphi example to learn some tricks. I can see then in C++, C# or
> VB.NET, etc.

I agree that component-based arch is good, but I hardly see
conjunction to SWIG/GDAL issue.

> I have worked with UNIX for 10 years but I am out of it for 7, so I
> don't know what is going on there.

One of the famouse COM-like components arch is Bonobo,
created by Miguel de Icaza.

> But I think that by exposing classes'
> names and behavior and attributes though a C++ library it is not going
> to make a lot of difference from a COM interface. That "COM-CORBA
> bridging" think look interesting I will check it out...

C++ vtable is compatible with COM binary interface, so you don't
have to use COM to expose interface-based access to your components.
But I still don't see how it applies to "SWIG or not to SWIG" issue.

> GDAL architecture is really good.

Yes, and the main advantage for me is that it's very clear.
You can learn how to write GDAL/OGR driver in minutes.
Genuine simplicity is a bless, I can say something about it :-)

> I use it trough C++, Python and trough
> my own Delphi wrapper :-).  My Delphi plans are still the same: develop
> a wrapper. It is fun. Some little tricks will make my wrapper easier to
> user and therefore more productive. So, it looks like Matt and I have
> the same goal.

IMHO, wrappers are good because they open wide range of "markets"
for particular software, e.g. for GDAL and I agree it's good to
have wrappers for scripting languages, etc.

Regarding Matt's idea, I'm not sure what are his objectives.
IMHO, if it's like rewriting or restructuring GDAL types into
new shape that fits conventions of particular project, then
I'd say it's a waste of time
But if wrapping GDAL brings new values, then it's a good idea.

> Finally, if that is the philosophy of GDAL. I don't argue about It. It's
> an excellent base layer and we will continue to create ours wrappers.

I am not able to answer for GDAL project. I'm only share my
personal opinions.

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net <http://mateusz.loskot.net/> 
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev




From ILucena at clarku.edu  Fri Sep  1 11:10:21 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Link error on Windows  XP64
In-Reply-To: <008a01c6cda7$29036a40$6b00a8c0@xeon>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45501CE65AD@Iris.ad.clarku.edu>

Hi Anders,

 

I just compiled GDAL in Windows XP64 using Visual Studio 8 (2005) and it
works pretty well. 

 

1) Did you run "C:\Program Files (x86)\Microsoft Visual Studio
8\VC\vcvarsall.bat" first to get the path and environment variables
settings? I did that, so in fact I am using the 32bit version of
compiler, maybe is that what you need. Check the variables and you can
see the "(x86)" after "Program Files";

 

VCINSTALLDIR=C:\Program Files (x86)\Microsoft Visual Studio 8\VC

VS80COMNTOOLS=C:\Program Files (x86)\Microsoft Visual Studio
8\Common7\Tools\

VSINSTALLDIR=C:\Program Files (x86)\Microsoft Visual Studio 8

 

2) Anyway, I not am compiling netCDF for now. It could be it, I don't
know. But you can try to comment it back on nmake.opt and try again.

 

3) The error that your log shows doesn't give me any clue, maybe someone
else in the list.

 

4) Another issue is you folder name with spaces. It could get messy... 
But there is some workaround to make it work, like using the "~", ex.:

 

GDAL_HOME = "E:\Progra~1\Gdal-1.3.2"

 

Good luck and lets us know what works for you Anders,

 

Ivan Lucena

 

________________________________

From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Anders Moe
Sent: Friday, September 01, 2006 5:15 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Link error on Windows XP64

 

Hi all

 

I'm building gdal 1.3.2  in a win 64XP using MSVC 2005. However, I'm
getting linking errors, given below. Can anyone see whats wrong ? This
is my first time building gdal, and I find it rather difficult to
navigate all the makefiles etc. 

 

Thanks, 

 

Anders

 

 

--- - - - - - 

 

C:\Documents and Settings\Anders\My Documents\src\gdal-1.3.2\frmts>cd
netcdf   && nmake /NOLOGO /f makefile.vc   && cd .. 

            copy *.obj ..\o

gmtdataset.obj

netcdfdataset.obj

        2 file(s) copied.

            cd ..

            cd vb6

            nmake /nologo /f makefile.vc

            cd ..

            if exist gdal.lib del gdal.lib

            lib /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj
frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib
vb6\vb6_support.obj

Microsoft (R) Library Manager Version 8.00.50727.42

Copyright (C) Microsoft Corporation.  All rights reserved.

 

ogrsf_frmts.lib(parsexsd.obj) : warning LNK4221: no public symbols
found; archive member will be inaccessible

            link /dll /debug /INCLUDE:_OGRFeatureStylePuller
/INCLUDE:_OSRValidate  /INCLUDE:_OPTGetProjectionMethods
/INCLUDE:_OGR_G_GetPointCount  /INCLUDE:_OGRRegisterAll
/INCLUDE:_GDALSimpleImageWarp@36  /INCLUDE:_GDALReprojectImage@48
/INCLUDE:_GDALComputeMedianCutPCT@32  /INCLUDE:_GDALDitherRGB2PCT@28
/INCLUDE:_vbSafeArrayToPtr@16
/INCLUDE:_OCTNewCoordinateTransformation@8 port\*.obj gcore\*.obj
alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib
vb6\vb6_support.obj      odbc32.lib           "C:\Documents and
Settings\Anders\My
Documents\src\netcdf-3.6.1\src\win32\NET\x64\debug\netcdf.lib"
gcore\Version.res  /out:gdal13.dll /implib:gdal_i.lib 

Microsoft (R) Incremental Linker Version 8.00.50727.42

Copyright (C) Microsoft Corporation.  All rights reserved.

 

   Creating library gdal_i.lib and object gdal_i.exp

LINK : error LNK2001: unresolved external symbol
_OCTNewCoordinateTransformation@8

LINK : error LNK2001: unresolved external symbol _vbSafeArrayToPtr@16

LINK : error LNK2001: unresolved external symbol _GDALDitherRGB2PCT@28

LINK : error LNK2001: unresolved external symbol
_GDALComputeMedianCutPCT@32

LINK : error LNK2001: unresolved external symbol _GDALReprojectImage@48

LINK : error LNK2001: unresolved external symbol _GDALSimpleImageWarp@36

LINK : error LNK2001: unresolved external symbol _OGRRegisterAll

LINK : error LNK2001: unresolved external symbol _OGR_G_GetPointCount

LINK : error LNK2001: unresolved external symbol
_OPTGetProjectionMethods

LINK : error LNK2001: unresolved external symbol _OSRValidate

LINK : error LNK2001: unresolved external symbol _OGRFeatureStylePuller

gdal13.dll : fatal error LNK1120: 11 unresolved externals

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060901/86395d5e/attachment.html
From ari.jolma at tkk.fi  Fri Sep  1 12:38:48 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>
	<44F6FCDD.50308@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
Message-ID: <44F86218.1080304@tkk.fi>

Matt Hanson kirjoitti:
> To clarify what I'm doing, I'm creating an Geospatial Image Processing library.   The underlying dataset resides on disk and is interfaced through GDAL, and is read and processed in chunks, and written out.   My goal is to make the file I/O and chunking process as transparent as possible to the developer.  I'm essentially applying the power and ease of use of the CImg library to Geospatial imagery.   My hope is to make is publicly available but as both libraries are LGPL it is ultimately up to my boss to make that decision.
>   

How does what you try to accomplish differ from what can be done with OSSIM?

My first  impression, after looking briefly at CImg's website, is that 
marrying GDAL and CImg elegantly won't be easy. It may be easy to use 
GDAL to bring a piece of one band into CImg but not so easy to support 
processing big images with CImg. I would assume taking chunks, 
processing them, and putting them together again does not produce 
correct results in all cases.

Ari

-- 
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From mhanson at photon.com  Fri Sep  1 14:55:34 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>
	<44F6FCDD.50308@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
	<44F86218.1080304@tkk.fi>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027856D@pj-exchange.photon.com>

There are some roadblocks to combining these two libraries but I think I have a decent plan of attack.  Certainly some algorithms can't be processed piecewise, but many can.   The important thing is to properly pad out each chunk based on the size of the neighborhood (for neighborhood-based algorithms).   Some algorithms will require a different approach, such as an FFT which requires processing entire columns, then rows.
 
As far as OSSIM goes, to be perfectly honest I've attempted to use it on several occasions and every time I throw my hands up in despair.   I think I'm a fairly educated guy (i have an MS in Remote Sensing/Image Processing), but OSSIM is way beyond me.   It's true these things can be accomplished with OSSIM and I've been very impressed with what OSSIM can do, but I can't do them.   There is a severe lack of documentation and tutorials, mixed with the fact that the actual code is extremely confusing (to me).    Personally I think OSSIM has way too many classes whose interactions are mind-boggling, and lacks an easy to use API.    Obviously OSSIM has been used to do very cool things such as the ImageLinker and osgPlanetViewer apps but I feel more comfortable writing my own then trying to make sense of it.   It won't be as powerful as OSSIM but it will have a more intuitive interface.
 
 
matt
 
 
Matt Hanson
http://www.omnium-gatherum.org
 

________________________________

From: Ari Jolma [mailto:ari.jolma@tkk.fi]
Sent: Fri 9/1/2006 12:38 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDALDataset as a Base Class



Matt Hanson kirjoitti:
> To clarify what I'm doing, I'm creating an Geospatial Image Processing library.   The underlying dataset resides on disk and is interfaced through GDAL, and is read and processed in chunks, and written out.   My goal is to make the file I/O and chunking process as transparent as possible to the developer.  I'm essentially applying the power and ease of use of the CImg library to Geospatial imagery.   My hope is to make is publicly available but as both libraries are LGPL it is ultimately up to my boss to make that decision.
>  

How does what you try to accomplish differ from what can be done with OSSIM?

My first  impression, after looking briefly at CImg's website, is that
marrying GDAL and CImg elegantly won't be easy. It may be easy to use
GDAL to bring a piece of one band into CImg but not so easy to support
processing big images with CImg. I would assume taking chunks,
processing them, and putting them together again does not produce
correct results in all cases.

Ari

--
Prof. Ari Jolma
Kartografia ja Geoinformatiikka / Cartography and Geoinformatics
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma





From mateusz at loskot.net  Fri Sep  1 16:10:14 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
Message-ID: <44F893A6.8060604@loskot.net>

Matt Hanson wrote:
> Well I'm glad to see my post started a discussion about these things
> but I don't have much to add because I'm having a hard time following
> some of it.

It's more a kind of academic debate. It does not apply directly to your
problem, so don't worry ;-)

> I'm creating an Geospatial Image Processing
> library.   The underlying dataset resides on disk and is interfaced
> through GDAL, and is read and processed in chunks, and written out.
> My goal is to make the file I/O and chunking process as transparent
> as possible to the developer.

Does the 'transparent' mean you don't want to make user of your
library to deal directly with GDAL?
So, user needs only to pass filename/dataset location to your interface
and GDAL objects are create behind the scene?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Fri Sep  1 16:30:01 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027856D@pj-exchange.photon.com>
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>	<44F86218.1080304@tkk.fi>
	<0719BE42F22E0A46857DF72644EC5D7027856D@pj-exchange.photon.com>
Message-ID: <44F89849.6020601@loskot.net>

Matt Hanson wrote:
> There are some roadblocks to combining these two libraries but I
> think I have a decent plan of attack.

Matt,
I've not analyzed CImg deeply, but AFAI understand it.
it's implemented using different paradigm than GDAL.
The former is based om meta programming (the kingdom of static
polymorphism and compile time actions), the latter is based on
dynamic polymorphism.

What Ari said a message before, mixing these two worlds
may be a challange. Certainly, it's doable,
but I doubt you'll be able to mix it directly
for example directly inheriting CImg-like types from GDAL types.

Certainly, I don't know your ideas in details, so these are only some
general assumptions.

By the way, do you know GIL, I announced it here a some time ago:

http://opensource.adobe.com/gil/

It seems to be similar to CImg.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mhanson at photon.com  Fri Sep  1 16:48:34 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>
	<44F893A6.8060604@loskot.net>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027856E@pj-exchange.photon.com>

Mateusz wrote:
> Does the 'transparent' mean you don't want to make user of your
> library to deal directly with GDAL?
> So, user needs only to pass filename/dataset location to your interface
> and GDAL objects are create behind the scene?

Essentially yes, even though I may add that GDAL has a very nice and quick to learn interface.  So it's not to make GDAL simpler but rather to automate the process of reading, processing in chunks, and writing out.    A user would init an image by passing it a filename and in most cases they won't have to worry about calling Read/Write functions, instead they call processing functions.
 
I'm actually quite interested at some point to write iterators (1-D and 2-D), so that STL or more specifically VIGRA (http://kogs-www.informatik.uni-hamburg.de/~koethe/vigra/) style algorithms could be used directly but that would take a lot more work and the trick would be to make them smart enough to minimize I/O.   I haven't thoguht out the process yet but  I'd probably start by restricting the case to forward iterators and then read in a block when you hit the beginning of it and store which piece has been read in.  This isn't in the scope of my current effort but it would be nice to see someday.
 
 
matt
 
 
Matt Hanson
http://www.omnium-gatherum.org

 


From mhanson at photon.com  Fri Sep  1 17:42:52 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>	<44F86218.1080304@tkk.fi>
	<0719BE42F22E0A46857DF72644EC5D7027856D@pj-exchange.photon.com>
	<44F89849.6020601@loskot.net>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027856F@pj-exchange.photon.com>

Thanks for the link to GIL - it looks interesting.  I'm familiar with most of the DIP libraries out there but this one escaped my notice - they need to do some work on getting higher on search engines because I've scoured the net on several occasions over the last few years and never came across it.  I've used CImg quite a bit and while it challenges some normal C++ practices it's is the most complete, intuitive, easy to use IP library I've ever used.  It rivals the capabilities of the higher level IDL language (Interactive Data Language NOT Interface Definition Language) which I've used extensively since the early 90's.
 
I understand your statement, though I would not have been able to vocalize it in that manner (due to my informal programming training) but quickly realized the differences between the two and there is a stumbling block due to this very reason.   Let me explain the problem from my POV to verify I'm on the same page and my approach to get around it.  Maybe I'm oversimplifyign the problem and some of you may point out issues I haven't thought of or encountered yet.  Maybe someone has insight or different ideas.
 
Datatypes in GDAL datasets are described by the GDALDataType enumeration.   When you open a GDAL dataset the user need not know, or care, about the datatype.   The CImg class on the other hand, being a template, must have a datatype declared at compile time, such as CImg<int>.    While the GDAL method is flexible and means the user has less to worry about, when it comes to DIP, it becomes much more difficult to do things dynamically.  In fact, if I'm writing algorithms I want complete control over my data types.  Therefore my GImage class takes the template approach where the user declares the data type they want the dataset to be.   In fact, GDAL is so cool :-) that I don't even have to worry about conversion of datatypes because RasterIO does it for me.   It becomes a simple matter of looking up the proper GDALDataType enum based on the typename (using typeid(var)->name ).     Trying to make DIP funtions handle datatypes dynamically would be much more work.  There is however at least one DIP library that takes this approach, at least to some extent and that is VIPS, which I have also used quite a bit and is a very decent library.   Obviously by making GImage a template it assumes, or rather makes, all bands of the same data type - thus my previous post concerning that a couple weeks ago. 
 
The difficult issue is going from a GDALDataType enum to a typeid that can be used to create an instantiated object.  For example, if I want to create a GImage object of whatever datatype currently exists within the GDAL file.   This is useful if you want to extract and save a subset of data but keep the same datatype.   There are two solutions I see here:
 
1 - Make a non-member function not based on templates that simply copies a subset of GDAL data to a new file.  Subsequent processing would still require a user to use a GImage object, and thus specify the datatype they would like to do that processing in.
 
2 - Try and look up and return a typename based on the GDALDatatype enum.  This means parsing the file and returning a typename, then the user can use typename to instantiate a GImage object.  This is a very difficult thing to do, even if it is possible.   I think that something similar to the ideas presented here:
http://www.accu-usa.org/2000-05-Main.html
may work.   At the very least this approach requires pre-instantiated GImage classes of all the datatypes GDAL supports.  i.e.
typedef GImage<short> int16GImage;
typedef CImage<double> doubleGImage;
and so on.
 
 
So in other words this GImage class will be more like the CImg approach.  A templated DIP library, but underneath it is processing piecewise and using GDAL to actually do the I/O.
 
 
matt

________________________________

From: gdal-dev-bounces@lists.maptools.org on behalf of Mateusz Loskot
Sent: Fri 9/1/2006 4:30 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDALDataset as a Base Class



Matt Hanson wrote:
> There are some roadblocks to combining these two libraries but I
> think I have a decent plan of attack.

Matt,
I've not analyzed CImg deeply, but AFAI understand it.
it's implemented using different paradigm than GDAL.
The former is based om meta programming (the kingdom of static
polymorphism and compile time actions), the latter is based on
dynamic polymorphism.

What Ari said a message before, mixing these two worlds
may be a challange. Certainly, it's doable,
but I doubt you'll be able to mix it directly
for example directly inheriting CImg-like types from GDAL types.

Certainly, I don't know your ideas in details, so these are only some
general assumptions.

By the way, do you know GIL, I announced it here a some time ago:

http://opensource.adobe.com/gil/

It seems to be similar to CImg.

Cheers
--
Mateusz Loskot
http://mateusz.loskot.net <http://mateusz.loskot.net/> 
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev




From mateusz at loskot.net  Fri Sep  1 18:13:53 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027856E@pj-exchange.photon.com>
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>	<44F893A6.8060604@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856E@pj-exchange.photon.com>
Message-ID: <44F8B0A1.5070101@loskot.net>

Matt Hanson wrote:
> Mateusz wrote:
>> Does the 'transparent' mean you don't want to make user of your 
>> library to deal directly with GDAL? So, user needs only to pass 
>> filename/dataset location to your interface and GDAL objects are 
>> create behind the scene?
> 
> Essentially yes, even though I may add that GDAL has a very nice and 
> quick to learn interface.  So it's not to make GDAL simpler but 
> rather to automate the process of reading, processing in chunks, and 
> writing out. A user would init an image by passing it a filename and
> in most cases they won't have to worry about calling Read/Write 
> functions, instead they call processing functions.


Yes, I think I understand your objectives now.
Basically, you're going to use GDAL as as a I/O
interface to access images.
Like using fopen function without wanting to make it simplier or
change its interface and behaviour, but just use it.

So, definitely inheritance is not a good idea here,
what we've already discussed.


> I'm actually quite interested at some point to write iterators (1-D 
> and 2-D), so that STL or more specifically VIGRA 
> (http://kogs-www.informatik.uni-hamburg.de/~koethe/vigra/) style 
> algorithms could be used directly but that would take a lot more work
>  and the trick would be to make them smart enough to minimize I/O.

Yes, the idea is good.
Similarly, I create my own iterator (input iterator) for Shapefile,
so I can use STL algorithms accepting input iterators on shape objects.
(it's under development, I'm going to publish it in October,
now I don't have any time to finish it.)

The main idea is to define proper "protocol" of data exchange between
iterator (client) and underlying "container" (image).

Another interesting idea is a View concept.
View is a kind of "looking glass" through which a set of elements
can be observed in different ways without interfering the structure of
the set itself. You know, too look at something as it would have
different structure than it actually has.

View concept in C++ is usually based on two fundamental concepts:
sequence and iterator. For example, one may want to define
a chunk_view for raster (2D array of pixels) which would enable
user to iterate raster by-chunks (for example by 20x20 pixel chunks)
instead of by-single-pixel. And thanks to STL-compliant iterators,
this may be done with STL algorithms.

A very trivial use case, for presentation purpose:
You have a blank (white or black) raster of size of 200x200 pixels.
You can use view + iterator + std::for_each or std::transform algorithm
to make it fill 20x20 pixels chunks with black and white to make
it a chessboard. With view/iterator, this operation can be made in
single line of code.

The View concept is powerful and pretty coder-friendly to grasp.
Here is a very good intruduction: STL Sequences & the View Concept
http://www.ddj.com/dept/cpp/184401789

View Template Library is a set of predefined STL-compliant views:
http://www.zib.de/weiser/vtl/

BTW, I think our debate may be  getting Off-Topic for
the gdal-dev list :-)

> I haven't thoguht out the process yet but  I'd probably start by 
> restricting the case to forward iterators and then read in a block 
> when you hit the beginning of it and store which piece has been read 
> in.  This isn't in the scope of my current effort but it would be 
> nice to see someday.

If you mean to do read-only in forward progress, then input
iterators should be used here (using STL iterators nomenclature).
Forward iterators provide read-write access, during forward
iteration only.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From packalen at cs.joensuu.fi  Sat Sep  2 10:16:59 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
Message-ID: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>

Frank, list,

Once again, I struggled with the weird problem until I understood to look 
at the documentation... The problem was that, within importFromWkt(), the 
pointer was updated to pointer after the consumed text. However, I don't 
still understand why the first *corrected* solution does not work 
properly. I want to reset the geometry of an existing feature based on WKT 
representation. Below are two examples in which only the latter one works 
properly. An example 1 crashes due to illegal memory access. geo_trans is 
a buffer which stores WKT.

EXAMPLE 1
=========
OGRPolygon * poPoly = new OGRPolygon();
poPoly->importFromWkt( &geo_trans );
poDstFeature->SetGeometryDirectly( poPoly );
...
OGRFeature::DestroyFeature( poFeature );

EXAMPLE 2
=========
char* pszWkt = (char*) geo_trans;
OGRSpatialReference *ref = new OGRSpatialReference( NULL );
OGRGeometry *new_geom;
OGRErr err = OGRGeometryFactory::createFromWkt(&pszWkt, ref, &new_geom);
poDstFeature->SetGeometryDirectly( new_geom );
...
OGRFeature::DestroyFeature( poFeature );

In the comment within the ogrgeometryfactory.cpp it states that 
"createFromWkt() now updates pointer to text to indicate how much text was 
consumed". I understand that this can be useful in many occasions although 
I don't understand why it is implemented this way. Anyway, why the first 
solution does not work? In addition, in an example 1 the problem occurres 
only after very many (>million) calls to importFromWkt(). Something is 
happening in the background (related to reference counting etc.?) I don't 
understand.

Best regards,
Petteri

=========================================================================
Petteri Packal?n 
University of Joensuu 
Faculty of Forestry 
P.O. Box 111 
80101 Joensuu
Finland 
e-mail: packalen@cs.joensuu.fi 
=========================================================================
From mateusz at loskot.net  Sat Sep  2 10:38:17 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
Message-ID: <44F99759.4080202@loskot.net>

Petteri Packalen wrote:
> Frank, list,
> 
> Once again, I struggled with the weird problem until I understood to
> look at the documentation... The problem was that, within
> importFromWkt(), the pointer was updated to pointer after the consumed
> text. However, I don't still understand why the first *corrected*
> solution does not work properly. I want to reset the geometry of an
> existing feature based on WKT representation. Below are two examples in
> which only the latter one works properly. An example 1 crashes due to
> illegal memory access. geo_trans is a buffer which stores WKT.
> 
> EXAMPLE 1
> =========
> OGRPolygon * poPoly = new OGRPolygon();
> poPoly->importFromWkt( &geo_trans );

Please show your geo_trans declaration and initialization.

> In the comment within the ogrgeometryfactory.cpp it states that
> "createFromWkt() now updates pointer to text to indicate how much text
> was consumed". I understand that this can be useful in many occasions
> although I don't understand why it is implemented this way. Anyway, why
> the first solution does not work?

I believe Frank is able to answer this question.

> In addition, in an example 1 the
> problem occurres only after very many (>million) calls to
> importFromWkt(). Something is happening in the background (related to
> reference counting etc.?) I don't understand.

You mean, you're importing ~1 million geometries from WKT strings?
Are you sure you're doing fresh WKT initialization for every geometry?

Please, show us more complete piece of code, with declarations and
definitions of all variables that play in the example 1.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From packalen at cs.joensuu.fi  Sat Sep  2 11:11:15 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <44F99759.4080202@loskot.net>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<44F99759.4080202@loskot.net>
Message-ID: <Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>

Mateusz

>> Once again, I struggled with the weird problem until I understood to
>> look at the documentation... The problem was that, within
>> importFromWkt(), the pointer was updated to pointer after the consumed
>> text. However, I don't still understand why the first *corrected*
>> solution does not work properly. I want to reset the geometry of an
>> existing feature based on WKT representation. Below are two examples in
>> which only the latter one works properly. An example 1 crashes due to
>> illegal memory access. geo_trans is a buffer which stores WKT.
>>
>> EXAMPLE 1
>> =========
>> OGRPolygon * poPoly = new OGRPolygon();
>> poPoly->importFromWkt( &geo_trans );
>
> Please show your geo_trans declaration and initialization.

WKT_BUF 1000000
char * geo_trans = new char[ WKT_BUF ];

>> In addition, in an example 1 the
>> problem occurres only after very many (>million) calls to
>> importFromWkt(). Something is happening in the background (related to
>> reference counting etc.?) I don't understand.
>
> You mean, you're importing ~1 million geometries from WKT strings?

yes, actually coordinates are read from the shapefile, parsed to WKT, WKT 
coordinates are processed (local affine transformation) and converted back 
to WKT representation. This approch may sound a bit weird but the reason 
for this is that I have previously implemented routines for this WKT 
processing. Millions of shapes is just an extreme case for testing 
purposes (lidar data).

> Are you sure you're doing fresh WKT initialization for every geometry?

geo_trans is allocated only once in the beginning of the function and the 
same chunk is used all the time. I'm sure WKTs are in proper format.

> Please, show us more complete piece of code, with declarations and
> definitions of all variables that play in the example 1.

The code is too length and fragmentd to be pasted here as a whole. The 
latter approch creates correct output. However, now I noticed that there 
may have some memory de-allocation problem with it which lead to another 
question. Because I use SetGeometryDirectly( new_geom ), I don't release 
new_geom explicitly. I have understood OGRFeature::DestroyFeature( poDstFeature ) 
de-allocates it and all other resources it uses. Have I understood it 
correctly?

Best regards,
Petteri


From warmerdam at pobox.com  Sat Sep  2 11:25:04 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
Message-ID: <44F9A250.2070109@pobox.com>

Petteri Packalen wrote:
> In the comment within the ogrgeometryfactory.cpp it states that 
> "createFromWkt() now updates pointer to text to indicate how much text 
> was consumed". I understand that this can be useful in many occasions 
> although I don't understand why it is implemented this way. 

Petteri,

Well, I do regret having implemented it this way.  At the time it seemed
like a good way to preserve the information about how much text was
consumed, but in retrospect that has not proven to be very useful, and
the interface is quite confusing and awkward.

 > Anyway, why
> the first solution does not work? In addition, in an example 1 the 
> problem occurres only after very many (>million) calls to 
> importFromWkt(). Something is happening in the background (related to 
> reference counting etc.?) I don't understand.

The code shown in both cases looks fine.  As Mateusz suggests, I'd guess
the problem lies in some of the code that is not shown.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From packalen at cs.joensuu.fi  Sat Sep  2 12:53:44 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
Message-ID: <Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>

Mateusz, Frank, list,

I prepared the code below that demonstrates an essential part of the 
function in question. There was actually a bug in my first mail in example 
1. Here is the more comprehensive illustration. Thus, although in both 
examples the address of the COPY of the pointer is passed to 
createFromWkt() or importFromWkt() only latter one works properly.

// Some variables needed in the above code.
OGRFeature   *poSrcFeature;
char         *geo_wkt = new char[ WKT_BUF ];
char         *geo_trans = new char[ WKT_BUF ];

// This loop which goes through all OGR features. Partly taken
// from the TranslateLayer() function in ogr2ogr.cpp.
while( TRUE )
{
    OGRFeature *poDstFeature = NULL;

    // Fetch input feature.
    poSrcFeature = poSrcLayer->GetNextFeature();
    if ( poSrcFeature == NULL )
       break;

    if ( ++nFeaturesInTransaction == nGroupTransactions )
    {
       poDstLayer->CommitTransaction();
       poDstLayer->StartTransaction();
       nFeaturesInTransaction = 0;
    }

    // Create output feature based on input feature.
    CPLErrorReset();
    poDstFeature = OGRFeature::CreateFeature( poDstLayer->GetLayerDefn() );
    poDstFeature->SetFrom( poSrcFeature, TRUE );

    // Fetch output geometry ref.
    OGRGeometry *poGeom = poDstFeature->GetGeometryRef();

    // Export geometry to WKT to be transformed.
    poGeom->exportToWkt( &geo_wkt );

    // Transform WKT (it is verified that proper WKT is returned)
    if ( bToEurefJhs154 == true )
       geo_trans = ConvertWktByJhs154ToEuref( geo_wkt );
    else
       geo_trans = ConvertWktByJhs154ToYkj( geo_wkt );

    // Notice that geo_trans should always point to the beginnig
    // of its memory allocation. Therefore, pass a copy of it to
    // the createFromWkt() and importFromWkt().
    char* pszWkt = (char*) geo_trans;

//--> EXAMPLE 1: This does not work (e.g. in the case of point)...
    if ( poGeom->getGeometryType() == wkbPoint )
    {
       OGRPoint *poPoint = new OGRPoint();
       poPoint->importFromWkt( &pszWkt );
       poDstFeature->SetGeometryDirectly( poPoint );
     }
     else
     ...

//--> EXAMPLE 2: but this works.
    OGRSpatialReference *ref = new OGRSpatialReference( NULL );
    OGRGeometry *new_geom;
    OGRGeometryFactory::createFromWkt( &pszWkt, ref, &new_geom );
    poDstFeature->SetGeometryDirectly( new_geom );

    // Destroy source feature.
    OGRFeature::DestroyFeature( poSrcFeature );

    // Write new feature to layer.
    poDstLayer->CreateFeature( poDstFeature );

    // Destroy destination feature.
    OGRFeature::DestroyFeature( poDstFeature );
}

Best regards,
Petteri

On Sat, 2 Sep 2006, Petteri Packalen wrote:

> Frank, list,
>
> Once again, I struggled with the weird problem until I understood to look at 
> the documentation... The problem was that, within importFromWkt(), the 
> pointer was updated to pointer after the consumed text. However, I don't 
> still understand why the first *corrected* solution does not work properly. I 
> want to reset the geometry of an existing feature based on WKT 
> representation. Below are two examples in which only the latter one works 
> properly. An example 1 crashes due to illegal memory access. geo_trans is a 
> buffer which stores WKT.
>
> EXAMPLE 1
> =========
> OGRPolygon * poPoly = new OGRPolygon();
> poPoly->importFromWkt( &geo_trans );
> poDstFeature->SetGeometryDirectly( poPoly );
> ...
> OGRFeature::DestroyFeature( poFeature );
>
> EXAMPLE 2
> =========
> char* pszWkt = (char*) geo_trans;
> OGRSpatialReference *ref = new OGRSpatialReference( NULL );
> OGRGeometry *new_geom;
> OGRErr err = OGRGeometryFactory::createFromWkt(&pszWkt, ref, &new_geom);
> poDstFeature->SetGeometryDirectly( new_geom );
> ...
> OGRFeature::DestroyFeature( poFeature );
>
> In the comment within the ogrgeometryfactory.cpp it states that 
> "createFromWkt() now updates pointer to text to indicate how much text was 
> consumed". I understand that this can be useful in many occasions although I 
> don't understand why it is implemented this way. Anyway, why the first 
> solution does not work? In addition, in an example 1 the problem occurres 
> only after very many (>million) calls to importFromWkt(). Something is 
> happening in the background (related to reference counting etc.?) I don't 
> understand.
>
> Best regards,
> Petteri
>
> =========================================================================
> Petteri Packal?n University of Joensuu Faculty of Forestry P.O. Box 111 80101 
> Joensuu
> Finland e-mail: packalen@cs.joensuu.fi 
> =========================================================================
>
From warmerdam at pobox.com  Sat Sep  2 13:01:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<44F99759.4080202@loskot.net>
	<Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>
Message-ID: <44F9B8EC.30900@pobox.com>

Petteri Packalen wrote:
> WKT_BUF 1000000
> char * geo_trans = new char[ WKT_BUF ];

...
> The code is too length and fragmentd to be pasted here as a whole. The 
> latter approch creates correct output. However, now I noticed that there 
> may have some memory de-allocation problem with it which lead to another 
> question. Because I use SetGeometryDirectly( new_geom ), I don't release 
> new_geom explicitly. I have understood OGRFeature::DestroyFeature( 
> poDstFeature ) de-allocates it and all other resources it uses. Have I 
> understood it correctly?

Petteri,

Yes, that is correct.  You should not need to do anything to deallocate
the geometry after using SetGeometryDirectly().

How do you deallocate geo_trans though?  You can't use delete on the
geo_trans pointer after passing it to ImportFromWkt() since the pointer
is changed by that function.  I suspect this is your problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Sat Sep  2 13:22:55 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<44F99759.4080202@loskot.net>
	<Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>
Message-ID: <44F9BDEF.3030508@loskot.net>

Petteri Packalen wrote:
>>> EXAMPLE 1
>>> =========
>>> OGRPolygon * poPoly = new OGRPolygon();
>>> poPoly->importFromWkt( &geo_trans );
>>
>> Please show your geo_trans declaration and initialization.
> 
> WKT_BUF 1000000
> char * geo_trans = new char[ WKT_BUF ];

Petteri,

It looks good.

As I understand, geo_trans is a buffer to store *single* buffer at time.
Also, I assume you're copying stuff tot the geo_trans buffer
(e.g std::memcpy() or other correct way).
But are you sure you're *reseting* the buffer before copying new stuff?
For example, if onece you have WKT long for 100 characters and
next time you will copy there WKT shorter, e.g. 80 chars long,
then you will have a garbage at the end, so you need to manually
assure there is always null character at the end \0 char.
I'd use std::memset() function from <cstring> library here:

std::memset(geo_trans, 0, WKT_BUF);

called before copying every WKT string into the buffer.

>>> In addition, in an example 1 the
>>> problem occurres only after very many (>million) calls to
>>> importFromWkt(). Something is happening in the background (related to
>>> reference counting etc.?) I don't understand.
>>
>> You mean, you're importing ~1 million geometries from WKT strings?
> 
> yes, actually coordinates are read from the shapefile, parsed to WKT,
> WKT coordinates are processed (local affine transformation) and
> converted back to WKT representation. This approch may sound a bit weird
> but the reason for this is that I have previously implemented routines
> for this WKT processing. Millions of shapes is just an extreme case for
> testing purposes (lidar data).


OK,I don't see anything incorrect here.


>> Are you sure you're doing fresh WKT initialization for every geometry?
> 
> geo_trans is allocated only once in the beginning of the function and
> the same chunk is used all the time. I'm sure WKTs are in proper format.


I'd suspect that may be a problem, please check if you *clear*  the
buffer properly.


>> Please, show us more complete piece of code, with declarations and
>> definitions of all variables that play in the example 1.
> 
> The code is too length and fragmentd to be pasted here as a whole.

Understood.

> The
> latter approch creates correct output. However, now I noticed that there
> may have some memory de-allocation problem with it which lead to another
> question. Because I use SetGeometryDirectly( new_geom ), I don't release
> new_geom explicitly. I have understood OGRFeature::DestroyFeature(
> poDstFeature ) de-allocates it and all other resources it uses. Have I

SetGeometryDirectly transfers ownership of the geometry to instance of
the OGRFeature type on which you call it.
So, if you assign geometry to feature using SetGeometryDirectly,
you don't need to destroy geometry yourself,
destructor of OGRFeature (after you call OGRFeature::DestroyFeature())
will do it for you.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From packalen at cs.joensuu.fi  Sat Sep  2 13:56:34 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <44F9B8EC.30900@pobox.com>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<44F99759.4080202@loskot.net>
	<Pine.GSO.4.61.0609021743510.13704@cs.joensuu.fi>
	<44F9B8EC.30900@pobox.com>
Message-ID: <Pine.GSO.4.61.0609022047330.13704@cs.joensuu.fi>

Frank,

> Yes, that is correct.  You should not need to do anything to deallocate
> the geometry after using SetGeometryDirectly().
>
> How do you deallocate geo_trans though?  You can't use delete on the
> geo_trans pointer after passing it to ImportFromWkt() since the pointer
> is changed by that function.  I suspect this is your problem.

I don't de-allocate it at all, I use the same buffer all the time. There 
was a small bug in my first mail, see the longer version of the code. I 
pass the address of the COPY of the pointer to createFromWkt() or 
importFromWkt(). Thus original pointer always points to the beginning of 
the memory allocation.I will use the *now* working version also later 
because it is more simple (I don't have to instantiate proper geometry type, I may 
use OGRGeometry). I just don't understand why the another approach 
does not work.

Best Regards,
Petteri



From mateusz at loskot.net  Sat Sep  2 17:09:19 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>
Message-ID: <44F9F2FF.8070300@loskot.net>

Petteri Packalen wrote:
> Mateusz, Frank, list,
> 
> I prepared the code below that demonstrates an essential part of the
> function in question. There was actually a bug in my first mail in
> example 1. Here is the more comprehensive illustration. Thus, although
> in both examples the address of the COPY of the pointer is passed to
> createFromWkt() or importFromWkt() only latter one works properly.
> 
> // Some variables needed in the above code.
> OGRFeature   *poSrcFeature;
> char         *geo_wkt = new char[ WKT_BUF ];
> char         *geo_trans = new char[ WKT_BUF ];
> 
> // This loop which goes through all OGR features. Partly taken
> // from the TranslateLayer() function in ogr2ogr.cpp.
> while( TRUE )
> {
>    OGRFeature *poDstFeature = NULL;
> 
>    // Fetch input feature.
>    poSrcFeature = poSrcLayer->GetNextFeature();
>    if ( poSrcFeature == NULL )
>       break;
> 
>    if ( ++nFeaturesInTransaction == nGroupTransactions )
>    {
>       poDstLayer->CommitTransaction();
>       poDstLayer->StartTransaction();
>       nFeaturesInTransaction = 0;
>    }
> 
>    // Create output feature based on input feature.
>    CPLErrorReset();
>    poDstFeature = OGRFeature::CreateFeature( poDstLayer->GetLayerDefn() );
>    poDstFeature->SetFrom( poSrcFeature, TRUE );
> 
>    // Fetch output geometry ref.
>    OGRGeometry *poGeom = poDstFeature->GetGeometryRef();
> 
>    // Export geometry to WKT to be transformed.
>    poGeom->exportToWkt( &geo_wkt );



If this is your complete set of operations, I don't see that you're
clearing the geo_trans buffer between filling it with exportToWkt().

So, you likely are getting garbage from previous WKT if the latter
is shorter than previous.

Here is small case study that presents my considerations:

//////////////////////////////////////////////////////////////////////
// Compile:
// g++ -Wall -pedantic -ansi -o newedchar newedchar.cpp

#include <iostream>
#include <cstring>
#include <cassert>

void print_data(const char* data, std::size_t size)
{
    assert(0 != data);

    std::cout << "------ START (size=" << size - 1 << ") ------\n";

    for (std::size_t i = 0; i != size - 1; ++i)
        std::cout << data[i] << " , ";

    std::cout << "\n------ END ------\n\n";
}

int main()
{
    // Short data source
    const std::size_t shortSize = 5;
    const char shortData[] = "12345"; // 5 elements + null

    // Long data source
    const std::size_t longSize = 8;
    const char longData[] = "abcdefgh"; // 8 elements + null

    // Destination buffer
    const std::size_t size = 15; // 14 elements + null
    char* dest = new char[size]; // filled with 0

    const char* p = 0; // iterator used to print, 'dest' stays unchanged

    // Copy long data to common buffer
    std::memcpy(dest, longData, longSize);

    p = dest;
    print_data(p, size);

    // DON'T CLEAN THE BUFFER (uncomment to clear buffer in next run)
    // std::memset(dest, 0, size);

    // Copy short data to common buffer
    std::memcpy(dest, shortData, shortSize);

    p = dest;
    print_data(dest, size);

    delete[] dest;

    return 0;
}
//////////////////////////////////////////////////////////////////////




And here is the output of this program:

mloskot:~$ ./bufftest
------ START (size=14) ------
a , b , c , d , e , f , g , h ,  ,  ,  ,  ,  ,  ,
------ END ------

------ START (size=14) ------
1 , 2 , 3 , 4 , 5 , f , g , h ,  ,  ,  ,  ,  ,  ,
------ END ------


The first buffer print is correct, it includes what we expect.
The second print is incorrect, it includes *garbage*, previous
content of buffer:

1 , 2 , 3 , 4 , 5 , f , g , h ,  ,  ,  ,  ,  ,  ,
-------------------^^^^^^^^^^^ - GARBAGE



But the correct and safe result should look as follows:

------ START (size=14) ------
a , b , c , d , e , f , g , h ,  ,  ,  ,  ,  ,  ,
------ END ------

------ START (size=14) ------
1 , 2 , 3 , 4 , 5 ,  ,  ,  ,  ,  ,  ,  ,  ,  ,
------ END ------


I hope it helps.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Sat Sep  2 17:53:25 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
Message-ID: <44F9FD55.9000806@pobox.com>

GDAL PSC Members,

I am motioning for Tamas Szekeres to be given GDAL committer access.

My intention is that Tamas would take responsible for getting the GDAL
C# bindings working properly.  He submitted some patches months ago which
I have neglected, and the component clearly needs an "owner".  Tamas has
been a great asset to MapServer with his support of the c# bindings.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Sat Sep  2 17:55:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDALDataset as a Base Class
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027856F@pj-exchange.photon.com>
References: <6FD7C9DB26540B42A1207C69BF92D45501CE6374@Iris.ad.clarku.edu>	<44F6FCDD.50308@loskot.net>	<0719BE42F22E0A46857DF72644EC5D7027856B@pj-exchange.photon.com>	<44F86218.1080304@tkk.fi>	<0719BE42F22E0A46857DF72644EC5D7027856D@pj-exchange.photon.com>	<44F89849.6020601@loskot.net>
	<0719BE42F22E0A46857DF72644EC5D7027856F@pj-exchange.photon.com>
Message-ID: <44F9FDCA.2040905@loskot.net>

Matt Hanson wrote:
> Obviously by making GImage a template it assumes, or
> rather makes, all bands of the same data type

IMHO it's not so obvious and fixed.
I think I understand your idea but I'm not able to talk
about it in details.
Generally, you can use template to generate type and algorithms
appropriate for particular enumerator from GDALDataType.
Shortly, or very shortly, template may be used in place of
switch expression, to make type decisions in compile time.

One of techniques are metafunctions, or type functions in other words.
For example, you can generate concrete type based on decisions like
if A is of type of X do ... else do ...

IMO MPL library (http://www.boost.org/libs/mpl/) is a
good place to start, especially
http://www.boost.org/libs/mpl/doc/refmanual/metafunctions.html

> 2 - Try and look up and return a typename based on the GDALDatatype
> enum.  This means parsing the file and returning a typename, then the
> user can use typename to instantiate a GImage object.  This is a very
> difficult thing to do, even if it is possible.   I think that
> something similar to the ideas presented here: 
> http://www.accu-usa.org/2000-05-Main.html may work.   At the very
> least this approach requires pre-instantiated GImage classes of all
> the datatypes GDAL supports.  i.e. typedef GImage<short> int16GImage;
>  typedef CImage<double> doubleGImage; and so on.

CImage may be a like std::vector<T>, where user specifies T
passing appropriate type. You can add some compile-time checks
and "if's", etc. using metafunctions.
Simply, you can generate the code based on user's type selection.

I know I'm giving general ideas, but it's a nice piece of design
and sorry I am not able consider all details of it.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From packalen at cs.joensuu.fi  Sun Sep  3 03:01:28 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <44F9F2FF.8070300@loskot.net>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>
	<44F9F2FF.8070300@loskot.net>
Message-ID: <Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>

Hi,

Unfortunately this is not the problem, WKT strings are in correct 
format. geo_trans is a global variable which is filled within 
ConvertWktByJhs154ToEuref(). Note that example 2 works perfectly.

Best regards,
Petteri

> Petteri Packalen wrote:
>> Mateusz, Frank, list,
>>
>> I prepared the code below that demonstrates an essential part of the
>> function in question. There was actually a bug in my first mail in
>> example 1. Here is the more comprehensive illustration. Thus, although
>> in both examples the address of the COPY of the pointer is passed to
>> createFromWkt() or importFromWkt() only latter one works properly.
>>
>> // Some variables needed in the above code.
>> OGRFeature   *poSrcFeature;
>> char         *geo_wkt = new char[ WKT_BUF ];
>> char         *geo_trans = new char[ WKT_BUF ];
>>
>> // This loop which goes through all OGR features. Partly taken
>> // from the TranslateLayer() function in ogr2ogr.cpp.
>> while( TRUE )
>> {
>>    OGRFeature *poDstFeature = NULL;
>>
>>    // Fetch input feature.
>>    poSrcFeature = poSrcLayer->GetNextFeature();
>>    if ( poSrcFeature == NULL )
>>       break;
>>
>>    if ( ++nFeaturesInTransaction == nGroupTransactions )
>>    {
>>       poDstLayer->CommitTransaction();
>>       poDstLayer->StartTransaction();
>>       nFeaturesInTransaction = 0;
>>    }
>>
>>    // Create output feature based on input feature.
>>    CPLErrorReset();
>>    poDstFeature = OGRFeature::CreateFeature( poDstLayer->GetLayerDefn() );
>>    poDstFeature->SetFrom( poSrcFeature, TRUE );
>>
>>    // Fetch output geometry ref.
>>    OGRGeometry *poGeom = poDstFeature->GetGeometryRef();
>>
>>    // Export geometry to WKT to be transformed.
>>    poGeom->exportToWkt( &geo_wkt );
>
>
>
> If this is your complete set of operations, I don't see that you're
> clearing the geo_trans buffer between filling it with exportToWkt().
>
> So, you likely are getting garbage from previous WKT if the latter
> is shorter than previous.
>
> Here is small case study that presents my considerations:
>
> //////////////////////////////////////////////////////////////////////
> // Compile:
> // g++ -Wall -pedantic -ansi -o newedchar newedchar.cpp
>
> #include <iostream>
> #include <cstring>
> #include <cassert>
>
> void print_data(const char* data, std::size_t size)
> {
>    assert(0 != data);
>
>    std::cout << "------ START (size=" << size - 1 << ") ------\n";
>
>    for (std::size_t i = 0; i != size - 1; ++i)
>        std::cout << data[i] << " , ";
>
>    std::cout << "\n------ END ------\n\n";
> }
>
> int main()
> {
>    // Short data source
>    const std::size_t shortSize = 5;
>    const char shortData[] = "12345"; // 5 elements + null
>
>    // Long data source
>    const std::size_t longSize = 8;
>    const char longData[] = "abcdefgh"; // 8 elements + null
>
>    // Destination buffer
>    const std::size_t size = 15; // 14 elements + null
>    char* dest = new char[size]; // filled with 0
>
>    const char* p = 0; // iterator used to print, 'dest' stays unchanged
>
>    // Copy long data to common buffer
>    std::memcpy(dest, longData, longSize);
>
>    p = dest;
>    print_data(p, size);
>
>    // DON'T CLEAN THE BUFFER (uncomment to clear buffer in next run)
>    // std::memset(dest, 0, size);
>
>    // Copy short data to common buffer
>    std::memcpy(dest, shortData, shortSize);
>
>    p = dest;
>    print_data(dest, size);
>
>    delete[] dest;
>
>    return 0;
> }
> //////////////////////////////////////////////////////////////////////
>
>
>
>
> And here is the output of this program:
>
> mloskot:~$ ./bufftest
> ------ START (size=14) ------
> a , b , c , d , e , f , g , h ,  ,  ,  ,  ,  ,  ,
> ------ END ------
>
> ------ START (size=14) ------
> 1 , 2 , 3 , 4 , 5 , f , g , h ,  ,  ,  ,  ,  ,  ,
> ------ END ------
>
>
> The first buffer print is correct, it includes what we expect.
> The second print is incorrect, it includes *garbage*, previous
> content of buffer:
>
> 1 , 2 , 3 , 4 , 5 , f , g , h ,  ,  ,  ,  ,  ,  ,
> -------------------^^^^^^^^^^^ - GARBAGE
>
>
>
> But the correct and safe result should look as follows:
>
> ------ START (size=14) ------
> a , b , c , d , e , f , g , h ,  ,  ,  ,  ,  ,  ,
> ------ END ------
>
> ------ START (size=14) ------
> 1 , 2 , 3 , 4 , 5 ,  ,  ,  ,  ,  ,  ,  ,  ,  ,
> ------ END ------
>
>
> I hope it helps.
>
> Cheers
> -- 
> Mateusz Loskot
> http://mateusz.loskot.net
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From mateusz at loskot.net  Sun Sep  3 10:34:03 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>
	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>
	<44F9F2FF.8070300@loskot.net>
	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>
Message-ID: <44FAE7DB.1050101@loskot.net>

Petteri Packalen wrote:
> 
> Unfortunately this is not the problem, WKT strings are in correct
> format. geo_trans is a global variable which is filled within
> ConvertWktByJhs154ToEuref(). Note that example 2 works perfectly.

Petteri,

I'm inclined to state that OGR works perfectly and the problem
is somewhere in your code.
However, it's very hard to point out where is the problem.
Your latest snipped may be correct as you assembled it from various
files of your code, but your original "big" application may work
incorrectly.

Also, semantically, there is no difference between using:
poPoly->importFromWkt( &geo_trans );
and using
OGRErr err = OGRGeometryFactory::createFromWkt(&pszWkt, ref, &new_geom);

The latter is just a short of the former - user does not need to
allocate geometry, the factory will do it.

I checked "mass generation" of shapes using techniques from the 1st
example from your initial post, the one that's not working
for you - poPoly->importFromWkt...

I generate 1 billion of features and it works perfectly, without
any segmentation faults, illegal memory access or memory leaks
(see below).

////////////////////////////////////////////////////////////////////////////////
// importwkt.cpp - test of non-factory-based importFromWkt()
// Compile:
// g++ -g -Wall -Wno-long-long -pedantic importwkt.cpp
//     -o importwkt -lgdal -lgeos_c -lgeos
//
#include <ogr_geometry.h>
#include <ogrsf_frmts.h>
#include <cassert>
#include <cstdio>  // printf(), sprintf()
#include <cstdlib> // srand(), rand()
#include <ctime>   // time()

int main(int argc, char* argv[])
{
    // No specific options, just run with some dummy argument(s)
    // ./importwkt blabla
    // to run in verbose mode or without any arguments to run in
    // dotted mode + summary:
    // ./importwkt
    //
    bool verbose = false;
    if (argc != 1)
    {
        verbose = true;
    }

    // CHANGE nFeaturesMax TO TEST VARIOUS CASES
    const std::size_t nFeaturesMax = 1000000; // max number of features

    const char *pszDriverName = "ESRI Shapefile";
    OGRSFDriver *poDriver = NULL;
    OGRErr rc = OGRERR_NONE;

    OGRRegisterAll();

    // Driver
    poDriver =
OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName);
    assert(NULL != poDriver);

    // Data source
    OGRDataSource *poDS = poDriver->CreateDataSource("testimpwkt.shp",
NULL);
    assert(NULL != poDS && "Can not create shapefile!");

    // Layer
    OGRLayer *poLayer = poDS->CreateLayer("testimpwkt", NULL,
wkbPolygon, NULL);
    assert(NULL != poLayer && "Can not create layer!");

    // Field
    const std::size_t fieldSize = 40;
    OGRFieldDefn oField("Name", OFTString);
    oField.SetWidth(fieldSize - 1);
    rc = poLayer->CreateField( &oField );
    assert(OGRERR_NONE == rc && "Can not create field!");

    // Generate nFeaturesMax number of features
    std::srand(std::time(NULL)); // we will try to generate random
coordinates
    const int coordMax = 1000; // max coord value
    const int coordMin = 10;   // min coord value

    // WKT buffer
    const std::size_t wktSize = 100; // max WKT length
    char wkt[wktSize] = { 0 };

    std::size_t nCount = 0;
    while (nCount < nFeaturesMax)
    {
        std::size_t ret = 0;

        // Feature
        OGRFeature *poFeature = new OGRFeature(poLayer->GetLayerDefn());

        // Attribute
        char name[fieldSize]= { 0 };
        ret = sprintf(name, "Feature %d", nCount);;
        assert(fieldSize >= ret);
        poFeature->SetField( "Name", name );

        // Geometry

        // Just to make coords less tedious ;-)
        int coord = (std::rand() % (coordMax - coordMin + 1)) + coordMin;

        // let's be a bit more defensive
        // NOTE: it can be safely commented
        memset(wkt, 0, wktSize);

        ret = sprintf(wkt, "POLYGON ((0 0 %u, %u 0 5, %u %u 5, 0 %u 5))",
                      coord, coord, coord, coord, coord);
        assert(wktSize >= ret);

        OGRPolygon* poPoly = new OGRPolygon();

        char* ptr = wkt;
        poPoly->importFromWkt(&ptr);
        poFeature->SetGeometryDirectly( poPoly ); // transfer geom
ownership to the feature

        // Create Feature
        rc = poLayer->CreateFeature(poFeature);
        assert(OGRERR_NONE == rc && "Can not create feature!");

        // Control output
        if (verbose)
            printf("%s: Geometry: %s\n", name, poPoly->getGeometryName());
        else
            printf(".");

        delete poFeature; // also frees geometry
        ++nCount;
    }

    printf("\nSuccessfully saved %d features\n", nCount);

    // Close data source
    OGRDataSource::DestroyDataSource( poDS );
}
////////////////////////////////////////////////////////////////////////////////

Last lines of output:

........................................
Successfully saved 1000000 features
mloskot:~/dev/gdal/test$ ls -lh testimpwkt.*
-rw-r--r-- 1 mloskot mloskot  39M 2006-09-03 16:18 testimpwkt.dbf
-rw-r--r-- 1 mloskot mloskot 115M 2006-09-03 16:18 testimpwkt.shp
-rw-r--r-- 1 mloskot mloskot 7.7M 2006-09-03 16:18 testimpwkt.shx



Now, what valgrind says about it (see LEAK SUMMARY):

...
Feature 9995: Geometry: POLYGON
Feature 9996: Geometry: POLYGON
Feature 9997: Geometry: POLYGON
Feature 9998: Geometry: POLYGON
Feature 9999: Geometry: POLYGON
==6766==
==6766== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 75 from 1)
==6766== malloc/free: in use at exit: 3,723 bytes in 43 blocks.
==6766== malloc/free: 230,162 allocs, 230,119 frees, 10,970,713 bytes
allocated.
==6766== For counts of detected errors, rerun with: -v
==6766== searching for pointers to 43 not-freed blocks.
==6766== checked 2,427,092 bytes.
==6766==
==6766== LEAK SUMMARY:
==6766==    definitely lost: 0 bytes in 0 blocks.
==6766==      possibly lost: 0 bytes in 0 blocks.
==6766==    still reachable: 3,723 bytes in 43 blocks.
==6766==         suppressed: 0 bytes in 0 blocks.
==6766== Reachable blocks (those to which a pointer was found) are not
shown.
==6766== To see them, rerun with: --show-reachable=yes



I'm sorry, but I'm completely out of concepts what is going wrong
with your code.
The only possibility I see to run and check your code with
input datasets you're using.

Are you running your code on Windows with DLLs?
If you are, then may be you're dealing with "passing objects across DLL
boundaries" issue.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From hobu at iastate.edu  Sun Sep  3 16:15:23 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <44F9FD55.9000806@pobox.com>
References: <44F9FD55.9000806@pobox.com>
Message-ID: <p06230901c120e8091175@[192.168.182.8]>

+1.  Tamas does a great job on the MapScript bindings.  He is 
courteous with commits, explicit with bug reports, and hopefully can 
bring some more life (and typemaps!) to the C# GDAL bindings.

Howard

At 5:53 PM -0400 9/2/06, Frank Warmerdam wrote:
>GDAL PSC Members,
>
>I am motioning for Tamas Szekeres to be given GDAL committer access.
>
>My intention is that Tamas would take responsible for getting the GDAL
>C# bindings working properly.  He submitted some patches months ago which
>I have neglected, and the component clearly needs an "owner".  Tamas has
>been a great asset to MapServer with his support of the c# bindings.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Sun Sep  3 18:34:16 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Memory leak under Matlab (a follow up from -
	importFromWkt() problem)
In-Reply-To: <44FAE7DB.1050101@loskot.net>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>
	<44FAE7DB.1050101@loskot.net>
Message-ID: <44FB5868.7030003@ualg.pt>


Hi,
I was following this thread with a particular interest due to another 
problem.
I wrote a OGR based Matlab MEX file to do coordinate conversions.
Well the thing works well but has a small memory leak. Though small, the 
leak
is sufficiently important to prevent the use of that program when 
attached to mouse
movements (it accumulates fast).

Now given the valgrind report about the test prog "importwkt" I 
converted it into a ML
mex and, ... the memory leak is still there.
To be honest a similar story happened with a GMT based mex file to do 
also coordinate
conversions, so I'm starting to lean to the probability that the problem 
might be on the Matlab
side (a third attempt with a OpenCV mex also reveals some memory leak) .

However, guessing that it wont be nothing at all easy to convince 
Mathworks about this problem
I'm asking here about the chances that it might be a GDAL memory leak.

Thanks

Joaquim Luis

> Now, what valgrind says about it (see LEAK SUMMARY):
>
> ==6766==
> ==6766== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 75 from 1)
> ==6766== malloc/free: in use at exit: 3,723 bytes in 43 blocks.
> ==6766== malloc/free: 230,162 allocs, 230,119 frees, 10,970,713 bytes
> allocated.
> ==6766== For counts of detected errors, rerun with: -v
> ==6766== searching for pointers to 43 not-freed blocks.
> ==6766== checked 2,427,092 bytes.
> ==6766==
> ==6766== LEAK SUMMARY:
> ==6766==    definitely lost: 0 bytes in 0 blocks.
> ==6766==      possibly lost: 0 bytes in 0 blocks.
> ==6766==    still reachable: 3,723 bytes in 43 blocks.
> ==6766==         suppressed: 0 bytes in 0 blocks.
> ==6766== Reachable blocks (those to which a pointer was found) are no


From mateusz at loskot.net  Mon Sep  4 00:06:15 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: Memory leak under Matlab (a follow up from -
 importFromWkt() problem)
In-Reply-To: <44FB5868.7030003@ualg.pt>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>
	<44FAE7DB.1050101@loskot.net> <44FB5868.7030003@ualg.pt>
Message-ID: <44FBA637.8080000@loskot.net>

Joaquim Luis wrote:
> 
> Hi, I was following this thread with a particular interest due to 
> another problem. I wrote a OGR based Matlab MEX file to do coordinate
>  conversions. Well the thing works well but has a small memory leak. 
> Though small, the leak is sufficiently important to prevent the use 
> of that program when attached to mouse movements (it accumulates 
> fast).

Joaquin,

Sounds strange. Is there any chance you're misusing MEX memory
management functions or may be you're following one of MATLAB
buggy examples, like:
http://www.mathworks.com/support/solutions/data/1-1NOXOX.html

May be you're using mexMakeMemoryPersistent in loop or similar call,
so memory is not cleared after your MEX is unloaded.
Note, it's only my surmise.

> Now given the valgrind report about the test prog "importwkt" I 
> converted it into a ML mex and, ... the memory leak is still there. 
> To be honest a similar story happened with a GMT based mex file to do
>  also coordinate conversions, so I'm starting to lean to the 
> probability that the problem might be on the Matlab side (a third 
> attempt with a OpenCV mex also reveals some memory leak) .

Are you using MATLAB on Windows?
Have you tried to run your MEX with a memory leak checker attached?
If you're using MATLAB on Windows, I'd try to build MEX dll with
VLD leak detector [1] but I'm not sure if it will give you usable
and meaningful report when working with MATLAB.

[1] http://www.codeproject.com/tools/visualleakdetector.asp

Another option is to do some simple  tests of memory
allocation/deallocation and observe how MATLAB will behave.

> However, guessing that it wont be nothing at all easy to convince 
> Mathworks about this problem I'm asking here about the chances that 
> it might be a GDAL memory leak.

IMHO contacting Mathworks support and sending them your MEX code
would be the easiest, but I don't know if effective.

There are chances for memory leaks in GDAL as in every other piece
software. Not much helpful, but thats all I can say.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From zhonghaiw at gmail.com  Mon Sep  4 03:13:38 2006
From: zhonghaiw at gmail.com (Zhonghai Wang)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <p06230901c120e8091175@192.168.182.8>
References: <44F9FD55.9000806@pobox.com> <p06230901c120e8091175@192.168.182.8>
Message-ID: <2534c4120609040013u6d0a9d82rcf423a98a82515d6@mail.gmail.com>

+1, we really need a GURU in C#  things.

zhonghai

On 9/3/06, Howard Butler <hobu@iastate.edu> wrote:
>
> +1.  Tamas does a great job on the MapScript bindings.  He is
> courteous with commits, explicit with bug reports, and hopefully can
> bring some more life (and typemaps!) to the C# GDAL bindings.
>
> Howard
>
> At 5:53 PM -0400 9/2/06, Frank Warmerdam wrote:
> >GDAL PSC Members,
> >
> >I am motioning for Tamas Szekeres to be given GDAL committer access.
> >
> >My intention is that Tamas would take responsible for getting the GDAL
> >C# bindings working properly.  He submitted some patches months ago which
> >I have neglected, and the component clearly needs an "owner".  Tamas has
> >been a great asset to MapServer with his support of the c# bindings.
> >
> >Best regards,
> >--
>
> >---------------------------------------+--------------------------------------
> >I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> >light and sound - activate the windows | http://pobox.com/~warmerdam
> >and watch the world go round - Rush    | President OSGeo,
> http://osgeo.org
> >
> >_______________________________________________
> >Gdal-dev mailing list
> >Gdal-dev@lists.maptools.org
> >http://lists.maptools.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060904/18bc478b/attachment.html
From dpinte at itae.be  Mon Sep  4 06:25:24 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
Message-ID: <1157365525.23753.33.camel@geru-itae>

Hi,

Since the update of my debian package to the latest python-gdal bindings
(1.3.2-2). I have the following problem when reading features from a
shapefile :

ERROR 1: GEOSException: ParseException: Expected number but encountered
','

when my code calling :

found = gbuffer.is_disjoint(geometry)

or

intersection = gbuffer.intersect(geometry)

I have googled a bit about the problem but found nothing. The libgdal1
is linked with geos 2.2.1-1 (that did not change since January 2006
according to the changelog). I suppose there was a change on the ogr
part. 

Any hint to solve the problem ?

Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060904/2fb7320c/attachment.bin
From dpinte at itae.be  Mon Sep  4 09:50:58 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <1157365525.23753.33.camel@geru-itae>
References: <1157365525.23753.33.camel@geru-itae>
Message-ID: <1157377858.2561.4.camel@geru-itae>

Le lundi 04 septembre 2006 ? 12:25 +0200, Didrik Pinte a ?crit :
> Any hint to solve the problem ?

Because of a problem between gdalnumeric and python-numpy, I have
uninstalled the following packages and kept only python-numeric :

apt-get remove python-numpy python-numpy-ext python-scipy fftw3

It solved the problem ! That's strange. When looking a the org.py code
of Disjoint, I'm wondering where I can find a link between the python
libs and the _gdal code :
----------------------------------------------------------------------
   def Disjoint( self, other_geom ):
        return _gdal.OGR_G_Disjoint( self._o, other_geom._o )
----------------------------------------------------------------------

Didrik
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: Ceci est une partie de message
	=?ISO-8859-1?Q?num=E9riquement?= =?ISO-8859-1?Q?_sign=E9e?=
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060904/1fd3b0fc/attachment.bin
From warmerdam at pobox.com  Mon Sep  4 10:44:48 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <1157377858.2561.4.camel@geru-itae>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae>
Message-ID: <44FC3BE0.7070704@pobox.com>

Didrik Pinte wrote:
> Le lundi 04 septembre 2006 ? 12:25 +0200, Didrik Pinte a ?crit :
>> Any hint to solve the problem ?
> 
> Because of a problem between gdalnumeric and python-numpy, I have
> uninstalled the following packages and kept only python-numeric :
> 
> apt-get remove python-numpy python-numpy-ext python-scipy fftw3

Didrik,

Well, I wouldn't have imagined this connection!

> It solved the problem ! That's strange. When looking a the org.py code
> of Disjoint, I'm wondering where I can find a link between the python
> libs and the _gdal code :
> ----------------------------------------------------------------------
>    def Disjoint( self, other_geom ):
>         return _gdal.OGR_G_Disjoint( self._o, other_geom._o )
> ----------------------------------------------------------------------

This would appear to be from the 'old style' python bindings.

For these there is a gdal.i interface file which swig (1.1) turns into a
gdal_wrap.c with C-to-python wrappers for all the published functions.
This compiles to _gdalmodule.so on unix.  So the python wrapper layer in
ogr.py imports _gdal and then calls the C functions in it.

Does that answer your question?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dpinte at itae.be  Mon Sep  4 10:55:17 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <44FC3BE0.7070704@pobox.com>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae>  <44FC3BE0.7070704@pobox.com>
Message-ID: <1157381717.2561.21.camel@geru-itae>

Le lundi 04 septembre 2006 ? 10:44 -0400, Frank Warmerdam a ?crit :
> Didrik Pinte wrote:
> > Le lundi 04 septembre 2006 ? 12:25 +0200, Didrik Pinte a ?crit :
> >> Any hint to solve the problem ?
> > 
> > Because of a problem between gdalnumeric and python-numpy, I have
> > uninstalled the following packages and kept only python-numeric :
> > 
> > apt-get remove python-numpy python-numpy-ext python-scipy fftw3
> 
> Didrik,
> 
> Well, I wouldn't have imagined this connection!

Nor do I ;-)

> > It solved the problem ! That's strange. When looking a the org.py code
> > of Disjoint, I'm wondering where I can find a link between the python
> > libs and the _gdal code :
> > ----------------------------------------------------------------------
> >    def Disjoint( self, other_geom ):
> >         return _gdal.OGR_G_Disjoint( self._o, other_geom._o )
> > ----------------------------------------------------------------------
> 
> This would appear to be from the 'old style' python bindings.
> 
> For these there is a gdal.i interface file which swig (1.1) turns into a
> gdal_wrap.c with C-to-python wrappers for all the published functions.
> This compiles to _gdalmodule.so on unix.  So the python wrapper layer in
> ogr.py imports _gdal and then calls the C functions in it.
> 
> Does that answer your question?

For sure. Thank you for the clear explanation. That's what I thought
some minutes after having sent the message. 

I've suggested that the debian package python-gdal conflict with
python-numpy in order to get a working system in any case (this will
appear in the debian bts today).

Mateusz, did you had time to work on the ng bindings ? Do you need
help ?

Best regards,

Didrik


From C.Strobl at dlr.de  Mon Sep  4 11:12:44 2006
From: C.Strobl at dlr.de (C.Strobl@dlr.de)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] gdal and hdf
Message-ID: <9773EFADA4FF6C43A49824D50B1539A7017300F7@exbe04.intra.dlr.de>

 
hello all,
 
i am working with den fwtools (GDAL 1.3.2.0, FWTools 1.0.5, released
2006/07/06) and i don't get it to convert hdf-files with gdal,
especially handling subsets didn't work. here is the description what i
tried. i tested aster- and modis-hdf4-files
 
Aster Level 1B
Data:
http://edcftp.cr.usgs.gov/pub/data/disaster/katrina/aster_L1B/AST_L1BE00
3090320051623270000000.tar.gz
<http://edcftp.cr.usgs.gov/pub/data/disaster/katrina/aster_L1B/AST_L1BE0
03090320051623270000000.tar.gz> 

 
gdalinfo -nogcp -nomd
"E:\usgs\aster\AST_L1BE003090320051623270000000.hdf"
 
Driver: HDF4/Hierarchical Data Format Release 4
Size is 512, 512
Coordinate System is `'
Subdatasets:
 
SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"E:\usgs\aster\AST_L1BE003090320051
623270
000000.hdf":VNIR_Swath:ImageData1
  SUBDATASET_1_DESC=[4200x4980] ImageData1 (8-bit unsigned integer)
 
SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"E:\usgs\aster\AST_L1BE003090320051
623270
000000.hdf":VNIR_Swath:ImageData2
  SUBDATASET_2_DESC=[4200x4980] ImageData2 (8-bit unsigned integer)
 
SUBDATASET_3_NAME=HDF4_EOS:EOS_SWATH:"E:\usgs\aster\AST_L1BE003090320051
623270
000000.hdf":VNIR_Swath:ImageData3N
  SUBDATASET_3_DESC=[4200x4980] ImageData3N (8-bit unsigned integer)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)
 
--------------------------------------------------
 
#gdal_translate
gdal_translate -of GTiff
"E:\usgs\aster\AST_L1BE003090320051623270000000.hdf"
e:\usgs\aster\AST_L1BE003090320051623270000000.tif
Input file contains subdatasets. Please, select one of them for reading.
 
--------------------------------------------------
 
analogue to the description given at
http://www.remotesensing.org/gdal/frmt_hdf4.html
<http://www.remotesensing.org/gdal/frmt_hdf4.html>  i tested gdalinfo
for subdatasets
 

gdalinfo
HDF4_EOS:EOS_SWATH:E:\usgs\aster\AST_L1BE003090320051623270000000.hdf:VN
IR_Swath:ImageData3N
 
and also some variations:
gdalinfo
HDF4_EOS:EOS_SWATH:"E:\usgs\aster\AST_L1BE003090320051623270000000.hdf":
VNIR_Swath:ImageData3N
gdalinfo
"HDF4_EOS:EOS_SWATH:E:\usgs\aster\AST_L1BE003090320051623270000000.hdf:V
NIR_Swath:ImageData3N"
gdalinfo
'HDF4_EOS:EOS_SWATH:E:\usgs\aster\AST_L1BE003090320051623270000000.hdf:V
NIR_Swath:ImageData3N'
 
--------------------------------------------------
 
nothing worked at all. so i tested a modis-file
 
 
MODIS Level 1B
 
Data:
http://outreach.eos.nasa.gov/Terra_CD-01/meta/modis/subset_MOD02_243.185
0.hdf
<http://outreach.eos.nasa.gov/Terra_CD-01/meta/modis/subset_MOD02_243.18
50.hdf> 
 
#without GCP(-nogcp) und metadata(-nomd)
gdalinfo -nogcp -nomd "E:\usgs\modis\subset_MOD02_243.1850.hdf"
 
Driver: HDF4/Hierarchical Data Format Release 4
Size is 512, 512
Coordinate System is `'
Subdatasets:
 
SUBDATASET_1_NAME=HDF4_EOS:EOS_SWATH:"E:\usgs\modis\subset_MOD02_243.185
0.hdf"
:MODIS_SWATH_Type_L1B:EV_250_Aggr1km_RefSB
  SUBDATASET_1_DESC=[2x2030x1354] EV_250_Aggr1km_RefSB (16-bit unsigned
integer)
 
 
SUBDATASET_2_NAME=HDF4_EOS:EOS_SWATH:"E:\usgs\modis\subset_MOD02_243.185
0.hdf"
:MODIS_SWATH_Type_L1B:EV_500_Aggr1km_RefSB
  SUBDATASET_2_DESC=[5x2030x1354] EV_500_Aggr1km_RefSB (16-bit unsigned
integer)
 
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)
 
--------------------------------------------------
 
#gdal_translate
gdal_translate -of GTiff "E:\usgs\modis\subset_MOD02_243.1850.hdf"
e:\usgs\modis\subset_MOD02_243.1850.tif
Input file contains subdatasets. Please, select one of them for reading.
 
--------------------------------------------------
 
analogue to the description given at
http://www.remotesensing.org/gdal/frmt_hdf4.html
<http://www.remotesensing.org/gdal/frmt_hdf4.html>  i tested gdalinfo
for subdatasets
 

gdalinfo
HDF4_EOS:EOS_SWATH:E:\usgs\modis\subset_MOD02_243.1850.hdf:MODIS_SWATH_T
ype_L1B:EV_250_Aggr1km_RefSB
 
--------------------------------------------------
 
there were the same problems i had already with the aster-files
 
 
last i tried the sample files from
ftp://ftp.remotesensing.org/gdal/data/hdf4/
 
 
gdalinfo -nogcp -nomd
D:\user\OpenSource\Data\gdal\MO36MW14.chlor_MODIS.ADD2001089.004.2002186
190207.hdf
 
Driver: HDF4Image/HDF4 Dataset
Size is 1024, 512
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right ( 1024.0,    0.0)
Lower Right ( 1024.0,  512.0)
Center      (  512.0,  256.0)
Band 1 Block=1024x1 Type=UInt16, ColorInterp=Gray
 

gdalinfo -nogcp -nomd
D:\user\OpenSource\Data\gdal\S2002196124536.L1A_HDUN.BartonBendish.extra
ct.hdf
 
Driver: HDF4Image/HDF4 Dataset
Size is 320, 352
Coordinate System is `'
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  352.0)
Upper Right (  320.0,    0.0)
Lower Right (  320.0,  352.0)
Center      (  160.0,  176.0)
Band 1 Block=320x1 Type=Int16, ColorInterp=Gray
Band 2 Block=320x1 Type=Int16, ColorInterp=Gray
Band 3 Block=320x1 Type=Int16, ColorInterp=Gray
Band 4 Block=320x1 Type=Int16, ColorInterp=Gray
Band 5 Block=320x1 Type=Int16, ColorInterp=Gray
Band 6 Block=320x1 Type=Int16, ColorInterp=Gray
Band 7 Block=320x1 Type=Int16, ColorInterp=Gray
Band 8 Block=320x1 Type=Int16, ColorInterp=Gray
 

Both datasets have no subdatasets, so also the gdal_translate works
 
gdal_translate -of GTiff
D:\user\OpenSource\Data\gdal\MO36MW14.chlor_MODIS.ADD2001089.004.2002186
190207.hdf
D:\user\OpenSource\Data\gdal\MO36MW14.chlor_MODIS.ADD2001089.004.2002186
190207.tif
gdal_translate -of GTiff
D:\user\OpenSource\Data\gdal\S2002196124536.L1A_HDUN.BartonBendish.extra
ct.hdf
D:\user\OpenSource\Data\gdal\S2002196124536.L1A_HDUN.BartonBendish.extra
ct.tif
 
the problem: the second result-file i can't view with a normal image
software like irfanview or photoshop, but for example with erdas. ok,
thats not so important for me now. i think i make some mistake with the
syntax defining the datasubsets. maybe somebody can help me, maybe its a
windows special like ogr and vpf.
 
thanks and greetings from munich
christian
 
 
 
 
 
 
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060904/e8467509/attachment.html
From dmorissette at mapgears.com  Mon Sep  4 12:29:05 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <44F9FD55.9000806@pobox.com>
References: <44F9FD55.9000806@pobox.com>
Message-ID: <44FC5451.7080601@mapgears.com>

Frank Warmerdam wrote:
> 
> I am motioning for Tamas Szekeres to be given GDAL committer access.
> 
> My intention is that Tamas would take responsible for getting the GDAL
> C# bindings working properly.  He submitted some patches months ago which
> I have neglected, and the component clearly needs an "owner".  Tamas has
> been a great asset to MapServer with his support of the c# bindings.
> 

+1. Tamas does a great job on MapServer's C# MapScript so I welcome his 
participation in GDAL.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/

From jluis at ualg.pt  Mon Sep  4 12:37:19 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: Memory leak under Matlab (a follow up from - 
	importFromWkt() problem)
In-Reply-To: <44FBA637.8080000@loskot.net>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>	<44FAE7DB.1050101@loskot.net>
	<44FB5868.7030003@ualg.pt> <44FBA637.8080000@loskot.net>
Message-ID: <44FC563F.6010009@ualg.pt>

Mateusz,
> Sounds strange. Is there any chance you're misusing MEX memory
> management functions or may be you're following one of MATLAB
> buggy examples, like:
> http://www.mathworks.com/support/solutions/data/1-1NOXOX.html
>
> May be you're using mexMakeMemoryPersistent in loop or similar call,
> so memory is not cleared after your MEX is unloaded.
> Note, it's only my surmise.
>   

No, that should not be the problem.

> Are you using MATLAB on Windows?
>   
Yes.
> Have you tried to run your MEX with a memory leak checker attached?
> If you're using MATLAB on Windows, I'd try to build MEX dll with
> VLD leak detector [1] but I'm not sure if it will give you usable
> and meaningful report when working with MATLAB.
>
> [1] http://www.codeproject.com/tools/visualleakdetector.asp
>   

OK, I'll see if that is possible.

> Another option is to do some simple  tests of memory
> allocation/deallocation and observe how MATLAB will behave.
>   

I tried that and never found a case with a memory leak. All cases that I 
found
occur when 3rth party libraries are used by the ML mexs (eg. gdal, gmt & 
opencv).
That is why I anticipate that the Mathworks support will be difficult to 
convince,
and that is also why that I'm trying to build the strongest as possible 
case (or find out
what is going on) before contacting them.

For example the following very short peace of code already produces the 
memory
leak, but in order to see (in the Windows Task Manager) it I have to run 
the code many times.
Something like:

for(i=1:5000);t=test_leak('+proj=longlat');end

However, in the original code from where this excerpt comes, the leak 
was sufficiently  large
to be seen only after a couple of executions.

Is there anyone who could test this on a system other than Windows?

Thanks

Joaquim Luis


#include "mex.h"
#include "gdal.h"
#include "ogr_spatialref.h"

/* 
--------------------------------------------------------------------------- 
*/
/* Matlab Gateway routine */
void mexFunction(int nlhs, mxArray *plhs[], int nrhs, const mxArray 
*prhs[]) {
    char    *pszSrcSRS = NULL, *pszSrcWKT = NULL;
    char    *pszDstSRS = NULL, *pszDstWKT = NULL;
    OGRSpatialReference oSrcSRS, oDstSRS;

    if (nrhs == 1 && mxIsChar(prhs[0])) {
        pszSrcSRS = (char *)mxArrayToString(prhs[0]);

        if( oSrcSRS.SetFromUserInput( pszSrcSRS ) != OGRERR_NONE )
            mexErrMsgTxt("OGRPROJ: Translating SRS string failed.");

        oSrcSRS.exportToPrettyWkt( &pszSrcWKT, FALSE );
        if (nlhs == 1)
            plhs[0] = mxCreateString(pszSrcWKT);
        else
            mexPrintf("%s",pszSrcWKT);

        OGRFree(pszSrcWKT);
    }
}




From warmerdam at pobox.com  Mon Sep  4 12:43:58 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] gdal and hdf
In-Reply-To: <9773EFADA4FF6C43A49824D50B1539A7017300F7@exbe04.intra.dlr.de>
References: <9773EFADA4FF6C43A49824D50B1539A7017300F7@exbe04.intra.dlr.de>
Message-ID: <44FC57CE.3080904@pobox.com>

C.Strobl@dlr.de wrote:
--------------------------------------
>  
> #gdal_translate
> gdal_translate -of GTiff "E:\usgs\modis\subset_MOD02_243.1850.hdf" 
> e:\usgs\modis\subset_MOD02_243.1850.tif
> Input file contains subdatasets. Please, select one of them for reading.
>  
> --------------------------------------------------
>  
> analogue to the description given at 
> http://www.remotesensing.org/gdal/frmt_hdf4.html i tested gdalinfo for 
> subdatasets
>  
> 
> gdalinfo 
> HDF4_EOS:EOS_SWATH:E:\usgs\modis\subset_MOD02_243.1850.hdf:MODIS_SWATH_Type_L1B:EV_250_Aggr1km_RefSB

Christian,

I have just tested the FWTools 1.0.5 with a modis swath file and
it seemed to work ok.  I will note that FWTools 1.0.6 contains
some improvements with regard to swath handling.

I wasn't clear on what problems actually occured when you tried the
translations you reported on.

By the way, the easiest way to capture all the subdatasets out of an
HDF file is with the -sds option to gdal_translate.  This causes
it to produce one output file for each subdataset in the input file.

> --------------------------------------------------
>  
> there were the same problems i had already with the aster-files
...
> the problem: the second result-file i can't view with a normal image 
> software like irfanview or photoshop, but for example with erdas. ok, 
> thats not so important for me now. i think i make some mistake with the 
> syntax defining the datasubsets. maybe somebody can help me, maybe its a 
> windows special like ogr and vpf.

Potentially the problem is the use of band interleaved TIFF files.  You
could try adding the -co INTERLEAVE=PIXEL creation option on gdal_translate.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jluis at ualg.pt  Mon Sep  4 12:50:40 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: Memory leak under Matlab (a follow up from - 
	importFromWkt() problem)
In-Reply-To: <44FBA637.8080000@loskot.net>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>	<44FAE7DB.1050101@loskot.net>
	<44FB5868.7030003@ualg.pt> <44FBA637.8080000@loskot.net>
Message-ID: <44FC5960.6030505@ualg.pt>

Mateusz,
> May be you're using mexMakeMemoryPersistent in loop or similar call,
> so memory is not cleared after your MEX is unloaded.
>   
Sorry, I forgot to comment this.
MEXs are never unloaded (unless we issue a 'clear' command) so, for 
example, global variables
retains their values between successive mex calls.
This is a comprehensible behavior since loading a mex takes some time 
and imagine how slow
a loop would be if  inside it the dll had to loaded in every loop step.

Does this ring any bells for anything that are normally cleared by the 
system at the execution end
but will not be done here?

Joaquim


From mateusz at loskot.net  Mon Sep  4 13:00:06 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: Memory leak under Matlab (a follow up from - 
	importFromWkt() problem)
In-Reply-To: <44FC563F.6010009@ualg.pt>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>	<44FAE7DB.1050101@loskot.net>
	<44FB5868.7030003@ualg.pt> <44FBA637.8080000@loskot.net>
	<44FC563F.6010009@ualg.pt>
Message-ID: <44FC5B96.7010605@loskot.net>

Joaquim Luis wrote:
> 
>> Another option is to do some simple  tests of memory
>> allocation/deallocation and observe how MATLAB will behave.
>>   
> 
> I tried that and never found a case with a memory leak. All cases that I
> found occur when 3rth party libraries are used by the ML mexs
> (eg. gdal, gmt & opencv).

Joaquim,

That's a bit strange for me, but I'm not a MATLAB user to find
where is the problem.

> That is why I anticipate that the Mathworks support will be difficult to
> convince, and that is also why that I'm trying to build the strongest
> as possible case (or find out what is going on) before contacting them.

That's a good idea.

> For example the following very short peace of code already produces the
> memory leak, but in order to see (in the Windows Task Manager) it
> I have to run the code many times.
> Something like:
> 
> for(i=1:5000);t=test_leak('+proj=longlat');end
> 
> However, in the original code from where this excerpt comes, the leak
> was sufficiently large to be seen only after a couple of executions.
> 
> Is there anyone who could test this on a system other than Windows?

Unfortunately, I'm not.
I can only keep my eyes open and test for possible memory leaks in
the OGR, what I'm definitely going to do.

I'm sorry I was not very helpful in your case.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From radim.blazek at gmail.com  Mon Sep  4 13:16:01 2006
From: radim.blazek at gmail.com (Radim Blazek)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Cannot read Idrisi in QGIS -
	IdrisiRasterBand::GetNoDataValue () crash
Message-ID: <340505ef0609041016o707d2da3x3dfe8f06a9e3d577@mail.gmail.com>

QGIS crashes when I try to open data in Idrisi format
(http://www.pitt.edu/~laad/vdlpsurv/western_form1_idrisi.exe)

Backtrace:

#0  0xb6a39ef4 in IdrisiRasterBand::GetNoDataValue ()
   from /usr/local/lib/libgdal.so.1
#1  0xb7fd2592 in QgsRasterLayer::readFile (this=0x8233bd8, fileName=@0x1)
    at qgsrasterlayer.cpp:604
#2  0xb7fd9f97 in QgsRasterLayer (this=0x8233bd8, path=@0x81f7584,
    baseName=@0xbfffdab0) at qgsrasterlayer.cpp:467
#3  0xb7d18d6e in QgisApp::addRasterLayer (this=0x80e1188,

Probably we have to check first if the data source has no data value
defined before caling GDAL GetNoDataValue ()?

Radim

From warmerdam at pobox.com  Mon Sep  4 13:16:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Re: Memory leak under Matlab (a follow up from - 
	importFromWkt() problem)
In-Reply-To: <44FC563F.6010009@ualg.pt>
References: <Pine.GSO.4.61.0609021712540.13704@cs.joensuu.fi>	<Pine.GSO.4.61.0609021951380.13704@cs.joensuu.fi>	<44F9F2FF.8070300@loskot.net>	<Pine.GSO.4.61.0609030944490.25774@cs.joensuu.fi>	<44FAE7DB.1050101@loskot.net>	<44FB5868.7030003@ualg.pt>
	<44FBA637.8080000@loskot.net> <44FC563F.6010009@ualg.pt>
Message-ID: <44FC5F63.1000802@pobox.com>

Joaquim Luis wrote:
> Mateusz,
>> Sounds strange. Is there any chance you're misusing MEX memory
>> management functions or may be you're following one of MATLAB
>> buggy examples, like:
>> http://www.mathworks.com/support/solutions/data/1-1NOXOX.html
>>
>> May be you're using mexMakeMemoryPersistent in loop or similar call,
>> so memory is not cleared after your MEX is unloaded.
>> Note, it's only my surmise.
>>   
> 
> No, that should not be the problem.
> 
>> Are you using MATLAB on Windows?
>>   
> Yes.
>> Have you tried to run your MEX with a memory leak checker attached?
>> If you're using MATLAB on Windows, I'd try to build MEX dll with
>> VLD leak detector [1] but I'm not sure if it will give you usable
>> and meaningful report when working with MATLAB.
>>
>> [1] http://www.codeproject.com/tools/visualleakdetector.asp
>>   
> 
> OK, I'll see if that is possible.
> 
>> Another option is to do some simple  tests of memory
>> allocation/deallocation and observe how MATLAB will behave.
>>   
> 
> I tried that and never found a case with a memory leak. All cases that I 
> found
> occur when 3rth party libraries are used by the ML mexs (eg. gdal, gmt & 
> opencv).
> That is why I anticipate that the Mathworks support will be difficult to 
> convince,
> and that is also why that I'm trying to build the strongest as possible 
> case (or find out
> what is going on) before contacting them.
> 
> For example the following very short peace of code already produces the 
> memory
> leak, but in order to see (in the Windows Task Manager) it I have to run 
> the code many times.
> Something like:
> 
> for(i=1:5000);t=test_leak('+proj=longlat');end
> 
> However, in the original code from where this excerpt comes, the leak 
> was sufficiently  large
> to be seen only after a couple of executions.
> 
> Is there anyone who could test this on a system other than Windows?

Joaquim,

I'm not sure why you are running into a memory leak.  There are many variables
at play of course.  I tried a simple variation on your code and ran it under
valgrind which showed no related memory leaks.

#include "gdal.h"
#include "ogr_spatialref.h"


int main()

{
    char    *pszSrcSRS = NULL, *pszSrcWKT = NULL;
    char    *pszDstSRS = NULL, *pszDstWKT = NULL;
    OGRSpatialReference oSrcSRS, oDstSRS;

    pszSrcSRS = "WGS84";

    if( oSrcSRS.SetFromUserInput( pszSrcSRS ) != OGRERR_NONE )
        printf("OGRPROJ: Translating SRS string failed.\n");

    oSrcSRS.exportToPrettyWkt( &pszSrcWKT, FALSE );

    printf("%s\n",pszSrcWKT);

    OGRFree(pszSrcWKT);
}

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Sep  4 14:03:55 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Cannot read Idrisi in QGIS
	-	IdrisiRasterBand::GetNoDataValue () crash
In-Reply-To: <340505ef0609041016o707d2da3x3dfe8f06a9e3d577@mail.gmail.com>
References: <340505ef0609041016o707d2da3x3dfe8f06a9e3d577@mail.gmail.com>
Message-ID: <44FC6A8B.70304@pobox.com>

Radim Blazek wrote:
> QGIS crashes when I try to open data in Idrisi format
> (http://www.pitt.edu/~laad/vdlpsurv/western_form1_idrisi.exe)
> 
> Backtrace:
> 
> #0  0xb6a39ef4 in IdrisiRasterBand::GetNoDataValue ()
>   from /usr/local/lib/libgdal.so.1
> #1  0xb7fd2592 in QgsRasterLayer::readFile (this=0x8233bd8, fileName=@0x1)
>    at qgsrasterlayer.cpp:604
> #2  0xb7fd9f97 in QgsRasterLayer (this=0x8233bd8, path=@0x81f7584,
>    baseName=@0xbfffdab0) at qgsrasterlayer.cpp:467
> #3  0xb7d18d6e in QgisApp::addRasterLayer (this=0x80e1188,
> 
> Probably we have to check first if the data source has no data value
> defined before caling GDAL GetNoDataValue ()?

Radim,

I haven't looked at the dataset in question, but there was a bug at one point
in the IDRISI driver related to missing nodata values.  Perhaps Ivan will
try the dataset, and indicate if there is still a problem.

QGIS should be able to call GetNoDataValue() safely without any sort of
pre-test.   If it causes a crash in GDAL then it is a bug that should
be fixed in GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From daniel.victoria at gmail.com  Mon Sep  4 22:08:20 2006
From: daniel.victoria at gmail.com (Daniel Victoria)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
Message-ID: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>

Hi all,

I bet someone already figure this problem out but I could not find the
solution in the mailing list archives so here goes the question.

I'm trying to import Modis BRDF Albedo (Mod43B) using gdal. The Modis
web page tells it's a 22 band image (2 quality, 10 albedo for diferent
bands and white/black body) and sure enough, issuing gdalinfo on the
file will give me 2 subdatasets:

SUBDATASET_1_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo
  SUBDATASET_1_DESC=[1200x1200x10x2] Albedo (16-bit integer)
SUBDATASET_2_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo_Quality
  SUBDATASET_2_DESC=[1200x1200x2] Albedo_Quality (32-bit unsigned integer)

Where subdataset 1 has 10x2 bands of 1200 x 1200. But then, when I
issue gdalinfo on the first subdataset:

gdalinfo HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo

I get 1200 bands of 1200x1 instead of 20 bands of 1200x1200? So, what
am I doing wrong? Modis reprojection tool will list the 22 bands but
then I don't know how to use MRT in bash mode to import 60 images in
one swift stroke.

Thanks
Daniel

From dron at ak4719.spb.edu  Tue Sep  5 07:25:37 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
In-Reply-To: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
References: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
Message-ID: <20060905112537.GA17771@ak4719.spb.edu>

On Mon, Sep 04, 2006 at 11:08:20PM -0300, Daniel Victoria wrote:
> I'm trying to import Modis BRDF Albedo (Mod43B) using gdal. The Modis
> web page tells it's a 22 band image (2 quality, 10 albedo for diferent
> bands and white/black body) and sure enough, issuing gdalinfo on the
> file will give me 2 subdatasets:
> 
> SUBDATASET_1_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo
>  SUBDATASET_1_DESC=[1200x1200x10x2] Albedo (16-bit integer)
> SUBDATASET_2_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo_Quality
>  SUBDATASET_2_DESC=[1200x1200x2] Albedo_Quality (32-bit unsigned integer)
> 
> Where subdataset 1 has 10x2 bands of 1200 x 1200. But then, when I
> issue gdalinfo on the first subdataset:
> 
> gdalinfo 
> HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo
> 
> I get 1200 bands of 1200x1 instead of 20 bands of 1200x1200? So, what
> am I doing wrong? Modis reprojection tool will list the 22 bands but
> then I don't know how to use MRT in bash mode to import 60 images in
> one swift stroke.


Daniel,

There is nothing wrong in your actions, but the HDF4 driver does not
proprly work with 4D datasets. Could you make available for download one
of those datasets?

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From dron at ak4719.spb.edu  Tue Sep  5 07:52:05 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <44F9FD55.9000806@pobox.com>
References: <44F9FD55.9000806@pobox.com>
Message-ID: <20060905115205.GA17810@ak4719.spb.edu>

On Sat, Sep 02, 2006 at 05:53:25PM -0400, Frank Warmerdam wrote:
> I am motioning for Tamas Szekeres to be given GDAL committer access.
> 
> My intention is that Tamas would take responsible for getting the GDAL
> C# bindings working properly.  He submitted some patches months ago which
> I have neglected, and the component clearly needs an "owner".  Tamas has
> been a great asset to MapServer with his support of the c# bindings.

+1

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From daniel.victoria at gmail.com  Tue Sep  5 08:36:50 2006
From: daniel.victoria at gmail.com (Daniel Victoria)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
In-Reply-To: <20060905112537.GA17771@ak4719.spb.edu>
References: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
	<20060905112537.GA17771@ak4719.spb.edu>
Message-ID: <e7d9427f0609050536w612db041oebbd5fae3608e479@mail.gmail.com>

Andrey,

You can get one of the MOD43B images in the link bellow. It's an 18 Mb file
http://juruti.cena.usp.br/~daniel/modis/modis43b3.tar.gz

It's comforting to know that I'm not the one messing up. The down side
is that I really wished I could do this with GDAL so then I could do a
batch import. Do you know of any other software that can do a batch
import with HDF4 data?

Thanks
Daniel


On 9/5/06, Andrey Kiselev <dron@ak4719.spb.edu> wrote:
> On Mon, Sep 04, 2006 at 11:08:20PM -0300, Daniel Victoria wrote:
> > I'm trying to import Modis BRDF Albedo (Mod43B) using gdal. The Modis
> > web page tells it's a 22 band image (2 quality, 10 albedo for diferent
> > bands and white/black body) and sure enough, issuing gdalinfo on the
> > file will give me 2 subdatasets:
> >
> > SUBDATASET_1_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo
> >  SUBDATASET_1_DESC=[1200x1200x10x2] Albedo (16-bit integer)
> > SUBDATASET_2_NAME=HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo_Quality
> >  SUBDATASET_2_DESC=[1200x1200x2] Albedo_Quality (32-bit unsigned integer)
> >
> > Where subdataset 1 has 10x2 bands of 1200 x 1200. But then, when I
> > issue gdalinfo on the first subdataset:
> >
> > gdalinfo
> > HDF4_EOS:EOS_GRID:"MOD43B3.A2003193.h21v10.004.2003226054122.hdf":MOD_Grid_BRDF:Albedo
> >
> > I get 1200 bands of 1200x1 instead of 20 bands of 1200x1200? So, what
> > am I doing wrong? Modis reprojection tool will list the 22 bands but
> > then I don't know how to use MRT in bash mode to import 60 images in
> > one swift stroke.
>
>
> Daniel,
>
> There is nothing wrong in your actions, but the HDF4 driver does not
> proprly work with 4D datasets. Could you make available for download one
> of those datasets?
>
> Regards,
> Andrey
>
> --
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From ILucena at clarku.edu  Tue Sep  5 08:41:13 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <44F9FD55.9000806@pobox.com>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45501CE66EE@Iris.ad.clarku.edu>

+1

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Saturday, September 02, 2006 5:53 PM
To: gdal-dev
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer

GDAL PSC Members,

I am motioning for Tamas Szekeres to be given GDAL committer access.

My intention is that Tamas would take responsible for getting the GDAL
C# bindings working properly.  He submitted some patches months ago
which
I have neglected, and the component clearly needs an "owner".  Tamas has
been a great asset to MapServer with his support of the c# bindings.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From radim.blazek at gmail.com  Tue Sep  5 11:22:15 2006
From: radim.blazek at gmail.com (Radim Blazek)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Cannot read Idrisi in
	QGIS-IdrisiRasterBand::GetNoDataValue () crash
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D45501CE66E0@Iris.ad.clarku.edu>
References: <44FC6A8B.70304@pobox.com>
	<6FD7C9DB26540B42A1207C69BF92D45501CE66E0@Iris.ad.clarku.edu>
Message-ID: <340505ef0609050822k69ae620dw615a61078ec98933@mail.gmail.com>

Hi,
I have got crash both on Windows and Linux.
gdalinfo and gdal_translate work for me.
All with GDAL 1.3.2.

Radim

On 9/5/06, Ivan Lucena <ILucena@clarku.edu> wrote:
> Frank, Radim,
>
> The issue that we have with IdrisiRasterBand::GetNoDataValue was fixed a
> long time ago. What was happening is that someone found and dataset
> where instead of "flag def`n" there was a "flag def'n" in the .rdc file.
> But I think Frank himself fixed it with those "if/else" that follows:
>
> ----------
> double IdrisiRasterBand::GetNoDataValue(int *pbSuccess)
> {
> IdrisiDataset *poGDS = (IdrisiDataset *) poDS;
>
> double dfNoData;
> const char *pszFlagDefn;
>
> if (CSLFetchNameValue(poGDS->papszRDC, rdcFLAG_DEFN) != NULL)
>         pszFlagDefn = CSLFetchNameValue(poGDS->papszRDC, rdcFLAG_DEFN);
> else if (CSLFetchNameValue(poGDS->papszRDC, rdcFLAG_DEFN2) != NULL)
>         pszFlagDefn = CSLFetchNameValue(poGDS->papszRDC, rdcFLAG_DEFN2);
>
> //
> ------------------------------------------------------------------------
> -
> // If Flag_Def is not "none", value means "background" or "missing data"
> //
> ------------------------------------------------------------------------
> -
>
> if (! EQUAL(pszFlagDefn, "none"))
> {
>         dfNoData = atof_nz(CSLFetchNameValue(poGDS->papszRDC,
> rdcFLAG_VALUE));
>         *pbSuccess = TRUE;
> }
> else
> {
>         dfNoData = -9999.0;    /* this value should be ignored */
>         *pbSuccess = FALSE;
> }
>         return dfNoData;
> }
> ----------
>
> In the previous code I also misunderstood the meaning of pbSuccess so I
> think that I also made some changes after Frank's commit, I hope I've
> got it right now Frank. If the .rdc file says that there is no "Flag
> Value" the driver returns Success as FALSE and the NoData is just a
> default and presumably ignored value.
>
> Radim, I am attaching a log of some operations that I did with your
> dataset in Win32. Unfortunately I don't have a UNIX system to test it on
> now.
>
> So the question is: Why is crashing in your computer?
>
> One possibility is that Frank and I know that in the released version
> GDAL-1.3.2 in zip or tar.gz package there is a known bug in the RST
> driver related to coordinate system identification. Is it possible that
> your bug-tracker is pointing to the wrong function?
>
> I suggest you to get the latest version from CVS or even better wait a
> little bit and I will commit some fixes that I made this past weekend.
>
> Thanks for helping me identify error and improve my code.
>
> Ivan Lucena
>
> "Smart data structure and dumb code works a lot better than the other
> way around" Eric S. Raymond, The Cathedral and the Bazaar.
>
> ----------
> C:\Data\x>gdal_translate -of gtiff western_form1.rst western_form1.tif
> 0...10...20...30...40...50...60...70...80...90...Input file size is
> 3100, 2100
> 100 - done.
>
>
> C:\Data\x>gdalinfo western_form1.rst
> Driver: RST/Idrisi Raster A.1
> Size is 3100, 2100
> Coordinate System is `'
> Origin = (100.000000,744.000000)
> Pixel Size = (0.01000000,-0.01000000)
> Corner Coordinates:
> Upper Left  (     100.000,     744.000)
> Lower Left  (     100.000,     723.000)
> Upper Right (     131.000,     744.000)
> Lower Right (     131.000,     723.000)
> Center      (     115.500,     733.500)
> Band 1 Block=3100x1 Type=Byte, ColorInterp=Gray
>   Min=0.000 Max=3.000
>   NoData Value=0
>   Unit Type: classes
>   Categories:
>       0:
>       1: AREA OCUPADA
>       2: RECONOCIDA
>       3: NO RECON.
>
> C:\Data\x>gdalinfo western_form1.tif
> Driver: GTiff/GeoTIFF
> Size is 3100, 2100
> Coordinate System is `'
> Origin = (100.000000,744.000000)
> Pixel Size = (0.01000000,-0.01000000)
> Corner Coordinates:
> Upper Left  (     100.000,     744.000)
> Lower Left  (     100.000,     723.000)
> Upper Right (     131.000,     744.000)
> Lower Right (     131.000,     723.000)
> Center      (     115.500,     733.500)
> Band 1 Block=3100x2 Type=Byte, ColorInterp=Gray
>   NoData Value=0
> ----------
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
> Warmerdam
> Sent: Monday, September 04, 2006 2:04 PM
> To: Radim Blazek
> Cc: gdal-dev@lists.maptools.org; qgis-developer
> Subject: Re: [Gdal-dev] Cannot read Idrisi in QGIS-
> IdrisiRasterBand::GetNoDataValue () crash
>
> Radim Blazek wrote:
> > QGIS crashes when I try to open data in Idrisi format
> > (http://www.pitt.edu/~laad/vdlpsurv/western_form1_idrisi.exe)
> >
> > Backtrace:
> >
> > #0  0xb6a39ef4 in IdrisiRasterBand::GetNoDataValue ()
> >   from /usr/local/lib/libgdal.so.1
> > #1  0xb7fd2592 in QgsRasterLayer::readFile (this=0x8233bd8,
> fileName=@0x1)
> >    at qgsrasterlayer.cpp:604
> > #2  0xb7fd9f97 in QgsRasterLayer (this=0x8233bd8, path=@0x81f7584,
> >    baseName=@0xbfffdab0) at qgsrasterlayer.cpp:467
> > #3  0xb7d18d6e in QgisApp::addRasterLayer (this=0x80e1188,
> >
> > Probably we have to check first if the data source has no data value
> > defined before caling GDAL GetNoDataValue ()?
>
> Radim,
>
> I haven't looked at the dataset in question, but there was a bug at one
> point
> in the IDRISI driver related to missing nodata values.  Perhaps Ivan
> will
> try the dataset, and indicate if there is still a problem.
>
> QGIS should be able to call GetNoDataValue() safely without any sort of
> pre-test.   If it causes a crash in GDAL then it is a bug that should
> be fixed in GDAL.
>
> Best regards,
> --
> ---------------------------------------+--------------------------------
> ------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo,
> http://osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From Chris.Barker at noaa.gov  Tue Sep  5 12:38:41 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <1157377858.2561.4.camel@geru-itae>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae>
Message-ID: <44FDA811.1090705@noaa.gov>

Didrik Pinte wrote:
> Because of a problem between gdalnumeric and python-numpy, I have
> uninstalled the following packages and kept only python-numeric :
> 
> apt-get remove python-numpy python-numpy-ext python-scipy fftw3
> 
> It solved the problem ! That's strange.

That is very odd. the new numpy and the old Numeric should have no 
trouble at all co-existing.

My guess is that it is a Debian bug -- perhaps the python-numpy package 
is set up to replace Numeric, rather than coexist with it. However, if 
not, then there may be a bug in numpy, and it should be reported. It is 
certainly intended that they don't interfere with one another.

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From dron at ak4719.spb.edu  Tue Sep  5 12:58:53 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
In-Reply-To: <e7d9427f0609050536w612db041oebbd5fae3608e479@mail.gmail.com>
References: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
	<20060905112537.GA17771@ak4719.spb.edu>
	<e7d9427f0609050536w612db041oebbd5fae3608e479@mail.gmail.com>
Message-ID: <20060905165853.GA18961@ak4719.spb.edu>

On Tue, Sep 05, 2006 at 09:36:50AM -0300, Daniel Victoria wrote:
> You can get one of the MOD43B images in the link bellow. It's an 18 Mb
> file http://juruti.cena.usp.br/~daniel/modis/modis43b3.tar.gz
> 
> It's comforting to know that I'm not the one messing up. The down side
> is that I really wished I could do this with GDAL so then I could do a
> batch import. Do you know of any other software that can do a batch
> import with HDF4 data?

Daniel,

You can grab the latest GDAL snapshot from CVS and test it for support
for your datasets. I am not sure that my approach will work in all
possible situations, but it should work in your case. I do not know
other tools suitable for batch processing, it is hard to automatically
process HDF files, because they are designed to be human readable in the
first place and not machine readable. MRT is higly specific tool, so it
is probably the best choice for MODIS processing, though the GDAL driver
tries to be the universal one.

I think that MRT can be used in batch mode, you just need to cgenerate
control file on the fly, something like

for i in *.hdf ; do
	echo INPUT_FILENAME = $i >prm.prm
	echo OUTPUT_FILENAME = `basename $i .hdf`.tif >> prm.prm
...
done


Regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517

From daniel.victoria at gmail.com  Tue Sep  5 13:29:48 2006
From: daniel.victoria at gmail.com (Daniel Victoria)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
In-Reply-To: <20060905165853.GA18961@ak4719.spb.edu>
References: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
	<20060905112537.GA17771@ak4719.spb.edu>
	<e7d9427f0609050536w612db041oebbd5fae3608e479@mail.gmail.com>
	<20060905165853.GA18961@ak4719.spb.edu>
Message-ID: <e7d9427f0609051029y4061a98emf583f141ce4be42b@mail.gmail.com>

Thanks Andrey,

I'll check out the lastest gdal from CVS and see if it works tonight.
I forgot to mention that I used yesterdays GDAL from CVS if that is of
any help, with the --with-hdf4=/usr/include/hdf option in configure
and that I'm runing Ubuntu Linux.

I'll also try to use MRT in batch mode, generating the parameter files
on the fly.

Thanks
Daniel

On 9/5/06, Andrey Kiselev <dron@ak4719.spb.edu> wrote:
> On Tue, Sep 05, 2006 at 09:36:50AM -0300, Daniel Victoria wrote:
> > You can get one of the MOD43B images in the link bellow. It's an 18 Mb
> > file http://juruti.cena.usp.br/~daniel/modis/modis43b3.tar.gz
> >
> > It's comforting to know that I'm not the one messing up. The down side
> > is that I really wished I could do this with GDAL so then I could do a
> > batch import. Do you know of any other software that can do a batch
> > import with HDF4 data?
>
> Daniel,
>
> You can grab the latest GDAL snapshot from CVS and test it for support
> for your datasets. I am not sure that my approach will work in all
> possible situations, but it should work in your case. I do not know
> other tools suitable for batch processing, it is hard to automatically
> process HDF files, because they are designed to be human readable in the
> first place and not machine readable. MRT is higly specific tool, so it
> is probably the best choice for MODIS processing, though the GDAL driver
> tries to be the universal one.
>
> I think that MRT can be used in batch mode, you just need to cgenerate
> control file on the fly, something like
>
> for i in *.hdf ; do
>         echo INPUT_FILENAME = $i >prm.prm
>         echo OUTPUT_FILENAME = `basename $i .hdf`.tif >> prm.prm
> ...
> done
>
>
> Regards,
> Andrey
>
>
> --
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From warmerdam at pobox.com  Tue Sep  5 13:43:08 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Licensing issue with geodata embedded in gdal.
In-Reply-To: <20060808140637.GE6046@ba.issia.cnr.it>
References: <20060808140637.GE6046@ba.issia.cnr.it>
Message-ID: <44FDB72C.9000506@pobox.com>

Francesco Paolo Lovergine wrote:
> http://lists.alioth.debian.org/pipermail/pkg-grass-devel/2006-August/001179.html
> 
> It's questionable if this issue is a non-issue for Debian. We distribute
> gdal in main and this is indeed a use limitation for our users.
> Moving only data in non-free could be an option (I don't know how much
> complicated). But solving the question at upstream level would be more nice.

Francesco,

That url doesn't resolve for me. Note there are quite a few potential
freeness issues identified in GDAL as part of the review at:

   http://wiki.osgeo.org/index.php/GDAL_Provenance_Review

It is my intention to address them all in the coming months as one
precondition of GDAL passing OSGeo incubation.  However, I do feel they
are all "low risk", so if it is possible to take no action for a little
while, there is hope that we might have the issues resolved in time for a
1.4.0 release.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From packalen at cs.joensuu.fi  Tue Sep  5 15:13:31 2006
From: packalen at cs.joensuu.fi (Petteri Packalen)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
Message-ID: <Pine.GSO.4.61.0609052211480.6434@cs.joensuu.fi>

Mateusz, Frank and others,

> Are you running your code on Windows with DLLs? If you
> are, then may be you're dealing with "passing objects
> across DLL boundaries" issue.

I rewrote this part of the code using OGR C interface and now it works 
perfectly using both approaches I presented previously. Probably it was 
some sort of dll/heap issue. I use precompiled dll from FWTools under 
Windows.

I also noticed that there was a substantial memory leak in my code. I was 
creating new OGRSpatialReference within a loop which browses through 
features:

while ( TRUE )
{
    ... // Create WKT
    OGRSpatialReferenceH hRef = OSRNewSpatialReference( NULL );  // <---
    OGRGeometryH hGeomNew;
    OGRErr err = OGR_G_CreateFromWkt( &pszWkt, hRef, &hGeomNew );
    OGR_F_SetGeometryDirectly( hDstFeature, hGeomNew );
    OGR_L_CreateFeature( hDstLayer, hDstFeature )
    OGR_F_Destroy( hDstFeature );
}

Thus I instantiated very many OGRSpatialReferences. When I instantiated 
only one OGRSpatialReference out of the loop memory leak disappeared (or 
alternatively passing directly NULL to OGR_G_CreateFromWkt as spatial 
reference). I look at the source code and tried to trace why all of 
OGRSpatialReferences are not de-allocated via ~OGRFeature() --> 
~OGRGeometry() --> OGRSpatialReference::Release() but I didn't follow 
without modifying source code (I use FWTools dll). Probably reference 
counting in OGRSpatialReference cannot handle this kind of misuse of the 
OGR?

Anyway, it was my mistake. I really appreciate your help in this list.

Best regards,
Petteri

=========================================================================
Petteri Packal?n 
University of Joensuu 
Faculty of Forestry 
P.O. Box 111 
80101 Joensuu
Finland 
e-mail: packalen@cs.joensuu.fi 
=========================================================================
From mateusz at loskot.net  Tue Sep  5 16:50:33 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609052211480.6434@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609052211480.6434@cs.joensuu.fi>
Message-ID: <44FDE319.6040506@loskot.net>

Petteri Packalen wrote:
> Mateusz, Frank and others,
> 
>> Are you running your code on Windows with DLLs? If you
>> are, then may be you're dealing with "passing objects
>> across DLL boundaries" issue.
> 
> I rewrote this part of the code using OGR C interface and now it works
> perfectly using both approaches I presented previously. Probably it was
> some sort of dll/heap issue. I use precompiled dll from FWTools under
> Windows.

If you're creating/destroying objects across DLL boundaries,
it's recommended to use dedicated destroy/create factory methods
from OGRGeometryFactory:
http://www.gdal.org/ogr/classOGRGeometryFactory.html

and CreateFeature/DestroyFeature from OGRFeature class:
http://www.gdal.org/ogr/classOGRFeature.html

instead of applying new/delete operators directly.

> I also noticed that there was a substantial memory leak in my code. I
> was creating new OGRSpatialReference within a loop which browses through
> features:
> 
> while ( TRUE )
> {
>    ... // Create WKT
>    OGRSpatialReferenceH hRef = OSRNewSpatialReference( NULL );  // <---
>    OGRGeometryH hGeomNew;
>    OGRErr err = OGR_G_CreateFromWkt( &pszWkt, hRef, &hGeomNew );
>    OGR_F_SetGeometryDirectly( hDstFeature, hGeomNew );
>    OGR_L_CreateFeature( hDstLayer, hDstFeature )
>    OGR_F_Destroy( hDstFeature );
> }
>
> Thus I instantiated very many OGRSpatialReferences. When I instantiated
> only one OGRSpatialReference out of the loop memory leak disappeared (or
> alternatively passing directly NULL to OGR_G_CreateFromWkt as spatial
> reference). I look at the source code and tried to trace why all of
> OGRSpatialReferences are not de-allocated via ~OGRFeature() -->
> ~OGRGeometry() --> OGRSpatialReference::Release() but I didn't follow
> without modifying source code (I use FWTools dll). Probably reference
> counting in OGRSpatialReference cannot handle this kind of misuse of the
> OGR?

SRS object is a shared object and its lifetime is managed by reference
counter. If you have a number of geometries with the same SRS, then you
don't need to instantiate separate SRS object for every geometry,
but share common SRS instance between all your geometries.

However, I'm not sure I see where is the miususe when having
separate SRS for every geometry.

> Anyway, it was my mistake. I really appreciate your help in this list.

You're welcome.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From frankie at debian.org  Tue Sep  5 14:16:14 2006
From: frankie at debian.org (Francesco P. Lovergine)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Licensing issue with geodata embedded in gdal.
In-Reply-To: <44FDB72C.9000506@pobox.com>
References: <20060808140637.GE6046@ba.issia.cnr.it>
	<44FDB72C.9000506@pobox.com>
Message-ID: <20060905181613.GA4371@ba.issia.cnr.it>

On Tue, Sep 05, 2006 at 01:43:08PM -0400, Frank Warmerdam wrote:
> Francesco Paolo Lovergine wrote:
> >http://lists.alioth.debian.org/pipermail/pkg-grass-devel/2006-August/001179.html
> >
> >It's questionable if this issue is a non-issue for Debian. We distribute
> >gdal in main and this is indeed a use limitation for our users.
> >Moving only data in non-free could be an option (I don't know how much
> >complicated). But solving the question at upstream level would be more 
> >nice.
> 
> Francesco,
> 
> That url doesn't resolve for me. Note there are quite a few potential
> freeness issues identified in GDAL as part of the review at:
> 
>   http://wiki.osgeo.org/index.php/GDAL_Provenance_Review
> 
> It is my intention to address them all in the coming months as one
> precondition of GDAL passing OSGeo incubation.  However, I do feel they
> are all "low risk", so if it is possible to take no action for a little
> while, there is hope that we might have the issues resolved in time for a
> 1.4.0 release.
> 

Yep, people yet reported that, I hope it will be solved in time for
Etch... 

-- 
Francesco P. Lovergine

From warmerdam at pobox.com  Tue Sep  5 20:05:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] importFromWkt() problem
In-Reply-To: <Pine.GSO.4.61.0609052211480.6434@cs.joensuu.fi>
References: <Pine.GSO.4.61.0609052211480.6434@cs.joensuu.fi>
Message-ID: <44FE10B3.6040501@pobox.com>

Petteri Packalen wrote:
> Mateusz, Frank and others,
> 
>> Are you running your code on Windows with DLLs? If you
>> are, then may be you're dealing with "passing objects
>> across DLL boundaries" issue.
> 
> I rewrote this part of the code using OGR C interface and now it works 
> perfectly using both approaches I presented previously. Probably it was 
> some sort of dll/heap issue. I use precompiled dll from FWTools under 
> Windows.
> 
> I also noticed that there was a substantial memory leak in my code. I 
> was creating new OGRSpatialReference within a loop which browses through 
> features:
> 
> while ( TRUE )
> {
>    ... // Create WKT
>    OGRSpatialReferenceH hRef = OSRNewSpatialReference( NULL );  // <---
>    OGRGeometryH hGeomNew;
>    OGRErr err = OGR_G_CreateFromWkt( &pszWkt, hRef, &hGeomNew );
>    OGR_F_SetGeometryDirectly( hDstFeature, hGeomNew );
>    OGR_L_CreateFeature( hDstLayer, hDstFeature )
>    OGR_F_Destroy( hDstFeature );
> }

Petteri,

I believe that OSRNewSpatialReference() creates a spatial reference
with a starting reference count of one.  So the more correct approach would
be:


while ( TRUE )
{
    ... // Create WKT
    OGRSpatialReferenceH hRef = OSRNewSpatialReference( NULL );  // <---
    OGRGeometryH hGeomNew;
    OGRErr err = OGR_G_CreateFromWkt( &pszWkt, hRef, &hGeomNew );
    OSRRelease( hRef ); /**** ADDED THIS ****/
    OGR_F_SetGeometryDirectly( hDstFeature, hGeomNew );
    OGR_L_CreateFeature( hDstLayer, hDstFeature )
    OGR_F_Destroy( hDstFeature );
}

But honestly, I'm not sure why you are even creating an empty
spatial reference for the use of these geometries.  You can just pass
NULL in for the OGRSpatialReferenceH in OGR_G_CreateFromWkt() if you
don't have a need to attach spatial reference system to a geometry.

And if you did have a coordinate system, creating it once outside the
loop is far better than creating one for each geometry.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From daniel.victoria at gmail.com  Tue Sep  5 21:46:15 2006
From: daniel.victoria at gmail.com (Daniel Victoria)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Modis HDF help
In-Reply-To: <20060905165853.GA18961@ak4719.spb.edu>
References: <e7d9427f0609041908v5522073co710954274b190e6c@mail.gmail.com>
	<20060905112537.GA17771@ak4719.spb.edu>
	<e7d9427f0609050536w612db041oebbd5fae3608e479@mail.gmail.com>
	<20060905165853.GA18961@ak4719.spb.edu>
Message-ID: <e7d9427f0609051846v60a717cdy22c4144544fc953@mail.gmail.com>

Thanks Andrey,

I'm pleased to inform that whatever you did fixed the problem. Now I
can import MOD43B using gdal and it correctily recognizes the 22
bands.

once again, thanks
Daniel

On 9/5/06, Andrey Kiselev <dron@ak4719.spb.edu> wrote:
> On Tue, Sep 05, 2006 at 09:36:50AM -0300, Daniel Victoria wrote:
> > You can get one of the MOD43B images in the link bellow. It's an 18 Mb
> > file http://juruti.cena.usp.br/~daniel/modis/modis43b3.tar.gz
> >
> > It's comforting to know that I'm not the one messing up. The down side
> > is that I really wished I could do this with GDAL so then I could do a
> > batch import. Do you know of any other software that can do a batch
> > import with HDF4 data?
>
> Daniel,
>
> You can grab the latest GDAL snapshot from CVS and test it for support
> for your datasets. I am not sure that my approach will work in all
> possible situations, but it should work in your case. I do not know
> other tools suitable for batch processing, it is hard to automatically
> process HDF files, because they are designed to be human readable in the
> first place and not machine readable. MRT is higly specific tool, so it
> is probably the best choice for MODIS processing, though the GDAL driver
> tries to be the universal one.
>
> I think that MRT can be used in batch mode, you just need to cgenerate
> control file on the fly, something like
>
> for i in *.hdf ; do
>         echo INPUT_FILENAME = $i >prm.prm
>         echo OUTPUT_FILENAME = `basename $i .hdf`.tif >> prm.prm
> ...
> done
>
>
> Regards,
> Andrey
>
>
> --
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From dpinte at itae.be  Wed Sep  6 03:23:57 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <44FDA811.1090705@noaa.gov>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae>  <44FDA811.1090705@noaa.gov>
Message-ID: <1157527437.13176.56.camel@geru-itae>

Le mardi 05 septembre 2006 ? 09:38 -0700, Christopher Barker a ?crit :
> Didrik Pinte wrote:
> > Because of a problem between gdalnumeric and python-numpy, I have
> > uninstalled the following packages and kept only python-numeric :
> > 
> > apt-get remove python-numpy python-numpy-ext python-scipy fftw3
> > 
> > It solved the problem ! That's strange.
> 
> That is very odd. the new numpy and the old Numeric should have no 
> trouble at all co-existing.

That's why i was running with both of them.

> My guess is that it is a Debian bug -- perhaps the python-numpy package 
> is set up to replace Numeric, rather than coexist with it. However, if 
> not, then there may be a bug in numpy, and it should be reported. It is 
> certainly intended that they don't interfere with one another.

Running my application on windows and linux, it seems that the windows
version is running with numpy and Numeric without the problems
encountered on the Debian installation. I will investigate a bit the
problem on the Debian system.

Didrik


From C.Strobl at dlr.de  Wed Sep  6 11:38:31 2006
From: C.Strobl at dlr.de (C.Strobl@dlr.de)
Date: Wed Nov 21 11:50:20 2007
Subject: AW: [Gdal-dev] gdal and hdf
In-Reply-To: <44FC57CE.3080904@pobox.com>
Message-ID: <9773EFADA4FF6C43A49824D50B1539A7017D3099@exbe04.intra.dlr.de>


hello frank,
thank you for your fast answer. the -sds option works fine, i didn't see it, because i searched mainly at the hdf-description-page.
my problem was the specification of subdatasets. i think its only a matter of syntax, maybe double quotes or not, ...its always a little bit different with windows, also for example with ogr and vpf. there only the subdataset must be double quoted
its still interesting for me, because sometimes its more usefull to extract only subdatasets
thanks
christian
  

-----Urspr?ngliche Nachricht-----
Von: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Gesendet: Montag, 4. September 2006 18:44
An: Strobl, Christian
Cc: gdal-dev@lists.maptools.org
Betreff: Re: [Gdal-dev] gdal and hdf

C.Strobl@dlr.de wrote:
--------------------------------------
>  
> #gdal_translate
> gdal_translate -of GTiff "E:\usgs\modis\subset_MOD02_243.1850.hdf" 
> e:\usgs\modis\subset_MOD02_243.1850.tif
> Input file contains subdatasets. Please, select one of them for reading.
>  
> --------------------------------------------------
>  
> analogue to the description given at
> http://www.remotesensing.org/gdal/frmt_hdf4.html i tested gdalinfo for 
> subdatasets
>  
> 
> gdalinfo
> HDF4_EOS:EOS_SWATH:E:\usgs\modis\subset_MOD02_243.1850.hdf:MODIS_SWATH
> _Type_L1B:EV_250_Aggr1km_RefSB

Christian,

I have just tested the FWTools 1.0.5 with a modis swath file and it seemed to work ok.  I will note that FWTools 1.0.6 contains some improvements with regard to swath handling.

I wasn't clear on what problems actually occured when you tried the translations you reported on.

By the way, the easiest way to capture all the subdatasets out of an HDF file is with the -sds option to gdal_translate.  This causes it to produce one output file for each subdataset in the input file.

> --------------------------------------------------
>  
> there were the same problems i had already with the aster-files
...
> the problem: the second result-file i can't view with a normal image 
> software like irfanview or photoshop, but for example with erdas. ok, 
> thats not so important for me now. i think i make some mistake with 
> the syntax defining the datasubsets. maybe somebody can help me, maybe 
> its a windows special like ogr and vpf.

Potentially the problem is the use of band interleaved TIFF files.  You could try adding the -co INTERLEAVE=PIXEL creation option on gdal_translate.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From warmerdam at pobox.com  Wed Sep  6 11:57:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: AW: [Gdal-dev] gdal and hdf
In-Reply-To: <9773EFADA4FF6C43A49824D50B1539A7017D3099@exbe04.intra.dlr.de>
References: <9773EFADA4FF6C43A49824D50B1539A7017D3099@exbe04.intra.dlr.de>
Message-ID: <44FEF005.9020302@pobox.com>

C.Strobl@dlr.de wrote:
> hello frank,
> thank you for your fast answer. the -sds option works fine, i didn't see it, because i searched mainly at the hdf-description-page.
> my problem was the specification of subdatasets. i think its only a matter of syntax, maybe double quotes or not, ...its always a little bit different with windows, also for example with ogr and vpf. there only the subdataset must be double quoted
> its still interesting for me, because sometimes its more usefull to extract only subdatasets
> thanks
...
>> gdalinfo
>> HDF4_EOS:EOS_SWATH:E:\usgs\modis\subset_MOD02_243.1850.hdf:MODIS_SWATH
>> _Type_L1B:EV_250_Aggr1km_RefSB

Christian,

Indeed I think the problem is quoting.  In particular, you need quotes around
the actual filename to get through to the program if you use a file path that
includes a colon.  I don't know how to accomplish this on windows.  But you
might be better off not using an absolute path that includes a driver
specifier.  I think use of the colon as a delimeter for sections of the
filename may have been unwise.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Sep  6 18:30:09 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <20060905115205.GA17810@ak4719.spb.edu>
References: <44F9FD55.9000806@pobox.com>
	<20060905115205.GA17810@ak4719.spb.edu>
Message-ID: <44FF4BF1.1010401@pobox.com>

Andrey Kiselev wrote:
> On Sat, Sep 02, 2006 at 05:53:25PM -0400, Frank Warmerdam wrote:
>> I am motioning for Tamas Szekeres to be given GDAL committer access.
>>
>> My intention is that Tamas would take responsible for getting the GDAL
>> C# bindings working properly.  He submitted some patches months ago which
>> I have neglected, and the component clearly needs an "owner".  Tamas has
>> been a great asset to MapServer with his support of the c# bindings.

Folks,

OK, by unanimous vote Tamas has been granted committer status.  I have
created a CVS account with name "tamas" and provided him with password
details.

I'm thinking of Tamas as "owner" of the C# bindings.  As long as his
work does not materially affect other aspects of the code and stays
within existing guidelines I don't expect RFCs for changes to the C#
bindings.  If there are users of the C# bindings with an interest in
their stability or particulars of how they should work, I'd encourage
them to get in contact with Tamas.

Tamas - I'm very pleased to have your support!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From szekerest at gmail.com  Wed Sep  6 19:33:41 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <44FF4BF1.1010401@pobox.com>
References: <44F9FD55.9000806@pobox.com>
	<20060905115205.GA17810@ak4719.spb.edu> <44FF4BF1.1010401@pobox.com>
Message-ID: <f3b73b7d0609061633t655e2417vc99331f31a423e29@mail.gmail.com>

Folks,

Thank you for your support. I think this area was a bit neglected for
a while, but I hope we can get something working for the next release.

Here is a brief enumeration about the upcoming changes:

Fix for bug 949
MONO support (Win/Linux/OSX)
missing typemaps
sample apps
readme - howto
C# interface tests

Best Regards

Tamas


2006/9/7, Frank Warmerdam <warmerdam@pobox.com>:
> Andrey Kiselev wrote:
> > On Sat, Sep 02, 2006 at 05:53:25PM -0400, Frank Warmerdam wrote:
> >> I am motioning for Tamas Szekeres to be given GDAL committer access.
> >>
> >> My intention is that Tamas would take responsible for getting the GDAL
> >> C# bindings working properly.  He submitted some patches months ago which
> >> I have neglected, and the component clearly needs an "owner".  Tamas has
> >> been a great asset to MapServer with his support of the c# bindings.
>
> Folks,
>
> OK, by unanimous vote Tamas has been granted committer status.  I have
> created a CVS account with name "tamas" and provided him with password
> details.
>
> I'm thinking of Tamas as "owner" of the C# bindings.  As long as his
> work does not materially affect other aspects of the code and stays
> within existing guidelines I don't expect RFCs for changes to the C#
> bindings.  If there are users of the C# bindings with an interest in
> their stability or particulars of how they should work, I'd encourage
> them to get in contact with Tamas.
>
> Tamas - I'm very pleased to have your support!
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGeo, http://osgeo.org
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>

From rsignell at usgs.gov  Thu Sep  7 07:49:47 2006
From: rsignell at usgs.gov (Rich Signell)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] The GDAL CF-NetCDF driver seems to lose the geoferencing
	info on output.
Message-ID: <61033b870609070449w284cee12jc682f308ff090003@mail.gmail.com>

GDAL NetCDF driver folk:

I was excited to see that in the GDAL 1.3.2.0 that I got with FWTOOLS
1.0.6, the CF-style "netcdf" is available as an output format!  (Even
though
http://gdal.maptools.org/formats_list.html doesn't yet list "creation"
for NetCDF, however).

I tried converting a geotiff using:

gdal_translate -of netcdf  SeaWiFS.tif SeaWiFS.nc

and it works fine (but didn't give the usual 0... 10... 20...), but
loses the georeferencing information.  It writes only the pixel values
and not the coordinate variables:

$ ncdump -h SeaWiFS.nc
netcdf SeaWiFS {
dimensions:
        x = 36000 ;
        y = 7000 ;
variables:
        byte Band1(y, x) ;
                Band1:long_name = "GDAL Band Number 1" ;
                Band1:_FillValue = -9999. ;

// global attributes:
                :Conventions = "CF-1.0" ;
                :AREA_OR_POINT = "Area" ;
}


Thanks,
Rich

-- 
Dr. Richard P. Signell   (508) 457-2229
USGS, 384 Woods Hole Rd.
Woods Hole, MA 02543-1598

From ILucena at clarku.edu  Thu Sep  7 10:41:35 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDAL windows installer?
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45501CE6BBD@Iris.ad.clarku.edu>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: GDAL132Setup.iss
Type: application/octet-stream
Size: 3909 bytes
Desc: GDAL132Setup.iss
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060907/5fc77255/GDAL132Setup.obj
From poliveira at esri-portugal.pt  Thu Sep  7 10:57:47 2006
From: poliveira at esri-portugal.pt (Pedro Oliveira)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] convert HDF to TIF  - georeferencing problems
Message-ID: <FC3E2365FE096449AD07A1D5A17F6EAA01071856@Teris.esript.local>

 

Good Morning LIST

 

I'm trying to import HDF-SMI from MODIS to TiF, and i'm using the GDAL
FWTools application.

I'm using the following sintax for importing the hdf image in a batch
file that uses some variables to lock the file name:

 

GDAL_TRANSLATE -OF GTIFF %DIRIN%\%%X  %DIROUT%\%%~nX.TIF

 

Everything work's fine. The problem is the this:

The outpu image is a GeoTiff but it dosn't have lat/long georeferencing,
but has row/column info. Ive tried to use some paramenter like -t_srs or
-s_srs in gdalwarp but didn't work.

When i use gdalinfo i cn see that the HDF file dosn't have a explicit
geographical information, but the information has lat/long data.

 

Is there a way to import image and have the output file as lat/long
(wgs84) georefernced

 

I've download the image in the following URL

HDF-SMI:

http://oceancolor.gsfc.nasa.gov/cgi/level3.pl?DAY=08Aug2005&PER=&TYP=mac
hl&RRW=16

 

i've used a Chlorophyll (Aqua-MODIS) monthy 4km HDF file.

 

Tanks in advance by you help

Best regards

 

Pedro Oliveira

 

 




 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060907/99ddff64/attachment.html
From warmerdam at pobox.com  Thu Sep  7 12:59:32 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] convert HDF to TIF  - georeferencing problems
In-Reply-To: <FC3E2365FE096449AD07A1D5A17F6EAA01071856@Teris.esript.local>
References: <FC3E2365FE096449AD07A1D5A17F6EAA01071856@Teris.esript.local>
Message-ID: <45004FF4.3030005@pobox.com>

Pedro Oliveira wrote:
>  
> 
> Good Morning LIST
> 
>  
> 
> I?m trying to import HDF-SMI from MODIS to TiF, and i?m using the GDAL 
> FWTools application.
> 
> I?m using the following sintax for importing the hdf image in a batch 
> file that uses some variables to lock the file name:
> 
>  
> 
> GDAL_TRANSLATE -OF GTIFF %DIRIN%\%%X  %DIROUT%\%%~nX.TIF
> 
>  
> 
> Everything work?s fine. The problem is the this:
> 
> The outpu image is a GeoTiff but it dosn?t have lat/long georeferencing, 
> but has row/column info. Ive tried to use some paramenter like ?t_srs or 
> ?s_srs in gdalwarp but didn?t work.
> 
> When i use gdalinfo i cn see that the HDF file dosn?t have a explicit 
> geographical information, but the information has lat/long data.
> 
>  
> 
> Is there a way to import image and have the output file as lat/long 
> (wgs84) georefernced

Pedro,

It seems the HDF files don't have "standard" geolocation information.  But
the metadata comments indicate it is equidistant cylindrical (same as
WGS84 geographic for our purposes) for the whole world.  So the following
would produce a GeoTIFF with a coordinate system and bounds.

   gdal_translate A20052132005243.L3m_MO_CHLO_4 out.tif \
             -a_srs WGS84 -a_ullr -180 90 180 -90

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jingmuyang at aol.com  Thu Sep  7 13:32:30 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Reading Erdas Imagine Files Through GDAL 1.3.2
Message-ID: <6194856.post@talk.nabble.com>


I experience the performance downgrade after linking my application into GDAL
1.3.2 to read (open) large (200MB) Erdas Imagine files.  It paused about
20-30 seconds in calling GDALOpen.  But when I used the early GDAL release
(1.2.6) reading such files were very fast.  What happens with the latest
release of GDAL?

Thanks ahead!

Jingmu

-- 
View this message in context: http://www.nabble.com/Reading-Erdas-Imagine-Files-Through-GDAL-1.3.2-tf2234529.html#a6194856
Sent from the GDAL - Dev forum at Nabble.com.


From jingmuyang at aol.com  Thu Sep  7 13:46:28 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] GDAL and Solaris 10/sparc
In-Reply-To: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
References: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
Message-ID: <6195088.post@talk.nabble.com>


I used the following configuration to successfully build GDAL 1.3.2 on
Solaris 10 with gcc 3.4.3 under /usr/sfw/bin/.

./configure --with-png=internal --with-jpeg=internal --with-geotiff=internal
--with-libtiff=internal --with-libz=internal --with-unix-stdio-64=no
--with-static-proj4=/usr/local/lib

Jingmu



Shaun Kolomeitz wrote:
> 
> 
> After months of searching, hacking and many hundreds of compile attempts I
> am still unable to successfully get GDAL to compile on a SPARC/Solaris 10
> environment. No amount of searching lists and getting obscure possible
> fixes has worked.
> My original aim was to get GDAL with ECW compiled and going, but for now
> I'd even settle for just Geotiff, HFA and JPEG. I'll just have to use
> WindoZe to do any other conversions.
> Would someone mind sending me some settings from their working GDAL
> sparc/Solaris X configurations ?
> Stuff like the system wide "crle", PATH and LD_LIBRARY_PATH settings for
> compilation and the versions of GCC/etc that actually work.
> Any other suggestions that might help me get this going would be most
> welcome.
> 
> TIA,
> Shaun
> 
> 
> ___________________________
> Disclaimer
> 
> This e-mail, including attachments if any, has originated from a
> Queensland government agency and may contain information that is
> confidential, or covered by legal professional privilege, and is intended
> for the named recipient(s) only.  If you have received this message in
> error, you are asked to inform the sender as quickly as possible and
> delete this message and any copies of this message from your computer
> system network.
> 
> Any form of disclosure, modification, distribution and/or publication of
> this e-mail, including attachments is prohibited.  Unless otherwise
> stated, this e-mail, including attachments represents the views of the
> sender and not the views of the Environmental Protection Agency.
> 
> Although this e-mail has been checked for the presence of computer
> viruses, the Environmental Protection Agency provides no warranty that all
> possible viruses have been detected and cleaned.  Any use of this e-mail
> could harm your computer system.
> ___________________________
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://www.nabble.com/GDAL-and-Solaris-10-sparc-tf2149918.html#a6195088
Sent from the GDAL - Dev forum at Nabble.com.


From warmerdam at pobox.com  Thu Sep  7 16:36:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Reading Erdas Imagine Files Through GDAL 1.3.2
In-Reply-To: <6194856.post@talk.nabble.com>
References: <6194856.post@talk.nabble.com>
Message-ID: <450082C3.9000207@pobox.com>

Jingmu Yang wrote:
> I experience the performance downgrade after linking my application into GDAL
> 1.3.2 to read (open) large (200MB) Erdas Imagine files.  It paused about
> 20-30 seconds in calling GDALOpen.  But when I used the early GDAL release
> (1.2.6) reading such files were very fast.  What happens with the latest
> release of GDAL?

Jingma,

There have been a variety of improvements to the HFA driver in the last year
or two.  I suspect you are suffering from a lot of time being spent turning
a color table into a GDAL "Raster Attribute Table".  I recall having to
do some serious work to improve the performance of this, though I'm not
clear on whether that was before or after the GDAL 1.3.2 release. I'd
suggest trying your gdalinfo, and the gdalinfo from a recent FWTools and
see if the fwtools gdalinfo is nice and fast.  Alternatively, try building
from GDAL CVS source for comparison.

If the problem persists with recent source then please file a bug and make
your file available somewhere for me to try with.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From rsignell at usgs.gov  Thu Sep  7 18:45:07 2006
From: rsignell at usgs.gov (Rich Signell)
Date: Wed Nov 21 11:50:20 2007
Subject: [Gdal-dev] Motion: Tamas Szekeres as a GDAL committer
In-Reply-To: <f3b73b7d0609061633t655e2417vc99331f31a423e29@mail.gmail.com>
References: <44F9FD55.9000806@pobox.com>
	<20060905115205.GA17810@ak4719.spb.edu> <44FF4BF1.1010401@pobox.com>
	<f3b73b7d0609061633t655e2417vc99331f31a423e29@mail.gmail.com>
Message-ID: <61033b870609071545m8aef324j562a0cf5f61234b3@mail.gmail.com>

GDAL NetCDF driver folk:

The NetCDF driver seems to lose the geoferencing info on output.

I was excited to see that in the GDAL 1.3.2.0 that I got with FWTOOLS
1.0.6, the CF-style "netcdf" is available as an output format!  (Even
though
http://gdal.maptools.org/formats_list.html doesn't yet list "creation"
for NetCDF, however).

I tried converting a geotiff using:

gdal_translate -of netcdf  SeaWiFS.tif SeaWiFS.nc

and it works fine (but didn't give the usual 0... 10... 20...), but
loses the georeferencing information.  It writes only the pixel values
and not the coordinate variables:

$ ncdump -h SeaWiFS.nc
netcdf SeaWiFS {
dimensions:
        x = 36000 ;
        y = 7000 ;
variables:
        byte Band1(y, x) ;
                Band1:long_name = "GDAL Band Number 1" ;
                Band1:_FillValue = -9999. ;

// global attributes:
                :Conventions = "CF-1.0" ;
                :AREA_OR_POINT = "Area" ;
}


Thanks,
Rich
-- 
Dr. Richard P. Signell   (508) 457-2229
USGS, 384 Woods Hole Rd.
Woods Hole, MA 02543-1598

From ben at vterrain.org  Thu Sep  7 20:26:24 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL windows installer?
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D45501CE6BBD@Iris.ad.clarku.edu>
Message-ID: <00be01c6d2dd$6b4112f0$9b02a8c0@DellWork>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: apps_with_data.iss
Type: application/octet-stream
Size: 8341 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060907/8653da05/apps_with_data.obj
From daim.project at free.fr  Fri Sep  8 06:13:22 2006
From: daim.project at free.fr (David Marteau)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDALGetOpenDatasets
Message-ID: <45014242.1070804@free.fr>

Hi

There is something I do not understand with the C function 
GDALOpenDatasets : why this function requires a  GDALDatasetH*** as input  ?
The returned pointer from GDALDataset::GetOpenDatasets is a 
GDALDataset** and then should be cast to a GDALDatasetH* ,(which 
translate to void**) not a GDALDatasetH** ? Thus the required parameter 
should be a GDALDatasetH** instead.

Please, tell me I have missed something here.

David



From Martin.Spott at mgras.net  Fri Sep  8 07:51:03 2006
From: Martin.Spott at mgras.net (Martin Spott)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL and Solaris 10/sparc
References: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
	<6195088.post@talk.nabble.com>
Message-ID: <edrlf7$15m6$1@osprey.mgras.de>

Hi Jingmu,

Jingmu Yang wrote:

> I used the following configuration to successfully build GDAL 1.3.2 on
> Solaris 10 with gcc 3.4.3 under /usr/sfw/bin/.
> 
> ./configure --with-png=internal --with-jpeg=internal --with-geotiff=internal
> --with-libtiff=internal --with-libz=internal --with-unix-stdio-64=no
[...]                                            ^^^^^^^^^^^^^^^^^^^^^

I'm very curious to know which goals you achieve with this option.

Thanks,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------

From mhanson at photon.com  Fri Sep  8 09:06:21 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] URL filenames
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278576@pj-exchange.photon.com>

Does GDAL support URL filenames at all, or is that left up to each Driver?   Is there a way to know which ones do without testing each one?   Does the VRT format support URL's ?
 
Thanks!
 
matt


From jingmuyang at aol.com  Fri Sep  8 09:24:24 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL and Solaris 10/sparc
In-Reply-To: <edrlf7$15m6$1@osprey.mgras.de>
References: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
	<6195088.post@talk.nabble.com> <edrlf7$15m6$1@osprey.mgras.de>
Message-ID: <6208832.post@talk.nabble.com>


The reason why I used option --with-unix-stdio-64=no in configuration is that
I experienced compiling error.  After I added that option the build went
through.  My goal is just to build the library successfully.

Regards,

Jingmu



Martin Spott wrote:
> 
> Hi Jingmu,
> 
> Jingmu Yang wrote:
> 
>> I used the following configuration to successfully build GDAL 1.3.2 on
>> Solaris 10 with gcc 3.4.3 under /usr/sfw/bin/.
>> 
>> ./configure --with-png=internal --with-jpeg=internal
>> --with-geotiff=internal
>> --with-libtiff=internal --with-libz=internal --with-unix-stdio-64=no
> [...]                                            ^^^^^^^^^^^^^^^^^^^^^
> 
> I'm very curious to know which goals you achieve with this option.
> 
> Thanks,
> 	Martin.
> -- 
>  Unix _IS_ user friendly - it's just selective about who its friends are !
> --------------------------------------------------------------------------
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://www.nabble.com/GDAL-and-Solaris-10-sparc-tf2149918.html#a6208832
Sent from the GDAL - Dev forum at Nabble.com.


From dpinte at itae.be  Fri Sep  8 11:03:00 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <44FDA811.1090705@noaa.gov>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae>  <44FDA811.1090705@noaa.gov>
Message-ID: <1157727780.16798.5.camel@geru-itae>

Le mardi 05 septembre 2006 ? 09:38 -0700, Christopher Barker a ?crit :
> Didrik Pinte wrote:
> > Because of a problem between gdalnumeric and python-numpy, I have
> > uninstalled the following packages and kept only python-numeric :
> > 
> > apt-get remove python-numpy python-numpy-ext python-scipy fftw3
> > 
> > It solved the problem ! That's strange.
> 
> That is very odd. the new numpy and the old Numeric should have no 
> trouble at all co-existing.
> 
> My guess is that it is a Debian bug -- perhaps the python-numpy package 
> is set up to replace Numeric, rather than coexist with it. However, if 
> not, then there may be a bug in numpy, and it should be reported. It is 
> certainly intended that they don't interfere with one another.
> 
> -Chris

Chris, 

You were right. It's a Debian bug.

The following library cannot coexist on the system :

/usr/lib/python2.4/site-packages/numpy/core/multiarray.so

/usr/lib/python2.4/site-packages/Numeric/multiarray.so

When they are both present, I get the GEOS exception.

I'll report this to the Debian BTS.

Didrik


From warmerdam at pobox.com  Fri Sep  8 11:15:28 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] URL filenames
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70278576@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278576@pj-exchange.photon.com>
Message-ID: <45018910.8050500@pobox.com>

Matt Hanson wrote:
> Does GDAL support URL filenames at all, or is that left up to each Driver?
> Is there a way to know which ones do without testing each one?   Does the
> VRT format support URL's ?

Matt,

Currently the only driver which really supports urls is the OPeNDAP driver,
which the uses a special protocol to talk to the remote server.  GDAL does
not currently support fetching remote files and using them locally.

I'd be open to the idea of having GDALOpen() take care of fetching the
data from an URL if it wasn't successfully opened on a first pass through
the drivers.  Then try opening the fetched data file.  But this isn't
something I'm planning to implement soon.

I'd add I am hoping to implement WCS client support in GDAL this fall.  So
we need to keep in mind that some drivers may want to handle http urls in
special ways.  That's why I suggest it only be generically fetched if none
of the drivers access it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Fri Sep  8 11:29:11 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDALGetOpenDatasets
In-Reply-To: <45014242.1070804@free.fr>
References: <45014242.1070804@free.fr>
Message-ID: <45018C47.3010109@pobox.com>

David Marteau wrote:
> Hi
> 
> There is something I do not understand with the C function 
> GDALOpenDatasets : why this function requires a  GDALDatasetH*** as 
> input  ?
> The returned pointer from GDALDataset::GetOpenDatasets is a 
> GDALDataset** and then should be cast to a GDALDatasetH* ,(which 
> translate to void**) not a GDALDatasetH** ? Thus the required parameter 
> should be a GDALDatasetH** instead.
> 
> Please, tell me I have missed something here.

David,

Yikes!  You are quite right.  I have corrected this in CVS.  I normally
hate to change stable C APIs, even when they are wrong, but I will break
my rule of thumb in this case because:

  1) This function is very very rarely used.

  2) The change doesn't affect the ABI.  At most it would mean calling
     code needs to be altered a bit to compile.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dpinte at itae.be  Fri Sep  8 13:45:36 2006
From: dpinte at itae.be (Didrik Pinte)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] python gdal 1.3.2 and geos
In-Reply-To: <45019418.9000900@noaa.gov>
References: <1157365525.23753.33.camel@geru-itae>
	<1157377858.2561.4.camel@geru-itae> <44FDA811.1090705@noaa.gov>
	<1157727780.16798.5.camel@geru-itae>  <45019418.9000900@noaa.gov>
Message-ID: <1157737536.19740.5.camel@geru-itae>

Le vendredi 08 septembre 2006 ? 09:02 -0700, Christopher Barker a
?crit :
> Didrik Pinte wrote:
> > You were right. It's a Debian bug.
> > 
> > The following library cannot coexist on the system :
> > 
> > /usr/lib/python2.4/site-packages/numpy/core/multiarray.so
> > 
> > /usr/lib/python2.4/site-packages/Numeric/multiarray.so
> > 
> > When they are both present, I get the GEOS exception.
> 
> For what it's worth, I have both of those on my Fedora Core 4 system, 
> and have never had a problem, even if I import both Numeric and numpy in 
> the same app.
> 
> This might be worth a post to the numpy list, at least if you're using 
> recent versions of both Numeric and numpy.
> 
> -Chris

I've identified the culprit and made a test case.

When matplotlib/pylab is configured to use the numpy library and loaded
into my application, it causes the GEOS exception. So it's not a numpy
problem but probably a matplotlib specific bug.

Didrik


From mhanson at photon.com  Fri Sep  8 15:40:49 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>

I'm having problems programatically creating VRT datasets.
 
Here's my code:
 
GDALDataset *ds = driver->Create(filename, ROI.width(), ROI.height(), 1, GDALType(&typeid(T)), NULL);
stringstream XML;
XML << "<SimpleSource>"
<< "<SourceFilename relativeToVRT=\"1\">" << Image.Filename() 
<< "</SourceFilename><SourceBand>1</SourceBand>"
<< "<SrcRect xOff=\"" << ROI.x0() << "\" yOff=\"" << ROI.y0() << "\" xSize=\"" << ROI.width()
<< "\" ySize=\"" << ROI.height() << "\"/>"
<< "<DstRect xOff=\"0\" yOff=\"0\" xSize=\"" << ROI.width() << "\" ySize=\"" << ROI.height() << "\"/>"
<< "</SimpleSource>";
ds->GetRasterBand(1)->SetMetadataItem("source_0", XML.str().c_str(), "new_vrt_sources");
delete ds;
 
**************************************************
 
What I get for an output file is:
<VRTDataset rasterXSize="400" rasterYSize="400">

<VRTRasterBand dataType="Int16" band="1"/>

</VRTDataset>

**************************************************

It's not writing the SimpleSource section using the SetMetaDataItem function.   Am I using it wrong here?



From dyang at NRCan.gc.ca  Fri Sep  8 17:33:33 2006
From: dyang at NRCan.gc.ca (Yang, Richard)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Gdal compiling error 
Message-ID: <F0E0B899CB43D5118D220002A55113CF0B382DBB@s2-edm-r1.nrn.nrcan.gc.ca>

I tried to build gdal-1.3.2 on solaris2.8 and encountered an error:

ld: fatal: relocations remain against allocatable but non-writable
sections
collect2: ld returned 1 exit status
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/data/lmn20/Emergy/gdal'
make: *** [check-lib] Error 2
2257.53u 418.81s 49:32.25 90.0%

What "non-writable sections collect2" means? How to walk around it?

TIA

Richard Yang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060908/c139b189/attachment.html
From putler at sauder.ubc.ca  Fri Sep  8 19:13:13 2006
From: putler at sauder.ubc.ca (Dan Putler)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GML file problems
Message-ID: <674ACC5B-61B8-47A5-B206-D7D28E51ABF9@sauder.ubc.ca>

Hi All,

I'm attempting to use ogr2ogr for the purposes of converting a file  
encoded in GML2.1.2 to a shapefile, but ogr2ogr is not recognizing it  
as a GML file. I'm using the version of gdal/ogr bundled with FWTools  
1.0.5.

Here is the GML file I'm trying to use as a source:

<?xml version="1.0" encoding="utf-8" standalone="no"?>
<PostalCodeLookup version="1.0.0" xmlns:xsi="http://www.w3.org/2001/ 
XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://cgdi- 
dev.geoconnections.org/prototypes/schemas/cgdi/postalcode/1.0.0/ 
postalcode.xsd" xmlns:gml="http://www.opengis.net/gml">
	<gml:boundedBy>
		<gml:Null>inapplicable</gml:Null>
	</gml:boundedBy>
	<PostalCodeResultSet sortArea="FSA">
		<PostalCode>
			<gml:name>V1A</gml:name>
			<Placename>Kimberley</Placename>
			<ProvinceOrTerritory>BC</ProvinceOrTerritory>		
			<gml:centerOf>
				<gml:Point srsName="http://www.opengis.net/gml/srs/epsg.xml#4326">
					<gml:coordinates>-115.970116,49.660305</gml:coordinates>
				</gml:Point>
			</gml:centerOf>
		</PostalCode>
	</PostalCodeResultSet>
</PostalCodeLookup>

Dan

From jgreenberg at arc.nasa.gov  Fri Sep  8 19:39:49 2006
From: jgreenberg at arc.nasa.gov (Jonathan Greenberg)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Any advances in getting LFS under cygwin/windows?
Message-ID: <000b01c6d3a0$19bd6af0$0701a8c0@QWARD>

I was just checking in to see if anyone had managed to get large file
support working for gdal under cygwin/windows?  Although cygwin claims LFS
for NTFS, as of 6 months ago we couldn't get GDAL to read large files beyond
the 2gb (or is it 4gb) threshold...

--j

--

Jonathan A. Greenberg, PhD
NASA Postdoctoral Researcher
NASA Ames Research Center
MS 242-4
Moffett Field, CA 94035-1000
Phone: 415-794-5043
AIM: jgrn3007
MSN: jgrn3007@hotmail.com



From warmerdam at pobox.com  Fri Sep  8 22:30:07 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Gdal compiling error
In-Reply-To: <F0E0B899CB43D5118D220002A55113CF0B382DBB@s2-edm-r1.nrn.nrcan.gc.ca>
References: <F0E0B899CB43D5118D220002A55113CF0B382DBB@s2-edm-r1.nrn.nrcan.gc.ca>
Message-ID: <931f8ea90609081930g32cec757nddef6865af470875@mail.gmail.com>

On 9/8/06, Yang, Richard <dyang@nrcan.gc.ca> wrote:
>
>
>
> I tried to build gdal-1.3.2 on solaris2.8 and encountered an error:
>
> ld: fatal: relocations remain against allocatable but non-writable sections
> collect2: ld returned 1 exit status
> make[1]: *** [libgdal.la] Error 1
> make[1]: Leaving directory `/data/lmn20/Emergy/gdal'
> make: *** [check-lib] Error 2
> 2257.53u 418.81s 49:32.25 90.0%
>
> What "non-writable sections collect2" means? How to walk around it?

Richard,

I'm not really sure what this means.  Things to keep in mind
on Solaris are:
 o Care with 32bit vs. 64bit environment.
 o I believe -fPIC is manditory for shared libraries.

However, i'm not at all sure you are running into either of those.
All I can advise is:

 1) Try configuring --without-libtool.   In theory libtool helps work
     around platform specific problems.  But when it fails it can
     be very hard (for me at least) to figure out why.

 2) Try reducing he number of external libraries used.  For
      instance, if external postres libs are being picked up,
     consider configuring --without-pg if only to narrow down
     what may be the issue.  Often some sort of mismatched
     libraries getting linked in is an issue.

Some on else also recently mentioned configuring
--without-unix-stdio-64 which could help, though you
would presumably be limited to files up to 2GB.

Once you narrow down what change gets the build
working, we can consider how that feature can be
re-enabled if you need it.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Sep  8 23:00:31 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>
Message-ID: <931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com>

On 9/8/06, Matt Hanson <mhanson@photon.com> wrote:
> I'm having problems programatically creating VRT datasets.
>

Matt,

This is a bug in the VRT "create from metadata" logic.
It works for calls via SetMetadata(), but not via
SetMetadataItem().  I found that the following slight
variation does work.

I will try and fix this in the code tonight as well,
but for the time being you will need to workaround
it by going through SetMetadata().

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Sep  8 23:01:23 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
In-Reply-To: <931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com>
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>
	<931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com>
Message-ID: <931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>

On 9/8/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> On 9/8/06, Matt Hanson <mhanson@photon.com> wrote:
> > I'm having problems programatically creating VRT datasets.
> >
>
> Matt,
>
> This is a bug in the VRT "create from metadata" logic.
> It works for calls via SetMetadata(), but not via
> SetMetadataItem().  I found that the following slight
> variation does work.

Matt,

As usual, I forgot the actual text.

#include "gdal_priv.h"

int main()

{
    GDALAllRegister();

    GDALDriver *driver = (GDALDriver *) GDALGetDriverByName( "VRT" );
    GDALDataset *ds = driver->Create("test.vrt", 500, 500, 1, GDT_Byte, NULL );
    char *pszXML = "source_0=<SimpleSource>"
        "<SourceFilename relativeToVRT=\"1\">utm.tif</SourceFilename>"
        "<SourceBand>1</SourceBand>"
        "<SrcRect xOff=\"0\" yOff=\"0\" xSize=\"100\" ySize=\"100\"/>"
        "<DstRect xOff=\"0\" yOff=\"0\" xSize=\"100\" ySize=\"100\"/>"
        "</SimpleSource>";
    char *apszMD[2] = { pszXML, NULL };

//    ds->GetRasterBand(1)->SetMetadataItem("source_0", pszXML,
"new_vrt_sources");
    ds->GetRasterBand(1)->SetMetadata( apszMD, "new_vrt_sources");
    delete ds;
}

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Sat Sep  9 00:21:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
In-Reply-To: <931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>
	<931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com>
	<931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>
Message-ID: <931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com>

On 9/8/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>     char *pszXML = "source_0=<SimpleSource>"


Matt,

One point I wasn't very specific about is that embedding
the name of the item becomes important (as above) when
using SetMetadata().

I have now fixed VRTSourcedRasterBand so that
SetMetadataItem() on a single item also works.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Sat Sep  9 00:24:06 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Any advances in getting LFS under cygwin/windows?
In-Reply-To: <000b01c6d3a0$19bd6af0$0701a8c0@QWARD>
References: <000b01c6d3a0$19bd6af0$0701a8c0@QWARD>
Message-ID: <931f8ea90609082124p5e9eef08gc059dbec3a880008@mail.gmail.com>

On 9/8/06, Jonathan Greenberg <jgreenberg@arc.nasa.gov> wrote:
> I was just checking in to see if anyone had managed to get large file
> support working for gdal under cygwin/windows?  Although cygwin claims LFS
> for NTFS, as of 6 months ago we couldn't get GDAL to read large files beyond
> the 2gb (or is it 4gb) threshold...

Jonathan,

I am not aware of any work on this.  It *should* be just
a matter of fixing up the build logic.  But I don't know
what the exact fix will be.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Sat Sep  9 00:34:54 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GML file problems
In-Reply-To: <674ACC5B-61B8-47A5-B206-D7D28E51ABF9@sauder.ubc.ca>
References: <674ACC5B-61B8-47A5-B206-D7D28E51ABF9@sauder.ubc.ca>
Message-ID: <931f8ea90609082134x7c5505f1ieadd0665f2fdc882@mail.gmail.com>

On 9/8/06, Dan Putler <putler@sauder.ubc.ca> wrote:
> Hi All,
>
> I'm attempting to use ogr2ogr for the purposes of converting a file
> encoded in GML2.1.2 to a shapefile, but ogr2ogr is not recognizing it
> as a GML file. I'm using the version of gdal/ogr bundled with FWTools
> 1.0.5.
>
> Here is the GML file I'm trying to use as a source:
>
> <?xml version="1.0" encoding="utf-8" standalone="no"?>
> <PostalCodeLookup version="1.0.0" xmlns:xsi="http://www.w3.org/2001/
> XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://cgdi-
> dev.geoconnections.org/prototypes/schemas/cgdi/postalcode/1.0.0/
> postalcode.xsd" xmlns:gml="http://www.opengis.net/gml">
>         <gml:boundedBy>
>                 <gml:Null>inapplicable</gml:Null>
>         </gml:boundedBy>
>         <PostalCodeResultSet sortArea="FSA">
>                 <PostalCode>
>                         <gml:name>V1A</gml:name>
>                         <Placename>Kimberley</Placename>
>                         <ProvinceOrTerritory>BC</ProvinceOrTerritory>
>                         <gml:centerOf>
>                                 <gml:Point srsName="http://www.opengis.net/gml/srs/epsg.xml#4326">
>                                         <gml:coordinates>-115.970116,49.660305</gml:coordinates>
>                                 </gml:Point>
>                         </gml:centerOf>
>                 </PostalCode>
>         </PostalCodeResultSet>
> </PostalCodeLookup>

Dan,

I'm embarrassed to admit that the OGR GML reader
is a haphazard hack intended to read GML files without
having to look at the schema files.   Because of that, it
uses various giffy rules to try and recognise stuff.

One is that the element that is the parent of a feature
needs to be a gml:featureMember (well actually any
element name ending in Member will do).

Contrast your GML with the style of OGR generated
GML.  Note that all the features are kept in a
featureCollection, and that each feature is a child of
a featureMember element.

<ogr:FeatureCollection
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://ogr.maptools.org/prov.xsd"
     xmlns:ogr="http://ogr.maptools.org/"
     xmlns:gml="http://www.opengis.net/gml">
  <gml:boundedBy>
    <gml:Box>
      <gml:coord><gml:X>2253355.75</gml:X><gml:Y>-76361.7734375</gml:Y></gml:coord>
      <gml:coord><gml:X>2747648.5</gml:X><gml:Y>515489.03125</gml:Y></gml:coord>
    </gml:Box>
  </gml:boundedBy>
  <gml:featureMember>
    <ogr:province fid="F0">
      <ogr:geometryProperty><gml:Polygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>2407487.25,512212.40625
2406782.5,513659.375 2407398.0,515030.53125 2410186.75,515489.03125
2411133.5,513513.125 2409505.75,512788.40625
2407487.25,512212.40625</gml:coordinates></gml:LinearRing></gml:outerBoundaryIs></gml:Polygon></ogr:geometryProperty>
      <ogr:AREA>9359132.000</ogr:AREA>
      <ogr:PERIMETER>12010.509</ogr:PERIMETER>

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ben at vterrain.org  Sat Sep  9 06:36:59 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
Message-ID: <033801c6d3fb$e1f57610$9b02a8c0@DellWork>


I am tring to convert my GDAL-based application to support international
characters in filenames.  So far, this has gone pretty well.  On Windows,
there are the _wfopen etc. methods which can take wide strings.  On Mac OS
X, the standard C library accepts UTF-8 in normal fopen().

However, i've got code calling GDAL functions like this one:
	char **CSLLoad(const char *pszFname)

I don't know how to pass my wide-string filenames to CSLLoad.  It seems to
expect only local charset encoded strings, which means i can't pass it a
filename containing e.g. Chinese characters.

Perhaps there is support for this somewhere in GDAL that i just haven't
found yet?

Another option is for me to open the file first, e.g. for Windows:
	std::wstring fname;
	FILE *fp = _wfopen(fname, L"rb");
	int fd = _fileno(fp);
Then i could pass the fd into GDAL, if it had a way of accepting it.

Help?

Thanks,
Ben


From mhanson at photon.com  Sat Sep  9 09:13:49 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>
	<931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027857A@pj-exchange.photon.com>

Frank, thanks for the quick fix.

________________________________

From: fwarmerdam@gmail.com on behalf of Frank Warmerdam
Sent: Sat 9/9/2006 12:21 AM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Creating VRT datasets



On 9/8/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>     char *pszXML = "source_0=<SimpleSource>"


Matt,

One point I wasn't very specific about is that embedding
the name of the item becomes important (as above) when
using SetMetadata().

I have now fixed VRTSourcedRasterBand so that
SetMetadataItem() on a single item also works.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




From sy at perkins.net  Sat Sep  9 10:23:26 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Any advances in getting LFS under cygwin/windows?
In-Reply-To: <931f8ea90609082124p5e9eef08gc059dbec3a880008@mail.gmail.com>
References: <000b01c6d3a0$19bd6af0$0701a8c0@QWARD>
	<931f8ea90609082124p5e9eef08gc059dbec3a880008@mail.gmail.com>
Message-ID: <4502CE5E.2@perkins.net>




> On 9/8/06, Jonathan Greenberg <jgreenberg@arc.nasa.gov> wrote:
>> I was just checking in to see if anyone had managed to get large file
>> support working for gdal under cygwin/windows?  Although cygwin 
>> claims LFS
>> for NTFS, as of 6 months ago we couldn't get GDAL to read large files 
>> beyond
>> the 2gb (or is it 4gb) threshold...

What format are you using? Note that some formats, e.g. TIFF, have 2 or 
4GB size limits independent of the file system / OS.

Sy



From warmerdam at pobox.com  Sat Sep  9 14:29:38 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <033801c6d3fb$e1f57610$9b02a8c0@DellWork>
References: <033801c6d3fb$e1f57610$9b02a8c0@DellWork>
Message-ID: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>

On 9/9/06, Ben Discoe <ben@vterrain.org> wrote:
>
> I am tring to convert my GDAL-based application to support international
> characters in filenames.  So far, this has gone pretty well.  On Windows,
> there are the _wfopen etc. methods which can take wide strings.  On Mac OS
> X, the standard C library accepts UTF-8 in normal fopen().
>
> However, i've got code calling GDAL functions like this one:
>         char **CSLLoad(const char *pszFname)
>
> I don't know how to pass my wide-string filenames to CSLLoad.  It seems to
> expect only local charset encoded strings, which means i can't pass it a
> filename containing e.g. Chinese characters.
>
> Perhaps there is support for this somewhere in GDAL that i just haven't
> found yet?

Ben,

There is currently no suppot in GDAL for wide strings, or
wide string filenames.  It seems it is not an issue on MacOS X
since you can use a utf-8 encoding.  As far as I know fopen()
is the only low level open function used by GDAL (well there
might be a few exceptions in sublibraries using open()
instead).

> Another option is for me to open the file first, e.g. for Windows:
>         std::wstring fname;
>         FILE *fp = _wfopen(fname, L"rb");
>         int fd = _fileno(fp);
> Then i could pass the fd into GDAL, if it had a way of accepting it.

There is no support for this in GDAL.

For something like CSLLoad(), it is easy enough to
reimplement yourself.  But it is a big issue for all the
files opened through GDALOpen().

Actually, in thinking about it, you could in theory
implement some sort of special VSI*L handler that
knows how to handle wide strings.  This would be
fairly involved though, and would still only work
for those drivers that use the VSIFOpenL() function
as opposed to VSIFOpen() or their own direct
fopen() or open() calls.

Are you sure there isn't someway of turning wide
string filenames into something compatible with
fopen() on windows?  I have tried opening a variety
of unusual filenames in different character sets,
including double byte names, on windows successfully
(I think). I believe I just passed whatever got passed
in as a filename after using shell completion.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From naiara at mail.utexas.edu  Sat Sep  9 16:51:33 2006
From: naiara at mail.utexas.edu (Naiara Pinto)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] spheroid to sphere (gdalwarp)
Message-ID: <9d4084070609091351y24e5c06fs29eaecc87aa09c53@mail.gmail.com>

Hi all,

I am trying to project some layers from Lat Long (WGS84 and NAD83)
into Lambert Azimuthal Equal Area (ellipse = Sphere). Here is the
command I use:

gdalwarp -s_srs '+proj=longlat +ellps=GRS80 +datum=NAD83 +no_defs'
-t_srs '+proj=laea +lat_0=44.807685 +lon_0=-100 +ellps=sphere +x_0=0
+y_0=0 +units=m +no_defs' -tr 30 30 -rn  -srcnodata -9999 -dstnodata
-9999 land_cover.tif pland_cover.tif

The center latitude of the output layer is actually 45N, but it seems
GDALWARP defines the latitude in accordance with the datum of the
source file.
I used this command with several layers and they all line up. The
problem is that they don't line up with the layer that was originally
in Lambert Azimuthal Equal Area. The projected layers seem to be
shifted east (although the fit looks better in the center).

Is there a problem transforming the data from spheroid to sphere, and
if so, what could I do to get around this?

Thanks!

Naiara.

From ben at vterrain.org  Sat Sep  9 20:31:48 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>
Message-ID: <009f01c6d470$81309bf0$9b02a8c0@DellWork>

Hi Frank,

> There is currently no suppot in GDAL for wide strings, or
> wide string filenames.  As far as I know
> fopen() is the only low level open function used by GDAL
> (well there might be a few exceptions in sublibraries using
> open() instead).

Yes, fortunately the problem seems isolated to fopen(), hopefully due to
that, we can find a single-point fix.  It's good that the resulting FILE* is
no different regardless of the filename's charset or how it was opened.

> > Another option is for me to open the file first, e.g. for Windows:
> >         std::wstring fname;
> >         FILE *fp = _wfopen(fname, L"rb");
> >         int fd = _fileno(fp);
> > Then i could pass the fd into GDAL, if it had a way of accepting it.
>
> There is no support for this in GDAL.

That might be a (relatively) painless solution then - for a the few places
in GDAL that take a (const char *) filename, a second entry point that take
a (FILE *).  I will explore this option, but you may already understand the
ramifications better?

> For something like CSLLoad(), it is easy enough to
> reimplement yourself.  But it is a big issue for all the
> files opened through GDALOpen().

Might be.  I hope not too bad.

> Actually, in thinking about it, you could in theory implement
> some sort of special VSI*L handler that knows how to handle
> wide strings.

But the methods above it (like CSLLoad) would still need to accept the wide
string in order to pass it on to the VSI*L handle, i think?

> Are you sure there isn't someway of turning wide string
> filenames into something compatible with
> fopen() on windows?

Nope, fopen() on Windows (and most Unices, AFAIK) assume that the (const
char *) is in the current charset (local code page, multi-byte).  This means
you can open chinese-name files on a chinese-locale OS, and euro-names on a
euro-locale OS, but not any other situation.  That puts on a damper on
international file exchange, the problem i am trying to fix.

> I have tried opening a variety of
> unusual filenames in different character sets, including
> double byte names, on windows successfully (I think). I
> believe I just passed whatever got passed in as a filename
> after using shell completion.

What shell are you using?   
I tried with cygwin, and this is what i get.  I made a couple sample files,
one with western europe non-ASCII characters, and one with Chinese
characters.  When i 'ls', the non-ASCII are displayed as question marks:

$ ls
??City.dem  Pa?sCatalu?a.dem

That should be (Bei)(Jing)City.dem, and Pa?sCatalu?a.dem (accent on i, tilde
on n).

Using the shell completion, it works for the western europe name (since
that's my machine's locale) but fails for the Chinese:  The shell apparently
tries to make escape sequences:

$ gdalinfo Pa\355sCatalu\361a.dem
Driver: USGSDEM/USGS Optional ASCII DEM (and CDED)
Size is 374, 466
Coordinate System is: [....]

$ gdalinfo \?\?City.dem
ERROR 4: `??City.dem' does not exist in the file system,
and is not recognised as a supported dataset name.
GDALOpen failed - 4

This could be the limitation of Cygwin's default command line, but even if
the command-line handled it, we know it would fail when it gets to GDALOpen.

-Ben

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060909/ac64d6ce/attachment.html
From ben at vterrain.org  Sun Sep 10 04:42:30 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <009f01c6d470$81309bf0$9b02a8c0@DellWork>
Message-ID: <00d301c6d4b5$0df61d00$9b02a8c0@DellWork>

Frank,
 
I'm still interested to see what you think of the previous email, but i did
one test:
 
I split CSLLoad into two methods:  the first takes a (const char *)
filename, the other takes a (FILE *).  The first just calls VSIFOpenL and
calls the second.  That opens the possibility of the user to pass their own
(FILE *) into the second.  However, it doesn't work.
 
Apparently, as the documentation for VSIFOpenL says, "the FILE * returned by
this function is not really a standard C library FILE *, and cannot be used
with any functions other than the VSI*L family of functions."  The converse
appears true as well, you cannot use regular FILE* with the VSI family of
functions.
 
Hence, it seems our uptions are limited to the following:
 
1. Provide a second entry point for each GDAL function taking a (const char
*filename), which takes a (const wchar_t *filename).
 
2. Leave the entry points the same, but declare that all non-ASCII filenames
passed to GDAL must be UTF-8.  This would have no effect on existing code
using ASCII filename, and no effect on existing code on OSX.  Inside
VSIFOpenL or similar, we would need code like this:
 
FILE *VSIFOpenL( const char * pszFilename, ...)
{
#if WIN32
    (convert pszFilename from utf-8 to wide string)
    use _wfopen(wide string);
#elif __DARWIN_OSX__
    (proceed normally, it already expects utf-8)
#else
    // some other flavor of Unix
    (convert pszFilename from utf-8 to wide string to local code page, using
ANSI wctombs())
    use fopen(local string);
#endif
 
3. Do the above, but make the methods which take UTF-8 into a separate set
of entry points.  That makes it 100% sure not to break anyone's existing
code, which might be currently passing in non-ASCII characters.
 
Thoughts?  I can help do the implementation work, as i am now feeling fairly
well grounded in cross-platform charset issues.
 
Thanks,
Ben



  _____  

From: Ben Discoe
Sent: Saturday, September 09, 2006 2:32 PM
To: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] Wide-character filenames with GDAL file IO?



> > Then i could pass the fd into GDAL, if it had a way of accepting it.
>
> There is no support for this in GDAL.

That might be a (relatively) painless solution then - for a the few places
in GDAL that take a (const char *) filename, a second entry point that take
a (FILE *).  I will explore this option, but you may already understand the
ramifications better?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060909/55c407e4/attachment.html
From tflynch at gmail.com  Sun Sep 10 18:51:29 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ECW JPEG 2000 SDK v3.3: final source distribution
	released
Message-ID: <c39b2a650609101551w41f853c1p6be325dd8ddf4b8a@mail.gmail.com>

Dear GDAL users and developers,

ER Mapper is pleased to announce that v3.3 of the ECW JPEG 2000 SDK
now has a source distribution for Linux, Solaris, Windows and Mac OS X
ready and in public release.

Detailed product information and downloads are available at

http://www.ermapper.com/downloads/download_view.aspx?PRODUCT_VERSION_ID=305

A number of bugs have been fixed for this final v3.3 release, Visual
Studio 2005 build files have been refreshed, and the stability of the
non-win32 threading model has been improved significantly.

We hope this latest release will improve the experience of GDAL users
when processing the ECW and JPEG 2000 formats.  Please direct all
feedback to devsupport@ermapper.com.au .

Regards

-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From poz at rocketmail.com  Sun Sep 10 20:24:59 2006
From: poz at rocketmail.com (chris pozsgai)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] (no subject)
Message-ID: <20060911002459.83011.qmail@web50206.mail.yahoo.com>

I am trying to render 48bit RGB TIFF (planar configuration = 2)
  tiled images on a Windows platform (.NET C++ environment).
   
  I have looked through the GDAL sites and posts and
  haven't found any code to do this. 
   
  If I use a CreateDIBSection call with 24bit color, I get
  a very dark image.  (The CreateDIBSection fails for a
  bbp of 48.)
   
  Does anyone have any insight on this?  Does the WinAPI
  or GDI+ support this?  
   
  Thanks,
   
  Chris
   

 			
---------------------------------
Get your own web address for just $1.99/1st yr. We'll help. Yahoo! Small Business.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060910/65c0fc9e/attachment.html
From dron at ak4719.spb.edu  Mon Sep 11 07:06:03 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <009f01c6d470$81309bf0$9b02a8c0@DellWork>
References: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>
	<009f01c6d470$81309bf0$9b02a8c0@DellWork>
Message-ID: <20060911110603.GA21234@ak4719.spb.edu>

On Sat, Sep 09, 2006 at 02:31:48PM -1000, Ben Discoe wrote:
> > I have tried opening a variety of unusual filenames in different
> > character sets, including double byte names, on windows successfully
> > (I think). I believe I just passed whatever got passed in as a
> > filename after using shell completion.
> 
> What shell are you using?   I tried with cygwin, and this is what i
> get.

Ben,

AFAIK Cygwin does not support locale, so any locale-related tests are
not clean under Cygwin.

I think the simplest way to add multibyte support to GDAL is using UTF-8
as an internal character set. All strings and filenames should be passed
in UTF-8 encoding and properly converted to UCS-16 when needed (_wopen
on Windows). The major drawback of this change is additional
requirement: we will need an Unicode library to replace all string
handling functions from the C lib with the Unicode aware ones.

This problem was raised one time in the past, probably this is a time
when we should prepare RFC for GDAL localization. This is a major
change, this change can broke functionality, so it is painful, but
inevitable.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From crane_ba at yahoo.com  Mon Sep 11 09:45:03 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Fatal Error accessing stdClass as array problem
Message-ID: <20060911134503.77938.qmail@web52804.mail.yahoo.com>

Hi,

I have been using OGR_L_GetExtents to access MBR data
about a layer. I have been advised about accessing
this "array" by using normal array notation:
$minx=$ext_array['minx'] - but this only produces the
following error:

Fatal Error: Cannot use object of type stdClass as
array in c:\...

Can anyone advise me on what I need to do to get these
values of of this class?

Ben


__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From nbest at speakeasy.net  Mon Sep 11 09:48:41 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] joining DBFs
Message-ID: <45056939.6090009@speakeasy.net>

Can someone point me to a straightforward way to join attributes from an 
   additional dbf table using either OGR or GRASS, or even Perl?  It's 
so easy in Arc that I would think this has been solved in our world 
also.  So far my impression is that I would have to script a row-by-row 
UPDATE since the SQL drivers don't support any type of JOIN afaik.  It 
seems like I have seen an example somewhere using a Perl DBF module but 
I can't put my finger on it.  I'll keep digging and hopefully this wheel 
has been invented.

Neil

From beyhan at deprem.gov.tr  Mon Sep 11 09:56:30 2006
From: beyhan at deprem.gov.tr (Murat BEYHAN)
Date: Wed Nov 21 11:50:21 2007
Subject: Fw: [Gdal-dev] OGR functionality.
In-Reply-To: <000e01c6d5a7$3787a8d0$6f14a8c0@beyhan>
References: <000e01c6d5a7$3787a8d0$6f14a8c0@beyhan>
Message-ID: <20060911134956.M36686@deprem.gov.tr>

Dear Warmerdam;

Thank you for the previous e mail.

You all right that I was make mistake for gdal by using old version.
I have clean all files related with old gdal version and I have installed
latest version of gdal-1.3.2-1 by using rpm file.
Than I have tried the following command to connect and read data from mysql.

[murat@sakura map]$ ogrinfo /var/www/html/map/agidata.ovf

But I have faced the following results output.

ERROR 4: Update access not supported for VRT datasources.
ERROR 1: Failed to open datasource
`MYSQL:eqinfo,user=root,password=mysql_123,host=localhost,port=3306,tables=deneme'.
FAILURE:
Unable to open datasource `/var/www/html/map/agidata.ovf' with the following
drivers.
  -> ESRI Shapefile
  -> MapInfo File
  -> UK .NTF
  -> SDTS
  -> TIGER
  -> S57
  -> DGN
  -> VRT
  -> AVCBin
  -> REC
  -> Memory
  -> CSV
  -> GML
  -> SQLite
  -> PostgreSQL

Please help me why I'm wrong. And thank you for your interest.
Murat


warmerdam@pobox.com
---------- Forwarded Message -----------
From: "Murat BEYHAN" <beyhan@deprem.gov.tr>
To: "Murat BEYHAN" <beyhan@deprem.gov.tr>
Sent: Mon, 11 Sep 2006 16:35:54 +0300
Subject: Fw: [Gdal-dev] OGR functionality.

----- Original Message ----- 
From: "Frank Warmerdam" <warmerdam@pobox.com>
To: "Murat BEYHAN" <beyhan@deprem.gov.tr>
Cc: <gdal-dev@lists.maptools.org>
Sent: Tuesday, August 22, 2006 4:39 PM
Subject: Re: [Gdal-dev] OGR functionality.

> Murat BEYHAN wrote:
>> Dear Friends;
>>
>> I'm using mandrake linux limited edition 2005.
>> And I'm MapServer user.
>> For the connect MySQL by using ogr I have tried following connection
>>
>> <OGRVRTDataSource>
>>     <OGRVRTLayer name="aqidata">
>> 
>>
<SrcDataSource>MYSQL:eqinfo,user=root,password=mysql_123,host=localhost,port=3306,tables=deneme</SrcDataSource>
>>         <SrcSQL>SELECT ID,Lat,Lon,Mag FROM deneme</SrcSQL>
>>         <GeometryType>wkbPoint</GeometryType>
>>         <GeometryField encoding="PointFromColumns" x="lat" y="lon"/>
>>     </OGRVRTLayer>
>> </OGRVRTDataSource>
>>
>>
>> And I have faced the following
>> [root@sakura murat]# ogrinfo /var/www/html/map/agidata.ovf
>> ogrinfo: symbol lookup error: ogrinfo: undefined symbol:
>> _Z26OGRGeneralCmdLineProcessoriPPPci
>> [root@sakura murat]#
>
> Murat,
>
> This problem isn't related to the .ovf file particulars.  It almost
> certainly means your ogrinfo executable is using the wrong version of
> libgdal.so (likely an older version of libgdal.so with a newer ogrinfo).
>
> Please review your shared library path settings.  You may want to remove
> an older libgdal.so, or perhaps set LD_LIBRARY_PATH to ensure the newer
> library version gets picked up.
>
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | President OSGF, http://osgeo.org
>
>
> -- 
> This message has been scanned for viruses and
> dangerous content by MailScanner, and is
> believed to be clean.
>
>

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.
------- End of Forwarded Message -------


--
Open WebMail Project (http://openwebmail.org)


-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From nbest at speakeasy.net  Mon Sep 11 10:07:12 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: joining DBFs
In-Reply-To: <45056939.6090009@speakeasy.net>
References: <45056939.6090009@speakeasy.net>
Message-ID: <45056D90.2060103@speakeasy.net>

Sorry, I just looked at the OGR SQL page again for the first time in a 
while.  Is the JOIN support new?  Maybe I just conflated the GRASS and 
OGR SQL features.  This looks like it will do the trick.  As penance I 
will submit my query as an example.

Neil


Neil Best wrote:
> Can someone point me to a straightforward way to join attributes from an 
>   additional dbf table using either OGR or GRASS, or even Perl?  It's so 
> easy in Arc that I would think this has been solved in our world also.  
> So far my impression is that I would have to script a row-by-row UPDATE 
> since the SQL drivers don't support any type of JOIN afaik.  It seems 
> like I have seen an example somewhere using a Perl DBF module but I 
> can't put my finger on it.  I'll keep digging and hopefully this wheel 
> has been invented.
> 
> Neil
> 

From crane_ba at yahoo.com  Mon Sep 11 11:19:28 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Adobe SVG to be discontinued next year
Message-ID: <20060911151928.55127.qmail@web52813.mail.yahoo.com>

Hi all,

I have just found out that Adobe will be discontinuing
support/distribution of their SVG Viewer. This has
alarmed me to a certain degree and has made me think
about possible contingency plans should (worst case
scenario I know and very unlikely) SVG become a
second-grade product.

Has anyone used the php_ogr libraries with Macromedia
Flash? If so, what was your general impression? I am
seriously considering having a go at developing what
I'm currently working on in Flash (parallel
development) in case I have to move over.

Has anyone had any success with this?

Ben Crane

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From nbest at speakeasy.net  Mon Sep 11 11:28:19 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: joining DBFs
In-Reply-To: <45056D90.2060103@speakeasy.net>
References: <45056939.6090009@speakeasy.net> <45056D90.2060103@speakeasy.net>
Message-ID: <45058093.9020109@speakeasy.net>

Something is going wrong.  I have created indexes on both tables even
though it wasn't clear if that is strictly necessary for the primary
table.  Having an unknown SRS wouldn't cause this, would it?  I should
just look up my EPSG -- that's what I'll do next.  It appears to do
something before seg-faulting -- maybe there is a corrupt polygon?

I see that the key of the secondary table also gets added as a column,
which Arc also does in a join operation.  I find this unnecessary and
annoying.  Is there an argument in favor?  I guess it can be dropped
easily enough, but notice that DBF truncates that qualified column name.

Also, there appears to be a problem with the -overwrite option that I
show at the end of my output that I don't understand, requiring an rm
step.  Is this a limitation of the SHP driver or something I am doing wrong?

I thought better of attaching my data.  Drop me a line if you would like 
to have a look at it.  Thanks for any insight.


neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
Segmentation fault
neil@gandalf:~/gis/kb$ ogrinfo test mpo2_poverty INFO: Open of `test'
using driver `ESRI Shapefile' successful.

Layer name: mpo2_poverty
Geometry: Polygon
Feature Count: 0
Extent: (0.000000, 0.000000) - (0.000000, 0.000000)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_pov: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
neil@gandalf:~/gis/kb$ ls test
mpo2_poverty.dbf  mpo2_poverty.shp  mpo2_poverty.shx
neil@gandalf:~/gis/kb$ ogrinfo -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" ses INFO: Open of `ses'
using driver `ESRI Shapefile' successful.

Layer name: mpo2
Geometry: Polygon
Feature Count: 17466
Extent: (211950.731904, 1576286.159537) - (885960.120408, 2252334.267779)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_poverty_UNIVERSAL.GEO_IDENTI: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
OGRFeature(mpo2):0
    SHAPECODE (String) = 4610051
    ZONE_AREA (Real) =           415737
    OID_ (Integer) = 17100
    GEO_IDENTI (String) = 4610051
    TOTPOP (Real) =      26.73
    ONE_RACE (Real) =      26.73
    WHITE (Real) =      26.34
    BLACK (Real) =       0.10
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.29
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      26.73
    NHISP_WHIT (Real) =      26.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610051
    HOUSEHOLDS (Real) =     8.75
    HOUSEHOL_A (Real) =     0.42
    POLYGON ((565168.49996185512282
2123297.036226258147508,567837.380521122599021
2123311.42119784001261,567836.905601977137849
2123150.250083384104073,567836.875 2123150.25,566502.812442400609143
2123148.437627284321934,565168.658338983776048
2123146.625130200758576,565168.49996185512282 2123297.036226258147508))

OGRFeature(mpo2):1
    SHAPECODE (String) = 4610042
    ZONE_AREA (Real) =           405230
    OID_ (Integer) = 17097
    GEO_IDENTI (String) = 4610042
    TOTPOP (Real) =      12.42
    ONE_RACE (Real) =      12.42
    WHITE (Real) =      12.30
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.11
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      12.42
    NHISP_WHIT (Real) =      12.30
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610042
    HOUSEHOLDS (Real) =     6.87
    HOUSEHOL_A (Real) =     0.33
    POLYGON ((567837.380521122599021
2123311.42119784001261,570497.874934128252789
2123300.937598436605185,570497.723520182771608
2123157.500268447212875,569167.374749097623862
2123153.875339915510267,567836.905601977137849
2123150.250083384104073,567837.380521122599021 2123311.42119784001261))

OGRFeature(mpo2):2
    SHAPECODE (String) = 4610041
    ZONE_AREA (Real) =           358029
    OID_ (Integer) = 17096
    GEO_IDENTI (String) = 4610041
    TOTPOP (Real) =       0.48
    ONE_RACE (Real) =       0.48
    WHITE (Real) =       0.48
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.48
    NHISP_WHIT (Real) =       0.48
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610041
    HOUSEHOLDS (Real) =     5.00
    HOUSEHOL_A (Real) =     0.24
    POLYGON ((570497.874934128252789
2123300.937598436605185,573158.271560193505138
2123290.454384359996766,573158.381680462392978
2123164.750001248437911,573158.375 2123164.75,571828.062485220958479
2123161.125170259270817,570497.723520182771608
2123157.500268447212875,570497.874934128252789 2123300.937598436605185))

OGRFeature(mpo2):3
    SHAPECODE (String) = 4610052
    ZONE_AREA (Real) =           387044
    OID_ (Integer) = 17101
    GEO_IDENTI (String) = 4610052
    TOTPOP (Real) =      12.21
    ONE_RACE (Real) =      12.21
    WHITE (Real) =      12.06
    BLACK (Real) =       0.14
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.02
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.21
    NOT_HISPAN (Real) =      12.00
    NHISP_WHIT (Real) =      11.84
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610052
    HOUSEHOLDS (Real) =    11.30
    HOUSEHOL_A (Real) =     0.67
    POLYGON ((562499.551199327223003
2123282.650887067895383,565168.49996185512282
2123297.036226258147508,565168.658338983776048
2123146.625130200758576,563834.437308961409144
2123144.812542194500566,562500.262920987908728
2123143.000017553567886,562499.551199327223003 2123282.650887067895383))

OGRFeature(mpo2):4
    SHAPECODE (String) = 4610032
    ZONE_AREA (Real) =           301133
    OID_ (Integer) = 17093
    GEO_IDENTI (String) = 4610032
    TOTPOP (Real) =       0.56
    ONE_RACE (Real) =       0.56
    WHITE (Real) =       0.56
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.56
    NHISP_WHIT (Real) =       0.56
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610032
    HOUSEHOLDS (Real) =     0.47
    HOUSEHOL_A (Real) =     0.04
    POLYGON ((573158.271560193505138
2123290.454384359996766,575833.499946153140627
2123264.680594602134079,575833.422804853646085
2123165.249997253529727,574495.937499998952262
2123165.000005841255188,573158.381680462392978
2123164.750001248437911,573158.271560193505138 2123290.454384359996766))

OGRFeature(mpo2):5
    SHAPECODE (String) = 4610061
    ZONE_AREA (Real) =           373248
    OID_ (Integer) = 17104
    GEO_IDENTI (String) = 4610061
    TOTPOP (Real) =       3.76
    ONE_RACE (Real) =       3.70
    WHITE (Real) =       3.59
    BLACK (Real) =       0.01
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.04
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.06
    HISPANIC (Real) =       0.12
    NOT_HISPAN (Real) =       3.64
    NHISP_WHIT (Real) =       3.53
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610061
    HOUSEHOLDS (Real) =    12.52
    HOUSEHOL_A (Real) =     0.80
    POLYGON ((559860.124304226133972
2123272.137048966716975,562499.551199327223003
2123282.650887067895383,562500.262920987908728
2123143.000017553567886,562500.25 2123143.0,561180.563844703836367
2123135.984603217802942,559860.851143212290481
2123128.969065317418426,559860.124304226133972 2123272.137048966716975))

OGRFeature(mpo2):6
    SHAPECODE (String) = 4610062
    ZONE_AREA (Real) =           387825
    OID_ (Integer) = 17105
    GEO_IDENTI (String) = 4610062
    TOTPOP (Real) =       3.46
    ONE_RACE (Real) =       3.46
    WHITE (Real) =       3.46
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       3.46
    NHISP_WHIT (Real) =       3.46
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610062
    HOUSEHOLDS (Real) =     5.65
    HOUSEHOL_A (Real) =     0.19
    POLYGON ((557183.877244946546853
2123261.476542191114277,559860.124304226133972
2123272.137048966716975,559860.851143212290481
2123128.969065317418426,558541.187734182458371
2123121.953789453487843,557186.092565013910644
2123114.75015982426703,557185.866814971901476
2123129.702169452793896,557183.877244946546853 2123261.476542191114277))

OGRFeature(mpo2):7
    SHAPECODE (String) = 4610031
    ZONE_AREA (Real) =           230844
    OID_ (Integer) = 17092
    GEO_IDENTI (String) = 4610031
    TOTPOP (Real) =       0.07
    ONE_RACE (Real) =       0.07
    WHITE (Real) =       0.07
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.07
    NHISP_WHIT (Real) =       0.07
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610031
    HOUSEHOLDS (Real) =     0.07
    HOUSEHOL_A (Real) =     0.01
    POLYGON ((575833.499946153140627
2123264.680594602134079,578508.610308142262511
2123238.907941915560514,578508.432067663408816
2123165.749987302813679,577170.9375 2123165.5,575833.422804853646085
2123165.249997253529727,575833.499946153140627 2123264.680594602134079))

OGRFeature(mpo2):8
    SHAPECODE (String) = 4609011
    ZONE_AREA (Real) =           229076
    OID_ (Integer) = 16955
    GEO_IDENTI (String) = 4609011
    TOTPOP (Real) =       6.63
    ONE_RACE (Real) =       6.44
    WHITE (Real) =       6.36
    BLACK (Real) =       0.02
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.19
    HISPANIC (Real) =       0.04
    NOT_HISPAN (Real) =       6.59
    NHISP_WHIT (Real) =       6.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609011
    HOUSEHOLDS (Real) =     2.55
    HOUSEHOL_A (Real) =     0.15
    POLYGON ((554590.91588362515904
2123241.632391711231321,557183.877244946546853
2123261.476542191114277,557185.866814971901476
2123129.702169452793896,555888.410371425678022
2123163.290501976385713,554584.285233602509834
2123197.051472527906299,554590.91588362515904 2123241.632391711231321))

OGRFeature(mpo2):9
    SHAPECODE (String) = 4609014
    ZONE_AREA (Real) =          6951748
    OID_ (Integer) = 16957
    GEO_IDENTI (String) = 4609014
    TOTPOP (Real) =     155.95
    ONE_RACE (Real) =     152.29
    WHITE (Real) =     150.60
    BLACK (Real) =       0.42
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       1.27
    TWO_PLUS_R (Real) =       3.66
    HISPANIC (Real) =       1.66
    NOT_HISPAN (Real) =     154.29
    NHISP_WHIT (Real) =     150.18
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609014
    HOUSEHOLDS (Real) =    66.53
    HOUSEHOL_A (Real) =     5.12
    POLYGON ((551953.502148762461729
2123221.448043493088335,554590.91588362515904
2123241.632391711231321,554584.285233602509834
2123197.051472527906299,554600.954803448054008
2121870.175678761675954,554617.624373293714598
2120543.29988499591127,553313.499235470429994
2120577.060855546966195,552009.364189005456865
2120610.822082611266524,551980.995648902608082
2121936.581881972495466,551980.965271481196396
2121938.001523731742054,551953.502148762461729 2123221.448043493088335))

Segmentation fault

neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
FAILED: Layer mpo2_poverty already exists, and -append not specified.
          Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.
neil@gandalf:~/gis/kb$ ogr2ogr -overwrite -sql "SELECT * FROM mpo2 LEFT
JOIN 2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
ERROR 6: DeleteLayer() not supported by this data source.
DeleteLayer() failed when overwrite requested.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.

Neil Best wrote:
> Sorry, I just looked at the OGR SQL page again for the first time in a 
> while.  Is the JOIN support new?  Maybe I just conflated the GRASS and 
> OGR SQL features.  This looks like it will do the trick.  As penance I 
> will submit my query as an example.
> 
> Neil
> 
> 
> Neil Best wrote:
>> Can someone point me to a straightforward way to join attributes from 
>> an   additional dbf table using either OGR or GRASS, or even Perl?  
>> It's so easy in Arc that I would think this has been solved in our 
>> world also.  So far my impression is that I would have to script a 
>> row-by-row UPDATE since the SQL drivers don't support any type of JOIN 
>> afaik.  It seems like I have seen an example somewhere using a Perl 
>> DBF module but I can't put my finger on it.  I'll keep digging and 
>> hopefully this wheel has been invented.
>>
>> Neil
>>



From nbest at speakeasy.net  Mon Sep 11 11:28:19 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: joining DBFs
In-Reply-To: <45056D90.2060103@speakeasy.net>
References: <45056939.6090009@speakeasy.net> <45056D90.2060103@speakeasy.net>
Message-ID: <45058093.9020109@speakeasy.net>

Something is going wrong.  I have created indexes on both tables even
though it wasn't clear if that is strictly necessary for the primary
table.  Having an unknown SRS wouldn't cause this, would it?  I should
just look up my EPSG -- that's what I'll do next.  It appears to do
something before seg-faulting -- maybe there is a corrupt polygon?

I see that the key of the secondary table also gets added as a column,
which Arc also does in a join operation.  I find this unnecessary and
annoying.  Is there an argument in favor?  I guess it can be dropped
easily enough, but notice that DBF truncates that qualified column name.

Also, there appears to be a problem with the -overwrite option that I
show at the end of my output that I don't understand, requiring an rm
step.  Is this a limitation of the SHP driver or something I am doing wrong?

I thought better of attaching my data.  Drop me a line if you would like 
to have a look at it.  Thanks for any insight.


neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
Segmentation fault
neil@gandalf:~/gis/kb$ ogrinfo test mpo2_poverty INFO: Open of `test'
using driver `ESRI Shapefile' successful.

Layer name: mpo2_poverty
Geometry: Polygon
Feature Count: 0
Extent: (0.000000, 0.000000) - (0.000000, 0.000000)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_pov: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
neil@gandalf:~/gis/kb$ ls test
mpo2_poverty.dbf  mpo2_poverty.shp  mpo2_poverty.shx
neil@gandalf:~/gis/kb$ ogrinfo -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" ses INFO: Open of `ses'
using driver `ESRI Shapefile' successful.

Layer name: mpo2
Geometry: Polygon
Feature Count: 17466
Extent: (211950.731904, 1576286.159537) - (885960.120408, 2252334.267779)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_poverty_UNIVERSAL.GEO_IDENTI: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
OGRFeature(mpo2):0
    SHAPECODE (String) = 4610051
    ZONE_AREA (Real) =           415737
    OID_ (Integer) = 17100
    GEO_IDENTI (String) = 4610051
    TOTPOP (Real) =      26.73
    ONE_RACE (Real) =      26.73
    WHITE (Real) =      26.34
    BLACK (Real) =       0.10
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.29
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      26.73
    NHISP_WHIT (Real) =      26.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610051
    HOUSEHOLDS (Real) =     8.75
    HOUSEHOL_A (Real) =     0.42
    POLYGON ((565168.49996185512282
2123297.036226258147508,567837.380521122599021
2123311.42119784001261,567836.905601977137849
2123150.250083384104073,567836.875 2123150.25,566502.812442400609143
2123148.437627284321934,565168.658338983776048
2123146.625130200758576,565168.49996185512282 2123297.036226258147508))

OGRFeature(mpo2):1
    SHAPECODE (String) = 4610042
    ZONE_AREA (Real) =           405230
    OID_ (Integer) = 17097
    GEO_IDENTI (String) = 4610042
    TOTPOP (Real) =      12.42
    ONE_RACE (Real) =      12.42
    WHITE (Real) =      12.30
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.11
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      12.42
    NHISP_WHIT (Real) =      12.30
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610042
    HOUSEHOLDS (Real) =     6.87
    HOUSEHOL_A (Real) =     0.33
    POLYGON ((567837.380521122599021
2123311.42119784001261,570497.874934128252789
2123300.937598436605185,570497.723520182771608
2123157.500268447212875,569167.374749097623862
2123153.875339915510267,567836.905601977137849
2123150.250083384104073,567837.380521122599021 2123311.42119784001261))

OGRFeature(mpo2):2
    SHAPECODE (String) = 4610041
    ZONE_AREA (Real) =           358029
    OID_ (Integer) = 17096
    GEO_IDENTI (String) = 4610041
    TOTPOP (Real) =       0.48
    ONE_RACE (Real) =       0.48
    WHITE (Real) =       0.48
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.48
    NHISP_WHIT (Real) =       0.48
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610041
    HOUSEHOLDS (Real) =     5.00
    HOUSEHOL_A (Real) =     0.24
    POLYGON ((570497.874934128252789
2123300.937598436605185,573158.271560193505138
2123290.454384359996766,573158.381680462392978
2123164.750001248437911,573158.375 2123164.75,571828.062485220958479
2123161.125170259270817,570497.723520182771608
2123157.500268447212875,570497.874934128252789 2123300.937598436605185))

OGRFeature(mpo2):3
    SHAPECODE (String) = 4610052
    ZONE_AREA (Real) =           387044
    OID_ (Integer) = 17101
    GEO_IDENTI (String) = 4610052
    TOTPOP (Real) =      12.21
    ONE_RACE (Real) =      12.21
    WHITE (Real) =      12.06
    BLACK (Real) =       0.14
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.02
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.21
    NOT_HISPAN (Real) =      12.00
    NHISP_WHIT (Real) =      11.84
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610052
    HOUSEHOLDS (Real) =    11.30
    HOUSEHOL_A (Real) =     0.67
    POLYGON ((562499.551199327223003
2123282.650887067895383,565168.49996185512282
2123297.036226258147508,565168.658338983776048
2123146.625130200758576,563834.437308961409144
2123144.812542194500566,562500.262920987908728
2123143.000017553567886,562499.551199327223003 2123282.650887067895383))

OGRFeature(mpo2):4
    SHAPECODE (String) = 4610032
    ZONE_AREA (Real) =           301133
    OID_ (Integer) = 17093
    GEO_IDENTI (String) = 4610032
    TOTPOP (Real) =       0.56
    ONE_RACE (Real) =       0.56
    WHITE (Real) =       0.56
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.56
    NHISP_WHIT (Real) =       0.56
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610032
    HOUSEHOLDS (Real) =     0.47
    HOUSEHOL_A (Real) =     0.04
    POLYGON ((573158.271560193505138
2123290.454384359996766,575833.499946153140627
2123264.680594602134079,575833.422804853646085
2123165.249997253529727,574495.937499998952262
2123165.000005841255188,573158.381680462392978
2123164.750001248437911,573158.271560193505138 2123290.454384359996766))

OGRFeature(mpo2):5
    SHAPECODE (String) = 4610061
    ZONE_AREA (Real) =           373248
    OID_ (Integer) = 17104
    GEO_IDENTI (String) = 4610061
    TOTPOP (Real) =       3.76
    ONE_RACE (Real) =       3.70
    WHITE (Real) =       3.59
    BLACK (Real) =       0.01
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.04
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.06
    HISPANIC (Real) =       0.12
    NOT_HISPAN (Real) =       3.64
    NHISP_WHIT (Real) =       3.53
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610061
    HOUSEHOLDS (Real) =    12.52
    HOUSEHOL_A (Real) =     0.80
    POLYGON ((559860.124304226133972
2123272.137048966716975,562499.551199327223003
2123282.650887067895383,562500.262920987908728
2123143.000017553567886,562500.25 2123143.0,561180.563844703836367
2123135.984603217802942,559860.851143212290481
2123128.969065317418426,559860.124304226133972 2123272.137048966716975))

OGRFeature(mpo2):6
    SHAPECODE (String) = 4610062
    ZONE_AREA (Real) =           387825
    OID_ (Integer) = 17105
    GEO_IDENTI (String) = 4610062
    TOTPOP (Real) =       3.46
    ONE_RACE (Real) =       3.46
    WHITE (Real) =       3.46
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       3.46
    NHISP_WHIT (Real) =       3.46
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610062
    HOUSEHOLDS (Real) =     5.65
    HOUSEHOL_A (Real) =     0.19
    POLYGON ((557183.877244946546853
2123261.476542191114277,559860.124304226133972
2123272.137048966716975,559860.851143212290481
2123128.969065317418426,558541.187734182458371
2123121.953789453487843,557186.092565013910644
2123114.75015982426703,557185.866814971901476
2123129.702169452793896,557183.877244946546853 2123261.476542191114277))

OGRFeature(mpo2):7
    SHAPECODE (String) = 4610031
    ZONE_AREA (Real) =           230844
    OID_ (Integer) = 17092
    GEO_IDENTI (String) = 4610031
    TOTPOP (Real) =       0.07
    ONE_RACE (Real) =       0.07
    WHITE (Real) =       0.07
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.07
    NHISP_WHIT (Real) =       0.07
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610031
    HOUSEHOLDS (Real) =     0.07
    HOUSEHOL_A (Real) =     0.01
    POLYGON ((575833.499946153140627
2123264.680594602134079,578508.610308142262511
2123238.907941915560514,578508.432067663408816
2123165.749987302813679,577170.9375 2123165.5,575833.422804853646085
2123165.249997253529727,575833.499946153140627 2123264.680594602134079))

OGRFeature(mpo2):8
    SHAPECODE (String) = 4609011
    ZONE_AREA (Real) =           229076
    OID_ (Integer) = 16955
    GEO_IDENTI (String) = 4609011
    TOTPOP (Real) =       6.63
    ONE_RACE (Real) =       6.44
    WHITE (Real) =       6.36
    BLACK (Real) =       0.02
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.19
    HISPANIC (Real) =       0.04
    NOT_HISPAN (Real) =       6.59
    NHISP_WHIT (Real) =       6.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609011
    HOUSEHOLDS (Real) =     2.55
    HOUSEHOL_A (Real) =     0.15
    POLYGON ((554590.91588362515904
2123241.632391711231321,557183.877244946546853
2123261.476542191114277,557185.866814971901476
2123129.702169452793896,555888.410371425678022
2123163.290501976385713,554584.285233602509834
2123197.051472527906299,554590.91588362515904 2123241.632391711231321))

OGRFeature(mpo2):9
    SHAPECODE (String) = 4609014
    ZONE_AREA (Real) =          6951748
    OID_ (Integer) = 16957
    GEO_IDENTI (String) = 4609014
    TOTPOP (Real) =     155.95
    ONE_RACE (Real) =     152.29
    WHITE (Real) =     150.60
    BLACK (Real) =       0.42
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       1.27
    TWO_PLUS_R (Real) =       3.66
    HISPANIC (Real) =       1.66
    NOT_HISPAN (Real) =     154.29
    NHISP_WHIT (Real) =     150.18
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609014
    HOUSEHOLDS (Real) =    66.53
    HOUSEHOL_A (Real) =     5.12
    POLYGON ((551953.502148762461729
2123221.448043493088335,554590.91588362515904
2123241.632391711231321,554584.285233602509834
2123197.051472527906299,554600.954803448054008
2121870.175678761675954,554617.624373293714598
2120543.29988499591127,553313.499235470429994
2120577.060855546966195,552009.364189005456865
2120610.822082611266524,551980.995648902608082
2121936.581881972495466,551980.965271481196396
2121938.001523731742054,551953.502148762461729 2123221.448043493088335))

Segmentation fault

neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
FAILED: Layer mpo2_poverty already exists, and -append not specified.
          Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.
neil@gandalf:~/gis/kb$ ogr2ogr -overwrite -sql "SELECT * FROM mpo2 LEFT
JOIN 2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
ERROR 6: DeleteLayer() not supported by this data source.
DeleteLayer() failed when overwrite requested.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.

Neil Best wrote:
> Sorry, I just looked at the OGR SQL page again for the first time in a 
> while.  Is the JOIN support new?  Maybe I just conflated the GRASS and 
> OGR SQL features.  This looks like it will do the trick.  As penance I 
> will submit my query as an example.
> 
> Neil
> 
> 
> Neil Best wrote:
>> Can someone point me to a straightforward way to join attributes from 
>> an   additional dbf table using either OGR or GRASS, or even Perl?  
>> It's so easy in Arc that I would think this has been solved in our 
>> world also.  So far my impression is that I would have to script a 
>> row-by-row UPDATE since the SQL drivers don't support any type of JOIN 
>> afaik.  It seems like I have seen an example somewhere using a Perl 
>> DBF module but I can't put my finger on it.  I'll keep digging and 
>> hopefully this wheel has been invented.
>>
>> Neil
>>



From nbest at speakeasy.net  Mon Sep 11 11:28:19 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: joining DBFs
In-Reply-To: <45056D90.2060103@speakeasy.net>
References: <45056939.6090009@speakeasy.net> <45056D90.2060103@speakeasy.net>
Message-ID: <45058093.9020109@speakeasy.net>

Something is going wrong.  I have created indexes on both tables even
though it wasn't clear if that is strictly necessary for the primary
table.  Having an unknown SRS wouldn't cause this, would it?  I should
just look up my EPSG -- that's what I'll do next.  It appears to do
something before seg-faulting -- maybe there is a corrupt polygon?

I see that the key of the secondary table also gets added as a column,
which Arc also does in a join operation.  I find this unnecessary and
annoying.  Is there an argument in favor?  I guess it can be dropped
easily enough, but notice that DBF truncates that qualified column name.

Also, there appears to be a problem with the -overwrite option that I
show at the end of my output that I don't understand, requiring an rm
step.  Is this a limitation of the SHP driver or something I am doing wrong?

I thought better of attaching my data.  Drop me a line if you would like 
to have a look at it.  Thanks for any insight.


neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
Segmentation fault
neil@gandalf:~/gis/kb$ ogrinfo test mpo2_poverty INFO: Open of `test'
using driver `ESRI Shapefile' successful.

Layer name: mpo2_poverty
Geometry: Polygon
Feature Count: 0
Extent: (0.000000, 0.000000) - (0.000000, 0.000000)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_pov: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
neil@gandalf:~/gis/kb$ ls test
mpo2_poverty.dbf  mpo2_poverty.shp  mpo2_poverty.shx
neil@gandalf:~/gis/kb$ ogrinfo -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" ses INFO: Open of `ses'
using driver `ESRI Shapefile' successful.

Layer name: mpo2
Geometry: Polygon
Feature Count: 17466
Extent: (211950.731904, 1576286.159537) - (885960.120408, 2252334.267779)
Layer SRS WKT:
(unknown)
SHAPECODE: String (16.0)
ZONE_AREA: Real (16.0)
OID_: Integer (9.0)
GEO_IDENTI: String (14.0)
TOTPOP: Real (10.2)
ONE_RACE: Real (10.2)
WHITE: Real (10.2)
BLACK: Real (10.2)
AMERINDIAN: Real (10.2)
ASIAN: Real (10.2)
PACIFIC: Real (10.2)
OTHER: Real (10.2)
TWO_PLUS_R: Real (10.2)
HISPANIC: Real (10.2)
NOT_HISPAN: Real (10.2)
NHISP_WHIT: Real (10.2)
2000HH_poverty_UNIVERSAL.GEO_IDENTI: String (14.0)
HOUSEHOLDS: Real (8.2)
HOUSEHOL_A: Real (8.2)
OGRFeature(mpo2):0
    SHAPECODE (String) = 4610051
    ZONE_AREA (Real) =           415737
    OID_ (Integer) = 17100
    GEO_IDENTI (String) = 4610051
    TOTPOP (Real) =      26.73
    ONE_RACE (Real) =      26.73
    WHITE (Real) =      26.34
    BLACK (Real) =       0.10
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.29
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      26.73
    NHISP_WHIT (Real) =      26.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610051
    HOUSEHOLDS (Real) =     8.75
    HOUSEHOL_A (Real) =     0.42
    POLYGON ((565168.49996185512282
2123297.036226258147508,567837.380521122599021
2123311.42119784001261,567836.905601977137849
2123150.250083384104073,567836.875 2123150.25,566502.812442400609143
2123148.437627284321934,565168.658338983776048
2123146.625130200758576,565168.49996185512282 2123297.036226258147508))

OGRFeature(mpo2):1
    SHAPECODE (String) = 4610042
    ZONE_AREA (Real) =           405230
    OID_ (Integer) = 17097
    GEO_IDENTI (String) = 4610042
    TOTPOP (Real) =      12.42
    ONE_RACE (Real) =      12.42
    WHITE (Real) =      12.30
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.11
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =      12.42
    NHISP_WHIT (Real) =      12.30
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610042
    HOUSEHOLDS (Real) =     6.87
    HOUSEHOL_A (Real) =     0.33
    POLYGON ((567837.380521122599021
2123311.42119784001261,570497.874934128252789
2123300.937598436605185,570497.723520182771608
2123157.500268447212875,569167.374749097623862
2123153.875339915510267,567836.905601977137849
2123150.250083384104073,567837.380521122599021 2123311.42119784001261))

OGRFeature(mpo2):2
    SHAPECODE (String) = 4610041
    ZONE_AREA (Real) =           358029
    OID_ (Integer) = 17096
    GEO_IDENTI (String) = 4610041
    TOTPOP (Real) =       0.48
    ONE_RACE (Real) =       0.48
    WHITE (Real) =       0.48
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.48
    NHISP_WHIT (Real) =       0.48
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610041
    HOUSEHOLDS (Real) =     5.00
    HOUSEHOL_A (Real) =     0.24
    POLYGON ((570497.874934128252789
2123300.937598436605185,573158.271560193505138
2123290.454384359996766,573158.381680462392978
2123164.750001248437911,573158.375 2123164.75,571828.062485220958479
2123161.125170259270817,570497.723520182771608
2123157.500268447212875,570497.874934128252789 2123300.937598436605185))

OGRFeature(mpo2):3
    SHAPECODE (String) = 4610052
    ZONE_AREA (Real) =           387044
    OID_ (Integer) = 17101
    GEO_IDENTI (String) = 4610052
    TOTPOP (Real) =      12.21
    ONE_RACE (Real) =      12.21
    WHITE (Real) =      12.06
    BLACK (Real) =       0.14
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.02
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.21
    NOT_HISPAN (Real) =      12.00
    NHISP_WHIT (Real) =      11.84
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610052
    HOUSEHOLDS (Real) =    11.30
    HOUSEHOL_A (Real) =     0.67
    POLYGON ((562499.551199327223003
2123282.650887067895383,565168.49996185512282
2123297.036226258147508,565168.658338983776048
2123146.625130200758576,563834.437308961409144
2123144.812542194500566,562500.262920987908728
2123143.000017553567886,562499.551199327223003 2123282.650887067895383))

OGRFeature(mpo2):4
    SHAPECODE (String) = 4610032
    ZONE_AREA (Real) =           301133
    OID_ (Integer) = 17093
    GEO_IDENTI (String) = 4610032
    TOTPOP (Real) =       0.56
    ONE_RACE (Real) =       0.56
    WHITE (Real) =       0.56
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.56
    NHISP_WHIT (Real) =       0.56
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610032
    HOUSEHOLDS (Real) =     0.47
    HOUSEHOL_A (Real) =     0.04
    POLYGON ((573158.271560193505138
2123290.454384359996766,575833.499946153140627
2123264.680594602134079,575833.422804853646085
2123165.249997253529727,574495.937499998952262
2123165.000005841255188,573158.381680462392978
2123164.750001248437911,573158.271560193505138 2123290.454384359996766))

OGRFeature(mpo2):5
    SHAPECODE (String) = 4610061
    ZONE_AREA (Real) =           373248
    OID_ (Integer) = 17104
    GEO_IDENTI (String) = 4610061
    TOTPOP (Real) =       3.76
    ONE_RACE (Real) =       3.70
    WHITE (Real) =       3.59
    BLACK (Real) =       0.01
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.04
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.06
    HISPANIC (Real) =       0.12
    NOT_HISPAN (Real) =       3.64
    NHISP_WHIT (Real) =       3.53
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610061
    HOUSEHOLDS (Real) =    12.52
    HOUSEHOL_A (Real) =     0.80
    POLYGON ((559860.124304226133972
2123272.137048966716975,562499.551199327223003
2123282.650887067895383,562500.262920987908728
2123143.000017553567886,562500.25 2123143.0,561180.563844703836367
2123135.984603217802942,559860.851143212290481
2123128.969065317418426,559860.124304226133972 2123272.137048966716975))

OGRFeature(mpo2):6
    SHAPECODE (String) = 4610062
    ZONE_AREA (Real) =           387825
    OID_ (Integer) = 17105
    GEO_IDENTI (String) = 4610062
    TOTPOP (Real) =       3.46
    ONE_RACE (Real) =       3.46
    WHITE (Real) =       3.46
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       3.46
    NHISP_WHIT (Real) =       3.46
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610062
    HOUSEHOLDS (Real) =     5.65
    HOUSEHOL_A (Real) =     0.19
    POLYGON ((557183.877244946546853
2123261.476542191114277,559860.124304226133972
2123272.137048966716975,559860.851143212290481
2123128.969065317418426,558541.187734182458371
2123121.953789453487843,557186.092565013910644
2123114.75015982426703,557185.866814971901476
2123129.702169452793896,557183.877244946546853 2123261.476542191114277))

OGRFeature(mpo2):7
    SHAPECODE (String) = 4610031
    ZONE_AREA (Real) =           230844
    OID_ (Integer) = 17092
    GEO_IDENTI (String) = 4610031
    TOTPOP (Real) =       0.07
    ONE_RACE (Real) =       0.07
    WHITE (Real) =       0.07
    BLACK (Real) =       0.00
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.00
    TWO_PLUS_R (Real) =       0.00
    HISPANIC (Real) =       0.00
    NOT_HISPAN (Real) =       0.07
    NHISP_WHIT (Real) =       0.07
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610031
    HOUSEHOLDS (Real) =     0.07
    HOUSEHOL_A (Real) =     0.01
    POLYGON ((575833.499946153140627
2123264.680594602134079,578508.610308142262511
2123238.907941915560514,578508.432067663408816
2123165.749987302813679,577170.9375 2123165.5,575833.422804853646085
2123165.249997253529727,575833.499946153140627 2123264.680594602134079))

OGRFeature(mpo2):8
    SHAPECODE (String) = 4609011
    ZONE_AREA (Real) =           229076
    OID_ (Integer) = 16955
    GEO_IDENTI (String) = 4609011
    TOTPOP (Real) =       6.63
    ONE_RACE (Real) =       6.44
    WHITE (Real) =       6.36
    BLACK (Real) =       0.02
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       0.06
    TWO_PLUS_R (Real) =       0.19
    HISPANIC (Real) =       0.04
    NOT_HISPAN (Real) =       6.59
    NHISP_WHIT (Real) =       6.34
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609011
    HOUSEHOLDS (Real) =     2.55
    HOUSEHOL_A (Real) =     0.15
    POLYGON ((554590.91588362515904
2123241.632391711231321,557183.877244946546853
2123261.476542191114277,557185.866814971901476
2123129.702169452793896,555888.410371425678022
2123163.290501976385713,554584.285233602509834
2123197.051472527906299,554590.91588362515904 2123241.632391711231321))

OGRFeature(mpo2):9
    SHAPECODE (String) = 4609014
    ZONE_AREA (Real) =          6951748
    OID_ (Integer) = 16957
    GEO_IDENTI (String) = 4609014
    TOTPOP (Real) =     155.95
    ONE_RACE (Real) =     152.29
    WHITE (Real) =     150.60
    BLACK (Real) =       0.42
    AMERINDIAN (Real) =       0.00
    ASIAN (Real) =       0.00
    PACIFIC (Real) =       0.00
    OTHER (Real) =       1.27
    TWO_PLUS_R (Real) =       3.66
    HISPANIC (Real) =       1.66
    NOT_HISPAN (Real) =     154.29
    NHISP_WHIT (Real) =     150.18
    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609014
    HOUSEHOLDS (Real) =    66.53
    HOUSEHOL_A (Real) =     5.12
    POLYGON ((551953.502148762461729
2123221.448043493088335,554590.91588362515904
2123241.632391711231321,554584.285233602509834
2123197.051472527906299,554600.954803448054008
2121870.175678761675954,554617.624373293714598
2120543.29988499591127,553313.499235470429994
2120577.060855546966195,552009.364189005456865
2120610.822082611266524,551980.995648902608082
2121936.581881972495466,551980.965271481196396
2121938.001523731742054,551953.502148762461729 2123221.448043493088335))

Segmentation fault

neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
FAILED: Layer mpo2_poverty already exists, and -append not specified.
          Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.
neil@gandalf:~/gis/kb$ ogr2ogr -overwrite -sql "SELECT * FROM mpo2 LEFT
JOIN 2000HH_poverty_UNIVERSAL ON
geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
ERROR 6: DeleteLayer() not supported by this data source.
DeleteLayer() failed when overwrite requested.
ERROR 1: Terminating translation prematurely after failed
translation from sql statement.

Neil Best wrote:
> Sorry, I just looked at the OGR SQL page again for the first time in a 
> while.  Is the JOIN support new?  Maybe I just conflated the GRASS and 
> OGR SQL features.  This looks like it will do the trick.  As penance I 
> will submit my query as an example.
> 
> Neil
> 
> 
> Neil Best wrote:
>> Can someone point me to a straightforward way to join attributes from 
>> an   additional dbf table using either OGR or GRASS, or even Perl?  
>> It's so easy in Arc that I would think this has been solved in our 
>> world also.  So far my impression is that I would have to script a 
>> row-by-row UPDATE since the SQL drivers don't support any type of JOIN 
>> afaik.  It seems like I have seen an example somewhere using a Perl 
>> DBF module but I can't put my finger on it.  I'll keep digging and 
>> hopefully this wheel has been invented.
>>
>> Neil
>>



From nbarker at ittvis.com  Mon Sep 11 13:01:15 2006
From: nbarker at ittvis.com (Norman Barker)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Adobe SVG to be discontinued next year
Message-ID: <B67A5FB7A8114B47A70517C9C0D102E8131B3E@bath.uk.rsinc.com>



-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Ben Crane
Sent: Monday, September 11, 2006 9:19 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Adobe SVG to be discontinued next year

Hi all,

I have just found out that Adobe will be discontinuing
support/distribution of their SVG Viewer. This has
alarmed me to a certain degree and has made me think
about possible contingency plans should (worst case
scenario I know and very unlikely) SVG become a
second-grade product.

Has anyone used the php_ogr libraries with Macromedia
Flash? If so, what was your general impression? I am
seriously considering having a go at developing what
I'm currently working on in Flash (parallel
development) in case I have to move over.

Has anyone had any success with this?

Ben Crane

Ben,

It is interesting that Adobe have discontinued support for the SVG
viewer, however take heart from the vastly improved SVG support in
Firefox, and that Virtual Earth uses inline SVG in firefox -
http://blog.codedread.com/archives/2006/05/25/microsoft-live-local-now-u
ses-svg/

If I were to consider parallel development (and I am not SVG is cool,
and my project life times are short!) I would consider Laszlo
(http://www.openlaszlo.org/) which abstracts the presentation layer.

It is a sad day if Adobe pulls SVG.

Norman


From Chris.Barker at noaa.gov  Mon Sep 11 14:29:05 2006
From: Chris.Barker at noaa.gov (Christopher Barker)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Adobe SVG to be discontinued next year
In-Reply-To: <20060911151928.55127.qmail@web52813.mail.yahoo.com>
References: <20060911151928.55127.qmail@web52813.mail.yahoo.com>
Message-ID: <4505AAF1.3000802@noaa.gov>

Ben Crane wrote:

> I have just found out that Adobe will be discontinuing
> support/distribution of their SVG Viewer. 

  should (worst case
> scenario I know and very unlikely) SVG become a
> second-grade product.

SVG is an open standard, and now supported directly by the latest 
versions of Firefox, Opera, Konqeror, and Safari. IO don't know about 
I.E.  Maybe that's why Adobe as dropped it.

On the other hand, were Macromedia to drop Flash, you'd really be stuck 
-- so I'd not worry about it, that's the reason to stick with open 
standards.

-Chris


-- 
Christopher Barker, Ph.D.
Oceanographer
                                     		
NOAA/OR&R/HAZMAT         (206) 526-6959   voice
7600 Sand Point Way NE   (206) 526-6329   fax
Seattle, WA  98115       (206) 526-6317   main reception

Chris.Barker@noaa.gov

From mhanson at photon.com  Mon Sep 11 15:20:36 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>
	<931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>

Should I get this fix from CVS?    Is last nights snapshot safe to upgrade to ?

________________________________

From: fwarmerdam@gmail.com on behalf of Frank Warmerdam
Sent: Sat 9/9/2006 12:21 AM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Creating VRT datasets



On 9/8/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
>     char *pszXML = "source_0=<SimpleSource>"


Matt,

One point I wasn't very specific about is that embedding
the name of the item becomes important (as above) when
using SetMetadata().

I have now fixed VRTSourcedRasterBand so that
SetMetadataItem() on a single item also works.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




From ricardoluis at ufs.br  Mon Sep 11 16:24:50 2006
From: ricardoluis at ufs.br (Ricardo)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Calling OGRLayer member functions from MFC::OnDraw
Message-ID: <20060911195532.M51291@ufs.br>


Hi,

I'm trying to call OGRLayer member functions from MFC::OnDraw and it was 
returning to me an Access violation reading location.

It was working well for OGRDataSource member functions, with that I can 
count the number of layers and other functions works well, but nothing can 
be done with OGRLayer member functions or atributes.

I'm using Visual Studio .NET 2003, with GDAL 1.3.2 compiled by me. I compile 
it because my data are in a PostGIS data base. My source code was able to 
return some information from  the data source, but nothing can be done with 
the OGRLayer objects.

That is my source:
///////////////////////////////////////////////////////////////////////////

CChildView::CChildView()
{

const char *conexao = "PG:user=postgres password=postgres dbname=testegis 
host=10.0.0.62 port=5432";

OGRRegisterAll();
CPLPushErrorHandler( CPLQuietErrorHandler );

CPLSetConfigOption("GML_FIELDTYPES","ALWAYS_STRING");

   
 char szPath[100] = "";


char *pszDSName = NULL;
pszDSName = CPLStrdup(conexao);
char **papszTokens = NULL;
papszTokens = CSLTokenizeStringComplex( conexao, ",", TRUE, FALSE );
if( CSLCount(papszTokens) > 0 )
      pszDSName = CPLStrdup( papszTokens[0] );
CSLDestroy(papszTokens);
 if( pszDSName == NULL )
  {
      exit( 1 );
  }
#ifdef USE_SHARED_ACCESS
     poDS = OGRSFDriverRegistrar::GetRegistrar()->OpenShared( pszDSName );
#else
      poDS = OGRSFDriverRegistrar::Open( pszDSName );
#endif


poOGRLayer = poDS->GetLayer(13); //until here it works well.


poOGRLayer->ResetReading(); // it causes a  Access violation reading location


}
//////////////////////////////////////////////////////////////////////


Some has a clue?
Thank you all.

Ricardo Lu?s


From jluis at ualg.pt  Mon Sep 11 16:40:09 2006
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Memory leak under Matlab (a follow up from -
	importFromWkt() problem)
In-Reply-To: <7224B63940F10F40A48AC423597ADE570F6FE6C5@MESSAGE-AH.ad.mathworks.com>
References: <7224B63940F10F40A48AC423597ADE570F6FE6C5@MESSAGE-AH.ad.mathworks.com>
Message-ID: <4505C9A9.1050802@ualg.pt>

Philip Borghesani wrote:
> It is not always simple or straight forward to translate from a properly 
> working main to a mex function.  In the example code you supplied I am 
> concerned about some of the initialization code that the tested example you 
> linked to is not doing in a while loop.
>
> Remember that a mex file is not unloaded after each call so you code is 
> doing the equvilent of putting a loop around a main function.
>
> Try placeing the initiization code in a block that will only run once:
>
> // untested code
>
>  static  OGRSFDriver *poDriver = NULL;
>
> if (poDriver==NULL) {
>     OGRRegisterAll();
>
>     // Driver
>     poDriver 
> =OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(pszDriverName);
>     assert(NULL != poDriver);
> }
>
> // I do not see any code that deletes or releases the poDriver is this 
> needed

Hi,
I received the mail above from the Mathworks.
I did what Philip Borghesani suggested without any advance. That is the 
memory leak still leaks.
However, I would like to be 100% sure in the answer to the second question.

Is the poDriver automatically freed?

Thanks

Joaquim Luis


From jdjohnso at google.com  Mon Sep 11 21:39:43 2006
From: jdjohnso at google.com (John Johnson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Converting an exiting OGR loader into an "optional"
	loader?
Message-ID: <d0b0f8b0609111839m340106c7r1b7613d1547f77af@mail.google.com>

The current build method for most loaders links them directly into the GDAL
library. This means that if those loaders need an external library, GDAL
will not load w/o that library being present on the target machine. This
means that if some of my users need a loader for a proprietary format
(e.gOracle Spatial), I either need to build two versions of GDAL (one
with the
OCI driver and one without) or I need to make sure that all of my users have
the OCI client library installed. Neither option is very appealing to me.

So my goal is to build a single version of GDAL configured with several
"optional" loaders. That way if a customer has the necessary proprietary
client libraries they will be able to use the optional loader. But if they
do not have the necessary client libraries, the other loaders will at least
still work.

The current FMEObjects OGR loader already does this by using CPLGetSymbol to
determine if the necessary FMEObjects client library is available. It does
this during the Open so it can simply return FALSE if it can't load the
shared library. It's a little bit heavy of an implementation (each Open call
will try again to load the shared library), but it works.

I figure that other existing  loaders that could benefit from this
"optional" loading functionality could be easily adapted from their current
implementation by linking them into their own shared library (instead of
into the main GDAL library) and by providing the additional RegisterOGRXXX
function. The resulting shared libraries would be installed in one of the
standard directories searched by the OGR Driver Registrar. If they are able
to be successfully loaded at runtime (because the necessary external libs
are present), they will be added to the list of drivers, otherwise they will
be omitted.

My issue now figuring out the best way to convert these existing loaders (
e.g. Oracle Spatial's OCI) to support this "optional" loading of external
libraries w/o breaking the build for everybody that expects them to behave
the old way. I was thinking about a new configure option to specify that you
want the library built as an "optional" module instead of default behavior
of linking it directly into the GDAL library.

I realize that this is signifcant enough of a change that I'd need buyoff
from the "powers that be" before a patch would ever be accepted back into
the mainline build. So I'm asking now. Does this seem like a reasonable
approach?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060911/68ee17ea/attachment.html
From mhanson at photon.com  Mon Sep 11 22:33:12 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] MSVCRT80.dll
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027857C@pj-exchange.photon.com>

I'm not sure how exactly I did things differently, but I got the latest snapshot for the SetMetadataItem fix and compiled using nmake as per the Windows install directions.   I overwrote my gdal13.dll and gdal13.dll.manifest files and I'm getting a error:
 
"This application has failed to start because MSVCR80.dll was not found. Re-installing the application may fix the problem"
 
I'm using nmake.opt as is except for changing the directory.   I also edited cpl_config.h.vc to set the vnsprintf and related functions to 0.
 
Now it's important to note that I did get this error when I first tried to install GDAL but ended up solving it by copying the dll and manifest files to the directory where my exe is located.   But this time it doesn't work.  I even went back to the 1.3.2 release version and am getting the same error.   Also note I have followed all old suggestions on the forums concerning this and they don't work.  This is somehow related to debug information.
 
Has anyone else encountered this?   This problem drove me nuts for hours the first time and I'd rather not repeat it.


From nharding at extendthereach.com  Mon Sep 11 22:48:30 2006
From: nharding at extendthereach.com (Ned Harding)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] MSVCRT80.dll
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027857C@pj-exchange.photon.com>
Message-ID: <3B6819E719271748B923CE3CDBD4EC98B864D0@srcmail1.extendthereach.com>

MS changed the way the dlls install for VS2005.  The easiest way to deal
with it is to just use their install to make sure they are all in the
right places.

http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=
32BC1BEE-A3F9-4C13-9C99-220B62A191EE 

Ned.

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Monday, September 11, 2006 8:33 PM
To: Gdal-dev@lists.maptools.org
Subject: [Gdal-dev] MSVCRT80.dll

I'm not sure how exactly I did things differently, but I got the latest
snapshot for the SetMetadataItem fix and compiled using nmake as per the
Windows install directions.   I overwrote my gdal13.dll and
gdal13.dll.manifest files and I'm getting a error:
 
"This application has failed to start because MSVCR80.dll was not found.
Re-installing the application may fix the problem"
 
I'm using nmake.opt as is except for changing the directory.   I also
edited cpl_config.h.vc to set the vnsprintf and related functions to 0.
 
Now it's important to note that I did get this error when I first tried
to install GDAL but ended up solving it by copying the dll and manifest
files to the directory where my exe is located.   But this time it
doesn't work.  I even went back to the 1.3.2 release version and am
getting the same error.   Also note I have followed all old suggestions
on the forums concerning this and they don't work.  This is somehow
related to debug information.
 
Has anyone else encountered this?   This problem drove me nuts for hours
the first time and I'd rather not repeat it.

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From mhanson at photon.com  Mon Sep 11 22:50:38 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] MSVCRT80.dll
References: <3B6819E719271748B923CE3CDBD4EC98B864D0@srcmail1.extendthereach.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027857D@pj-exchange.photon.com>

I have Visual Studio 2005 Prof, so I'm not sure what this redistributable package would add.
 
I've been using GDAL fine in my app, but then I tried to upgrade to the latest version and this problem cropped up again, trying to go back to the stable version results in the same problem.   ack

________________________________

From: Ned Harding [mailto:nharding@extendthereach.com]
Sent: Mon 9/11/2006 10:48 PM
To: Matt Hanson; Gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] MSVCRT80.dll



MS changed the way the dlls install for VS2005.  The easiest way to deal
with it is to just use their install to make sure they are all in the
right places.

http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=
32BC1BEE-A3F9-4C13-9C99-220B62A191EE

Ned.

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
Sent: Monday, September 11, 2006 8:33 PM
To: Gdal-dev@lists.maptools.org
Subject: [Gdal-dev] MSVCRT80.dll

I'm not sure how exactly I did things differently, but I got the latest
snapshot for the SetMetadataItem fix and compiled using nmake as per the
Windows install directions.   I overwrote my gdal13.dll and
gdal13.dll.manifest files and I'm getting a error:

"This application has failed to start because MSVCR80.dll was not found.
Re-installing the application may fix the problem"

I'm using nmake.opt as is except for changing the directory.   I also
edited cpl_config.h.vc to set the vnsprintf and related functions to 0.

Now it's important to note that I did get this error when I first tried
to install GDAL but ended up solving it by copying the dll and manifest
files to the directory where my exe is located.   But this time it
doesn't work.  I even went back to the 1.3.2 release version and am
getting the same error.   Also note I have followed all old suggestions
on the forums concerning this and they don't work.  This is somehow
related to debug information.

Has anyone else encountered this?   This problem drove me nuts for hours
the first time and I'd rather not repeat it.

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev




From warmerdam at pobox.com  Tue Sep 12 05:03:17 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com>
	<931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com>
	<931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com>
	<931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com>
	<0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>
Message-ID: <931f8ea90609120203t11d1d954j9ef42e81a228b228@mail.gmail.com>

On 9/11/06, Matt Hanson <mhanson@photon.com> wrote:
> Should I get this fix from CVS?    Is last nights snapshot safe to upgrade to ?


Matt,

Yes, to the best of my knowledge the nightly cvs
should be fine.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mhanson at photon.com  Tue Sep 12 09:31:08 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com><931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com><0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>
	<931f8ea90609120203t11d1d954j9ef42e81a228b228@mail.gmail.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278580@pj-exchange.photon.com>

Ok, well I wasn't able to solve the issue with MSVCRT80.dll "missing" in the CVS, though I did manage to get back to the stable version so I could do the work around using Setmetadata instead of Setmetadataitem.
 
And it caused an odd problem.    Before the changes, it would create the file, but just not write the metadata.   But when I change the Setmetadata line to the below, not only does not not create a file, it generates an Access Violation error as soon as it hits
Delete ds;
 
**********************************************************************************
GDALDataset *ds = driver->Create(filename.c_str(), ROI.width(), ROI.height(), 1, GDALType(&typeid(T)), NULL);

stringstream XML;

XML << "source_0=<SimpleSource>"

<< "<SourceFilename relativeToVRT=\"1\">" << Image.Filename() << "</SourceFilename><SourceBand>1</SourceBand>"

<< "<SrcRect xOff=\"" << ROI.x0() << "\" yOff=\"" << ROI.y0() << "\" xSize=\"" << ROI.width()

<< "\" ySize=\"" << ROI.height() << "\"/>"

<< "<DstRect xOff=\"0\" yOff=\"0\" xSize=\"" << ROI.width() << "\" ySize=\"" << ROI.height() << "\"/>"

<< "</SimpleSource>";

char* list[] = { const_cast<char*>(XML.str().c_str()), NULL };

ds->GetRasterBand(1)->SetMetadata(list, "new_vrt_sources");

delete ds;

****************************************************************

 

Also, I noticed that after the   driver->Create    call,    eAccess is GA_ReadOnly - why would a new dataset that needs to be written to be Read Only?

 

 

matt


________________________________

From: fwarmerdam@gmail.com on behalf of Frank Warmerdam
Sent: Tue 9/12/2006 5:03 AM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Creating VRT datasets



On 9/11/06, Matt Hanson <mhanson@photon.com> wrote:
> Should I get this fix from CVS?    Is last nights snapshot safe to upgrade to ?


Matt,

Yes, to the best of my knowledge the nightly cvs
should be fine.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




From woklist at kyngchaos.com  Tue Sep 12 10:36:28 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ECW JPEG 2000 SDK v3.3: final source distribution
	released
In-Reply-To: <c39b2a650609101551w41f853c1p6be325dd8ddf4b8a@mail.gmail.com>
References: <c39b2a650609101551w41f853c1p6be325dd8ddf4b8a@mail.gmail.com>
Message-ID: <8E37C28F-3D26-41E9-AD91-CAA771279E5C@kyngchaos.com>

I was all excited about this.  But...

Are you sure the threading is improved, for Mac OS X at least?  I  
still get a trap error in compression.  And I can't get a working  
decompression either - all I get is invalid or corrupt file errors.   
I've tried this on PPC, OS 10.4.7, GCC 4.0.1 (tried the beta on  
Intel, but my MacBook is in the shop right now so I can't try the  
final 3.3 release on Intel Mac OS X).

I'm starting to wonder if there is something wrong with how I build  
it.  I don't think I'm doing anything wrong, but I've heard that at  
least a working reader is possible.

Any ideas?  Maybe time to sign up on the forum and ask around...

On Sep 10, 2006, at 5:51 PM, Tom Lynch wrote:

> Dear GDAL users and developers,
>
> ER Mapper is pleased to announce that v3.3 of the ECW JPEG 2000 SDK
> now has a source distribution for Linux, Solaris, Windows and Mac OS X
> ready and in public release.
>
> Detailed product information and downloads are available at
>
> http://www.ermapper.com/downloads/download_view.aspx? 
> PRODUCT_VERSION_ID=305
>
> A number of bugs have been fixed for this final v3.3 release, Visual
> Studio 2005 build files have been refreshed, and the stability of the
> non-win32 threading model has been improved significantly.
>
> We hope this latest release will improve the experience of GDAL users
> when processing the ECW and JPEG 2000 formats.  Please direct all
> feedback to devsupport@ermapper.com.au .
>

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

[Trillian]  What are you supposed to do WITH a maniacally depressed  
robot?

[Marvin]  You think you have problems?  What are you supposed to do  
if you ARE a maniacally depressed robot?  No, don't try and answer,  
I'm 50,000 times more intelligent than you and even I don't know the  
answer...

- HitchHiker's Guide to the Galaxy



From mhanson at photon.com  Tue Sep 12 10:42:27 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Creating VRT datasets
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com><931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com><0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>
	<931f8ea90609120203t11d1d954j9ef42e81a228b228@mail.gmail.com>
	<0719BE42F22E0A46857DF72644EC5D70278580@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278581@pj-exchange.photon.com>

I've found the root of my problem, but I still don't know why it's a problem.
 
For the CVS version, I had to turn on the /MD switch in my code (multi-thread debug).   However, as near as I can tell there's no difference between the CVS and release versions in this regard.   They are both compiled using /MD (assuming you compile it in Debug which is the default in the nmake.opt file).    I do not have to do this with the release version (though....technically I *should* have to, the mult-thread switch should match between my code and the gdal13.dll, so I don't see why the release version would have worked, but it did I went back and tested it again).
 
So once I changed that switch the MSVCRT80.dll missing error went away, AND I was able to use the SetMetadataItem function, and the fix worked great.   Thanks Frank!
 
 

________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 9:31 AM
To: Gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] Creating VRT datasets


Ok, well I wasn't able to solve the issue with MSVCRT80.dll "missing" in the CVS, though I did manage to get back to the stable version so I could do the work around using Setmetadata instead of Setmetadataitem.
 
And it caused an odd problem.    Before the changes, it would create the file, but just not write the metadata.   But when I change the Setmetadata line to the below, not only does not not create a file, it generates an Access Violation error as soon as it hits
Delete ds;
 
**********************************************************************************
GDALDataset *ds = driver->Create(filename.c_str(), ROI.width(), ROI.height(), 1, GDALType(&typeid(T)), NULL);

stringstream XML;

XML << "source_0=<SimpleSource>"

<< "<SourceFilename relativeToVRT=\"1\">" << Image.Filename() << "</SourceFilename><SourceBand>1</SourceBand>"

<< "<SrcRect xOff=\"" << ROI.x0() << "\" yOff=\"" << ROI.y0() << "\" xSize=\"" << ROI.width()

<< "\" ySize=\"" << ROI.height() << "\"/>"

<< "<DstRect xOff=\"0\" yOff=\"0\" xSize=\"" << ROI.width() << "\" ySize=\"" << ROI.height() << "\"/>"

<< "</SimpleSource>";

char* list[] = { const_cast<char*>(XML.str().c_str()), NULL };

ds->GetRasterBand(1)->SetMetadata(list, "new_vrt_sources");

delete ds;

****************************************************************

 

Also, I noticed that after the   driver->Create    call,    eAccess is GA_ReadOnly - why would a new dataset that needs to be written to be Read Only?

 

 

matt


________________________________

From: fwarmerdam@gmail.com on behalf of Frank Warmerdam
Sent: Tue 9/12/2006 5:03 AM
To: Matt Hanson
Cc: Gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Creating VRT datasets



On 9/11/06, Matt Hanson <mhanson@photon.com> wrote:
> Should I get this fix from CVS?    Is last nights snapshot safe to upgrade to ?


Matt,

Yes, to the best of my knowledge the nightly cvs
should be fine.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent




From dron at ak4719.spb.edu  Tue Sep 12 12:07:30 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] RFC: additional styles for text labels
Message-ID: <20060912160730.GA27704@ak4719.spb.edu>

Folks,

I want to add several new options for text label styles. I need these
styles in order to be compatible with some complex GIS (more precisely
with the file format used by that GIS). The code is ready to be commited
if there will be no objections against these new options.

The new label parameters are:

w		Stretch.
		The stretch factor changes the width of all characters in the
		font by factor percent. For example, setting factor to 150
		results in all characters in the font being 1.5 times (ie.
		150%) wider. The default stretch factor is 100.

st		Strike out text.

h		Colour of the shadow of label.

m:h		New placement mode.  Every word of text attached to polyline
		is placed horizontally in its segment, anchor point is a
		center of segment.

m:a		New placement mode.  Every word of text attached to polyline
		is stretched to fit the segment of polyline and placed along
		that segment. The anchor point is a start of a segment.

p: {10,11,12}	New anchor positions relative to text bottom
		See the image attached. Note, that positions {1,2,3} are
		relative to baseline, not a bottom of text box.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517
-------------- next part --------------
A non-text attachment was scrubbed...
Name: anchor-style.png
Type: image/png
Size: 7772 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060912/c3be4e7f/anchor-style.png
From collinsb at mitre.org  Tue Sep 12 12:24:25 2006
From: collinsb at mitre.org (Collins, Benjamin)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] PGM file too short
Message-ID: <8D27E2CDAF11D34F97E7445BCCCDB92C01252197@IMCSRV1.MITRE.ORG>

I'm using gdal_merge.py to patch together a very large image, and
passing the -init 0 flag to get the mosaic all initialized to 0.
However, it seems that the size of the file on the file-system does not
match the declared length in the header.  In fact, it's 168459 bytes
too short (a fraction of the length on one line).
Currently I think it has something to do with the last line in the
mosaic being not fully covered by source pixels.  It seems that the PNM
driver is therefore not completing that last line in the file.  These
missing pixels at the end of the file are causing errors in some other
utilities, namely the sample Kakadu programs!

Any thoughts, or is this a bug?
--
Ben


From sy at perkins.net  Tue Sep 12 12:27:15 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] MSVCRT80.dll
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027857D@pj-exchange.photon.com>
References: <3B6819E719271748B923CE3CDBD4EC98B864D0@srcmail1.extendthereach.com>
	<0719BE42F22E0A46857DF72644EC5D7027857D@pj-exchange.photon.com>
Message-ID: <4506DFE3.6010003@perkins.net>

With the stricter checking for DLL compatibility in Visual Studio, I've 
found that it now matters a lot more whether things were compiled with 
the debug or non debug version of the runtime library, i.e. /MD vs /MDd. 
So you'd better make sure you're using the smae runtime libraries for 
everything, including your application, GDAL, and any of the DLLs that 
GDAL depends upon if you built those separately. i.e. you might find you 
have to build two different versions of GDAL, one for debug and one for 
release. In earlier versions you seemed to be able to get away with this 
more.

At least, this is the conclusion I came to a while back ad it seems to 
be working, but to be honest, I don't fully understand all the  manifest 
/ DLL issues in VS 2005 ad it seems poorly explained in the docs.

Cheers,

Sy


Matt Hanson wrote:
> I have Visual Studio 2005 Prof, so I'm not sure what this redistributable package would add.
>  
> I've been using GDAL fine in my app, but then I tried to upgrade to the latest version and this problem cropped up again, trying to go back to the stable version results in the same problem.   ack
>
> ________________________________
>
> From: Ned Harding [mailto:nharding@extendthereach.com]
> Sent: Mon 9/11/2006 10:48 PM
> To: Matt Hanson; Gdal-dev@lists.maptools.org
> Subject: RE: [Gdal-dev] MSVCRT80.dll
>
>
>
> MS changed the way the dlls install for VS2005.  The easiest way to deal
> with it is to just use their install to make sure they are all in the
> right places.
>
> http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=
> 32BC1BEE-A3F9-4C13-9C99-220B62A191EE
>
> Ned.
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.maptools.org
> [mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Matt Hanson
> Sent: Monday, September 11, 2006 8:33 PM
> To: Gdal-dev@lists.maptools.org
> Subject: [Gdal-dev] MSVCRT80.dll
>
> I'm not sure how exactly I did things differently, but I got the latest
> snapshot for the SetMetadataItem fix and compiled using nmake as per the
> Windows install directions.   I overwrote my gdal13.dll and
> gdal13.dll.manifest files and I'm getting a error:
>
> "This application has failed to start because MSVCR80.dll was not found.
> Re-installing the application may fix the problem"
>
> I'm using nmake.opt as is except for changing the directory.   I also
> edited cpl_config.h.vc to set the vnsprintf and related functions to 0.
>
> Now it's important to note that I did get this error when I first tried
> to install GDAL but ended up solving it by copying the dll and manifest
> files to the directory where my exe is located.   But this time it
> doesn't work.  I even went back to the 1.3.2 release version and am
> getting the same error.   Also note I have followed all old suggestions
> on the forums concerning this and they don't work.  This is somehow
> related to debug information.
>
> Has anyone else encountered this?   This problem drove me nuts for hours
> the first time and I'd rather not repeat it.
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>   


From sy at perkins.net  Tue Sep 12 13:17:20 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL and VS 2005  (Was: Creating VRT datasets)
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D70278582@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com><931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com><0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>	<931f8ea90609120203t11d1d954j9ef42e81a228b228@mail.gmail.com>	<0719BE42F22E0A46857DF72644EC5D70278580@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D70278581@pj-exchange.photon.com>
	<4506E15F.7090800@perkins.net>
	<0719BE42F22E0A46857DF72644EC5D70278582@pj-exchange.photon.com>
Message-ID: <4506EBA0.5060409@perkins.net>

Matt Hanson wrote:
> Sy, you are right about debug mode being /MDd, I was messed up I thought /MD was debug.   Regardless, it did fix things.  Compiling my proj in Debug mode (/MDd switch) generated the error.   When I switched to /MD it worked.    The thing I'm confused about is why it worked for the release version of GDAL.
>   

The release version of GDAL? If you're talking about the two lines of 
compiler options in nmake.opt that you can choose between, they both 
specify /MD. The only difference is that the "debug" line turns off 
optimization and generates a debug symbol file (a .pdb file).

So, are you saying that with GDAL compiled with the /MD switch, and 
optimization on, your application, compiled in debug mode within the 
IDE, worked fine? So many combinations to consider...


On a related note, I wonder whether some of our problems are cause by 
nmake. With every new version of visual studio, I can't help but feel 
that it's a  bti of a dinosaur. For instance, consider the problems with 
manifests. Maybe we should be looking at creating a visual studio 
project file or two for building gdal? Has anyone done this?

If GDAL was built using a proper .vcproj file, then other applications 
built using VS could "reference" that project in an easy way.

One slightly annoying thing I've encountered in the past when converting 
makefile projects into Visual Studio is that VS divides a complete 
"Solution" (i.e. the GDAL package) up into individual "Projects" (i.e. 
the final executables, DLLs etc), and then appears to insist that each 
the .vcproj file associated with each project lives in it its own 
directory. In contrast the GDAL directory organization builds several 
libraries and executables from the same directory, .e.g gdal/apps. In a 
port that I'm woking on now, I've ended up moving all the source code 
related to different executables into their own sub-directories. I 
wouldn't want to emabrk on such a major change in GDAL.

Now, note that the vcproj files do not have to be in the same directory 
as the source code files, so one solution is to create a separate 
hierarchy of  .vcproj files, with one executable / DLL to each 
directory, that then refers across to the GDAL source files. This 
preserves the existnig structure of the source code, but has the 
unfortunate side effect of separating source code from the associated 
.vcproj files.

Anybody had experience with this task or have any other thoughts?




From mhanson at photon.com  Tue Sep 12 14:10:47 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL and VS 2005  (Was: Creating VRT datasets)
References: <0719BE42F22E0A46857DF72644EC5D70278578@pj-exchange.photon.com><931f8ea90609082000m439f6ae6v4e9b9aeea9650ebf@mail.gmail.com><931f8ea90609082001y170f4529kac9927828ce2405c@mail.gmail.com><931f8ea90609082121y4bd90cc2n2fa757159aed5afb@mail.gmail.com><0719BE42F22E0A46857DF72644EC5D7027857B@pj-exchange.photon.com>	<931f8ea90609120203t11d1d954j9ef42e81a228b228@mail.gmail.com>	<0719BE42F22E0A46857DF72644EC5D70278580@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D70278581@pj-exchange.photon.com>
	<4506E15F.7090800@perkins.net>
	<0719BE42F22E0A46857DF72644EC5D70278582@pj-exchange.photon.com>
	<4506EBA0.5060409@perkins.net>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278584@pj-exchange.photon.com>

Ah, I guess you are right - GDAL always uses /MD.   I had to switch my project from /MDd to /MD as well when compiling it in Debug mode.
 
I have not compiled a release version of GDAL, but will have to at some point.
 
The whole manifest issue is certainly annoying, and confusing.   The whole idea of having to have a separate manifest file for DLL's seems like not just one step back, but 20 steps back.  Well actually you don't *have* to have a separate manifest file but I don't know how to change GDAL's nmake.opt to embed the manifest in the DLL.
 
A VS Solution file would be a great help - I think the way to handle that to minimize impact on GDAL is just to have a separate VS folder where ALL of the solution and vcproj files can reside, referencing back to the dir structure of GDAL.    
 
Is there some way to specify a file from the VS compiler options so we could just reference nmake.opt from within the VS Solution ?
 
 

________________________________

From: Simon Perkins [mailto:sy@perkins.net]
Sent: Tue 9/12/2006 1:17 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] GDAL and VS 2005 (Was: Creating VRT datasets)



Matt Hanson wrote:
> Sy, you are right about debug mode being /MDd, I was messed up I thought /MD was debug.   Regardless, it did fix things.  Compiling my proj in Debug mode (/MDd switch) generated the error.   When I switched to /MD it worked.    The thing I'm confused about is why it worked for the release version of GDAL.
>  

The release version of GDAL? If you're talking about the two lines of
compiler options in nmake.opt that you can choose between, they both
specify /MD. The only difference is that the "debug" line turns off
optimization and generates a debug symbol file (a .pdb file).

So, are you saying that with GDAL compiled with the /MD switch, and
optimization on, your application, compiled in debug mode within the
IDE, worked fine? So many combinations to consider...


On a related note, I wonder whether some of our problems are cause by
nmake. With every new version of visual studio, I can't help but feel
that it's a  bti of a dinosaur. For instance, consider the problems with
manifests. Maybe we should be looking at creating a visual studio
project file or two for building gdal? Has anyone done this?

If GDAL was built using a proper .vcproj file, then other applications
built using VS could "reference" that project in an easy way.

One slightly annoying thing I've encountered in the past when converting
makefile projects into Visual Studio is that VS divides a complete
"Solution" (i.e. the GDAL package) up into individual "Projects" (i.e.
the final executables, DLLs etc), and then appears to insist that each
the .vcproj file associated with each project lives in it its own
directory. In contrast the GDAL directory organization builds several
libraries and executables from the same directory, .e.g gdal/apps. In a
port that I'm woking on now, I've ended up moving all the source code
related to different executables into their own sub-directories. I
wouldn't want to emabrk on such a major change in GDAL.

Now, note that the vcproj files do not have to be in the same directory
as the source code files, so one solution is to create a separate
hierarchy of  .vcproj files, with one executable / DLL to each
directory, that then refers across to the GDAL source files. This
preserves the existnig structure of the source code, but has the
unfortunate side effect of separating source code from the associated
.vcproj files.

Anybody had experience with this task or have any other thoughts?







From mhanson at photon.com  Tue Sep 12 14:16:37 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] relativeToVRT attribute
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278585@pj-exchange.photon.com>

I'm having problems with the relativeToVRT atrtribute for GDAL's virtual file format.   I'm creating a dataset programmatically and using SetMetadataItem to write a <SimpleSource> XML line to the source_0 meta data item.
 
But it doesn't seem to work.   I've set relativeToVRT to 1, and written a filename with no path.   The Filename is valid and resides in the same directory as the VRT I'm writing....but note that this is different then the the Current working directory.    Could there be an issue here when WRITING a VRT file using the relativeToVRT attribute?   It looks like there might be a bug when it validates that name when writing it, though it works when reading a VRT file.
 
 
-matt


From mhanson at photon.com  Tue Sep 12 15:21:56 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] VRT File Format
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>

Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
ERROR 1: Corrupt of empty VRT source XML document.
 
Here's my VRT file:
 
*********************************************************************************************
<VRTDataset rasterXSize="400" rasterYSize="400">

<VRTRasterBand dataType="Int16" band="1">

<SimpleSource>

<SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>

<SourceBand>1</SourceBand>

<SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>

<DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>

</SimpleSource>

</VRTRasterBand>

</VRTDataset>

********************************************************************



From fcollier at preparedresponse.com  Tue Sep 12 15:25:41 2006
From: fcollier at preparedresponse.com (Frances Collier)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr creating shapefile
Message-ID: <001e01c6d6a1$3cb12980$0d5aa8c0@devfrances>

Hello all,

I initially posted this on the postgis mailing list but was informed that it
was better suited for this list. So, below is the problem I've been having.
I'll greatly appreciate any help I can get. Thank you -Frances

I have been trying to figure out how to create a shapefile using 
ogr2ogr. I haven't been able to find much on it through google and the 
user pages so I thought one of you might be able to help.

Here's my statement:

ogr2ogr -f "ESRI Shapefile" test "PG:dbname=mydb host=localhost 
user=postgres password=postgres" -sql "Select pop from getPop()"

When I click enter I get an Application Error that states the memory 
could not be "read". I'm sure it's in my syntax, but I can't figure it 
out. I would like to know if there are other ways to accomplish this as
well.

Thank you,
Frances Collier




From mhanson at photon.com  Tue Sep 12 16:09:51 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>

I've tracked down this error to vrtsourcedrasterband.cpp, line 286, where is processed the sources from the VRT set.
I can't really figure out what's happening. It loks like the it's supposed to step through the XML elements of the tree, but on the first one (which is an XML Attribute, dataType) it generates an error because VRTDriver::ParseSource checks to see if it's an element which it's not, it's an attribute.   So it triggers the CPLError in vrtdriver.cpp, line 134.
 
My VRT looks correct to me, but I must be doing something wrong because if this really is an error it wouldn't work on any VRT dataset.
 
 
*************************************************
if( poBand != NULL 

&& poBand->XMLInit( psChild, pszVRTPath ) == CE_None )

{

SetBand( ++nBands, poBand );

}

else

{

if( poBand )

delete poBand; 

return CE_Failure;

}

***************************************

poBand is evaluating to Null, bu

 


________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 3:21 PM
To: gdal-dev@lists.maptools.org
Subject: VRT File Format


Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
ERROR 1: Corrupt of empty VRT source XML document.
 
Here's my VRT file:
 
*********************************************************************************************
<VRTDataset rasterXSize="400" rasterYSize="400">

<VRTRasterBand dataType="Int16" band="1">

<SimpleSource>

<SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>

<SourceBand>1</SourceBand>

<SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>

<DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>

</SimpleSource>

</VRTRasterBand>

</VRTDataset>

********************************************************************



From matt.wilkie at gov.yk.ca  Tue Sep 12 18:45:22 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] oziexplorer .map reader?
Message-ID: <45073882.5090601@gov.yk.ca>

Dear GDAL Developers,

I'm seeking a gdal format driver to read Oziexplorer .MAP format or 
Fugawi .JPR format for georeferencing an image. If this doesn't exist 
already, what would it cost (and how long might it take) to write one?

thanks.

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From wolfgang.qual at gmx.net  Wed Sep 13 04:46:53 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Problem using OGR and join-functionality: column names
	gone when creating a new shapefile?
Message-ID: <200609131046.53725.wolfgang.qual@gmx.net>

Hi list,
yesterday, I found a very interesting page on the internet - manpage of OGR 
SQL [1]. Wow, I thought - I can perfom JOINs on the command line. Using 
the join-command as described in this manual combinded to the ogrinfo-command 
clearly showed, that a join was performed.
*But could I make this permanent?* 
Within the next step, I used ogr2ogr with the same sql-expression. A new 
shapefile was created, the desired column of the second theme was appended to 
the table (ogr2ogr -f "ESRI Shapefile" testfile.shp ./ -sql "select ...."

However, I realised, that all the column names were gone, or to be more 
precise, lost their names in favour of a new one. All column names of the 
first shapefile "Flurstck_test.shp" were (re)-named to "flurstck_t" and the 
new column of the second theme "flurstck_nr.shp" is named "flurstck_n" now.
Also, the column definitions were all converted to "Real" except the column 
that was appended (joined) to the table. This column is of type "String".

Is this a common (known problem)? I would be most grateful for some comments, 
as I really would like to use this feature of ogr! Thanks in advance!

I am using gdal 1.3.2-2 on a Debian machine.

Best regards,
Wolfgang

[1] www.remotesensing.org/gdal/ogr/ogr_sql.html

From beyhan at deprem.gov.tr  Wed Sep 13 07:13:13 2006
From: beyhan at deprem.gov.tr (Murat BEYHAN)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] installation problem gdal-1.3.2
In-Reply-To: <200609131046.53725.wolfgang.qual@gmx.net>
References: <200609131046.53725.wolfgang.qual@gmx.net>
Message-ID: <20060913105005.M36544@deprem.gov.tr>

Hi friends,

I would like to use OGR/Mapserver/Mysql functionality to create a map by using
data stored in Mysql.

For this Actually I couldn't understood more about Ogr but 
I would like to install gdal-1.3.2 bur I always facing following error message.
I really have spent a lot of time to solve this problem but I couldn't achieved.

Please if anybody has idea about the mistake which I did,
tell me.

Just I'm asking you.
Is it possible to read data for example point data for the location of city
from MySQL database tables to draw it on the map without creation shp files or
 OGR can create shape files for drawing the map.
Thank you...
 result of my installation stages are here.

configure --with-mysql --with-netcdf
.
.
.
GDAL is now configured for i686-pc-linux-gnu

  Installation directory:    /usr/local
  C compiler:                gcc -O2
  C++ compiler:              g++ -O2

  LIBTOOL support:           yes

  LIBZ support:              external
  GRASS support:             libgrass
  CFITSIO support:           no
  PCRaster support:          internal
  NETCDF support:            yes
  LIBPNG support:            external
  LIBTIFF support:           external
  LIBGEOTIFF support:        internal
  LIBJPEG support:           external
  LIBGIF support:            internal
  OGDI support:              yes
  HDF4 support:              no
  HDF5 support:              no
  KAKADU support:            no
  JASPER support:            no
  ECW support:               no
  MrSID support:             no
  POSTGRESQL support:        no
  MySQL support:             yes
  XERCES support:            no
  ODBC support:              no
  OCI support:               no
  SDE support:               no
  DODS support:              no
  SQLite support:            no
  DWGdirect support          no
  PANORAMA GIS support:      no
  GEOS support:              yes

  Statically link PROJ.4:    no

  Traditional Python:        no
  NG SWIG Bindings:

  enable OGR building:       yes
make 
after run make the last two lines are here
.
.
.             
creating gdal_rasterize
make[1]: Leaving directory `/usr/local/gdal-1.3.2/apps'


make install
after run make install the last four lines are here

.
.
.
make[1]: Leaving directory `/usr/local/gdal-1.3.2/man'
for f in data/*.* ; do /usr/local/gdal-1.3.2/install-sh -c -m 0644 $f
/usr/local/share/gdal ; done
/bin/sh /usr/local/gdal-1.3.2/libtool --mode=finish --silent /usr/local/lib
ldconfig: /usr/local/lib/libpdf.so.5 is not a symbolic link

after this
I would like to try ogrinfo ond ogr2ogr commands
But I have faced the following error
[root@sakura gdal-1.3.2]# ogrinfo
ogrinfo: error while loading shared libraries: libgdal.so.1: cannot open
shared object file: No such file or directory

what is wrong which I did...
Thank you


-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From sy at perkins.net  Wed Sep 13 13:06:00 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
Message-ID: <1158167160.3081.270844271@webmail.messagingengine.com>

Hi,

Matt Hanson and I had a thread going in which the subject of Visual
Studio Project files came up. I didn't get any comments on that and
figured the details might have been lost in the noise, so here's a
second attempt to elicit some feedback...

THE ISSUE

On windows / visual studio, we currently build GDAL using nmake.
However, particularly with the arrival of Visual Studio 2005, this
solution is starting to look a little antiquated. In particular, the
introduction of manifests and tighter coupling to DLL versions has made
it a little harder to build GDAL and have it work smoothly with other
Visual Studio projects. Problems with not having the manifests embedded,
and clashes between debug and non-debug libraries seem to have greatly
increased under VS 2005.

PROPOSED SOLUTION

Create VS 2005 project files, in parallel to the existing nmake files,
that allow GDAL to be built within the VS IDE. This should simplify
development of GDAL itself under windows by providing easy access to the
VS debugger, editor and so forth, plus it makes it easy for us to create
modern compliant GDAL DLLs and executables with embedded manifests. In
addition, applications that use GDAL that are built using visual studio
can link to GDAL simply by referencing the GDAL project files, which
should clean up a lot of problems with DLL versions etc. Finally, the VS
debugger will be able to smoothly step from the application into the
GDAL source code, simplifying debugging under VS.

PROPOSED IMPLEMENTATION

The Visual Studio IDE requires that each individual DLL, executable etc,
be treated as a separate "Project" within a larger "Solution". The
.vcproj files defining individual projects have to live in their own
sub-directories - you cannot have more than one .vcproj file in the same
directory (or at least, I haven't found an easy way of doing this). The
source code does not have to be in the same directory as the .vcproj
files.  The acutal executables, libraries, etc are built in Debug and
Release sub-directories of the .vcproj directories. Note that other VS
applications that depend on GDAL do not have to know about this level of
detail - they simply reference the .vcproj file.

Given this structure it would be awkward to fit the VS project files in
the same directories as the existing source code and makefiles. Instead,
it would probably make more sense to create a separate hierarchy of VS
project files that cross references to the GDAL source code. So, we
would create a top level directory with gdal, called something like
gdal/visual_studio, and then create separate project subdirectories
under that for each executable and DLL that we want to build. Those
project files would then refer across to source code in other GDAL
directories. We would set things up so that relative paths were used.

One issue is how to handle configuration related activites. Currently,
GDAL is configured for Visual Studio through manual editing of the
nmake.opt file. This both determines what optional components get built,
and where the external libraries and header files that GDAL needs can be
found. VS supports a degree of user configurability, but we would have
to look carefully at how this could be made to work with project files
In particular, we need to try to separate congifuration files that are
going to be different for every user, and the common build files that
users will want to update from CVS.



So, what d'yall think? Is it necessary? Would it be useful? Any ideas
about this could be implemented most effectively? Anyone done any work
on this already that they want to share? I would be happy to take a
first stab at this. Should this be written up as an official RFC? How do
I do that?

Cheers,

Sy

From craig.miller at spatialminds.com  Wed Sep 13 14:14:58 2006
From: craig.miller at spatialminds.com (Craig Miller)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158167160.3081.270844271@webmail.messagingengine.com>
Message-ID: <006701c6d760$85fa3f40$3301a8c0@vaio>

I'm in favor of them being officially supported.  There is already an
unofficial set available that works quite nicely (under VS2003 anyway).

--Craig 

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Simon Perkins
Sent: Wednesday, September 13, 2006 10:06 AM
To: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Visual Studio Project Files

Hi,

Matt Hanson and I had a thread going in which the subject of Visual Studio
Project files came up. I didn't get any comments on that and figured the
details might have been lost in the noise, so here's a second attempt to
elicit some feedback...

THE ISSUE

On windows / visual studio, we currently build GDAL using nmake.
However, particularly with the arrival of Visual Studio 2005, this solution
is starting to look a little antiquated. In particular, the introduction of
manifests and tighter coupling to DLL versions has made it a little harder
to build GDAL and have it work smoothly with other Visual Studio projects.
Problems with not having the manifests embedded, and clashes between debug
and non-debug libraries seem to have greatly increased under VS 2005.

PROPOSED SOLUTION

Create VS 2005 project files, in parallel to the existing nmake files, that
allow GDAL to be built within the VS IDE. This should simplify development
of GDAL itself under windows by providing easy access to the VS debugger,
editor and so forth, plus it makes it easy for us to create modern compliant
GDAL DLLs and executables with embedded manifests. In addition, applications
that use GDAL that are built using visual studio can link to GDAL simply by
referencing the GDAL project files, which should clean up a lot of problems
with DLL versions etc. Finally, the VS debugger will be able to smoothly
step from the application into the GDAL source code, simplifying debugging
under VS.

PROPOSED IMPLEMENTATION

The Visual Studio IDE requires that each individual DLL, executable etc, be
treated as a separate "Project" within a larger "Solution". The .vcproj
files defining individual projects have to live in their own sub-directories
- you cannot have more than one .vcproj file in the same directory (or at
least, I haven't found an easy way of doing this). The source code does not
have to be in the same directory as the .vcproj files.  The acutal
executables, libraries, etc are built in Debug and Release sub-directories
of the .vcproj directories. Note that other VS applications that depend on
GDAL do not have to know about this level of detail - they simply reference
the .vcproj file.

Given this structure it would be awkward to fit the VS project files in the
same directories as the existing source code and makefiles. Instead, it
would probably make more sense to create a separate hierarchy of VS project
files that cross references to the GDAL source code. So, we would create a
top level directory with gdal, called something like gdal/visual_studio, and
then create separate project subdirectories under that for each executable
and DLL that we want to build. Those project files would then refer across
to source code in other GDAL directories. We would set things up so that
relative paths were used.

One issue is how to handle configuration related activites. Currently, GDAL
is configured for Visual Studio through manual editing of the nmake.opt
file. This both determines what optional components get built, and where the
external libraries and header files that GDAL needs can be found. VS
supports a degree of user configurability, but we would have to look
carefully at how this could be made to work with project files In
particular, we need to try to separate congifuration files that are going to
be different for every user, and the common build files that users will want
to update from CVS.



So, what d'yall think? Is it necessary? Would it be useful? Any ideas about
this could be implemented most effectively? Anyone done any work on this
already that they want to share? I would be happy to take a first stab at
this. Should this be written up as an official RFC? How do I do that?

Cheers,

Sy
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From roger at beardandsandals.co.uk  Wed Sep 13 14:18:36 2006
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158167160.3081.270844271@webmail.messagingengine.com>
Message-ID: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>



> So, what d'yall think? Is it necessary? Would it be useful? Any ideas
> about this could be implemented most effectively? Anyone done any work
> on this already that they want to share? I would be happy to take a
> first stab at this. Should this be written up as an official RFC? How do
> I do that?
> 

Sy,

Both Ben Discoe and I have done work on this. This has been mentioned on
this list occasionally in the past.

Ben's files are available for download the "Virtual Terrain Project" site.
http://vterrain.org/dist/gdal132_vc71.zip

I have some slightly updated versions of these files that you are welcome to
have if you want them.

I am not sure how many people are using VS 2005 yet. But VC7.1 (2003) is
probably a good starting format.

Good luck.

Roger



From sy at perkins.net  Wed Sep 13 16:35:17 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
References: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <1158179717.714.270863590@webmail.messagingengine.com>


On Wed, 13 Sep 2006 19:18:36 +0100, "Roger James"

> Both Ben Discoe and I have done work on this. This has been mentioned on
> this list occasionally in the past.
> 
> Ben's files are available for download the "Virtual Terrain Project"
> site.
> http://vterrain.org/dist/gdal132_vc71.zip
> 
> I have some slightly updated versions of these files that you are welcome
> to
> have if you want them.
> 
> I am not sure how many people are using VS 2005 yet. But VC7.1 (2003) is
> probably a good starting format.

I have to say that I'm personally really only interested in the VS 2005
project files. I'm also using C# 2.0, which requires VS 2005, so that's
my platform of choice. VS 2005 also seems to be the point at which nmake
starts to break down due to manifest issues and so forth. Unfortunately
the 2003 and 2005 project files are not directly compatible, though VS
2005 can import 2003 projects into 2005 format. Brian and Roger's work
on 2003 will undoubtedly make an excellent starting point however.

One idea is to have both 2003 and 2005 project files within the GDAL
source tree, e.g. in gdal/visual_studio/2003 and
gdal/visual_studio/2005. An objection might be that this might pose
issues with keeping both sets of build files up to date, but if there
are going to be project files for both 2003 and 2005 floating around
anyway for different users, why not have them in the official source
tree? The two sets of files are different but don't take up a lot of
space. For people who don't use Visual Studio, the only apparent change
will be the appearance of a top level visual_studio directory with some
XML files in it. The rest of the GDAL source tree would be unaffected.

But whatever we do, I'd like Frank or one of his deputies to chime in
before I do anything like adding a new top level directory to GDAL. On
that note, are we still using the CVS repository at maptools.org? I
noticed an RFC about switching over to Subversion.

I'll do some more background research on config issues etc.

Cheers,

Sy

From sy at perkins.net  Wed Sep 13 16:43:26 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
References: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <1158180206.1492.270865181@webmail.messagingengine.com>


On Wed, 13 Sep 2006 19:18:36 +0100, "Roger James"

> I am not sure how many people are using VS 2005 yet. But VC7.1 (2003) is
> probably a good starting format.

Hey, it's only almost 2007... :)

Incidentally, just in case any windows developers out there aren't aware
of this, Microsoft have decided to make the express editions of Visual
Studio 2005 free on a permanent basis (originally it was just going to
be for a year but they changed their minds). The express editions seem
to have virtually everything in them that the solo developer needs,
including the same optimizing compilers that are available in all the
other versions. The IDE is actually pretty cool once you get into it.

Cheers,

Sy

From sy at perkins.net  Wed Sep 13 17:20:36 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D45501DB4C94@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D45501DB4C94@Iris.ad.clarku.edu>
Message-ID: <1158182436.5352.270865651@webmail.messagingengine.com>


On Wed, 13 Sep 2006 16:46:18 -0400, "Ivan Lucena" <ILucena@clarku.edu>
said:
> Once you have a project in VC 2003 (VC7.1), just by loading on VC 2005
> will  automatically update it.

Indeed. But if I then make any changes to those project files in 2005, I
can't commit the changes to CVS in a way that 2003 people can use.

Cheers,

Sy

From Martin.Spott at mgras.net  Thu Sep 14 04:55:06 2006
From: Martin.Spott at mgras.net (Martin Spott)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr creating shapefile
References: <001e01c6d6a1$3cb12980$0d5aa8c0@devfrances>
Message-ID: <eeb5da$11sg$1@osprey.mgras.de>

"Frances Collier" wrote:
> Hello all,

> I initially posted this on the postgis mailing list but was informed that it
> was better suited for this list. So, below is the problem I've been having.
> I'll greatly appreciate any help I can get. Thank you -Frances

> I have been trying to figure out how to create a shapefile using 
> ogr2ogr.

I can confirm getting a segmentation fault unter Linux/ia32 with
'ogr2ogr' from gdal-1.3.2:

foxtrot: 10:42:53 ~> /opt/GRASS/bin/ogr2ogr -f "ESRI Shapefile" \
  ./mangrove.shp PG:'host=localhost user=martin dbname=landcover' \
  -sql "SELECT wkb_geometry from mangrove"
Segmentation fault

Running a binary compiled for x86_64 on the same machine reveals a
different error message:

ERROR 2: CPLRealloc(): Out of memory allocating 85052352 bytes. Abort


Doesn't "pgsql2shp" do the job for you ? This is what I use
for this job.

Cheers,
	Martin.
-- 
 Unix _IS_ user friendly - it's just selective about who its friends are !
--------------------------------------------------------------------------

From dron at ak4719.spb.edu  Thu Sep 14 05:47:39 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158167160.3081.270844271@webmail.messagingengine.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
Message-ID: <20060914094739.GA3884@ak4719.spb.edu>

On Wed, Sep 13, 2006 at 11:06:00AM -0600, Simon Perkins wrote:
> PROPOSED IMPLEMENTATION
> 
> The Visual Studio IDE requires that each individual DLL, executable etc,
> be treated as a separate "Project" within a larger "Solution". The
> .vcproj files defining individual projects have to live in their own
> sub-directories - you cannot have more than one .vcproj file in the same
> directory (or at least, I haven't found an easy way of doing this). The
> source code does not have to be in the same directory as the .vcproj
> files.  The acutal executables, libraries, etc are built in Debug and
> Release sub-directories of the .vcproj directories. Note that other VS
> applications that depend on GDAL do not have to know about this level of
> detail - they simply reference the .vcproj file.

Simon,

That all looks pretty complicated to maintain. Is there a way to include
in project files the list of file paths and include parameters like it
is done in the current makefiles? Otherwise it gets too complicated even to 
add a single new file to the project. If we will found a way to keep the
file lists and configuration parameters separate from the project files
there will be no problem to add them to GDAL. Without such separation
there should be the one who will regularly update project files.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From bthoen at gisnet.com  Thu Sep 14 10:53:25 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Problem exporting to MapInfo TAB with ogr2ogr from
	postgreSQL
Message-ID: <45096CE5.4000807@gisnet.com>

I just installed gdal 1.3.2 (compiled from source using the default 
settings) so I could use ogr2ogr to convert data in PostgreSQL to 
MapInfo, but I'm getting some weird results. First, I tried:
ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial1" -sql "select * 
from napp2"

I expected trouble with this because there are two geometries for each 
record; a point and a polygon. But I got a file where  all records 
mapped to the same point location and all fields were rendered as 
char(254). So if you have multiple geometries, how do you specify the 
one you want?

Next I tried a table with only one geometry. I typed:
ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial2" -sql "select id, 
gridcode from adams_v1 where gridcode=72 limit 50"

This time I got 50 records with the id and gridcode set to the right 
types, but no polygons. I tried specifying the geometry:
ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial2" -sql "select 
the_geom, id, gridcode from adams_v1 where gridcode=72 limit 50"

but the result was the same. So I looked for documentation and found 
only some *.dox files. So my question is, how do I read the 
documentation, and why doesn't the MapInfo conversion work?

 Thanks,
- Bill Thoen

From ollerery at engr.orst.edu  Thu Sep 14 15:06:07 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Enabling Xerces support
Message-ID: <4509A81F.7050105@engr.orst.edu>

I have seen a few threads on this but they all seem to say that version 
1.7 is needed but i can no longer find this version of the Xerces site, 
only 2.7 is available.  I am using the following configure command

 > ./configure --with-xerces

but when i do this i get the following error:

...
...
checking for Xerces C++... requested, but compile or link fails!

g++ -I/usr/local/include -I/usr/local/include/xercesc -o conftest 
conftest.cpp -L/usr/local/lib -lxerces-c -lpthread -ljpeg -ltiff -lpng 
-lpq -L/usr/lib -lpq -lz
-lm -lrt -ldl

/usr/bin/ld: cannot find -lxerces-c


I have complied xerces-c-src_2_7_0 from the source in the directory 
/root/xerces-c-src_2_7_0/

From ollerery at engr.orst.edu  Thu Sep 14 15:33:02 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Enabling Xerces support
In-Reply-To: <4509A81F.7050105@engr.orst.edu>
References: <4509A81F.7050105@engr.orst.edu>
Message-ID: <4509AE6E.1030200@engr.orst.edu>

Ryan Ollerenshaw wrote:
> I have seen a few threads on this but they all seem to say that 
> version 1.7 is needed but i can no longer find this version of the 
> Xerces site, only 2.7 is available.  I am using the following 
> configure command
>
> > ./configure --with-xerces
>
> but when i do this i get the following error:
>
> ...
> ...
> checking for Xerces C++... requested, but compile or link fails!
>
> g++ -I/usr/local/include -I/usr/local/include/xercesc -o conftest 
> conftest.cpp -L/usr/local/lib -lxerces-c -lpthread -ljpeg -ltiff -lpng 
> -lpq -L/usr/lib -lpq -lz
> -lm -lrt -ldl
>
> /usr/bin/ld: cannot find -lxerces-c
>
>
> I have complied xerces-c-src_2_7_0 from the source in the directory 
> /root/xerces-c-src_2_7_0/
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


Sorry for the post looks like i was just not following direction.  The 
install of Xerces-C works just fine with gdal when you follow the 
directions the the Xerces site:

http://xml.apache.org/xerces-c/build-winunix.html#UNIX

built gdal with:
./configure --with-xerces=/path/to/xerces-c-src_2_7_0/



From mhanson at photon.com  Thu Sep 14 17:07:41 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>

In looking at this more, I don't see how the current VRT driver can read any virtual file correctly.   Is anyone else able to read VRT files in 1.3.2?
 
The problem is that vrtsourcedrasterband is not expecting the <VRTRasterBand> XML element to have any XML attributes (i.e. <VRTRasterBand dataType="float32"> associated with it.   It expects the first child to be an Element also.    
 
I would submit a bug report, but since this bug means broken VRT files I wanted to check to see if anyone else was using VRT's with success.   And if you are reading them with 1.3.2 then can you post the VRT file you're using ?    Thanks!
 
matt

________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 4:09 PM
To: gdal-dev@lists.maptools.org
Subject: RE: VRT File Format


I've tracked down this error to vrtsourcedrasterband.cpp, line 286, where is processed the sources from the VRT set.
I can't really figure out what's happening. It loks like the it's supposed to step through the XML elements of the tree, but on the first one (which is an XML Attribute, dataType) it generates an error because VRTDriver::ParseSource checks to see if it's an element which it's not, it's an attribute.   So it triggers the CPLError in vrtdriver.cpp, line 134.
 
My VRT looks correct to me, but I must be doing something wrong because if this really is an error it wouldn't work on any VRT dataset.
 
 
*************************************************
if( poBand != NULL 

&& poBand->XMLInit( psChild, pszVRTPath ) == CE_None )

{

SetBand( ++nBands, poBand );

}

else

{

if( poBand )

delete poBand; 

return CE_Failure;

}

***************************************

poBand is evaluating to Null, bu

 


________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 3:21 PM
To: gdal-dev@lists.maptools.org
Subject: VRT File Format


Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
ERROR 1: Corrupt of empty VRT source XML document.
 
Here's my VRT file:
 
*********************************************************************************************
<VRTDataset rasterXSize="400" rasterYSize="400">

<VRTRasterBand dataType="Int16" band="1">

<SimpleSource>

<SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>

<SourceBand>1</SourceBand>

<SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>

<DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>

</SimpleSource>

</VRTRasterBand>

</VRTDataset>

********************************************************************



From ollerery at engr.orst.edu  Thu Sep 14 17:20:51 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr: Command not found.
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
Message-ID: <4509C7B3.30701@engr.orst.edu>

So i had to recompile gdal from the source in order to add support for 
Xerces-C but after i did this i was still getting the same error so i 
removed ogr2ogr from the /usr/local/bin/ directory and then recompiled 
gdal again but now the ogr2ogr command is not being put back into the 
/usr/local/bin/ directory.  what do i need to do in order to get the 
gdal command back in there.

Thank you,
-Ryan

From jingmuyang at aol.com  Thu Sep 14 18:35:01 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Reading Erdas Imagine Files Through GDAL 1.3.2
In-Reply-To: <450082C3.9000207@pobox.com>
References: <6194856.post@talk.nabble.com> <450082C3.9000207@pobox.com>
Message-ID: <4509D915.2040008@aol.com>

warmerdam@pobox.com wrote:
> Jingmu Yang wrote:
>> I experience the performance downgrade after linking my application 
>> into GDAL
>> 1.3.2 to read (open) large (200MB) Erdas Imagine files.  It paused about
>> 20-30 seconds in calling GDALOpen.  But when I used the early GDAL 
>> release
>> (1.2.6) reading such files were very fast.  What happens with the latest
>> release of GDAL?
>
> Jingma,
>
> There have been a variety of improvements to the HFA driver in the 
> last year
> or two.  I suspect you are suffering from a lot of time being spent 
> turning
> a color table into a GDAL "Raster Attribute Table".  I recall having to
> do some serious work to improve the performance of this, though I'm not
> clear on whether that was before or after the GDAL 1.3.2 release. I'd
> suggest trying your gdalinfo, and the gdalinfo from a recent FWTools and
> see if the fwtools gdalinfo is nice and fast.  Alternatively, try 
> building
> from GDAL CVS source for comparison.
>
> If the problem persists with recent source then please file a bug and 
> make
> your file available somewhere for me to try with.
>
> Best regards,

I downloaded GDAL from CVS and rebuilt the library.  It is obviously 
that the performance problem for Erdas Imagine files has been solved.  
With the newly added class GDALRasterAttributeTable I can only use GDAL 
to retrieve the class names.

Thanks, Frank!

Regards,

Jingmu


From crane_ba at yahoo.com  Fri Sep 15 06:40:30 2006
From: crane_ba at yahoo.com (Ben Crane)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] OOP Question regarding OGR_L_GetExtents
Message-ID: <20060915104030.70653.qmail@web52811.mail.yahoo.com>

Hi all,

Back to this query. I have no really OOP experience
with any programming language so this is all a bit of
a steep learning curve in many ways. I know this isn't
an OOP area, but since many of you will be familiar to
OOP and the PHP_OGR classes, it seemed the best place.

I cannot access the information in provided by
OGR_L_GetExtents using the normal array access method
because (I believe) it is a class and therefore the
rules are different.

Now. I've hunted around on the web and can't get a
straight answer from anywhere so here it is. All I can
find is how to create classes and hown to call/pass
data to them...but nothing on how to access existing
data stored in a class and assign that data to
standard php variables.

To access the 2 coordinate pairs held within the
OGREnvelope() class using OOP techniques? I believe
since the OGREnvelope class is in ogr_core.h that I
need to get hold of this information after
OGR_L_GetExtents has been successfully used.

Thanx,
Ben

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 

From tutey at o2.pl  Fri Sep 15 10:04:09 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL driver for Magellan topo format
In-Reply-To: <200607291324.55305.henrik@johome.net>
References: <200607291324.55305.henrik@johome.net>
Message-ID: <450AB2D9.6080602@o2.pl>

Henrik,

Where has the diff gone?

http://rigel.johome.net/blx/blx_gdaldriver.diff seems down.

Maciek

From vjetly at i3.com  Fri Sep 15 11:11:02 2006
From: vjetly at i3.com (Vikalpa Jetly)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Define/overwrite projection on shapefile
Message-ID: <000001c6d8d9$283b5e00$1b28c80a@i3.local>

How would I use ogr to set/overwrite a projection for an existing shapefile?
I have a wkt projection say 'dref' that I want to use to set the projection.
I understand that while creating a new shapefile I can use:

 

sref = osr.SpatialReference()

sref.ImportFromWkt(dref)

layer = datasource.CreateLayer('newshape', geom_type=ogr.wkbPolygon, srs =
dref)

 

How would I do this for an existing shapefile? or do I need to create a copy
of the shapefile?

 

Thanks.

Vikalpa

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060915/168ca6b7/attachment.html
From bthoen at gisnet.com  Fri Sep 15 11:45:25 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: Problem exporting to MapInfo TAB with ogr2ogr from
	postgreSQL
In-Reply-To: <45096CE5.4000807@gisnet.com>
References: <45096CE5.4000807@gisnet.com>
Message-ID: <20060915154525.GA28141@www.gisnet.com>

I didn't get a single response to this yesterday, so I'll ask it again. If
I'm not asking the right question or not explaining smoething, will
somebody please let me know, or point me to the right FM so I can RTFM? 

 
On Thu, Sep 14, 2006 at 08:53:25AM -0600, Bill Thoen wrote:
> I just installed gdal 1.3.2 (compiled from source using the default 
> settings) so I could use ogr2ogr to convert data in PostgreSQL to 
> MapInfo, but I'm getting some weird results. First, I tried:
> ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial1" -sql "select * 
> from napp2"
> 
> I expected trouble with this because there are two geometries for each 
> record; a point and a polygon. But I got a file where  all records 
> mapped to the same point location and all fields were rendered as 
> char(254). So if you have multiple geometries, how do you specify the 
> one you want?
> 
> Next I tried a table with only one geometry. I typed:
> ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial2" -sql "select id, 
> gridcode from adams_v1 where gridcode=72 limit 50"
> 
> This time I got 50 records with the id and gridcode set to the right 
> types, but no polygons. I tried specifying the geometry:
> ogr2ogr -f "MapInfo File" test.tab "PG:dbname=spatial2" -sql "select 
> the_geom, id, gridcode from adams_v1 where gridcode=72 limit 50"
> 
> but the result was the same. So I looked for documentation and found 
> only some *.dox files. So my question is, how do I read the 
> documentation, and why doesn't the MapInfo conversion work?
> 
> Thanks,
> - Bill Thoen
> 

From nbest at speakeasy.net  Fri Sep 15 12:25:35 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: joining DBFs
In-Reply-To: <45058093.9020109@speakeasy.net>
References: <45056939.6090009@speakeasy.net> <45056D90.2060103@speakeasy.net>
	<45058093.9020109@speakeasy.net>
Message-ID: <450AD3FF.6050300@speakeasy.net>

Am I barking up the wrong tree?  Is ogr2ogr supposed to be able to take 
a .shp and a .dbf of a different name and join them one-to-one by a 
given key?  Examples such as 
http://article.gmane.org/gmane.comp.gis.mapserver.user/8278 suggest so. 
  I have been following the examples on the OGR SQL page, but the fact 
that there are no ogr2ogr examples there worries me that the utility 
does not support this.  Aside from the seg faults, ogr2ogr keeps 
complaining that it is unable to open name_of_dbf.shp or 
name_of_dbf.SHP.  It's not a shapefile!

The latest iteration of my command:

neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN 
'ses/2000HH_poverty_UNIVERSAL.dbf'.2000HH_poverty_UNIVERSAL pov ON 
mpo2.geo_identi=pov.geo_identi" -nln mpo2_poverty -s_srs EPSG:26771 ses ses
ERROR 4: Unable to open ses/TAZ_SocioEcon_IN_r1.shp or 
ses/TAZ_SocioEcon_IN_r1.SHP.
ERROR 4: Unable to open ses/2000HH_poverty_UNIVERSAL.shp or 
ses/2000HH_poverty_UNIVERSAL.SHP.
ERROR 4: Unable to open ses/TAZ_SocioEcon_IN_r1.shp or 
ses/TAZ_SocioEcon_IN_r1.SHP.
ERROR 4: Unable to open ses/2000HH_poverty_UNIVERSAL.shp or 
ses/2000HH_poverty_UNIVERSAL.SHP.
ERROR 4: Unable to open ses/2000HH_poverty_UNIVERSAL.shp or 
ses/2000HH_poverty_UNIVERSAL.SHP.
Segmentation fault

I tried cp'ing my dbf to pov.dbf in case the filename was causing 
problems, so the alias became the literal -- same result.

I tried what I thought would be a trivial join by renaming the .dbf from 
a shapefile and joining them back together by FID.  Is this a valid test?

Originally I was using gdal 1.3.2 compiled from source on my Ubuntu 
Dapper system, then I dropped back to the 1.2.6 package from the repos 
-- same behavior, seg faults.

I have seen other mention of seg faults or other problems when working 
with .DBFs and .SHPs in my web searches.  Whether my troubles are 
realted to others', I can't be sure.

http://article.gmane.org/gmane.comp.gis.gdal.devel/8595
http://article.gmane.org/gmane.comp.gis.gdal.devel/8603
http://article.gmane.org/gmane.comp.gis.grass.user/11735
http://bugzilla.remotesensing.org/show_bug.cgi?id=641

Anyone still reading?  Please let me know if at least I am asking a 
valid question and composing appropriate articles.  Thanks.


Neil Best wrote:
> Something is going wrong.  I have created indexes on both tables even
> though it wasn't clear if that is strictly necessary for the primary
> table.  Having an unknown SRS wouldn't cause this, would it?  I should
> just look up my EPSG -- that's what I'll do next.  It appears to do
> something before seg-faulting -- maybe there is a corrupt polygon?
> 
> I see that the key of the secondary table also gets added as a column,
> which Arc also does in a join operation.  I find this unnecessary and
> annoying.  Is there an argument in favor?  I guess it can be dropped
> easily enough, but notice that DBF truncates that qualified column name.
> 
> Also, there appears to be a problem with the -overwrite option that I
> show at the end of my output that I don't understand, requiring an rm
> step.  Is this a limitation of the SHP driver or something I am doing 
> wrong?
> 
> I thought better of attaching my data.  Drop me a line if you would like 
> to have a look at it.  Thanks for any insight.
> 
> 
> neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
> 2000HH_poverty_UNIVERSAL ON
> geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
> Segmentation fault
> neil@gandalf:~/gis/kb$ ogrinfo test mpo2_poverty INFO: Open of `test'
> using driver `ESRI Shapefile' successful.
> 
> Layer name: mpo2_poverty
> Geometry: Polygon
> Feature Count: 0
> Extent: (0.000000, 0.000000) - (0.000000, 0.000000)
> Layer SRS WKT:
> (unknown)
> SHAPECODE: String (16.0)
> ZONE_AREA: Real (16.0)
> OID_: Integer (9.0)
> GEO_IDENTI: String (14.0)
> TOTPOP: Real (10.2)
> ONE_RACE: Real (10.2)
> WHITE: Real (10.2)
> BLACK: Real (10.2)
> AMERINDIAN: Real (10.2)
> ASIAN: Real (10.2)
> PACIFIC: Real (10.2)
> OTHER: Real (10.2)
> TWO_PLUS_R: Real (10.2)
> HISPANIC: Real (10.2)
> NOT_HISPAN: Real (10.2)
> NHISP_WHIT: Real (10.2)
> 2000HH_pov: String (14.0)
> HOUSEHOLDS: Real (8.2)
> HOUSEHOL_A: Real (8.2)
> neil@gandalf:~/gis/kb$ ls test
> mpo2_poverty.dbf  mpo2_poverty.shp  mpo2_poverty.shx
> neil@gandalf:~/gis/kb$ ogrinfo -sql "SELECT * FROM mpo2 LEFT JOIN
> 2000HH_poverty_UNIVERSAL ON
> geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" ses INFO: Open of `ses'
> using driver `ESRI Shapefile' successful.
> 
> Layer name: mpo2
> Geometry: Polygon
> Feature Count: 17466
> Extent: (211950.731904, 1576286.159537) - (885960.120408, 2252334.267779)
> Layer SRS WKT:
> (unknown)
> SHAPECODE: String (16.0)
> ZONE_AREA: Real (16.0)
> OID_: Integer (9.0)
> GEO_IDENTI: String (14.0)
> TOTPOP: Real (10.2)
> ONE_RACE: Real (10.2)
> WHITE: Real (10.2)
> BLACK: Real (10.2)
> AMERINDIAN: Real (10.2)
> ASIAN: Real (10.2)
> PACIFIC: Real (10.2)
> OTHER: Real (10.2)
> TWO_PLUS_R: Real (10.2)
> HISPANIC: Real (10.2)
> NOT_HISPAN: Real (10.2)
> NHISP_WHIT: Real (10.2)
> 2000HH_poverty_UNIVERSAL.GEO_IDENTI: String (14.0)
> HOUSEHOLDS: Real (8.2)
> HOUSEHOL_A: Real (8.2)
> OGRFeature(mpo2):0
>    SHAPECODE (String) = 4610051
>    ZONE_AREA (Real) =           415737
>    OID_ (Integer) = 17100
>    GEO_IDENTI (String) = 4610051
>    TOTPOP (Real) =      26.73
>    ONE_RACE (Real) =      26.73
>    WHITE (Real) =      26.34
>    BLACK (Real) =       0.10
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.29
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =      26.73
>    NHISP_WHIT (Real) =      26.34
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610051
>    HOUSEHOLDS (Real) =     8.75
>    HOUSEHOL_A (Real) =     0.42
>    POLYGON ((565168.49996185512282
> 2123297.036226258147508,567837.380521122599021
> 2123311.42119784001261,567836.905601977137849
> 2123150.250083384104073,567836.875 2123150.25,566502.812442400609143
> 2123148.437627284321934,565168.658338983776048
> 2123146.625130200758576,565168.49996185512282 2123297.036226258147508))
> 
> OGRFeature(mpo2):1
>    SHAPECODE (String) = 4610042
>    ZONE_AREA (Real) =           405230
>    OID_ (Integer) = 17097
>    GEO_IDENTI (String) = 4610042
>    TOTPOP (Real) =      12.42
>    ONE_RACE (Real) =      12.42
>    WHITE (Real) =      12.30
>    BLACK (Real) =       0.00
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.11
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =      12.42
>    NHISP_WHIT (Real) =      12.30
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610042
>    HOUSEHOLDS (Real) =     6.87
>    HOUSEHOL_A (Real) =     0.33
>    POLYGON ((567837.380521122599021
> 2123311.42119784001261,570497.874934128252789
> 2123300.937598436605185,570497.723520182771608
> 2123157.500268447212875,569167.374749097623862
> 2123153.875339915510267,567836.905601977137849
> 2123150.250083384104073,567837.380521122599021 2123311.42119784001261))
> 
> OGRFeature(mpo2):2
>    SHAPECODE (String) = 4610041
>    ZONE_AREA (Real) =           358029
>    OID_ (Integer) = 17096
>    GEO_IDENTI (String) = 4610041
>    TOTPOP (Real) =       0.48
>    ONE_RACE (Real) =       0.48
>    WHITE (Real) =       0.48
>    BLACK (Real) =       0.00
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =       0.48
>    NHISP_WHIT (Real) =       0.48
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610041
>    HOUSEHOLDS (Real) =     5.00
>    HOUSEHOL_A (Real) =     0.24
>    POLYGON ((570497.874934128252789
> 2123300.937598436605185,573158.271560193505138
> 2123290.454384359996766,573158.381680462392978
> 2123164.750001248437911,573158.375 2123164.75,571828.062485220958479
> 2123161.125170259270817,570497.723520182771608
> 2123157.500268447212875,570497.874934128252789 2123300.937598436605185))
> 
> OGRFeature(mpo2):3
>    SHAPECODE (String) = 4610052
>    ZONE_AREA (Real) =           387044
>    OID_ (Integer) = 17101
>    GEO_IDENTI (String) = 4610052
>    TOTPOP (Real) =      12.21
>    ONE_RACE (Real) =      12.21
>    WHITE (Real) =      12.06
>    BLACK (Real) =       0.14
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.02
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.21
>    NOT_HISPAN (Real) =      12.00
>    NHISP_WHIT (Real) =      11.84
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610052
>    HOUSEHOLDS (Real) =    11.30
>    HOUSEHOL_A (Real) =     0.67
>    POLYGON ((562499.551199327223003
> 2123282.650887067895383,565168.49996185512282
> 2123297.036226258147508,565168.658338983776048
> 2123146.625130200758576,563834.437308961409144
> 2123144.812542194500566,562500.262920987908728
> 2123143.000017553567886,562499.551199327223003 2123282.650887067895383))
> 
> OGRFeature(mpo2):4
>    SHAPECODE (String) = 4610032
>    ZONE_AREA (Real) =           301133
>    OID_ (Integer) = 17093
>    GEO_IDENTI (String) = 4610032
>    TOTPOP (Real) =       0.56
>    ONE_RACE (Real) =       0.56
>    WHITE (Real) =       0.56
>    BLACK (Real) =       0.00
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =       0.56
>    NHISP_WHIT (Real) =       0.56
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610032
>    HOUSEHOLDS (Real) =     0.47
>    HOUSEHOL_A (Real) =     0.04
>    POLYGON ((573158.271560193505138
> 2123290.454384359996766,575833.499946153140627
> 2123264.680594602134079,575833.422804853646085
> 2123165.249997253529727,574495.937499998952262
> 2123165.000005841255188,573158.381680462392978
> 2123164.750001248437911,573158.271560193505138 2123290.454384359996766))
> 
> OGRFeature(mpo2):5
>    SHAPECODE (String) = 4610061
>    ZONE_AREA (Real) =           373248
>    OID_ (Integer) = 17104
>    GEO_IDENTI (String) = 4610061
>    TOTPOP (Real) =       3.76
>    ONE_RACE (Real) =       3.70
>    WHITE (Real) =       3.59
>    BLACK (Real) =       0.01
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.04
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.06
>    TWO_PLUS_R (Real) =       0.06
>    HISPANIC (Real) =       0.12
>    NOT_HISPAN (Real) =       3.64
>    NHISP_WHIT (Real) =       3.53
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610061
>    HOUSEHOLDS (Real) =    12.52
>    HOUSEHOL_A (Real) =     0.80
>    POLYGON ((559860.124304226133972
> 2123272.137048966716975,562499.551199327223003
> 2123282.650887067895383,562500.262920987908728
> 2123143.000017553567886,562500.25 2123143.0,561180.563844703836367
> 2123135.984603217802942,559860.851143212290481
> 2123128.969065317418426,559860.124304226133972 2123272.137048966716975))
> 
> OGRFeature(mpo2):6
>    SHAPECODE (String) = 4610062
>    ZONE_AREA (Real) =           387825
>    OID_ (Integer) = 17105
>    GEO_IDENTI (String) = 4610062
>    TOTPOP (Real) =       3.46
>    ONE_RACE (Real) =       3.46
>    WHITE (Real) =       3.46
>    BLACK (Real) =       0.00
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =       3.46
>    NHISP_WHIT (Real) =       3.46
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610062
>    HOUSEHOLDS (Real) =     5.65
>    HOUSEHOL_A (Real) =     0.19
>    POLYGON ((557183.877244946546853
> 2123261.476542191114277,559860.124304226133972
> 2123272.137048966716975,559860.851143212290481
> 2123128.969065317418426,558541.187734182458371
> 2123121.953789453487843,557186.092565013910644
> 2123114.75015982426703,557185.866814971901476
> 2123129.702169452793896,557183.877244946546853 2123261.476542191114277))
> 
> OGRFeature(mpo2):7
>    SHAPECODE (String) = 4610031
>    ZONE_AREA (Real) =           230844
>    OID_ (Integer) = 17092
>    GEO_IDENTI (String) = 4610031
>    TOTPOP (Real) =       0.07
>    ONE_RACE (Real) =       0.07
>    WHITE (Real) =       0.07
>    BLACK (Real) =       0.00
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.00
>    TWO_PLUS_R (Real) =       0.00
>    HISPANIC (Real) =       0.00
>    NOT_HISPAN (Real) =       0.07
>    NHISP_WHIT (Real) =       0.07
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4610031
>    HOUSEHOLDS (Real) =     0.07
>    HOUSEHOL_A (Real) =     0.01
>    POLYGON ((575833.499946153140627
> 2123264.680594602134079,578508.610308142262511
> 2123238.907941915560514,578508.432067663408816
> 2123165.749987302813679,577170.9375 2123165.5,575833.422804853646085
> 2123165.249997253529727,575833.499946153140627 2123264.680594602134079))
> 
> OGRFeature(mpo2):8
>    SHAPECODE (String) = 4609011
>    ZONE_AREA (Real) =           229076
>    OID_ (Integer) = 16955
>    GEO_IDENTI (String) = 4609011
>    TOTPOP (Real) =       6.63
>    ONE_RACE (Real) =       6.44
>    WHITE (Real) =       6.36
>    BLACK (Real) =       0.02
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       0.06
>    TWO_PLUS_R (Real) =       0.19
>    HISPANIC (Real) =       0.04
>    NOT_HISPAN (Real) =       6.59
>    NHISP_WHIT (Real) =       6.34
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609011
>    HOUSEHOLDS (Real) =     2.55
>    HOUSEHOL_A (Real) =     0.15
>    POLYGON ((554590.91588362515904
> 2123241.632391711231321,557183.877244946546853
> 2123261.476542191114277,557185.866814971901476
> 2123129.702169452793896,555888.410371425678022
> 2123163.290501976385713,554584.285233602509834
> 2123197.051472527906299,554590.91588362515904 2123241.632391711231321))
> 
> OGRFeature(mpo2):9
>    SHAPECODE (String) = 4609014
>    ZONE_AREA (Real) =          6951748
>    OID_ (Integer) = 16957
>    GEO_IDENTI (String) = 4609014
>    TOTPOP (Real) =     155.95
>    ONE_RACE (Real) =     152.29
>    WHITE (Real) =     150.60
>    BLACK (Real) =       0.42
>    AMERINDIAN (Real) =       0.00
>    ASIAN (Real) =       0.00
>    PACIFIC (Real) =       0.00
>    OTHER (Real) =       1.27
>    TWO_PLUS_R (Real) =       3.66
>    HISPANIC (Real) =       1.66
>    NOT_HISPAN (Real) =     154.29
>    NHISP_WHIT (Real) =     150.18
>    2000HH_poverty_UNIVERSAL.GEO_IDENTI (String) = 4609014
>    HOUSEHOLDS (Real) =    66.53
>    HOUSEHOL_A (Real) =     5.12
>    POLYGON ((551953.502148762461729
> 2123221.448043493088335,554590.91588362515904
> 2123241.632391711231321,554584.285233602509834
> 2123197.051472527906299,554600.954803448054008
> 2121870.175678761675954,554617.624373293714598
> 2120543.29988499591127,553313.499235470429994
> 2120577.060855546966195,552009.364189005456865
> 2120610.822082611266524,551980.995648902608082
> 2121936.581881972495466,551980.965271481196396
> 2121938.001523731742054,551953.502148762461729 2123221.448043493088335))
> 
> Segmentation fault
> 
> neil@gandalf:~/gis/kb$ ogr2ogr -sql "SELECT * FROM mpo2 LEFT JOIN
> 2000HH_poverty_UNIVERSAL ON
> geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
> FAILED: Layer mpo2_poverty already exists, and -append not specified.
>          Consider using -append, or -overwrite.
> ERROR 1: Terminating translation prematurely after failed
> translation from sql statement.
> neil@gandalf:~/gis/kb$ ogr2ogr -overwrite -sql "SELECT * FROM mpo2 LEFT
> JOIN 2000HH_poverty_UNIVERSAL ON
> geo_identi=2000HH_poverty_UNIVERSAL.geo_identi" -nln mpo2_poverty test ses
> ERROR 6: DeleteLayer() not supported by this data source.
> DeleteLayer() failed when overwrite requested.
> ERROR 1: Terminating translation prematurely after failed
> translation from sql statement.
> 
> Neil Best wrote:
>> Sorry, I just looked at the OGR SQL page again for the first time in a 
>> while.  Is the JOIN support new?  Maybe I just conflated the GRASS and 
>> OGR SQL features.  This looks like it will do the trick.  As penance I 
>> will submit my query as an example.
>>
>> Neil
>>
>>
>> Neil Best wrote:
>>> Can someone point me to a straightforward way to join attributes from 
>>> an   additional dbf table using either OGR or GRASS, or even Perl?  
>>> It's so easy in Arc that I would think this has been solved in our 
>>> world also.  So far my impression is that I would have to script a 
>>> row-by-row UPDATE since the SQL drivers don't support any type of 
>>> JOIN afaik.  It seems like I have seen an example somewhere using a 
>>> Perl DBF module but I can't put my finger on it.  I'll keep digging 
>>> and hopefully this wheel has been invented.
>>>
>>> Neil
>>>


From ollerery at engr.orst.edu  Fri Sep 15 19:00:16 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] gdal Install
Message-ID: <450B3080.1040707@engr.orst.edu>

I am having some problems installing GDAL on Fedora Core 5.  The commands ./configure make and make install all seem to run just fine but after the install when i try to run any of the commands i get:

-bash: gdaltindex: command not found

I do however get some errors when i run make and ideas on what i am doing wrong?

geotiff.cpp:2963: error: 'TIFFTAG_GEOPIXELSCALE' was not declared in this scope
geotiff.cpp:2970: error: 'TIFFTAG_GEOTIEPOINTS' was not declared in this scope
geotiff.cpp:2982: error: 'TIFFTAG_GEOTRANSMATRIX' was not declared in this scopegeotiff.cpp:3027: error: 'TIFFTAG_GEOTIEPOINTS' was not declared in this scope
geotiff.cpp:3051: error: 'GTIF' was not declared in this scope
geotiff.cpp:3051: error: 'hGTIF' was not declared in this scope
geotiff.cpp:3052: error: 'GTIFDefn' was not declared in this scope
geotiff.cpp:3052: error: expected `;' before 'sGTIFDefn'
geotiff.cpp:3057: error: 'GTIFNew' was not declared in this scope
geotiff.cpp:3066: error: 'sGTIFDefn' was not declared in this scope
geotiff.cpp:3066: error: 'GTIFGetDefn' was not declared in this scope
geotiff.cpp:3068: error: 'GTIFGetOGISDefn' cannot be used as a function
geotiff.cpp:3075: error: 'GTRasterTypeGeoKey' was not declared in this scope
geotiff.cpp:3076: error: 'GTIFKeyGet' was not declared in this scope
geotiff.cpp:3078: error: 'RasterPixelIsPoint' was not declared in this scope
geotiff.cpp:3084: error: 'GTIFFree' was not declared in this scope
geotiff.cpp: In function 'GDALDataset* GTiffCreateCopy(const char*, GDALDataset*, int, char**, int (*)(double, const char*, void*), void*)':
geotiff.cpp:3955: error: 'TIFFTAG_GEOPIXELSCALE' was not declared in this scope
geotiff.cpp:3964: error: 'TIFFTAG_GEOTIEPOINTS' was not declared in this scope
geotiff.cpp:3980: error: 'TIFFTAG_GEOTRANSMATRIX' was not declared in this scopegeotiff.cpp:4017: error: 'TIFFTAG_GEOTIEPOINTS' was not declared in this scope
geotiff.cpp:4032: error: 'GTIF' was not declared in this scope
geotiff.cpp:4032: error: 'psGTIF' was not declared in this scope
geotiff.cpp:4034: error: 'GTIFNew' was not declared in this scope
geotiff.cpp:4035: error: 'GTIFSetFromOGISDefn' cannot be used as a function
geotiff.cpp:4041: error: 'GTRasterTypeGeoKey' was not declared in this scope
geotiff.cpp:4041: error: 'TYPE_SHORT' was not declared in this scope
geotiff.cpp:4042: error: 'RasterPixelIsPoint' was not declared in this scope
geotiff.cpp:4042: error: 'GTIFKeySet' was not declared in this scope
geotiff.cpp:4045: error: 'GTIFWriteKeys' was not declared in this scope
geotiff.cpp:4046: error: 'GTIFFree' was not declared in this scope
geotiff.cpp:4309: error: 'XTIFFClose' was not declared in this scope
make[2]: *** [../o/geotiff.o] Error 1
make[2]: Leaving directory `/usr/share/gdal-1.3.2/frmts/gtiff'
make[1]: *** [gtiff-install-obj] Error 2
make[1]: Leaving directory `/usr/share/gdal-1.3.2/frmts'
make: *** [frmts-target] Error 2



From ollerery at engr.orst.edu  Fri Sep 15 20:49:55 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] gdal Install
In-Reply-To: <450B3080.1040707@engr.orst.edu>
References: <450B3080.1040707@engr.orst.edu>
Message-ID: <450B4A33.4080504@engr.orst.edu>

I think that i took care of my previous problem by installing the ogdi 
rmp but now i am getting the following errors during make.  Do these 
errors mean that i need to install grass? isnt grass its own GIS 
application why would i need to install it if i only need gdal to use 
with MapServer?

I am using this configure command:
./configure --with-png=internal --with-libtiff=internal 
--with-jpeg=internal  --with-gif=internal 
--with-pg=/usr/local/pgsql/bin/pg_config --with-geos 
--with-xerces=/root/xerces-c-src_2_7_0/

Here are the errors that are displayed:
grassdataset.cpp:84:22: error: libgrass.h: No such file or directory
grassdataset.cpp: In constructor 
'GRASSRasterBand::GRASSRasterBand(GRASSDataset*, int, const char*, const 
char*)':
grassdataset.cpp:182: error: aggregate 'Cell_head sCellInfo' has 
incomplete type and cannot be defined
grassdataset.cpp:187: error: 'G_get_cellhd' was not declared in this scope
grassdataset.cpp:188: error: 'G_raster_map_type' was not declared in 
this scope
grassdataset.cpp:193: error: aggregate 'FPRange sRange' has incomplete 
type and cannot be defined
grassdataset.cpp:196: error: 'G_read_fp_range' was not declared in this 
scope
grassdataset.cpp:203: error: 'G_get_fp_range_min_max' was not declared 
in this scope
grassdataset.cpp:210: error: 'CELL_TYPE' was not declared in this scope
grassdataset.cpp:236: error: 'FCELL_TYPE' was not declared in this scope
grassdataset.cpp:241: error: 'DCELL_TYPE' was not declared in this scope
grassdataset.cpp:250: error: 'G_open_cell_old' was not declared in this 
scope
grassdataset.cpp:255: error: aggregate 'Colors sGrassColors' has 
incomplete type and cannot be defined
grassdataset.cpp:259: error: 'G_read_colors' was not declared in this scope
grassdataset.cpp:267: error: 'G_get_color' was not declared in this scope
grassdataset.cpp:287: error: 'G_free_colors' was not declared in this scope
grassdataset.cpp: In destructor 'virtual 
GRASSRasterBand::~GRASSRasterBand()':
grassdataset.cpp:302: error: 'G_close_cell' was not declared in this scope
grassdataset.cpp: In member function 'virtual CPLErr 
GRASSRasterBand::IReadBlock(int, int, void*)':
grassdataset.cpp:321: error: 'G_get_null_value_row' was not declared in 
this scope
grassdataset.cpp:326: error: 'G_get_raster_row' was not declared in this 
scope
grassdataset.cpp:346: error: 'G_get_raster_row' was not declared in this 
scope
grassdataset.cpp: In static member function 'static GDALDataset* 
GRASSDataset::Open(GDALOpenInfo*)':
grassdataset.cpp:517: error: 'G_set_error_routine' was not declared in 
this scope
grassdataset.cpp:518: error: 'G_gisinit_2' was not declared in this scope
grassdataset.cpp:524: error: 'G_check_cell' was not declared in this scope
grassdataset.cpp:529: error: 'G_free' was not declared in this scope
grassdataset.cpp:536: error: 'I_check_group' was not declared in this scope
grassdataset.cpp:538: error: aggregate 'Ref ref' has incomplete type and 
cannot be defined
grassdataset.cpp:540: error: 'I_init_group_ref' was not declared in this 
scope
grassdataset.cpp:541: error: 'I_get_group_ref' was not declared in this 
scope
grassdataset.cpp:549: error: 'I_free_group_ref' was not declared in this 
scope
grassdataset.cpp:551: error: 'G_free' was not declared in this scope
grassdataset.cpp:571: error: aggregate 'Cell_head sCellInfo' has 
incomplete type and cannot be defined
grassdataset.cpp:573: error: 'G_get_cellhd' was not declared in this scope
grassdataset.cpp:582: error: 'G_set_window' was not declared in this scope
grassdataset.cpp:596: error: 'G_get_cell_as_proj4' was not declared in 
this scope
grassdataset.cpp:606: error: 'G_free' was not declared in this scope
make[2]: *** [../o/grassdataset.o] Error 1
make[2]: Leaving directory `/usr/share/gdal-1.3.2/frmts/grass'
make[1]: *** [grass-install-obj] Error 2
make[1]: Leaving directory `/usr/share/gdal-1.3.2/frmts'
make: *** [frmts-target] Error 2

From nbest at speakeasy.net  Sat Sep 16 08:16:35 2006
From: nbest at speakeasy.net (Neil Best)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: Problem using OGR and join-functionality: column
 names gone when creating a new shapefile?
In-Reply-To: <200609131046.53725.wolfgang.qual@gmx.net>
References: <200609131046.53725.wolfgang.qual@gmx.net>
Message-ID: <450BEB23.6040304@speakeasy.net>

Hi, Wolfgang.  I think if you look at my recent posts to the list you 
will see that we are experiencing similar difficulties, you and I.  I 
wanted to do the same thing, make a join permanent, the only difference 
is that my source data is a .shp and a .dbf, rather than related tables 
in an RDBMS.

Since I can't get it to work either I can't speak with much authority, 
but I think I can point out something about your problem with field 
names.  If you look at the section describing joins on the OGR SQL page 
you will see a detailed discussion of how column names in the SQL 
statement map to the output.  My guess is that OGR is trying to give you 
fully qualified column names (e.g. "flurstck_test.ich_weiss_was_nicht") 
and truncating them according to the .dbf conventions.  Try using some 
aliases in your SQL.  If you post your query and a minimal description 
of your columns to the list I can try to offer a suggestion.

What's interesting is that we are both running the same version under 
Debian, albeit I am using Ubuntu.  I don't know if this is significant 
or not, especially since I got the same results when I dropped back to 
1.2.6, but there it is . . .


Neil


wqual wrote:
> Hi list,
> yesterday, I found a very interesting page on the internet - manpage of OGR 
> SQL [1]. Wow, I thought - I can perfom JOINs on the command line. Using 
> the join-command as described in this manual combinded to the ogrinfo-command 
> clearly showed, that a join was performed.
> *But could I make this permanent?* 
> Within the next step, I used ogr2ogr with the same sql-expression. A new 
> shapefile was created, the desired column of the second theme was appended to 
> the table (ogr2ogr -f "ESRI Shapefile" testfile.shp ./ -sql "select ...."
> 
> However, I realised, that all the column names were gone, or to be more 
> precise, lost their names in favour of a new one. All column names of the 
> first shapefile "Flurstck_test.shp" were (re)-named to "flurstck_t" and the 
> new column of the second theme "flurstck_nr.shp" is named "flurstck_n" now.
> Also, the column definitions were all converted to "Real" except the column 
> that was appended (joined) to the table. This column is of type "String".
> 
> Is this a common (known problem)? I would be most grateful for some comments, 
> as I really would like to use this feature of ogr! Thanks in advance!
> 
> I am using gdal 1.3.2-2 on a Debian machine.
> 
> Best regards,
> Wolfgang
> 
> [1] www.remotesensing.org/gdal/ogr/ogr_sql.html


From bthoen at gisnet.com  Sat Sep 16 12:16:22 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Default Settings when Compiling GDAL
Message-ID: <20060916161622.GA2431@www.gisnet.com>

If I compile the GDAL package using just the defaults, is support for
postgres one of the defaults or do I need to add the --with-pg option? How
do I tell which options are set "on" by default?


From bthoen at gisnet.com  Sat Sep 16 17:03:26 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr -f "MapInfo File" -- Does this even work at
	all?!?
Message-ID: <450C669E.9060608@gisnet.com>

I've got a spatial database in postgres that I can extract to shp 
format, no problem. But when I try:

ogr2ogr -f "MapInfo File" napp1.tab PG:dbname=spatial2 napp1

it appears to build a MapInfo TAB file with no errors (I've read the 
caveats on http://ogr.maptools.org/drv_mitab.html, and that page wasn't 
easy to find either). But when I try to open it in MapInfo 8.5, I get an 
error "Unable to open table napp1.tab." The problem is not with the .tab 
or .dat file; if I rename the .id and .map to something else, I can open 
that table as if it were non-mappable table.

When I check the table with ogrinfo, it appeasrs normal with a 
geographic coordinate system (WGS 84) with units in degrees -- i.e. 
pretty basic. The map features are simple MULTIPOLYGON types. I've tried 
all kinds of variations to try and get a MapInfo table out of this 
utility, but so far the only way that works is to dump it as shp and 
then convert it with *MapInfo's* conversion utility. Not what I was 
hoping for.

Can anyone tell me what I'm doing wrong or suggest something I can try 
to get it to work?


From bthoen at gisnet.com  Sun Sep 17 13:07:09 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr -f "MapInfo File" -- Does this even work at
	all?!?
In-Reply-To: <450C669E.9060608@gisnet.com>
References: <450C669E.9060608@gisnet.com>
Message-ID: <20060917170709.GA19926@www.gisnet.com>

I've now tried several other data sources (from postgres and from
shapefile) and ogr2ogr never creates a MapInfo table that can be opened by
MI 8.0 or 8.5. However, if I add -dsco FORMAT=MIF and set the
dst_datasource to something with a .MIF extension, it works just fine. So
it looks like something's wrong with the MITAB driver regarding TAB file
creation. 

Can anyone else confirm this, or do I have a local problem?


On Sat, Sep 16, 2006 at 03:03:26PM -0600, Bill Thoen wrote:
> I've got a spatial database in postgres that I can extract to shp 
> format, no problem. But when I try:
> 
> ogr2ogr -f "MapInfo File" napp1.tab PG:dbname=spatial2 napp1
> 
> it appears to build a MapInfo TAB file with no errors (I've read the 
> caveats on http://ogr.maptools.org/drv_mitab.html, and that page wasn't 
> easy to find either). But when I try to open it in MapInfo 8.5, I get an 
> error "Unable to open table napp1.tab." The problem is not with the .tab 
> or .dat file; if I rename the .id and .map to something else, I can open 
> that table as if it were non-mappable table.
> 
> When I check the table with ogrinfo, it appeasrs normal with a 
> geographic coordinate system (WGS 84) with units in degrees -- i.e. 
> pretty basic. The map features are simple MULTIPOLYGON types. I've tried 
> all kinds of variations to try and get a MapInfo table out of this 
> utility, but so far the only way that works is to dump it as shp and 
> then convert it with *MapInfo's* conversion utility. Not what I was 
> hoping for.
> 
> Can anyone tell me what I'm doing wrong or suggest something I can try 
> to get it to work?
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 

From wolfgang.qual at gmx.net  Mon Sep 18 04:54:28 2006
From: wolfgang.qual at gmx.net (wqual)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Re: Problem using OGR and join-functionality: column
	names gone when creating a new shapefile?
In-Reply-To: <450BEB23.6040304@speakeasy.net>
References: <200609131046.53725.wolfgang.qual@gmx.net>
	<450BEB23.6040304@speakeasy.net>
Message-ID: <200609181054.28802.wolfgang.qual@gmx.net>

Hi Neil,
thank you for your reply - and a good idea to use aliases. But first, the 
complete ogr2ogr-command that I used before:
ogr2ogr -f "ESRI Shapefile" testjoin5.shp ./ -sql "select 
flurstck_test.*, flurstck_nr1.GEMARKUNG_ from flurstck_test left join 
flurstck_nr1 on flurstck_test.OBJEKT_ID = flurstck_nr1.OBJEKT_ID"

The result was the column names as described earlier:
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_t
flurstck_n

After your mail, I used the alias "fl" for flurstck_test and "nr" for 
flurstck_nr:

wolfgang.qual@rgu04-200:~$ ogr2ogr -f "ESRI Shapefile" testjoin6.shp ./ 
-sql "select fl.*, nr.GEMARKUNG from flurstck_test fl left join 
flurstck_nr1 nr on fl.OBJEKT_ID = nr.OBJEKT_ID"

The new column names were then:
fl.OGR_FID
fl.OBJEKT_
fl.FOLIE
fl.OBJEKTA
fl.X
fl.Y
fl.NUTZUNG
fl.EIGENTU
fl.ADMPLAY
fl.FLUR_P_
nr.GEMARKU

This result looks much better! I guess there's no way to keep the original 
column names, but this is ok.

Best regards,
Wolfgang

---8<----------------------------------------------------------
Am Samstag 16 September 2006 pH:16:14 nachmittags/abends schrieb Neil Best:
> Hi, Wolfgang.  I think if you look at my recent posts to the list you
> will see that we are experiencing similar difficulties, you and I.  I
> wanted to do the same thing, make a join permanent, the only difference
> is that my source data is a .shp and a .dbf, rather than related tables
> in an RDBMS.
>
> Since I can't get it to work either I can't speak with much authority,
> but I think I can point out something about your problem with field
> names.  If you look at the section describing joins on the OGR SQL page
> you will see a detailed discussion of how column names in the SQL
> statement map to the output.  My guess is that OGR is trying to give you
> fully qualified column names (e.g. "flurstck_test.ich_weiss_was_nicht")
> and truncating them according to the .dbf conventions.  Try using some
> aliases in your SQL.  If you post your query and a minimal description
> of your columns to the list I can try to offer a suggestion.
>
> What's interesting is that we are both running the same version under
> Debian, albeit I am using Ubuntu.  I don't know if this is significant
> or not, especially since I got the same results when I dropped back to
> 1.2.6, but there it is . . .
>
>
> Neil
>
> wqual wrote:
> > Hi list,
> > yesterday, I found a very interesting page on the internet - manpage of
> > OGR SQL [1]. Wow, I thought - I can perfom JOINs on the command line.
> > Using the join-command as described in this manual combinded to the
> > ogrinfo-command clearly showed, that a join was performed.
> > *But could I make this permanent?*
> > Within the next step, I used ogr2ogr with the same sql-expression. A new
> > shapefile was created, the desired column of the second theme was
> > appended to the table (ogr2ogr -f "ESRI Shapefile" testfile.shp ./ -sql
> > "select ...."
> >
> > However, I realised, that all the column names were gone, or to be more
> > precise, lost their names in favour of a new one. All column names of the
> > first shapefile "Flurstck_test.shp" were (re)-named to "flurstck_t" and
> > the new column of the second theme "flurstck_nr.shp" is named
> > "flurstck_n" now. Also, the column definitions were all converted to
> > "Real" except the column that was appended (joined) to the table. This
> > column is of type "String".
> >
> > Is this a common (known problem)? I would be most grateful for some
> > comments, as I really would like to use this feature of ogr! Thanks in
> > advance!
> >
> > I am using gdal 1.3.2-2 on a Debian machine.
> >
> > Best regards,
> > Wolfgang
> >
> > [1] www.remotesensing.org/gdal/ogr/ogr_sql.html

From Jukka.Rahkonen at mmmtike.fi  Mon Sep 18 05:36:52 2006
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Gdal_translate and the Internal accuracy of ground
	control points
Message-ID: <CC197224AC75CE4DB23F739B16891B866683F7@tikka.haapa.mmm.fi>

Hi,
 
I have inserted ground control points into a GeoTIFF image file with gdal_translate in this way:
gdal_translate input.tif  output_gcp.tif -gcp 0 0  285113.632 6713217.584 etc.
 
Gdalinfo reports me about the resulting image as follows:
GCP Projection =

GCP[  0]: Id=1, Info=

          (0,0) -> (285114,6.71322e+006,0)

 

Are the gcp's still stored into the GeoTIFF file with the same accuracy I gave them, or are they rounded like gdalinfo is expressing them?

 

Regards,

 

-Jukka Rahkonen-



From dmorissette at mapgears.com  Mon Sep 18 11:56:02 2006
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr -f "MapInfo File" -- Does this even work at
	all?!?
In-Reply-To: <450C669E.9060608@gisnet.com>
References: <450C669E.9060608@gisnet.com>
Message-ID: <450EC192.2040908@mapgears.com>

Bill,

I didn't check the version of MITAB that is used in GDAL 1.3.2 (that's 
the version you're using, right?), but there was a bug at some point 
around MITAB 1.5.0 that resulted in invalid .MAP files being generated, 
this may well be what you ran into.

This has been fixed in MITAB 1.5.1 (2006-07-25) but I'm not sure if I 
have updated the GDAL/OGR code with the latest code after the MITAB 
1.5.1 release (doh!).

I am on the road right now, this combined with a computer HD crash so I 
can't backport the latest MITAB source in OGR myself before next week at 
least.

Daniel

P.S. You didn't get any reply to your mutliple posts on this topic last 
week because we were all at FOSS4G2006 in Lausanne. You missed a very 
good week!  ;)


Bill Thoen wrote:

> I've got a spatial database in postgres that I can extract to shp 
> format, no problem. But when I try:
> 
> ogr2ogr -f "MapInfo File" napp1.tab PG:dbname=spatial2 napp1
> 
> it appears to build a MapInfo TAB file with no errors (I've read the 
> caveats on http://ogr.maptools.org/drv_mitab.html, and that page wasn't 
> easy to find either). But when I try to open it in MapInfo 8.5, I get an 
> error "Unable to open table napp1.tab." The problem is not with the .tab 
> or .dat file; if I rename the .id and .map to something else, I can open 
> that table as if it were non-mappable table.
> 
> When I check the table with ogrinfo, it appeasrs normal with a 
> geographic coordinate system (WGS 84) with units in degrees -- i.e. 
> pretty basic. The map features are simple MULTIPOLYGON types. I've tried 
> all kinds of variations to try and get a MapInfo table out of this 
> utility, but so far the only way that works is to dump it as shp and 
> then convert it with *MapInfo's* conversion utility. Not what I was 
> hoping for.
> 
> Can anyone tell me what I'm doing wrong or suggest something I can try 
> to get it to work?
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From bthoen at gisnet.com  Mon Sep 18 12:05:06 2006
From: bthoen at gisnet.com (Bill Thoen)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] ogr2ogr -f "MapInfo File" -- Does this even work at
	all?!?
In-Reply-To: <450EC192.2040908@mapgears.com>
References: <450C669E.9060608@gisnet.com> <450EC192.2040908@mapgears.com>
Message-ID: <450EC3B2.5050703@gisnet.com>

Daniel Morissette wrote:

> I didn't check the version of MITAB that is used in GDAL 1.3.2 (that's 
> the version you're using, right?), but there was a bug at some point 
> around MITAB 1.5.0 that resulted in invalid .MAP files being 
> generated, this may well be what you ran into.

That's the problem. The data part works fine (when I remove the .map and 
.id files, the data is viewable) A binary compare with a good .MAP file 
and a bad one shows all kinds of differences. I got around it for now by 
exporting shapefiles and converting them to TAB. This also gets around 
the problem of the MITAB driver not being able to handle PostgreSQL date 
fields.

> P.S. You didn't get any reply to your mutliple posts on this topic 
> last week because we were all at FOSS4G2006 in Lausanne. You missed a 
> very good week! ;)

I wondered where everybody was. I guess I just picked he wrong week to 
get started with all this FOS GIS stuff and have lots of newbie questions!


From ollerery at engr.orst.edu  Mon Sep 18 13:45:49 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] gdal 1.3.1 install
In-Reply-To: <450EC3B2.5050703@gisnet.com>
References: <450C669E.9060608@gisnet.com> <450EC192.2040908@mapgears.com>
	<450EC3B2.5050703@gisnet.com>
Message-ID: <450EDB4D.3050207@engr.orst.edu>

I am trying to compile gdal on fedora core 5 but i keep running into 
problems, i am using the following configure command:

./configure  --with-png  --with-libtiff  --with-jpeg  --with-gif  
--with-geotiff=internal --with-pg=/usr/local/pgsql/bin/pg_config 
--with-geos --without-cfitsio

then during make i am getting the following error:

make[2]: Entering directory `/root/gdal-1.3.1/frmts/fit'
/bin/sh ../../libtool --mode=compile g++ -Wall  -O2   -I../../port 
-I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts  
-I../../port  -c -o ../o/fitdataset.o fitdataset.cpp
 g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr 
-I../../ogr/ogrsf_frmts -I../../port -c fitdataset.cpp  -fPIC -DPIC -o 
../o/.libs/fitdataset.o
fitdataset.cpp:177: error: extra qualification 'FITRasterBand::' on 
member 'FITRasterBand'
fitdataset.cpp: In static member function 'static GDALDataset* 
FITDataset::Open(GDALOpenInfo*)':
fitdataset.cpp:1019: warning: dereferencing type-punned pointer will 
break strict-aliasing rules
make[2]: *** [../o/fitdataset.o] Error 1
make[2]: Leaving directory `/root/gdal-1.3.1/frmts/fit'
make[1]: *** [fit-install-obj] Error 2
make[1]: Leaving directory `/root/gdal-1.3.1/frmts'
make: *** [frmts-target] Error 2


any help would be great, thanks.

From ollerery at engr.orst.edu  Mon Sep 18 14:07:22 2006
From: ollerery at engr.orst.edu (Ryan Ollerenshaw)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] gdal 1.3.0 install
In-Reply-To: <450EDB4D.3050207@engr.orst.edu>
References: <450C669E.9060608@gisnet.com>
	<450EC192.2040908@mapgears.com>	<450EC3B2.5050703@gisnet.com>
	<450EDB4D.3050207@engr.orst.edu>
Message-ID: <450EE05A.9070904@engr.orst.edu>


Ryan Ollerenshaw wrote:
> I am trying to compile gdal on fedora core 5 but i keep running into 
> problems, i am using the following configure command:
>
> ./configure  --with-png  --with-libtiff  --with-jpeg  --with-gif  
> --with-geotiff=internal --with-pg=/usr/local/pgsql/bin/pg_config 
> --with-geos --without-cfitsio
>
> then during make i am getting the following error:
>
> make[2]: Entering directory `/root/gdal-1.3.1/frmts/fit'
> /bin/sh ../../libtool --mode=compile g++ -Wall  -O2   -I../../port 
> -I../../gcore -I../../alg -I../../ogr -I../../ogr/ogrsf_frmts  
> -I../../port  -c -o ../o/fitdataset.o fitdataset.cpp
> g++ -Wall -O2 -I../../port -I../../gcore -I../../alg -I../../ogr 
> -I../../ogr/ogrsf_frmts -I../../port -c fitdataset.cpp  -fPIC -DPIC -o 
> ../o/.libs/fitdataset.o
> fitdataset.cpp:177: error: extra qualification 'FITRasterBand::' on 
> member 'FITRasterBand'
> fitdataset.cpp: In static member function 'static GDALDataset* 
> FITDataset::Open(GDALOpenInfo*)':
> fitdataset.cpp:1019: warning: dereferencing type-punned pointer will 
> break strict-aliasing rules
> make[2]: *** [../o/fitdataset.o] Error 1
> make[2]: Leaving directory `/root/gdal-1.3.1/frmts/fit'
> make[1]: *** [fit-install-obj] Error 2
> make[1]: Leaving directory `/root/gdal-1.3.1/frmts'
> make: *** [frmts-target] Error 2
>
>
> any help would be great, thanks.
>
I have tried gdal-1.3.1 and got the same error

With gdal-1.3.2 i get the following error:

make[2]: Entering directory `/root/gdal-1.3.2/frmts/grass'
/bin/sh /root/gdal-1.3.2/libtool --mode=compile g++ -Wall  -O2    
-I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore -I/root/gdal-1.3.2/alg 
-I/root/gdal-1.3.2/ogr -I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED 
-I/root/gdal-1.3.2/port  -c -o ../o/grassdataset.o grassdataset.cpp
 g++ -Wall -O2 -I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore 
-I/root/gdal-1.3.2/alg -I/root/gdal-1.3.2/ogr 
-I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED -I/root/gdal-1.3.2/port 
-c grassdataset.cpp  -fPIC -DPIC -o ../o/.libs/grassdataset.o
grassdataset.cpp:84:22: error: libgrass.h: No such file or directory
grassdataset.cpp: In constructor 
'GRASSRasterBand::GRASSRasterBand(GRASSDataset*, int, const char*, const 
char*)':
grassdataset.cpp:182: error: aggregate 'Cell_head sCellInfo' has 
incomplete type and cannot be defined
grassdataset.cpp:187: error: 'G_get_cellhd' was not declared in this scope
grassdataset.cpp:188: error: 'G_raster_map_type' was not declared in 
this scope
grassdataset.cpp:193: error: aggregate 'FPRange sRange' has incomplete 
type and cannot be defined
grassdataset.cpp:196: error: 'G_read_fp_range' was not declared in this 
scope
grassdataset.cpp:203: error: 'G_get_fp_range_min_max' was not declared 
in this scope
grassdataset.cpp:210: error: 'CELL_TYPE' was not declared in this scope
grassdataset.cpp:236: error: 'FCELL_TYPE' was not declared in this scope
grassdataset.cpp:241: error: 'DCELL_TYPE' was not declared in this scope
grassdataset.cpp:250: error: 'G_open_cell_old' was not declared in this 
scope
grassdataset.cpp:255: error: aggregate 'Colors sGrassColors' has 
incomplete type and cannot be defined
grassdataset.cpp:259: error: 'G_read_colors' was not declared in this scope
grassdataset.cpp:267: error: 'G_get_color' was not declared in this scope
grassdataset.cpp:287: error: 'G_free_colors' was not declared in this scope
grassdataset.cpp: In destructor 'virtual 
GRASSRasterBand::~GRASSRasterBand()':
grassdataset.cpp:302: error: 'G_close_cell' was not declared in this scope
grassdataset.cpp: In member function 'virtual CPLErr 
GRASSRasterBand::IReadBlock(int, int, void*)':
grassdataset.cpp:321: error: 'G_get_null_value_row' was not declared in 
this scope
grassdataset.cpp:326: error: 'G_get_raster_row' was not declared in this 
scope
grassdataset.cpp:346: error: 'G_get_raster_row' was not declared in this 
scope
grassdataset.cpp: In static member function 'static GDALDataset* 
GRASSDataset::Open(GDALOpenInfo*)':
grassdataset.cpp:517: error: 'G_set_error_routine' was not declared in 
this scope
grassdataset.cpp:518: error: 'G_gisinit_2' was not declared in this scope
grassdataset.cpp:524: error: 'G_check_cell' was not declared in this scope
grassdataset.cpp:529: error: 'G_free' was not declared in this scope
grassdataset.cpp:536: error: 'I_check_group' was not declared in this scope
grassdataset.cpp:538: error: aggregate 'Ref ref' has incomplete type and 
cannot be defined
grassdataset.cpp:540: error: 'I_init_group_ref' was not declared in this 
scope
grassdataset.cpp:541: error: 'I_get_group_ref' was not declared in this 
scope
grassdataset.cpp:549: error: 'I_free_group_ref' was not declared in this 
scope
grassdataset.cpp:551: error: 'G_free' was not declared in this scope
grassdataset.cpp:571: error: aggregate 'Cell_head sCellInfo' has 
incomplete type and cannot be defined
grassdataset.cpp:573: error: 'G_get_cellhd' was not declared in this scope
grassdataset.cpp:582: error: 'G_set_window' was not declared in this scope
grassdataset.cpp:596: error: 'G_get_cell_as_proj4' was not declared in 
this scope
grassdataset.cpp:606: error: 'G_free' was not declared in this scope
make[2]: *** [../o/grassdataset.o] Error 1
make[2]: Leaving directory `/root/gdal-1.3.2/frmts/grass'
make[1]: *** [grass-install-obj] Error 2
make[1]: Leaving directory `/root/gdal-1.3.2/frmts'
make: *** [frmts-target] Error 2




From wmc at timberline.ca  Mon Sep 18 16:28:17 2006
From: wmc at timberline.ca (Will Cadell)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] easy ogr question...
Message-ID: <450F0161.6090403@timberline.ca>

hi guys... am i just stupid or is there another way to add a field to a
shapefile other than:
   
    ds = ogr.open("c:\shapefile.shp", True)
   
    new_field = ogr.FieldDefn()
    new_field.SetName(new_field_name)
    new_field.SetType(new_field_type)
    new_field.SetWidth(new_field_width)
   
    layer = ds.GetLayer(0)
    layer.CreateField(new_field)
   
    ds.destroy

because this doesn't work for me...

please help, Will

-- 
Will Cadell
Remote Sensing and GIS Analyst

   /\/\
  /  \ \
 /  Timberline
/   Forest Inventory Consultants

tel:(250) 562 2628       address: 1579 9th Ave,
skype: geo_will                   Prince George,
loc: 53.9135N, 122.7544W          BC, Canada 

www.timberline.ca


From ILucena at clarku.edu  Mon Sep 18 17:17:17 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] make makefile.vc run faster
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45501DB52D7@Iris.ad.clarku.edu>

Hi There,

I am drinking too much coffee every time I change something and
re-compile GDAL, but that's because the make files are wasting a lot of
time copying unchanged .obj files. So I did the following steps to
replace all copy by "xcopy /D /Y":

-----------------------------------------------------------------
In Visual Studio (8) 2005:

Edit>>"Find and Replace">>"Replace in Files"

Find what:
"copy *.obj" 

Replace with:
"xcopy /D /Y *.obj"

Look in:
<your gdal source main folder, ex: "E:\GDAL\">

v - Include sub-folders

Find options:

Look at these files types:
"makefile.vc"

Click on "Replace All"

Click on "Yes"
-----------------------------------------------------------------

Now it runs in no-time (for a cup of coffee).

Of curse there is a better way to do that by creating rules in
makefiles. But this is just a suggestion with minimum impact.

Ivan



From henrik at johome.net  Tue Sep 19 04:20:54 2006
From: henrik at johome.net (Henrik Johansson)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL driver for Magellan topo format
Message-ID: <200609191020.55236.>

> Where has the diff gone?

Sorry, I've been out of town and I've had some problems with the web server. 
No everything should work fine though.

I haven't got any response at all from the GDAL BLX patch. Has anyone tried 
it?

/Henrik

From tutey at o2.pl  Tue Sep 19 08:27:12 2006
From: tutey at o2.pl (Maciej Sieczka)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL driver for Magellan topo format
In-Reply-To: <200609191020.55236.>
References: <200609191020.55236.>
Message-ID: <450FE220.4020207@o2.pl>

Henrik Johansson wrote:
>> Where has the diff gone?
> 
> Sorry, I've been out of town and I've had some problems with the web server. 
> No everything should work fine though.
> 
> I haven't got any response at all from the GDAL BLX patch. Has anyone tried 
> it?

Not me :). I just spotted this interesting plugin and wanted to
advertise it on Polish GPS mailing list, as a part of my GDAL propaganda.

Nice it's back again. Maybe now some Polish GPS folk will try it.

Best,
Maciek

From kkirubanantham at yahoo.com  Tue Sep 19 11:03:24 2006
From: kkirubanantham at yahoo.com (kiruba nantham)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] GDAL-Building
Message-ID: <20060919150324.70150.qmail@web52210.mail.yahoo.com>

    i am building gdal-1.3.2 using embedded VC++ 4.0 when i am compiling it i am getting 95 errors (error is : can not open include file: ' errno.h ' : no such file or directory). what directory i should include for this errno.h? 
  
      otherwise if any one knows how to build  gdal13.dll using cygwin  please tell me how to do? i tried with  cygwin it's creating library(libgdal.a)  but it is not creating  gdal13.dll.
  
       if any one knows how to solve this problems please tell me because i got struct up with this problems.
  
  regards,
          k.kiruba 
  
 		
---------------------------------
Get your email and more, right on the  new Yahoo.com 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060919/d905dfbf/attachment.html
From josegomez at gmx.net  Tue Sep 19 11:23:54 2006
From: josegomez at gmx.net (Jose Luis Gomez Dans)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Complex data types
Message-ID: <20060919152354.106290@gmx.net>

Hi!
I want to extract data from ENVISAT ASAR files (Envisat/ESAT format). I would like to use the Python bindings for this task, and read a ROI, rather than the whole image, which is quite large. I understand that GDAL will output CInt16 data types, which I will then need to process to work out the magnitude and so on. However, I can't figure out how to read these data into Python (Numpy) arrays. 

Also, is there a way to be able to specify a ROI in the original image? There are some GCPs in the file's header, but the UL and LR coordinates are purely row and column numbers. Any ideas how this subsetting can be achieved?

Of course, any other experiences of using ASAR SLC or PRI images with GDAL will be most welcomed! :)
-- 
NEU: GMX DSL Sofort-Start-Set - blitzschnell ins Internet!
Echte DSL-Flatrate ab 0,- Euro* http://www.gmx.net/de/go/dsl

From warmerdam at pobox.com  Tue Sep 19 12:17:52 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] make makefile.vc run faster
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D45501DB52D7@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D45501DB52D7@Iris.ad.clarku.edu>
Message-ID: <45101830.50307@pobox.com>

Ivan Lucena wrote:
> Hi There,
> 
> I am drinking too much coffee every time I change something and
> re-compile GDAL, but that's because the make files are wasting a lot of
> time copying unchanged .obj files. So I did the following steps to
> replace all copy by "xcopy /D /Y":

Ivan,

Would you be willing to apply this change in CVS?  Let me know when it is
there, and I'll do some checking to make sure it is working ok at my end too.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From sy at perkins.net  Tue Sep 19 12:19:52 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <20060914094739.GA3884@ak4719.spb.edu>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<20060914094739.GA3884@ak4719.spb.edu>
Message-ID: <1158682792.12878.271307886@webmail.messagingengine.com>


On Thu, 14 Sep 2006 13:47:39 +0400, "Andrey Kiselev"
<dron@ak4719.spb.edu> said:
> On Wed, Sep 13, 2006 at 11:06:00AM -0600, Simon Perkins wrote:
> > PROPOSED IMPLEMENTATION
> > 
> > The Visual Studio IDE requires that each individual DLL, executable etc,
> > be treated as a separate "Project" within a larger "Solution". The
> > .vcproj files defining individual projects have to live in their own
> > sub-directories - you cannot have more than one .vcproj file in the same
> > directory (or at least, I haven't found an easy way of doing this). The
> > source code does not have to be in the same directory as the .vcproj
> > files.  The acutal executables, libraries, etc are built in Debug and
> > Release sub-directories of the .vcproj directories. Note that other VS
> > applications that depend on GDAL do not have to know about this level of
> > detail - they simply reference the .vcproj file.
> 
> Simon,
> 
> That all looks pretty complicated to maintain. Is there a way to include
> in project files the list of file paths and include parameters like it
> is done in the current makefiles? Otherwise it gets too complicated even
> to 
> add a single new file to the project. If we will found a way to keep the
> file lists and configuration parameters separate from the project files
> there will be no problem to add them to GDAL. Without such separation
> there should be the one who will regularly update project files.

Hi Anrey,

Which bit do you mean is complicated? The separate directory of Visual
Studio files? Or the separate project files for each built component? Or
maintaining configurations etc? Under VS 2005, I think it's possible to
have project files inherit from one another, so I think that it should
be possible to put all the common information in one place. If you add a
file to a component, you would have to add that file to the relevant
project file (no wildcards or things like that), but that shouldn't be a
huge maintenance headache. Anyway, I'll take a look to see what's
possible, and when I have something more concrete we can decide whether
to include it in the GDAL source tree or distribute it as an unsupported
contributed extra.


Thanks to Roger and others for the 2003 project files which should
provide a good starting point.

Cheers,

Sy

From warmerdam at pobox.com  Tue Sep 19 12:26:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] easy ogr question...
In-Reply-To: <450F0161.6090403@timberline.ca>
References: <450F0161.6090403@timberline.ca>
Message-ID: <45101A49.5030108@pobox.com>

Will Cadell wrote:
> hi guys... am i just stupid or is there another way to add a field to a
> shapefile other than:
>    
>     ds = ogr.open("c:\shapefile.shp", True)
>    
>     new_field = ogr.FieldDefn()
>     new_field.SetName(new_field_name)
>     new_field.SetType(new_field_type)
>     new_field.SetWidth(new_field_width)
>    
>     layer = ds.GetLayer(0)
>     layer.CreateField(new_field)
>    
>     ds.destroy
> 
> because this doesn't work for me...

Will,

This does seem like the correct approach.  Are there any features in the
shapefile already?  I'm pretty sure that adding a field only works when
there are no features yet.  If you aren't getting an error message then
there is a clear bug here, and a bug report in bugzilla would be appreciated.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From wmc at timberline.ca  Tue Sep 19 12:33:03 2006
From: wmc at timberline.ca (Will Cadell)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] easy ogr question...
In-Reply-To: <45101A49.5030108@pobox.com>
References: <450F0161.6090403@timberline.ca> <45101A49.5030108@pobox.com>
Message-ID: <45101BBF.7010606@timberline.ca>

Thanks Frank,

No message I'm afraid but there are features, and I was wondering how
ogr would handle and 'empty' column. I assumed it would add nulls, but
hey ho seems like I'll have to make a new shapefile, copy the layer
definition then add the field then copy all the features to a new
shapefile... Does seem a bit cumbersome though... is there a better way
people can think of?

will

Frank Warmerdam wrote:
> Will Cadell wrote:
>> hi guys... am i just stupid or is there another way to add a field to a
>> shapefile other than:
>>        ds = ogr.open("c:\shapefile.shp", True)
>>        new_field = ogr.FieldDefn()
>>     new_field.SetName(new_field_name)
>>     new_field.SetType(new_field_type)
>>     new_field.SetWidth(new_field_width)
>>        layer = ds.GetLayer(0)
>>     layer.CreateField(new_field)
>>        ds.destroy
>>
>> because this doesn't work for me...
>
> Will,
>
> This does seem like the correct approach.  Are there any features in the
> shapefile already?  I'm pretty sure that adding a field only works when
> there are no features yet.  If you aren't getting an error message then
> there is a clear bug here, and a bug report in bugzilla would be
> appreciated.
>
> Best regards,

-- 
Will Cadell
Remote Sensing and GIS Analyst

   /\/\
  /  \ \
 /  Timberline
/   Forest Inventory Consultants

tel:(250) 562 2628       address: 1579 9th Ave,
skype: geo_will                   Prince George,
loc: 53.9135N, 122.7544W          BC, Canada 

www.timberline.ca


From warmerdam at pobox.com  Tue Sep 19 12:32:44 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] gdal 1.3.0 install
In-Reply-To: <450EE05A.9070904@engr.orst.edu>
References: <450C669E.9060608@gisnet.com>	<450EC192.2040908@mapgears.com>	<450EC3B2.5050703@gisnet.com>	<450EDB4D.3050207@engr.orst.edu>
	<450EE05A.9070904@engr.orst.edu>
Message-ID: <45101BAC.5020905@pobox.com>

Ryan Ollerenshaw wrote:
> I have tried gdal-1.3.1 and got the same error
> 
> With gdal-1.3.2 i get the following error:
> 
> make[2]: Entering directory `/root/gdal-1.3.2/frmts/grass'
> /bin/sh /root/gdal-1.3.2/libtool --mode=compile g++ -Wall  -O2    
> -I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore -I/root/gdal-1.3.2/alg 
> -I/root/gdal-1.3.2/ogr -I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED 
> -I/root/gdal-1.3.2/port  -c -o ../o/grassdataset.o grassdataset.cpp
> g++ -Wall -O2 -I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore 
> -I/root/gdal-1.3.2/alg -I/root/gdal-1.3.2/ogr 
> -I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED -I/root/gdal-1.3.2/port 
> -c grassdataset.cpp  -fPIC -DPIC -o ../o/.libs/grassdataset.o
> grassdataset.cpp:84:22: error: libgrass.h: No such file or directory
> grassdataset.cpp: In constructor 


Ryan,

There is no sign in the above compile line that the GRASS include files
are being indicated properly.  If GRASS support is not important, I
would suggest you re-configure --without-grass.  If GRASS support is
important, then we need to track through the configure logic related
to GRASS and I would need to know what grass related configure options
you used.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From putler at sauder.ubc.ca  Tue Sep 19 12:48:36 2006
From: putler at sauder.ubc.ca (Dan Putler)
Date: Wed Nov 21 11:50:21 2007
Subject: [Gdal-dev] easy ogr question...
In-Reply-To: <45101BBF.7010606@timberline.ca>
References: <450F0161.6090403@timberline.ca> <45101A49.5030108@pobox.com>
	<45101BBF.7010606@timberline.ca>
Message-ID: <C6E7A849-F742-4BDD-97AA-4FEFD75E9B42@sauder.ubc.ca>

Hi Will,

I add new fields to shapefiles all the time. Although, I do it using  
R, which (through Frank's shapelib) handles DBFs beautifully. I can  
provide details, but since this is now off list, I can provide  
details privately. The main thing is that you only need to muck with  
the *.dbf file, not the *.shp file itself.

Dan

On 19-Sep-06, at 9:33 AM, Will Cadell wrote:

> Thanks Frank,
>
> No message I'm afraid but there are features, and I was wondering how
> ogr would handle and 'empty' column. I assumed it would add nulls, but
> hey ho seems like I'll have to make a new shapefile, copy the layer
> definition then add the field then copy all the features to a new
> shapefile... Does seem a bit cumbersome though... is there a better  
> way
> people can think of?
>
> will
>
> Frank Warmerdam wrote:
>> Will Cadell wrote:
>>> hi guys... am i just stupid or is there another way to add a  
>>> field to a
>>> shapefile other than:
>>>        ds = ogr.open("c:\shapefile.shp", True)
>>>        new_field = ogr.FieldDefn()
>>>     new_field.SetName(new_field_name)
>>>     new_field.SetType(new_field_type)
>>>     new_field.SetWidth(new_field_width)
>>>        layer = ds.GetLayer(0)
>>>     layer.CreateField(new_field)
>>>        ds.destroy
>>>
>>> because this doesn't work for me...
>>
>> Will,
>>
>> This does seem like the correct approach.  Are there any features  
>> in the
>> shapefile already?  I'm pretty sure that adding a field only works  
>> when
>> there are no features yet.  If you aren't getting an error message  
>> then
>> there is a clear bug here, and a bug report in bugzilla would be
>> appreciated.
>>
>> Best regards,
>
> -- 
> Will Cadell
> Remote Sensing and GIS Analyst
>
>    /\/\
>   /  \ \
>  /  Timberline
> /   Forest Inventory Consultants
>
> tel:(250) 562 2628       address: 1579 9th Ave,
> skype: geo_will                   Prince George,
> loc: 53.9135N, 122.7544W          BC, Canada
>
> www.timberline.ca
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Tue Sep 19 13:10:26 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158167160.3081.270844271@webmail.messagingengine.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
Message-ID: <45102482.6040504@loskot.net>

Simon Perkins wrote:
> 
> THE ISSUE
> 
> On windows / visual studio, we currently build GDAL using nmake.

Generally, GDAL uses makefile-based building system.
It does not only apply to Windows, but also to Unixes,
even if nmake uses different makefiles format than GNU make on Unix.

> However, particularly with the arrival of Visual Studio 2005, this 
> solution is starting to look a little antiquated.

Sorry, I can't see any special relation between arrival of the VS 2005
and nmake. Both are different tools. AFAIK VS 2005 is not supposed to
replace nmake, as previous VS versions wasn't as well.
As I understand, the issue is about *adding* VS 2005 support but not
with replacing nmake with VS 2005.

> In particular, the introduction of manifests and tighter coupling to 
> DLL versions has made it a little harder to build GDAL and have it 
> work smoothly with other Visual Studio projects. Problems with not 
> having the manifests embedded, and clashes between debug and 
> non-debug libraries seem to have greatly increased under VS 2005.

It is possible to embed a manifest into the final binary when
building with nmake too.
See:
http://msdn2.microsoft.com/en-us/library/ms235591.aspx

Certainly, in order to officially support manifest embedding when
building with VC++ 8.0 compiler, GDAL makefiles need some changes.

What you mean as a "DLL versions" expression?

> PROPOSED SOLUTION
> 
> Create VS 2005 project files, in parallel to the existing nmake 
> files, that allow GDAL to be built within the VS IDE.

IMHO, the overall idea is great, but I also see hassle of the project
files maintenance.

> This should simplify development of GDAL itself under windows by 
> providing easy access to the VS debugger, editor and so forth,

Yes.

> plus it makes it easy for us to create modern compliant GDAL DLLs and
>  executables with embedded manifests.

This issue may be easily solved without VS 2005.
So, I'd say it's not depending on VS 2005 usage.

> In addition, applications that use GDAL that are built using visual 
> studio can link to GDAL simply by referencing the GDAL project files,
>  which should clean up a lot of problems with DLL versions etc.

Sorry, but I can't see how this solves the DLL hell problems.
You're still required to keep DLLs together with your executable,
inside common directory, if there are any other GDAL versions
existing in the system, ie. in c:\window folder.

> Finally, the VS debugger will be able to smoothly step from the 
> application into the GDAL source code, simplifying debugging under 
> VS.

That's right.

> PROPOSED IMPLEMENTATION
> 
> The Visual Studio IDE requires that each individual DLL, executable 
> etc, be treated as a separate "Project" within a larger "Solution". 
> The .vcproj files defining individual projects have to live in their 
> own sub-directories - you cannot have more than one .vcproj file in 
> the same directory (or at least, I haven't found an easy way of doing
>  this).

You can have more than one .vcproj files in the same directory.
The VS is a bit dumb and does not allow you to create it that
way, but you have a liberty to edit .vcproj/.sln files to fix
this issue.

> The source code does not have to be in the same directory as the 
> .vcproj files. [...]

That's good.
I'd suggest to keep VS project/solution files outside the source tree
to not to mess the source tree with VS intermediate and other stuff
that's not cleaned when you click Build -> Clean (like, build log, ncb,
suo, and other files).

My suggestion is to have 'build' directory or 'msvc80' and keep all
project files and solution in there, all together or structured in
some subdirs. For example:

<gdal>\msvc80\gdal.sln
<gdal>\msvc80\frmts\<library>\<library>.vcproj
<gdal>\msvc80\ogr\ogr.vcproj
<gdal>\msvc80\ogrsf_frmts\<library>\<library>.vcproj
.etc.

where
<gdal> is a root directory of the GDAL sources
<library> is a placeholder for library name, a driver

> Given this structure it would be awkward to fit the VS project files 
> in the same directories as the existing source code and makefiles. 
> Instead, it would probably make more sense to create a separate 
> hierarchy of VS project files that cross references to the GDAL 
> source code. So, we would create a top level directory with gdal, 
> called something like gdal/visual_studio, and then create separate 
> project subdirectories under that for each executable and DLL that we
>  want to build. Those project files would then refer across to source
>  code in other GDAL directories. We would set things up so that 
> relative paths were used.

Exactly, that's what I'm talking about a few lines above. Great.
One note, the AFAIK we're going to use Visual C++ only,
so visual_studio name may seem to verbose.

> One issue is how to handle configuration related activites. 
> Currently, GDAL is configured for Visual Studio through manual 
> editing of the nmake.opt file. This both determines what optional 
> components get built, and where the external libraries and header 
> files that GDAL needs can be found. VS supports a degree of user 
> configurability, but we would have to look carefully at how this 
> could be made to work with project files In particular, we need to 
> try to separate congifuration files that are going to be different 
> for every user, and the common build files that users will want to 
> update from CVS.

I'd suggest to use Visual Studio Property Sheet which can be edited
using Property Manager.
Then all project files can inherit from common property sheet.
I've tested this approach when developing Visual C++ project files for
SOCI library project and it works well.
You can define all paths and predefine macros/env variables
that user can be asked to fill with value.
For example, PROJ4_DIR and user will need to fill it with appropriate path.

Another option is to use command line, provide .bat script to set all
environment and then build.bat which will build GDAL calling VS from
command line (see FDO build system, http://fdo.osgeo.org/)
But as I understand it's not the case here.

> So, what d'yall think? Is it necessary? Would it be useful? Any ideas
>  about this could be implemented most effectively? Anyone done any 
> work on this already that they want to share? I would be happy to 
> take a first stab at this. Should this be written up as an official 
> RFC? How do I do that?

Personally, instead of playing VS project files and solution,
I'd try to see if cmake may be helpful here.
cmake uses CMakeLists.txt files (something like makefile) and then
generates Visual Studio project files on Windows and Makefile files for
GNU make on Unix.
See: http://www.cmake.org

Theoretically (I've not used it on Windows yet), cmake would be a
solution to keep portable meta-build system that can use native build
systems for particular platform: Visual Studio on Windows and GNU make
on Unix.
The build system maintenance would be much more easier: "maintain once
and support two".
Recently, one user posted cmake config for GEOS on the GEOS' list.
I played with it a bit and it seems to be very nice, clean and easy to
maintain and powerful.

http://geos.refractions.net/pipermail/geos-devel/2006-September/002552.html
http://geos.refractions.net/pipermail/geos-devel/2006-September/002553.html

So, may be cmake is worth to look at.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From mateusz at loskot.net  Tue Sep 19 13:22:38 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL-Building
In-Reply-To: <20060919150324.70150.qmail@web52210.mail.yahoo.com>
References: <20060919150324.70150.qmail@web52210.mail.yahoo.com>
Message-ID: <4510275E.4090405@loskot.net>

kiruba nantham wrote:
>     i am building gdal-1.3.2 using embedded VC++ 4.0 

Hi,

Why are you using eVC++ ?
Are you trying to use GDAL on Windows CE ?

If you are, have you read this?
http://www.gdal.org/wince.html

Unfortunately, it's *not* possible to build many of portable (between
Windows desktop and Unix) libraries using for Windows CE because
Windows CE does not support POSIX and its C library is very very limited.

You have two options:
1. Port a library similarly as I ported GDAL/OGR with writing
some C library extension like this:
http://sourceforge.net/projects/wcelibcex
Note, the WinCE port does not support rasters yet!

2. Buy commercial version of C library for Windows CE from Dinkumware
http://www.dinkumware.com


> when i am compiling
> it i am getting 95 errors (error is : can not open include file: '
> errno.h ' : no such file or directory). what directory i should include
> for this errno.h?

There is no errno.h in CRT on Windows CE.

Have you seen this:
http://msdn.microsoft.com/library/en-us/wcecrt/htm/_wcecrt_microsoft_c_run_time_library_for_windows_ce.asp

"The Microsoft C Run-Time Library for Windows CE supports a subset of
the functions that are available in the full Microsoft C Run-Time
Library for the desktop"

I provide thread-unsafe version of errno.h in my WCELIBCEX library:
http://sourceforge.net/projects/wcelibcex

>     otherwise if any one knows how to build gdal13.dll using cygwin 
> please tell me how to do? i tried with cygwin it's creating
> library(libgdal.a)  but it is not creating gdal13.dll.
> 
>     if any one knows how to solve this problems please tell me because i
> got struct up with this problems.

Excuse me, but I don't understand.
Why you're using eVC++ 4.0 (eMbedded Visual C++ 4.0) when you want to
use Cygwin?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 13:27:30 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Default Settings when Compiling GDAL
In-Reply-To: <20060916161622.GA2431@www.gisnet.com>
References: <20060916161622.GA2431@www.gisnet.com>
Message-ID: <45102882.4010502@loskot.net>

Bill Thoen wrote:
> If I compile the GDAL package using just the defaults, is support for
> postgres one of the defaults or do I need to add the --with-pg option?

AFAIK yes.
If you run only ./configure without any PostgreSQL related options,
the ./configure script will *try* to detect it and if found,
it will turn the PG support on.

> How do I tell which options are set "on" by default?

You can always try-and-see :-)
Some of default values of options are listed after you run:
./configure --help

I don't know any better way.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 13:36:45 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158179717.714.270863590@webmail.messagingengine.com>
References: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
	<1158179717.714.270863590@webmail.messagingengine.com>
Message-ID: <45102AAD.4070901@loskot.net>

Simon Perkins wrote:
> On Wed, 13 Sep 2006 19:18:36 +0100, "Roger James"
> 
>> Both Ben Discoe and I have done work on this. This has been 
>> mentioned on this list occasionally in the past.
>> 
>> Ben's files are available for download the "Virtual Terrain 
>> Project" site. http://vterrain.org/dist/gdal132_vc71.zip
>> 
>> I have some slightly updated versions of these files that you are 
>> welcome to have if you want them.
>> 
>> I am not sure how many people are using VS 2005 yet. But VC7.1 
>> (2003) is probably a good starting format.
> 
> I have to say that I'm personally really only interested in the VS 
> 2005 project files.

Simon,

Visual Studio 2002/2003 projects can be easily imported and
converted to VS 2005.

> VS 2005 also seems to be the point at which nmake starts to break 
> down due to manifest issues and so forth.

No, that's not true.
As I wrote in my previous response, you can easily embed manifest when
building with nmake:

http://msdn2.microsoft.com/en-us/library/ms235591.aspx

nmake is a very important and widely used tool, so you can safely expect
that it will be supported by new release of VS in future.

> One idea is to have both 2003 and 2005 project files within the GDAL
>  source tree, e.g. in gdal/visual_studio/2003 and  gdal/visual_studio/2005.

Since, GDAL uses Visual C++ compiler, I'd vote on following proposal,
differentiating compiler versions and with short dir names :-)

<gdal>\msvc70 - VC++ 2002
<gdal>\msvc71 - VC++ 2003
<gdal>\msvc80 - VC++ 2005

> An objection might be that this might pose 
> issues with keeping both sets of build files up to date, but if there
>  are going to be project files for both 2003 and 2005 floating around
>  anyway for different users, why not have them in the official source
>  tree?

I think maintenance of these files will be a hassle.
May be it would be a good idea to write a script for adding new source
code files into project files automatically:
1. Scan subproject source tree
2. Find new file
3. Add it to the .vcproj (XML file in fact)

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 13:38:51 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158180206.1492.270865181@webmail.messagingengine.com>
References: <000b01c6d761$0827bf60$fd0ba8c0@lancaster.beardandsandals.co.uk>
	<1158180206.1492.270865181@webmail.messagingengine.com>
Message-ID: <45102B2B.4070106@loskot.net>

Simon Perkins wrote:
> On Wed, 13 Sep 2006 19:18:36 +0100, "Roger James"
> 
>> I am not sure how many people are using VS 2005 yet. But VC7.1 (2003) is
>> probably a good starting format.
> 
> Hey, it's only almost 2007... :)
> 
> Incidentally, just in case any windows developers out there aren't aware
> of this, Microsoft have decided to make the express editions of Visual
> Studio 2005 free on a permanent basis (originally it was just going to
> be for a year but they changed their minds). The express editions seem
> to have virtually everything in them that the solo developer needs,
> including the same optimizing compilers that are available in all the
> other versions. The IDE is actually pretty cool once you get into it.

For Visual C++ 2003 users, there is also a free
version of Visual C++ 7.1 compiler:

http://msdn.microsoft.com/visualc/vctoolkit2003/

though, without any IDE.
In fact, the VC++ Toolkit has been replaced with VC++ 2005 EE.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 13:45:04 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <20060914094739.GA3884@ak4719.spb.edu>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<20060914094739.GA3884@ak4719.spb.edu>
Message-ID: <45102CA0.7020203@loskot.net>

Andrey Kiselev wrote:
> On Wed, Sep 13, 2006 at 11:06:00AM -0600, Simon Perkins wrote:
>> PROPOSED IMPLEMENTATION
>>
>> The Visual Studio IDE requires that each individual DLL, executable etc,
>> be treated as a separate "Project" within a larger "Solution". The
>> .vcproj files defining individual projects have to live in their own
>> sub-directories - you cannot have more than one .vcproj file in the same
>> directory (or at least, I haven't found an easy way of doing this). The
>> source code does not have to be in the same directory as the .vcproj
>> files.  The acutal executables, libraries, etc are built in Debug and
>> Release sub-directories of the .vcproj directories. Note that other VS
>> applications that depend on GDAL do not have to know about this level of
>> detail - they simply reference the .vcproj file.
> 
> Simon,
> 
> That all looks pretty complicated to maintain. Is there a way to include
> in project files the list of file paths and include parameters like it
> is done in the current makefiles?

The only way is to use Visual Studio Property Sheet that can be
inherited/overriden.

> Otherwise it gets too complicated even to 
> add a single new file to the project. If we will found a way to keep the
> file lists and configuration parameters separate from the project files
> there will be no problem to add them to GDAL. Without such separation

In fact, Visual Studio is strongly oriented on project structure made as
project1\project1.vcproj
project1\file.cpp
project1\file.h
...

And if one want to separate sources from project files in some more
sophisticated way, it's a real pain in the ass.
I hardly remember a project where I shouldn't edit VS project files
manually to keep my own project layout of choice and avoid the VS-like
structure.

For example, if I wanted to have relative paths in my project files, like

..\..\subproject1\file.cpp

then I have to edit .vcproj file manually, because Visual Studio does
not provide any option to check that would tell VS to use relative paths.
Or may be I've missed something and I'm a lame VS user :-)

That's why I'd suggest to take a look at the cmake as a solution for
such annoyances.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 14:13:16 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] ogr2ogr creating shapefile
In-Reply-To: <eeb5da$11sg$1@osprey.mgras.de>
References: <001e01c6d6a1$3cb12980$0d5aa8c0@devfrances>
	<eeb5da$11sg$1@osprey.mgras.de>
Message-ID: <4510333C.9070805@loskot.net>

Martin Spott wrote:
> "Frances Collier" wrote:
>> Hello all,
> 
>> I initially posted this on the postgis mailing list but was 
>> informed that it was better suited for this list. So, below is the
>>  problem I've been having. I'll greatly appreciate any help I can 
>> get. Thank you -Frances
> 
>> I have been trying to figure out how to create a shapefile using 
>> ogr2ogr.
> 
> I can confirm getting a segmentation fault unter Linux/ia32 with 
> 'ogr2ogr' from gdal-1.3.2:
> 
> foxtrot: 10:42:53 ~> /opt/GRASS/bin/ogr2ogr -f "ESRI Shapefile" \ 
> ./mangrove.shp PG:'host=localhost user=martin dbname=landcover' \ 
> -sql "SELECT wkb_geometry from mangrove" Segmentation fault
> 
> Running a binary compiled for x86_64 on the same machine reveals a 
> different error message:
> 
> ERROR 2: CPLRealloc(): Out of memory allocating 85052352 bytes. Abort
> 
> 
> 
Frances, Martin,

IMHO, your SQL queries are non-standard queries and geometry returned
from the database is likely in so called "internal format".
So, if use with MySQL, your SQL statement
"SELECT wkb_geometry from mangrove"
will return data in internal format used in MySQL.
If used with PostGIS, it will return data in internal format
used by PostGIS.

There is a bug on the GDAL bugzilla about it.
If you're interested, please see comments posted to the Bug 1230.
Here is my longer explanation:
http://bugzilla.remotesensing.org/show_bug.cgi?id=1230#c17

MySQL documentation suggests something similar I'm trying to tell
in comments:
http://dev.mysql.com/doc/refman/5.1/en/fetching-spatial-data.html

The OGC SFS for SQL specification seems to be not exact in this matter.
It only says:

AsText( ):String ?Exports this Geometry to a specific well-known text
representation of Geometry.

AsBinary( ):Binary?Exports this Geometry to a specific well-known binary
representation of Geometry.

So, according to my understanding, in order to get data in OGC-compliant
format, you need to use AsBinary or AsText, otherwise you may get a
"garbage" - internal format.

PostgreSQL/PostGIS uses EWKB/EWKT, extended versions of WKB and WKT,
that's why OGR throws segmentation fault.
If you use CVS version of OGR, no segfaults will be thrown
and you will not get any geometries according to simple but not genuine
rule: garbage in, garbage out.
EWKB, as a non-standard format, is considered as a garbage.

Yes, this is not a very convenient solution, but we don't see any better
at the moment. Unfortunately, it's not very easy to detect if
OGR gets EWKB or WKB, becasause EWKB injects some additional fields
inside the standard WKB stream.


So, please, try to use following SQL statement:
SELECT AsText(wkb_geometry) from mangrove

or if you need WKB binary stream:
SELECT AsBinary(wkb_geometry) from mangrove

and it should work well.


Personally, as I'm a kind of standards purist ;-), I'd use AsText and
AsBinary, otherwise I'd consider the SQL as a not OGC-compliant, so not
portable


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Tue Sep 19 14:20:02 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL-Building
In-Reply-To: <20060919150324.70150.qmail@web52210.mail.yahoo.com>
References: <20060919150324.70150.qmail@web52210.mail.yahoo.com>
Message-ID: <451034D2.3080508@pobox.com>

kiruba nantham wrote:
>     i am building gdal-1.3.2 using embedded VC++ 4.0 when i am compiling 
> it i am getting 95 errors (error is : can not open include file: ' 
> errno.h ' : no such file or directory). what directory i should include 
> for this errno.h?

Kiruba,

VC++ 4.0?  Whew, that seems pretty ancient.  I think VC6 would be the
oldest MS compiler likely to work.

>     otherwise if any one knows how to build gdal13.dll using cygwin  
> please tell me how to do? i tried with cygwin it's creating 
> library(libgdal.a)  but it is not creating gdal13.dll.

I'm not sure why you are running into problems with Cygwin.  I had thought
this was working ok.  But you do need to know that a Cygwin build of the DLL
is not generally going to work smoothly with non-Cygwin components.  It's
fine if you want an all-cygwin solution, but you can't necessarily turn around
and use that DLL for non-cygwin purposes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Sep 19 14:21:54 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Default Settings when Compiling GDAL
In-Reply-To: <20060916161622.GA2431@www.gisnet.com>
References: <20060916161622.GA2431@www.gisnet.com>
Message-ID: <45103542.70801@pobox.com>

Bill Thoen wrote:
> If I compile the GDAL package using just the defaults, is support for
> postgres one of the defaults or do I need to add the --with-pg option? How
> do I tell which options are set "on" by default?

Bill,

If you don't specify anything about postgres when configuring GDAL, it will
try to find pg_config in the path.  If it finds it, it will attempt to
configure in postgres/postgis support on the basis of it.

I wish I could say there is a way to know whether given configure options
behave this way (default to on, if some supporting item can be found) or
not, but in fact the behavior varies widely.  But you can watch the messages
during configuration and the final configure report to get an idea of which
options were activated.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Sep 19 14:21:59 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Gdal_translate and the Internal accuracy of ground
	control points
In-Reply-To: <CC197224AC75CE4DB23F739B16891B866683F7@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B866683F7@tikka.haapa.mmm.fi>
Message-ID: <45103547.6040204@pobox.com>

Rahkonen Jukka wrote:
> Hi,
> 
> I have inserted ground control points into a GeoTIFF image file with
> gdal_translate in this way: gdal_translate input.tif  output_gcp.tif -gcp 0
> 0  285113.632 6713217.584 etc.
> 
> Gdalinfo reports me about the resulting image as follows: GCP Projection =
> 
> GCP[  0]: Id=1, Info=
> 
> (0,0) -> (285114,6.71322e+006,0)
> 
> 
> 
> Are the gcp's still stored into the GeoTIFF file with the same accuracy I
> gave them, or are they rounded like gdalinfo is expressing them?

Jukka,

The GCPs are handled and stored as double precision values, so I believe
the original values would be properly preserved.  It is just the gdalinfo
report-to-screen logic which is not displaying the full precision.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Tue Sep 19 14:22:24 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Re: Problem using OGR and join-functionality: column
	names gone when creating a new shapefile?
In-Reply-To: <200609181054.28802.wolfgang.qual@gmx.net>
References: <200609131046.53725.wolfgang.qual@gmx.net>	<450BEB23.6040304@speakeasy.net>
	<200609181054.28802.wolfgang.qual@gmx.net>
Message-ID: <45103560.1020204@pobox.com>

wqual wrote:
> Hi Neil,
> thank you for your reply - and a good idea to use aliases. But first, the 
> complete ogr2ogr-command that I used before:
> ogr2ogr -f "ESRI Shapefile" testjoin5.shp ./ -sql "select 
> flurstck_test.*, flurstck_nr1.GEMARKUNG_ from flurstck_test left join 
> flurstck_nr1 on flurstck_test.OBJEKT_ID = flurstck_nr1.OBJEKT_ID"
> 
> The result was the column names as described earlier:
> flurstck_t
> flurstck_t
> flurstck_t
> flurstck_t
...

> fl.NUTZUNG
> fl.EIGENTU
> fl.ADMPLAY
> fl.FLUR_P_
> nr.GEMARKU
> 
> This result looks much better! I guess there's no way to keep the original 
> column names, but this is ok.

Wolfgang,

I see what is happening.  It is rather annoying that there is no way
to control the column renaming.  Perhaps at some point I should offer
some mechanism to either rename specific columns or to at least strip off
"dot prefix" names.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Tue Sep 19 14:30:10 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] ogr2ogr: Command not found.
In-Reply-To: <4509C7B3.30701@engr.orst.edu>
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
	<4509C7B3.30701@engr.orst.edu>
Message-ID: <45103732.5040406@loskot.net>

Ryan Ollerenshaw wrote:
> So i had to recompile gdal from the source in order to add support for
> Xerces-C but after i did this i was still getting the same error so i
> removed ogr2ogr from the /usr/local/bin/ directory and then recompiled
> gdal again but now the ogr2ogr command is not being put back into the
> /usr/local/bin/ directory.  what do i need to do in order to get the
> gdal command back in there.

After you compile GDAL from sources on Unix,
you need to install it, so run following command:

$ make install

Then, make will (re)install all libraries and executables in paths under
'prefix'. prefix is a base installation path, by default it is in
/usr/local, so libs go to /usr/local/lib, programs go to /usr/local/bin,
etc.

You can use custom prefix:


./configure --prefix=/my/custom/dir
make
make install


then you will get

/my/custom/dir/lib - libraries
/my/custom/dir/bin - programs
/my/custom/dir/share - GDAL resources, etc.

If you want to do *complete* rebuild, run "make clean" command first.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 14:45:51 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <033801c6d3fb$e1f57610$9b02a8c0@DellWork>
References: <033801c6d3fb$e1f57610$9b02a8c0@DellWork>
Message-ID: <45103ADF.9040706@loskot.net>

Ben Discoe wrote:
> Perhaps there is support for this somewhere in GDAL that i just haven't
> found yet?

The only solution I know is to use encoding-aware conversion from
Unicode to ANSI string, but it won't solve your problem
(http://www.mkssoftware.com/docs/man3/mbstowcs.3.asp).
It only will make it technically possible to pass strings between
Unicode API and ANSI-only API.

> Another option is for me to open the file first, e.g. for Windows:
> 	std::wstring fname;
> 	FILE *fp = _wfopen(fname, L"rb");
--------------------------^^^^^^^

A side note, there is no implicit conversion defined
between std::wstring and std::string
to const char* wchar_t and const char*.
You need to use fname.c_str().

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 14:50:18 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <20060911110603.GA21234@ak4719.spb.edu>
References: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>	<009f01c6d470$81309bf0$9b02a8c0@DellWork>
	<20060911110603.GA21234@ak4719.spb.edu>
Message-ID: <45103BEA.2020503@loskot.net>

Andrey Kiselev wrote:
> This problem was raised one time in the past, probably this is a time
> when we should prepare RFC for GDAL localization. This is a major
> change, this change can broke functionality, so it is painful, but
> inevitable.

If non-PSC member can answer, I'd like to second this idea.

BTW, there is a very nice generic UTF-8 manipulator which
may be helpful for GDAL too:
http://sourceforge.net/projects/utfcpp

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Tue Sep 19 14:57:28 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Calling OGRLayer member functions from MFC::OnDraw
In-Reply-To: <20060911195532.M51291@ufs.br>
References: <20060911195532.M51291@ufs.br>
Message-ID: <45103D98.1060705@loskot.net>

Ricardo wrote:
> Hi,
> 
> I'm trying to call OGRLayer member functions from MFC::OnDraw and it was 
> returning to me an Access violation reading location.
> 
> [...]
> 
> That is my source:
> ///////////////////////////////////////////////////////////////////////////
> 
> CChildView::CChildView()
> {

Hmm, it's not the OnDraw() handler, but a class constructor.

> const char *conexao = "PG:user=postgres password=postgres dbname=testegis 
> host=10.0.0.62 port=5432";
> 
> OGRRegisterAll();
> CPLPushErrorHandler( CPLQuietErrorHandler );
> 
> CPLSetConfigOption("GML_FIELDTYPES","ALWAYS_STRING");
> 
>    
>  char szPath[100] = "";
> 
> 
> char *pszDSName = NULL;
> pszDSName = CPLStrdup(conexao);
> char **papszTokens = NULL;
> papszTokens = CSLTokenizeStringComplex( conexao, ",", TRUE, FALSE );
> if( CSLCount(papszTokens) > 0 )
>       pszDSName = CPLStrdup( papszTokens[0] );
> CSLDestroy(papszTokens);
>  if( pszDSName == NULL )
>   {
>       exit( 1 );
>   }


It's really not a good idea to run exit from constructors.
The only option you have is to throw an exception from constructor.


> #ifdef USE_SHARED_ACCESS
>      poDS = OGRSFDriverRegistrar::GetRegistrar()->OpenShared( pszDSName );
> #else
>       poDS = OGRSFDriverRegistrar::Open( pszDSName );
> #endif
> 
> 
> poOGRLayer = poDS->GetLayer(13); //until here it works well.
> 


Have you checked poOGRLayer for NULL here?
Please, try to add some assertion below GetLayer() call.

> poOGRLayer->ResetReading(); // it causes a  Access violation reading location


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From jdjohnso at google.com  Tue Sep 19 15:31:42 2006
From: jdjohnso at google.com (John Johnson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] 1.3.2 build error - (linux, --without-libtool, make -j)
Message-ID: <d0b0f8b0609191231t510f7318oecce3c6b5bd00b63@mail.google.com>

When compiling on linux w/o libtool (e.g. to support kakadu), make -j is
broken.
Here's a little patch to fix it.
-------------------- cut --------------------
diff -uNr gdal-1.3.2.orig/GNUmakefile gdal-1.3.2/GNUmakefile
--- gdal-1.3.2.orig/GNUmakefile    2006-03-24 08:51:56.000000000 -0800
+++ gdal-1.3.2/GNUmakefile    2006-09-19 12:25:36.000000000 -0700
@@ -35,7 +35,7 @@
     $(AR) r $(GDAL_LIB) $(GDAL_OBJ)
     $(RANLIB) $(GDAL_LIB)

-$(GDAL_SLIB):    $(GDAL_OBJ)
+$(GDAL_SLIB):    $(GDAL_OBJ) $(GDAL_LIB)
     $(LD_SHARED) $(GDAL_SLIB_SONAME) $(GDAL_OBJ) $(GDAL_LIBS) $(LIBS) \
         -o $(GDAL_SLIB)
-------------------- cut --------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060919/6fcb8e57/attachment.html
From sy at perkins.net  Tue Sep 19 15:35:14 2006
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <45102482.6040504@loskot.net>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<45102482.6040504@loskot.net>
Message-ID: <1158694514.2443.271324930@webmail.messagingengine.com>


On Tue, 19 Sep 2006 19:10:26 +0200, "Mateusz Loskot"
<mateusz@loskot.net> said:
>> > However, particularly with the arrival of Visual Studio 2005, this 
> > solution is starting to look a little antiquated.
> 
> Sorry, I can't see any special relation between arrival of the VS 2005
> and nmake. Both are different tools. AFAIK VS 2005 is not supposed to
> replace nmake, as previous VS versions wasn't as well.
> As I understand, the issue is about *adding* VS 2005 support but not
> with replacing nmake with VS 2005.


I don't think that nmake is going to go away - too many people depend on
it. But my feeling is that it's probably not Microsoft's priority. I see
the IDE becoming more central to the build process and having to jump
through more and more hoops to make nmake work. I'll admit that this is
more of a gut feeling than anything else, but I do know that when I
recently switched a cross-platform project of mine from SCons to visual
studio project files, a lot of things became easier on windows! We
already have to maintain a set of build scripts for Visual Studio (the
makefile.vc files) that are independent from the UNIX makefiles, so my
question was whether it would be worth migrating to, or adding, an IDE
based set of script (project files).



> > In particular, the introduction of manifests and tighter coupling to 
> > DLL versions has made it a little harder to build GDAL and have it 
> > work smoothly with other Visual Studio projects. Problems with not 
> > having the manifests embedded, and clashes between debug and 
> > non-debug libraries seem to have greatly increased under VS 2005.
> 
> It is possible to embed a manifest into the final binary when
> building with nmake too.
> See:
> http://msdn2.microsoft.com/en-us/library/ms235591.aspx

OK, it's not impossible...

They seem to have improved their docs on this since I last looked as
well...


 
> What you mean as a "DLL versions" expression?

> Sorry, but I can't see how this solves the DLL hell problems.
> You're still required to keep DLLs together with your executable,
> inside common directory, if there are any other GDAL versions
> existing in the system, ie. in c:\window folder.

The main issue I'm referring to is the binding to the microsoft runtime
libraries. I've found that in building various DLLs and executables in
different ways, e.g. my application using the IDE, GDAL using nmake,
and, say, some library that GDAl depends upon using the IDE, I've seen
problems with MSVCR80.dll not found messages that I didn't see prior to
VS 2005. When other people recently started posting similar errors on
this list, I fiigured there might be a problem... It seems that there's
no longer a single MSVCR80.dll file - instead the system DLLs all have
"strong names" referenced in the embedded manifests.



> Personally, instead of playing VS project files and solution,
> I'd try to see if cmake may be helpful here.
> cmake uses CMakeLists.txt files (something like makefile) and then
> generates Visual Studio project files on Windows and Makefile files for
> GNU make on Unix.
> See: http://www.cmake.org
> 
> Theoretically (I've not used it on Windows yet), cmake would be a
> solution to keep portable meta-build system that can use native build
> systems for particular platform: Visual Studio on Windows and GNU make
> on Unix.
> The build system maintenance would be much more easier: "maintain once
> and support two".
> Recently, one user posted cmake config for GEOS on the GEOS' list.


Now THAT is a very interesting suggestion! I've used cmake as a user
before (e.g. with the VXL libraries), but have never set up scripts for
it. I was reluctant to suggest a unified cross platform build solution
after so much effort has gone into tuning the UNIX and makfile.vc files
over the years, but that could be a better solution that trying to
maintain multiple sets of Visual Studio project files in addition to the
UNIX and nmake makefiles.

Anyone here had much experience writing build scripts using cmake for
unix and windows? How is it?

I've used a different cross-platform system, SCons, in the past, but
I've found that it's still necessary to do a lot of special hacking for
windows and linux, plus SCons does not create native build scripts for
different platforms - it insists on being in control itself during every
build. I've concluded that this is perhap not the best plan. Maybe I'll
take a look at cmake then...


Cheers,

Sy




From neteler at itc.it  Tue Sep 19 16:28:09 2006
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] gdal 1.3.0 install
In-Reply-To: <45101BAC.5020905@pobox.com>
References: <450C669E.9060608@gisnet.com> <450EC192.2040908@mapgears.com>
	<450EC3B2.5050703@gisnet.com> <450EDB4D.3050207@engr.orst.edu>
	<450EE05A.9070904@engr.orst.edu> <45101BAC.5020905@pobox.com>
Message-ID: <20060919202809.GG26248@bartok.itc.it>

On Tue, Sep 19, 2006 at 12:32:44PM -0400, Frank Warmerdam wrote:
> Ryan Ollerenshaw wrote:
> >I have tried gdal-1.3.1 and got the same error
> >
> >With gdal-1.3.2 i get the following error:
> >
> >make[2]: Entering directory `/root/gdal-1.3.2/frmts/grass'
> >/bin/sh /root/gdal-1.3.2/libtool --mode=compile g++ -Wall  -O2    
> >-I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore -I/root/gdal-1.3.2/alg 
> >-I/root/gdal-1.3.2/ogr -I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED 
> >-I/root/gdal-1.3.2/port  -c -o ../o/grassdataset.o grassdataset.cpp
> >g++ -Wall -O2 -I/root/gdal-1.3.2/port -I/root/gdal-1.3.2/gcore 
> >-I/root/gdal-1.3.2/alg -I/root/gdal-1.3.2/ogr 
> >-I/root/gdal-1.3.2/ogr/ogrsf_frmts -DOGR_ENABLED -I/root/gdal-1.3.2/port 
> >-c grassdataset.cpp  -fPIC -DPIC -o ../o/.libs/grassdataset.o
> >grassdataset.cpp:84:22: error: libgrass.h: No such file or directory
> >grassdataset.cpp: In constructor 
> 
> 
> Ryan,
> 
> There is no sign in the above compile line that the GRASS include files
> are being indicated properly.  If GRASS support is not important, I
> would suggest you re-configure --without-grass.  If GRASS support is
> important, then we need to track through the configure logic related
> to GRASS and I would need to know what grass related configure options
> you used.
>

Hi,

GDAL 1.3.2 needs to be linked to a recent GRASS, otherwise the
include files may not be found (we changed to <grass/gis.h> etc).
Not sure if this info is related to the problem here.

Markus 

From warmerdam at pobox.com  Tue Sep 19 16:32:59 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] 1.3.2 build error - (linux, --without-libtool, make -j)
In-Reply-To: <d0b0f8b0609191231t510f7318oecce3c6b5bd00b63@mail.google.com>
References: <d0b0f8b0609191231t510f7318oecce3c6b5bd00b63@mail.google.com>
Message-ID: <451053FB.2070007@pobox.com>

John Johnson wrote:
> When compiling on linux w/o libtool (e.g. to support kakadu), make -j is 
> broken.
> Here's a little patch to fix it.
> -------------------- cut --------------------
> diff -uNr gdal-1.3.2.orig/GNUmakefile gdal-1.3.2/GNUmakefile
> --- gdal-1.3.2.orig/GNUmakefile    2006-03-24 08:51:56.000000000 -0800
> +++ gdal-1.3.2/GNUmakefile    2006-09-19 12:25:36.000000000 -0700
> @@ -35,7 +35,7 @@
>      $(AR) r $(GDAL_LIB) $(GDAL_OBJ)
>      $(RANLIB) $(GDAL_LIB)
>  
> -$(GDAL_SLIB):    $(GDAL_OBJ)
> +$(GDAL_SLIB):    $(GDAL_OBJ) $(GDAL_LIB)
>      $(LD_SHARED) $(GDAL_SLIB_SONAME) $(GDAL_OBJ) $(GDAL_LIBS) $(LIBS) \
>          -o $(GDAL_SLIB)
> -------------------- cut --------------------

John,

Patch applied.

Thanks!

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Tue Sep 19 17:31:03 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158694514.2443.271324930@webmail.messagingengine.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<45102482.6040504@loskot.net>
	<1158694514.2443.271324930@webmail.messagingengine.com>
Message-ID: <45106197.3000408@loskot.net>

Simon Perkins wrote:
> On Tue, 19 Sep 2006 19:10:26 +0200, "Mateusz Loskot" 
> <mateusz@loskot.net> said:
>>>> However, particularly with the arrival of Visual Studio 2005,
>>>> this
>>> solution is starting to look a little antiquated.
>> Sorry, I can't see any special relation between arrival of the VS
>> 2005 and nmake. Both are different tools. AFAIK VS 2005 is not
>> supposed to replace nmake, as previous VS versions wasn't as well. 
>> As I understand, the issue is about *adding* VS 2005 support but
>> not with replacing nmake with VS 2005.
> 
> 
> [...] so my question was whether it would be worth migrating to, or
> adding, an IDE based set of script (project files).

MIHO, it's worth, if there are users interested to keep project
files up to date.


>> What you mean as a "DLL versions" expression?
> 
>> Sorry, but I can't see how this solves the DLL hell problems. 
>> You're still required to keep DLLs together with your executable, 
>> inside common directory, if there are any other GDAL versions 
>> existing in the system, ie. in c:\window folder.
> 
> The main issue I'm referring to is the binding to the microsoft
> runtime libraries. I've found that in building various DLLs and
> executables in different ways, e.g. my application using the IDE,
> GDAL using nmake, and, say, some library that GDAl depends upon using
> the IDE,

There should be no differences between DLLs when building programs using
Visual C++ run from command line or from IDE. In both cases the same
compiler and SDK is used.

> I've seen problems with MSVCR80.dll not found messages that I didn't
> see prior to VS 2005. When other people recently started posting
> similar errors on this list, I fiigured there might be a problem...
> It seems that there's no longer a single MSVCR80.dll file - instead
> the system DLLs all have "strong names" referenced in the embedded
> manifests.

Not exactly.
There is the single file of this DLL but the problem was likely on the
GDAL side.
The MSVCR80.dll could not be found by GDAL because GDAL is not build
with the manifest, embedded or as an external file.
Simply, the "MSVCR80.dll not found" issue is usually caused by following
reasons:
1. msvcr80.dll library is not present in the system -> this is a bug VC++
2. exe/dll has not been compiled with manifest support


>> Personally, instead of playing VS project files and solution, I'd
>> try to see if cmake may be helpful here. cmake uses CMakeLists.txt
>> files (something like makefile) and then generates Visual Studio
>> project files on Windows and Makefile files for GNU make on Unix. 
>> See: http://www.cmake.org
>> 
>> Theoretically (I've not used it on Windows yet), cmake would be a 
>> solution to keep portable meta-build system that can use native
>> build systems for particular platform: Visual Studio on Windows and
>> GNU make on Unix. The build system maintenance would be much more
>> easier: "maintain once and support two". Recently, one user posted
>> cmake config for GEOS on the GEOS' list.
> 
> 
> Now THAT is a very interesting suggestion! I've used cmake as a user 
> before (e.g. with the VXL libraries), but have never set up scripts
> for it. I was reluctant to suggest a unified cross platform build
> solution after so much effort has gone into tuning the UNIX and
> makfile.vc files over the years, but that could be a better solution
> that trying to maintain multiple sets of Visual Studio project files
> in addition to the UNIX and nmake makefiles.
> 
> Anyone here had much experience writing build scripts using cmake for
>  unix and windows? How is it?

I wrote a few small cmake scripts for testing purpose only
and I like it.
I think someone from the KDE dev team should be able to tell you more
about some experiences because KDE has switched to cmake already:
http://lwn.net/Articles/188693/

> I've used a different cross-platform system, SCons, in the past, but 
> I've found that it's still necessary to do a lot of special hacking
> for windows and linux, plus SCons does not create native build
> scripts for different platforms - it insists on being in control
> itself during every build. I've concluded that this is perhap not the
> best plan. Maybe I'll take a look at cmake then...

Another powerful option is Jam used by Boost libraries and it supports
rich set of toolsets, but does not support VS projects/solutions
generation. I only mention it if you're curious.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ben at vterrain.org  Tue Sep 19 17:33:40 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <20060911110603.GA21234@ak4719.spb.edu>
Message-ID: <00bd01c6dc33$46789bf0$9b02a8c0@DellWork>

> -----
> From:Andrey Kiselev
> Sent: Monday, September 11, 2006 1:06 AM
> 
> I think the simplest way to add multibyte support to GDAL is 
> using UTF-8 as an internal character set. All strings and 
> filenames should be passed in UTF-8 encoding and properly 
> converted to UCS-16 when needed (_wopen on Windows).

I agree this seems like a workable solution.

> The major drawback of this change is additional
> requirement: we will need an Unicode library to replace all 
> string handling functions from the C lib with the Unicode aware ones.

Not necessarily.  This really only affects filepath/filename strings.  Since
UTF-8 and ASCII are identical over the range of ASCII, and string subsets
which GDAL could conceivably need to manipulate such as file extentions
("*.tif") are ASCII, nothing breaks by declaring that all filenames passed
to GDAL must be UTF-8.

I have found this to be true with the entire VTP software, which sits above
GDAL.  It now uses UTF-8 internally for all filesystem strings, and has not
encountered the need for any special Unicode library.

> This problem was raised one time in the past, probably this 
> is a time when we should prepare RFC for GDAL localization. 
> This is a major change, this change can broke functionality, 
> so it is painful, but inevitable.

I suspect is not so major.  I'm willing to tackle the task, if Frank et al.
are interested.

-Ben


From ben at vterrain.org  Tue Sep 19 17:47:22 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <45103ADF.9040706@loskot.net>
Message-ID: <00c401c6dc35$30992c80$9b02a8c0@DellWork>

> -----
> From: Mateusz Loskot
> Sent: Tuesday, September 19, 2006 8:46 AM
> 
> Ben Discoe wrote:
> > Another option is for me to open the file first, e.g. for Windows:
> > 	std::wstring fname;
> > 	FILE *fp = _wfopen(fname, L"rb");
> --------------------------^^^^^^^
> 
> A side note, there is no implicit conversion defined
> You need to use fname.c_str().

You are correct, sorry i left that out.  The code would be like this:

FILE *GDALFileOpen(const char *fname_utf8, const char *mode)
{
#if WIN32	// Windows
	wstring2 fn, mo(mode);
	fn.from_utf8(fname_utf8);
	return _wfopen(fn.c_str(), mo.c_str());
#elif __DARWIN_OSX__	// Mac OS X
	return fopen(fname_utf8, mode);
#else	// some other Unix flavor
	wstring2 fn, mo(mode);
	fn.from_utf8(fname_utf8);
	return fopen(fn.mb_str(), mode);
#endif
}

This is using the small "wstring2" class which is just std::wstring plus
methods for converting to and from utf-8 and mbs.

The problem i have _not_ solved is what to do on Windows with code which
uses std::ifstream() instead of fopen().  MSDN documents that there is a
(wchar_t*) version of std::ifstream() constructor
(http://msdn2.microsoft.com/en-us/library/zek0beca.aspx), but it does not
appear in the headers/libs that come with MSVC 7.1.  Fortunately this should
not affect GDAL, since AFAIK it does a good job of avoiding the C++ stream
classes. (Correct?)

-Ben


From mateusz at loskot.net  Tue Sep 19 18:37:40 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <00c401c6dc35$30992c80$9b02a8c0@DellWork>
References: <00c401c6dc35$30992c80$9b02a8c0@DellWork>
Message-ID: <45107134.6040408@loskot.net>

Ben Discoe wrote:
>> -----
>> From: Mateusz Loskot
>> Sent: Tuesday, September 19, 2006 8:46 AM
>>
>> Ben Discoe wrote:
>>> Another option is for me to open the file first, e.g. for Windows:
>>> 	std::wstring fname;
>>> 	FILE *fp = _wfopen(fname, L"rb");
>> --------------------------^^^^^^^
>>
>> A side note, there is no implicit conversion defined
>> You need to use fname.c_str().
> 
> You are correct, sorry i left that out.  The code would be like this:
> 
> FILE *GDALFileOpen(const char *fname_utf8, const char *mode)
> {
> #if WIN32	// Windows
> 	wstring2 fn, mo(mode);
> 	fn.from_utf8(fname_utf8);
> 	return _wfopen(fn.c_str(), mo.c_str());
> #elif __DARWIN_OSX__	// Mac OS X
> 	return fopen(fname_utf8, mode);
> #else	// some other Unix flavor
> 	wstring2 fn, mo(mode);
> 	fn.from_utf8(fname_utf8);
> 	return fopen(fn.mb_str(), mode);
> #endif
> }
> 
> This is using the small "wstring2" class which is just std::wstring plus
> methods for converting to and from utf-8 and mbs.
> 
> The problem i have _not_ solved is what to do on Windows with code which
> uses std::ifstream() instead of fopen().

std::ifstream is a type from the C++ library but fopen() is a function
from the C library.
I'm not sure I understand what's here to be solved and what you mean
"Windows with code which uses".

Simply, you have to decide if you use streams or file descriptor, both
are different approaches used in different languages (C/C++) and are
based on different libraries (C/C++).

> MSDN documents that there is a
> (wchar_t*) version of std::ifstream() constructor
> (http://msdn2.microsoft.com/en-us/library/zek0beca.aspx),

Simply, there are two specializations of basic_ifstream,
one for char -> ifsteram and one for wchar_t -> wifstream.
The idea is the same as behind two specializations of basic_string:
string and wstring.

ifstream and wifstream are typedefs of the basic_ifstream specializations:

typedef basic_ifstream<char> ifstream;
typedef basic_ifstream<wchar_t> wifstream;

> but it does not
> appear in the headers/libs that come with MSVC 7.1.

AFAIR there is <fstream> header in C++ library provided with
Visual C++ 7.1 compiler.
Streams are available with all C++ standard compliant compilers,
Visual C++ 7.1 is considered as the first ISO C++ compliant version.
So, it should work perfectly.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Tue Sep 19 20:43:40 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158167160.3081.270844271@webmail.messagingengine.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
Message-ID: <45108EBC.8060501@pobox.com>

Simon Perkins wrote:
> Hi,
> 
> Matt Hanson and I had a thread going in which the subject of Visual
> Studio Project files came up. I didn't get any comments on that and
> figured the details might have been lost in the noise, so here's a
> second attempt to elicit some feedback...
...
> So, what d'yall think? Is it necessary? Would it be useful? Any ideas
> about this could be implemented most effectively? Anyone done any work
> on this already that they want to share? I would be happy to take a
> first stab at this. Should this be written up as an official RFC? How do
> I do that?

Sy,

I haven't run into any compelling problems with the NMAKE based build
approach myself.  As Mateusz points out, we can adjust things to embed
the manifests if that is important.

However, if there are folks who understand project files well, and are
willing to maintain them, then I would not be opposed to them being
available as a parallel build mechanism.  I, unfortunately, do not
understand them well, and am not really keen on being responsible
for their development or maintenance.

I would suggest that a formal RFC be brought forward to the GDAL PSC
before project files (or cmake based builds) are introduced into the
existing tree.

Incidentally, if something like this is approached, it might be reasonable
to integrate it with the project files for wince in the gdal\wince directory.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ben at vterrain.org  Wed Sep 20 02:13:54 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <45107134.6040408@loskot.net>
Message-ID: <014801c6dc7b$f34e7050$9b02a8c0@DellWork>

Mateusz,

> -----
> From: Mateusz Loskot
> Sent: Tuesday, September 19, 2006 12:38 PM
> 
> > The problem i have _not_ solved is what to do on Windows with code 
> > which uses std::ifstream() instead of fopen().
> 
> std::ifstream is a type from the C++ library but fopen() is a 
> function from the C library.
> I'm not sure I understand what's here to be solved

What's here to be solved is GDAL's source.  If it only calls fopen(), then
it can be replaced with the function i described.  If GDAL also uses the C++
stream classes for file IO (which i hope it does not), then there exists the
problem i described.

> Simply, you have to decide if you use streams or file 
> descriptor, both are different approaches used in different 
> languages (C/C++) and are based on different libraries (C/C++).

Obviously.  But like many large projects, GDAL is both C and C++, and uses
both standard libraries.

> > MSDN documents that there is a
> > (wchar_t*) version of std::ifstream() constructor 
> > (http://msdn2.microsoft.com/en-us/library/zek0beca.aspx),
> 
> Simply, there are two specializations of basic_ifstream, one 
> for char -> ifstream and one for wchar_t -> wifstream.

There may be, but that's irrelevant.  I said two _constructors_, not two
template instances.  If that MSDN link works for you, you can see that
std::ifstream<char> has two constructors, one which takes a char*filename,
and one which takes a wchar_t*filename.  This is totally independent of the
base type of the template, which has to do with the data read from the
stream, not the charset of the filename used to construct it.

As i mentioned, the MSDN documentation has those two constructors, but the
headers and library that come with MSVC 7.1 do not have both.

> AFAIR there is <fstream> header in C++ library provided with 
> Visual C++ 7.1 compiler.

Yes, but the constructor does not take a wchar_t*filename.

-Ben


From dron at ak4719.spb.edu  Wed Sep 20 05:04:52 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <00bd01c6dc33$46789bf0$9b02a8c0@DellWork>
References: <20060911110603.GA21234@ak4719.spb.edu>
	<00bd01c6dc33$46789bf0$9b02a8c0@DellWork>
Message-ID: <20060920090452.GA16617@ak4719.spb.edu>

On Tue, Sep 19, 2006 at 11:33:40AM -1000, Ben Discoe wrote:
> > The major drawback of this change is additional requirement: we will
> > need an Unicode library to replace all string handling functions
> > from the C lib with the Unicode aware ones.
> 
> Not necessarily.  This really only affects filepath/filename strings.
> Since UTF-8 and ASCII are identical over the range of ASCII, and
> string subsets which GDAL could conceivably need to manipulate such as
> file extentions ("*.tif") are ASCII, nothing breaks by declaring that
> all filenames passed to GDAL must be UTF-8.
> 
> I have found this to be true with the entire VTP software, which sits
> above GDAL.  It now uses UTF-8 internally for all filesystem strings,
> and has not encountered the need for any special Unicode library.
> 
> > This problem was raised one time in the past, probably this is a
> > time when we should prepare RFC for GDAL localization.  This is a
> > major change, this change can broke functionality, so it is painful,
> > but inevitable.
> 
> I suspect is not so major.  I'm willing to tackle the task, if Frank
> et al.  are interested.

Ben,

My concern is not only a file names, but the Unicode support for all
GDAL/OGR strings.  Personally I would like to see localized field names
in OGR and localized metadata in GDAL. But the filename issue is a good
starting point.

I think it should be done in the following steps:

1. Pick up the Unicode implementation.
2. Implement appropriate CPL layer for Unicide strings.
3. Convert all related CPL functions to use this new CPL layer. Note,
that filenames often embedded in more complex structures , so we should
be sure that all functions, responsible for parsing or serialization,
work correct with UTF-8 strings.

-- 
Andrey V. Kiselev
ICQ# 26871517

From dron at ak4719.spb.edu  Wed Sep 20 05:13:01 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <45103BEA.2020503@loskot.net>
References: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>
	<009f01c6d470$81309bf0$9b02a8c0@DellWork>
	<20060911110603.GA21234@ak4719.spb.edu>
	<45103BEA.2020503@loskot.net>
Message-ID: <20060920091301.GB16617@ak4719.spb.edu>

On Tue, Sep 19, 2006 at 08:50:18PM +0200, Mateusz Loskot wrote:
> BTW, there is a very nice generic UTF-8 manipulator which
> may be helpful for GDAL too:
> http://sourceforge.net/projects/utfcpp

Mateusz,

Thanks pointing that project, looks useful for some tasks! But it seems
it doesn't support UCS-2 encoding which we need to use in Windows
wopen() function. I am mainly thinking about IBM ICU library, because it
support a large amount of helpful localization functions which can be
used in GDAL, not only string conversion stuff.

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From dron at ak4719.spb.edu  Wed Sep 20 06:03:25 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <1158682792.12878.271307886@webmail.messagingengine.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<20060914094739.GA3884@ak4719.spb.edu>
	<1158682792.12878.271307886@webmail.messagingengine.com>
Message-ID: <20060920100325.GC16617@ak4719.spb.edu>

> > That all looks pretty complicated to maintain. Is there a way to
> > include in project files the list of file paths and include
> > parameters like it is done in the current makefiles? Otherwise it
> > gets too complicated even to add a single new file to the project.
> > If we will found a way to keep the file lists and configuration
> > parameters separate from the project files there will be no problem
> > to add them to GDAL. Without such separation there should be the one
> > who will regularly update project files.
> 
> Which bit do you mean is complicated? The separate directory of Visual
> Studio files? Or the separate project files for each built component? Or
> maintaining configurations etc?

Well, I am generally found complicated to go to Windows box, start the
GUI and edit the project files (including new modules, changing build
options etc.) It is easy to forget to do that after the change in the
build tree. So I am prefer project files to be generated by the common
build tool, something like the SCons or CMake. I have expirience with
SCons and I do not think that it is a good choice. SCons needs a bunch
of manually written scripts, because it doesn't support some features I
like to use (namely cross-compiling and libtool facilities).

CMake looks more promising, though it doesn't support cross-compiling as
well. But at least it can replace the current VS-oriented build system.
It is not a big pain to introduce the third build environment and test
it under different circumstances.

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mateusz at loskot.net  Wed Sep 20 07:23:48 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <45108EBC.8060501@pobox.com>
References: <1158167160.3081.270844271@webmail.messagingengine.com>
	<45108EBC.8060501@pobox.com>
Message-ID: <451124C4.8020708@loskot.net>

Frank Warmerdam wrote:
> Incidentally, if something like this is approached, it might be reasonable
> to integrate it with the project files for wince in the gdal\wince
> directory.

Frank,

This is a good idea.
I'll see how we could maintain common file list for both projects or may
be cmake can build for mobile devices using various compilers
shipped with Visual C++ 2005.

Nevertheless, I'd vote for cmake. If time will allow, I could provide my
5 cents in tweaking cmake configs and some maintenance work.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Wed Sep 20 07:27:45 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL driver for Magellan topo format
In-Reply-To: <450FE220.4020207@o2.pl>
References: <200609191020.55236.> <450FE220.4020207@o2.pl>
Message-ID: <451125B1.30408@loskot.net>

Maciej Sieczka wrote:
> Henrik Johansson wrote:
>>> Where has the diff gone?
>> Sorry, I've been out of town and I've had some problems with the web server. 
>> No everything should work fine though.
>>
>> I haven't got any response at all from the GDAL BLX patch. Has anyone tried 
>> it?
> 
> Not me :). I just spotted this interesting plugin and wanted to
> advertise it on Polish GPS mailing list, as a part of my GDAL propaganda.
> 
> Nice it's back again. Maybe now some Polish GPS folk will try it.

Arghh, why did I sell my Magellan Meridian receiver.
I did it because of poor support of Magellan formats by various free
software and I'm going to buy some Garmin.
But now I regret my decision :-(

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From jmoreau at nrcan.gc.ca  Thu Sep  7 11:47:46 2006
From: jmoreau at nrcan.gc.ca (=?iso-8859-1?Q?Moreau=2C_Jean-S=E9bastien?=)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] converting from .ers to .tif
Message-ID: <C4C4576E6E57D51191D30002A537C6CB081886B6@s5-shr-r1.cits.rncan.gc.ca>

Hi,

 

I'm trying to convert some DEM files from .ers format to .tif. When I use gdalinfo on my image, I get the following output:

 

D:\Apps\FWTools1.0.5> gdalinfo E:\Data\22k01102.ers

Driver: EHdr/ESRI .hdr Labelled

Size is 2798, 1409

Coordinate System is:

GEOGCS["NAD83",

    DATUM["North_American_Datum_1983",

        SPHEROID["GRS 1980",6378137,298.257222101,

            AUTHORITY["EPSG","7019"]],

        TOWGS84[0,0,0,0,0,0,0],

        AUTHORITY["EPSG","6269"]],

    PRIMEM["Greenwich",0,

        AUTHORITY["EPSG","8901"]],

    UNIT["degree",0.0174532925199433,

        AUTHORITY["EPSG","9108"]],

    AXIS["Lat",NORTH],

    AXIS["Long",EAST],

    AUTHORITY["EPSG","4269"]]

Origin = (-68.250915,50.125905)

Pixel Size = (0.00009000,-0.00009000)

Corner Coordinates:

Upper Left  ( -68.2509150,  50.1259050) ( 68d15'3.29"W, 50d 7'33.26"N)

Lower Left  ( -68.2509150,  49.9990950) ( 68d15'3.29"W, 49d59'56.74"N)

Upper Right ( -67.9990950,  50.1259050) ( 67d59'56.74"W, 50d 7'33.26"N)

Lower Right ( -67.9990950,  49.9990950) ( 67d59'56.74"W, 49d59'56.74"N)

Center      ( -68.1250050,  50.0625000) ( 68d 7'30.02"W, 50d 3'45.00"N)

Band 1 Block=2798x1 Type=Byte, ColorInterp=Undefined

  NoData Value=-9999

  Metadata:

  NBITS=-1

 

That seems to be all right. But when I try to use gdal_translate : 

 

D:\Apps\FWTools1.0.5>gdal_translate -of GTiff E:\Data\22m01101.ers E:\Data\22m01

101.tif

Input file size is 2798, 1409

0ERROR 2: CPLCalloc(): Out of memory allocating -348 bytes.

 

 

This application has requested the Runtime to terminate it in an unusual way.

Please contact the application's support team for more information.

 

Is there something wrong with my command?

 

Thanks

 

Jean-S?bastien Moreau

 

Centre d'information topographique de Sherbrooke
Ressources naturelles Canada
2144, rue King Ouest, bureau 010
Sherbrooke (Qu?bec) J1J 2E8
T?l. : 819-564-5600-ext 295     T?l?c. : 819-564-5698
Courrier ?lectronique : jmoreau@RNCan.gc.ca

Centre for Topographic Information of Sherbrooke
Natural Resources Canada
2144, King Street West, Suite 010
Sherbrooke, Quebec  J1J 2E8
Tel.:  819-564-5600-ext 295     Fax:  819-564-5698
E-mail:  jmoreau@NRCan.gc.ca

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060907/704da727/attachment.html
From johnslater at earthlink.net  Mon Sep 18 09:11:51 2006
From: johnslater at earthlink.net (John A. Slater)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Find elevation data at specific point
Message-ID: <000001c6db24$01de2880$6401a8c0@JohnSlater>

Did you get the answer? I had a web page that would give me the elevation if
I gave the lats & longs, but I can't find it .  Could you help?

 

Thanks,

 

John Slater

  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060918/d4b2c39f/attachment.html
From jingmuyang at aol.com  Thu Sep  7 13:32:30 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Reading Erdas Imagine Files Through GDAL 1.3.2
Message-ID: <6194856.post@talk.nabble.com>


I experience the performance downgrade after linking my application into GDAL
1.3.2 to read (open) large (200MB) Erdas Imagine files.  It paused about
20-30 seconds in calling GDALOpen.  But when I used the early GDAL release
(1.2.6) reading such files were very fast.  What happens with the latest
release of GDAL?

Thanks ahead!

Jingmu

-- 
View this message in context: http://www.nabble.com/Reading-Erdas-Imagine-Files-Through-GDAL-1.3.2-tf2234529.html#a6194856
Sent from the GDAL - Dev forum at Nabble.com.


From jingmuyang at aol.com  Thu Sep  7 13:46:28 2006
From: jingmuyang at aol.com (Jingmu Yang)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL and Solaris 10/sparc
In-Reply-To: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
References: <T7a472e6b5f9384f0e1b08@goshawk.env.qld.gov.au>
Message-ID: <6195088.post@talk.nabble.com>


I used the following configuration to successfully build GDAL 1.3.2 on
Solaris 10 with gcc 3.4.3 under /usr/sfw/bin/.

./configure --with-png=internal --with-jpeg=internal --with-geotiff=internal
--with-libtiff=internal --with-libz=internal --with-unix-stdio-64=no
--with-static-proj4=/usr/local/lib

Jingmu



Shaun Kolomeitz wrote:
> 
> 
> After months of searching, hacking and many hundreds of compile attempts I
> am still unable to successfully get GDAL to compile on a SPARC/Solaris 10
> environment. No amount of searching lists and getting obscure possible
> fixes has worked.
> My original aim was to get GDAL with ECW compiled and going, but for now
> I'd even settle for just Geotiff, HFA and JPEG. I'll just have to use
> WindoZe to do any other conversions.
> Would someone mind sending me some settings from their working GDAL
> sparc/Solaris X configurations ?
> Stuff like the system wide "crle", PATH and LD_LIBRARY_PATH settings for
> compilation and the versions of GCC/etc that actually work.
> Any other suggestions that might help me get this going would be most
> welcome.
> 
> TIA,
> Shaun
> 
> 
> ___________________________
> Disclaimer
> 
> This e-mail, including attachments if any, has originated from a
> Queensland government agency and may contain information that is
> confidential, or covered by legal professional privilege, and is intended
> for the named recipient(s) only.  If you have received this message in
> error, you are asked to inform the sender as quickly as possible and
> delete this message and any copies of this message from your computer
> system network.
> 
> Any form of disclosure, modification, distribution and/or publication of
> this e-mail, including attachments is prohibited.  Unless otherwise
> stated, this e-mail, including attachments represents the views of the
> sender and not the views of the Environmental Protection Agency.
> 
> Although this e-mail has been checked for the presence of computer
> viruses, the Environmental Protection Agency provides no warranty that all
> possible viruses have been detected and cleaned.  Any use of this e-mail
> could harm your computer system.
> ___________________________
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://www.nabble.com/GDAL-and-Solaris-10-sparc-tf2149918.html#a6195088
Sent from the GDAL - Dev forum at Nabble.com.


From bryan at geomega.com  Wed Sep 20 10:31:22 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] easy ogr question...
In-Reply-To: <C6E7A849-F742-4BDD-97AA-4FEFD75E9B42@sauder.ubc.ca>
References: <450F0161.6090403@timberline.ca>
	<45101A49.5030108@pobox.com>	<45101BBF.7010606@timberline.ca>
	<C6E7A849-F742-4BDD-97AA-4FEFD75E9B42@sauder.ubc.ca>
Message-ID: <451150BA.2030403@geomega.com>

Will, Frank, Dan,

I tested Will's code on a shapefile that had features and received this 
error:

ERROR 6: Can't create fields on a Shapefile layer with features.

Clear enough.

Then I deleted the features from the shapefile, ran the code again, and 
received this error:

ERROR 1: Can't create field test in Shape DBF file, reason unknown.

Not so clear.

Dan, I'm interested in the R code using dbflib because I wrote something 
a while ago in Python using dbflib and my technique was like Will 
described: make a new dbf with an additional field, populate with the 
data from the old one, delete the old dbf and replace it with the new one.

Bryan

Dan Putler wrote:
> Hi Will,
> 
> I add new fields to shapefiles all the time. Although, I do it using  
> R, which (through Frank's shapelib) handles DBFs beautifully. I can  
> provide details, but since this is now off list, I can provide  
> details privately. The main thing is that you only need to muck with  
> the *.dbf file, not the *.shp file itself.
> 
> Dan
> 
> On 19-Sep-06, at 9:33 AM, Will Cadell wrote:
> 
>> Thanks Frank,
>>
>> No message I'm afraid but there are features, and I was wondering how
>> ogr would handle and 'empty' column. I assumed it would add nulls, but
>> hey ho seems like I'll have to make a new shapefile, copy the layer
>> definition then add the field then copy all the features to a new
>> shapefile... Does seem a bit cumbersome though... is there a better  
>> way
>> people can think of?
>>
>> will
>>
>> Frank Warmerdam wrote:
>>> Will Cadell wrote:
>>>> hi guys... am i just stupid or is there another way to add a  
>>>> field to a
>>>> shapefile other than:
>>>>        ds = ogr.open("c:\shapefile.shp", True)
>>>>        new_field = ogr.FieldDefn()
>>>>     new_field.SetName(new_field_name)
>>>>     new_field.SetType(new_field_type)
>>>>     new_field.SetWidth(new_field_width)
>>>>        layer = ds.GetLayer(0)
>>>>     layer.CreateField(new_field)
>>>>        ds.destroy
>>>>
>>>> because this doesn't work for me...
>>> Will,
>>>
>>> This does seem like the correct approach.  Are there any features  
>>> in the
>>> shapefile already?  I'm pretty sure that adding a field only works  
>>> when
>>> there are no features yet.  If you aren't getting an error message  
>>> then
>>> there is a clear bug here, and a bug report in bugzilla would be
>>> appreciated.
>>>
>>> Best regards,
>> -- 
>> Will Cadell
>> Remote Sensing and GIS Analyst
>>
>>    /\/\
>>   /  \ \
>>  /  Timberline
>> /   Forest Inventory Consultants
>>
>> tel:(250) 562 2628       address: 1579 9th Ave,
>> skype: geo_will                   Prince George,
>> loc: 53.9135N, 122.7544W          BC, Canada
>>
>> www.timberline.ca
>>
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 

From wenjun636465 at 163.com  Wed Sep 20 04:02:26 2006
From: wenjun636465 at 163.com (wenjun636465)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL version problem
Message-ID: <4510F592.000134.18428@bj163app22.163.com>

 
   I can use the function 'const char *CPLReadLine(file *fp)' OF gdal1.2 version successfully.But now i replace the gdal1.2 with the gdal1.3.1 in the same project,the function 'const char *CPLReadLine(file *fp)' can't run successfully.why?is it the version problem?
    please help me
    Thanks.
                                                       ZhangWenjun
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060920/1a6d7773/attachment.html
From poliveira at esri-portugal.pt  Thu Sep  7 07:18:05 2006
From: poliveira at esri-portugal.pt (Pedro Oliveira)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Converting HDF-SMI in TIF  -georeferencing problems
Message-ID: <FC3E2365FE096449AD07A1D5A17F6EAA01071855@Teris.esript.local>

Good Morning

 

I'm trying to import HDF-SMI from MODIS to TiF, and i'm using the GDAL
FWTools application.

I'm using the following sintax for importing the hdf image in a batch
file that uses some variables to lock the file name:

 

GDAL_TRANSLATE -OF GTIFF %DIRIN%\%%X  %DIROUT%\%%~nX.TIF

 

Everything work's fine. The problem is the this:

The outpu image is a GeoTiff but it dosn't have lat/long georeferencing,
but has row/column info. Ive tried to use some paramenter like -t_srs or
-s_srs in gdalwarp but didn't work.

When i use gdalinfo i cn see that the HDF file dosn't have a explicit
geographical information, but the information has lat/long data.

 

Is there a way to import image and have the output file as lat/long
(wgs84) georefernced

 

I've download the image in the following URL

HDF-SMI:

http://oceancolor.gsfc.nasa.gov/cgi/level3.pl?DAY=08Aug2005&PER=&TYP=mac
hl&RRW=16

 

i've used a Chlorophyll (Aqua-MODIS) monthy 4km HDF file.

 

Tanks in advance by you help

Best regards

 

Pedro Oliveira

 




 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060907/1d21c50d/attachment.html
From ILucena at clarku.edu  Wed Sep 20 11:25:44 2006
From: ILucena at clarku.edu (Ivan Lucena)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Visual Studio Project Files
In-Reply-To: <45108EBC.8060501@pobox.com>
Message-ID: <6FD7C9DB26540B42A1207C69BF92D45501E746A4@Iris.ad.clarku.edu>

Hi there,

After I changed all "copy *.obj ../o" to "xcopy /D /Y *.obj ../o" in
about 65 GDAL makefile.vc my compilation process improved very
reasonably, so I decided to give it a try to what Microsoft Visual
Studio calls a "Makefile Project":

ms-help://MS.VSCC.v80/MS.MSDN.vAug06.en/dv_vcide/html/dd077af3-97a8-48fb
-baaa-cf7e07ddef61.htm

It is not as good as a real "Visual Studio Dynamic Library (.dll)" but
works very well. I can edit my piece of code and click F5 to start
debugging in seconds. 

Basically all you have to do is to configure in the VC project
properties the proper command line for build, clean and rebuild.

I am not against the Visual Studio Project initiative, I actually would
like to have the time and knowledge to help, but I think that "Makefile
Project" is just something that could be adopted individually very
easily in the meantime or by some of the folks that prefer make files.

Best regards,

Ivan Lucena

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Tuesday, September 19, 2006 8:44 PM
To: Simon Perkins
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Visual Studio Project Files

Simon Perkins wrote:
> Hi,
> 
> Matt Hanson and I had a thread going in which the subject of Visual
> Studio Project files came up. I didn't get any comments on that and
> figured the details might have been lost in the noise, so here's a
> second attempt to elicit some feedback...
...
> So, what d'yall think? Is it necessary? Would it be useful? Any ideas
> about this could be implemented most effectively? Anyone done any work
> on this already that they want to share? I would be happy to take a
> first stab at this. Should this be written up as an official RFC? How
do
> I do that?

Sy,

I haven't run into any compelling problems with the NMAKE based build
approach myself.  As Mateusz points out, we can adjust things to embed
the manifests if that is important.

However, if there are folks who understand project files well, and are
willing to maintain them, then I would not be opposed to them being
available as a parallel build mechanism.  I, unfortunately, do not
understand them well, and am not really keen on being responsible
for their development or maintenance.

I would suggest that a formal RFC be brought forward to the GDAL PSC
before project files (or cmake based builds) are introduced into the
existing tree.

Incidentally, if something like this is approached, it might be
reasonable
to integrate it with the project files for wince in the gdal\wince
directory.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From support at geoimage.fr  Wed Sep 20 12:46:14 2006
From: support at geoimage.fr (Fabien Dachicourt)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Memory problem with ECW images
Message-ID: <03cf01c6dcd4$4a13b1e0$3501a8c0@ANKARA>

Hi,
Our software browses large images through GDAL library, it reads images by 
blocks at any given resolution with GDALDatasetRasterIO and frees blocks 
which are out of view. It works pretty fine, it allows to control the exact 
amount of data in memory.
However we notice some large memory consumption with ECW images, it looks 
like there is a big memory leak : all loaded tiles are stored somewhere in 
memory and never free.
Exactly the same RGB image in TIFF format works fine, without memory 
overflow.

Is it a memory leak or any hidden cache in the ECW libraries or in the ECW 
driver ? is there any way to control the size of this cache ?

The GDAL cache is set to 2MB.
The GDAL version is 1.3.2.0 (FWTools 1.0.5).

Thanks in advance for any help,
Fabien 



From rlcave3rd at yahoo.com  Wed Sep 20 14:31:45 2006
From: rlcave3rd at yahoo.com (Bob Cave)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OGR - Writing MapInfo Text Features 
Message-ID: <20060920183145.47683.qmail@web55505.mail.re4.yahoo.com>

Hello,

Can the MapInfo (TAB/MIF) driver for OGR write a text feature via the OGR interface?  I know that when I read a text feature using OGR, I get a point geometry with a label attached.  I tried writing a point geometry with a label attached, but that did not work.

I can write a text feature using MITAB directly, but the MITAB classes are not exported from GDAL, and I'd prefer to use just the OGR interfaces in any case.

Cheers,

Bob

 		
---------------------------------
Talk is cheap. Use Yahoo! Messenger to make PC-to-Phone calls.  Great rates starting at 1?/min.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060920/4e98d8a9/attachment.html
From mateusz at loskot.net  Wed Sep 20 15:46:19 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <014801c6dc7b$f34e7050$9b02a8c0@DellWork>
References: <014801c6dc7b$f34e7050$9b02a8c0@DellWork>
Message-ID: <45119A8B.8020707@loskot.net>

Ben Discoe wrote:
> Mateusz,
> 
>> -----
>> From: Mateusz Loskot
>> Sent: Tuesday, September 19, 2006 12:38 PM
>>
>>> The problem i have _not_ solved is what to do on Windows with code 
>>> which uses std::ifstream() instead of fopen().
>> std::ifstream is a type from the C++ library but fopen() is a 
>> function from the C library.
>> I'm not sure I understand what's here to be solved
> 
> What's here to be solved is GDAL's source.  If it only calls fopen(), then
> it can be replaced with the function i described.  If GDAL also uses the C++
> stream classes for file IO (which i hope it does not), then there exists the
> problem i described.

AFAIK, GDAL does not uses C++ SL streams, so C library calls are the
only option. So, I don't see much problems with using them, besides
customizing GDAL itself to work with wide-char strings.

>> Simply, you have to decide if you use streams or file 
>> descriptor, both are different approaches used in different 
>> languages (C/C++) and are based on different libraries (C/C++).
> 
> Obviously.  But like many large projects, GDAL is both C and C++, and uses
> both standard libraries.

Generally yes, but in GDAL C++ library is not widely used, so C
functions can be considered as the only option.

>>> MSDN documents that there is a
>>> (wchar_t*) version of std::ifstream() constructor 
>>> (http://msdn2.microsoft.com/en-us/library/zek0beca.aspx),
>> Simply, there are two specializations of basic_ifstream, one 
>> for char -> ifstream and one for wchar_t -> wifstream.
> 
> There may be, but that's irrelevant.  I said two _constructors_, not two
> template instances.  If that MSDN link works for you, you can see that
> std::ifstream<char> has two constructors, one which takes a char*filename,
> and one which takes a wchar_t*filename.  This is totally independent of the
> base type of the template, which has to do with the data read from the
> stream, not the charset of the filename used to construct it.
>
> As i mentioned, the MSDN documentation has those two constructors, but the
> headers and library that come with MSVC 7.1 do not have both.

Now, everything is clear. We're talking about two different things,
but that's because I've had no idea about this ctor.
And because the problem is in the MSDN documentation :-)
The second constructor you see, that takes const wchar_t* parameter
is a non-standard *extension* introduced by Microsoft.
That's why you can't find it in the MSVC++ 7.1, as well as you won't
find it in libstdc++, Dinkumware C++ and even in Comeau C/C++ - the most
up-to-date C++ compiler.

Standard ctors of basic_ifstream are specified in the
27.8.1.6 basic_ifstream constructors of C++ Language Standard.

Also, in Dinkumware's manual:

http://www.dinkumware.com/manuals/?manual=compleat&page=fstream.html#basic_ifstream

Dinkumware manuals are very good regarding ISO C++ compliance.

I just wonder why Microsoft does not inform that this wide-char-based
ctor is an extension. There is a relevant note about it but only in
the <fstream> file, line 591:

// construct with wide-named file -- EXTENSION


>> AFAIR there is <fstream> header in C++ library provided with 
>> Visual C++ 7.1 compiler.
> 
> Yes, but the constructor does not take a wchar_t*filename.

Because, what I'm expalining above, there is no wide-char based
ctor in basic_ifstream class, according to the C++ standard.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mhanson at photon.com  Wed Sep 20 16:01:29 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>

So, can anyone verify VRT files work ?    My sample VRT is as simple as the one in the documentation and GDAL is not parsing it correctly.

________________________________

From: Matt Hanson
Sent: Thu 9/14/2006 5:07 PM
To: gdal-dev@lists.maptools.org
Subject: RE: VRT File Format


In looking at this more, I don't see how the current VRT driver can read any virtual file correctly.   Is anyone else able to read VRT files in 1.3.2?
 
The problem is that vrtsourcedrasterband is not expecting the <VRTRasterBand> XML element to have any XML attributes (i.e. <VRTRasterBand dataType="float32"> associated with it.   It expects the first child to be an Element also.    
 
I would submit a bug report, but since this bug means broken VRT files I wanted to check to see if anyone else was using VRT's with success.   And if you are reading them with 1.3.2 then can you post the VRT file you're using ?    Thanks!
 
matt

________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 4:09 PM
To: gdal-dev@lists.maptools.org
Subject: RE: VRT File Format


I've tracked down this error to vrtsourcedrasterband.cpp, line 286, where is processed the sources from the VRT set.
I can't really figure out what's happening. It loks like the it's supposed to step through the XML elements of the tree, but on the first one (which is an XML Attribute, dataType) it generates an error because VRTDriver::ParseSource checks to see if it's an element which it's not, it's an attribute.   So it triggers the CPLError in vrtdriver.cpp, line 134.
 
My VRT looks correct to me, but I must be doing something wrong because if this really is an error it wouldn't work on any VRT dataset.
 
 
*************************************************
if( poBand != NULL 

&& poBand->XMLInit( psChild, pszVRTPath ) == CE_None )

{

SetBand( ++nBands, poBand );

}

else

{

if( poBand )

delete poBand; 

return CE_Failure;

}

***************************************

poBand is evaluating to Null, bu

 


________________________________

From: Matt Hanson
Sent: Tue 9/12/2006 3:21 PM
To: gdal-dev@lists.maptools.org
Subject: VRT File Format


Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
ERROR 1: Corrupt of empty VRT source XML document.
 
Here's my VRT file:
 
*********************************************************************************************
<VRTDataset rasterXSize="400" rasterYSize="400">

<VRTRasterBand dataType="Int16" band="1">

<SimpleSource>

<SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>

<SourceBand>1</SourceBand>

<SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>

<DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>

</SimpleSource>

</VRTRasterBand>

</VRTDataset>

********************************************************************



From warmerdam at pobox.com  Wed Sep 20 16:56:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>
Message-ID: <4511AB11.2000907@pobox.com>

Matt Hanson wrote:
> So, can anyone verify VRT files work ?    My sample VRT is as simple as the one in the documentation and GDAL is not parsing it correctly.

Matt,

I changed the SourceFilename to point to a file on my system, and then
gdalinfo on the file worked for me.  This was with GDAL from CVS.

Best regards,

> Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
> ERROR 1: Corrupt of empty VRT source XML document.
>  
> Here's my VRT file:
>  
> *********************************************************************************************
> <VRTDataset rasterXSize="400" rasterYSize="400">
> 
> <VRTRasterBand dataType="Int16" band="1">
> 
> <SimpleSource>
> 
> <SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>
> 
> <SourceBand>1</SourceBand>
> 
> <SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>
> 
> <DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>
> 
> </SimpleSource>
> 
> </VRTRasterBand>
> 
> </VRTDataset>
> 
> ********************************************************************
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 
> 


-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Wed Sep 20 17:59:37 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <20060920091301.GB16617@ak4719.spb.edu>
References: <931f8ea90609091129qad27af7j3c5767c44f68a56c@mail.gmail.com>	<009f01c6d470$81309bf0$9b02a8c0@DellWork>	<20060911110603.GA21234@ak4719.spb.edu>	<45103BEA.2020503@loskot.net>
	<20060920091301.GB16617@ak4719.spb.edu>
Message-ID: <4511B9C9.7090200@loskot.net>

Andrey Kiselev wrote:
> On Tue, Sep 19, 2006 at 08:50:18PM +0200, Mateusz Loskot wrote:
>> BTW, there is a very nice generic UTF-8 manipulator which
>> may be helpful for GDAL too:
>> http://sourceforge.net/projects/utfcpp
> 
> Mateusz,
> 
> Thanks pointing that project, looks useful for some tasks! But it seems
> it doesn't support UCS-2 encoding which we need to use in Windows
> wopen() function.

Andrey,

You're right. Windows calls Unicode as UCS-2 / UTF-16 encodings.
And this library supports only UTF-8 encoding.

> I am mainly thinking about IBM ICU library, because it
> support a large amount of helpful localization functions which can be
> used in GDAL, not only string conversion stuff.

I think it's a good idea. ICU should solve most of GDAL
internationalization problems.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Wed Sep 20 18:03:08 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <20060920090452.GA16617@ak4719.spb.edu>
References: <20060911110603.GA21234@ak4719.spb.edu>	<00bd01c6dc33$46789bf0$9b02a8c0@DellWork>
	<20060920090452.GA16617@ak4719.spb.edu>
Message-ID: <4511BA9C.9080900@loskot.net>

Andrey Kiselev wrote:
> On Tue, Sep 19, 2006 at 11:33:40AM -1000, Ben Discoe wrote:
>>> The major drawback of this change is additional requirement: we will
>>> need an Unicode library to replace all string handling functions
>>> from the C lib with the Unicode aware ones.
>> Not necessarily.  This really only affects filepath/filename strings.
>> Since UTF-8 and ASCII are identical over the range of ASCII, and
>> string subsets which GDAL could conceivably need to manipulate such as
>> file extentions ("*.tif") are ASCII, nothing breaks by declaring that
>> all filenames passed to GDAL must be UTF-8.
>>
>> I have found this to be true with the entire VTP software, which sits
>> above GDAL.  It now uses UTF-8 internally for all filesystem strings,
>> and has not encountered the need for any special Unicode library.
>>
>>> This problem was raised one time in the past, probably this is a
>>> time when we should prepare RFC for GDAL localization.  This is a
>>> major change, this change can broke functionality, so it is painful,
>>> but inevitable.
>> I suspect is not so major.  I'm willing to tackle the task, if Frank
>> et al.  are interested.
> 
> Ben,
> 
> My concern is not only a file names, but the Unicode support for all
> GDAL/OGR strings.  Personally I would like to see localized field names
> in OGR and localized metadata in GDAL. But the filename issue is a good
> starting point.
> 
> I think it should be done in the following steps:
> 
> 1. Pick up the Unicode implementation.
> 2. Implement appropriate CPL layer for Unicide strings.
> 3. Convert all related CPL functions to use this new CPL layer. Note,
> that filenames often embedded in more complex structures , so we should
> be sure that all functions, responsible for parsing or serialization,
> work correct with UTF-8 strings.

If there are Unicode and non-Unicode versions of CPL, then may be
it could be possible to build GDAL in Unicode mode on request.
It should simplify maintenance of the GDAL codebase.
I've not considered this implementation in details yet,
but what do you think about supporting both versions?

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From tflynch at gmail.com  Wed Sep 20 21:52:18 2006
From: tflynch at gmail.com (Tom Lynch)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Memory problem with ECW images
In-Reply-To: <03cf01c6dcd4$4a13b1e0$3501a8c0@ANKARA>
References: <03cf01c6dcd4$4a13b1e0$3501a8c0@ANKARA>
Message-ID: <c39b2a650609201852k6b4994cey24654048a7c645d@mail.gmail.com>

Hi Fabien,

Which version of the ECW libraries are you using?  If it's the
previous RC2, there was definitely a memory leak in that distribution,
relating to tiled views.  That bug was fixed for the current public
release.

The ECW library maintains a cache for compressed and uncompressed
blocks of frequently used imagery as views are read.  The basic method
used is to set cache size at about 1/4 of physical RAM and fill with
uncompressed blocks as they are viewed, then start to recycle cache
for compressed blocks as more imagery is viewed, on an LRU basis.  The
cache is also purged at various times, including on library shutdown.

The maximum size of the cache can be controlled using
NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, <size in bytes>);

Hope this helps.  If you're seeing a bug in ECW caching please let us
know, and we'll correspond with you to locate and fix the problem.

Regards

Tom Lynch

On 9/21/06, Fabien Dachicourt <support@geoimage.fr> wrote:
> Hi,
> Our software browses large images through GDAL library, it reads images by
> blocks at any given resolution with GDALDatasetRasterIO and frees blocks
> which are out of view. It works pretty fine, it allows to control the exact
> amount of data in memory.
> However we notice some large memory consumption with ECW images, it looks
> like there is a big memory leak : all loaded tiles are stored somewhere in
> memory and never free.
> Exactly the same RGB image in TIFF format works fine, without memory
> overflow.
>
> Is it a memory leak or any hidden cache in the ECW libraries or in the ECW
> driver ? is there any way to control the size of this cache ?
>
> The GDAL cache is set to 2MB.
> The GDAL version is 1.3.2.0 (FWTools 1.0.5).
>
> Thanks in advance for any help,
> Fabien
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>


-- 
Tom Lynch
Development, ER Mapper
Phone:      +61 8 93882900
Fax:        +61 8 93882901
Email:      tom.lynch@ermapper.com
Web:        http://www.ermapper.com
Forums:     http://forum.ermapper.com

From jnovak at novacell.com  Thu Sep 21 01:36:49 2006
From: jnovak at novacell.com (John Novak)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] libgeotiff in gdal and csv files
Message-ID: <451224F1.60605@novacell.com>

I notice that the libtiff built into gdal 1.3.1 by default does not seem 
to have the csv file support included.

As I need one of the projections in pcs.csv, what is the recommended 
prcedure for including this support with the builtin libgeotiff ?

Or, should I just build with an external libgeotiff that I know has the 
proper support included ?

BTW, I'm building on windoze ;-(

Best,

John Novak



From ben at vterrain.org  Thu Sep 21 02:00:21 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <20060920090452.GA16617@ak4719.spb.edu>
Message-ID: <005901c6dd43$39592a50$9b02a8c0@DellWork>

Andrey,

> -----Original Message-----
> From: Andrey Kiselev
> Sent: Tuesday, September 19, 2006 11:05 PM
> 
> My concern is not only a file names, but the Unicode support 
> for all GDAL/OGR strings.  Personally I would like to see 
> localized field names in OGR and localized metadata in GDAL. 

I can't imagine how other GDAL/OGR would need to do charset manipulation?
As long as the user gives UTF-8 or other 1-byte strings, GDAL/OGR can be
charset agnostic.  It isn't doing any charset handling now for
non-filenames, and it works just fine.  But, we can keep an eye out for
this, should it turn up.

> But the filename issue is a good starting point.
> I think it should be done in the following steps:
> 1. Pick up the Unicode implementation.
> 2. Implement appropriate CPL layer for Unicode strings.
> 3. Convert all related CPL functions to use this new CPL 
> layer.

I am happy to do this work and submit it, i am just waiting to hear from you
(or Frank, or..? Confused by GDAL's new democracy) that i should proceed.

> Note, that filenames often embedded in more complex 
> structures , so we should be sure that all functions, 
> responsible for parsing or serialization, work correct with 
> UTF-8 strings.

Agreed.

-Ben


From ben at vterrain.org  Thu Sep 21 02:07:38 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <45119A8B.8020707@loskot.net>
Message-ID: <005a01c6dd44$3da97c30$9b02a8c0@DellWork>

Mateusz,

> >>> MSDN documents that there is a
> >>> (wchar_t*) version of std::ifstream() constructor 
> >>> (http://msdn2.microsoft.com/en-us/library/zek0beca.aspx),
> 
> Now, everything is clear. We're talking about two different 
> things, but that's because I've had no idea about this ctor.
> And because the problem is in the MSDN documentation :-)

Yes. :)

> second constructor you see, that takes const wchar_t* 
> parameter is a non-standard *extension* introduced by Microsoft.

Well sure.  So is _wfopen, and _wfopen is great.
The trouble here is not that it's a non-standard *extension*, but that it's
a non-standard *extension* which appears in the docs but not in the product.
:|

> That's why you can't find it in the MSVC++ 7.1

Well no, MSVC++ 7.1 has all of Microsoft's nonstandard extension, except
(apparently) this one.

> Because, what I'm expalining above, there is no wide-char 
> based ctor in basic_ifstream class, according to the C++ standard.

Yes, it's well known that the C and C++ standards are critically flawed in
that they only support a local charset, not unicode.  This discussion isn't
about standards, but about how we can implement support for all filenames in
GDAL.  Fortunately for GDAL, it (apparently) sticks to C stdlib, so we can
(thankfully) use _wfopen on Windows.

-Ben


From mateusz at loskot.net  Thu Sep 21 04:04:25 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <005b01c6dd44$763187f0$9b02a8c0@DellWork>
References: <005b01c6dd44$763187f0$9b02a8c0@DellWork>
Message-ID: <45124789.1090107@loskot.net>

Ben Discoe wrote:
>> If there are Unicode and non-Unicode versions of CPL, then 
>> may be it could be possible to build GDAL in Unicode mode on request.
>> It should simplify maintenance of the GDAL codebase.
> 
> Since we plan to use UTF-8, instead of wide strings, then it is not
> necessary to built GDAL in different modes.  That is indeed simpler.

OK, it's clear.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Sep 21 04:12:31 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <005a01c6dd44$3da97c30$9b02a8c0@DellWork>
References: <005a01c6dd44$3da97c30$9b02a8c0@DellWork>
Message-ID: <4512496F.9050900@loskot.net>

Ben Discoe wrote:
>> second constructor you see, that takes const wchar_t* 
>> parameter is a non-standard *extension* introduced by Microsoft.
> 
> Well sure.  So is _wfopen, and _wfopen is great.
> The trouble here is not that it's a non-standard *extension*, but that it's
> a non-standard *extension* which appears in the docs but not in the product.
> :|

Ben,

My understanding is as follows, the extension has been introduced
with Visual C++ 8.0, so Visual C++ 7.1 does not include it.

>> That's why you can't find it in the MSVC++ 7.1
> 
> Well no, MSVC++ 7.1 has all of Microsoft's nonstandard extension, except
> (apparently) this one.

I can't agree.
Visual C++ 7.1. does not include *all* extensions, because many or most
of them have been introduced with Visual C++ 8.0, for example
safe version of C/C++ SL.

I mean, we can not expect both Visual C++ 7.1 and 8.0 include the
same version of standard and non-standard C/C++ features.
Also, new version of Visual C++ will likely include new stuff that won't
be backported to Visual C++ 2005.

>> Because, what I'm expalining above, there is no wide-char 
>> based ctor in basic_ifstream class, according to the C++ standard.
> 
> Yes, it's well known that the C and C++ standards are critically flawed in
> that they only support a local charset, not unicode.

Yes. Unicode handling is a matter of library but not the language,
in case of C/C++.

> This discussion isn't
> about standards, but about how we can implement support
> for all filenames in GDAL.

Yes, you're right.
I'm referencing to standards because I see standards as
the way to provide portable software.
So, if the wide-char ctor is only included in basic_ifstream of Visual
C++ 8.0, we can not use it because it's not portable.
That's why I usually try to stick to C/C++ standards and portable solutions.

I believe, portability is relevant to GDAL development.

> Fortunately for GDAL, it (apparently) sticks to C stdlib, so we can
> (thankfully) use _wfopen on Windows.

That's right.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From support at geoimage.fr  Thu Sep 21 04:50:38 2006
From: support at geoimage.fr (Fabien Dachicourt)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Memory problem with ECW images
References: <03cf01c6dcd4$4a13b1e0$3501a8c0@ANKARA>
	<c39b2a650609201852k6b4994cey24654048a7c645d@mail.gmail.com>
Message-ID: <046b01c6dd5b$0361eeb0$3501a8c0@ANKARA>

Hi Tom,
Thanks for your answer,
Actually, i use the library version packaged in FWTools 1.0.5, I don't know 
if it corresponds to the RC2 version :
- NCScnet_fw.dll : 1.0.0.1
- NCSEcw_fw.dll : 3.1.0.350
- NCSUtil_fw.dll : 1.0.0.1

Anyhow, your description corresponds to what i get.
1/4 of physical RAM seems quite big, cause we manage our own cache to manage 
uncompressed blocks. I'm going to try the NCSecwSetConfig function to reduce 
it.

Regards,
Fabien

----- Original Message ----- 
From: "Tom Lynch" <tflynch@gmail.com>
To: "Fabien Dachicourt" <support@geoimage.fr>
Cc: <gdal-dev@lists.maptools.org>
Sent: Thursday, September 21, 2006 3:52 AM
Subject: Re: [Gdal-dev] Memory problem with ECW images


> Hi Fabien,
>
> Which version of the ECW libraries are you using?  If it's the
> previous RC2, there was definitely a memory leak in that distribution,
> relating to tiled views.  That bug was fixed for the current public
> release.
>
> The ECW library maintains a cache for compressed and uncompressed
> blocks of frequently used imagery as views are read.  The basic method
> used is to set cache size at about 1/4 of physical RAM and fill with
> uncompressed blocks as they are viewed, then start to recycle cache
> for compressed blocks as more imagery is viewed, on an LRU basis.  The
> cache is also purged at various times, including on library shutdown.
>
> The maximum size of the cache can be controlled using
> NCSecwSetConfig(NCSCFG_CACHE_MAXMEM, <size in bytes>);
>
> Hope this helps.  If you're seeing a bug in ECW caching please let us
> know, and we'll correspond with you to locate and fix the problem.
>
> Regards
>
> Tom Lynch
>
> On 9/21/06, Fabien Dachicourt <support@geoimage.fr> wrote:
>> Hi,
>> Our software browses large images through GDAL library, it reads images 
>> by
>> blocks at any given resolution with GDALDatasetRasterIO and frees blocks
>> which are out of view. It works pretty fine, it allows to control the 
>> exact
>> amount of data in memory.
>> However we notice some large memory consumption with ECW images, it looks
>> like there is a big memory leak : all loaded tiles are stored somewhere 
>> in
>> memory and never free.
>> Exactly the same RGB image in TIFF format works fine, without memory
>> overflow.
>>
>> Is it a memory leak or any hidden cache in the ECW libraries or in the 
>> ECW
>> driver ? is there any way to control the size of this cache ?
>>
>> The GDAL cache is set to 2MB.
>> The GDAL version is 1.3.2.0 (FWTools 1.0.5).
>>
>> Thanks in advance for any help,
>> Fabien
>>
>>
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@lists.maptools.org
>> http://lists.maptools.org/mailman/listinfo/gdal-dev
>>
>
>
> -- 
> Tom Lynch
> Development, ER Mapper
> Phone:      +61 8 93882900
> Fax:        +61 8 93882901
> Email:      tom.lynch@ermapper.com
> Web:        http://www.ermapper.com
> Forums:     http://forum.ermapper.com
> 



From holl at gdf-hannover.de  Thu Sep 21 07:43:52 2006
From: holl at gdf-hannover.de (Stephan Holl)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OCI-geometry recognition
Message-ID: <20060921134352.201db1d4@butan.gdf-hannover.de>

Dear developers,

I am working with an Oracle db storing geographic data. When copying a
point-shapefile into Oracle using ogr2ogr everything is fine.

ogr2ogr -f "OCI" -nlt POINT -nln spearfish_bugsites
OCI:usr/pwd@oracle bugsites.shp

Querying the database with ogrinfo gives the following (strange) result
about the geometry:

ogrinfo -al -so OCI:usr/pwd@oracle spearfish_bugsites
INFO: Open of `OCI:usr/pwd@oracle'
using driver `OCI' successful.
Layer name: SPEARFISH_BUGSITES
Geometry: Unknown (any)
         ^^^^^^^^^^^^^^
Feature Count: 90
[...]

Why is this geometry-type unknown, even when I forced to create a POINT
layer?

Dumping the geometry says that points are there.

ogrinfo  OCI:usr/pwd@oracle spearfish_bugsites 
using driver `OCI' successful.
Layer name: SPEARFISH_BUGSITES
Geometry: Unknown (any)
[...]
FID Column = OGR_FID
Geometry Column = ORA_GEOMETRY
cat: Integer (11.0)
str1: String (80.0)
OGRFeature(SPEARFISH_BUGSITES):1
  cat (Integer) = 1
  str1 (String) = Beetle site
  POINT (590232 4915039 0)
 ^^^^^^^^
[...]
OGRFeature(SPEARFISH_BUGSITES):90
  cat (Integer) = 2
  str1 (String) = Beetle site
  POINT (590430 4915204 0)

Is this an error on my side using ogr2ogr or some Oracle-oddities?

I found this problematic when I tryed to load a layer directly into
QGIS, which consequently answers
UNKNOWN WKBTYPE ENCOUNTERED.

What can I do?

Thanks in advance

	Stephan Holl

-- 
GDF Hannover - Solutions for spatial data analysis and remote sensing
Hannover Office      -     Mengendamm 16d      -     D-30177 Hannover
Internet: www.gdf-hannover.de      -      Email: holl@gdf-hannover.de
Phone : ++49-(0)511.39088507       -        Fax: ++49-(0)511.39088508

From andrey.kiselev at gmail.com  Thu Sep 21 09:00:52 2006
From: andrey.kiselev at gmail.com (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
Message-ID: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>

On 9/21/06, Ben Discoe <ben@vterrain.org> wrote:
> I am happy to do this work and submit it, i am just waiting to hear from you
> (or Frank, or..? Confused by GDAL's new democracy) that i should proceed.

We have discussed the issue today on IRC and now I want to come up with the
following proposal.

Unicode support in GDAL.

There are three basic statements:

1. Users work in localized environment using their native languages. That
   means we can not assume ASCII character set when working with string data
   passed to GDAL.

2. GDAL uses UTF-8 encoding internally when working with strings.

3. GDAL uses Unicode version of third-party API when it is possible.

So all strings, used in GDAL, are in UTF-8, not in plain ASCII. That means we
should convert user's input from the local encoding to UTF-8 during
interactive sessions. The opposite should be done for GDAL output. For
example, when user passes a filename as a command-line parameter to GDAL
utilities, that filename should be immediately converted to UTF-8 and only
afetrwards passed to functions like GDALOpen(). All functions, wich take
character strings as parameters, assume UTF-8 (with except of several ones,
which will do the conversion between different encodings, see below). The same
is valid for output functions. Output functions (CPLError/CPLDebug), embedded
in GDAL, should convert all strings from UTF-8 to local encoding befire
printing them. Custom error handlers should be aware of UTF-8 issue and do the
proper transformation of strings passed to them.

The string encoding pops up again when GDAL needs to call the third-party API.
UTF-8 should be converted to encoding suitable for that API. In particular,
that means we should convert UTF-8 to UTF-16 before calling CreateFile()
function in Windows implementation of VSIFOpenL().

For file format drivers the string representation should be worked out on
per-driver basis. If driver need to parse ASCII text there is no need to
convert strings to UTF-8 until they will be passed to GDAL functions.

Notes on implementation:

1. New CPL functions:

   // Convert UTF-8 encoded string into ASCII. Out-of-range characters
   // replaced with '?' in output string.
   char* CPLUTF8ToASCII(const char*);

   // Convert UTF-8 encoded string into local encoding.
   char* CPLUTF8ToLocal(const char*);

   // Convert string from local encoding to UTF-8.
   char* CPLLocalToUTF8(const char*);

   // Convert string from UTF-8 encoding into array of wchar_t elements.
   // Destination encoding is system specific.
   wchar_t* CPLUTF8ToWide(const char*);

   // Convert array of wchar_t elements into UTF-8 encoded string.
   // Source encoding is system specific.
   char* CPLWideToUTF8(wchar_t*);

2. In order to use non-ASCII characters in user input every application should
   call setlocale(LC_ALL,  "") function right after the entry point.

3. Code example. Let's look how the gdal utilities and core code should
   be changed in regard to Unicode.

   For input instead of

	pszFilename = argv[i];
	if( pszFilename )
		hDataset = GDALOpen( pszFilename, GA_ReadOnly );

   we should do

	pszFilename = CPLLocalToUTF8(argv[i]);
	if ( pszFilename )
	{
		hDataset = GDALOpen( pszFilename, GA_ReadOnly );
		CPLFree( pszFilename );
	}

   For output instead of

   	printf( "Description = %s\n", GDALGetDescription(hBand) );

   we should do

	char *pszDescription = CPLUTF8ToLocal( GDALGetDescription(hBand) );
	if ( pszDescription )
	{
   		printf( "Description = %s\n", pszDescription );
		CPLFree( pszDescription );
	}

   The filename passed to GDALOpen() in UTF-8 encoding in the code snippet
   above will be further processed in the GDAL core. On Windows instead of

   	hFile = CreateFile( pszFilename, dwDesiredAccess,
		FILE_SHARE_READ | FILE_SHARE_WRITE,
                NULL, dwCreationDisposition,  dwFlagsAndAttributes, NULL );

   we do

	wchar_t *pawcFilename = CPLUTF8ToWide( pszFilename );
	if ( pawcFilename )
	{
		// I am prefer call the wide character version explicitly
		// rather than specify _UNICODE switch.
   		hFile = CreateFileW( pawcFilename, dwDesiredAccess,
			FILE_SHARE_READ | FILE_SHARE_WRITE, NULL,
			dwCreationDisposition,  dwFlagsAndAttributes, NULL );
		CPLFree( pawcFilename );
	}

References:

1. FAQ on how to use Unicode in software:

    http://www.cl.cam.ac.uk/~mgk25/unicode.html

2. FLTK implementation of string conversion functions:

    http://svn.easysw.com/public/fltk/fltk/trunk/src/utf.c


-- 
Andrey V. Kiselev
ICQ# 26871517

From warmerdam at pobox.com  Thu Sep 21 09:26:18 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <20060921134352.201db1d4@butan.gdf-hannover.de>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>
Message-ID: <451292FA.4070200@pobox.com>

Stephan Holl wrote:
> Dear developers,
> 
> I am working with an Oracle db storing geographic data. When copying a
> point-shapefile into Oracle using ogr2ogr everything is fine.
> 
> ogr2ogr -f "OCI" -nlt POINT -nln spearfish_bugsites
> OCI:usr/pwd@oracle bugsites.shp
> 
> Querying the database with ogrinfo gives the following (strange) result
> about the geometry:
> 
> ogrinfo -al -so OCI:usr/pwd@oracle spearfish_bugsites
> INFO: Open of `OCI:usr/pwd@oracle'
> using driver `OCI' successful.
> Layer name: SPEARFISH_BUGSITES
> Geometry: Unknown (any)
>          ^^^^^^^^^^^^^^
...
> Is this an error on my side using ogr2ogr or some Oracle-oddities?
> 
> I found this problematic when I tryed to load a layer directly into
> QGIS, which consequently answers
> UNKNOWN WKBTYPE ENCOUNTERED.
> 
> What can I do?

Stephan,

I am not aware of a dependable way of determining the geometry type of an
oracle geometry column.  So the driver just returns wkbUnknown which means
any geometry type may appear.

This is not uncommon with different kinds of drivers, so if QGIS can't handle
it, I think QGIS should be improved.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Thu Sep 21 09:40:10 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
Message-ID: <4512963A.1080706@pobox.com>

Andrey Kiselev wrote:
> On 9/21/06, Ben Discoe <ben@vterrain.org> wrote:
>> I am happy to do this work and submit it, i am just waiting to hear 
>> from you
>> (or Frank, or..? Confused by GDAL's new democracy) that i should proceed.
> 
> We have discussed the issue today on IRC and now I want to come up with the
> following proposal.
> 
> Unicode support in GDAL.
> 
> There are three basic statements:
> 
> 1. Users work in localized environment using their native languages. That
>   means we can not assume ASCII character set when working with string data
>   passed to GDAL.

Andrey,

This seems reasonable.

> 2. GDAL uses UTF-8 encoding internally when working with strings.

This seems like a good idea.

> 3. GDAL uses Unicode version of third-party API when it is possible.

I'm not so sure about this, but clearly we don't want to dumb down to ascii
when going to third party apis if it is avoidable.

A couple notes:

  1) I think we should be extending the CPLString class methods to going
     between the various representation and try to use those in preference
     to C functions.  Mainly I suggest this to reduce the amount of keeping
     track of pointers and freeing we would have to do.  We might still want
     the C function interface for some purposes.

  2) Who would be doing this work?

BTW, to prepare it as a formal RFC just write it up as a DOX file in the
gdal/rfc directory and add to the list in rfc_list.dox.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From holl at gdf-hannover.de  Thu Sep 21 09:48:10 2006
From: holl at gdf-hannover.de (Stephan Holl)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <451292FA.4070200@pobox.com>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>
	<451292FA.4070200@pobox.com>
Message-ID: <20060921154810.03d97e00@butan.gdf-hannover.de>

Hello Frank,

On Thu, 21 Sep 2006 09:26:18 -0400 Frank Warmerdam
<warmerdam@pobox.com> wrote:

> Stephan Holl wrote:
> > Dear developers,
> > 
> > I am working with an Oracle db storing geographic data. When
> > copying a point-shapefile into Oracle using ogr2ogr everything is
> > fine.
> > 
> > ogr2ogr -f "OCI" -nlt POINT -nln spearfish_bugsites
> > OCI:usr/pwd@oracle bugsites.shp
> > 
> > Querying the database with ogrinfo gives the following (strange)
> > result about the geometry:
> > 
> > ogrinfo -al -so OCI:usr/pwd@oracle spearfish_bugsites
> > INFO: Open of `OCI:usr/pwd@oracle'
> > using driver `OCI' successful.
> > Layer name: SPEARFISH_BUGSITES
> > Geometry: Unknown (any)
> >          ^^^^^^^^^^^^^^
> ...
> > Is this an error on my side using ogr2ogr or some Oracle-oddities?
> > 
> > I found this problematic when I tryed to load a layer directly into
> > QGIS, which consequently answers
> > UNKNOWN WKBTYPE ENCOUNTERED.
> > 
> > What can I do?
> 
> Stephan,
> 
> I am not aware of a dependable way of determining the geometry type
> of an oracle geometry column.  So the driver just returns wkbUnknown
> which means any geometry type may appear.

OK. Thanks for that. I did not know.

> 
> This is not uncommon with different kinds of drivers, so if QGIS
> can't handle it, I think QGIS should be improved.

In what way? That it can deal with wkbUnknown or that it can 'identify'
the correct geometry by itself?

TIA

	Stephan

-- 
GDF Hannover - Solutions for spatial data analysis and remote sensing
Hannover Office      -     Mengendamm 16d      -     D-30177 Hannover
Internet: www.gdf-hannover.de      -      Email: holl@gdf-hannover.de
Phone : ++49-(0)511.39088507       -        Fax: ++49-(0)511.39088508

From warmerdam at pobox.com  Thu Sep 21 10:02:05 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <20060921154810.03d97e00@butan.gdf-hannover.de>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>	<451292FA.4070200@pobox.com>
	<20060921154810.03d97e00@butan.gdf-hannover.de>
Message-ID: <45129B5D.4010508@pobox.com>

Stephan Holl wrote:
>> This is not uncommon with different kinds of drivers, so if QGIS
>> can't handle it, I think QGIS should be improved.
> 
> In what way? That it can deal with wkbUnknown or that it can 'identify'
> the correct geometry by itself?

Stephan,

Well, I was thinking in terms of working with wkbUnknown in some reasonable
way - even if it ends up having to scan some features to establish a type
or ask the user if it really needs a single geometry type.  Note that there
are drivers which return a mix of geometry types such as DGN, and potentially
OCI.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From marco.hugentobler at karto.baug.ethz.ch  Wed Sep 20 11:19:38 2006
From: marco.hugentobler at karto.baug.ethz.ch (humarco)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <45129B5D.4010508@pobox.com>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>
	<20060921154810.03d97e00@butan.gdf-hannover.de>
	<45129B5D.4010508@pobox.com>
Message-ID: <200609201519.38869.marco.hugentobler@karto.baug.ethz.ch>


Dear Stephan and Frank,

QGIS can handle data sources which return multiple geometry types, because it 
looks at the beginning of the wkb of each feature what type it has. It just 
cannot handle features with geometry type wkbUnknown (and unfortunately 2.5D 
geometries...).

Do you mean to make tests on the wkb byte sequence for a feature if it has wkb 
type unknown (0) ?

cheers,
Marco

Am Donnerstag, 21. September 2006 14:02 schrieb Frank Warmerdam:
> Stephan Holl wrote:
> >> This is not uncommon with different kinds of drivers, so if QGIS
> >> can't handle it, I think QGIS should be improved.
> >
> > In what way? That it can deal with wkbUnknown or that it can 'identify'
> > the correct geometry by itself?
>
> Stephan,
>
> Well, I was thinking in terms of working with wkbUnknown in some reasonable
> way - even if it ends up having to scan some features to establish a type
> or ask the user if it really needs a single geometry type.  Note that there
> are drivers which return a mix of geometry types such as DGN, and
> potentially OCI.
>
> Best regards,

From warmerdam at pobox.com  Thu Sep 21 10:55:05 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Wide-character filenames with GDAL file IO?
In-Reply-To: <005901c6dd43$39592a50$9b02a8c0@DellWork>
References: <005901c6dd43$39592a50$9b02a8c0@DellWork>
Message-ID: <4512A7C9.6030300@pobox.com>

Ben Discoe wrote:
> Andrey,
> 
>> -----Original Message-----
>> From: Andrey Kiselev
>> Sent: Tuesday, September 19, 2006 11:05 PM
>>
>> My concern is not only a file names, but the Unicode support 
>> for all GDAL/OGR strings.  Personally I would like to see 
>> localized field names in OGR and localized metadata in GDAL. 
> 
> I can't imagine how other GDAL/OGR would need to do charset manipulation?
> As long as the user gives UTF-8 or other 1-byte strings, GDAL/OGR can be
> charset agnostic.  It isn't doing any charset handling now for
> non-filenames, and it works just fine.  But, we can keep an eye out for
> this, should it turn up.

Ben / Andrey,

Perhaps we should look at doing a first pass implementation only for
filenames, and then look at other strings (metadata, descriptions,
OGR field values and field names) as a second pass if filenames
are where most of the benefit is.

>> But the filename issue is a good starting point.
>> I think it should be done in the following steps:
>> 1. Pick up the Unicode implementation.
>> 2. Implement appropriate CPL layer for Unicode strings.
>> 3. Convert all related CPL functions to use this new CPL 
>> layer.
> 
> I am happy to do this work and submit it, i am just waiting to hear from you
> (or Frank, or..? Confused by GDAL's new democracy) that i should proceed.

GDAL's new democracy is covered in:

   http://www.gdal.org/rfc1_pmc.html

Briefly, a disruptive change such as the UTF-8 upgrade needs to be
written up as a formal proposal to the PSC, and voted on after discussion.

I think I would like to see a 1.3.3 release before we start incorporating
UTF-8 support, and at that point we would likely consider the UTF-8 work
to be towards GDAL 1.4.0.

>> Note, that filenames often embedded in more complex 
>> structures , so we should be sure that all functions, 
>> responsible for parsing or serialization, work correct with 
>> UTF-8 strings.
> 
> Agreed.

Good point.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Thu Sep 21 10:56:16 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] libgeotiff in gdal and csv files
In-Reply-To: <451224F1.60605@novacell.com>
References: <451224F1.60605@novacell.com>
Message-ID: <4512A810.7050707@pobox.com>

John Novak wrote:
> I notice that the libtiff built into gdal 1.3.1 by default does not seem 
> to have the csv file support included.
> 
> As I need one of the projections in pcs.csv, what is the recommended 
> prcedure for including this support with the builtin libgeotiff ?
> 
> Or, should I just build with an external libgeotiff that I know has the 
> proper support included ?
> 
> BTW, I'm building on windoze ;-(

John,

My suggestion would be to build with an external libgeotiff to get "built in"
support files.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Thu Sep 21 11:12:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GDAL version problem
In-Reply-To: <4510F592.000134.18428@bj163app22.163.com>
References: <4510F592.000134.18428@bj163app22.163.com>
Message-ID: <4512ABD5.3030808@pobox.com>

wenjun636465 wrote:
>  
>    I can use the function 'const char *CPLReadLine(file *fp)' OF gdal1.2 
> version successfully.But now i replace the gdal1.2 with the gdal1.3.1 in 
> the same project,the function 'const char *CPLReadLine(file *fp)' can't 
> run successfully.why?is it the version problem?

ZhangWenjun,

I've skimmed through the code, and I don't see any
obvious reason it would work differently now than in
GDAL 1.2.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Thu Sep 21 11:39:16 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>
	<4511AB11.2000907@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>

This is indeed interesting.  I took the sample and changed the filename too.   I tried gdalinfo and it works.    But my code still wasn't working (corrupt XML file error).  So, I made this very simple program, even switched to the C API.  And it does not work.   I've looked at gdalinfo.c and can't see why there would be any difference.   Someone on the list emailed and suggested I avoid spaces in my filenames.  I've done that too, and still doesn't work yet gdalinfo.exe does.
 
*******************************************************************
#include "gdal.h"

int main() {

GDALAllRegister();

const char* fname = "c:\\testimages\\tstimage";

GDALDatasetH ds = GDALOpen(fname,GA_ReadOnly);

return 0;

}

**************************************************

The exact error is:

"ERROR 1: Corrupt or empty VRT source XML document."

Which i've traced back as described before to gdalsourcerasterband.cpp:286 where it appears that while processing the XML elements it expects only XML elements, not attributes.  When it hits the first attribute of VRTRasterBand it throws this error.

I'm not sure if I'm confused why my code doesn't work, or if I'm confused that the gdalinfo code does work !

Sincerely, Confused in New Hampshire

 


________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Wed 9/20/2006 4:56 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] RE: VRT File Format



Matt Hanson wrote:
> So, can anyone verify VRT files work ?    My sample VRT is as simple as the one in the documentation and GDAL is not parsing it correctly.

Matt,

I changed the SourceFilename to point to a file on my system, and then
gdalinfo on the file worked for me.  This was with GDAL from CVS.

Best regards,

> Encountered another problem with the VRT files, but different then my other post - to work around that issue for now I am using absolute pathnames.   But when I try to read in the VRT file below I get
> ERROR 1: Corrupt of empty VRT source XML document.
> 
> Here's my VRT file:
> 
> *********************************************************************************************
> <VRTDataset rasterXSize="400" rasterYSize="400">
>
> <VRTRasterBand dataType="Int16" band="1">
>
> <SimpleSource>
>
> <SourceFilename>C:\Documents and Settings\mhanson\Flux\testimages\MISI_28jun02</SourceFilename>
>
> <SourceBand>1</SourceBand>
>
> <SrcRect xOff="0" yOff="0" xSize="400" ySize="400"/>
>
> <DstRect xOff="0" yOff="0" xSize="400" ySize="400"/>
>
> </SimpleSource>
>
> </VRTRasterBand>
>
> </VRTDataset>
>
> ********************************************************************
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
>
>


--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From mateusz at loskot.net  Thu Sep 21 11:44:28 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
Message-ID: <4512B35C.9060904@loskot.net>

Andrey Kiselev wrote:
> We have discussed the issue today on IRC and now I want to come up with the
> following proposal.
> 
> Unicode support in GDAL.
> 
> There are three basic statements:
> 
> 1. Users work in localized environment using their native languages. That
>   means we can not assume ASCII character set when working with string data
>   passed to GDAL.

+1

> 2. GDAL uses UTF-8 encoding internally when working with strings.

+1

> 3. GDAL uses Unicode version of third-party API when it is possible.

+1

> So all strings, used in GDAL, are in UTF-8, not in plain ASCII. That
> means we should convert user's input from the local encoding to UTF-8 during
> interactive sessions. The opposite should be done for GDAL output.

Is my understanding correct that we won't reimplement GDAL drivers,
for example Shape to accept UTF-8?
So, strings will be converted to/from ASCII when reading/writing strings
into GDAL internal buffers, to UTF-8 ?

AFAI understand, the data flow for sample OGR data looks as follows:

user's input -> convert to UTF-8 -> manipulate -> convert to ASCII
   -> send to OGR driver -> write to dataset

However, it's still not full Unicode support, because drivers
still accept non-Unicode.

I'm a bit confused :-)

> All functions, wich take
> character strings as parameters, assume UTF-8 (with except of several ones,
> which will do the conversion between different encodings, see below).

OK.

> The same is valid for output functions.
> Output functions (CPLError/CPLDebug), embedded
> in GDAL, should convert all strings from UTF-8 to local encoding befire
> printing them. Custom error handlers should be aware of UTF-8 issue and
> do the proper transformation of strings passed to them.

OK.

> The string encoding pops up again when GDAL needs to call the
> third-party API.
> UTF-8 should be converted to encoding suitable for that API. In particular,
> that means we should convert UTF-8 to UTF-16 before calling CreateFile()
> function in Windows implementation of VSIFOpenL().

OK

> For file format drivers the string representation should be worked out on
> per-driver basis. If driver need to parse ASCII text there is no need to
> convert strings to UTF-8 until they will be passed to GDAL functions.

I see, now my questions from above have been answered.
Thought, I still think drivers should also support Unicode, at least
OGR drivers, to be able to deal with i18n'ized
strings in feature attributes.

> Notes on implementation:
> [...]

OK.

> 2. FLTK implementation of string conversion functions:
> 
>    http://svn.easysw.com/public/fltk/fltk/trunk/src/utf.c

And functions reference:

http://www.easysw.com/~mike/fltk/doc-2.0/html/utf_8h.html

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Sep 21 12:46:49 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
In-Reply-To: <0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>	<4511AB11.2000907@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>
Message-ID: <4512C1F9.1020202@pobox.com>

Matt Hanson wrote:
> This is indeed interesting.  I took the sample and changed the filename too.   I tried gdalinfo and it works.    But my code still wasn't working (corrupt XML file error).  So, I made this very simple program, even switched to the C API.  And it does not work.   I've looked at gdalinfo.c and can't see why there would be any difference.   Someone on the list emailed and suggested I avoid spaces in my filenames.  I've done that too, and still doesn't work yet gdalinfo.exe does.
>  
> *******************************************************************
> #include "gdal.h"
> 
> int main() {
> 
> GDALAllRegister();
> 
> const char* fname = "c:\\testimages\\tstimage";
> 
> GDALDatasetH ds = GDALOpen(fname,GA_ReadOnly);
> 
> return 0;
> 
> }
> 
> **************************************************
> 
> The exact error is:
> 
> "ERROR 1: Corrupt or empty VRT source XML document."
> 
> Which i've traced back as described before to gdalsourcerasterband.cpp:286 where it appears that while processing the XML elements it expects only XML elements, not attributes.  When it hits the first attribute of VRTRasterBand it throws this error.
> 
> I'm not sure if I'm confused why my code doesn't work, or if I'm confused that the gdalinfo code does work !
> 
> Sincerely, Confused in New Hampshire

Matt,

The conclusion I would take from this is that you have multiple
versions of the GDAL DLL or shared library and you get getting
these different version in the two cases for some reason or other.

There was a fix in the VRT code in the last month or two that might
have been related.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mhanson at photon.com  Thu Sep 21 13:37:52 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>	<4511AB11.2000907@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>
	<4512C1F9.1020202@pobox.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278590@pj-exchange.photon.com>

Frank , you are correct about two different versions:
the gdalinfo I was using was built on my cygwin a while ago: 1.3.1 (2005/10/04)
and of course the library I was linking to was newer: 1.3.2 from CVS (2006/05/02), AND I'm building with Visual Studio.
 
So, I called gdalinfo.exe, which is the CVS version from a week or two ago, and that generates the same error as my simple program.  So, there still seems to be a bug It looks like this is probably an issue with the Windows build.   I'm currently rebuilding my cygwin with the same version as windows to verify, but I suspect that since it ran for you that I won't have a problem with it.
 
Any suggestions?
 
 

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Thu 9/21/2006 12:46 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] RE: VRT File Format



Matt Hanson wrote:
> This is indeed interesting.  I took the sample and changed the filename too.   I tried gdalinfo and it works.    But my code still wasn't working (corrupt XML file error).  So, I made this very simple program, even switched to the C API.  And it does not work.   I've looked at gdalinfo.c and can't see why there would be any difference.   Someone on the list emailed and suggested I avoid spaces in my filenames.  I've done that too, and still doesn't work yet gdalinfo.exe does.
> 
> *******************************************************************
> #include "gdal.h"
>
> int main() {
>
> GDALAllRegister();
>
> const char* fname = "c:\\testimages\\tstimage";
>
> GDALDatasetH ds = GDALOpen(fname,GA_ReadOnly);
>
> return 0;
>
> }
>
> **************************************************
>
> The exact error is:
>
> "ERROR 1: Corrupt or empty VRT source XML document."
>
> Which i've traced back as described before to gdalsourcerasterband.cpp:286 where it appears that while processing the XML elements it expects only XML elements, not attributes.  When it hits the first attribute of VRTRasterBand it throws this error.
>
> I'm not sure if I'm confused why my code doesn't work, or if I'm confused that the gdalinfo code does work !
>
> Sincerely, Confused in New Hampshire

Matt,

The conclusion I would take from this is that you have multiple
versions of the GDAL DLL or shared library and you get getting
these different version in the two cases for some reason or other.

There was a fix in the VRT code in the last month or two that might
have been related.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From dron at ak4719.spb.edu  Thu Sep 21 13:53:51 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512B35C.9060904@loskot.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<4512B35C.9060904@loskot.net>
Message-ID: <20060921175351.GA5933@ak4719.spb.edu>

On Thu, Sep 21, 2006 at 05:44:28PM +0200, Mateusz Loskot wrote:
> Is my understanding correct that we won't reimplement GDAL drivers,
> for example Shape to accept UTF-8?
> So, strings will be converted to/from ASCII when reading/writing strings
> into GDAL internal buffers, to UTF-8 ?

...

> > For file format drivers the string representation should be worked out on
> > per-driver basis. If driver need to parse ASCII text there is no need to
> > convert strings to UTF-8 until they will be passed to GDAL functions.
> 
> I see, now my questions from above have been answered.
> Thought, I still think drivers should also support Unicode, at least
> OGR drivers, to be able to deal with i18n'ized
> strings in feature attributes.

You are absolutely right. Moreover, it is my primary goal to add Unicode
support to PG driver (I want localized table column names). But not all
file formats support non-ASCII characters. For example, various .HDR
labeled rasters are just 7-bit ASCII text files and it is not a good
idea to write 8-bit strings in such a files. When you need to pass
strings, extracted from such file outside the driver (e.g., in
SetMetadata() call), you should convert them to UTF-8. If you just want
to use extracted strings internally in driver, there is no need in any
conversions.

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mateusz at loskot.net  Thu Sep 21 14:46:11 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060921175351.GA5933@ak4719.spb.edu>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>
	<20060921175351.GA5933@ak4719.spb.edu>
Message-ID: <4512DDF3.4050900@loskot.net>

Andrey Kiselev wrote:
> On Thu, Sep 21, 2006 at 05:44:28PM +0200, Mateusz Loskot wrote:
>> Is my understanding correct that we won't reimplement GDAL drivers,
>> for example Shape to accept UTF-8?
>> So, strings will be converted to/from ASCII when reading/writing strings
>> into GDAL internal buffers, to UTF-8 ?
> 
> ...
> 
>>> For file format drivers the string representation should be worked out on
>>> per-driver basis. If driver need to parse ASCII text there is no need to
>>> convert strings to UTF-8 until they will be passed to GDAL functions.
>> I see, now my questions from above have been answered.
>> Thought, I still think drivers should also support Unicode, at least
>> OGR drivers, to be able to deal with i18n'ized
>> strings in feature attributes.
> 
> You are absolutely right. Moreover, it is my primary goal to add Unicode
> support to PG driver (I want localized table column names).

Andrey,

Now, it's clear for me. Thanks!
Yes, I also think it could be a good idea to have localized
attributes stored in Shapefile, MapInfo files
and - what's quite obvious - GML, KML and CSV.
There are also ESRI Personal GeoDatbase (here I'm not sure about UTF-8),
Oracle and MySQL databases which also can store Unicode strings and then
we could use UTF-8 encoding on client side.

I used ISO-8859-2 ASCII subset in Shapefile files to be able
to store polish strings, but I believe it should be
possible to store UTF-8. What do you think? Frank?

> But not all file formats support non-ASCII characters.

Yes, I suppose.
May be we could try to compose a list of formats that are
Unicode-friendly and on what conditions.
What do you think?

> For example, various .HDR
> labeled rasters are just 7-bit ASCII text files and it is not a good
> idea to write 8-bit strings in such a files.

Absolutely, right.

> When you need to pass strings, extracted from such file outside the driver
> (e.g., in SetMetadata() call), you should convert them to UTF-8. If you just want
> to use extracted strings internally in driver, there is no need in any
> conversions.

Yes, it's how I imagine it should work.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Sep 21 15:00:46 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512DDF3.4050900@loskot.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>
	<4512DDF3.4050900@loskot.net>
Message-ID: <4512E15E.3000808@loskot.net>

Mateusz Loskot wrote:
> May be we could try to compose a list of formats that are 
> Unicode-friendly and on what conditions. What do you think?

I checked if ArcGIS handles Unicode in Shapefile and it seems it's
officially supported, though I'm not the ArcGIS user but I've only read
its manual.

Also, ArcSDE provide some/limited Unicode support.

ESRI Personal Geodatabase supports Unicode well.


Here is a bunch of URLs:


FAQ: Does ArcGIS Desktop support Unicode?

<http://support.esri.com/index.cfm?fa=knowledgebase.techarticles.articleShow&d=27345>


ArcSDE geodatabases have limited support for Unicode.

<http://support.esri.com/index.cfm?fa=knowledgebase.techarticles.articleShow&d=27341>

HOWTO:  Read and write Shapefile and dBASE file encoded in various
code pages

<http://support.esri.com/index.cfm?fa=knowledgebase.techarticles.articleShow&d=21106>

Interesting quotes:
"Note: You can now store Shapefile in UTF-8. However, Shapefile encoded
in UTF-8 will only be recognized in ArcGIS Desktop."

I'm not sure how to understand this quote, but I also believe
every client software that works with Shapefile format is free to
support Unicode in Shapefile files, isn't it?


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Sep 21 16:17:13 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512E15E.3000808@loskot.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>	<4512DDF3.4050900@loskot.net>
	<4512E15E.3000808@loskot.net>
Message-ID: <4512F349.3060506@pobox.com>

Mateusz Loskot wrote:
> Interesting quotes:
> "Note: You can now store Shapefile in UTF-8. However, Shapefile encoded
> in UTF-8 will only be recognized in ArcGIS Desktop."
> 
> I'm not sure how to understand this quote, but I also believe
> every client software that works with Shapefile format is free to
> support Unicode in Shapefile files, isn't it?

Mateusz,

I presume the above note is because there is no "standard" way of indicating
that text in a .dbf file is in UTF-8.  I persume ArcGIS is using some custom
flag to keep track of this.  If we can figure out what they did, we could
also honour it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From takubo at saruga-tondara.net  Thu Sep 21 16:24:07 2006
From: takubo at saruga-tondara.net (Akio Takubo)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
Message-ID: <20060922052407.e13c8755.takubo@saruga-tondara.net>

Dear Andrey and all developers.

 I've read "Wide-character filenames " thread with much interest these days. 
And I read draft document for Unicode support. It is great to be improving 
non-ASCII charcters support! So I have some comments for draft.

 At first, as Ben pointed out, I think that filename (or related with filesystem) issue 
and data(attribute name, attribute data, etc...) issue  are some diffrent topic.

 In this draft, it seems that supported encodings are following three types.
+ ASCII
+ UTF-8(and UTF-16)
+ local encoding
So this framework has some limitation, i think. If GDAL/OGR convert to 
UTF-8 internally, this conversion may break information 
when shp file have encoding other than local one.
 For example, Can a user, who uses Windows with Latin1(CP1252), read 
shapefile with Shift JIS(CP932) (most japanese use shp file with CP932) correctly?
I think that we cannot know what encoding is used in each shp file automatically.

At least, we can manipurate non-ASCII contents with current GDAL/OGR generally, 
as a client which uses GDAL/OGR consider contents's encoding.
Now we can receive raw byte sequence from GDAL/OGR, 
we can convert it to strings specified encodings. 
In QGIS, when a user open shp  (or other supported file), he need to 
select encoding which this file has. And reading attribute via OGR 
and convert from selected encoding to unicode(it is QGIS's internal encoding). 
So we can read contents with various encodings.

If GDAL/OGR will use UTF-8 internally, It is better way that add API 
for specifying encoding for each datasource (not each driver or not per system) 
is needed (maybe default is local encoding), I think. 
Depends on file format, this setting can be ignored, of course.

 Client <------------------> GDAL/OGR <-------------------> datasource
 (local encoding)                (UTF-8)                           (user setting/ or driver specific)


 I hope my comments will help you.

Thanks, 

 Akio Takubo
  From Tokyo, Japan

On Thu, 21 Sep 2006 17:00:52 +0400
"Andrey Kiselev" <andrey.kiselev@gmail.com> wrote:

> On 9/21/06, Ben Discoe <ben@vterrain.org> wrote:
> > I am happy to do this work and submit it, i am just waiting to hear from you
> > (or Frank, or..? Confused by GDAL's new democracy) that i should proceed.
> 
> We have discussed the issue today on IRC and now I want to come up with the
> following proposal.
> 
> Unicode support in GDAL.
> 
> There are three basic statements:
> 
> 1. Users work in localized environment using their native languages. That
>    means we can not assume ASCII character set when working with string data
>    passed to GDAL.
> 
> 2. GDAL uses UTF-8 encoding internally when working with strings.
> 
> 3. GDAL uses Unicode version of third-party API when it is possible.
> 
> So all strings, used in GDAL, are in UTF-8, not in plain ASCII. That means we
> should convert user's input from the local encoding to UTF-8 during
> interactive sessions. The opposite should be done for GDAL output. For
> example, when user passes a filename as a command-line parameter to GDAL
> utilities, that filename should be immediately converted to UTF-8 and only
> afetrwards passed to functions like GDALOpen(). All functions, wich take
> character strings as parameters, assume UTF-8 (with except of several ones,
> which will do the conversion between different encodings, see below). The same
> is valid for output functions. Output functions (CPLError/CPLDebug), embedded
> in GDAL, should convert all strings from UTF-8 to local encoding befire
> printing them. Custom error handlers should be aware of UTF-8 issue and do the
> proper transformation of strings passed to them.
> 
> The string encoding pops up again when GDAL needs to call the third-party API.
> UTF-8 should be converted to encoding suitable for that API. In particular,
> that means we should convert UTF-8 to UTF-16 before calling CreateFile()
> function in Windows implementation of VSIFOpenL().
> 
> For file format drivers the string representation should be worked out on
> per-driver basis. If driver need to parse ASCII text there is no need to
> convert strings to UTF-8 until they will be passed to GDAL functions.
> 
> Notes on implementation:
> 
> 1. New CPL functions:
> 
>    // Convert UTF-8 encoded string into ASCII. Out-of-range characters
>    // replaced with '?' in output string.
>    char* CPLUTF8ToASCII(const char*);
> 
>    // Convert UTF-8 encoded string into local encoding.
>    char* CPLUTF8ToLocal(const char*);
> 
>    // Convert string from local encoding to UTF-8.
>    char* CPLLocalToUTF8(const char*);
> 
>    // Convert string from UTF-8 encoding into array of wchar_t elements.
>    // Destination encoding is system specific.
>    wchar_t* CPLUTF8ToWide(const char*);
> 
>    // Convert array of wchar_t elements into UTF-8 encoded string.
>    // Source encoding is system specific.
>    char* CPLWideToUTF8(wchar_t*);
> 
> 2. In order to use non-ASCII characters in user input every application should
>    call setlocale(LC_ALL,  "") function right after the entry point.
> 
> 3. Code example. Let's look how the gdal utilities and core code should
>    be changed in regard to Unicode.
> 
>    For input instead of
> 
> 	pszFilename = argv[i];
> 	if( pszFilename )
> 		hDataset = GDALOpen( pszFilename, GA_ReadOnly );
> 
>    we should do
> 
> 	pszFilename = CPLLocalToUTF8(argv[i]);
> 	if ( pszFilename )
> 	{
> 		hDataset = GDALOpen( pszFilename, GA_ReadOnly );
> 		CPLFree( pszFilename );
> 	}
> 
>    For output instead of
> 
>    	printf( "Description = %s\n", GDALGetDescription(hBand) );
> 
>    we should do
> 
> 	char *pszDescription = CPLUTF8ToLocal( GDALGetDescription(hBand) );
> 	if ( pszDescription )
> 	{
>    		printf( "Description = %s\n", pszDescription );
> 		CPLFree( pszDescription );
> 	}
> 
>    The filename passed to GDALOpen() in UTF-8 encoding in the code snippet
>    above will be further processed in the GDAL core. On Windows instead of
> 
>    	hFile = CreateFile( pszFilename, dwDesiredAccess,
> 		FILE_SHARE_READ | FILE_SHARE_WRITE,
>                 NULL, dwCreationDisposition,  dwFlagsAndAttributes, NULL );
> 
>    we do
> 
> 	wchar_t *pawcFilename = CPLUTF8ToWide( pszFilename );
> 	if ( pawcFilename )
> 	{
> 		// I am prefer call the wide character version explicitly
> 		// rather than specify _UNICODE switch.
>    		hFile = CreateFileW( pawcFilename, dwDesiredAccess,
> 			FILE_SHARE_READ | FILE_SHARE_WRITE, NULL,
> 			dwCreationDisposition,  dwFlagsAndAttributes, NULL );
> 		CPLFree( pawcFilename );
> 	}
> 
> References:
> 
> 1. FAQ on how to use Unicode in software:
> 
>     http://www.cl.cam.ac.uk/~mgk25/unicode.html
> 
> 2. FLTK implementation of string conversion functions:
> 
>     http://svn.easysw.com/public/fltk/fltk/trunk/src/utf.c
> 
> 
> -- 
> Andrey V. Kiselev
> ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@lists.maptools.org
> http://lists.maptools.org/mailman/listinfo/gdal-dev
> 




From mateusz at loskot.net  Thu Sep 21 16:24:12 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512F349.3060506@pobox.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>	<4512DDF3.4050900@loskot.net>
	<4512E15E.3000808@loskot.net> <4512F349.3060506@pobox.com>
Message-ID: <4512F4EC.8060100@loskot.net>

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Interesting quotes: "Note: You can now store Shapefile in UTF-8.
>> However, Shapefile encoded in UTF-8 will only be recognized in
>> ArcGIS Desktop."
>> 
>> I'm not sure how to understand this quote, but I also believe every
>> client software that works with Shapefile format is free to support
>> Unicode in Shapefile files, isn't it?
> 
> Mateusz,
> 
> I presume the above note is because there is no "standard" way of 
> indicating that text in a .dbf file is in UTF-8.  I persume ArcGIS is
> using some custom flag to keep track of this.  If we can figure out
> what they did, we could also honour it.

Frank,

I see.
So, in the meantime, we could just allow users to store UTF-8 strings
the DBF file and users would be required to know/memorize if this file
contains UTF-8 data or not, on the client side.
Another option (temporary) is to set our own flags in unused fields in
the main file header, for example byte 4, until we reveal how ArcGIS
stores encoding information.

I know, it's not very genuine solution :-)

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Thu Sep 21 16:41:50 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512F349.3060506@pobox.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>	<4512DDF3.4050900@loskot.net>
	<4512E15E.3000808@loskot.net> <4512F349.3060506@pobox.com>
Message-ID: <4512F90E.1010208@loskot.net>

Frank Warmerdam wrote:
> I persume ArcGIS is using some custom flag to keep track of this. If
> we can figure out what they did, we could also honour it.

OK, I think I'm close to know how ArcGIS stores codepage
information in Shapefile.

AFAIK so far, there are two variants:

1. Language driver ID stored in the header of DBF file.
It's 29th byte, 1 byte.


2. There is an associated file with the same name as other Shapefile
files, but with .CPG extension, i.e. countries.shp and countries.cpg

Here I found some sample Shapefile file that includes .cpg:

http://www.unc.edu/courses/2006spring/geog/070/001/mkjohnso/Lab%209/?C=M;O=A


There is Shapefile.prj, Shapefile.shp, Shapefile.cpg, etc.

The .cpg file simply stores codepage identitfier

Here is a list of possible/all (?) codepage identifiers + some
helpful explanation;

http://www.forumsig.org/archive/index.php/t-439.html


How ArcGIS handles codepage using these two indicators above?

<http://support.esri.com/index.cfm?fa=knowledgebase.techArticles.articleShow&d=21106>

"When opening a shapefile and dBASE file in ArcGIS Desktop, the Desktop
programs look at the Language Driver ID (LDID) in the header of a dBASE
file, or an associated *.CPG file, which are both used to define the
code page, in order to determine the code page of the file that is read."


I'm not 100%, but it seems this information makes it possible to
implement codepage support for Shapefile, at least ;-)
So, UTF-8 may be supported as well.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mhanson at photon.com  Thu Sep 21 17:01:10 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>	<4511AB11.2000907@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>
	<4512C1F9.1020202@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D70278590@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278591@pj-exchange.photon.com>

Looks like I was wrong.
 
I built cygwin and Visual Studio binaries from CVS (dated today) and running gdalinfo with either binary on the sample VRT file in the GDAL docuementation results in the same error:
 
$ gdalinfo c:\\testimages\tstimage
 
*******************************************************
ERROR 1: Corrupt or empty VRT source XML document.
GDALOpen failed - 1
Corrupt or empty VRT source XML document.
*******************************************************
 
 


 
 

________________________________

From: Matt Hanson
Sent: Thu 9/21/2006 1:37 PM
To: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] RE: VRT File Format


Frank , you are correct about two different versions:
the gdalinfo I was using was built on my cygwin a while ago: 1.3.1 (2005/10/04)
and of course the library I was linking to was newer: 1.3.2 from CVS (2006/05/02), AND I'm building with Visual Studio.
 
So, I called gdalinfo.exe, which is the CVS version from a week or two ago, and that generates the same error as my simple program.  So, there still seems to be a bug It looks like this is probably an issue with the Windows build.   I'm currently rebuilding my cygwin with the same version as windows to verify, but I suspect that since it ran for you that I won't have a problem with it.
 
Any suggestions?
 
 

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Thu 9/21/2006 12:46 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] RE: VRT File Format



Matt Hanson wrote:
> This is indeed interesting.  I took the sample and changed the filename too.   I tried gdalinfo and it works.    But my code still wasn't working (corrupt XML file error).  So, I made this very simple program, even switched to the C API.  And it does not work.   I've looked at gdalinfo.c and can't see why there would be any difference.   Someone on the list emailed and suggested I avoid spaces in my filenames.  I've done that too, and still doesn't work yet gdalinfo.exe does.
> 
> *******************************************************************
> #include "gdal.h"
>
> int main() {
>
> GDALAllRegister();
>
> const char* fname = "c:\\testimages\\tstimage";
>
> GDALDatasetH ds = GDALOpen(fname,GA_ReadOnly);
>
> return 0;
>
> }
>
> **************************************************
>
> The exact error is:
>
> "ERROR 1: Corrupt or empty VRT source XML document."
>
> Which i've traced back as described before to gdalsourcerasterband.cpp:286 where it appears that while processing the XML elements it expects only XML elements, not attributes.  When it hits the first attribute of VRTRasterBand it throws this error.
>
> I'm not sure if I'm confused why my code doesn't work, or if I'm confused that the gdalinfo code does work !
>
> Sincerely, Confused in New Hampshire

Matt,

The conclusion I would take from this is that you have multiple
versions of the GDAL DLL or shared library and you get getting
these different version in the two cases for some reason or other.

There was a fix in the VRT code in the last month or two that might
have been related.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From armin.burger at gmx.net  Thu Sep 21 17:21:22 2006
From: armin.burger at gmx.net (Armin Burger)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4512F349.3060506@pobox.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>	<4512DDF3.4050900@loskot.net>	<4512E15E.3000808@loskot.net>
	<4512F349.3060506@pobox.com>
Message-ID: <45130252.6080209@gmx.net>

When I remeber well, you have to specify globally in the Windows 
registry if the .dbf of shapefiles are encoded in UTF. But if you do so 
and then load a shapefile not in UTF then the special characters are 
displayed wrong.

So ArcGIS has not really a flexible support for UTF, at least not for 
shapes.

armin

Frank Warmerdam wrote:
> Mateusz Loskot wrote:
>> Interesting quotes:
>> "Note: You can now store Shapefile in UTF-8. However, Shapefile encoded
>> in UTF-8 will only be recognized in ArcGIS Desktop."
>>
>> I'm not sure how to understand this quote, but I also believe
>> every client software that works with Shapefile format is free to
>> support Unicode in Shapefile files, isn't it?
> 
> Mateusz,
> 
> I presume the above note is because there is no "standard" way of 
> indicating
> that text in a .dbf file is in UTF-8.  I persume ArcGIS is using some 
> custom
> flag to keep track of this.  If we can figure out what they did, we could
> also honour it.
> 
> Best regards,

From mateusz at loskot.net  Thu Sep 21 17:51:44 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <45130252.6080209@gmx.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<4512B35C.9060904@loskot.net>	<20060921175351.GA5933@ak4719.spb.edu>	<4512DDF3.4050900@loskot.net>	<4512E15E.3000808@loskot.net>
	<4512F349.3060506@pobox.com> <45130252.6080209@gmx.net>
Message-ID: <45130970.8050004@loskot.net>

Armin Burger wrote:
> When I remeber well, you have to specify globally in the Windows 
> registry if the .dbf of shapefiles are encoded in UTF. But if you do 
> so and then load a shapefile not in UTF then the special characters 
> are displayed wrong.
> 
> So ArcGIS has not really a flexible support for UTF, at least not for
>  shapes.

Yes, you're right, although this setting applies to ArcGIS behavior.
AFAIU, it's something like turn on/off Unicode support :-)

If we want to work out more flexible solution we need to know what's the
data encoding itself, because in fact we will deal with 3 encodings:
local on user's computer, UTF-8 used by GDAL and dataset encoding.

IOW, we need to know how to read data and to convert it to UTF-8 in
order to push it to user through another conversion from UTF-8 to user's
locale. This is my understanding of the problem.

So, Shapefile's localization driver ID or .cpg file can be used here,
regarding OGR and Shapefile driver only, as an example.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From ugeni79 at gmail.com  Thu Sep 21 18:16:21 2006
From: ugeni79 at gmail.com (ugeni79@gmail.com)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
Message-ID: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>

Hi,
I am using gdal 1.3.1 on windows and when I try to read from two different
shapefiles at the same time from two different threads my application
crashes.  Is OGR (or maybe in this case shapelib) supposed to be reentrant?
If not, has anyone looked at what it would take to make it reentrant?
Any help would be greatly appreciated!
Thx!
-eugene
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060921/6233ebda/attachment.html
From holger.laebe at gmx.de  Fri Sep 22 02:06:03 2006
From: holger.laebe at gmx.de (=?ISO-8859-15?Q?Holger_L=E4be?=)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Problem with ogr2ogr and S-57 data
Message-ID: <45137D4B.3040309@gmx.de>

Hi,

i'm trying to convert a S-57 inland enc cell to ESRI Shapefile. The 
railways and roads however are'nt correctly converted.

It seems as there are multiple, disjunct segements in one geometry
object, but this is misinterpreted(?) by ogr2ogr. They are placed as one
polyline with connections across the enc cell area.

Any ideas ?

Best regards,
Holger




From warmerdam at pobox.com  Fri Sep 22 03:15:43 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Problem with ogr2ogr and S-57 data
In-Reply-To: <45137D4B.3040309@gmx.de>
References: <45137D4B.3040309@gmx.de>
Message-ID: <45138D9F.1070508@pobox.com>

Holger L?be wrote:
> Hi,
> 
> i'm trying to convert a S-57 inland enc cell to ESRI Shapefile. The 
> railways and roads however are'nt correctly converted.
> 
> It seems as there are multiple, disjunct segements in one geometry
> object, but this is misinterpreted(?) by ogr2ogr. They are placed as one
> polyline with connections across the enc cell area.

Holger,

I would appreciate it if you could file a bug with an S-57 file
demonstrating the problem, and specific details (such as the feature id
and layer) I can use to isolate a feature with the problem.

Once I can reproduce it, I may be able to fix it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From Roger.Bivand at nhh.no  Fri Sep 22 03:35:55 2006
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Re: [GRASS-user] gdal and grass new problem from "is,
 but isn't" series
In-Reply-To: <451381A9.7010805@amu.edu.pl>
Message-ID: <Pine.LNX.4.44.0609220856100.17053-100000@reclus.nhh.no>

On Fri, 22 Sep 2006, [windows-1252] Jaros?aw Jasiewicz wrote:

> Roger Bivand napisa?(a):
> > Jarek:
> >
> > This feels very much like the rgdal issue with libproj.a. Did that get 
> > resolved, by the way? Is the target machine 64-bit, and the software a 
> > mixture of 32-bit and 64-bit installs? 
> >   
> Roger
> >   
> 
> Not for now
> But You're right
> It isn't 64 bit machnie but some instalers (including gdal) treat is as 
> 64 bit. Now I look for solution on that path
> 
> Anyway problem on computer wchich I try to configure is only "about 
> gdal" I have no problem with other lots of aplications - maby I shall 
> consult with gdal specialists?

I was at the Lausanne FOSS4G meeting, and issues like this were discussed, 
but not resolved. We mentioned for example having some way of software 
reporting how it had been built, because configure scripts can differ 
across software which is expected to work together. The gdal-config script 
is one example, another which is pretty complete is R CMD config with lots 
of arguments and flags, but neither of them seem to report the length of 
pointers directly. For R:

$ echo '.Machine$sizeof.pointer' | R --vanilla --quiet
> .Machine$sizeof.pointer
[1] 4
$

does work, but means asking the running program. Section 2.5 in:

http://cran.r-project.org/doc/manuals/R-admin.html

describes how sub-architectures are managed in R.

I've included a CC to the GDAL development list partly because your
situation, Jarek, is really difficult - if I understand it correctly, you
have proj, gdal, GRASS, grass-plugin, and R all working together on one
machine (i386 Linux 32-bit?, OS distribution unknown) and on trying to
install the same software on a different machine that you say GDAL
(wrongly) thinks is 64-bit (Linux, OS distribution unknown), you see
installed libraries that configure then does not pick up.

The report we saw on R-sig-geo earlier this month copied from R-sig-mac
suggests that they (on a different platform (G4/G5)) do see problems on
installation when some configure scripts choose one thing and others
something else with regard to pointer length, when shared objects are
being built for subsequent linking. Do you have the possibility to
document both machines and installations?

Unfortunately I do not have access to a 64-bit machine to play with, so I 
have no very good way of knowing what is going on here, but if it is 
possible to install a distribution such that software installed from 
source to work together does not do so, then some way of flagging what is 
going on would be valuable.

Within R for R built from source, the compile flags for shared objects in 
contributed packages (like rgdal) are taken from those used to build the R 
engine, but of course these can differ from flags used for building 
external libraries linked to the contributed package. This seems to be 
your case for libproj.a not being accepted by ./configure in the R rgdal 
package, and may be the case between the GDAL/OGR GRASS plugin and the 
GRASS libraries.

Roger


> 
> regards
> 
> Jarek
> 

-- 
Roger Bivand
Economic Geography Section, Department of Economics, Norwegian School of
Economics and Business Administration, Helleveien 30, N-5045 Bergen,
Norway. voice: +47 55 95 93 55; fax +47 55 95 95 43
e-mail: Roger.Bivand@nhh.no




From dron at ak4719.spb.edu  Fri Sep 22 05:01:16 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060922052407.e13c8755.takubo@saruga-tondara.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<20060922052407.e13c8755.takubo@saruga-tondara.net>
Message-ID: <20060922090116.GA6149@ak4719.spb.edu>

On Fri, Sep 22, 2006 at 05:24:07AM +0900, Akio Takubo wrote:
>  At first, as Ben pointed out, I think that filename (or related with
>  filesystem) issue and data(attribute name, attribute data, etc...)
>  issue  are some diffrent topic.

Akio,

These are not entirely different issues. The only different things are
the ways how filename comes to GDAL core. It can be either read from the
user's input or read from the file contents.

>  In this draft, it seems that supported encodings are following three types.
> + ASCII
> + UTF-8(and UTF-16)
> + local encoding
> So this framework has some limitation, i think. If GDAL/OGR convert to
> UTF-8 internally, this conversion may break information when shp file
> have encoding other than local one.  For example, Can a user, who uses
> Windows with Latin1(CP1252), read shapefile with Shift JIS(CP932)
> (most japanese use shp file with CP932) correctly?  I think that we
> cannot know what encoding is used in each shp file automatically.
> 
> At least, we can manipurate non-ASCII contents with current GDAL/OGR
> generally, as a client which uses GDAL/OGR consider contents's
> encoding.  Now we can receive raw byte sequence from GDAL/OGR, we can
> convert it to strings specified encodings.  In QGIS, when a user open
> shp  (or other supported file), he need to select encoding which this
> file has. And reading attribute via OGR and convert from selected
> encoding to unicode(it is QGIS's internal encoding).  So we can read
> contents with various encodings.
> 
> If GDAL/OGR will use UTF-8 internally, It is better way that add API
> for specifying encoding for each datasource (not each driver or not
> per system) is needed (maybe default is local encoding), I think.
> Depends on file format, this setting can be ignored, of course.

Excellent point! I have missed this problem completely, but it is very
important for my environment too. I will phrase the problem one more
time: what should we do if the file encoding differs from the local
system encoding and we do not have a way to know the file encoding other
than ask user.

Well, for now I do not know how to solve this. The natural solution is
to introduce configuration parameter "ENCODING" to GDALOpen/OGROpen
functions.  Unfortunately, those functions do not accept configuration
parameters.  That should be the next RFC, I think. Hopefully, we do not
need to add encoding parameter immediately, because it is independent
from the general i18n process. We can add UTF-8 support now and add
support for forcing encoding later, when the open options will be
introduced.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mateusz at loskot.net  Fri Sep 22 08:55:22 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060922052407.e13c8755.takubo@saruga-tondara.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<20060922052407.e13c8755.takubo@saruga-tondara.net>
Message-ID: <4513DD3A.8080504@loskot.net>

Akio Takubo wrote:
>  In this draft, it seems that supported encodings are following three types.
> + ASCII
> + UTF-8(and UTF-16)
> + local encoding
> So this framework has some limitation, i think. If GDAL/OGR convert to 
> UTF-8 internally, this conversion may break information 
> when shp file have encoding other than local one.
>  For example, Can a user, who uses Windows with Latin1(CP1252), read 
> shapefile with Shift JIS(CP932) (most japanese use shp file with CP932) correctly?
> I think that we cannot know what encoding is used in each shp file automatically.

Generally, I agree. But I think there are some exceptions to this rule.
I mean, if particular data format supports encoding information to be
stored in the dataset, then we will be able to use it to provide correct
conversion.
See, my latest posts about how encoding can be stored in Shapefile.
This information can be used to select/control appropriated
encoder/decoder (on the internationalization layer side) and do the job
well.


To summary, the conversion flow will look like this:

                   (1)             (2)
    Shapefile       |      GDAL     |      Local host
                    |               |
Shift JIS (CP932) ->|->    UTF-8  ->|->    Latin1 (CP1252)
                    |               |


Convertion (1) will be controled by codepage stored in
the Language driver ID (dbf) or .cpg file, if one of them is present in
the Shapefile.
Otherwise we can decide to treat Shapefile using UTF-8 (in range of
ASCII subset) encoding, by default.

Certainly, this approach may not be possible to use for every
dataformat/driver, but I think it's a good idea to use wherever it's
possible.

> At least, we can manipurate non-ASCII contents with current GDAL/OGR generally, 
> as a client which uses GDAL/OGR consider contents's encoding.

Also, currently GDAL/ORG uses ASCII which is a subset of UTF-8, in other
words, UTF-8 is a superset of ASCII, so ASCII is compatible with UTF-8
in range of 0-128 characters.

> Now we can receive raw byte sequence from GDAL/OGR, 
> we can convert it to strings specified encodings. 
> In QGIS, when a user open shp  (or other supported file), he need to 
> select encoding which this file has.

Or, for Shapefile in this example, we can detect encoding if .cpg or
Language driver ID is available.

> And reading attribute via OGR 
> and convert from selected encoding to unicode(it is QGIS's internal encoding). 
> So we can read contents with various encodings.

Yes, exactly, that's why I'm trying to express, though may be in
not very clear way.

> If GDAL/OGR will use UTF-8 internally, It is better way that add API 
> for specifying encoding for each datasource (not each driver or not per system) 
> is needed (maybe default is local encoding), I think. 

In both cases, we need to be able to use various encoders/decoders to be
able to transform X encoding to UTF-8.

> Depends on file format, this setting can be ignored, of course.
> 
>  Client <------------------> GDAL/OGR <-------------------> datasource
>  (local encoding)                (UTF-8)                           (user setting/ or driver specific)

Yes, exactly.
However, when I'm talking about "Unicode-aware driver" I'm trying to say
that we should support various encodings of the same kind of datasources.
For example, Shape driver should be able to manipulate Shapefiles
encoded in Latin1 or UTF-8 or .... whatever encoding user want's to use.

That's what I understand, generally, as an internationalization of OGR
drivers.
If I'm messing this subject too much, I appologize :-)

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net


From hobu at iastate.edu  Fri Sep 22 10:10:05 2006
From: hobu at iastate.edu (Howard Butler)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
Message-ID: <6.2.3.4.2.20060922090925.02dbd1e8@hobu.mail.iastate.edu>

No.  It would be a significant task to make OGR reentrant.  GDAL 
provides some capabilities in this regard, but OGR does not.

Howard

At 05:16 PM 9/21/2006, ugeni79@gmail.com wrote:
>Hi,
>I am using gdal 1.3.1 on windows and when I try to read from two 
>different shapefiles at the same time from two different threads my 
>application crashes.  Is OGR (or maybe in this case shapelib) 
>supposed to be reentrant?  If not, has anyone looked at what it 
>would take to make it reentrant?
>Any help would be greatly appreciated!
>Thx!
>-eugene
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@lists.maptools.org
>http://lists.maptools.org/mailman/listinfo/gdal-dev


From mateusz at loskot.net  Fri Sep 22 11:26:19 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
Message-ID: <4514009B.3010109@loskot.net>

ugeni79@gmail.com wrote:
> Hi, I am using gdal 1.3.1 on windows and when I try to read from two 
> different shapefiles at the same time from two different threads my 
> application crashes.  Is OGR (or maybe in this case shapelib)
> supposed to be reentrant?  If not, has anyone looked at what it would
> take to make it reentrant? Any help would be greatly appreciated!

Are you talking about reentrance or thread-safety?
According to my understanding, both are different concepts.
Generally, reentrance provides calls across processes, but thread-safety
works across threads in frames of single process.

Certainly, it's possible function is reentrant and thread-safe at the
same time, but also function can be thread-safe but not reentrant, etc.

For GDAL thread-safety, please refer to FAQ 10.
http://www.gdal.org/faq.html
Note, I'm not sure how up to date is this FAQ.

For OGR thread-safety, I'm inclined to say that non-mutual access is
thread-safe in OGR. I also believe that more strict thread-safety can be
achived on the client side using threading capabilities provided by CPL.
Unfortunately, it doesn't apply to reentrance, because reentrance
requires much deeper changes and policies on (low) level of single
function call.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Fri Sep 22 11:36:57 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <4514009B.3010109@loskot.net>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
	<4514009B.3010109@loskot.net>
Message-ID: <45140319.1040508@loskot.net>

Mateusz Loskot wrote:
> ugeni79@gmail.com wrote:
>> Hi, I am using gdal 1.3.1 on windows and when I try to read from two 
>> different shapefiles at the same time from two different threads my 
>> application crashes.  Is OGR (or maybe in this case shapelib)
>> supposed to be reentrant?  If not, has anyone looked at what it would
>> take to make it reentrant? Any help would be greatly appreciated!
> 
> Are you talking about reentrance or thread-safety?
> According to my understanding, both are different concepts.
> Generally, reentrance provides calls across processes, but thread-safety
------------------------------^^^^^^^^^^^^^^

Should be concurent calls safety.

Cheers

-- 
Mateusz Loskot
http://mateusz.loskot.net

From matt.wilkie at gov.yk.ca  Fri Sep 22 12:22:34 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] list of geodata torrent servers?
Message-ID: <45140DCA.7030606@gov.yk.ca>

Hi there, has anybody compiled a list of servers who serve out 
geographic or spatial data via bit torrent? I know of these, who am I 
missing?

http://mappinghacks.com/data/
http://www.geotorrent.org/
http://www.worldwinddata.com/
http://nasa1.us.archive.org/cachepacks/new/torrents/


thanks :)

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From mhanson at photon.com  Fri Sep 22 12:23:14 2006
From: mhanson at photon.com (Matt Hanson)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RE: VRT File Format
References: <0719BE42F22E0A46857DF72644EC5D70278587@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D70278588@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858B@pj-exchange.photon.com>	<0719BE42F22E0A46857DF72644EC5D7027858D@pj-exchange.photon.com>	<4511AB11.2000907@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D7027858E@pj-exchange.photon.com>
	<4512C1F9.1020202@pobox.com>
	<0719BE42F22E0A46857DF72644EC5D70278590@pj-exchange.photon.com>
	<0719BE42F22E0A46857DF72644EC5D70278591@pj-exchange.photon.com>
Message-ID: <0719BE42F22E0A46857DF72644EC5D70278593@pj-exchange.photon.com>

Ok I've just built on a linux machine and same problem. Summary:
I've built on Windows under both cygwin and Visual Studio.  Also built on fedora Core 2.
 
gdalinfo in all 3 cases, when run on the sample VRT file from the GDAL documentation (edited to point to a real file) generates the error:
 
*******************************************************
ERROR 1: Corrupt or empty VRT source XML document.
GDALOpen failed - 1
Corrupt or empty VRT source XML document.
*******************************************************
 
matt
 

________________________________

From: Matt Hanson
Sent: Thu 9/21/2006 5:01 PM
To: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] RE: VRT File Format


Looks like I was wrong.
 
I built cygwin and Visual Studio binaries from CVS (dated today) and running gdalinfo with either binary on the sample VRT file in the GDAL docuementation results in the same error:
 
$ gdalinfo c:\\testimages\tstimage
 
*******************************************************
ERROR 1: Corrupt or empty VRT source XML document.
GDALOpen failed - 1
Corrupt or empty VRT source XML document.
*******************************************************
 
 


 
 

________________________________

From: Matt Hanson
Sent: Thu 9/21/2006 1:37 PM
To: gdal-dev@lists.maptools.org
Subject: RE: [Gdal-dev] RE: VRT File Format


Frank , you are correct about two different versions:
the gdalinfo I was using was built on my cygwin a while ago: 1.3.1 (2005/10/04)
and of course the library I was linking to was newer: 1.3.2 from CVS (2006/05/02), AND I'm building with Visual Studio.
 
So, I called gdalinfo.exe, which is the CVS version from a week or two ago, and that generates the same error as my simple program.  So, there still seems to be a bug It looks like this is probably an issue with the Windows build.   I'm currently rebuilding my cygwin with the same version as windows to verify, but I suspect that since it ran for you that I won't have a problem with it.
 
Any suggestions?
 
 

________________________________

From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Thu 9/21/2006 12:46 PM
To: Matt Hanson
Cc: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] RE: VRT File Format



Matt Hanson wrote:
> This is indeed interesting.  I took the sample and changed the filename too.   I tried gdalinfo and it works.    But my code still wasn't working (corrupt XML file error).  So, I made this very simple program, even switched to the C API.  And it does not work.   I've looked at gdalinfo.c and can't see why there would be any difference.   Someone on the list emailed and suggested I avoid spaces in my filenames.  I've done that too, and still doesn't work yet gdalinfo.exe does.
> 
> *******************************************************************
> #include "gdal.h"
>
> int main() {
>
> GDALAllRegister();
>
> const char* fname = "c:\\testimages\\tstimage";
>
> GDALDatasetH ds = GDALOpen(fname,GA_ReadOnly);
>
> return 0;
>
> }
>
> **************************************************
>
> The exact error is:
>
> "ERROR 1: Corrupt or empty VRT source XML document."
>
> Which i've traced back as described before to gdalsourcerasterband.cpp:286 where it appears that while processing the XML elements it expects only XML elements, not attributes.  When it hits the first attribute of VRTRasterBand it throws this error.
>
> I'm not sure if I'm confused why my code doesn't work, or if I'm confused that the gdalinfo code does work !
>
> Sincerely, Confused in New Hampshire

Matt,

The conclusion I would take from this is that you have multiple
versions of the GDAL DLL or shared library and you get getting
these different version in the two cases for some reason or other.

There was a fix in the VRT code in the last month or two that might
have been related.

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org <http://osgeo.org/> 





From mbrudka at aster.pl  Fri Sep 22 13:31:02 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
Message-ID: <45141DD6.6060809@aster.pl>

ugeni79@gmail.com napisa?(a):
> Hi,
> I am using gdal 1.3.1 on windows and when I try to read from two 
> different shapefiles at the same time from two different threads my 
> application crashes. Is OGR (or maybe in this case shapelib) supposed 
> to be reentrant? If not, has anyone looked at what it would take to 
> make it reentrant?
> Any help would be greatly appreciated!
Hi,

OGR is neither reentrant nor thread-safe. There were some efforts in 
GDAL 1.3.x to make it thread safe, but the work does not seem to be 
finished. There some fundamental architectural misconceptions in OGR 
which prevents GDAL to be thread safe.
However you should not care about all of that that during mutual access 
to two different shapes from two different threads. AFAIK the code in 
OGR related with PROJ.4's thread unsafety is guarded quite well.

Regards
Marek


From szekerest at gmail.com  Fri Sep 22 14:10:31 2006
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <4514009B.3010109@loskot.net>
Message-ID: <4514270a.357cae87.0814.fffff9b1@mx.gmail.com>

Hi,

Reentrancy is a stronger concept than thread-safety, because the second
attempt to perform the operation can even come from within the same thread.


Tamas


-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Mateusz Loskot
Sent: Friday, September 22, 2006 5:26 PM
To: gdal-dev@lists.maptools.org
Subject: Re: [Gdal-dev] Is OGR reentrant?

ugeni79@gmail.com wrote:
> Hi, I am using gdal 1.3.1 on windows and when I try to read from two 
> different shapefiles at the same time from two different threads my 
> application crashes.  Is OGR (or maybe in this case shapelib)
> supposed to be reentrant?  If not, has anyone looked at what it would
> take to make it reentrant? Any help would be greatly appreciated!

Are you talking about reentrance or thread-safety?
According to my understanding, both are different concepts.
Generally, reentrance provides calls across processes, but thread-safety
works across threads in frames of single process.

Certainly, it's possible function is reentrant and thread-safe at the
same time, but also function can be thread-safe but not reentrant, etc.

For GDAL thread-safety, please refer to FAQ 10.
http://www.gdal.org/faq.html
Note, I'm not sure how up to date is this FAQ.

For OGR thread-safety, I'm inclined to say that non-mutual access is
thread-safe in OGR. I also believe that more strict thread-safety can be
achived on the client side using threading capabilities provided by CPL.
Unfortunately, it doesn't apply to reentrance, because reentrance
requires much deeper changes and policies on (low) level of single
function call.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net
_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev

-- 
No virus found in this incoming message.
Checked by AVG Free Edition.
Version: 7.1.405 / Virus Database: 268.12.8/455 - Release Date: 2006.09.22.
 

-- 
No virus found in this outgoing message.
Checked by AVG Free Edition.
Version: 7.1.405 / Virus Database: 268.12.8/455 - Release Date: 2006.09.22.
 


From rec at geodesign.com.br  Fri Sep 22 14:43:50 2006
From: rec at geodesign.com.br (Reinaldo Escada Chohfi)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GeoTiff tag Question
Message-ID: <6.2.1.2.0.20060922153935.01d03598@mailhost.geodesign.com.br>

Heloo List,

Could anyone let me know how to get the right X and Y values to go from

    Tagged_Information:
       ModelTransformationTag (4,4):
          0.50                     -9.61303488e-006 
0                4679893.77
          -7.88540724e-005 
-0.50                    0                7913730.85
          0                0                1                0
          0                0                0                1
       End_Of_Tags.

to

    Tagged_Information:
       ModelTiepointTag (2,3):
          0                0                0
          X?              Y?               0
       ModelPixelScaleTag (1,3):
          0.50           0.50            0
       End_Of_Tags.

Thanks in advance,

Reinaldo


From warmerdam at pobox.com  Fri Sep 22 15:21:38 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] GeoTiff tag Question
In-Reply-To: <6.2.1.2.0.20060922153935.01d03598@mailhost.geodesign.com.br>
References: <6.2.1.2.0.20060922153935.01d03598@mailhost.geodesign.com.br>
Message-ID: <451437C2.7040001@pobox.com>

Reinaldo Escada Chohfi wrote:
> Heloo List,
> 
> Could anyone let me know how to get the right X and Y values to go from
> 
>    Tagged_Information:
>       ModelTransformationTag (4,4):
>          0.50                     -9.61303488e-006 0                
> 4679893.77
>          -7.88540724e-005 -0.50                    0                
> 7913730.85
>          0                0                1                0
>          0                0                0                1
>       End_Of_Tags.
> 
> to
> 
>    Tagged_Information:
>       ModelTiepointTag (2,3):
>          0                0                0
>          X?              Y?               0
>       ModelPixelScaleTag (1,3):
>          0.50           0.50            0
>       End_Of_Tags.
> 
> Thanks in advance,

Reinaldo,

If you were to change the small rotational coefficients to zero you would
get:

    Tagged_Information:
       ModelTiepointTag (2,3):
          0                0                0
          4679893.77       7913730.85       0
       ModelPixelScaleTag (1,3):
          0.5              0.5              0
       End_Of_Tags.

Note that this is not an exact representation.  An exact conversion
is not possible since the tiepoint+pixelscale method can't represent
rotation.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From ugeni79 at gmail.com  Fri Sep 22 16:09:34 2006
From: ugeni79 at gmail.com (ugeni79@gmail.com)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <45141DD6.6060809@aster.pl>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>
	<45141DD6.6060809@aster.pl>
Message-ID: <7b3af6610609221309we8c0e90mde7236e070425b28@mail.gmail.com>

Given that OGR is not reentrant and is not thread safe, is there any way I
can get OgrDatasources to work for concurrent reading from different
threads? or is ot my only choice to spin off a separate process for each of
the data sources?

Marek,
I have no need for OGR to be thread safe, since I would prefer to have each
of my threads to instantiate its own OGR objects, therefore they would not
need to be protected from simultaneous access.  Are you saying that it is
the limitations of PROJ.4 that make OGR not reentrant thus causing my
problem?
Please forgive my ignorance, I am just not that familiar with the code...

Thanks for all the help!
-eugene

On 9/22/06, Marek Brudka <mbrudka@aster.pl> wrote:
>
> ugeni79@gmail.com napisa?(a):
> > Hi,
> > I am using gdal 1.3.1 on windows and when I try to read from two
> > different shapefiles at the same time from two different threads my
> > application crashes. Is OGR (or maybe in this case shapelib) supposed
> > to be reentrant? If not, has anyone looked at what it would take to
> > make it reentrant?
> > Any help would be greatly appreciated!
> Hi,
>
> OGR is neither reentrant nor thread-safe. There were some efforts in
> GDAL 1.3.x to make it thread safe, but the work does not seem to be
> finished. There some fundamental architectural misconceptions in OGR
> which prevents GDAL to be thread safe.
> However you should not care about all of that that during mutual access
> to two different shapes from two different threads. AFAIK the code in
> OGR related with PROJ.4's thread unsafety is guarded quite well.
>
> Regards
> Marek
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060922/0a8f1fbd/attachment.html
From stanley at eos.sr.unh.edu  Fri Sep 22 17:39:55 2006
From: stanley at eos.sr.unh.edu (Stanley Glidden)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Example of using gdal to display netcdf cf files with
 mapserver needed.
Message-ID: <Pine.SGI.4.10.10609221727230.1943649-100000@eos.sr.unh.edu>


I am interested in displaying netcdf cf files using gdal and mapserver
Could someone post or point me to an example of a .map file and a link to
a netcdf file it displays, and any information needed to configure gdal.
Thanks.


From warmerdam at pobox.com  Fri Sep 22 19:13:56 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <7b3af6610609221309we8c0e90mde7236e070425b28@mail.gmail.com>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>	<45141DD6.6060809@aster.pl>
	<7b3af6610609221309we8c0e90mde7236e070425b28@mail.gmail.com>
Message-ID: <45146E34.3040909@pobox.com>

ugeni79@gmail.com wrote:
> Given that OGR is not reentrant and is not thread safe, is there any way 
> I can get OgrDatasources to work for concurrent reading from different 
> threads? or is ot my only choice to spin off a separate process for each 
> of the data sources?

Eugene,

I would say that OGR has not been reviewed for threadsafety, though I
am not aware of problems with threadsafety in OGR off hand.  Of course,
with it never having been through a careful review there are likely to
be a few problems.

If you really really want concurrent reading (as opposed to syncronized
reading sliced amoung several threads), you would pretty much have to
use separate processes *or* review and fix thread safety issues in OGR
yourself.

> Marek,
> I have no need for OGR to be thread safe, since I would prefer to have 
> each of my threads to instantiate its own OGR objects, therefore they 
> would not need to be protected from simultaneous access.  Are you saying 
> that it is the limitations of PROJ.4 that make OGR not reentrant thus 
> causing my problem?
> Please forgive my ignorance, I am just not that familiar with the code...

I'm aware of two main issues with PROJ.4.  One was the static "start"
variable used by pj_init(), which I have just fixed.  And the other is
related to maintaining the grid shift file list (managed via a static
buffer) which I would claim has a low risk of actually failing.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mbrudka at aster.pl  Sat Sep 23 05:19:42 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Is OGR reentrant?
In-Reply-To: <7b3af6610609221309we8c0e90mde7236e070425b28@mail.gmail.com>
References: <7b3af6610609211516p47d10048u85d0b71a77b0f9@mail.gmail.com>	
	<45141DD6.6060809@aster.pl>
	<7b3af6610609221309we8c0e90mde7236e070425b28@mail.gmail.com>
Message-ID: <4514FC2E.7080406@aster.pl>

Hi
ugeni79@gmail.com wrote:
> Given that OGR is not reentrant and is not thread safe, is there any 
> way I can get OgrDatasources to work for concurrent reading from 
> different threads? or is ot my only choice to spin off a separate 
> process for each of the data sources?
Just because of thread safety problems I my company we sticked to GDAL 
1.26 and made it thread safe for bothWindows and Linux.  Unfortunatelly, 
patches did not enter the main GDAL repository, thought we tried.. But, 
when mutually accessing two different datasources you should not care 
about thread safety at all, if of course a datasource and all its 
products like layers, features, definitions and spatial references are 
really employed in the same thread. For example you may get into 
troubles when a spatial reference from a layer produced by datasource A 
in thread 1 is accessed in thread 2.

HTH
Marek

From warmerdam at pobox.com  Sat Sep 23 10:18:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Define/overwrite projection on shapefile
In-Reply-To: <000001c6d8d9$283b5e00$1b28c80a@i3.local>
References: <000001c6d8d9$283b5e00$1b28c80a@i3.local>
Message-ID: <4515424D.4070605@pobox.com>

Vikalpa Jetly wrote:
> How would I use ogr to set/overwrite a projection for an existing 
> shapefile? I have a wkt projection say ?dref? that I want to use to set 
> the projection. I understand that while creating a new shapefile I can use:
> 
>  
> 
> sref = osr.SpatialReference()
> 
> sref.ImportFromWkt(dref)
> 
> layer = datasource.CreateLayer(?newshape?, geom_type=ogr.wkbPolygon, srs 
> = dref)
> 
>  
> 
> How would I do this for an existing shapefile? or do I need to create a 
> copy of the shapefile?

Vikalpa,

Other than creating a complete copy of the shapefile, altering the
SRS while creating the new layer, there is no way through the OGR API
to reset the SRS of a shapefile.   There is no easy way to copy a layer.
You basically need to create a new layer, add fields one at a time,
and then create features on it one at a time.

However, the shapefile projection is just kept in a .prj file.  So you
could directly alter it, instead of going through the OGR API. One thing
to keep in mind is that shapefile's .prj files are slightly altered from
the original OGR WKT.  So you need to do sref.morphToESRI() before converting
back to wkt and writing to the file.

Something like:

   sref.osr.SpatialReference()
   sref.ImportFromWkt( dref )
   sref.MorphToESRI()
   esri_wkt = sref.ExportToWKT()
   open( 'newshape.prj', 'w' ).write( esri_wkt + '\n' )

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dron at ak4719.spb.edu  Sat Sep 23 11:34:05 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC: additional styles for text labels
In-Reply-To: <20060912160730.GA27704@ak4719.spb.edu>
References: <20060912160730.GA27704@ak4719.spb.edu>
Message-ID: <20060923153405.GA24837@ak4719.spb.edu>

On Tue, Sep 12, 2006 at 08:07:30PM +0400, Andrey Kiselev wrote:
> I want to add several new options for text label styles. I need these
> styles in order to be compatible with some complex GIS (more precisely
> with the file format used by that GIS). The code is ready to be commited
> if there will be no objections against these new options.
> 
> The new label parameters are:
> 
> w		Stretch.
> 		The stretch factor changes the width of all characters in the
> 		font by factor percent. For example, setting factor to 150
> 		results in all characters in the font being 1.5 times (ie.
> 		150%) wider. The default stretch factor is 100.
> 
> st		Strike out text.
> 
> h		Colour of the shadow of label.
> 
> m:h		New placement mode.  Every word of text attached to polyline
> 		is placed horizontally in its segment, anchor point is a
> 		center of segment.
> 
> m:a		New placement mode.  Every word of text attached to polyline
> 		is stretched to fit the segment of polyline and placed along
> 		that segment. The anchor point is a start of a segment.
> 
> p: {10,11,12}	New anchor positions relative to text bottom
> 		See the image attached. Note, that positions {1,2,3} are
> 		relative to baseline, not a bottom of text box.

There weren't any objections, so I decided commit these changes. This
doesn't affect backward compatibility and should be pretty harmless.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From warmerdam at pobox.com  Sat Sep 23 12:25:00 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC: additional styles for text labels
In-Reply-To: <20060923153405.GA24837@ak4719.spb.edu>
References: <20060912160730.GA27704@ak4719.spb.edu>
	<20060923153405.GA24837@ak4719.spb.edu>
Message-ID: <45155FDC.2000907@pobox.com>

Andrey Kiselev wrote:
> On Tue, Sep 12, 2006 at 08:07:30PM +0400, Andrey Kiselev wrote:
>> I want to add several new options for text label styles. I need these
>> styles in order to be compatible with some complex GIS (more precisely
>> with the file format used by that GIS). The code is ready to be commited
>> if there will be no objections against these new options.
>>
>> The new label parameters are:
>>
>> w		Stretch.
>> 		The stretch factor changes the width of all characters in the
>> 		font by factor percent. For example, setting factor to 150
>> 		results in all characters in the font being 1.5 times (ie.
>> 		150%) wider. The default stretch factor is 100.
>>
>> st		Strike out text.
>>
>> h		Colour of the shadow of label.
>>
>> m:h		New placement mode.  Every word of text attached to polyline
>> 		is placed horizontally in its segment, anchor point is a
>> 		center of segment.
>>
>> m:a		New placement mode.  Every word of text attached to polyline
>> 		is stretched to fit the segment of polyline and placed along
>> 		that segment. The anchor point is a start of a segment.
>>
>> p: {10,11,12}	New anchor positions relative to text bottom
>> 		See the image attached. Note, that positions {1,2,3} are
>> 		relative to baseline, not a bottom of text box.
> 
> There weren't any objections, so I decided commit these changes. This
> doesn't affect backward compatibility and should be pretty harmless.

Andrey,

Please ensure that gdal/ogr/ogr_feature_style.html gets updated.  I will
say I'm hesitant to add a great deal more complication to the OGR Feature
Style specification and related code.  Implementation is already very spotty
in existing drivers and applications, and it seems like their *ought* to
be some sort of OGR based model for feature styling we could migrate to
at some point in the future.

I'd add that I feel that while this does not break backward compatibility,
it really ought to be a formal RFC with the approval requirements that go
with it.  I didn't get around to responding to this, presumably because
it came in during my email swamping around the conference.  Since I didn't
raise the RFC issue or other concerns in a timely fashion, I'm willing to
let it pass now unless there are concerns from other PSC members.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From bfraser at geoanalytic.com  Sat Sep 23 15:03:33 2006
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] converting from .ers to .tif
References: <C4C4576E6E57D51191D30002A537C6CB081886B6@s5-shr-r1.cits.rncan.gc.ca>
Message-ID: <024001c6df42$f7675de0$160002c0@shark>

Jean-S?bastien,

  GDAL does not support .ers files directly.   However, since most .ers header files reference a data file of type "BIL" it is possible to hand craft an ESRI .hdr file header (which GDAL does support) to reference the the BIL file.  And as the .hdr header does not include a coordinate system definition, you would need to add a "-a_srs" to your gdal_translate command line.

Brent Fraser
GeoAnalytic Inc
Calgary, Alberta, Canada

  ----- Original Message ----- 
  From: Moreau ; Jean-S?bastien 
  To: gdal-dev@lists.maptools.org 
  Sent: Thursday, September 07, 2006 9:47 AM
  Subject: [Gdal-dev] converting from .ers to .tif


  Hi,

   

  I'm trying to convert some DEM files from .ers format to .tif. When I use gdalinfo on my image, I get the following output:

   

  D:\Apps\FWTools1.0.5> gdalinfo E:\Data\22k01102.ers

  Driver: EHdr/ESRI .hdr Labelled

  Size is 2798, 1409

  Coordinate System is:

  GEOGCS["NAD83",

      DATUM["North_American_Datum_1983",

          SPHEROID["GRS 1980",6378137,298.257222101,

              AUTHORITY["EPSG","7019"]],

          TOWGS84[0,0,0,0,0,0,0],

          AUTHORITY["EPSG","6269"]],

      PRIMEM["Greenwich",0,

          AUTHORITY["EPSG","8901"]],

      UNIT["degree",0.0174532925199433,

          AUTHORITY["EPSG","9108"]],

      AXIS["Lat",NORTH],

      AXIS["Long",EAST],

      AUTHORITY["EPSG","4269"]]

  Origin = (-68.250915,50.125905)

  Pixel Size = (0.00009000,-0.00009000)

  Corner Coordinates:

  Upper Left  ( -68.2509150,  50.1259050) ( 68d15'3.29"W, 50d 7'33.26"N)

  Lower Left  ( -68.2509150,  49.9990950) ( 68d15'3.29"W, 49d59'56.74"N)

  Upper Right ( -67.9990950,  50.1259050) ( 67d59'56.74"W, 50d 7'33.26"N)

  Lower Right ( -67.9990950,  49.9990950) ( 67d59'56.74"W, 49d59'56.74"N)

  Center      ( -68.1250050,  50.0625000) ( 68d 7'30.02"W, 50d 3'45.00"N)

  Band 1 Block=2798x1 Type=Byte, ColorInterp=Undefined

    NoData Value=-9999

    Metadata:

    NBITS=-1

   

  That seems to be all right. But when I try to use gdal_translate : 

   

  D:\Apps\FWTools1.0.5>gdal_translate -of GTiff E:\Data\22m01101.ers E:\Data\22m01

  101.tif

  Input file size is 2798, 1409

  0ERROR 2: CPLCalloc(): Out of memory allocating -348 bytes.

   

   

  This application has requested the Runtime to terminate it in an unusual way.

  Please contact the application's support team for more information.

   

  Is there something wrong with my command?

   

  Thanks

   

  Jean-S?bastien Moreau

   

  Centre d'information topographique de Sherbrooke
  Ressources naturelles Canada
  2144, rue King Ouest, bureau 010
  Sherbrooke (Qu?bec) J1J 2E8
  T?l. : 819-564-5600-ext 295     T?l?c. : 819-564-5698
  Courrier ?lectronique : jmoreau@RNCan.gc.ca

  Centre for Topographic Information of Sherbrooke
  Natural Resources Canada
  2144, King Street West, Suite 010
  Sherbrooke, Quebec  J1J 2E8
  Tel.:  819-564-5600-ext 295     Fax:  819-564-5698
  E-mail:  jmoreau@NRCan.gc.ca



------------------------------------------------------------------------------


  _______________________________________________
  Gdal-dev mailing list
  Gdal-dev@lists.maptools.org
  http://lists.maptools.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060923/6bbde508/attachment.html
From takubo at saruga-tondara.net  Sat Sep 23 20:20:37 2006
From: takubo at saruga-tondara.net (Akio Takubo)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060922090116.GA6149@ak4719.spb.edu>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<20060922052407.e13c8755.takubo@saruga-tondara.net>
	<20060922090116.GA6149@ak4719.spb.edu>
Message-ID: <20060924092037.e1995bd6.takubo@saruga-tondara.net>

Dear Andrey,

On Fri, 22 Sep 2006 13:01:16 +0400
Andrey Kiselev <dron@ak4719.spb.edu> wrote:

> On Fri, Sep 22, 2006 at 05:24:07AM +0900, Akio Takubo wrote:
> >  At first, as Ben pointed out, I think that filename (or related with
> >  filesystem) issue and data(attribute name, attribute data, etc...)
> >  issue  are some diffrent topic.
> 
> Akio,
> 
> These are not entirely different issues. The only different things are
> the ways how filename comes to GDAL core. It can be either read from the
> user's input or read from the file contents.

 I agree with not entirely diffrent. What I want to say is that 
filesystem may have some limitation for encoding but we may use 
all encoding for reading/writing data. Sorry for my not enough explanation.

> >  In this draft, it seems that supported encodings are following three types.
> > + ASCII
> > + UTF-8(and UTF-16)
> > + local encoding
> > So this framework has some limitation, i think. If GDAL/OGR convert to
> > UTF-8 internally, this conversion may break information when shp file
> > have encoding other than local one.  For example, Can a user, who uses
> > Windows with Latin1(CP1252), read shapefile with Shift JIS(CP932)
> > (most japanese use shp file with CP932) correctly?  I think that we
> > cannot know what encoding is used in each shp file automatically.
> > 
> > At least, we can manipurate non-ASCII contents with current GDAL/OGR
> > generally, as a client which uses GDAL/OGR consider contents's
> > encoding.  Now we can receive raw byte sequence from GDAL/OGR, we can
> > convert it to strings specified encodings.  In QGIS, when a user open
> > shp  (or other supported file), he need to select encoding which this
> > file has. And reading attribute via OGR and convert from selected
> > encoding to unicode(it is QGIS's internal encoding).  So we can read
> > contents with various encodings.
> > 
> > If GDAL/OGR will use UTF-8 internally, It is better way that add API
> > for specifying encoding for each datasource (not each driver or not
> > per system) is needed (maybe default is local encoding), I think.
> > Depends on file format, this setting can be ignored, of course.
> 
> Excellent point! I have missed this problem completely, but it is very
> important for my environment too. I will phrase the problem one more
> time: what should we do if the file encoding differs from the local
> system encoding and we do not have a way to know the file encoding other
> than ask user.
>
> Well, for now I do not know how to solve this. The natural solution is
> to introduce configuration parameter "ENCODING" to GDALOpen/OGROpen
> functions.  Unfortunately, those functions do not accept configuration
> parameters.  That should be the next RFC, I think. Hopefully, we do not
> need to add encoding parameter immediately, because it is independent
> from the general i18n process. We can add UTF-8 support now and add
> support for forcing encoding later, when the open options will be
> introduced.

 It is very complicated problem, I think. Now we can select various encoding
on web browser or text editor so there are both some metadata for encoding 
selection and user selection mechanism. I hope we can find excellent solution 
for GDAL/OGR and also use various encoding correctly. I'll post about 
your next RFC, if I notice something on it.

Best regards, 

 Akio Takubo
  From Tokyo, Japan

From takubo at saruga-tondara.net  Sat Sep 23 23:58:05 2006
From: takubo at saruga-tondara.net (Akio Takubo)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <4513DD3A.8080504@loskot.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<20060922052407.e13c8755.takubo@saruga-tondara.net>
	<4513DD3A.8080504@loskot.net>
Message-ID: <20060924125805.0d43b715.takubo@saruga-tondara.net>

Thank you for replying, Mateusz,

On Fri, 22 Sep 2006 14:55:22 +0200
Mateusz Loskot <mateusz@loskot.net> wrote:

> Akio Takubo wrote:
> >  In this draft, it seems that supported encodings are following three types.
> > + ASCII
> > + UTF-8(and UTF-16)
> > + local encoding
> > So this framework has some limitation, i think. If GDAL/OGR convert to 
> > UTF-8 internally, this conversion may break information 
> > when shp file have encoding other than local one.
> >  For example, Can a user, who uses Windows with Latin1(CP1252), read 
> > shapefile with Shift JIS(CP932) (most japanese use shp file with CP932) correctly?
> > I think that we cannot know what encoding is used in each shp file automatically.
> 
> Generally, I agree. But I think there are some exceptions to this rule.
> I mean, if particular data format supports encoding information to be
> stored in the dataset, then we will be able to use it to provide correct
> conversion.
>
> See, my latest posts about how encoding can be stored in Shapefile.
> This information can be used to select/control appropriated
> encoder/decoder (on the internationalization layer side) and do the job
> well.
>
> To summary, the conversion flow will look like this:
> 
>                    (1)             (2)
>     Shapefile       |      GDAL     |      Local host
>                     |               |
> Shift JIS (CP932) ->|->    UTF-8  ->|->    Latin1 (CP1252)
>                     |               |
> 
> 
> Convertion (1) will be controled by codepage stored in
> the Language driver ID (dbf) or .cpg file, if one of them is present in
> the Shapefile.
> Otherwise we can decide to treat Shapefile using UTF-8 (in range of
> ASCII subset) encoding, by default.

 I've read your post. Considering LDID is interesting.
About a month ago I've just talked with a japanese developer 
about dbf's LDID, he had written it in his blog,   
He and I agreed that LDID is convinience if it was set correctly, 
but providing a mechanism, for setting encoding which a user 
wants, is also important because there are some apps which 
doesn't handle LDID correctly. 
 About shapefile format, sharpmap supports LDID handling 
and provides interface for setting encoding manually. 
It seems good interface.

> Certainly, this approach may not be possible to use for every
> dataformat/driver, but I think it's a good idea to use wherever it's
> possible.

 I agree with it. PG driver is one of good example, I think.
If setting client encoding to UNICODE, we can completely read/write
data with UTF-8 regardless of db encoding.
Other example is gml driver. XML document instance declares
its own encoding. 

> > At least, we can manipurate non-ASCII contents with current GDAL/OGR generally, 
> > as a client which uses GDAL/OGR consider contents's encoding.
> 
> Also, currently GDAL/ORG uses ASCII which is a subset of UTF-8, in other
> words, UTF-8 is a superset of ASCII, so ASCII is compatible with UTF-8
> in range of 0-128 characters.

Yes, ASCII has compatiblity for UTF-8. But if raw byte sequence is not broken, 
client (not inside GDAL/OGR) which uses GDAL/OGR can also handle data with 
multibytes encoding.
Currently client must know what encoding uses, but after GDAL/OGR support 
unicode, client always uses UTF-8 and GDAL/OGR must know what encoding uses.

> > Now we can receive raw byte sequence from GDAL/OGR, 
> > we can convert it to strings specified encodings. 
> > In QGIS, when a user open shp  (or other supported file), he need to 
> > select encoding which this file has.
> 
> Or, for Shapefile in this example, we can detect encoding if .cpg or
> Language driver ID is available.
>
> > And reading attribute via OGR 
> > and convert from selected encoding to unicode(it is QGIS's internal encoding). 
> > So we can read contents with various encodings.
> 
> Yes, exactly, that's why I'm trying to express, though may be in
> not very clear way.
>
> > If GDAL/OGR will use UTF-8 internally, It is better way that add API 
> > for specifying encoding for each datasource (not each driver or not per system) 
> > is needed (maybe default is local encoding), I think. 
> 
> In both cases, we need to be able to use various encoders/decoders to be
> able to transform X encoding to UTF-8.

 Yes. As converting encode at inside of GDAL/OGR, it is needed to 
some encoding converter. Currenly in the outside of GDAL/OGR, 
some app convert encoding (QGIS, Mapserver...).

> > Depends on file format, this setting can be ignored, of course.
> > 
> >  Client <------------------> GDAL/OGR <-------------------> datasource
> >  (local encoding)                (UTF-8)                           (user setting/ or driver specific)
> 
> Yes, exactly.
> However, when I'm talking about "Unicode-aware driver" I'm trying to say
> that we should support various encodings of the same kind of datasources.
> For example, Shape driver should be able to manipulate Shapefiles
> encoded in Latin1 or UTF-8 or .... whatever encoding user want's to use.
>
> That's what I understand, generally, as an internationalization of OGR
> drivers.
> If I'm messing this subject too much, I appologize :-)

Sorry for some mistake previous post. I intended following after GDAL/OGR supports
unicode. It may be waht you said.
Client <-----(utf-8)--------> GDAL/OGR <---(Utf-8 <->  datasource encoding* )---> datasource
* driver speific/auto detected(ex shp with LDID)/user selection


Best regards, 

 Akio Takubo
  From Tokyo, Japan

From mateusz at loskot.net  Sun Sep 24 10:23:31 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060924125805.0d43b715.takubo@saruga-tondara.net>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<20060922052407.e13c8755.takubo@saruga-tondara.net>	<4513DD3A.8080504@loskot.net>
	<20060924125805.0d43b715.takubo@saruga-tondara.net>
Message-ID: <451694E3.60407@loskot.net>

Hi Akio,

Akio Takubo wrote:
> On Fri, 22 Sep 2006 14:55:22 +0200
> Mateusz Loskot <mateusz@loskot.net> wrote:
>>
>> Convertion (1) will be controled by codepage stored in
>> the Language driver ID (dbf) or .cpg file, if one of them is present in
>> the Shapefile.
>> Otherwise we can decide to treat Shapefile using UTF-8 (in range of
>> ASCII subset) encoding, by default.
> 
>  I've read your post. Considering LDID is interesting.

Yes, I also see it as pretty nice solution.

> About a month ago I've just talked with a japanese developer 
> about dbf's LDID, he had written it in his blog,

I'm curious about it, could you give the blog URL?

> He and I agreed that LDID is convinience if it was set correctly, 
> but providing a mechanism, for setting encoding which a user 
> wants, is also important because there are some apps which 
> doesn't handle LDID correctly.

Yes, I agree. I'm also aware it's not a trivial task.
Genreally, implementing fully-featured i18n scares me a lot but
it's very interesting subject for me :)

> About shapefile format, sharpmap supports LDID handling 
> and provides interface for setting encoding manually. 
> It seems good interface.

I tried to look at the code but I have no idea how to access
sharpmap's repository from its website.

I think the most important thing we need to support LDID is to have a
valid list of language drivers IDs.


The Shapefile provider for FDO uses .cpg file.
Second ctor of ShapeCPG class uses locale to set appropriate
codepage in .cpg file:

ShapeCPG::ShapeCPG (const WCHAR* name, char *locale)

https://fdoshp.osgeo.org/source/browse/fdoshp/trunk/Providers/SHP/Src/ShpRead/ShapeCPG.cpp

Next, in RowData class

https://fdoshp.osgeo.org/source/browse/fdoshp/trunk/Providers/SHP/Src/ShpRead/RowData.cpp

there are some functions to convert between codepages codes:

RowData::ConvertCodePageWin()
RowData::ConvertCodePageLinux()

and data itself:

RowData::GetData()

and the final data conversion (ie. multibyte_to_wide_cpg macro and
friends) is done using iconv on Unix and Windows API conversion
functions on Windows:

https://fdocore.osgeo.org/source/browse/fdocore/trunk/Utilities/Common/Inc/FdoCommonStringUtil.h

It can be used as an exemplar of the .cpg handling and
characters encoding conversions.

>> Certainly, this approach may not be possible to use for every
>> dataformat/driver, but I think it's a good idea to use wherever it's
>> possible.
> 
>  I agree with it. PG driver is one of good example, I think.
> If setting client encoding to UNICODE, we can completely read/write
> data with UTF-8 regardless of db encoding.
> Other example is gml driver. XML document instance declares
> its own encoding. 

Yes, also KML is XML-based.

>>> At least, we can manipurate non-ASCII contents with current GDAL/OGR generally, 
>>> as a client which uses GDAL/OGR consider contents's encoding.
>> Also, currently GDAL/ORG uses ASCII which is a subset of UTF-8, in other
>> words, UTF-8 is a superset of ASCII, so ASCII is compatible with UTF-8
>> in range of 0-128 characters.
> 
> Yes, ASCII has compatiblity for UTF-8. But if raw byte sequence is not broken, 
> client (not inside GDAL/OGR) which uses GDAL/OGR can also handle data with 
> multibytes encoding.
> Currently client must know what encoding uses, but after GDAL/OGR support 
> unicode, client always uses UTF-8 and GDAL/OGR must know what encoding uses.

This is how I understand it.

>>> If GDAL/OGR will use UTF-8 internally, It is better way that add API 
>>> for specifying encoding for each datasource (not each driver or not per system) 
>>> is needed (maybe default is local encoding), I think. 
>> In both cases, we need to be able to use various encoders/decoders to be
>> able to transform X encoding to UTF-8.
> 
>  Yes. As converting encode at inside of GDAL/OGR, it is needed to 
> some encoding converter. Currenly in the outside of GDAL/OGR, 
> some app convert encoding (QGIS, Mapserver...).

I suppose we will likely needs some external engine to achieve that,
like ICU or iconv, or something else.

May be it's reasonable to provide optional support of ICU.
Boost.Regexp works that way:
http://www.boost.org/libs/regex/doc/install.html#unicode

>>> Depends on file format, this setting can be ignored, of course.
>>>
>>>  Client <------------------> GDAL/OGR <-------------------> datasource
>>>  (local encoding)                (UTF-8)                           (user setting/ or driver specific)
>> Yes, exactly.
>> However, when I'm talking about "Unicode-aware driver" I'm trying to say
>> that we should support various encodings of the same kind of datasources.
>> For example, Shape driver should be able to manipulate Shapefiles
>> encoded in Latin1 or UTF-8 or .... whatever encoding user want's to use.
>>
>> That's what I understand, generally, as an internationalization of OGR
>> drivers.
>> If I'm messing this subject too much, I appologize :-)
> 
> Sorry for some mistake previous post. I intended following after GDAL/OGR supports
> unicode. It may be waht you said.
> Client <-----(utf-8)--------> GDAL/OGR <---(Utf-8 <->  datasource encoding* )---> datasource
> * driver speific/auto detected(ex shp with LDID)/user selection

Yes, it's exactly what I have in mind.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From dron at ak4719.spb.edu  Mon Sep 25 05:12:57 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC 5: Unicode support in GDAL
Message-ID: <20060925091257.GA549@ak4719.spb.edu>

Folks,

There is new RFC on the topic we are recently discussed:

 http://gdal.maptools.org/rfc5_unicode.html

Any comments are welcome.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From warmerdam at pobox.com  Mon Sep 25 10:27:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC 5: Unicode support in GDAL
In-Reply-To: <20060925091257.GA549@ak4719.spb.edu>
References: <20060925091257.GA549@ak4719.spb.edu>
Message-ID: <4517E769.1020601@pobox.com>

Andrey Kiselev wrote:
> Folks,
> 
> There is new RFC on the topic we are recently discussed:
> 
>  http://gdal.maptools.org/rfc5_unicode.html
> 
> Any comments are welcome.

Andrey,

1) I don't think I like the constraint that CPLString's must always be in
    UTF-8.  Instead, I think I would prefer CPLString know it's encoding,
    and that the recoding operations change the encoding "in place" within
    the CPLString.  The current recode() method still leaves us with the
    "remember to free" issue I was hoping to avoid by moving some of this
    work into the CPLString.

2) How is the "int nEncoding" parameter enumerated?  Is there some well known
    universal list of encodings mapped to integers we would be using?

3) I don't understand your comment about having to call setlocale(LC_ALL,"")
    in order to use non-ASCII characters.  Why?  I do think the RFC will need
    to address how it relates to the previous work to force things into the
    C locale at strategic points.  Perhaps that does not related since it
    was really just about numeric locale processing?

I think there is still a great deal of material that will need to be fleshed
out in the RFC before it is adoptable.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dron at ak4719.spb.edu  Mon Sep 25 12:25:42 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] RFC 5: Unicode support in GDAL
In-Reply-To: <4517E769.1020601@pobox.com>
References: <20060925091257.GA549@ak4719.spb.edu> <4517E769.1020601@pobox.com>
Message-ID: <20060925162542.GA3901@ak4719.spb.edu>

On Mon, Sep 25, 2006 at 10:27:53AM -0400, Frank Warmerdam wrote:
> 1) I don't think I like the constraint that CPLString's must always be in
>    UTF-8.  Instead, I think I would prefer CPLString know it's encoding,
>    and that the recoding operations change the encoding "in place" within
>    the CPLString.  The current recode() method still leaves us with the
>    "remember to free" issue I was hoping to avoid by moving some of this
>    work into the CPLString.

If encoding will be stored inside CPLString object you should always
remember what encoding assotiated with each object. I thought that
recode() method should return pointer to internally allocated buffer,
just like c_str() method does so there is no need to worry about its
freeing. 

> 2) How is the "int nEncoding" parameter enumerated?  Is there some
> well known universal list of encodings mapped to integers we would be
> using?

Well, I am still not know how to enumerate them in a best way, but one
of the existing lists can be choosen. This question closely related to
encoding software we will use. I am prefer ICU, it is big gun, but it
does a lot of things we need (or will need in the future). Iconv is also
a choice, but it has problems on platforms, other than glibc. Are there
any objections against ICU? String API should be defined finally only
after choosing the underlying software.

> 3) I don't understand your comment about having to call setlocale(LC_ALL,"")
>    in order to use non-ASCII characters.  Why?  I do think the RFC will need
>    to address how it relates to the previous work to force things into the
>    C locale at strategic points.  Perhaps that does not related since it
>    was really just about numeric locale processing?

setlocale(LC_ALL,"") call required to set process' locale to user's
current locale. Otherwise "C" will be used. RFC talks about conversions
between local and Unicode character sets, it is not possible without
knowlege of local system encoding, that is why we need that setlocale
call. Of course, later in the code setlocale(LC_ALL,NULL) should be
called to obtain actual value (it looks like ICU can do it itself).

Anyway, any good behaved program should do setlocale(LC_ALL,"") at
start, otherwise its behaviour will be a bit incorrect in localized
environments. Depending on program nature it can be heavily incorrect.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From warmerdam at pobox.com  Mon Sep 25 14:28:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:22 2007
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C
In-Reply-To: <000401c6e0ce$fbb84480$bf11000a@pc.asf.alaska.edu>
References: <000401c6e0ce$fbb84480$bf11000a@pc.asf.alaska.edu>
Message-ID: <45181FC5.6060203@pobox.com>

Brian S. Dixon wrote:
> Hi Frank,
> 
>   Our s/w is ANSI C, compiled with gcc ...Like I mentioned before, GDAL is
> all new to me so I have some basic questions.  It looks like GDAL is written
> in C++ ...I've never tried to utilize C++ libraries from a C program before
> (usually the other way around).  Is this possible?  Porting our code to C++
> is a much larger project...

Brian,

Conveniently GDAL has C cover functions already!

If you look in gdal.h you will see the C API.  Most of the C++ method
documentation refers to the related C entry point, though there is no
documentation for the C entry points so you need to work it out by
examining the prototypes.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mlepage at pyxisinnovation.com  Mon Sep 25 15:22:22 2006
From: mlepage at pyxisinnovation.com (Marc Lepage)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C
In-Reply-To: <45181FC5.6060203@pobox.com>
Message-ID: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>

Is GDAL C code wrapped in C++, or C++ code wrapped in C? I'm curious
about which way it goes and the issues involved. I've typically wrapped
C with C++, but these days it seems more projects are going the other
way.

-----Original Message-----
From: gdal-dev-bounces@lists.maptools.org
[mailto:gdal-dev-bounces@lists.maptools.org] On Behalf Of Frank
Warmerdam
Sent: Monday, September 25, 2006 2:28 PM
To: Brian S. Dixon
Cc: gdal-dev@lists.maptools.org
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C

Brian S. Dixon wrote:
> Hi Frank,
> 
>   Our s/w is ANSI C, compiled with gcc ...Like I mentioned before,
GDAL is
> all new to me so I have some basic questions.  It looks like GDAL is
written
> in C++ ...I've never tried to utilize C++ libraries from a C program
before
> (usually the other way around).  Is this possible?  Porting our code
to C++
> is a much larger project...

Brian,

Conveniently GDAL has C cover functions already!

If you look in gdal.h you will see the C API.  Most of the C++ method
documentation refers to the related C entry point, though there is no
documentation for the C entry points so you need to work it out by
examining the prototypes.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo,
http://osgeo.org

_______________________________________________
Gdal-dev mailing list
Gdal-dev@lists.maptools.org
http://lists.maptools.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Mon Sep 25 15:48:21 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C
In-Reply-To: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>
References: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>
Message-ID: <45183285.6020204@pobox.com>

Marc Lepage wrote:
> Is GDAL C code wrapped in C++, or C++ code wrapped in C? I'm curious
> about which way it goes and the issues involved. I've typically wrapped
> C with C++, but these days it seems more projects are going the other
> way.

Marc,

GDAL is C++ code with a C wrapper.  Some folks might also feel the need
to point out that my C++ code is more like "C with classes" than true modern
C++. :-)

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From mateusz at loskot.net  Mon Sep 25 15:48:42 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C
In-Reply-To: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>
References: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>
Message-ID: <4518329A.3090608@loskot.net>

Marc Lepage wrote:
> Is GDAL C code wrapped in C++, or C++ code wrapped in C? I'm curious
> about which way it goes and the issues involved. I've typically wrapped
> C with C++, but these days it seems more projects are going the other
> way.

GDAL is implemented in C++ language and it exposes C++ API (a bunch of
classes, etc.) and also C API (a bunch of functions and types).
So, from client's point of view, it's double-API library, but
internally implemented in C++.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From mateusz at loskot.net  Mon Sep 25 16:02:28 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Re: Using GDAL in Linux ANSI C
In-Reply-To: <45183285.6020204@pobox.com>
References: <8B5901C2B9E9094AA4028CF5E33980D7041DCC@aristotle.PyxisInnovation.local>
	<45183285.6020204@pobox.com>
Message-ID: <451835D4.7020104@loskot.net>

Frank Warmerdam wrote:
> Marc Lepage wrote:
>> Is GDAL C code wrapped in C++, or C++ code wrapped in C? I'm curious
>> about which way it goes and the issues involved. I've typically wrapped
>> C with C++, but these days it seems more projects are going the other
>> way.
> 
> Marc,
> 
> GDAL is C++ code with a C wrapper.  Some folks might also feel the need
> to point out that my C++ code is more like "C with classes" than true
> modern
> C++. :-)

Frank,

If GDAL is compiled with C++ compiler, then it's a correct C++ code.
No doubts.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From astewart at TerraGoTech.com  Mon Sep 25 16:51:24 2006
From: astewart at TerraGoTech.com (Alan Stewart)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] NITF JPEG Compression
Message-ID: <4518414C.1030509@TerraGoTech.com>

Frank Warmerdam <warmerdam at pobox.com> wrote:
> I have committed preliminary support to the GDAL NITF driver for JPEG
> (C3) compressed images.  This includes "single blocked" (one big tile) and
> multi-blocked images.  It only works for 8bit, not 12/16 bit images.  It
> does not (as far as I understand it) support lossly compressed jpeg.  The
> support is read-only, not for export.
>
> I am interested in reports of problems with the support.
>   
I've downloaded and build gdal-1.3.2 on Windows XP. All the JPEG images 
seem to be failing in the sample file set posted at 
<http://www.gwg.nga.mil/ntb/baseline/software/samplefile.html>. For 
example, in the NITF 2.0 section, U_1105A, U_1025A, U_1033A and U_1036A 
fail.

Should I be using the external JPEG library support I see in nmake.opt?

Thanks...

-- 

 Alan Stewart
 Senior Software Architect
 TerraGo Technologies, Inc.
 astewart@TerraGoTech.com
 678-391-9700 x9615

-------------- next part --------------
A non-text attachment was scrubbed...
Name: astewart.vcf
Type: text/x-vcard
Size: 307 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060925/b585409f/astewart.vcf
From mbrudka at aster.pl  Mon Sep 25 17:34:16 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
Message-ID: <45184B58.7040204@aster.pl>

Hi,

    From my painfull practice as well from the knowledge of other 
libraries and some standards comes the following rule of thumb: *use 
wide chars* and do not make *implicite* assumptions about encoding (here 
UTF8). This means that:
- GDAL should be extended with overloaded, i18n aware and wchar driven 
methods/interfaces .
- GDAL drivers should make all necessary conversion from and to wchars.

I know that this proposition is really expensive in working hours and is 
not the shortest path to i18n compliant GDAL. But I also know that such 
attempt will:
 - simplify GDAL interfaces and make them *explicite *with respect to i18n.
 - enable smooth transition for existing applications.
 - avoid yet another copy of strings, because many libraries already 
provides wchar driven interfaces.

Regards
Marek

From warmerdam at pobox.com  Mon Sep 25 18:45:13 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <45184B58.7040204@aster.pl>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<45184B58.7040204@aster.pl>
Message-ID: <45185BF9.6020009@pobox.com>

Marek Brudka wrote:
> Hi,
> 
>    From my painfull practice as well from the knowledge of other 
> libraries and some standards comes the following rule of thumb: *use 
> wide chars* and do not make *implicite* assumptions about encoding (here 
> UTF8). This means that:
> - GDAL should be extended with overloaded, i18n aware and wchar driven 
> methods/interfaces .
> - GDAL drivers should make all necessary conversion from and to wchars.
> 
> I know that this proposition is really expensive in working hours and is 
> not the shortest path to i18n compliant GDAL. But I also know that such 
> attempt will:
> - simplify GDAL interfaces and make them *explicite *with respect to i18n.
> - enable smooth transition for existing applications.
> - avoid yet another copy of strings, because many libraries already 
> provides wchar driven interfaces.

Marek,

Can you provide some more background on why a wide character solution
is preferable to UTF8?  Personally, I think the whole effort will be a
non-starter if we have to re-engineer everything to use wide characters.
I could be overruled of course.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Mon Sep 25 18:48:41 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] NITF JPEG Compression
In-Reply-To: <4518414C.1030509@TerraGoTech.com>
References: <4518414C.1030509@TerraGoTech.com>
Message-ID: <45185CC9.5070301@pobox.com>

Alan Stewart wrote:
> Frank Warmerdam <warmerdam at pobox.com> wrote:
>> I have committed preliminary support to the GDAL NITF driver for JPEG
>> (C3) compressed images.  This includes "single blocked" (one big tile) 
>> and
>> multi-blocked images.  It only works for 8bit, not 12/16 bit images.  It
>> does not (as far as I understand it) support lossly compressed jpeg.  The
>> support is read-only, not for export.
>>
>> I am interested in reports of problems with the support.
>>   
> I've downloaded and build gdal-1.3.2 on Windows XP. All the JPEG images 
> seem to be failing in the sample file set posted at 
> <http://www.gwg.nga.mil/ntb/baseline/software/samplefile.html>. For 
> example, in the NITF 2.0 section, U_1105A, U_1025A, U_1033A and U_1036A 
> fail.
> 
> Should I be using the external JPEG library support I see in nmake.opt?

Alan,

The jpeg in nitf support was implemented after the 1.3.2 release.  You can
grab a nightly CVS snapshot to test it out.  It should work with either
the internal libjpeg, or an external one.  No need to alter your configuration
for this.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From dron at ak4719.spb.edu  Tue Sep 26 03:13:57 2006
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <45185BF9.6020009@pobox.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<45184B58.7040204@aster.pl> <45185BF9.6020009@pobox.com>
Message-ID: <20060926071357.GA7749@ak4719.spb.edu>

On Mon, Sep 25, 2006 at 06:45:13PM -0400, Frank Warmerdam wrote:
> >   From my painfull practice as well from the knowledge of other 
> >libraries and some standards comes the following rule of thumb: *use 
> >wide chars* and do not make *implicite* assumptions about encoding (here 
> >UTF8). This means that:
> >- GDAL should be extended with overloaded, i18n aware and wchar driven 
> >methods/interfaces .
> >- GDAL drivers should make all necessary conversion from and to wchars.
> >
> >I know that this proposition is really expensive in working hours and is 
> >not the shortest path to i18n compliant GDAL. But I also know that such 
> >attempt will:
> >- simplify GDAL interfaces and make them *explicite *with respect to i18n.
> >- enable smooth transition for existing applications.
> >- avoid yet another copy of strings, because many libraries already 
> >provides wchar driven interfaces.
> 
> Can you provide some more background on why a wide character solution
> is preferable to UTF8?

I am seconded on this. For me it looks like 8-bit UTF-8 is the same as
wide chars in terms of multilingual support. Wide chars typically used
in Windows interfaces and we can implement necessary conversion
functions where it is needed. Most free toolkits and libraries use
UTF-8 internally and it is no problem to interface with them using our
approach.

Regards,
Andrey


-- 
Andrey V. Kiselev
ICQ# 26871517

From aykutkocak at superonline.com  Tue Sep 26 09:19:01 2006
From: aykutkocak at superonline.com (=?ISO-8859-9?Q?Aykut_KO=C7AK?=)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OGR and python: File creation question...
Message-ID: <451928C5.3040801@superonline.com>

Hi to all,

I am trying the following simple python code to create a ESRI Shape 
file. This script seems working fine. But when I checked the new file 
with ogrinfo, I can not see the field I am trying to have within SHP 
file. What am i doing wrong with this? Thanks in advance for all 
suggestions.


Regards,


Python Code:
--------------------

#
import sys,os
# Vector Mapping support
import ogr

if __name__=="__main__":
    # Create the driver to use
    drv=ogr.GetDriverByName("ESRI Shapefile")
    # Create the DataSource to be written
    ds=drv.CreateDataSource("test.shp")
    # Create a layer
    lyr=ds.CreateLayer(name='test_layer',geom_type=ogr.wkbPoint)
    # Prepare the structure of the a feature.
    field_def=ogr.FieldDefn('test1',ogr.OFTInteger)
    feature_def=ogr.FeatureDefn(name='test_feature')
    feature_def.AddFieldDefn(field_def)
    feature_def.SetGeomType(ogr.wkbPoint)
    # Create a feature using prepared structure
    feature=ogr.Feature(feature_def)
    # Set the value of the field for this feature
    feature.SetField(0,173)
    # Set the Geometry for this feature
    geom=ogr.CreateGeometryFromWkt('POINT(%f %f)' % (32.0,39.0))
    feature.SetGeometryDirectly(geom)
    # Add this new feature to the Layer
    lyr.CreateFeature(feature)
    # be sure everything written to disk
    lyr.SyncToDisk()
    # Destroy the Data Source
    ds.Destroy()
    # exit gracefully
    sys.exit(0)
   


ogrinfo results:
---------------------------------------------
oot@clown-aero:~/project/python# ogrinfo test.shp -al
INFO: Open of `test.shp'
using driver `ESRI Shapefile' successful.

Layer name: test
Geometry: Point
Feature Count: 1
Extent: (32.000000, 39.000000) - (32.000000, 39.000000)
Layer SRS WKT:
(unknown)
FID: Real (11.0)
OGRFeature(test):0
  FID (Real) =           0
  POINT (32 39)



-- 
Aykut KO?AK

 Elektronik M?hendisi
(/Electronics Engineer/)
 
 E-Posta
(/E-Mail/ )

 aykutkocak@superonline.com


From bryan at geomega.com  Tue Sep 26 10:10:20 2006
From: bryan at geomega.com (Bryan Keith)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OGR and python: File creation question...
In-Reply-To: <451928C5.3040801@superonline.com>
References: <451928C5.3040801@superonline.com>
Message-ID: <451934CC.8060501@geomega.com>

Merhaba Aykut,

See below.

Aykut KO?AK wrote:
> Hi to all,
> 
> I am trying the following simple python code to create a ESRI Shape 
> file. This script seems working fine. But when I checked the new file 
> with ogrinfo, I can not see the field I am trying to have within SHP 
> file. What am i doing wrong with this? Thanks in advance for all 
> suggestions.
> 
> 
> Regards,
> 
> 
> Python Code:
> --------------------
> 
> #
> import sys,os
> # Vector Mapping support
> import ogr
> 
> if __name__=="__main__":
>     # Create the driver to use
>     drv=ogr.GetDriverByName("ESRI Shapefile")
>     # Create the DataSource to be written
>     ds=drv.CreateDataSource("test.shp")
>     # Create a layer
>     lyr=ds.CreateLayer(name='test_layer',geom_type=ogr.wkbPoint)
>     # Prepare the structure of the a feature.
>     field_def=ogr.FieldDefn('test1',ogr.OFTInteger)

At this point in my code that works I have a line like this:

lyr.CreateField(field_def)

Hope that helps.

Bryan

>     feature_def=ogr.FeatureDefn(name='test_feature')
>     feature_def.AddFieldDefn(field_def)
>     feature_def.SetGeomType(ogr.wkbPoint)
>     # Create a feature using prepared structure
>     feature=ogr.Feature(feature_def)
>     # Set the value of the field for this feature
>     feature.SetField(0,173)
>     # Set the Geometry for this feature
>     geom=ogr.CreateGeometryFromWkt('POINT(%f %f)' % (32.0,39.0))
>     feature.SetGeometryDirectly(geom)
>     # Add this new feature to the Layer
>     lyr.CreateFeature(feature)
>     # be sure everything written to disk
>     lyr.SyncToDisk()
>     # Destroy the Data Source
>     ds.Destroy()
>     # exit gracefully
>     sys.exit(0)
>    
> 
> 
> ogrinfo results:
> ---------------------------------------------
> oot@clown-aero:~/project/python# ogrinfo test.shp -al
> INFO: Open of `test.shp'
> using driver `ESRI Shapefile' successful.
> 
> Layer name: test
> Geometry: Point
> Feature Count: 1
> Extent: (32.000000, 39.000000) - (32.000000, 39.000000)
> Layer SRS WKT:
> (unknown)
> FID: Real (11.0)
> OGRFeature(test):0
>   FID (Real) =           0
>   POINT (32 39)
> 
> 
> 

From aykutkocak at superonline.com  Tue Sep 26 14:25:10 2006
From: aykutkocak at superonline.com (=?ISO-8859-9?Q?Aykut_KO=C7AK?=)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OGR and python: File creation question...
In-Reply-To: <451934CC.8060501@geomega.com>
References: <451928C5.3040801@superonline.com> <451934CC.8060501@geomega.com>
Message-ID: <45197086.4060403@superonline.com>

Thank you for answer, working for me as well.

Bryan Keith wrote:

> Merhaba Aykut,
>
> See below.
>
> Aykut KO?AK wrote:
>
>> Hi to all,
>>
>> I am trying the following simple python code to create a ESRI Shape 
>> file. This script seems working fine. But when I checked the new file 
>> with ogrinfo, I can not see the field I am trying to have within SHP 
>> file. What am i doing wrong with this? Thanks in advance for all 
>> suggestions.
>>
>>
>> Regards,
>>
>>
>> Python Code:
>> --------------------
>>
>> #
>> import sys,os
>> # Vector Mapping support
>> import ogr
>>
>> if __name__=="__main__":
>>     # Create the driver to use
>>     drv=ogr.GetDriverByName("ESRI Shapefile")
>>     # Create the DataSource to be written
>>     ds=drv.CreateDataSource("test.shp")
>>     # Create a layer
>>     lyr=ds.CreateLayer(name='test_layer',geom_type=ogr.wkbPoint)
>>     # Prepare the structure of the a feature.
>>     field_def=ogr.FieldDefn('test1',ogr.OFTInteger)
>
>
> At this point in my code that works I have a line like this:
>
> lyr.CreateField(field_def)
>
> Hope that helps.
>
> Bryan
>
>>     feature_def=ogr.FeatureDefn(name='test_feature')
>>     feature_def.AddFieldDefn(field_def)
>>     feature_def.SetGeomType(ogr.wkbPoint)
>>     # Create a feature using prepared structure
>>     feature=ogr.Feature(feature_def)
>>     # Set the value of the field for this feature
>>     feature.SetField(0,173)
>>     # Set the Geometry for this feature
>>     geom=ogr.CreateGeometryFromWkt('POINT(%f %f)' % (32.0,39.0))
>>     feature.SetGeometryDirectly(geom)
>>     # Add this new feature to the Layer
>>     lyr.CreateFeature(feature)
>>     # be sure everything written to disk
>>     lyr.SyncToDisk()
>>     # Destroy the Data Source
>>     ds.Destroy()
>>     # exit gracefully
>>     sys.exit(0)
>>   
>>
>> ogrinfo results:
>> ---------------------------------------------
>> oot@clown-aero:~/project/python# ogrinfo test.shp -al
>> INFO: Open of `test.shp'
>> using driver `ESRI Shapefile' successful.
>>
>> Layer name: test
>> Geometry: Point
>> Feature Count: 1
>> Extent: (32.000000, 39.000000) - (32.000000, 39.000000)
>> Layer SRS WKT:
>> (unknown)
>> FID: Real (11.0)
>> OGRFeature(test):0
>>   FID (Real) =           0
>>   POINT (32 39)
>>
>>
>>
>
>
>


-- 
Aykut KO?AK

 Elektronik M?hendisi
(/Electronics Engineer/)
 
 E-Posta
(/E-Mail/ )

 aykutkocak@superonline.com


From astewart at TerraGoTech.com  Tue Sep 26 14:54:15 2006
From: astewart at TerraGoTech.com (Alan Stewart)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] NITF JPEG Compression
In-Reply-To: <45185CC9.5070301@pobox.com>
References: <4518414C.1030509@TerraGoTech.com> <45185CC9.5070301@pobox.com>
Message-ID: <45197757.4030102@TerraGoTech.com>

Frank Warmerdam wrote:
> The jpeg in nitf support was implemented after the 1.3.2 release.  You 
> can
> grab a nightly CVS snapshot to test it out.  It should work with either
> the internal libjpeg, or an external one.  No need to alter your 
> configuration
> for this.
Thanks, many of the C3-compressed files work with the 2006.09.26 snapshot.

However, I am frequently seeing two JPEG-related errors from gdal_translate:

ERROR 6: SetColorInterpretation() not supported for this dataset.

and

ERROR 1: libjpeg: Unsupported JPEG data precision 12

Also, files where before gdal_translate failed with:

ERROR 1: The file i_3051e.ntf appears to be an NITF file, but no image
blocks were found on it.  GDAL cannot utilize non-image
NITF files.
GDALOpen failed - 1
The file i_3051e.ntf appears to be an NITF file, but no image
blocks were found on it.  GDAL cannot utilize non-image
NITF files.

now cause an abend - Windows asks if you want to report the error to 
Microsoft - with:

Warning 1: The file i_3051e.ntf appears to be an NITF file, but no image
blocks were found on it.
ERROR 5: GDALDataset::GetRasterBand(1) - Illegal band #

-- 

 Alan Stewart
 Senior Software Architect
 TerraGo Technologies, Inc.
 astewart@TerraGoTech.com
 678-391-9700 x9615

-------------- next part --------------
A non-text attachment was scrubbed...
Name: astewart.vcf
Type: text/x-vcard
Size: 307 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060926/99f5cacc/astewart.vcf
From mbrudka at aster.pl  Tue Sep 26 15:45:09 2006
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <20060926071357.GA7749@ak4719.spb.edu>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>	<45184B58.7040204@aster.pl>
	<45185BF9.6020009@pobox.com> <20060926071357.GA7749@ak4719.spb.edu>
Message-ID: <45198345.6040101@aster.pl>

Hi,

Andrey Kiselev wrote:
> On Mon, Sep 25, 2006 at 06:45:13PM -0400, Frank Warmerdam wrote:
>>> - simplify GDAL interfaces and make them *explicite *with respect to i18n.
>>> - enable smooth transition for existing applications.
>>> - avoid yet another copy of strings, because many libraries already 
>>> provides wchar driven interfaces.
>>>       
>> Can you provide some more background on why a wide character solution
>> is preferable to UTF8?
For a GDAL the three points above are the main ones.
>>  Personally, I think the whole effort will be a
>> non-starter if we have to re-engineer everything to use wide characters.
>>     
Rewriting GDAL/OGR to use wide chars is pointless. Too much effort for 
GDAL developers as well as GDAL users. It is better to provide some 
additional interfaces for wide chars eg.

class OGRSFDriverRegistrar
{
    static OGRDataSource *Open( const char *pszName, int bUpdate=FALSE,
                                OGRSFDriver ** ppoDriver = NULL );

    OGRDataSource *OpenShared( const char *pszName, int bUpdate=FALSE,
                               OGRSFDriver ** ppoDriver = NULL );

    static OGRDataSource *Open( const wchar_t *pszName, int bUpdate=FALSE,
                                OGRSFDriver ** ppoDriver = NULL );

    OGRDataSource *OpenShared( const wchar_t *pszName, int bUpdate=FALSE,
                               OGRSFDriver ** ppoDriver = NULL );
}

Please notice how encoding were introduced in C++ STL, which is in a 
sense a blueprint for C++ developers. STL streams for old  and wide 
chars are distict and there is no assumption that a string passed for 
example to cout are encoded in XYZ standard and thus require recoding 
before outputing to terminal.
>
> I am seconded on this. For me it looks like 8-bit UTF-8 is the same as
> wide chars in terms of multilingual support. 
Sure, one may encode everything in UTF8 as well as in wide chars. But 
the convention to use UTF-8 encoding in plain strings is only 
*implicite*  and may be violated at the runtime. Wide chars area 
*explicite* and enable partial compile-time validation of i18n handling 
as well as clean distiction between i18n aware and not aware interfaces.
> Wide chars typically used in Windows interfaces and we can implement necessary conversion functions where it is needed. 
>   
Wide chars were introduced in C/C++ standard to avoid unnecessary 
conversions and enable smooth transition of strings between various 
libraries. One should always remember the ordinary C++ application 
usually wastes it time in string copying/conversion. Why to introduce 
another copying?

> Most free toolkits and libraries use UTF-8 internally and it is no problem to interface with them using our
> approach.
>   
In our company we use *directly* 20-30 open source  libraries and I 
cannot agree with the above statement. Moreoever, for many laguages with 
GDAL/OGR bindings wide chars are preffered way to deal with i18n issues.


BTW. In Windows typically M$ code pages are employed. It is a horror for 
portable applications and even a worse solution than UTF-8.

BTW 2. OGR spends more time in strcpy than the average C++ library, 
please cachegrind some trivial  examples to verify that.

Marek Brudka


From andrey.kiselev at gmail.com  Wed Sep 27 04:57:06 2006
From: andrey.kiselev at gmail.com (Andrey Kiselev)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <45198345.6040101@aster.pl>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
	<45184B58.7040204@aster.pl> <45185BF9.6020009@pobox.com>
	<20060926071357.GA7749@ak4719.spb.edu> <45198345.6040101@aster.pl>
Message-ID: <29bcc0df0609270157p27884590q1a89da6c93689b3d@mail.gmail.com>

On 9/26/06, Marek Brudka <mbrudka@aster.pl> wrote:

> > On Mon, Sep 25, 2006 at 06:45:13PM -0400, Frank Warmerdam wrote:
> > I am seconded on this. For me it looks like 8-bit UTF-8 is the same as
> > wide chars in terms of multilingual support.
> Sure, one may encode everything in UTF8 as well as in wide chars. But
> the convention to use UTF-8 encoding in plain strings is only
> *implicite*  and may be violated at the runtime. Wide chars area
> *explicite* and enable partial compile-time validation of i18n handling
> as well as clean distiction between i18n aware and not aware interfaces.

OK, I see the point. I am agree that this is better solution for
programming interfaces.
But see below.


> Rewriting GDAL/OGR to use wide chars is pointless. Too much effort for
> GDAL developers as well as GDAL users. It is better to provide some
> additional interfaces for wide chars eg.
>
> class OGRSFDriverRegistrar
> {
>     static OGRDataSource *Open( const char *pszName, int bUpdate=FALSE,
>                                 OGRSFDriver ** ppoDriver = NULL );
>
>     OGRDataSource *OpenShared( const char *pszName, int bUpdate=FALSE,
>                                OGRSFDriver ** ppoDriver = NULL );
>
>     static OGRDataSource *Open( const wchar_t *pszName, int bUpdate=FALSE,
>                                 OGRSFDriver ** ppoDriver = NULL );
>
>     OGRDataSource *OpenShared( const wchar_t *pszName, int bUpdate=FALSE,
>                                OGRSFDriver ** ppoDriver = NULL );
> }

Marek, you are still talking about file names, but it is just a part
of the problem, and not the most significant part from my point of
view. I am thinking about whole GDAL i18n. In particular, I want to
have multilingual support in each driver where it makes sense.
Actually we need not only these several functions, but much more. I
think that almost every GDAL/OGR function which takes char* argument
should have its wide-character counterpart. Well, it is more or less
mechanical work to add a bunch of additional interfaces, but what to
do with drivers? Converting to UTF-8 is relatively simple and
non-intrusive and all functionality will be preserved even with
untouched code. Introduction of wchar_t* strings will take much more
efforts, because _every_ driver must be converted in order to support
this.

I am agree that introduction of UTF-8 looks mostly as a hack, not a
clean solution, but it should quickly bring the new functionality to
us. If we will go toward wchar_t* way I am afraid that the actual work
will never be started. That way is only acceptable if there will be
volunteers willing to help in wchar_t* transition, otherwise we have
no chances to complete it.

Best regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From holl at gdf-hannover.de  Wed Sep 27 05:49:36 2006
From: holl at gdf-hannover.de (Stephan Holl)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <45129B5D.4010508@pobox.com>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>
	<451292FA.4070200@pobox.com>
	<20060921154810.03d97e00@butan.gdf-hannover.de>
	<45129B5D.4010508@pobox.com>
Message-ID: <20060927114936.20798416@butan.gdf-hannover.de>

Hello Frank,

On Thu, 21 Sep 2006 10:02:05 -0400 Frank Warmerdam
<warmerdam@pobox.com> wrote:

> Stephan Holl wrote:
> >> This is not uncommon with different kinds of drivers, so if QGIS
> >> can't handle it, I think QGIS should be improved.
> > 
> > In what way? That it can deal with wkbUnknown or that it can
> > 'identify' the correct geometry by itself?
> 
> Stephan,
> 
> Well, I was thinking in terms of working with wkbUnknown in some
> reasonable way - even if it ends up having to scan some features to
> establish a type or ask the user if it really needs a single geometry
> type.  Note that there are drivers which return a mix of geometry
> types such as DGN, and potentially OCI.

I have digged into this and found out the following (using QGIS):

When loading a line-layer, I get this wkbtype: 2147483650
Debug: qgsvectorlayer.cpp: 3322: (drawFeature) 2147483650
File: qgsvectorlayer.cpp, Line: 3438: UNKNOWN WKBTYPE ENCOUNTERED
export to Wkt: LINESTRING (599410.286458709975705
4925218.247969940304756 0,599446.169775799964555 4925223.06831809040159
0,599667.214197290013544 4925284.553749489597976
0,599766.326235549990088 4925326.424210700206459 0)

Exporting this as WKT it says it is LINESTRING(x, y, z).

So the mystery-value of 2147483650 seems strange. Is this a bug in OGR?

Same applies to point and geometry layers:
WKB for points:   2147483649
WKB fr lines:     2147483650
WKB for polygons: 2147483651

?!

Thank you and TIA!

	Stephan

-- 
GDF Hannover - Solutions for spatial data analysis and remote sensing
Hannover Office      -     Mengendamm 16d      -     D-30177 Hannover
Internet: www.gdf-hannover.de      -      Email: holl@gdf-hannover.de
Phone : ++49-(0)511.39088507       -        Fax: ++49-(0)511.39088508

From epk.lists at gmail.com  Wed Sep 27 08:57:42 2006
From: epk.lists at gmail.com (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] no sucess trying to build ECW for GDAL .
Message-ID: <2d1782780609270557u57fb1719gedba856d0ccffc4@mail.gmail.com>

Hi,

I'm under SuSE 10.1 machine trying to build ECW toolkit and then build GDAL
against it but got no sucess.

I tryed to build libecwj2-3.3 package using:

$ cd Source/NCSBuildQmake/
$ make -f Makefile-linux-shared
.... then outputs:
g++ -c -pipe -Wall -W -O2 -D_REENTRANT -fPIC  -DUNICODE -DLINUX
-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
-D_GNU_SOURCE -DPOSIX -D_REENTRANT -DLIBECWJ2 -I. -I../../Source/include
-I../../Source/C/NCSEcw/lcms/include -o ../../obj/linux-g++/shared/NCSJP2.o
../../Source/C/NCSEcw/NCSJP2/NCSJP2.cpp
../../Source/include/NCSString.h: In copy constructor
'CNCSString::CNCSString(const CNCSString&)':
../../Source/include/NCSString.h:41: warning: base class 'struct
std::basic_string<wchar_t, std::char_traits<wchar_t>,
std::allocator<wchar_t> >' should be explicitly initialized in the copy
constructor
../../Source/include/NCSJPCBuffer.h: At global scope:
../../Source/include/NCSJPCBuffer.h:176: error: extra qualification
'CNCSJPCBuffer::' on member 'CNCSJPCBuffer'
../../Source/include/NCSJPCBuffer.h:189: error: extra qualification
'CNCSJPCBuffer::' on member 'operator='
../../Source/include/NCSJP2FileView.h:837: error: ISO C++ forbids
declaration of 'CNCSJPCResample' with no type
../../Source/include/NCSJP2FileView.h:837: error: expected ';' before '*'
token
make: *** [../../obj/linux-g++/shared/NCSJP2.o] Error 1

trying 3.3-RC2 version gives me the same error.

I also tryed to extract a pre-build of ECW libs I found under
www.maptools.org download folder:
$ CPPFLAGS="-I/usr/include/hdf -I/usr/local/ecw/include -L/usr/local/ecw/lib"
./configure --with-threads --with-libz=internal --with-pg=/usr/bin/pg_config
--with-pcraster=/usr --with-png=internal --with-libtiff=internal
--with-geotiff=internal --with-jpeg=internal --with-gif=internal
--with-ogdi=/usr --with-hdf5=/usr --with-jasper=/usr --with-ogr
--with-mysql=/usr/bin/mysql_config --with-odbc=/usr/local/src/epk/unixODBC-
2.2.11 --with-sqlite=/usr --with-geos=s/usr/local/bin/geos-config
--with-proj4 --with-perl --with-php --with-ruby --with-ngpython
--with-hdf4=/usr/lib/hdf
--with-oci=/usr/lib/oracle/xe/app/oracle/product/10.2.0/server
--with-ecw=/usr/local/ecw 2>&1 | tee configure.log
But after make I got:
make[2]: Entering directory `/usr/local/src/epk/gdal-1.3.2/frmts/ecw'
/bin/sh /usr/local/src/epk/gdal-1.3.2/libtool --mode=compile g++ -Wall
-O2   -I/usr/local/src/epk/gdal-1.3.2/port
-I/usr/local/src/epk/gdal-1.3.2/gcore
-I/usr/local/src/epk/gdal-1.3.2/alg -I/usr/local/src/epk/gdal-1.3.2/ogr
-I/usr/local/src/epk/gdal-1.3.2/ogr/ogrsf_frmts -DFRMT_ecw -DOGR_ENABLED
-I/usr/include/hdf -I/usr/local/ecw/include -L/usr/local/ecw/lib
-I/usr/local/src/epk/gdal-1.3.2/port
-I/usr/local/src/epk/unixODBC-2.2.11-I/usr/local/src/epk/unixODBC-
2.2.11/include -I/usr/local/ecw/include -I/usr -I/usr/include
-I/usr/include  -c -o ../o/ecwdataset.o ecwdataset.cpp
 g++ -Wall -O2 -I/usr/local/src/epk/gdal-1.3.2/port
-I/usr/local/src/epk/gdal-1.3.2/gcore -I/usr/local/src/epk/gdal-1.3.2/alg
-I/usr/local/src/epk/gdal-1.3.2/ogr
-I/usr/local/src/epk/gdal-1.3.2/ogr/ogrsf_frmts
-DFRMT_ecw -DOGR_ENABLED -I/usr/include/hdf -I/usr/local/ecw/include
-L/usr/local/ecw/lib -I/usr/local/src/epk/gdal-1.3.2/port
-I/usr/local/src/epk/unixODBC-2.2.11
-I/usr/local/src/epk/unixODBC-2.2.11/include
-I/usr/local/ecw/include -I/usr -I/usr/include -I/usr/include -c
ecwdataset.cpp  -fPIC -DPIC -o ../o/.libs/ecwdataset.o
/usr/local/ecw/include/NCSJPCBuffer.h:176: error: extra qualification
'CNCSJPCBuffer::' on member 'CNCSJPCBuffer'
/usr/local/ecw/include/NCSJPCBuffer.h:189: error: extra qualification
'CNCSJPCBuffer::' on member 'operator='
/usr/local/ecw/include/NCSJP2FileView.h:820: error: ISO C++ forbids
declaration of 'CNCSJPCResample' with no type
/usr/local/ecw/include/NCSJP2FileView.h:820: error: expected ';' before '*'
token
/usr/local/ecw/include/NCSJPCMarker.h:101: error: extra qualification
'CNCSJPCMarker::' on member 'operator='
/usr/local/ecw/include/NCSJPCPacket.h:32: warning: 'class CNCSJPCPacket' has
virtual functions but non-virtual destructor
/usr/local/ecw/include/NCSJPCPLTMarker.h:84: error: extra qualification
'CNCSJPCPLTMarker::' on member 'operator='
ecwdataset.cpp: In member function 'virtual CPLErr
ECWRasterBand::IRasterIO(GDALRWFlag, int, int, int, int, void*, int, int,
GDALDataType, int, int)':
ecwdataset.cpp:551: warning: dereferencing type-punned pointer will break
strict-aliasing rules
make[2]: *** [../o/ecwdataset.o] Error 1
make[2]: Leaving directory `/usr/local/src/epk/gdal-1.3.2/frmts/ecw'
make[1]: *** [ecw-install-obj] Error 2
make[1]: Leaving directory `/usr/local/src/epk/gdal-1.3.2/frmts'
make: *** [frmts-target] Error 2


Any ideas?

regards

-- 
Eduardo Patto Kanegae
http://www.webmapit.com.br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060927/5ebb406e/attachment.html
From warmerdam at pobox.com  Wed Sep 27 09:57:31 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OCI-geometry recognition
In-Reply-To: <20060927114936.20798416@butan.gdf-hannover.de>
References: <20060921134352.201db1d4@butan.gdf-hannover.de>	<451292FA.4070200@pobox.com>	<20060921154810.03d97e00@butan.gdf-hannover.de>	<45129B5D.4010508@pobox.com>
	<20060927114936.20798416@butan.gdf-hannover.de>
Message-ID: <451A834B.9070609@pobox.com>

Stephan Holl wrote:
> Exporting this as WKT it says it is LINESTRING(x, y, z).
> 
> So the mystery-value of 2147483650 seems strange. Is this a bug in OGR?
> 
> Same applies to point and geometry layers:
> WKB for points:   2147483649
> WKB fr lines:     2147483650
> WKB for polygons: 2147483651

Stephan,

This is the list of enumerated values for geometry types in OGR:

typedef enum
{
     wkbUnknown = 0,             /* non-standard */
     wkbPoint = 1,               /* rest are standard WKB type codes */
     wkbLineString = 2,
     wkbPolygon = 3,
     wkbMultiPoint = 4,
     wkbMultiLineString = 5,
     wkbMultiPolygon = 6,
     wkbGeometryCollection = 7,
     wkbNone = 100,              /* non-standard, for pure attribute records */
     wkbLinearRing = 101,        /* non-standard, just for createGeometry() */
     wkbPoint25D = 0x80000001,   /* 2.5D extensions as per 99-402 */
     wkbLineString25D = 0x80000002,
     wkbPolygon25D = 0x80000003,
     wkbMultiPoint25D = 0x80000004,
     wkbMultiLineString25D = 0x80000005,
     wkbMultiPolygon25D = 0x80000006,
     wkbGeometryCollection25D = 0x80000007
} OGRwkbGeometryType;

So, what you are seeing is the 2.5D (x,y,z) forms of the geometries.
For applications that don't care to differentiate, I normally use the
wkbFlatten() macro on the values to reduce them to the simple 2D versions.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From warmerdam at pobox.com  Wed Sep 27 11:27:50 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] NITF JPEG Compression
In-Reply-To: <45197757.4030102@TerraGoTech.com>
References: <4518414C.1030509@TerraGoTech.com> <45185CC9.5070301@pobox.com>
	<45197757.4030102@TerraGoTech.com>
Message-ID: <451A9876.8060207@pobox.com>

Alan Stewart wrote:
> However, I am frequently seeing two JPEG-related errors from 
> gdal_translate:
> 
> ERROR 6: SetColorInterpretation() not supported for this dataset.

Alan,

This can be generally ignored.  It should really be thought of as a warning.
If you can provide details via a bug report on how to reproduce this I'll
try and fix the message.

> and
> 
> ERROR 1: libjpeg: Unsupported JPEG data precision 12

The default build of GDAL uses a libjpeg that only supports 8 bit
precision jpeg files.  There is a libjpeg variant available that
can dynamically support 8 or 12bit files which should resolve this
problem - but it can be pretty tricky to use.

> Also, files where before gdal_translate failed with:
> 
> ERROR 1: The file i_3051e.ntf appears to be an NITF file, but no image
> blocks were found on it.  GDAL cannot utilize non-image
> NITF files.
> GDALOpen failed - 1
> The file i_3051e.ntf appears to be an NITF file, but no image
> blocks were found on it.  GDAL cannot utilize non-image
> NITF files.
> 
> now cause an abend - Windows asks if you want to report the error to 
> Microsoft - with:
> 
> Warning 1: The file i_3051e.ntf appears to be an NITF file, but no image
> blocks were found on it.
> ERROR 5: GDALDataset::GetRasterBand(1) - Illegal band #

The NITF driver was modified since GDAL 1.3.2 to support reading CGM
graphics segments as metadata.  In order to allow reading this from
files with no image segment, I had to relax the requirement on there
actually being an image.  So now it is possible to open a non-image
NITF file, it just won't have any bands.

However, many applications and libraries do not properly work with
band-less GDAL files.  Often this takes the form of an assumption that
there is a band 1 to check for information like datatype.  I see the
GeoTIFF CreateCopy() method has this problem.  I have:

  1) modified gdal_translate to avoid calling GDALCreateCopy() if the
     input has no bands as it is unlikely to be useful, and likely to
     cause problems.
  2) Modified GTiffDataset::CreateCopy() to error out gracefully if
     there are no input bands.

Thanks for your feedback.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From astewart at TerraGoTech.com  Wed Sep 27 14:35:38 2006
From: astewart at TerraGoTech.com (Alan Stewart)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] ADRG
Message-ID: <451AC47A.9070301@TerraGoTech.com>

I'm successfully fetching an image from ADRG using the OGDI bridge with 
gdal_translate. However, I don't see how to retrieve the individual 
source graphics that were scanned in composing the ADRG or the legend 
images associated with each source graphic. Is there a way to get these 
also via the bridge?

Also, the link to the programmer's reference PDF on the web page at  
http://ogdi.sourceforge.net is broken...

-- 

 Alan Stewart
 Senior Software Architect
 TerraGo Technologies, Inc.
 astewart@TerraGoTech.com
 678-391-9700 x9615

-------------- next part --------------
A non-text attachment was scrubbed...
Name: astewart.vcf
Type: text/x-vcard
Size: 307 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060927/991f381a/astewart.vcf
From matt.wilkie at gov.yk.ca  Wed Sep 27 16:24:30 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] add ArcGIS 9.2 to list of projects using gdal
Message-ID: <451ADDFE.6050100@gov.yk.ca>

Hi Frank, I think you can add ArcGIS 9.2 to the list of projects using 
GDAL: http://tinyurl.com/gwac9 "ArcGIS 9.2 has adopted the Geospatial 
Data Abstract Library (GDAL) and supports adding custom formats through 
the GDAL format driver."

:)

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From warmerdam at pobox.com  Wed Sep 27 17:22:19 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] add ArcGIS 9.2 to list of projects using gdal
In-Reply-To: <451ADDFE.6050100@gov.yk.ca>
References: <451ADDFE.6050100@gov.yk.ca>
Message-ID: <451AEB8B.3060905@pobox.com>

Matt Wilkie wrote:
> Hi Frank, I think you can add ArcGIS 9.2 to the list of projects using 
> GDAL: http://tinyurl.com/gwac9 "ArcGIS 9.2 has adopted the Geospatial Data
> Abstract Library (GDAL) and supports adding custom formats through the GDAL
> format driver."

Matt,

I am very pleased to see writing GDAL plugins is supported as a way of adding
raster formats to ArcGIS.  I hadn't realized that was a supported approach.

The project list for the GDAL page now includes "ESRI ArcGIS 9.2+: A popular 
GIS system."

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From perrygeo at gmail.com  Wed Sep 27 19:09:02 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
Message-ID: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>

Hey folks,

 Trying to import an ArcInfo Grid into grass and I'm getting a bunch
of the following errors:

ERROR 1: IReadBlock failed at X offset 0, Y offset 5399
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 5399

Strangely enough, the import proceeds but I get some wierd results!
(see attached image)

I experience the same errors using other gdal utilities as well. I've
found a few other mentions of this issue but no solutions yet..
http://permalink.gmane.org/gmane.comp.gis.gdal.devel/1643

So far the only thing able to open the grid properly is ArcGIS. So I'm
guessing that this grid has some strange issues that the gdal driver
doesn't handle. If anyone's interested in helping debug this, i've
posted the grid at
http://ebm.nceas.ucsb.edu/mapping/data/rasters_bad.zip

Thanks,
-- 
-------------------------------------------------------
Matthew T. Perry
GIS Analyst / Software Engineer
National Center for Ecological Analysis and Synthesis (NCEAS)
http://ebm.nceas.ucsb.edu/
http://www.nceas.ucsb.edu/ecoinformatics
work: perry@nceas.ucsb.edu
personal: perrygeo@gmail.com
web: http://www.perrygeo.net
-------------------------------------------------------
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Screenshot.png
Type: image/png
Size: 9211 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060927/74768481/Screenshot.png
From grass-bugs at intevation.de  Mon Sep 25 06:30:22 2006
From: grass-bugs at intevation.de (Maciek Sieczka via RT)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] [bug #5168] (grass) v.in.ogr: undefined symbol
	OGRRegisterAll
Message-ID: <20060925103022.67A151005DB@lists.intevation.de>

Frank,

This bug might be OGR related.

guest wrote (Sun, Sep 24 2006 15:56:53):

> PC AMD-X86_64 Fc5 (Fedora-core-5) 

> grass-6.3.cvs-x86_64-unknown-linux-gnu-23_09_2006.tar.gz
> download: grass.itc.it

> $ v.in.ogr dsn=adm.e00 output=adm1
> v.in.ogr: symbol lookup error: v.in.ogr: undefined symbol: 
> OGRRegisterAll
> GRASS 6.3.cvs (d1144):/home/md/danguole/d1144/PERMANENT >
> ********************************************************
> ********************************************************
> 
> EXP  0 /MULTID/DT13/UPDATE/EXP50LKS/1144/ADM.E00                                
> ARC  2
>          1         1         2         3         0         0         7
>  3.7567922E+05 6.1011955E+06 3.7574516E+05 6.1011565E+06
>  3.7582256E+05 6.1011005E+06 3.7593669E+05 6.1010175E+06
>  3.7603438E+05 6.1009595E+06 3.7613091E+05 6.1009115E+06
>  3.7617653E+05 6.1008895E+06
>          2         1         4         1         0         0         6
>  3.7988538E+05 6.1007795E+06 3.7996950E+05 6.1008715E+06
>  3.8004209E+05 6.1009545E+06 3.8012244E+05 6.1010585E+06
>  3.8017984E+05 6.1011625E+06 3.8020294E+05 6.1012205E+06
>          3         1         5         6         0         0         7
>  3.7704091E+05 6.1004985E+06 3.7716925E+05 6.1004755E+06
>  3.7728094E+05 6.1004505E+06 3.7738888E+05 6.1004305E+06
>  3.7748419E+05 6.1004115E+06 3.7756931E+05 6.1003985E+06
>  3.7762012E+05 6.1003945E+06
>         -1         0         0         0         0         0         0
> TOL  2
>          1         2 5.0010004E+00
>          2         2 0.0000000E+00
>          3         2 0.0000000E+00
>          4         2 0.0000000E+00
>          5         2 0.0000000E+00
>          6         2 2.5005000E+02
>          7         2 2.5005000E+01
>          8         2 2.5005000E+01
>          9         2 2.5005000E+01
>         10         2 2.5005000E+01
>         -1         0         0         0         0         0         0
> SIN  2
> EOX
> LOG  2
> 200012271231   0     0     0minde   export COVER 1144/adm ../exp50lks/1144/adm
> ~
> 200012271308   0     0     0minde   export COVER 1144/adm ../exp50lks/1144/adm
> ~
> EOL
> PRJ  2
> Projection    TRANSVERSE
> ~
> Zunits        NO
> ~
> Units         METERS
> ~
> Spheroid      GRS1980
> ~
> Xshift        0.0000000000
> ~
> Yshift        0.0000000000
> ~
> Parameters
> ~
> 0.99980 /* scale factor at central meridian
> ~
>  24  0  0.000 /* longitude of central meridian
> ~
>  0  0  0.000 /* latitude of origin
> ~
> 500000.00000 /* false easting (meters)
> ~
> 0.00000 /* false northing (meters)
> ~
> EOP
> IFO  2
> ADM.AAT                         XX   8   8  36         3
> FNODE#            4-1   14-1   5-1 50-1  -1  -1-1                   1-
> TNODE#            4-1   54-1   5-1 50-1  -1  -1-1                   2-
> LPOLY#            4-1   94-1   5-1 50-1  -1  -1-1                   3-
> RPOLY#            4-1  134-1   5-1 50-1  -1  -1-1                   4-
> LENGTH            4-1  174-1  12 3 60-1  -1  -1-1                   5-
> ADM#              4-1  214-1   5-1 50-1  -1  -1-1                   6-
> ADM-ID            4-1  254-1   5-1 50-1  -1  -1-1                   7-
> CODE              7-1  294-1   7-1 30-1  -1  -1-1                   8-
>           2          3          0          0 5.8524921E+02          1          1
>  110110
>           4          1          0          0 5.4753052E+02          2          1
>  110110
>           5          6          0          0 5.8876056E+02          3          1
>  110110
> ADM.BND                         XX   4   4  16         1
> XMIN              4-1   14-1  12 3 60-1  -1  -1-1                   1-
> YMIN              4-1   54-1  12 3 60-1  -1  -1-1                   2-
> XMAX              4-1   94-1  12 3 60-1  -1  -1-1                   3-
> YMAX              4-1  134-1  12 3 60-1  -1  -1-1                   4-
>  3.7497500E+05 6.0762155E+06 3.9998000E+05 6.1012205E+06
> ADM.TIC                         XX   3   3  12         4
> IDTIC             4-1   14-1   5-1 50-1  -1  -1-1                   1-
> XTIC              4-1   54-1  12 3 60-1  -1  -1-1                   2-
> YTIC              4-1   94-1  12 3 60-1  -1  -1-1                   3-
>           1 3.7497500E+05 6.1012205E+06
>           2 3.9998000E+05 6.1012205E+06
>           3 3.7497500E+05 6.0762155E+06
>           4 3.9998000E+05 6.0762155E+06
> EOI
> EOS


-------------------------------------------- Managed by Request Tracker

From wxfei19 at yahoo.com.cn  Mon Sep 25 08:04:29 2006
From: wxfei19 at yahoo.com.cn (xiongfei wen)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] some problem on gdal support hdf4 format
Message-ID: <20060925120429.77652.qmail@web15201.mail.cnb.yahoo.com>

gdal-dev@lists.maptools.org:
         
            I am a student from China PR, I have got a problem on dealing hdf4 format with GDAL.
            I downloaded a gdal package from www.gdal.org/dl ,after unzip the gdal131.zip I found a file named makefile.opt. in this file it says 
   
  # Uncomment the following and update to enable NCSA HDF Release 4 support.
#HDF4_DIR = D:\warmerda\HDF41r5
#HDF4_LIB = /LIBPATH:$(HDF4_DIR)\lib Ws2_32.lib
   
  I have downloaded the HDF42r1 from NCSA,I set it in C:/myhdfstuff ,and I can access the hdf files using the HDF library,and I change HDF4_DIR and HDF4_LIB into 
  # Uncomment the following and update to enable NCSA HDF Release 4 support.
HDF4_DIR = C:\MyHDFStuff\HDF42r1\hdf4lib\debug
HDF4_LIB = C:\MyHDFStuff\HDF42r1\hdf4lib\debug\lib C:\MyHDFStuff\HDF42r1\hdf4lib\release\lib Ws2_32.lib
   
  then I run "nmake /f  makefile.vc " , A link error always occured ,why this happened, when I comment the line of HDF4_DIR HDF4_LIB,I can run the commands "nmake /f  makefile.vc" ,"nmake /f  makefile.vc install " ,'" nmake /f  makefile.vc devinstall" successfully, and I can use GDAL access the .img (HFA) files .
   
  what should I do if I want to use gdal support  hdf4 and hdf5?
   
  Looking forward for your reply!!
                                                               
                                                                     Xiongfei Wen
                                                                    2006-9-25
   
   

 		
---------------------------------
-3.5G20M 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060925/105b1f88/attachment.html
From bdixon at asf.alaska.edu  Mon Sep 25 14:18:21 2006
From: bdixon at asf.alaska.edu (Brian S. Dixon)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Using GDAL in Linux ANSI C
In-Reply-To: <45145D99.80508@pobox.com>
Message-ID: <000401c6e0ce$fbb84480$bf11000a@pc.asf.alaska.edu>

Hi Frank,

  Our s/w is ANSI C, compiled with gcc ...Like I mentioned before, GDAL is
all new to me so I have some basic questions.  It looks like GDAL is written
in C++ ...I've never tried to utilize C++ libraries from a C program before
(usually the other way around).  Is this possible?  Porting our code to C++
is a much larger project...

Thanks,

Brian

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, September 22, 2006 2:03 PM
To: Brian S. Dixon
Subject: Re: GeoTIFF v. ERDAS/ARCGIS .aux files

Brian S. Dixon wrote:
> Very good news!  So, the scenario that I'm imagining then is to consider
> using gdal, or part of the gdal code, to read the ERDAS tif/aux
> TIFF/GeoTIFF/GeoKey information into some internal data structure that
> you've already produced, then use our code to convert this info (and the
tif
> image) to our internal image file format (the combination of an image
file,
> .img, and a meta data file, .meta.)  Since we want to keep the conversion
> process fairly simple for our users, we'll likely read a GeoTIFF file and
if
> it has missing information then automatically look for an aux file and use
> it ...only asserting if we fail after that step.  I'd probably take this
> approach rather than have users figure it out and have to execute
> intermediate steps in order to make the conversion work, e.g. somehow
> produce a 'complete' GeoTIFF file first.
> 
> Since I'm fairly new to the Alaska Satellite Facility and GIS type stuff
in
> general, GDAL is new to me.  I'll go take a look at the gdal_translate
> utility and see if I can dig into the code a bit...

Brian,

OK, sounds good.

By the way, the logic in GDAL where it decides to go looking for an .aux
file
if projection info is missing in a TIFF file is in the
GTiffDataset::GetProjectionRef() method in gdal/frmts/gtiff/geotiff.cpp.

It looks like this:

char *GTiffDataset::GetProjectionRef()

{
     if( nGCPCount == 0 )
     {
         if( EQUAL(pszProjection,"") )
             return GDALPamDataset::GetProjectionRef();
         else
             return( pszProjection );
     }
     else
         return "";
}

The GDALPamDataset::GetProjectionRef() will look for an .aux file.
So, you might want to short-circuit this code somehow.  Perhaps altering
it to try the GDALPamDataset::GetProjectionRef(), and then only using
the local pszProjection if the pam method returns an empty string. That
would essentially mean that the .aux code would take precidence over
the geotiff info.

Good luck,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org



From ywyw1983 at tom.com  Tue Sep 26 05:32:11 2006
From: ywyw1983 at tom.com (=?gb2312?B?0c/OsA==?=)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] How can i display a map using GDAL ?
Message-ID: <000601c6e14e$a56a1790$0300a8c0@Phenix>

Hi,
   I'm a newer about GIS.At the present,i want to use GDAL library to display a map by Qt programming.I have read the ESRI Shapefile Technical Description and the OGR API Tutorial ,but still don't know how to display a picture of map .OGR API Tutorial only tell me how to get the information in text format from a sharp file,but doesn't show how to display a map.could you give me a simple example about browse a map using GDAL by Qt programming .
 Thank you!
                                                                                                                           phenix  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060926/9c1c1d83/attachment.html
From jrharting at yahoo.com  Tue Sep 26 19:56:41 2006
From: jrharting at yahoo.com (John Harting)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] possible to update gdal from mac os x binary dist?
Message-ID: <20060926235641.12953.qmail@web53410.mail.yahoo.com>

I have gdal installed with the binary distribution of GRASS6 for Mac OS X (Tiger).  Problem is, the gdal version is 1.2.6, but the rgdal geostats package for R I want to install requires at least version 1.3.1.  Is it possible to update gdal without re-building all of grass from source?  if so...how?

thanks!
John

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060926/6989e0e3/attachment.html
From epk.lists at gmail.com  Wed Sep 27 08:44:18 2006
From: epk.lists at gmail.com (Eduardo Patto Kanegae)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] no sucess trying to build ECW for GDAL
Message-ID: <2d1782780609270544n156a47e9o1cab63041a3f3425@mail.gmail.com>

Hi,

I'm under SuSE 10.1 machine trying to build ECW toolkit and then build GDAL
against it but got no sucess.

I tryed to build libecwj2-3.3 package using:

$ cd Source/NCSBuildQmake/
$ make -f Makefile-linux-shared
.... then outputs:
g++ -c -pipe -Wall -W -O2 -D_REENTRANT -fPIC  -DUNICODE -DLINUX
-D_LARGEFILE_SOURCE -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64
-D_GNU_SOURCE -DPOSIX -D_REENTRANT -DLIBECWJ2 -I. -I../../Source/include
-I../../Source/C/NCSEcw/lcms/include -o ../../obj/linux-g++/shared/NCSJP2.o
../../Source/C/NCSEcw/NCSJP2/NCSJP2.cpp
../../Source/include/NCSString.h: In copy constructor
'CNCSString::CNCSString(const CNCSString&)':
../../Source/include/NCSString.h:41: warning: base class 'struct
std::basic_string<wchar_t, std::char_traits<wchar_t>,
std::allocator<wchar_t> >' should be explicitly initialized in the copy
constructor
../../Source/include/NCSJPCBuffer.h: At global scope:
../../Source/include/NCSJPCBuffer.h:176: error: extra qualification
'CNCSJPCBuffer::' on member 'CNCSJPCBuffer'
../../Source/include/NCSJPCBuffer.h:189: error: extra qualification
'CNCSJPCBuffer::' on member 'operator='
../../Source/include/NCSJP2FileView.h:837: error: ISO C++ forbids
declaration of 'CNCSJPCResample' with no type
../../Source/include/NCSJP2FileView.h:837: error: expected ';' before '*'
token
make: *** [../../obj/linux-g++/shared/NCSJP2.o] Error 1

trying 3.3-RC2 version gives me the same error.

Any ideas?

regards

-- 
Eduardo Patto Kanegae
http://www.webmapit.com.br
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060927/c1718117/attachment.html
From cspeirs at softree.com  Wed Sep 27 14:12:28 2006
From: cspeirs at softree.com (Craig)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] GDAL and MrSID
Message-ID: <000401c6e260$f60c5920$6401a8c0@softreeq8yviog>

I am new to GDAL and trying to read and display Mr. SID files. I am finding the performance is horrific  (2 minutes to read a 7Mb sid image).

I am using RasterIO (see snippet of code below).  Setting GDAL_ONE_BIG_READ has no effect.  What am I missing?  Is there some code somewhere which shows how to read Mr.SID into a raster of RGB triples?  Am I better off to user the Mr. SID API directly instead of GDAL?

Thanks in advance.

Craig Speirs

//////////////////////////////////////////////////////////////
.......................
  for (int iBand=1,nBandsRead=0;iBand<=nBands; iBand ++)
  {
   iColorOffset = 0;
   iColorInterp = poDataset->GetRasterBand(iBand)->GetColorInterpretation();
   switch(iColorInterp)
   { 
    case GCI_RedBand : iColorOffset = 2; 
     break;
    case GCI_GreenBand : iColorOffset = 1;
     break;
    case GCI_BlueBand : iColorOffset = 0;
     break;
    default : continue ;
   }
   gdErr = poDataset->GetRasterBand(iBand)->RasterIO(GF_Read,0,0,
poDataset->GetRasterXSize(), poDataset->GetRasterYSize(),((LPBYTE)pBits) + iColorOffset,bmi.biWidth,abs(bmi.biHeight),GDT_Byte,3,dwBytesPerLine);
   nBandsRead ++;
  }
...................
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060927/7f480be3/attachment.html
From elan at bluemandrill.com  Wed Sep 27 15:35:50 2006
From: elan at bluemandrill.com (Elan Feingold)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Warping GOES products
References: <E1GSf7j-0003lw-16@ciao.gmane.org>
Message-ID: <D8DAE392-3A09-410F-B483-7AAED4885333@bluemandrill.com>

I'm trying to use gdalwarp to convert GOES products (see
http://www.weather.gov/noaaport/html/icdtb48e.html), specifically the
GOES East and GOES West products, to Plate Caree, and I'm not having
much luck.

This is the workflow I've been following:

1) Convert the product into a raw grayscale file with the ucsat utility.

2) Convert the raw grayscale file into a TIFF using Imagemagick

3) Add 4 GCPs using gdal_translate

4) Use gdalwarp like this: gdalwarp -s_srs "+proj=lcc +lat_ts=25.000N
+lon_0=95.000W" -t_srs "+proj=eqc" TIGE02_new.2.tif
TIGE02_new.2.proj.jpg

Unfortunately the resulting image, while definitely warped, doesn't
match up with our other Plate Caree maps.

Any ideas would be much appreciated!

Thanks,

-elan





From warmerdam at pobox.com  Wed Sep 27 23:02:57 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
In-Reply-To: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>
References: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>
Message-ID: <451B3B61.3090104@pobox.com>

Matthew Perry wrote:
> Hey folks,
> 
> Trying to import an ArcInfo Grid into grass and I'm getting a bunch
> of the following errors:
> 
> ERROR 1: IReadBlock failed at X offset 0, Y offset 5399
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 5399
> 
> Strangely enough, the import proceeds but I get some wierd results!
> (see attached image)
> 
> I experience the same errors using other gdal utilities as well. I've
> found a few other mentions of this issue but no solutions yet..
> http://permalink.gmane.org/gmane.comp.gis.gdal.devel/1643
> 
> So far the only thing able to open the grid properly is ArcGIS. So I'm
> guessing that this grid has some strange issues that the gdal driver
> doesn't handle. If anyone's interested in helping debug this, i've
> posted the grid at
> http://ebm.nceas.ucsb.edu/mapping/data/rasters_bad.zip

Matthew,

I downloaded and tried this dataset and it seemed to work ok for me.
Could you perhaps try it with FWTools 1.0.5?  I imagine it was a compression
type that was fixed since the version of GDAL you are using.

Looking through the code it seems like the last improvement in that code
was in late 2005, so I presume GDAL 1.3.2 should work too.  Let me know
if you see the problem with FWTools 1.0.5. Otherwise I think we can
"write it off" as an already fixed problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From perrygeo at gmail.com  Wed Sep 27 23:28:44 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
In-Reply-To: <451B3B61.3090104@pobox.com>
References: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>
	<451B3B61.3090104@pobox.com>
Message-ID: <5383fa5e0609272028se809546jb742d42f87a1d8a5@mail.gmail.com>

Frank,

On 9/27/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Matthew Perry wrote:
> > Trying to import an ArcInfo Grid into grass and I'm getting a bunch
> > of the following errors:
> >
> > ERROR 1: IReadBlock failed at X offset 0, Y offset 5399
> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 5399
> >
>
> I downloaded and tried this dataset and it seemed to work ok for me.
> Could you perhaps try it with FWTools 1.0.5?  I imagine it was a compression
> type that was fixed since the version of GDAL you are using.
>
> Looking through the code it seems like the last improvement in that code
> was in late 2005, so I presume GDAL 1.3.2 should work too.  Let me know
> if you see the problem with FWTools 1.0.5. Otherwise I think we can
> "write it off" as an already fixed problem.
>

Hrmmm. I'm using gdal 1.3.2 on our linux machine and fwtools 1.0.5 on
windows.. same error with both.

I'll try the latest cvs and see if that works...

-- 
Matthew T. Perry
GIS Analyst / Software Engineer
National Center for Ecological Analysis and Synthesis (NCEAS)
work: perry@nceas.ucsb.edu
web: http://www.perrygeo.net

From woklist at kyngchaos.com  Wed Sep 27 23:54:35 2006
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] possible to update gdal from mac os x binary dist?
In-Reply-To: <20060926235641.12953.qmail@web53410.mail.yahoo.com>
References: <20060926235641.12953.qmail@web53410.mail.yahoo.com>
Message-ID: <FF5D694E-7E74-490B-9EDC-EDF7EAD33C42@kyngchaos.com>

I have a full range of _current_ GIS software for OS X - GRASS, GDAL,  
etc, including R GDAL extension and GRASS R install instructions.

On Sep 26, 2006, at 6:56 PM, John Harting wrote:

> I have gdal installed with the binary distribution of GRASS6 for  
> Mac OS X (Tiger).  Problem is, the gdal version is 1.2.6, but the  
> rgdal geostats package for R I want to install requires at least  
> version 1.3.1.  Is it possible to update gdal without re-building  
> all of grass from source?  if so...how?
>

-----
William Kyngesburye <kyngchaos@kyngchaos.com>
http://www.kyngchaos.com/

Theory of the Universe

There is a theory which states that if ever anyone discovers exactly  
what the universe is for and why it is here, it will instantly  
disappear and be replaced by something even more bizarrely  
inexplicable.  There is another theory which states that this has  
already happened.

-Hitchhiker's Guide to the Galaxy 2nd season intro



From perrygeo at gmail.com  Wed Sep 27 23:55:11 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
In-Reply-To: <5383fa5e0609272028se809546jb742d42f87a1d8a5@mail.gmail.com>
References: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>
	<451B3B61.3090104@pobox.com>
	<5383fa5e0609272028se809546jb742d42f87a1d8a5@mail.gmail.com>
Message-ID: <5383fa5e0609272055k261cd4bak98a9c25732439273@mail.gmail.com>

Frank,

On 9/27/06, Matthew Perry <perrygeo@gmail.com> wrote:
> Frank,
>
> On 9/27/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> > Matthew Perry wrote:
> > > Trying to import an ArcInfo Grid into grass and I'm getting a bunch
> > > of the following errors:
> > >
> > > ERROR 1: IReadBlock failed at X offset 0, Y offset 5399
> > > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 5399
> > >
> >
> > I downloaded and tried this dataset and it seemed to work ok for me.
> > Could you perhaps try it with FWTools 1.0.5?  I imagine it was a compression
> > type that was fixed since the version of GDAL you are using.
> >
> > Looking through the code it seems like the last improvement in that code
> > was in late 2005, so I presume GDAL 1.3.2 should work too.  Let me know
> > if you see the problem with FWTools 1.0.5. Otherwise I think we can
> > "write it off" as an already fixed problem.
> >
>
> Hrmmm. I'm using gdal 1.3.2 on our linux machine and fwtools 1.0.5 on
> windows.. same error with both.
>
> I'll try the latest cvs and see if that works...
>

OK. My bad on this one. That grid works fine for me as well. It was in
a directory with a bunch of other grids (all with the same problem)
and I just used arc to copy one of them into its own directory for a
smaller download. Apparently copying it solved the problem !

I guess the lesson is that it's dangerous to keep all your grids in a
single directory.. since they all share the info folder, the risk of
corrupting them becomes high.

-- 
Matthew T. Perry
GIS Analyst / Software Engineer
National Center for Ecological Analysis and Synthesis (NCEAS)
work: perry@nceas.ucsb.edu
web: http://www.perrygeo.net

From warmerdam at pobox.com  Thu Sep 28 00:07:53 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
In-Reply-To: <5383fa5e0609272055k261cd4bak98a9c25732439273@mail.gmail.com>
References: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>	
	<451B3B61.3090104@pobox.com>	
	<5383fa5e0609272028se809546jb742d42f87a1d8a5@mail.gmail.com>
	<5383fa5e0609272055k261cd4bak98a9c25732439273@mail.gmail.com>
Message-ID: <451B4A99.6060800@pobox.com>

Matthew Perry wrote:
> OK. My bad on this one. That grid works fine for me as well. It was in
> a directory with a bunch of other grids (all with the same problem)
> and I just used arc to copy one of them into its own directory for a
> smaller download. Apparently copying it solved the problem !
> 
> I guess the lesson is that it's dangerous to keep all your grids in a
> single directory.. since they all share the info folder, the risk of
> corrupting them becomes high.

Matt,

GDAL should not be looking at the info directory at all.  If you can
capture just the grid directory for one problem grid, and not the info
directory I could dig into this further.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From perrygeo at gmail.com  Thu Sep 28 00:43:03 2006
From: perrygeo at gmail.com (Matthew Perry)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Error reading ArcInfo Grid
In-Reply-To: <451B4A99.6060800@pobox.com>
References: <5383fa5e0609271609w4f078300odca78aba8531d52f@mail.gmail.com>
	<451B3B61.3090104@pobox.com>
	<5383fa5e0609272028se809546jb742d42f87a1d8a5@mail.gmail.com>
	<5383fa5e0609272055k261cd4bak98a9c25732439273@mail.gmail.com>
	<451B4A99.6060800@pobox.com>
Message-ID: <5383fa5e0609272143k10975a43t5c2d21b9fd5414b3@mail.gmail.com>

Frank,

On 9/27/06, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Matthew Perry wrote:
> > OK. My bad on this one. That grid works fine for me as well. It was in
> > a directory with a bunch of other grids (all with the same problem)
> > and I just used arc to copy one of them into its own directory for a
> > smaller download. Apparently copying it solved the problem !
> >
> > I guess the lesson is that it's dangerous to keep all your grids in a
> > single directory.. since they all share the info folder, the risk of
> > corrupting them becomes high.
>
> Matt,
>
> GDAL should not be looking at the info directory at all.  If you can
> capture just the grid directory for one problem grid, and not the info
> directory I could dig into this further.

I'll dig into it tomorrow.

In the mean time, I put the up whole errant directory for download at
http://ebm.nceas.ucsb.edu/mapping/data/habitat_classes_bad.tar.gz .
None of the grids here seem to work but, when copied to their own dir
using esri software, they're ok.


-- 
Matthew T. Perry
GIS Analyst / Software Engineer
National Center for Ecological Analysis and Synthesis (NCEAS)
work: perry@nceas.ucsb.edu
web: http://www.perrygeo.net

From ben at vterrain.org  Thu Sep 28 04:16:52 2006
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609270157p27884590q1a89da6c93689b3d@mail.gmail.com>
Message-ID: <032c01c6e2d6$743e3370$9b02a8c0@DellWork>

I've just returned to the list to check on whether my UTF-8 proposal was
being considered.  Looks like it's quite gone from a molehill to a mountain
:|  Very sorry about provoking that.  My original proposal is quite small
and modest and easily accomplished..

Let's split this very clearly into two separate subjects:

1. GDAL to support all filenames by declaring paths passed in are UTF-8.
This is simple and critical (and i'm volunteering to implement and submit
it).

2. GDAL to try to convert all sorts of charsets on content strings in data
files.  This is complex, messy and non-critical.

> -----
> From: Andrey Kiselev
> Sent: Tuesday, September 26, 2006 10:57 PM
> 
> [..] talking about file names, but it is just 
> a part of the problem, and not the most significant part from 
> my point of view. I am thinking about whole GDAL i18n.

Andrey, i appreciate your enthusiasm for i18n :), but let me illustrate why
i believe ilenames are the more significant problem.

A. I have a file on my disk with Chinese characters in its name.  Currently,
i *cannot open* it with GDAL.

B. I have a bunch of SHP files on my disk with various charsets in them
(mostly UTF-8).  Currently, i can read and process all of them just fine,
because i know their encoding.  This is true around the world, e.g. Akio
knows when his SHP have Shift-JIS in them.

All content strings are supported now, because GDAL is low-level and
charset-agnostic (as one could argue, it should be).

> In particular, I want to have multilingual support in each 
> driver where it makes sense.

OK if you want to propose that, but i would consider it an entirely
different RFC than international filename support.

> I am agree that introduction of UTF-8 looks mostly as a hack, 
> not a clean solution

I would say it's actually quite elegant and clean..

> but it should quickly bring the new 
> functionality to us. If we will go toward wchar_t* way I am 
> afraid that the actual work will never be started. That way 
> is only acceptable if there will be volunteers willing to 
> help in wchar_t* transition, otherwise we have no chances to 
> complete it.

Agreed.

-Ben


From jean-philippe.rannou at ago.fr  Thu Sep 28 04:32:37 2006
From: jean-philippe.rannou at ago.fr (Jean-Philippe RANNOU)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Loosing positions in S-57 to S-57 conversion via ogr2ogr
Message-ID: <451B88A5.6080902@ago.fr>

Hi,

I'm trying to use S-57 to S-57 conversion via OGR.
I set the minimum required options (specified in OGR S-57 html doc)

set OGR_S57_OPTIONS = "RETURN_PRIMITIVES=ON,RETURN_LINKAGES=ON,LNAM_REFS=ON"

I checked WRECKS positions in my S-57 file using

ogrinfo CA49995B.000 WRECKS

I did the conversion for WRECKS

ogr2ogr -skipfailure -append -f "S57" output.000 CA49995B.000 WRECKS

but in the resulting file when i check the resulting file

ogrinfo output.000 WRECKS

and the WRECKS positions disapeared (no more POINTS and empty polygons).

Has somebody experienced such conversion? What am i doing wrong?

Regards

   JP

-- 
RANNOU Jean-Philippe - ATLANTIDE
Consultant
Tel. : +33 (0)2 98 05 43 21
http://www.ago.fr/
--
Technop?le Brest Iroise
Site du Vernis - CS 23866
29238 Brest Cedex 3 - France
Tel. : +33 (0)2 98 05 43 21
Fax. : +33 (0)2 98 05 20 34
e-mail: atlantide-brest@ago.fr


From andrey.kiselev at gmail.com  Thu Sep 28 05:30:44 2006
From: andrey.kiselev at gmail.com (Andrey Kiselev)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] some problem on gdal support hdf4 format
In-Reply-To: <20060925120429.77652.qmail@web15201.mail.cnb.yahoo.com>
References: <20060925120429.77652.qmail@web15201.mail.cnb.yahoo.com>
Message-ID: <29bcc0df0609280230jbd8c796h2affd8f2a1e9a5f3@mail.gmail.com>

On 9/25/06, xiongfei wen <wxfei19@yahoo.com.cn> wrote:
> I have downloaded the HDF42r1 from NCSA,I set it in C:/myhdfstuff ,and I can
> access the hdf files using the HDF library,and I change HDF4_DIR and
> HDF4_LIB into
> # Uncomment the following and update to enable NCSA HDF Release 4 support.
> HDF4_DIR = C:\MyHDFStuff\HDF42r1\hdf4lib\debug
> HDF4_LIB = C:\MyHDFStuff\HDF42r1\hdf4lib\debug\lib C:\MyHDFStuff\HDF42r1\hdf4lib\release\lib Ws2_32.lib

You don't need to tuch the HDF4_LIB variable. Just uncomment it and
change a path in HDF4_DIR to point a directory where your HDF library
located (it seems you did right this part).

Regards,
Andrey

-- 
Andrey V. Kiselev
ICQ# 26871517

From mateusz at loskot.net  Thu Sep 28 08:24:27 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] How can i display a map using GDAL ?
In-Reply-To: <000601c6e14e$a56a1790$0300a8c0@Phenix>
References: <000601c6e14e$a56a1790$0300a8c0@Phenix>
Message-ID: <451BBEFB.9070408@loskot.net>

 wrote:
> Hi,
>    I'm a newer about GIS.At the present,i want to use GDAL library to
> display a map by Qt programming.
> I have read the */ESRI Shapefile
> Technical Description /*and the */OGR API Tutorial/* ,but still don't
> know how to display a picture of map .*/OGR API Tutorial/* only tell me
> how to get the information in text format from a sharp file,but doesn't
> show how to display a map.

Hi,

GDAL does not provide anything about GUI toolkits or displaying
maps. GDAL is an implementation of data model and data access providers.
The analogy could be ODBC API providing access to databases but ODBC does
not provide any features to display data on a screen.

> could you give me a simple example about
> browse a map using GDAL by Qt programming .

QGIS is not a simple example but an example. It's written in QT and uses
GDAL/OGR.

http://qgis.org/

I'd try to find out how to do it simplier. The requirement is that
you have to know how to draw vector geometries (point, line, polygon)
using QT API.

If you know how to do it, then iterate through Shapefile features,
read geometry and build QT's representation of point, line or polygon,
depending on the geometry type of Shapefile.

Follow the "Reading From OGR" section of the OGR tutorial.
Here is one of possible schemes to follow:


OGRFeature *poFeature = NULL
poLayer->ResetReading();
while( (poFeature = poLayer->GetNextFeature()) != NULL)
{
   OGRGeometry *poGeometry
   poGeometry = poFeature->GetGeometryRef();

   if( poGeometry != NULL )
   {

      if (wkbFlatten(poGeometry->getGeometryType()) == wkbPoint )
      {
          OGRPoint *poPoint = (OGRPoint *) poGeometry;

          // HERE CALL QT API TO DRAW POINT

      }
      else if (wkbFlatten(poGeometry->getGeometryType()) == wkbLineString)
      {
          OGRLinearString *poLine = (OGRLinearString *) poGeometry;

          // HERE CALL QT API TO DRAW LINE

      }
      else if (wkbFlatten(poGeometry->getGeometryType()) == wkbPolygon)
      {
          // ...
      }
   }
}


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From warmerdam at pobox.com  Thu Sep 28 09:25:10 2006
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Loosing positions in S-57 to S-57 conversion via
	ogr2ogr
In-Reply-To: <451B88A5.6080902@ago.fr>
References: <451B88A5.6080902@ago.fr>
Message-ID: <451BCD36.1000005@pobox.com>

Jean-Philippe RANNOU wrote:
> Hi,
> 
> I'm trying to use S-57 to S-57 conversion via OGR.
> I set the minimum required options (specified in OGR S-57 html doc)
> 
> set OGR_S57_OPTIONS = 
> "RETURN_PRIMITIVES=ON,RETURN_LINKAGES=ON,LNAM_REFS=ON"
> 
> I checked WRECKS positions in my S-57 file using
> 
> ogrinfo CA49995B.000 WRECKS
> 
> I did the conversion for WRECKS
> 
> ogr2ogr -skipfailure -append -f "S57" output.000 CA49995B.000 WRECKS
> 
> but in the resulting file when i check the resulting file
> 
> ogrinfo output.000 WRECKS
> 
> and the WRECKS positions disapeared (no more POINTS and empty polygons).
> 
> Has somebody experienced such conversion? What am i doing wrong?

JP,

I just tried a similar conversion and it worked for me.  The resulting
S-57 file did have wrecks.  I did observe that the new DSID feature class
support is not supported by the writer.

Are you confident that the double quotes did not get included in your
OGR_S57_OPTIONS senvironment variable?  Does an ogrinfo on your original
file show layers called IsolatedNode, ConnectedNode, Edge and Face (as
well as the regular feature classes)?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | President OSGeo, http://osgeo.org


From jdgonon at gi-lemans.com  Thu Sep 28 09:27:02 2006
From: jdgonon at gi-lemans.com (Jean-Daniel GONON)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] SPAM!!!: Errors with compilation of OGR
Message-ID: <001e01c6e301$c8f8d160$4869850a@gi.com>

Hello, 

I have problems with compilation of OGR under MS Visual Studio 2005 and MS Visual C++ 6.0 :

- with MS Visual Studio 2005 : I have one error "midl : command line error MIDL1001 : cannot open input file GeometryIdl.idl" whereas this file is in gdal-1.3.2\ogr with other files of project

- with MS Visual C++ 6.0 : I have errors on inclusion of five files .h : cpl_minixml.h, ogrsf_frmts.h, cpl_port.h, cpl_string.h, cpl_conv.h

These files are in folder gdal-1.3.2\port.

I didn't move none the files which create problem.

Is there a problem of code (version?), or is it the configuration of MS Visual Studio/C++ ?

Thank you

Jean-Daniel

(France)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060928/6a95ace7/attachment.html
From mateusz at loskot.net  Thu Sep 28 09:41:18 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] SPAM!!!: Errors with compilation of OGR
In-Reply-To: <001e01c6e301$c8f8d160$4869850a@gi.com>
References: <001e01c6e301$c8f8d160$4869850a@gi.com>
Message-ID: <451BD0FE.6040503@loskot.net>

Jean-Daniel GONON wrote:
> Hello,
> I have problems with compilation of OGR under MS Visual Studio 2005 and
> MS Visual C++ 6.0 :

OK, please show us exact commands you run and from which directories.
Otherwise, it will be hard or impossible to find out where is the problem.

Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From matt.wilkie at gov.yk.ca  Thu Sep 28 18:32:24 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] add ArcGIS 9.2 to list of projects using gdal
In-Reply-To: <451AEB8B.3060905@pobox.com>
References: <451ADDFE.6050100@gov.yk.ca> <451AEB8B.3060905@pobox.com>
Message-ID: <451C4D78.6020900@gov.yk.ca>

> I am very pleased to see writing GDAL plugins is supported as a way of 
> adding raster formats to ArcGIS.  I hadn't realized that was a supported approach.

me too :) Hopefully I'll be able to combine some of my scripts together 
now and not be jumping back and forth between fwtools and arc, and 
forgetting where I am.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From matt.wilkie at gov.yk.ca  Thu Sep 28 20:05:11 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] mario's fusion?
Message-ID: <451C6337.6000805@gov.yk.ca>

Hi All, does anybody know what happened to Mario Beauchamp's openev 
addons? They used to be here: 
http://pages.infinit.net/starged/openev/index.htm
I'm specifically interested in fusion.py.

thanks,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
http://environmentyukon.gov.yk.ca/geomatics/
--------------------------------------------


From ari.jolma at tkk.fi  Fri Sep 29 06:06:16 2006
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] add ArcGIS 9.2 to list of projects using gdal
In-Reply-To: <451AEB8B.3060905@pobox.com>
References: <451ADDFE.6050100@gov.yk.ca> <451AEB8B.3060905@pobox.com>
Message-ID: <451CF018.20908@tkk.fi>

Frank Warmerdam kirjoitti:
>
> The project list for the GDAL page now includes "ESRI ArcGIS 9.2+: A 
> popular GIS system."

GDAL seems to have multiple homes, I looked for this entry and..

https://gdal.osgeo.org/ ...no
http://www.remotesensing.org/gdal/ ...no
http://www.gdal.org/ ..ah, yes

Cheers,

Ari

-- 
Prof. Ari Jolma
Geoinformaatio- ja paikannustekniikka
Geoinformation and positioning technology
Teknillinen Korkeakoulu / Helsinki University of Technology
POBox 1200, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://www.tkk.fi/~jolma


From dany.geotools at gmail.com  Fri Sep 29 08:52:15 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] GDAL coordinate reference system retrieval problems.
Message-ID: <7221db410609290552k7d744446y6707dcd71240f73e@mail.gmail.com>

Hi list,
I have some problems during coordinate reference system retrieval operations
with GDAL.

Using gdalinfo or directly using "Dataset.GetProjection()" on some files, it
returns the empty string "" while,
using gdalinfo from FWTools, it returns the required projection string.

Any suggestion? (DLL, required library,...)?

Thank you very much.

-- 
Best Regards,
Daniele
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060929/04458cd6/attachment.html
From dany.geotools at gmail.com  Fri Sep 29 09:17:28 2006
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] GDAL coordinate reference system retrieval problems.
In-Reply-To: <6FD7C9DB26540B42A1207C69BF92D45501E7540E@Iris.ad.clarku.edu>
References: <6FD7C9DB26540B42A1207C69BF92D45501E7540E@Iris.ad.clarku.edu>
Message-ID: <7221db410609290617i4ac20aaag6fc9f44fc2f7d7b9@mail.gmail.com>

Dear Mr. Lucena,

Now I set this variable and it works fine.
Thank you very much.

Best Regards,
Daniele



On 9/29/06, Ivan Lucena <ILucena@clarku.edu> wrote:
>
>  Do you have GDAL_DATA environment variable set?
>
>
>  ------------------------------
>
> *From:* gdal-dev-bounces@lists.maptools.org [mailto:
> gdal-dev-bounces@lists.maptools.org] *On Behalf Of *Daniele Romagnoli
> *Sent:* Friday, September 29, 2006 8:52 AM
> *To:* gdal-dev@lists.maptools.org; Frank Warmerdam; Simone Giannecchini
> *Subject:* [Gdal-dev] GDAL coordinate reference system retrieval problems.
>
>
>
> Hi list,
> I have some problems during coordinate reference system retrieval
> operations with GDAL.
>
> Using gdalinfo or directly using "Dataset.GetProjection()" on some files,
> it returns the empty string "" while,
> using gdalinfo from FWTools, it returns the required projection string.
>
> Any suggestion? (DLL, required library,...)?
>
> Thank you very much.
>
> --
> Best Regards,
> Daniele
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060929/3bd6d5af/attachment.html
From starged at gmail.com  Fri Sep 29 10:47:28 2006
From: starged at gmail.com (Mario Beauchamp)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] mario's fusion?
In-Reply-To: <451C6337.6000805@gov.yk.ca>
References: <451C6337.6000805@gov.yk.ca>
Message-ID: <f5a8aca50609290747l77e4b749k492b5d5dff1dcaeb@mail.gmail.com>

Hi Matt,

On 9/28/06, Matt Wilkie <matt.wilkie@gov.yk.ca> wrote:
> Hi All, does anybody know what happened to Mario Beauchamp's openev
> addons? They used to be here:
> http://pages.infinit.net/starged/openev/index.htm
> I'm specifically interested in fusion.py.

They are now here: http://openev.sourceforge.net/mariotools/

BTW, starged@videotron.ca is no longer valid as well...

cheers
-- 
Mario B.

From matt.wilkie at gov.yk.ca  Fri Sep 29 18:06:32 2006
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] OFFTOPIC: No more paper topographic maps by NRCan...
Message-ID: <451D98E8.4000109@gov.yk.ca>

Please forgive this offtopic message. I know there are a lot of 
canadians on the list who might be interested in this news.

-matt

-------- Original Message --------
Subject: 	No more topographic maps by NRCan...
Date: 	Fri, 29 Sep 2006 13:45:37 -0700


NO MORE TOPOGRAPHIC MAPS
As of January 2007, Natural Resources Canada will discontinue the
printing of paper topographic maps and will close the Canada Map Office.
  Many of us rely heavily on these maps and there isn't always a good
alternative, especially for those without access to large plotters. If
you want more information on the topic and how you can voice your
disapproval (if you disagree), please see the website:
http://www.mapsforcanadians.ca/
---------------------------------



From andrea.aime at aliceposta.it  Thu Sep 28 13:09:15 2006
From: andrea.aime at aliceposta.it (aaime74)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Transparency in 8bit geotiffs with a color table
Message-ID: <6550742.post@talk.nabble.com>


Hi,
I'm trying, without success, to create a geotiff, byte format, with the last
entry of the
color table as a transparent color (by playing with alpha), but apparently I
keep on
getting opaque images.

Is there any way to get transparent output in 8bit geotiffs with a color
table?
Cheers
Andrea Aime
-- 
View this message in context: http://www.nabble.com/Transparency-in-8bit-geotiffs-with-a-color-table-tf2352161.html#a6550742
Sent from the GDAL - Dev mailing list archive at Nabble.com.


From mateusz at loskot.net  Sat Sep 30 14:59:38 2006
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] RFC DRAFT: Unicode support in GDAL
In-Reply-To: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
References: <29bcc0df0609210600r6ff22e94g86c61996a7eba1fe@mail.gmail.com>
Message-ID: <451EBE9A.703@loskot.net>

Andrey Kiselev wrote:
> On 9/21/06, Ben Discoe <ben@vterrain.org> wrote:
>> I am happy to do this work and submit it, i am just waiting to hear
>>  from you (or Frank, or..? Confused by GDAL's new democracy) that i
>>  should proceed.
> 
> We have discussed the issue today on IRC and now I want to come up 
> with the following proposal.
> 
> Unicode support in GDAL.

Just to complement the discussion, here is a document about unicode
support for C++ language standard posted by Matt Austern.
It's a proposal for next release of C++ Language Standard, C++0x (sic).

http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2035.pdf

Matt writes:

"This paper describes changes to the standard library that will be
needed if WG21 chooses to adopt N2018. It is a proposal for C++0x,
because it proposes changes in existing standard library
components."

This document gives concise explanation of Unicode and main aspects
Unicode support in programming language.
Thus, I believe it may be interesting for implementors of homemade
Unicode support and, also, to see what's the C++ language tendency in
this matter.


Cheers
-- 
Mateusz Loskot
http://mateusz.loskot.net

From andrea.aime at aliceposta.it  Thu Sep 28 13:09:15 2006
From: andrea.aime at aliceposta.it (aaime74)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] Transparency in 8bit geotiffs with a color table
Message-ID: <6550742.post@talk.nabble.com>


Hi,
I'm trying, without success, to create a geotiff, byte format, with the last
entry of the
color table as a transparent color (by playing with alpha), but apparently I
keep on
getting opaque images.

Is there any way to get transparent output in 8bit geotiffs with a color
table?
Cheers
Andrea Aime
-- 
View this message in context: http://www.nabble.com/Transparency-in-8bit-geotiffs-with-a-color-table-tf2352161.html#a6550742
Sent from the GDAL - Dev mailing list archive at Nabble.com.


From dmeeks at esri.com  Thu Sep 28 19:20:49 2006
From: dmeeks at esri.com (Dan Meeks)
Date: Wed Nov 21 11:50:23 2007
Subject: [Gdal-dev] NITF RPC support
Message-ID: <1991EA1FD4698B469010E81AEA3AD3BE08C62D6C@barbwire.esri.com>

Hi list,

 

Hopefully someone out there will be able to answer this question
concerning the support of NITF RPC. When reading RPCs from NITF, the
type of RPC (A or B) being used doesn't appear to be reflected in the
end result. Is it safe to assume that the translation of the NITF RPC
information for both RPC00A and RPC00B tags is appropriately translated
during the read of the data?

 

Thanks,

Dan Meeks

ESRI, Inc.

380 New York St.

Redlands, CA  92373

909-793-2853 x1692

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20060928/31c158fd/attachment.html
