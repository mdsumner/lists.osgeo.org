From g.moes at web.de  Sun Feb  1 20:09:37 2009
From: g.moes at web.de (Georges Moes)
Date: Sun Feb  1 20:09:38 2009
Subject: [Gdal-dev] KML with descriptions from Postgis Views via ogr2ogr
Message-ID: <1233536977163-2255911.post@n2.nabble.com>


I'm really impressed by the command-line functionality of ogr2ogr, since I've
found until now no suitable gui to use it under Windows.

Actually I try to create KML-files from Postgressql/Postgis-data with
ogr2ogr, which works fine. I encountered only two problems, that I couldn't
solve until now. Maybe there is someone that can help me.

My command looks like this:
ogr2ogr -f KML c:/parzellen.kml PG:"host=localhost port=5432 dbname=test
user=postgres password=XXXX" -sql "select ka_nr, ka_sect as Sektion, ka_flur
as Flur, ka_akte as Kaufakte, kart_dat as Kartierdatum, kart_pers as
Kartierer, pacht as P?chter, transform(the_geom,4326) from view_kataster"
-dsco NameField=kadaster_nr -dsco
DescriptionField=Sektion,Flur,Kaufakte,Kartierdatum,Kartierer,P?chter

My main problem is, that the kml-file is created, but doesn't display at the
right place in Google Earth. When opening the file in GE first GE zooms
close to the place, where the polygons should be. When I click in GE on the
imported layer, all the polygons are there, but they are displayed as point
marker??? When I click them, I get a balloon, with only a part of the
informations I wanted to be displayed. The main problem is, that the
balloons sit 'lost in space', meens outside the earth somewhere in space ??
When i hover the balloons with the mouse, the displayed lat and lon, and
hight values are OK.
I've tried to indicate the source and the target projection with -s_srs
"EPSG:2169" or -t_srs "EPSG:4326", but without other results.

The underlying table works fine, so maybe there is a problem with using
views in ogr2ogr??? 

The other problem is, that the kml-file only contains the NameField and the
3 first DescriptionFields (Sektion,Flur,Kaufakte), the rest is ignored. Are
there any restrictions I've ignored?

Maybe there is someone, who could give me an a tip or an answer to my
questions?


-- 
View this message in context: http://n2.nabble.com/KML-with-descriptions-from-Postgis-Views-via-ogr2ogr-tp2255911p2255911.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From a.neumann at carto.net  Mon Feb  2 03:49:53 2009
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon Feb  2 03:49:59 2009
Subject: [Gdal-dev] KML with descriptions from Postgis Views via ogr2ogr
In-Reply-To: <1233536977163-2255911.post@n2.nabble.com>
References: <1233536977163-2255911.post@n2.nabble.com>
Message-ID: <53878.193.246.86.39.1233564593.squirrel@webmail.customers.iirc.at>

Hi Georges,

I usually generate my KML files with a scripting language like PHP or
Perl. It gives you more fine-grained control over the structure and
content of the KML as opposed to "automatic" conversions like ogr2ogr or
FME.

It might be useful to post your KML somewhere if you want to have comments.

The KML tutorials at Google might be useful to get more insight on what
might be wrong with your KML:

http://code.google.com/apis/kml/documentation/kml_tut.html
also contains a KML reference.

If you want I can send you PHP examples how I generate polygons to KML
from Postgis. It is actually quite simple, since Postgis already offers
the AsKML() command for converting the geometry.

Andreas

>
> I'm really impressed by the command-line functionality of ogr2ogr, since
> I've
> found until now no suitable gui to use it under Windows.
>
> Actually I try to create KML-files from Postgressql/Postgis-data with
> ogr2ogr, which works fine. I encountered only two problems, that I
> couldn't
> solve until now. Maybe there is someone that can help me.
>
> My command looks like this:
> ogr2ogr -f KML c:/parzellen.kml PG:"host=localhost port=5432 dbname=test
> user=postgres password=XXXX" -sql "select ka_nr, ka_sect as Sektion,
> ka_flur
> as Flur, ka_akte as Kaufakte, kart_dat as Kartierdatum, kart_pers as
> Kartierer, pacht as P??chter, transform(the_geom,4326) from view_kataster"
> -dsco NameField=kadaster_nr -dsco
> DescriptionField=Sektion,Flur,Kaufakte,Kartierdatum,Kartierer,P??chter
>
> My main problem is, that the kml-file is created, but doesn't display at
> the
> right place in Google Earth. When opening the file in GE first GE zooms
> close to the place, where the polygons should be. When I click in GE on
> the
> imported layer, all the polygons are there, but they are displayed as
> point
> marker??? When I click them, I get a balloon, with only a part of the
> informations I wanted to be displayed. The main problem is, that the
> balloons sit 'lost in space', meens outside the earth somewhere in space
> ??
> When i hover the balloons with the mouse, the displayed lat and lon, and
> hight values are OK.
> I've tried to indicate the source and the target projection with -s_srs
> "EPSG:2169" or -t_srs "EPSG:4326", but without other results.
>
> The underlying table works fine, so maybe there is a problem with using
> views in ogr2ogr???
>
> The other problem is, that the kml-file only contains the NameField and
> the
> 3 first DescriptionFields (Sektion,Flur,Kaufakte), the rest is ignored.
> Are
> there any restrictions I've ignored?
>
> Maybe there is someone, who could give me an a tip or an answer to my
> questions?
>
>
> --
> View this message in context:
> http://n2.nabble.com/KML-with-descriptions-from-Postgis-Views-via-ogr2ogr-tp2255911p2255911.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Andreas Neumann
B?schacherstrasse 6, CH-8624 Gr?t/Gossau, Switzerland
Email: a.neumann@carto.net, Web:
* http://www.carto.net/ (Carto and SVG resources)
* http://www.carto.net/neumann/ (personal page)
* http://www.svgopen.org/ (SVG Open Conference)
* http://www.geofoto.ch/ (Georeferenced Photos of Switzerland)

From g.moes at web.de  Mon Feb  2 04:21:52 2009
From: g.moes at web.de (Georges Moes)
Date: Mon Feb  2 04:21:54 2009
Subject: [Gdal-dev] KML with descriptions from Postgis Views via ogr2ogr
In-Reply-To: <53878.193.246.86.39.1233564593.squirrel@webmail.customers.iirc.at>
References: <1233536977163-2255911.post@n2.nabble.com>
	<53878.193.246.86.39.1233564593.squirrel@webmail.customers.iirc.at>
Message-ID: <1233566512451-2257086.post@n2.nabble.com>


Thanks for your quick reply,

I'll have a look at the KML-page, maybe I'll find out what is wrong with my
kml-file.

I know that postgis offers the new function asKML(), but I still work with
postgresql 8.2 and the older version of postgis where this function isn't
yet available. It looks, as it should be worth to upgrade to the latest
version.

Nevertheless I would be interested in an php-way to use ogr2ogr.

Georges
    





Andreas Neumann wrote:
> 
> Hi Georges,
> 
> I usually generate my KML files with a scripting language like PHP or
> Perl. It gives you more fine-grained control over the structure and
> content of the KML as opposed to "automatic" conversions like ogr2ogr or
> FME.
> 
> It might be useful to post your KML somewhere if you want to have
> comments.
> 
> The KML tutorials at Google might be useful to get more insight on what
> might be wrong with your KML:
> 
> http://code.google.com/apis/kml/documentation/kml_tut.html
> also contains a KML reference.
> 
> If you want I can send you PHP examples how I generate polygons to KML
> from Postgis. It is actually quite simple, since Postgis already offers
> the AsKML() command for converting the geometry.
> 
> Andreas
> 
>>
>> I'm really impressed by the command-line functionality of ogr2ogr, since
>> I've
>> found until now no suitable gui to use it under Windows.
>>
>> Actually I try to create KML-files from Postgressql/Postgis-data with
>> ogr2ogr, which works fine. I encountered only two problems, that I
>> couldn't
>> solve until now. Maybe there is someone that can help me.
>>
>> My command looks like this:
>> ogr2ogr -f KML c:/parzellen.kml PG:"host=localhost port=5432 dbname=test
>> user=postgres password=XXXX" -sql "select ka_nr, ka_sect as Sektion,
>> ka_flur
>> as Flur, ka_akte as Kaufakte, kart_dat as Kartierdatum, kart_pers as
>> Kartierer, pacht as P??chter, transform(the_geom,4326) from
>> view_kataster"
>> -dsco NameField=kadaster_nr -dsco
>> DescriptionField=Sektion,Flur,Kaufakte,Kartierdatum,Kartierer,P??chter
>>
>> My main problem is, that the kml-file is created, but doesn't display at
>> the
>> right place in Google Earth. When opening the file in GE first GE zooms
>> close to the place, where the polygons should be. When I click in GE on
>> the
>> imported layer, all the polygons are there, but they are displayed as
>> point
>> marker??? When I click them, I get a balloon, with only a part of the
>> informations I wanted to be displayed. The main problem is, that the
>> balloons sit 'lost in space', meens outside the earth somewhere in space
>> ??
>> When i hover the balloons with the mouse, the displayed lat and lon, and
>> hight values are OK.
>> I've tried to indicate the source and the target projection with -s_srs
>> "EPSG:2169" or -t_srs "EPSG:4326", but without other results.
>>
>> The underlying table works fine, so maybe there is a problem with using
>> views in ogr2ogr???
>>
>> The other problem is, that the kml-file only contains the NameField and
>> the
>> 3 first DescriptionFields (Sektion,Flur,Kaufakte), the rest is ignored.
>> Are
>> there any restrictions I've ignored?
>>
>> Maybe there is someone, who could give me an a tip or an answer to my
>> questions?
>>
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/KML-with-descriptions-from-Postgis-Views-via-ogr2ogr-tp2255911p2255911.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> 
> -- 
> Andreas Neumann
> B?schacherstrasse 6, CH-8624 Gr?t/Gossau, Switzerland
> Email: a.neumann@carto.net, Web:
> * http://www.carto.net/ (Carto and SVG resources)
> * http://www.carto.net/neumann/ (personal page)
> * http://www.svgopen.org/ (SVG Open Conference)
> * http://www.geofoto.ch/ (Georeferenced Photos of Switzerland)
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/KML-with-descriptions-from-Postgis-Views-via-ogr2ogr-tp2255911p2257086.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jeff.hamann at forestinformatics.com  Mon Feb  2 11:52:28 2009
From: jeff.hamann at forestinformatics.com (Jeff Hamann)
Date: Mon Feb  2 11:54:41 2009
Subject: [gdal-dev] -update -append -f kml and -sql options for time series?
Message-ID: <498724CC.10304@forestinformatics.com>


I have no idea where to send this and after signing up for the another
list server, I thought I might try here. Let me first say that I have
been using the heck out of gdal, ogr2ogr, and postgis for a few days now 
to generate kml files with relative ease, using commands like:

ogr2ogr -f kml himom.kml PG:"host=localhost dbname=$1" -sql "select
st_transform(boundary,4326), blah, blah, blah from my table"

While this is awsome, I need to export a timestamp/timespan into the kml
file as well so I can make use of the time slider in google earth. I'm
a relative newbie to xml/kml and had no idea if ogr2ogr/postgis can do 
this. I'm pretty sure after some experimentation, that concatenating 
multiple files:

ogr2ogr -f kml himom.kml PG:"host=localhost dbname=$1" -sql "select
st_transform(boundary,4326), blah, blah, blah from my table where time = 
this_time"

ogr2ogr -update -append -f kml himom.kml PG:"host=localhost dbname=$1" 
-sql "select
st_transform(boundary,4326), blah, blah, blah from my table where time = 
next_time"

seems to only produce a file with the last query. So my questions are these:

1) is it possible to include additional tags 
<TimeSpan><when>...</when></TimeSpan> as part of the sql query (e.g. 
next_time as TimeStamp),

2) Does anyone know if the -update -append works with -sql,

3) While I think I can hack a solution (read I must hack a solution), 
where is the documentation for adding features to ogr2ogr),

4) Would it be easier to post process the generated kml file(s) and 
manipulate the file/entries myself  using another tool since I'm kind of 
new to xml/kml/gdal/etc.

Jeff D. Hamann, PhD
Forest Informatics


-------------- next part --------------
A non-text attachment was scrubbed...
Name: jeff_hamann.vcf
Type: text/x-vcard
Size: 284 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090202/82fb4c79/jeff_hamann.vcf
From jorge.arevalo at gmail.com  Mon Feb  2 12:18:46 2009
From: jorge.arevalo at gmail.com (Jorge)
Date: Mon Feb  2 12:18:51 2009
Subject: [gdal-dev] Creating a blank raster from scratch
Message-ID: <49872AF6.2050908@gmail.com>

Hello everybody

I'm creating a blank raster from scratch, to rasterize it later. Ok,
I've read the FAQ:

http://trac.osgeo.org/gdal/wiki/FAQRaster#HowcanIcreateablankrasterbasedonavectorfilesextentsforusewithgdal_rasterize

I've executed this code with no problems in a Mac, with Leopard. I've
used the frameworks at http://www.kyngchaos.com/software:frameworks. The
version of GDAL is 1.6.0, and the numpy version is 1.0.1 Now, I try to
execute the code in another machine, a PC with Suse Linux Enterpise 11.0
for 64bits processors. I've installed gdal and numpy from repositories.
The version of GDAL is 1.6.0, and numpy version is 1.2.1  So, the gdal
versions are the same. But if I open, for example, the file ogr.py in
both systems, are different files. Maybe the Framework I'm using is a
port of GDAL 1.6.0 to Mac with any changes?

And another issue: the code fails in the PC with Suse. The first error is:

src_lyr = src_ds.GetLayerByIndex( index = 0 )
AttributeError: DataSource instance has no attribute 'GetLayerByIndex'

I could solve the problem by changing the call to "GetLayerByIndex(
index = 0 )" for "GetLayer( 0 )". Why is this happening, if the version
of GDAL is 1.6.0 on both systems? Again, I think that maybe the
Framework I'm using is a port of GDAL 1.6.0 to Mac with any changes.

Then, made this change, I get another error, that I couldn't solve yet
(create_raster.py is the name of my file):

 File "./create_raster.py", line 112, in ?
    dst_ds.GetRasterBand(1).WriteArray( zeros )
  File "/usr/lib64/python2.4/site-packages/gdal.py", line 876, in WriteArray
    return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
  File "/usr/lib64/python2.4/site-packages/gdalnumeric.py", line 193, in
BandWriteArray
    datatype = NumericTypeCodeToGDALTypeCode( array.typecode() )
AttributeError: 'numpy.ndarray' object has no attribute 'typecode'

So, basically, the method "BandWriteArray" of gdalnumeric.py is
expecting an object array, with a method named "typecode()", but the
array created with numpy.zeros, don't have this attribute. Am I right?
Then, the fact is that in version 1.0.1 of numpy, the array created with
numpy.zeros has a method named "typecode()", but in version 1.2.1, this
attribute doesn't exist. Do I have to "downgrade" the numpy version from
1.2.1 to 1.0.1 to make the code works in suse? Is there another
solution? Sorry for this kind of questions, but I'm very newbie with Python

Thanks in advance!

Regards
Jorge




From condit at sdsc.edu  Mon Feb  2 14:01:23 2009
From: condit at sdsc.edu (Christopher Condit)
Date: Mon Feb  2 14:01:41 2009
Subject: [gdal-dev] -update -append -f kml and -sql options for time
	series?
In-Reply-To: <498724CC.10304@forestinformatics.com>
References: <498724CC.10304@forestinformatics.com>
Message-ID: <845AADAC1106E44996327D62097E4C6B0124359E@et.ad.sdsc.edu>

Hi Jeff-
> I have no idea where to send this and after signing up for the another
> list server, I thought I might try here. Let me first say that I have
> been using the heck out of gdal, ogr2ogr, and postgis for a few days
> now to generate kml files with relative ease, using commands like:
> 
> ogr2ogr -f kml himom.kml PG:"host=localhost dbname=$1" -sql "select
> st_transform(boundary,4326), blah, blah, blah from my table"
> 
> While this is awsome, I need to export a timestamp/timespan into the
> kml file as well so I can make use of the time slider in google earth.
> I'm a relative newbie to xml/kml and had no idea if ogr2ogr/postgis
can
> do this. I'm pretty sure after some experimentation, that
concatenating
> multiple files:
> 
> ogr2ogr -f kml himom.kml PG:"host=localhost dbname=$1" -sql "select
> st_transform(boundary,4326), blah, blah, blah from my table where time
> = this_time"
> 
> ogr2ogr -update -append -f kml himom.kml PG:"host=localhost dbname=$1"
> -sql "select
> st_transform(boundary,4326), blah, blah, blah from my table where time
> = next_time"
> 
> seems to only produce a file with the last query. So my questions are
> these:
> 
> 1) is it possible to include additional tags
> <TimeSpan><when>...</when></TimeSpan> as part of the sql query (e.g.
> next_time as TimeStamp),
At this point the KML driver does not recognize the Date/Time type in
OGR. Your idea is a good one, but since the output of the transformation
is KML the driver should be escaping the content of the elements. So
your content would end up like:
&lt;TimeSpanA&gt; and so forth. See point 4 below for a possible
solution.

> 2) Does anyone know if the -update -append works with -sql,
It's not that it doesn't work with -sql, it's that the current KML
driver doesn't support an update.

> 3) While I think I can hack a solution (read I must hack a solution),
> where is the documentation for adding features to ogr2ogr),
http://www.gdal.org/ogr/ogr_drivertut.html
is a good place to start. The existing driver is limited in its
capabilities. I'm in the process of updating the driver to work with
libkml, at which point updates and appends would be supported.
 
> 4) Would it be easier to post process the generated kml file(s) and
> manipulate the file/entries myself  using another tool since I'm kind
> of new to xml/kml/gdal/etc.
Yes. I think the easiest way is to simply write a short XSL transform
that you can filter your content through. You can use this to both
combine your various KML outputs and change the dates (which come out as
strings) to actual time stamps.
I wrote something on the wiki about applying styles, but you could
easily adapt this to whatever you need.
http://trac.osgeo.org/gdal/wiki/KML

-Chris

Christopher Condit
condit@sdsc.edu
(858) 822-5483
From jeff.hamann at forestinformatics.com  Mon Feb  2 14:15:03 2009
From: jeff.hamann at forestinformatics.com (Jeff Hamann)
Date: Mon Feb  2 14:15:06 2009
Subject: [gdal-dev] -f kml and -sql options for TimeStamp
Message-ID: <49874637.1040402@forestinformatics.com>

In the last hour I've managed to export KML files using the following 
syntax after some simple mods (read mimic the name/description handling) 
to the KML export functions in OGR:


/Library/Frameworks/GDAL.framework/Programs/ogr2ogr \
-f KML activity.kml  \
PG:"host=localhost dbname=wadnr" \
-sql "select st_transform(st_centroid(boundary),4326), \
current_database() as name, \
now() as generated_when, \
effective_date || 'D' as TimeStamp \
from tmp_tbl limit 15000" \
-nlt POINT \
-nln activity

I'm not sure the best way to get this code back into the repos if anyone 
is interested (and I haven't bothered to fix the following):

ogr2ogr(25854) malloc: *** error for object 0xf01350: incorrect checksum 
for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug
ogr2ogr(25854) malloc: *** error for object 0xf01360: incorrect checksum 
for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug
ogr2ogr(25854) malloc: *** error for object 0xf01370: incorrect checksum 
for freed object - object was probably modified after being freed.
*** set a breakpoint in malloc_error_break to debug

Warning 1: Multi-column primary key in 'stems' detected but not supported.

jeff-hamanns-macbook-pro:trunk hamannj$

but it does the job of adding the following tags/elements/whatever 
they're called to the file:

<TimeStamp><when>2002-05-18D</when></TimeStamp>

to each placemark, which is what I needed. I have a feeling I'll be 
hacking on this again in the next few days, so any advice for putting in 
   other features would be helpful. Ultimately, I need to include both 
TimeStamps and TimeSpans for each entry (Placemark/Linestring/Polygon). 
Next stop, coloring the pins ;-)


Jeff.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: jeff_hamann.vcf
Type: text/x-vcard
Size: 284 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090202/2710ea85/jeff_hamann.vcf
From JARED.RUBIN at saic.com  Mon Feb  2 14:35:09 2009
From: JARED.RUBIN at saic.com (Jared Rubin)
Date: Mon Feb  2 14:49:03 2009
Subject: [gdal-dev] core dumping on PNG RGB creation
Message-ID: <1233603309.7062.562.camel@pelican.tucson.saic.com>

I am unable to generate a RGB png image from the python swig interface.
The following code does work if I change the driver to BMP. Is there
something odd about the PNG driver?
Thanks


import osgeo.gdal as gdal
import numpy
buf = (numpy.random.rand(100*100*3)*255).round() % 255
buf = buf.reshape(100,100,3)
driver = gdal.GetDriverByName('PNG')
ds = driver.Create('tmp.png',100,100,3)
ds.GetRasterBand(1).WriteArray(buf[:,:,0])
ds.GetRasterBand(2).WriteArray(buf[:,:,1])
ds.GetRasterBand(3).WriteArray(buf[:,:,2])



From lran at unc.edu  Mon Feb  2 15:05:23 2009
From: lran at unc.edu (Limei Ran)
Date: Mon Feb  2 15:05:25 2009
Subject: [gdal-dev] Error message in reading as
Message-ID: <20090202150523.aqyexco80gw8cg8c@webmail3.isis.unc.edu>


Hi:

I have a question about reading a grib image file.  I opened this file 
with GDALOpen to get the general information about the image.  Along 
the information I printed out, I also I got an error message and 
warning:
==============
Warning: Inside GRIB2Inventory, Message # 2
ERROR: Ran out of file reading SECT0
There were 78 trailing bytes in the file.
        Driver: GRIB/GRIdded Binary (.grb)
        Size is 1500x800x1
        Origin = (-2996013.616997,5845025.240730)
        Pixel Size = (4000.000,4000.000)
==============

Could you tell me what the warning and error messages are about?  Do 
they affect how I read the data in the image?

Thanks,

Limei

From ivan.lucena at pmldnet.com  Mon Feb  2 15:05:42 2009
From: ivan.lucena at pmldnet.com (=?utf-8?Q?Lucena,=20Ivan?=)
Date: Mon Feb  2 15:05:44 2009
Subject: =?utf-8?B?UmU6IFtnZGFsLWRldl0gY29yZSBkdW1waW5nIG9uIFBORyBSR0IgY3JlYXRpb24=?=
Message-ID: <20090202200542.11597.qmail@s466.sureserver.com>

That is because the PNG driver does not support Create() Method. 

Compare the two outputs:

% gdalinfo --format png
% gdalinfo --format gtiff


>  -------Original Message-------
>  From: Jared Rubin <JARED.RUBIN@saic.com>
>  Subject: [gdal-dev] core dumping on PNG RGB creation
>  Sent: Feb 02 '09 19:35
>  
>  I am unable to generate a RGB png image from the python swig interface.
>  The following code does work if I change the driver to BMP. Is there
>  something odd about the PNG driver?
>  Thanks
>  
>  
>  import osgeo.gdal as gdal
>  import numpy
>  buf = (numpy.random.rand(100*100*3)*255).round() % 255
>  buf = buf.reshape(100,100,3)
>  driver = gdal.GetDriverByName('PNG')
>  ds = driver.Create('tmp.png',100,100,3)
>  ds.GetRasterBand(1).WriteArray(buf[:,:,0])
>  ds.GetRasterBand(2).WriteArray(buf[:,:,1])
>  ds.GetRasterBand(3).WriteArray(buf[:,:,2])
>  
>  
>  
>  _______________________________________________
>  gdal-dev mailing list
>  gdal-dev@lists.osgeo.org
>  http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  

From JARED.RUBIN at saic.com  Mon Feb  2 15:13:22 2009
From: JARED.RUBIN at saic.com (Jared Rubin)
Date: Mon Feb  2 15:12:08 2009
Subject: [gdal-dev] core dumping on PNG RGB creation
In-Reply-To: <20090202200542.11597.qmail@s466.sureserver.com>
References: <20090202200542.11597.qmail@s466.sureserver.com>
Message-ID: <1233605602.7062.565.camel@pelican.tucson.saic.com>

But if the following define is set when building gdal 
-DSUPPORT_CREATE then the PNG driver will support the CREATE method
Jared

On Mon, 2009-02-02 at 20:05 +0000, Lucena, Ivan wrote:
> 
> That is because the PNG driver

From warmerdam at pobox.com  Mon Feb  2 15:40:39 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Feb  2 15:40:59 2009
Subject: [gdal-dev] Error message in reading as
In-Reply-To: <20090202150523.aqyexco80gw8cg8c@webmail3.isis.unc.edu>
References: <20090202150523.aqyexco80gw8cg8c@webmail3.isis.unc.edu>
Message-ID: <49875A47.7070003@pobox.com>

Limei Ran wrote:
> 
> Hi:
> 
> I have a question about reading a grib image file.  I opened this file 
> with GDALOpen to get the general information about the image.  Along the 
> information I printed out, I also I got an error message and warning:
> ==============
> Warning: Inside GRIB2Inventory, Message # 2
> ERROR: Ran out of file reading SECT0
> There were 78 trailing bytes in the file.
>        Driver: GRIB/GRIdded Binary (.grb)
>        Size is 1500x800x1
>        Origin = (-2996013.616997,5845025.240730)
>        Pixel Size = (4000.000,4000.000)
> ==============
> 
> Could you tell me what the warning and error messages are about?  Do 
> they affect how I read the data in the image?

Limei,

I don't know exactly what the error means.  It comes from the lower level
grib library.  I imagine you would need to experiment to see how well the
resulting dataset works.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Mon Feb  2 18:09:16 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Feb  2 18:09:30 2009
Subject: [gdal-dev] core dumping on PNG RGB creation
In-Reply-To: <1233605602.7062.565.camel@pelican.tucson.saic.com>
References: <20090202200542.11597.qmail@s466.sureserver.com>
	<1233605602.7062.565.camel@pelican.tucson.saic.com>
Message-ID: <200902030009.18010.even.rouault@mines-paris.org>

Jared,

It looks like you're looking for big troubles ;-)

If SUPPORT_CREATE is not defined by default in standard GDAL built, it means 
that it is not production ready... After having looked at the code a bit, I 
can tell you that it is definitely not ready to work bullet-proof and would 
require a lot of love. I think it will probably never meet the expectations 
for a driver supporting Create() (random write access for example), because 
of the way libpng works. 

In particular, it can't support writing separately in raster bands in 
multiband case like what you are doing (it would require caching the data for 
each whole band...). You should use interleaved writing (write data for the 3 
bands of the first line, then write data for the 3 bands of the second line, 
etc.) but I'm afraid you'll go into other issues again, like the file not 
being properly closed, uninitalized variables, being unable to read the 
content of the created dataset without closing it (which might be an issue if 
cache size is not sufficient), etc etc...

So my advice if you want to safely generate a PNG : use the MEM driver to 
write your data and then CreateCopy() the MEM dataset into a PNG.

Something like :

import osgeo.gdal as gdal
import numpy
buf = (numpy.random.rand(100*100*3)*255).round() % 255
buf = buf.reshape(100,100,3)
driver = gdal.GetDriverByName('MEM')
ds = driver.Create('tmp.mem', 100,100,3)
ds.GetRasterBand(1).WriteArray(buf[:,:,0])
ds.GetRasterBand(2).WriteArray(buf[:,:,1])
ds.GetRasterBand(3).WriteArray(buf[:,:,2])
ds2 = gdal.GetDriverByName('PNG').CreateCopy('tmp.png', ds)
ds = None
ds2 = None

Even

Le Monday 02 February 2009 21:13:22 Jared Rubin, vous avez ?crit?:
> But if the following define is set when building gdal
> -DSUPPORT_CREATE then the PNG driver will support the CREATE method
> Jared
>
> On Mon, 2009-02-02 at 20:05 +0000, Lucena, Ivan wrote:
> > That is because the PNG driver
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From no-reply at neogeo-online.net  Tue Feb  3 03:13:59 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Tue Feb  3 03:14:04 2009
Subject: [gdal-dev] GeoJSON from FME
Message-ID: <4987FCC7.7000803@neogeo-online.net>

Hi list,

I'm trying to feed my app with a geoJSON file generated by FME, which
then should be translated to postGIS by ogr. But the FME GeoJSON looks
suspicious, as it begins by :
{"LIEU_Geocodes_new":{"type":"FeatureCollection"
where LIEU_Geocodes_new is the name of the original MapInfo file
processed to geoJSON by FME.
this global object is out of the geoJSON specifications, and makes ogr
fail to translate the file. If I just remove this encapsulation, it goes
well.
Any of you would know why FME is returning such misformed geoJSON ?

Regards

Guillaume Sueur
From johanlahti at gmail.com  Tue Feb  3 04:20:55 2009
From: johanlahti at gmail.com (Johan_L)
Date: Tue Feb  3 04:20:58 2009
Subject: [Gdal-dev] transform point problem using gdal 1.5 with osr
In-Reply-To: <f0c176350812162323l2b47772dudb95af85829f6e61@mail.gmail.com>
References: <f0c176350812162323l2b47772dudb95af85829f6e61@mail.gmail.com>
Message-ID: <1233652855690-2262370.post@n2.nabble.com>


I'm having the same problem. I tried another way according to one example I
found, which doesn't work either:

from osgeo import ogr, osr

# Get the geometry object
ds = ogr.Open("inFile.shp")
layer = ds.GetLayer()
feature = layer.GetNextFeature()
geom = feature.GetGeometryRef()

# Get the coordinate systems and transform
inSR = osr.SpatialReference()
inSR.GetGeometryRef() # this is WGS84
outSR = osr.SpatialReference()
outSR.ImportFromEPSG(2400) # RT90 (Sweden)
coordTrans = osr.CoordinateTransformation(inSR, outSR)
geom.Transform(coordTrans)


Results in the following error message:

TypeError: in method 'Geometry_Transform', argument 2 of type
'OSRCoordinateTransformationShadow *'




prairie Last wrote:
> 
> I am trying to tranform one coordinate system to another (wgs84 to utm).
> Found one example on the internet (adapted a little). It got an error when
> I
> try to run the program. Since I am new to GDAL, I cannot figure out how to
> correct this. Please see the following program. I also tried to add one
> more
> value to "res.ct.TransformPoint(lon, lat)", but it did not solve the
> problem.  Any help or hint appreciated. I also attach the error to the
> end.
> 
> from osgeo import osr
> import math
> import pyproj
> 
> def UTMZone(lon, lat):
>     return int((lon + 180) / 6) + 1
> if __name__ == '__main__':
>     lat = 41.395304
>     lon = 73.310067
> 
>     wgs84 = osr.SpatialReference()
>     utm = osr.SpatialReference()
>     wgs84.ImportFromProj4("+proj=latlong +datum=WGS84")
>     utm.ImportFromProj4("+proj=utm +zone="+str(UTMZone(lon,lat))+"
> +datum=WGS84")
>     ct = osr.CoordinateTransformation(wgs84,utm)
>     res= ct.TransformPoint(lon, lat)
>     print res
> 
> 
> 
> 
> 
>  Error Message:
> 
> Traceback (most recent call last):
>   File "C:\Python25\trans.py", line 28, in <module>
>     res= ct.TransformPoint(lon, lat)
>   File "C:\Python25\lib\site-packages\osgeo\osr.py", line 602, in
> TransformPoint
>     return _osr.CoordinateTransformation_TransformPoint(*args)
> NotImplementedError: Wrong number of arguments for overloaded function
> 'CoordinateTransformation_TransformPoint'.
>   Possible C/C++ prototypes are:
>     TransformPoint(double [3])
>     TransformPoint(double [3],double,double,double)
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/transform-point-problem-using-gdal-1.5-with-osr-tp2036503p2262370.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gdal at archivideo.com  Tue Feb  3 05:00:13 2009
From: gdal at archivideo.com (Johan Nouvel)
Date: Tue Feb  3 05:00:28 2009
Subject: [gdal-dev] erosion/dilation in gdal ?
Message-ID: <498815AD.8020206@archivideo.com>

Hello all,

Is there a way to do erosion/dilatation on image in gdal ?

I've looked in alg.h, but I've seen no straight way to do such thing.

Any idea ?

Regards,
Johan.

-- 
Johan Nouvel, R&D Engineer
http://www.archivideo.com
tel : +33 (0)2 99 86 30 20
ARCHIVIDEO, 40 rue des Veyettes, 35000 RENNES, FRANCE
From mateusz at loskot.net  Tue Feb  3 05:04:20 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue Feb  3 05:05:57 2009
Subject: [gdal-dev] GeoJSON from FME
In-Reply-To: <4987FCC7.7000803@neogeo-online.net>
References: <4987FCC7.7000803@neogeo-online.net>
Message-ID: <498816A4.5020409@loskot.net>

Guillaume Sueur wrote:
> Hi list,
> 
> I'm trying to feed my app with a geoJSON file generated by FME, which
> then should be translated to postGIS by ogr. But the FME GeoJSON looks
> suspicious, as it begins by :
> {"LIEU_Geocodes_new":{"type":"FeatureCollection"
> where LIEU_Geocodes_new is the name of the original MapInfo file
> processed to geoJSON by FME.
> this global object is out of the geoJSON specifications, and makes ogr
> fail to translate the file. If I just remove this encapsulation, it goes
> well.

Guillaume,

I can confirm that FME returns extra bits in GeoJSON output.
As I see, it isn't documented in "FME Readers and Writers" manual, so 
little to say.

> Any of you would know why FME is returning such misformed geoJSON ?

I would suggest to ask your question on FMETalk

http://groups.google.com/group/fmetalk

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From cristian.balint at gmail.com  Tue Feb  3 05:22:53 2009
From: cristian.balint at gmail.com (Balint Cristian)
Date: Tue Feb  3 05:23:36 2009
Subject: [gdal-dev] erosion/dilation in gdal ?
In-Reply-To: <498815AD.8020206@archivideo.com>
References: <498815AD.8020206@archivideo.com>
Message-ID: <BA9CAA546ED5411CBD6C7ECD40A6F6DC@Yoda>


----- Original Message ----- 
From: "Johan Nouvel" <gdal@archivideo.com>
To: <gdal-dev@lists.osgeo.org>
Sent: Tuesday, February 03, 2009 12:00 PM
Subject: [gdal-dev] erosion/dilation in gdal ?


> Hello all,
> 
> Is there a way to do erosion/dilatation on image in gdal ?
> 
> I've looked in alg.h, but I've seen no straight way to do such thing.
> 
> Any idea ?

   Best way should be using third party (e.g. GIMP can do even 
batch mode in CLI) or imagemagick, but first you want to
save spatial information with 'listgeo' than restore it back after
mangling the data as plain 'picture' with 'geotiffcp'.

http://svn.osgeo.org/metacrs/geotiff/trunk/libgeotiff/docs/listgeo.html

Its an idea.

/Cristian.

 
From jorge.arevalo at gmail.com  Tue Feb  3 06:39:45 2009
From: jorge.arevalo at gmail.com (Jorge)
Date: Tue Feb  3 06:39:51 2009
Subject: [gdal-dev] Re: Creating a blank raster from scratch
In-Reply-To: <49872AF6.2050908@gmail.com>
References: <49872AF6.2050908@gmail.com>
Message-ID: <49882D01.4020307@gmail.com>

Hello again,

I' ve found the problem, I think. Is the version of numpy used by
gdalnumeric. The code from FAQ works with numpy version 1.0.1, but fails
with numpy version 1.2.1. The fail is because the narray attribute
"typecode()" doesn't exist. From the numpy book, available at
http://numpy.scipy.org/numpybook.pdf, you can get (page 55):

"If you are converting code from Numeric, then you
will need to make the following (search and replace)
conversions: .typecode() --> .dtype.char;
.iscontiguous() --> .flags.contiguous;
.byteswapped() --> .byteswap(); .toscalar()
--> .item(); and .itemsize() --> .itemsize. The
numpy.oldnumeric.alter code1 module can automate this for you."

Ok. I've opened gdalnumeric.py, and the last change was from 2006/03/21.
The older version from numpy available at sourceforge download's page is
from 2007-11-08. Then, gdal is using a really old version of numpy.
Maybe I can use the numpy 1.0.1 from my mac, but I think that it would
be easier to replace the snippet's code lines that uses numpy from the
correct ones. What's the best way to do this

        # Create blank raster with fully opaque alpha band
        zeros = numpy.zeros( (tiff_height, tiff_width), numpy.uint8 )
        dst_ds.GetRasterBand(1).WriteArray( zeros )
        dst_ds.GetRasterBand(2).WriteArray( zeros )
        dst_ds.GetRasterBand(3).WriteArray( zeros )
        opaque = numpy.zeros((tiff_height,tiff_width), numpy.uint8 )*255
        dst_ds.GetRasterBand(4).WriteArray( opaque )

by using gdal? Because, if I'm right, this snippet from the FAQ is
deprecated.

Regards
Jorge

Jorge escribi?:
> Hello everybody
>
> I'm creating a blank raster from scratch, to rasterize it later. Ok,
> I've read the FAQ:
>
> http://trac.osgeo.org/gdal/wiki/FAQRaster#HowcanIcreateablankrasterbasedonavectorfilesextentsforusewithgdal_rasterize
>
> I've executed this code with no problems in a Mac, with Leopard. I've
> used the frameworks at http://www.kyngchaos.com/software:frameworks. The
> version of GDAL is 1.6.0, and the numpy version is 1.0.1 Now, I try to
> execute the code in another machine, a PC with Suse Linux Enterpise 11.0
> for 64bits processors. I've installed gdal and numpy from repositories.
> The version of GDAL is 1.6.0, and numpy version is 1.2.1  So, the gdal
> versions are the same. But if I open, for example, the file ogr.py in
> both systems, are different files. Maybe the Framework I'm using is a
> port of GDAL 1.6.0 to Mac with any changes?
>
> And another issue: the code fails in the PC with Suse. The first error is:
>
> src_lyr = src_ds.GetLayerByIndex( index = 0 )
> AttributeError: DataSource instance has no attribute 'GetLayerByIndex'
>
> I could solve the problem by changing the call to "GetLayerByIndex(
> index = 0 )" for "GetLayer( 0 )". Why is this happening, if the version
> of GDAL is 1.6.0 on both systems? Again, I think that maybe the
> Framework I'm using is a port of GDAL 1.6.0 to Mac with any changes.
>
> Then, made this change, I get another error, that I couldn't solve yet
> (create_raster.py is the name of my file):
>
>  File "./create_raster.py", line 112, in ?
>     dst_ds.GetRasterBand(1).WriteArray( zeros )
>   File "/usr/lib64/python2.4/site-packages/gdal.py", line 876, in WriteArray
>     return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
>   File "/usr/lib64/python2.4/site-packages/gdalnumeric.py", line 193, in
> BandWriteArray
>     datatype = NumericTypeCodeToGDALTypeCode( array.typecode() )
> AttributeError: 'numpy.ndarray' object has no attribute 'typecode'
>
> So, basically, the method "BandWriteArray" of gdalnumeric.py is
> expecting an object array, with a method named "typecode()", but the
> array created with numpy.zeros, don't have this attribute. Am I right?
> Then, the fact is that in version 1.0.1 of numpy, the array created with
> numpy.zeros has a method named "typecode()", but in version 1.2.1, this
> attribute doesn't exist. Do I have to "downgrade" the numpy version from
> 1.2.1 to 1.0.1 to make the code works in suse? Is there another
> solution? Sorry for this kind of questions, but I'm very newbie with Python
>
> Thanks in advance!
>
> Regards
> Jorge
>
>
>
>
>
>   

-- 
"Afirmo con total convicci?n que la religi?n cristiana organizada como Iglesia ha sido y es a?n la principal enemiga del progreso moral en el mundo"

"La religi?n se basa, pienso, principal y primariamente en el miedo. El miedo es el padre de la crueldad, y por tanto no es sorprendente que crueldad y religi?n han ido tomadas de la mano. La ciencia puede ayudarnos a superar este cobarde temor en que ha vivido la humanidad por tantas generaciones." 

(Bertrand Russell)

From jorge.arevalo at gmail.com  Tue Feb  3 06:53:17 2009
From: jorge.arevalo at gmail.com (Jorge)
Date: Tue Feb  3 06:53:25 2009
Subject: [gdal-dev] Re: Creating a blank raster from scratch
In-Reply-To: <49882D01.4020307@gmail.com>
References: <49872AF6.2050908@gmail.com> <49882D01.4020307@gmail.com>
Message-ID: <4988302D.8080103@gmail.com>

And finally, hello

Sorry for being annoying. I've found this ticket closed 2 years ago
http://trac.osgeo.org/gdal/ticket/1166.

I'll apply the patch, but I think that this should be added with the
FAQ. Saves time :-)

Best regards
Jorge

Jorge escribi?:
> Hello again,
>
> I' ve found the problem, I think. Is the version of numpy used by
> gdalnumeric. The code from FAQ works with numpy version 1.0.1, but fails
> with numpy version 1.2.1. The fail is because the narray attribute
> "typecode()" doesn't exist. From the numpy book, available at
> http://numpy.scipy.org/numpybook.pdf, you can get (page 55):
>
> "If you are converting code from Numeric, then you
> will need to make the following (search and replace)
> conversions: .typecode() --> .dtype.char;
> .iscontiguous() --> .flags.contiguous;
> .byteswapped() --> .byteswap(); .toscalar()
> --> .item(); and .itemsize() --> .itemsize. The
> numpy.oldnumeric.alter code1 module can automate this for you."
>
> Ok. I've opened gdalnumeric.py, and the last change was from 2006/03/21.
> The older version from numpy available at sourceforge download's page is
> from 2007-11-08. Then, gdal is using a really old version of numpy.
> Maybe I can use the numpy 1.0.1 from my mac, but I think that it would
> be easier to replace the snippet's code lines that uses numpy from the
> correct ones. What's the best way to do this
>
>         # Create blank raster with fully opaque alpha band
>         zeros = numpy.zeros( (tiff_height, tiff_width), numpy.uint8 )
>         dst_ds.GetRasterBand(1).WriteArray( zeros )
>         dst_ds.GetRasterBand(2).WriteArray( zeros )
>         dst_ds.GetRasterBand(3).WriteArray( zeros )
>         opaque = numpy.zeros((tiff_height,tiff_width), numpy.uint8 )*255
>         dst_ds.GetRasterBand(4).WriteArray( opaque )
>
> by using gdal? Because, if I'm right, this snippet from the FAQ is
> deprecated.
>
> Regards
> Jorge
>
> Jorge escribi?:
>   
>> Hello everybody
>>
>> I'm creating a blank raster from scratch, to rasterize it later. Ok,
>> I've read the FAQ:
>>
>> http://trac.osgeo.org/gdal/wiki/FAQRaster#HowcanIcreateablankrasterbasedonavectorfilesextentsforusewithgdal_rasterize
>>
>> I've executed this code with no problems in a Mac, with Leopard. I've
>> used the frameworks at http://www.kyngchaos.com/software:frameworks. The
>> version of GDAL is 1.6.0, and the numpy version is 1.0.1 Now, I try to
>> execute the code in another machine, a PC with Suse Linux Enterpise 11.0
>> for 64bits processors. I've installed gdal and numpy from repositories.
>> The version of GDAL is 1.6.0, and numpy version is 1.2.1  So, the gdal
>> versions are the same. But if I open, for example, the file ogr.py in
>> both systems, are different files. Maybe the Framework I'm using is a
>> port of GDAL 1.6.0 to Mac with any changes?
>>
>> And another issue: the code fails in the PC with Suse. The first error is:
>>
>> src_lyr = src_ds.GetLayerByIndex( index = 0 )
>> AttributeError: DataSource instance has no attribute 'GetLayerByIndex'
>>
>> I could solve the problem by changing the call to "GetLayerByIndex(
>> index = 0 )" for "GetLayer( 0 )". Why is this happening, if the version
>> of GDAL is 1.6.0 on both systems? Again, I think that maybe the
>> Framework I'm using is a port of GDAL 1.6.0 to Mac with any changes.
>>
>> Then, made this change, I get another error, that I couldn't solve yet
>> (create_raster.py is the name of my file):
>>
>>  File "./create_raster.py", line 112, in ?
>>     dst_ds.GetRasterBand(1).WriteArray( zeros )
>>   File "/usr/lib64/python2.4/site-packages/gdal.py", line 876, in WriteArray
>>     return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
>>   File "/usr/lib64/python2.4/site-packages/gdalnumeric.py", line 193, in
>> BandWriteArray
>>     datatype = NumericTypeCodeToGDALTypeCode( array.typecode() )
>> AttributeError: 'numpy.ndarray' object has no attribute 'typecode'
>>
>> So, basically, the method "BandWriteArray" of gdalnumeric.py is
>> expecting an object array, with a method named "typecode()", but the
>> array created with numpy.zeros, don't have this attribute. Am I right?
>> Then, the fact is that in version 1.0.1 of numpy, the array created with
>> numpy.zeros has a method named "typecode()", but in version 1.2.1, this
>> attribute doesn't exist. Do I have to "downgrade" the numpy version from
>> 1.2.1 to 1.0.1 to make the code works in suse? Is there another
>> solution? Sorry for this kind of questions, but I'm very newbie with Python
>>
>> Thanks in advance!
>>
>> Regards
>> Jorge
>>
>>
>>
>>
>>
>>   
>>     
>
>   

-- 
"Afirmo con total convicci?n que la religi?n cristiana organizada como Iglesia ha sido y es a?n la principal enemiga del progreso moral en el mundo"

"La religi?n se basa, pienso, principal y primariamente en el miedo. El miedo es el padre de la crueldad, y por tanto no es sorprendente que crueldad y religi?n han ido tomadas de la mano. La ciencia puede ayudarnos a superar este cobarde temor en que ha vivido la humanidad por tantas generaciones." 

(Bertrand Russell)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090203/9b32a323/attachment-0001.html
From no-reply at neogeo-online.net  Tue Feb  3 06:57:29 2009
From: no-reply at neogeo-online.net (Guillaume Sueur)
Date: Tue Feb  3 06:57:42 2009
Subject: [gdal-dev] GeoJSON from FME
In-Reply-To: <498816A4.5020409@loskot.net>
References: <4987FCC7.7000803@neogeo-online.net> <498816A4.5020409@loskot.net>
Message-ID: <49883129.3070105@neogeo-online.net>


> 
> I can confirm that FME returns extra bits in GeoJSON output.
> As I see, it isn't documented in "FME Readers and Writers" manual, so
> little to say.

nice to hear i didn't screw it up !

> 
>> Any of you would know why FME is returning such misformed geoJSON ?
> 
> I would suggest to ask your question on FMETalk
> 
> http://groups.google.com/group/fmetalk

nice tip

Thanks

Guillaume

From wroberts at csir.co.za  Tue Feb  3 08:54:56 2009
From: wroberts at csir.co.za (Wesley Roberts)
Date: Tue Feb  3 09:11:02 2009
Subject: [gdal-dev] Transformation from WGS84 to Cape Datum
Message-ID: <498868D702000073000184C3@pta-emo.csir.co.za>

Dear list

I have a shapefile with the following projection, see below (using 'ogrinfo -al Richmond_compartments_WGS84.shp')

I would like to perform a datum transformation from WGS84 to the Cape Datum using the clark 1880 spheroid. Is this possible using ogr? I have tried using ogr2ogr but have had no luck as I am not sure how to specify the correct projection parameters and am not sure if ogr supports the Cape Datum and clark 1880 spheroid. 

One error I receive is that the program fails to initialise PROJ.4. I have installed PROJ.4 prior to my grass instillation so it should be there.

Could someone point me towards a tutorial or help file describing the supported datums and spheroids or give an example of the syntax used.

Many thanks,
Wesley



**********************************************************************************************************************************************
INFO: Open of `Richmond_compartments_WGS84.shp'
      using driver `ESRI Shapefile' successful.

Layer name: Richmond_compartments_WGS84
Geometry: Polygon
Feature Count: 2798
Extent: (-101046.795901, -3391548.960746) - (-58458.688098, -3267168.091898)
Layer SRS WKT:
PROJCS["STMLO31",
    GEOGCS["WGS84",
        DATUM["WGS84",
            SPHEROID["WGS84",6378137.0,298.257223599998]],
        PRIMEM["Greenwich",0.0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["False_Easting",0.0],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",31.0],
    PARAMETER["Scale_Factor",-1.0],
    PARAMETER["Latitude_of_Origin",0.0],
    UNIT["Meter",1.0]]
**********************************************************************************************************************************************








-- 
This message is subject to the CSIR's copyright terms and conditions, e-mail legal notice, and implemented Open Document Format (ODF) standard. 
The full disclaimer details can be found at http://www.csir.co.za/disclaimer.html.

This message has been scanned for viruses and dangerous content by MailScanner, 
and is believed to be clean.  MailScanner thanks Transtec Computers for their support.

From warmerdam at pobox.com  Tue Feb  3 10:33:54 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Feb  3 10:34:12 2009
Subject: [gdal-dev] erosion/dilation in gdal ?
In-Reply-To: <498815AD.8020206@archivideo.com>
References: <498815AD.8020206@archivideo.com>
Message-ID: <498863E2.1020309@pobox.com>

Johan Nouvel wrote:
> Hello all,
> 
> Is there a way to do erosion/dilatation on image in gdal ?
> 
> I've looked in alg.h, but I've seen no straight way to do such thing.

Johan,

I am not aware of anything intended specifically for this.  There is the
raster fill algorithm which can "grow" an image by a specific amount.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jluis at ualg.pt  Tue Feb  3 10:48:12 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Tue Feb  3 10:48:18 2009
Subject: [gdal-dev] erosion/dilation in gdal ?
In-Reply-To: <498863E2.1020309@pobox.com>
References: <498815AD.8020206@archivideo.com> <498863E2.1020309@pobox.com>
Message-ID: <4988673C.8010604@ualg.pt>

Frank Warmerdam wrote:
> Johan Nouvel wrote:
>> Hello all,
>>
>> Is there a way to do erosion/dilatation on image in gdal ?
>>
>> I've looked in alg.h, but I've seen no straight way to do such thing.

Johan,

As you very probably know those are operations of the image processing world.
If you don't know it yet have a look at the OpenCV library. It is amazingly
fast, but doesn't know anything about coordinates.

Joaquim Luis
From vjetly at i3.com  Tue Feb  3 12:41:19 2009
From: vjetly at i3.com (Vikalpa Jetly)
Date: Tue Feb  3 12:45:45 2009
Subject: [gdal-dev] erosion/dilation in gdal 
In-Reply-To: <20090203170020.B46A9E012BC@lists.osgeo.org>
References: <20090203170020.B46A9E012BC@lists.osgeo.org>
Message-ID: <001101c98626$9f5ef710$de1ce530$@com>


> Johan Nouvel wrote:
> Hello all,
>
> Is there a way to do erosion/dilatation on image in gdal ?
>
> I've looked in alg.h, but I've seen no straight way to do such thing.


Johan,
On the Python side there is the ndimage package that is included in scipy
(http://www.scipy.org/SciPyPackages/Ndimage) that has erosion and dilation
functions that you might want to consider. Take a look at binary and grey
scale morphology here:

http://stsdas.stsci.edu/numarray/numarray-1.5.html/module-numarray.ndimage.h
tml

If they do what you need, then you can read an image into a numpy array
using gdal,perform erosion/dilation, write a new image out with the result
and rewrite extent and projection to the image.

Vikalpa








From blake at hailmail.net  Tue Feb  3 17:19:46 2009
From: blake at hailmail.net (Dane Springmeyer)
Date: Tue Feb  3 17:26:04 2009
Subject: [gdal-dev] Re: Creating a blank raster from scratch
In-Reply-To: <4988302D.8080103@gmail.com>
References: <49872AF6.2050908@gmail.com> <49882D01.4020307@gmail.com>
	<4988302D.8080103@gmail.com>
Message-ID: <61B6F92B-2239-4EC3-91C4-95DCD3E17C72@hailmail.net>

Jorge,

I think I was the original poster of the trac snippet, which worked  
for me on mac os.

Great job researching, and yes, please update the snippet as needed.

Thanks!

Dane


On Feb 3, 2009, at 3:53 AM, Jorge wrote:

> And finally, hello
>
> Sorry for being annoying. I've found this ticket closed 2 years ago http://trac.osgeo.org/gdal/ticket/1166 
> .
>
> I'll apply the patch, but I think that this should be added with the  
> FAQ. Saves time :-)
>
> Best regards
> Jorge
>
> Jorge escribi?:
>>
>> Hello again,
>>
>> I' ve found the problem, I think. Is the version of numpy used by
>> gdalnumeric. The code from FAQ works with numpy version 1.0.1, but  
>> fails
>> with numpy version 1.2.1. The fail is because the narray attribute
>> "typecode()" doesn't exist. From the numpy book, available at
>> http://numpy.scipy.org/numpybook.pdf, you can get (page 55):
>>
>> "If you are converting code from Numeric, then you
>> will need to make the following (search and replace)
>> conversions: .typecode() --> .dtype.char;
>> .iscontiguous() --> .flags.contiguous;
>> .byteswapped() --> .byteswap(); .toscalar()
>> --> .item(); and .itemsize() --> .itemsize. The
>> numpy.oldnumeric.alter code1 module can automate this for you."
>>
>> Ok. I've opened gdalnumeric.py, and the last change was from  
>> 2006/03/21.
>> The older version from numpy available at sourceforge download's  
>> page is
>> from 2007-11-08. Then, gdal is using a really old version of numpy.
>> Maybe I can use the numpy 1.0.1 from my mac, but I think that it  
>> would
>> be easier to replace the snippet's code lines that uses numpy from  
>> the
>> correct ones. What's the best way to do this
>>
>>         # Create blank raster with fully opaque alpha band
>>         zeros = numpy.zeros( (tiff_height, tiff_width), numpy.uint8 )
>>         dst_ds.GetRasterBand(1).WriteArray( zeros )
>>         dst_ds.GetRasterBand(2).WriteArray( zeros )
>>         dst_ds.GetRasterBand(3).WriteArray( zeros )
>>         opaque = numpy.zeros((tiff_height,tiff_width),  
>> numpy.uint8 )*255
>>         dst_ds.GetRasterBand(4).WriteArray( opaque )
>>
>> by using gdal? Because, if I'm right, this snippet from the FAQ is
>> deprecated.
>>
>> Regards
>> Jorge
>>
>> Jorge escribi?:
>>
>>> Hello everybody
>>>
>>> I'm creating a blank raster from scratch, to rasterize it later. Ok,
>>> I've read the FAQ:
>>>
>>> http://trac.osgeo.org/gdal/wiki/FAQRaster#HowcanIcreateablankrasterbasedonavectorfilesextentsforusewithgdal_rasterize
>>>
>>> I've executed this code with no problems in a Mac, with Leopard.  
>>> I've
>>> used the frameworks at http://www.kyngchaos.com/ 
>>> software:frameworks. The
>>> version of GDAL is 1.6.0, and the numpy version is 1.0.1 Now, I  
>>> try to
>>> execute the code in another machine, a PC with Suse Linux  
>>> Enterpise 11.0
>>> for 64bits processors. I've installed gdal and numpy from  
>>> repositories.
>>> The version of GDAL is 1.6.0, and numpy version is 1.2.1  So, the  
>>> gdal
>>> versions are the same. But if I open, for example, the file ogr.py  
>>> in
>>> both systems, are different files. Maybe the Framework I'm using  
>>> is a
>>> port of GDAL 1.6.0 to Mac with any changes?
>>>
>>> And another issue: the code fails in the PC with Suse. The first  
>>> error is:
>>>
>>> src_lyr = src_ds.GetLayerByIndex( index = 0 )
>>> AttributeError: DataSource instance has no attribute  
>>> 'GetLayerByIndex'
>>>
>>> I could solve the problem by changing the call to "GetLayerByIndex(
>>> index = 0 )" for "GetLayer( 0 )". Why is this happening, if the  
>>> version
>>> of GDAL is 1.6.0 on both systems? Again, I think that maybe the
>>> Framework I'm using is a port of GDAL 1.6.0 to Mac with any changes.
>>>
>>> Then, made this change, I get another error, that I couldn't solve  
>>> yet
>>> (create_raster.py is the name of my file):
>>>
>>>  File "./create_raster.py", line 112, in ?
>>>     dst_ds.GetRasterBand(1).WriteArray( zeros )
>>>   File "/usr/lib64/python2.4/site-packages/gdal.py", line 876, in  
>>> WriteArray
>>>     return gdalnumeric.BandWriteArray( self, array, xoff, yoff )
>>>   File "/usr/lib64/python2.4/site-packages/gdalnumeric.py", line  
>>> 193, in
>>> BandWriteArray
>>>     datatype = NumericTypeCodeToGDALTypeCode( array.typecode() )
>>> AttributeError: 'numpy.ndarray' object has no attribute 'typecode'
>>>
>>> So, basically, the method "BandWriteArray" of gdalnumeric.py is
>>> expecting an object array, with a method named "typecode()", but the
>>> array created with numpy.zeros, don't have this attribute. Am I  
>>> right?
>>> Then, the fact is that in version 1.0.1 of numpy, the array  
>>> created with
>>> numpy.zeros has a method named "typecode()", but in version 1.2.1,  
>>> this
>>> attribute doesn't exist. Do I have to "downgrade" the numpy  
>>> version from
>>> 1.2.1 to 1.0.1 to make the code works in suse? Is there another
>>> solution? Sorry for this kind of questions, but I'm very newbie  
>>> with Python
>>>
>>> Thanks in advance!
>>>
>>> Regards
>>> Jorge
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>
>
> -- 
> "Afirmo con total convicci?n que la religi?n cristiana organizada  
> como Iglesia ha sido y es a?n la principal enemiga del progreso  
> moral en el mundo"
>
> "La religi?n se basa, pienso, principal y primariamente en el miedo.  
> El miedo es el padre de la crueldad, y por tanto no es sorprendente  
> que crueldad y religi?n han ido tomadas de la mano. La ciencia puede  
> ayudarnos a superar este cobarde temor en que ha vivido la humanidad  
> por tantas generaciones."
>
> (Bertrand Russell)
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090203/fb23ab77/attachment.html
From craig.leat at gmail.com  Wed Feb  4 13:19:07 2009
From: craig.leat at gmail.com (Craig Leat)
Date: Wed Feb  4 13:19:10 2009
Subject: [gdal-dev] Transformation from WGS84 to Cape Datum
Message-ID: <1fef7d9b0902041019t257669f7g4acba3505d7dc91c@mail.gmail.com>

Wesley Roberts:
> I would like to perform a datum transformation from WGS84 to the Cape Datum
> using the clark 1880 spheroid. Is this possible using ogr? I have tried using
> ogr2ogr but have had no luck as I am not sure how to specify the correct
> projection parameters and am not sure if ogr supports the Cape Datum and
> clark 1880 spheroid.

See here:
http://article.gmane.org/gmane.comp.gis.proj-4.devel/2188/

Craig
From Shawn.Gong at drdc-rddc.gc.ca  Thu Feb  5 15:31:05 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Feb  5 15:31:09 2009
Subject: [gdal-dev] gdal function to tell if UTM or lat/lon
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E742@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,

I know that in Python ds.GetProjection() ds.GetGCPProjection() will
yield "GEOGCS[,DATUM[,SPHEROID[ ..." which can be searched for
"Transverse_Mercator" or "degree" strings.

Is there a more direct way in gdalinfo or Python function to tell if an
image is in UTM or lat/lon right away?

thanks,
Shawn



-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090205/33e8582d/attachment.html
From warmerdam at pobox.com  Thu Feb  5 15:49:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb  5 15:49:50 2009
Subject: [gdal-dev] gdal function to tell if UTM or lat/lon
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E742@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E742@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <498B50D7.2030000@pobox.com>

Gong, Shawn (Contractor) wrote:
> hi list,
> 
> I know that in Python ds.GetProjection() ds.GetGCPProjection() will 
> yield ?GEOGCS[,DATUM[,SPHEROID[ ?? which can be searched for 
> ?Transverse_Mercator? or ?degree? strings.
> 
> Is there a more direct way in gdalinfo or Python function to tell if an 
> image is in UTM or lat/lon right away?

Shawn,

The projections tutorial provides some clues on such things.

   http://www.gdal.org/ogr/osr_tutorial.html

The "normal" approach would be to turn the WKT from GetProjection() into
an OGRSpatialReference (osr.SpatialReference in Python) object and then
query it for information such as the PROJECTION attribute or call
IsProjected(), IsGeographic(), etc.

Note that some Transverse Mercator projections are UTM, but not all.
The GetUTMZone() method can be used to check if it is specifically UTM
and for what zone:

http://www.gdal.org/ogr/classOGRSpatialReference.html#4b17d85f5db53978c749780b214c4237

Also, seaching for degree isn't very meaningful since even projected
coordinate systems have an underlying geographic coordinate system which
will be using the unit degree.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Shawn.Gong at drdc-rddc.gc.ca  Thu Feb  5 15:55:06 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Thu Feb  5 15:55:09 2009
Subject: [gdal-dev] gdal function to tell if UTM or lat/lon
In-Reply-To: <498B50D7.2030000@pobox.com>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E742@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<498B50D7.2030000@pobox.com>
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E743@ottawaex02.Ottawa.drdc-rddc.gc.ca>

thanks Frank.

GetUTMZone() method is a C function. Is there a Python function?


Shawn


-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org
[mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Frank Warmerdam
Sent: Thursday, February 05, 2009 3:49 PM
To: Gong, Shawn (Contractor)
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [gdal-dev] gdal function to tell if UTM or lat/lon

Gong, Shawn (Contractor) wrote:
> hi list,
> 
> I know that in Python ds.GetProjection() ds.GetGCPProjection() will 
> yield "GEOGCS[,DATUM[,SPHEROID[ ..." which can be searched for 
> "Transverse_Mercator" or "degree" strings.
> 
> Is there a more direct way in gdalinfo or Python function to tell if
an 
> image is in UTM or lat/lon right away?

Shawn,

The projections tutorial provides some clues on such things.

   http://www.gdal.org/ogr/osr_tutorial.html

The "normal" approach would be to turn the WKT from GetProjection() into
an OGRSpatialReference (osr.SpatialReference in Python) object and then
query it for information such as the PROJECTION attribute or call
IsProjected(), IsGeographic(), etc.

Note that some Transverse Mercator projections are UTM, but not all.
The GetUTMZone() method can be used to check if it is specifically UTM
and for what zone:

http://www.gdal.org/ogr/classOGRSpatialReference.html#4b17d85f5db53978c7
49780b214c4237

Also, seaching for degree isn't very meaningful since even projected
coordinate systems have an underlying geographic coordinate system which
will be using the unit degree.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
From oliver.eichler at gmx.de  Thu Feb  5 16:00:20 2009
From: oliver.eichler at gmx.de (Oliver Eichler)
Date: Thu Feb  5 16:02:52 2009
Subject: [gdal-dev] RasterIO vs progress bar
Message-ID: <200902052200.20259.oliver.eichler@gmx.de>

Hi,

Is there a way to get a progress when using RasterIO? Guess not ;) But it 
would be quite nice to have. Usually RatserIO is really fast, so you don't 
need it, but if you play with WMS access a feedback would be _really_ nice.

I know API changes suck. But is there any chance in future to pass a callback 
function pointer and a void pointer to RasterIO. The callback function will 
receive the progress and the void pointer. That should make C and C++ lads 
happy. A way to abort transaction would be nice, too.

I would really like to press on this topic, because I thing RasterIO is pretty 
neat and fast. I can get WMS access with just a few lines and it's quite the 
same as handling a file. I really appreciate that, however  without visual 
feedback on the download progress the normal user will get frustrated. And 
that would force me to re-implement all the magic. 

How is the chance to get this into GDAL?

Oliver
From neteler at osgeo.org  Thu Feb  5 16:18:16 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Thu Feb  5 16:18:18 2009
Subject: [gdal-dev] gdal 1.6 doesn't recognize his own projection definition
	(LL -> LAEA)
Message-ID: <86782b610902051318w11397615l93442e9ced2f2f60@mail.gmail.com>

Hi,

I have taken a couple of CGIAR SRTM Geotiffs (LatLong, unfortunately
they missed to insert that into the metadata in V4) and gdalwarp'ed them
to the EU LAEA projection on the fly. The definition originates from
the CORINE landcover mapset available at the European Environmental
Agency, .prj file is attached:

gdalwarp -s_srs epsg:4326 -t_srs /geo/laea_etrs89.prj
/geo/cgiar_LL/srtm_41_0[1-3].tif srtmV4_cgiar_laea.tif
Creating output file that is 8277P x 22800L.

But recognition then fails:

gdalinfo europe_all_srtmV4_cgiar_250m_LAEA_EU.tif
Driver: GTiff/GeoTIFF
Files: europe_all_srtmV4_cgiar_250m_LAEA_EU.tif
Size is 24213, 17341
Coordinate System is:
PROJCS["ETRS_1989_LAEA_L52_M10",
    GEOGCS["GCS_ETRS_1989",
        DATUM["unknown",
            SPHEROID["unnamed",6378137,298.2572221010002]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
    PARAMETER["latitude_of_center",0],
    PARAMETER["longitude_of_center",0],
    PARAMETER["false_easting",4321000],
    PARAMETER["false_northing",3210000],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (1772847.359583478420973,4574867.517244365997612)
Pixel Size = (250.000000000000000,-250.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 1772847.360, 4574867.517) ( 23d26'46.28"W, 12d 6'34.61"N)
Lower Left  ( 1772847.360,  239617.517) ( 25d 6'35.90"W, 26d28'25.00"S)
Upper Right ( 7826097.360, 4574867.517) ( 32d26'40.92"E, 11d52'36.96"N)
Lower Right ( 7826097.360,  239617.517) ( 34d42'27.86"E, 25d54'34.36"S)
Center      ( 4799472.360, 2407242.517) (  4d19'30.13"E,  7d15'33.16"S)
Band 1 Block=24213x1 Type=Int16, ColorInterp=Gray
  Overviews: 12107x8671, 6054x4336, 3027x2168, 1514x1084, 757x542

Apparently the datum isn't properly morphed? I was using 1.6-branch to generate
the map and used both 1.6-branch and SVN trunk to read it, no way.

Bug or feature?

Ah, generating it in SVN trunk and reading it in SVN trunk appears to work:
...
Coordinate System is:
PROJCS["ETRS_1989_LAEA_L52_M10",
    GEOGCS["GCS_ETRS_1989",
        DATUM["D_ETRS_1989",
            SPHEROID["GRS_1980",6378137,298.257222101]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Lambert_Azimuthal_Equal_Area"],
...

Since I prefer to use for the production machine the 1.6-branch version,
could the relevant fix be backported?

thanks,
Markus
-------------- next part --------------
A non-text attachment was scrubbed...
Name: laea_etrs89.prj
Type: application/octet-stream
Size: 388 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090205/441be19c/laea_etrs89.obj
From neteler at osgeo.org  Thu Feb  5 16:23:33 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Thu Feb  5 16:23:40 2009
Subject: [gdal-dev] Re: gdal 1.6 doesn't recognize his own projection
	definition (LL -> LAEA)
In-Reply-To: <86782b610902051318w11397615l93442e9ced2f2f60@mail.gmail.com>
References: <86782b610902051318w11397615l93442e9ced2f2f60@mail.gmail.com>
Message-ID: <86782b610902051323k3863cbdeu84403d503355d18f@mail.gmail.com>

On Thu, Feb 5, 2009 at 10:18 PM, Markus Neteler <neteler@osgeo.org> wrote:
...
> Since I prefer to use for the production machine the 1.6-branch version,
> could the relevant fix be backported?

Ah, I probably found a difference:

trunk-svn:
[neteler@eden gdal]$ grep -i GCS_ETRS_1989 */*
ogr/ogr_srs_esri_names.h:"EUREF_FIN_TM35FIN", "GCS_ETRS_1989", "GCS_EUREF_FIN",

1.6-svn:
[neteler@geodata gdal_16svn]$ grep -i GCS_ETRS_1989 */*
[neteler@geodata gdal_16svn]$
-> nothing like that

Hopefully the missing pieces can be sync'ed over to 1.6-svn.

thanks,
Markus
From warmerdam at pobox.com  Thu Feb  5 16:44:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb  5 16:45:19 2009
Subject: [gdal-dev] gdal function to tell if UTM or lat/lon
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E743@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E742@ottawaex02.Ottawa.drdc-rddc.gc.ca>
	<498B50D7.2030000@pobox.com>
	<DF1471B5C308B346BF5A2AEA00C5615E26E743@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <498B5DDA.6010902@pobox.com>

Gong, Shawn (Contractor) wrote:
> thanks Frank.
> 
> GetUTMZone() method is a C function. Is there a Python function?

Shawn,

I have skimmed osr.py and this does not appear to be exposed in Python
or other swig languages.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Feb  5 19:26:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb  5 19:27:14 2009
Subject: [gdal-dev] RasterIO vs progress bar
In-Reply-To: <200902052200.20259.oliver.eichler@gmx.de>
References: <200902052200.20259.oliver.eichler@gmx.de>
Message-ID: <498B83D2.3020706@pobox.com>

Oliver Eichler wrote:
> Hi,
> 
> Is there a way to get a progress when using RasterIO? Guess not ;) But it 
> would be quite nice to have. Usually RatserIO is really fast, so you don't 
> need it, but if you play with WMS access a feedback would be _really_ nice.
> 
> I know API changes suck. But is there any chance in future to pass a callback 
> function pointer and a void pointer to RasterIO. The callback function will 
> receive the progress and the void pointer. That should make C and C++ lads 
> happy. A way to abort transaction would be nice, too.
> 
> I would really like to press on this topic, because I thing RasterIO is pretty 
> neat and fast. I can get WMS access with just a few lines and it's quite the 
> same as handling a file. I really appreciate that, however  without visual 
> feedback on the download progress the normal user will get frustrated. And 
> that would force me to re-implement all the magic. 
> 
> How is the chance to get this into GDAL?

Oliver,

I'm generally not too keen on this due to the disruption and the complexity
of doing a decent job of progress reporting through the RasterIO process.

For the case of WMS it might make sense to just make modest sized requests
so the user sees progress after each chunk is completed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Feb  5 19:32:15 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb  5 19:32:30 2009
Subject: [gdal-dev] Re: gdal 1.6 doesn't recognize his own projection
	definition (LL -> LAEA)
In-Reply-To: <86782b610902051323k3863cbdeu84403d503355d18f@mail.gmail.com>
References: <86782b610902051318w11397615l93442e9ced2f2f60@mail.gmail.com>
	<86782b610902051323k3863cbdeu84403d503355d18f@mail.gmail.com>
Message-ID: <498B850F.2050300@pobox.com>

Markus Neteler wrote:
> On Thu, Feb 5, 2009 at 10:18 PM, Markus Neteler <neteler@osgeo.org> wrote:
> ...
>> Since I prefer to use for the production machine the 1.6-branch version,
>> could the relevant fix be backported?
> 
> Ah, I probably found a difference:
> 
> trunk-svn:
> [neteler@eden gdal]$ grep -i GCS_ETRS_1989 */*
> ogr/ogr_srs_esri_names.h:"EUREF_FIN_TM35FIN", "GCS_ETRS_1989", "GCS_EUREF_FIN",
> 
> 1.6-svn:
> [neteler@geodata gdal_16svn]$ grep -i GCS_ETRS_1989 */*
> [neteler@geodata gdal_16svn]$
> -> nothing like that
> 
> Hopefully the missing pieces can be sync'ed over to 1.6-svn.

Markus,

There has been a massive set of changes applied to ESRI morphing and to
some extent to a variety of drivers in an attempt to better preserve
coordinate systems through various drivers.  It is being handled via this
ticket:

   http://trac.osgeo.org/gdal/ticket/2752

I'm not prepared to backport to 1.6 as there are several outstanding issues
related to the changes made.  I'm also a bit uncertain whether it makes sense
to move such broad changes into the 1.6 branch.

In brief, I'm not sure when or if these changes will go into 1.6 branch.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From gdal at archivideo.com  Fri Feb  6 03:09:11 2009
From: gdal at archivideo.com (Johan Nouvel)
Date: Fri Feb  6 03:09:21 2009
Subject: [gdal-dev] erosion/dilation in gdal ?
In-Reply-To: <4988673C.8010604@ualg.pt>
References: <498815AD.8020206@archivideo.com> <498863E2.1020309@pobox.com>
	<4988673C.8010604@ualg.pt>
Message-ID: <498BF027.9070800@archivideo.com>

Thanks to all for these advices.

We already use magick++ and opencv, I will look in these librairies.

Regards,
Johan.

-- 
Johan Nouvel, R&D Engineer
http://www.archivideo.com
tel : +33 (0)2 99 86 30 20
ARCHIVIDEO, 40 rue des Veyettes, 35000 RENNES, FRANCE
From szekerest at gmail.com  Fri Feb  6 09:25:18 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri Feb  6 09:25:20 2009
Subject: [gdal-dev] RasterIO vs progress bar
In-Reply-To: <200902052200.20259.oliver.eichler@gmx.de>
References: <200902052200.20259.oliver.eichler@gmx.de>
Message-ID: <f3b73b7d0902060625i66119fbdwd1852753a2a1a28@mail.gmail.com>

Oliver,

There have been an effort to provide such kind of options in GDAL RFC 24 (
http://trac.osgeo.org/gdal/wiki/rfc24_progressive_data_support)
for the drivers involved in slow IO operations an possibly in use of
multiple threads in this regards.
I guess it might be a bit unrelated to this issue but just in case.


Best regards,

Tamas



2009/2/5 Oliver Eichler <oliver.eichler@gmx.de>

> Hi,
>
> Is there a way to get a progress when using RasterIO? Guess not ;) But it
> would be quite nice to have. Usually RatserIO is really fast, so you don't
> need it, but if you play with WMS access a feedback would be _really_ nice.
>
> I know API changes suck. But is there any chance in future to pass a
> callback
> function pointer and a void pointer to RasterIO. The callback function will
> receive the progress and the void pointer. That should make C and C++ lads
> happy. A way to abort transaction would be nice, too.
>
> I would really like to press on this topic, because I thing RasterIO is
> pretty
> neat and fast. I can get WMS access with just a few lines and it's quite
> the
> same as handling a file. I really appreciate that, however  without visual
> feedback on the download progress the normal user will get frustrated. And
> that would force me to re-implement all the magic.
>
> How is the chance to get this into GDAL?
>
> Oliver
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090206/22d30d4d/attachment.html
From neteler at osgeo.org  Fri Feb  6 17:19:20 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Fri Feb  6 17:19:22 2009
Subject: [gdal-dev] Re: gdal 1.6 doesn't recognize his own projection 
	definition (LL -> LAEA)
In-Reply-To: <498B850F.2050300@pobox.com>
References: <86782b610902051318w11397615l93442e9ced2f2f60@mail.gmail.com>
	<86782b610902051323k3863cbdeu84403d503355d18f@mail.gmail.com>
	<498B850F.2050300@pobox.com>
Message-ID: <86782b610902061419q7b351c60jd170cde9e4cb0543@mail.gmail.com>

Frank,

On Fri, Feb 6, 2009 at 1:32 AM, Frank Warmerdam <warmerdam@pobox.com> wrote:
> Markus Neteler wrote:
>> On Thu, Feb 5, 2009 at 10:18 PM, Markus Neteler <neteler@osgeo.org> wrote:
...
>> Hopefully the missing pieces can be sync'ed over to 1.6-svn.
>
> Markus,
>
> There has been a massive set of changes applied to ESRI morphing and to
> some extent to a variety of drivers in an attempt to better preserve
> coordinate systems through various drivers.  It is being handled via this
> ticket:
>
>  http://trac.osgeo.org/gdal/ticket/2752
>
> I'm not prepared to backport to 1.6 as there are several outstanding issues
> related to the changes made.  I'm also a bit uncertain whether it makes
> sense to move such broad changes into the 1.6 branch.
>
> In brief, I'm not sure when or if these changes will go into 1.6 branch.

I see.

A question: are just the metadata incomplete in the file I created
or is also the reprojection incorrect? Say, can I happily assign -a_srs
the correct projection definition or should I moreover reproject
again using trunk?

Thanks
Markus

PS: Some/all CGIAR SRTM Geotiffs have been updated on the server
      some months ago (I downloaded V4 before that) and now they
      contain the projection info.
From randre at gmail.com  Sat Feb  7 14:33:50 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Sat Feb  7 14:33:53 2009
Subject: [gdal-dev] Trying to clean up multiple GDAL installs
Message-ID: <9c2015090902071133w6282c10bo771e164734a77b1@mail.gmail.com>

Ok, I admit it.  I was lured by the promise of what I didn't already have.
I had a perfectly functional gdal install from source on my Ubuntu box.
Then I went and installed Qgis using apt-get, which brought in a gdal
package as well, and started to get errors like the one below.

ogrinfo: symbol lookup error: ogrinfo: undefined symbol:
_ZN10OGRFeature12DumpReadableEP8_IO_FILE

I decided I'd rather have ogrinfo than Qgis, so I removed Qgis using
"apt-get autoremove qgis".  This said that it removed some gdal stuff, but
afterwards I still had the ogrinfo error.  I then went into my
"/usr/local/gdal-1.5.2/" and did a "make clean".  I also deleted all "ogr"
and "gdal" apps that were left in "/usr/local/bin".  I then built gdal from
source again in the "/usr/local/gdal-1.5.2/" dir.  However, when I do a
"ogrinfo --version" it tells me I'm using "GDAL 1.6.0" - and I still have
the ogrinfo error.

I've checked my "gdal-config" file and it says CONFIG_VERSION="1.5.2", which
is correct.  So now I'm kinda scratching my head wondering what to delete
next.

Any hints, please?

Thanks,

Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090207/1cec7afc/attachment.html
From j.l.h.hartmann at uva.nl  Sat Feb  7 15:10:36 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Sat Feb  7 15:10:50 2009
Subject: [Fwd: Re: [gdal-dev] Warping an already georeferenced image with
	control points
Message-ID: <498DEABC.2000705@uva.nl>

No, this doesn't seem to work. Although the coordinate system *is* 
retained when I add -a_srs to the gcps, the boundaries of the input file 
are discarded: they are reset to the pixel dimensions of the file. Is 
this a bug?

Jan

Frank Warmerdam wrote:
> Jan Hartmann wrote:
>> Hi,
>>
>> I am trying to georeference old maps in two steps: first 
>> georeferencing them from the old projection to a modern one, and then 
>> ameliorating the georeferenced image by rubber-sheeting it on the 
>> base of control points, mostly triangulation points for which the 
>> coordinates in the old and new maps are known.
>>
>> The second step causes trouble: if I add  control points to the 
>> georeferenced image with gdal_translate -gcp , the projection 
>> information gets lost.
>>
>> Yet, AFAICS it should be possible: if I use gdaltransform -s_srs 
>> EPSG:28992 -t_srs EPSG:28992 -gcp ... , I can use control points with 
>> coordinates in EPSG:28992 and get a correct transformation.
>>
>> So: regarding this behavior  of gdal_translate, to discard projection 
>> information when control points are added: is it a bug or is it the 
>> expected behavior? In the last case, how can I rubber-sheet an 
>> already georeferenced map?
>
> Jan,
>
> If you use the -a_srs switch of gdal_translate in combination with the
> -gcp switch to add gcps, the GCPs should be recorded as being in the
> coordinate system described by -a_srs.  Because there is no reason to
> believe that the current image coordinate system is related to the
> coordinate system of the GCPs, no effort is made to use the existing 
> image
> coordinate system as the default GCP coordinate system.
>
> By the way, setting GCPs with a GCP coordinate system on an image is 
> likely
> to not work with most GDAL supported formats, and the coordinate system
> related aspect may also be supported in a variable fashion depending 
> on the
> format driver's implementation.
>
> Hopefully things work well with the GeoTIFF format, which I assume you 
> have
> been using.
>
> Best regards,


From even.rouault at mines-paris.org  Sat Feb  7 16:42:53 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Feb  7 16:43:06 2009
Subject: [gdal-dev] Trying to clean up multiple GDAL installs
In-Reply-To: <9c2015090902071133w6282c10bo771e164734a77b1@mail.gmail.com>
References: <9c2015090902071133w6282c10bo771e164734a77b1@mail.gmail.com>
Message-ID: <200902072242.55090.even.rouault@mines-paris.org>

I guess that the GDAL version that QGIS has brought in is located in /usr/bin 
for the binaries and in /usr/lib for the library.
You should probably begin by : apt-get remove libgdal* gdal-bin*
And check that there's no /usr/bin/gdal* or /usr/lib/libgdal*

Le Saturday 07 February 2009 20:33:50 Roger Andr?, vous avez ?crit?:
> Ok, I admit it.  I was lured by the promise of what I didn't already have.
> I had a perfectly functional gdal install from source on my Ubuntu box.
> Then I went and installed Qgis using apt-get, which brought in a gdal
> package as well, and started to get errors like the one below.
>
> ogrinfo: symbol lookup error: ogrinfo: undefined symbol:
> _ZN10OGRFeature12DumpReadableEP8_IO_FILE
>
> I decided I'd rather have ogrinfo than Qgis, so I removed Qgis using
> "apt-get autoremove qgis".  This said that it removed some gdal stuff, but
> afterwards I still had the ogrinfo error.  I then went into my
> "/usr/local/gdal-1.5.2/" and did a "make clean".  I also deleted all "ogr"
> and "gdal" apps that were left in "/usr/local/bin".  I then built gdal from
> source again in the "/usr/local/gdal-1.5.2/" dir.  However, when I do a
> "ogrinfo --version" it tells me I'm using "GDAL 1.6.0" - and I still have
> the ogrinfo error.
>
> I've checked my "gdal-config" file and it says CONFIG_VERSION="1.5.2",
> which is correct.  So now I'm kinda scratching my head wondering what to
> delete next.
>
> Any hints, please?
>
> Thanks,
>
> Roger


From jukka.rahkonen at mmmtike.fi  Sun Feb  8 11:41:59 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Sun Feb  8 11:42:15 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with	control points
References: <498DEABC.2000705@uva.nl>
Message-ID: <loom.20090208T163124-633@post.gmane.org>

Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:

> 
> No, this doesn't seem to work. Although the coordinate system *is* 
> retained when I add -a_srs to the gcps, the boundaries of the input file 
> are discarded: they are reset to the pixel dimensions of the file. Is 
> this a bug?
> 
> Jan
> 
> Frank Warmerdam wrote:
> > Jan Hartmann wrote:
> >> Hi,
> >>
> >> I am trying to georeference old maps in two steps: first 
> >> georeferencing them from the old projection to a modern one, and then 
> >> ameliorating the georeferenced image by rubber-sheeting it on the 
> >> base of control points, mostly triangulation points for which the 
> >> coordinates in the old and new maps are known.
> >>
> >> The second step causes trouble: if I add  control points to the 
> >> georeferenced image with gdal_translate -gcp , the projection 
> >> information gets lost.

Hi,

I am not sure if I understood how you trying to do the job, but hopefully my
task and work flow are close enough to be useful for you.

1. Let's say that the original image is in epsg:2393 and target is epsg:3067.
2. I insert some ground control points in epsg:3067 with gdal_translate and
-gcp.  Image format of the temporal output file can be GeoTIFF but also virtual
raster(vrt).
3. I warp the temporary image, now containing gpc's in epsg:3067 projection, to
final product using gdalwarp as
gdalwarp -s_srs epsg:3067 -t_srs epsg:3067.

-Jukka Rahkonen-

From jumpjack at libero.it  Sun Feb  8 15:43:06 2009
From: jumpjack at libero.it (jumpjack)
Date: Sun Feb  8 15:46:28 2009
Subject: [gdal-dev] gdalwarp: mercator to lambert azimutal equeal area
In-Reply-To: <497CD88F.7080904@ualg.pt>
References: <497CD88F.7080904@ualg.pt>
Message-ID: <200902082143060977.02021B6F@mail.libero.it>

Waht's wrong with this command?
gdalwarp -s_srs  "+proj=merc" -t_srs "+proj=laea" griglia.jpg  dest.jpg

Result:

ERROR 1: Unable to compute a transformation between pixel/line
and georeferenced coordinates for griglia.jpg.
There is no affine transformation and no GCPs.

How do I convert a mercator map to a Lambert Azimuthal Equal Area map?
How do I specifiy map edges?



From j.l.h.hartmann at uva.nl  Mon Feb  9 05:15:22 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Mon Feb  9 05:15:51 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with	control points
In-Reply-To: <loom.20090208T163124-633@post.gmane.org>
References: <498DEABC.2000705@uva.nl> <loom.20090208T163124-633@post.gmane.org>
Message-ID: <4990023A.2090204@uva.nl>



Jukka Rahkonen wrote:
> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>
>   
>> No, this doesn't seem to work. Although the coordinate system *is* 
>> retained when I add -a_srs to the gcps, the boundaries of the input file 
>> are discarded: they are reset to the pixel dimensions of the file. Is 
>> this a bug?
>>
>> Jan
>>
>> Frank Warmerdam wrote:
>>     
>>> Jan Hartmann wrote:
>>>       
>>>> Hi,
>>>>
>>>> I am trying to georeference old maps in two steps: first 
>>>> georeferencing them from the old projection to a modern one, and then 
>>>> ameliorating the georeferenced image by rubber-sheeting it on the 
>>>> base of control points, mostly triangulation points for which the 
>>>> coordinates in the old and new maps are known.
>>>>
>>>> The second step causes trouble: if I add  control points to the 
>>>> georeferenced image with gdal_translate -gcp , the projection 
>>>> information gets lost.
>>>>         
>
> Hi,
>
> I am not sure if I understood how you trying to do the job, but hopefully my
> task and work flow are close enough to be useful for you.
>
> 1. Let's say that the original image is in epsg:2393 and target is epsg:3067.
> 2. I insert some ground control points in epsg:3067 with gdal_translate and
> -gcp.  Image format of the temporal output file can be GeoTIFF but also virtual
> raster(vrt).
> 3. I warp the temporary image, now containing gpc's in epsg:3067 projection, to
> final product using gdalwarp as
> gdalwarp -s_srs epsg:3067 -t_srs epsg:3067.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>   
Hi Jukka,

You have described exactly what I want to do, but the problem is that in 
step 2, inserting gcps, the georeferenced boundaries of the file are 
lost. Eventually you get a somewhat displaced raw raster file.

Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090209/86883d33/attachment.html
From Jukka.Rahkonen at mmmtike.fi  Mon Feb  9 05:29:43 2009
From: Jukka.Rahkonen at mmmtike.fi (Rahkonen Jukka)
Date: Mon Feb  9 05:43:05 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with	control points
In-Reply-To: <4990023A.2090204@uva.nl>
Message-ID: <CC197224AC75CE4DB23F739B16891B86F7324A@tikka.haapa.mmm.fi>

Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
 
Jukka Rahkonen wrote:
 
>> Hi,
>> 
>> I am not sure if I understood how you trying to do the job, but
hopefully my
>> task and work flow are close enough to be useful for you.
>> 
>> 1. Let's say that the original image is in epsg:2393 and target is
epsg:3067.
>> 2. I insert some ground control points in epsg:3067 with
gdal_translate and
>> -gcp.  Image format of the temporal output file can be GeoTIFF but
also virtual
>> raster(vrt).
>> 3. I warp the temporary image, now containing gpc's in epsg:3067
projection, to
>> final product using gdalwarp as
>> gdalwarp -s_srs epsg:3067 -t_srs epsg:3067.
> 
> 
>> Hi Jukka,
>> You have described exactly what I want to do, but the problem is that
>> in step 2, inserting gcps, the georeferenced boundaries of the file
are
>> lost. Eventually you get a somewhat displaced raw raster file.
>> Jan 
 
Hi,
 
That displacement could be avoided at least by inserting manually gcp to
each
corner of the image. Perhaps this article gives some ideas:
http://www.scangis.org/scangis2007/papers/r3_rahkonen.pdf
 
-Jukka-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090209/aee71031/attachment.html
From j.l.h.hartmann at uva.nl  Mon Feb  9 06:15:01 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Mon Feb  9 06:15:13 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with	control points
In-Reply-To: <CC197224AC75CE4DB23F739B16891B86F7324A@tikka.haapa.mmm.fi>
References: <CC197224AC75CE4DB23F739B16891B86F7324A@tikka.haapa.mmm.fi>
Message-ID: <49901035.6050201@uva.nl>

Thanks Jukka, that is an interesting article in its own right, and it is 
relevant to historical maps too. Your solution is viable, but it takes 
more work (insert corner gcp in each image), which shouldn't be 
necessary, as this information is already available but is discarded by 
gdal_translate. If gdal_translate could keep this information in the 
target file, even when gcps have been added, everything would be fine 
(and my impression is it should).

Jan

Rahkonen Jukka wrote:
> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>  
> Jukka Rahkonen wrote:
>  
> >> Hi,
> >>
> >> I am not sure if I understood how you trying to do the job, but 
> hopefully my
> >> task and work flow are close enough to be useful for you.
> >>
> >> 1. Let's say that the original image is in epsg:2393 and target is 
> epsg:3067.
> >> 2. I insert some ground control points in epsg:3067 with 
> gdal_translate and
> >> -gcp.  Image format of the temporal output file can be GeoTIFF but 
> also virtual
> >> raster(vrt).
> >> 3. I warp the temporary image, now containing gpc's in epsg:3067 
> projection, to
> >> final product using gdalwarp as
> >> gdalwarp -s_srs epsg:3067 -t_srs epsg:3067.
> >
> >
> >> Hi Jukka,
> >> You have described exactly what I want to do, but the problem is that
> >> in step 2, inserting gcps, the georeferenced boundaries of the file are
> >> lost. Eventually you get a somewhat displaced raw raster file.
> >> Jan
>  
> Hi,
>  
> That displacement could be avoided at least by inserting manually gcp 
> to each
> corner of the image. Perhaps this article gives some ideas:
> http://www.scangis.org/scangis2007/papers/r3_rahkonen.pdf
>  
> -Jukka-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090209/afe57266/attachment.html
From grevedan at hotmail.com  Mon Feb  9 15:12:33 2009
From: grevedan at hotmail.com (Dan Greve)
Date: Mon Feb  9 15:13:36 2009
Subject: [gdal-dev] concerning VSIInstallSubFileHandler
Message-ID: <COL107-W39A4847F593784CDA4E8F7C7BC0@phx.gbl>


Greetings,

I am currently accessing datasets which are embedded inside a single file.  Each dataset is a given file offset and length inside of the larger file.  

I saw in the latest doxy-docs here that there is a VSIInstallSubFileHandler for doing just that, and look forward to testing it out.  My concern with it, as well as the normal VSIMemFileHandler, is in accessing large files.  I have 2 GB images, embedded within files that are up to 100 GB in size.  Does the VSIMemFileHandler do any sort of paging so that the entire source image is not read into memory?

-- Dan Greve
-- Software Engineer
-- Northrop Grumman Corporation

_________________________________________________________________
Windows Live?: Keep your life in sync. 
http://windowslive.com/explore?ocid=TXT_TAGLM_WL_t1_allup_explore_022009
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090209/66a7d9ab/attachment.html
From warmerdam at pobox.com  Mon Feb  9 15:21:04 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Feb  9 15:21:28 2009
Subject: [gdal-dev] concerning VSIInstallSubFileHandler
In-Reply-To: <COL107-W39A4847F593784CDA4E8F7C7BC0@phx.gbl>
References: <COL107-W39A4847F593784CDA4E8F7C7BC0@phx.gbl>
Message-ID: <49909030.2090400@pobox.com>

Dan Greve wrote:
> Greetings,
> 
> I am currently accessing datasets which are embedded inside a single 
> file.  Each dataset is a given file offset and length inside of the 
> larger file. 
> 
> I saw in the latest doxy-docs here 
> <http://www.gdal.org/ogr/cpl__vsi_8h.html> that there is a 
> VSIInstallSubFileHandler for doing just that, and look forward to 
> testing it out.  My concern with it, as well as the normal 
> VSIMemFileHandler, is in accessing large files.  I have 2 GB images, 
> embedded within files that are up to 100 GB in size.  Does the 
> VSIMemFileHandler do any sort of paging so that the entire source image 
> is not read into memory?

Dan,

The VSIMemFileHandler treats a memory buffer as a file.  There is no support
in it for paging from a file so it is only suitable when you are prepared
to load the object into RAM.

The VSISubFileHandler on the other hand just manages access to a file through
regular file access handle, but keeping track of an offset to the sub file.
So it does not use appreciably more memory than a normal file access.

I believe the subfilehandler would be the suitable tool for you.  I believe it
is only available in GDAL trunk, not 1.6.x.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From grevedan at hotmail.com  Mon Feb  9 15:42:47 2009
From: grevedan at hotmail.com (Dan Greve)
Date: Mon Feb  9 15:42:52 2009
Subject: [gdal-dev] concerning VSIInstallSubFileHandler
In-Reply-To: <49909030.2090400@pobox.com>
References: <COL107-W39A4847F593784CDA4E8F7C7BC0@phx.gbl>
	<49909030.2090400@pobox.com>
Message-ID: <COL107-W8337E959429A499AEEA536C7BC0@phx.gbl>


Frank,

Exactly the answer I was looking for, I was hoping the MemFileHandler wasn't used directly by the VSISubFileHandler.  You are constantly adding features right before I need them.  Keep up the great work!

-- dan

> Date: Mon, 9 Feb 2009 15:21:04 -0500
> From: warmerdam@pobox.com
> To: grevedan@hotmail.com
> CC: gdal-dev@lists.osgeo.org
> Subject: Re: [gdal-dev] concerning VSIInstallSubFileHandler
> 
> Dan Greve wrote:
> > Greetings,
> > 
> > I am currently accessing datasets which are embedded inside a single 
> > file.  Each dataset is a given file offset and length inside of the 
> > larger file. 
> > 
> > I saw in the latest doxy-docs here 
> > <http://www.gdal.org/ogr/cpl__vsi_8h.html> that there is a 
> > VSIInstallSubFileHandler for doing just that, and look forward to 
> > testing it out.  My concern with it, as well as the normal 
> > VSIMemFileHandler, is in accessing large files.  I have 2 GB images, 
> > embedded within files that are up to 100 GB in size.  Does the 
> > VSIMemFileHandler do any sort of paging so that the entire source image 
> > is not read into memory?
> 
> Dan,
> 
> The VSIMemFileHandler treats a memory buffer as a file.  There is no support
> in it for paging from a file so it is only suitable when you are prepared
> to load the object into RAM.
> 
> The VSISubFileHandler on the other hand just manages access to a file through
> regular file access handle, but keeping track of an offset to the sub file.
> So it does not use appreciably more memory than a normal file access.
> 
> I believe the subfilehandler would be the suitable tool for you.  I believe it
> is only available in GDAL trunk, not 1.6.x.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 

_________________________________________________________________
Windows Live?: E-mail. Chat. Share. Get more ways to connect. 
http://windowslive.com/howitworks?ocid=TXT_TAGLM_WL_t2_allup_howitworks_022009
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090209/5606a925/attachment.html
From Matthew.Cole at drdc-rddc.gc.ca  Mon Feb  9 16:48:11 2009
From: Matthew.Cole at drdc-rddc.gc.ca (Matthew Cole)
Date: Mon Feb  9 16:48:15 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
Message-ID: <1234216091798-2299600.post@n2.nabble.com>


I've created java bindings for GDAL 1.6 in Windows and it seemed to work but
I'm getting linker errors whenever I try to access any gdal functions.

java.lang.UnsatisfiedLinkError:
C:\build182\gdal-1.6.0\swig\java\apps\gdaljni.dl
l: Can't find dependent libraries
Exception in thread "main" java.lang.UnsatisfiedLinkError:
org.gdal.gdal.gdalJNI.AllRegister()V
        at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
        at org.gdal.gdal.gdal.AllRegister(gdal.java:255)
        at R2gcpinfo.R2ExtractFootprint(R2gcpinfo.java:100)
        at R2gcpinfo.main(R2gcpinfo.java:78)

I've got it working for version 1.4, with the dlls in the same places, so
I'm not sure what the problem is.  II don't think the java binding are
officially supported for 1.6 but has anyone gottem them working?

Thanks for your help,
Matt

-- 
View this message in context: http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2299600.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Mon Feb  9 17:08:47 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Feb  9 17:09:00 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <1234216091798-2299600.post@n2.nabble.com>
References: <1234216091798-2299600.post@n2.nabble.com>
Message-ID: <200902092308.48871.even.rouault@mines-paris.org>

Yes, I've managed to build them, but with Linux. Have you verified that the 
gdal.jar is generated and at the right place ?
There are instructions here : 
http://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructions

It would be great if you could update the wiki page in case something has 
really change in the build process since that page was written.

You should also be warned that due to missing SWIG typemaps, quite a few 
methods in 1.6 bindings have wrong signature, which will hopefully be fixed 
in the future in 1.7dev once I've commited the code.

Le Monday 09 February 2009 22:48:11 Matthew Cole, vous avez ?crit?:
> I've created java bindings for GDAL 1.6 in Windows and it seemed to work
> but I'm getting linker errors whenever I try to access any gdal functions.
>
> java.lang.UnsatisfiedLinkError:
> C:\build182\gdal-1.6.0\swig\java\apps\gdaljni.dl
> l: Can't find dependent libraries
> Exception in thread "main" java.lang.UnsatisfiedLinkError:
> org.gdal.gdal.gdalJNI.AllRegister()V
>         at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
>         at org.gdal.gdal.gdal.AllRegister(gdal.java:255)
>         at R2gcpinfo.R2ExtractFootprint(R2gcpinfo.java:100)
>         at R2gcpinfo.main(R2gcpinfo.java:78)
>
> I've got it working for version 1.4, with the dlls in the same places, so
> I'm not sure what the problem is.  II don't think the java binding are
> officially supported for 1.6 but has anyone gottem them working?
>
> Thanks for your help,
> Matt


From even.rouault at mines-paris.org  Mon Feb  9 19:46:41 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon Feb  9 19:46:54 2009
Subject: [gdal-dev] Improving GDAL safety with respect to hostile/corrupt
	files
Message-ID: <200902100146.42585.even.rouault@mines-paris.org>

Hi all,

This email follows a discussion started on GDAL IRC channel and some effort I 
have began in my own tree to review and fix GDAL drivers for being more 
robust when facing invalid data which can be corrupt files (random accidental 
errors), or hostile files (after code analysis of flaws in source code, or 
use of automated tool for that task).

This effort is a bit in the continuity of 
http://trac.osgeo.org/gdal/wiki/rfc19_safememalloc

First disclaimer : this topic only tries to address GDAL drivers, as opposed 
to OGR ones (but there would certainly similar issues with OGR drivers !) and 
I focus mainly on the read part of GDAL drivers.
Second disclaimer : I'm not personnaly a specialist in software safety, just 
trying to improve GDAL's state in that area.

First observation: we have currently 96 GDAL drivers advertized in 
http://gdal.org/formats_list.html (and a 97th commited just a few hours ago), 
representing about 368 000 lines of C/C++ code, so this would be a HUGE 
effort to make an exhaustive review.

I'm mainly interested in fixing code used by GDALOpen() and that could blow up 
when fed with invalid data. After successfully opening a dataset, the 
IReadBlock() method is generally the second place to check for issues. But as 
GDALOpen() is the first step the user needs to run to be able to decide if we 
want to go on using the dataset, the Open() method of the driver is the top 
priority place to look at.

From what I have seen, security related bugs can be classified as :
- segmentation faults = application crash.
- denial of service = code doesn't return to the caller in a reasonable amount 
of time. Endless loops, or loops on a huge number of iterations, huge memory 
allocations (ones that are comparable to the amount of RAM, so that they can 
be satisfied but at the expense of massive disk swapping)....
- buffer overflows, in particular stack buffer overflows, that could be 
exploited to make hostile code embedded in a dataset run as the user of the 
process linking with GDAL. Those last ones are generally the most dangerous 
ones.
Depending on how GDAL is used and deployed, this can have different 
consequences.

My review of quite a few drivers has revealed that there were several common 
mistakes that are made and which generally sum up to a lack of validation of 
input data for a small set of critical items. They generally can be easily 
avoided by simple tests. For example, the nRasterXSize field of the 
GDALDataset object is a (signed) int. But it is invalid to set a null or 
negative value into it. This is currently done in a minority of drivers. The 
same applies for block sizes in GDALRasterBand objects too. The idea is too 
check that the dimensions declared while reading the input data are valid, 
and if not, return properly with an error value. (We could also imagine to 
change the type of nRasterXSize to unsigned, but I expect this would be 
considered a too disruptive API change --> probably hundreds of compiler 
warnings to fix, and user code not ready to deal with 4 294 967 295 instead 
of 2 147 483 647 ).

For uncompressed data, we could also check that the file size is consistant 
with the expected file size (roughly header size + width * height * nbands * 
GDALGetDataSize(eDataType) ). But, I haven't really encountered a driver that 
would behave badly from the security point of view because of that. We would 
get I/O errors which is fine I think. I also want to remind people that we 
currently have tests in the autotest suite that use volontarily truncated 
datasets to check that the header can be successfully decoded. This is 
desirable to keep the test suite data small enough to be downloaded... 

Another common issue, which is really the main point where I wanted to get 
feedback at first, is dealing with the number of bands. Currently, when a 
GDAL driver opens a dataset and has detected that it was valid, it loops over 
the number of bands that must be created to instanciate them, like in :

    for( int iBand = 1; iBand <= nBands; iBand++ )
    {
        poDS->SetBand( iBand, new FooRasterBand(poDS, iBand) );
    }

and it returns to GDALOpen() only after that. So, what happens if nBands is 
really really huge, like 2 147 483 647 ? It will spend a lot of time in 
looping and will eventually crash in an unsucessfull memory allocation after 
having exhausted the memory. Many drivers read the number of bands from a 
int32, so that can happen. 

To solve that particular case, I'd like to introduce a GDAL_MAX_BAND_COUNT 
#define (defined in some GDAL core header file, gdal_priv.h for example) with 
which we would compare the number of bands read from the file, and error out 
if necessary. I'd suggest GDAL_MAX_BAND_COUNT = 65536.  TIFF has a limit to 
65535 for example, and after a bit of discussion on IRC, it seems to be a 
reasonable limit even for hyperspectral data, where GDAL still behaves well. 
Do people agree ? Or do you have real-world use cases where this would happen 
to be a too low limit ? We can safely define it at 2147483647, and people 
wanting to restrict it for their own needs could just change it and recompile 
GDAL with the value they feel to be appropriate. Another option would be to 
make that value a configuration option that could be changed at runtime.

Phil Vachon suggested to make the dataset dynamically allocate the Band 
object. This would require changes to GDAL core, that should be designed as 
additions, and not as requiring compulsory changes to existing drivers. It 
would anyway require each driver wanting to be more secure to be changed to 
use that new capability, and I think checking the number of bands is the 
easiest way of achieving the desired result.

Other issues can be related to integer overflow in additions, multiplications, 
etc . For example, for "nBlocksPerRow = (nRasterXSize+nBlockXSize-1) / 
nBlockXSize;", after having checked that nRasterXSize > 0 and nBlockXSize > 
0, we should also check that nRasterXSize <= INT_MAX - (nBlockXSize-1). I've 
added recently that kind of checks in gdalrasterband.cpp, but that can be 
found at the driver level too.

A difficult issue to solve is the case of those big memory allocations, big 
enough to exhaust your physical RAM, but not all your virtual memory. In most 
cases, those only occur in GDAL cache block when you first begin to read data 
in a band, so it can be analysed at application level if it is reasonnable to 
deal with a dataset whose blocksize is 100 000 x 100 000. But in a few 
drivers, this allocation is also done in the constructor of the Band object. 
This could probably be restructured by moving the buffer allocation at the 
first call of IReadBlock()/IWriteBlock().
A complementary idea is that we could define, via a configuration option, an 
optional maximum allocation size for a single allocation and make VSIMalloc 
check first that we don't ask for more. For example, we want all single 
memory allocations above 500 MB to fail. It is unlikely that a valid use of 
GDAL would require to allocate 500 MB in a single time. For example, FrankW 
lately wrote an alternate GIF driver to deal specifically with GIF files 
whose uncompressed data size is above 100 MB, without allocating all that 
memory.
(some people could object that similar mechanisms exists for that, like ulimit 
on Linux, but AFAIK they extend to the whole process, not at the library 
level)

Anyway, I think all substantial memory allocations should be done with 
VSIMalloc/Calloc and the return value tested against NULL, instead of using 
CPLMalloc/Calloc which just abort() in case of failure.

Well, I'm going to stop here this long and not exhaustive list of 
recommandations. This could be material for a dedicated page on Trac.

FrankW suggested that we could add a metadata item at the driver level which 
would indicate that the driver is considered to be safe (similarly to the 
metadata item indicating that a driver makes use of the VSI*L safe 
indicator). Quotting him : "So it would be easy for folks to only register 
drivers that claim to be vetted. The reference documentation would provide 
all appropriate disclaimers.". 

Although I'm not opposed to it, I feel personnaly a bit shy about that 
proposal and think the following points would have to be solved:
1) what would be the criteria to declare a driver to be vetted ? Check that 
some precise to-be-defined rules have been followed ? Or just a general code 
review ? by one or several people ? and/or a PSC decision ?
2) how do we handle cases where third-party libraries are used ? For example, 
let's imagine that we declare the GDAL specific code of the GeoTIFF driver to 
be safe. But as it makes uses of libgeotiff and libtiff, its safety also 
depends on those two ones...
3) are we in a position to judge our own work ? doesn't it put too much 
responsibility on our shoulders, even if we write all the appropriate 
disclaimers ? Would people really read and understand the scope of what 
we "guarantee" and what we don't.

I think many drivers can be easily fixed to be safer against random data 
corruption, but being robust against a targeted attack is far more 
complicated. In some cases, we can even foresee the path the attacker would 
follow, but fixing the driver might be a lot of work, that the maintener of 
the driver is not ready to do. And as all people in the GDAL developer 
community aren't necessarily interested in that area, we cannot reasonnably 
set strict rules on contributors.

I believe it could be interesting to have a Trac page with :
1) recommandations, common errors to avoid
2) a summary of what drivers have been reviewed, on which aspects they have 
been reviewed, on which revision of the file, by whom.... (this is a bit 
redundant with a careful analysis of subversion commit logs and diffs)

Then users interested could make their own enlightened choice of which driver 
to compile / register based on those indications and their own review.

Would we also want to indicate unresolved issues ? As GDAL is open source, it 
is already fairly easy for hostile people to craft malicious files and they 
wouldn't probably learn much with those informations, except maybe some 
script kiddies discovering a new playground...

Or should we just go on as we currently do, that is to say, fix things 
incrementally without too much formalism and publicity ?

For those who have had managed to reach the end of this lengthy email, I'd be 
happy to hear their feedback...

Best regards,

Even

From gregor.fikoczek at wheregroup.com  Tue Feb 10 04:22:07 2009
From: gregor.fikoczek at wheregroup.com (Gregor Fikoczek)
Date: Tue Feb 10 04:22:15 2009
Subject: [gdal-dev] Generating GML from Database - Problem: No decimal values
Message-ID: <200902101022.08153.gregor.fikoczek@wheregroup.com>



Hi list,

i got a problem by generating a GML-File from the Oracle- and MySQL-DB using 
ogr2ogr, so I alway getting in MySQL/oracle instead of a float-value an 
rounded integer-value (mostly 0) without any decimal numbers. 

Some Info:

#################################

Structure MySQL:

	ID  	smallint(6)  	
	col1 	float 		
	col2 	float(8,4) 	
	col3 	double 		
	col4 	double(8,4) 	
	col5 	decimal(10,0) 
	col6 	decimal(6,4)

using ogrinfo/ogr2ogr with MySQL:

ogrinfo MYSQL:******** -sql "SELECT * from test_decimal_values"

OGRFeature(sql_statement):3
  ID (Integer) = 3
  col1 (Real) =  12
  col2 (Real) =  12
  col3 (Real) =  12
  col4 (Real) =  12
  col5 (Real) =  12
  col6 (Real) =  12.1234

Real Value (every column) in the databese: 12.1234

=> Only the values of column col6 [	decimal(6,4)] are right interprated, what 
about the other decimal value in ogr ????
=> My real column is like the col1-column [float]

#################################

Structure Oracle:

ID		NUMBER(2,0)
COL1		NUMBER
COL2		NUMBER(6,4)


using ogrinfo/ogr2ogr with Oracle:

ogrinfo OCI:********** -sql "SELECT * from test_decimal_values"

Feature Count: 1
Layer SRS WKT:
(unknown)
ID: Integer (2.0)
COL1: Real (0.0)
COL2: Real (6.4)

OGRFeature(SELECT * from test_decimal_values):0
  ID (Integer) = 1
  COL1 (Real) = 12
  COL2 (Real) = 12.0000

Real Value (every column) in the databese: 12.3456


=> No column-values are right interprated, so what about the decimal value in 
ogr ????
=> My real column is like the col1-column [NUMBER]


#################################

So is there any option i got to set or a workaround for that problem, 
aspacialy in oracle?


Best regards, 
Greq



---------------------------------------
WhereGroup GmbH & Co. KG
Siemensstra?e 8
53121 Bonn
Germany

Gregor Fikoczek
Email: gregor.fikoczek@wheregroup.com
Fon: +49 (0)228 / 90 90 38 - 25
Fax: +49 (0)228 / 90 90 38 - 11

info@wheregroup.com
www.wheregroup.com
Amtsgericht Bonn, HRA 6788
-------------------------------
Komplement?rin:
WhereGroup Verwaltungs GmbH
vertreten durch:
Olaf Knopp, Peter Stamm
---------------------------------------
From gregor.fikoczek at wheregroup.com  Tue Feb 10 04:39:12 2009
From: gregor.fikoczek at wheregroup.com (Gregor Fikoczek)
Date: Tue Feb 10 04:39:15 2009
Subject: [gdal-dev] Generating GML from Database - Problem: No decimal
	values
In-Reply-To: <200902101022.08153.gregor.fikoczek@wheregroup.com>
References: <200902101022.08153.gregor.fikoczek@wheregroup.com>
Message-ID: <200902101039.12314.gregor.fikoczek@wheregroup.com>


Hi list, 

i got some new 


By generating GML from oracle, i first have to set the NLS_LANG-Parameter:



 export NLS_LANG=AMERICAN_AMERICA.WE8ISO8859P1
 ogrinfo OCI:************* -sql "SELECT * from test_decimal_values"

Layer name: SELECT * from test_decimal_values
Geometry: Unknown (any)
Feature Count: 1
Layer SRS WKT:
(unknown)
ID: Integer (2.0)
COL1: Real (0.0)
COL2: Real (6.4)
OGRFeature(SELECT * from test_decimal_values):0
  ID (Integer) = 1
  COL1 (Real) = 12.3456
  COL2 (Real) = 12.3456

=> So now everythin is fine with the GML from the data source oracle


########################################

So I got now only the problem with MySQL and the float column:

MySQL:
col1 	float

OGR:
col1 (Real) =  12

col1 (Real) =  12

(Real Value (every column) in the databese: 12.1234)

Any idea?

Best Regards,
Greq



Am Dienstag 10 Februar 2009 10:22:07 schrieb Gregor Fikoczek:
> Hi list,
>
> i got a problem by generating a GML-File from the Oracle- and MySQL-DB
> using ogr2ogr, so I alway getting in MySQL/oracle instead of a float-value
> an rounded integer-value (mostly 0) without any decimal numbers.
>
> Some Info:
>
> #################################
>
> Structure MySQL:
>
> 	ID  	smallint(6)
> 	col1 	float
> 	col2 	float(8,4)
> 	col3 	double
> 	col4 	double(8,4)
> 	col5 	decimal(10,0)
> 	col6 	decimal(6,4)
>
> using ogrinfo/ogr2ogr with MySQL:
>
> ogrinfo MYSQL:******** -sql "SELECT * from test_decimal_values"
>
> OGRFeature(sql_statement):3
>   ID (Integer) = 3
>   col1 (Real) =  12
>   col2 (Real) =  12
>   col3 (Real) =  12
>   col4 (Real) =  12
>   col5 (Real) =  12
>   col6 (Real) =  12.1234
>
> c
>
> => Only the values of column col6 [	decimal(6,4)] are right interprated,
> what about the other decimal value in ogr ????
> => My real column is like the col1-column [float]
>
> #################################
>
> Structure Oracle:
>
> ID		NUMBER(2,0)
> COL1		NUMBER
> COL2		NUMBER(6,4)
>
>
> using ogrinfo/ogr2ogr with Oracle:
>
> ogrinfo OCI:********** -sql "SELECT * from test_decimal_values"
>
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> ID: Integer (2.0)
> COL1: Real (0.0)
> COL2: Real (6.4)
>
> OGRFeature(SELECT * from test_decimal_values):0
>   ID (Integer) = 1
>   COL1 (Real) = 12
>   COL2 (Real) = 12.0000
>
> Real Value (every column) in the databese: 12.3456
>
>
> => No column-values are right interprated, so what about the decimal value
> in ogr ????
> => My real column is like the col1-column [NUMBER]
>
>
> #################################
>
> So is there any option i got to set or a workaround for that problem,
> aspacialy in oracle?
>
>
> Best regards,
> Greq
>
>
>
> ---------------------------------------
> WhereGroup GmbH & Co. KG
> Siemensstra?e 8
> 53121 Bonn
> Germany
>
> Gregor Fikoczek
> Email: gregor.fikoczek@wheregroup.com
> Fon: +49 (0)228 / 90 90 38 - 25
> Fax: +49 (0)228 / 90 90 38 - 11
>
> info@wheregroup.com
> www.wheregroup.com
> Amtsgericht Bonn, HRA 6788
> -------------------------------
> Komplement?rin:
> WhereGroup Verwaltungs GmbH
> vertreten durch:
> Olaf Knopp, Peter Stamm
> ---------------------------------------
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mit freundlichen Gr??en / Kind regards

Gregor Fikoczek



---------------------------------------
WhereGroup GmbH & Co. KG
Siemensstra?e 8
53121 Bonn
Germany

Gregor Fikoczek
Email: gregor.fikoczek@wheregroup.com
Fon: +49 (0)228 / 90 90 38 - 25
Fax: +49 (0)228 / 90 90 38 - 11

info@wheregroup.com
www.wheregroup.com
Amtsgericht Bonn, HRA 6788
-------------------------------
Komplement?rin:
WhereGroup Verwaltungs GmbH
vertreten durch:
Olaf Knopp, Peter Stamm
---------------------------------------
From jumpjack at libero.it  Tue Feb 10 12:48:46 2009
From: jumpjack at libero.it (jumpjack)
Date: Tue Feb 10 12:49:02 2009
Subject: [gdal-dev] gdalwarp: mercator to lambert azimutal equeal area
In-Reply-To: <20090209134720.ALG78945@mymail.erau.edu>
References: <20090209134720.ALG78945@mymail.erau.edu>
Message-ID: <200902101848460287.002A6ABD@mail.libero.it>

Thanks, but I can't yet understand...
I have a map of the whole world. It is 640 pixel wide. "Planar world" is 44.000.000 meters wide.... so which number should I specify as "A"??
The same applies for "E".
About C and F: which coordinates should I specify? Lat and Lon?  This would be 90,-180, I guess, being the map centered on Lat,Lon=0,0 and 360 wide and 180 tall.

Thanks for your pacience.

(Please reply on the list, others could be interested!)

bye,
Jumpjack


*********** REPLY SEPARATOR  ***********

On 09/02/2009 at 13.47 Wendy Fay Stevenson wrote:

>As long as the world file is the same name as the input file to gdalwarp,
>it will work.
>
>As for specifying the world file:
>A: number of meters across / number of pixels across
>D & B: 0
>E: -1 * number of meters in length / number of pixels in length 
>C and F specify the center of the top left pixel in eastings and
>northings, i.e. where on the projection the first pixel corresponds to.



From jumpjack at libero.it  Tue Feb 10 14:52:11 2009
From: jumpjack at libero.it (jumpjack)
Date: Tue Feb 10 14:52:32 2009
Subject: Fwd: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal
	equeal area
References: <20090209134720.ALG78945@mymail.erau.edu>
	<200902101848460287.002A6ABD@mail.libero.it>
Message-ID: <200902102052110755.009B6A59@mail.libero.it>

I tried georeferencing one of these images ( http://www.oera.net/How2/TextureMaps2.htm ) using MapWindow GIS; the pogram generated a .jgw file, which then I fixed by replacing "," by "." and changing something like 179.12345 to 180.0 .
Then I tried again this command:
>gdalwarp -s_srs  "+proj=merc" -t_srs "+proj=laea" world.jpg  dest.jpg

Ok, program now does not complain for any error... but what I get as output is EXACTLY the SAME image!!!

What's wrong now?
And how do I specify the center of the Lambert projection to be on north pole?


*********** BEGIN FORWARDED MESSAGE  ***********

On 09/02/2009 at 13.47 jumpjack <jumpjack@libero.it> wrote:

From: jumpjack <jumpjack@libero.it>
To: "Wendy Fay Stevenson" <stevensw@erau.edu>
CC: gdal-dev@lists.osgeo.org
Date: Tue, 10 Feb 2009 18:48:45 +0100 
Subject: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal  equeal area



>Thanks, but I can't yet understand...
>I have a map of the whole world. It is 640 pixel wide. "Planar world" is
>44.000.000 meters wide.... so which number should I specify as "A"??
>The same applies for "E".
>About C and F: which coordinates should I specify? Lat and Lon?  This
>would be 90,-180, I guess, being the map centered on Lat,Lon=0,0 and 360
>wide and 180 tall.
>
>Thanks for your pacience.
>
>(Please reply on the list, others could be interested!)
>
>bye,
>Jumpjack
>
>
>*********** REPLY SEPARATOR  ***********
>
>On 09/02/2009 at 13.47 Wendy Fay Stevenson wrote:
>
>>As long as the world file is the same name as the input file to gdalwarp,
>>it will work.
>>
>>As for specifying the world file:
>>A: number of meters across / number of pixels across
>>D & B: 0
>>E: -1 * number of meters in length / number of pixels in length 
>>C and F specify the center of the top left pixel in eastings and
>>northings, i.e. where on the projection the first pixel corresponds to.
>
>

*********** END FORWARDED MESSAGE  ***********

From even.rouault at mines-paris.org  Tue Feb 10 15:13:00 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Feb 10 15:13:14 2009
Subject: Fwd: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal
	equeal area
In-Reply-To: <200902102052110755.009B6A59@mail.libero.it>
References: <20090209134720.ALG78945@mymail.erau.edu>
	<200902101848460287.002A6ABD@mail.libero.it>
	<200902102052110755.009B6A59@mail.libero.it>
Message-ID: <200902102113.02855.even.rouault@mines-paris.org>

I think you don't define enough the projections and should specify more 
parameters. 

PROJ.4 documentation and the following links may be helpful :
http://www.remotesensing.org/geotiff/proj_list/mercator_1sp.html
http://www.remotesensing.org/geotiff/proj_list/mercator_2sp.html
http://www.remotesensing.org/geotiff/proj_list/lambert_azimuthal_equal_area.html


Le Tuesday 10 February 2009 20:52:11 jumpjack, vous avez ?crit?:
> I tried georeferencing one of these images (
> http://www.oera.net/How2/TextureMaps2.htm ) using MapWindow GIS; the pogram
> generated a .jgw file, which then I fixed by replacing "," by "." and
> changing something like 179.12345 to 180.0 .
>
> Then I tried again this command:
> >gdalwarp -s_srs  "+proj=merc" -t_srs "+proj=laea" world.jpg  dest.jpg
>
> Ok, program now does not complain for any error... but what I get as output
> is EXACTLY the SAME image!!!
>
> What's wrong now?
> And how do I specify the center of the Lambert projection to be on north
> pole?
>
>
> *********** BEGIN FORWARDED MESSAGE  ***********
>
> On 09/02/2009 at 13.47 jumpjack <jumpjack@libero.it> wrote:
>
> From: jumpjack <jumpjack@libero.it>
> To: "Wendy Fay Stevenson" <stevensw@erau.edu>
> CC: gdal-dev@lists.osgeo.org
> Date: Tue, 10 Feb 2009 18:48:45 +0100
> Subject: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal  equeal
> area
>
> >Thanks, but I can't yet understand...
> >I have a map of the whole world. It is 640 pixel wide. "Planar world" is
> >44.000.000 meters wide.... so which number should I specify as "A"??
> >The same applies for "E".
> >About C and F: which coordinates should I specify? Lat and Lon?  This
> >would be 90,-180, I guess, being the map centered on Lat,Lon=0,0 and 360?
> >wide and 180? tall.
> >
> >Thanks for your pacience.
> >
> >(Please reply on the list, others could be interested!)
> >
> >bye,
> >Jumpjack
> >
> >
> >*********** REPLY SEPARATOR  ***********
> >
> >On 09/02/2009 at 13.47 Wendy Fay Stevenson wrote:
> >>As long as the world file is the same name as the input file to gdalwarp,
> >>it will work.
> >>
> >>As for specifying the world file:
> >>A: number of meters across / number of pixels across
> >>D & B: 0
> >>E: -1 * number of meters in length / number of pixels in length
> >>C and F specify the center of the top left pixel in eastings and
> >>northings, i.e. where on the projection the first pixel corresponds to.
>
> *********** END FORWARDED MESSAGE  ***********
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Tue Feb 10 16:40:59 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Tue Feb 10 16:41:05 2009
Subject: Fwd: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal
	equeal area
In-Reply-To: <200902102052110755.009B6A59@mail.libero.it>
References: <20090209134720.ALG78945@mymail.erau.edu>	<200902101848460287.002A6ABD@mail.libero.it>
	<200902102052110755.009B6A59@mail.libero.it>
Message-ID: <4991F46B.9090608@ualg.pt>

Hi,

A couple of things,

1. "Planar world" is not 44.000.000 meters wide. It follows from the meter
    definitions that it is 40 000 000 meters

2. Mercator maps cannot span to +/- 90 degrees latitude

3. The images in www.oera.net/How2/TextureMaps2.htm are not Mecator

4. "and changing something like 179.12345 to 180.0 ." You should not do that.
    Coordinates in the world file are that of the CENTER of the top left pixel

5. The whole thing was easy task with Mirone.
    I used the first image on that page and with it just do:
    Put this inside a file named EarthMap_2500x1250.jgw

0.1440000000
0.0
0.0
-0.1440000000
-179.9280000000
89.9280000000

and now

gdalwarp EarthMap_2500x1250.jpg -s_srs +proj=latlong -t_srs +proj=laea EarthMap_2500x1250.jpg  dest.jpg

Which will show ... another manifestation of the gdalwarp bug (http://trac.osgeo.org/gdal/ticket/2305)
when dealing with global files

Joaquim Luis


> I tried georeferencing one of these images ( http://www.oera.net/How2/TextureMaps2.htm ) using MapWindow GIS; the pogram generated a .jgw file, which then I fixed by replacing "," by "." and changing something like 179.12345 to 180.0 .
> Then I tried again this command:
>> gdalwarp -s_srs  "+proj=merc" -t_srs "+proj=laea" world.jpg  dest.jpg
> 
> Ok, program now does not complain for any error... but what I get as output is EXACTLY the SAME image!!!
> 
> What's wrong now?
> And how do I specify the center of the Lambert projection to be on north pole?
> 
> 
> *********** BEGIN FORWARDED MESSAGE  ***********
> 
> On 09/02/2009 at 13.47 jumpjack <jumpjack@libero.it> wrote:
> 
> From: jumpjack <jumpjack@libero.it>
> To: "Wendy Fay Stevenson" <stevensw@erau.edu>
> CC: gdal-dev@lists.osgeo.org
> Date: Tue, 10 Feb 2009 18:48:45 +0100 
> Subject: Re[4]: [gdal-dev] gdalwarp: mercator to lambert azimutal  equeal area
> 
> 

> 
>> Thanks, but I can't yet understand...
>> I have a map of the whole world. It is 640 pixel wide. "Planar world" is
>> 44.000.000 meters wide.... so which number should I specify as "A"??
>> The same applies for "E".
>> About C and F: which coordinates should I specify? Lat and Lon?  This
>> would be 90,-180, I guess, being the map centered on Lat,Lon=0,0 and 360?
>> wide and 180? tall.
>>
>> Thanks for your pacience.
>>
>> (Please reply on the list, others could be interested!)
>>
>> bye,
>> Jumpjack
>>
>>
>> *********** REPLY SEPARATOR  ***********
>>
>> On 09/02/2009 at 13.47 Wendy Fay Stevenson wrote:
>>
>>> As long as the world file is the same name as the input file to gdalwarp,
>>> it will work.
>>>
>>> As for specifying the world file:
>>> A: number of meters across / number of pixels across
>>> D & B: 0
>>> E: -1 * number of meters in length / number of pixels in length 
>>> C and F specify the center of the top left pixel in eastings and
>>> northings, i.e. where on the projection the first pixel corresponds to.
>>
> 
> *********** END FORWARDED MESSAGE  ***********
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From yann.chemin at gmail.com  Tue Feb 10 20:38:00 2009
From: yann.chemin at gmail.com (Yann Chemin)
Date: Tue Feb 10 20:38:04 2009
Subject: [gdal-dev] satellite image processing in Python
Message-ID: <4f37eb890902101738o2a842452wfe31973282557442@mail.gmail.com>

Hello,

Would need a small help to troubleshoot this small code:

1 - When the for loop is over, the last file is not completely closed
(~480Mb instead of 509Mb)
Is there a way to force it to close? (opening another file forces the
previous file to be closed with a proper"?" 509Mb)

2 -  A segmentation fault is crashing Python when using LoadFile() on
any one of the files generated in the loop.

Thank you,
Yann

-------------------------------------------------------------------------------------

# Landsat 7 ETM + image downlaoded from GLCF
#ftp.glcf.umiacs.umd.edu/glcf/Landsat/WRS2/p127/r049/p127r049_7x20001104.ETM-EarthSat-Orthorectified/
#p127r049 2000/11/04 around Ubon Ratchathani, North East Thailand.
# Metadata in the text file: p127r049_7x20001104.met

#Purpose: Calculate NDVI and Albedo
#Usage: /usr/bin/python -u "ndvi_albedo.py"

#if problem of libgrass: MAPSET is not set
#then: set GDAL_SKIP = GRASS

F=[]
F.append('p116r049_7t20010518_z51_nn10.tif')
F.append('p116r049_7t20010518_z51_nn20.tif')
F.append('p116r049_7t20010518_z51_nn30.tif')
F.append('p116r049_7t20010518_z51_nn40.tif')
F.append('p116r049_7t20010518_z51_nn50.tif')
F.append('p116r049_7t20010518_z51_nn70.tif')

# For Image Processing
from math import *
import numpy
from osgeo import gdalnumeric
from osgeo import gdal
from osgeo.gdal_array import *
from osgeo.gdalconst import *

# Set our output file format driver
driver = gdal.GetDriverByName( 'GTiff' )

# Set our output files Projection parameters
# from input file number 1
tmp = gdal.Open(F[0])
geoT = tmp.GetGeoTransform()
proJ = tmp.GetProjection()
del tmp

#DN to radiance conversion factors
#(Check if they are correct for your image)
LMax = [191.6,196.5,152.9,241.1,31.060,10.8]
Lmin = [-6.2,-6.4,-5.0,-5.1,-1.0,-0.35]
#Exo-Atmospheric band-wise irradiance
KEXO = [1970.0,1843.0,1555.0,1047.0,227.1,80.53]
#Unless you use p127r049 2000/11/04, these must be changed
sun_elevation = 51.3428710
doy = 311
#Cos(sun zenith angle) / (pi * (Sun-Earth distance)^2)
constant=(cos((90-sun_elevation) * pi/180 ) / (pi * (1+0.01672 * sin
(2 * pi * (doy - 93.5) / 365)) ** 2))

#Top Of Atmosphere Reflectance
for i in range (0,6):
	b = LoadFile(F[i])
	result = int(100*((b * ((LMax[i]-Lmin[i])/255.0) + Lmin[i]) /
(constant * KEXO[i])))
	if i != 5:
		output_filename='b'+str(i+1)+'_ref.tif'
	else:
		output_filename='b'+str(i+2)+'_ref.tif'
	#Create output file with projection
	out = OpenArray(result)
	out.SetGeoTransform( geoT )
	out.SetProjection( proJ )
	driver.CreateCopy(output_filename, out)
	#Empty memory objects
	del result, b, out

#NDVI
NIR = LoadFile('b4_ref.tif') <------Seg Fault here
Red = LoadFile('b3_ref.tif')
ndvi = (NIR-Red)/(NIR+Red)


-- 
Yann Chemin
International Rice Research Institute
Office: http://www.irri.org/gis
Perso: http://www.freewebs.com/ychemin
YiKingDo: http://yikingdo.unblog.fr/
From yann.chemin at gmail.com  Tue Feb 10 20:48:56 2009
From: yann.chemin at gmail.com (Yann Chemin)
Date: Tue Feb 10 20:49:00 2009
Subject: [gdal-dev] Re: satellite image processing in Python
In-Reply-To: <4f37eb890902101738o2a842452wfe31973282557442@mail.gmail.com>
References: <4f37eb890902101738o2a842452wfe31973282557442@mail.gmail.com>
Message-ID: <4f37eb890902101748y535f8559w8aa1f5a5603b5b98@mail.gmail.com>

Sorry, this was not the version I intended to send initially.
Here it is...
_______________________________________

# Landsat 7 ETM + image downlaoded from GLCF
#ftp.glcf.umiacs.umd.edu/glcf/Landsat/WRS2/p127/r049/p127r049_7x20001104.ETM-EarthSat-Orthorectified/
#p127r049 2000/11/04 around Ubon Ratchathani, North East Thailand.
# Metadata in the text file: p127r049_7x20001104.met

#Purpose: Calculate NDVI and Albedo
#Usage: /usr/bin/python -u "ndvi_albedo.py"

#if problem of libgrass: MAPSET is not set
#then: set GDAL_SKIP = GRASS

F=[]
F.append('p116r049_7t20010518_z51_nn10.tif')
F.append('p116r049_7t20010518_z51_nn20.tif')
F.append('p116r049_7t20010518_z51_nn30.tif')
F.append('p116r049_7t20010518_z51_nn40.tif')
F.append('p116r049_7t20010518_z51_nn50.tif')
F.append('p116r049_7t20010518_z51_nn70.tif')

# For Image Processing
from math import *
import numpy
from osgeo import gdalnumeric
from osgeo import gdal
from osgeo.gdal_array import *
from osgeo.gdalconst import *

# Set our output file format driver
driver = gdal.GetDriverByName( 'GTiff' )

# Set our output files Projection parameters
# from input file number 1
tmp = gdal.Open(F[0])
geoT = tmp.GetGeoTransform()
proJ = tmp.GetProjection()
del tmp

#DN to radiance conversion factors
#(Check if they are correct for your image)
LMax = [191.6,196.5,152.9,241.1,31.060,10.8]
Lmin = [-6.2,-6.4,-5.0,-5.1,-1.0,-0.35]
#Exo-Atmospheric band-wise irradiance
KEXO = [1970.0,1843.0,1555.0,1047.0,227.1,80.53]
#Unless you use p127r049 2000/11/04, these must be changed
sun_elevation = 51.3428710
doy = 311
#Cos(sun zenith angle) / (pi * (Sun-Earth distance)^2)
constant=(cos((90-sun_elevation) * pi/180 ) / (pi * (1+0.01672 * sin
(2 * pi * (doy - 93.5) / 365)) ** 2))

#Top Of Atmosphere Reflectance
for i in range (0,6):
	b = LoadFile(F[i])
	result = 100*((b * ((LMax[i]-Lmin[i])/255.0) + Lmin[i]) / (constant * KEXO[i]))
	if i != 5:
		output_filename='b'+str(i+1)+'_ref.tif'
	else:
		output_filename='b'+str(i+2)+'_ref.tif'
	#Create output file with projection
	out = OpenArray(result)
	#out.dtype = numpy.int
	out.SetGeoTransform( geoT )
	out.SetProjection( proJ )
	driver.CreateCopy(output_filename, out)
	#SaveArray(result, output_filename, 'GTiff')
	#Empty memory objects
	del result, b, out


#NDVI
NIR = LoadFile('b4_ref.tif')
Red = LoadFile('b3_ref.tif')
ndvi = (NIR-Red)/1.0*(NIR+Red)
_______________________________________

2009/2/11 Yann Chemin <yann.chemin@gmail.com>:
> Hello,
>
> Would need a small help to troubleshoot this small code:
>
> 1 - When the for loop is over, the last file is not completely closed
> (~480Mb instead of 509Mb)
> Is there a way to force it to close? (opening another file forces the
> previous file to be closed with a proper"?" 509Mb)
>
> 2 -  A segmentation fault is crashing Python when using LoadFile() on
> any one of the files generated in the loop.
>
> Thank you,
> Yann
>
> -------------------------------------------------------------------------------------
>
> # Landsat 7 ETM + image downlaoded from GLCF
> #ftp.glcf.umiacs.umd.edu/glcf/Landsat/WRS2/p127/r049/p127r049_7x20001104.ETM-EarthSat-Orthorectified/
> #p127r049 2000/11/04 around Ubon Ratchathani, North East Thailand.
> # Metadata in the text file: p127r049_7x20001104.met
>
> #Purpose: Calculate NDVI and Albedo
> #Usage: /usr/bin/python -u "ndvi_albedo.py"
>
> #if problem of libgrass: MAPSET is not set
> #then: set GDAL_SKIP = GRASS
>
> F=[]
> F.append('p116r049_7t20010518_z51_nn10.tif')
> F.append('p116r049_7t20010518_z51_nn20.tif')
> F.append('p116r049_7t20010518_z51_nn30.tif')
> F.append('p116r049_7t20010518_z51_nn40.tif')
> F.append('p116r049_7t20010518_z51_nn50.tif')
> F.append('p116r049_7t20010518_z51_nn70.tif')
>
> # For Image Processing
> from math import *
> import numpy
> from osgeo import gdalnumeric
> from osgeo import gdal
> from osgeo.gdal_array import *
> from osgeo.gdalconst import *
>
> # Set our output file format driver
> driver = gdal.GetDriverByName( 'GTiff' )
>
> # Set our output files Projection parameters
> # from input file number 1
> tmp = gdal.Open(F[0])
> geoT = tmp.GetGeoTransform()
> proJ = tmp.GetProjection()
> del tmp
>
> #DN to radiance conversion factors
> #(Check if they are correct for your image)
> LMax = [191.6,196.5,152.9,241.1,31.060,10.8]
> Lmin = [-6.2,-6.4,-5.0,-5.1,-1.0,-0.35]
> #Exo-Atmospheric band-wise irradiance
> KEXO = [1970.0,1843.0,1555.0,1047.0,227.1,80.53]
> #Unless you use p127r049 2000/11/04, these must be changed
> sun_elevation = 51.3428710
> doy = 311
> #Cos(sun zenith angle) / (pi * (Sun-Earth distance)^2)
> constant=(cos((90-sun_elevation) * pi/180 ) / (pi * (1+0.01672 * sin
> (2 * pi * (doy - 93.5) / 365)) ** 2))
>
> #Top Of Atmosphere Reflectance
> for i in range (0,6):
>        b = LoadFile(F[i])
>        result = int(100*((b * ((LMax[i]-Lmin[i])/255.0) + Lmin[i]) /
> (constant * KEXO[i])))
>        if i != 5:
>                output_filename='b'+str(i+1)+'_ref.tif'
>        else:
>                output_filename='b'+str(i+2)+'_ref.tif'
>        #Create output file with projection
>        out = OpenArray(result)
>        out.SetGeoTransform( geoT )
>        out.SetProjection( proJ )
>        driver.CreateCopy(output_filename, out)
>        #Empty memory objects
>        del result, b, out
>
> #NDVI
> NIR = LoadFile('b4_ref.tif') <------Seg Fault here
> Red = LoadFile('b3_ref.tif')
> ndvi = (NIR-Red)/(NIR+Red)
>
>
> --
> Yann Chemin
> International Rice Research Institute
> Office: http://www.irri.org/gis
> Perso: http://www.freewebs.com/ychemin
> YiKingDo: http://yikingdo.unblog.fr/
>



-- 
Yann Chemin
International Rice Research Institute
Office: http://www.irri.org/gis
Perso: http://www.freewebs.com/ychemin
YiKingDo: http://yikingdo.unblog.fr/
From jumpjack at libero.it  Wed Feb 11 04:49:17 2009
From: jumpjack at libero.it (jumpjack)
Date: Wed Feb 11 04:49:19 2009
Subject: [Gdal-dev] Fwd: Re[4]: gdalwarp: mercator to lambert azimutal
	equeal area
In-Reply-To: <4991F46B.9090608@ualg.pt>
References: <200902101848460287.002A6ABD@mail.libero.it>
	<200902102052110755.009B6A59@mail.libero.it>
	<4991F46B.9090608@ualg.pt>
Message-ID: <1234345757798-2307715.post@n2.nabble.com>




Joaquim Luis wrote:
> 
> 
> 
> gdalwarp EarthMap_2500x1250.jpg -s_srs +proj=latlong -t_srs +proj=laea
> EarthMap_2500x1250.jpg  dest.jpg
> 
> Which will show ... another manifestation of the gdalwarp bug
> (http://trac.osgeo.org/gdal/ticket/2305)
> when dealing with global files
> 
> Joaquim Luis
> 
> 
...so?
alternatives?


-- 
View this message in context: http://n2.nabble.com/Re-4-%3A-gdalwarp%3A-mercator-to-lambert-azimutal-equeal-area-tp2303890p2307715.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From konstantin.baumann at hpi.uni-potsdam.de  Wed Feb 11 04:54:57 2009
From: konstantin.baumann at hpi.uni-potsdam.de (Konstantin Baumann)
Date: Wed Feb 11 05:22:45 2009
Subject: [gdal-dev] Unicode support for GDAL/OGR
Message-ID: <003a01c98c2e$cc61de40$65259ac0$@baumann@hpi.uni-potsdam.de>

Hi!

 

There are two RFCs regarding the Unicode issues:

                RFC #5: http://trac.osgeo.org/gdal/wiki/rfc5_unicode

                RFC #23: http://trac.osgeo.org/gdal/wiki/rfc23_ogr_unicode

 

RFC #23 seems to be adopted for GDAL 1.6. But to me it is not that clear,
which functions/methods do:

1.       always return/accept UTF-8 strings (e.g. OGRFeature::SetField(),
OGRFeature::GetFieldAsString() (or is this also based on the capability
flag), any other functions?, what about GetFieldName()?)

2.       can return/accept UTF-8 and also Ansi-encoded strings, based on the
capabilities of the underlying driver

3.       always return/accept Ansi-encoded strings (e.g. GDALOpen()?)

 

The state of RFC #5 is "in development". What does this mean? It has been
partially implemented, or it is currently in the implemented phase in a
separate branch, to merge back the changes into the main development branch
after a successful implementation?

 

Thanks for clarification,

    Kosta

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090211/667aceb1/attachment.html
From j.l.h.hartmann at uva.nl  Wed Feb 11 07:47:16 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Wed Feb 11 07:47:30 2009
Subject: [Fwd: Re: [gdal-dev] Warping an already georeferenced image with
	control points
In-Reply-To: <498DEABC.2000705@uva.nl>
References: <498DEABC.2000705@uva.nl>
Message-ID: <4992C8D4.2070302@uva.nl>

Sorry to keep moaning about this, but I need an indication what's going 
on here. Mind, I don't need an immediate solution: for the time being I 
have a workaround. Just an idea whether this a real problem, a dumb 
question, something that can be handled in the foreseeable future (or 
not), perhaps with adequate funding. Everything is better than talking 
to a blind wall.

Sorry again Frank,

Jan

Jan Hartmann wrote:
> No, this doesn't seem to work. Although the coordinate system *is* 
> retained when I add -a_srs to the gcps, the boundaries of the input 
> file are discarded: they are reset to the pixel dimensions of the 
> file. Is this a bug?
>
> Jan
>
> Frank Warmerdam wrote:
>> Jan Hartmann wrote:
>>> Hi,
>>>
>>> I am trying to georeference old maps in two steps: first 
>>> georeferencing them from the old projection to a modern one, and 
>>> then ameliorating the georeferenced image by rubber-sheeting it on 
>>> the base of control points, mostly triangulation points for which 
>>> the coordinates in the old and new maps are known.
>>>
>>> The second step causes trouble: if I add  control points to the 
>>> georeferenced image with gdal_translate -gcp , the projection 
>>> information gets lost.
>>>
>>> Yet, AFAICS it should be possible: if I use gdaltransform -s_srs 
>>> EPSG:28992 -t_srs EPSG:28992 -gcp ... , I can use control points 
>>> with coordinates in EPSG:28992 and get a correct transformation.
>>>
>>> So: regarding this behavior  of gdal_translate, to discard 
>>> projection information when control points are added: is it a bug or 
>>> is it the expected behavior? In the last case, how can I 
>>> rubber-sheet an already georeferenced map?
>>
>> Jan,
>>
>> If you use the -a_srs switch of gdal_translate in combination with the
>> -gcp switch to add gcps, the GCPs should be recorded as being in the
>> coordinate system described by -a_srs.  Because there is no reason to
>> believe that the current image coordinate system is related to the
>> coordinate system of the GCPs, no effort is made to use the existing 
>> image
>> coordinate system as the default GCP coordinate system.
>>
>> By the way, setting GCPs with a GCP coordinate system on an image is 
>> likely
>> to not work with most GDAL supported formats, and the coordinate system
>> related aspect may also be supported in a variable fashion depending 
>> on the
>> format driver's implementation.
>>
>> Hopefully things work well with the GeoTIFF format, which I assume 
>> you have
>> been using.
>>
>> Best regards,
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From rsosnowski at cableone.net  Wed Feb 11 08:41:21 2009
From: rsosnowski at cableone.net (Tri)
Date: Wed Feb 11 08:41:22 2009
Subject: [Gdal-dev] GDAL - CSharp
Message-ID: <1234359681049-2308674.post@n2.nabble.com>


Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I keep
getting exceptions like:

OgrPINVOKE, threw an exception.


TO TRY TO GET TO WORK I DID:
- Copied the csharp dlls into project,
- Created a reference to the dlls.  

What am I doing wrong?


-- 
View this message in context: http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From bea at ixsea.com  Wed Feb 11 08:46:26 2009
From: bea at ixsea.com (=?iso-8859-1?Q?Beno=EEt_Andrieu?=)
Date: Wed Feb 11 09:06:20 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <1234359681049-2308674.post@n2.nabble.com>
References: <1234359681049-2308674.post@n2.nabble.com>
Message-ID: <1F13C084BC3243B59DC6844A5E7C3899@ixsea.local>

What is the full message of the exception ?
Did you copy all the dll of GDAL ? The C# dlls are just wrappers around the GDAL dlls.

Regards,

Beno?t Andrieu
bea@ixsea.com
benoit.andrieu@gmail.com


----- Original Message ----- 
From: "Tri" <rsosnowski@cableone.net>
To: <gdal-dev@lists.osgeo.org>
Sent: Wednesday, February 11, 2009 2:41 PM
Subject: [Gdal-dev] GDAL - CSharp


>
> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I keep
> getting exceptions like:
>
> OgrPINVOKE, threw an exception.
>
>
> TO TRY TO GET TO WORK I DID:
> - Copied the csharp dlls into project,
> - Created a reference to the dlls.
>
> What am I doing wrong?
>
>
> -- 
> View this message in context: http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev 

From szekerest at gmail.com  Wed Feb 11 09:19:35 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Feb 11 09:19:37 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <1234359681049-2308674.post@n2.nabble.com>
References: <1234359681049-2308674.post@n2.nabble.com>
Message-ID: <f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>

Hi,

You might have to copy all of the dll-s (*_csharp.dll, *_wrap.dll,
gdal16.dll, proj.dll etc.) to the application executing directory.

Best regards,

Tamas



2009/2/11 Tri <rsosnowski@cableone.net>

>
> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I keep
> getting exceptions like:
>
> OgrPINVOKE, threw an exception.
>
>
> TO TRY TO GET TO WORK I DID:
> - Copied the csharp dlls into project,
> - Created a reference to the dlls.
>
> What am I doing wrong?
>
>
> --
> View this message in context:
> http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090211/2c7400d1/attachment.html
From jukka.rahkonen at mmmtike.fi  Wed Feb 11 09:59:48 2009
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed Feb 11 09:59:57 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with	control points
References: <498DEABC.2000705@uva.nl> <4992C8D4.2070302@uva.nl>
Message-ID: <loom.20090211T142751-676@post.gmane.org>

Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:

> 
> Sorry to keep moaning about this, but I need an indication what's going 
> on here. Mind, I don't need an immediate solution: for the time being I 
> have a workaround. Just an idea whether this a real problem, a dumb 
> question, something that can be handled in the foreseeable future (or 
> not), perhaps with adequate funding. Everything is better than talking 
> to a blind wall.
> 
> Sorry again Frank,
> 
> Jan

Hi, 

I think that your need to keep the original extents but add more ground control
points inside the image frame is rather uncommon. Doesn't it mean that you trust
that the image corners are correctly warped to a new projection, but there are
local distortions in the middle of image which should be corrected with a few
extra ground control points? For my mind it shoudn't be the default behaviour of
gdal but it might be usable as an user selectable option sometimes.

I know that missing gcp's at the image corners often leads to very odd result
with polynomial warping because the formula shoots over.  Even unaccurately
placed gcp's could help a lot in preserving the original shape of the map. I
guess that you are perhaps playing with scanned historical maps?  I have a few
old scanned parcel maps which are covering just the area of the farm, and two of
the map corners are just white background. It is impossible to measure any real
ground control points from the corners because there is nothing on the map to
compare with, and warping with all gcp's on the middle area makes really funny
looking curves into the hand drawn rectangle framing the original map.

-Jukka-

From Matthew.Cole at drdc-rddc.gc.ca  Wed Feb 11 11:10:53 2009
From: Matthew.Cole at drdc-rddc.gc.ca (Matthew Cole)
Date: Wed Feb 11 11:10:55 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <200902092308.48871.even.rouault@mines-paris.org>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
Message-ID: <1234368653400-2309579.post@n2.nabble.com>


Thanks Evan.  It turned out the problem had to do with including HDF4 and
HDF5 support.  Once I removed those the binding worked.

I had used the instructions at
http://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructions and will
update them for the newer program versions.

Matt


Even Rouault wrote:
> 
> Yes, I've managed to build them, but with Linux. Have you verified that
> the 
> gdal.jar is generated and at the right place ?
> There are instructions here : 
> http://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructions
> 
> It would be great if you could update the wiki page in case something has 
> really change in the build process since that page was written.
> 
> You should also be warned that due to missing SWIG typemaps, quite a few 
> methods in 1.6 bindings have wrong signature, which will hopefully be
> fixed 
> in the future in 1.7dev once I've commited the code.
> 
> Le Monday 09 February 2009 22:48:11 Matthew Cole, vous avez ?crit?:
>> I've created java bindings for GDAL 1.6 in Windows and it seemed to work
>> but I'm getting linker errors whenever I try to access any gdal
>> functions.
>>
>> java.lang.UnsatisfiedLinkError:
>> C:\build182\gdal-1.6.0\swig\java\apps\gdaljni.dl
>> l: Can't find dependent libraries
>> Exception in thread "main" java.lang.UnsatisfiedLinkError:
>> org.gdal.gdal.gdalJNI.AllRegister()V
>>         at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
>>         at org.gdal.gdal.gdal.AllRegister(gdal.java:255)
>>         at R2gcpinfo.R2ExtractFootprint(R2gcpinfo.java:100)
>>         at R2gcpinfo.main(R2gcpinfo.java:78)
>>
>> I've got it working for version 1.4, with the dlls in the same places, so
>> I'm not sure what the problem is.  II don't think the java binding are
>> officially supported for 1.6 but has anyone gottem them working?
>>
>> Thanks for your help,
>> Matt
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2309579.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Wed Feb 11 13:39:18 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Feb 11 13:39:29 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <1234368653400-2309579.post@n2.nabble.com>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
	<1234368653400-2309579.post@n2.nabble.com>
Message-ID: <200902111939.19537.even.rouault@mines-paris.org>

Matthew,

For the record, I just commited yesterday in GDAL SVN trunk a substantial 
update to the java bindings I was mentionning. Now all necessary typemaps 
have been created, so it looks rather good (no more SWIGTYPE_p_* classes). I 
would be interested in having early feedback from people already using the 
Java bindings to check if I haven't broken existing API. It shouldn't 
hopefully (at least the 2 test applications still run against the bindings). 
It also adds methods with default argument values, for example 
ogr.Open(String filename) in addition to the full ogr.Open(String filename, 
int update). Some facilities that look more java'ish have been added, like 
String Geometry.ExportToWkt(), in addition to the existing int 
Geometry.ExportToWkt(String[] argout), etc. A previous commit already added 
support for progress callbacks in GDAL API.

Best  regards

Le Wednesday 11 February 2009 17:10:53 Matthew Cole, vous avez ?crit?:
> Thanks Evan.  It turned out the problem had to do with including HDF4 and
> HDF5 support.  Once I removed those the binding worked.
>
> I had used the instructions at
> http://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructions and will
> update them for the newer program versions.
>
> Matt
>
> Even Rouault wrote:
> > Yes, I've managed to build them, but with Linux. Have you verified that
> > the
> > gdal.jar is generated and at the right place ?
> > There are instructions here :
> > http://trac.osgeo.org/gdal/wiki/GdalOgrInJavaBuildInstructions
> >
> > It would be great if you could update the wiki page in case something has
> > really change in the build process since that page was written.
> >
> > You should also be warned that due to missing SWIG typemaps, quite a few
> > methods in 1.6 bindings have wrong signature, which will hopefully be
> > fixed
> > in the future in 1.7dev once I've commited the code.
> >
> > Le Monday 09 February 2009 22:48:11 Matthew Cole, vous avez ?crit?:
> >> I've created java bindings for GDAL 1.6 in Windows and it seemed to work
> >> but I'm getting linker errors whenever I try to access any gdal
> >> functions.
> >>
> >> java.lang.UnsatisfiedLinkError:
> >> C:\build182\gdal-1.6.0\swig\java\apps\gdaljni.dl
> >> l: Can't find dependent libraries
> >> Exception in thread "main" java.lang.UnsatisfiedLinkError:
> >> org.gdal.gdal.gdalJNI.AllRegister()V
> >>         at org.gdal.gdal.gdalJNI.AllRegister(Native Method)
> >>         at org.gdal.gdal.gdal.AllRegister(gdal.java:255)
> >>         at R2gcpinfo.R2ExtractFootprint(R2gcpinfo.java:100)
> >>         at R2gcpinfo.main(R2gcpinfo.java:78)
> >>
> >> I've got it working for version 1.4, with the dlls in the same places,
> >> so I'm not sure what the problem is.  II don't think the java binding
> >> are officially supported for 1.6 but has anyone gottem them working?
> >>
> >> Thanks for your help,
> >> Matt
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Wed Feb 11 16:43:02 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Feb 11 16:43:14 2009
Subject: [gdal-dev] Unicode support for GDAL/OGR
In-Reply-To: <003a01c98c2e$cc61de40$65259ac0$@baumann@hpi.uni-potsdam.de>
References: <003a01c98c2e$cc61de40$65259ac0$@baumann@hpi.uni-potsdam.de>
Message-ID: <200902112243.04187.even.rouault@mines-paris.org>

Konstantin,

My understanding of the current state of GDAL 1.6.0 regarding those 2 RFCs 
is :

- RFC #5 has never been implemented, not even proposed to vote. The meaning of 
the terms 'development', 'adopted', etc is given at the bottom of the RfcList 
page

- RFC #23 has been implemented, at least partially. I can see that the 
CPLRecode API is implemented, the OLCStringsAsUTF8 capability as well. The 
GML driver is using the CPLRecode API. The GML and PostgreSQL both advertizes 
OLCStringsAsUTF8.
However, the shapefile driver hasn't yet received any updates regarding to 
encoding issues.

To answer your questions, RFC #23 only addresses OGR attribute values, not 
field names. It doesn't address either encoding of filenames (but RFC #5 
does). This is explained in the "Main concept" paragraph of RFC #23.

To sum up what RFC #5 says, I would say : "drivers should make all possible 
efforts to return strings attributes as UTF-8. When they are sure they do it, 
they can advertize OLCStringsAsUTF8. All drivers can assume that string 
attributes they receive will be UTF-8". So, the core has been implemented, 
but all drivers aren't necessary ready.

Best regards,

Even

Le Wednesday 11 February 2009 10:54:57 Konstantin Baumann, vous avez ?crit?:
> Hi!
>
>
>
> There are two RFCs regarding the Unicode issues:
>
>                 RFC #5: http://trac.osgeo.org/gdal/wiki/rfc5_unicode
>
>                 RFC #23: http://trac.osgeo.org/gdal/wiki/rfc23_ogr_unicode
>
>
>
> RFC #23 seems to be adopted for GDAL 1.6. But to me it is not that clear,
> which functions/methods do:
>
> 1.       always return/accept UTF-8 strings (e.g. OGRFeature::SetField(),
> OGRFeature::GetFieldAsString() (or is this also based on the capability
> flag), any other functions?, what about GetFieldName()?)
>
> 2.       can return/accept UTF-8 and also Ansi-encoded strings, based on
> the capabilities of the underlying driver
>
> 3.       always return/accept Ansi-encoded strings (e.g. GDALOpen()?)
>
>
>
> The state of RFC #5 is "in development". What does this mean? It has been
> partially implemented, or it is currently in the implemented phase in a
> separate branch, to merge back the changes into the main development branch
> after a successful implementation?
>
>
>
> Thanks for clarification,
>
>     Kosta


From greenberg at ucdavis.edu  Wed Feb 11 16:50:18 2009
From: greenberg at ucdavis.edu (Jonathan Greenberg)
Date: Wed Feb 11 16:51:42 2009
Subject: [gdal-dev] Open source GIS cataloging software?
Message-ID: <4993481A.3030808@ucdavis.edu>

Sorry for the cross-posting.  I was wondering if anyone has a unix (preferably) or windows program that can spider a directory, recursively searching for raster and vector data, and create bounding box polygons for each raster/vector it finds, with attributes indicating the path-to-file.

-- 

Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307, MSN: jgrn307@hotmail.com, Gchat: jgrn307 

From even.rouault at mines-paris.org  Wed Feb 11 17:15:57 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Feb 11 17:16:09 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	=?iso-8859-1?q?with=09control?= points
In-Reply-To: <loom.20090211T142751-676@post.gmane.org>
References: <498DEABC.2000705@uva.nl> <4992C8D4.2070302@uva.nl>
	<loom.20090211T142751-676@post.gmane.org>
Message-ID: <200902112315.58951.even.rouault@mines-paris.org>

Jan,

I concur with Jukka's analysis. Your need is rather uncommon, and I also 
thinks it shouldn't be a default behaviour. However, adding that capability 
to gdal_translate is quite easy. I've attached a patch for gdal_translate.cpp 
that adds the capability of adding the 4 corners as 4 additional GCPs with 
the "-add_corners_as_gcps" option. You might give it at try (it applies 
cleanly on GDAL 1.6.0 and trunk). I'm not sure yet if it is valuable enough 
to include it in baseline gdal_translate.cpp.

Best regards

Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez ?crit?:
> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
> > Sorry to keep moaning about this, but I need an indication what's going
> > on here. Mind, I don't need an immediate solution: for the time being I
> > have a workaround. Just an idea whether this a real problem, a dumb
> > question, something that can be handled in the foreseeable future (or
> > not), perhaps with adequate funding. Everything is better than talking
> > to a blind wall.
> >
> > Sorry again Frank,
> >
> > Jan
>
> Hi,
>
> I think that your need to keep the original extents but add more ground
> control points inside the image frame is rather uncommon. Doesn't it mean
> that you trust that the image corners are correctly warped to a new
> projection, but there are local distortions in the middle of image which
> should be corrected with a few extra ground control points? For my mind it
> shoudn't be the default behaviour of gdal but it might be usable as an user
> selectable option sometimes.
>
> I know that missing gcp's at the image corners often leads to very odd
> result with polynomial warping because the formula shoots over.  Even
> unaccurately placed gcp's could help a lot in preserving the original shape
> of the map. I guess that you are perhaps playing with scanned historical
> maps?  I have a few old scanned parcel maps which are covering just the
> area of the farm, and two of the map corners are just white background. It
> is impossible to measure any real ground control points from the corners
> because there is nothing on the map to compare with, and warping with all
> gcp's on the middle area makes really funny looking curves into the hand
> drawn rectangle framing the original map.
>
> -Jukka-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_translate_add_corners_as_gcps.patch
Type: text/x-diff
Size: 4249 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090211/cdf3c435/gdal_translate_add_corners_as_gcps.bin
From even.rouault at mines-paris.org  Wed Feb 11 17:22:10 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Feb 11 17:22:20 2009
Subject: [gdal-dev] Open source GIS cataloging software?
In-Reply-To: <4993481A.3030808@ucdavis.edu>
References: <4993481A.3030808@ucdavis.edu>
Message-ID: <200902112322.11140.even.rouault@mines-paris.org>

Jonathan,

Provided that you have some basic scripting/coding abilities, GDAL/OGR would 
certainly be able to solve your need. Python might be a good choice, as you 
can use the GDAL/OGR bindings. Or just use the C API.

For retrieving the boundings boxes:
Key API for raster part : gdal.Open(), Dataset.GetGeoTransform()
Key API for vector part : ogr.Open(), DataSource.GetLayer(), Layer.GetExtent()

OGR can also be used to create the output file.

The tutorials on gdal.org and gdal.org/ogr should be good starting points.

Le Wednesday 11 February 2009 22:50:18 Jonathan Greenberg, vous avez ?crit?:
> Sorry for the cross-posting.  I was wondering if anyone has a unix
> (preferably) or windows program that can spider a directory, recursively
> searching for raster and vector data, and create bounding box polygons for
> each raster/vector it finds, with attributes indicating the path-to-file.


From Tom.Kralidis at ec.gc.ca  Wed Feb 11 17:33:07 2009
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Ontario])
Date: Wed Feb 11 17:33:25 2009
Subject: [gdal-dev] Open source GIS cataloging software?
References: <4993481A.3030808@ucdavis.edu>
Message-ID: <DDA8F0C2655CB14DA8C7B84CDC6759A61824AE0C@dowexch2>


Here's a post which may help: http://spatialguru.com/code/xml_catalogue_format

..Tom



-----Original Message-----
From: gdal-dev-bounces@lists.osgeo.org on behalf of Jonathan Greenberg
Sent: Wed 11-Feb-09 16:50
To: gdal-dev@lists.osgeo.org
Subject: [gdal-dev] Open source GIS cataloging software?
 
Sorry for the cross-posting.  I was wondering if anyone has a unix (preferably) or windows program that can spider a directory, recursively searching for raster and vector data, and create bounding box polygons for each raster/vector it finds, with attributes indicating the path-to-file.

-- 

Jonathan A. Greenberg, PhD
Postdoctoral Scholar
Center for Spatial Technologies and Remote Sensing (CSTARS)
University of California, Davis
One Shields Avenue
The Barn, Room 250N
Davis, CA 95616
Cell: 415-794-5043
AIM: jgrn307, MSN: jgrn307@hotmail.com, Gchat: jgrn307 

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From emiliomayorga at gmail.com  Wed Feb 11 17:41:16 2009
From: emiliomayorga at gmail.com (Emilio Mayorga)
Date: Wed Feb 11 17:41:19 2009
Subject: [gdal-dev] Open source GIS cataloging software?
In-Reply-To: <DDA8F0C2655CB14DA8C7B84CDC6759A61824AE0C@dowexch2>
References: <4993481A.3030808@ucdavis.edu>
	<DDA8F0C2655CB14DA8C7B84CDC6759A61824AE0C@dowexch2>
Message-ID: <b0d146420902111441saa31499o2d39da5c08ee456d@mail.gmail.com>

Tyler Mitchell had a follow-up post to that original post, that's also
very relevant:
http://spatialguru.com/ideas/data_cataloguing_background

And there were some related discussions last May in the GeoNetwork list:
http://n2.nabble.com/SMET-(Spatial-Metadata-Extraction-Tool)-td2020014.html

But those may be going off in a different direction. Cheers,

-Emilio Mayorga


On Wed, Feb 11, 2009 at 2:33 PM, Kralidis,Tom [Ontario]
<Tom.Kralidis@ec.gc.ca> wrote:
>
> Here's a post which may help: http://spatialguru.com/code/xml_catalogue_format
>
> ..Tom
>
>
>
> -----Original Message-----
> From: gdal-dev-bounces@lists.osgeo.org on behalf of Jonathan Greenberg
> Sent: Wed 11-Feb-09 16:50
> To: gdal-dev@lists.osgeo.org
> Subject: [gdal-dev] Open source GIS cataloging software?
>
> Sorry for the cross-posting.  I was wondering if anyone has a unix (preferably) or windows program that can spider a directory, recursively searching for raster and vector data, and create bounding box polygons for each raster/vector it finds, with attributes indicating the path-to-file.
>
> --
>
> Jonathan A. Greenberg, PhD
> Postdoctoral Scholar
> Center for Spatial Technologies and Remote Sensing (CSTARS)
> University of California, Davis
> One Shields Avenue
> The Barn, Room 250N
> Davis, CA 95616
> Cell: 415-794-5043
> AIM: jgrn307, MSN: jgrn307@hotmail.com, Gchat: jgrn307
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From rsosnowski at cableone.net  Wed Feb 11 18:06:24 2009
From: rsosnowski at cableone.net (Tri)
Date: Wed Feb 11 18:06:25 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>
References: <1234359681049-2308674.post@n2.nabble.com>
	<f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>
Message-ID: <1234393584390-2312047.post@n2.nabble.com>


Hi Tamas and others - thanks for the help.

By application executing directory - I've copied the files to both the bin
directory under the project and the obj, Debug directory under the project. 
When I run the application in debug mode, the same problem occurs:

System.TypeInitializationException:   The type initializer for OSGeo.OGR.Ogr
threw an exception

InnerException:   The type initializer for OSGeo.OGR.OgrPINVOKE threw an
excpetion

I am using the 64 bit compiled code from you on Vista 64 bit machine.  

Any more ideas?  Thanks.....



Tamas Szekeres wrote:
> 
> Hi,
> 
> You might have to copy all of the dll-s (*_csharp.dll, *_wrap.dll,
> gdal16.dll, proj.dll etc.) to the application executing directory.
> 
> Best regards,
> 
> Tamas
> 
> 
> 
> 2009/2/11 Tri <rsosnowski@cableone.net>
> 
>>
>> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I keep
>> getting exceptions like:
>>
>> OgrPINVOKE, threw an exception.
>>
>>
>> TO TRY TO GET TO WORK I DID:
>> - Copied the csharp dlls into project,
>> - Created a reference to the dlls.
>>
>> What am I doing wrong?
>>
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/GDAL---CSharp-tp2308674p2312047.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Wed Feb 11 18:15:11 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Feb 11 18:15:13 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <1234393584390-2312047.post@n2.nabble.com>
References: <1234359681049-2308674.post@n2.nabble.com>
	<f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>
	<1234393584390-2312047.post@n2.nabble.com>
Message-ID: <f3b73b7d0902111515k1891120u11b44bf518d0161c@mail.gmail.com>

What kind of application you develop  Console/WinForms/ASP.NET ?
Wouldn't it be sufficient to use 32 bit binaries and compile your app with
the /platform:x86 option?

Best regards,

Tamas




2009/2/12 Tri <rsosnowski@cableone.net>

>
> Hi Tamas and others - thanks for the help.
>
> By application executing directory - I've copied the files to both the bin
> directory under the project and the obj, Debug directory under the project.
> When I run the application in debug mode, the same problem occurs:
>
> System.TypeInitializationException:   The type initializer for
> OSGeo.OGR.Ogr
> threw an exception
>
> InnerException:   The type initializer for OSGeo.OGR.OgrPINVOKE threw an
> excpetion
>
> I am using the 64 bit compiled code from you on Vista 64 bit machine.
>
> Any more ideas?  Thanks.....
>
>
>
> Tamas Szekeres wrote:
> >
> > Hi,
> >
> > You might have to copy all of the dll-s (*_csharp.dll, *_wrap.dll,
> > gdal16.dll, proj.dll etc.) to the application executing directory.
> >
> > Best regards,
> >
> > Tamas
> >
> >
> >
> > 2009/2/11 Tri <rsosnowski@cableone.net>
> >
> >>
> >> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I keep
> >> getting exceptions like:
> >>
> >> OgrPINVOKE, threw an exception.
> >>
> >>
> >> TO TRY TO GET TO WORK I DID:
> >> - Copied the csharp dlls into project,
> >> - Created a reference to the dlls.
> >>
> >> What am I doing wrong?
> >>
> >>
> >> --
> >> View this message in context:
> >> http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
> --
> View this message in context:
> http://n2.nabble.com/GDAL---CSharp-tp2308674p2312047.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090212/6c6f1efc/attachment.html
From rsosnowski at cableone.net  Wed Feb 11 18:21:26 2009
From: rsosnowski at cableone.net (Tri)
Date: Wed Feb 11 18:21:27 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <f3b73b7d0902111515k1891120u11b44bf518d0161c@mail.gmail.com>
References: <1234359681049-2308674.post@n2.nabble.com>
	<f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>
	<1234393584390-2312047.post@n2.nabble.com>
	<f3b73b7d0902111515k1891120u11b44bf518d0161c@mail.gmail.com>
Message-ID: <1234394486389-2312090.post@n2.nabble.com>


Tamas,

I'm creating web services.  This is first go on 64 bit machine - plenty of
32 bit web services to fall back on.  The problem is I was using FDO which
as far as I know has only 32 bit compiled code.  So I set the 'Enable 32 Bit
Application' to true, published the application, then tried to run from
localhost.  There were no problems with 64 bit, 32 bit conflicts this way. 
However, I then started getting an error that says:

System.IO file not found.   I'm not using System.IO file in the web service.

So, I thought I would use your compiled 64 bit GDAL / OGR code to create a
new web service, but running into previously mentioned problem taking this
approach.

Thanks again.....






Tamas Szekeres wrote:
> 
> What kind of application you develop  Console/WinForms/ASP.NET ?
> Wouldn't it be sufficient to use 32 bit binaries and compile your app with
> the /platform:x86 option?
> 
> Best regards,
> 
> Tamas
> 
> 
> 
> 
> 2009/2/12 Tri <rsosnowski@cableone.net>
> 
>>
>> Hi Tamas and others - thanks for the help.
>>
>> By application executing directory - I've copied the files to both the
>> bin
>> directory under the project and the obj, Debug directory under the
>> project.
>> When I run the application in debug mode, the same problem occurs:
>>
>> System.TypeInitializationException:   The type initializer for
>> OSGeo.OGR.Ogr
>> threw an exception
>>
>> InnerException:   The type initializer for OSGeo.OGR.OgrPINVOKE threw an
>> excpetion
>>
>> I am using the 64 bit compiled code from you on Vista 64 bit machine.
>>
>> Any more ideas?  Thanks.....
>>
>>
>>
>> Tamas Szekeres wrote:
>> >
>> > Hi,
>> >
>> > You might have to copy all of the dll-s (*_csharp.dll, *_wrap.dll,
>> > gdal16.dll, proj.dll etc.) to the application executing directory.
>> >
>> > Best regards,
>> >
>> > Tamas
>> >
>> >
>> >
>> > 2009/2/11 Tri <rsosnowski@cableone.net>
>> >
>> >>
>> >> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I
>> keep
>> >> getting exceptions like:
>> >>
>> >> OgrPINVOKE, threw an exception.
>> >>
>> >>
>> >> TO TRY TO GET TO WORK I DID:
>> >> - Copied the csharp dlls into project,
>> >> - Created a reference to the dlls.
>> >>
>> >> What am I doing wrong?
>> >>
>> >>
>> >> --
>> >> View this message in context:
>> >> http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
>> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> >>
>> >> _______________________________________________
>> >> gdal-dev mailing list
>> >> gdal-dev@lists.osgeo.org
>> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev@lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/GDAL---CSharp-tp2308674p2312047.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
View this message in context: http://n2.nabble.com/GDAL---CSharp-tp2308674p2312090.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From szekerest at gmail.com  Wed Feb 11 18:38:17 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Feb 11 18:43:58 2009
Subject: [Gdal-dev] GDAL - CSharp
In-Reply-To: <1234394486389-2312090.post@n2.nabble.com>
References: <1234359681049-2308674.post@n2.nabble.com>
	<f3b73b7d0902110619g6002a186sa391a6faf9d5b123@mail.gmail.com>
	<1234393584390-2312047.post@n2.nabble.com>
	<f3b73b7d0902111515k1891120u11b44bf518d0161c@mail.gmail.com>
	<1234394486389-2312090.post@n2.nabble.com>
Message-ID: <f3b73b7d0902111538r78768b0cq23d886a2a5746ace@mail.gmail.com>

You should provide further info about your environment:

1. Did you test your app by running from an IDE like VS2005 for example?
2. What version of OS/IIS you intend to use when deploying the application.

You appdir and platform configuration (32/64) may be different depending on
your environment.
For example by using the VS IDE you'd probably use WebDev.WebServer.exe as
the host process which is running against the 32 bit version of the .NET
framework on a 64 bit machine.

You might want to use SysInternals ProcMon.exe to make sure about the
expected locations of the dll files.

Best regards,

Tamas




2009/2/12 Tri <rsosnowski@cableone.net>

>
> Tamas,
>
> I'm creating web services.  This is first go on 64 bit machine - plenty of
> 32 bit web services to fall back on.  The problem is I was using FDO which
> as far as I know has only 32 bit compiled code.  So I set the 'Enable 32
> Bit
> Application' to true, published the application, then tried to run from
> localhost.  There were no problems with 64 bit, 32 bit conflicts this way.
> However, I then started getting an error that says:
>
> System.IO file not found.   I'm not using System.IO file in the web
> service.
>
> So, I thought I would use your compiled 64 bit GDAL / OGR code to create a
> new web service, but running into previously mentioned problem taking this
> approach.
>
> Thanks again.....
>
>
>
>
>
>
> Tamas Szekeres wrote:
> >
> > What kind of application you develop  Console/WinForms/ASP.NET ?
> > Wouldn't it be sufficient to use 32 bit binaries and compile your app
> with
> > the /platform:x86 option?
> >
> > Best regards,
> >
> > Tamas
> >
> >
> >
> >
> > 2009/2/12 Tri <rsosnowski@cableone.net>
> >
> >>
> >> Hi Tamas and others - thanks for the help.
> >>
> >> By application executing directory - I've copied the files to both the
> >> bin
> >> directory under the project and the obj, Debug directory under the
> >> project.
> >> When I run the application in debug mode, the same problem occurs:
> >>
> >> System.TypeInitializationException:   The type initializer for
> >> OSGeo.OGR.Ogr
> >> threw an exception
> >>
> >> InnerException:   The type initializer for OSGeo.OGR.OgrPINVOKE threw an
> >> excpetion
> >>
> >> I am using the 64 bit compiled code from you on Vista 64 bit machine.
> >>
> >> Any more ideas?  Thanks.....
> >>
> >>
> >>
> >> Tamas Szekeres wrote:
> >> >
> >> > Hi,
> >> >
> >> > You might have to copy all of the dll-s (*_csharp.dll, *_wrap.dll,
> >> > gdal16.dll, proj.dll etc.) to the application executing directory.
> >> >
> >> > Best regards,
> >> >
> >> > Tamas
> >> >
> >> >
> >> >
> >> > 2009/2/11 Tri <rsosnowski@cableone.net>
> >> >
> >> >>
> >> >> Can't get GDAL / OGR to work with CSharp.  Using the CSharp dlls, I
> >> keep
> >> >> getting exceptions like:
> >> >>
> >> >> OgrPINVOKE, threw an exception.
> >> >>
> >> >>
> >> >> TO TRY TO GET TO WORK I DID:
> >> >> - Copied the csharp dlls into project,
> >> >> - Created a reference to the dlls.
> >> >>
> >> >> What am I doing wrong?
> >> >>
> >> >>
> >> >> --
> >> >> View this message in context:
> >> >> http://n2.nabble.com/GDAL---CSharp-tp2308674p2308674.html
> >> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >> >>
> >> >> _______________________________________________
> >> >> gdal-dev mailing list
> >> >> gdal-dev@lists.osgeo.org
> >> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> >>
> >> >
> >> > _______________________________________________
> >> > gdal-dev mailing list
> >> > gdal-dev@lists.osgeo.org
> >> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> >
> >>
> >> --
> >> View this message in context:
> >> http://n2.nabble.com/GDAL---CSharp-tp2308674p2312047.html
> >> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
> --
> View this message in context:
> http://n2.nabble.com/GDAL---CSharp-tp2308674p2312090.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090212/451177bf/attachment-0001.html
From yann.chemin at gmail.com  Thu Feb 12 02:46:19 2009
From: yann.chemin at gmail.com (Yann Chemin)
Date: Thu Feb 12 02:53:07 2009
Subject: [gdal-dev] Re: satellite image processing in Python
In-Reply-To: <4f37eb890902101738o2a842452wfe31973282557442@mail.gmail.com>
References: <4f37eb890902101738o2a842452wfe31973282557442@mail.gmail.com>
Message-ID: <4f37eb890902112346q3758eabbi6280cd82e9970977@mail.gmail.com>

Hello,

Found out answer to question 1 it seems.

By naming the object for each action, then deleting it at the end of
the loop, it seems that the file is being written properly.

	geot=result.SetGeoTransform( geoT )
	proj=result.SetProjection( proJ )
	output=driver.CreateCopy(output_filename, result)
        del output, geot, proj

still loading the created file makes a segfault in ReadArray it seems.
I am using 1.5.2 for Lenny. Maybe should try 1.6

Yann
----------------------------------------------------------------
for i in range (0,6):
	tmp = gdal.Open(F[i])
	btmp = tmp.GetRasterBand(1)
	b = BandReadAsArray(btmp,0,0,tmp.RasterXSize,tmp.RasterYSize)
	result = (b * ((LMax[i]-Lmin[i])/255.0) + Lmin[i]) / (constant * KEXO[i])
	if i != 5:
		output_filename='b'+str(i+1)+'_ref'
	else:
		output_filename='b'+str(i+2)+'_ref'
	#Create output file with projection
	result = OpenArray(result)
	geot=result.SetGeoTransform( geoT )
	proj=result.SetProjection( proJ )
	output=driver.CreateCopy(output_filename, result)
	#Empty memory objects
	del result, b, tmp, btmp, output, geot, proj
-------------------------

2009/2/11 Yann Chemin <yann.chemin@gmail.com>:
> Hello,
>
> Would need a small help to troubleshoot this small code:
>
> 1 - When the for loop is over, the last file is not completely closed
> (~480Mb instead of 509Mb)
> Is there a way to force it to close? (opening another file forces the
> previous file to be closed with a proper"?" 509Mb)
>
> 2 -  A segmentation fault is crashing Python when using LoadFile() on
> any one of the files generated in the loop.
>
> Thank you,
> Yann
>
> -------------------------------------------------------------------------------------
>
> # Landsat 7 ETM + image downlaoded from GLCF
> #ftp.glcf.umiacs.umd.edu/glcf/Landsat/WRS2/p127/r049/p127r049_7x20001104.ETM-EarthSat-Orthorectified/
> #p127r049 2000/11/04 around Ubon Ratchathani, North East Thailand.
> # Metadata in the text file: p127r049_7x20001104.met
>
> #Purpose: Calculate NDVI and Albedo
> #Usage: /usr/bin/python -u "ndvi_albedo.py"
>
> #if problem of libgrass: MAPSET is not set
> #then: set GDAL_SKIP = GRASS
>
> F=[]
> F.append('p116r049_7t20010518_z51_nn10.tif')
> F.append('p116r049_7t20010518_z51_nn20.tif')
> F.append('p116r049_7t20010518_z51_nn30.tif')
> F.append('p116r049_7t20010518_z51_nn40.tif')
> F.append('p116r049_7t20010518_z51_nn50.tif')
> F.append('p116r049_7t20010518_z51_nn70.tif')
>
> # For Image Processing
> from math import *
> import numpy
> from osgeo import gdalnumeric
> from osgeo import gdal
> from osgeo.gdal_array import *
> from osgeo.gdalconst import *
>
> # Set our output file format driver
> driver = gdal.GetDriverByName( 'GTiff' )
>
> # Set our output files Projection parameters
> # from input file number 1
> tmp = gdal.Open(F[0])
> geoT = tmp.GetGeoTransform()
> proJ = tmp.GetProjection()
> del tmp
>
> #DN to radiance conversion factors
> #(Check if they are correct for your image)
> LMax = [191.6,196.5,152.9,241.1,31.060,10.8]
> Lmin = [-6.2,-6.4,-5.0,-5.1,-1.0,-0.35]
> #Exo-Atmospheric band-wise irradiance
> KEXO = [1970.0,1843.0,1555.0,1047.0,227.1,80.53]
> #Unless you use p127r049 2000/11/04, these must be changed
> sun_elevation = 51.3428710
> doy = 311
> #Cos(sun zenith angle) / (pi * (Sun-Earth distance)^2)
> constant=(cos((90-sun_elevation) * pi/180 ) / (pi * (1+0.01672 * sin
> (2 * pi * (doy - 93.5) / 365)) ** 2))
>
> #Top Of Atmosphere Reflectance
> for i in range (0,6):
>        b = LoadFile(F[i])
>        result = int(100*((b * ((LMax[i]-Lmin[i])/255.0) + Lmin[i]) /
> (constant * KEXO[i])))
>        if i != 5:
>                output_filename='b'+str(i+1)+'_ref.tif'
>        else:
>                output_filename='b'+str(i+2)+'_ref.tif'
>        #Create output file with projection
>        out = OpenArray(result)
>        out.SetGeoTransform( geoT )
>        out.SetProjection( proJ )
>        driver.CreateCopy(output_filename, out)
>        #Empty memory objects
>        del result, b, out
>
> #NDVI
> NIR = LoadFile('b4_ref.tif') <------Seg Fault here
> Red = LoadFile('b3_ref.tif')
> ndvi = (NIR-Red)/(NIR+Red)
>
>
> --
> Yann Chemin
> International Rice Research Institute
> Office: http://www.irri.org/gis
> Perso: http://www.freewebs.com/ychemin
> YiKingDo: http://yikingdo.unblog.fr/
>



-- 
Yann Chemin
International Center of Water for Food Security
Office: http://www.icwater.org
Perso: http://www.freewebs.com/ychemin
YiKingDo: http://yikingdo.unblog.fr/
From j.donovan at virtalis.com  Thu Feb 12 05:25:48 2009
From: j.donovan at virtalis.com (John Donovan)
Date: Thu Feb 12 05:25:56 2009
Subject: [gdal-dev] Vertical scaling during warping
Message-ID: <C8891C79DFCAB347B9221DF3890EDD2F195BA3@topdog.Virtalis.local>

Hi,
We have our own image format that is (among others) single-band 16-bit
unsigned height values. I've written a program to convert from the many
native GDAL formats to our format using ChunkAndWarpImage().

Everything is fine except when converting from a floating-point format.
I was expecting GDAL to do something with the scale and offset values
when warping, but it doesn't call our format's GetScale()/GetOffset()
functions at all, so consequently the fractional part of the input data
is truncated.

I'm willing to accept that my code could be at fault, so I'm open to any
and all suggestions. The only one I can think of, and I'd rather not do
it, is to tell GDAL our format is floating point, and do the scaling
manually in IWriteBlock(). But as the format can support floating point
values, it would make that code path not as clean as I would like.

Regards,
John Donovan - Programmer, Virtalis Ltd.

______________________________________________________________________
This email has been scanned for Virtalis Ltd by the MessageLabs Email Security System. ______________________________________________________________________
From warmerdam at pobox.com  Thu Feb 12 09:53:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb 12 09:54:16 2009
Subject: [gdal-dev] Vertical scaling during warping
In-Reply-To: <C8891C79DFCAB347B9221DF3890EDD2F195BA3@topdog.Virtalis.local>
References: <C8891C79DFCAB347B9221DF3890EDD2F195BA3@topdog.Virtalis.local>
Message-ID: <49943806.90009@pobox.com>

John Donovan wrote:
> Hi,
> We have our own image format that is (among others) single-band 16-bit
> unsigned height values. I've written a program to convert from the many
> native GDAL formats to our format using ChunkAndWarpImage().
> 
> Everything is fine except when converting from a floating-point format.
> I was expecting GDAL to do something with the scale and offset values
> when warping, but it doesn't call our format's GetScale()/GetOffset()
> functions at all, so consequently the fractional part of the input data
> is truncated.
> 
> I'm willing to accept that my code could be at fault, so I'm open to any
> and all suggestions. The only one I can think of, and I'd rather not do
> it, is to tell GDAL our format is floating point, and do the scaling
> manually in IWriteBlock(). But as the format can support floating point
> values, it would make that code path not as clean as I would like.

John,

It is not intended that GDAL applies or unapplies pixel value scaling
values as part of normal image IO.  The scale/offset values are provided
as metadata to application who want to more appropriately interpret
scaled values.

If you want applications to be able to treat your imagery as "real values"
rather than the scaled integers then you should represent the imagery
as floating point and apply/unapply the scaling yourself all the time
when reading and writing.

It is a very dangerous approach to apply different rules depending on
whether floating point or integer data is read/written.  I advise against it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Thu Feb 12 12:04:23 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb 12 12:04:44 2009
Subject: [gdal-dev] Generating GML from Database - Problem: No decimal
	values
In-Reply-To: <200902101022.08153.gregor.fikoczek@wheregroup.com>
References: <200902101022.08153.gregor.fikoczek@wheregroup.com>
Message-ID: <49945697.7050407@pobox.com>

Gregor Fikoczek wrote:
> 
> Hi list,
> 
> i got a problem by generating a GML-File from the Oracle- and MySQL-DB using 
> ogr2ogr, so I alway getting in MySQL/oracle instead of a float-value an 
> rounded integer-value (mostly 0) without any decimal numbers. 
...
> So is there any option i got to set or a workaround for that problem, 
> aspacialy in oracle?

Gregor,

If you can file a ticket with details on how to create a minimal test table
in mysql and/or oracle I'll have someone look at it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Thu Feb 12 13:42:26 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Feb 12 13:42:38 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <4993FE24.8060109@uva.nl>
References: <498DEABC.2000705@uva.nl>
	<200902112315.58951.even.rouault@mines-paris.org>
	<4993FE24.8060109@uva.nl>
Message-ID: <200902121942.27133.even.rouault@mines-paris.org>

Jan,

(I'm CC'ing the list)

I'm not sure what you mean with adapting the pixelsize, now that the output 
has only GCPs and no more geotransform matrix.

As far as including this option in baseline gdal_translate.cpp, I'm currently 
not really enthousiastic, as there are lots of way to get the result achieved 
(what is done with that patch could be done similarly with GDAL python API 
for instance) and the choice of corners is something rather arbitrary. Why 
should you trust the georeferenced coordinates of the corner points as 
reliable GCPs ? Why not some regularly discretized points along the edges ? 
Or a regular grid over the whole raster ? etc. etc. So, I'd prefer hearing 
from other GDAL developers or users that this patch is a sensical addition 
before commiting it.

Even

Le Thursday 12 February 2009 11:47:00, vous avez ?crit?:
> Hi Even,
>
> Thanks a lo. Just one small addition: the pixelsize has also to be
> adapted, else you get an image with false dimension. If it's not too
> much to add that, I'm going to try it out and will let you know the
> results. If it works, I have indeed a practical solution for my problem.
>
> Even so, I am not convinced that this is an uncommon problem. Consider a
> very basic GIS functionality: edge matching.  You have digitized a map
> from many sheets, and at the end the georeferenced images don't match
> precisely at the edges. Edge-matching functions (ArcGIS has lots of
> them) ensure that the edge of a feature on one map perfectly matches the
> feature edge on the adjacent map. This is exactly the kind of thing you
> can do with gdalwarp using control points on a georeferenced image. It
> is also more or less the thing I want to do with my historical maps.
> Would this be an argument to preserve the boundaries of a georeferenced
> image, when adding control points?
>
> Jan
>
> Even Rouault wrote:
> > Jan,
> >
> > I concur with Jukka's analysis. Your need is rather uncommon, and I also
> > thinks it shouldn't be a default behaviour. However, adding that
> > capability to gdal_translate is quite easy. I've attached a patch for
> > gdal_translate.cpp that adds the capability of adding the 4 corners as 4
> > additional GCPs with the "-add_corners_as_gcps" option. You might give it
> > at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure yet if
> > it is valuable enough to include it in baseline gdal_translate.cpp.
> >
> > Best regards
> >
> > Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez ?crit :
> >> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
> >>> Sorry to keep moaning about this, but I need an indication what's going
> >>> on here. Mind, I don't need an immediate solution: for the time being I
> >>> have a workaround. Just an idea whether this a real problem, a dumb
> >>> question, something that can be handled in the foreseeable future (or
> >>> not), perhaps with adequate funding. Everything is better than talking
> >>> to a blind wall.
> >>>
> >>> Sorry again Frank,
> >>>
> >>> Jan
> >>
> >> Hi,
> >>
> >> I think that your need to keep the original extents but add more ground
> >> control points inside the image frame is rather uncommon. Doesn't it
> >> mean that you trust that the image corners are correctly warped to a new
> >> projection, but there are local distortions in the middle of image which
> >> should be corrected with a few extra ground control points? For my mind
> >> it shoudn't be the default behaviour of gdal but it might be usable as
> >> an user selectable option sometimes.
> >>
> >> I know that missing gcp's at the image corners often leads to very odd
> >> result with polynomial warping because the formula shoots over.  Even
> >> unaccurately placed gcp's could help a lot in preserving the original
> >> shape of the map. I guess that you are perhaps playing with scanned
> >> historical maps?  I have a few old scanned parcel maps which are
> >> covering just the area of the farm, and two of the map corners are just
> >> white background. It is impossible to measure any real ground control
> >> points from the corners because there is nothing on the map to compare
> >> with, and warping with all gcp's on the middle area makes really funny
> >> looking curves into the hand drawn rectangle framing the original map.
> >>
> >> -Jukka-
> >>
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev@lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From bfraser at geoanalytic.com  Thu Feb 12 14:09:22 2009
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Thu Feb 12 14:09:58 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <200902121942.27133.even.rouault@mines-paris.org>
References: <498DEABC.2000705@uva.nl>	<200902112315.58951.even.rouault@mines-paris.org>	<4993FE24.8060109@uva.nl>
	<200902121942.27133.even.rouault@mines-paris.org>
Message-ID: <499473E2.1070902@geoanalytic.com>

Jan,

  I think what you want gdalwarp to do is [Delauney] image triangulation.  Not an uncommon (or unreasonable) request.  I occasionally have a need for triangulation when mosaicking several satellite images.  Its visually pleasing to have the roads match up precisely where the images overlap...

Brent Fraser

Even Rouault wrote:
> Jan,
> 
> (I'm CC'ing the list)
> 
> I'm not sure what you mean with adapting the pixelsize, now that the output 
> has only GCPs and no more geotransform matrix.
> 
> As far as including this option in baseline gdal_translate.cpp, I'm currently 
> not really enthousiastic, as there are lots of way to get the result achieved 
> (what is done with that patch could be done similarly with GDAL python API 
> for instance) and the choice of corners is something rather arbitrary. Why 
> should you trust the georeferenced coordinates of the corner points as 
> reliable GCPs ? Why not some regularly discretized points along the edges ? 
> Or a regular grid over the whole raster ? etc. etc. So, I'd prefer hearing 
> from other GDAL developers or users that this patch is a sensical addition 
> before commiting it.
> 
> Even
> 
> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
>> Hi Even,
>>
>> Thanks a lo. Just one small addition: the pixelsize has also to be
>> adapted, else you get an image with false dimension. If it's not too
>> much to add that, I'm going to try it out and will let you know the
>> results. If it works, I have indeed a practical solution for my problem.
>>
>> Even so, I am not convinced that this is an uncommon problem. Consider a
>> very basic GIS functionality: edge matching.  You have digitized a map
>> from many sheets, and at the end the georeferenced images don't match
>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
>> them) ensure that the edge of a feature on one map perfectly matches the
>> feature edge on the adjacent map. This is exactly the kind of thing you
>> can do with gdalwarp using control points on a georeferenced image. It
>> is also more or less the thing I want to do with my historical maps.
>> Would this be an argument to preserve the boundaries of a georeferenced
>> image, when adding control points?
>>
>> Jan
>>
>> Even Rouault wrote:
>>> Jan,
>>>
>>> I concur with Jukka's analysis. Your need is rather uncommon, and I also
>>> thinks it shouldn't be a default behaviour. However, adding that
>>> capability to gdal_translate is quite easy. I've attached a patch for
>>> gdal_translate.cpp that adds the capability of adding the 4 corners as 4
>>> additional GCPs with the "-add_corners_as_gcps" option. You might give it
>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure yet if
>>> it is valuable enough to include it in baseline gdal_translate.cpp.
>>>
>>> Best regards
>>>
>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez ?crit :
>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>>>>> Sorry to keep moaning about this, but I need an indication what's going
>>>>> on here. Mind, I don't need an immediate solution: for the time being I
>>>>> have a workaround. Just an idea whether this a real problem, a dumb
>>>>> question, something that can be handled in the foreseeable future (or
>>>>> not), perhaps with adequate funding. Everything is better than talking
>>>>> to a blind wall.
>>>>>
>>>>> Sorry again Frank,
>>>>>
>>>>> Jan
>>>> Hi,
>>>>
>>>> I think that your need to keep the original extents but add more ground
>>>> control points inside the image frame is rather uncommon. Doesn't it
>>>> mean that you trust that the image corners are correctly warped to a new
>>>> projection, but there are local distortions in the middle of image which
>>>> should be corrected with a few extra ground control points? For my mind
>>>> it shoudn't be the default behaviour of gdal but it might be usable as
>>>> an user selectable option sometimes.
>>>>
>>>> I know that missing gcp's at the image corners often leads to very odd
>>>> result with polynomial warping because the formula shoots over.  Even
>>>> unaccurately placed gcp's could help a lot in preserving the original
>>>> shape of the map. I guess that you are perhaps playing with scanned
>>>> historical maps?  I have a few old scanned parcel maps which are
>>>> covering just the area of the farm, and two of the map corners are just
>>>> white background. It is impossible to measure any real ground control
>>>> points from the corners because there is nothing on the map to compare
>>>> with, and warping with all gcp's on the middle area makes really funny
>>>> looking curves into the hand drawn rectangle framing the original map.
>>>>
>>>> -Jukka-
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
From j.l.h.hartmann at uva.nl  Fri Feb 13 06:29:51 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Fri Feb 13 06:30:03 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <499473E2.1070902@geoanalytic.com>
References: <498DEABC.2000705@uva.nl>	<200902112315.58951.even.rouault@mines-paris.org>	<4993FE24.8060109@uva.nl>
	<200902121942.27133.even.rouault@mines-paris.org>
	<499473E2.1070902@geoanalytic.com>
Message-ID: <499559AF.2070506@uva.nl>

Yes exactly! Brent highlights a point I never mentioned, and that may be 
the source of the confusion: when I add control points to an already 
georeferenced image, I gdalwarp it with the -tps option: a thin spline 
transformer, that transforms the control points to the exact 
georeferenced position, but stretches the areas in between. AFAIK, this 
is done by triangulation. This is different from a traditional warp, in 
which the eventual position of the control points on the georeferenced 
map has errors, although minimized ones. So in matching roads on two 
adjacent images, the road edges on both images are assigned the same 
georeferenced coordinates and then, after gdalwarp -tps, they exactly align.

So my workflow is:

gdalwarp raw image --> georeferenced image with correct projection, 
based on the corner points of the original map
gdal_translate : add control points to projected image, essentially 
small corrections of road edges and triangulation points for
                         which we know the exact coordinates from later 
sources
gdalwarp -tps georeferenced image --> georeferenced image with small 
corrections, where roads, churcht towers are on their exact locations

The whole procedure is something I do regularly with ArcGIS, not only 
with historical maps but also with things like aerial photographs, just 
like Brent describes. It can be done with gdal too, as described above, 
if only the second step would work. I still don't see why adding control 
points to an image that already has a projection defined, should destroy 
that projection information, including its georeferenced boundaries and 
dimensions. Even when this is not the case: when  a -a_srs flag is 
allowed for gdal_translate, it should be possible to add the complete 
geolocation information for that image too: bounds, pixel dimensions and 
geotranformation matrix, else the projection information doesn't make sense.

Have I made my intention a bit clearer now?

Jan

Brent Fraser wrote:
> Jan,
>
>  I think what you want gdalwarp to do is [Delauney] image 
> triangulation.  Not an uncommon (or unreasonable) request.  I 
> occasionally have a need for triangulation when mosaicking several 
> satellite images.  Its visually pleasing to have the roads match up 
> precisely where the images overlap...
>
> Brent Fraser
>
> Even Rouault wrote:
>> Jan,
>>
>> (I'm CC'ing the list)
>>
>> I'm not sure what you mean with adapting the pixelsize, now that the 
>> output has only GCPs and no more geotransform matrix.
>>
>> As far as including this option in baseline gdal_translate.cpp, I'm 
>> currently not really enthousiastic, as there are lots of way to get 
>> the result achieved (what is done with that patch could be done 
>> similarly with GDAL python API for instance) and the choice of 
>> corners is something rather arbitrary. Why should you trust the 
>> georeferenced coordinates of the corner points as reliable GCPs ? Why 
>> not some regularly discretized points along the edges ? Or a regular 
>> grid over the whole raster ? etc. etc. So, I'd prefer hearing from 
>> other GDAL developers or users that this patch is a sensical addition 
>> before commiting it.
>>
>> Even
>>
>> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
>>> Hi Even,
>>>
>>> Thanks a lo. Just one small addition: the pixelsize has also to be
>>> adapted, else you get an image with false dimension. If it's not too
>>> much to add that, I'm going to try it out and will let you know the
>>> results. If it works, I have indeed a practical solution for my 
>>> problem.
>>>
>>> Even so, I am not convinced that this is an uncommon problem. 
>>> Consider a
>>> very basic GIS functionality: edge matching.  You have digitized a map
>>> from many sheets, and at the end the georeferenced images don't match
>>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
>>> them) ensure that the edge of a feature on one map perfectly matches 
>>> the
>>> feature edge on the adjacent map. This is exactly the kind of thing you
>>> can do with gdalwarp using control points on a georeferenced image. It
>>> is also more or less the thing I want to do with my historical maps.
>>> Would this be an argument to preserve the boundaries of a georeferenced
>>> image, when adding control points?
>>>
>>> Jan
>>>
>>> Even Rouault wrote:
>>>> Jan,
>>>>
>>>> I concur with Jukka's analysis. Your need is rather uncommon, and I 
>>>> also
>>>> thinks it shouldn't be a default behaviour. However, adding that
>>>> capability to gdal_translate is quite easy. I've attached a patch for
>>>> gdal_translate.cpp that adds the capability of adding the 4 corners 
>>>> as 4
>>>> additional GCPs with the "-add_corners_as_gcps" option. You might 
>>>> give it
>>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure 
>>>> yet if
>>>> it is valuable enough to include it in baseline gdal_translate.cpp.
>>>>
>>>> Best regards
>>>>
>>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez 
>>>> ?crit :
>>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>>>>>> Sorry to keep moaning about this, but I need an indication what's 
>>>>>> going
>>>>>> on here. Mind, I don't need an immediate solution: for the time 
>>>>>> being I
>>>>>> have a workaround. Just an idea whether this a real problem, a dumb
>>>>>> question, something that can be handled in the foreseeable future 
>>>>>> (or
>>>>>> not), perhaps with adequate funding. Everything is better than 
>>>>>> talking
>>>>>> to a blind wall.
>>>>>>
>>>>>> Sorry again Frank,
>>>>>>
>>>>>> Jan
>>>>> Hi,
>>>>>
>>>>> I think that your need to keep the original extents but add more 
>>>>> ground
>>>>> control points inside the image frame is rather uncommon. Doesn't it
>>>>> mean that you trust that the image corners are correctly warped to 
>>>>> a new
>>>>> projection, but there are local distortions in the middle of image 
>>>>> which
>>>>> should be corrected with a few extra ground control points? For my 
>>>>> mind
>>>>> it shoudn't be the default behaviour of gdal but it might be 
>>>>> usable as
>>>>> an user selectable option sometimes.
>>>>>
>>>>> I know that missing gcp's at the image corners often leads to very 
>>>>> odd
>>>>> result with polynomial warping because the formula shoots over.  Even
>>>>> unaccurately placed gcp's could help a lot in preserving the original
>>>>> shape of the map. I guess that you are perhaps playing with scanned
>>>>> historical maps?  I have a few old scanned parcel maps which are
>>>>> covering just the area of the farm, and two of the map corners are 
>>>>> just
>>>>> white background. It is impossible to measure any real ground control
>>>>> points from the corners because there is nothing on the map to 
>>>>> compare
>>>>> with, and warping with all gcp's on the middle area makes really 
>>>>> funny
>>>>> looking curves into the hand drawn rectangle framing the original 
>>>>> map.
>>>>>
>>>>> -Jukka-
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
From bfraser at geoanalytic.com  Fri Feb 13 12:52:29 2009
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Fri Feb 13 12:53:01 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <499559AF.2070506@uva.nl>
References: <498DEABC.2000705@uva.nl>	<200902112315.58951.even.rouault@mines-paris.org>	<4993FE24.8060109@uva.nl>
	<200902121942.27133.even.rouault@mines-paris.org>
	<499473E2.1070902@geoanalytic.com> <499559AF.2070506@uva.nl>
Message-ID: <4995B35D.3010500@geoanalytic.com>

Jan,

I stepped through your procedure with a Canadian topo map to slightly adjust its positioning, using GDAL 1.6.0:

1. Warp raster image of topo map to a projected coordinate system
No Need.  Canadian topos already are georeferenced so I simply downloaded http://ftp2.cits.rncan.gc.ca/pub/canmatrix/50k_300dpi/082/h/canmatrix_082h04_tif.zip
 
2. Attach my new GCPs to the original topo map:
gdal_translate --optfile gcps.opt -a_srs "EPSG:26912" 082h04_1_1.tif 082h04_gcps.tif
	(the GCPs are in UTM zone 12, as indicated by the -a_srs parameter)

3. Warp/resample image using GCPs
gdalwarp -tps 082h04_gcps.tif 082h04_warped.tif

4. Examine SRS of output image:
gdalinfo  082h04_warped.tif

Driver: GTiff/GeoTIFF
Files: 082h04_warped.tif
Size is 11786, 8881
Coordinate System is:
PROJCS["NAD83 / UTM zone 12N",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-111],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","26912"]]
Origin = (275804.277072605620000,5462603.410837069200000)
Pixel Size = (4.233604626074191,-4.233604626074191)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  275804.277, 5462603.411) (114d 4'56.70"W, 49d16'30.13"N)
Lower Left  (  275804.277, 5425004.768) (114d 3'41.57"W, 48d56'14.30"N)
Upper Right (  325701.541, 5462603.411) (113d23'49.60"W, 49d17'28.67"N)
Lower Right (  325701.541, 5425004.768) (113d22'51.13"W, 48d57'12.15"N)
Center      (  300752.909, 5443804.089) (113d43'49.87"W, 49d 6'53.14"N)
Band 1 Block=11786x1 Type=Byte, ColorInterp=Palette
  Color Table (RGB with 256 entries)


The result of step 2 (gdal_translate) DOES remove the image's original georeferencing.  Actually, it replaces it with a set of GCPs (and their SRS).  To leave the original would resulting in two sets of conflicting georeferencing information.  

And to me it doesn't matter anyway, as that "GCP-ed" image is just temporary.  After the gdalwarp step I get an image with more traditional/well-supported georeferencing, I can delete it.

Should gdalinfo (and possibly other programs) use the GCPs to calculate the image extents?  Maybe.  I'd find it useful as a quality-control check to make sure I didn't mis-code a GCP resulting in a huge raster after warping.  Do you have another reason?

Brent


Jan Hartmann wrote:
> Yes exactly! Brent highlights a point I never mentioned, and that may be 
> the source of the confusion: when I add control points to an already 
> georeferenced image, I gdalwarp it with the -tps option: a thin spline 
> transformer, that transforms the control points to the exact 
> georeferenced position, but stretches the areas in between. AFAIK, this 
> is done by triangulation. This is different from a traditional warp, in 
> which the eventual position of the control points on the georeferenced 
> map has errors, although minimized ones. So in matching roads on two 
> adjacent images, the road edges on both images are assigned the same 
> georeferenced coordinates and then, after gdalwarp -tps, they exactly 
> align.
> 
> So my workflow is:
> 
> gdalwarp raw image --> georeferenced image with correct projection, 
> based on the corner points of the original map
> gdal_translate : add control points to projected image, essentially 
> small corrections of road edges and triangulation points for
>                         which we know the exact coordinates from later 
> sources
> gdalwarp -tps georeferenced image --> georeferenced image with small 
> corrections, where roads, churcht towers are on their exact locations
> 
> The whole procedure is something I do regularly with ArcGIS, not only 
> with historical maps but also with things like aerial photographs, just 
> like Brent describes. It can be done with gdal too, as described above, 
> if only the second step would work. I still don't see why adding control 
> points to an image that already has a projection defined, should destroy 
> that projection information, including its georeferenced boundaries and 
> dimensions. Even when this is not the case: when  a -a_srs flag is 
> allowed for gdal_translate, it should be possible to add the complete 
> geolocation information for that image too: bounds, pixel dimensions and 
> geotranformation matrix, else the projection information doesn't make 
> sense.
> 
> Have I made my intention a bit clearer now?
> 
> Jan
> 
> Brent Fraser wrote:
>> Jan,
>>
>>  I think what you want gdalwarp to do is [Delauney] image 
>> triangulation.  Not an uncommon (or unreasonable) request.  I 
>> occasionally have a need for triangulation when mosaicking several 
>> satellite images.  Its visually pleasing to have the roads match up 
>> precisely where the images overlap...
>>
>> Brent Fraser
>>
>> Even Rouault wrote:
>>> Jan,
>>>
>>> (I'm CC'ing the list)
>>>
>>> I'm not sure what you mean with adapting the pixelsize, now that the 
>>> output has only GCPs and no more geotransform matrix.
>>>
>>> As far as including this option in baseline gdal_translate.cpp, I'm 
>>> currently not really enthousiastic, as there are lots of way to get 
>>> the result achieved (what is done with that patch could be done 
>>> similarly with GDAL python API for instance) and the choice of 
>>> corners is something rather arbitrary. Why should you trust the 
>>> georeferenced coordinates of the corner points as reliable GCPs ? Why 
>>> not some regularly discretized points along the edges ? Or a regular 
>>> grid over the whole raster ? etc. etc. So, I'd prefer hearing from 
>>> other GDAL developers or users that this patch is a sensical addition 
>>> before commiting it.
>>>
>>> Even
>>>
>>> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
>>>> Hi Even,
>>>>
>>>> Thanks a lo. Just one small addition: the pixelsize has also to be
>>>> adapted, else you get an image with false dimension. If it's not too
>>>> much to add that, I'm going to try it out and will let you know the
>>>> results. If it works, I have indeed a practical solution for my 
>>>> problem.
>>>>
>>>> Even so, I am not convinced that this is an uncommon problem. 
>>>> Consider a
>>>> very basic GIS functionality: edge matching.  You have digitized a map
>>>> from many sheets, and at the end the georeferenced images don't match
>>>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
>>>> them) ensure that the edge of a feature on one map perfectly matches 
>>>> the
>>>> feature edge on the adjacent map. This is exactly the kind of thing you
>>>> can do with gdalwarp using control points on a georeferenced image. It
>>>> is also more or less the thing I want to do with my historical maps.
>>>> Would this be an argument to preserve the boundaries of a georeferenced
>>>> image, when adding control points?
>>>>
>>>> Jan
>>>>
>>>> Even Rouault wrote:
>>>>> Jan,
>>>>>
>>>>> I concur with Jukka's analysis. Your need is rather uncommon, and I 
>>>>> also
>>>>> thinks it shouldn't be a default behaviour. However, adding that
>>>>> capability to gdal_translate is quite easy. I've attached a patch for
>>>>> gdal_translate.cpp that adds the capability of adding the 4 corners 
>>>>> as 4
>>>>> additional GCPs with the "-add_corners_as_gcps" option. You might 
>>>>> give it
>>>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure 
>>>>> yet if
>>>>> it is valuable enough to include it in baseline gdal_translate.cpp.
>>>>>
>>>>> Best regards
>>>>>
>>>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez 
>>>>> ?crit :
>>>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>>>>>>> Sorry to keep moaning about this, but I need an indication what's 
>>>>>>> going
>>>>>>> on here. Mind, I don't need an immediate solution: for the time 
>>>>>>> being I
>>>>>>> have a workaround. Just an idea whether this a real problem, a dumb
>>>>>>> question, something that can be handled in the foreseeable future 
>>>>>>> (or
>>>>>>> not), perhaps with adequate funding. Everything is better than 
>>>>>>> talking
>>>>>>> to a blind wall.
>>>>>>>
>>>>>>> Sorry again Frank,
>>>>>>>
>>>>>>> Jan
>>>>>> Hi,
>>>>>>
>>>>>> I think that your need to keep the original extents but add more 
>>>>>> ground
>>>>>> control points inside the image frame is rather uncommon. Doesn't it
>>>>>> mean that you trust that the image corners are correctly warped to 
>>>>>> a new
>>>>>> projection, but there are local distortions in the middle of image 
>>>>>> which
>>>>>> should be corrected with a few extra ground control points? For my 
>>>>>> mind
>>>>>> it shoudn't be the default behaviour of gdal but it might be 
>>>>>> usable as
>>>>>> an user selectable option sometimes.
>>>>>>
>>>>>> I know that missing gcp's at the image corners often leads to very 
>>>>>> odd
>>>>>> result with polynomial warping because the formula shoots over.  Even
>>>>>> unaccurately placed gcp's could help a lot in preserving the original
>>>>>> shape of the map. I guess that you are perhaps playing with scanned
>>>>>> historical maps?  I have a few old scanned parcel maps which are
>>>>>> covering just the area of the farm, and two of the map corners are 
>>>>>> just
>>>>>> white background. It is impossible to measure any real ground control
>>>>>> points from the corners because there is nothing on the map to 
>>>>>> compare
>>>>>> with, and warping with all gcp's on the middle area makes really 
>>>>>> funny
>>>>>> looking curves into the hand drawn rectangle framing the original 
>>>>>> map.
>>>>>>
>>>>>> -Jukka-
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev@lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
> 
From even.rouault at mines-paris.org  Fri Feb 13 14:02:43 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri Feb 13 14:02:56 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <4995B35D.3010500@geoanalytic.com>
References: <498DEABC.2000705@uva.nl> <499559AF.2070506@uva.nl>
	<4995B35D.3010500@geoanalytic.com>
Message-ID: <200902132002.44935.even.rouault@mines-paris.org>

Yes, once you have specified GCPs with the -gcp option, you remove the 
original georeferencing made of the origin coordinates and pixel size.

Several notes :
- There is an exclusive test in gdal_translate.cpp that prevents you from 
setting both both GCPs and (origin coordinates, pixel size) at the same time. 
That can be easily disabled, by removing the '&& nGCPCount == 0 )' test at 
line 692 of gdal_translate.cpp. (*)
- ... but the GeoTIFF driver doesn't support setting both GCPs and (origin 
coordinates, pixel size) at the same time. It wouldn't read both either. 
Hacking the GTiff driver might be possible to make it support both. But my 
understanding of the GeoTIFF specification 
(http://www.remotesensing.org/geotiff/spec/geotiff2.6.html#2.6.1) is that it 
is not a foreseen case. Although I don't see it is explicitely forbidden, I 
would anticipate that it wouldn't be handled well by other software.
- The VRT driver happens to support writing and reading both both GCPs and 
(origin coordinates, pixel size) at the same time. But I doubt this is the 
result of a design decision. It more looks like this works because that's 
what required the minimum amount of coding !
- Although I'm not 100% positive, I am not aware of any other GDAL driver that 
would support both at the same time.
- I don't think that you actually loose information by transforming the 
(origin coordinates, pixel size) into 4 GCPs. With the raster dimension and 
the coordinates, it's easy to retrieve the pixel size.

Even

(*) To tell the truth, by looking at the code, I've seen a workaround that 
doesn't imply changing the code. Just use the -a_ullr option...

Le Friday 13 February 2009 18:52:29 Brent Fraser, vous avez ?crit?:
> Jan,
>
> I stepped through your procedure with a Canadian topo map to slightly
> adjust its positioning, using GDAL 1.6.0:
>
> 1. Warp raster image of topo map to a projected coordinate system
> No Need.  Canadian topos already are georeferenced so I simply downloaded
> http://ftp2.cits.rncan.gc.ca/pub/canmatrix/50k_300dpi/082/h/canmatrix_082h0
>4_tif.zip
>
> 2. Attach my new GCPs to the original topo map:
> gdal_translate --optfile gcps.opt -a_srs "EPSG:26912" 082h04_1_1.tif
> 082h04_gcps.tif (the GCPs are in UTM zone 12, as indicated by the -a_srs
> parameter)
>
> 3. Warp/resample image using GCPs
> gdalwarp -tps 082h04_gcps.tif 082h04_warped.tif
>
> 4. Examine SRS of output image:
> gdalinfo  082h04_warped.tif
>
> Driver: GTiff/GeoTIFF
> Files: 082h04_warped.tif
> Size is 11786, 8881
> Coordinate System is:
> PROJCS["NAD83 / UTM zone 12N",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",-111],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AUTHORITY["EPSG","26912"]]
> Origin = (275804.277072605620000,5462603.410837069200000)
> Pixel Size = (4.233604626074191,-4.233604626074191)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  275804.277, 5462603.411) (114d 4'56.70"W, 49d16'30.13"N)
> Lower Left  (  275804.277, 5425004.768) (114d 3'41.57"W, 48d56'14.30"N)
> Upper Right (  325701.541, 5462603.411) (113d23'49.60"W, 49d17'28.67"N)
> Lower Right (  325701.541, 5425004.768) (113d22'51.13"W, 48d57'12.15"N)
> Center      (  300752.909, 5443804.089) (113d43'49.87"W, 49d 6'53.14"N)
> Band 1 Block=11786x1 Type=Byte, ColorInterp=Palette
>   Color Table (RGB with 256 entries)
>
>
> The result of step 2 (gdal_translate) DOES remove the image's original
> georeferencing.  Actually, it replaces it with a set of GCPs (and their
> SRS).  To leave the original would resulting in two sets of conflicting
> georeferencing information.
>
> And to me it doesn't matter anyway, as that "GCP-ed" image is just
> temporary.  After the gdalwarp step I get an image with more
> traditional/well-supported georeferencing, I can delete it.
>
> Should gdalinfo (and possibly other programs) use the GCPs to calculate the
> image extents?  Maybe.  I'd find it useful as a quality-control check to
> make sure I didn't mis-code a GCP resulting in a huge raster after warping.
>  Do you have another reason?
>
> Brent
>
> Jan Hartmann wrote:
> > Yes exactly! Brent highlights a point I never mentioned, and that may be
> > the source of the confusion: when I add control points to an already
> > georeferenced image, I gdalwarp it with the -tps option: a thin spline
> > transformer, that transforms the control points to the exact
> > georeferenced position, but stretches the areas in between. AFAIK, this
> > is done by triangulation. This is different from a traditional warp, in
> > which the eventual position of the control points on the georeferenced
> > map has errors, although minimized ones. So in matching roads on two
> > adjacent images, the road edges on both images are assigned the same
> > georeferenced coordinates and then, after gdalwarp -tps, they exactly
> > align.
> >
> > So my workflow is:
> >
> > gdalwarp raw image --> georeferenced image with correct projection,
> > based on the corner points of the original map
> > gdal_translate : add control points to projected image, essentially
> > small corrections of road edges and triangulation points for
> >                         which we know the exact coordinates from later
> > sources
> > gdalwarp -tps georeferenced image --> georeferenced image with small
> > corrections, where roads, churcht towers are on their exact locations
> >
> > The whole procedure is something I do regularly with ArcGIS, not only
> > with historical maps but also with things like aerial photographs, just
> > like Brent describes. It can be done with gdal too, as described above,
> > if only the second step would work. I still don't see why adding control
> > points to an image that already has a projection defined, should destroy
> > that projection information, including its georeferenced boundaries and
> > dimensions. Even when this is not the case: when  a -a_srs flag is
> > allowed for gdal_translate, it should be possible to add the complete
> > geolocation information for that image too: bounds, pixel dimensions and
> > geotranformation matrix, else the projection information doesn't make
> > sense.
> >
> > Have I made my intention a bit clearer now?
> >
> > Jan
> >
> > Brent Fraser wrote:
> >> Jan,
> >>
> >>  I think what you want gdalwarp to do is [Delauney] image
> >> triangulation.  Not an uncommon (or unreasonable) request.  I
> >> occasionally have a need for triangulation when mosaicking several
> >> satellite images.  Its visually pleasing to have the roads match up
> >> precisely where the images overlap...
> >>
> >> Brent Fraser
> >>
> >> Even Rouault wrote:
> >>> Jan,
> >>>
> >>> (I'm CC'ing the list)
> >>>
> >>> I'm not sure what you mean with adapting the pixelsize, now that the
> >>> output has only GCPs and no more geotransform matrix.
> >>>
> >>> As far as including this option in baseline gdal_translate.cpp, I'm
> >>> currently not really enthousiastic, as there are lots of way to get
> >>> the result achieved (what is done with that patch could be done
> >>> similarly with GDAL python API for instance) and the choice of
> >>> corners is something rather arbitrary. Why should you trust the
> >>> georeferenced coordinates of the corner points as reliable GCPs ? Why
> >>> not some regularly discretized points along the edges ? Or a regular
> >>> grid over the whole raster ? etc. etc. So, I'd prefer hearing from
> >>> other GDAL developers or users that this patch is a sensical addition
> >>> before commiting it.
> >>>
> >>> Even
> >>>
> >>> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
> >>>> Hi Even,
> >>>>
> >>>> Thanks a lo. Just one small addition: the pixelsize has also to be
> >>>> adapted, else you get an image with false dimension. If it's not too
> >>>> much to add that, I'm going to try it out and will let you know the
> >>>> results. If it works, I have indeed a practical solution for my
> >>>> problem.
> >>>>
> >>>> Even so, I am not convinced that this is an uncommon problem.
> >>>> Consider a
> >>>> very basic GIS functionality: edge matching.  You have digitized a map
> >>>> from many sheets, and at the end the georeferenced images don't match
> >>>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
> >>>> them) ensure that the edge of a feature on one map perfectly matches
> >>>> the
> >>>> feature edge on the adjacent map. This is exactly the kind of thing
> >>>> you can do with gdalwarp using control points on a georeferenced
> >>>> image. It is also more or less the thing I want to do with my
> >>>> historical maps. Would this be an argument to preserve the boundaries
> >>>> of a georeferenced image, when adding control points?
> >>>>
> >>>> Jan
> >>>>
> >>>> Even Rouault wrote:
> >>>>> Jan,
> >>>>>
> >>>>> I concur with Jukka's analysis. Your need is rather uncommon, and I
> >>>>> also
> >>>>> thinks it shouldn't be a default behaviour. However, adding that
> >>>>> capability to gdal_translate is quite easy. I've attached a patch for
> >>>>> gdal_translate.cpp that adds the capability of adding the 4 corners
> >>>>> as 4
> >>>>> additional GCPs with the "-add_corners_as_gcps" option. You might
> >>>>> give it
> >>>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure
> >>>>> yet if
> >>>>> it is valuable enough to include it in baseline gdal_translate.cpp.
> >>>>>
> >>>>> Best regards
> >>>>>
> >>>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez
> >>>>>
> >>>>> ?crit :
> >>>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
> >>>>>>> Sorry to keep moaning about this, but I need an indication what's
> >>>>>>> going
> >>>>>>> on here. Mind, I don't need an immediate solution: for the time
> >>>>>>> being I
> >>>>>>> have a workaround. Just an idea whether this a real problem, a dumb
> >>>>>>> question, something that can be handled in the foreseeable future
> >>>>>>> (or
> >>>>>>> not), perhaps with adequate funding. Everything is better than
> >>>>>>> talking
> >>>>>>> to a blind wall.
> >>>>>>>
> >>>>>>> Sorry again Frank,
> >>>>>>>
> >>>>>>> Jan
> >>>>>>
> >>>>>> Hi,
> >>>>>>
> >>>>>> I think that your need to keep the original extents but add more
> >>>>>> ground
> >>>>>> control points inside the image frame is rather uncommon. Doesn't it
> >>>>>> mean that you trust that the image corners are correctly warped to
> >>>>>> a new
> >>>>>> projection, but there are local distortions in the middle of image
> >>>>>> which
> >>>>>> should be corrected with a few extra ground control points? For my
> >>>>>> mind
> >>>>>> it shoudn't be the default behaviour of gdal but it might be
> >>>>>> usable as
> >>>>>> an user selectable option sometimes.
> >>>>>>
> >>>>>> I know that missing gcp's at the image corners often leads to very
> >>>>>> odd
> >>>>>> result with polynomial warping because the formula shoots over. 
> >>>>>> Even unaccurately placed gcp's could help a lot in preserving the
> >>>>>> original shape of the map. I guess that you are perhaps playing with
> >>>>>> scanned historical maps?  I have a few old scanned parcel maps which
> >>>>>> are covering just the area of the farm, and two of the map corners
> >>>>>> are just
> >>>>>> white background. It is impossible to measure any real ground
> >>>>>> control points from the corners because there is nothing on the map
> >>>>>> to compare
> >>>>>> with, and warping with all gcp's on the middle area makes really
> >>>>>> funny
> >>>>>> looking curves into the hand drawn rectangle framing the original
> >>>>>> map.
> >>>>>>
> >>>>>> -Jukka-
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> gdal-dev mailing list
> >>>>>> gdal-dev@lists.osgeo.org
> >>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>>
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev@lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at mines-paris.org  Sat Feb 14 07:31:55 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Feb 14 07:32:08 2009
Subject: [gdal-dev] GDALRasterBand::GetUnitType() is not available in
	Python
In-Reply-To: <FB2BEBA4-BCF5-428A-8C1E-CF443D3A53E0@stamen.com>
References: <FB2BEBA4-BCF5-428A-8C1E-CF443D3A53E0@stamen.com>
Message-ID: <200902141331.56940.even.rouault@mines-paris.org>

FYI, I've just added GetUnitType() to SWIG bindings. Will be available in GDAL 
1.7.0.

If you can't wait, this can be backported to GDAL 1.6.0 with the following 
patch:

Index: swig/include/Band.i
===================================================================
--- swig/include/Band.i	(r?vision 16315)
+++ swig/include/Band.i	(copie de travail)
@@ -117,6 +117,10 @@
     return GDALSetRasterNoDataValue( self, d );
   }
   
+  const char* GetUnitType() {
+      return GDALGetRasterUnitType( self );
+  }
+  
   %apply (char **options) { (char **) };
   char** GetRasterCategoryNames( ) {
     return GDALGetRasterCategoryNames( self );




Le Monday 24 November 2008 23:15:14 Michal Migurski, vous avez ?crit?:
> Hello,
>
> I'm following up on this mail from a few months ago:
> 	http://lists.osgeo.org/pipermail/gdal-dev/2008-June/017358.html
>
> Have there been any patches or workarounds for this issue? I'm using a
> collection .dem files that mix feet & meters, and I can't see any
> other way to access the unit information.
>
> Thanks,
> -mike.
>
> ----------------------------------------------------------------
> michal migurski- mike@stamen.com
>                   415.558.1610
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From j.l.h.hartmann at uva.nl  Sun Feb 15 07:03:55 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Sun Feb 15 07:04:08 2009
Subject: [gdal-dev] Re: [Fwd: Re: Warping an already georeferenced image
	with control points
In-Reply-To: <200902132002.44935.even.rouault@mines-paris.org>
References: <498DEABC.2000705@uva.nl> <499559AF.2070506@uva.nl>
	<4995B35D.3010500@geoanalytic.com>
	<200902132002.44935.even.rouault@mines-paris.org>
Message-ID: <499804AB.5030500@uva.nl>

Yes, I think I understand the problem now: a GeoTiff header cannot have 
*both* SRS *and* GCP information. Even so, I think there is a point to 
be made for a gcp-transformation of an already georeferenced image. 
Would adding gcp's to the gdalwarp program be a solution?

Jan

Even Rouault wrote:
> Yes, once you have specified GCPs with the -gcp option, you remove the 
> original georeferencing made of the origin coordinates and pixel size.
>
> Several notes :
> - There is an exclusive test in gdal_translate.cpp that prevents you from 
> setting both both GCPs and (origin coordinates, pixel size) at the same time. 
> That can be easily disabled, by removing the '&& nGCPCount == 0 )' test at 
> line 692 of gdal_translate.cpp. (*)
> - ... but the GeoTIFF driver doesn't support setting both GCPs and (origin 
> coordinates, pixel size) at the same time. It wouldn't read both either. 
> Hacking the GTiff driver might be possible to make it support both. But my 
> understanding of the GeoTIFF specification 
> (http://www.remotesensing.org/geotiff/spec/geotiff2.6.html#2.6.1) is that it 
> is not a foreseen case. Although I don't see it is explicitely forbidden, I 
> would anticipate that it wouldn't be handled well by other software.
> - The VRT driver happens to support writing and reading both both GCPs and 
> (origin coordinates, pixel size) at the same time. But I doubt this is the 
> result of a design decision. It more looks like this works because that's 
> what required the minimum amount of coding !
> - Although I'm not 100% positive, I am not aware of any other GDAL driver that 
> would support both at the same time.
> - I don't think that you actually loose information by transforming the 
> (origin coordinates, pixel size) into 4 GCPs. With the raster dimension and 
> the coordinates, it's easy to retrieve the pixel size.
>
> Even
>
> (*) To tell the truth, by looking at the code, I've seen a workaround that 
> doesn't imply changing the code. Just use the -a_ullr option...
>
> Le Friday 13 February 2009 18:52:29 Brent Fraser, vous avez ?crit :
>   
>> Jan,
>>
>> I stepped through your procedure with a Canadian topo map to slightly
>> adjust its positioning, using GDAL 1.6.0:
>>
>> 1. Warp raster image of topo map to a projected coordinate system
>> No Need.  Canadian topos already are georeferenced so I simply downloaded
>> http://ftp2.cits.rncan.gc.ca/pub/canmatrix/50k_300dpi/082/h/canmatrix_082h0
>> 4_tif.zip
>>
>> 2. Attach my new GCPs to the original topo map:
>> gdal_translate --optfile gcps.opt -a_srs "EPSG:26912" 082h04_1_1.tif
>> 082h04_gcps.tif (the GCPs are in UTM zone 12, as indicated by the -a_srs
>> parameter)
>>
>> 3. Warp/resample image using GCPs
>> gdalwarp -tps 082h04_gcps.tif 082h04_warped.tif
>>
>> 4. Examine SRS of output image:
>> gdalinfo  082h04_warped.tif
>>
>> Driver: GTiff/GeoTIFF
>> Files: 082h04_warped.tif
>> Size is 11786, 8881
>> Coordinate System is:
>> PROJCS["NAD83 / UTM zone 12N",
>>     GEOGCS["NAD83",
>>         DATUM["North_American_Datum_1983",
>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>                 AUTHORITY["EPSG","7019"]],
>>             AUTHORITY["EPSG","6269"]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433],
>>         AUTHORITY["EPSG","4269"]],
>>     PROJECTION["Transverse_Mercator"],
>>     PARAMETER["latitude_of_origin",0],
>>     PARAMETER["central_meridian",-111],
>>     PARAMETER["scale_factor",0.9996],
>>     PARAMETER["false_easting",500000],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]],
>>     AUTHORITY["EPSG","26912"]]
>> Origin = (275804.277072605620000,5462603.410837069200000)
>> Pixel Size = (4.233604626074191,-4.233604626074191)
>> Metadata:
>>   AREA_OR_POINT=Area
>> Image Structure Metadata:
>>   INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  275804.277, 5462603.411) (114d 4'56.70"W, 49d16'30.13"N)
>> Lower Left  (  275804.277, 5425004.768) (114d 3'41.57"W, 48d56'14.30"N)
>> Upper Right (  325701.541, 5462603.411) (113d23'49.60"W, 49d17'28.67"N)
>> Lower Right (  325701.541, 5425004.768) (113d22'51.13"W, 48d57'12.15"N)
>> Center      (  300752.909, 5443804.089) (113d43'49.87"W, 49d 6'53.14"N)
>> Band 1 Block=11786x1 Type=Byte, ColorInterp=Palette
>>   Color Table (RGB with 256 entries)
>>
>>
>> The result of step 2 (gdal_translate) DOES remove the image's original
>> georeferencing.  Actually, it replaces it with a set of GCPs (and their
>> SRS).  To leave the original would resulting in two sets of conflicting
>> georeferencing information.
>>
>> And to me it doesn't matter anyway, as that "GCP-ed" image is just
>> temporary.  After the gdalwarp step I get an image with more
>> traditional/well-supported georeferencing, I can delete it.
>>
>> Should gdalinfo (and possibly other programs) use the GCPs to calculate the
>> image extents?  Maybe.  I'd find it useful as a quality-control check to
>> make sure I didn't mis-code a GCP resulting in a huge raster after warping.
>>  Do you have another reason?
>>
>> Brent
>>
>> Jan Hartmann wrote:
>>     
>>> Yes exactly! Brent highlights a point I never mentioned, and that may be
>>> the source of the confusion: when I add control points to an already
>>> georeferenced image, I gdalwarp it with the -tps option: a thin spline
>>> transformer, that transforms the control points to the exact
>>> georeferenced position, but stretches the areas in between. AFAIK, this
>>> is done by triangulation. This is different from a traditional warp, in
>>> which the eventual position of the control points on the georeferenced
>>> map has errors, although minimized ones. So in matching roads on two
>>> adjacent images, the road edges on both images are assigned the same
>>> georeferenced coordinates and then, after gdalwarp -tps, they exactly
>>> align.
>>>
>>> So my workflow is:
>>>
>>> gdalwarp raw image --> georeferenced image with correct projection,
>>> based on the corner points of the original map
>>> gdal_translate : add control points to projected image, essentially
>>> small corrections of road edges and triangulation points for
>>>                         which we know the exact coordinates from later
>>> sources
>>> gdalwarp -tps georeferenced image --> georeferenced image with small
>>> corrections, where roads, churcht towers are on their exact locations
>>>
>>> The whole procedure is something I do regularly with ArcGIS, not only
>>> with historical maps but also with things like aerial photographs, just
>>> like Brent describes. It can be done with gdal too, as described above,
>>> if only the second step would work. I still don't see why adding control
>>> points to an image that already has a projection defined, should destroy
>>> that projection information, including its georeferenced boundaries and
>>> dimensions. Even when this is not the case: when  a -a_srs flag is
>>> allowed for gdal_translate, it should be possible to add the complete
>>> geolocation information for that image too: bounds, pixel dimensions and
>>> geotranformation matrix, else the projection information doesn't make
>>> sense.
>>>
>>> Have I made my intention a bit clearer now?
>>>
>>> Jan
>>>
>>> Brent Fraser wrote:
>>>       
>>>> Jan,
>>>>
>>>>  I think what you want gdalwarp to do is [Delauney] image
>>>> triangulation.  Not an uncommon (or unreasonable) request.  I
>>>> occasionally have a need for triangulation when mosaicking several
>>>> satellite images.  Its visually pleasing to have the roads match up
>>>> precisely where the images overlap...
>>>>
>>>> Brent Fraser
>>>>
>>>> Even Rouault wrote:
>>>>         
>>>>> Jan,
>>>>>
>>>>> (I'm CC'ing the list)
>>>>>
>>>>> I'm not sure what you mean with adapting the pixelsize, now that the
>>>>> output has only GCPs and no more geotransform matrix.
>>>>>
>>>>> As far as including this option in baseline gdal_translate.cpp, I'm
>>>>> currently not really enthousiastic, as there are lots of way to get
>>>>> the result achieved (what is done with that patch could be done
>>>>> similarly with GDAL python API for instance) and the choice of
>>>>> corners is something rather arbitrary. Why should you trust the
>>>>> georeferenced coordinates of the corner points as reliable GCPs ? Why
>>>>> not some regularly discretized points along the edges ? Or a regular
>>>>> grid over the whole raster ? etc. etc. So, I'd prefer hearing from
>>>>> other GDAL developers or users that this patch is a sensical addition
>>>>> before commiting it.
>>>>>
>>>>> Even
>>>>>
>>>>> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
>>>>>           
>>>>>> Hi Even,
>>>>>>
>>>>>> Thanks a lo. Just one small addition: the pixelsize has also to be
>>>>>> adapted, else you get an image with false dimension. If it's not too
>>>>>> much to add that, I'm going to try it out and will let you know the
>>>>>> results. If it works, I have indeed a practical solution for my
>>>>>> problem.
>>>>>>
>>>>>> Even so, I am not convinced that this is an uncommon problem.
>>>>>> Consider a
>>>>>> very basic GIS functionality: edge matching.  You have digitized a map
>>>>>> from many sheets, and at the end the georeferenced images don't match
>>>>>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
>>>>>> them) ensure that the edge of a feature on one map perfectly matches
>>>>>> the
>>>>>> feature edge on the adjacent map. This is exactly the kind of thing
>>>>>> you can do with gdalwarp using control points on a georeferenced
>>>>>> image. It is also more or less the thing I want to do with my
>>>>>> historical maps. Would this be an argument to preserve the boundaries
>>>>>> of a georeferenced image, when adding control points?
>>>>>>
>>>>>> Jan
>>>>>>
>>>>>> Even Rouault wrote:
>>>>>>             
>>>>>>> Jan,
>>>>>>>
>>>>>>> I concur with Jukka's analysis. Your need is rather uncommon, and I
>>>>>>> also
>>>>>>> thinks it shouldn't be a default behaviour. However, adding that
>>>>>>> capability to gdal_translate is quite easy. I've attached a patch for
>>>>>>> gdal_translate.cpp that adds the capability of adding the 4 corners
>>>>>>> as 4
>>>>>>> additional GCPs with the "-add_corners_as_gcps" option. You might
>>>>>>> give it
>>>>>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure
>>>>>>> yet if
>>>>>>> it is valuable enough to include it in baseline gdal_translate.cpp.
>>>>>>>
>>>>>>> Best regards
>>>>>>>
>>>>>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez
>>>>>>>
>>>>>>> ?crit :
>>>>>>>               
>>>>>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>>>>>>>>                 
>>>>>>>>> Sorry to keep moaning about this, but I need an indication what's
>>>>>>>>> going
>>>>>>>>> on here. Mind, I don't need an immediate solution: for the time
>>>>>>>>> being I
>>>>>>>>> have a workaround. Just an idea whether this a real problem, a dumb
>>>>>>>>> question, something that can be handled in the foreseeable future
>>>>>>>>> (or
>>>>>>>>> not), perhaps with adequate funding. Everything is better than
>>>>>>>>> talking
>>>>>>>>> to a blind wall.
>>>>>>>>>
>>>>>>>>> Sorry again Frank,
>>>>>>>>>
>>>>>>>>> Jan
>>>>>>>>>                   
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>> I think that your need to keep the original extents but add more
>>>>>>>> ground
>>>>>>>> control points inside the image frame is rather uncommon. Doesn't it
>>>>>>>> mean that you trust that the image corners are correctly warped to
>>>>>>>> a new
>>>>>>>> projection, but there are local distortions in the middle of image
>>>>>>>> which
>>>>>>>> should be corrected with a few extra ground control points? For my
>>>>>>>> mind
>>>>>>>> it shoudn't be the default behaviour of gdal but it might be
>>>>>>>> usable as
>>>>>>>> an user selectable option sometimes.
>>>>>>>>
>>>>>>>> I know that missing gcp's at the image corners often leads to very
>>>>>>>> odd
>>>>>>>> result with polynomial warping because the formula shoots over. 
>>>>>>>> Even unaccurately placed gcp's could help a lot in preserving the
>>>>>>>> original shape of the map. I guess that you are perhaps playing with
>>>>>>>> scanned historical maps?  I have a few old scanned parcel maps which
>>>>>>>> are covering just the area of the farm, and two of the map corners
>>>>>>>> are just
>>>>>>>> white background. It is impossible to measure any real ground
>>>>>>>> control points from the corners because there is nothing on the map
>>>>>>>> to compare
>>>>>>>> with, and warping with all gcp's on the middle area makes really
>>>>>>>> funny
>>>>>>>> looking curves into the hand drawn rectangle framing the original
>>>>>>>> map.
>>>>>>>>
>>>>>>>> -Jukka-
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> gdal-dev mailing list
>>>>>>>> gdal-dev@lists.osgeo.org
>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>>>                 
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>           
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>     
>
>
>
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090215/fb282114/attachment.html
From Sjur.A.Kolberg at sintef.no  Mon Feb 16 04:32:13 2009
From: Sjur.A.Kolberg at sintef.no (Sjur Kolberg)
Date: Mon Feb 16 04:32:17 2009
Subject: [gdal-dev] Is anyone working on an OGR driver for IDRISI vector
	data?
Message-ID: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>

Dear list,

The IDRISI raster format is well represented in GDAL, but OGR doesn't contain the IDRISI vector format. Is anyone working or planning to work on this?

If I (at the moment very hypothetically) should think of creating a driver - is there somewhere I could steal the database part from? IDRISI use Access database for storing attributes, and comes in Windows version only.

Regards,

Sjur Kolberg
SINTEF Energiforskning A/S
Sem S?lands vei 11
7465 Trondheim
tlf. 73 59 72 78
fax  73 59 72 50


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090216/f9f65644/attachment.html
From jef at norbit.de  Mon Feb 16 04:39:53 2009
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Mon Feb 16 04:40:01 2009
Subject: [gdal-dev] Is anyone working on an OGR driver for IDRISI vector
	data?
In-Reply-To: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>
References: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>
Message-ID: <20090216093953.GA5472@norbit.de>

Hi Sjur,

On Mon, 16. Feb 2009 at 10:32:13 +0100, Sjur Kolberg wrote:
> If I (at the moment very hypothetically) should think of creating a driver - is
> there somewhere I could steal the database part from? IDRISI use Access
> database for storing attributes, and comes in Windows version only.

ESRI Personal GeoDatabase (PGeo driver) is also MSAccess based.
See http://www.gdal.org/ogr/drv_pgeo.html


J?rgen

-- 
J?rgen E. Fischer         norBIT GmbH               Tel. +49-4931-918175-20
Dipl.-Inf. (FH)           Rheinstra?e 13            Fax. +49-4931-918175-50
Software Engineer         D-26506 Norden               http://www.norbit.de

-- 
norBIT Gesellschaft fuer Unternehmensberatung und Informationssysteme mbH
Rheinstrasse 13, 26506 Norden
GF: Jelto Buurman, HR: Amtsgericht Emden, HRB 5502

From ivan.lucena at pmldnet.com  Mon Feb 16 07:41:47 2009
From: ivan.lucena at pmldnet.com (Ivan Lucena)
Date: Mon Feb 16 07:41:36 2009
Subject: [gdal-dev] Is anyone working on an OGR driver for IDRISI vector
	data?
In-Reply-To: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>
References: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>
Message-ID: <49995F0B.2080601@pmldnet.com>

Hi There,

I started working on the VCT format just after the RST but I did not see 
much interest about it. I could commit it to the trunk if someone want 
to take from here I left.

Best regards,

Ivan

Sjur Kolberg wrote:
> Dear list,
>  
> The IDRISI raster format is well represented in GDAL, but OGR doesn't 
> contain the IDRISI vector format. Is anyone working or planning to work 
> on this?
>  
> If I (at the moment very hypothetically) should think of creating a 
> driver - is there somewhere I could steal the database part from? IDRISI 
> use Access database for storing attributes, and comes in Windows version 
> only.
>  
> Regards,
> 
> Sjur Kolberg
> SINTEF Energiforskning A/S
> Sem S?lands vei 11
> 7465 Trondheim
> tlf. 73 59 72 78
> fax  73 59 72 50
> 
>  
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From aca at ngi.be  Mon Feb 16 09:13:01 2009
From: aca at ngi.be (acangi)
Date: Mon Feb 16 09:13:03 2009
Subject: [Gdal-dev] gdalwarp changes colortable
In-Reply-To: <1234790572893-2334758.post@n2.nabble.com>
References: <1234790572893-2334758.post@n2.nabble.com>
Message-ID: <1234793581650-2335001.post@n2.nabble.com>


Subscription problem, reposting as requested.


acangi wrote:
> 
> Hello,
> 
> I try to translate colormapped geotiff files from EPSG:31300 to EPSG:3812,
> using 
> 
> $ gdalwarp -s_srs EPSG:31300 -t_srs "+proj=lcc +lat_1=49.83333333333334
> +lat_2=51.16666666666666 +lat_0=50.79781500000000 +lon_0=4.359215833333335
> +x_0=649328.0 +y_0=665262.0 +ellps=intl +units=m +no_defs" top250r.tif
> top250r_warp.tif
> 
> Using -t_srs EPSG:3812 gives a "is this a valid coordinate system ?"
> Using -t_srs 3812.prj (file containing the WKT, taken from 
> http://spatialreference.org/ref/epsg/3812/ogcwkt/
> http://spatialreference.org/ ) gives a "No translation for Lambert Conic
> Conformal (2SP) to PROJ.4 is known"
> As I couldn't find the PROJ.4 syntax for this SRS, I built it based on
> data from the WKT.
> 
> Coordinates transformation seems to work fine, but my colors are wrong:
> 
> 
> Before :  http://n2.nabble.com/file/n2334758/before.jpeg                
> After :  http://n2.nabble.com/file/n2334758/after.jpeg 
> 
> Checking the files with gdalinfo, I see differences :
> 
> Size is 18300, 15000 ==> Size is 18301, 15001
> The projection, the origin and the corner coordinates change like expected
> Pixel Size = (16.666670000000000,-16.666699999999999) ==> Pixel Size =
> (16.666302967680906,-16.666302967680906)
> Metadata:
>   AREA_OR_POINT=Area
>  
> TIFFTAG_DOCUMENTNAME=\\backstage\jobcontainer1\symb\map250\tiff\plot_complet.tif
>   TIFFTAG_SOFTWARE=Barco Graphics TIFFOut V1.0.2
>   TIFFTAG_XRESOLUTION=381
>   TIFFTAG_YRESOLUTION=381
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> ==> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:COMPRESSION=LZW  INTERLEAVE=BAND ==> Image
> Structure Metadata: INTERLEAVE=BAND
> Band 1 Block=256x256 Type=Byte, ColorInterp=Palette ==> Band 1
> Block=18301x1 Type=Byte, ColorInterp=Palette
> The color table is the same.
> 
> I tried with some more options : -of GTiff -co "PROFILE=GeoTIFF" -co
> "INTERLEAVE=PIXEL" -co "COMPRESS=LZW" -co "TILED=YES" :
> Size is 18300, 15001
> Yet another Pixel Size
> I get the "COMPRESSION=LZW"
> and Band 1 Block=256x256 Type=Byte, ColorInterp=Palette
> 
> ...but the colors are still wrong.
> 
> Any idea how I can change the projection without affecting the colors ?
> 
> 

-- 
View this message in context: http://n2.nabble.com/gdalwarp-changes-colortable-tp2334758p2335001.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From warmerdam at pobox.com  Mon Feb 16 11:07:27 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Feb 16 11:07:46 2009
Subject: [gdal-dev] Is anyone working on an OGR driver for IDRISI vector
	data?
In-Reply-To: <49995F0B.2080601@pmldnet.com>
References: <72251B925CE10A478606EEAC6AA683BE0BD43DE432@SINTEFEXMBX01.sintef.no>
	<49995F0B.2080601@pmldnet.com>
Message-ID: <49998F3F.9010707@pobox.com>

>> The IDRISI raster format is well represented in GDAL, but OGR doesn't 
>> contain the IDRISI vector format. Is anyone working or planning to 
>> work on this?
>>  
>> If I (at the moment very hypothetically) should think of creating a 
>> driver - is there somewhere I could steal the database part from? 
>> IDRISI use Access database for storing attributes, and comes in 
>> Windows version only.

Sjur,

Assuming this isn't already addressed by Ivan's work, you can model
the access db portion on the PGeo driver (gdal/ogr/ogrsf_frmts/pgeo)
which uses the lower level GDAL ODBC services to access and Access file.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From adriano at arvus.com.br  Mon Feb 16 13:53:35 2009
From: adriano at arvus.com.br (Adriano C Naspolini)
Date: Mon Feb 16 14:00:19 2009
Subject: [gdal-dev] ARM platform compatibility
Message-ID: <4999B62F.5050209@arvus.com.br>

Hi,
I developed an application and it runs perfectly over X86. However, when 
i try to run it on ARM it stops reading shapefiles (actually it reads 
wrong coordinates). I wrote a simple program to tell just the first 
"point" coordinates.

On X86:
x=: -53.1275 y= -31.8682

On ARM:
x=: -1.00226e-13 y= -1.76938e+52


Looking for the problem here, i found a thread from Etienne Dube on 
(2004-04-07 05:12:55 GMT), saying it's a byte ordering problem.
"Each 32-bit word in the 64-bit double value is stored little-endian, 
but the most significative 32-bit word comes last in memory 
("big-wordian")."

Changing the word-order for the first feature inside the ".shp" ("11 36 
3c bd 52 90 4a c0" to "52 90 4a c0 11 36 3c bd") and running it again:

under X86:
x=: -1.00226e-13 y= -31.8682

under ARM
x=: -53.1275 y= -1.76938e+52

So, clearly, i have the same problem then Etienne. He sent a patch, but 
didn't made many tests...
Is there a "final"solution for the problem? I couldn't see any answer to 
him.

Regards,

Adriano
From chaitanya.ch at gmail.com  Mon Feb 16 20:22:46 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Mon Feb 16 20:22:50 2009
Subject: [Gdal-dev] gdalwarp changes colortable
In-Reply-To: <1234793581650-2335001.post@n2.nabble.com>
References: <1234790572893-2334758.post@n2.nabble.com>
	<1234793581650-2335001.post@n2.nabble.com>
Message-ID: <eb502d880902161722i5fceb913r1c477d35282bed4@mail.gmail.com>

acangi,

Could you check if the after image shows any different colors with
some other image viewer like ImageMagick? OpenEV might not be reading
the color table correctly.

-- 
Chaitanya kumar CH.

On Mon, Feb 16, 2009 at 7:43 PM, acangi <aca@ngi.be> wrote:
>
> Subscription problem, reposting as requested.
>
>
> acangi wrote:
>>
>> Hello,
>>
>> I try to translate colormapped geotiff files from EPSG:31300 to EPSG:3812,
>> using
>>
>> $ gdalwarp -s_srs EPSG:31300 -t_srs "+proj=lcc +lat_1=49.83333333333334
>> +lat_2=51.16666666666666 +lat_0=50.79781500000000 +lon_0=4.359215833333335
>> +x_0=649328.0 +y_0=665262.0 +ellps=intl +units=m +no_defs" top250r.tif
>> top250r_warp.tif
>>
>> Using -t_srs EPSG:3812 gives a "is this a valid coordinate system ?"
>> Using -t_srs 3812.prj (file containing the WKT, taken from
>> http://spatialreference.org/ref/epsg/3812/ogcwkt/
>> http://spatialreference.org/ ) gives a "No translation for Lambert Conic
>> Conformal (2SP) to PROJ.4 is known"
>> As I couldn't find the PROJ.4 syntax for this SRS, I built it based on
>> data from the WKT.
>>
>> Coordinates transformation seems to work fine, but my colors are wrong:
>>
>>
>> Before :  http://n2.nabble.com/file/n2334758/before.jpeg
>> After :  http://n2.nabble.com/file/n2334758/after.jpeg
>>
>> Checking the files with gdalinfo, I see differences :
>>
>> Size is 18300, 15000 ==> Size is 18301, 15001
>> The projection, the origin and the corner coordinates change like expected
>> Pixel Size = (16.666670000000000,-16.666699999999999) ==> Pixel Size =
>> (16.666302967680906,-16.666302967680906)
>> Metadata:
>>   AREA_OR_POINT=Area
>>
>> TIFFTAG_DOCUMENTNAME=\\backstage\jobcontainer1\symb\map250\tiff\plot_complet.tif
>>   TIFFTAG_SOFTWARE=Barco Graphics TIFFOut V1.0.2
>>   TIFFTAG_XRESOLUTION=381
>>   TIFFTAG_YRESOLUTION=381
>>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>> ==> Metadata:
>>   AREA_OR_POINT=Area
>> Image Structure Metadata:COMPRESSION=LZW  INTERLEAVE=BAND ==> Image
>> Structure Metadata: INTERLEAVE=BAND
>> Band 1 Block=256x256 Type=Byte, ColorInterp=Palette ==> Band 1
>> Block=18301x1 Type=Byte, ColorInterp=Palette
>> The color table is the same.
>>
>> I tried with some more options : -of GTiff -co "PROFILE=GeoTIFF" -co
>> "INTERLEAVE=PIXEL" -co "COMPRESS=LZW" -co "TILED=YES" :
>> Size is 18300, 15001
>> Yet another Pixel Size
>> I get the "COMPRESSION=LZW"
>> and Band 1 Block=256x256 Type=Byte, ColorInterp=Palette
>>
>> ...but the colors are still wrong.
>>
>> Any idea how I can change the projection without affecting the colors ?
>>
>>
>
> --
> View this message in context: http://n2.nabble.com/gdalwarp-changes-colortable-tp2334758p2335001.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From 2voodoo at gmx.de  Mon Feb 16 21:05:03 2009
From: 2voodoo at gmx.de (Tom Kazimiers)
Date: Mon Feb 16 21:05:08 2009
Subject: [gdal-dev] ARM platform compatibility
In-Reply-To: <4999B62F.5050209@arvus.com.br>
References: <4999B62F.5050209@arvus.com.br>
Message-ID: <499A1B4F.8090204@gmx.de>

Hi Adriano,

which version of CGAL did you compile for ARM?

I use 1.5.2 and reading shapefiles works very well.

Regards,
Tom

Adriano C Naspolini schrieb:
> Hi,
> I developed an application and it runs perfectly over X86. However,
> when i try to run it on ARM it stops reading shapefiles (actually it
> reads wrong coordinates). I wrote a simple program to tell just the
> first "point" coordinates.
>
> On X86:
> x=: -53.1275 y= -31.8682
>
> On ARM:
> x=: -1.00226e-13 y= -1.76938e+52
>
>
> Looking for the problem here, i found a thread from Etienne Dube on
> (2004-04-07 05:12:55 GMT), saying it's a byte ordering problem.
> "Each 32-bit word in the 64-bit double value is stored little-endian,
> but the most significative 32-bit word comes last in memory
> ("big-wordian")."
>
> Changing the word-order for the first feature inside the ".shp" ("11
> 36 3c bd 52 90 4a c0" to "52 90 4a c0 11 36 3c bd") and running it again:
>
> under X86:
> x=: -1.00226e-13 y= -31.8682
>
> under ARM
> x=: -53.1275 y= -1.76938e+52
>
> So, clearly, i have the same problem then Etienne. He sent a patch,
> but didn't made many tests...
> Is there a "final"solution for the problem? I couldn't see any answer
> to him.
>
> Regards,
>
> Adriano
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From adriano at arvus.com.br  Mon Feb 16 23:22:34 2009
From: adriano at arvus.com.br (Adriano C Naspolini)
Date: Mon Feb 16 23:29:20 2009
Subject: [gdal-dev] ARM platform compatibility
In-Reply-To: <499A1B4F.8090204@gmx.de>
References: <4999B62F.5050209@arvus.com.br> <499A1B4F.8090204@gmx.de>
Message-ID: <499A3B8A.7040505@arvus.com.br>

Hi Tom,
I was trying with 1.5.3 (Debian etch, gcc-4.1), now changed to 1.6.0, 
but no success.

About 1.5.2 version, didn't work neither.

By default, configuration sets up "msb2lsb" (big-wordian). Forcing the 
configuration (changing configure file) to be "lsb2msb" make no 
difference (maybe because the problem is exactly there).

The next step I'll do is to apply Etienne's patch manually, because it 
became incompatible with newer versions of shpopen.c...


Thanks,

Adriano

Tom Kazimiers escreveu:
> Hi Adriano,
> 
> which version of CGAL did you compile for ARM?
> 
> I use 1.5.2 and reading shapefiles works very well.
> 
> Regards,
> Tom
> 
> Adriano C Naspolini schrieb:
>> Hi,
>> I developed an application and it runs perfectly over X86. However,
>> when i try to run it on ARM it stops reading shapefiles (actually it
>> reads wrong coordinates). I wrote a simple program to tell just the
>> first "point" coordinates.
>>
>> On X86:
>> x=: -53.1275 y= -31.8682
>>
>> On ARM:
>> x=: -1.00226e-13 y= -1.76938e+52
>>
>>
>> Looking for the problem here, i found a thread from Etienne Dube on
>> (2004-04-07 05:12:55 GMT), saying it's a byte ordering problem.
>> "Each 32-bit word in the 64-bit double value is stored little-endian,
>> but the most significative 32-bit word comes last in memory
>> ("big-wordian")."
>>
>> Changing the word-order for the first feature inside the ".shp" ("11
>> 36 3c bd 52 90 4a c0" to "52 90 4a c0 11 36 3c bd") and running it again:
>>
>> under X86:
>> x=: -1.00226e-13 y= -31.8682
>>
>> under ARM
>> x=: -53.1275 y= -1.76938e+52
>>
>> So, clearly, i have the same problem then Etienne. He sent a patch,
>> but didn't made many tests...
>> Is there a "final"solution for the problem? I couldn't see any answer
>> to him.
>>
>> Regards,
>>
>> Adriano
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> 
> 
From anja.roesel at zmaw.de  Tue Feb 17 03:40:23 2009
From: anja.roesel at zmaw.de (Anja Roesel)
Date: Tue Feb 17 03:40:25 2009
Subject: [gdal-dev] gdalwarp: utm to polarsterographic projection
Message-ID: <499A77F7.8040607@zmaw.de>

Dear list,

i tried several options to reproject coordinates from utm to polar
stereographic but without success. It seems that I use some wrong
parameters.
Could you tell me what would be the best command to project it correctly?

These are the information from gdalinfo for the sourcefile:

> >gdalinfo utm.tif
Driver: GTiff/GeoTIFF
Size is 9101, 8561
Coordinate System is:
PROJCS["WGS 84 / UTM zone 10N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",-123],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32610"]]
Origin = (279000.000000,7853400.000000)
Pixel Size = (30.00000000,-30.00000000)
Metadata:
  AREA_OR_POINT=Point
Corner Coordinates:
Upper Left  (  279000.000, 7853400.000) (128d59'44.63"W, 70d41'12.77"N)
Lower Left  (  279000.000, 7596570.000) (128d23'2.66"W, 68d23'42.08"N)
Upper Right (  552030.000, 7853400.000) (121d35'1.70"W, 70d46'45.81"N)
Lower Right (  552030.000, 7596570.000) (121d43'44.87"W, 68d28'36.75"N)
Center      (  415515.000, 7724985.000) (125d10'26.99"W, 69d37'11.51"N)
Band 1 Block=9101x1 Type=Byte, ColorInterp=Gray


This is one of my commands:

gdalwarp -s_srs "+proj=utm  +zone=10 +datum=WGS84" -t_srs "+proj=stere
+lat_ts=70.0 +lat_0=90.0 +lon_0=45.0 +k_0=1.0 +x_0=0.0 +y_0=0.0" utm.tif
pol_ster.tif


Thank you very much for your comments and remarks.


-- Anja R?sel

From battisti at actgate.com  Tue Feb 17 14:34:49 2009
From: battisti at actgate.com (Andrea Battisti)
Date: Tue Feb 17 14:34:58 2009
Subject: [gdal-dev] modifying HDF4 subdatasets
Message-ID: <499B1159.9030103@actgate.com>

Hi all,


is it possible to modify existing HDF4 subdatasets using the GDAL/HDF4
driver ?


I see that the HDF4 driver should support the creation from scratch, but
given a HDF4 file containing a set of subdatasets, would it be possible
to open one of the subdatasets, (over)writing to it using RasterIO() ?

If not, what is the correct way to modify the content of a sub-dataset?


Thanks in advance for any advise.



Best regards,

-- 
Andrea Battisti
Applied Coherent Technology Corp.


From battisti at actgate.com  Tue Feb 17 14:21:58 2009
From: battisti at actgate.com (Andrea Battisti)
Date: Tue Feb 17 14:47:45 2009
Subject: [gdal-dev] modifying HDF4 subdatasets
Message-ID: <499B0E56.3000907@actgate.com>

Hi all,


is it possible to modify existing HDF4 subdatasets using the GDAL/HDF4
driver ?


I see that the HDF4 driver should support the creation from scratch, but
given a HDF4 file containing a set of subdatasets, would it be possible
to open one of the subdatasets, (over)writing to it using RasterIO() ?

If not, what is the correct way to modify the content of a sub-dataset?


Thanks in advance for any advise.



Best regards,

-- 
Andrea Battisti
Applied Coherent Technology Corp.

From warmerdam at pobox.com  Tue Feb 17 15:11:11 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Feb 17 15:11:30 2009
Subject: [gdal-dev] modifying HDF4 subdatasets
In-Reply-To: <499B1159.9030103@actgate.com>
References: <499B1159.9030103@actgate.com>
Message-ID: <499B19DF.8020102@pobox.com>

Andrea Battisti wrote:
> Hi all,
> 
> 
> is it possible to modify existing HDF4 subdatasets using the GDAL/HDF4
> driver ?
> 
> 
> I see that the HDF4 driver should support the creation from scratch, but
> given a HDF4 file containing a set of subdatasets, would it be possible
> to open one of the subdatasets, (over)writing to it using RasterIO() ?
> 
> If not, what is the correct way to modify the content of a sub-dataset?

Andrea,

GDAL currently only supports writing to the non-HDFEOS dataset type
it creates itself (I think "SDS" datasets).

I haven't tested update in place, but based on a brief review of the
code it seems it ought to work in simple cases.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mchapman at fortifiedgeospatial.com  Tue Feb 17 16:01:24 2009
From: mchapman at fortifiedgeospatial.com (Martin Chapman)
Date: Tue Feb 17 16:08:16 2009
Subject: [gdal-dev] FL.lla file not included in makefile.vc nadshift option
Message-ID: <000001c99142$e4c00bb0$ae402310$@com>

Frank,

 

I noticed in the /src/makefile.vc for proj4 that the config entries for
nadshift is missing an entry for the FL.lla file.  I didn't know if this was
a big deal, but I thought it probably matters for datum shifts in Florida.
Anyway I thought you would want to know.  Also, I usually deploy the files
in the nad directory and set the path to them at runtime because it is my
understanding that these binary outputs are needed at runtime.  Is that
correct?  Also, could you briefly explain to me how they are used?

 

nadshift:   nad2bin.exe

      cd ..\nad

      ..\src\nad2bin.exe < conus.lla conus

      ..\src\nad2bin.exe < MD.lla MD

      ..\src\nad2bin.exe < TN.lla TN

      ..\src\nad2bin.exe < WI.lla WI

      ..\src\nad2bin.exe < WO.lla WO

      ..\src\nad2bin.exe < alaska.lla alaska

      ..\src\nad2bin.exe < hawaii.lla hawaii

      ..\src\nad2bin.exe < prvi.lla prvi

      ..\src\nad2bin.exe < stgeorge.lla stgeorge

      ..\src\nad2bin.exe < stlrnc.lla stlrnc

      ..\src\nad2bin.exe < stpaul.lla stpaul

      ..\src\nad2bin.exe < null.lla null

      cd ..\src

 

Best regards,

Martin

 

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090217/61d13fec/attachment.html
From mchapman at fortifiedgeospatial.com  Tue Feb 17 16:13:29 2009
From: mchapman at fortifiedgeospatial.com (Martin Chapman)
Date: Tue Feb 17 16:13:41 2009
Subject: [gdal-dev] FL.lla file not included in makefile.vc nadshift option
Message-ID: <001001c99144$94f30d10$bed92730$@com>

Frank,

 

I should also add that I am using proj 4.6.1. 

 

Martin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090217/bbf5d901/attachment.html
From bryan at ideotrope.org  Tue Feb 17 16:43:45 2009
From: bryan at ideotrope.org (Bryan Keith)
Date: Tue Feb 17 16:43:47 2009
Subject: [gdal-dev] how to find gdal_fillnodata
In-Reply-To: <49809298.8030007@pobox.com>
References: <1983.64.78.232.178.1233159071.squirrel@ideotrope.org>
	<49809298.8030007@pobox.com>
Message-ID: <2627.64.78.232.178.1234907025.squirrel@ideotrope.org>

> Bryan Keith wrote:
>> Hello,
>>
>> I combined two DEM datasets with gdal_merge, and there's a broken strip
>> of
>> nodata between the two.  What gdal utility can I use to fix this?  I
>> found
>> references to gdal_fillnodata on the web, but I don't have it.  I
>> installed FWTools 2.2.8 on windows, but that doesn't seem to include
>> gdal_fillnodata either.  On Linux I have GDAL 1.4.4.0, released
>> 2007/11/23.  I looked at the source code (from the daily svn snapshot),
>> and it looks I need gdal.FillNoData but that's not part of the bindings
>> that I have on either Windows or Linux.  How can I get this utility or
>> is
>> there another utility that I can use?
>
> Bryan,
>
> This utility only exists in the most recent builds from trunk.  I see it
> was not in FWTools 2.3.0, but it is in the gdal-dev package of OSGeo4W.
> On linux you could build from svn with python support and you should have
> it.
>

Frank,

I installed OSGeo4W this afternoon.  I had to do a little futzing to get
python to work with gdal-dev (change the windows %path% variable and
change the Python sys.path list).  However, when I run gdal_fillnodata, I
end up with a tif that has all 0s.  What am I doing wrong?  Commands are
pasted below.

Bryan

C:\Projects>gdalinfo dem.tif -stats
Driver: GTiff/GeoTIFF
Files: dem.tif
Size is 2200, 1411
Coordinate System is:
Origin = (1749100.677571530000000,304762.295903306220000)
Pixel Size = (32.820441700754138,-32.820441700754138)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 1749100.678,  304762.296) (122d52'36.09"W, 38d30'0.63"N)
Lower Left  ( 1749100.678,  258452.653) (122d52'30.48"W, 38d22'22.86"N)
Upper Right ( 1821305.649,  304762.296) (122d37'27.85"W, 38d30'6.53"N)
Lower Right ( 1821305.649,  258452.653) (122d37'23.86"W, 38d22'28.75"N)
Center      ( 1785203.163,  281607.474) (122d44'59.57"W, 38d26'14.94"N)
Band 1 Block=2200x1 Type=Float32, ColorInterp=Gray
  Minimum=10.000, Maximum=563.300, Mean=78.248, StdDev=78.791
  NoData Value=-32766
  Metadata:
    STATISTICS_MINIMUM=10
    STATISTICS_MAXIMUM=563.29998779297
    STATISTICS_MEAN=78.248205065279
    STATISTICS_STDDEV=78.791386753552

C:\Projects>\OSGeo4W\apps\gdal-dev\bin\gdal_fillnodata.bat dem.tif
 dem_nnd.tif
0...10...20...30...40...50...60...70...80...90...100 - done.

C:\Projects>gdalinfo dem_nnd.tif -stats
Driver: GTiff/GeoTIFF
Files: dem_nnd.tif
Size is 2200, 1411
Coordinate System is:
Origin = (1749100.677571530000000,304762.295903306220000)
Pixel Size = (32.820441700754138,-32.820441700754138)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( 1749100.678,  304762.296) (122d52'36.09"W, 38d30'0.63"N)
Lower Left  ( 1749100.678,  258452.653) (122d52'30.48"W, 38d22'22.86"N)
Upper Right ( 1821305.649,  304762.296) (122d37'27.85"W, 38d30'6.53"N)
Lower Right ( 1821305.649,  258452.653) (122d37'23.86"W, 38d22'28.75"N)
Center      ( 1785203.163,  281607.474) (122d44'59.57"W, 38d26'14.94"N)
Band 1 Block=2200x1 Type=Float32, ColorInterp=Gray
  Minimum=0.000, Maximum=0.000, Mean=0.000, StdDev=0.000
  Metadata:
    STATISTICS_MINIMUM=0
    STATISTICS_MAXIMUM=0
    STATISTICS_MEAN=0
    STATISTICS_STDDEV=0

C:\Projects>

From skmcbride at gmail.com  Tue Feb 17 18:05:08 2009
From: skmcbride at gmail.com (Simon.)
Date: Tue Feb 17 18:05:11 2009
Subject: [Gdal-dev] Advice on Multiple RasterIO Reads.
Message-ID: <1234911908763-2343782.post@n2.nabble.com>


Hi List,

What is the suggested RasterIO usage for reading many small requests
repeatedly?

Current Process:
	1. for each (x,y) coordinate in collection (10,000+)
		i. get the raster tile 
		ii. open a dataset  - Readonly & OpenShared (1-4 tiles)
		iii. get raster band 1
		iv. calculate the (x,y) cell location
		v. read the raster (2x2 array)
		vi. apply bi-linear interpolation
		vii. return value
	
Is there an optimal block size for this type of processing?

Raster Info
Format=GTiff
Pixel Size=2,5 or 10 
Size=2502x2502,1002X1002 or 502x502
Band 1 Block Size=2502x1,1002x2 or 502x4
DataType=Float32
File Size=25MB,4MB or 1MB

MaxCache=400
-- 
View this message in context: http://n2.nabble.com/Advice-on-Multiple-RasterIO-Reads.-tp2343782p2343782.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From aca at ngi.be  Wed Feb 18 03:46:07 2009
From: aca at ngi.be (acangi)
Date: Wed Feb 18 03:46:13 2009
Subject: [Gdal-dev] gdalwarp changes colortable
In-Reply-To: <eb502d880902161722i5fceb913r1c477d35282bed4@mail.gmail.com>
References: <1234790572893-2334758.post@n2.nabble.com>
	<1234793581650-2335001.post@n2.nabble.com>
	<eb502d880902161722i5fceb913r1c477d35282bed4@mail.gmail.com>
Message-ID: <1234946767934-2345702.post@n2.nabble.com>


I forgot to mention I was viewing the rasters with GeoServer and Openlayers.
Thanks for your suggestion, I tested them on QuantumGIS and there the colors
are fine.

So, I guess I just have to forward my question to the geoserver mailing
list, which isn't using OpenEV, AFAIK.


Chaitanya kumar CH wrote:
> 
> acangi,
> 
> Could you check if the after image shows any different colors with
> some other image viewer like ImageMagick? OpenEV might not be reading
> the color table correctly.
> 
> -- 
> Chaitanya kumar CH.
> 
> On Mon, Feb 16, 2009 at 7:43 PM, acangi <aca@ngi.be> wrote:
>>
>> Subscription problem, reposting as requested.
>>
>>
>> acangi wrote:
>>>
>>> Hello,
>>>
>>> I try to translate colormapped geotiff files from EPSG:31300 to
>>> EPSG:3812,
>>> using
>>>
>>> $ gdalwarp -s_srs EPSG:31300 -t_srs "+proj=lcc +lat_1=49.83333333333334
>>> +lat_2=51.16666666666666 +lat_0=50.79781500000000
>>> +lon_0=4.359215833333335
>>> +x_0=649328.0 +y_0=665262.0 +ellps=intl +units=m +no_defs" top250r.tif
>>> top250r_warp.tif
>>>
>>> Using -t_srs EPSG:3812 gives a "is this a valid coordinate system ?"
>>> Using -t_srs 3812.prj (file containing the WKT, taken from
>>> http://spatialreference.org/ref/epsg/3812/ogcwkt/
>>> http://spatialreference.org/ ) gives a "No translation for Lambert Conic
>>> Conformal (2SP) to PROJ.4 is known"
>>> As I couldn't find the PROJ.4 syntax for this SRS, I built it based on
>>> data from the WKT.
>>>
>>> Coordinates transformation seems to work fine, but my colors are wrong:
>>>
>>>
>>> Before :  http://n2.nabble.com/file/n2334758/before.jpeg
>>> After :  http://n2.nabble.com/file/n2334758/after.jpeg
>>>
>>> Checking the files with gdalinfo, I see differences :
>>>
>>> Size is 18300, 15000 ==> Size is 18301, 15001
>>> The projection, the origin and the corner coordinates change like
>>> expected
>>> Pixel Size = (16.666670000000000,-16.666699999999999) ==> Pixel Size =
>>> (16.666302967680906,-16.666302967680906)
>>> Metadata:
>>>   AREA_OR_POINT=Area
>>>
>>> TIFFTAG_DOCUMENTNAME=\\backstage\jobcontainer1\symb\map250\tiff\plot_complet.tif
>>>   TIFFTAG_SOFTWARE=Barco Graphics TIFFOut V1.0.2
>>>   TIFFTAG_XRESOLUTION=381
>>>   TIFFTAG_YRESOLUTION=381
>>>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>>> ==> Metadata:
>>>   AREA_OR_POINT=Area
>>> Image Structure Metadata:COMPRESSION=LZW  INTERLEAVE=BAND ==> Image
>>> Structure Metadata: INTERLEAVE=BAND
>>> Band 1 Block=256x256 Type=Byte, ColorInterp=Palette ==> Band 1
>>> Block=18301x1 Type=Byte, ColorInterp=Palette
>>> The color table is the same.
>>>
>>> I tried with some more options : -of GTiff -co "PROFILE=GeoTIFF" -co
>>> "INTERLEAVE=PIXEL" -co "COMPRESS=LZW" -co "TILED=YES" :
>>> Size is 18300, 15001
>>> Yet another Pixel Size
>>> I get the "COMPRESSION=LZW"
>>> and Band 1 Block=256x256 Type=Byte, ColorInterp=Palette
>>>
>>> ...but the colors are still wrong.
>>>
>>> Any idea how I can change the projection without affecting the colors ?
>>>
>>>
>>
>> --
>> View this message in context:
>> http://n2.nabble.com/gdalwarp-changes-colortable-tp2334758p2335001.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/gdalwarp-changes-colortable-tp2334758p2345702.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From j.l.h.hartmann at uva.nl  Wed Feb 18 09:17:22 2009
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Wed Feb 18 09:17:55 2009
Subject: [gdal-dev] Warping an already georeferenced image with control
	points
In-Reply-To: <200902132002.44935.even.rouault@mines-paris.org>
References: <498DEABC.2000705@uva.nl> <499559AF.2070506@uva.nl>
	<4995B35D.3010500@geoanalytic.com>
	<200902132002.44935.even.rouault@mines-paris.org>
Message-ID: <499C1872.501@uva.nl>

Thanks to Brent Fraser, I think I know now were the problem lies. He 
even sent me some suggestions for a workaround, without even exactly 
completely comprehending the problem (isn't that brilliant?). I want to 
rubbersheet maps (gdalwarp -tps), using already georeferenced maps and 
using control points in georeferenced coordinates. I do this to align 
exactly historical maps, but it is also something that is useful in 
edge-matching adjacent sheets of recent topographical maps. This 
*cannot* be done by the gdal_translate / gdalwarp suite. The problem is 
that control points have to be added to a tiff-file with gdal_translate, 
and when that is done, the file has lost its georeferencing information: 
SRS and dimensions. This is a restriction of the geotiff format, so the 
problem is unsolvable.

However, computationally everything is available in GDAL to implement 
this functionality. With gdaltransform, I can do exactly what I want: 
here, I translate a coordinate in the Dutch SRS (epsg:28992) one meter 
east, based on four control points, also in epsg:28992:

gdaltransform -s_srs epsg:28992 -t_srs epsg:28992                      
                       -gcp 179624 318062 179625 318062
                      -gcp 181371 318062 181372 318062
                      -gcp 181371 320751 181372 320751
                      -gcp 179624 320751 179625 320751 <<eof
 180000 320000
 180001 320000 0
eof

So the problem is not that GDAL can't do it (GDAL can do practically 
anything:-)), it is just that the Geotiff file format isn't up to the 
problem.

Now, this geotiff file with gcps is just an intermediate file. When 
warping with control points, you need first to gdal_translate the 
original image into a second file with gcps added, and than you can 
gdalwarp that second file into the final map, a third file. I have 
always wondered why this intermediate gcp-file was needed: you could 
just as well transform directly from image to map, *if* gcps could be 
indicated with gdalwarp, or am I overlooking something? Adding a -gcp 
option to gdalwarp would AFAICS not be very difficult, it wouldn't break 
existing applications, and it would make warping by control points more 
efficient, because no intermediate files have to be generated any more. 
I think I understand how the gcp option came to be added to 
gdal_translate: some image providers, especially satellite images, 
provide their images with control points within the file, so the -gcp 
option has to be retained for gdal_translate.

So, even if I have been unable to make clear my exotic problems with 
historical maps, could this feature, adding a -gcp parameter to 
gdalwarp, be implemented with a reasonable amount of programming effort?

Thanks,

Jan


Even Rouault wrote:
> Yes, once you have specified GCPs with the -gcp option, you remove the 
> original georeferencing made of the origin coordinates and pixel size.
>
> Several notes :
> - There is an exclusive test in gdal_translate.cpp that prevents you from 
> setting both both GCPs and (origin coordinates, pixel size) at the same time. 
> That can be easily disabled, by removing the '&& nGCPCount == 0 )' test at 
> line 692 of gdal_translate.cpp. (*)
> - ... but the GeoTIFF driver doesn't support setting both GCPs and (origin 
> coordinates, pixel size) at the same time. It wouldn't read both either. 
> Hacking the GTiff driver might be possible to make it support both. But my 
> understanding of the GeoTIFF specification 
> (http://www.remotesensing.org/geotiff/spec/geotiff2.6.html#2.6.1) is that it 
> is not a foreseen case. Although I don't see it is explicitely forbidden, I 
> would anticipate that it wouldn't be handled well by other software.
> - The VRT driver happens to support writing and reading both both GCPs and 
> (origin coordinates, pixel size) at the same time. But I doubt this is the 
> result of a design decision. It more looks like this works because that's 
> what required the minimum amount of coding !
> - Although I'm not 100% positive, I am not aware of any other GDAL driver that 
> would support both at the same time.
> - I don't think that you actually loose information by transforming the 
> (origin coordinates, pixel size) into 4 GCPs. With the raster dimension and 
> the coordinates, it's easy to retrieve the pixel size.
>
> Even
>
> (*) To tell the truth, by looking at the code, I've seen a workaround that 
> doesn't imply changing the code. Just use the -a_ullr option...
>
> Le Friday 13 February 2009 18:52:29 Brent Fraser, vous avez ?crit :
>   
>> Jan,
>>
>> I stepped through your procedure with a Canadian topo map to slightly
>> adjust its positioning, using GDAL 1.6.0:
>>
>> 1. Warp raster image of topo map to a projected coordinate system
>> No Need.  Canadian topos already are georeferenced so I simply downloaded
>> http://ftp2.cits.rncan.gc.ca/pub/canmatrix/50k_300dpi/082/h/canmatrix_082h0
>> 4_tif.zip
>>
>> 2. Attach my new GCPs to the original topo map:
>> gdal_translate --optfile gcps.opt -a_srs "EPSG:26912" 082h04_1_1.tif
>> 082h04_gcps.tif (the GCPs are in UTM zone 12, as indicated by the -a_srs
>> parameter)
>>
>> 3. Warp/resample image using GCPs
>> gdalwarp -tps 082h04_gcps.tif 082h04_warped.tif
>>
>> 4. Examine SRS of output image:
>> gdalinfo  082h04_warped.tif
>>
>> Driver: GTiff/GeoTIFF
>> Files: 082h04_warped.tif
>> Size is 11786, 8881
>> Coordinate System is:
>> PROJCS["NAD83 / UTM zone 12N",
>>     GEOGCS["NAD83",
>>         DATUM["North_American_Datum_1983",
>>             SPHEROID["GRS 1980",6378137,298.2572221010002,
>>                 AUTHORITY["EPSG","7019"]],
>>             AUTHORITY["EPSG","6269"]],
>>         PRIMEM["Greenwich",0],
>>         UNIT["degree",0.0174532925199433],
>>         AUTHORITY["EPSG","4269"]],
>>     PROJECTION["Transverse_Mercator"],
>>     PARAMETER["latitude_of_origin",0],
>>     PARAMETER["central_meridian",-111],
>>     PARAMETER["scale_factor",0.9996],
>>     PARAMETER["false_easting",500000],
>>     PARAMETER["false_northing",0],
>>     UNIT["metre",1,
>>         AUTHORITY["EPSG","9001"]],
>>     AUTHORITY["EPSG","26912"]]
>> Origin = (275804.277072605620000,5462603.410837069200000)
>> Pixel Size = (4.233604626074191,-4.233604626074191)
>> Metadata:
>>   AREA_OR_POINT=Area
>> Image Structure Metadata:
>>   INTERLEAVE=BAND
>> Corner Coordinates:
>> Upper Left  (  275804.277, 5462603.411) (114d 4'56.70"W, 49d16'30.13"N)
>> Lower Left  (  275804.277, 5425004.768) (114d 3'41.57"W, 48d56'14.30"N)
>> Upper Right (  325701.541, 5462603.411) (113d23'49.60"W, 49d17'28.67"N)
>> Lower Right (  325701.541, 5425004.768) (113d22'51.13"W, 48d57'12.15"N)
>> Center      (  300752.909, 5443804.089) (113d43'49.87"W, 49d 6'53.14"N)
>> Band 1 Block=11786x1 Type=Byte, ColorInterp=Palette
>>   Color Table (RGB with 256 entries)
>>
>>
>> The result of step 2 (gdal_translate) DOES remove the image's original
>> georeferencing.  Actually, it replaces it with a set of GCPs (and their
>> SRS).  To leave the original would resulting in two sets of conflicting
>> georeferencing information.
>>
>> And to me it doesn't matter anyway, as that "GCP-ed" image is just
>> temporary.  After the gdalwarp step I get an image with more
>> traditional/well-supported georeferencing, I can delete it.
>>
>> Should gdalinfo (and possibly other programs) use the GCPs to calculate the
>> image extents?  Maybe.  I'd find it useful as a quality-control check to
>> make sure I didn't mis-code a GCP resulting in a huge raster after warping.
>>  Do you have another reason?
>>
>> Brent
>>
>> Jan Hartmann wrote:
>>     
>>> Yes exactly! Brent highlights a point I never mentioned, and that may be
>>> the source of the confusion: when I add control points to an already
>>> georeferenced image, I gdalwarp it with the -tps option: a thin spline
>>> transformer, that transforms the control points to the exact
>>> georeferenced position, but stretches the areas in between. AFAIK, this
>>> is done by triangulation. This is different from a traditional warp, in
>>> which the eventual position of the control points on the georeferenced
>>> map has errors, although minimized ones. So in matching roads on two
>>> adjacent images, the road edges on both images are assigned the same
>>> georeferenced coordinates and then, after gdalwarp -tps, they exactly
>>> align.
>>>
>>> So my workflow is:
>>>
>>> gdalwarp raw image --> georeferenced image with correct projection,
>>> based on the corner points of the original map
>>> gdal_translate : add control points to projected image, essentially
>>> small corrections of road edges and triangulation points for
>>>                         which we know the exact coordinates from later
>>> sources
>>> gdalwarp -tps georeferenced image --> georeferenced image with small
>>> corrections, where roads, churcht towers are on their exact locations
>>>
>>> The whole procedure is something I do regularly with ArcGIS, not only
>>> with historical maps but also with things like aerial photographs, just
>>> like Brent describes. It can be done with gdal too, as described above,
>>> if only the second step would work. I still don't see why adding control
>>> points to an image that already has a projection defined, should destroy
>>> that projection information, including its georeferenced boundaries and
>>> dimensions. Even when this is not the case: when  a -a_srs flag is
>>> allowed for gdal_translate, it should be possible to add the complete
>>> geolocation information for that image too: bounds, pixel dimensions and
>>> geotranformation matrix, else the projection information doesn't make
>>> sense.
>>>
>>> Have I made my intention a bit clearer now?
>>>
>>> Jan
>>>
>>> Brent Fraser wrote:
>>>       
>>>> Jan,
>>>>
>>>>  I think what you want gdalwarp to do is [Delauney] image
>>>> triangulation.  Not an uncommon (or unreasonable) request.  I
>>>> occasionally have a need for triangulation when mosaicking several
>>>> satellite images.  Its visually pleasing to have the roads match up
>>>> precisely where the images overlap...
>>>>
>>>> Brent Fraser
>>>>
>>>> Even Rouault wrote:
>>>>         
>>>>> Jan,
>>>>>
>>>>> (I'm CC'ing the list)
>>>>>
>>>>> I'm not sure what you mean with adapting the pixelsize, now that the
>>>>> output has only GCPs and no more geotransform matrix.
>>>>>
>>>>> As far as including this option in baseline gdal_translate.cpp, I'm
>>>>> currently not really enthousiastic, as there are lots of way to get
>>>>> the result achieved (what is done with that patch could be done
>>>>> similarly with GDAL python API for instance) and the choice of
>>>>> corners is something rather arbitrary. Why should you trust the
>>>>> georeferenced coordinates of the corner points as reliable GCPs ? Why
>>>>> not some regularly discretized points along the edges ? Or a regular
>>>>> grid over the whole raster ? etc. etc. So, I'd prefer hearing from
>>>>> other GDAL developers or users that this patch is a sensical addition
>>>>> before commiting it.
>>>>>
>>>>> Even
>>>>>
>>>>> Le Thursday 12 February 2009 11:47:00, vous avez ?crit :
>>>>>           
>>>>>> Hi Even,
>>>>>>
>>>>>> Thanks a lo. Just one small addition: the pixelsize has also to be
>>>>>> adapted, else you get an image with false dimension. If it's not too
>>>>>> much to add that, I'm going to try it out and will let you know the
>>>>>> results. If it works, I have indeed a practical solution for my
>>>>>> problem.
>>>>>>
>>>>>> Even so, I am not convinced that this is an uncommon problem.
>>>>>> Consider a
>>>>>> very basic GIS functionality: edge matching.  You have digitized a map
>>>>>> from many sheets, and at the end the georeferenced images don't match
>>>>>> precisely at the edges. Edge-matching functions (ArcGIS has lots of
>>>>>> them) ensure that the edge of a feature on one map perfectly matches
>>>>>> the
>>>>>> feature edge on the adjacent map. This is exactly the kind of thing
>>>>>> you can do with gdalwarp using control points on a georeferenced
>>>>>> image. It is also more or less the thing I want to do with my
>>>>>> historical maps. Would this be an argument to preserve the boundaries
>>>>>> of a georeferenced image, when adding control points?
>>>>>>
>>>>>> Jan
>>>>>>
>>>>>> Even Rouault wrote:
>>>>>>             
>>>>>>> Jan,
>>>>>>>
>>>>>>> I concur with Jukka's analysis. Your need is rather uncommon, and I
>>>>>>> also
>>>>>>> thinks it shouldn't be a default behaviour. However, adding that
>>>>>>> capability to gdal_translate is quite easy. I've attached a patch for
>>>>>>> gdal_translate.cpp that adds the capability of adding the 4 corners
>>>>>>> as 4
>>>>>>> additional GCPs with the "-add_corners_as_gcps" option. You might
>>>>>>> give it
>>>>>>> at try (it applies cleanly on GDAL 1.6.0 and trunk). I'm not sure
>>>>>>> yet if
>>>>>>> it is valuable enough to include it in baseline gdal_translate.cpp.
>>>>>>>
>>>>>>> Best regards
>>>>>>>
>>>>>>> Le Wednesday 11 February 2009 15:59:48 Jukka Rahkonen, vous avez
>>>>>>>
>>>>>>> ?crit :
>>>>>>>               
>>>>>>>> Jan Hartmann <j.l.h.hartmann <at> uva.nl> writes:
>>>>>>>>                 
>>>>>>>>> Sorry to keep moaning about this, but I need an indication what's
>>>>>>>>> going
>>>>>>>>> on here. Mind, I don't need an immediate solution: for the time
>>>>>>>>> being I
>>>>>>>>> have a workaround. Just an idea whether this a real problem, a dumb
>>>>>>>>> question, something that can be handled in the foreseeable future
>>>>>>>>> (or
>>>>>>>>> not), perhaps with adequate funding. Everything is better than
>>>>>>>>> talking
>>>>>>>>> to a blind wall.
>>>>>>>>>
>>>>>>>>> Sorry again Frank,
>>>>>>>>>
>>>>>>>>> Jan
>>>>>>>>>                   
>>>>>>>> Hi,
>>>>>>>>
>>>>>>>> I think that your need to keep the original extents but add more
>>>>>>>> ground
>>>>>>>> control points inside the image frame is rather uncommon. Doesn't it
>>>>>>>> mean that you trust that the image corners are correctly warped to
>>>>>>>> a new
>>>>>>>> projection, but there are local distortions in the middle of image
>>>>>>>> which
>>>>>>>> should be corrected with a few extra ground control points? For my
>>>>>>>> mind
>>>>>>>> it shoudn't be the default behaviour of gdal but it might be
>>>>>>>> usable as
>>>>>>>> an user selectable option sometimes.
>>>>>>>>
>>>>>>>> I know that missing gcp's at the image corners often leads to very
>>>>>>>> odd
>>>>>>>> result with polynomial warping because the formula shoots over. 
>>>>>>>> Even unaccurately placed gcp's could help a lot in preserving the
>>>>>>>> original shape of the map. I guess that you are perhaps playing with
>>>>>>>> scanned historical maps?  I have a few old scanned parcel maps which
>>>>>>>> are covering just the area of the farm, and two of the map corners
>>>>>>>> are just
>>>>>>>> white background. It is impossible to measure any real ground
>>>>>>>> control points from the corners because there is nothing on the map
>>>>>>>> to compare
>>>>>>>> with, and warping with all gcp's on the middle area makes really
>>>>>>>> funny
>>>>>>>> looking curves into the hand drawn rectangle framing the original
>>>>>>>> map.
>>>>>>>>
>>>>>>>> -Jukka-
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> gdal-dev mailing list
>>>>>>>> gdal-dev@lists.osgeo.org
>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>>>>                 
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev@lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>           
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>     
>
>
>
>   
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090218/4e35eaf3/attachment-0001.html
From warmerdam at pobox.com  Wed Feb 18 10:45:57 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Feb 18 10:46:24 2009
Subject: [gdal-dev] Re: Warping an already georeferenced image with control
	points
In-Reply-To: <499C1872.501@uva.nl>
References: <498DEABC.2000705@uva.nl> <499559AF.2070506@uva.nl>
	<4995B35D.3010500@geoanalytic.com>
	<200902132002.44935.even.rouault@mines-paris.org> <499C1872.501@uva.nl>
Message-ID: <499C2D35.1030400@pobox.com>

Jan Hartmann wrote:

> Now, this geotiff file with gcps is just an intermediate file. When 
> warping with control points, you need first to gdal_translate the 
> original image into a second file with gcps added, and than you can 
> gdalwarp that second file into the final map, a third file. I have 
> always wondered why this intermediate gcp-file was needed: you could 
> just as well transform directly from image to map, *if* gcps could be 
> indicated with gdalwarp, or am I overlooking something? Adding a -gcp 
> option to gdalwarp would AFAICS not be very difficult, it wouldn't break 
> existing applications, and it would make warping by control points more 
> efficient, because no intermediate files have to be generated any more. 
> I think I understand how the gcp option came to be added to 
> gdal_translate: some image providers, especially satellite images, 
> provide their images with control points within the file, so the -gcp 
> option has to be retained for gdal_translate.
> 
> So, even if I have been unable to make clear my exotic problems with 
> historical maps, could this feature, adding a -gcp parameter to 
> gdalwarp, be implemented with a reasonable amount of programming effort?

Jan,

I haven't been following this discussion as closely as I might.  I think
you could gdal_translate to VRT format, instead of an intermediate GeoTIFF,
in order to add the GCPs in a VRT "wrapper" around the original GeoTIFF.
This will hopefully support GCP+SRS and geotransform+SRS.

I'm a bit hesitant to add the -gcp logic into gdalwarp as it already has
a very complicated interface, and because it would require wrapping the
input dataset in a VRT internally to accomplish the functionality without
overly complicating the rest of the calls into the library.

But, if the gdal_translate approach is unsuitable, I can ask Chaitanya to
implement that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From randre at gmail.com  Wed Feb 18 15:45:16 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Wed Feb 18 15:45:18 2009
Subject: [gdal-dev] NetCDF data upside down when read by gdal
Message-ID: <9c2015090902181245s7868f9f1s632748e9730eaaf3@mail.gmail.com>

Hi All,

- I am attempting to use a NetCDF file as a data source for a raster layer
in Mapserver.  According to a very useful email sent in November 2005 from
Norman Barker,
http://lists.osgeo.org/pipermail/mapserver-users/2005-November/012153.html,
and from Mapserver documentation at
http://www.mapserver.org/ogc/wcs_format.html#netcdf, it seems like this
should be possible using Mapserver's gdal driver to read the file.  However,
I am running into some problems when trying to implement these examples
using GDAL 1.5.2, released 2008/05/29.

- The NetCDF file which I am using to test with is a "CF Convention" sample
file which I downloaded from
http://www.unidata.ucar.edu/software/netcdf/examples/tos_O1_2001-2002.nc.
This file contains information about sea-surface temperatures, and when
viewed by gdalinfo has the following characteristics:

$ gdalinfo tos_O1_2001-2002.nc
Driver: netCDF/Network Common Data Format
Files: tos_O1_2001-2002.nc
Size is 512, 512
Coordinate System is `'
Metadata:
  NC_GLOBAL#title=IPSL  model output prepared for IPCC Fourth Assessment
SRES A2 experiment
  NC_GLOBAL#institution=IPSL (Institut Pierre Simon Laplace, Paris, France)
  NC_GLOBAL#source=IPSL-CM4_v1 (2003) : atmosphere : LMDZ (IPSL-CM4_IPCC,
96x71x19) ; ocean ORCA2 (ipsl_cm4_v1_8, 2x2L31); sea ice LIM (ipsl_cm4_v
  NC_GLOBAL#contact=Sebastien Denvil, sebastien.denvil@ipsl.jussieu.fr
  NC_GLOBAL#project_id=IPCC Fourth Assessment
  NC_GLOBAL#table_id=Table O1 (13 November 2004)
  NC_GLOBAL#experiment_id=SRES A2 experiment
  NC_GLOBAL#realization=1
  NC_GLOBAL#cmor_version=9.600000e-01
  NC_GLOBAL#Conventions=CF-1.0
  NC_GLOBAL#history=YYYY/MM/JJ: data generated; YYYY/MM/JJ+1 data
transformed  At 16:37:23 on 01/11/2005, CMOR rewrote data to comply with CF
standards and IPCC Fourth Assessment requirements
  NC_GLOBAL#references=Dufresne et al, Journal of Climate, 2015, vol XX, p
136
  NC_GLOBAL#comment=Test drive
Subdatasets:
  SUBDATASET_1_NAME=NETCDF:"tos_O1_2001-2002.nc":lon_bnds
  SUBDATASET_1_DESC=[180x2] lon_bnds (64-bit floating-point)
  SUBDATASET_2_NAME=NETCDF:"tos_O1_2001-2002.nc":lat_bnds
  SUBDATASET_2_DESC=[170x2] lat_bnds (64-bit floating-point)
  SUBDATASET_3_NAME=NETCDF:"tos_O1_2001-2002.nc":time_bnds
  SUBDATASET_3_DESC=[24x2] time_bnds (64-bit floating-point)
  SUBDATASET_4_NAME=NETCDF:"tos_O1_2001-2002.nc":tos
  SUBDATASET_4_DESC=[24x170x180] sea_surface_temperature (32-bit
floating-point)
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  512.0)
Upper Right (  512.0,    0.0)
Lower Right (  512.0,  512.0)
Center      (  256.0,  256.0)

- The SUBDATASET of interest is the "tos" one, and when queried by gdalinfo
it shows that it contains 24 bands, each of which varies by
NETCDF_DIMENSION_time that increments by 15.  When specifically queried by
gdalinfo, this SUBDATASET looks like this:

$ gdalinfo NETCDF:"tos_O1_2001-2002.nc":tos
Driver: netCDF/Network Common Data Format
Files: none associated
Size is 180, 170
Coordinate System is `'
Origin = (0.000000000000000,90.000000000000000)
Pixel Size = (2.000000000000000,-1.000000000000000)
Metadata:
  NC_GLOBAL#title=IPSL  model output prepared for IPCC Fourth Assessment
SRES A2 experiment
  NC_GLOBAL#institution=IPSL (Institut Pierre Simon Laplace, Paris, France)
  NC_GLOBAL#source=IPSL-CM4_v1 (2003) : atmosphere : LMDZ (IPSL-CM4_IPCC,
96x71x19) ; ocean ORCA2 (ipsl_cm4_v1_8, 2x2L31); sea ice LIM (ipsl_cm4_v
  NC_GLOBAL#contact=Sebastien Denvil, sebastien.denvil@ipsl.jussieu.fr
  NC_GLOBAL#project_id=IPCC Fourth Assessment
  NC_GLOBAL#table_id=Table O1 (13 November 2004)
  NC_GLOBAL#experiment_id=SRES A2 experiment
  NC_GLOBAL#realization=1
  NC_GLOBAL#cmor_version=9.600000e-01
  NC_GLOBAL#Conventions=CF-1.0
  NC_GLOBAL#history=YYYY/MM/JJ: data generated; YYYY/MM/JJ+1 data
transformed  At 16:37:23 on 01/11/2005, CMOR rewrote data to comply with CF
standards and IPCC Fourth Assessment requirements
  NC_GLOBAL#references=Dufresne et al, Journal of Climate, 2015, vol XX, p
136
  NC_GLOBAL#comment=Test drive
  tos#standard_name=sea_surface_temperature
  tos#long_name=Sea Surface Temperature
  tos#units=K
  tos#cell_methods=time: mean (interval: 30 minutes)
  tos#_FillValue=1.000000e+20
  tos#missing_value=1.000000e+20
  tos#original_name=sosstsst
  tos#original_units=degC
  tos#history= At   16:37:23 on 01/11/2005: CMOR altered the data in the
following ways: added 2.73150E+02 to yield output units;  Cyclical dimension
was output starting at a different lon;
  lon#standard_name=longitude
  lon#long_name=longitude
  lon#units=degrees_east
  lon#axis=X
  lon#bounds=lon_bnds
  lon#original_units=degrees_east
  lat#standard_name=latitude
  lat#long_name=latitude
  lat#units=degrees_north
  lat#axis=Y
  lat#bounds=lat_bnds
  lat#original_units=degrees_north
  time#standard_name=time
  time#long_name=time
  time#units=days since 2001-1-1
  time#axis=T
  time#calendar=360_day
  time#bounds=time_bnds
  time#original_units=seconds since 2001-1-1
Corner Coordinates:
Upper Left  (   0.0000000,  90.0000000)
Lower Left  (   0.0000000, -80.0000000)
Upper Right (     360.000,      90.000)
Lower Right (     360.000,     -80.000)
Center      ( 180.0000000,   5.0000000)
Band 1 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=15
    NETCDF_time_units=days since 2001-1-1
Band 2 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=45
    NETCDF_time_units=days since 2001-1-1
Band 3 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=75
    NETCDF_time_units=days since 2001-1-1
Band 4 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=105
    NETCDF_time_units=days since 2001-1-1
Band 5 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=135
    NETCDF_time_units=days since 2001-1-1
Band 6 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=165
    NETCDF_time_units=days since 2001-1-1
Band 7 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=195
    NETCDF_time_units=days since 2001-1-1
Band 8 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=225
    NETCDF_time_units=days since 2001-1-1
Band 9 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=255
    NETCDF_time_units=days since 2001-1-1
Band 10 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=285
    NETCDF_time_units=days since 2001-1-1
Band 11 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=315
    NETCDF_time_units=days since 2001-1-1
Band 12 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=345
    NETCDF_time_units=days since 2001-1-1
Band 13 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=375
    NETCDF_time_units=days since 2001-1-1
Band 14 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=405
    NETCDF_time_units=days since 2001-1-1
Band 15 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=435
    NETCDF_time_units=days since 2001-1-1
Band 16 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=465
    NETCDF_time_units=days since 2001-1-1
Band 17 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=495
    NETCDF_time_units=days since 2001-1-1
Band 18 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=525
    NETCDF_time_units=days since 2001-1-1
Band 19 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=555
    NETCDF_time_units=days since 2001-1-1
Band 20 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=585
    NETCDF_time_units=days since 2001-1-1
Band 21 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=615
    NETCDF_time_units=days since 2001-1-1
Band 22 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=645
    NETCDF_time_units=days since 2001-1-1
Band 23 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=675
    NETCDF_time_units=days since 2001-1-1
Band 24 Block=180x1 Type=Float32, ColorInterp=Undefined
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=705
    NETCDF_time_units=days since 2001-1-1

- I am able to test that I can extract one of these bands with GDAL, and
convert it to GeoTIFF with the following command:
gdal_translate -b 1 NETCDF:"tos_O1_2001-2002.nc":tos sea_temp_band_1.tif.
Here however is where the first problem appears.  As you can see from the
screenshot of the sea_temp_band_1.tif that I've posted at
http://2.bp.blogspot.com/_-yICqdt0mtY/SZxtI4yUHdI/AAAAAAAAA-I/z7W_O6qBXho/s1600-h/upside_down_netcdf.jpg,
the data in the file appears to be represented upside down.  Since this file
is a sample from the Unidata web site, I'm reasonably confident that the
file follows the CF convention.  Every NetCDF file I have tried to read with
GDAL has had this problem, including ones that I have created with
gdal_translate.  As you can see from the gdalinfo output above, the
georeferencing and pixel dimensions seem to be reasonable.  In the past I
have used flip_raster.py to "fix" this, and created an intermediary
GeoTIFF.  Now that I would like to use the NetCDF itself as the data source
to feed a WCS service, this is no longer an acceptable solution.  Of
interest though, is that the georeferencing info between the flipped and
unflipped files are exactly the same.  See below:

- Flipped file:
---------------
$ gdalinfo flipped_sea_temp_band_1.tif
Driver: GTiff/GeoTIFF
Files: flipped_sea_temp_band_1.tif
Size is 180, 170
Coordinate System is `'
Origin = (0.000000000000000,90.000000000000000)
Pixel Size = (2.000000000000000,-1.000000000000000)
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (   0.0000000,  90.0000000)
Lower Left  (   0.0000000, -80.0000000)
Upper Right (     360.000,      90.000)
Lower Right (     360.000,     -80.000)
Center      ( 180.0000000,   5.0000000)
Band 1 Block=180x11 Type=Float32, ColorInterp=Gray

- Unflipped file:
-----------------
$ gdalinfo sea_temp_band_1.tif
Driver: GTiff/GeoTIFF
Files: sea_temp_band_1.tif
Size is 180, 170
Coordinate System is `'
Origin = (0.000000000000000,90.000000000000000)
Pixel Size = (2.000000000000000,-1.000000000000000)
<snip> (Metadata removed for clarity)
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (   0.0000000,  90.0000000)
Lower Left  (   0.0000000, -80.0000000)
Upper Right (     360.000,      90.000)
Lower Right (     360.000,     -80.000)
Center      ( 180.0000000,   5.0000000)
Band 1 Block=180x11 Type=Float32, ColorInterp=Gray
  NoData Value=1.00000002004087734e+20
  Metadata:
    NETCDF_VARNAME=tos
    NETCDF_DIMENSION_time=15
    NETCDF_time_units=days since 2001-1-1

- I'm unsure if this is a bug in GDAL, or an incorrectly formatted NetCDF
file.  So, would it be possible for someone who has a NetCDF file that is
read  "right-side-up" to post it as a sample for me to test with?

Thanks in advance,

Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090218/f8ef8bec/attachment-0001.html
From ksshannon at gmail.com  Thu Feb 19 11:40:31 2009
From: ksshannon at gmail.com (Kyle Shannon)
Date: Thu Feb 19 11:40:33 2009
Subject: [gdal-dev] Compiling on RHEL 5
Message-ID: <c28f2e140902190840n4825889dkd9345f00a5c90370@mail.gmail.com>

Hello everyone, I am new(er) to linux and I tried to compile gdal on a new
workstation running Red Hat Enterprise Linux Server release 5.2.  I ran into
an error during compilation:

/usr/lib/libexpat.so: could not read symbols: File in wrong format
collect2: ld returned 1 exit status
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory `/home/kyle/gdal/gdal-1.6.0'
make: *** [check-lib] Error 2


I am hoping this is a simple issue where I just have to tell the configure
script something I missed.  Anyone have any ideas?  thank you.

Other stats:
RHEL 5.2 64bit
gcc 4.1.2

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)829-6954
kshannon@fs.fed.us
ksshannon@gmail.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090219/0483f057/attachment.html
From even.rouault at mines-paris.org  Thu Feb 19 14:00:28 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Feb 19 14:00:41 2009
Subject: [gdal-dev] Compiling on RHEL 5
In-Reply-To: <c28f2e140902190840n4825889dkd9345f00a5c90370@mail.gmail.com>
References: <c28f2e140902190840n4825889dkd9345f00a5c90370@mail.gmail.com>
Message-ID: <200902192000.29582.even.rouault@mines-paris.org>

My guess is that /usr/lib/libexpat.so is a 32bit library. Maybe there's 
a /usr/lib64/libexpat.so on your system ? I'm not sure of the filesystem 
layout of RedHat's 64bit systems.

If that's the case, use the --with-expat-lib= option of the configure script.

Le Thursday 19 February 2009 17:40:31 Kyle Shannon, vous avez ?crit?:
> Hello everyone, I am new(er) to linux and I tried to compile gdal on a new
> workstation running Red Hat Enterprise Linux Server release 5.2.  I ran
> into an error during compilation:
>
> /usr/lib/libexpat.so: could not read symbols: File in wrong format
> collect2: ld returned 1 exit status
> make[1]: *** [libgdal.la] Error 1
> make[1]: Leaving directory `/home/kyle/gdal/gdal-1.6.0'
> make: *** [check-lib] Error 2
>
>
> I am hoping this is a simple issue where I just have to tell the configure
> script something I missed.  Anyone have any ideas?  thank you.
>
> Other stats:
> RHEL 5.2 64bit
> gcc 4.1.2
>
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> Kyle Shannon
> Physical Science Technician
> RMRS Fire Sciences Lab
> Fire, Fuels & Smoke - RWU 4405
> 5775 Highway 10 W.
> Missoula, MT 59808
> (406)829-6954
> kshannon@fs.fed.us
> ksshannon@gmail.com
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


From Matthew.Cole at drdc-rddc.gc.ca  Thu Feb 19 14:27:55 2009
From: Matthew.Cole at drdc-rddc.gc.ca (Matthew Cole)
Date: Thu Feb 19 14:27:56 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <200902111939.19537.even.rouault@mines-paris.org>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
	<1234368653400-2309579.post@n2.nabble.com>
	<200902111939.19537.even.rouault@mines-paris.org>
Message-ID: <1235071675324-2354972.post@n2.nabble.com>


Sure, I'd be happy to try them to make sure they don't break anything.
Where would I get the updated version?  

Matt


Matthew,

For the record, I just commited yesterday in GDAL SVN trunk a substantial 
update to the java bindings I was mentionning. Now all necessary typemaps 
have been created, so it looks rather good (no more SWIGTYPE_p_* classes). I 
would be interested in having early feedback from people already using the 
Java bindings to check if I haven't broken existing API. It shouldn't 
hopefully (at least the 2 test applications still run against the bindings). 
It also adds methods with default argument values, for example 
ogr.Open(String filename) in addition to the full ogr.Open(String filename, 
int update). Some facilities that look more java'ish have been added, like 
String Geometry.ExportToWkt(), in addition to the existing int 
Geometry.ExportToWkt(String[] argout), etc. A previous commit already added 
support for progress callbacks in GDAL API.

Best  regards



-- 
View this message in context: http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2354972.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Thu Feb 19 14:33:05 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu Feb 19 14:33:14 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <1235071675324-2354972.post@n2.nabble.com>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902111939.19537.even.rouault@mines-paris.org>
	<1235071675324-2354972.post@n2.nabble.com>
Message-ID: <200902192033.05505.even.rouault@mines-paris.org>

Hi Matt,

You'll have to build GDAL and the Java bindings from the latest daily snapshot 
of the SVN trunk head. You can download the source at 
http://download.osgeo.org/gdal/daily/
(download the gdal-svn-trunk*.tar.gz or gdal-svntrunk*.zip at your 
convenience)

Thanks

Le Thursday 19 February 2009 20:27:55 Matthew Cole, vous avez ?crit?:
> Sure, I'd be happy to try them to make sure they don't break anything.
> Where would I get the updated version?
>
> Matt
>
>
> Matthew,
>
> For the record, I just commited yesterday in GDAL SVN trunk a substantial
> update to the java bindings I was mentionning. Now all necessary typemaps
> have been created, so it looks rather good (no more SWIGTYPE_p_* classes).
> I would be interested in having early feedback from people already using
> the Java bindings to check if I haven't broken existing API. It shouldn't
> hopefully (at least the 2 test applications still run against the
> bindings). It also adds methods with default argument values, for example
> ogr.Open(String filename) in addition to the full ogr.Open(String filename,
> int update). Some facilities that look more java'ish have been added, like
> String Geometry.ExportToWkt(), in addition to the existing int
> Geometry.ExportToWkt(String[] argout), etc. A previous commit already added
> support for progress callbacks in GDAL API.
>
> Best  regards


From ksshannon at gmail.com  Fri Feb 20 11:21:37 2009
From: ksshannon at gmail.com (Kyle Shannon)
Date: Fri Feb 20 11:22:04 2009
Subject: [gdal-dev] Compiling on RHEL 5
In-Reply-To: <200902192000.29582.even.rouault@mines-paris.org>
References: <c28f2e140902190840n4825889dkd9345f00a5c90370@mail.gmail.com>
	<200902192000.29582.even.rouault@mines-paris.org>
Message-ID: <c28f2e140902200821m65d78997w714df8b053440de2@mail.gmail.com>

That was exactly it, running great now, thanks.

kss
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Kyle Shannon
Physical Science Technician
RMRS Fire Sciences Lab
Fire, Fuels & Smoke - RWU 4405
5775 Highway 10 W.
Missoula, MT 59808
(406)829-6954
kshannon@fs.fed.us
ksshannon@gmail.com
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


On Thu, Feb 19, 2009 at 12:00 PM, Even Rouault <even.rouault@mines-paris.org
> wrote:

> My guess is that /usr/lib/libexpat.so is a 32bit library. Maybe there's
> a /usr/lib64/libexpat.so on your system ? I'm not sure of the filesystem
> layout of RedHat's 64bit systems.
>
> If that's the case, use the --with-expat-lib= option of the configure
> script.
>
> Le Thursday 19 February 2009 17:40:31 Kyle Shannon, vous avez ?crit :
> > Hello everyone, I am new(er) to linux and I tried to compile gdal on a
> new
> > workstation running Red Hat Enterprise Linux Server release 5.2.  I ran
> > into an error during compilation:
> >
> > /usr/lib/libexpat.so: could not read symbols: File in wrong format
> > collect2: ld returned 1 exit status
> > make[1]: *** [libgdal.la] Error 1
> > make[1]: Leaving directory `/home/kyle/gdal/gdal-1.6.0'
> > make: *** [check-lib] Error 2
> >
> >
> > I am hoping this is a simple issue where I just have to tell the
> configure
> > script something I missed.  Anyone have any ideas?  thank you.
> >
> > Other stats:
> > RHEL 5.2 64bit
> > gcc 4.1.2
> >
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> > Kyle Shannon
> > Physical Science Technician
> > RMRS Fire Sciences Lab
> > Fire, Fuels & Smoke - RWU 4405
> > 5775 Highway 10 W.
> > Missoula, MT 59808
> > (406)829-6954
> > kshannon@fs.fed.us
> > ksshannon@gmail.com
> > ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090220/a8d573ba/attachment.html
From randre at gmail.com  Fri Feb 20 11:50:07 2009
From: randre at gmail.com (=?ISO-8859-1?Q?Roger_Andr=E9?=)
Date: Fri Feb 20 11:50:10 2009
Subject: [gdal-dev] NetCDF data upside down when read by gdal
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E797@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <9c2015090902181245s7868f9f1s632748e9730eaaf3@mail.gmail.com>
	<DF1471B5C308B346BF5A2AEA00C5615E26E797@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <9c2015090902200850w2998d522qd154ef663b5240c2@mail.gmail.com>

Rockin`!

Thanks so much, that helps very much.

Roger
--

On Fri, Feb 20, 2009 at 8:32 AM, Gong, Shawn (Contractor) <
Shawn.Gong@drdc-rddc.gc.ca> wrote:

>  hi Roger,
>
>
>
> Here are cpp and h files that I modified to flip netCDF images.
>
> They are in ..\gdal-1.6.0\frmts\netcdf\
>
>
>
> hope that they help,
> Shawn
>
>
>  ------------------------------
>
> *From:* gdal-dev-bounces@lists.osgeo.org [mailto:
> gdal-dev-bounces@lists.osgeo.org] *On Behalf Of *Roger Andr?
> *Sent:* Wednesday, February 18, 2009 3:45 PM
> *To:* gdal-dev
> *Subject:* [gdal-dev] NetCDF data upside down when read by gdal
>
>
>
> Hi All,
>
> - I am attempting to use a NetCDF file as a data source for a raster layer
> in Mapserver.  According to a very useful email sent in November 2005 from
> Norman Barker,
> http://lists.osgeo.org/pipermail/mapserver-users/2005-November/012153.html,
> and from Mapserver documentation at
> http://www.mapserver.org/ogc/wcs_format.html#netcdf, it seems like this
> should be possible using Mapserver's gdal driver to read the file.  However,
> I am running into some problems when trying to implement these examples
> using GDAL 1.5.2, released 2008/05/29.
>
> - The NetCDF file which I am using to test with is a "CF Convention" sample
> file which I downloaded from
> http://www.unidata.ucar.edu/software/netcdf/examples/tos_O1_2001-2002.nc.
> This file contains information about sea-surface temperatures, and when
> viewed by gdalinfo has the following characteristics:
>
> $ gdalinfo tos_O1_2001-2002.nc
> Driver: netCDF/Network Common Data Format
> Files: tos_O1_2001-2002.nc
> Size is 512, 512
> Coordinate System is `'
> Metadata:
>   NC_GLOBAL#title=IPSL  model output prepared for IPCC Fourth Assessment
> SRES A2 experiment
>   NC_GLOBAL#institution=IPSL (Institut Pierre Simon Laplace, Paris, France)
>   NC_GLOBAL#source=IPSL-CM4_v1 (2003) : atmosphere : LMDZ (IPSL-CM4_IPCC,
> 96x71x19) ; ocean ORCA2 (ipsl_cm4_v1_8, 2x2L31); sea ice LIM (ipsl_cm4_v
>   NC_GLOBAL#contact=Sebastien Denvil, sebastien.denvil@ipsl.jussieu.fr
>   NC_GLOBAL#project_id=IPCC Fourth Assessment
>   NC_GLOBAL#table_id=Table O1 (13 November 2004)
>   NC_GLOBAL#experiment_id=SRES A2 experiment
>   NC_GLOBAL#realization=1
>   NC_GLOBAL#cmor_version=9.600000e-01
>   NC_GLOBAL#Conventions=CF-1.0
>   NC_GLOBAL#history=YYYY/MM/JJ: data generated; YYYY/MM/JJ+1 data
> transformed  At 16:37:23 on 01/11/2005, CMOR rewrote data to comply with CF
> standards and IPCC Fourth Assessment requirements
>   NC_GLOBAL#references=Dufresne et al, Journal of Climate, 2015, vol XX, p
> 136
>   NC_GLOBAL#comment=Test drive
> Subdatasets:
>   SUBDATASET_1_NAME=NETCDF:"tos_O1_2001-2002.nc":lon_bnds
>   SUBDATASET_1_DESC=[180x2] lon_bnds (64-bit floating-point)
>   SUBDATASET_2_NAME=NETCDF:"tos_O1_2001-2002.nc":lat_bnds
>   SUBDATASET_2_DESC=[170x2] lat_bnds (64-bit floating-point)
>   SUBDATASET_3_NAME=NETCDF:"tos_O1_2001-2002.nc":time_bnds
>   SUBDATASET_3_DESC=[24x2] time_bnds (64-bit floating-point)
>   SUBDATASET_4_NAME=NETCDF:"tos_O1_2001-2002.nc":tos
>   SUBDATASET_4_DESC=[24x170x180] sea_surface_temperature (32-bit
> floating-point)
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0,  512.0)
> Upper Right (  512.0,    0.0)
> Lower Right (  512.0,  512.0)
> Center      (  256.0,  256.0)
>
> - The SUBDATASET of interest is the "tos" one, and when queried by gdalinfo
> it shows that it contains 24 bands, each of which varies by
> NETCDF_DIMENSION_time that increments by 15.  When specifically queried by
> gdalinfo, this SUBDATASET looks like this:
>
> $ gdalinfo NETCDF:"tos_O1_2001-2002.nc":tos
> Driver: netCDF/Network Common Data Format
> Files: none associated
> Size is 180, 170
> Coordinate System is `'
> Origin = (0.000000000000000,90.000000000000000)
> Pixel Size = (2.000000000000000,-1.000000000000000)
> Metadata:
>   NC_GLOBAL#title=IPSL  model output prepared for IPCC Fourth Assessment
> SRES A2 experiment
>   NC_GLOBAL#institution=IPSL (Institut Pierre Simon Laplace, Paris, France)
>   NC_GLOBAL#source=IPSL-CM4_v1 (2003) : atmosphere : LMDZ (IPSL-CM4_IPCC,
> 96x71x19) ; ocean ORCA2 (ipsl_cm4_v1_8, 2x2L31); sea ice LIM (ipsl_cm4_v
>   NC_GLOBAL#contact=Sebastien Denvil, sebastien.denvil@ipsl.jussieu.fr
>   NC_GLOBAL#project_id=IPCC Fourth Assessment
>   NC_GLOBAL#table_id=Table O1 (13 November 2004)
>   NC_GLOBAL#experiment_id=SRES A2 experiment
>   NC_GLOBAL#realization=1
>   NC_GLOBAL#cmor_version=9.600000e-01
>   NC_GLOBAL#Conventions=CF-1.0
>   NC_GLOBAL#history=YYYY/MM/JJ: data generated; YYYY/MM/JJ+1 data
> transformed  At 16:37:23 on 01/11/2005, CMOR rewrote data to comply with CF
> standards and IPCC Fourth Assessment requirements
>   NC_GLOBAL#references=Dufresne et al, Journal of Climate, 2015, vol XX, p
> 136
>   NC_GLOBAL#comment=Test drive
>   tos#standard_name=sea_surface_temperature
>   tos#long_name=Sea Surface Temperature
>   tos#units=K
>   tos#cell_methods=time: mean (interval: 30 minutes)
>   tos#_FillValue=1.000000e+20
>   tos#missing_value=1.000000e+20
>   tos#original_name=sosstsst
>   tos#original_units=degC
>   tos#history= At   16:37:23 on 01/11/2005: CMOR altered the data in the
> following ways: added 2.73150E+02 to yield output units;  Cyclical dimension
> was output starting at a different lon;
>   lon#standard_name=longitude
>   lon#long_name=longitude
>   lon#units=degrees_east
>   lon#axis=X
>   lon#bounds=lon_bnds
>   lon#original_units=degrees_east
>   lat#standard_name=latitude
>   lat#long_name=latitude
>   lat#units=degrees_north
>   lat#axis=Y
>   lat#bounds=lat_bnds
>   lat#original_units=degrees_north
>   time#standard_name=time
>   time#long_name=time
>   time#units=days since 2001-1-1
>   time#axis=T
>   time#calendar=360_day
>   time#bounds=time_bnds
>   time#original_units=seconds since 2001-1-1
> Corner Coordinates:
> Upper Left  (   0.0000000,  90.0000000)
> Lower Left  (   0.0000000, -80.0000000)
> Upper Right (     360.000,      90.000)
> Lower Right (     360.000,     -80.000)
> Center      ( 180.0000000,   5.0000000)
> Band 1 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=15
>     NETCDF_time_units=days since 2001-1-1
> Band 2 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=45
>     NETCDF_time_units=days since 2001-1-1
> Band 3 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=75
>     NETCDF_time_units=days since 2001-1-1
> Band 4 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=105
>     NETCDF_time_units=days since 2001-1-1
> Band 5 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=135
>     NETCDF_time_units=days since 2001-1-1
> Band 6 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=165
>     NETCDF_time_units=days since 2001-1-1
> Band 7 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=195
>     NETCDF_time_units=days since 2001-1-1
> Band 8 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=225
>     NETCDF_time_units=days since 2001-1-1
> Band 9 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=255
>     NETCDF_time_units=days since 2001-1-1
> Band 10 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=285
>     NETCDF_time_units=days since 2001-1-1
> Band 11 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=315
>     NETCDF_time_units=days since 2001-1-1
> Band 12 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=345
>     NETCDF_time_units=days since 2001-1-1
> Band 13 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=375
>     NETCDF_time_units=days since 2001-1-1
> Band 14 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=405
>     NETCDF_time_units=days since 2001-1-1
> Band 15 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=435
>     NETCDF_time_units=days since 2001-1-1
> Band 16 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=465
>     NETCDF_time_units=days since 2001-1-1
> Band 17 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=495
>     NETCDF_time_units=days since 2001-1-1
> Band 18 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=525
>     NETCDF_time_units=days since 2001-1-1
> Band 19 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=555
>     NETCDF_time_units=days since 2001-1-1
> Band 20 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=585
>     NETCDF_time_units=days since 2001-1-1
> Band 21 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=615
>     NETCDF_time_units=days since 2001-1-1
> Band 22 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=645
>     NETCDF_time_units=days since 2001-1-1
> Band 23 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=675
>     NETCDF_time_units=days since 2001-1-1
> Band 24 Block=180x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=705
>     NETCDF_time_units=days since 2001-1-1
>
> - I am able to test that I can extract one of these bands with GDAL, and
> convert it to GeoTIFF with the following command:
> gdal_translate -b 1 NETCDF:"tos_O1_2001-2002.nc":tos sea_temp_band_1.tif.
> Here however is where the first problem appears.  As you can see from the
> screenshot of the sea_temp_band_1.tif that I've posted at
> http://2.bp.blogspot.com/_-yICqdt0mtY/SZxtI4yUHdI/AAAAAAAAA-I/z7W_O6qBXho/s1600-h/upside_down_netcdf.jpg,
> the data in the file appears to be represented upside down.  Since this file
> is a sample from the Unidata web site, I'm reasonably confident that the
> file follows the CF convention.  Every NetCDF file I have tried to read with
> GDAL has had this problem, including ones that I have created with
> gdal_translate.  As you can see from the gdalinfo output above, the
> georeferencing and pixel dimensions seem to be reasonable.  In the past I
> have used flip_raster.py to "fix" this, and created an intermediary
> GeoTIFF.  Now that I would like to use the NetCDF itself as the data source
> to feed a WCS service, this is no longer an acceptable solution.  Of
> interest though, is that the georeferencing info between the flipped and
> unflipped files are exactly the same.  See below:
>
> - Flipped file:
> ---------------
> $ gdalinfo flipped_sea_temp_band_1.tif
> Driver: GTiff/GeoTIFF
> Files: flipped_sea_temp_band_1.tif
> Size is 180, 170
> Coordinate System is `'
> Origin = (0.000000000000000,90.000000000000000)
> Pixel Size = (2.000000000000000,-1.000000000000000)
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (   0.0000000,  90.0000000)
> Lower Left  (   0.0000000, -80.0000000)
> Upper Right (     360.000,      90.000)
> Lower Right (     360.000,     -80.000)
> Center      ( 180.0000000,   5.0000000)
> Band 1 Block=180x11 Type=Float32, ColorInterp=Gray
>
> - Unflipped file:
> -----------------
> $ gdalinfo sea_temp_band_1.tif
> Driver: GTiff/GeoTIFF
> Files: sea_temp_band_1.tif
> Size is 180, 170
> Coordinate System is `'
> Origin = (0.000000000000000,90.000000000000000)
> Pixel Size = (2.000000000000000,-1.000000000000000)
> <snip> (Metadata removed for clarity)
> Image Structure Metadata:
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (   0.0000000,  90.0000000)
> Lower Left  (   0.0000000, -80.0000000)
> Upper Right (     360.000,      90.000)
> Lower Right (     360.000,     -80.000)
> Center      ( 180.0000000,   5.0000000)
> Band 1 Block=180x11 Type=Float32, ColorInterp=Gray
>   NoData Value=1.00000002004087734e+20
>   Metadata:
>     NETCDF_VARNAME=tos
>     NETCDF_DIMENSION_time=15
>     NETCDF_time_units=days since 2001-1-1
>
> - I'm unsure if this is a bug in GDAL, or an incorrectly formatted NetCDF
> file.  So, would it be possible for someone who has a NetCDF file that is
> read  "right-side-up" to post it as a sample for me to test with?
>
> Thanks in advance,
>
> Roger
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090220/d01169eb/attachment-0001.html
From bgiv at gmx.de  Fri Feb 20 12:18:08 2009
From: bgiv at gmx.de (Wolfgang Lahr)
Date: Fri Feb 20 12:18:12 2009
Subject: [gdal-dev] gdla wms tilecache
Message-ID: <1941627678.20090220181808@gmx.de>

Hello list,

I am having a hard time accessing a TileCache (v2.10) layer with the GDAL
(1.6) WMS driver. The cache was built from an UMN MapServer WMS. I can
access the tiled layer without any problem using OpenLayers. But when
I try to access the data via gdal (MapServer or gdal_translate), I can
see an image - however, the north-south alignment of the tiles seems
messed up, though the east-west direction aligns fine.

Thanks for any hints

Wolfgang

This is what gdal_info says:

Driver: WMS/OGC Web Map Service
Files: osm_cache.xml
Size is 65536, 54528
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.01745329251994328,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4326"]]
Origin = (7.500000000000000,51.750000000000000)
Pixel Size = (0.000045776367188,-0.000045848004695)
Corner Coordinates:
Upper Left  (   7.5000000,  51.7500000) (  7d30'0.00"E, 51d45'0.00"N)
Lower Left  (   7.5000000,  49.2500000) (  7d30'0.00"E, 49d15'0.00"N)
Upper Right (  10.5000000,  51.7500000) ( 10d30'0.00"E, 51d45'0.00"N)
Lower Right (  10.5000000,  49.2500000) ( 10d30'0.00"E, 49d15'0.00"N)
Center      (   9.0000000,  50.5000000) (  9d 0'0.00"E, 50d30'0.00"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Undefined
  Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426
Band 2 Block=256x256 Type=Byte, ColorInterp=Undefined
  Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426
Band 3 Block=256x256 Type=Byte, ColorInterp=Undefined
  Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426

From crschmidt at metacarta.com  Fri Feb 20 13:26:12 2009
From: crschmidt at metacarta.com (Christopher Schmidt)
Date: Fri Feb 20 13:26:17 2009
Subject: [gdal-dev] gdla wms tilecache
In-Reply-To: <1941627678.20090220181808@gmx.de>
References: <1941627678.20090220181808@gmx.de>
Message-ID: <20090220182612.GM15275@metacarta.com>

On Fri, Feb 20, 2009 at 06:18:08PM +0100, Wolfgang Lahr wrote:
> Hello list,
> 
> I am having a hard time accessing a TileCache (v2.10) layer with the GDAL
> (1.6) WMS driver. The cache was built from an UMN MapServer WMS. I can
> access the tiled layer without any problem using OpenLayers. But when
> I try to access the data via gdal (MapServer or gdal_translate), I can
> see an image - however, the north-south alignment of the tiles seems
> messed up, though the east-west direction aligns fine.
> 
> Thanks for any hints
> 
> Wolfgang
> 
> This is what gdal_info says:
> Band 1 Block=256x256 Type=Byte, ColorInterp=Undefined
>   Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426
> Band 2 Block=256x256 Type=Byte, ColorInterp=Undefined
>   Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426
> Band 3 Block=256x256 Type=Byte, ColorInterp=Undefined
>   Overviews: 32768x27264, 16384x13632, 8192x6816, 4096x3408, 2048x1704, 1024x852, 512x426

These seem odd -- like you might have your configuratio mixed up.
Generally speaking, TileCache tiles would be the same size in x/y
directions... 

Regards,
-- 
Christopher Schmidt
MetaCarta
From cjanssen at iavo-rs.com  Fri Feb 20 14:31:52 2009
From: cjanssen at iavo-rs.com (Christiaan Janssen)
Date: Fri Feb 20 15:01:54 2009
Subject: [gdal-dev] NITF file limitations
Message-ID: <4C7AE9E3-8956-4447-BD49-365DD4D5BC51@iavo-rs.com>

I was recently trying to open a NITF (jpeg blocked) file whose size was roughly 5GB using the stable 1.6 release and having quite a bit of trouble. Namely, I'm getting Access Violation Exception in the calls to CloseHandle. I dug around in the source a bit and noticed the code for the NITFdataset was referncing various file indexes that were stored in 32bit int's, this would obviously cause an issue for files of this size, maybe not specifically the issue I'm seeing but definitely with respect to raster data access. Does anyone know if this is a known issue and if so is there any way to work with this, or is this something thats needing to be addressed? Thanks.

Christiaan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090220/36205a70/attachment.html
From warmerdam at pobox.com  Fri Feb 20 15:40:46 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Feb 20 15:41:06 2009
Subject: [gdal-dev] NITF file limitations
In-Reply-To: <4C7AE9E3-8956-4447-BD49-365DD4D5BC51@iavo-rs.com>
References: <4C7AE9E3-8956-4447-BD49-365DD4D5BC51@iavo-rs.com>
Message-ID: <499F154E.5020101@pobox.com>

Christiaan Janssen wrote:
> I was recently trying to open a NITF (jpeg blocked) file whose size was 
> roughly 5GB using the stable 1.6 release and having quite a bit of 
> trouble. Namely, I'm getting Access Violation Exception in the calls to 
> CloseHandle. I dug around in the source a bit and noticed the code for 
> the NITFdataset was referncing various file indexes that were stored in 
> 32bit int's, this would obviously cause an issue for files of this size, 
> maybe not specifically the issue I'm seeing but definitely with respect 
> to raster data access. Does anyone know if this is a known issue and if 
> so is there any way to work with this, or is this something thats 
> needing to be addressed? Thanks.

Christian,

You are correct that the GDAL NITF driver was written based on the
assumption that NITF files are no larger than 4GB (the largest value
representable in a 32bit unsigned integer).

Reviewing the specification very briefly, I see that size values
are specified in a variety of ways, and for image data segment size
it is a 10 digit value which would in theory represent values up to
nearly 10GB.

The GDAL NITF driver could be upgraded to support large files but it
seems there are still significant issues inherent in the format with large
files.

I don't have any large files to test with, but if you are able to provide
your data file, and you are sufficiently motivated I could likely queue
up the task of adding "big file" support to the driver, at least for
reading.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From idlegod at gmail.com  Sat Feb 21 19:43:42 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sat Feb 21 19:43:44 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
Message-ID: <6702ec190902211643n2d70c36ap920cc49a57d1542d@mail.gmail.com>

I have a map that is in Lambert Conformal Conical, that I am
attempting to convert to something that is more "web friendly". That
is, vertical lines of longitude and straight lines of latitude,
hopefully with equal distance between latitudes. I have attempted to
use gdalwarp, but have had absolutely no luck even getting any
results.

Fortunately, the map has a bunch of data stamped on it that will
likely help in the conversion process.

Beside "standard parallels", it has 49 20  and 54 40, in degrees
minutes. I would presume 49 20 is for the south half of the map, and
54 40 is for the north half.

The scale is 1:500 000.

The topographic data is NAD27, although I don't know if that is pertinent.

The images are large; at 11696x4208.

I've prodded the IRC channel, but noone seems to be around, but this
list seems active.

I just don't understand what all the arguments really are, or mean, so
I can't even muddle my way through. I am apparently pretty bad at
finding any real examples of converting from LCC. Any help would be
greatly appreciated.
From idlegod at gmail.com  Sat Feb 21 23:07:49 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sat Feb 21 23:07:52 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <20090221224553.ALN67388@mymail.erau.edu>
References: <20090221224553.ALN67388@mymail.erau.edu>
Message-ID: <6702ec190902212007k5a693bcepa67f5b38cd7553df@mail.gmail.com>

>From the gdal_translate line, the images are identical, but with added
information to the tif, in a geotif style.

Once I warp it, the image is squished (as I would expect), but the
width is the same.

I have also tried embedding all of the geotiff data within the
intermediate image, but for some reason, I just cannot seem to set the
pixel size. If I create a wld or a tfw file, it just seems to ignore
it.

gdal_translate -of gtiff -CO TFW=YES -a_ullr -115 56 -105 54 -a_srs
"+proj=lcc +lat_0=56 +lon_0=-115 +lat_2=49.33 +lat_1=54.66 +x_0=0
+y_0=0 +datum=NAD27" n.tif nn.tif

I am wondering if perhaps its because photoshop added a bunch of
incorrect meta data:

Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
  TIFFTAG_DATETIME=2009:02:21 16:15:49
  TIFFTAG_XRESOLUTION=72
  TIFFTAG_YRESOLUTION=72
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)

To my eyes, that looks like 72pixels per inch, which is about right
for the scanner it came in from, but wrong for the actual map scale. I
cannot find a way in photoshop to change that, and it definitely
doesn't like scaling to sizes below 1.0

On Sat, Feb 21, 2009 at 8:45 PM, Wendy Fay Stevenson <stevensw@erau.edu> wrote:
> Hi
>
> Have you not got a world file for your image?
> I would agree that the pixel size does not seem right.  I
> would try writing my own world file with reasonable values -
> just to see if the image come out looking better.  Make sure
> you call it the same name as your original tiff file (with
> .wld or .twf extention) and gdal will automatically pick it
> up.
>
> What results do you get if you run gdalinfo on the new file?
> Does it have more or less the same number of pixels?
>
> I know you can set the resolution with gdalwarp but I haven't
> tried that.
>
> About the false eastings and northings, it would very much
> depend on the projection of the original image.  If they do
> not specify I would assume they are 0.
>
> Wendy
>
From idlegod at gmail.com  Sat Feb 21 23:37:26 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sat Feb 21 23:37:29 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <20090221231741.ALN67929@mymail.erau.edu>
References: <20090221231741.ALN67929@mymail.erau.edu>
Message-ID: <6702ec190902212037j4764266fu29c49eee629be598@mail.gmail.com>

Hm, so maybe that value is correct.

1/0.000854993160055 is 1169.59999999961637120000, which would mean its
about 1px per km.

I think I found an issue even before I warp:
gdal_translate -of gtiff -CO TFW=YES -a_ullr -115 56 -105 54 -a_srs
"+proj=lcc +lat_0=56 +lon_0=-115 +lat_2=49.33 +lat_1=54.66 +x_0=0
+y_0=0 +datum=NAD27" n.tif nn.tif

Upper Left  (-115.0000000,  56.0000000) (115d 0'6.63"W, 56d 0'1.81"N)
Lower Left  (-115.0000000,  54.0000000) (115d 0'6.63"W, 56d 0'1.74"N)
Upper Right (-105.0000000,  56.0000000) (115d 0'6.05"W, 56d 0'1.81"N)
Lower Right (-105.0000000,  54.0000000) (115d 0'6.05"W, 56d 0'1.74"N)
Center      (-110.0000000,  55.0000000) (115d 0'6.34"W, 56d 0'1.78"N)

Apparently a_ullr isn't setting it correctly...



On Sat, Feb 21, 2009 at 9:17 PM, Wendy Fay Stevenson <stevensw@erau.edu> wrote:
> Hi
>
> Why not save it as a GIF or JPG and then give it to gdalwarp
> (with a world file)?  I think that if you specify a geotiff
> file gdalwarp would use the information inside the file.  So
> photoshop adding those tags could very well cause a problem.
>
> Remember, the pixel size is in the units of the projection, in
> this case meters.
>
> Wendy
>
From szekerest at gmail.com  Sun Feb 22 12:24:53 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sun Feb 22 12:24:57 2009
Subject: [gdal-dev] MapServer and GDAL build SDKs available
Message-ID: <f3b73b7d0902220924t770c1a23p26566d30ad416744@mail.gmail.com>

Folks,

I've uploaded my latest SDK packages which provide a quick solution to make
consistent debug or release builds with various compiler versions and
architectures. The Windows builders of the GDAL buildbot have already been
relying on these packages for quite a long time (until the buildbot was
alive ;-)
Those packages contain a number of the precompiled libraries required to be
able to build GDAL and MapServer successfully, each of the dependencies have
been compiled by using the same compiler so as to avoid the possible memory
issues reated to the mixed CRT dependencies. For this reason mixing the
dll-s and libs among these packages is highly discouraged and unsupported.
For the compiling instructions please refer to the readme.txt contained by
the packages. The supported dependencies/versions are enumerated in the /doc
subdirectory of the packages.
The C# packages correspond to the compiler default .NET Framework versions
1.1, 2.0 and 3.5.

The various versions of the packages can be downloaded from these locations:

MSVC2003 (Win32):  http://vbkto.dyndns.org:1280/sdk/release-1310-dev.zip
MSVC2005 (Win32):  http://vbkto.dyndns.org:1280/sdk/release-1400-dev.zip
MSVC2005 (Win64):  http://vbkto.dyndns.org:1280/sdk/release-1400-x64-dev.zip
MSVC2008 (Win32):  http://vbkto.dyndns.org:1280/sdk/release-1500-dev.zip
MSVC2008 (Win64):  http://vbkto.dyndns.org:1280/sdk/release-1500-x64-dev.zip


You can download the corresponding binary only standalone packages from
these locations:

MSVC2003 (Win32):
http://vbkto.dyndns.org:1280/sdk/release-1310-gdal-1-6-mapserver.zip
MSVC2005 (Win32):
http://vbkto.dyndns.org:1280/sdk/release-1400-gdal-1-6-mapserver.zip
MSVC2005 (Win64):
http://vbkto.dyndns.org:1280/sdk/release-1400-x64-gdal-1-6-mapserver.zip
MSVC2008 (Win32):
http://vbkto.dyndns.org:1280/sdk/release-1500-gdal-1-6-mapserver.zip
MSVC2008 (Win64):
http://vbkto.dyndns.org:1280/sdk/release-1500-x64-gdal-1-6-mapserver.zip

In the near future (hopefully) I'll present automated daily builds of the
binaries for the development versions of GDAL and MapServer to be able to
stay in sync with the latest changes/fixes in the SVN easily.


Let me know about your experences, wishes

Best regards

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090222/94128360/attachment.html
From idlegod at gmail.com  Sun Feb 22 12:38:35 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sun Feb 22 12:38:39 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
References: <20090221234738.ALN68400@mymail.erau.edu>
	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
Message-ID: <6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>

I am still battleing this conversion. I was just informed, via IRC,
that gdal won't overwrite existing files, so I may have been making a
difference, but not knowing it. In any case, I tossed together a
simple script, that thus far, does nothing...

#!/bin/sh

rm -rf nn.tif n-merc.tif

echo '*** Translate ***'
gdal_translate n.tif nn.tif -of gtiff -CO TFW=YES -mo
TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_ullr -115d0 56d0
-105d0 54d0 -a_srs "+proj=lcc +lat_0=54 +lon_0=-115 +lat_1=49.33
+lat_2=54.66 +x_0=0 +y_0=0 +datum=NAD27 +ellps=clrk80"

echo '***   Warp    ***'
gdalwarp -t_srs "+proj=merc +datum=WGS84" nn.tif n-merc.tif

open n-merc.tif


I have also posted the source file I am working with, albeit scaled
down and converted so its not 140mb.

http://game-sat.com/~brian/north.png

What concerns me is what gdalinfo gives me for the intermediate step,
as the georeferenced coordinates are dead wrong. If I remove the a_srs
to assign it as being an actual lambert conformal projection, it
doesn't even have the georeferenced options, just the first ones.

$ gdalinfo nn.tif
Driver: GTiff/GeoTIFF
Files: nn.tif
Size is 11696, 4208
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["NAD27",
        DATUM["North_American_Datum_1927",
            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
                AUTHORITY["EPSG","7008"]],
            AUTHORITY["EPSG","6267"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4267"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",49.33],
    PARAMETER["standard_parallel_2",54.66],
    PARAMETER["latitude_of_origin",54],
    PARAMETER["central_meridian",-115],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-115.000000000000000,56.000000000000000)
Pixel Size = (0.000854993160055,-0.000475285171103)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
  TIFFTAG_DATETIME=2009:02:21 16:15:49
  TIFFTAG_XRESOLUTION=0
  TIFFTAG_YRESOLUTION=0
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (-115.0000000,  56.0000000) (115d 0'6.32"W, 54d 0'1.81"N)
Lower Left  (-115.0000000,  54.0000000) (115d 0'6.32"W, 54d 0'1.75"N)
Upper Right (-105.0000000,  56.0000000) (115d 0'5.77"W, 54d 0'1.81"N)
Lower Right (-105.0000000,  54.0000000) (115d 0'5.77"W, 54d 0'1.75"N)
Center      (-110.0000000,  55.0000000) (115d 0'6.04"W, 54d 0'1.78"N)
Band 1 Block=11696x1 Type=Byte, ColorInterp=Red
Band 2 Block=11696x1 Type=Byte, ColorInterp=Green
Band 3 Block=11696x1 Type=Byte, ColorInterp=Blue


On Sat, Feb 21, 2009 at 9:55 PM, Brian Murray <idlegod@gmail.com> wrote:
> I'm trying to get all of it. :)
>
> It appears like a_allr is ok, but then when I apply the definition, it
> only grabs a few meters of the real map...
>
> I think I must have to set the scale to something. I just don't know
> what yet... I am going to sleep on it. I found some sites that have
> some calculations for that now.
>
> On Sat, Feb 21, 2009 at 9:47 PM, Wendy Fay Stevenson <stevensw@erau.edu> wrote:
>> Um, it looks like it's doing what you're asking it to do.
>> What corner points are you wanting?
>>
>
From jluis at ualg.pt  Sun Feb 22 14:59:47 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Sun Feb 22 14:59:58 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
References: <20090221234738.ALN68400@mymail.erau.edu>	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
	<6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
Message-ID: <49A1AEB3.2020007@ualg.pt>



Brian,

The left side of your image contains a ... legend, so it's not part of the
map. How can any program guess what is legend and where the map starts?

Joaquim Luis

> I am still battleing this conversion. I was just informed, via IRC,
> that gdal won't overwrite existing files, so I may have been making a
> difference, but not knowing it. In any case, I tossed together a
> simple script, that thus far, does nothing...
> 
> #!/bin/sh
> 
> rm -rf nn.tif n-merc.tif
> 
> echo '*** Translate ***'
> gdal_translate n.tif nn.tif -of gtiff -CO TFW=YES -mo
> TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_ullr -115d0 56d0
> -105d0 54d0 -a_srs "+proj=lcc +lat_0=54 +lon_0=-115 +lat_1=49.33
> +lat_2=54.66 +x_0=0 +y_0=0 +datum=NAD27 +ellps=clrk80"
> 
> echo '***   Warp    ***'
> gdalwarp -t_srs "+proj=merc +datum=WGS84" nn.tif n-merc.tif
> 
> open n-merc.tif
> 
> 
> I have also posted the source file I am working with, albeit scaled
> down and converted so its not 140mb.
> 
> http://game-sat.com/~brian/north.png
> 
> What concerns me is what gdalinfo gives me for the intermediate step,
> as the georeferenced coordinates are dead wrong. If I remove the a_srs
> to assign it as being an actual lambert conformal projection, it
> doesn't even have the georeferenced options, just the first ones.
> 
> $ gdalinfo nn.tif
> Driver: GTiff/GeoTIFF
> Files: nn.tif
> Size is 11696, 4208
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["NAD27",
>         DATUM["North_American_Datum_1927",
>             SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
>                 AUTHORITY["EPSG","7008"]],
>             AUTHORITY["EPSG","6267"]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433],
>         AUTHORITY["EPSG","4267"]],
>     PROJECTION["Lambert_Conformal_Conic_2SP"],
>     PARAMETER["standard_parallel_1",49.33],
>     PARAMETER["standard_parallel_2",54.66],
>     PARAMETER["latitude_of_origin",54],
>     PARAMETER["central_meridian",-115],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-115.000000000000000,56.000000000000000)
> Pixel Size = (0.000854993160055,-0.000475285171103)
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
>   TIFFTAG_DATETIME=2009:02:21 16:15:49
>   TIFFTAG_XRESOLUTION=0
>   TIFFTAG_YRESOLUTION=0
>   TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
> Image Structure Metadata:
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (-115.0000000,  56.0000000) (115d 0'6.32"W, 54d 0'1.81"N)
> Lower Left  (-115.0000000,  54.0000000) (115d 0'6.32"W, 54d 0'1.75"N)
> Upper Right (-105.0000000,  56.0000000) (115d 0'5.77"W, 54d 0'1.81"N)
> Lower Right (-105.0000000,  54.0000000) (115d 0'5.77"W, 54d 0'1.75"N)
> Center      (-110.0000000,  55.0000000) (115d 0'6.04"W, 54d 0'1.78"N)
> Band 1 Block=11696x1 Type=Byte, ColorInterp=Red
> Band 2 Block=11696x1 Type=Byte, ColorInterp=Green
> Band 3 Block=11696x1 Type=Byte, ColorInterp=Blue
> 
> 
> On Sat, Feb 21, 2009 at 9:55 PM, Brian Murray <idlegod@gmail.com> wrote:
>> I'm trying to get all of it. :)
>>
>> It appears like a_allr is ok, but then when I apply the definition, it
>> only grabs a few meters of the real map...
>>
>> I think I must have to set the scale to something. I just don't know
>> what yet... I am going to sleep on it. I found some sites that have
>> some calculations for that now.
>>
>> On Sat, Feb 21, 2009 at 9:47 PM, Wendy Fay Stevenson <stevensw@erau.edu> wrote:
>>> Um, it looks like it's doing what you're asking it to do.
>>> What corner points are you wanting?
>>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From idlegod at gmail.com  Sun Feb 22 15:03:48 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sun Feb 22 15:03:53 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
References: <20090221234738.ALN68400@mymail.erau.edu>
	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
	<6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
Message-ID: <6702ec190902221203i6c19342en2b94e7bd583733c@mail.gmail.com>

I finally have positive results, that I figured I should share here
(especially since this thread is already indexed on google...)

First, I created the world file for my map. I calculated the pixel
size by getting the number of pixels between each line of longitude. I
found this to be 65.5 (1 division being 1/2 a degree, or 30 minutes,
which translates to about 55.56km. 848 pixels / 55560 = 65.5).

You may ask, how do I calculate the false easting/northing? I have no
clue. I just dumped some numbers into a website
(http://www.gazza.co.nz/datumshift.html) and viola, they were valid. I
don't even know what false easting/northings are. I gather they are
something to do with how many meters off of 0 you are, but really, no
idea.

$ cat north.wld
65.5
0
0
-65.5
8223265.173
4204567.856

Note, this world file is a companion to north.tif. While the false
east/northings are correct for any file with at the same location, the
pixels per meter measure (65) is different depending on the resolution
of the file.

Next, I wipe out all of my existing working files. gdal will _NOT_
overwrite existing files. I found this out the hard way.

rm -rf nn.* n-merc.*

Next, I converted my simple tif file to a geotif file. Photoshop added
some xres data, which I wiped, but I don't believe it is necessary.
a_ullr seems to break things, so I opted for the world file from above
instead.

echo '*** Translate ***'
gdal_translate north.tif nn.tif -of gtiff -CO TFW=YES -mo
TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_srs "+proj=lcc
+lat_0=56 +lon_0=-115 +lat_1=49d20 +lat_2=54d40 +y_0=4204567.856
+x_0=8223265.173 +k_0=1.17230169 +datum=NAD27 +ellps=clrk80"

Note, I created a worldfile (-co TFW=YES), but this is not required.
GeoTIFF puts all of that data within the metadata of the file.

Calculating the definition (-a_srs) was rather difficult. The websites
I found were rather poorly documented. They had a lot of very
technical details, and very few laymans terms (for people like me).

lat_0 and lon_0 are the origins. That is, the lat and lon from the top
left of the image.
lat_1 and lat_2 are the standard parallels. The map I have had these
listed on it. While I cannot confirm this, these are often lines of
latitude that are 30% and 60% of the map. These are where the
"invisible cone" intersect the plane of the sphere. Everywhere between
these lines is above the cone, where all lines outside of these lines
is behind the cone. At least, thats how I understand it.
x_0 and y_0 are frustrating. I have no idea how to calculate these.
Northing is the X, and Easting is the Y, from the values from the
above website. I do not know if the website for proj is wrong, or if
the calculator is wrong. All I know is I had them backwards before,
and nothing worked right.
I don't think the k_0 is necessary, or even used, but the calculator
gave it to me, so I entered it.
Datum was written on my map as "topographic data". It was not written
with the other data, but I found it on the bottom of the map key. I
took a blind stab at the ellps.

Now I have a file called nn.tif. It contains all of the info that
properly described my map. All I had to do was tell gdalwarp what to
warp it to, and viola, out came a proper map.

echo '***   Warp    ***'
gdalwarp nn.tif n-merc.tif -t_srs "+proj=merc +datum=WGS84"

This tells gdalwarp to produce a mercator projection. Then I opened
it, and viola, it was "bent", where it was flat on the left, and
twisted all the way along to the right.

Also, you can cut out the gdal_translate, and use 1 line with the
world file instead:

gdalwarp north.tif n-merc.tif -s_srs "+proj=lcc +lat_0=56 +lon_0=-115
+lat_1=49d20 +lat_2=54d40 +y_0=4204567.856 +x_0=8223265.173
+k_0=1.17230169 +datum=NAD27 +ellps=clrk80" -t_srs "+proj=merc
+datum=WGS84"

This does the same steps, but overrides any data within the geotiff
tags. This should (and does) take a bit longer. If you have 1 map, and
want to do several projections, create an intermediary and warp
multiple times.
From idlegod at gmail.com  Sun Feb 22 15:05:36 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sun Feb 22 15:05:39 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <49A1AEB3.2020007@ualg.pt>
References: <20090221234738.ALN68400@mymail.erau.edu>
	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
	<6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
	<49A1AEB3.2020007@ualg.pt>
Message-ID: <6702ec190902221205q5e43f633v3ff3c8d1262821da@mail.gmail.com>

I know. I left that on there in the mean time while I figured out the
translations. It wasn't even bending the map at all before. The
software just sees the image as a blob of data, that you have to tell
it how to transform, so it really didn't care that the map had a
legend left on it. In my last post, I describe how I finally got it to
work. :)

On Sun, Feb 22, 2009 at 12:59 PM, Joaquim Luis <jluis@ualg.pt> wrote:
>
>
> Brian,
>
> The left side of your image contains a ... legend, so it's not part of the
> map. How can any program guess what is legend and where the map starts?
>
> Joaquim Luis
>
>> I am still battleing this conversion. I was just informed, via IRC,
>> that gdal won't overwrite existing files, so I may have been making a
>> difference, but not knowing it. In any case, I tossed together a
>> simple script, that thus far, does nothing...
>>
>> #!/bin/sh
>>
>> rm -rf nn.tif n-merc.tif
>>
>> echo '*** Translate ***'
>> gdal_translate n.tif nn.tif -of gtiff -CO TFW=YES -mo
>> TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_ullr -115d0 56d0
>> -105d0 54d0 -a_srs "+proj=lcc +lat_0=54 +lon_0=-115 +lat_1=49.33
>> +lat_2=54.66 +x_0=0 +y_0=0 +datum=NAD27 +ellps=clrk80"
>>
>> echo '***   Warp    ***'
>> gdalwarp -t_srs "+proj=merc +datum=WGS84" nn.tif n-merc.tif
>>
>> open n-merc.tif
>>
>>
>> I have also posted the source file I am working with, albeit scaled
>> down and converted so its not 140mb.
>>
>> http://game-sat.com/~brian/north.png
>>
>> What concerns me is what gdalinfo gives me for the intermediate step,
>> as the georeferenced coordinates are dead wrong. If I remove the a_srs
>> to assign it as being an actual lambert conformal projection, it
>> doesn't even have the georeferenced options, just the first ones.
>>
>> $ gdalinfo nn.tif
>> Driver: GTiff/GeoTIFF
>> Files: nn.tif
>> Size is 11696, 4208
>> Coordinate System is:
>> PROJCS["unnamed",
>>    GEOGCS["NAD27",
>>        DATUM["North_American_Datum_1927",
>>            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
>>                AUTHORITY["EPSG","7008"]],
>>            AUTHORITY["EPSG","6267"]],
>>        PRIMEM["Greenwich",0],
>>        UNIT["degree",0.0174532925199433],
>>        AUTHORITY["EPSG","4267"]],
>>    PROJECTION["Lambert_Conformal_Conic_2SP"],
>>    PARAMETER["standard_parallel_1",49.33],
>>    PARAMETER["standard_parallel_2",54.66],
>>    PARAMETER["latitude_of_origin",54],
>>    PARAMETER["central_meridian",-115],
>>    PARAMETER["false_easting",0],
>>    PARAMETER["false_northing",0],
>>    UNIT["metre",1,
>>        AUTHORITY["EPSG","9001"]]]
>> Origin = (-115.000000000000000,56.000000000000000)
>> Pixel Size = (0.000854993160055,-0.000475285171103)
>> Metadata:
>>  AREA_OR_POINT=Area
>>  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
>>  TIFFTAG_DATETIME=2009:02:21 16:15:49
>>  TIFFTAG_XRESOLUTION=0
>>  TIFFTAG_YRESOLUTION=0
>>  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>> Image Structure Metadata:
>>  INTERLEAVE=PIXEL
>> Corner Coordinates:
>> Upper Left  (-115.0000000,  56.0000000) (115d 0'6.32"W, 54d 0'1.81"N)
>> Lower Left  (-115.0000000,  54.0000000) (115d 0'6.32"W, 54d 0'1.75"N)
>> Upper Right (-105.0000000,  56.0000000) (115d 0'5.77"W, 54d 0'1.81"N)
>> Lower Right (-105.0000000,  54.0000000) (115d 0'5.77"W, 54d 0'1.75"N)
>> Center      (-110.0000000,  55.0000000) (115d 0'6.04"W, 54d 0'1.78"N)
>> Band 1 Block=11696x1 Type=Byte, ColorInterp=Red
>> Band 2 Block=11696x1 Type=Byte, ColorInterp=Green
>> Band 3 Block=11696x1 Type=Byte, ColorInterp=Blue
>>
>>
>> On Sat, Feb 21, 2009 at 9:55 PM, Brian Murray <idlegod@gmail.com> wrote:
>>>
>>> I'm trying to get all of it. :)
>>>
>>> It appears like a_allr is ok, but then when I apply the definition, it
>>> only grabs a few meters of the real map...
>>>
>>> I think I must have to set the scale to something. I just don't know
>>> what yet... I am going to sleep on it. I found some sites that have
>>> some calculations for that now.
>>>
>>> On Sat, Feb 21, 2009 at 9:47 PM, Wendy Fay Stevenson <stevensw@erau.edu>
>>> wrote:
>>>>
>>>> Um, it looks like it's doing what you're asking it to do.
>>>> What corner points are you wanting?
>>>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
>
From jluis at ualg.pt  Sun Feb 22 15:24:27 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Sun Feb 22 15:24:30 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <6702ec190902221205q5e43f633v3ff3c8d1262821da@mail.gmail.com>
References: <20090221234738.ALN68400@mymail.erau.edu>	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>	<6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>	<49A1AEB3.2020007@ualg.pt>
	<6702ec190902221205q5e43f633v3ff3c8d1262821da@mail.gmail.com>
Message-ID: <49A1B47B.3090501@ualg.pt>

Brian Murray wrote:
> I know. I left that on there in the mean time while I figured out the
> translations. It wasn't even bending the map at all before. The
> software just sees the image as a blob of data, that you have to tell
> it how to transform, so it really didn't care that the map had a
> legend left on it. In my last post, I describe how I finally got it to
> work. :)

Good for you,

... but are you sure it worked? I mean, are you sure that it is correctly
referenced?
At half way of the description I just quit following it (sorry, too complicated for me).

Joaquim Luis

> 
> On Sun, Feb 22, 2009 at 12:59 PM, Joaquim Luis <jluis@ualg.pt> wrote:
>>
>> Brian,
>>
>> The left side of your image contains a ... legend, so it's not part of the
>> map. How can any program guess what is legend and where the map starts?
>>
>> Joaquim Luis
>>
>>> I am still battleing this conversion. I was just informed, via IRC,
>>> that gdal won't overwrite existing files, so I may have been making a
>>> difference, but not knowing it. In any case, I tossed together a
>>> simple script, that thus far, does nothing...
>>>
>>> #!/bin/sh
>>>
>>> rm -rf nn.tif n-merc.tif
>>>
>>> echo '*** Translate ***'
>>> gdal_translate n.tif nn.tif -of gtiff -CO TFW=YES -mo
>>> TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_ullr -115d0 56d0
>>> -105d0 54d0 -a_srs "+proj=lcc +lat_0=54 +lon_0=-115 +lat_1=49.33
>>> +lat_2=54.66 +x_0=0 +y_0=0 +datum=NAD27 +ellps=clrk80"
>>>
>>> echo '***   Warp    ***'
>>> gdalwarp -t_srs "+proj=merc +datum=WGS84" nn.tif n-merc.tif
>>>
>>> open n-merc.tif
>>>
>>>
>>> I have also posted the source file I am working with, albeit scaled
>>> down and converted so its not 140mb.
>>>
>>> http://game-sat.com/~brian/north.png
>>>
>>> What concerns me is what gdalinfo gives me for the intermediate step,
>>> as the georeferenced coordinates are dead wrong. If I remove the a_srs
>>> to assign it as being an actual lambert conformal projection, it
>>> doesn't even have the georeferenced options, just the first ones.
>>>
>>> $ gdalinfo nn.tif
>>> Driver: GTiff/GeoTIFF
>>> Files: nn.tif
>>> Size is 11696, 4208
>>> Coordinate System is:
>>> PROJCS["unnamed",
>>>    GEOGCS["NAD27",
>>>        DATUM["North_American_Datum_1927",
>>>            SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
>>>                AUTHORITY["EPSG","7008"]],
>>>            AUTHORITY["EPSG","6267"]],
>>>        PRIMEM["Greenwich",0],
>>>        UNIT["degree",0.0174532925199433],
>>>        AUTHORITY["EPSG","4267"]],
>>>    PROJECTION["Lambert_Conformal_Conic_2SP"],
>>>    PARAMETER["standard_parallel_1",49.33],
>>>    PARAMETER["standard_parallel_2",54.66],
>>>    PARAMETER["latitude_of_origin",54],
>>>    PARAMETER["central_meridian",-115],
>>>    PARAMETER["false_easting",0],
>>>    PARAMETER["false_northing",0],
>>>    UNIT["metre",1,
>>>        AUTHORITY["EPSG","9001"]]]
>>> Origin = (-115.000000000000000,56.000000000000000)
>>> Pixel Size = (0.000854993160055,-0.000475285171103)
>>> Metadata:
>>>  AREA_OR_POINT=Area
>>>  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
>>>  TIFFTAG_DATETIME=2009:02:21 16:15:49
>>>  TIFFTAG_XRESOLUTION=0
>>>  TIFFTAG_YRESOLUTION=0
>>>  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>>> Image Structure Metadata:
>>>  INTERLEAVE=PIXEL
>>> Corner Coordinates:
>>> Upper Left  (-115.0000000,  56.0000000) (115d 0'6.32"W, 54d 0'1.81"N)
>>> Lower Left  (-115.0000000,  54.0000000) (115d 0'6.32"W, 54d 0'1.75"N)
>>> Upper Right (-105.0000000,  56.0000000) (115d 0'5.77"W, 54d 0'1.81"N)
>>> Lower Right (-105.0000000,  54.0000000) (115d 0'5.77"W, 54d 0'1.75"N)
>>> Center      (-110.0000000,  55.0000000) (115d 0'6.04"W, 54d 0'1.78"N)
>>> Band 1 Block=11696x1 Type=Byte, ColorInterp=Red
>>> Band 2 Block=11696x1 Type=Byte, ColorInterp=Green
>>> Band 3 Block=11696x1 Type=Byte, ColorInterp=Blue
>>>
>>>
>>> On Sat, Feb 21, 2009 at 9:55 PM, Brian Murray <idlegod@gmail.com> wrote:
>>>> I'm trying to get all of it. :)
>>>>
>>>> It appears like a_allr is ok, but then when I apply the definition, it
>>>> only grabs a few meters of the real map...
>>>>
>>>> I think I must have to set the scale to something. I just don't know
>>>> what yet... I am going to sleep on it. I found some sites that have
>>>> some calculations for that now.
>>>>
>>>> On Sat, Feb 21, 2009 at 9:47 PM, Wendy Fay Stevenson <stevensw@erau.edu>
>>>> wrote:
>>>>> Um, it looks like it's doing what you're asking it to do.
>>>>> What corner points are you wanting?
>>>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>>
>>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

From idlegod at gmail.com  Sun Feb 22 15:31:19 2009
From: idlegod at gmail.com (Brian Murray)
Date: Sun Feb 22 15:31:23 2009
Subject: [gdal-dev] Converting from Lambert (LCC) to latlong/mercator
In-Reply-To: <49A1B47B.3090501@ualg.pt>
References: <20090221234738.ALN68400@mymail.erau.edu>
	<6702ec190902212055y3fb48f6eq62c2f130216f7d30@mail.gmail.com>
	<6702ec190902220938g71ccb181p65c568cd159afe3b@mail.gmail.com>
	<49A1AEB3.2020007@ualg.pt>
	<6702ec190902221205q5e43f633v3ff3c8d1262821da@mail.gmail.com>
	<49A1B47B.3090501@ualg.pt>
Message-ID: <6702ec190902221231h3cd0a713medcfa1ea13b9f40@mail.gmail.com>

Yep. Its a tad bit off (less then 5% for sure), but I also have the
lat/long values about 5% off, since I picked a lat/long that wasn't at
the edges. Once I adjust those, it will be OK now. I did remove the
legend, which will help. I just left it on there while it wasn't
scaling at all.

On Sun, Feb 22, 2009 at 1:24 PM, Joaquim Luis <jluis@ualg.pt> wrote:
> Brian Murray wrote:
>>
>> I know. I left that on there in the mean time while I figured out the
>> translations. It wasn't even bending the map at all before. The
>> software just sees the image as a blob of data, that you have to tell
>> it how to transform, so it really didn't care that the map had a
>> legend left on it. In my last post, I describe how I finally got it to
>> work. :)
>
> Good for you,
>
> ... but are you sure it worked? I mean, are you sure that it is correctly
> referenced?
> At half way of the description I just quit following it (sorry, too
> complicated for me).
>
> Joaquim Luis
>
>>
>> On Sun, Feb 22, 2009 at 12:59 PM, Joaquim Luis <jluis@ualg.pt> wrote:
>>>
>>> Brian,
>>>
>>> The left side of your image contains a ... legend, so it's not part of
>>> the
>>> map. How can any program guess what is legend and where the map starts?
>>>
>>> Joaquim Luis
>>>
>>>> I am still battleing this conversion. I was just informed, via IRC,
>>>> that gdal won't overwrite existing files, so I may have been making a
>>>> difference, but not knowing it. In any case, I tossed together a
>>>> simple script, that thus far, does nothing...
>>>>
>>>> #!/bin/sh
>>>>
>>>> rm -rf nn.tif n-merc.tif
>>>>
>>>> echo '*** Translate ***'
>>>> gdal_translate n.tif nn.tif -of gtiff -CO TFW=YES -mo
>>>> TIFFTAG_XRESOLUTION= -mo TIFFTAG_YRESOLUTION= -a_ullr -115d0 56d0
>>>> -105d0 54d0 -a_srs "+proj=lcc +lat_0=54 +lon_0=-115 +lat_1=49.33
>>>> +lat_2=54.66 +x_0=0 +y_0=0 +datum=NAD27 +ellps=clrk80"
>>>>
>>>> echo '***   Warp    ***'
>>>> gdalwarp -t_srs "+proj=merc +datum=WGS84" nn.tif n-merc.tif
>>>>
>>>> open n-merc.tif
>>>>
>>>>
>>>> I have also posted the source file I am working with, albeit scaled
>>>> down and converted so its not 140mb.
>>>>
>>>> http://game-sat.com/~brian/north.png
>>>>
>>>> What concerns me is what gdalinfo gives me for the intermediate step,
>>>> as the georeferenced coordinates are dead wrong. If I remove the a_srs
>>>> to assign it as being an actual lambert conformal projection, it
>>>> doesn't even have the georeferenced options, just the first ones.
>>>>
>>>> $ gdalinfo nn.tif
>>>> Driver: GTiff/GeoTIFF
>>>> Files: nn.tif
>>>> Size is 11696, 4208
>>>> Coordinate System is:
>>>> PROJCS["unnamed",
>>>>   GEOGCS["NAD27",
>>>>       DATUM["North_American_Datum_1927",
>>>>           SPHEROID["Clarke 1866",6378206.4,294.9786982139006,
>>>>               AUTHORITY["EPSG","7008"]],
>>>>           AUTHORITY["EPSG","6267"]],
>>>>       PRIMEM["Greenwich",0],
>>>>       UNIT["degree",0.0174532925199433],
>>>>       AUTHORITY["EPSG","4267"]],
>>>>   PROJECTION["Lambert_Conformal_Conic_2SP"],
>>>>   PARAMETER["standard_parallel_1",49.33],
>>>>   PARAMETER["standard_parallel_2",54.66],
>>>>   PARAMETER["latitude_of_origin",54],
>>>>   PARAMETER["central_meridian",-115],
>>>>   PARAMETER["false_easting",0],
>>>>   PARAMETER["false_northing",0],
>>>>   UNIT["metre",1,
>>>>       AUTHORITY["EPSG","9001"]]]
>>>> Origin = (-115.000000000000000,56.000000000000000)
>>>> Pixel Size = (0.000854993160055,-0.000475285171103)
>>>> Metadata:
>>>>  AREA_OR_POINT=Area
>>>>  TIFFTAG_SOFTWARE=Adobe Photoshop CS3 Macintosh
>>>>  TIFFTAG_DATETIME=2009:02:21 16:15:49
>>>>  TIFFTAG_XRESOLUTION=0
>>>>  TIFFTAG_YRESOLUTION=0
>>>>  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
>>>> Image Structure Metadata:
>>>>  INTERLEAVE=PIXEL
>>>> Corner Coordinates:
>>>> Upper Left  (-115.0000000,  56.0000000) (115d 0'6.32"W, 54d 0'1.81"N)
>>>> Lower Left  (-115.0000000,  54.0000000) (115d 0'6.32"W, 54d 0'1.75"N)
>>>> Upper Right (-105.0000000,  56.0000000) (115d 0'5.77"W, 54d 0'1.81"N)
>>>> Lower Right (-105.0000000,  54.0000000) (115d 0'5.77"W, 54d 0'1.75"N)
>>>> Center      (-110.0000000,  55.0000000) (115d 0'6.04"W, 54d 0'1.78"N)
>>>> Band 1 Block=11696x1 Type=Byte, ColorInterp=Red
>>>> Band 2 Block=11696x1 Type=Byte, ColorInterp=Green
>>>> Band 3 Block=11696x1 Type=Byte, ColorInterp=Blue
>>>>
>>>>
>>>> On Sat, Feb 21, 2009 at 9:55 PM, Brian Murray <idlegod@gmail.com> wrote:
>>>>>
>>>>> I'm trying to get all of it. :)
>>>>>
>>>>> It appears like a_allr is ok, but then when I apply the definition, it
>>>>> only grabs a few meters of the real map...
>>>>>
>>>>> I think I must have to set the scale to something. I just don't know
>>>>> what yet... I am going to sleep on it. I found some sites that have
>>>>> some calculations for that now.
>>>>>
>>>>> On Sat, Feb 21, 2009 at 9:47 PM, Wendy Fay Stevenson
>>>>> <stevensw@erau.edu>
>>>>> wrote:
>>>>>>
>>>>>> Um, it looks like it's doing what you're asking it to do.
>>>>>> What corner points are you wanting?
>>>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev@lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>>
>>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
>
From trailcode at gmail.com  Sun Feb 22 18:06:08 2009
From: trailcode at gmail.com (trailcode)
Date: Sun Feb 22 18:06:10 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <1235327043246-2368577.post@n2.nabble.com>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
	<1234368653400-2309579.post@n2.nabble.com>
	<200902111939.19537.even.rouault@mines-paris.org>
	<1235071675324-2354972.post@n2.nabble.com>
	<200902192033.05505.even.rouault@mines-paris.org>
	<1235327043246-2368577.post@n2.nabble.com>
Message-ID: <1235343968133-2369562.post@n2.nabble.com>


I got gdal java binding to work with win32. I downloaded the jre from:
http://udig.refractions.net/files/downloads/jre/

And used it to execute my test program. For the java .jar files I am not
using gdal.jar but the jars which come with: imageio-ext

The thing which is strange is if I copy the gdaljni.dll gdal14.dll and other
.dll files from the jdk downloaded above to my project dir and set my
java.library.path to point to them I get the same old unsatisfied link
error. I even tried copying over all .dll files in the JDK tree but got the
same message. 

Does anyone have any idea what is going on here?

I would like to create an application distributable via jnlp.

Thanks,
Matthew Tang 
-- 
View this message in context: http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2369562.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From dany.geotools at gmail.com  Mon Feb 23 06:23:32 2009
From: dany.geotools at gmail.com (Daniele Romagnoli)
Date: Mon Feb 23 06:23:36 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <1235343968133-2369562.post@n2.nabble.com>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
	<1234368653400-2309579.post@n2.nabble.com>
	<200902111939.19537.even.rouault@mines-paris.org>
	<1235071675324-2354972.post@n2.nabble.com>
	<200902192033.05505.even.rouault@mines-paris.org>
	<1235327043246-2368577.post@n2.nabble.com>
	<1235343968133-2369562.post@n2.nabble.com>
Message-ID: <7221db410902230323t277169d9rc44d756fd8925a56@mail.gmail.com>

Hi,
please read below.

On Mon, Feb 23, 2009 at 12:06 AM, trailcode <trailcode@gmail.com> wrote:

>
> I got gdal java binding to work with win32. I downloaded the jre from:
> http://udig.refractions.net/files/downloads/jre/


Note that these libraries have been built against GDAL 1.4.4.
Where do you have placed the DLLs to let them work during your first test?



> <http://udig.refractions.net/files/downloads/jre/>
>
> And used it to execute my test program. For the java .jar files I am not
> using gdal.jar but the jars which come with: imageio-ext
>
> The thing which is strange is if I copy the gdaljni.dll gdal14.dll and
> other
> .dll files from the jdk downloaded above to my project dir and set my
> java.library.path to point to them I get the same old unsatisfied link
> error. I even tried copying over all .dll files in the JDK tree but got the
> same message.
>
> Does anyone have any idea what is going on here?


On Windows, we have sometime noticed similar issues on DLL native libs
loading. Not sure what is happening when this occurs. (Be sure that all
required libraries are together with these DLLs (A check with "Dependency
walker" may be helpful)).
A solution could be putting them on your JDK/bin being sure that the same
libs aren't somewhere on folders linked by your PATH env.  (Be sure you
don't have old GDAL Libs somewhere hidden on your machine)
This could be helpful to do some initial testings. See my next feeddback
about JNLP.


>
>
> I would like to create an application distributable via jnlp.


We are working on creating a web start application involving other native
libraries (not GDAL related).
Therefore we will handle native DLLs loading and some feedbacks on this
topic will come in the near future (we are working on it this week).

Cheers,
Daniele



>
>
> Thanks,
> Matthew Tang
> --
> View this message in context:
> http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2369562.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090223/d62c8da6/attachment.html
From collinsb at mitre.org  Mon Feb 23 09:06:52 2009
From: collinsb at mitre.org (Collins, Benjamin)
Date: Mon Feb 23 11:23:04 2009
Subject: [Gdal-dev] GDAL 1.6 Java binding, Windows
In-Reply-To: <7221db410902230323t277169d9rc44d756fd8925a56@mail.gmail.com>
References: <1234216091798-2299600.post@n2.nabble.com>
	<200902092308.48871.even.rouault@mines-paris.org>
	<1234368653400-2309579.post@n2.nabble.com>
	<200902111939.19537.even.rouault@mines-paris.org>
	<1235071675324-2354972.post@n2.nabble.com>
	<200902192033.05505.even.rouault@mines-paris.org>
	<1235327043246-2368577.post@n2.nabble.com>
	<1235343968133-2369562.post@n2.nabble.com>
	<7221db410902230323t277169d9rc44d756fd8925a56@mail.gmail.com>
Message-ID: <77F7C5B5FC691E438C577AEDAC9D6D560C5047C76A@IMCMBX4.MITRE.ORG>

If one native library (DLL) loads another, the "java.library.path" variable will not be honored, since it's not Java doing the load, but the OS trying to resolve the dependencies for the DLL.  As Daniele suggested, Dependency Walker is a great tool for finding out the relationships between libraries.
To solve this problem in software I write, I often do a "defensive load".  You can call System.loadLibrary() with the secondary library and have Java load it up from the "java.library.path".  Then, when the JNI library is loaded, the library it depends on will already be in memory ready to go.  Using this technique I have never had to place native libraries in the JDK itself.  This method work only on windows, where DLLs are reused in a process by default, and will most likely not work on other platforms.

--
Ben

From: gdal-dev-bounces@lists.osgeo.org [mailto:gdal-dev-bounces@lists.osgeo.org] On Behalf Of Daniele Romagnoli
Sent: Monday, February 23, 2009 6:24 AM
To: trailcode
Cc: gdal-dev@lists.osgeo.org
Subject: Re: [Gdal-dev] GDAL 1.6 Java binding, Windows

Hi,
please read below.
On Mon, Feb 23, 2009 at 12:06 AM, trailcode <trailcode@gmail.com<mailto:trailcode@gmail.com>> wrote:

I got gdal java binding to work with win32. I downloaded the jre from:
http://udig.refractions.net/files/downloads/jre/

Note that these libraries have been built against GDAL 1.4.4.
Where do you have placed the DLLs to let them work during your first test?




And used it to execute my test program. For the java .jar files I am not
using gdal.jar but the jars which come with: imageio-ext

The thing which is strange is if I copy the gdaljni.dll gdal14.dll and other
.dll files from the jdk downloaded above to my project dir and set my
java.library.path to point to them I get the same old unsatisfied link
error. I even tried copying over all .dll files in the JDK tree but got the
same message.

Does anyone have any idea what is going on here?

On Windows, we have sometime noticed similar issues on DLL native libs loading. Not sure what is happening when this occurs. (Be sure that all required libraries are together with these DLLs (A check with "Dependency walker" may be helpful)).
A solution could be putting them on your JDK/bin being sure that the same libs aren't somewhere on folders linked by your PATH env.  (Be sure you don't have old GDAL Libs somewhere hidden on your machine)
This could be helpful to do some initial testings. See my next feeddback about JNLP.



I would like to create an application distributable via jnlp.

We are working on creating a web start application involving other native libraries (not GDAL related).
Therefore we will handle native DLLs loading and some feedbacks on this topic will come in the near future (we are working on it this week).

Cheers,
Daniele




Thanks,
Matthew Tang
--
View this message in context: http://n2.nabble.com/GDAL-1.6-Java-binding%2C-Windows-tp2299600p2369562.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org<mailto:gdal-dev@lists.osgeo.org>
http://lists.osgeo.org/mailman/listinfo/gdal-dev



--
-------------------------------------------------------
Eng. Daniele Romagnoli
Software Engineer

GeoSolutions S.A.S.
Via Carignoni 51
55041 Camaiore (LU)
Italy

phone: +39 0584983027
fax:     +39 0584983027
mob:   +39 328 0559267


http://www.geo-solutions.it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090223/3511b2af/attachment-0001.html
From Shawn.Gong at drdc-rddc.gc.ca  Mon Feb 23 18:32:42 2009
From: Shawn.Gong at drdc-rddc.gc.ca (Gong, Shawn (Contractor))
Date: Mon Feb 23 18:32:46 2009
Subject: [gdal-dev] BandReadAsArray speed up
Message-ID: <DF1471B5C308B346BF5A2AEA00C5615E26E7A4@ottawaex02.Ottawa.drdc-rddc.gc.ca>

hi list,


I am reading the image data for a bandobj, using BandReadAsArray() which works, but it is sometimes slow.? 
Is it actually reading from the file?? Is there a way to access the image data that is already in memory, or anything else I could do to speed it up?


thanks,
Shawn


From hobu.inc at gmail.com  Mon Feb 23 19:54:39 2009
From: hobu.inc at gmail.com (Howard Butler)
Date: Mon Feb 23 19:54:43 2009
Subject: [gdal-dev] BandReadAsArray speed up
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E7A4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E7A4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <36DFAAAE-6505-48AB-900A-2ADCDDE571A2@gmail.com>


On Feb 23, 2009, at 5:32 PM, Gong, Shawn (Contractor) wrote:

> hi list,
>
>
> I am reading the image data for a bandobj, using BandReadAsArray()  
> which works, but it is sometimes slow.
> Is it actually reading from the file?  Is there a way to access the  
> image data that is already in memory, or anything else I could do to  
> speed it up?
>

BandReadAsArray has regressed a bit from old-gen bindings to new-gen  
bindings.  Specifically, it is reallocating every time a read happens  
instead of allowing you to fill an already existing array.  This might  
give you a significant speedup depending on your circumstances.  I  
hope to fix this bug at the Toronto sprint.

http://wiki.osgeo.org/wiki/Toronto_Code_Sprint_2009

http://trac.osgeo.org/gdal/ticket/2658


Howard
From warmerdam at pobox.com  Mon Feb 23 20:19:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Mon Feb 23 20:20:13 2009
Subject: [gdal-dev] BandReadAsArray speed up
In-Reply-To: <DF1471B5C308B346BF5A2AEA00C5615E26E7A4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
References: <DF1471B5C308B346BF5A2AEA00C5615E26E7A4@ottawaex02.Ottawa.drdc-rddc.gc.ca>
Message-ID: <49A34B3E.2070603@pobox.com>

Gong, Shawn (Contractor) wrote:
> hi list,
> 
> 
> I am reading the image data for a bandobj, using BandReadAsArray() which
> works, but it is sometimes slow. Is it actually reading from the file?  Is
> there a way to access the image data that is already in memory, or anything
> else I could do to speed it up?

Shawn,

BandReadAsArray() calls the GDALRasterBand::RasterIO() function which will
normally first search the block cache for information before actually
asking the driver for data though this can be overridden by some driver
implementations.  Often slow read data access against large datasets is
caused by cache thrashing.  For instance if you ask for scanlines from a
tile oriented format, but a row of tiles in the block cache add up to more
memory than is set aside for the block cache, then by the time the last tile
for the scanline is read, the first will be discarded.  Thus subsequent
scanline requests will cause all the data to be re-read from the underlying
driver.

If this is what is happening, you can improve things by upping the block
cache size (GDAL_CACHEMAX config options or there is also a specific set call
in python for this).

There are many other possible reasons for poor performance too.

I will note that the extra array allocation that Howard mentions will only
make a very modest difference in performance.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From lucafasano at interfree.it  Tue Feb 24 03:33:48 2009
From: lucafasano at interfree.it (LF)
Date: Tue Feb 24 03:34:06 2009
Subject: [gdal-dev] Re: Conflicts when using GDAL with minGW
References: <4553AE0A.7070903@missouri.edu>
Message-ID: <loom.20090224T083314-540@post.gmane.org>

Ozy Sjahputera <sjahputerao <at> missouri.edu> writes:

> ...
>
> error: `snprintf' is not a member of `std'
> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
> declaration of C function `float _copysign(float, float)' conflicts with 
> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
> declaration of C function `long double _copysign(long double, long 
> double)' conflicts with
> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
> previous declaration `double _copysign(double, double)' here 
> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
> previous declaration `float _copysign(float, float)' here
> 
> The following is my GDAL headers included:
> #include <gdal_priv.h>
> #include <cpl_string.h>
> #include <ogr_spatialref.h>
> #include <gdalwarper.h>
> 
> It seems that the GDAL library is causing some functions in the minGW 
> C++ library (cstdio) to be undeclared.
> 
> Has anyone experienced this kind of conflict?
> 
> Thanks
> Ozy
> 

Hi
I've a problem like your one.
I tried to compile a PLUGIN for GDAL and I included files as following:

#include gdal_priv.h
#include hdf5.h
#include gdal_pam.h
#include gdal_priv.h
#include cpl_string.h
#include ogr_spatialref.h
#include cpl_list.h

I had two conflicts between mingw and gdal for variables *_copysign*
and *ssize_t*, defined in both mingw and gdal. 
Should I define some macros or other else when I want to compile GDAL 
with MinGW?

Someone could help us??





From lucafasano at interfree.it  Tue Feb 24 05:25:13 2009
From: lucafasano at interfree.it (LF)
Date: Tue Feb 24 05:25:29 2009
Subject: [gdal-dev] Re: Conflicts when using GDAL with minGW
References: <4553AE0A.7070903@missouri.edu>
	<loom.20090224T083314-540@post.gmane.org>
Message-ID: <loom.20090224T102056-939@post.gmane.org>

LF <lucafasano <at> interfree.it> writes:

> > It seems that the GDAL library is causing some functions in the minGW 
> > C++ library (cstdio) to be undeclared.
> I had two conflicts between mingw and gdal for variables *_copysign*
> and *ssize_t*, defined in both mingw and gdal. 
> Should I define some macros or other else when I want to compile GDAL 
> with MinGW?

As you can see I use HDF5 library. Could it cause my problem??

From didier.richard at ign.fr  Tue Feb 24 06:55:11 2009
From: didier.richard at ign.fr (RICHARD Didier)
Date: Tue Feb 24 07:02:57 2009
Subject: [gdal-dev] [1.6.0][GDALWARP] World file name is empty
Message-ID: <32928.87.231.96.39.1235476511.squirrel@webmail.ign.fr>

Hi all,

I am having the following behavior with gdalwarp (freshly compiled from
1.6.0) when I am requiring to get a tfw file (former releases didn't have
this behavior) :

$ gdalwarp ... -co "TFW=YES" in.tif out.tif

"out.tif" and ".tfw" files are generated (before 1.6.0, I got "out.tif"
and "out.tfw")

If I remove the -co "TFW=YES", only the "out.tif" is produced. Then,

$ gdal_translate -co "TFW=YES" out.tif out2.tif

"out2.tif" and "out2.tfw" are generated as expected.

I noticed that osFilename is empty in WriteGeoTIFFInfo() function.
A workaround solution (for me only) was to add :

poDS->osFilename = pszFilename;

at line 5420 of GTiffDataset::Create() function in geotiff.cpp.


Did anyone else face this behavior ?

Should I put a ticket (I didn't find such a report in the trac) ?

Sincerely,

didier
-- 
RICHARD Didier - Chef du p?le technique du G?oportail
2/4, avenue Pasteur - 94165 Saint Mand? Cedex
T?l : +33 (0) 1 43 98 83 23
From warmerdam at pobox.com  Tue Feb 24 13:18:45 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue Feb 24 13:19:06 2009
Subject: [gdal-dev] [1.6.0][GDALWARP] World file name is empty
In-Reply-To: <32928.87.231.96.39.1235476511.squirrel@webmail.ign.fr>
References: <32928.87.231.96.39.1235476511.squirrel@webmail.ign.fr>
Message-ID: <49A43A05.50507@pobox.com>

RICHARD Didier wrote:
> Hi all,
> 
> I am having the following behavior with gdalwarp (freshly compiled from
> 1.6.0) when I am requiring to get a tfw file (former releases didn't have
> this behavior) :
> 
> $ gdalwarp ... -co "TFW=YES" in.tif out.tif
> 
> "out.tif" and ".tfw" files are generated (before 1.6.0, I got "out.tif"
> and "out.tfw")
> 
> If I remove the -co "TFW=YES", only the "out.tif" is produced. Then,
> 
> $ gdal_translate -co "TFW=YES" out.tif out2.tif
> 
> "out2.tif" and "out2.tfw" are generated as expected.
> 
> I noticed that osFilename is empty in WriteGeoTIFFInfo() function.
> A workaround solution (for me only) was to add :
> 
> poDS->osFilename = pszFilename;
> 
> at line 5420 of GTiffDataset::Create() function in geotiff.cpp.
> 
> 
> Did anyone else face this behavior ?
> 
> Should I put a ticket (I didn't find such a report in the trac) ?

Didier,

I was unable to reproduce this problem and it appears that
GTiffDataset::Create() does assign osFilename with pszFilename fairly
prominately in trunk and 1.6 branch.  I suspect this is a problem someone
already noticed and fixed.  I'd appreciate it if you could confirm the
behavior no longer occurs for you with trunk (or 1.6 branch if that is
convenient for you to build from).  If the problem persists, then filing
a ticket would be appropriate.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From even.rouault at mines-paris.org  Tue Feb 24 13:28:34 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue Feb 24 13:28:50 2009
Subject: [gdal-dev] [1.6.0][GDALWARP] World file name is empty
In-Reply-To: <49A43A05.50507@pobox.com>
References: <32928.87.231.96.39.1235476511.squirrel@webmail.ign.fr>
	<49A43A05.50507@pobox.com>
Message-ID: <200902241928.35501.even.rouault@mines-paris.org>

Hi,

yes that very same problem was detected in 1.6.0 as ticket 
http://trac.osgeo.org/gdal/ticket/2760 and it was fixed in both trunk and 
branches/1.6. So it will be solved in 1.6.1.

Best regards,

Even

Le Tuesday 24 February 2009 19:18:45 Frank Warmerdam, vous avez ?crit?:
> RICHARD Didier wrote:
> > Hi all,
> >
> > I am having the following behavior with gdalwarp (freshly compiled from
> > 1.6.0) when I am requiring to get a tfw file (former releases didn't have
> > this behavior) :
> >
> > $ gdalwarp ... -co "TFW=YES" in.tif out.tif
> >
> > "out.tif" and ".tfw" files are generated (before 1.6.0, I got "out.tif"
> > and "out.tfw")
> >
> > If I remove the -co "TFW=YES", only the "out.tif" is produced. Then,
> >
> > $ gdal_translate -co "TFW=YES" out.tif out2.tif
> >
> > "out2.tif" and "out2.tfw" are generated as expected.
> >
> > I noticed that osFilename is empty in WriteGeoTIFFInfo() function.
> > A workaround solution (for me only) was to add :
> >
> > poDS->osFilename = pszFilename;
> >
> > at line 5420 of GTiffDataset::Create() function in geotiff.cpp.
> >
> >
> > Did anyone else face this behavior ?
> >
> > Should I put a ticket (I didn't find such a report in the trac) ?
>
> Didier,
>
> I was unable to reproduce this problem and it appears that
> GTiffDataset::Create() does assign osFilename with pszFilename fairly
> prominately in trunk and 1.6 branch.  I suspect this is a problem someone
> already noticed and fixed.  I'd appreciate it if you could confirm the
> behavior no longer occurs for you with trunk (or 1.6 branch if that is
> convenient for you to build from).  If the problem persists, then filing
> a ticket would be appropriate.
>
> Best regards,


From didier.richard at ign.fr  Tue Feb 24 14:30:00 2009
From: didier.richard at ign.fr (RICHARD Didier)
Date: Tue Feb 24 14:38:52 2009
Subject: [gdal-dev] [1.6.0][GDALWARP] World file name is empty
In-Reply-To: <200902241928.35501.even.rouault@mines-paris.org>
References: <32928.87.231.96.39.1235476511.squirrel@webmail.ign.fr>
	<49A43A05.50507@pobox.com>
	<200902241928.35501.even.rouault@mines-paris.org>
Message-ID: <34048.87.231.96.39.1235503800.squirrel@webmail.ign.fr>


> Hi,
>
> yes that very same problem was detected in 1.6.0 as ticket
> http://trac.osgeo.org/gdal/ticket/2760 and it was fixed in both trunk and
> branches/1.6. So it will be solved in 1.6.1.
>

Thanks Even (I could not find it in the trac), and yes (Frank), it is
working with the trunk !

All the best,

didier

> Best regards,
>
> Even
>
> Le Tuesday 24 February 2009 19:18:45 Frank Warmerdam, vous avez ?crit :
>> RICHARD Didier wrote:
>> > Hi all,
>> >
>> > I am having the following behavior with gdalwarp (freshly compiled
>> from
>> > 1.6.0) when I am requiring to get a tfw file (former releases didn't
>> have
>> > this behavior) :
>> >
>> > $ gdalwarp ... -co "TFW=YES" in.tif out.tif
>> >
>> > "out.tif" and ".tfw" files are generated (before 1.6.0, I got
>> "out.tif"
>> > and "out.tfw")
>> >
>> > If I remove the -co "TFW=YES", only the "out.tif" is produced. Then,
>> >
>> > $ gdal_translate -co "TFW=YES" out.tif out2.tif
>> >
>> > "out2.tif" and "out2.tfw" are generated as expected.
>> >
>> > I noticed that osFilename is empty in WriteGeoTIFFInfo() function.
>> > A workaround solution (for me only) was to add :
>> >
>> > poDS->osFilename = pszFilename;
>> >
>> > at line 5420 of GTiffDataset::Create() function in geotiff.cpp.
>> >
>> >
>> > Did anyone else face this behavior ?
>> >
>> > Should I put a ticket (I didn't find such a report in the trac) ?
>>
>> Didier,
>>
>> I was unable to reproduce this problem and it appears that
>> GTiffDataset::Create() does assign osFilename with pszFilename fairly
>> prominately in trunk and 1.6 branch.  I suspect this is a problem
>> someone
>> already noticed and fixed.  I'd appreciate it if you could confirm the
>> behavior no longer occurs for you with trunk (or 1.6 branch if that is
>> convenient for you to build from).  If the problem persists, then filing
>> a ticket would be appropriate.
>>
>> Best regards,
>
>
>


-- 
RICHARD Didier - Chef du p?le technique du G?oportail
2/4, avenue Pasteur - 94165 Saint Mand? Cedex
T?l : +33 (0) 1 43 98 83 23
From ari.jolma at tkk.fi  Wed Feb 25 02:01:35 2009
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Wed Feb 25 02:03:11 2009
Subject: [gdal-dev] Re: Conflicts when using GDAL with minGW
In-Reply-To: <loom.20090224T083314-540@post.gmane.org>
References: <4553AE0A.7070903@missouri.edu>
	<loom.20090224T083314-540@post.gmane.org>
Message-ID: <49A4ECCF.4020108@tkk.fi>

LF kirjoitti:
> Ozy Sjahputera <sjahputerao <at> missouri.edu> writes:
>
>   
>> ...
>>
>> error: `snprintf' is not a member of `std'
>> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
>> declaration of C function `float _copysign(float, float)' conflicts with 
>> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
>> declaration of C function `long double _copysign(long double, long 
>> double)' conflicts with
>> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
>> previous declaration `double _copysign(double, double)' here 
>> e:/MinGW/bin/../lib/gcc/mingw32/3.4.2/../../../../include/math.h error: 
>> previous declaration `float _copysign(float, float)' here
>>
>> The following is my GDAL headers included:
>> #include <gdal_priv.h>
>> #include <cpl_string.h>
>> #include <ogr_spatialref.h>
>> #include <gdalwarper.h>
>>
>> It seems that the GDAL library is causing some functions in the minGW 
>> C++ library (cstdio) to be undeclared.
>>
>> Has anyone experienced this kind of conflict?
>>
>> Thanks
>> Ozy
>>
>>     
>
> Hi
> I've a problem like your one.
> I tried to compile a PLUGIN for GDAL and I included files as following:
>
> #include gdal_priv.h
> #include hdf5.h
> #include gdal_pam.h
> #include gdal_priv.h
> #include cpl_string.h
> #include ogr_spatialref.h
> #include cpl_list.h
>
> I had two conflicts between mingw and gdal for variables *_copysign*
> and *ssize_t*, defined in both mingw and gdal. 
> Should I define some macros or other else when I want to compile GDAL 
> with MinGW?
>
> Someone could help us??
>   

I don't get any errors compiling in msys ("gcc -I/local/include 
-Ihdf5-1.8.2/src test.cpp") simple programs with those includes. I don't 
use hdf5 so I used hdf5.h from a configured source I just downloaded.

My gcc is 3.4.5

Best regards,

Ari


>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>   


-- 
Prof. Ari Jolma
Environmental Management Information Technology
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 4511 address: POBox 5300, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://geoinformatics.tkk.fi

From szekerest at gmail.com  Wed Feb 25 16:34:37 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Wed Feb 25 16:34:41 2009
Subject: [gdal-dev] MapServer and GDAL daily build Windows binaries available
Message-ID: <f3b73b7d0902251334i3aac7715wfe7aea21ebc4d61b@mail.gmail.com>

Hi All,

I've set up a build server providing daily snapshot builds for various
compilers/architectures and created a root page containing the links to the
results (along with the build SDKs have been used for the builds)

http://vbkto.dyndns.org:1280/sdk/index.html

You can simply download and use any of the build snapshots to be able to
obtain the Windows binaries with the recent fixes without requiring to
compile by yourself. But if you would rather compile by hand (eg for
debugging purposes) just pick up the SDK packages providing a ready to use
compile environment for all of those platforms enumerated.

You may encounter some features missing (like swigpython binaries,
mapscript-java etc) which are about to be added shortly, after I make sure
those are working equally well on all platforms. I'll also provide links to
the corresponding autotest results until the buildbot configuration is not
resurrected.



Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090225/2d0fc055/attachment.html
From even.rouault at mines-paris.org  Wed Feb 25 18:23:09 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed Feb 25 18:23:20 2009
Subject: [gdal-dev] MapServer and GDAL daily build Windows binaries
	available
In-Reply-To: <f3b73b7d0902251334i3aac7715wfe7aea21ebc4d61b@mail.gmail.com>
References: <f3b73b7d0902251334i3aac7715wfe7aea21ebc4d61b@mail.gmail.com>
Message-ID: <200902260023.10524.even.rouault@mines-paris.org>

Tamas,

this is a very good initiative ! It works pretty well as I've been able to run 
the Java GDAL apps from trunk under Wine ! (The apps themselves are not 
included in the bin/gdal/java directory of your packages, as they were 
missing from the ant build.xml. I've just commited a change in r16417, so 
that the .class should be generated in swig/java/build/apps)

wine 
~/.wine/c/Program\Files/Java/jre6/bin/java.exe -cp "../../swig/java/apps;./gdal.jar" 
gdalinfo byte.tif

(And I also hope we'll see buildbot working again soon.)

Best regards.

Even

Le Wednesday 25 February 2009 22:34:37 Tamas Szekeres, vous avez ?crit?:
> Hi All,
>
> I've set up a build server providing daily snapshot builds for various
> compilers/architectures and created a root page containing the links to the
> results (along with the build SDKs have been used for the builds)
>
> http://vbkto.dyndns.org:1280/sdk/index.html
>
> You can simply download and use any of the build snapshots to be able to
> obtain the Windows binaries with the recent fixes without requiring to
> compile by yourself. But if you would rather compile by hand (eg for
> debugging purposes) just pick up the SDK packages providing a ready to use
> compile environment for all of those platforms enumerated.
>
> You may encounter some features missing (like swigpython binaries,
> mapscript-java etc) which are about to be added shortly, after I make sure
> those are working equally well on all platforms. I'll also provide links to
> the corresponding autotest results until the buildbot configuration is not
> resurrected.
>
>
>
> Best regards,
>
> Tamas


From nicholas.g.lawrence at mainroads.qld.gov.au  Wed Feb 25 19:23:55 2009
From: nicholas.g.lawrence at mainroads.qld.gov.au (nicholas.g.lawrence@mainroads.qld.gov.au)
Date: Wed Feb 25 19:39:14 2009
Subject: [gdal-dev] weeding out x,y,z points
Message-ID: <OF937DB916.7C91F09A-ON4A257569.0001FF2E-4A257569.0002304E@transport.qld.gov.au>


A client has a very large (millions of records) ascii file consisting
solely of x,y,z co-ordinates.

They would like to reduce the number of records by weeking out points that
are too close to each other.

Can GDAL or OGR weed out 3D points based on proximity to each other?

Regards,
nick


***********************************************************************
WARNING: This e-mail (including any attachments) may contain legally
privileged, confidential or private information and may be protected by
copyright. You may only use it if you are the person(s) it was intended
to be sent to and if you use it in an authorised way.  No one is 
allowed to use, review, alter, transmit, disclose, distribute, print 
or copy this e-mail without appropriate authority.

If this e-mail was not intended for you and was sent to you by mistake,
please telephone or e-mail me immediately, destroy any hardcopies of
this e-mail and delete it and any copies of it from your computer
system. Any right which the sender may have under copyright law, and 
any legal privilege and confidentiality attached to this e-mail is not 
waived or destroyed by that mistake.

It is your responsibility to ensure that this e-mail does not contain
and is not affected by computer viruses, defects or interference by
third parties or replication problems (including incompatibility with
your computer system).

Opinions contained in this e-mail do not necessarily reflect the
opinions of the Queensland Department of Main Roads, Queensland
Transport or Maritime Safety Queensland, or endorsed organisations
utilising the same infrastructure.
***********************************************************************

From mateusz at loskot.net  Wed Feb 25 20:02:12 2009
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed Feb 25 20:02:19 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <OF937DB916.7C91F09A-ON4A257569.0001FF2E-4A257569.0002304E@transport.qld.gov.au>
References: <OF937DB916.7C91F09A-ON4A257569.0001FF2E-4A257569.0002304E@transport.qld.gov.au>
Message-ID: <49A5EA14.7040100@loskot.net>

nicholas.g.lawrence@mainroads.qld.gov.au wrote:
> A client has a very large (millions of records) ascii file consisting
>  solely of x,y,z co-ordinates.
> 
> They would like to reduce the number of records by weeking out points
> that are too close to each other.
> 
> Can GDAL or OGR weed out 3D points based on proximity to each other?

Perhaps libLAS (http://liblas.org/) and its utils will help, try txt2las
with -scale or -xyz_scale option:

http://liblas.org/browser/trunk/doc/txt2las.txt

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net
Charter Member of OSGeo, http://osgeo.org
From jluis at ualg.pt  Wed Feb 25 22:31:47 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Feb 25 22:32:11 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <OF937DB916.7C91F09A-ON4A257569.0001FF2E-4A257569.0002304E@transport.qld.gov.au>
References: <OF937DB916.7C91F09A-ON4A257569.0001FF2E-4A257569.0002304E@transport.qld.gov.au>
Message-ID: <49A60D23.3010304@ualg.pt>

nicholas.g.lawrence@mainroads.qld.gov.au wrote:
> A client has a very large (millions of records) ascii file consisting
> solely of x,y,z co-ordinates.
> 
> They would like to reduce the number of records by weeking out points that
> are too close to each other.
> 
> Can GDAL or OGR weed out 3D points based on proximity to each other?


A job for GMT's blockmean or blockmedian.

Joaquim Luis
From nicholas.g.lawrence at mainroads.qld.gov.au  Wed Feb 25 23:56:24 2009
From: nicholas.g.lawrence at mainroads.qld.gov.au (nicholas.g.lawrence@mainroads.qld.gov.au)
Date: Wed Feb 25 23:56:33 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <49A60D23.3010304@ualg.pt>
Message-ID: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>

> nicholas.g.lawrence@mainroads.qld.gov.au wrote:
> > A client has a very large (millions of records) ascii file consisting
> > solely of x,y,z co-ordinates.
> >
> > They would like to reduce the number of records by weeking out points
that
> > are too close to each other.
> >
> > Can GDAL or OGR weed out 3D points based on proximity to each other?

>
> A job for GMT's blockmean or blockmedian.

> Joaquim Luis

Okay, I downloaded the Manpages.

My initial reading is that blockmean and blockmedian work by averaging
the values.

My client says that they want the resulting data points to be
a subset of the original data points, that is the process should
delete points, not re-calculate new ones that are an average.

Is this still do-able? Is there a specific option I should
be looking at?

Regards,
nick


***********************************************************************
WARNING: This e-mail (including any attachments) may contain legally
privileged, confidential or private information and may be protected by
copyright. You may only use it if you are the person(s) it was intended
to be sent to and if you use it in an authorised way.  No one is 
allowed to use, review, alter, transmit, disclose, distribute, print 
or copy this e-mail without appropriate authority.

If this e-mail was not intended for you and was sent to you by mistake,
please telephone or e-mail me immediately, destroy any hardcopies of
this e-mail and delete it and any copies of it from your computer
system. Any right which the sender may have under copyright law, and 
any legal privilege and confidentiality attached to this e-mail is not 
waived or destroyed by that mistake.

It is your responsibility to ensure that this e-mail does not contain
and is not affected by computer viruses, defects or interference by
third parties or replication problems (including incompatibility with
your computer system).

Opinions contained in this e-mail do not necessarily reflect the
opinions of the Queensland Department of Main Roads, Queensland
Transport or Maritime Safety Queensland, or endorsed organisations
utilising the same infrastructure.
***********************************************************************

From ari.jolma at tkk.fi  Thu Feb 26 01:10:46 2009
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Thu Feb 26 01:45:29 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>
References: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>
Message-ID: <49A63266.3010200@tkk.fi>

nicholas.g.lawrence@mainroads.qld.gov.au wrote:
>> nicholas.g.lawrence@mainroads.qld.gov.au wrote:
>>     
>>> A client has a very large (millions of records) ascii file consisting
>>> solely of x,y,z co-ordinates.
>>>
>>> They would like to reduce the number of records by weeking out points that
>>>       
>>> are too close to each other.
>>>
>>> Can GDAL or OGR weed out 3D points based on proximity to each other?
>>>       
>
> My client says that they want the resulting data points to be
> a subset of the original data points, that is the process should
> delete points, not re-calculate new ones that are an average.
>   


I would use plain Perl (or Python or high level language X) to read in 
the points sequentially and discard new ones that are "too close" to 
existing ones. It may take a while & require a bit of memory it is 
probably doable that way (millions of points but not 100s of millions in 
the end set). The program shouldn't need to be more than 20 lines I guess.

This is doable in plain programming language since distance is so easy 
to compute. If you had polygons or linestrings then GDAL+GEOS would be 
natural additional tools.

Ari

From wroberts at csir.co.za  Thu Feb 26 02:59:10 2009
From: wroberts at csir.co.za (Wesley Roberts)
Date: Thu Feb 26 03:00:17 2009
Subject: [gdal-dev] weeding out x,y,z points
Message-ID: <49A667F302000073000190D2@pta-emo.csir.co.za>

Have you looked at the spatial applications available in R. It sounds like you have a lidar data set yes? R has a bunch of packages that could help, gstat, spatstat, maptools, sp, etc have a look at 

http://wiki.r-project.org/rwiki/doku.php?id=tips:spatial-data

One option I can think of, but cant remember how to do it is the following. Sometimes when interpolating lidar points (or any for that matter) it is useful to remove some points from your data for validation later on. typically one would remove 5 or 10% of the data and use this to validate the final surface. So you would then sit with the modelling data containing 90% of the original data and your validation data containing 10% of the original data. The removal is usually done randomly and would therefore allow you to retain the structure of your original data.

As I said earlier I cant exactly remember how this is done, but the link should give you a good start.

HTH
Wesley

Wesley Roberts MSc.
Researcher: Earth Observation (Ecosystems)
Natural Resources and the Environment
CSIR
Tel: +27 (21) 888-2490
Fax: +27 (21) 888-2693

"To know the road ahead, ask those coming back."
- Chinese proverb

>>> <nicholas.g.lawrence@mainroads.qld.gov.au> 02/26/09 6:57 AM >>>
> nicholas.g.lawrence@mainroads.qld.gov.au wrote:
> > A client has a very large (millions of records) ascii file consisting
> > solely of x,y,z co-ordinates.
> >
> > They would like to reduce the number of records by weeking out points
that
> > are too close to each other.
> >
> > Can GDAL or OGR weed out 3D points based on proximity to each other?

>
> A job for GMT's blockmean or blockmedian.

> Joaquim Luis

Okay, I downloaded the Manpages.

My initial reading is that blockmean and blockmedian work by averaging
the values.

My client says that they want the resulting data points to be
a subset of the original data points, that is the process should
delete points, not re-calculate new ones that are an average.

Is this still do-able? Is there a specific option I should
be looking at?

Regards,
nick


***********************************************************************
WARNING: This e-mail (including any attachments) may contain legally
privileged, confidential or private information and may be protected by
copyright. You may only use it if you are the person(s) it was intended
to be sent to and if you use it in an authorised way.  No one is 
allowed to use, review, alter, transmit, disclose, distribute, print 
or copy this e-mail without appropriate authority.

If this e-mail was not intended for you and was sent to you by mistake,
please telephone or e-mail me immediately, destroy any hardcopies of
this e-mail and delete it and any copies of it from your computer
system. Any right which the sender may have under copyright law, and 
any legal privilege and confidentiality attached to this e-mail is not 
waived or destroyed by that mistake.

It is your responsibility to ensure that this e-mail does not contain
and is not affected by computer viruses, defects or interference by
third parties or replication problems (including incompatibility with
your computer system).

Opinions contained in this e-mail do not necessarily reflect the
opinions of the Queensland Department of Main Roads, Queensland
Transport or Maritime Safety Queensland, or endorsed organisations
utilising the same infrastructure.
***********************************************************************

_______________________________________________
gdal-dev mailing list
gdal-dev@lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
This message is subject to the CSIR's copyright terms and conditions, e-mail legal notice, and implemented Open Document Format (ODF) standard. 
The full disclaimer details can be found at http://www.csir.co.za/disclaimer.html.

This message has been scanned for viruses and dangerous content by MailScanner, 
and is believed to be clean.  MailScanner thanks Transtec Computers for their support.

From jgomezdans at gmail.com  Thu Feb 26 05:23:36 2009
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Thu Feb 26 05:29:15 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <49A63266.3010200@tkk.fi>
References: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>
	<49A63266.3010200@tkk.fi>
Message-ID: <91d218430902260223l440f990pd316e1aab43023c@mail.gmail.com>

Hi,

2009/2/26 Ari Jolma <ari.jolma@tkk.fi>

> nicholas.g.lawrence@mainroads.qld.gov.au wrote:
>
>>
>>> <nicholas.g.lawrence@mainroads.qld.gov.au>
>>>>
>>>> Can GDAL or OGR weed out 3D points based on proximity to each other?
>>>>
>>>>
>>>  I would use plain Perl (or Python or high level language X) to read in
> the points sequentially and discard new ones that are "too close" to
> existing ones. It may take a while & require a bit of memory it is probably
> doable that way (millions of points but not 100s of millions in the end
> set). The program shouldn't need to be more than 20 lines I guess.


scipy (python's numeric/scientific workhorse) now has a Kdtrees
capabilities, which are an efficient way of working out distances between
points:
<http://docs.scipy.org/doc/scipy/reference/spatial.html>

Best regards,
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090226/1b14c172/attachment.html
From lucafasano at interfree.it  Thu Feb 26 07:03:40 2009
From: lucafasano at interfree.it (LF)
Date: Thu Feb 26 07:03:52 2009
Subject: [gdal-dev] Link GDAL with MinGW
Message-ID: <loom.20090226T114507-718@post.gmane.org>

Hi to everyone,
I'm trying to make a plugin for GDAL. So I need to use some GDALDataset methods
(AddBand, GetDriver, setGCPs, ...).
When I compile my code with MinGW it's all OK, but when MinGW starts linking it
doesn't found these methods and give me "undefined reference" to all them.
In makefile I added to LNK_FLAGS variable both gdal16.dll and its path. I tried
to use gdal_i.lib of 1.5 version too, but nothing appened.
If it's useful I copy CPP_FLAGS following:

CPPFLAGS:=-Wall -DCSK_PLUGIN -fPIC $(GDAL_INCLUDE) $(HDF5_INCLUDE) $(CPPFLAGS)
CPPFLAGS:= -DH5_HAVE_HIGH_LEVEL_API $(CPPFLAGS)
CPPFLAGS:= -DWIN32 -DDLL_EXPORT -DPIC $(CPPFLAGS)


From ari.jolma at tkk.fi  Thu Feb 26 08:08:04 2009
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Thu Feb 26 08:08:09 2009
Subject: [gdal-dev] Link GDAL with MinGW
In-Reply-To: <loom.20090226T114507-718@post.gmane.org>
References: <loom.20090226T114507-718@post.gmane.org>
Message-ID: <49A69434.3060707@tkk.fi>

MinGW gcc generates .dll.a files, which are the link libraries, but it 
can also use the plain dll to link against.

However, when you mention gdal16.dll, it sounds like you're trying to 
link against a GDAL dll that was generated with VC. The C++ API is very 
difficult to use from such dll when you're developing with MinGW if not 
impossible. I, for one, have never succeeded. The Swig bindings use some 
C++ API, which have so far prevented me from using "an official" binary 
gdal dll for the Perl bindings for example.

Ari

LF kirjoitti:
> Hi to everyone,
> I'm trying to make a plugin for GDAL. So I need to use some GDALDataset methods
> (AddBand, GetDriver, setGCPs, ...).
> When I compile my code with MinGW it's all OK, but when MinGW starts linking it
> doesn't found these methods and give me "undefined reference" to all them.
> In makefile I added to LNK_FLAGS variable both gdal16.dll and its path. I tried
> to use gdal_i.lib of 1.5 version too, but nothing appened.
> If it's useful I copy CPP_FLAGS following:
>
> CPPFLAGS:=-Wall -DCSK_PLUGIN -fPIC $(GDAL_INCLUDE) $(HDF5_INCLUDE) $(CPPFLAGS)
> CPPFLAGS:= -DH5_HAVE_HIGH_LEVEL_API $(CPPFLAGS)
> CPPFLAGS:= -DWIN32 -DDLL_EXPORT -DPIC $(CPPFLAGS)
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>   


-- 
Prof. Ari Jolma
Environmental Management Information Technology
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 4511 address: POBox 5300, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://geoinformatics.tkk.fi

From ari.jolma at tkk.fi  Thu Feb 26 08:14:49 2009
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Thu Feb 26 08:14:52 2009
Subject: [gdal-dev] Link GDAL with MinGW
In-Reply-To: <7980_1235653829_ZZ0KFO00G4NCKTUE.00_49A69434.3060707@tkk.fi>
References: <loom.20090226T114507-718@post.gmane.org>
	<7980_1235653829_ZZ0KFO00G4NCKTUE.00_49A69434.3060707@tkk.fi>
Message-ID: <49A695C9.8030900@tkk.fi>

oops, I believe it is not correct to say "Swig bindings use some C++ 
API", but it is nevertheless sometimes hard/not possible to mix VC and 
MinGW when developing for Windows

Ari

Ari Jolma kirjoitti:
> MinGW gcc generates .dll.a files, which are the link libraries, but it 
> can also use the plain dll to link against.
>
> However, when you mention gdal16.dll, it sounds like you're trying to 
> link against a GDAL dll that was generated with VC. The C++ API is 
> very difficult to use from such dll when you're developing with MinGW 
> if not impossible. I, for one, have never succeeded. The Swig bindings 
> use some C++ API, which have so far prevented me from using "an 
> official" binary gdal dll for the Perl bindings for example.
>
> Ari
>
> LF kirjoitti:
>> Hi to everyone,
>> I'm trying to make a plugin for GDAL. So I need to use some 
>> GDALDataset methods
>> (AddBand, GetDriver, setGCPs, ...).
>> When I compile my code with MinGW it's all OK, but when MinGW starts 
>> linking it
>> doesn't found these methods and give me "undefined reference" to all 
>> them.
>> In makefile I added to LNK_FLAGS variable both gdal16.dll and its 
>> path. I tried
>> to use gdal_i.lib of 1.5 version too, but nothing appened.
>> If it's useful I copy CPP_FLAGS following:
>>
>> CPPFLAGS:=-Wall -DCSK_PLUGIN -fPIC $(GDAL_INCLUDE) $(HDF5_INCLUDE) 
>> $(CPPFLAGS)
>> CPPFLAGS:= -DH5_HAVE_HIGH_LEVEL_API $(CPPFLAGS)
>> CPPFLAGS:= -DWIN32 -DDLL_EXPORT -DPIC $(CPPFLAGS)
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>   
>
>


-- 
Prof. Ari Jolma
Environmental Management Information Technology
Teknillinen Korkeakoulu / Helsinki University of Technology
tel: +358 9 4511 address: POBox 5300, 02015 TKK, Finland
Email: ari.jolma at tkk.fi URL: http://geoinformatics.tkk.fi

From lucafasano at interfree.it  Thu Feb 26 09:03:01 2009
From: lucafasano at interfree.it (LF)
Date: Thu Feb 26 09:03:18 2009
Subject: [gdal-dev] Re: Link GDAL with MinGW
References: <loom.20090226T114507-718@post.gmane.org> <49A69434.3060707@tkk.fi>
Message-ID: <loom.20090226T135119-156@post.gmane.org>

Ari Jolma <ari.jolma <at> tkk.fi> writes:
> 
> MinGW gcc generates .dll.a files, which are the link libraries, but it 
> can also use the plain dll to link against.
> 
> However, when you mention gdal16.dll, it sounds like you're trying to 
> link against a GDAL dll that was generated with VC. The C++ API is very 
> difficult to use from such dll when you're developing with MinGW if not 
> impossible.
I'm not sure of this. In the same project I linked *correctly* hdf5 library,
which is a dll file and I think compiled with VC. 
I've problem only with gdal.

Perhaps it needs some flags when compile.
> 
> Ari
> 
> LF kirjoitti:
> > Hi to everyone,
> > I'm trying to make a plugin for GDAL. So I need to use some GDALDataset 
methods
> > (AddBand, GetDriver, setGCPs, ...).
> > When I compile my code with MinGW it's all OK, but when MinGW starts 
linking it
> > doesn't found these methods and give me "undefined reference" to all them.
> > In makefile I added to LNK_FLAGS variable both gdal16.dll and its path.

From ari.jolma at tkk.fi  Thu Feb 26 09:54:34 2009
From: ari.jolma at tkk.fi (Ari Jolma)
Date: Thu Feb 26 09:54:37 2009
Subject: [gdal-dev] Re: Link GDAL with MinGW
In-Reply-To: <loom.20090226T135119-156@post.gmane.org>
References: <loom.20090226T114507-718@post.gmane.org> <49A69434.3060707@tkk.fi>
	<loom.20090226T135119-156@post.gmane.org>
Message-ID: <49A6AD2A.6010701@tkk.fi>

LF kirjoitti:
> Ari Jolma <ari.jolma <at> tkk.fi> writes:
>   
>> MinGW gcc generates .dll.a files, which are the link libraries, but it 
>> can also use the plain dll to link against.
>>
>> However, when you mention gdal16.dll, it sounds like you're trying to 
>> link against a GDAL dll that was generated with VC. The C++ API is very 
>> difficult to use from such dll when you're developing with MinGW if not 
>> impossible.
>>     
> I'm not sure of this. In the same project I linked *correctly* hdf5 library,
> which is a dll file and I think compiled with VC. 
> I've problem only with gdal.
>
> Perhaps it needs some flags when compile.
>   

But you do use VC compiled GDAL DLL? HDF5 seems to be available in many 
formats (for cygwin, vs2005, etc). I'm just looking at a hdf5dll.dll and 
it does not export anything in C++, while gdal16.dll does. I believe gcc 
is not able to decrypt the way VC exports C++ methods, which you are using.

Why don't you use the GDAL DLL that you get from compiling it with MinGW?

Ari
From warmerdam at pobox.com  Thu Feb 26 11:05:58 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb 26 11:06:21 2009
Subject: [gdal-dev] Link GDAL with MinGW
In-Reply-To: <49A695C9.8030900@tkk.fi>
References: <loom.20090226T114507-718@post.gmane.org>
	<7980_1235653829_ZZ0KFO00G4NCKTUE.00_49A69434.3060707@tkk.fi>
	<49A695C9.8030900@tkk.fi>
Message-ID: <49A6BDE6.1060807@pobox.com>

Ari Jolma wrote:
> oops, I believe it is not correct to say "Swig bindings use some C++ 
> API", but it is nevertheless sometimes hard/not possible to mix VC and 
> MinGW when developing for Windows

Folks,

I am interested in making use of the GDAL and OGR C API practical and even
convenient when GDAL is built with MSVC and applications are built with
MinGW.  If there is a particular problem with this, I would encourage
filing a ticket.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From lucafasano at interfree.it  Thu Feb 26 12:08:51 2009
From: lucafasano at interfree.it (LF)
Date: Thu Feb 26 12:09:07 2009
Subject: [gdal-dev] Re: Link GDAL with MinGW
References: <loom.20090226T114507-718@post.gmane.org>
	<7980_1235653829_ZZ0KFO00G4NCKTUE.00_49A69434.3060707@tkk.fi>
	<49A695C9.8030900@tkk.fi> <49A6BDE6.1060807@pobox.com>
Message-ID: <loom.20090226T164701-993@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> 
> Ari Jolma wrote:
> > oops, I believe it is not correct to say "Swig bindings use some C++ 
> > API", but it is nevertheless sometimes hard/not possible to mix VC and 
> > MinGW when developing for Windows
> 
> Folks,
> 
> I am interested in making use of the GDAL and OGR C API practical and even
> convenient when GDAL is built with MSVC and applications are built with
> MinGW.  If there is a particular problem with this, I would encourage
> filing a ticket.
> 
> Best regards,

First of all, thanks to your fast answers.
Then, I report following my makefile.


GDAL_ROOT="C:\gdalwin32-1.6_bin\"

LD_SHARED=g++ -shared
OBJ=hdf5dataset.o hdf5imagedataset.o
GDAL_INCLUDE=-I "C:\gdal_1_6_0_DEV\include"
HDF5_INCLUDE=-I "C:\5-168-win-vnet_corrected_for_MinGW\include"
CPPFLAGS:=-Wall -fPIC $(GDAL_INCLUDE) $(CPPFLAGS) $(HDF5_INCLUDE)
CPPFLAGS:= -DWIN32 -DDLL_EXPORT -DPIC $(CPPFLAGS)

# Comment out for release mode
CPPFLAGS:=-g3 -ggdb3 -DDEBUG $(CPPFLAGS)
LNK_FLAGS:=$(LNK_FLAGS) -L "C:\gdalwin32-1.6_bin\bin"
#both msvcr inserted 71 and 90
LNK_FLAGS:=$(LNK_FLAGS) -lgdal16 -lmsvcr71 -lmsvcr91
LNK_FLAGS:=$(LNK_FLAGS) -L "C:\5-168-win-vnet_corrected_for_MinGW\dll"
LNK_FLAGS:=$(LNK_FLAGS) -lhdf5_cppdll -lhdf5dll -lhdf5_hldll

.PHONY: default plugin clean

PLUGIN = gdal_HDF5.so
default: plugin
clean:
	rm -f *.o *~ $(PLUGIN)

hdf5dataset.o: hdf5dataset.h
hdf5imagedataset.o: hdf5dataset.h
plugin: $(PLUGIN)
$(PLUGIN):	$(OBJ)
	$(LD_SHARED) $(OBJ) $(LNK_FLAGS) -o $



When I compile my code with MinGW it's all OK, but when MinGW starts 
linking it doesn't found all methods of GDALDataset giving me "undefined
reference" to them. It seems not to link gdal dll.

You can try it in gdalsrc/frmts/hdf5 because it needs three source files in this
folder.

PS. To avoid compiling errors I re-compiled hdf5 as described here:
http://lists.osgeo.org/pipermail/gdal-dev/2007-April/012825.html  and modified
/hdf5/include/H5pubconf.h defining H5_SIZEOF_SSIZE_T:
     #define H5_SIZEOF_SSIZE_T  4 /* for 32 bit machines */
(as described here
http://trac.nexusformat.org/code/browser/branches/4.1/README.MinGW?rev=998)

PS2. I tried to convert gdal dll into a .a file for MinGW as described here:
http://www.mingw.org/wiki/MSVC_and_MinGW_DLLs but it doesn-t link correctly.


Best regards
Luca

From warmerdam at pobox.com  Thu Feb 26 12:29:39 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Thu Feb 26 12:30:05 2009
Subject: [gdal-dev] Re: Link GDAL with MinGW
In-Reply-To: <loom.20090226T164701-993@post.gmane.org>
References: <loom.20090226T114507-718@post.gmane.org>
	<7980_1235653829_ZZ0KFO00G4NCKTUE.00_49A69434.3060707@tkk.fi>
	<49A695C9.8030900@tkk.fi> <49A6BDE6.1060807@pobox.com>
	<loom.20090226T164701-993@post.gmane.org>
Message-ID: <49A6D183.80603@pobox.com>

LF wrote:
> First of all, thanks to your fast answers.
> Then, I report following my makefile.
> 
> 
> GDAL_ROOT="C:\gdalwin32-1.6_bin\"
> 
> LD_SHARED=g++ -shared
> OBJ=hdf5dataset.o hdf5imagedataset.o

Luca,

I get the impression you are trying to build the HDF5 plugin with MinGW
for use with a GDAL built with MSVC.  Plugins use the C++ API and are
generally not going to be compatible between compilers.  At this time
I believe you just have to use a similar compiler to build plugins as
was used to build the core GDAL library.

The offer to improve MinGW/MSVC mixing only applies to the GDAL/OGR C API
(not the C++ API) and is mainly aimed at making it possible to build
applications against the GDAL/OGR C API using MinGW when GDAL is built with
MSVC.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jluis at ualg.pt  Thu Feb 26 13:42:10 2009
From: jluis at ualg.pt (Joaquim Luis)
Date: Thu Feb 26 14:25:34 2009
Subject: [gdal-dev] weeding out x,y,z points
In-Reply-To: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>
References: <OF27D44F46.AF31360E-ON4A257569.001AA181-4A257569.001B22AC@transport.qld.gov.au>
Message-ID: <49A6E282.2070506@ualg.pt>


> Okay, I downloaded the Manpages.
> 
> My initial reading is that blockmean and blockmedian work by averaging
> the values.

blockmedian does not do point average. It does take the median point inside each bin.
However, if the number of points inside a bin is even than it takes the average
of the two central points.

> My client says that they want the resulting data points to be
> a subset of the original data points, that is the process should
> delete points, not re-calculate new ones that are an average.

Well, you (or the client) do what you want, but that is not the
correct procedure because it may introduce aliasing. What will be the
condition to decide the reference point towards which the others
are compared?

Joaquim

From walker at mfgis.com  Thu Feb 26 14:39:49 2009
From: walker at mfgis.com (Steve Walker)
Date: Thu Feb 26 14:59:13 2009
Subject: [gdal-dev] Failure to compile 1.6.0 with errors 'libgdal.so:
 undefined reference to `PMPI::Intracomm::current_op'
Message-ID: <35792.24.129.92.213.1235677189.squirrel@mfgis.com>

Hi, I'm a brand new visitor to your list here.

I'm working on Debian Squeeze and have had a functioning 1.6.0 install
(compiled, not from a .deb) version up until this morning, when I went to
re-compile so as to include additional support, specifically ogdi.

After a half day of trying and failing, I felt it time to come here.  The
error looks like this:

/bin/sh /home/walker/admin/gdal-1.6.0/libtool --mode=link	g++  gdalinfo.o  \
		/home/walker/admin/gdal-1.6.0/libgdal.la -o gdalinfo
libtool: link: g++ gdalinfo.o -o .libs/gdalinfo 
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so -L/usr/lib -L/usr/local/lib
-L/usr/lib/lib -L/usr/include/ogdi -L/usr/include/ogdi/lib
-L/usr/lib/grass/lib -L/usr/local/Geo_DSDK-7.0.0.2167/lib/Release
-L/usr/local/Geo_DSDK-7.0.0.2167/3rd-party/lib/Release
/usr/lib/libgeos_c.so /usr/lib/libgeos.so /usr/lib/libodbc.so
/usr/lib/libodbcinst.so /usr/lib/libltdl.so /usr/lib/libexpat.so
/usr/local/lib/libNCSEcw.so /usr/local/lib/libNCSCnet.so
/usr/local/lib/libNCSUtil.so /usr/lib/libjasper.so /usr/lib/libhdf5.so -lm
-lmfhdf -ldf -logdi31 /usr/lib/libjpeg.so -lpng -lnetcdf -lgrass_vect
-lgrass_dig2 -lgrass_dgl -lgrass_rtree -lgrass_linkm -lgrass_dbmiclient
-lgrass_dbmibase -lgrass_I -lgrass_gproj -lgrass_vask -lgrass_gmath
-lgrass_gis -lgrass_datetime -lpq -lz -lrt -ldl /usr/lib/libcurl-gnutls.so
-lltidsdk -lpthread -llt_kakadu
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`PMPI::Intracomm::current_op'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`PMPI::Comm::mpi_comm_map'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`MPI::Is_initialized()'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`PMPI::Comm::mpi_err_map'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`MPI::Op::Free()'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`op_intercept'
/home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
`MPI::Op::Init(void (*)(void const*, void*, int, MPI::Datatype const&),
bool)'
collect2: ld returned 1 exit status
make[1]: *** [gdalinfo] Error 1
make[1]: Leaving directory `/home/walker/admin/gdal-1.6.0/apps'
make: *** [apps-target] Error 2


My configure command looks like this:

./configure \
  --with-libz \
  --with-pg=/usr/bin/pg_config \
  --with-grass=/usr/lib/grass \
  --with-libgrass \
  --with-cfitsio \
  --with-pcraste \
  --with-png \
  --with-libtiff \
  --with-geotiff \
  --with-jpeg \
  --with-gif \
  --with-ogdi=/usr/include/ogdi \
  --with-jasper=/usr/lib \
  --with-ecw=/usr/local \
  --with-mrsid=/usr/local/Geo_DSDK-7.0.0.2167 \
  --with-jp2mrsid \
  --with-xerces \
  --with-xerces-inc \
  --with-xerces-lib \
  --with-expat \
  --with-expat-inc \
  --with-expat-lib \
  --with-odbc \
  --with-curl=/usr/bin/curl-config \
  --with-geos \
  --with-perl \
  --with-python

I'll supply any more information as needed, such as installed packages, etc.


Thanks in advance,


-- 
Steve Walker
Middle Fork Geographic Information Services
360.671.2505
walker@mfgis.com
http://mfgis.com

From nahumoz at gmail.com  Thu Feb 26 16:04:51 2009
From: nahumoz at gmail.com (Oz Nahum)
Date: Thu Feb 26 16:04:54 2009
Subject: [gdal-dev] ASCII Rasters and 'null' values in python-gdal
Message-ID: <6ec71d090902261304u398d4468we3ca3558ca918956@mail.gmail.com>

Hi,
I have to ascii raster that I created using a text editor:
the first is called raster1.asc and looks like this:
<http://forum.qgis.org/viewtopic.php?f=2&t=4552#>ncols         6
nrows         4
xllcorner     3366820.0000019
yllcorner     5814589.0300007
cellsize      10
NODATA_value  -9999
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 -9999 -9999
The second is called raster2.asc and looks like this:
<http://forum.qgis.org/viewtopic.php?f=2&t=4552#>ncols         6
nrows         4
xllcorner     3366820.0000019
yllcorner     5814589.0300007
cellsize      10
NODATA_value  null
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 null null

When I import them into python I find out the lower right corner of the
first raster is not giving the correct value: instead of 'null' qgis
displays the value '31081'.
The other raster is imported correctly and it showing 'null's for the two
last data cells.

>>> dataset = gdal.Open('raster2.asc', GA_ReadOnly)
>>> b = gdal_array.DatasetReadAsArray(dataset)
>>> b
array([[1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1, 1],
       [1, 1, 1, 1, 0, 0]], dtype=int16)
>>> dataset = gdal.Open('raster1.asc', GA_ReadOnly)
>>> a = gdal_array.DatasetReadAsArray(dataset)
>>> a
array([[    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1, -9999, 31081]], dtype=int16)
>>>


So before I go and open a bug, I just wanted to know - what is wrong ? Maybe
it's my system setup ? Maybe i don't write correct ascii rasters ? Also,
another thing I would like to bypass is the fact that 'null' values are
formed as zeros in gdal-numpy - this could lead to error when doing some
raster manipulations. Is there a way to by pass this (besides being
aware...)?

I use Debian Lenny the latest relevant packages from.

Thanks,
Oz N,
Grad Studend,
Universit?t T?bingen



-- 

----
           Imagine there's no countries
           It isn't hard to do
           Nothing to kill or die for
           And no religion too
           Imagine all the people
           Living life in peace
----
          You all must read 'The God Delusion'
          http://en.wikipedia.org/wiki/The_God_Delusion
---
when one person suffers from a delusion it is called insanity. When many
people suffer from a delusion it is called religion."
Robert Pirsig, Zen and the Art of Motorcycle Maintenance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090226/147dc840/attachment.html
From chaitanya.ch at gmail.com  Thu Feb 26 21:26:20 2009
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Thu Feb 26 21:26:26 2009
Subject: [gdal-dev] ASCII Rasters and 'null' values in python-gdal
In-Reply-To: <6ec71d090902261304u398d4468we3ca3558ca918956@mail.gmail.com>
References: <6ec71d090902261304u398d4468we3ca3558ca918956@mail.gmail.com>
Message-ID: <eb502d880902261826m37068ff7x606cec3abb1d887e@mail.gmail.com>

Oz,

NODATA_VALUES is supposed to be a pixel value (integer or real)
whereas "null" is a string. Try to convert all the "null" strings into
an unused pixel value like -9999 in raster1.asc

Regards,
-- 
Chaitanya kumar CH.

On Fri, Feb 27, 2009 at 2:34 AM, Oz Nahum <nahumoz@gmail.com> wrote:
> Hi,
> I have to ascii raster that I created using a text editor:
> the first is called raster1.asc and looks like this:
> ncols? ? ? ? ?6
> nrows? ? ? ? ?4
> xllcorner? ? ?3366820.0000019
> yllcorner? ? ?5814589.0300007
> cellsize? ? ? 10
> NODATA_value? -9999
> 1 1 1 1 1 1
> 1 1 1 1 1 1
> 1 1 1 1 1 1
> 1 1 1 1 -9999 -9999
> The second is called raster2.asc and looks like this:
> ncols? ? ? ? ?6
> nrows? ? ? ? ?4
> xllcorner? ? ?3366820.0000019
> yllcorner? ? ?5814589.0300007
> cellsize? ? ? 10
> NODATA_value? null
> 1 1 1 1 1 1
> 1 1 1 1 1 1
> 1 1 1 1 1 1
> 1 1 1 1 null null
>
> When I import them into python I find out the lower right corner of the
> first raster is not giving the correct value: instead of 'null' qgis
> displays the value '31081'.
> The other raster is imported correctly and it showing 'null's for the two
> last data cells.
>
>>>> dataset = gdal.Open('raster2.asc', GA_ReadOnly)
>>>> b = gdal_array.DatasetReadAsArray(dataset)
>>>> b
> array([[1, 1, 1, 1, 1, 1],
> ? ? ? ?[1, 1, 1, 1, 1, 1],
> ? ? ? ?[1, 1, 1, 1, 1, 1],
> ? ? ? ?[1, 1, 1, 1, 0, 0]], dtype=int16)
>>>> dataset = gdal.Open('raster1.asc', GA_ReadOnly)
>>>> a = gdal_array.DatasetReadAsArray(dataset)
>>>> a
> array([[? ? 1,? ? ?1,? ? ?1,? ? ?1,? ? ?1,? ? ?1],
> ? ? ? ?[? ? 1,? ? ?1,? ? ?1,? ? ?1,? ? ?1,? ? ?1],
> ? ? ? ?[? ? 1,? ? ?1,? ? ?1,? ? ?1,? ? ?1,? ? ?1],
> ? ? ? ?[? ? 1,? ? ?1,? ? ?1,? ? ?1, -9999, 31081]], dtype=int16)
>>>>
>
>
> So before I go and open a bug, I just wanted to know - what is wrong ? Maybe
> it's my system setup ? Maybe i don't write correct ascii rasters ? Also,
> another thing I would like to bypass is the fact that 'null' values are
> formed as zeros in gdal-numpy - this could lead to error when doing some
> raster manipulations. Is there a way to by pass this (besides being
> aware...)?
>
> I use Debian Lenny the latest relevant packages from.
>
> Thanks,
> Oz N,
> Grad Studend,
> Universit?t T?bingen
>
>
>
> --
>
> ----
> ? ? ? ? ? ?Imagine there's no countries
> ? ? ? ? ? ?It isn't hard to do
> ? ? ? ? ? ?Nothing to kill or die for
> ? ? ? ? ? ?And no religion too
> ? ? ? ? ? ?Imagine all the people
> ? ? ? ? ? ?Living life in peace
> ----
> ? ? ? ? ? You all must read 'The God Delusion'
> ? ? ? ? ? http://en.wikipedia.org/wiki/The_God_Delusion
> ---
> when one person suffers from a delusion it is called insanity. When many
> people suffer from a delusion it is called religion."
> Robert Pirsig, Zen and the Art of Motorcycle Maintenance
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
From nahumoz at gmail.com  Fri Feb 27 03:09:08 2009
From: nahumoz at gmail.com (Oz Nahum)
Date: Fri Feb 27 03:09:13 2009
Subject: [gdal-dev] ASCII Rasters and 'null' values in python-gdal
In-Reply-To: <eb502d880902261826m37068ff7x606cec3abb1d887e@mail.gmail.com>
References: <6ec71d090902261304u398d4468we3ca3558ca918956@mail.gmail.com>
	<eb502d880902261826m37068ff7x606cec3abb1d887e@mail.gmail.com>
Message-ID: <6ec71d090902270009v2e4ec57at35efbf2d4485cbf@mail.gmail.com>

Hi, Thanks for the answer.
Ok, I admit the way I presented my first email is a bit confusing.
But the problem is not with the 'null' values. Rather the problem is with
the raster containing the no data values as -9999. This is a no data
representation like you said.
My problem is that GDAL is converting the last -9999 value to this value
31081.
raster2.asc and looks like this:
in text editor:
ncols         6
nrows         4
xllcorner     3366820.0000019
yllcorner     5814589.0300007
cellsize      10
NODATA_value -9999
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 1 1
1 1 1 1 -9999 -9999in python:
>>> dataset = gdal.Open('raster1.asc', GA_ReadOnly)
>>> a = gdal_array.DatasetReadAsArray(dataset)
>>> a
array([[    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1,     1,     1],
       [    1,     1,     1,     1, -9999, 31081]], dtype=int16)
>>>

Thanks again,
Oz.

On Fri, Feb 27, 2009 at 3:26 AM, Chaitanya kumar CH
<chaitanya.ch@gmail.com>wrote:

> Oz,
>
> NODATA_VALUES is supposed to be a pixel value (integer or real)
> whereas "null" is a string. Try to convert all the "null" strings into
> an unused pixel value like -9999 in raster1.asc
>
> Regards,
> --
> Chaitanya kumar CH.
>
> On Fri, Feb 27, 2009 at 2:34 AM, Oz Nahum <nahumoz@gmail.com> wrote:
> > Hi,
> > I have to ascii raster that I created using a text editor:
> > the first is called raster1.asc and looks like this:
> > ncols         6
> > nrows         4
> > xllcorner     3366820.0000019
> > yllcorner     5814589.0300007
> > cellsize      10
> > NODATA_value  -9999
> > 1 1 1 1 1 1
> > 1 1 1 1 1 1
> > 1 1 1 1 1 1
> > 1 1 1 1 -9999 -9999
> > The second is called raster2.asc and looks like this:
> > ncols         6
> > nrows         4
> > xllcorner     3366820.0000019
> > yllcorner     5814589.0300007
> > cellsize      10
> > NODATA_value  null
> > 1 1 1 1 1 1
> > 1 1 1 1 1 1
> > 1 1 1 1 1 1
> > 1 1 1 1 null null
> >
> > When I import them into python I find out the lower right corner of the
> > first raster is not giving the correct value: instead of 'null' qgis
> > displays the value '31081'.
> > The other raster is imported correctly and it showing 'null's for the two
> > last data cells.
> >
> >>>> dataset = gdal.Open('raster2.asc', GA_ReadOnly)
> >>>> b = gdal_array.DatasetReadAsArray(dataset)
> >>>> b
> > array([[1, 1, 1, 1, 1, 1],
> >        [1, 1, 1, 1, 1, 1],
> >        [1, 1, 1, 1, 1, 1],
> >        [1, 1, 1, 1, 0, 0]], dtype=int16)
> >>>> dataset = gdal.Open('raster1.asc', GA_ReadOnly)
> >>>> a = gdal_array.DatasetReadAsArray(dataset)
> >>>> a
> > array([[    1,     1,     1,     1,     1,     1],
> >        [    1,     1,     1,     1,     1,     1],
> >        [    1,     1,     1,     1,     1,     1],
> >        [    1,     1,     1,     1, -9999, 31081]], dtype=int16)
> >>>>
> >
> >
> > So before I go and open a bug, I just wanted to know - what is wrong ?
> Maybe
> > it's my system setup ? Maybe i don't write correct ascii rasters ? Also,
> > another thing I would like to bypass is the fact that 'null' values are
> > formed as zeros in gdal-numpy - this could lead to error when doing some
> > raster manipulations. Is there a way to by pass this (besides being
> > aware...)?
> >
> > I use Debian Lenny the latest relevant packages from.
> >
> > Thanks,
> > Oz N,
> > Grad Studend,
> > Universit?t T?bingen
> >
> >
> >
> > --
> >
> > ----
> >            Imagine there's no countries
> >            It isn't hard to do
> >            Nothing to kill or die for
> >            And no religion too
> >            Imagine all the people
> >            Living life in peace
> > ----
> >           You all must read 'The God Delusion'
> >           http://en.wikipedia.org/wiki/The_God_Delusion
> > ---
> > when one person suffers from a delusion it is called insanity. When many
> > people suffer from a delusion it is called religion."
> > Robert Pirsig, Zen and the Art of Motorcycle Maintenance
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev@lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>



-- 

----
           Imagine there's no countries
           It isn't hard to do
           Nothing to kill or die for
           And no religion too
           Imagine all the people
           Living life in peace
----
          You all must read 'The God Delusion'
          http://en.wikipedia.org/wiki/The_God_Delusion
---
when one person suffers from a delusion it is called insanity. When many
people suffer from a delusion it is called religion."
Robert Pirsig, Zen and the Art of Motorcycle Maintenance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090227/86402343/attachment.html
From aca at ngi.be  Fri Feb 27 05:43:50 2009
From: aca at ngi.be (acangi)
Date: Fri Feb 27 05:43:53 2009
Subject: [Gdal-dev] gdal_retile.py -r mode ?
Message-ID: <1235731430796-2394924.post@n2.nabble.com>


Hello,

Trying to execute this command :
 
gdal_retile.py -targetDir pyramid -levels 4 -v -pyramidOnly -s_srs
top50r.prj -ps 4000 4000 -r mode -co "TILED=YES" -co "INTERLEAVE=PIXEL" -co
"COMPRESS=LZW" -tileIndex pyramid -tileIndexField location *map.tif

gives the error "Unknown resampling method : mode", although it works fine
in gdaladdo.

It's gdal 1.6.0 --with-python. The data is colormapped, therefor I want to
use mode. I don't want to convert it to RGB first because of the size of the
data and I'm not the only one using it.

Shouldn't the "-r mode" option work in gdal_retile ?
-- 
View this message in context: http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2394924.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From christian.mueller at nvoe.at  Fri Feb 27 07:00:38 2009
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Fri Feb 27 07:06:06 2009
Subject: [gdal-dev] Re: gdal_retile.py -r mode ?
In-Reply-To: <1235731430796-2394924.post@n2.nabble.com>
References: <1235731430796-2394924.post@n2.nabble.com>
Message-ID: <20090227120038.23937.qmail@mail.linux4all.at>

The error is correct. A look at the man page shows 

gdal_retile.py [-v] [-co NAME=VALUE]* [-of out_format] [-ps pixelWidth 
pixelHeight]
              [-ot  {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
                     CInt16/CInt32/CFloat32/CFloat64}]'
              [ -tileIndex tileIndexName [-tileIndexField 
tileIndexFieldName]]
              [ -csv fileName [-csvDelim delimiter]]
              [-s_srs srs_def]  [-pyramidOnly]
              [-r {near/bilinear/cubic/cubicspline}]
              -levels numberoflevels
              -targetDir TileDirectory input_files 


which means that -r determines the resampling method, which could be 

near
bilinear
cubic
cubicspline 

and has nothing to do with the data size. At the moment, I have not 
implemented a parameter to change the color model (perhaps I should). 

Anyway, there are other possibilities to achieve this. (rgp2pct.py as an 
example). 

If you have many tiles, the best idea is to write a little script. If you 
are working on a linux box I could assist you. 

If you have many,many tiles, use the --optFile option  described here.
http://www.gdal.org/gdal_utilities.html 

If you have problems, send me a mail 

cheers
christian 

 

acangi writes: 

> 
> Hello, 
> 
> Trying to execute this command :
>  
> gdal_retile.py -targetDir pyramid -levels 4 -v -pyramidOnly -s_srs
> top50r.prj -ps 4000 4000 -r mode -co "TILED=YES" -co "INTERLEAVE=PIXEL" -co
> "COMPRESS=LZW" -tileIndex pyramid -tileIndexField location *map.tif 
> 
> gives the error "Unknown resampling method : mode", although it works fine
> in gdaladdo. 
> 
> It's gdal 1.6.0 --with-python. The data is colormapped, therefor I want to
> use mode. I don't want to convert it to RGB first because of the size of the
> data and I'm not the only one using it. 
> 
> Shouldn't the "-r mode" option work in gdal_retile ?
> -- 
> View this message in context: http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2394924.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From aca at ngi.be  Fri Feb 27 07:12:41 2009
From: aca at ngi.be (acangi)
Date: Fri Feb 27 07:12:42 2009
Subject: [Gdal-dev] gdal_retile.py -r mode ?
In-Reply-To: <20090227120038.23937.qmail@mail.linux4all.at>
References: <1235731430796-2394924.post@n2.nabble.com>
	<20090227120038.23937.qmail@mail.linux4all.at>
Message-ID: <1235736761752-2395290.post@n2.nabble.com>


Thanks for your answer.

I'd be more interested in a "mode" resampling method for gdal_retile. Is it
something you're thinking of ? Can it be reused from gdaladdo ?



Christian M?ller wrote:
> 
> The error is correct. A look at the man page shows 
> 
> gdal_retile.py [-v] [-co NAME=VALUE]* [-of out_format] [-ps pixelWidth 
> pixelHeight]
>               [-ot  {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>                      CInt16/CInt32/CFloat32/CFloat64}]'
>               [ -tileIndex tileIndexName [-tileIndexField 
> tileIndexFieldName]]
>               [ -csv fileName [-csvDelim delimiter]]
>               [-s_srs srs_def]  [-pyramidOnly]
>               [-r {near/bilinear/cubic/cubicspline}]
>               -levels numberoflevels
>               -targetDir TileDirectory input_files 
> 
> 
> which means that -r determines the resampling method, which could be 
> 
> near
> bilinear
> cubic
> cubicspline 
> 
> and has nothing to do with the data size. At the moment, I have not 
> implemented a parameter to change the color model (perhaps I should). 
> 
> Anyway, there are other possibilities to achieve this. (rgp2pct.py as an 
> example). 
> 
> If you have many tiles, the best idea is to write a little script. If you 
> are working on a linux box I could assist you. 
> 
> If you have many,many tiles, use the --optFile option  described here.
> http://www.gdal.org/gdal_utilities.html 
> 
> If you have problems, send me a mail 
> 
> cheers
> christian 
> 
>  
> 
> acangi writes: 
> 
>> 
>> Hello, 
>> 
>> Trying to execute this command :
>>  
>> gdal_retile.py -targetDir pyramid -levels 4 -v -pyramidOnly -s_srs
>> top50r.prj -ps 4000 4000 -r mode -co "TILED=YES" -co "INTERLEAVE=PIXEL"
>> -co
>> "COMPRESS=LZW" -tileIndex pyramid -tileIndexField location *map.tif 
>> 
>> gives the error "Unknown resampling method : mode", although it works
>> fine
>> in gdaladdo. 
>> 
>> It's gdal 1.6.0 --with-python. The data is colormapped, therefor I want
>> to
>> use mode. I don't want to convert it to RGB first because of the size of
>> the
>> data and I'm not the only one using it. 
>> 
>> Shouldn't the "-r mode" option work in gdal_retile ?
>> -- 
>> View this message in context:
>> http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2394924.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>  
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 

-- 
View this message in context: http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2395290.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From legeochen at gmail.com  Fri Feb 27 08:47:06 2009
From: legeochen at gmail.com (legeochen)
Date: Fri Feb 27 08:52:49 2009
Subject: [gdal-dev] create 25D MultiPolygon how to
Message-ID: <b508b9770902270547u6e6a574ch5f2f77a899c2233d@mail.gmail.com>

Hi All
I try to create some multipolygons with OGR. After creating them, but when I
want view them in arcscene, it just make arcscene crash! Then I tried
osgviewer with ESRI Shapefile, I was warned:
ESRIShape loader: .dbf file containe different record number that .shp file.

                             .dbf record skipped.
Actually, only one feature in the dataset had been readed out.
Then, I tried osgviewer with ogr, got warnings like this:
Warning something wrong with a polygon in a multi polygon.
And, the result is not quite as expected!
Here is my code:
 const char* pszDriverName = "ESRI Shapefile";
 OGRSFDriver *poDriver;
 OGRRegisterAll();
    poDriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(
                pszDriverName );
    if( poDriver == NULL )
    {
        printf( "%s driver not available.\n", pszDriverName );
        return false;
    }
 OGRDataSource *poDS;
 poDS = poDriver->Open(shpfile,TRUE);
 if(poDS == NULL)
  poDS = poDriver->CreateDataSource(shpfile,NULL);
 if(poDS == NULL)
 {
  printf("Creation of output file failed.\n");
  return false;
 }
 OGRLayer* poLayer = poDS->GetLayerByName (layername);
 if(poLayer == NULL)
 {
  if( !poDS->TestCapability( ODsCCreateLayer ) )
        {
            fprintf( stderr,
              "Layer Roadway not found, and CreateLayer not supported by
driver." );
            return FALSE;
        }
  CPLErrorReset();
  poLayer = poDS->CreateLayer(layername,NULL,wkbMultiPolygon25D,NULL);
  if(poLayer == NULL)
  {
   printf( "Layer creation failed.\n" );
   return false;
  }
 }

 for(Roadway::RoadWayArray::iterator itrw = _roadwayArr.begin(); itrw !=
_roadwayArr.end();itrw++)
 {
  OGRFeature *poFeature;

  OGRMultiPolygon multiPoly;
  poFeature = OGRFeature::CreateFeature(poLayer->GetLayerDefn());
  Roadway::Triangle_list tris = (*itrw)->getTrianglelist();
  for(Triangle_list::const_iterator ittri = tris.begin();ittri !=
tris.end();ittri++)
  {
   OGRPolygon polygon;
   OGRLinearRing poRing;
   poRing.addPoint((*ittri).a().x(),(*ittri).a().y(),(*ittri).a().z());
   poRing.addPoint((*ittri).b().x(),(*ittri).b().y(),(*ittri).b().z());
   poRing.addPoint((*ittri).c().x(),(*ittri).c().y(),(*ittri).c().z());
   poRing.addPoint((*ittri).a().x(),(*ittri).a().y(),(*ittri).a().z());

   polygon.addRing(&poRing);
   multiPoly.addGeometry(&polygon);

  }
  poFeature->SetGeometry(&multiPoly);
  if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )
  {
   printf( "Failed to create feature in shapefile.\n" );
   return false;
  }
  OGRFeature::DestroyFeature( poFeature );
 }
 OGRDataSource::DestroyDataSource( poDS );
Any help is appreciated!!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090227/8b02e654/attachment-0001.html
From walker at mfgis.com  Fri Feb 27 09:17:48 2009
From: walker at mfgis.com (Steve Walker)
Date: Fri Feb 27 09:17:52 2009
Subject: [gdal-dev] Re: Failure to compile 1.6.0 with errors 'libgdal.so:
 undefined reference to `PMPI::Intracomm::current_op'
In-Reply-To: <35792.24.129.92.213.1235677189.squirrel@mfgis.com>
References: <35792.24.129.92.213.1235677189.squirrel@mfgis.com>
Message-ID: <56405.24.129.92.213.1235744268.squirrel@mfgis.com>

I was able to complete a successful build by including the following in my
configure command:

--with-hdf4=no --with-hdf5=no

Which then of course leads to the follow-up:  What's wrong with my hdf
installs?

I have the following packages installed:
hdf4-tools
hdf5-tools
libhdf4g
libhdf4g-dev
libhdf5-lam-1.6.6-0
libhdf5-openmpi-1.6.6-0
libhdf5-openmpi-dev

I am not yet sure if or how this will affect my ability to work with ogdi
layers.

Steve


> Hi, I'm a brand new visitor to your list here.
>
> I'm working on Debian Squeeze and have had a functioning 1.6.0 install
> (compiled, not from a .deb) version up until this morning, when I went to
> re-compile so as to include additional support, specifically ogdi.
>
> After a half day of trying and failing, I felt it time to come here.  The
> error looks like this:
>
> /bin/sh /home/walker/admin/gdal-1.6.0/libtool --mode=link	g++  gdalinfo.o
> \
> 		/home/walker/admin/gdal-1.6.0/libgdal.la -o gdalinfo
> libtool: link: g++ gdalinfo.o -o .libs/gdalinfo
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so -L/usr/lib -L/usr/local/lib
> -L/usr/lib/lib -L/usr/include/ogdi -L/usr/include/ogdi/lib
> -L/usr/lib/grass/lib -L/usr/local/Geo_DSDK-7.0.0.2167/lib/Release
> -L/usr/local/Geo_DSDK-7.0.0.2167/3rd-party/lib/Release
> /usr/lib/libgeos_c.so /usr/lib/libgeos.so /usr/lib/libodbc.so
> /usr/lib/libodbcinst.so /usr/lib/libltdl.so /usr/lib/libexpat.so
> /usr/local/lib/libNCSEcw.so /usr/local/lib/libNCSCnet.so
> /usr/local/lib/libNCSUtil.so /usr/lib/libjasper.so /usr/lib/libhdf5.so -lm
> -lmfhdf -ldf -logdi31 /usr/lib/libjpeg.so -lpng -lnetcdf -lgrass_vect
> -lgrass_dig2 -lgrass_dgl -lgrass_rtree -lgrass_linkm -lgrass_dbmiclient
> -lgrass_dbmibase -lgrass_I -lgrass_gproj -lgrass_vask -lgrass_gmath
> -lgrass_gis -lgrass_datetime -lpq -lz -lrt -ldl /usr/lib/libcurl-gnutls.so
> -lltidsdk -lpthread -llt_kakadu
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `PMPI::Intracomm::current_op'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `PMPI::Comm::mpi_comm_map'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `MPI::Is_initialized()'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `PMPI::Comm::mpi_err_map'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `MPI::Op::Free()'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `op_intercept'
> /home/walker/admin/gdal-1.6.0/.libs/libgdal.so: undefined reference to
> `MPI::Op::Init(void (*)(void const*, void*, int, MPI::Datatype const&),
> bool)'
> collect2: ld returned 1 exit status
> make[1]: *** [gdalinfo] Error 1
> make[1]: Leaving directory `/home/walker/admin/gdal-1.6.0/apps'
> make: *** [apps-target] Error 2
>
>
> My configure command looks like this:
>
> ./configure \
>   --with-libz \
>   --with-pg=/usr/bin/pg_config \
>   --with-grass=/usr/lib/grass \
>   --with-libgrass \
>   --with-cfitsio \
>   --with-pcraste \
>   --with-png \
>   --with-libtiff \
>   --with-geotiff \
>   --with-jpeg \
>   --with-gif \
>   --with-ogdi=/usr/include/ogdi \
>   --with-jasper=/usr/lib \
>   --with-ecw=/usr/local \
>   --with-mrsid=/usr/local/Geo_DSDK-7.0.0.2167 \
>   --with-jp2mrsid \
>   --with-xerces \
>   --with-xerces-inc \
>   --with-xerces-lib \
>   --with-expat \
>   --with-expat-inc \
>   --with-expat-lib \
>   --with-odbc \
>   --with-curl=/usr/bin/curl-config \
>   --with-geos \
>   --with-perl \
>   --with-python
>
> I'll supply any more information as needed, such as installed packages,
> etc.
>
>
> Thanks in advance,
>
>
> --
> Steve Walker
> Middle Fork Geographic Information Services
> > http://mfgis.com
>


-- 
Steve Walker
Middle Fork Geographic Information Services
http://mfgis.com

From warmerdam at pobox.com  Fri Feb 27 11:25:40 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Feb 27 11:26:01 2009
Subject: [gdal-dev] Re: Failure to compile 1.6.0 with errors 'libgdal.so:
	undefined reference to `PMPI::Intracomm::current_op'
In-Reply-To: <56405.24.129.92.213.1235744268.squirrel@mfgis.com>
References: <35792.24.129.92.213.1235677189.squirrel@mfgis.com>
	<56405.24.129.92.213.1235744268.squirrel@mfgis.com>
Message-ID: <49A81404.5080600@pobox.com>

Steve Walker wrote:
> I was able to complete a successful build by including the following in my
> configure command:
> 
> --with-hdf4=no --with-hdf5=no
> 
> Which then of course leads to the follow-up:  What's wrong with my hdf
> installs?
> 
> I have the following packages installed:
> hdf4-tools
> hdf5-tools
> libhdf4g
> libhdf4g-dev
> libhdf5-lam-1.6.6-0
> libhdf5-openmpi-1.6.6-0
> libhdf5-openmpi-dev
> 
> I am not yet sure if or how this will affect my ability to work with ogdi
> layers.

Steve,

It would appear your hdf5 libraries are MPI enabled and have additional MPI
related dependencies that are not addressed by normal linking.  If you want
to use them you would need to work out the details and do some custom
hacking on your GDALmake.opt.

However, HDF4 and HDF5 formats are unrelated to OGDI and lack of them
should have no impact if you are primarily interested in the OGDI gateway.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From warmerdam at pobox.com  Fri Feb 27 11:40:36 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Feb 27 11:40:59 2009
Subject: [gdal-dev] ASCII Rasters and 'null' values in python-gdal
In-Reply-To: <6ec71d090902270009v2e4ec57at35efbf2d4485cbf@mail.gmail.com>
References: <6ec71d090902261304u398d4468we3ca3558ca918956@mail.gmail.com>
	<eb502d880902261826m37068ff7x606cec3abb1d887e@mail.gmail.com>
	<6ec71d090902270009v2e4ec57at35efbf2d4485cbf@mail.gmail.com>
Message-ID: <49A81784.9040501@pobox.com>

Oz Nahum wrote:
> Hi, Thanks for the answer.
> Ok, I admit the way I presented my first email is a bit confusing.
> But the problem is not with the 'null' values. Rather the problem is 
> with the raster containing the no data values as -9999. This is a no 
> data representation like you said. 
> My problem is that GDAL is converting the last -9999 value to this value 
> 31081.
> raster2.asc and looks like this:
> 
> in text editor:
>     |ncols         6
>     nrows         4
>     xllcorner     3366820.0000019
>     yllcorner     5814589.0300007
>     cellsize      10
>     NODATA_value -9999
>     1 1 1 1 1 1
>     1 1 1 1 1 1
>     1 1 1 1 1 1
>     1 1 1 1 -9999 -9999|
> 
> |in python:     
>  >>> dataset = gdal.Open('raster1.asc', GA_ReadOnly)
>  >>> a = gdal_array.DatasetReadAsArray(dataset)
>  >>> a
> array([[    1,     1,     1,     1,     1,     1],
>        [    1,     1,     1,     1,     1,     1],
>        [    1,     1,     1,     1,     1,     1],
>        [    1,     1,     1,     1, -9999, 31081]], dtype=int16)

Oz,

I'm not seeing this behavior on my system:

 >>> a = gdalnumeric.DatasetReadAsArray(ds)
 >>> print a
[[    1     1     1     1     1     1]
  [    1     1     1     1     1     1]
  [    1     1     1     1     1     1]
  [    1     1     1     1 -9999 -9999]]

I'd suggest filing a ticket on the issue and being very specific
about the operating system platform, and GDAL version you are using.
Also, make sure you zip and attach the grid file in case there is some
issue with missing final newline or something that is having an influence.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From christian.mueller at nvoe.at  Fri Feb 27 13:25:10 2009
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Fri Feb 27 13:25:15 2009
Subject: [gdal-dev] Re: gdal_retile.py -r mode ?
In-Reply-To: <1235736761752-2395290.post@n2.nabble.com>
References: <1235731430796-2394924.post@n2.nabble.com>
	<20090227120038.23937.qmail@mail.linux4all.at>
	<1235736761752-2395290.post@n2.nabble.com>
Message-ID: <20090227182510.25475.qmail@mail.linux4all.at>

The utility uses the python method gdal.ReprojectImage(....). 

As far as I see in http://www.gdal.org/gdalwarper_8h.html there is a new 
Constant GRA_Lanczos for an interpolation method which is not supported at 
the moment, but I see no constant for "mode" resampling. 

Perhaps we get a hint from an specialist. 

At the moment I see no possibility (but I could be wrong) 

christian 

 

acangi writes: 

> 
> Thanks for your answer. 
> 
> I'd be more interested in a "mode" resampling method for gdal_retile. Is it
> something you're thinking of ? Can it be reused from gdaladdo ? 
> 
>  
> 
> Christian M?ller wrote:
>> 
>> The error is correct. A look at the man page shows  
>> 
>> gdal_retile.py [-v] [-co NAME=VALUE]* [-of out_format] [-ps pixelWidth 
>> pixelHeight]
>>               [-ot  {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>>                      CInt16/CInt32/CFloat32/CFloat64}]'
>>               [ -tileIndex tileIndexName [-tileIndexField 
>> tileIndexFieldName]]
>>               [ -csv fileName [-csvDelim delimiter]]
>>               [-s_srs srs_def]  [-pyramidOnly]
>>               [-r {near/bilinear/cubic/cubicspline}]
>>               -levels numberoflevels
>>               -targetDir TileDirectory input_files  
>> 
>> 
>> which means that -r determines the resampling method, which could be  
>> 
>> near
>> bilinear
>> cubic
>> cubicspline  
>> 
>> and has nothing to do with the data size. At the moment, I have not 
>> implemented a parameter to change the color model (perhaps I should).  
>> 
>> Anyway, there are other possibilities to achieve this. (rgp2pct.py as an 
>> example).  
>> 
>> If you have many tiles, the best idea is to write a little script. If you 
>> are working on a linux box I could assist you.  
>> 
>> If you have many,many tiles, use the --optFile option  described here.
>> http://www.gdal.org/gdal_utilities.html  
>> 
>> If you have problems, send me a mail  
>> 
>> cheers
>> christian  
>> 
>>   
>> 
>> acangi writes:  
>> 
>>> 
>>> Hello,  
>>> 
>>> Trying to execute this command :
>>>  
>>> gdal_retile.py -targetDir pyramid -levels 4 -v -pyramidOnly -s_srs
>>> top50r.prj -ps 4000 4000 -r mode -co "TILED=YES" -co "INTERLEAVE=PIXEL"
>>> -co
>>> "COMPRESS=LZW" -tileIndex pyramid -tileIndexField location *map.tif  
>>> 
>>> gives the error "Unknown resampling method : mode", although it works
>>> fine
>>> in gdaladdo.  
>>> 
>>> It's gdal 1.6.0 --with-python. The data is colormapped, therefor I want
>>> to
>>> use mode. I don't want to convert it to RGB first because of the size of
>>> the
>>> data and I'm not the only one using it.  
>>> 
>>> Shouldn't the "-r mode" option work in gdal_retile ?
>>> -- 
>>> View this message in context:
>>> http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2394924.html
>>> Sent from the GDAL - Dev mailing list archive at Nabble.com.  
>>> 
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev@lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>   
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev@lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev 
>> 
>> 
> 
> -- 
> View this message in context: http://n2.nabble.com/gdal_retile.py--r-mode---tp2394924p2395290.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com. 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev@lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
 

From warmerdam at pobox.com  Fri Feb 27 13:33:20 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Feb 27 13:33:42 2009
Subject: [gdal-dev] Re: gdal_retile.py -r mode ?
In-Reply-To: <20090227182510.25475.qmail@mail.linux4all.at>
References: <1235731430796-2394924.post@n2.nabble.com>
	<20090227120038.23937.qmail@mail.linux4all.at>
	<1235736761752-2395290.post@n2.nabble.com>
	<20090227182510.25475.qmail@mail.linux4all.at>
Message-ID: <49A831F0.5070202@pobox.com>

Christian M?ller wrote:
> The utility uses the python method gdal.ReprojectImage(....).
> As far as I see in http://www.gdal.org/gdalwarper_8h.html there is a new 
> Constant GRA_Lanczos for an interpolation method which is not supported 
> at the moment, but I see no constant for "mode" resampling.
> Perhaps we get a hint from an specialist.
> At the moment I see no possibility (but I could be wrong)

Christian,

I do not believe that mode resampling is available via the warp api,
nor is it particularly conducive to such a resampling kernel since it
does not keep close track of which input pixels map to a particular
output pixel.  This is a surprisingly difficult thing to do when an
arbitrary spatial transformation is being applied.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From christian.mueller at nvoe.at  Fri Feb 27 14:12:29 2009
From: christian.mueller at nvoe.at (Christian =?iso-8859-1?Q?M=FCller?=)
Date: Fri Feb 27 14:33:23 2009
Subject: [gdal-dev] Re: gdal_retile.py -r mode ?
In-Reply-To: <49A831F0.5070202@pobox.com>
References: <1235731430796-2394924.post@n2.nabble.com>
	<20090227120038.23937.qmail@mail.linux4all.at>
	<1235736761752-2395290.post@n2.nabble.com>
	<20090227182510.25475.qmail@mail.linux4all.at>
	<49A831F0.5070202@pobox.com>
Message-ID: <20090227191229.6096.qmail@mail.linux4all.at>

Thanks for your answer. Another question, does it make sense to support the 
GRA_Lanczos interpolation method which has been introduced after I finished 
gdal_retile.py 

I would do a cvs checkout and send you the python file and the man page as 
attachment. 

christian 

 


Frank Warmerdam writes: 

> Christian M?ller wrote:
>> The utility uses the python method gdal.ReprojectImage(....).
>> As far as I see in http://www.gdal.org/gdalwarper_8h.html there is a new 
>> Constant GRA_Lanczos for an interpolation method which is not supported 
>> at the moment, but I see no constant for "mode" resampling.
>> Perhaps we get a hint from an specialist.
>> At the moment I see no possibility (but I could be wrong)
> 
> Christian, 
> 
> I do not believe that mode resampling is available via the warp api,
> nor is it particularly conducive to such a resampling kernel since it
> does not keep close track of which input pixels map to a particular
> output pixel.  This is a surprisingly difficult thing to do when an
> arbitrary spatial transformation is being applied. 
> 
> Best regards,
> -- 
> ---------------------------------------+---------------------------------- 
> ----
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent 
> 
 

From nimalikaf at gmail.com  Fri Feb 27 14:42:39 2009
From: nimalikaf at gmail.com (nimalika fernando)
Date: Fri Feb 27 14:42:42 2009
Subject: [gdal-dev] different results for vector and raster data
	reprojections
Message-ID: <39624f50902271142j2d6b8bcbsa9d724adb0d2f090@mail.gmail.com>

Hi,

I have used ogr2ogr to assign projection information(SL99) to some vector
data which does not contain any projection information.

I used the same projection information to reproject a raster in UTM 44N to
SL99.Both data sets contain data of same location.



When I try to overlay the projected data  ( using QGIS where the SL99 is
defined using the same projection information) there is a small shift in two
layers.



When check the projection information using ogrinfo/gdalinfo I found that
even though the same parameters are used for projection of vector and raster
data , some parts of the WKT is different. I am not sure whether this is the
reason for the problem in overlapping.



The resulting WKT are as follows

Raster



PROJCS["Transverse_Mercator",

    GEOGCS["Everest 1830",

        DATUM["unknown",

            SPHEROID["unnamed",6377276.345,300.8017000000115]],

        PRIMEM["Greenwich",0],

        UNIT["degree",0.0174532925199433]],

    PROJECTION["Transverse_Mercator"],

    PARAMETER["latitude_of_origin",7.00047],

    PARAMETER["central_meridian",80.77171],

    PARAMETER["scale_factor",1],

    PARAMETER["false_easting",200000],

    PARAMETER["false_northing",200000],

    UNIT["metre",1,

        AUTHORITY["EPSG","9001"]]]



Vector

PROJCS["Transverse_Mercator",

    GEOGCS["Everest 1830",

        DATUM["unknown",

            SPHEROID["evrst30",6377276.345,300.8017]],

        PRIMEM["Greenwich",0],

        UNIT["Degree",0.017453292519943295]],

    PROJECTION["Transverse_Mercator"],

    PARAMETER["latitude_of_origin",7.00047],

    PARAMETER["central_meridian",80.77171],

    PARAMETER["scale_factor",1],

    PARAMETER["false_easting",200000],

    PARAMETER["false_northing",200000],

    UNIT["Meter",1]]



Can anybody help me to identify what went wrong  ?

Thanking you



nimalika
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/00441567/attachment.html
From warmerdam at pobox.com  Fri Feb 27 15:05:16 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri Feb 27 15:05:39 2009
Subject: [gdal-dev] Re: gdal_retile.py -r mode ?
In-Reply-To: <20090227191229.6096.qmail@mail.linux4all.at>
References: <1235731430796-2394924.post@n2.nabble.com>
	<20090227120038.23937.qmail@mail.linux4all.at>
	<1235736761752-2395290.post@n2.nabble.com>
	<20090227182510.25475.qmail@mail.linux4all.at>
	<49A831F0.5070202@pobox.com>
	<20090227191229.6096.qmail@mail.linux4all.at>
Message-ID: <49A8477C.3000304@pobox.com>

Christian M?ller wrote:
> Thanks for your answer. Another question, does it make sense to support 
> the GRA_Lanczos interpolation method which has been introduced after I 
> finished gdal_retile.py
> I would do a cvs checkout and send you the python file and the man page 
> as attachment.

Christian,

Yes, that would be nice, but I'd suggest you file the change as a ticket
for more organized processing.  I'd also suggest you remove any validation
at the script level on the resampling algorithm so that algorithms added
in the future can be used without changes in the script even if they are
missing in the docs.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From frdcn at hotmail.com  Fri Feb 27 22:43:05 2009
From: frdcn at hotmail.com (godofredo contreras)
Date: Fri Feb 27 22:44:07 2009
Subject: [gdal-dev] OGR Grass driver error
Message-ID: <COL103-W42F42E9CDEFF8E42BCD6B9B2AB0@phx.gbl>


Hi:

I tried to use ogrinfo with the grass driver, this was the command I used:

C:\dev\cpp\qgisrelease>ogrinfo C:/spearfish60/PERMANENT/vector/landcover/head

and  I got the following warnings:

Warning 1: GRASS warning: Unable to open datum table file <C:/spearfish60/PERMAN
ENT/vector/landcover/head/etc/datum.table>
Warning 1: GRASS warning: Unable to open ellipsoid table file <C:/spearfish60/PE
RMANENT/vector/landcover/head/etc/ellipse.table>

and didn't show any layers.

Is the grass driver updated to work with grass 6.0 data?, I'm using the ogrinfo from
osgeo4w and I set GISBASE to an installation of grass-6.4.0RC3 inside osgeo4w 
directory. 

Regards
Godofredo Contreras

 

_________________________________________________________________
Windows Live?: Discover 10 secrets about the new Windows Live.  
http://windowslive.com/connect/post/jamiethomson.spaces.live.com-Blog-cns!550F681DAD532637!7540.entry?ocid=TXT_TAGLM_WL_t2_ugc_post_022009
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/5136d906/attachment-0001.html
From szekerest at gmail.com  Sat Feb 28 06:56:16 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Feb 28 06:56:22 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
Message-ID: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>

Folks,

I'm just trying to run the python tests as a part of my regular builds,
however the test mentioned above causes a crash either with Python25 or
Python26 all the time.
Could someone point me to a possible workaround to this issue? A fragment of
the test output attached below:



Running tests from gdrivers/gmt.py
  TEST: gmt_1 ... success
  TEST: gmt_2 ... success
Running tests from gdrivers/grass.py
  TEST: grass_1 ... success
  TEST: grass_2 ... skip
Running tests from gdrivers/grib.py
  TEST: grib_1 ... success
Running tests from gdrivers/gsc.py
  TEST: gsc_1 ... success
Running tests from gdrivers/gsg.py
  TEST: gsg_1 ... success
  TEST: gsg_2 ... success
  TEST: gsg_3 ... success
  TEST: gsg_4 ... success
  TEST: gsg_5 ... success
Running tests from gdrivers/gxf.py
  TEST: gxf_1 ... success
  TEST: : SAMPLE.GXF ... Downloading
http://download.osgeo.org/gdal/data/gxf/SAM
PLE.GXF (length = 437236 bytes)...
success
  TEST: : gxf_compressed.gxf ... Downloading
http://download.osgeo.org/gdal/data
/gxf/gxf_compressed.gxf (length = 316502 bytes)...
success
  TEST: : gxf_text.gxf ... Downloading
http://download.osgeo.org/gdal/data/gxf/g
xf_text.gxf (length = 692562 bytes)...
success
  TEST: : gxf_ul_r.gxf ... Downloading
http://download.osgeo.org/gdal/data/gxf/g
xf_ul_r.gxf (length = 316502 bytes)...
success
  TEST: : latlong.gxf ... Downloading
http://download.osgeo.org/gdal/data/gxf/la
tlong.gxf (length = 270333 bytes)...
success
  TEST: : spif83.gxf ... Downloading
http://download.osgeo.org/gdal/data/gxf/spi
f83.gxf (length = 1081848 bytes)...
success
Running tests from gdrivers/hdf5.py
  TEST: hdf5_1 ... success
  TEST: : HDF5:"C1979091.h5"://HDF4_PALGROUP/HDF4_PALETTE_2 ... Downloading
ftp:
//ftp.hdfgroup.uiuc.edu/hdf_files/hdf5/samples/convert/C1979091.h5...
success
  TEST: : HDF5:"C1979091.h5"://Raster_Image_#0 ... success
  TEST: :
HDF5:"half_moon_bay.grid"://HDFEOS/GRIDS/DEMGRID/Data_Fields/Elevation
 ... Downloading
ftp://ftp.hdfgroup.uiuc.edu/hdf_files/hdf5/geospatial/DEM/half_
moon_bay.grid...
success
Running tests from gdrivers/hfa.py
  TEST: hfa_histread ... success
  TEST: hfa_histwrite ... success
  TEST: hfa_int_stats_1 ... success
  TEST: hfa_int_stats_2 ... success
  TEST: hfa_float_stats_1 ... success
  TEST: hfa_float_stats_2 ... success
  TEST: hfa_int_read ... success
  TEST: hfa_float_read ... success
  TEST: hfa_pe_read ... success
  TEST: hfa_pe_write ... success
  TEST: hfa_metadata_1 ... success
  TEST: hfa_metadata_2 ... success
  TEST: hfa_grow_rrdlist ... success
  TEST: hfa_clean_ige ... success
  TEST: hfa_corrupt_aux ... success
  TEST: hfa_mapinformation_units ... success
  TEST: hfa_nodata_write ... success
  TEST: hfa_nodata_read ... success
  TEST: hfa_rotated_read ... success
  TEST: hfa_rotated_write ... Expected:
PROJCS["NAD83_Virginia_North",GEOGCS["GC
S_North_American_1983",DATUM["North_American_Datum_1983",SPHEROID["GRS_1980",637
8137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],
PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["standard_parallel_1",39.2],
PARAMETER["standard_parallel_2",38.03333333333333],PARAMETER["latitude_of_origin
",37.66666666666666],PARAMETER["central_meridian",-78.5],PARAMETER["false_eastin
g",11482916.66666667],PARAMETER["false_northing",6561666.666666667],PARAMETER["s
cale_factor",1.0],UNIT["Foot_US",0.30480060960121924]]
Got:      PROJCS["Lambert Conformal
Conic",GEOGCS["NAD83",DATUM["North_American_
Datum_1983",SPHEROID["GRS
1980",6378137,298.257222101,AUTHORITY["EPSG","7019"]],
TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0,AUTHORITY[
"EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHO
RITY["EPSG","4269"]],PROJECTION["Lambert_Conformal_Conic_2SP"],PARAMETER["standa
rd_parallel_1",39.2],PARAMETER["standard_parallel_2",38.03333333333333],PARAMETE
R["latitude_of_origin",37.66666666666666],PARAMETER["central_meridian",-78.5],PA
RAMETER["false_easting",11482916.66666667],PARAMETER["false_northing",6561666.66
6666668],UNIT["us_survey_feet",0.3048006096012192]]
fail
    SRS differs from expected.
  TEST: hfa_vsimem ... success
  TEST: hfa_proName ... success
  TEST: hfa_read_empty_compressed ... success
  TEST: hfa_unique_values_color_table ... success
  TEST: hfa_xforms_3rd ... success
  TEST: hfa_delete_colortable ... fail (blowup)
Traceback (most recent call last):
  File "pymod\gdaltest.py", line 99, in run_tests
    result = func()
  File ".\hfa.py", line 832, in hfa_delete_colortable
    ds.GetRasterBand(1).SetColorTable(None)
AttributeError: 'NoneType' object has no attribute 'GetRasterBand'
Running tests from gdrivers/ida.py
  TEST: ida_1 ... success
  TEST: ida_2 ... success
  TEST: ida_3 ... success
  TEST: ida_4 ... success
  TEST: ida_5 ... success
  TEST: ida_6 ... success
  TEST: ida_7 ... success
Running tests from gdrivers/idrisi.py
  TEST: idrisi_1 ... success
  TEST: idrisi_2 ... success
  TEST: idrisi_3 ... success
  TEST: idrisi_4 ... success
  TEST: idrisi_cleanup ... success
Running tests from gdrivers/ilwis.py
  TEST: ilwis_1 ... success
  TEST: ilwis_2 ... success
  TEST: ilwis_3 ... success
  TEST: ilwis_4 ... success
  TEST: ilwis_5 ... success
  TEST: ilwis_cleanup ... success
Running tests from gdrivers/ingr.py
  TEST: ingr_1 ... success
  TEST: ingr_2 ... success
  TEST: ingr_3 ... success
  TEST: ingr_4 ... success
  TEST: ingr_5 ... success
  TEST: ingr_6 ... success
  TEST: ingr_7 ... success
  TEST: ingr_8 ... success
  TEST: ingr_9 ... success
  TEST: ingr_10 ... success
  TEST: ingr_11 ... success
  TEST: ingr_12 ... success
  TEST: ingr_13 ... success
  TEST: ingr_14 ... success
  TEST: ingr_15 ... success
  TEST: ingr_16 ... success
Running tests from gdrivers/isis.py
  TEST: isis_1 ... success
  TEST: isis_2 ... success
Running tests from gdrivers/isis2.py
  TEST: isis2_1 ... success
Running tests from gdrivers/jdem.py
  TEST: jdem_1 ... success
Running tests from gdrivers/jp2kak.py
  TEST: jp2kak_1 ... skip
  TEST: jp2kak_2 ... skip
  TEST: jp2kak_3 ... skip
  TEST: jp2kak_4 ... skip
  TEST: jp2kak_5 ... skip
  TEST: jp2kak_6 ... skip
  TEST: jp2kak_7 ... skip
  TEST: jp2kak_8 ... skip
  TEST: jp2kak_9 ... skip
  TEST: jp2kak_10 ... skip
  TEST: jp2kak_cleanup ... success
Running tests from gdrivers/jpeg.py
  TEST: jpeg_1 ... success
  TEST: jpeg_2 ... success
  TEST: jpeg_3 ... success
  TEST: jpeg_4 ... success
  TEST: jpeg_5 ... success
  TEST: jpeg_6 ... success
  TEST: jpeg_7 ... success
  TEST: jpeg_8 ... success
  TEST: jpeg_9 ... success
Running tests from gdrivers/jpeg2000.py
  TEST: jpeg2000_1 ... Deregistering JP2ECW
success
  TEST: jpeg2000_2 ... skip
  TEST: jpeg2000_3 ... skip
  TEST: jpeg2000_4 ... skip
  TEST: jpeg2000_5 ... skip
  TEST: jpeg2000_6 ... skip
  TEST: jpeg2000_online_1 ... skip
  TEST: jpeg2000_online_2 ... skip
  TEST: jpeg2000_online_3 ... skip
  TEST: jpeg2000_online_4 ... skip
  TEST: jpeg2000_cleanup ... Registering JP2ECW
success
Running tests from gdrivers/l1b.py
  TEST: : n12gac8bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1b
/n12gac8bit.l1b (length = 99962 bytes)...
success
  TEST: : n12gac10bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1
b/n12gac10bit.l1b (length = 128922 bytes)...
success
  TEST: : n14gac16bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1
b/n14gac16bit.l1b (length = 199882 bytes)...
success
  TEST: : n15gac8bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1b
/n15gac8bit.l1b (length = 151040 bytes)...
success
  TEST: : n16gac10bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1
b/n16gac10bit.l1b (length = 198656 bytes)...
success
  TEST: : n17gac16bit.l1b ... Downloading
http://download.osgeo.org/gdal/data/l1
b/n17gac16bit.l1b (length = 231424 bytes)...
success
  TEST: : frang.1b ... Downloading 30000 bytes from
http://www2.ncdc.noaa.gov/do
cs/podug/data/avhrr/frang.1b...
success
  TEST: : franh.1b ... Downloading 100000 bytes from
http://www2.ncdc.noaa.gov/d
ocs/podug/data/avhrr/franh.1b...
success
  TEST: : calfirel.1b ... Downloading 30000 bytes from
http://www2.ncdc.noaa.gov
/docs/podug/data/avhrr/calfirel.1b...
success
  TEST: : rapnzg.1b ... Downloading 30000 bytes from
http://www2.ncdc.noaa.gov/d
ocs/podug/data/avhrr/rapnzg.1b...
success
  TEST: : noaa18.n1b ... Downloading 50000 bytes from
ftp://ftp.sat.dundee.ac.uk
/misc/testdata/new_noaa/new_klm_format/noaa18.n1b...
success
  TEST: : noaa1b ... Downloading 150000 bytes from
ftp://ftp.sat.dundee.ac.uk/mi
sc/testdata/metop/noaa1b...
success
Running tests from gdrivers/lan.py
  TEST: lan_1 ... success
  TEST: lan_2 ... success
Running tests from gdrivers/lcp.py
  TEST: lcp_1 ... success
  TEST: lcp_2 ... success
Running tests from gdrivers/leveller.py
  TEST: leveller_1 ... success
Running tests from gdrivers/mem.py
  TEST: mem_1 ... success
  TEST: mem_2 ... skip
  TEST: mem_3 ... success
  TEST: mem_cleanup ... success
Running tests from gdrivers/mff.py
  TEST: mff_1 ... success
  TEST: mff_2 ... success
  TEST: mff_3 ... success
Running tests from gdrivers/mff2.py
  TEST: mff2_1 ... success
Running tests from gdrivers/mrsid.py
  TEST: mrsid_1 ... success
  TEST: mrsid_2 ... success
  TEST: mrsid_3 ... success
  TEST: mrsid_4 ... success
  TEST: mrsid_5 ... skip
  TEST: mrsid_6 ... skip
  TEST: mrsid_7 ... skip
  TEST: mrsid_online_1 ... skip
  TEST: mrsid_online_2 ... skip
  TEST: mrsid_online_3 ... skip
  TEST: mrsid_online_4 ... skip
  TEST: mrsid_cleanup ... success
Running tests from gdrivers/ndf.py
  TEST: ndf_1 ... success
Running tests from gdrivers/netcdf.py
  TEST: netcdf_1 ... success
  TEST: netcdf_2 ... success
  TEST: netcdf_3 ... success
  TEST: netcdf_4 ... success
Running tests from gdrivers/nitf.py
  TEST: nitf_1 ... success
  TEST: nitf_2 ... success
  TEST: nitf_3 ... success
  TEST: nitf_4 ... success
  TEST: nitf_5 ... success
  TEST: nitf_6 ... success
  TEST: nitf_7 ... success
  TEST: nitf_8 ... success
  TEST: nitf_9 ... success
  TEST: nitf_10 ... success
  TEST: nitf_11 ... success
  TEST: nitf_12 ... success
  TEST: nitf_13 ... success
  TEST: nitf_14 ... success
  TEST: nitf_15 ... success
  TEST: nitf_16 ... success
  TEST: nitf_17 ... success
  TEST: nitf_18 ... success
  TEST: nitf_19 ... success
  TEST: nitf_20 ... success
  TEST: nitf_21 ... success
  TEST: nitf_22 ... success
  TEST: nitf_23 ... success
  TEST: nitf_24 ... success
  TEST: nitf_25 ... success
  TEST: nitf_26 ... success
  TEST: nitf_27 ... success
  TEST: nitf_28_jp2ecw ... success
  TEST: nitf_28_jp2mrsid ... skip
  TEST: nitf_28_jp2kak ... skip
  TEST: nitf_29 ... success
  TEST: nitf_30 ... success
  TEST: nitf_31 ... success
  TEST: nitf_32 ... success
  TEST: nitf_33 ... success
  TEST: nitf_34 ... success
  TEST: nitf_35 ... success
  TEST: nitf_36 ... 4.96162341488e+24 3.06042744026e+25
fail
    did not get expected mean or standard dev.
  TEST: nitf_37 ... NMAKE : fatal error U1077:
'E:\builds\Python26\python.exe' :
 return code '0xc0000409'
Stop.



Thanks,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/67966a2d/attachment.html
From szekerest at gmail.com  Sat Feb 28 08:25:33 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Feb 28 08:25:38 2009
Subject: [gdal-dev] SWIG Python 2.6 build warnings
Message-ID: <f3b73b7d0902280525v58ad715cp65550274e746f042@mail.gmail.com>

Hi All,

I just wanted to know whether the following warnings are about to be ignored
or not during the Windows builds?

http://vbkto.dyndns.org:1280/sdk/build-output/python-build.txt


Best regards,

Tamas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/1ad87066/attachment-0001.html
From neteler at osgeo.org  Sat Feb 28 12:27:40 2009
From: neteler at osgeo.org (Markus Neteler)
Date: Sat Feb 28 12:27:42 2009
Subject: [gdal-dev] OGR Grass driver error
In-Reply-To: <COL103-W42F42E9CDEFF8E42BCD6B9B2AB0@phx.gbl>
References: <COL103-W42F42E9CDEFF8E42BCD6B9B2AB0@phx.gbl>
Message-ID: <86782b610902280927w2dc037c2s923b1f031626b636@mail.gmail.com>

On Sat, Feb 28, 2009 at 4:43 AM, godofredo contreras <frdcn@hotmail.com> wrote:
> Hi:
>
> I tried to use ogrinfo with the grass driver, this was the command I used:
>
> C:\dev\cpp\qgisrelease>ogrinfo
> C:/spearfish60/PERMANENT/vector/landcover/head
>
> and? I got the following warnings:
>
> Warning 1: GRASS warning: Unable to open datum table file
> <C:/spearfish60/PERMAN
> ENT/vector/landcover/head/etc/datum.table>
> Warning 1: GRASS warning: Unable to open ellipsoid table file
> <C:/spearfish60/PE
> RMANENT/vector/landcover/head/etc/ellipse.table>
>
> and didn't show any layers.
>
> Is the grass driver updated to work with grass 6.0 data?, I'm using the
> ogrinfo from
> osgeo4w and I set GISBASE to an installation of grass-6.4.0RC3 inside
> osgeo4w
> directory.

The problem is that the software wasn't compiled with the (AFAIK)
--with-proj-share=...
flag to indicate the correct path of these files.

On my Linux box they stay in:
/usr/share/gdal/grass/etc/

Best reported to
http://trac.osgeo.org/osgeo4w/
as bug.

Markus
From warmerdam at pobox.com  Sat Feb 28 12:53:30 2009
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Sat Feb 28 12:53:44 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
In-Reply-To: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
References: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
Message-ID: <49A97A1A.4050104@pobox.com>

Tamas Szekeres wrote:
> Folks,
> 
> I'm just trying to run the python tests as a part of my regular builds, 
> however the test mentioned above causes a crash either with Python25 or 
> Python26 all the time.
> Could someone point me to a possible workaround to this issue? A 
> fragment of the test output attached below:
...
>   TEST: nitf_34 ... success
>   TEST: nitf_35 ... success
>   TEST: nitf_36 ... 4.96162341488e+24 3.06042744026e+25
> fail
>     did not get expected mean or standard dev.
>   TEST: nitf_37 ... NMAKE : fatal error U1077: 
> 'E:\builds\Python26\python.exe' :
>  return code '0xc0000409'
> Stop.

Tamas,

I was seeing a somewhat similar effect with the latest nitf.py and
a week old FWTools build but when I refreshed from the latest
GDAL source the problem went away leading me to suspect that the
test is for a recent fix put in by Even.  Are you confident you are
running the test with the latest source?  Perhaps there was a short overlap?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From frankie at debian.org  Sat Feb 28 13:51:14 2009
From: frankie at debian.org (Francesco P. Lovergine)
Date: Sat Feb 28 13:52:46 2009
Subject: [gdal-dev] Re: Failure to compile 1.6.0 with errors
	'libgdal.so: undefined reference to `PMPI::Intracomm::current_op'
In-Reply-To: <56405.24.129.92.213.1235744268.squirrel@mfgis.com>
References: <35792.24.129.92.213.1235677189.squirrel@mfgis.com>
	<56405.24.129.92.213.1235744268.squirrel@mfgis.com>
Message-ID: <20090228185113.GA3589@frankie.is-a-geek.org>

On Fri, Feb 27, 2009 at 02:17:48PM -0000, Steve Walker wrote:
> I was able to complete a successful build by including the following in my
> configure command:
> 
> --with-hdf4=no --with-hdf5=no
> 
> Which then of course leads to the follow-up:  What's wrong with my hdf
> installs?
> 
> I have the following packages installed:
> hdf4-tools
> hdf5-tools
> libhdf4g
> libhdf4g-dev
> libhdf5-lam-1.6.6-0
> libhdf5-openmpi-1.6.6-0
> libhdf5-openmpi-dev
> 
> I am not yet sure if or how this will affect my ability to work with ogdi
> layers.
> 

You should install the serial edition of the hdf5 development stuff before
compiling:

libhdf5-serial-dev

The hdf4 stuff is not relevant.

-- 
Francesco P. Lovergine
From even.rouault at mines-paris.org  Sat Feb 28 14:04:50 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Feb 28 14:05:02 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
In-Reply-To: <49A97A1A.4050104@pobox.com>
References: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
	<49A97A1A.4050104@pobox.com>
Message-ID: <200902282004.51235.even.rouault@mines-paris.org>

Yes, exactly you need latest trunk to run this test.

Le Saturday 28 February 2009 18:53:30 Frank Warmerdam, vous avez ?crit?:
> I was seeing a somewhat similar effect with the latest nitf.py and
> a week old FWTools build but when I refreshed from the latest
> GDAL source the problem went away leading me to suspect that the
> test is for a recent fix put in by Even. ?Are you confident you are
> running the test with the latest source? ?Perhaps there was a short
> overlap?


From szekerest at gmail.com  Sat Feb 28 14:09:12 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Feb 28 14:09:15 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
In-Reply-To: <200902282004.51235.even.rouault@mines-paris.org>
References: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
	<49A97A1A.4050104@pobox.com>
	<200902282004.51235.even.rouault@mines-paris.org>
Message-ID: <f3b73b7d0902281109h3dac9c08xfb22fdcf918eb430@mail.gmail.com>

I've been running against the stable branch. Is this an issue?

Best regards,

Tamas


2009/2/28 Even Rouault <even.rouault@mines-paris.org>

> Yes, exactly you need latest trunk to run this test.
>
> Le Saturday 28 February 2009 18:53:30 Frank Warmerdam, vous avez ?crit :
> > I was seeing a somewhat similar effect with the latest nitf.py and
> > a week old FWTools build but when I refreshed from the latest
> > GDAL source the problem went away leading me to suspect that the
> > test is for a recent fix put in by Even.  Are you confident you are
> > running the test with the latest source?  Perhaps there was a short
> > overlap?
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/672e5b23/attachment.html
From even.rouault at mines-paris.org  Sat Feb 28 14:30:10 2009
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat Feb 28 14:30:30 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
In-Reply-To: <f3b73b7d0902281109h3dac9c08xfb22fdcf918eb430@mail.gmail.com>
References: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
	<200902282004.51235.even.rouault@mines-paris.org>
	<f3b73b7d0902281109h3dac9c08xfb22fdcf918eb430@mail.gmail.com>
Message-ID: <200902282030.13954.even.rouault@mines-paris.org>

Tamas, 

Yes, nitf_37 won't work against the stable branch.

Generally speaking, I think you should only run the stable branch with its 
autotest in branches/1.6/autotest, and not trunk autotest, as there are new 
features and bug fixes that go only in trunk and whose testing against stable 
can easily crash. Of course, I could make some conditionnal testing on the 
GDAL version to skip that test, but I don't think it's really worse the 
effort as similar issues could appear elsewhere in that autotest suite. And 
even if you don't get crashes, you'll get lots of failed tests.

Even

Le Saturday 28 February 2009 20:09:12, vous avez ?crit?:
> I've been running against the stable branch. Is this an issue?
>
> Best regards,
>
> Tamas
>
>
> 2009/2/28 Even Rouault <even.rouault@mines-paris.org>
>
> > Yes, exactly you need latest trunk to run this test.
> >
> > Le Saturday 28 February 2009 18:53:30 Frank Warmerdam, vous avez ?crit :
> > > I was seeing a somewhat similar effect with the latest nitf.py and
> > > a week old FWTools build but when I refreshed from the latest
> > > GDAL source the problem went away leading me to suspect that the
> > > test is for a recent fix put in by Even.  Are you confident you are
> > > running the test with the latest source?  Perhaps there was a short
> > > overlap?


From szekerest at gmail.com  Sat Feb 28 14:32:47 2009
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sat Feb 28 14:32:48 2009
Subject: [gdal-dev] GDAL autotest (nitf_37) causes a crash on Windows
In-Reply-To: <200902282030.13954.even.rouault@mines-paris.org>
References: <f3b73b7d0902280356j1b237044ke1384f626a332096@mail.gmail.com>
	<200902282004.51235.even.rouault@mines-paris.org>
	<f3b73b7d0902281109h3dac9c08xfb22fdcf918eb430@mail.gmail.com>
	<200902282030.13954.even.rouault@mines-paris.org>
Message-ID: <f3b73b7d0902281132v3128d5a2k87713c24047e165d@mail.gmail.com>

Yes, I'll do so in my final configuration.

Thanks,

Tamas




2009/2/28 Even Rouault <even.rouault@mines-paris.org>

> Tamas,
>
> Yes, nitf_37 won't work against the stable branch.
>
> Generally speaking, I think you should only run the stable branch with its
> autotest in branches/1.6/autotest, and not trunk autotest, as there are new
> features and bug fixes that go only in trunk and whose testing against
> stable
> can easily crash. Of course, I could make some conditionnal testing on the
> GDAL version to skip that test, but I don't think it's really worse the
> effort as similar issues could appear elsewhere in that autotest suite. And
> even if you don't get crashes, you'll get lots of failed tests.
>
> Even
>
> Le Saturday 28 February 2009 20:09:12, vous avez ?crit :
> > I've been running against the stable branch. Is this an issue?
> >
> > Best regards,
> >
> > Tamas
> >
> >
> > 2009/2/28 Even Rouault <even.rouault@mines-paris.org>
> >
> > > Yes, exactly you need latest trunk to run this test.
> > >
> > > Le Saturday 28 February 2009 18:53:30 Frank Warmerdam, vous avez ?crit
> :
> > > > I was seeing a somewhat similar effect with the latest nitf.py and
> > > > a week old FWTools build but when I refreshed from the latest
> > > > GDAL source the problem went away leading me to suspect that the
> > > > test is for a recent fix put in by Even.  Are you confident you are
> > > > running the test with the latest source?  Perhaps there was a short
> > > > overlap?
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20090228/9d9b70e2/attachment.html
