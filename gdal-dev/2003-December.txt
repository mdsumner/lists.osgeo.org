From fulton at cmu.edu  Mon Dec  1 16:11:09 2003
From: fulton at cmu.edu (Sean Fulton)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Re: undefined python objects
Message-ID: <E29CD1B0-2442-11D8-9845-003065D5F140@cmu.edu>

> I am trying to compile GDAL on OSX with python support, but I get the 
> following errors on building:
> <SNIP>
> The only advice I have seen so far is to compile without python 
> support, but thats not really a solution. Python support is the only 
> reason I am looking to use GDAL.
>
> Thanks in advance,

Chris,

The python that comes with OS X isn't set-up the way it is on other 
OSs. There is no shared library (i.e. libpython.so or libpython.dylib), 
at least on 10.2, to which GDAL can link . I *think* 10.3 has python as 
a framework in which case you may be able to link against 
/Library/Frameworks/Python.framework/Versions/Current/Python by passing 
'-framework Python' to the linker. Or you could try creating a soft 
link from  /path/to/lib/libpython2.3.dylib to 
/Library/Frameworks/Python.framework/Versions/Current/Python.

I think you can build python as a framework by hand if you're not on 
Panther. Searching python.org will probably be more useful than I have 
been. The GDAL developers probably don't have the time or resources to 
hunt down platform inconsistencies like this, so I'm sure they'd 
appreciate any help in resolving it.

Good luck, and let us know if you get it working!

	Sean


From jgallagher at gso.uri.edu  Mon Dec  1 16:21:52 2003
From: jgallagher at gso.uri.edu (James Gallagher)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] A questions about IRasterIO and overlays
Message-ID: <1070313712.2887.91.camel@comet.dods.org>

I'm improving a GDAL driver for the DODS/OPeNDAP protocol. The driver
can read rasters from DODS/OPeNDAP servers. One problem with the current
implementation is that it always reads the entire raster. 

Before I dive into IRasterIO() I'd like to make sure providing my own
implementation of that method is really the best way to go. OPeNDAP
provides ways to read parts of rasters using the indexes combined with
an optional 'stride' value (which allows for sub-sampling).

I was also wondering about overlays and the comment that a driver that
provides its own implementation of IRasterIO() would normally implement
overlays. What exactly are 'overlays?'

As you can probably tell, I'm not that familiar with GIS software so my
apologies if these are really basic questions.

Thanks,
James
-- 
__________________________________________________________________________
James Gallagher		         The Distributed Oceanographic Data System
jgallagher@gso.uri.edu               http://unidata.ucar.edu/packages/dods
Voice/Fax: 406.723.8663

From chris at fonnesbeck.org  Mon Dec  1 17:09:48 2003
From: chris at fonnesbeck.org (Christopher Fonnesbeck)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Re: undefined python objects
In-Reply-To: <E29CD1B0-2442-11D8-9845-003065D5F140@cmu.edu>
References: <E29CD1B0-2442-11D8-9845-003065D5F140@cmu.edu>
Message-ID: <144DC63F-244B-11D8-8C0F-000A956FDAC0@fonnesbeck.org>

On Dec 1, 2003, at 4:11 PM, Sean Fulton wrote:

>> I am trying to compile GDAL on OSX with python support, but I get the  
>> following errors on building:
>> <SNIP>
>> The only advice I have seen so far is to compile without python  
>> support, but thats not really a solution. Python support is the only  
>> reason I am looking to use GDAL.
>>
>> Thanks in advance,
>
> Chris,
>
> The python that comes with OS X isn't set-up the way it is on other  
> OSs. There is no shared library (i.e. libpython.so or  
> libpython.dylib), at least on 10.2, to which GDAL can link . I *think*  
> 10.3 has python as a framework in which case you may be able to link  
> against /Library/Frameworks/Python.framework/Versions/Current/Python  
> by passing '-framework Python' to the linker. Or you could try  
> creating a soft link from  /path/to/lib/libpython2.3.dylib to  
> /Library/Frameworks/Python.framework/Versions/Current/Python.
>
> I think you can build python as a framework by hand if you're not on  
> Panther. Searching python.org will probably be more useful than I have  
> been. The GDAL developers probably don't have the time or resources to  
> hunt down platform inconsistencies like this, so I'm sure they'd  
> appreciate any help in resolving it.
>
> Good luck, and let us know if you get it working!
>
> 	Sean
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev
>
>

I have used "-framework Python" as the python link arguments, and based  
on the build output, I think it finds it:

  g++ -Wall -O2 -I../port -I../port -I../gcore -I../ogr  
-I/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3  
-I/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
python2.3 -c gdalnumeric.cpp -o gdalnumeric.o >/dev/null 2>&1

It still, however, gets the undefined symbols that I cited previously.  
If it finds the framework, then the problem lies elsewhere, doesnt it?

Thanks again,
Chris


--
Christopher J. Fonnesbeck ( c h r i s @ f o n n e s b e c k . o r g )
Georgia Cooperative Fish & Wildlife Research Unit, University of Georgia


From junshi at mail.ustc.edu.cn  Mon Dec  1 10:42:27 2003
From: junshi at mail.ustc.edu.cn (junshi@mail.ustc.edu.cn)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] a question
Message-ID: <1488.210.45.70.56.1070293347.squirrel@webmail.ustc.edu.cn>

Dear Sir,

I downloaded the jasper-1.700.5 and my operating system is windows 2000.

I am try to use Microsoft Visual C 6.0 to write a program in my research
of Jpeg2000. But I met a problem.
I used MSVC to bulid a dialog.I added all the h files in the directory
".../libjasper/include/jasper", the c files in the directory
"".../libjasper/base" and the lib file "libjasper.lib" to my project. Then
I added "#include <jasper/jasper.h>" in MytestDlg.cpp.
In "Project->Settings->", I set all the c files in the directory
"".../libjasper/base" as "Automatic use of precompiled headers" (or "Not
using precompiled headers"). Then I built the program, but I foud  eight
errors. These are as followed:

d:Mytest\libjasper\include\jasper\jas_stream.h(131) : fatal error C1083:
Cannot open include file: 'unistd.h': No such file or directory
jas_init.c
d:Mytest\libjasper\include\jasper\jas_types.h(157) : fatal error C1083:
Cannot open include file: 'stdbool.h': No such file or directory
jas_seq.c
Others are the same.

What is the problem? Is it a bug? Would you kindly tell me how to solve it?

Yours sincerely,
Shi Jun


From dron at ak4719.spb.edu  Tue Dec  2 10:03:23 2003
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] a question
In-Reply-To: <1488.210.45.70.56.1070293347.squirrel@webmail.ustc.edu.cn>
References: <1488.210.45.70.56.1070293347.squirrel@webmail.ustc.edu.cn>
Message-ID: <20031202150323.GB28185@ak4719.spb.edu>

On Mon, Dec 01, 2003 at 11:42:27PM +0800, junshi@mail.ustc.edu.cn wrote:
> I downloaded the jasper-1.700.5 and my operating system is windows 2000.
> 
> I am try to use Microsoft Visual C 6.0 to write a program in my
> research of Jpeg2000. But I met a problem. I used MSVC to bulid a
> dialog.I added all the h files in the directory
> ".../libjasper/include/jasper", the c files in the directory
> "".../libjasper/base" and the lib file "libjasper.lib" to my project.
> Then I added "#include <jasper/jasper.h>" in MytestDlg.cpp. In
> "Project->Settings->", I set all the c files in the directory
> "".../libjasper/base" as "Automatic use of precompiled headers" (or
> "Not using precompiled headers"). Then I built the program, but I foud
> eight errors. These are as followed:
> 
> d:Mytest\libjasper\include\jasper\jas_stream.h(131) : fatal error C1083:
> Cannot open include file: 'unistd.h': No such file or directory
> jas_init.c
> d:Mytest\libjasper\include\jasper\jas_types.h(157) : fatal error C1083:
> Cannot open include file: 'stdbool.h': No such file or directory
> jas_seq.c
> Others are the same.
> 
> What is the problem? Is it a bug? Would you kindly tell me how to
> solve it?

Hello,

The source of problems is jas_config.h file. The file is autogenerated
by the configure script in POSIX environment. In case of MSVC compiler
that file should be manually copied from the jas_config2.h. It is
handled automatically by the bundled MSVC project.

					Regards,
					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From warmerdam at pobox.com  Tue Dec  2 10:30:23 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Shapelib moved
Message-ID: <3FCCB00F.9060703@pobox.com>

Folks,

I have removed gdal/frmts/shapelib from the GDAL source tree.  If you are
getting warnings when you do a cvs update, you may need to do a
"rm -rf frmts/shapelib".

Shapelib is now hosted in it's own CVS tree, and the web site is
hosted at http://shapelib.maptools.org/.  I will continue to maintain
a copy of a few files in gdal/ogr/ogrsf_frmts/shape but these will be a
clone of the master, and should not be updated directly.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From dem at acri-st.fr  Tue Dec  2 11:26:06 2003
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Shapelib moved => gdalindex pb
In-Reply-To: <3FCCB00F.9060703@pobox.com>
Message-ID: <5.0.2.1.2.20031202172016.00b09ea0@mail.acri.fr>

Hi Frank,

I've just updated and there are minor problems with gdalindex.
With this changes it works for me under Windows :

dem@dem /cygdrive/e/acri/cvs_checkout/gdal
$ cvs diff apps/gdaltindex.c
Index: apps/gdaltindex.c
===================================================================
RCS file: /cvsroot/osrs/gdal/apps/gdaltindex.c,v
retrieving revision 1.4
diff -r1.4 gdaltindex.c
45c45
< #include "shapelib/shapefil.h"
---
 > #include "ogrsf_frmts/shape/shapefil.h"


dem@dem /cygdrive/e/acri/cvs_checkout/gdal
$ cvs diff apps/makefile.vc
Index: apps/makefile.vc
===================================================================
RCS file: /cvsroot/osrs/gdal/apps/makefile.vc,v
retrieving revision 1.16
diff -r1.16 makefile.vc
47,48c47,48
<               ../frmts/shapelib/shpopen.c \
<               ../frmts/shapelib/dbfopen.c \
---
 >               ../ogr/ogrsf_frmts/shape/shpopen.c \
 >               ../ogr/ogrsf_frmts/shape/dbfopen.c \


Regard,

Julien


At 10:30 02/12/2003 -0500, you wrote:
>Folks,
>
>I have removed gdal/frmts/shapelib from the GDAL source tree.  If you are
>getting warnings when you do a cvs update, you may need to do a
>"rm -rf frmts/shapelib".
>
>Shapelib is now hosted in it's own CVS tree, and the web site is
>hosted at http://shapelib.maptools.org/.  I will continue to maintain
>a copy of a few files in gdal/ogr/ogrsf_frmts/shape but these will be a
>clone of the master, and should not be updated directly.
>
>Best regards,
>
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@remotesensing.org
>http://remotesensing.org/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Tue Dec  2 11:54:42 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Shapelib moved => gdalindex pb
In-Reply-To: <5.0.2.1.2.20031202172016.00b09ea0@mail.acri.fr>
References: <5.0.2.1.2.20031202172016.00b09ea0@mail.acri.fr>
Message-ID: <3FCCC3D2.1070806@pobox.com>

Julien Demaria wrote:
> Hi Frank,
> 
> I've just updated and there are minor problems with gdalindex.
> With this changes it works for me under Windows :

Julien,

Thanks ... fixes applied to CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From bfraser at geoanalytic.com  Tue Dec  2 18:38:23 2003
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Modis L1B and gdal_translate 1.1.9
Message-ID: <025401c3b92d$603811a0$020002c0@SHARK>

Andrey,

  I'm trying to get gdal_translate (v1.1.9) to convert a Modis image:
ftp://g0dps01u.ecs.nasa.gov/MODIS_Terra_Radiances_Geolocation/MOD02QKM.004/2003.12.02//MOD02QKM.A2003336.0720.004.2003336144538.hdf

to a geotiff.  v1.1.9 crashes, but v1.1.8 successfully converts it using the following commandline:

C:\>gdal_translate -of GTiff HDF4_SDS:MODIS_L1B:"MOD02QKM.A2003336.0720.004.2003336144538.hdf":2 test.tif

Is this a known problem?   

Thanks!
Brent Fraser

GeoAnalytic Inc.
Tel:(403) 213-2700
bfraser@geoanalytic.com
www.geoanalytic.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031202/3602d581/attachment.html
From schut at sarvision.com  Wed Dec  3 03:09:24 2003
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] gdalwarp and Goode's Homolosine projection
In-Reply-To: <025401c3b92d$603811a0$020002c0@SHARK> (from bfraser@geoanalytic.com on Wed, Dec 03, 2003 at 00:38:23 +0100)
References: <025401c3b92d$603811a0$020002c0@SHARK>
Message-ID: <20031203080924.GG29249@lowresbox.lan>

Frank and others,

I couldn't get gdalwarp to work on rasters in Goode's Homolosine  
projection (I want to reproject modis composites, which come in this  
projection, into unprojected latlon). I suppose Goode's Homolosine is  
not supported by gdalwarp? I know it actually is a mixture of  
projections. It exists in proj4, however. Now I use grass to reproject,  
but it is way slow and I don't have really the need to get all my  
rasters into grass and then export them again.

If it is not supported, any chance to get it supported?
If it is supported, what am I doing wrong? Could you give me an  
example?

Later,
Vincent Schut.

From dron at ak4719.spb.edu  Wed Dec  3 03:36:15 2003
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Modis L1B and gdal_translate 1.1.9
In-Reply-To: <025401c3b92d$603811a0$020002c0@SHARK>
References: <025401c3b92d$603811a0$020002c0@SHARK>
Message-ID: <20031203083615.GB4925@ak4719.spb.edu>

>   I'm trying to get gdal_translate (v1.1.9) to convert a Modis image:
>   ftp://g0dps01u.ecs.nasa.gov/MODIS_Terra_Radiances_Geolocation/MOD02QKM.004/2003.12.02//MOD02QKM.A2003336.0720.004.2003336144538.hdf
> 
> to a geotiff.  v1.1.9 crashes, but v1.1.8 successfully converts it

Brent,

Before I shall download and test your file could you try it with the
latest dayly snapshot of the GDAL?

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From fulton at cmu.edu  Wed Dec  3 10:51:47 2003
From: fulton at cmu.edu (Sean Fulton)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Re: undefined python objects
In-Reply-To: <20031202170001.22587.22420.Mailman@yoda.imagelinks.com>
References: <20031202170001.22587.22420.Mailman@yoda.imagelinks.com>
Message-ID: <9A235FE6-25A8-11D8-AAFF-003065D5F140@cmu.edu>


> On Dec 1, 2003, at 4:11 PM, Sean Fulton wrote:
>
>>> I am trying to compile GDAL on OSX with python support, but I get  
>>> the following errors on building:
>>> <SNIP>
>>> The only advice I have seen so far is to compile without python  
>>> support, but thats not really a solution. Python support is the only  
>>> reason I am looking to use GDAL.
>>>
>>> Thanks in advance,
>>
>> Chris,
>>
>> The python that comes with OS X isn't set-up the way it is on other  
>> OSs. There is no shared library (i.e. libpython.so or  
>> libpython.dylib), at least on 10.2, to which GDAL can link . I  
>> *think* 10.3 has python as a framework in which case you may be able  
>> to link against  
>> /Library/Frameworks/Python.framework/Versions/Current/Python by  
>> passing '-framework Python' to the linker. Or you could try creating  
>> a soft link from  /path/to/lib/libpython2.3.dylib to  
>> /Library/Frameworks/Python.framework/Versions/Current/Python.
>>
>> I think you can build python as a framework by hand if you're not on  
>> Panther. Searching python.org will probably be more useful than I  
>> have been. The GDAL developers probably don't have the time or  
>> resources to hunt down platform inconsistencies like this, so I'm  
>> sure they'd appreciate any help in resolving it.
>>
>> Good luck, and let us know if you get it working!
>>
>> 	Sean
>>
>> _______________________________________________
>> Gdal-dev mailing list
>> Gdal-dev@remotesensing.org
>> http://remotesensing.org/mailman/listinfo/gdal-dev
>>
>>
>
> I have used "-framework Python" as the python link arguments, and  
> based on the build output, I think it finds it:
>
>  g++ -Wall -O2 -I../port -I../port -I../gcore -I../ogr  
> -I/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3  
> -I/System/Library/Frameworks/Python.framework/Versions/2.3/include/ 
> python2.3 -c gdalnumeric.cpp -o gdalnumeric.o >/dev/null 2>&1
>

Those are the include files in that line. Listed twice for some  
unknown-to-me reason.  Something in the configure script is adding it  
twice but we shouldn't have to worry about that now.

> It still, however, gets the undefined symbols that I cited previously.  
> If it finds the framework, then the problem lies elsewhere, doesnt it?
>

I believe, if there are undefined symbols, it's not linking. I've just  
upgraded to Panther but I don't have the developer CD yet. I think I  
did get it to link properly once but now have problems with missing  
headers.

You might try building with ' make  
PYTHON_LIBS="-L/Library/Frameworks/Python.framework/Versions/Current/ 
Python" '

> Thanks again,
> Chris
>

Good luck. I'll give it a try once I get a Dev CD and see if we can't  
beat Panther into submission.

	Sean


From bfraser at geoanalytic.com  Wed Dec  3 11:13:04 2003
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Modis L1B and gdal_translate 1.1.9
References: <025401c3b92d$603811a0$020002c0@SHARK> <20031203083615.GB4925@ak4719.spb.edu>
Message-ID: <03e801c3b9b8$5533e050$020002c0@SHARK>

Andrey,

  Yes, it works, thanks!

FYI, The daily snapshot does not compile due to problems with OGR:

----------------------------------------------------------------------------
------------------
ogr_attrind.cpp
        cl /nologo /Zi
/Fd..\..\..\gdal.pdb -I..\..\..\port -I..\..\..\ogr -I..\..\..\gcore -I.. -I
..\..     -DODBC_ENABLED /c ogr_miattrind.cpp
ogr_miattrind.cpp
ogr_miattrind.cpp(620) : error C2259: 'OGRMILayerAttrIndex' : cannot
instantiate abstract class due to following members:
        ogr_miattrind.cpp(94) : see declaration of 'OGRMILayerAttrIndex'
ogr_miattrind.cpp(620) : warning C4259: 'int __thiscall
OGRLayerAttrIndex::AddToIndex(class OGRFeature *)' : pure virtual function
was not defined
        ..\ogr_attrind.h(94) : see declaration of 'AddToIndex'
ogr_miattrind.cpp(620) : error C2259: 'OGRMILayerAttrIndex' : cannot
instantiate abstract class due to following members:
        ogr_miattrind.cpp(94) : see declaration of 'OGRMILayerAttrIndex'
ogr_miattrind.cpp(620) : warning C4259: 'int __thiscall
OGRLayerAttrIndex::AddToIndex(class OGRFeature *)' : pure virtual function
was not defined
        ..\ogr_attrind.h(94) : see declaration of 'AddToIndex'
NMAKE : fatal error U1077: 'cl' : return code '0x2'
Stop.
NMAKE : fatal error U1077: 'for' : return code '0x1'
Stop.
----------------------------------------------------------------------------
------------------

And GDAL will not link without OGR (I commented out the OGR references in
contour.cpp to get it to link):


----------------------------------------------------------------------------
------------------
   Creating library gdal_i.lib and object gdal_i.exp
contour.obj : error LNK2001: unresolved external symbol _OGR_L_CreateFeature
contour.obj : error LNK2001: unresolved external symbol _OGR_L_GetLayerDefn
gdal11.dll : fatal error LNK1120: 2 unresolved externals
NMAKE : fatal error U1077: 'link' : return code '0x460'
Stop.
----------------------------------------------------------------------------
------------------

Brent

----- Original Message -----
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: "GDAL Dev" <gdal-dev@remotesensing.org>
Sent: Wednesday, December 03, 2003 1:36 AM
Subject: Re: [Gdal-dev] Modis L1B and gdal_translate 1.1.9


> >   I'm trying to get gdal_translate (v1.1.9) to convert a Modis image:
> >
ftp://g0dps01u.ecs.nasa.gov/MODIS_Terra_Radiances_Geolocation/MOD02QKM.004/2
003.12.02//MOD02QKM.A2003336.0720.004.2003336144538.hdf
> >
> > to a geotiff.  v1.1.9 crashes, but v1.1.8 successfully converts it
>
> Brent,
>
> Before I shall download and test your file could you try it with the
> latest dayly snapshot of the GDAL?
>
> --
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev


From mbp at geomtech.com  Wed Dec  3 15:47:36 2003
From: mbp at geomtech.com (Mark Phillips)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Employment Opportunity for GIS Programmer
Message-ID: <200312032047.hB3Klaw24006@intuition.geomtech.com>

Apologies in advance because this message is not directly related to
GDAL, but it may be of interest to some people who read this
list.

The National Climatic Data Center (NCDC), which is part of the US
National Oceanic and Atmospheric Administration (NOAA), has an opening
for a GIS programmer.  NCDC is the US national archive of weather
data; all government weather observations from around the US are
archived and made available to the public from here.

The job will involve working with ArcIMS.  They are committed to
sticking with ArcIMS, (this is their decision, not mine), but I can
say that there is at least one person in the building, namely me, who
is a big GDAL/MapServer proponent, so there would be at least some chance
to discuss and possibly use these tools.  There is some level of
underlying support and precedent within the organization for the use
of open source software (for example we use Linux servers).

The job is in Asheville NC, which is in the heart of the western NC
mountains, one of the most beautiful areas of the country.  If you
like outdoor activities like hiking, canoing, hunting, etc, and
aren't averse to working with ArcIMS, then consider coming to join the
small but growing collection of high tech software developers here in
Asheville.

The job announcement is in the paragraph below.  Feel free to contact
me [Mark Phillips <mbp@geomtech.com>] directly if you have questions
about the nature of NCDC in general, but note that the official
contact for the job is Rich Baldwin <Rich.Baldwin@noaa.gov>.

    The National Climatic Data Center is seeking to fill a contract
    position for GIS lead developer.  The position would be onsite
    here at the federal building in Asheville, NC through a contract
    company supporting NCDC.  We are looking for an individual with a
    strong background in ArcIMS and ArcSDE.  Java and/or JavaScript
    experience would be a consideration (though not required), and
    Unix and/or Linux experience is preferred.  The starting date
    would be as soon as possible, but is negotiable.

    If you are interested or know of someone who may be interested,
    please forward resumes to Rich.Baldwin@noaa.gov.

----

Mark Phillips @ Geometry Technologies LLC
77 Owenby Cove Road
Fairview, NC  28730
Phone: 828-628-0489
mbp@geomtech.com       http://www.geomtech.com

From TMitchell at lignum.com  Fri Dec  5 11:34:27 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] opening dataset of unknown type
Message-ID: <OFBA2272C4.9B2A9B5E-ON88256DF3.005ABB85-88256DF3.005B0B15@lignum.com>




I really like how you can program ogr to open a dataset without explicitly
laying out what type it is.  I assume it tries to open it with a list of
drivers until it succeeds, or fails altogether.  Is that right?

Can anyone tell me how you can identify which driver format was successful?
I'm specifically interested in how to do this in python.  I've got the
dataset open but don't know, programatically, what type it is.  I see
ogrinfo returns this information, but I'm not able to figure out how it
does it.

Tyler


From lorenzo.moretti at bologna.enea.it  Fri Dec  5 12:28:08 2003
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] HDF-EOS format is supported?
Message-ID: <a06002001bbf66e2e1b57@[192.107.62.86]>

I have many ASTER files. They are HDF-EOS format version 2.6. I have 
some software that read these file but I want to read from GDAL. GDAL 
is the library for many UNIX applications (MapServer, Grass, etc.). I 
have compiled gdal with HDF4 format but my format (HDF-EOS) is 
different from HDF4 standard, I think.
Is this format supported from GDAL?
How much different from HDF4 standard?

HDF-EOS files are used in research environment but now it's possible 
to work with them only from ERDAS, ENVI and other commercial software.

Thanks

-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot              Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________

From warmerdam at pobox.com  Fri Dec  5 13:24:15 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] opening dataset of unknown type
In-Reply-To: <OFBA2272C4.9B2A9B5E-ON88256DF3.005ABB85-88256DF3.005B0B15@lignum.com>
References: <OFBA2272C4.9B2A9B5E-ON88256DF3.005ABB85-88256DF3.005B0B15@lignum.com>
Message-ID: <3FD0CD4F.2030802@pobox.com>

Tyler Mitchell wrote:
> 
> 
> 
> I really like how you can program ogr to open a dataset without explicitly
> laying out what type it is.  I assume it tries to open it with a list of
> drivers until it succeeds, or fails altogether.  Is that right?

Tyler,

This is correct.

> Can anyone tell me how you can identify which driver format was successful?
> I'm specifically interested in how to do this in python.  I've got the
> dataset open but don't know, programatically, what type it is.  I see
> ogrinfo returns this information, but I'm not able to figure out how it
> does it.

The short answer, there is no way.

The longer answer is that I have committed changes in the gdal/pymod directory
so that the driver found in ogr.Open() can be captured somewhat like in C or
C++.  You can update from CVS to get this capability.  The new code allows you
to do the following to get the driver name for a dataset.

import ogr

x = ogr.Open( 'openev/polygon.shp' )

print x.GetDriver().GetName()


Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From dron at ak4719.spb.edu  Fri Dec  5 14:09:19 2003
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] HDF-EOS format is supported?
In-Reply-To: <a06002001bbf66e2e1b57@[192.107.62.86]>
References: <a06002001bbf66e2e1b57@[192.107.62.86]>
Message-ID: <20031205190919.GA16224@ak4719.spb.edu>

On Fri, Dec 05, 2003 at 06:28:08PM +0100, Lorenzo Moretti wrote:
> I have many ASTER files. They are HDF-EOS format version 2.6. I have
> some software that read these file but I want to read from GDAL. GDAL
> is the library for many UNIX applications (MapServer, Grass, etc.). I
> have compiled gdal with HDF4 format but my format (HDF-EOS) is
> different from HDF4 standard, I think. Is this format supported from
> GDAL?

Yes, it is supported. You need the NCSA HDF4 library and don't need
HDF-EOS to compile GDAL.

> How much different from HDF4 standard?

HDF-EOS implements the higher level of abstraction on top of plain HDF4,
but it is not used in GDAL to avoid unnecessary external depends. The
part of HDF-EOS functionality simply implemented in the HDF4 driver.

						Regards,
						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From sylvain_duclos at yahoo.com  Fri Dec  5 16:35:40 2003
From: sylvain_duclos at yahoo.com (s duclos)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] opening dataset of unknown type
In-Reply-To: <3FD0CD4F.2030802@pobox.com>
Message-ID: <20031205213540.34777.qmail@web12503.mail.yahoo.com>

Hi Frank & Tyler

Later on you will want to have the driver 
name at compile-time :)

I added this to ogrsf_frmts.h:

@@ -307,6 +228,19 @@
  * OGRSFDriverRegistrar.
  */
 
+// GetName() return one of those
+#define AVC_DRIVER_NAME "AVCBin"
+#define DGN_DRIVER_NAME "DGN"
+#define GML_DRIVER_NAME "GML"
+#define TAB_DRIVER_NAME "MapInfo File"
+#define NTF_DRIVER_NAME "UK .NTF"
+#define OGD_DRIVER_NAME "OGDI"
+#define SQL_DRIVER_NAME "PostgreSQL"
+#define S57_DRIVER_NAME "IHO S-57 (ENC)"
+#define STD_DRIVER_NAME "SDTS"
+#define SHP_DRIVER_NAME "ESRI Shapefile"
+#define TGR_DRIVER_NAME "TIGER"
+
 class CPL_DLL OGRSFDriver
 {
   public:


And in the corresponding GetName I replace
the string with the symbol.

For exemple in S57 in
gdal/ogr/ogrsf_frmts/s57/ogrs57driver.cpp

const char *OGRS57Driver::GetName()

{
    return S57_DRIVER_NAME;
}


So that when compiling from OpenEV you can
pull-in S57_DRIVER_NAME whitout having to
know what the string is.

I have to do the same trick as bellow in gvogr.c 
to get the drive name:

gv_data_set_property( psData, "_ogr_driver_name",
OGR_Dr_GetName(hDriver) );

Then during the layer settup I end up
comparing S57_DRIVER_NAME  to the value of
_ogr_driver_name.

Sorry for drifting a bit out of gdal .. :)

Cheers,

Sylvain.



--- Frank Warmerdam <warmerdam@pobox.com> wrote:
> Tyler Mitchell wrote:
> > 
> > 
> > 
> > I really like how you can program ogr to open a
> dataset without explicitly
> > laying out what type it is.  I assume it tries to
> open it with a list of
> > drivers until it succeeds, or fails altogether. 
> Is that right?
> 
> Tyler,
> 
> This is correct.
> 
> > Can anyone tell me how you can identify which
> driver format was successful?
> > I'm specifically interested in how to do this in
> python.  I've got the
> > dataset open but don't know, programatically, what
> type it is.  I see
> > ogrinfo returns this information, but I'm not able
> to figure out how it
> > does it.
> 
> The short answer, there is no way.
> 
> The longer answer is that I have committed changes
> in the gdal/pymod directory
> so that the driver found in ogr.Open() can be
> captured somewhat like in C or
> C++.  You can update from CVS to get this
> capability.  The new code allows you
> to do the following to get the driver name for a
> dataset.
> 
> import ogr
> 
> x = ogr.Open( 'openev/polygon.shp' )
> 
> print x.GetDriver().GetName()
> 
> 
> Best regards,
> 
> -- 
>
---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank
> Warmerdam, warmerdam@pobox.com
> light and sound - activate the windows |
> http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial
> Programmer for Rent
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev


__________________________________
Do you Yahoo!?
Free Pop-Up Blocker - Get it now
http://companion.yahoo.com/

From TMitchell at lignum.com  Fri Dec  5 16:37:13 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] opening dataset of unknown type
In-Reply-To: <3FD0CD4F.2030802@pobox.com>
Message-ID: <OF89BD9695.02078434-ON88256DF3.00768F4E-88256DF3.0076C314@lignum.com>





> The short answer, there is no way.
>
> The longer answer is that I have committed changes in the
gdal/pymoddirectory
> so that the driver found in ogr.Open() can be captured somewhat like in C
or
> C++.

Great Frank!  Thank you very much for implementing it.  I'm trying it on
windows, but appears that I need a new _gdal.dll I guess.  Do I need one
built from current CVS?   I'll try to pull one together via Cygwin.

Tyler


From cgn at globexplorer.com  Sat Dec  6 00:42:25 2003
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] build problemos...
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328014729BA@loki.wc.globexplorer.net>

Hmmm - getting a build error on the CVS version..

??

thx/Chris

----------------------------------------------------------



  g++ -I../../../port -I.. -I../.. -Wall -O2 -DPG_ENABLED -c ogr_miattrind.cpp  -fPIC -DPIC -o ../o/.libs/ogr_miattrind.o
ogr_miattrind.cpp: In function `OGRLayerAttrIndex*
   OGRCreateDefaultLayerIndex()':
ogr_miattrind.cpp:620: cannot allocate an object of type `OGRMILayerAttrIndex'
ogr_miattrind.cpp:620:   because the following virtual functions are abstract:
../ogr_attrind.h:94:    virtual OGRErr OGRLayerAttrIndex::AddToIndex(OGRFeature*)


From warmerdam at pobox.com  Fri Dec  5 16:58:21 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] opening dataset of unknown type
In-Reply-To: <OF89BD9695.02078434-ON88256DF3.00768F4E-88256DF3.0076C314@lignum.com>
References: <OF89BD9695.02078434-ON88256DF3.00768F4E-88256DF3.0076C314@lignum.com>
Message-ID: <3FD0FF7D.1050308@pobox.com>

Tyler Mitchell wrote:
> 
> 
> 
> 
>>The short answer, there is no way.
>>
>>The longer answer is that I have committed changes in the
> 
> gdal/pymoddirectory
> 
>>so that the driver found in ogr.Open() can be captured somewhat like in C
> 
> or
> 
>>C++.
> 
> 
> Great Frank!  Thank you very much for implementing it.  I'm trying it on
> windows, but appears that I need a new _gdal.dll I guess.  Do I need one
> built from current CVS?   I'll try to pull one together via Cygwin.

Tyler,

Right, you need to rebuild _gdal.dll from CVS.

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From gdal-dev-admin at remotesensing.org  Mon Dec  8 10:57:24 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Lat/Long -> UTM conversion formulas
Message-ID: <PBEPKNAFMBCIOBJCNAJCAEBHCBAA.dmcaferty@seeop.net>

Hopefully this is the right mail list to post this to.
If not, please direct me accordingly

I am looking for the math formulas to convert from
standard Lat/long coordinates to UTM.

Thanks,
Dan

_______________________
Daniel V. McAferty
Thorpe Seeop corp.



From gdal-dev-admin at remotesensing.org  Mon Dec  8 11:21:48 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Lat/Long -> UTM conversion formulas
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C0726@mercator.topozone.com>

Dan -

A Google search for "convert latitude longitude UTM" will list

http://www.gpsy.com/gpsinfo/geotoutm/

at the top of the list, and that's good place to start.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: gdal-dev-admin@remotesensing.org
[mailto:gdal-dev-admin@remotesensing.org]
Sent: Monday, December 08, 2003 10:57 AM
To: gdal-dev
Subject: [Gdal-dev] Lat/Long -> UTM conversion formulas


Hopefully this is the right mail list to post this to.
If not, please direct me accordingly

I am looking for the math formulas to convert from
standard Lat/long coordinates to UTM.

Thanks,
Dan

_______________________
Daniel V. McAferty
Thorpe Seeop corp.


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From gdal-dev-admin at remotesensing.org  Mon Dec  8 13:20:14 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR/Shapefile crash
Message-ID: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com>

I sent this to Frank directly, then decided to subscribe and post to
this list instead.  Sorry for the duplicate to you Frank.  I added a
bit more info in this one though.

---------- Forwarded message ----------

I remember a while back having segfaults with Shapelib when trying
to open a dataset that was corrupted.  I think that one had too few
vectors to go with the dbf file.  I had no way around the segfaults,
which would crash Xastir, other than deleting the corrupted files.
Also got segfaults if I tried to access a field index that was
higher than available.

Question #1, Shapelib:
----------------------
Is there any way to have the Shapefile library incorporate simple
checks so that segfaults are avoided and error codes are returned
instead?


Question #2, OGR:
-----------------
> As I try to get OGR integrated into Xastir, I'm getting segfaults
> any time I try to open a Shapefile dataset that includes a .prj
> file.  Is it something I'm doing, or perhaps the PROJ.4 installation
> on my system?

> Note:  Using Xastir with Shapelib, I can open these files.  Using
> OGR, I can open them.  Once I add the .prj file into the mix,
> Xastir/OGR segfaults, Xastir/Shapelib can read them just fine.

> Datum translations using libgeotiff are working fine in Xastir.
> Datum translations using OGR appear to be working for TIGER/Line
> files.  We're just having this segfault problem with Shapefile .prj
> files (so far).  Segfaults are bad for us.  Ours is a long-running
> program, and we'd like a way around segfaults in all cases.

Never mind on this one!  On one system with older? GDAL/OGR, it
segfaulted.  On another system, with CVS GDAL/OGR, it opened it just
fine with both methods, with a .prj file present.  I'll update the
other system and things will hopefully be fine there.


Question #3, OGR:
-----------------
The available docs for datum translation using OGR are mostly in
C++.  The text mentions that the Transform() method returns
OGRERR_NONE on success.  In 'C', I'm getting a '1' returned, but the
operation appears to succeed otherwise.  Your short 'C' example
seems to show that '1' is the proper return code as well.  Thoughts?
Am I doing that one right?

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From gdal-dev-admin at remotesensing.org  Sat Dec  6 00:31:19 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] HELLO!
Message-ID: <20031206053119.16484.qmail@sina.com>

I Want to Display the Geotiff Image using Gdal.

I must use GDALRasterBand::RasterIO,then transition  then buffer to DIB buffer,then invoke Windows API---BitBlt to display it.I think so,but I don't know how to do.I want the samples.
   Can you help me?
   Thanks!  
______________________________________

===================================================================

From gdal-dev-admin at remotesensing.org  Sat Dec  6 00:32:52 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] HELLO!
Message-ID: <20031206053252.15310.qmail@sina.com>

    I Want to Display the Geotiff Image using Gdal.
    I must use GDALRasterBand::RasterIO,then transition  the buffer to DIB buffer,then invoke Windows API---BitBlt to display it.I think so,but I don't know how to do.I want the samples.
    Can you help me?
    Thanks!  

                                         yours
______________________________________

===================================================================

From gdal-dev-admin at remotesensing.org  Mon Dec  8 14:30:53 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR/Shapefile crash
In-Reply-To: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com>
References: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com>
Message-ID: <3FD4D16D.2020703@pobox.com>

gdal-dev-admin@remotesensing.org wrote:
> I sent this to Frank directly, then decided to subscribe and post to
> this list instead.  Sorry for the duplicate to you Frank.  I added a
> bit more info in this one though.
> 
> ---------- Forwarded message ----------
> 
> I remember a while back having segfaults with Shapelib when trying
> to open a dataset that was corrupted.  I think that one had too few
> vectors to go with the dbf file.  I had no way around the segfaults,
> which would crash Xastir, other than deleting the corrupted files.
> Also got segfaults if I tried to access a field index that was
> higher than available.
> 
> Question #1, Shapelib:
> ----------------------
> Is there any way to have the Shapefile library incorporate simple
> checks so that segfaults are avoided and error codes are returned
> instead?

Curt,

Is not my intention that shapelib would crash when in response to
normal sorts of invalid arguments.  If you can detail the situation
and submit it via the Shapelib Bugzilla (http://shapelib.maptools.org)
I will look into improving things for the next release.

> Question #2, OGR:
> -----------------
> 
>>As I try to get OGR integrated into Xastir, I'm getting segfaults
>>any time I try to open a Shapefile dataset that includes a .prj
>>file.  Is it something I'm doing, or perhaps the PROJ.4 installation
>>on my system?
> 
> 
>>Note:  Using Xastir with Shapelib, I can open these files.  Using
>>OGR, I can open them.  Once I add the .prj file into the mix,
>>Xastir/OGR segfaults, Xastir/Shapelib can read them just fine.
 >
>>Datum translations using libgeotiff are working fine in Xastir.
>>Datum translations using OGR appear to be working for TIGER/Line
>>files.  We're just having this segfault problem with Shapefile .prj
>>files (so far).  Segfaults are bad for us.  Ours is a long-running
>>program, and we'd like a way around segfaults in all cases.
> 
> 
> Never mind on this one!  On one system with older? GDAL/OGR, it
> segfaulted.  On another system, with CVS GDAL/OGR, it opened it just
> fine with both methods, with a .prj file present.  I'll update the
> other system and things will hopefully be fine there.

Ahh, good.

> Question #3, OGR:
> -----------------
> The available docs for datum translation using OGR are mostly in
> C++.  The text mentions that the Transform() method returns
> OGRERR_NONE on success.  In 'C', I'm getting a '1' returned, but the
> operation appears to succeed otherwise.  Your short 'C' example
> seems to show that '1' is the proper return code as well.  Thoughts?
> Am I doing that one right?

The OGR Projections tutorial was wrong on this point.  The Transform()
method returns TRUE (non-zero) on success or FALSE (zero) on failure.
I will correct the OGR Projection Tutorial.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From gdal-dev-admin at remotesensing.org  Tue Dec  9 09:41:20 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Link error on Win2K
Message-ID: <5.1.0.14.0.20031209101733.0460ee48@caris0.caris.priv>

Hi all,

I am getting an unresolved external after building the cvs verison.
cvs update from minutes ago on Win2K using VC6.
No errors until final link.

         cd ..
         if exist gdal.lib del gdal.lib
         lib /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj 
ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib
Microsoft (R) Library Manager Version 6.00.8447
Copyright (C) Microsoft Corp 1992-1998. All rights reserved.

         link /dll /debug 
/INCLUDE:_OCTNewCoordinateTransformation  /INCLUDE:_OGRRegisterAll  /INCLUD
E:_OGRFeatureStylePuller  /INCLUDE:_OSRValidate 
/INCLUDE:_OPTGetProjectionMethods  /INCLUDE:_OGR_G_
GetPointCount 
/INCLUDE:_GDALSimpleImageWarp  /INCLUDE:_GDALSuggestedWarpOutput 
/INCLUDE:_GDALGCPTra
nsform  /INCLUDE:_GDALComputeMedianCutPCT  /INCLUDE:_GDALDitherRGB2PCT 
port\*.obj gcore\*.obj alg\*.
obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib 
ogr\ogr.lib   D:\third_party\lib/xerces-c220.lib
  odbc32.lib  D:\third_party\ECWSdk\lib\NCSEcw.lib 
D:\third_party\ECWSdk\lib\NCSEcwC.lib  D:\third_pa
rty\ECWSdk\lib\NCSUtil.lib       D:\third_party\lib/libjpeg6s.lib 
D:\third_party\lib/libpng125s.lib
  /out:gdal11.dll /implib:gdal_i.lib
Microsoft (R) Incremental Linker Version 6.00.8447
Copyright (C) Microsoft Corp 1992-1998. All rights reserved.

    Creating library gdal_i.lib and object gdal_i.exp
ogrsf_frmts.lib(ogrregisterall.obj) : error LNK2001: unresolved external 
symbol _RegisterOGRVRT
gdal11.dll : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: 'link' : return code '0x460'
Stop.

ogr\ogrsf_frmts\vrt\ogrvrtdriver.cpp gets compiled (no errors) and gets 
added to ogrsf_frmts.lib.

Any ideas?

Todd


From gdal-dev-admin at remotesensing.org  Tue Dec  9 12:30:12 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR: C API for Polygon/Multipolygon?
Message-ID: <Pine.LNX.4.53.0312090921060.7899@wapiti.tc.fluke.com>

I'm attempting to use a 'C' interface to OGR.  I have points and
polylines getting drawn on my map, but don't see how to easily do a
'C' interface to the polygon functions.

I have a parallel working implementation using Shapelib alone, so
I've done this before, including the CW/CCW ring stuff (fill/hole
polygons).  I need to do the same thing now in OGR so I can switch
to it and gain the advantages of the OGR library.

Anyone have a reference implementation in 'C' that shows how to
access the elements in polygons/multipolygons for reading?

I see "OGRLinearRing", "getExteriorRing", and "getInteriorRing", but
those appear to be C++ objects/methods.  I see no 'C' interface for
them.  Accurate?  Do I need to get into the wkt/wkb calls in order
to do it?

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From gdal-dev-admin at remotesensing.org  Tue Dec  9 13:19:56 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] A questions about IRasterIO and overlays
In-Reply-To: <1070313712.2887.91.camel@comet.dods.org>
References: <1070313712.2887.91.camel@comet.dods.org>
Message-ID: <3FD6124C.5080808@pobox.com>

James Gallagher wrote:
> I'm improving a GDAL driver for the DODS/OPeNDAP protocol. The driver
> can read rasters from DODS/OPeNDAP servers. One problem with the current
> implementation is that it always reads the entire raster. 
> 
> Before I dive into IRasterIO() I'd like to make sure providing my own
> implementation of that method is really the best way to go. OPeNDAP
> provides ways to read parts of rasters using the indexes combined with
> an optional 'stride' value (which allows for sub-sampling).
> 
> I was also wondering about overlays and the comment that a driver that
> provides its own implementation of IRasterIO() would normally implement
> overlays. What exactly are 'overlays?'
> 
> As you can probably tell, I'm not that familiar with GIS software so my
> apologies if these are really basic questions.

James,

I'm not sure where you read overlays.  I suspect you are referring to
overviews, is that correct?  An overview is a reduced resolution image used
for faster reads when only a reduced resolution image is needed.

You can use stride values to simulate overviews.  So, I think it would
be wise to return synthetic power of 2 overiews for your dataset.  You might
want to skim the MrSID example for how this can be done.

However, the deeper problem is how to handle IO requests. Right now I gather
you read the whole remote dataset on open, and pull it into local memory?
For modest sized datasets that are read by applications a bit at a time this
is a very good approach.  I would presume there is a non-trivial overhead
(network latency, etc) to each OPeNDAP request?

If network latency and other request overhead was zero,the idea approach would
be to satisfy each IRasterIO() request with an OPeNDAP request.  This would
minimize the amount of memory used in the driver, and ensure only required
data would be read.  However, there is latency, and for some sorts of requests,
such as the common case of the application asking for the entire dataset, but
one scanline at a time, the latency would likely kill you.

On the other hand if you are working with a big dataset, and a client like
MapServer that might only want a small area or want the dataset at a much
reduced resolution, then reading the whole thing will kill you.

What I have done in some drivers is have two basic cases:

  1) Attempt to satisfy each RasterIO() request via a lower level request.

  2) Treat the dataset as "scanlined organized" for blocksize/caching
     purposes, but read-ahead lots of scanlines in response to any request
     that isn't satisfied out of the cache.  Implement this logic in the
     IReadBlock() method.

then I basically check the nature of the request in the RasterIO() to
decide how to handle it.  If the request is fairly large then I stick
with case (1) otherwise I call the GDALRasterBand::IRasterIO() which will
eventually call IReadBlock() taking care of any required resampling.

I hope this helps, though I am proposing some complications. :-)

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From gdal-dev-admin at remotesensing.org  Tue Dec  9 13:51:17 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] A questions about IRasterIO and overlays
Message-ID: <71E37EF6B7DCC1499CEA0316A2568328014729F2@loki.wc.globexplorer.net>

Hmmm - remote subsetting is kinda what the OpenGIS web coverage server spec, http://www.opengis.org/docs/03-065r6.pdf, and the JPEG2000 JPIP protocol, http://www.kakadusoftware.com/jpip-links-and-info.html, are all about...

It would be awesome if someone were psyched to implement one of these items as a GDAL driver!

Chris

-----Original Message-----
From:	gdal-dev-admin@remotesensing.org [mailto:gdal-dev-admin@remotesensing.org]
Sent:	Tue 12/9/2003 10:19 AM
To:	gdal-dev@remotesensing.org
Cc:	
Subject:	Re: [Gdal-dev] A questions about IRasterIO and overlays
James Gallagher wrote:
> I'm improving a GDAL driver for the DODS/OPeNDAP protocol. The driver
> can read rasters from DODS/OPeNDAP servers. One problem with the current
> implementation is that it always reads the entire raster. 
> Before I dive into IRasterIO() I'd like to make sure providing my own
> implementation of that method is really the best way to go. OPeNDAP
> provides ways to read parts of rasters using the indexes combined with
> an optional 'stride' value (which allows for sub-sampling).
> 
> I was also wondering about overlays and the comment that a driver that
> provides its own implementation of IRasterIO() would normally implement
> overlays. What exactly are 'overlays?'
> 
> As you can probably tell, I'm not that familiar with GIS software so my
> apologies if these are really basic questions.

James,

I'm not sure where you read overlays.  I suspect you are referring to
overviews, is that correct?  An overview is a reduced resolution image used
for faster reads when only a reduced resolution image is needed.

You can use stride values to simulate overviews.  So, I think it would
be wise to return synthetic power of 2 overiews for your dataset.  You might
want to skim the MrSID example for how this can be done.

However, the deeper problem is how to handle IO requests. Right now I gather
you read the whole remote dataset on open, and pull it into local memory?
For modest sized datasets that are read by applications a bit at a time this
is a very good approach.  I would presume there is a non-trivial overhead
(network latency, etc) to each OPeNDAP request?

If network latency and other request overhead was zero,the idea approach would
be to satisfy each IRasterIO() request with an OPeNDAP request.  This would
minimize the amount of memory used in the driver, and ensure only required
data would be read.  However, there is latency, and for some sorts of requests,
such as the common case of the application asking for the entire dataset, but
one scanline at a time, the latency would likely kill you.

On the other hand if you are working with a big dataset, and a client like
MapServer that might only want a small area or want the dataset at a much
reduced resolution, then reading the whole thing will kill you.

What I have done in some drivers is have two basic cases:

  1) Attempt to satisfy each RasterIO() request via a lower level request.

  2) Treat the dataset as "scanlined organized" for blocksize/caching
     purposes, but read-ahead lots of scanlines in response to any request
     that isn't satisfied out of the cache.  Implement this logic in the
     IReadBlock() method.

then I basically check the nature of the request in the RasterIO() to
decide how to handle it.  If the request is fairly large then I stick
with case (1) otherwise I call the GDALRasterBand::IRasterIO() which will
eventually call IReadBlock() taking care of any required resampling.

I hope this helps, though I am proposing some complications. :-)

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev





From gdal-dev-admin at remotesensing.org  Tue Dec  9 14:50:50 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] A questions about IRasterIO and overlays
In-Reply-To: <71E37EF6B7DCC1499CEA0316A2568328014729F2@loki.wc.globexplorer.net>
References: <71E37EF6B7DCC1499CEA0316A2568328014729F2@loki.wc.globexplorer.net>
Message-ID: <3FD6279A.60207@pobox.com>

gdal-dev-admin@remotesensing.org wrote:
> Hmmm - remote subsetting is kinda what the OpenGIS web coverage server spec, http://www.opengis.org/docs/03-065r6.pdf, and the JPEG2000 JPIP protocol, http://www.kakadusoftware.com/jpip-links-and-info.html, are all about...
> 
> It would be awesome if someone were psyched to implement one of these items as a GDAL driver!

Chris,

It is my hope to at some point build WMS and WCS client support right
within GDAL at which point I will face similar issues to what James is
running into with OPeNDAP.  I would likely take the approach I outlined.

I would add that I made a first crack at being able to use JPIP in the
JP2KAK driver.  There, I used the same IO strategies used with local files
and I think this resulted in pretty terrible performance in some cases.
But I also found the whole JPIP access very flakey.  I presume this was
due to a poor implementation on my part, but I never had any client requesting
JPIP support, so I let it drop.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From gdal-dev-admin at remotesensing.org  Tue Dec  9 14:56:30 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR: C API for Polygon/Multipolygon?
In-Reply-To: <Pine.LNX.4.53.0312090921060.7899@wapiti.tc.fluke.com>
References: <Pine.LNX.4.53.0312090921060.7899@wapiti.tc.fluke.com>
Message-ID: <3FD628EE.90202@pobox.com>

gdal-dev-admin@remotesensing.org wrote:
> I'm attempting to use a 'C' interface to OGR.  I have points and
> polylines getting drawn on my map, but don't see how to easily do a
> 'C' interface to the polygon functions.
> 
> I have a parallel working implementation using Shapelib alone, so
> I've done this before, including the CW/CCW ring stuff (fill/hole
> polygons).  I need to do the same thing now in OGR so I can switch
> to it and gain the advantages of the OGR library.
> 
> Anyone have a reference implementation in 'C' that shows how to
> access the elements in polygons/multipolygons for reading?
> 
> I see "OGRLinearRing", "getExteriorRing", and "getInteriorRing", but
> those appear to be C++ objects/methods.  I see no 'C' interface for
> them.  Accurate?  Do I need to get into the wkt/wkb calls in order
> to do it?

Curt,

For reasons that seemed good at the time, I did not make some of the C
geometry functions mirror the C++ that closely.  To access the rings of
polygons you use OGR_G_GetGeometryRef().  To find out how many rings there
are use OGR_G_GetGeometryCount().  This essentially treats polygons as a
contain of rings.  You then fetch the points from the rings the same way
you would with a linestring.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From gdal-dev-admin at remotesensing.org  Tue Dec  9 15:33:17 2003
From: gdal-dev-admin at remotesensing.org (gdal-dev-admin@remotesensing.org)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR: C API for Polygon/Multipolygon?
In-Reply-To: <3FD628EE.90202@pobox.com>
References: <Pine.LNX.4.53.0312090921060.7899@wapiti.tc.fluke.com>
 <3FD628EE.90202@pobox.com>
Message-ID: <Pine.LNX.4.53.0312091227300.7899@wapiti.tc.fluke.com>

On Tue, 9 Dec 2003 gdal-dev-admin@remotesensing.org wrote:

> For reasons that seemed good at the time, I did not make some of the C
> geometry functions mirror the C++ that closely.  To access the rings of
> polygons you use OGR_G_GetGeometryRef().  To find out how many rings there
> are use OGR_G_GetGeometryCount().  This essentially treats polygons as a
> contain of rings.  You then fetch the points from the rings the same way
> you would with a linestring.

Thank you!  I have polygons getting drawn now.  Was pulling my hair
out trying to decide whether I needed to implement some C wrappers
for some C++ functions myself.

Here are the types that I have in my code:

  case 1:             // Point
  case 4:             // MultiPoint
  case 0x80000001:    // Point25D
  case 0x80000004:    // MultiPoint25D
  case 2:             // LineString (polyline)
  case 5:             // MultiLineString
  case 0x80000002:    // LineString25D
  case 0x80000005:    // MultiLineString25D
  case 3:             // Polygon
  case 6:             // MultiPolygon
  case 0x80000003:    // Polygon25D
  case 0x80000006:    // MultiPolygon25D
  case 7:             // GeometryCollection
  case 0x80000007:    // GeometryCollection25D

Should I assume that for ALL of the more complicated types I just
need to check how many Geometries there are via
OGR_G_GetGeometryCount() and then iterate through each of these
subgeometries, treating them as the simpler types?

If so, that will be fairly easy to implement.  The two I'm most
interested in now are MultiPoint and MultiPolygon.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Tue Dec  9 16:58:25 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR: C API for Polygon/Multipolygon?
In-Reply-To: <Pine.LNX.4.53.0312091227300.7899@wapiti.tc.fluke.com>
References: <Pine.LNX.4.53.0312090921060.7899@wapiti.tc.fluke.com> <3FD628EE.90202@pobox.com> <Pine.LNX.4.53.0312091227300.7899@wapiti.tc.fluke.com>
Message-ID: <3FD64581.6000101@pobox.com>

gdal-dev-admin@remotesensing.org wrote:
> On Tue, 9 Dec 2003 gdal-dev-admin@remotesensing.org wrote:
> 
> 
>>For reasons that seemed good at the time, I did not make some of the C
>>geometry functions mirror the C++ that closely.  To access the rings of
>>polygons you use OGR_G_GetGeometryRef().  To find out how many rings there
>>are use OGR_G_GetGeometryCount().  This essentially treats polygons as a
>>contain of rings.  You then fetch the points from the rings the same way
>>you would with a linestring.
> 
> 
> Thank you!  I have polygons getting drawn now.  Was pulling my hair
> out trying to decide whether I needed to implement some C wrappers
> for some C++ functions myself.
> 
> Here are the types that I have in my code:
> 
>   case 1:             // Point
>   case 4:             // MultiPoint
>   case 0x80000001:    // Point25D
>   case 0x80000004:    // MultiPoint25D
>   case 2:             // LineString (polyline)
>   case 5:             // MultiLineString
>   case 0x80000002:    // LineString25D
>   case 0x80000005:    // MultiLineString25D
>   case 3:             // Polygon
>   case 6:             // MultiPolygon
>   case 0x80000003:    // Polygon25D
>   case 0x80000006:    // MultiPolygon25D
>   case 7:             // GeometryCollection
>   case 0x80000007:    // GeometryCollection25D
> 
> Should I assume that for ALL of the more complicated types I just
> need to check how many Geometries there are via
> OGR_G_GetGeometryCount() and then iterate through each of these
> subgeometries, treating them as the simpler types?

Curt,

Yes. Everything but Point, Point25D, LineString, and LineString25D
are treated as if there were collections from the C API point of
view.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From matt.wilkie at gov.yk.ca  Tue Dec  9 19:57:10 2003
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] arcinfo grid gotcha
Message-ID: <3FD66F66.8010202@gov.yk.ca>

Hi all,

Stumbled across a "gotcha" this afternoon when using the Windows gdal 
utilities v1.1.8 (from openev_fw distribution) and ArcInfo binary grids
(v1.1.9 info at end):

* If you type a trailing slash, the internal AIG grid driver is used.
* If you omit the slash, the external GIO driver is used.
* Because the two drivers have different abilities, the output may not 
be what you expect. In particular the number format (byte, int32, etc) 
and projections are different (or absent).
* It doesn't seem to matter which slash is used (\ or /).

 > gdal_translate arcinfo_grid/ aig.tif
 > gdalinfo aig.tif

Driver: GTiff/GeoTIFF
Size is 6927, 6799
Coordinate System is:
PROJCS["unnamed",
     GEOGCS["NAD83",
         DATUM["North_American_Datum_1983",
             SPHEROID["GRS 1980",6378137,298.2572221010002,
                 AUTHORITY["EPSG","7019"]],
             AUTHORITY["EPSG","6269"]],
         PRIMEM["Greenwich",0],
         UNIT["degree",0.0174532925199433],
         AUTHORITY["EPSG","4269"]],
     PROJECTION["Albers_Conic_Equal_Area"],
     PARAMETER["standard_parallel_1",61.66666666666666],
     PARAMETER["standard_parallel_2",68],
     PARAMETER["latitude_of_center",59],
     PARAMETER["longitude_of_center",-132.5],
     PARAMETER["false_easting",500000],
     PARAMETER["false_northing",500000],
     UNIT["metre",1,
         AUTHORITY["EPSG","9001"]]]
Origin = (183318.249099,624474.799031)
Pixel Size = (17.490628,-17.490628)
Corner Coordinates:
Upper Left  (  183318.249,  624474.799) (138d10'18.18"W, 59d59'32.80"N)
Lower Left  (  183318.249,  505556.021) (137d59'16.23"W, 58d55'35.54"N)
Upper Right (  304475.828,  624474.799) (136d 0'27.34"W, 60d 4'16.47"N)
Lower Right (  304475.828,  505556.021) (135d53'36.67"W, 59d 0'10.44"N)
Center      (  243897.038,  565015.410) (137d 0'54.78"W, 59d30'11.08"N)
Band 1 Block=6927x1 Type=Byte, ColorInterp=Gray
   NoData Value=255


 > gdal_translate arcinfo_grid gio.tif
 > gdalinfo gio.tif

Driver: GTiff/GeoTIFF
Size is 6927, 6799
Coordinate System is `'
Origin = (183318.249099,624474.799031)
Pixel Size = (17.490628,-17.490628)
Corner Coordinates:
Upper Left  (  183318.249,  624474.799)
Lower Left  (  183318.249,  505556.021)
Upper Right (  304475.828,  624474.799)
Lower Right (  304475.828,  505556.021)
Center      (  243897.038,  565015.410)
Band 1 Block=6927x1 Type=Int32, ColorInterp=Gray
   NoData Value=-2.14748e+009


With gdal 1.1.9 compiled under cygwin only the GIO driver is used, with 
or without a trailing slash. This is undesirable because the AIG driver 
is superior, at least with the data we use. (Presumably one could 
compile v119 without GIO). Is there a mechanism to force which driver is 
used to read the source data set?


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------




From nhv at cape.com  Wed Dec 10 01:08:50 2003
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] arcinfo grid gotcha
In-Reply-To: <3FD66F66.8010202@gov.yk.ca>
Message-ID: <EKEJIKAILPONGGENMBGAKEJBFLAA.nhv@cape.com>

Matt Wilkie writes:
>
> Stumbled across a "gotcha" this afternoon when using the Windows gdal 
> utilities v1.1.8 (from openev_fw distribution) and ArcInfo binary grids
> (v1.1.9 info at end):
> 
> * If you type a trailing slash, the internal AIG grid driver is used.
> * If you omit the slash, the external GIO driver is used.
> * Because the two drivers have different abilities, the output may not 
> be what you expect. In particular the number format (byte, int32, etc) 
> and projections are different (or absent).
> * It doesn't seem to matter which slash is used (\ or /).
 
< snip >
 
> With gdal 1.1.9 compiled under cygwin only the GIO driver is used, with 
> or without a trailing slash. This is undesirable because the AIG driver 
> is superior, at least with the data we use. (Presumably one could 
> compile v119 without GIO). Is there a mechanism to force which driver is 
> used to read the source data set?

Hi Matt

Try adding the ArcInfo bin directory to your path or copy 
  avbase.dll
  avfeat.dll
  avgridio.dll
from the arcinfo bin directory into a directory on your path

This works for me with MingW,  there could be a 'path' issue
using Cygwin so make sure you reference directories by there
common name ie.  D:/dir1/dir2  instead of the Unix name

HTH

Norman



From warmerdam at pobox.com  Wed Dec 10 09:06:59 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] arcinfo grid gotcha
In-Reply-To: <3FD66F66.8010202@gov.yk.ca>
References: <3FD66F66.8010202@gov.yk.ca>
Message-ID: <3FD72883.4050006@pobox.com>

Matt Wilkie wrote:
> With gdal 1.1.9 compiled under cygwin only the GIO driver is used, with 
> or without a trailing slash. This is undesirable because the AIG driver 
> is superior, at least with the data we use. (Presumably one could 
> compile v119 without GIO). Is there a mechanism to force which driver is 
> used to read the source data set?

Matt,

 From within a program you can use GDALDriverManager::DeregisterDriver()
to remove the GIO driver.

Users can set the GDAL_SKIP environment variable with a list of space
seperated driver names that they wish to not be used.

eg.

set GDAL_SKIP="GIO"
gdalinfo mygrid

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From nfarah at hotmail.com  Wed Dec 10 11:17:33 2003
From: nfarah at hotmail.com (N. Farah)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] SAR_CEOS: possible memory leak ?
Message-ID: <BAY8-F53Fur2iz2Mb1s0000b688@hotmail.com>

Hi,

While reading a SARA_CEOS image the process went fine, but a memory dump 
occurred in my debug session.
To try to isolate the problem, I tried to, only, open the image then close 
it, the same behavior occurs. This suggests that a possible memory leak 
might be in the Open(...) method.

I was using the "ottawa_patch.img" dataset from the remotesensing.org ftp 
site.

Noureddine Farah

_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*.  
http://join.msn.com/?page=features/virus&pgmarket=en-ca&RU=http%3a%2f%2fjoin.msn.com%2f%3fpage%3dmisc%2fspecialoffers%26pgmarket%3den-ca


From mathieu_gdal at yahoo.fr  Wed Dec 10 10:11:42 2003
From: mathieu_gdal at yahoo.fr (mathieu_gdal)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] using a feature to store a "Track"
In-Reply-To: <EKEJIKAILPONGGENMBGAKEJBFLAA.nhv@cape.com>
Message-ID: <000001c3bf2f$f31343c0$3b00000a@informatiquemer.fr>

Dear All,

I have a very basic question, I would like to know if my approach is
good or not at all.

I have a list of points, called "a track". Each point is defined by :
- a position (in lat,lon,WGS84)
- an altitude
- a heading (it is an example)

I would like to use the class OGRFeature to store this "Track".
The Track's Geometry (lat, lon, and altitude) is very well managed in
the OGRFeature (OGRFeature::poGeometry)
But how to store the other attributes, such as heading?

My idea is to store the heading in a feature's special attribute, as a
list of double. 
This size of this list would be the same as the geometry size.
To retrieve a specific point, I will have to retrieve its position with
the geometry, and the heading with the "double list" attribute.
It might be costly if I want to store many other parameters for each
point. 

Do you think it is a good approach?
Is there alternatives?

Thanks,
Mathieu



From hacker at tc.fluke.com  Wed Dec 10 12:07:04 2003
From: hacker at tc.fluke.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR/Shapefile crash
In-Reply-To: <3FD4D16D.2020703@pobox.com>
References: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com>
 <3FD4D16D.2020703@pobox.com>
Message-ID: <Pine.LNX.4.53.0312100851350.28330@wapiti.tc.fluke.com>

On Mon, 8 Dec 2003 gdal-dev-admin@remotesensing.org wrote:

> > Question #2, OGR:
> > -----------------
> >
> >>As I try to get OGR integrated into Xastir, I'm getting segfaults
> >>any time I try to open a Shapefile dataset that includes a .prj
> >>file.  Is it something I'm doing, or perhaps the PROJ.4 installation
> >>on my system?
> >
> >
> >>Note:  Using Xastir with Shapelib, I can open these files.  Using
> >>OGR, I can open them.  Once I add the .prj file into the mix,
> >>Xastir/OGR segfaults, Xastir/Shapelib can read them just fine.
>  >
> >>Datum translations using libgeotiff are working fine in Xastir.
> >>Datum translations using OGR appear to be working for TIGER/Line
> >>files.  We're just having this segfault problem with Shapefile .prj
> >>files (so far).  Segfaults are bad for us.  Ours is a long-running
> >>program, and we'd like a way around segfaults in all cases.
> >
> >
> > Never mind on this one!  On one system with older? GDAL/OGR, it
> > segfaulted.  On another system, with CVS GDAL/OGR, it opened it just
> > fine with both methods, with a .prj file present.  I'll update the
> > other system and things will hopefully be fine there.

That system is using CVS GDAL, proj-4.4.7, and
proj-nad27-1.1.tar.gz.  It still segfaults on this statement if a
".prj" file is present with a Shapefile:


  datasource = OGROpen(full_filename, 0 /* bUpdate */, &driver);


It doesn't segfault if the .prj file is absent, but of course then
it can't get any spatial info from the file.

The system which segfaults has had various versions of proj and
libgeotiff installed at various times.  It has an older libtiff,
therefore is running libgeotiff 1.1.4 or 1.1.5 to match.
Libgeotiff's datum translation functions work fine inside Xastir on
that system, so the libgeotiff/libproj/libtiff stuff is working.

Another system doesn't segfault, but has a newer tiff/libgeotiff
installed.

It sounds like there might be a header/library file mismatch only
where OGR is concerned, which the libtiff/libproj/libgeotiff chain
is somehow avoiding.  Perhaps header files inside OGR that don't
match libraries that are installed on the system?

Another subject:  Is there a test suite of simple map files for the
various types and subtypes of maps accepted by OGR/GDAL?

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From matt.wilkie at gov.yk.ca  Wed Dec 10 12:16:45 2003
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] arcinfo grid gotcha
In-Reply-To: <3FD72883.4050006@pobox.com>
References: <3FD72883.4050006@pobox.com>
Message-ID: <3FD754FD.8050208@gov.yk.ca>

Norman Vine wrote:

 > Try adding the ArcInfo bin directory to your path or copy
 >   avbase.dll
 >   avfeat.dll
 >   avgridio.dll
 > from the arcinfo bin directory into a directory on your path

Thanks Norman but that is the opposite of what I want (thanks for 
itemising exactly which dlls are needed; I can use that). AIG is 
superior as it correctly reads and transfers the projection as well as 
the numeric type while GIO does not.

Frank Warmerdam wrote:

> Users can set the GDAL_SKIP environment variable with a list of space
> seperated driver names that they wish to not be used.
...
> set GDAL_SKIP="GIO"

thanks Frank, I can work with that.  I note that this disables both read 
and write with the specified drivers.  Not a problem for me currently as 
  I don't need both at the same time very often.

Actually, now that I think about it some more, is there any reason to 
use GIO for reading grids at all? Ideally AIG would be used for reading 
AI binary grids and GIO for writing AI binary grids.

Suggestion: allow explicit commandline options to override environment 
setting. For example:

	$ export GDAL_SKIP=GIO
	$ gdal_translate -of GIO inputimg.tif outputgrid

would work.

----
The link to http://www.remotesensing.org/gdal/frmt_various.html#GIO from 
http://www.remotesensing.org/gdal/formats_list.html "ArcInfo Binary Grid 
(GIO)" is broken. That target section does not exist. It does exist in 
my local html file of the same name for v1.1.8 though.


cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From hamdi_ines2003 at yahoo.fr  Tue Dec  9 08:14:59 2003
From: hamdi_ines2003 at yahoo.fr (=?iso-8859-1?q?hamdi=20ines?=)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] problem with gdal
Message-ID: <20031209131459.43949.qmail@web14713.mail.yahoo.com>

Hello,
first I want to subscribe in gdallist by: hamdi_ines2003@yahoo.fr and second I have a question:
I m download gdal-cvs-031203 to read gml file in
grass57,but when i execute the command make (after
> ./configure) the result is:
> .
> .
> .
> >make[2]: Entre dans le r?pertoire
> 
`/home/versionfinaledocgrass57/versionsforopenevfw-gdal/gdal-cvs-031203/frmts/png'
> make[2]: Rien ? faire pour `install-obj'.
> make[2]: Quitte le r?pertoire
> 
`/home/versionfinaledocgrass57/versionsforopenevfw-gdal/gdal-cvs-031203/frmts/png'
> make -C grass install-obj
> make[2]: Entre dans le r?pertoire
> 
`/home/versionfinaledocgrass57/versionsforopenevfw-gdal/gdal-cvs-031203/frmts/grass'
> /bin/sh ../../libtool --mode=compile g++ -I../../port
> -I../../gcore -I../../ogr -Wall  -O2   -c -o
> ../o/grassdataset.o grassdataset.cpp
>  g++ -I../../port -I../../gcore -I../../ogr -Wall -O2
> -c grassdataset.cpp  -fPIC -DPIC -o
> ../o/.libs/grassdataset.o
> grassdataset.cpp: In static member function `static
> GDALDataset*
>    GRASSDataset::Open(GDALOpenInfo*)':
> grassdataset.cpp:513: invalid conversion from `int
> (*)(...)' to `int (*)()'
> make[2]: *** [../o/grassdataset.o] Erreur 1

[...]
Please can you help me to resolv this problem.
THANK YOU
HAMDI In?s



---------------------------------
Do You Yahoo!? -- Avec Yahoo! soyez au coeur de la r?colte de dons pour le T?l?thon.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031209/5ae4d0b3/attachment.html
From hamdi_ines2003 at yahoo.fr  Wed Dec 10 07:46:38 2003
From: hamdi_ines2003 at yahoo.fr (=?iso-8859-1?q?hamdi=20ines?=)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] problem with gdal1.1.9
Message-ID: <20031210124638.25260.qmail@web14711.mail.yahoo.com>

hello,
i tried to install gdal1.1.9 but when i write:
make all to include the ogr i get:

>make[1]: doxygen : Commande introuvable
make[1]: *** [docs] Erreur 127
make[1]: Quitte le r?pertoire
`/home/versionfinaledocgrass57/versionsforopenevfw-gdal/gdal-1.1.9/ogr'
>make: *** [ogr-all] Erreur 2
please can you help me to resolv this problem and how
can i read gml file with gdal1.1.9.
HAMDI In?s


____________________________________________________________________________________
Do You Yahoo!? -- Avec Yahoo! soyez au coeur de la r?colte de dons pour le T?l?thon.
http://fr.promotions.yahoo.com/caritatif/

From warmerdam at pobox.com  Wed Dec 10 12:39:18 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] using a feature to store a "Track"
In-Reply-To: <000001c3bf2f$f31343c0$3b00000a@informatiquemer.fr>
References: <000001c3bf2f$f31343c0$3b00000a@informatiquemer.fr>
Message-ID: <3FD75A46.1090703@pobox.com>

mathieu_gdal wrote:
> Dear All,
> 
> I have a very basic question, I would like to know if my approach is
> good or not at all.
> 
> I have a list of points, called "a track". Each point is defined by :
> - a position (in lat,lon,WGS84)
> - an altitude
> - a heading (it is an example)
> 
> I would like to use the class OGRFeature to store this "Track".
> The Track's Geometry (lat, lon, and altitude) is very well managed in
> the OGRFeature (OGRFeature::poGeometry)
> But how to store the other attributes, such as heading?
> 
> My idea is to store the heading in a feature's special attribute, as a
> list of double. 
> This size of this list would be the same as the geometry size.
> To retrieve a specific point, I will have to retrieve its position with
> the geometry, and the heading with the "double list" attribute.
> It might be costly if I want to store many other parameters for each
> point. 

Mathieu,

This approach will work but the caveat is that very view OGR file formats
are going to support saving the list of doubles attribute type.  One low
tech alternative is to just keep the list of headings in string attribute
with commas between the values.  As long as the format you want to work
with supports long strings this should be OK.

The Shapefile format can actually store X, Y, Z and "M" for each geometry
vertex.  It would be ideal to map your heading to this measure value; however,
the current OGR Shapefile driver has no support for reading or writing to the
measure value.  Another approach might be to try and take advantage of this
by updating the Shapefile driver (the lower level Shapelib works just fine
for the measure values).

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Wed Dec 10 13:04:14 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] SAR_CEOS: possible memory leak ?
In-Reply-To: <BAY8-F53Fur2iz2Mb1s0000b688@hotmail.com>
References: <BAY8-F53Fur2iz2Mb1s0000b688@hotmail.com>
Message-ID: <3FD7601E.90901@pobox.com>

N. Farah wrote:
> 
> Hi,
> 
> While reading a SARA_CEOS image the process went fine, but a memory dump 
> occurred in my debug session.
> To try to isolate the problem, I tried to, only, open the image then 
> close it, the same behavior occurs. This suggests that a possible memory 
> leak might be in the Open(...) method.
> 
> I was using the "ottawa_patch.img" dataset from the remotesensing.org 
> ftp site.

Noureddine,

I tried running gdalinfo -mm under valgrind on the ottawa patch image, and
it didn't identify any illegitimate memory use on Linux.  I did find a few
minor memory leaks for which I have committed fixes, but these should not
explain a crash.

Could you try and dig into the problem from your end a bit more?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From TMitchell at lignum.com  Wed Dec 10 13:05:21 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] using a feature to store a "Track"
In-Reply-To: <3FD75A46.1090703@pobox.com>
Message-ID: <OF52DBFA9C.214E41F1-ON88256DF8.006303A3-88256DF8.00635DAC@lignum.com>





Do you a have specific OGR format in mind?  Would using a database be more
flexible than a file format?

Also,
I've used OGR, Python and PostGIS to grab GPS waypoints from a Garmin
receiver and hoped to tackle tracks in the future too.  If you are
interested in sharing code, drop me a note off-list (tmitchell@lignum.com).

Tyler



                                                                           
             Frank Warmerdam                                               
             <warmerdam@pobox.                                             
             com>                                                       To 
             Sent by:                  gdal-dev@remotesensing.org          
             gdal-dev-admin@re                                          cc 
             motesensing.org                                               
                                                                    Fax to 
                                                                           
             12/10/2003 09:39                                      Subject 
             AM                        Re: [Gdal-dev] using a feature to   
                                       store a "Track"                     
                                                                           
             Please respond to                                             
             gdal-dev@remotese                                             
                 nsing.org                                                 
                                                                           
                                                                           




mathieu_gdal wrote:
> Dear All,
>
> I have a very basic question, I would like to know if my approach is
> good or not at all.
>
> I have a list of points, called "a track". Each point is defined by :
> - a position (in lat,lon,WGS84)
> - an altitude
> - a heading (it is an example)
>
> I would like to use the class OGRFeature to store this "Track".
> The Track's Geometry (lat, lon, and altitude) is very well managed in
> the OGRFeature (OGRFeature::poGeometry)
> But how to store the other attributes, such as heading?
>
> My idea is to store the heading in a feature's special attribute, as a
> list of double.
> This size of this list would be the same as the geometry size.
> To retrieve a specific point, I will have to retrieve its position with
> the geometry, and the heading with the "double list" attribute.
> It might be costly if I want to store many other parameters for each
> point.

Mathieu,

This approach will work but the caveat is that very view OGR file formats
are going to support saving the list of doubles attribute type.  One low
tech alternative is to just keep the list of headings in string attribute
with commas between the values.  As long as the format you want to work
with supports long strings this should be OK.

The Shapefile format can actually store X, Y, Z and "M" for each geometry
vertex.  It would be ideal to map your heading to this measure value;
however,
the current OGR Shapefile driver has no support for reading or writing to
the
measure value.  Another approach might be to try and take advantage of this
by updating the Shapefile driver (the lower level Shapelib works just fine
for the measure values).

Best regards,

--
---------------------------------------+--------------------------------------

I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev



From hgrabows at stk.com  Wed Dec 10 13:00:14 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shifting
Message-ID: <44AB336C889417448260E477E9D398100384DA@toledo.stk.com>

I read through the archive and it appears that datum shifting should be
available in the OGR libraries, but I'm having issues with this.  I got
the binary form of PROJ.4 from the website, as well as downloaded the
data files for the shifts.  My application sets the environment variable
leading to those data files, per the suggestion of the PROJ.4 site.
It's just not happening.  My situation is that I'm trying to
automatically reproject ESRI shapefiles into WGS84 for my application.
As long as the projection uses a WGS84 datum, everyone is happy.  If it
doesn't use this datum then the data generated comes out in a
nonsensical fashion.  I've tried doing it from the command line ogr2ogr
that I built with the standard GDAL build scripts with a similar issue,
but in the form of an error.  In both cases I have an environment
variable PROJ_LIB set to the directory where the data files like
"nad27","nad83", and "alaska.lla" are stored.  

In the command line case, I can correctly reproject a shape file with
data in an Albers projection using the following command:

ogr2ogr -t_srs WGS84 out.shp cities_alb.shp

However if I do the same thing with a shape file with its geometry in a
NAD 1927 UTM Zone 16N projection I get the following result:

This command: ogr2ogr -t_srs WGS84 out.shp roads.shp

produces this error message:
ERROR 1: failed to load NAD27-83 correction file
Failed to transform feature 0.
ERROR 1: Terminating translation prematurely after failed
translation of layer roads

I assume the two are related.  In code, I'm doing a very similar thing.
I create a new shape file data source and get the shapefile as a layer.
I pull the spatial reference for that layer and create a default WGS84
spatial reference.  I then create a new coordinate transformation object
and use that to transform a Geometry collection.  The relevent code
snippet looks like this:

 OGRCoordinateTransformation *pCoordTrans=0;
 OGRSpatialReference  srWGS84;
 OGRSpatialReference  sr2;
 OGRDataSource   *pDS=0;
 OGRErr     err;
 OGRLayer    *pLayer=0;
 OGRSpatialReference  *pOrig=0;

...

  pLayer = pDS->GetLayerByName(featureName);

  pOrig = pLayer->GetSpatialRef();
  err = srWGS84.SetWellKnownGeogCS("WGS84");
  pCoordTrans = OGRCreateCoordinateTransformation(pOrig,&srWGS84);

  OGRGeometryCollection pointCol;

...

  pointCol.transform(pCoordTrans);

Again, this works for Albers projections, but not the NAD based
projection that I tried above.  It doesn't throw an error, but it also
doesn't.  If I manually transform the data in ArcGIS I get a valid
transformation, so I know an accurate conversion is possible.  

Hopefully this provides enough information to provide some assistance.
You guys have done a good job with this library, and I'd like to express
my appreciation for the time you have put into developing and
maintaining it.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!

From nfarah at hotmail.com  Wed Dec 10 13:44:13 2003
From: nfarah at hotmail.com (N. Farah)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] SAR_CEOS: possible memory leak ? 
Message-ID: <BAY8-F23EKAajHVBAIW0000d0e4@hotmail.com>

Frank,

Actually there was no crash, just memory leaks.
I got the new committed file "sar_ceosdataset.cpp". After running open and 
close on the dataset, there were memory leaks. After an initial 
investigation, most of the leaks are the memory of every "Links->object" 
(see the destructor). There were 21 objects in the "Links" and all of of 
them leaked 28 bytes. It appears that they were not fully released.

The other leaks are four objects of 8 bytes. I did not have a chance yet to 
target their source.
I'll investigate more...

Noureddine Farah

_________________________________________________________________
MSN 8 with e-mail virus protection service: 2 months FREE*  
http://join.msn.com/?page=features/virus&pgmarket=en-ca&RU=http%3a%2f%2fjoin.msn.com%2f%3fpage%3dmisc%2fspecialoffers%26pgmarket%3den-ca


From warmerdam at pobox.com  Wed Dec 10 14:29:21 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] SAR_CEOS: possible memory leak ?
In-Reply-To: <BAY8-F23EKAajHVBAIW0000d0e4@hotmail.com>
References: <BAY8-F23EKAajHVBAIW0000d0e4@hotmail.com>
Message-ID: <3FD77411.10304@pobox.com>

N. Farah wrote:
> Frank,
> 
> Actually there was no crash, just memory leaks.
> I got the new committed file "sar_ceosdataset.cpp". After running open 
> and close on the dataset, there were memory leaks. After an initial 
> investigation, most of the leaks are the memory of every "Links->object" 
> (see the destructor). There were 21 objects in the "Links" and all of of 
> them leaked 28 bytes. It appears that they were not fully released.

Noureddine,

I also modified one of the other files in the same directory, ceos.c I think.
There will still be a few leaks left related to setting up the lists of
"templates".  These should be a one-time cost, reused for subsequent datasets.
And there is the usual one-time leaks related to registering all the drivers
at runtime.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Wed Dec 10 15:46:28 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shifting
In-Reply-To: <44AB336C889417448260E477E9D398100384DA@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384DA@toledo.stk.com>
Message-ID: <3FD78624.6030106@pobox.com>

> ogr2ogr -t_srs WGS84 out.shp cities_alb.shp
> 
> However if I do the same thing with a shape file with its geometry in a
> NAD 1927 UTM Zone 16N projection I get the following result:
 >
> This command: ogr2ogr -t_srs WGS84 out.shp roads.shp
> 
> produces this error message:
> ERROR 1: failed to load NAD27-83 correction file
> Failed to transform feature 0.
> ERROR 1: Terminating translation prematurely after failed
> translation of layer roads


Hank,

I am not sure what is going wrong.  What I will note is that error
-38 from PROJ.4 (which is reported as "failed to load NAD27-83 correction file"
can be produced for a number of reasons, apparently including:

  o Not finding the datum shift file (any datum shift file, not just nad27/83
    ones for the US).
  o not having a shift file for the location you are attempting to translate
    (are your vectors all in the continental US?)
  o The file having a corrupt header as would occur if the binary version
    (nad27/83) was generated on a different platform.

Recent PROJ.4 source includes support for setting the PROJ_DEBUG environment
variable (to anything) to turn on some extra debug information in the
datum shift code.  You might want to try this.

You might want to debug into pj_apply_gridshift() if and below if you are
able to build proj.4 in debug.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Wed Dec 10 15:57:45 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Link error on Win2K
In-Reply-To: <5.1.0.14.0.20031209101733.0460ee48@caris0.caris.priv>
References: <5.1.0.14.0.20031209101733.0460ee48@caris0.caris.priv>
Message-ID: <3FD788C9.2010904@pobox.com>

gdal-dev-admin@remotesensing.org wrote:
> Hi all,
> 
> I am getting an unresolved external after building the cvs verison.
> cvs update from minutes ago on Win2K using VC6.
> No errors until final link.
> 
>         cd ..
>         if exist gdal.lib del gdal.lib
>         lib /out:gdal.lib port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj 
> ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib
> Microsoft (R) Library Manager Version 6.00.8447
> Copyright (C) Microsoft Corp 1992-1998. All rights reserved.
> 
>         link /dll /debug /INCLUDE:_OCTNewCoordinateTransformation  
> /INCLUDE:_OGRRegisterAll  /INCLUD
> E:_OGRFeatureStylePuller  /INCLUDE:_OSRValidate 
> /INCLUDE:_OPTGetProjectionMethods  /INCLUDE:_OGR_G_
> GetPointCount /INCLUDE:_GDALSimpleImageWarp  
> /INCLUDE:_GDALSuggestedWarpOutput /INCLUDE:_GDALGCPTra
> nsform  /INCLUDE:_GDALComputeMedianCutPCT  /INCLUDE:_GDALDitherRGB2PCT 
> port\*.obj gcore\*.obj alg\*.
> obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib   
> D:\third_party\lib/xerces-c220.lib
>  odbc32.lib  D:\third_party\ECWSdk\lib\NCSEcw.lib 
> D:\third_party\ECWSdk\lib\NCSEcwC.lib  D:\third_pa
> rty\ECWSdk\lib\NCSUtil.lib       D:\third_party\lib/libjpeg6s.lib 
> D:\third_party\lib/libpng125s.lib
>  /out:gdal11.dll /implib:gdal_i.lib
> Microsoft (R) Incremental Linker Version 6.00.8447
> Copyright (C) Microsoft Corp 1992-1998. All rights reserved.
> 
>    Creating library gdal_i.lib and object gdal_i.exp
> ogrsf_frmts.lib(ogrregisterall.obj) : error LNK2001: unresolved external 
> symbol _RegisterOGRVRT
> gdal11.dll : fatal error LNK1120: 1 unresolved externals
> NMAKE : fatal error U1077: 'link' : return code '0x460'
> Stop.
> 
> ogr\ogrsf_frmts\vrt\ogrvrtdriver.cpp gets compiled (no errors) and gets 
> added to ogrsf_frmts.lib.


Todd,

I tried this on win32, and it seems to work for me.  I suspect you did not
pull the new gdal/ogr/ogrsf_frmts/vrt directory from CVS when updating.
You need to use the "cvs update -d" using the commandline cvs client to
pull out new directories as well as new files from CVS.  Do you have
a gdal/ogr/ogrsf_frmts/vrt directory?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Wed Dec 10 16:37:31 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR/Shapefile crash
In-Reply-To: <Pine.LNX.4.53.0312100851350.28330@wapiti.tc.fluke.com>
References: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com> <3FD4D16D.2020703@pobox.com> <Pine.LNX.4.53.0312100851350.28330@wapiti.tc.fluke.com>
Message-ID: <3FD7921B.9070207@pobox.com>

Curt Mills, WE7U wrote:
> That system is using CVS GDAL, proj-4.4.7, and
> proj-nad27-1.1.tar.gz.  It still segfaults on this statement if a
> ".prj" file is present with a Shapefile:
> 
> 
>   datasource = OGROpen(full_filename, 0 /* bUpdate */, &driver);

Curt,

Well, this isn't really "close enough" to the problem to tell much
from.

> It doesn't segfault if the .prj file is absent, but of course then
> it can't get any spatial info from the file.
> 
> The system which segfaults has had various versions of proj and
> libgeotiff installed at various times.  It has an older libtiff,
> therefore is running libgeotiff 1.1.4 or 1.1.5 to match.
> Libgeotiff's datum translation functions work fine inside Xastir on
> that system, so the libgeotiff/libproj/libtiff stuff is working.
> 
> Another system doesn't segfault, but has a newer tiff/libgeotiff
> installed.
> 
> It sounds like there might be a header/library file mismatch only
> where OGR is concerned, which the libtiff/libproj/libgeotiff chain
> is somehow avoiding.  Perhaps header files inside OGR that don't
> match libraries that are installed on the system?

I'm afraid I am somewhat confused at the end of this.  If you can
produce the effect with a clean CVS build I will fix.  But it sounds
like it might be a build-configuation issue, or a bug that has already
been fixed.

> Another subject:  Is there a test suite of simple map files for the
> various types and subtypes of maps accepted by OGR/GDAL?

Map files?  I assume you just mean raster files of the various formats?
There is a growing set of sample files at:

   ftp://ftp.remotesensing.org/gdal/data/

There is also a set of test scripts written in python for testing some
GDAL capbilities (in osrs/gdalautotest in CVS).

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From hacker at tc.fluke.com  Wed Dec 10 17:07:37 2003
From: hacker at tc.fluke.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR/Shapefile crash
In-Reply-To: <3FD7921B.9070207@pobox.com>
References: <Pine.LNX.4.53.0312081013020.7899@wapiti.tc.fluke.com>
 <3FD4D16D.2020703@pobox.com> <Pine.LNX.4.53.0312100851350.28330@wapiti.tc.fluke.com>
 <3FD7921B.9070207@pobox.com>
Message-ID: <Pine.LNX.4.53.0312101403250.28330@wapiti.tc.fluke.com>

On Wed, 10 Dec 2003, Frank Warmerdam wrote:

> I'm afraid I am somewhat confused at the end of this.  If you can
> produce the effect with a clean CVS build I will fix.  But it sounds
> like it might be a build-configuation issue, or a bug that has already
> been fixed.

Understand.  I'm planning to upgrade that system sometime to SuSE
8.x (it's 7.3 currently), at which point I'll check again.


> > Another subject:  Is there a test suite of simple map files for the
> > various types and subtypes of maps accepted by OGR/GDAL?
>
> Map files?  I assume you just mean raster files of the various formats?

Nope.  Another one of our developers is doing the GDAL integration
(Hi Chris!).  I'm doing OGR, therefore I'm looking for vector files
only.

In particular, it'd be nice if all of the major object types were in
some simple example files, perhaps Shapefiles.

I'm prowling around the 'net and finding various maps to test with,
but most of them just have Point/Linestring/Polygon/MultiPolygon.
I'm having troubles finding anything more complicated, or finding
some of the more obscure map formats to test with.

Have a vector collection?

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hgrabows at stk.com  Wed Dec 10 18:59:26 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shifting
Message-ID: <44AB336C889417448260E477E9D398100384DC@toledo.stk.com>

The only data files I have in my "nad" directory, which is mapped to the
environment variable as I stated below, are the ones that came with the
standard windows library zip file "proj446_win32_bin.zip" that I got
from http://remotesensing.org/proj/.  These all seem to be binary files.
When I put debug mode on I did get a weird additional error:

pj_open_lib(conus): call
fopen(C:\perforce\data\main\STKData\CentralBodies\Earth
\nad/conus).
ERROR 1: no system list, errno: 2

There is a file called conus.lla, and naming a copy of that file t
"conus" fixed that problem (if it was one at all).  After that, I get
the exact same debugging messages as I did before:

pj_open_lib(conus): call
fopen(C:\perforce\data\main\STKData\CentralBodies\Earth
\nad/conus).
ERROR 1: failed to load NAD27-83 correction file
Failed to transform feature 0.
ERROR 1: Terminating translation prematurely after failed
translation of layer roads

I suppose I'm going to have to compile and see what is going on.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Wednesday, December 10, 2003 3:46 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Datum shifting


> ogr2ogr -t_srs WGS84 out.shp cities_alb.shp
> 
> However if I do the same thing with a shape file with its geometry in 
> a NAD 1927 UTM Zone 16N projection I get the following result:
 >
> This command: ogr2ogr -t_srs WGS84 out.shp roads.shp
> 
> produces this error message:
> ERROR 1: failed to load NAD27-83 correction file
> Failed to transform feature 0.
> ERROR 1: Terminating translation prematurely after failed translation 
> of layer roads


Hank,

I am not sure what is going wrong.  What I will note is that error -38
from PROJ.4 (which is reported as "failed to load NAD27-83 correction
file" can be produced for a number of reasons, apparently including:

  o Not finding the datum shift file (any datum shift file, not just
nad27/83
    ones for the US).
  o not having a shift file for the location you are attempting to
translate
    (are your vectors all in the continental US?)
  o The file having a corrupt header as would occur if the binary
version
    (nad27/83) was generated on a different platform.

Recent PROJ.4 source includes support for setting the PROJ_DEBUG
environment variable (to anything) to turn on some extra debug
information in the datum shift code.  You might want to try this.

You might want to debug into pj_apply_gridshift() if and below if you
are able to build proj.4 in debug.

Best regards,

-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From matt.gregory at oregonstate.edu  Wed Dec 10 20:15:25 2003
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] newbie question about AIG vs. GIO drivers
Message-ID: <BE589336ED4F8845ABD0817C5617E7D00F8B51@thuja>

I have been combing through the prior postings to the list, but haven't come across an answer.  I apologize if this has been covered before ...

I am trying to sort out which is the "best" driver to use when reading in ArcInfo binary grids.  It appears that the GIO driver has preference (based on its position in GDALLAllRegister) and will allow writing grids, whereas the AIG driver will not.  However, the GIO driver lacks any projection definition capabilities at present(?).  

I can't find any documentation on the GIO driver as it appears to point to a missing link.(http://remotesensing.org/gdal/frmt_various.html#GIO)

Any guidance on this would be very helpful.  GDAL promises to be very useful ...

thanks, matt

Matt Gregory
Faculty Research Assistant
Department of Forest Science
Oregon State University
541.750.7285
matt.gregory@orst.edu

From warmerdam at pobox.com  Wed Dec 10 22:20:38 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] newbie question about AIG vs. GIO drivers
In-Reply-To: <BE589336ED4F8845ABD0817C5617E7D00F8B51@thuja>
References: <BE589336ED4F8845ABD0817C5617E7D00F8B51@thuja>
Message-ID: <3FD7E286.5060505@pobox.com>

Gregory, Matthew wrote:
> I have been combing through the prior postings to the list, but haven't come across an answer.  I apologize if this has been covered before ...
> 
> I am trying to sort out which is the "best" driver to use when reading in ArcInfo binary grids.  It appears that the GIO driver has preference (based on its position in GDALLAllRegister) and will allow writing grids, whereas the AIG driver will not.  However, the GIO driver lacks any projection definition capabilities at present(?).  
> 
> I can't find any documentation on the GIO driver as it appears to point to a missing link.(http://remotesensing.org/gdal/frmt_various.html#GIO)
> 
> Any guidance on this would be very helpful.  GDAL promises to be very useful ...

Matt,

In theory the GIO driver is better because it uses ESRI's own libraries
to read the file, so it might work for files that the AIG driver fails
on due to some misunderstanding of the format on my part.  However, in
practice, the AIG driver is better maintained and has projections support
which are omitted from the GIO driver because there was little interest.

Furthermore, I believe I dropped support for the GIO for the 1.1.9 release
(or perhaps it was since then) because it was generally more trouble than
it was worth.  The creating of files seems to be pretty buggy and the
read was not as good (in some ways) as the AIG especially once I finally
susses out the last weird compression type so the AIG now supports all
grid forms I have seen.  The docs presumably disappeared as part of this
"cleaning out" of the GIO driver.

However, recently a client has requested that I refresh the GIO driver, and
fix up the output support properly, so you should see it again in the
next major release.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From ed at topozone.com  Wed Dec 10 22:23:11 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shifting
Message-ID: <13858AA1A74F30419F319ACB66A9D12203ADC0@mercator.topozone.com>

Hank -

Just to double-check Frank's question, are all the data points in that
file within the continental US?

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com
ed@topozone.com


-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com] 
Sent: Wednesday, December 10, 2003 6:59 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shifting

The only data files I have in my "nad" directory, which is mapped to the
environment variable as I stated below, are the ones that came with the
standard windows library zip file "proj446_win32_bin.zip" that I got
from http://remotesensing.org/proj/.  These all seem to be binary files.
When I put debug mode on I did get a weird additional error:

pj_open_lib(conus): call
fopen(C:\perforce\data\main\STKData\CentralBodies\Earth
\nad/conus).
ERROR 1: no system list, errno: 2

There is a file called conus.lla, and naming a copy of that file t
"conus" fixed that problem (if it was one at all).  After that, I get
the exact same debugging messages as I did before:

pj_open_lib(conus): call
fopen(C:\perforce\data\main\STKData\CentralBodies\Earth
\nad/conus).
ERROR 1: failed to load NAD27-83 correction file Failed to transform
feature 0.
ERROR 1: Terminating translation prematurely after failed translation of
layer roads

I suppose I'm going to have to compile and see what is going on.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent: Wednesday, December 10, 2003 3:46 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Datum shifting


> ogr2ogr -t_srs WGS84 out.shp cities_alb.shp
> 
> However if I do the same thing with a shape file with its geometry in 
> a NAD 1927 UTM Zone 16N projection I get the following result:
 >
> This command: ogr2ogr -t_srs WGS84 out.shp roads.shp
> 
> produces this error message:
> ERROR 1: failed to load NAD27-83 correction file
> Failed to transform feature 0.
> ERROR 1: Terminating translation prematurely after failed translation 
> of layer roads


Hank,

I am not sure what is going wrong.  What I will note is that error -38
from PROJ.4 (which is reported as "failed to load NAD27-83 correction
file" can be produced for a number of reasons, apparently including:

  o Not finding the datum shift file (any datum shift file, not just
nad27/83
    ones for the US).
  o not having a shift file for the location you are attempting to
translate
    (are your vectors all in the continental US?)
  o The file having a corrupt header as would occur if the binary
version
    (nad27/83) was generated on a different platform.

Recent PROJ.4 source includes support for setting the PROJ_DEBUG
environment variable (to anything) to turn on some extra debug
information in the datum shift code.  You might want to try this.

You might want to debug into pj_apply_gridshift() if and below if you
are able to build proj.4 in debug.

Best regards,

-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Wed Dec 10 23:02:13 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shifting
In-Reply-To: <44AB336C889417448260E477E9D398100384DC@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384DC@toledo.stk.com>
Message-ID: <3FD7EC45.8040905@pobox.com>

Grabowski, Hank wrote:
> The only data files I have in my "nad" directory, which is mapped to the
> environment variable as I stated below, are the ones that came with the
> standard windows library zip file "proj446_win32_bin.zip" that I got
> from http://remotesensing.org/proj/.  These all seem to be binary files.
> When I put debug mode on I did get a weird additional error:
> 
> pj_open_lib(conus): call
> fopen(C:\perforce\data\main\STKData\CentralBodies\Earth
> \nad/conus).
> ERROR 1: no system list, errno: 2
> 
> There is a file called conus.lla, and naming a copy of that file t
> "conus" fixed that problem (if it was one at all).  After that, I get
> the exact same debugging messages as I did before:

Hank,

Here-in lies the problem.  The conus.lla file is an ASCII file which needs
to be converted to binary format, with the name conus.  The error is that
the header is corrupt (not the expected binary format), though I must confess
that the error reporting is very wanting in detail.

The "no system list" part just means that the software on the platform in
question is not configured to call strerror() to translate system error codes
into message strings.  I think I have already corrected this in the
development source.

Finally, it would seem that the proj446_win32_bin.zip distribution was prepared
improperly, including only the ascii files, instead of the binary files.  You
can issue the following commands from within the "nad" directory to translate
the ascii files into binary files.  Likely only the conus line will be
necessary.

	..\bin\nad2bin.exe < conus.lla conus
	..\bin\nad2bin.exe < MD.lla MD
	..\bin\nad2bin.exe < TN.lla TN
	..\bin\nad2bin.exe < WI.lla WI
	..\bin\nad2bin.exe < WO.lla WO
	..\bin\nad2bin.exe < alaska.lla alaska
	..\bin\nad2bin.exe < hawaii.lla hawaii
	..\bin\nad2bin.exe < prvi.lla prvi
	..\bin\nad2bin.exe < stgeorge.lla stgeorge
	..\bin\nad2bin.exe < stlrnc.lla stlrnc
	..\bin\nad2bin.exe < stpaul.lla stpaul

I appologise for the error, and the confusion it caused.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Thu Dec 11 01:26:09 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] New .bt driver
Message-ID: <3FD80E01.90003@pobox.com>

Folks,

At the request of Matt Wilkie I have implemented read and write support
for the .bt (binary terrain) format used by the VTP software for holding
elevation data. The code is very new and lightly tested. Let me know if
anyone runs into problems building or using it.

    VTP - http://www.vterrain.org/

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From Ballini.Yvain at seat.it  Thu Dec 11 04:22:38 2003
From: Ballini.Yvain at seat.it (Ballini Yvain)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] compiling mapserver 4.0 with gdal support on VC7
Message-ID: <4B1A1EC0790F054193453C48725D43180B8C5C@MSGBE1V1.seat.it>


Hi,

I'm trying to recompile mapserver 4.0 with OGR support (on Windows XP
with VC7).

Without the gdal support, it's everything ok but adding the gdal support
introduces a lot of problem during the recompilation of mapserver.

When I run the makefile.vc of mapserver, it gives me the following
errors for gdal 1.1.9:

cpl.lib(cpl_error.obj) : error LNK2019: unresolved external symbol
__imp___vsnpr intf referenced in function _CPLDebug

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol
__imp___vsnp rintf referenced in function _CSLSave

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol
__imp__fp uts referenced in function _VSIFPuts

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol
__imp__mk dir referenced in function _VSIMkdir

OLDNAMES.lib(mkdir.obi) : error LNK2001: unresolved external symbol
__imp__mkdir

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol
__imp__rm dir referenced in function _VSIRmdir

OLDNAMES.lib(rmdir.obi) : error LNK2001: unresolved external symbol
__imp__rmdir

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol
__imp__strer ror referenced in function _CSLSave

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol
__imp___errn o referenced in function _CSLSave

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol
__imp___findclo se referenced in function _CPLReadDir

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol
__imp___findnex t referenced in function _CPLReadDir

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol
__imp___findfir st referenced in function _CPLReadDir

OLDNAMES.lib(mkdir.obi) : error LNK2001: unresolved external symbol
__imp___mkdi r

OLDNAMES.lib(rmdir.obi) : error LNK2001: unresolved external symbol
__imp___rmdi r mapserv.exe : fatal error LNK1120: 11 unresolved
externals NMAKE : fatal error U1077: 'link' : return code '0x460'

Stop.

Does someone know if there is a better version for compiling with VC7 ?

Thanks.

Yvain Ballini.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031211/ead44da8/attachment.html
From warmerdam at pobox.com  Thu Dec 11 09:41:04 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] compiling mapserver 4.0 with gdal support on VC7
In-Reply-To: <4B1A1EC0790F054193453C48725D43180B8C5C@MSGBE1V1.seat.it>
References: <4B1A1EC0790F054193453C48725D43180B8C5C@MSGBE1V1.seat.it>
Message-ID: <3FD88200.7010703@pobox.com>

Ballini Yvain wrote:
> cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol 
> __imp___findfir st referenced in function _CPLReadDir
> 
> OLDNAMES.lib(mkdir.obi) : error LNK2001: unresolved external symbol 
> __imp___mkdi r
> 
> OLDNAMES.lib(rmdir.obi) : error LNK2001: unresolved external symbol 
> __imp___rmdi r mapserv.exe : fatal error LNK1120: 11 unresolved 
> externals NMAKE : fatal error U1077: 'link' : return code '0x460'
> 
> Stop.
> 
> Does someone know if there is a better version for compiling with VC7 ?

Yvain,

I build GDAL regularly with VC7 (admittedly the first release of VC7, not
the new 2003 version).  I don't know why you are getting the above problems,
but I would guess there is some sort of mixup in the versions of LIBC you
are using.  This might be due to altering some of the flags in nmake.opt
after doing a partial build and not cleaning up, or due to linking against
some external library with a different libc.

This is a very difficult sort of problem to diagnose remotely.

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From ed at topozone.com  Thu Dec 11 09:55:22 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] compiling mapserver 4.0 with gdal support on VC7
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C0777@mercator.topozone.com>

Yvain -
 
This looks like a mismatched set of compile/build options.  I build GDAL all the time with VC7 and I find it's one of the cleanest builds in the MapServer suite.  I would do a "clean" and then rebuild everything; if the problem persists, you probably have mismatched compiler options for some of the modules.  Have you edited the compiler switches from the default distribution?
 
    - Ed
Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Ballini Yvain [mailto:Ballini.Yvain@seat.it]
Sent: Thursday, December 11, 2003 4:23 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] compiling mapserver 4.0 with gdal support on VC7



Hi,

I'm trying to recompile mapserver 4.0 with OGR support (on Windows XP with VC7).

Without the gdal support, it's everything ok but adding the gdal support introduces a lot of problem during the recompilation of mapserver.

When I run the makefile.vc of mapserver, it gives me the following errors for gdal 1.1.9:

cpl.lib(cpl_error.obj) : error LNK2019: unresolved external symbol __imp___vsnpr intf referenced in function _CPLDebug

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol __imp___vsnp rintf referenced in function _CSLSave

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol __imp__fp uts referenced in function _VSIFPuts

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol __imp__mk dir referenced in function _VSIMkdir

OLDNAMES.lib(mkdir.obi) : error LNK2001: unresolved external symbol __imp__mkdir

cpl.lib(cpl_vsisimple.obj) : error LNK2019: unresolved external symbol __imp__rm dir referenced in function _VSIRmdir

OLDNAMES.lib(rmdir.obi) : error LNK2001: unresolved external symbol __imp__rmdir

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol __imp__strer ror referenced in function _CSLSave

cpl.lib(cpl_string.obj) : error LNK2019: unresolved external symbol __imp___errn o referenced in function _CSLSave

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol __imp___findclo se referenced in function _CPLReadDir

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol __imp___findnex t referenced in function _CPLReadDir

cpl.lib(cpl_dir.obj) : error LNK2019: unresolved external symbol __imp___findfir st referenced in function _CPLReadDir

OLDNAMES.lib(mkdir.obi) : error LNK2001: unresolved external symbol __imp___mkdi r

OLDNAMES.lib(rmdir.obi) : error LNK2001: unresolved external symbol __imp___rmdi r mapserv.exe : fatal error LNK1120: 11 unresolved externals NMAKE : fatal error U1077: 'link' : return code '0x460'

Stop.

Does someone know if there is a better version for compiling with VC7 ?

Thanks.

Yvain Ballini.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031211/94d91f17/attachment.html
From gillian.walter at atlantis-scientific.com  Thu Dec 11 11:31:50 2003
From: gillian.walter at atlantis-scientific.com (Gillian Walter)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] numpy uint16, uint32
Message-ID: <3FD89BF6.3090106@atlantis-scientific.com>

Hi Frank,

Were uint16 ('w') and uint32 ('u') left out of numpydataset.cpp for a 
reason, or have they just not been needed and never got added in?  I 
 added them to my linux build as types GDT_UInt16 and GDT_UInt32, and 
things seemed to be okay when I displayed each of them as an array in 
openev.  If they were just forgotten, I'll go ahead and check in the 
changes.

Gillian



From warmerdam at pobox.com  Thu Dec 11 11:46:26 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] numpy uint16, uint32
In-Reply-To: <3FD89BF6.3090106@atlantis-scientific.com>
References: <3FD89BF6.3090106@atlantis-scientific.com>
Message-ID: <3FD89F62.7020006@pobox.com>

Gillian Walter wrote:
> Hi Frank,
> 
> Were uint16 ('w') and uint32 ('u') left out of numpydataset.cpp for a 
> reason, or have they just not been needed and never got added in?  I 
> added them to my linux build as types GDT_UInt16 and GDT_UInt32, and 
> things seemed to be okay when I displayed each of them as an array in 
> openev.  If they were just forgotten, I'll go ahead and check in the 
> changes.

Gillian,

Presumably just an omission.  Please commit the changes.

Thanks,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From matt.wilkie at gov.yk.ca  Thu Dec 11 12:04:44 2003
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] newbie question about AIG vs. GIO drivers
In-Reply-To: <BE589336ED4F8845ABD0817C5617E7D00F8B51@thuja>
References: <BE589336ED4F8845ABD0817C5617E7D00F8B51@thuja>
Message-ID: <3FD8A3AC.2070601@gov.yk.ca>

 > I have been combing through the prior postings to the list, but haven't
 > come across an answer.  I apologize if this has been covered before ...

The recent thread "arcinfo grid gotcha" thread covers part of the 
differences.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From hacker at tc.fluke.com  Thu Dec 11 12:12:50 2003
From: hacker at tc.fluke.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <3FD89F62.7020006@pobox.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com>
Message-ID: <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>

My code is currently reading Shapefile maps via OGR.  If I disable
the feature loop, memory appears relatively stable.

Enabling the feature loop, I'm losing megabytes every time I read
in Shapefiles.  I disabled the majority of the "feature" loop via
#ifdef's, and am just running this now:


  while ( (featureH = OGR_L_GetNextFeature( layer )) != NULL ) {
      if (featureH)
          OGR_F_Destroy( featureH );
  }


It's still losing megabytes every time I load a map.  Using CVS
GDAL/OGR and of course the 'C' API.

Is OGR_F_Destroy() not free'ing all the memory used?

I register all drivers when I start my app (a long-running app by
the way), and leave them alone after that.  Is there something that
I should Destory/Free regarding the drivers?

I'm not free'ing the layers either, but it appears from your 'C'
sample program that I should not.  There doesn't appear to be a big
problem in the layers anyway.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hacker at tc.fluke.com  Thu Dec 11 12:34:35 2003
From: hacker at tc.fluke.com (Curt Mills)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com>
 <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
Message-ID: <Pine.LNX.4.53.0312110932190.28330@wapiti.tc.fluke.com>

On Thu, 11 Dec 2003, Curt Mills, WE7U wrote:

> My code is currently reading Shapefile maps via OGR.  If I disable
> the feature loop, memory appears relatively stable.
>
> Enabling the feature loop, I'm losing megabytes every time I read
> in Shapefiles.

More data:  Tried the same thing with SDTS DLG file.  First file
load takes me from 10588 kbytes to 14508 kbytes, then it stays
stable as I pan/zoom (which reads the file in again), actually
dropping slightly to around 14476 kbytes.

With Shapefiles, the memory just keeps climbing each time I load a
file.  A lot.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hacker at tc.fluke.com  Thu Dec 11 13:07:39 2003
From: hacker at tc.fluke.com (Curt Mills)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312110932190.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com>
 <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312110932190.28330@wapiti.tc.fluke.com>
Message-ID: <Pine.LNX.4.53.0312111007080.28330@wapiti.tc.fluke.com>

On Thu, 11 Dec 2003, Curt Mills wrote:

> On Thu, 11 Dec 2003, Curt Mills, WE7U wrote:
>
> > My code is currently reading Shapefile maps via OGR.  If I disable
> > the feature loop, memory appears relatively stable.
> >
> > Enabling the feature loop, I'm losing megabytes every time I read
> > in Shapefiles.
>
> More data:  Tried the same thing with SDTS DLG file.  First file
> load takes me from 10588 kbytes to 14508 kbytes, then it stays
> stable as I pan/zoom (which reads the file in again), actually
> dropping slightly to around 14476 kbytes.
>
> With Shapefiles, the memory just keeps climbing each time I load a
> file.  A lot.

Yet more:  Point/Polylines don't appear to trigger it.  Happens with
Polygon and perhaps MultiPolygon files.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hacker at tc.fluke.com  Thu Dec 11 13:37:46 2003
From: hacker at tc.fluke.com (Curt Mills)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312111007080.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com>
 <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312110932190.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312111007080.28330@wapiti.tc.fluke.com>
Message-ID: <Pine.LNX.4.53.0312111032480.28330@wapiti.tc.fluke.com>

On Thu, 11 Dec 2003, Curt Mills wrote:

> On Thu, 11 Dec 2003, Curt Mills wrote:
>
> > On Thu, 11 Dec 2003, Curt Mills, WE7U wrote:
> >
> > > My code is currently reading Shapefile maps via OGR.  If I disable
> > > the feature loop, memory appears relatively stable.
> > >
> > > Enabling the feature loop, I'm losing megabytes every time I read
> > > in Shapefiles.
> >
> > More data:  Tried the same thing with SDTS DLG file.  First file
> > load takes me from 10588 kbytes to 14508 kbytes, then it stays
> > stable as I pan/zoom (which reads the file in again), actually
> > dropping slightly to around 14476 kbytes.
> >
> > With Shapefiles, the memory just keeps climbing each time I load a
> > file.  A lot.
>
> Yet more:  Point/Polylines don't appear to trigger it.  Happens with
> Polygon and perhaps MultiPolygon files.

Yet another datapoint:  My first SDTS test file only contained
Points/Polylines, which did not trigger the memory loss.  SDTS files
which contain Polygons _do_ trigger it.  Shapefile Multipolygons
also definitely trigger it.

I'm losing memory with these map formats so far:

    SDTS Polygons
    Shapefile Polygons
    Shapefile MultiPolygons

Everything appears ok with only Points/Polylines from the few
formats I've tried.

This is with my "feature" loop essentially disabled:  Get each new
feature, and then destroy it.

If I disable even that part of the loop and leave only the layer
loop, memory usage becomes stable.  If I use files containing only
Points/Lines, memory usage becomes stable.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hgrabows at stk.com  Thu Dec 11 13:44:40 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <44AB336C889417448260E477E9D398100384DE@toledo.stk.com>

Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!

From ed at topozone.com  Thu Dec 11 13:54:34 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C078D@mercator.topozone.com>

Hank -

As the saying goes, the man with two watches never knows what time it is!  It might be worth testing the conversion on a third source, such as the "Geodetic Tool Kit" tools from NGS at http://www.ngs.noaa.gov/TOOLS just to see whether they agree with your PROJ output or with your ESRI output (or neither <g>).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 1:45 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Datum shift accuracy


Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hacker at tc.fluke.com  Thu Dec 11 14:24:04 2003
From: hacker at tc.fluke.com (Curt Mills)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312111032480.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com>
 <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312110932190.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312111007080.28330@wapiti.tc.fluke.com>
 <Pine.LNX.4.53.0312111032480.28330@wapiti.tc.fluke.com>
Message-ID: <Pine.LNX.4.53.0312111118110.28330@wapiti.tc.fluke.com>

On Thu, 11 Dec 2003, Curt Mills wrote:

> Yet another datapoint:  My first SDTS test file only contained
> Points/Polylines, which did not trigger the memory loss.  SDTS files
> which contain Polygons _do_ trigger it.  Shapefile Multipolygons
> also definitely trigger it.
>
> I'm losing memory with these map formats so far:
>
>     SDTS Polygons
>     Shapefile Polygons
>     Shapefile MultiPolygons
>
> Everything appears ok with only Points/Polylines from the few
> formats I've tried.
>
> This is with my "feature" loop essentially disabled:  Get each new
> feature, and then destroy it.
>
> If I disable even that part of the loop and leave only the layer
> loop, memory usage becomes stable.  If I use files containing only
> Points/Lines, memory usage becomes stable.

There appear to be 13 "new" calls in shape2ogr.cpp, while exactly 3
"delete" calls to free the allocated memory.  Those are likely to be
the causes of at least some of the memory leaks I'm seeing, although
I didn't delve into the structure of the code too much.

Similar leaks exist in the SDTS polygon code and perhaps other
drivers.

I'll file it in Bugzilla.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From hgrabows at stk.com  Thu Dec 11 14:42:53 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <44AB336C889417448260E477E9D3981028B209@toledo.stk.com>

This is true.  I was just hoping that one of the two watches had
documentation of validation against the Naval Observatory's Atomic
Clock, so to speak.  Being as I don't if either of these have been
rigorously validated against an industry baseline, if one exists, I'll
take your advice and throw a third watch into the mix.  Thanks!

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 1:55 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


Hank -

As the saying goes, the man with two watches never knows what time it
is!  It might be worth testing the conversion on a third source, such as
the "Geodetic Tool Kit" tools from NGS at http://www.ngs.noaa.gov/TOOLS
just to see whether they agree with your PROJ output or with your ESRI
output (or neither <g>).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 1:45 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Datum shift accuracy


Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From Doug_Newcomb at fws.gov  Thu Dec 11 15:09:06 2003
From: Doug_Newcomb at fws.gov (Doug_Newcomb@fws.gov)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <OF10AF0E32.CC30C624-ON85256DF9.006EB26B-85256DF9.006EB299@irm.r9.fws.gov>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031211/e160950d/attachment.html
From ed at topozone.com  Thu Dec 11 15:18:37 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C0793@mercator.topozone.com>

Hank -

Given your setup problems, I'm slightly concerned that there may be some residual problem.  I think that's unlikely - I'd expect a complete failure, not a slightly inaccurate result - but this also may be a usage problem.

In my experience I have compared UTM PROJ results with the online NOAA tools and found them to agree to better than a millimeter.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 2:43 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


This is true.  I was just hoping that one of the two watches had
documentation of validation against the Naval Observatory's Atomic
Clock, so to speak.  Being as I don't if either of these have been
rigorously validated against an industry baseline, if one exists, I'll
take your advice and throw a third watch into the mix.  Thanks!

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 1:55 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


Hank -

As the saying goes, the man with two watches never knows what time it
is!  It might be worth testing the conversion on a third source, such as
the "Geodetic Tool Kit" tools from NGS at http://www.ngs.noaa.gov/TOOLS
just to see whether they agree with your PROJ output or with your ESRI
output (or neither <g>).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 1:45 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Datum shift accuracy


Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Thu Dec 11 15:38:34 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR
Message-ID: <44AB336C889417448260E477E9D398100384DF@toledo.stk.com>

I followed your advise to compare to the USGS tool.  The conversion
results are listed below.  As we can see, the ESRI and USGS tools match
identically (to the precision of ESRI which was lower than the USGS
solution).  There is a convergence parameter from the USGS calculation
which is significantly larger than the error between OGR and ESRI/USGS.
Being a novice at this reprojection business, I don't know if that is
the bounds of the accuracy of the solution.  I would tend to believe not
however, since a 40 minute minimum accuracy would be a multi-kilometer
error in position.  On a hunch I looked at the two definitions used for
WGS84 by both OGR and ESRI, and their coefficients match to reported
accuracy.  I'll continue investigating this issue if no one has any
ideas what could be causing it.

UTM X	597196.62	Meters		
UTM Y	4116325.5	Meters		
				
Product	Lat			Lon			Convergence
Scale
		DD MM SS.sssss 	DDD MM SS.sssss 	DD MM SS.ss
Unitless
USGS		37 11 24.57282 	085 54 17.71610 	0 39 43.15
9.99716E-001
ESRI		37 11 24.57 	085 54 17.72		
OGR		37 11 24.76	      085 54 17.62		

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 1:55 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


Hank -

As the saying goes, the man with two watches never knows what time it
is!  It might be worth testing the conversion on a third source, such as
the "Geodetic Tool Kit" tools from NGS at http://www.ngs.noaa.gov/TOOLS
just to see whether they agree with your PROJ output or with your ESRI
output (or neither <g>).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 1:45 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Datum shift accuracy


Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Thu Dec 11 15:59:14 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid
Message-ID: <44AB336C889417448260E477E9D398100384E0@toledo.stk.com>

There is a small discrepancy in the spheroid parameters for the Clark
1866 spheroid between ESRI/USGS and OGR.  Does anyone have a link to a
government standards site, like the USGS or USNO, that maintains these
constants?  Here are the sets of constants for the two programs from
their respective generated projection (.prj) files:

OGR:
  Spheroid: Clarke 1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799999999800000000
    Inverse Flattening: 294.978698213897990000


ESRI:
  Spheroid: Clarke_1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799998980900000000
    Inverse Flattening: 294.978698200000000000

From ed at topozone.com  Thu Dec 11 16:21:47 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C0797@mercator.topozone.com>

Hank -

These appear to be in the range of binary floating-point storage precision limits.  According to Snyder's Map Projections (USGS Bulletin 1395) the Clarke 1866 ellipsoid is:

Semimajor axis:	6378206.4
Semiminor axis:	6356583.8
Inverse flattening: 294.98

where the two axes are listed as "exact values" and the third is computed (my desktop calculator gives 294.97869821390582...)

Since the axes are supposed to be exact at one decimal place, it appears that the OGR values are more accurate than the ESRI ones.  In each case the inverse flattening seems to be correctly computed as the inverse of 1 - (semiminor/semimajor).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 3:59 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid


There is a small discrepancy in the spheroid parameters for the Clark
1866 spheroid between ESRI/USGS and OGR.  Does anyone have a link to a
government standards site, like the USGS or USNO, that maintains these
constants?  Here are the sets of constants for the two programs from
their respective generated projection (.prj) files:

OGR:
  Spheroid: Clarke 1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799999999800000000
    Inverse Flattening: 294.978698213897990000


ESRI:
  Spheroid: Clarke_1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799998980900000000
    Inverse Flattening: 294.978698200000000000
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Thu Dec 11 16:27:20 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Datum shift accuracy
Message-ID: <44AB336C889417448260E477E9D398100384E1@toledo.stk.com>

I'm assuming it's just a configuration problem as well.  However it is
related to the datum shifting.  Doing an Albers->WGS84 reprojection
produces identical results with ESRI.  For what it's worth, doing
NAD27->WGS84->NAD27 in OGR gives me back the same shape, but I'm not
surprised at the internal consistency from that case.  The shift from a
base WGS84 to the NAD27 based projection produces a similar though
backwards shift.

My data files are the exact set in the proj446_win32_bin.zip, with the
.lla files all having been run through that nad converter that was
suggested earlier to create binary equivalents.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 3:19 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


Hank -

Given your setup problems, I'm slightly concerned that there may be some
residual problem.  I think that's unlikely - I'd expect a complete
failure, not a slightly inaccurate result - but this also may be a usage
problem.

In my experience I have compared UTM PROJ results with the online NOAA
tools and found them to agree to better than a millimeter.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 2:43 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


This is true.  I was just hoping that one of the two watches had
documentation of validation against the Naval Observatory's Atomic
Clock, so to speak.  Being as I don't if either of these have been
rigorously validated against an industry baseline, if one exists, I'll
take your advice and throw a third watch into the mix.  Thanks!

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 1:55 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] Datum shift accuracy


Hank -

As the saying goes, the man with two watches never knows what time it
is!  It might be worth testing the conversion on a third source, such as
the "Geodetic Tool Kit" tools from NGS at http://www.ngs.noaa.gov/TOOLS
just to see whether they agree with your PROJ output or with your ESRI
output (or neither <g>).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 1:45 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Datum shift accuracy


Hello again,

I want to thank everyone for their help getting the datum shifting
working again.  Converting the tables to binary form fixed the problem.
Now that I'm getting conversions however a second question has arisen.
What kind of precision should I expect in these conversions between
OGR/Proj.4 and ESRI ArcGIS?  

When converting Albers projections to WGS84 projections in both products
I get identical results.  However when I convert this NAD 1927 UTM Zone
16N data to WGS84 I get discrepancies.  There is a five to seven meter
difference, mostly in the North-South axis, between the OGR conversion
(using the ogr2ogr command) and the ESRI conversion.  Is this to be
expected?  My dataset is "roads.shp" from the the fourth exercise for
3DAnalyst in ArcTutor.  It is a city in the road data for a town in the
middle of Kentucky.  For this sort of conversion, is 6-7 meter precision
considered good or poor?  I would think it is poor, but I wanted to
defer to those with more experience with this sort of computation.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Thu Dec 11 17:01:54 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid
Message-ID: <44AB336C889417448260E477E9D3981028B20D@toledo.stk.com>

Both OGR and ESRI are using the exact same semi-major axis parameter,
with an extra 4e-10 meters.  Both round to the same one-digit semi-minor
axis.  I didn't believe that these numbers were significant enough to
produce a multi-meter error, however I'm just reporting what I'm finding
along my investigative process.

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Thursday, December 11, 2003 4:22 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid


Hank -

These appear to be in the range of binary floating-point storage
precision limits.  According to Snyder's Map Projections (USGS Bulletin
1395) the Clarke 1866 ellipsoid is:

Semimajor axis:	6378206.4
Semiminor axis:	6356583.8
Inverse flattening: 294.98

where the two axes are listed as "exact values" and the third is
computed (my desktop calculator gives 294.97869821390582...)

Since the axes are supposed to be exact at one decimal place, it appears
that the OGR values are more accurate than the ESRI ones.  In each case
the inverse flattening seems to be correctly computed as the inverse of
1 - (semiminor/semimajor).

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Thursday, December 11, 2003 3:59 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid


There is a small discrepancy in the spheroid parameters for the Clark
1866 spheroid between ESRI/USGS and OGR.  Does anyone have a link to a
government standards site, like the USGS or USNO, that maintains these
constants?  Here are the sets of constants for the two programs from
their respective generated projection (.prj) files:

OGR:
  Spheroid: Clarke 1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799999999800000000
    Inverse Flattening: 294.978698213897990000


ESRI:
  Spheroid: Clarke_1866
    Semimajor Axis: 6378206.400000000400000000
    Semiminor Axis: 6356583.799998980900000000
    Inverse Flattening: 294.978698200000000000
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Thu Dec 11 14:11:40 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com> <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
Message-ID: <3FD8C16C.5030001@pobox.com>

Curt Mills, WE7U wrote:
> My code is currently reading Shapefile maps via OGR.  If I disable
> the feature loop, memory appears relatively stable.
> 
> Enabling the feature loop, I'm losing megabytes every time I read
> in Shapefiles.  I disabled the majority of the "feature" loop via
> #ifdef's, and am just running this now:
> 
> 
>   while ( (featureH = OGR_L_GetNextFeature( layer )) != NULL ) {
>       if (featureH)
>           OGR_F_Destroy( featureH );
>   }
> 
> 
> It's still losing megabytes every time I load a map.  Using CVS
> GDAL/OGR and of course the 'C' API.
> 
> Is OGR_F_Destroy() not free'ing all the memory used?
> 
> I register all drivers when I start my app (a long-running app by
> the way), and leave them alone after that.  Is there something that
> I should Destory/Free regarding the drivers?
> 
> I'm not free'ing the layers either, but it appears from your 'C'
> sample program that I should not.  There doesn't appear to be a big
> problem in the layers anyway.

Curt,

I ran "ogrinfo -ro -al polygon.shp" through valgrind, and it reports only
316 bytes of memory leaked.  Is there anything unusual about the file
in question?  Are you working from recent source?  I don't know why there
would be a problem.  You are destroying the datasource when you are done,
right?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Thu Dec 11 14:20:26 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
References: <3FD89BF6.3090106@atlantis-scientific.com> <3FD89F62.7020006@pobox.com> <Pine.LNX.4.53.0312110849290.28330@wapiti.tc.fluke.com>
Message-ID: <3FD8C37A.4020600@pobox.com>

Curt Mills, WE7U wrote:
> My code is currently reading Shapefile maps via OGR.  If I disable
> the feature loop, memory appears relatively stable.
> 
> Enabling the feature loop, I'm losing megabytes every time I read
> in Shapefiles.  I disabled the majority of the "feature" loop via
> #ifdef's, and am just running this now:

Curt,

I tested on a bunch of other files, and discovered that a bunch of new
contributed code related to recognising multipolygons properly was leaking
geometry objects quite seriously.  I have committed a fix to the
gdal/ogr/ogrsf_frmts/shape/shape2ogr.cpp file that corrects this.  I imagine
this was what was causing you problems.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Thu Dec 11 16:32:25 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR vs. ESRI Clarke 1866 Spheroid
In-Reply-To: <44AB336C889417448260E477E9D398100384E0@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384E0@toledo.stk.com>
Message-ID: <3FD8E269.4000903@pobox.com>

Grabowski, Hank wrote:
> There is a small discrepancy in the spheroid parameters for the Clark
> 1866 spheroid between ESRI/USGS and OGR.  Does anyone have a link to a
> government standards site, like the USGS or USNO, that maintains these
> constants?  Here are the sets of constants for the two programs from
> their respective generated projection (.prj) files:
> 
> OGR:
>   Spheroid: Clarke 1866
>     Semimajor Axis: 6378206.400000000400000000
>     Semiminor Axis: 6356583.799999999800000000
>     Inverse Flattening: 294.978698213897990000
> 
> 
> ESRI:
>   Spheroid: Clarke_1866
>     Semimajor Axis: 6378206.400000000400000000
>     Semiminor Axis: 6356583.799998980900000000
>     Inverse Flattening: 294.978698200000000000
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev

Hank,

 From the EPSG definitions I see the following:

7008,Clarke 1866,6378206.4,9001,,6356583.8,1,Original definition a=20926062 and b=20855121 (British) feet. Uses Clarke's 
1865 inch-metre ratio of 39.370432 to obtain metres. (Metric value then converted to US survey feet for use in the 
United States using 39.37 exactly giving a=20925832.16 ft US).,US Army Map Service Technical Manual No. 7; 
1943.,EPSG,1995-06-02 00:00:00,98.34,0

OGR computes the inverse flattening from the semimajor and semiminor
axis.  I would have to assume that ESRI uses a deliberately truncated
value for inverse flattening to discard "noise" digits beyond the real
precision of the value.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From Rich at GreenwoodMap.com  Thu Dec 11 19:10:34 2003
From: Rich at GreenwoodMap.com (Richard Greenwood)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR
In-Reply-To: <44AB336C889417448260E477E9D398100384DF@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384DF@toledo.stk.com>
Message-ID: <6.0.0.22.0.20031211164502.02671480@mail.GreenwoodMap.com>


At 01:38 PM 12/11/2003, you wrote:
>I followed your advise to compare to the USGS tool.  The conversion
>results are listed below.  As we can see, the ESRI and USGS tools match
>identically (to the precision of ESRI which was lower than the USGS
>solution).  There is a convergence parameter from the USGS calculation
>which is significantly larger than the error between OGR and ESRI/USGS.
>Being a novice at this reprojection business, I don't know if that is
>the bounds of the accuracy of the solution.  I would tend to believe not
>however, since a 40 minute minimum accuracy would be a multi-kilometer
>error in position.  On a hunch I looked at the two definitions used for
>WGS84 by both OGR and ESRI, and their coefficients match to reported
>accuracy.  I'll continue investigating this issue if no one has any
>ideas what could be causing it.
>
>UTM X   597196.62       Meters
>UTM Y   4116325.5       Meters
>
>Product Lat                     Lon                     Convergence
>Scale
>                 DD MM SS.sssss  DDD MM SS.sssss         DD MM SS.ss
>Unitless
>USGS            37 11 24.57282  085 54 17.71610         0 39 43.15
>9.99716E-001
>ESRI            37 11 24.57     085 54 17.72
>OGR             37 11 24.76           085 54 17.62
>
>Hank Grabowski
>hgrabowski@stk.com
>1-610-578-1000

The convergence angle is not an indication of error, it is the angular 
difference between true (geodetic) north and grid north at a given point in 
a projected coordinate system. Similarly, the scale is the ratio of the 
difference between grid and ellipsoidal (sea level) lengths at a give point 
within a projection.

WGS84 and NAD27 are datums, while Albers is a projection. Converting 
between projections is rigorous i.e. a single formula can be applied at any 
location in a projection to convert it between projections. Conversions 
between datums are approximate. Conversions between datums are usually done 
by interpolation. The datum shift will be different at different places on 
the earth. So it is important that you do not attempt datum conversions 
outside of the area of the datum (NAD27 is a localized datum, NAD83 and 
WGS84 are not). Are your longitudes above west? And if so, shouldn't they 
be negative?

Corpscon (which is based on Nadcon) is a widely accepted standard for 
projection and datum conversion and can be freely downloaded at: 
http://crunch.tec.army.mil/software/corpscon/corpscon.html



Richard W. Greenwood, PLS
Greenwood Mapping, Inc.
Rich <at> GreenwoodMap <dot> com
(307) 733-0203
http://www.GreenwoodMap.com 


From archer at eskimo.com  Thu Dec 11 20:31:41 2003
From: archer at eskimo.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <3FD8C16C.5030001@pobox.com>
Message-ID: <Pine.LNX.4.04.10312111729520.13764-100000@gatekeeper.we7u.net>

On Thu, 11 Dec 2003, Frank Warmerdam wrote:

> I ran "ogrinfo -ro -al polygon.shp" through valgrind, and it reports only
> 316 bytes of memory leaked.  Is there anything unusual about the file
> in question?  Are you working from recent source?  I don't know why there
> would be a problem.  You are destroying the datasource when you are done,
> right?

Yes.  I started with your example C program, and filled things in
from there.  We have the capability of running through a lot of files
at once, displaying them all.  We finish each one before starting on
the next.  We're multi-threaded, but not in the map reading/display
portion of our program.  The datasources get closed and all objects
that I can figure out that we malloc'ed, get free'd when we're done.

-- 
Curt, WE7U.				archer@eskimo.com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From archer at eskimo.com  Thu Dec 11 20:32:42 2003
From: archer at eskimo.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Forgetting to Destroy?
In-Reply-To: <3FD8C37A.4020600@pobox.com>
Message-ID: <Pine.LNX.4.04.10312111732110.13764-100000@gatekeeper.we7u.net>

On Thu, 11 Dec 2003, Frank Warmerdam wrote:

> I tested on a bunch of other files, and discovered that a bunch of new
> contributed code related to recognising multipolygons properly was leaking
> geometry objects quite seriously.  I have committed a fix to the
> gdal/ogr/ogrsf_frmts/shape/shape2ogr.cpp file that corrects this.  I imagine
> this was what was causing you problems.

Sure sounds like it!  Thanks for the quick service.  Hopefully we
won't be needing any more for a while.  ;-)

-- 
Curt, WE7U.				archer@eskimo.com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From hgrabows at stk.com  Fri Dec 12 08:44:24 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR
Message-ID: <44AB336C889417448260E477E9D398100384E2@toledo.stk.com>

I'm pulling the value for X and Y directly off of the ArcMap measuring
tool.  I zoomed into a point on a map that was drawn in the native
coordinate system of the shapefile (so there is no conversion) and then
entered those values into the website tool as you saw them.  To find the
WGS84 values I created a layer with the WGS84 coordinate system and then
added the data that had been converted by OGR into WGS84 and allowed
ESRI to auto-convert the data from the native shape file.  Again using
the measuring tool I got the exact measurement of the given point.  The
difference is quite visible without going into that much detail, but I
wanted to get quantitative differences to help diagnose the problem.  I
can try the same computation with the link you gave me in a previous
e-mail and move see what happens.  If you guys want I could post the
data, it's very small, on an FTP site for you guys to try and duplicate
the problem I'm seeing.  

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Richard Greenwood [mailto:Rich@greenwoodmap.com] 
Sent: Thursday, December 11, 2003 7:11 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] USGS vs. ESRI vs. OGR




At 01:38 PM 12/11/2003, you wrote:
>I followed your advise to compare to the USGS tool.  The conversion 
>results are listed below.  As we can see, the ESRI and USGS tools match

>identically (to the precision of ESRI which was lower than the USGS 
>solution).  There is a convergence parameter from the USGS calculation 
>which is significantly larger than the error between OGR and ESRI/USGS.

>Being a novice at this reprojection business, I don't know if that is 
>the bounds of the accuracy of the solution.  I would tend to believe 
>not however, since a 40 minute minimum accuracy would be a 
>multi-kilometer error in position.  On a hunch I looked at the two 
>definitions used for WGS84 by both OGR and ESRI, and their coefficients

>match to reported accuracy.  I'll continue investigating this issue if 
>no one has any ideas what could be causing it.
>
>UTM X   597196.62       Meters
>UTM Y   4116325.5       Meters
>
>Product Lat                     Lon                     Convergence
>Scale
>                 DD MM SS.sssss  DDD MM SS.sssss         DD MM SS.ss
>Unitless
>USGS            37 11 24.57282  085 54 17.71610         0 39 43.15
>9.99716E-001
>ESRI            37 11 24.57     085 54 17.72
>OGR             37 11 24.76           085 54 17.62
>
>Hank Grabowski
>hgrabowski@stk.com
>1-610-578-1000

The convergence angle is not an indication of error, it is the angular 
difference between true (geodetic) north and grid north at a given point
in 
a projected coordinate system. Similarly, the scale is the ratio of the 
difference between grid and ellipsoidal (sea level) lengths at a give
point 
within a projection.

WGS84 and NAD27 are datums, while Albers is a projection. Converting 
between projections is rigorous i.e. a single formula can be applied at
any 
location in a projection to convert it between projections. Conversions 
between datums are approximate. Conversions between datums are usually
done 
by interpolation. The datum shift will be different at different places
on 
the earth. So it is important that you do not attempt datum conversions 
outside of the area of the datum (NAD27 is a localized datum, NAD83 and 
WGS84 are not). Are your longitudes above west? And if so, shouldn't
they 
be negative?

Corpscon (which is based on Nadcon) is a widely accepted standard for 
projection and datum conversion and can be freely downloaded at: 
http://crunch.tec.army.mil/software/corpscon/corpscon.html



Richard W. Greenwood, PLS
Greenwood Mapping, Inc.
Rich <at> GreenwoodMap <dot> com
(307) 733-0203
http://www.GreenwoodMap.com 

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Fri Dec 12 09:02:01 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR vs Corpscon
Message-ID: <44AB336C889417448260E477E9D3981028B211@toledo.stk.com>

Now we are back to square one so to speak.  ESRI and USGS match each
other.  OGR and Corpscon match each other.  I've updated the table
below.  Does NOAA/USGS or NADCON maintain the standards on the
conversions?

Product	Lat			Lon
		DD MM SS.sssss 	DDD MM SS.sssss 
USGS		37 11 24.57282 	085 54 17.71610 
ESRI		37 11 24.57 	085 54 17.72
OGR		37 11 24.76		085 54 17.62
Corpscom	37 11 24.75909	085 54 17.61834

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Richard Greenwood [mailto:Rich@greenwoodmap.com] 
Sent: Thursday, December 11, 2003 7:11 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] USGS vs. ESRI vs. OGR




At 01:38 PM 12/11/2003, you wrote:
>I followed your advise to compare to the USGS tool.  The conversion 
>results are listed below.  As we can see, the ESRI and USGS tools match

>identically (to the precision of ESRI which was lower than the USGS 
>solution).  There is a convergence parameter from the USGS calculation 
>which is significantly larger than the error between OGR and ESRI/USGS.

>Being a novice at this reprojection business, I don't know if that is 
>the bounds of the accuracy of the solution.  I would tend to believe 
>not however, since a 40 minute minimum accuracy would be a 
>multi-kilometer error in position.  On a hunch I looked at the two 
>definitions used for WGS84 by both OGR and ESRI, and their coefficients

>match to reported accuracy.  I'll continue investigating this issue if 
>no one has any ideas what could be causing it.
>
>UTM X   597196.62       Meters
>UTM Y   4116325.5       Meters
>
>Product Lat                     Lon                     Convergence
>Scale
>                 DD MM SS.sssss  DDD MM SS.sssss         DD MM SS.ss
>Unitless
>USGS            37 11 24.57282  085 54 17.71610         0 39 43.15
>9.99716E-001
>ESRI            37 11 24.57     085 54 17.72
>OGR             37 11 24.76           085 54 17.62
>
>Hank Grabowski
>hgrabowski@stk.com
>1-610-578-1000

The convergence angle is not an indication of error, it is the angular 
difference between true (geodetic) north and grid north at a given point
in 
a projected coordinate system. Similarly, the scale is the ratio of the 
difference between grid and ellipsoidal (sea level) lengths at a give
point 
within a projection.

WGS84 and NAD27 are datums, while Albers is a projection. Converting 
between projections is rigorous i.e. a single formula can be applied at
any 
location in a projection to convert it between projections. Conversions 
between datums are approximate. Conversions between datums are usually
done 
by interpolation. The datum shift will be different at different places
on 
the earth. So it is important that you do not attempt datum conversions 
outside of the area of the datum (NAD27 is a localized datum, NAD83 and 
WGS84 are not). Are your longitudes above west? And if so, shouldn't
they 
be negative?

Corpscon (which is based on Nadcon) is a widely accepted standard for 
projection and datum conversion and can be freely downloaded at: 
http://crunch.tec.army.mil/software/corpscon/corpscon.html



Richard W. Greenwood, PLS
Greenwood Mapping, Inc.
Rich <at> GreenwoodMap <dot> com
(307) 733-0203
http://www.GreenwoodMap.com 

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Dec 12 09:18:49 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR
In-Reply-To: <44AB336C889417448260E477E9D398100384DF@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384DF@toledo.stk.com>
Message-ID: <3FD9CE49.3010204@pobox.com>

Grabowski, Hank wrote:
> I followed your advise to compare to the USGS tool.  The conversion
> results are listed below.  As we can see, the ESRI and USGS tools match
> identically (to the precision of ESRI which was lower than the USGS
> solution).  There is a convergence parameter from the USGS calculation
> which is significantly larger than the error between OGR and ESRI/USGS.
> Being a novice at this reprojection business, I don't know if that is
> the bounds of the accuracy of the solution.  I would tend to believe not
> however, since a 40 minute minimum accuracy would be a multi-kilometer
> error in position.  On a hunch I looked at the two definitions used for
> WGS84 by both OGR and ESRI, and their coefficients match to reported
> accuracy.  I'll continue investigating this issue if no one has any
> ideas what could be causing it.
> 
> UTM X	597196.62	Meters		
> UTM Y	4116325.5	Meters		
> 				
> Product	Lat			Lon			Convergence
> Scale
> 		DD MM SS.sssss 	DDD MM SS.sssss 	DD MM SS.ss
> Unitless
> USGS		37 11 24.57282 	085 54 17.71610 	0 39 43.15
> 9.99716E-001
> ESRI		37 11 24.57 	085 54 17.72		
> OGR		37 11 24.76	085 54 17.62		

Hank,

I am a bit confused.  When I do UTM16 NAD27 to geographic NAD27 I get:

cs2cs +proj=utm +zone=16 +datum=NAD27 +to +proj=latlong +datum=NAD27
597196.62 4116325.5                               (input)
85d54'17.716"W  37d11'24.573"N 0.000              (output)

It would *appear* that your locations for the USGS and ESRI are the NAD27
lat/long location, not the NAD83 location unless the datum shift at the
location is less than 1/100 of a second.

I broke down the conversion into steps from UTM 16 NAD27 to Latlong NAD27,
and then used "nad2nad" explicitly with the conus file just to be sure
that my code for cs2cs wasn't mixing things up, and I get the same final
OGR output coordinates you did.  While the ESRI software uses a somewhat
different grid shift file than ESRI, I believe that the PROJ/OGR software
is doing the right thing given the values in the conus file.

In summary, I question whether your USGS/ESRI numbers really represent
applying a datum shift at all.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From hgrabows at stk.com  Fri Dec 12 09:22:24 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] Also against NIMA/US Army
Message-ID: <44AB336C889417448260E477E9D3981028B212@toledo.stk.com>

I found another tool off of the Capscon site.  Apparently the tool
doesn't convert to WGS84 but only to NAD83, which they say is "close
enough for most uses."  However they recommended a tool called GEOTRANS.
This tool is supposedly put out by the US Army Topographic Engineering
Center Geospatial Information Division and the NIMA Exploitation Tools
Division.  The results are below.  I used the same data points as I
listed previously for the Easting/Northing values.  I chose the NAD 27
UTM zone 16 baseline going to the WGS84 Geodetic output.  The values
don't match any of the four previous tools for latitude, but seems to
agree more with the OGR/Corpscon results.  


Product	Lat			Lon
		DD MM SS.sssss 	DDD MM SS.sssss 
USGS		37 11 24.57282 	085 54 17.71610 
ESRI		37 11 24.57 	085 54 17.72
OGR		37 11 24.76		085 54 17.62
Corpscon	37 11 24.75909	085 54 17.61834
GeoTrans	37 11 24.9344	085 54 17.6040

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Curt Mills, WE7U [mailto:archer@eskimo.com] 
Sent: Thursday, December 11, 2003 8:32 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] Forgetting to Destroy?


On Thu, 11 Dec 2003, Frank Warmerdam wrote:

> I ran "ogrinfo -ro -al polygon.shp" through valgrind, and it reports 
> only 316 bytes of memory leaked.  Is there anything unusual about the 
> file in question?  Are you working from recent source?  I don't know 
> why there would be a problem.  You are destroying the datasource when 
> you are done, right?

Yes.  I started with your example C program, and filled things in from
there.  We have the capability of running through a lot of files at
once, displaying them all.  We finish each one before starting on the
next.  We're multi-threaded, but not in the map reading/display portion
of our program.  The datasources get closed and all objects that I can
figure out that we malloc'ed, get free'd when we're done.

-- 
Curt, WE7U.				archer@eskimo.com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From hgrabows at stk.com  Fri Dec 12 09:42:32 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
Message-ID: <44AB336C889417448260E477E9D3981028B213@toledo.stk.com>

The problem as I've determined is that my "NAD27->WGS84" conversion is
really just doing a "NAD27->NAD83" conversion.  The NAD27->NAD83
conversion in ESRI identically matches the conversion I'm attempting in
OGR.  Is there something wrong with the syntax of my command for the
conversion to WGS84?  

ogr2ogr -t_srs WGS84 out.shp roads.shp

My program's internal conversion to WGS84 has the exact same difference,
so I figure once I determine how to get the conversion working in
ogr2ogr I should be able to map it over to my internal code as well.  Is
it such that NAD83 is the best I can do with OGR? If that's the case
that's fine.  I just need to make that fact known to our users.

Thanks for the help guys, you've all been very responsive.
Hank

From warmerdam at pobox.com  Fri Dec 12 09:51:04 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
In-Reply-To: <44AB336C889417448260E477E9D3981028B213@toledo.stk.com>
References: <44AB336C889417448260E477E9D3981028B213@toledo.stk.com>
Message-ID: <3FD9D5D8.107@pobox.com>

Grabowski, Hank wrote:
> The problem as I've determined is that my "NAD27->WGS84" conversion is
> really just doing a "NAD27->NAD83" conversion.  The NAD27->NAD83
> conversion in ESRI identically matches the conversion I'm attempting in
> OGR.  Is there something wrong with the syntax of my command for the
> conversion to WGS84?  
> 
> ogr2ogr -t_srs WGS84 out.shp roads.shp
> 
> My program's internal conversion to WGS84 has the exact same difference,
> so I figure once I determine how to get the conversion working in
> ogr2ogr I should be able to map it over to my internal code as well.  Is
> it such that NAD83 is the best I can do with OGR? If that's the case
> that's fine.  I just need to make that fact known to our users.

Hank,

There is nothing wrong with your OGR syntax, but (as with geotrans) OGR
assumes that WGS84 and NAD83 are essentially the same which they are at
the precisions you are working at.  What I don't understand is what the
ESRI and USGS software packages are doing.  It seems that since they
don't have a grid shift from NAD27 to WGS84 they are just doing no
datum shift and going on blissfully.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From nhv at cape.com  Fri Dec 12 10:00:00 2003
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
In-Reply-To: <44AB336C889417448260E477E9D3981028B213@toledo.stk.com>
Message-ID: <EKEJIKAILPONGGENMBGAAEAOFMAA.nhv@cape.com>

Grabowski, Hank writes:
>  
> My program's internal conversion to WGS84 has the exact same difference,
> so I figure once I determine how to get the conversion working in
> ogr2ogr I should be able to map it over to my internal code as well.  Is
> it such that NAD83 is the best I can do with OGR? If that's the case
> that's fine.  I just need to make that fact known to our users.

Set up a custom Datum conversion to go from your internal code
to the outside world.

I believe all you need to do this will be the semi-major and sem-minor
axis.

As others have pointed out there are minor discrepancies between
these between the various conversion systems you have been discussing.

FWIW - I use this for WGS84
http://earth-info.nima.mil/GandG/tr8350_2.html

HTH

Norman



From ed at topozone.com  Fri Dec 12 09:57:41 2003
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
Message-ID: <13858AA1A74F30419F319ACB66A9D1222C079C@mercator.topozone.com>

Hank -

I'll look into this a bit, but for the location and precisions you're talking about, the NAD27->WGS84 conversion IS the NAD27->NAD83 conversion.  The difference between the two should be invisible or at best microscopic - nowhere near the delta you're seeing.  I'm inclined to agree with Frank here, and you may just be grouping tools into those that are doing the datum shift and those that are not.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Friday, December 12, 2003 9:43 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] NAD83 vs. WGS84


The problem as I've determined is that my "NAD27->WGS84" conversion is
really just doing a "NAD27->NAD83" conversion.  The NAD27->NAD83
conversion in ESRI identically matches the conversion I'm attempting in
OGR.  Is there something wrong with the syntax of my command for the
conversion to WGS84?  

ogr2ogr -t_srs WGS84 out.shp roads.shp

My program's internal conversion to WGS84 has the exact same difference,
so I figure once I determine how to get the conversion working in
ogr2ogr I should be able to map it over to my internal code as well.  Is
it such that NAD83 is the best I can do with OGR? If that's the case
that's fine.  I just need to make that fact known to our users.

Thanks for the help guys, you've all been very responsive.
Hank
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From tbeckman at usgs.gov  Fri Dec 12 10:02:43 2003
From: tbeckman at usgs.gov (Tim Beckmann)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR
Message-ID: <OFF963D051.6293BDE0-ON86256DFA.0051F014@cr.usgs.gov>

As one more data point, I used some of our internal software to convert 
UTM, zone 16, NAD27 to Geographic, WGS84 and received the same results as 
OGR.  The software is based on GCTP and our own datum layer.

--------------------------------------------------------------------------
Tim Beckmann               tbeckman@usgs.gov
Software Project Lead
SAIC
EROS Data Center, Sioux Falls, SD 57198
605-594-2521    Phone
605-594-6940    Fax





Frank Warmerdam <warmerdam@pobox.com>
Sent by: gdal-dev-admin@remotesensing.org
12/12/2003 08:18 AM
Please respond to gdal-dev

 
        To:     gdal-dev@remotesensing.org
        cc: 
        Subject:        Re: [Gdal-dev] USGS vs. ESRI vs. OGR


Grabowski, Hank wrote:
> I followed your advise to compare to the USGS tool.  The conversion
> results are listed below.  As we can see, the ESRI and USGS tools match
> identically (to the precision of ESRI which was lower than the USGS
> solution).  There is a convergence parameter from the USGS calculation
> which is significantly larger than the error between OGR and ESRI/USGS.
> Being a novice at this reprojection business, I don't know if that is
> the bounds of the accuracy of the solution.  I would tend to believe not
> however, since a 40 minute minimum accuracy would be a multi-kilometer
> error in position.  On a hunch I looked at the two definitions used for
> WGS84 by both OGR and ESRI, and their coefficients match to reported
> accuracy.  I'll continue investigating this issue if no one has any
> ideas what could be causing it.
> 
> UTM X          597196.62               Meters 
> UTM Y          4116325.5               Meters 
> 
> Product                Lat Lon  Convergence
> Scale
>                                DD MM SS.sssss                  DDD MM 
SS.sssss                 DD MM SS.ss
> Unitless
> USGS                           37 11 24.57282                  085 54 
17.71610                 0 39 43.15
> 9.99716E-001
> ESRI                           37 11 24.57             085 54 17.72   
> OGR                            37 11 24.76             085 54 17.62   

Hank,

I am a bit confused.  When I do UTM16 NAD27 to geographic NAD27 I get:

cs2cs +proj=utm +zone=16 +datum=NAD27 +to +proj=latlong +datum=NAD27
597196.62 4116325.5                               (input)
85d54'17.716"W  37d11'24.573"N 0.000              (output)

It would *appear* that your locations for the USGS and ESRI are the NAD27
lat/long location, not the NAD83 location unless the datum shift at the
location is less than 1/100 of a second.

I broke down the conversion into steps from UTM 16 NAD27 to Latlong NAD27,
and then used "nad2nad" explicitly with the conus file just to be sure
that my code for cs2cs wasn't mixing things up, and I get the same final
OGR output coordinates you did.  While the ESRI software uses a somewhat
different grid shift file than ESRI, I believe that the PROJ/OGR software
is doing the right thing given the values in the conus file.

In summary, I question whether your USGS/ESRI numbers really represent
applying a datum shift at all.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031212/91c1f4dd/attachment.html
From Rich at GreenwoodMap.com  Fri Dec 12 10:07:57 2003
From: Rich at GreenwoodMap.com (Richard Greenwood)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] USGS vs. ESRI vs. OGR vs Corpscon
In-Reply-To: <44AB336C889417448260E477E9D3981028B211@toledo.stk.com>
References: <44AB336C889417448260E477E9D3981028B211@toledo.stk.com>
Message-ID: <6.0.0.22.0.20031212075925.02507cc0@mail.GreenwoodMap.com>

At 07:02 AM 12/12/2003, you wrote:

>Now we are back to square one so to speak.  ESRI and USGS match each
>other.  OGR and Corpscon match each other.  I've updated the table
>below.  Does NOAA/USGS or NADCON maintain the standards on the
>conversions?
>
>Product Lat                     Lon
>                 DD MM SS.sssss  DDD MM SS.sssss
>USGS            37 11 24.57282  085 54 17.71610
>ESRI            37 11 24.57     085 54 17.72
>OGR             37 11 24.76             085 54 17.62
>Corpscom        37 11 24.75909  085 54 17.61834

I think Frank got it figured out - your USGS and ESRI conversions are not 
applying a datum shift. Simply converting your above lat lons from NAD27 to 
NAD83 produced exactly the same deltas as the deltas between USGS/ESRI and 
OGR/Corpson. So check your syntax in USGS/ESRI (neither are products that I 
am familiar with, although the ArcView 3.? implementation of their 
coordinate conversion tool made this type of error very easy to make). The 
datum shift in meters for your position should be Y=5.742, X=2.411

If you are seeing a difference between NAD83 and WGS84 something is 
definitely wrong. I would guess you are comparing NAD83/WGS84 to HPGN. What 
is the magnitude of the error?

Rich


Richard W. Greenwood, PLS
Greenwood Mapping, Inc.
Rich <at> GreenwoodMap <dot> com
(307) 733-0203
http://www.GreenwoodMap.com 
From hgrabows at stk.com  Fri Dec 12 10:08:28 2003
From: hgrabows at stk.com (Grabowski, Hank)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
Message-ID: <44AB336C889417448260E477E9D398100384E4@toledo.stk.com>

I would find it to be an aggregious error that the ESRI code, which is
used in a signficant number of GIS installations, is not doing the datum
shift.  I'm going to call their tech support department in the next
hour, once they open, to determine if the software isn't performing the
task that they say it is performing.  If I look at the layer's active
coordinate conversions when I have a WGS84 based layer and I import the
NAD27 UTM data I see one coversion called NAD_1927_To_WGS_1984_1.  Doing
the same thing with a NAD83 layer produces a conversion called
NAD_1927_To_NAD_1983_NADCON.  The NAD27->NAD83 method is NADCON.  The
NAD27->WGS84 method is a Geocentric Translation method.  Having never
coded up a conversion method myself, I don't know if that is the
standard mechanism of conversion between those two datums.  

Hank Grabowski
hgrabowski@stk.com
1-610-578-1000
------------------------------------------------------------------------
----------
Experience the analysis and visualization power of STK 5.0 by upgrading
today! Order your free copy at http://www.stk.com to get started!



-----Original Message-----
From: Ed McNierney [mailto:ed@topozone.com] 
Sent: Friday, December 12, 2003 9:58 AM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] NAD83 vs. WGS84


Hank -

I'll look into this a bit, but for the location and precisions you're
talking about, the NAD27->WGS84 conversion IS the NAD27->NAD83
conversion.  The difference between the two should be invisible or at
best microscopic - nowhere near the delta you're seeing.  I'm inclined
to agree with Frank here, and you may just be grouping tools into those
that are doing the datum shift and those that are not.

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242 

-----Original Message-----
From: Grabowski, Hank [mailto:hgrabows@stk.com]
Sent: Friday, December 12, 2003 9:43 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] NAD83 vs. WGS84


The problem as I've determined is that my "NAD27->WGS84" conversion is
really just doing a "NAD27->NAD83" conversion.  The NAD27->NAD83
conversion in ESRI identically matches the conversion I'm attempting in
OGR.  Is there something wrong with the syntax of my command for the
conversion to WGS84?  

ogr2ogr -t_srs WGS84 out.shp roads.shp

My program's internal conversion to WGS84 has the exact same difference,
so I figure once I determine how to get the conversion working in
ogr2ogr I should be able to map it over to my internal code as well.  Is
it such that NAD83 is the best I can do with OGR? If that's the case
that's fine.  I just need to make that fact known to our users.

Thanks for the help guys, you've all been very responsive.
Hank
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From jgallagher at gso.uri.edu  Fri Dec 12 14:06:24 2003
From: jgallagher at gso.uri.edu (James Gallagher)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] A questions about IRasterIO and overlays
In-Reply-To: <3FD6124C.5080808@pobox.com>
References: <1070313712.2887.91.camel@comet.dods.org>
	 <3FD6124C.5080808@pobox.com>
Message-ID: <1071255984.2046.40.camel@comet.dods.org>

On Tue, 2003-12-09 at 11:19, gdal-dev-admin@remotesensing.org wrote:
> James Gallagher wrote:
> > I'm improving a GDAL driver for the DODS/OPeNDAP protocol. The driver
> > can read rasters from DODS/OPeNDAP servers. One problem with the current
> > implementation is that it always reads the entire raster. 
> > 
> > Before I dive into IRasterIO() I'd like to make sure providing my own
> > implementation of that method is really the best way to go. OPeNDAP
> > provides ways to read parts of rasters using the indexes combined with
> > an optional 'stride' value (which allows for sub-sampling).
> > 
> > I was also wondering about overlays and the comment that a driver that
> > provides its own implementation of IRasterIO() would normally implement
> > overlays. What exactly are 'overlays?'
> > 
> > As you can probably tell, I'm not that familiar with GIS software so my
> > apologies if these are really basic questions.
> 
> James,
> 
> I'm not sure where you read overlays.  I suspect you are referring to
> overviews, is that correct?

Yes. Sorry about that.

>   An overview is a reduced resolution image used
> for faster reads when only a reduced resolution image is needed.
> 
> You can use stride values to simulate overviews.  So, I think it would
> be wise to return synthetic power of 2 overiews for your dataset.  You might
> want to skim the MrSID example for how this can be done.
> 
> However, the deeper problem is how to handle IO requests. Right now I gather
> you read the whole remote dataset on open, and pull it into local memory?

No, but almost. The DAP provides a pretty rich set of sub-sampling
tools. What I do now is read 'metadata' in when the remote data source
is opened. Then I use that to build RasterBand instances. When the drver
is used to get data from a particular RasterBand I read the data. But,
and it's a big but, the DAP lets a client do things like read just a
portion of an array and right now I'm ignoring that. The driver always
reads the entire Array. In many ways reading just part of an Array is an
optimization since most of the data sources in DODS (i.e., accessible
using DAP servers) holds more than one Array. So being able to read just
the Array the client wants instead of the whole data source is a big
win. But, of course, we want the whole enchilada...

> For modest sized datasets that are read by applications a bit at a time this
> is a very good approach.  I would presume there is a non-trivial overhead
> (network latency, etc) to each OPeNDAP request?

Yes, there is, although the middleware library does support client-side
caching.

> If network latency and other request overhead was zero,the idea approach would
> be to satisfy each IRasterIO() request with an OPeNDAP request.  This would
> minimize the amount of memory used in the driver, and ensure only required
> data would be read.  However, there is latency, and for some sorts of requests,
> such as the common case of the application asking for the entire dataset, but
> one scanline at a time, the latency would likely kill you.

Good point about the one-scanline-at-a-time issue. Maybe it's best we
read the entire array at once... 

> On the other hand if you are working with a big dataset, and a client like
> MapServer that might only want a small area or want the dataset at a much
> reduced resolution, then reading the whole thing will kill you.

Yup.

> What I have done in some drivers is have two basic cases:
> 
>   1) Attempt to satisfy each RasterIO() request via a lower level request.
> 
>   2) Treat the dataset as "scanlined organized" for blocksize/caching
>      purposes, but read-ahead lots of scanlines in response to any request
>      that isn't satisfied out of the cache.  Implement this logic in the
>      IReadBlock() method.
> 
> then I basically check the nature of the request in the RasterIO() to
> decide how to handle it.  If the request is fairly large then I stick
> with case (1) otherwise I call the GDALRasterBand::IRasterIO() which will
> eventually call IReadBlock() taking care of any required resampling.
> 
> I hope this helps, though I am proposing some complications. :-)

It does help (although it does pose some complications!). 

Thanks very much,

James
> 
> Best regards,
-- 
__________________________________________________________________________
James Gallagher		         The Distributed Oceanographic Data System
jgallagher@gso.uri.edu               http://unidata.ucar.edu/packages/dods
Voice/Fax: 406.723.8663


From hacker at tc.fluke.com  Fri Dec 12 18:01:45 2003
From: hacker at tc.fluke.com (Curt Mills)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR Questions
Message-ID: <Pine.LNX.4.53.0312121453410.28330@wapiti.tc.fluke.com>

1) Can the coordinate system change per layer in a vector file?  If
not, shouldn't the call to get the spatial reference be based on the
datasource instead of the layer?

2) Shapefile "hole" polygons:  Are there other OGR formats that do
something similar?  Should I check whether the datasource is a
shapefile and implement "hole" polygons only for them?

3) Is there a standard anywhere for how to specify drawing
preferences across GIS systems?  I'm talking about things like
enabling/disabling layers, deciding which field is the label for the
object, colors, layer stackup, line widths, polygon fill or outline,
etc.  The sorts of things that might be written to a file that
accompanies a dataset, or perhaps covers a directory heirarchy of
GIS files.

4) Getting the number of points in a feature:  Is that always an
"inexpensive" operation?  If it can be "expensive", is there a way
to gain the entire set of vectors instead that would be faster?  I
saw nothing in ogr_api.h about it.

Again, I'm using the C API to OGR.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From matt.wilkie at gov.yk.ca  Fri Dec 12 19:48:32 2003
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
In-Reply-To: <44AB336C889417448260E477E9D398100384E4@toledo.stk.com>
References: <44AB336C889417448260E477E9D398100384E4@toledo.stk.com>
Message-ID: <3FDA61E0.3030507@gov.yk.ca>

Grabowski, Hank wrote:

> I would find it to be an aggregious error that the ESRI code, which is
> used in a signficant number of GIS installations, is not doing the datum
> shift.  I'm going to call their tech support department in the next
> hour, once they open, to determine if the software isn't performing the
> task that they say it is performing.  If I look at the layer's active
> coordinate conversions when I have a WGS84 based layer and I import the
> NAD27 UTM data I see one coversion called NAD_1927_To_WGS_1984_1.  Doing
> the same thing with a NAD83 layer produces a conversion called
> NAD_1927_To_NAD_1983_NADCON.  The NAD27->NAD83 method is NADCON.  The
> NAD27->WGS84 method is a Geocentric Translation method.  Having never
> coded up a conversion method myself, I don't know if that is the
> standard mechanism of conversion between those two datums.  

I wonder if ArcMap's on the fly projection is taking shortcuts. In 
ArcInfo Workstation one cannot project directly from NAD27 to WGS84, but 
rather does things in two steps using what they call a 3 parameter 
transformation. From ArcDoc "NAD to WGS":

"The most accurate way to convert between WGS84 or WGS72 and NAD27is the 
following:

1.) PROJECT the dataset from "DATUM WGS84" to "DATUM NAR_C" (uses three 
parameter method).

2.) Use PROJECTDEFINE to update the datum to "DATUM NAD83".

3.) PROJECT from "DATUM NAD83" to "DATUM NAD27" (uses NADCON method).

Simply reverse the steps to convert from NAD27 to WGS84. This two step 
method takes advantage of the fact that the most accurate way to convert 
between NAD83 and NAD27 is the NADCON method. It's possible to convert 
directly to and from WGS84 and NAD27 (using the equivalent datum NAS_C) 
but not as accurate."

NOTE: Step 2 is a hack and doesn't change any values, it just changes 
the value in a text file (prj.adf) from NAR_C to NAD83; else the next 
step won't run.


ArcDoc "Transforming between NAD27 and NAD83" says:

"The datum transformation program known as NADCON, created by the U.S. 
National Geodetic Survey (NGS), has been implemented within the PROJECT 
command. A minimum curvature-derived surface based upon the National 
Geodetic Reference System determines the transformation of points and 
has an approximate accuracy of 0.15 to 0.5 meters. The accepted national 
standard, NADCON is the fastest, simplest, and most accurate datum 
transformation for mapping at scales of 1:200 and smaller. NADCON, an 
acronym for North American Datum CONversion, is suitable for the United 
States, Puerto Rico, and the Virgin Islands, but only for conversion 
between the NAD27, the NAD83, the High Precision GPS Network (HPGN) 
readjustment of NAD83, and selected local island datums discussed below. 
..."

An online doc which contains links to yet more docs, in particular the 
'Projection Engine', which might shed light on the ESRI way is
http://tinyurl.com/z0ve
(goes to 
http://support.esri.com/index.cfm?fa=knowledgebase.techArticles.articleShow&d=23025)

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From matt.wilkie at gov.yk.ca  Fri Dec 12 19:54:28 2003
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] NAD83 vs. WGS84
In-Reply-To: <3FDA61E0.3030507@gov.yk.ca>
References: <3FDA61E0.3030507@gov.yk.ca>
Message-ID: <3FDA6344.9040409@gov.yk.ca>

Some ArcObjects code for "Let?s say you need to convert from UTM zone 14 
on WGS84 to UTM zone 14 on NAD27. This requires three conversions: from 
UTM to geographic on WGS84, from WGS84 to NAD27 in geographic 
coordinates, and finally back to UTM on NAD27."

http://arcsdeonline.esri.com/capi_concepts/changing_coordinate_systems.htm


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From warmerdam at pobox.com  Sat Dec 13 01:55:35 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR Questions
In-Reply-To: <Pine.LNX.4.53.0312121453410.28330@wapiti.tc.fluke.com>
References: <Pine.LNX.4.53.0312121453410.28330@wapiti.tc.fluke.com>
Message-ID: <3FDAB7E7.2020503@pobox.com>

Curt Mills wrote:
> 1) Can the coordinate system change per layer in a vector file?  If
> not, shouldn't the call to get the spatial reference be based on the
> datasource instead of the layer?

Curt,

In theory different layers in a datasource can have different coordinate
systems, though this is uncommon.  It does happen though.

> 2) Shapefile "hole" polygons:  Are there other OGR formats that do
> something similar?  Should I check whether the datasource is a
> shapefile and implement "hole" polygons only for them?

I'm not sure what a hole polygon is.  A shapefile polygon file may
have Polygon and MultiPolygon geometries.  Till just recently multipolygons
were just returned as polygons, but Radim recently fixed this.

What do you mean?

> 3) Is there a standard anywhere for how to specify drawing
> preferences across GIS systems?  I'm talking about things like
> enabling/disabling layers, deciding which field is the label for the
> object, colors, layer stackup, line widths, polygon fill or outline,
> etc.  The sorts of things that might be written to a file that
> accompanies a dataset, or perhaps covers a directory heirarchy of
> GIS files.

There are many standards.  Within the OGR API the preferred approach
to this is the OGR Feature Style Specification:

   http://gdal.velocet.ca/~warmerda/projects/opengis/ogr_feature_style_008.html

Basically this is intended to provide a mechanism for different underlying
formats to indicate their rendering information.  It is at least partially
implemented for the DGN and Mapinfo drivers.  The only applications that I
am aware of taking advantage of it are OpenEV and MapServer.

> 4) Getting the number of points in a feature:  Is that always an
> "inexpensive" operation?  If it can be "expensive", is there a way
> to gain the entire set of vectors instead that would be faster?  I
> saw nothing in ogr_api.h about it.
> 
> Again, I'm using the C API to OGR.

Getting the number of points in an OGRGeometry is generally cheap.  If the
geometry is a collection,then you would have to dig through the tree to get
the total count, but it is still relatively cheap.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From archer at eskimo.com  Sat Dec 13 03:12:38 2003
From: archer at eskimo.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR Questions
In-Reply-To: <3FDAB7E7.2020503@pobox.com>
Message-ID: <Pine.LNX.4.04.10312130004220.20194-100000@gatekeeper.we7u.net>

On Sat, 13 Dec 2003, Frank Warmerdam wrote:

> In theory different layers in a datasource can have different coordinate
> systems, though this is uncommon.  It does happen though.

I'm going to ignore it then for our application.  If it ever happens,
they can convert the dataset to something reasonable and try reading
it in again.  I'm just snagging the spatial info from layer 0 right
now.


> > 2) Shapefile "hole" polygons:  Are there other OGR formats that do
> > something similar?  Should I check whether the datasource is a
> > shapefile and implement "hole" polygons only for them?
> 
> I'm not sure what a hole polygon is.  A shapefile polygon file may
> have Polygon and MultiPolygon geometries.  Till just recently multipolygons
> were just returned as polygons, but Radim recently fixed this.
> 
> What do you mean?

In Shapefiles, there are "fill" polygons, and there are "hold"
polygons in those filled polygons.  The direction of the vertices
as you walk around the polygon tells you which it is, hole or fill.
I've seen some implementations of Shapefiles where they ignore this.
You end up with problems like this:  Puget Sound (Seattle Area) has
a water polygon.  On it is an Island (Whidbey Island), that has a
lake with an island on it.  Without holes, the Island itself might
not appear, same for the lake on the island, and the island in that.

I've seen the same problem with a Shapefile of San Fransisco area.

I was wondering if some of the other formats that OGR supports might
have a similar thing in them.


> There are many standards.  Within the OGR API the preferred approach
> to this is the OGR Feature Style Specification:
> 
>    http://gdal.velocet.ca/~warmerda/projects/opengis/ogr_feature_style_008.html
> 
> Basically this is intended to provide a mechanism for different underlying
> formats to indicate their rendering information.  It is at least partially
> implemented for the DGN and Mapinfo drivers.  The only applications that I
> am aware of taking advantage of it are OpenEV and MapServer.

I'll take a closer look at that.  We have an AWK-like setup for
Shapefiles right now, and with the GDAL/OGR integration, it may be
time to look into a more general method.

One more question:  If a system already uses libproj, libshape, and
libgeotiff, might it cause problems at link time if the gdal library
is linked at the end, and some of the three mentioned libraries are
older?  I know that gdal uses all three of these, but I don't know if
it's linking to them at that stage.  I'm still getting runtime
segfaults with OGR, both with Shapefiles and with SDTS so far, when
coordinate translation code is invoked.  I'm just about to test with
the different link order (-lgdal first) to see if that solves the
problem.

-- 
Curt, WE7U.				archer@eskimo.com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From archer at eskimo.com  Sat Dec 13 03:16:09 2003
From: archer at eskimo.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR Questions
In-Reply-To: <Pine.LNX.4.04.10312130004220.20194-100000@gatekeeper.we7u.net>
Message-ID: <Pine.LNX.4.04.10312130015290.20194-100000@gatekeeper.we7u.net>

On Sat, 13 Dec 2003, Curt Mills, WE7U wrote:

> 
> In Shapefiles, there are "fill" polygons, and there are "hold"
> polygons in those filled polygons.  The direction of the vertices
> as you walk around the polygon tells you which it is, hole or fill.

I of course meant "hole" and not "hold" polygons...

-- 
Curt, WE7U.				archer@eskimo.com
http://www.eskimo.com/~archer
  Lotto:  A tax on people who are bad at math. - unknown
Windows:  Microsoft's tax on computer illiterates. - WE7U.
The world DOES revolve around me:  I picked the coordinate system!"


From warmerdam at pobox.com  Sat Dec 13 03:19:43 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:00 2007
Subject: [Gdal-dev] OGR Questions
In-Reply-To: <Pine.LNX.4.04.10312130004220.20194-100000@gatekeeper.we7u.net>
References: <Pine.LNX.4.04.10312130004220.20194-100000@gatekeeper.we7u.net>
Message-ID: <3FDACB9F.6010906@pobox.com>

Curt Mills, WE7U wrote:
>>>2) Shapefile "hole" polygons:  Are there other OGR formats that do
>>>something similar?  Should I check whether the datasource is a
>>>shapefile and implement "hole" polygons only for them?
>>
>>I'm not sure what a hole polygon is.  A shapefile polygon file may
>>have Polygon and MultiPolygon geometries.  Till just recently multipolygons
>>were just returned as polygons, but Radim recently fixed this.
>>
>>What do you mean?
> 
> 
> In Shapefiles, there are "fill" polygons, and there are "hold"
> polygons in those filled polygons.  The direction of the vertices
> as you walk around the polygon tells you which it is, hole or fill.
> I've seen some implementations of Shapefiles where they ignore this.
> You end up with problems like this:  Puget Sound (Seattle Area) has
> a water polygon.  On it is an Island (Whidbey Island), that has a
> lake with an island on it.  Without holes, the Island itself might
> not appear, same for the lake on the island, and the island in that.
> 
> I've seen the same problem with a Shapefile of San Fransisco area.
> 
> I was wondering if some of the other formats that OGR supports might
> have a similar thing in them.

Curt,

An OGRPolygon objects consists of one outer ring and zero or more
inner rings.  The inner rings are holes.  The C API kind of hides this
fact, but you should be able to assume that the first ring is an outer
ring, and ony other rings are inner rings (holes).  Note that in the
simple features geometry model you can't make any assumptions about
the winding direction of holes or outer rings.

Some polygons when read from Shapefiles will be returned as OGRMultiPolygon.
These are basically areas that have multiple outer rings.  For instance, if
you had one feature that was a chain of islands.  In the past (and likely
even now with some format drivers) these were just returned as polygons with
the outer and inner rings all mixed up.  But the development code includes
fixes (for shapefiles at least) to fix this up and convert into a multi
polygon so you can properly establish what are outer rings, and what
are inner rings (holes).

> One more question:  If a system already uses libproj, libshape, and
> libgeotiff, might it cause problems at link time if the gdal library
> is linked at the end, and some of the three mentioned libraries are
> older?  I know that gdal uses all three of these, but I don't know if
> it's linking to them at that stage.  I'm still getting runtime
> segfaults with OGR, both with Shapefiles and with SDTS so far, when
> coordinate translation code is invoked.  I'm just about to test with
> the different link order (-lgdal first) to see if that solves the
> problem.

On unix platforms I often run into problems with more than one copy of
a shared library gets linked in at the same time.  I have especially
noticed this with PROJ.4 where I would have a version that was
embedded in the OGDI shared libraries, and another version loaded from
a standalone PROJ.4 library.  It seemed that either version might get
called at random from higher level code.

Note that the libproj.so is loaded after application startup with a
dlopen() call for use with the OGRCoordinateTransformation class.  This
may have some relation to the problem as well.

While not always trivial to arrange, it is intended that libgdal can
be built with external versions of the various libraries that are
sometimes embedded, like libtiff, libgeotiff, libpng, libjpeg and libz.
Factoring this out properly can be critical when GDAL is used in a
complex applications with other dependencies on the same libraries.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From paul-grass at stjohnspoint.co.uk  Mon Dec 15 06:59:54 2003
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Minor compilation error
Message-ID: <Pine.LNX.4.58.0312151153000.2122@agrippa.ukshells.co.uk>

Hello
Here is an interesting problem (see below) I encountered when compiling
the latest GDAL source (on an IRIX 6.2 system). The function prototype for
CPLScanDouble() had recently been changed to take an extra argument. But
when compiling I got an error because #include <cpl_string.h> was picking
up the old version of the cpl_*.h files installed in /usr/local/include
instead of the up-to-date and consistent versions in ../../port

If  -I/usr/local/include was included last after the include directories
within the GDAL source tree, I think things would work properly. As it is,
I deleted my GDAL-related header files in /usr/local/include to allow the
compilation to proceed.

I'm not sure if this is a valid complaint or something worth fixing so am
posting it here just in case.

Paul


(directory frmts/raw)

/bin/sh ../../libtool --mode=compile CC -O3   -I/usr/local/include  -I../../port -I../../port -I../../gcore -I../../ogr  -c -o fastdataset.o fastdataset.cpp
 CC -O3 -I/usr/local/include -I../../port -I../../port -I../../gcore -I../../ogr -c fastdataset.cpp  -DPIC
CC: Warning: -c should not be used with ucode -O3 -o32 on a single file; use -j instead to get inter-module optimization.
"fastdataset.cpp", line 541: error(3229): too many arguments in function call
          dfULX = CPLScanDouble( szHeader + 3664, 13, "C" );
                                                      ^

"fastdataset.cpp", line 542: error(3229): too many arguments in function call
          dfULY = CPLScanDouble( szHeader + 3678, 13, "C" );
                                                      ^

"fastdataset.cpp", line 543: error(3229): too many arguments in function call
          dfURX = CPLScanDouble( szHeader + 3744, 13, "C" );
                                                      ^

"fastdataset.cpp", line 544: error(3229): too many arguments in function call
          dfURY = CPLScanDouble( szHeader + 3758, 13, "C" );
                                                      ^

"fastdataset.cpp", line 545: error(3229): too many arguments in function call
          dfLRX = CPLScanDouble( szHeader + 3824, 13, "C" );
                                                      ^

"fastdataset.cpp", line 546: error(3229): too many arguments in function call
          dfLRY = CPLScanDouble( szHeader + 3838, 13, "C" );
                                                      ^

"fastdataset.cpp", line 547: error(3229): too many arguments in function call
          dfLLX = CPLScanDouble( szHeader + 3904, 13, "C" );
                                                      ^

"fastdataset.cpp", line 548: error(3229): too many arguments in function call
          dfLLY = CPLScanDouble( szHeader + 3918, 13, "C" );
                                                      ^

"fastdataset.cpp", line 556: error(3229): too many arguments in function call
                      PackedDMSToDec( CPLScanDouble(szHeader + 3312, 24, "C") ),
                                                                         ^

"fastdataset.cpp", line 558: error(3229): too many arguments in function call
                      PackedDMSToDec( CPLScanDouble(szHeader + 3282, 24, "C") ),
                                                                         ^

"fastdataset.cpp", line 559: error(3229): too many arguments in function call
                      CPLScanDouble(szHeader + 3232, 24, "C"),   // Scale factor
                                                         ^

"fastdataset.cpp", line 560: error(3229): too many arguments in function call
                      CPLScanDouble(szHeader + 3337, 24, "C"),   // False easting
                                                         ^

"fastdataset.cpp", line 561: error(3229): too many arguments in function call
                      CPLScanDouble(szHeader + 3362, 24, "C") ); // False northing
                                                         ^

"fastdataset.cpp", line 565: error(3229): too many arguments in function call
          dfULX = CPLScanDouble( szHeader + 3664, 13, "C" ) - dfZone;
                                                      ^

"fastdataset.cpp", line 566: error(3229): too many arguments in function call
          dfULY = CPLScanDouble( szHeader + 3678, 13, "C" );
                                                      ^

"fastdataset.cpp", line 567: error(3229): too many arguments in function call
          dfURX = CPLScanDouble( szHeader + 3744, 13, "C" ) - dfZone;
                                                      ^

"fastdataset.cpp", line 568: error(3229): too many arguments in function call
          dfURY = CPLScanDouble( szHeader + 3758, 13, "C" );
                                                      ^

"fastdataset.cpp", line 569: error(3229): too many arguments in function call
          dfLRX = CPLScanDouble( szHeader + 3824, 13, "C" ) - dfZone;
                                                      ^

"fastdataset.cpp", line 570: error(3229): too many arguments in function call
          dfLRY = CPLScanDouble( szHeader + 3838, 13, "C" );
                                                      ^

"fastdataset.cpp", line 571: error(3229): too many arguments in function call
          dfLLX = CPLScanDouble( szHeader + 3904, 13, "C" ) - dfZone;
                                                      ^

"fastdataset.cpp", line 572: error(3229): too many arguments in function call
          dfLLY = CPLScanDouble( szHeader + 3918, 13, "C" );
                                                      ^

"fastdataset.cpp", line 521: warning(3666): variable "dfLRX" was set but never
          used
      double	dfLRX = poDS->nRasterXSize - 0.5, dfLRY = poDS->nRasterYSize - 0.5;
            	^

"fastdataset.cpp", line 521: warning(3666): variable "dfLRY" was set but never
          used
      double	dfLRX = poDS->nRasterXSize - 0.5, dfLRY = poDS->nRasterYSize - 0.5;
            	                                  ^

21 errors detected in the compilation of "fastdataset.cpp".
make: *** [fastdataset.o] Error 1

From paul-grass at stjohnspoint.co.uk  Mon Dec 15 08:04:28 2003
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Bigger compilation error
Message-ID: <Pine.LNX.4.58.0312151301210.2122@agrippa.ukshells.co.uk>

See attached for make output, today's CVS using libtool on IRIX 6.2. It
stops at seemingly the last stage before creating the shared library. It
worked fine before (even after libtool introduction), a few months ago. I am
just sending this to the list as I'm not sure what's wrong.

Paul
-------------- next part --------------
A non-text attachment was scrubbed...
Name: make.log.gz
Type: application/octet-stream
Size: 4322 bytes
Desc: 
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031215/a12774d3/make.log.obj
From warmerdam at pobox.com  Mon Dec 15 09:27:46 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Bigger compilation error
In-Reply-To: <Pine.LNX.4.58.0312151301210.2122@agrippa.ukshells.co.uk>
References: <Pine.LNX.4.58.0312151301210.2122@agrippa.ukshells.co.uk>
Message-ID: <3FDDC4E2.8080907@pobox.com>

Paul Kelly wrote:
> See attached for make output, today's CVS using libtool on IRIX 6.2. It
> stops at seemingly the last stage before creating the shared library. It
> worked fine before (even after libtool introduction), a few months ago. I am
> just sending this to the list as I'm not sure what's wrong.

Paul,

I'm not too sure why things are going wrong.  At the bottom I see:

ld: FATAL 43: cannot mix PIC and non-PIC: .libs/libgdal.la-2.o.

Did you used to get this?  It almost looks as if something is being compiled
without libtool and it's -fPIC flags. I presume a clean build doesn't help?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From dem at acri-st.fr  Mon Dec 15 10:41:04 2003
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Little link pb gdal_contour (Windows MSVC++)
Message-ID: <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr>

Hi,

little fix to build gdal_contour.exe under Windows with MSVC++ :


dem@dem /cygdrive/e/acri/cvs_checkout/gdal
$ cvs diff apps/makefile.vc
Index: apps/makefile.vc
===================================================================
RCS file: /cvsroot/osrs/gdal/apps/makefile.vc,v
retrieving revision 1.17
diff -r1.17 makefile.vc
38,40c38,40
<       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp $(XTRAOBJ) $(LIBS) \
<               /link $(LINKER_FLAGS)
<
---
 >       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp ../alg/contour.obj \
 >               $(XTRAOBJ) $(LIBS) /link $(LINKER_FLAGS)


Regards,

Julien


From mathieu_gdal at yahoo.fr  Mon Dec 15 10:51:18 2003
From: mathieu_gdal at yahoo.fr (mathieu_gdal)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] datum shift in OGR / proj4
In-Reply-To: <3FDACB9F.6010906@pobox.com>
Message-ID: <000001c3c323$482a76c0$3b00000a@informatiquemer.fr>

Dear All,

I know the basics of datums concepts, and until now, I was making datum
conversion with my own code (using in particular the abridged Molodensky
formula).

Now, I would like to port my code to OGR.
Where could I find documentations about how to convert datums with Proj4
/ OGR? 
In can see in this mailing list some experts talking about "Datum Data
files". I have my own datum list and file format, so is it possible to
feed Proj4/OGR with my own datums?

If you could give me a "starting point" (doc and/or code) to allow me to
start with OGR and datums, it would be great.

Mathieu


From warmerdam at pobox.com  Mon Dec 15 11:00:24 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Little link pb gdal_contour (Windows MSVC++)
In-Reply-To: <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr>
References: <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr>
Message-ID: <3FDDDA98.8000803@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> little fix to build gdal_contour.exe under Windows with MSVC++ :
> 
> 
> dem@dem /cygdrive/e/acri/cvs_checkout/gdal
> $ cvs diff apps/makefile.vc
> Index: apps/makefile.vc
> ===================================================================
> RCS file: /cvsroot/osrs/gdal/apps/makefile.vc,v
> retrieving revision 1.17
> diff -r1.17 makefile.vc
> 38,40c38,40
> <       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp $(XTRAOBJ) $(LIBS) \
> <               /link $(LINKER_FLAGS)
> <
> ---
>  >       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp ../alg/contour.obj \
>  >               $(XTRAOBJ) $(LIBS) /link $(LINKER_FLAGS)

Julien,

The contour.obj is already in GDAL11.dll, so this shouldn't be necessary.
I think the problem is that some of the contour functions were declared without
the CPL_DLL attribute so they weren't exported from the DLL.  I have fixed
this in gdal/alg/gdal_alg.h, and committed the change.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From dem at acri-st.fr  Mon Dec 15 11:17:56 2003
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Little link pb gdal_contour (Windows MSVC++)
In-Reply-To: <3FDDDA98.8000803@pobox.com>
References: <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr>
 <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr>
Message-ID: <5.0.2.1.2.20031215171253.00a77370@mail.acri.fr>

Frank,

gdal_contour still doesn't compile :

         cl /nologo /Ox /MD -I..\port -I..\ogr -I..\gcore  -I..\frmts 
-I..\alg gd
al_contour.cpp  ..\gdal_i.lib  /link
gdal_contour.cpp
gdal_contour.cpp(249) : warning C4508: 'main' : function should return a value;
'void' return type assumed
    Creating library gdal_contour.lib and object gdal_contour.exp
gdal_contour.obj : error LNK2001: unresolved external symbol 
_GDALContourGenerat
e
gdal_contour.exe : fatal error LNK1120: 1 unresolved externals
NMAKE : fatal error U1077: 'cl' : return code '0x2'
Stop.
NMAKE : fatal error U1077: 'e:\PROGRA~1\MICROS~2\VC98\BIN\NMAKE.EXE' : 
return co
de '0x2'
Stop.

Ideas ?

Thanks in advance,

Julien


At 11:00 15/12/2003 -0500, you wrote:
>Julien Demaria wrote:
>>Hi,
>>little fix to build gdal_contour.exe under Windows with MSVC++ :
>>
>>dem@dem /cygdrive/e/acri/cvs_checkout/gdal
>>$ cvs diff apps/makefile.vc
>>Index: apps/makefile.vc
>>===================================================================
>>RCS file: /cvsroot/osrs/gdal/apps/makefile.vc,v
>>retrieving revision 1.17
>>diff -r1.17 makefile.vc
>>38,40c38,40
>><       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp $(XTRAOBJ) $(LIBS) \
>><               /link $(LINKER_FLAGS)
>><
>>---
>>  >       $(CC) $(CFLAGS) $(XTRAFLAGS) gdal_contour.cpp ../alg/contour.obj \
>>  >               $(XTRAOBJ) $(LIBS) /link $(LINKER_FLAGS)
>
>Julien,
>
>The contour.obj is already in GDAL11.dll, so this shouldn't be necessary.
>I think the problem is that some of the contour functions were declared 
>without
>the CPL_DLL attribute so they weren't exported from the DLL.  I have fixed
>this in gdal/alg/gdal_alg.h, and committed the change.
>
>Best regards,
>
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@remotesensing.org
>http://remotesensing.org/mailman/listinfo/gdal-dev



From hacker at tc.fluke.com  Mon Dec 15 11:18:28 2003
From: hacker at tc.fluke.com (Curt Mills, WE7U)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] datum shift in OGR / proj4
In-Reply-To: <000001c3c323$482a76c0$3b00000a@informatiquemer.fr>
References: <000001c3c323$482a76c0$3b00000a@informatiquemer.fr>
Message-ID: <Pine.LNX.4.53.0312150811030.4268@wapiti.tc.fluke.com>

On Mon, 15 Dec 2003, mathieu_gdal wrote:

> If you could give me a "starting point" (doc and/or code) to allow me to
> start with OGR and datums, it would be great.

Which API?  I just wrote some GPL'ed code with the 'C' API.  It
appears to do the correct thing so far, but it's very recent code.

It's rather cool being able to suck in state-plane coordinate
system maps or UTM projected maps into our application, and
auto-convert directly to WGS84 as we're drawing map after map on top
of each other!

We've been using Shapelib, libgeotiff, and libproj in our app up
until now.  We're working on getting GDAL/OGR full support into our
application, and the OGR stuff is starting to show results already.

-- 
Curt Mills, WE7U                    hacker_NO_SPAM_@tc.fluke.com
Senior Methods Engineer/SysAdmin
"Lotto:    A tax on people who are bad at math!"
"Windows:  Microsoft's tax on computer illiterates!" -- WE7U
"The world DOES revolve around me:  I picked the coordinate system!"

From warmerdam at pobox.com  Mon Dec 15 11:23:47 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] datum shift in OGR / proj4
In-Reply-To: <000001c3c323$482a76c0$3b00000a@informatiquemer.fr>
References: <000001c3c323$482a76c0$3b00000a@informatiquemer.fr>
Message-ID: <3FDDE013.5050500@pobox.com>

mathieu_gdal wrote:
> Dear All,
> 
> I know the basics of datums concepts, and until now, I was making datum
> conversion with my own code (using in particular the abridged Molodensky
> formula).
> 
> Now, I would like to port my code to OGR.
> Where could I find documentations about how to convert datums with Proj4
> / OGR? 
> In can see in this mailing list some experts talking about "Datum Data
> files". I have my own datum list and file format, so is it possible to
> feed Proj4/OGR with my own datums?
> 
> If you could give me a "starting point" (doc and/or code) to allow me to
> start with OGR and datums, it would be great.

Mathieu,

OGR / PROJ.4 support 3 and 7 parameter datum transformations as well as
grid file driven transformations (used for NAD27 to NAD83 primarily).

At the OGR level you use the 3 and 7 parameter transformations with the
TOWGS84[] item in a WKT coordinate system.  The following is a very simple
made up example of a geographic coordinate system with a datum shift defined
in a TOWGS84 node:

GEOGCS["International 1909 (Hayford)",
     DATUM["unknown",
         SPHEROID["intl",6378388,297],
         TOWGS84[1,2,3,0,0,0,0]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433]]

The corresponds to the PROJ.4 definition:

+proj=latlong +ellps=intl +towgs84=1,2,3

The grid shift files are only used by OGR when it recognises it is converting
to/from NAD27.   Let me know if you need to tie into that.

So basicaly, you should be able to translate your existing coordinate systems
into WKT definitions that includes the TOWGS84 node for the DATUM, and then
OGR will apply the datum shift during coordinate transformation if required.

You might want to skim:

   http://www.remotesensing.org/gdal/ogr/osr_tutorial.html
   http://www.remotesensing.org/proj/gen_parms.html
   http://www.remotesensing.org/proj/faq.html

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From warmerdam at pobox.com  Mon Dec 15 11:25:22 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Little link pb gdal_contour (Windows MSVC++)
In-Reply-To: <5.0.2.1.2.20031215171253.00a77370@mail.acri.fr>
References: <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr> <5.0.2.1.2.20031215163738.00a77370@mail.acri.fr> <5.0.2.1.2.20031215171253.00a77370@mail.acri.fr>
Message-ID: <3FDDE072.1080501@pobox.com>

Julien Demaria wrote:
> Frank,
> 
> gdal_contour still doesn't compile :
> 
>         cl /nologo /Ox /MD -I..\port -I..\ogr -I..\gcore  -I..\frmts 
> -I..\alg gd
> al_contour.cpp  ..\gdal_i.lib  /link
> gdal_contour.cpp
> gdal_contour.cpp(249) : warning C4508: 'main' : function should return a 
> value;
> 'void' return type assumed
>    Creating library gdal_contour.lib and object gdal_contour.exp
> gdal_contour.obj : error LNK2001: unresolved external symbol 
> _GDALContourGenerat
> e
> gdal_contour.exe : fatal error LNK1120: 1 unresolved externals
> NMAKE : fatal error U1077: 'cl' : return code '0x2'
> Stop.
> NMAKE : fatal error U1077: 'e:\PROGRA~1\MICROS~2\VC98\BIN\NMAKE.EXE' : 
> return co
> de '0x2'
> Stop.
> 
> Ideas ?

Julien,

Did you force the contour code in gdal/alg to rebuild?  The modification
to the include file changes the way the contour.obj is created so that
when the dll is created the function will be exported.  To be safest you
could do an "nmake /f makefile.vc clean" on the whole tree and then rebuild.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From T.R.DeCarlo at LaRC.NASA.GOV  Mon Dec 15 14:30:05 2003
From: T.R.DeCarlo at LaRC.NASA.GOV (Thom DeCarlo)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Python compatibility?
Message-ID: <EPEALOKKOCCOEALLINACEEPAFEAA.T.R.DeCarlo@larc.nasa.gov>

Hi,
I just downloaded the current release of Python (v2.3.2) from their website.
Unfortunately, it does not include everything needed to compile GDAL 1.1.9.
When building GDAL I get missing include file errors in the gdal_py.h file.

        cd pymod
        if exist "C:\Program Files\Python23"\python.exe nmake /nologo /f
makefile.vc
        cl /nologo /Ox /MD -I..\port -I..\ogr -I..\gcore -I"C:\Program
Files\Python23"/include -DHAVE_NUMPY /c gdal_wrap.c
gdal_wrap.c
gdal_py.h(56) : fatal error C1083: Cannot open include file:
'Numeric/arrayobject.h': No such file or directory
NMAKE : fatal error U1077: 'cl' : return code '0x2'

After further searching, I found that gdal is expecting to find the
Numerical Python package, as well as the basic Python. Numerical is not part
of the basic installation, and according to the Numpy website
(http://www.pfdubois.com/numpy/) it is going to be phased out in favor of
Numarray.

Can this dependency be explicitly noted in the GDAL nmake.opt file? (I'd
submit the change myself, but my network admin has blocked the ports needed
to run CVS.)

Thanks,
Thom


Thom DeCarlo
Sr. S/W Eng, VisSim
Team ConITS - AvSP - LaRC - NASA




From ke.zeng at ga.com  Mon Dec 15 15:05:34 2003
From: ke.zeng at ga.com (Ke Zeng)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Question on GDALAllRgister()
In-Reply-To: <3FDDE072.1080501@pobox.com>
Message-ID: <20031215200401.8323424010@lynxmail.ga.com>

Hi,
I am new to GDAL. I downloaded gdal project through CVS and compiled GDAL
under my WinXP. Everything seems to be all right. Now I start to build a
little test following GDAL API Tutorial. Test project under VC++6 is
compiled and linked to gdal_i.lib OK. But when the test program hits
GDALAllRegiter(), it keeps making assertion. At one point, it complained
gdal.dll was not found. But I intent to use static library in my project.
Did I miss anything? Please help. Thanks.

Ke Zeng 



From dron at ak4719.spb.edu  Tue Dec 16 03:37:09 2003
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Question on GDALAllRgister()
In-Reply-To: <20031215200401.8323424010@lynxmail.ga.com>
References: <3FDDE072.1080501@pobox.com> <20031215200401.8323424010@lynxmail.ga.com>
Message-ID: <20031216083709.GA7037@ak4719.spb.edu>

Hi,

On Mon, Dec 15, 2003 at 12:05:34PM -0800, Ke Zeng wrote:
> I am new to GDAL. I downloaded gdal project through CVS and compiled
> GDAL under my WinXP. Everything seems to be all right. Now I start to
> build a little test following GDAL API Tutorial. Test project under
> VC++6 is compiled and linked to gdal_i.lib OK. But when the test
> program hits GDALAllRegiter(), it keeps making assertion. At one
> point, it complained gdal.dll was not found. But I intent to use
> static library in my project. Did I miss anything? Please help.
> Thanks.

You should use /ML option instead of /MD in the OPTFLAGS parameter in
nmake.opt file. /ML instructs compiler to build the static library.


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From TMitchell at lignum.com  Tue Dec 16 12:13:14 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Converting style info to attributes
Message-ID: <OFE284E832.D89434EB-ON88256DFE.005E630C-88256DFE.005E9813@lignum.com>




Using OGR, I want to take a DGN file and convert it to another format
(shape or postgis).  I want to take the styling information from DGN and
store it as attributes in the output format.  Are these exposed anywhere
that I can get at with Python?  I see that Mapserver gets access to them,
but I assumes it through the c api.  I also assume I can't do this with the
ogr2ogr utility. Any thoughts?

Tyler


From ke.zeng at ga.com  Tue Dec 16 13:39:06 2003
From: ke.zeng at ga.com (Ke Zeng)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] geotiff.lib and gdal11.dll
In-Reply-To: <20031215200401.8323424010@lynxmail.ga.com>
Message-ID: <20031216183733.053552401E@lynxmail.ga.com>

Hi.
My current project uses geotiff.lib. But I need to use gdal11.dll in the
project as well. There are many conflict definitions between the two. Is
there a way to decouple the two in the same project? I am using VC++6.
Thanks.

Ke Zeng


From warmerdam at pobox.com  Tue Dec 16 14:03:08 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Converting style info to attributes
In-Reply-To: <OFE284E832.D89434EB-ON88256DFE.005E630C-88256DFE.005E9813@lignum.com>
References: <OFE284E832.D89434EB-ON88256DFE.005E630C-88256DFE.005E9813@lignum.com>
Message-ID: <3FDF56EC.4030304@pobox.com>

Tyler Mitchell wrote:
> 
> 
> 
> Using OGR, I want to take a DGN file and convert it to another format
> (shape or postgis).  I want to take the styling information from DGN and
> store it as attributes in the output format.  Are these exposed anywhere
> that I can get at with Python?  I see that Mapserver gets access to them,
> but I assumes it through the c api.  I also assume I can't do this with the
> ogr2ogr utility. Any thoughts?

Tyler,

I haven't tested it, but I see there is a GetStyleString() and SetStyleString()
method on the ogr.Feature() in Python.  So you can use the GetStyleString()
to fetch the style, but you will need to put it in a regular attribute yourself
if you are writing to PostGIS or Shapefile.  Also, I don't think there is any
mechanism to tell MapServer to use a regular attribute as the source of
the style string, though I can see that this would be very useful.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From TMitchell at lignum.com  Tue Dec 16 14:56:20 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Converting style info to attributes
In-Reply-To: <3FDF56EC.4030304@pobox.com>
Message-ID: <OF8C6A3B9A.FE9A9CAE-ON88256DFE.006B0B18-88256DFE.006D86ED@lignum.com>





> I haven't tested it, but I see there is a GetStyleString() and
> SetStyleString()
> method on the ogr.Feature() in Python.  So you can use the
GetStyleString()

Great, thanks.  That answers my question and I'll have a peek.

> Also, I don't think there is any
> mechanism to tell MapServer to use a regular attribute as the source of
> the style string, though I can see that this would be very useful.

I see what you mean, it would be a good feature if it isn't already.  But
that's okay for me right now.

FYI What I'm aiming at is trying to store CAD data and related feature
styles in another format and being able to convert it back into CAD formats
with minimal info loss.  Obviously I'll hit similar issues when trying to
convert back in CAD.

Tyler


From TMitchell at lignum.com  Tue Dec 16 19:01:21 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] ogr.py duplicate CreateFeature() ?
Message-ID: <OFF9722B25.588B2812-ON88256DFE.0083C8FE-88256DFF.00001F63@lignum.com>




In ogr.py I see what appears to be a duplicate function.  Line 368 and 389
are both:
def CreateFeature() but the second argument in one is "feat" and in the
other is "feature".  Is this intentional or an error?

Tyler


From TMitchell at lignum.com  Tue Dec 16 19:59:57 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Seg fault with CreateFeature
Message-ID: <OF48EBB67D.E5AB3D53-ON88256DFF.00045FC8-88256DFF.00057CC2@lignum.com>




This is one of my first attempts at creating a layer and wondered if anyone
can notice any obvious problem with my methodology.  Python certainly
doesn't like it - I get a core dump after my last command.
The basic idea is:
1) open a DGN layer, read a feature and geometry and the Style String.
2) Create a new shape file and put the geometry into it, calculate the
string data type field to hold the style string value

I'm running gdal from CVS today this morning on Cygwin.  I'm getting errors
on win32 as well, which points to my SetGeometry syntax.  What am I doing
wrong?

Tyler


Here is my output, followed by the raw script
----------------
Interactive OUTPUT
-----------------
Python 2.3 (#1, Aug 27 2003, 16:44:27)
[GCC 3.2 20020927 (prerelease)] on cygwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import ogr

>>> dsin = ogr.Open("c:/tmp/dgnshp/cp200.dgn")
>>> layin = dsin.GetLayer()
>>> layin.GetName()
'elements'

>>> dsout = ogr.GetDriver(0).CreateDataSource("c:/tmp/dgnshp/ogrout")
>>> layout = dsout.CreateLayer("newlayer",None,3)

>>> flddefout = ogr.FieldDefn( "stylestr",4)
>>> layout.CreateField(flddefout)
0

>>> featin = layin.GetFeature(18)
>>> featin.GetField("Type")
14

>>> featout = ogr.Feature( flddefout )

>>> geoin = featin.GetGeometryRef()
>>> featout.SetGeometryDirectly( geoin )
0

>>> featout.SetField(0,featin.GetStyleString)
>>> layout.CreateFeature(featout)
Segmentation fault (core dumped)

----------------
Stripped down script
-----------------
import ogr

dsin = ogr.Open("c:/tmp/dgnshp/cp200.dgn")
layin = dsin.GetLayer()
layin.GetName()
#'elements'

dsout = ogr.GetDriver(0).CreateDataSource("c:/tmp/dgnshp/ogrout")
layout = dsout.CreateLayer("newlayer",None,3)

flddefout = ogr.FieldDefn( "stylestr",4)
layout.CreateField(flddefout)
#0

featin = layin.GetFeature(18)
featin.GetField("Type")
#14

featout = ogr.Feature( flddefout )
geoin = featin.GetGeometryRef()
featout.SetGeometryDirectly( geoin )
#0
featout.SetField(0,featin.GetStyleString)
layout.CreateFeature(featout)
#Segmentation fault (core dumped)


From dron at ak4719.spb.edu  Wed Dec 17 03:03:05 2003
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] geotiff.lib and gdal11.dll
In-Reply-To: <20031216183733.053552401E@lynxmail.ga.com>
References: <20031215200401.8323424010@lynxmail.ga.com> <20031216183733.053552401E@lynxmail.ga.com>
Message-ID: <20031217080305.GA8625@ak4719.spb.edu>

On Tue, Dec 16, 2003 at 10:39:06AM -0800, Ke Zeng wrote:
> My current project uses geotiff.lib. But I need to use gdal11.dll in
> the project as well. There are many conflict definitions between the
> two. Is there a way to decouple the two in the same project? I am
> using VC++6.

Yes... But it requires changes in the GDAL makefiles. Right now external
TIFF and Geotiff libraries are not supported for MSVC target.

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From paul-grass at stjohnspoint.co.uk  Wed Dec 17 04:54:17 2003
From: paul-grass at stjohnspoint.co.uk (Paul Kelly)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] Re: Bigger compilation error
In-Reply-To: <20031215162401.26709.70414.Mailman@yoda.imagelinks.com>
References: <20031215162401.26709.70414.Mailman@yoda.imagelinks.com>
Message-ID: <Pine.LNX.4.58.0312170951020.1135@agrippa.ukshells.co.uk>

Hello Frank

On Mon, 15 Dec 2003 gdal-dev-request@remotesensing.org wrote:

> Message: 3
> Date: Mon, 15 Dec 2003 09:27:46 -0500
> From: Frank Warmerdam <warmerdam@pobox.com>
> To: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] Bigger compilation error
> Reply-To: gdal-dev@remotesensing.org
>
> Paul Kelly wrote:
> > See attached for make output, today's CVS using libtool on IRIX 6.2. It
> > stops at seemingly the last stage before creating the shared library. It
> > worked fine before (even after libtool introduction), a few months ago. I am
> > just sending this to the list as I'm not sure what's wrong.
>
> Paul,
>
> I'm not too sure why things are going wrong.  At the bottom I see:
>
> ld: FATAL 43: cannot mix PIC and non-PIC: .libs/libgdal.la-2.o.
>
> Did you used to get this?  It almost looks as if something is being compiled
> without libtool and it's -fPIC flags. I presume a clean build doesn't help?

Looks like it was a problem with the compiler flags I was using. -O3 gave
the error, but it was fine with -O2. See below for a more specific-looking
error I got when compiling without libtool, but it's probably a red
herring---I don't think there's anything to worry about. Sorry.

Paul

make ./libgdal.a ./libgdal.1.1.so
make[1]: Entering directory `/indigo-disk2/grass/gdtest/gdal'
make[1]: `libgdal.a' is up to date.
CC -shared -all  ./frmts/o/*.o ./gcore/*.o ./port/*.o ./alg/*.o ./ogr/ogrsf_frmts/o/*.o ./ogr/ogrgeometryfactory.o ./ogr/ogrpoint.o ./ogr/ogrcurve.o ./ogr/ogrlinestring.o ./ogr/ogrlinearring.o ./ogr/ogrpolygon.o ./ogr/ogrutils.o ./ogr/ogrgeometry.o ./ogr/ogrgeometrycollection.o ./ogr/ogrmultipolygon.o ./ogr/ogrsurface.o ./ogr/ogrmultipoint.o ./ogr/ogrmultilinestring.o ./ogr/ogr_api.o ./ogr/ogrfeature.o ./ogr/ogrfeaturedefn.o ./ogr/ogrfeaturequery.o ./ogr/ogrfeaturestyle.o ./ogr/ogrfielddefn.o ./ogr/ogrspatialreference.o ./ogr/ogr_srsnode.o ./ogr/ogr_srs_proj4.o ./ogr/ogr_fromepsg.o ./ogr/ogrct.o ./ogr/ogr_opt.o ./ogr/ogr_srs_esri.o ./ogr/ogr_srs_pci.o ./ogr/swq.o ./ogr/ogr_srs_validate.o ./ogr/ogr_srs_xml.o ./ogr/ograssemblepolygon.o ./ogr/ogr2gmlgeometry.o ./ogr/gml2ogrgeometry.o ./libgdal.a   ./libgdal.a -lpng -lz -lm -ldl -L/usr/local/lib  \
	-o ./libgdal.1.1.so
ld: FATAL 43: cannot mix PIC and non-PIC: ./frmts/o/EnvisatFile.o.
make[1]: *** [libgdal.1.1.so] Error 1
make[1]: Leaving directory `/indigo-disk2/grass/gdtest/gdal'
make: *** [check-lib] Error 2






From archer at eskimo.com  Wed Dec 17 12:11:53 2003
From: archer at eskimo.com (Curt, WE7U)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] OGR example files
Message-ID: <Pine.GSU.4.44.0312170908260.2724-100000@eskimo.com>

The GDAL set of example files doesn't have any OGR files in it.

Could you add "ftp://gdal.velocet.ca/pub/outgoing/shape_eg_data.zip"
to that, but add ".prj" files for each so that OGR knows their
coordinate system?

Several of them look like UTM or state-plane coordinates.  If you
could tell me what coordinate system and datum they're in, I could
try to generate some of those ".prj" files.  I need them for my
testing now, to verify that I can draw various sorts of objects.

-----------------------------------------------------------------
Curt, WE7U			archer@eskimo.com
Arlington, WA, USA		http://www.eskimo.com/~archer
"Lotto:    A tax on people who are bad at math." -- unknown
"Windows:  Microsoft's tax on computer illiterates." -- WE7U


From dmcaferty at seeop.net  Wed Dec 17 16:27:35 2003
From: dmcaferty at seeop.net (Daniel McAferty)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] 1st Standard Parallel
Message-ID: <PBEPKNAFMBCIOBJCNAJCKEFACBAA.dmcaferty@seeop.net>

I am looking at the formulas to convert from UTM to standard Lat/Long.
1 parameter I need is the latitude of 1st Standard Parallel.

How is this calculated for UTM?

Thanks,
Dan

_______________________
Daniel V. McAferty
Thorpe Seeop corp.



From dmcaferty at seeop.net  Wed Dec 17 16:37:27 2003
From: dmcaferty at seeop.net (Daniel McAferty)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] 1st Standard Parallel
In-Reply-To: <PBEPKNAFMBCIOBJCNAJCKEFACBAA.dmcaferty@seeop.net>
Message-ID: <PBEPKNAFMBCIOBJCNAJCAEFBCBAA.dmcaferty@seeop.net>

Sorry to bother you all, I found what
I was looking for.
It was right in front of me. duh! :)

Dan

> -----Original Message-----
> From: gdal-dev-admin@remotesensing.org
> [mailto:gdal-dev-admin@remotesensing.org]On Behalf Of Daniel McAferty
> Sent: Wednesday, December 17, 2003 2:28 PM
> To: gdal-dev
> Subject: [Gdal-dev] 1st Standard Parallel
> 
> 
> I am looking at the formulas to convert from UTM to standard Lat/Long.
> 1 parameter I need is the latitude of 1st Standard Parallel.
> 
> How is this calculated for UTM?
> 
> Thanks,
> Dan
> 
> _______________________
> Daniel V. McAferty
> Thorpe Seeop corp.
> 
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev
> 


From TMitchell at lignum.com  Thu Dec 18 19:13:16 2003
From: TMitchell at lignum.com (Tyler Mitchell)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] How does ogr2ogr choose geometry type
Message-ID: <OF606C94B1.0B038F27-ON88256E01.0000EB50-88256E01.000136A3@lignum.com>




I doing some conversion from shape file to PostGIS with ogr2ogr.  That's a
great utility.  I'm finding that, in one case, a polygon will not meet the
database constraint for the geometry type.  Looking into it further, I see
that ogr2ogr identified the type as POLYGON.  When I manually specified
MULTIPOLYGON during the translation, it worked fine.

This leads me to the question of how does it determine which type to use?
Will it ever use multipolygon on it's own?

Tyler


From ke.zeng at ga.com  Wed Dec 17 20:21:02 2003
From: ke.zeng at ga.com (Ke Zeng)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] GetGeoTransform() return null string
In-Reply-To: <20031216183733.053552401E@lynxmail.ga.com>
Message-ID: <20031218011928.47B882401E@lynxmail.ga.com>

Hi. All,
I used my program (not GDAL) to created NITF2.1 file which is validated
using Mr.BIIF, and can be displayed using viewers like RemoteView.
Using GDAL, I am able to read out band data and display without problem. But
when I tried to call GetGeoTransform() from GDALDataset, it returns null
string. Using gdalinfo, I am not able to get "Coordinate System" (null)
either. Could something be wrong in my NITF file and was not detected by
Mr.BIIF? How do I know?
What field(s) does GetGeoTransform() look for?
Thanks in advance for any help.

Ke Zeng 



From wly3000 at hotmail.com  Wed Dec 24 09:59:31 2003
From: wly3000 at hotmail.com (wang liyan)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] band concept of GDAL data model
Message-ID: <SEA1-F4zUSxvjPkQTGp00034a68@hotmail.com>

 Hi,

   What I want is to change a one-band image into a image with 4 bands 
image.
   
I have already read the image data by using RasterIO method,the type of 
origion 

image is GDT_Byte.Then how to create an 4 bands image which type is 
GDT_Float32?

I have read the GDAL data model for several times.But i don't quiet 
understand it.

Can any experts help me?

    Thanks in advanced!
    
                                    jeff

_________________________________________________________________
 MSN Messenger:  http://messenger.msn.com/cn  


From warmerdam at pobox.com  Sun Dec 28 11:46:50 2003
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] band concept of GDAL data model
In-Reply-To: <SEA1-F4zUSxvjPkQTGp00034a68@hotmail.com>
References: <SEA1-F4zUSxvjPkQTGp00034a68@hotmail.com>
Message-ID: <3FEF08FA.3070102@pobox.com>

wang liyan wrote:
> 
> Hi,
> 
>   What I want is to change a one-band image into a image with 4 bands 
> image.
>   I have already read the image data by using RasterIO method,the type 
> of origion
> image is GDT_Byte.Then how to create an 4 bands image which type is 
> GDT_Float32?
> 
> I have read the GDAL data model for several times.But i don't quiet 
> understand it.
> 
> Can any experts help me?
> 
>    Thanks in advanced!
>                                       jeff

Jeff,

The details will vary but basically you would use the Create()
method on the GDALDriver class to create a new file with the
desired dimensions, number of bands and band data type, and then
use the RasterIO() method to read from your source file and then
write to your destination file.  You will need to review the API
documentation to do some of this.  The tutorial should cover much
of what you need:

  http://www.remotesensing.org/gdal/gdal_tutorial.html

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent



From hamdi_ines2003 at yahoo.fr  Mon Dec 29 04:54:48 2003
From: hamdi_ines2003 at yahoo.fr (=?iso-8859-1?q?hamdi=20ines?=)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] problem with configure xerces-c1_6_0 into gdal
Message-ID: <20031229095448.66611.qmail@web14716.mail.yahoo.com>

hello ,
I have a questions but before i descripe my platform
and installed soft:
platform: redhat 8
the soft installed:
-the binary version of grass57-10-10
-gdal1.1.9
-xerces-c_1.1.6(from the source)
-gdal-cvs-031220
-proj-4.4.1
-postgresql7.3.2
my question is:
I have a gml file named ionic_wfs.gml placed
in/home/gml_samples, i want to read and manupulate it
with the grass57 command: ogr2ogr, v.in.ogr and
v.out.ogr, ogrinfo.. but i have many problem:
with ogrinfo :
GRASS 5.7.-cvs:~ > ogrinfo
home/gml_samples/ionic_wfs.gml
ERROR 1: Unable to create Xerces C++ based GML reader,
Xerces support
not configured into GDAL/OGR.
ERROR 1: File /home/gml_samples/ionic_wfs.gml appears
to be GML but the GML reader can't
be instantiated, likely because Xerces support wasn't
configured in.
FAILURE:
Unable to open datasource
`/home/gml_samples/ionic_wfs.gml' with the following
drivers.
  -> ESRI Shapefile
  -> UK .NTF
  -> SDTS
  -> TIGER
  -> S57
  -> MapInfo File
  -> DGN
  -> VRT
  -> AVCBin
  -> REC
  -> Memory
  -> GML
with v.in.ogr:
GRASS 5.7.-cvs:~ > v.in.ogr dsn=/home/gml_samples/
output=grass_test
ERROR: Cannot open data source
with v.out.ogr:
GRASS 5.7.-cvs:~ > v.out.ogr -c input=ionic_wfs.gml
dsn=/home/gml_samples/ layer=gmlfile
ERROR: Could not find input map <ionic_wfs.gml>
with ogr2ogr:
GRASS 5.7.-cvs:~ > ogr2ogr -f shp /home/gml_samples/
/home/gml_samples/ionic_wfs.gml
ERROR 1: Unable to create Xerces C++ based GML reader,
Xerces support
not configured into GDAL/OGR.
ERROR 1: File /home/gml_samples/ionic_wfs.gml appears
to be GML but the GML reader can't
be instantiated, likely because Xerces support wasn't
configured in.
FAILURE:
Unable to open datasource
`/home/gml_samples/ionic_wfs.gml' with the following
drivers.
  -> ESRI Shapefile
  -> UK .NTF
  -> SDTS
  -> TIGER
  -> S57
  -> MapInfo File
  -> DGN
  -> VRT
  -> AVCBin
  -> REC
  -> Memory
  -> GML
from this i tried to configure xerces in gdal/ogr but
the result is:
conftest.cpp:5:parse error before '::' token
configure: error : please correct xerces options,
don't enables xerces.
I m dont understand the problem , please if you have
other method to configure xerces send it me because i
need it.
THANKES ADVANCED
HAMDI In?s

___________________________________________________________
Do You Yahoo!? -- Une adresse @yahoo.fr gratuite et en fran?ais !
Yahoo! Mail : http://fr.mail.yahoo.com

From wly3000 at hotmail.com  Tue Dec 30 07:49:56 2003
From: wly3000 at hotmail.com (wang liyan)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] band concept of GDAL data model
Message-ID: <Sea1-F56lnTJMs5H9vM0003bc1d@hotmail.com>

Frank Warmerdam,
     Thank you very much for your help! Now I have solved the problem.

                                       jeff

>From: Frank Warmerdam <warmerdam@pobox.com>
>Reply-To: gdal-dev@remotesensing.org
>To: gdal-dev@remotesensing.org
>Subject: Re: [Gdal-dev] band concept of GDAL data model
>Date: Sun, 28 Dec 2003 11:46:50 -0500
>
>wang liyan wrote:
> >
> > Hi,
> >
> >   What I want is to change a one-band image into a image with 4 bands
> > image.
> >   I have already read the image data by using RasterIO method,the type
> > of origion
> > image is GDT_Byte.Then how to create an 4 bands image which type is
> > GDT_Float32?
> >
> > I have read the GDAL data model for several times.But i don't quiet
> > understand it.
> >
> > Can any experts help me?
> >
> >    Thanks in advanced!
> >                                       jeff
>
>Jeff,
>
>The details will vary but basically you would use the Create()
>method on the GDALDriver class to create a new file with the
>desired dimensions, number of bands and band data type, and then
>use the RasterIO() method to read from your source file and then
>write to your destination file.  You will need to review the API
>documentation to do some of this.  The tutorial should cover much
>of what you need:
>
>   http://www.remotesensing.org/gdal/gdal_tutorial.html
>
>Best regards,
>
>--
>---------------------------------------+--------------------------------------

>I set the clouds in motion - turn up   | Frank Warmerdam, 
warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent
>
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@remotesensing.org
>http://remotesensing.org/mailman/listinfo/gdal-dev

_________________________________________________________________
 MSN Messenger:  http://messenger.msn.com/cn  


From list67 at netscape.net  Wed Dec 31 16:23:14 2003
From: list67 at netscape.net (list67@netscape.net)
Date: Wed Nov 21 11:49:01 2007
Subject: [Gdal-dev] number of GCPs
Message-ID: <488A187B.1DF65849.00066B75@netscape.net>

Hello.  I was wondering if there is a limit to the number of GCPs that can be added to a TIFF file.  A program that I'm working on uses GDALSetGCPs(...) to add GCPs to a TIFF file.  I've attatched a sample program that takes as input 2 filenames.  The first argument is a tiff filename of an existing tiff file.  The second argument is a filename for a new corresponding tiff file that has GCPs added for each pixel in the original file.  There are also some example tiff files attatched.

So, when I run the program with a 10x10 tiff file, gdalinfo outputs all the GCPs.  None of the other files seem to work (78x78, 256x256, 1200x1200).  I looked into the code and changed int16 to int (in frmts/gtiff/geotiff.cpp Line 2291) and u_short to int on Line 989 of frmts/gtiff/libtiff/tif_dir.c.  This did not seem to fix anything though.

I'm using a version of GDAL obtained via CVS.

    Mike


__________________________________________________________________
New! Unlimited Access from the Netscape Internet Service.
Beta test the new Netscape Internet Service for only $1.00 per month until 3/1/04.
Sign up today at http://isp.netscape.com/register
Act now to get a personalized email address!

Netscape. Just the Net You Need.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: testGCPWrite.tar.gz
Type: application/x-gzip-compressed
Size: 6547 bytes
Desc: testGCPWrite.tar.gz
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20031231/46095fa3/testGCPWrite.tar.bin
