From bartvde at xs4all.nl  Mon Mar  1 11:15:45 2004
From: bartvde at xs4all.nl (bartvde@xs4all.nl)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] ogr2ogr and Oracle: 3D instead of 2D
Message-ID: <4567.212.238.227.182.1078157745.squirrel@webmail.xs4all.nl>

Hi list,

we are trying to use ogr2ogr to import a MapInfo datasource into Oracle
Spatial. The MapInfo datasource is in the RD system (EPSG:28992) and is a
2D datasource. We are getting all data in Oracle in 3D instead of in 2D,
without requesting it specifically.

We are trying:

ogr2ogr -f OCI OCI:usr/pass@mydb e:\Projecten\EduGis\ApeldoornProef -lco
OVERWRITE=YES -s_srs EPSG:28992 -nlt POLYGON apeldoorn_vlak

Anybody have an idea why we get 3D (3003 instead of 2003)?

Best regards,
Bart

From warmerdam at pobox.com  Mon Mar  1 11:29:15 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] ogr2ogr and Oracle: 3D instead of 2D
In-Reply-To: <4567.212.238.227.182.1078157745.squirrel@webmail.xs4all.nl>
References: <4567.212.238.227.182.1078157745.squirrel@webmail.xs4all.nl>
Message-ID: <404364DB.8050608@pobox.com>

bartvde@xs4all.nl wrote:
> Hi list,
> 
> we are trying to use ogr2ogr to import a MapInfo datasource into Oracle
> Spatial. The MapInfo datasource is in the RD system (EPSG:28992) and is a
> 2D datasource. We are getting all data in Oracle in 3D instead of in 2D,
> without requesting it specifically.
> 
> We are trying:
> 
> ogr2ogr -f OCI OCI:usr/pass@mydb e:\Projecten\EduGis\ApeldoornProef -lco
> OVERWRITE=YES -s_srs EPSG:28992 -nlt POLYGON apeldoorn_vlak
> 
> Anybody have an idea why we get 3D (3003 instead of 2003)?

Bart,

The Oracle driver in OGR defaults to creating tables with a dimension of 3.
Use the "-lco DIM=2" command arg to force to 2D.

This is described in the layer creation options section of the Oracle Spatial
driver page at:

   http://www.remotesensing.org/gdal/ogr/drv_oci.html

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.wilkie at gov.yk.ca  Mon Mar  1 13:07:36 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] spatial data
In-Reply-To: <BAY1-F1310psNK2v9eH00001077@hotmail.com>
References: <BAY1-F1310psNK2v9eH00001077@hotmail.com>
Message-ID: <40437BE8.4090701@gov.yk.ca>

Saurabh Data wrote:
> Dear readers
> 
> I am a student doing research on "spatial databass; an analysis of open
> source systems". so I need to find open source system which support
> spatial content.
[...]
> I am still searching for more systems , which might be of any help.

A good place to start is http://freegis.org/
*Everything* listed there is both open source and spatially aware.

> Can anyone give me a brief idea of what does GDAL does and how does it
> fit in the context of spatial data.

In a nutshell, gdal is a spatial data translator. It reads data in most 
formats and converts it to a well known flavour of your choice. GDAL is 
for raster data (images, dems); the sister OGR project is for vector 
data (lines, points, polygons). At some point OGR and GDAL will likely 
be completely merged together.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From warmerdam at pobox.com  Mon Mar  1 13:48:02 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release
Message-ID: <40438562.30702@pobox.com>

Folks,

I have worked hard clearing up old bug reports, and reported build problems
with the GDAL alpha release and now I have a new cut I consider "Beta" quality.
I would appreciate people checking it out and reporting any problems.

If all goes well, I may cut a final release essentially matching this in a
couple of days.

   ftp://ftp.remotesensing.org/gdal/gdal-1.2.0b.tar.gz
   ftp://ftp.remotesensing.org/gdal/gdal120b.tar.gz

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From eric.sokolowsky at gsfc.nasa.gov  Mon Mar  1 16:30:36 2004
From: eric.sokolowsky at gsfc.nasa.gov (Eric Sokolowsky)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Creation of geotiff files with gdalwarp that have a transparent
 background
Message-ID: <Pine.LNX.4.44.0403011623180.16752-100000@cusco.gsfc.nasa.gov>

I have been experimenting with the gdal library, specifically the
gdalwarp tool included with the library.  It is very useful, and I have
been able to transform images to a geographic projection.  Is there is a
way to specify a default background color?  Specifically, I wish to
create a geotiff file where the areas not covered by the original source
file are transparent.  Is this possible, or do I need to start hacking
gdal?  Would this change be generally useful to others?

-- 
    ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center 
   / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
  / __/ _/ / _/ 301.286.3751                  Mailstop 935.0 Bldg 28 Rm E102
 /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771


From warmerdam at pobox.com  Mon Mar  1 16:51:06 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Creation of geotiff files with gdalwarp that have
 a transparent background
In-Reply-To: <Pine.LNX.4.44.0403011623180.16752-100000@cusco.gsfc.nasa.gov>
References: <Pine.LNX.4.44.0403011623180.16752-100000@cusco.gsfc.nasa.gov>
Message-ID: <4043B04A.1060302@pobox.com>

Eric Sokolowsky wrote:
> I have been experimenting with the gdal library, specifically the
> gdalwarp tool included with the library.  It is very useful, and I have
> been able to transform images to a geographic projection.  Is there is a
> way to specify a default background color?  Specifically, I wish to
> create a geotiff file where the areas not covered by the original source
> file are transparent.  Is this possible, or do I need to start hacking
> gdal?  Would this change be generally useful to others?
> 

Eric,

The default output value of a raster can be set with the INIT_DEST
warp options.

eg.

gdalwarp in.tif out.tif -t_srs WGS84 -wo INIT_DEST=255

The arguments can be a list of values if you want to apply different
values to different output bands.  The default is to set all output bands
to zero.

One issue you face is how to make something transparent in
TIFF format.  TIFF supports transparency if you use RGBA format.  That
is four bands with red, green, blue and alpha (transparency).  But if
your inputs is just RGB there is no obvious way to force gdalwarp to
produce an RGBA output file, and to treat the alpha band as a proper
transparency overlay.

The underlying Warp API does contain mechanisms whereby an application
might be able to maintain an alpha band properly, but the gdalwarp
program has no mechanism to take advantage of it.  Furthermore, this
hasn't really be used in the warp api so there may be issues I didn't
anticipate.

Currently, the gdalwarp assumption is that nodata pixel values will be
used to mark unset areas.  So that might involve picking a "background"
value, like 0, to mark all unset areas.  INIT_DEST could be used to
pre-apply this to the output file if a non-zero value were used.  Then
the warper would replace all pixels for which a value exists.   No mechanism
exists to ensure that the nodata value doesn't existing in the valid image
data though.

I think it would make sense to modify gdalwarp to explicitly support
transparency layers.  Some common forms I could imagine are:

  o An extra output band used to hold transparency.  Normally this would
    be assigned 0 to unset pixels and 255 for set pixels.
  o A seperate validity file.

Both mechanisms should also be supported on input, in addition to the
current -srcnodata switch.

Implementing these capabilities would be a fair amount of work, likely at
least a day.  I don't forsee getting to it in the near future, but if you
have a pressing need I might be able to do a quick effort sufficient to
your needs.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From bclay at ball.com  Mon Mar  1 17:21:14 2004
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Landsat
Message-ID: <E4394C8445EFCC4AA136A1C305E4C92851C8C2@APPMSG2.AERO.BALL.COM>

Are there any functions in the GDAL package for working with Landsat
images, in particular merging multiple layers into a single (RGB) images
and selecting a specific subset of the image.

Bruce
bclay@ball.com

From matt.wilkie at gov.yk.ca  Mon Mar  1 18:26:22 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Landsat
In-Reply-To: <E4394C8445EFCC4AA136A1C305E4C92851C8C2@APPMSG2.AERO.BALL.COM>
References: <E4394C8445EFCC4AA136A1C305E4C92851C8C2@APPMSG2.AERO.BALL.COM>
Message-ID: <4043C69E.7040307@gov.yk.ca>

Clay, Bruce wrote:

> Are there any functions in the GDAL package for working with Landsat
> images, in particular merging multiple layers into a single (RGB) images
 > and selecting a specific subset of the image.

See the -projwin or -srcwin options of gdal_translate for the 
subsetting. http://www.remotesensing.org/gdal/gdal_utilities.html

You can use the "-b" option for selecting/reordering particular bands 
but I believe all the bands have to in the same source file rather than 
band1.tif, band2.tif, etc. (I would love to be proven wrong about this)


Somebody else will have to answer about accessing programmaticaly from 
the library functions.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From eric.sokolowsky at gsfc.nasa.gov  Mon Mar  1 18:31:20 2004
From: eric.sokolowsky at gsfc.nasa.gov (Eric Sokolowsky)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Creation of geotiff files with gdalwarp that have a
 transparent background
In-Reply-To: <4043B04A.1060302@pobox.com>
Message-ID: <Pine.LNX.4.44.0403011818480.16752-100000@cusco.gsfc.nasa.gov>

On Mon, 1 Mar 2004, Frank Warmerdam wrote:

> Eric Sokolowsky wrote:
> > I have been experimenting with the gdal library, specifically the
> > gdalwarp tool included with the library.  It is very useful, and I have
> > been able to transform images to a geographic projection.  Is there is a
> > way to specify a default background color?  Specifically, I wish to
> > create a geotiff file where the areas not covered by the original source
> > file are transparent.  Is this possible, or do I need to start hacking
> > gdal?  Would this change be generally useful to others?
> > 
> 
> Eric,
> 
> The default output value of a raster can be set with the INIT_DEST
> warp options.
> 
> eg.
> 
> gdalwarp in.tif out.tif -t_srs WGS84 -wo INIT_DEST=255

This is a useful option, and I had missed it.  Thanks for pointing it 
out.  But, as you say below, it can't be used to add alpha to an image
that didn't have it before.


> The arguments can be a list of values if you want to apply different
> values to different output bands.  The default is to set all output bands
> to zero.
> 
> One issue you face is how to make something transparent in
> TIFF format.  TIFF supports transparency if you use RGBA format.  That
> is four bands with red, green, blue and alpha (transparency).  But if
> your inputs is just RGB there is no obvious way to force gdalwarp to
> produce an RGBA output file, and to treat the alpha band as a proper
> transparency overlay.

Yes, I gathered this from the documentation and the source.  I was just
wondering if I had missed something.


> The underlying Warp API does contain mechanisms whereby an application
> might be able to maintain an alpha band properly, but the gdalwarp
> program has no mechanism to take advantage of it.  Furthermore, this
> hasn't really be used in the warp api so there may be issues I didn't
> anticipate.
> 
> Currently, the gdalwarp assumption is that nodata pixel values will be
> used to mark unset areas.  So that might involve picking a "background"
> value, like 0, to mark all unset areas.  INIT_DEST could be used to
> pre-apply this to the output file if a non-zero value were used.  Then
> the warper would replace all pixels for which a value exists.   No mechanism
> exists to ensure that the nodata value doesn't existing in the valid image
> data though.
> 
> I think it would make sense to modify gdalwarp to explicitly support
> transparency layers.  Some common forms I could imagine are:
> 
>   o An extra output band used to hold transparency.  Normally this would
>     be assigned 0 to unset pixels and 255 for set pixels.

This limited support would be perfectly adequate for my purposes.


>   o A seperate validity file.

This would not be as useful because then I would have to combine it with
my image separately.


> Both mechanisms should also be supported on input, in addition to the
> current -srcnodata switch.
> 
> Implementing these capabilities would be a fair amount of work, likely at
> least a day.  I don't forsee getting to it in the near future, but if you
> have a pressing need I might be able to do a quick effort sufficient to
> your needs.

Well, I certainly appreciate the support.  My need is not extremely pressing
at this time.  (This may change after the staff meeting tomorrow.)  As I 
was looking at the source code for the geotiff format, I saw that there
are only a few places where the number of bands (nBands), so I was going
to try to see if I could add minimal support myself.  Since I am only 
concerned about geotiff output, I would localize all changes there.

-- 
    ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center 
   / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
  / __/ _/ / _/ 301.286.3751                  Mailstop 935.0 Bldg 28 Rm E102
 /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771


From nhv at cape.com  Mon Mar  1 18:55:58 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Landsat
In-Reply-To: <E4394C8445EFCC4AA136A1C305E4C92851C8C2@APPMSG2.AERO.BALL.COM>
Message-ID: <EKEJIKAILPONGGENMBGAEEOMGJAA.nhv@cape.com>

Clay, Bruce writes:
> 
> Are there any functions in the GDAL package for working with Landsat
> images, in particular merging multiple layers into a single (RGB) images
> and selecting a specific subset of the image.

Probably easiest to do with Python

see attached simplistic script for merging bands to RGB and
gdal_merge.py, gdalwarp or gdal_translate for clipping ops
or extend the script todo your clipping too :-)

note attached script is realy just to demonstrate 'how' this
could be done and not really designed for production use
where you  would probably want todo color correction also

HTH

Norman
-------------- next part --------------
#! /usr/bin/python
"""
Make a RGB LandSat Image with color correction
using bands 3 2 1 as R G B

Expects one argument
    basename of dataset
    ie without the trailing '_nnX.tif'
    all 3 band files must exist in the same directory

Needs the Numeric
http://www.pfdubois.com/numpy/

the GDAL extension
http://www.remotesensing.org/gdal
prebuilt extensions included in OpenEV
http://openev.sourceforge.net/

and the Python Imaging extensions <PIL>
http://www.pythonware.com/products/pil/

Author: Norman Vine - nhv@cape.com
"""

import os,sys
from gdalnumeric import *
from PIL import Image,ImageOps
from gzip import GzipFile


# change this to suit
#DEFAULT_FILE = "p012r30_5t900908"
DEFAULT_FILE = "p004r48_4t920625"
#DEFAULT_FILE = "p012r30_5t900908"


def red_lut():
    return make_lut(0.6024, -1.5, 7.0/256.0)

def green_lut():
    return make_lut(1.1749, -2.8, 5.0/256.0)

def blue_lut():
    return make_lut(0.8059, -1.2, 3.0/256.0)

def ColorCorrect(band, lut, clip=None):
    image = ArrayToImage(band)
    # transform image with our lut
    image = image.point(lut)
    # stretch contrast by ignoring the black background
    # and clipping a bit of our histogram's tails
    # original LandSat Images apparently have [0 0 0] for background
    image = ImageOps.autocontrast(image,cutoff=clip,ignore=[0,254,255])
    return ImageToArray(image)
    """
    return ImageToArray(ImageOps.autocontrast(ArrayToImage(band).point(lut),cutoff=clip,ignore=[0]))
    """
    
def makeLandsatRGB(base_name, LUT=None):
    """ """
    print "\nProcessing %s\n"%(base_name)

    if LUT is None:
        print "creating LUTs\n"
        LUT = [red_lut(),green_lut(),blue_lut()]

    ds = getBands(base_name)

    merged_ds = getMerged(base_name, ds)

    BANDS = ["RED","GREEN","BLUE"]
    print "\nprocessing"
    for i in range(1,4,1):
        print"\t band %s"%(BANDS[i-1])
        print "\t\treading"
        band = BandReadAsArray(ds[i-1].GetRasterBand(1),0,0,None,None)
        print "\t\ttransforming"
        band = ColorCorrect(band, LUT[i-1], clip=0.01)
        print"\t\twriting"
        BandWriteArray( merged_ds.GetRasterBand(i), band )

    for i in range(1,4,1):
        os.remove("%s_nn%d.tif"%(base_name,i))
    
    print "\n=== %s.tif written ===\n"%(base_name)

def splitLandsatRGB(base_name,data_path="./"):
    """  """
    data_path=os.path.join(data_path,base_name)
    print "\nProcessing %s\n"%(data_path)
    merged_ds = gdal.Open("%s.tif"%(data_path)) #(base_name))

    print "\tRed:   %s_nn3.tif"%(base_name)
    red_ds = gdal.GetDriverByName("GTiff").Create(
        "%s_nn3.tif"%(base_name), merged_ds.RasterXSize, merged_ds.RasterYSize, 1 )
    CopyDatasetInfo(merged_ds, red_ds )
    BandWriteArray( red_ds.GetRasterBand(1), BandReadAsArray(merged_ds.GetRasterBand(1),0,0,None,None) )

    print "\tGreen: %s_nn2.tif"%(base_name)
    green_ds = gdal.GetDriverByName("GTiff").Create(
        "%s_nn2.tif"%(base_name), merged_ds.RasterXSize, merged_ds.RasterYSize, 1 )
    CopyDatasetInfo(merged_ds, green_ds )
    BandWriteArray( green_ds.GetRasterBand(1), BandReadAsArray(merged_ds.GetRasterBand(2),0,0,None,None) )

    print "\tBlue:  %s_nn1.tif"%(base_name)
    blue_ds = gdal.GetDriverByName("GTiff").Create(
        "%s_nn1.tif"%(base_name), merged_ds.RasterXSize, merged_ds.RasterYSize, 1 )
    CopyDatasetInfo(merged_ds, blue_ds )
    BandWriteArray( blue_ds.GetRasterBand(1), BandReadAsArray(merged_ds.GetRasterBand(3),0,0,None,None) )


def unzip(fname):
    out_file = open(fname,"wb")
    zip_file = GzipFile(fname+".gz","r")
    out_file.write(zip_file.read(size=-1))
        
def ArrayToImage(a):
    i=Image.fromstring('L',(a.shape[1],a.shape[0]),
        (a.astype('b')).tostring())
    return i

def ImageToArray(i):
    a=fromstring(i.tostring(),'b')
    a.shape=i.im.size[1], i.im.size[0]
    return a

def getBands(base_name):    
    print "unzipping"
    ds = []
    for i in range(3,0,-1):
        getBand(ds,base_name,i)
    return ds

def getBand(ds,base_name,i):
    print"\t band %d"%(i)
    name = "%s_nn%d.tif"%(base_name,i)
    unzip(name)
    ds.append(gdal.Open(name))

def getMerged(base_name, ds):    
    merged_ds = gdal.GetDriverByName("GTiff").Create(
        "%s.tif"%(base_name), ds[0].RasterXSize, ds[0].RasterYSize, 3 )
    CopyDatasetInfo(ds[0],merged_ds )
    return merged_ds
    
def stretch(band):
    mmin = minimum.reduce(ravel(band))
    mmax = maximum.reduce(ravel(band))
    band = (band - mmin) / (mmax - mmin)
    return band
    
def make_lut(gain,bias,exposure):
    lut  = arange(0,256,1,'f')
    ilut = arange(0,256,1,'b')
    lut = clip(256-256*exp(-exposure*(gain*lut+bias)),0,255)
    for i in range(256):
        ilut[i] = lut[i]
#    print ilut
    return ilut

if __name__ == "__main__":
#    if len(sys.argv) > 1:
#        fname = sys.argv[1]
#    else:
#        fname = DEFAULT_FILE
#    names = ["p012r30_5t900908","p011r31_5t901003","p012r31_5t870916",
#             "p007r52_5t19861231","p007r53_5t19861231","p013r55_4t880206" ]
#             "p004r48_4t920625","p004r47_5t910207"]

#    makeLandsatRGB("p011r31_5t901003")
#    names = ["p012r43_5t19840603"]
    
#    for fname in names:
#        makeLandsatRGB(dirname,fname)
#        splitLandsatRGB(fname)
#        os.system("../PrepData/Prepland3 %s_nn"%(fname))
        
#    hires_names = ["1","2"]
#    hires_names = ["stcroix_e","stcroix_w"]
#    hires_names = ["stcroix_w"]
#    hires_names = ["hadleys","quisset","juniper"]
    data_path = "f:/data/processed"
    for fname in hires_names:
        makeLandsatRGB(fname)
        splitLandsatRGB(fname,data_path)
        os.system("../PrepData/Prepland3 %s_nn"%(fname))

        
        
From gilber at milcse.cig.mot.com  Mon Mar  1 04:14:09 2004
From: gilber at milcse.cig.mot.com (David Gilberstadt)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] unresolved externals for OGR in Windows
Message-ID: <000801c3ff6d$8ee33940$5aef0991@milcse.cig.mot.com>

Can anyone help me with the following problem linking
with OGR under Windows.

Version of GDAL:  gdal-1.2.0a4

My app is linked with gdal_i.lib. 
I successfully called functions from GDAL (i.e. GDALOpen() ), but when
I added a call to an OGR function, I get unresolved externals for all
the OGR functions(69 in number).

I have analyzed the gdal12.dll and all the stubs for the OGR
functions are there. 

I would appreciate any help,
Thank you
David Gilberstadt 



From ganny_3 at rediffmail.com  Mon Mar  1 18:59:08 2004
From: ganny_3 at rediffmail.com (Ganesh  P)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Shape file display using AVL legend file
Message-ID: <20040301235908.12459.qmail@webmail31.rediffmail.com>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040301/ab756cea/attachment.html
-------------- next part --------------
Hello everyone

I am new to GDAL and OGR. Currently we are using Mapserver 4.0 with PHP/Mapscript and GDAL support on RedHat Linux 9.0. 
We have developed a web-interface to display the raster imagery using GDAL and Mapserver and is working very well. Now, we have started displaying vector (shape) files and needed some help. 
The problem is as follows:
       We have a single base map(shape file) and a few .AVL(Arc View legend) files associated with that shape file to display different maps and their corresponding legends. In ArcView, when i view the shape file with different AVL files, i get different maps and color legends. 
I wanted to know, if there is any library/utility that reads the AVL files and generates the color legend and the corresponding shape file that can be used to display with mapserver ?  

I have been looking on the google for a few days but couldnt find anything useful. And we are in need of finishing this very soon.

Can anyone help me on this issue ? If possible can you send me some example code or may be as to how to approach for this problem.
Any help is greatly appreciated.

Thanks 
Ganesh


From support at geoimage.fr  Tue Mar  2 10:32:30 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
Message-ID: <087101c4006b$93980250$e32346c0@pili>

Hello,

I am trying to build GDAL with a static link of the Proj4 library.

*** On Solaris, I have the following problem :

My configure line is :

 $ ./configure \
--prefix=$(geolib)/libGDAL_OGR/src/SOLARIS2_6/gdal/RELEASE \
--with-libtiff=$(geolib)/libTIFF/src/SOLARIS2_6  \
--with-geotiff=$(geolib)/libGEOTIFF/src/SOLARIS2_6  \
--with-local=$(geolib)/libHDF/src/SOLARIS  \
--with-threads=-"lposix4 -lnsl" \
--with-hdf4=$(geolib)/libHDF/src/SOLARIS  \
--without-jasper  \
--with-jpeg=internal \
 --with-libz=internal  \
--with-png=internal  \
--without-libtool  \
--without-ld-shared  \
--with-static-proj4=$(geolib)/libPROJ/src/SOLARIS2_6

the libproj.a library is searched in the 'src' directory  under the specified proj directory.
The problem is that when Proj is build with libtool, the src directory doesn't contain
any library. The library is in the ".libs" sub-directory.

Perhaps configure should look directly inside the specified directory ( This allows to
specify either the lib directory resulting of a 'make install' or the '.libs' directory inside
the build tree).

*** On Win32, I specify a static proj link in nmake.opt :

PROJ_FLAGS = -DPROJ_STATIC
PROJ_INCLUDE = -Iz:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\include
PROJ_LIB = z:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\lib

But It looks like PROJ_LIB is never used... I have to add '$PROJ_LIB\proj.lib' to ADD_LIBS
in order to properly link.
Am i missing something ?

Any comments appreciated,
Best regards,

Fr?d?ric.
_________________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From lorenzo.moretti at bologna.enea.it  Tue Mar  2 10:51:57 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <40438562.30702@pobox.com>
References: <40438562.30702@pobox.com>
Message-ID: <a06020400bc6a56f5a928@[192.107.62.86]>

>Folks,
>
>I have worked hard clearing up old bug reports, and reported build problems
>with the GDAL alpha release and now I have a new cut I consider 
>"Beta" quality.
>I would appreciate people checking it out and reporting any problems.
>
>If all goes well, I may cut a final release essentially matching this in a
>couple of days.
>
>   ftp://ftp.remotesensing.org/gdal/gdal-1.2.0b.tar.gz
>   ftp://ftp.remotesensing.org/gdal/gdal120b.tar.gz
>
>Best regards,

Until gdal_cvs-1.2.0a I have built binary in OSX very well.

 From this version 1.2.0b it's impossible to build from source.
The error is in raw format (inside frmts formats)

This is the error:

....
/bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common 
-no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore 
-I../../ogr -I../../port -c -o ../o/fastdataset.o fastdataset.cpp
  g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD 
-I../../port -I../../gcore -I../../ogr -I../../port -c 
fastdataset.cpp  -fno-common -DPIC -o ../o/.libs/fastdataset.o
fastdataset.cpp: In function `static GDALDataset*
    FASTDataset::Open(GDALOpenInfo*)':
fastdataset.cpp:607: warning: `char*pszValue' might be used uninitialized in
    this function
  g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD 
-I../../port -I../../gcore -I../../ogr -I../../port -c 
fastdataset.cpp -o ../o/fastdataset.o >/dev/null 2>&1
/bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common 
-no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore 
-I../../ogr -I../../port -c -o ../o/atlsci_spheroid.o 
atlsci_spheroid.cpp
  g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD 
-I../../port -I../../gcore -I../../ogr -I../../port -c 
atlsci_spheroid.cpp  -fno-common -DPIC -o ../o/.libs/atlsci_spheroid.o
  g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD 
-I../../port -I../../gcore -I../../ogr -I../../port -c 
atlsci_spheroid.cpp -o ../o/atlsci_spheroid.o >/dev/null 2>&1
/bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common 
-no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore 
-I../../ogr -I../../port -c -o ../o/btdataset.o btdataset.cpp
  g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD 
-I../../port -I../../gcore -I../../ogr -I../../port -c btdataset.cpp  
-fno-common -DPIC -o ../o/.libs/btdataset.o
btdataset.cpp: In member function `virtual CPLErr BTRasterBand::IReadBlock(int,
    int, void*)':
btdataset.cpp:133: error: `nWordSize' undeclared (first use this function)
btdataset.cpp:133: error: (Each undeclared identifier is reported only once for
    each function it appears in.)
make[2]: *** [../o/btdataset.o] Error 1
make[1]: *** [raw-install-obj] Error 2
make: *** [frmts-target] Error 2
[lor:APPLI/gdal-cvs-040302] lor%

The file btdataset.cpp has a new version (1.4 vs 1.3 of old 1.2.0a).
I check this file and at line 130

/* -------------------------------------------------------------------- */
/*      Swap on MSB platforms.                                          */
/* -------------------------------------------------------------------- */
#ifdef CPL_MSB
     GDALSwapWords( pImage, nDataSize, nRasterYSize, nWordSize );
#endif   

nWordSize is undeclared.

Thank for fixing !!

Another problem:

I have QUICK BIRD image files:

Gdal read the band in wrong mode.
It creates
xxxx.red channel
xxxx.green channel
xxxx.blue channel
xxxx.alpha channel

QUICK BIRD has this format
xxxx.blue channel
xxxx.green channel
xxxx.red channel
xxxx.alpha channel

QUICK BIRD has 4 files
03MAY19095313-M2AS_R1C2-000000040462_01_P002.TIF	(Multispectral file)
03MAY19095313-M2AS_R1C2-000000040462_01_P002.TIL	(Tile of group image)
03MAY19095313-M2AS_R1C2-000000040462_01_P002.IMD	(Image description)
03MAY19095313-M2AS_R1C2-000000040462_01_P002.RPB	(Parameter of image)

Is it possible to fix this error ??

-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot              Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040302/4fe4d274/attachment.html
From warmerdam at pobox.com  Tue Mar  2 10:55:59 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <087101c4006b$93980250$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili>
Message-ID: <4044AE8F.4070702@pobox.com>

Fr?d?ric Trastour wrote:
> Hello,
> 
> I am trying to build GDAL with a static link of the Proj4 library.
> 
> *** On Solaris, I have the following problem :
> 
> My configure line is :
> 
>  $ ./configure \
> --prefix=$(geolib)/libGDAL_OGR/src/SOLARIS2_6/gdal/RELEASE \
> --with-libtiff=$(geolib)/libTIFF/src/SOLARIS2_6  \
> --with-geotiff=$(geolib)/libGEOTIFF/src/SOLARIS2_6  \
> --with-local=$(geolib)/libHDF/src/SOLARIS  \
> --with-threads=-"lposix4 -lnsl" \
> --with-hdf4=$(geolib)/libHDF/src/SOLARIS  \
> --without-jasper  \
> --with-jpeg=internal \
>  --with-libz=internal  \
> --with-png=internal  \
> --without-libtool  \
> --without-ld-shared  \
> --with-static-proj4=$(geolib)/libPROJ/src/SOLARIS2_6
> 
> the libproj.a library is searched in the 'src' directory  under the specified proj directory.
> The problem is that when Proj is build with libtool, the src directory doesn't contain
> any library. The library is in the ".libs" sub-directory.
> 
> Perhaps configure should look directly inside the specified directory ( This allows to
> specify either the lib directory resulting of a 'make install' or the '.libs' directory inside
> the build tree).

Fr?d?ric,

You are setting up a pretty hard configuration!   I would suggest you
install the PROJ.4 tree, even if only into a local tree and then use
that to link against instead.  That will avoid the libtool related issues.

> *** On Win32, I specify a static proj link in nmake.opt :
> 
> PROJ_FLAGS = -DPROJ_STATIC
> PROJ_INCLUDE = -Iz:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\include
> PROJ_LIB = z:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\lib
> 
> But It looks like PROJ_LIB is never used... I have to add '$PROJ_LIB\proj.lib' to ADD_LIBS
> in order to properly link.
> Am i missing something ?

Hmm, it would seem we missed this.  I have added PROJ_LIB into the EXTERNAL_LIBS
macro now.  Your local change should be fine too.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Mar  2 11:05:03 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <a06020400bc6a56f5a928@[192.107.62.86]>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]>
Message-ID: <4044B0AF.3070109@pobox.com>

Lorenzo Moretti wrote:
>> Folks,
>>
>> I have worked hard clearing up old bug reports, and reported build 
>> problems
>> with the GDAL alpha release and now I have a new cut I consider "Beta" 
>> quality.
>> I would appreciate people checking it out and reporting any problems.
>>
>> If all goes well, I may cut a final release essentially matching this in a
>> couple of days.
>>
>>   ftp://ftp.remotesensing.org/gdal/gdal-1.2.0b.tar.gz
>>   ftp://ftp.remotesensing.org/gdal/gdal120b.tar.gz
> 
>> Best regards,
> 
> 
> Until gdal_cvs-1.2.0a I have built binary in OSX very well.
> 
>  From this version 1.2.0b it's impossible to build from source.
> The error is in raw format (inside frmts formats)
> 
> This is the error:
> 
>     ....
> 
>     /bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common
>     -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore
>     -I../../ogr -I../../port -c -o ../o/fastdataset.o fastdataset.cpp
> 
>      g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD
>     -I../../port -I../../gcore -I../../ogr -I../../port -c
>     fastdataset.cpp  -fno-common -DPIC -o ../o/.libs/fastdataset.o
> 
>     fastdataset.cpp: In function `static GDALDataset*
> 
>        FASTDataset::Open(GDALOpenInfo*)':
> 
>     fastdataset.cpp:607: warning: `char*pszValue' might be used
>     uninitialized in
> 
>        this function
> 
>      g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD
>     -I../../port -I../../gcore -I../../ogr -I../../port -c
>     fastdataset.cpp -o ../o/fastdataset.o >/dev/null 2>&1
> 
>     /bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common
>     -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore
>     -I../../ogr -I../../port -c -o ../o/atlsci_spheroid.o
>     atlsci_spheroid.cpp
> 
>      g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD
>     -I../../port -I../../gcore -I../../ogr -I../../port -c
>     atlsci_spheroid.cpp  -fno-common -DPIC -o ../o/.libs/atlsci_spheroid.o
> 
>      g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD
>     -I../../port -I../../gcore -I../../ogr -I../../port -c
>     atlsci_spheroid.cpp -o ../o/atlsci_spheroid.o >/dev/null 2>&1
> 
>     /bin/sh ../../libtool --mode=compile g++ -Wall  -O3 -fno-common
>     -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD   -I../../port -I../../gcore
>     -I../../ogr -I../../port -c -o ../o/btdataset.o btdataset.cpp
> 
>      g++ -Wall -O3 -fno-common -no-cpp-precomp -DCPL_MULTIPROC_PTHREAD
>     -I../../port -I../../gcore -I../../ogr -I../../port -c
>     btdataset.cpp  -fno-common -DPIC -o ../o/.libs/btdataset.o
> 
>     btdataset.cpp: In member function `virtual CPLErr
>     BTRasterBand::IReadBlock(int,
> 
>        int, void*)':
> 
>     btdataset.cpp:133: error: `nWordSize' undeclared (first use this
>     function)
> 
>     btdataset.cpp:133: error: (Each undeclared identifier is reported
>     only once for
> 
>        each function it appears in.)
> 
>     make[2]: *** [../o/btdataset.o] Error 1
> 
>     make[1]: *** [raw-install-obj] Error 2
> 
>     make: *** [frmts-target] Error 2
> 
>     [lor:APPLI/gdal-cvs-040302] lor%
> 
> 
> The file btdataset.cpp has a new version (1.4 vs 1.3 of old 1.2.0a).
> I check this file and at line 130
> 
>     /*
>     -------------------------------------------------------------------- */
> 
>     /*      Swap on MSB
>     platforms.                                          */
> 
>     /*
>     -------------------------------------------------------------------- */
> 
>     #ifdef CPL_MSB
> 
>         GDALSwapWords( pImage, nDataSize, nRasterYSize, nWordSize );
> 
>     #endif   
> 
> 
> nWordSize is undeclared.
> 
> Thank for fixing !!

Lorenzo,

Sorry about that ... my error.  I have fixed this in CVS, committed
the fix and replaced the beta tarballs and zip.

> Another problem:
> 
> I have QUICK BIRD image files:
> 
> Gdal read the band in wrong mode.
> It creates
> xxxx.red channel
> xxxx.green channel
> xxxx.blue channel
> xxxx.alpha channel
> 
> QUICK BIRD has this format
> xxxx.blue channel
> xxxx.green channel
> xxxx.red channel
> xxxx.alpha channel
> 
> QUICK BIRD has 4 files
> 03MAY19095313-M2AS_R1C2-000000040462_01_P002.TIF        (Multispectral file)
> 03MAY19095313-M2AS_R1C2-000000040462_01_P002.TIL        (Tile of group 
> image)
> 03MAY19095313-M2AS_R1C2-000000040462_01_P002.IMD        (Image description)
> 03MAY19095313-M2AS_R1C2-000000040462_01_P002.RPB        (Parameter of image)
> 
> Is it possible to fix this error ??

If you want to reorder the bands it is possible to do so with some tricky
steps.

Basically, build a .vrt file corresponding to the input file:

gdal_translate -of VRT bgra.tif bgra.vrt

Then edit the .vrt file with a text editor, and change the <SourceBand>
values around to the order you want.  For instance, change the
<SourceBand> for the first VRTRasterBand to 3, the 2nd to 2, and the
3rd to 1.

Then convert the .vrt file back into a TIFF file and it should be reordered.

gdal_translate bgra.vrt rgba.tif

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From support at geoimage.fr  Tue Mar  2 11:22:44 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com>
Message-ID: <089601c40072$97e697c0$e32346c0@pili>

> Fr?d?ric,
>
> You are setting up a pretty hard configuration!   I would suggest you
> install the PROJ.4 tree, even if only into a local tree and then use
> that to link against instead.  That will avoid the libtool related issues.
>

It's what I done.

The problem is that "/src" is automatically appended to the specified directory.
The "make install" command in the PROJ4 build tree doesn't create a src
dir in the install tree ( only include, lib, bin and share - and it's ok). So I have to create
an 'src' in the PROJ installation tree and link the libproj.a library from lib to src.

It's not a big problem, but It's look strange to me that 'src' is always appended...


> > *** On Win32, I specify a static proj link in nmake.opt :
> >
> > PROJ_FLAGS = -DPROJ_STATIC
> > PROJ_INCLUDE = -Iz:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\include
> > PROJ_LIB = z:\GEOIMAGE_SRC\LIBRAIRIES\libPROJ\src\win32\lib
> >
> > But It looks like PROJ_LIB is never used... I have to add '$PROJ_LIB\proj.lib' to ADD_LIBS
> > in order to properly link.
> > Am i missing something ?
>
> Hmm, it would seem we missed this.  I have added PROJ_LIB into the EXTERNAL_LIBS
> macro now.  Your local change should be fine too.

Thanks a lot.

Fr?d?ric.



From warmerdam at pobox.com  Tue Mar  2 16:18:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <089601c40072$97e697c0$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili>
Message-ID: <4044FA15.6090807@pobox.com>

Fr?d?ric Trastour wrote:
>>Fr?d?ric,
>>
>>You are setting up a pretty hard configuration!   I would suggest you
>>install the PROJ.4 tree, even if only into a local tree and then use
>>that to link against instead.  That will avoid the libtool related issues.
>>
> 
> 
> It's what I done.
> 
> The problem is that "/src" is automatically appended to the specified directory.
> The "make install" command in the PROJ4 build tree doesn't create a src
> dir in the install tree ( only include, lib, bin and share - and it's ok). So I have to create
> an 'src' in the PROJ installation tree and link the libproj.a library from lib to src.
> 
> It's not a big problem, but It's look strange to me that 'src' is always appended...

Andrey,

Is this related to the way your new static proj support works?  Perhaps you
could look into it?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From eric.sokolowsky at gsfc.nasa.gov  Tue Mar  2 18:03:54 2004
From: eric.sokolowsky at gsfc.nasa.gov (Eric Sokolowsky)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Creation of geotiff files with gdalwarp that have a
 transparent background
In-Reply-To: <4043B04A.1060302@pobox.com>
Message-ID: <Pine.LNX.4.44.0403021751420.16752-100000@cusco.gsfc.nasa.gov>

On Mon, 1 Mar 2004, Frank Warmerdam wrote:

> Eric Sokolowsky wrote:
> > I have been experimenting with the gdal library, specifically the
> > gdalwarp tool included with the library.  It is very useful, and I have
> > been able to transform images to a geographic projection.  Is there is a
> > way to specify a default background color?  Specifically, I wish to
> > create a geotiff file where the areas not covered by the original source
> > file are transparent.  Is this possible, or do I need to start hacking
> > gdal?  Would this change be generally useful to others?
> > 
> 
> Eric,
> 
> The default output value of a raster can be set with the INIT_DEST
> warp options.
> 
> eg.
> 
> gdalwarp in.tif out.tif -t_srs WGS84 -wo INIT_DEST=255

Hmm.  I tried the "-wo" option but when I used it the program just 
printed the usage statement.  Perhaps I have a version that is too old.
No matter; I got the images I wanted by using my recipe below.


> One issue you face is how to make something transparent in
> TIFF format.  TIFF supports transparency if you use RGBA format.  That
> is four bands with red, green, blue and alpha (transparency).  But if
> your inputs is just RGB there is no obvious way to force gdalwarp to
> produce an RGBA output file, and to treat the alpha band as a proper
> transparency overlay.

I have developed a recipe to create the images that I want.  Thanks for
pointing me in the right direction.  Here is what I do:

My source image is a geotiff file in Lambert Azimuthal Equal Area projection.
I use ImageMagick's convert tool with the "-matte" option to add a matte
channel to the image.  (I also have to use "-compress none" to get around
lzw patent issues.)  This step, unfortunately, strips out the georegistration
information, but I can put it back with geotifcp, using the "-g" option on
the georegistration information (which itself is produced with listgeo).
Then I can use gdalwarp to produce the final image.

Of course, making the transparency work properly in gdalwarp would be
nice.  Fortunately, I can script all of these steps and I don't really
have that many to do.


-- 
    ____   __     Eric Sokolowsky    (GST)  NASA Goddard Space Flight Center 
   / __/__/_/__  Visualization Programmer    Scientific Visualization Studio
  / __/ _/ / _/ 301.286.3751                  Mailstop 935.0 Bldg 28 Rm E102
 /___/_//_/__/ eric.sokolowsky@gsfc.nasa.gov   Greenbelt, MD 20771


From lorenzo.moretti at bologna.enea.it  Wed Mar  3 06:42:00 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <4044B0AF.3070109@pobox.com>
References: <40438562.30702@pobox.com>
 <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com>
Message-ID: <a06020401bc6b712fcf47@[192.107.62.86]>

>
>Lorenzo,
>
>Sorry about that ... my error.  I have fixed this in CVS, committed
>the fix and replaced the beta tarballs and zip.

Thanx

>>Another problem:
>>
>>I have QUICK BIRD image files:
>>
>>
>>Is it possible to fix this error ??
>
>If you want to reorder the bands it is possible to do so with some tricky
>steps.
>
>Basically, build a .vrt file corresponding to the input file:
>
>gdal_translate -of VRT bgra.tif bgra.vrt
>
>Then edit the .vrt file with a text editor, and change the <SourceBand>
>values around to the order you want.  For instance, change the
><SourceBand> for the first VRTRasterBand to 3, the 2nd to 2, and the
>3rd to 1.
>
>Then convert the .vrt file back into a TIFF file and it should be reordered.
>
>gdal_translate bgra.vrt rgba.tif
>
>Good luck,

OK for this tip but I use Grass and r.in.gdal and this method is not 
applicable for user.  The module r.in.gdal read the band in wrong 
mode.
It's difficult for the user to use gdal_translate for creating 4 tiff 
files before and after to go to Grass and import these tiff files. 
This method must be more simple. Why is it impossible to import bands 
in right sequence?


-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot              Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________

From dron at ak4719.spb.edu  Wed Mar  3 06:54:28 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <089601c40072$97e697c0$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili>
Message-ID: <20040303115428.GA3796@ak4719.spb.edu>

On Tue, Mar 02, 2004 at 05:22:44PM +0100, Fr?d?ric Trastour wrote:
> The problem is that "/src" is automatically appended to the specified
> directory. The "make install" command in the PROJ4 build tree doesn't
> create a src dir in the install tree ( only include, lib, bin and
> share - and it's ok). So I have to create an 'src' in the PROJ
> installation tree and link the libproj.a library from lib to src.

I have commited a few tweaks for --with-static-proj4 test, could you
test this again?

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From warmerdam at pobox.com  Wed Mar  3 09:04:55 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <a06020401bc6b712fcf47@[192.107.62.86]>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com> <a06020401bc6b712fcf47@[192.107.62.86]>
Message-ID: <4045E607.3090801@pobox.com>

Lorenzo Moretti wrote:
> OK for this tip but I use Grass and r.in.gdal and this method is not 
> applicable for user.  The module r.in.gdal read the band in wrong mode.
> It's difficult for the user to use gdal_translate for creating 4 tiff 
> files before and after to go to Grass and import these tiff files. This 
> method must be more simple. Why is it impossible to import bands in 
> right sequence?

Lorenzo,

I do not believe that GDAL is reading the bands in the wrong order.  It is
reading the bands in the order they occur in the original file.  The original
file is also marked as RGB photometric interpretation if it is like the other
quickbird files I have encountered.  The problem is that the original files
are not setup for proper identification of band mappings.

If you have a full GDAL installation then my method would work fine.  If not
then use GRASS methods to reorder the bands.  I believe that the bands are
imported as seperate raster layers, and a composite image object created
for them.  It should be possible to create a new image object with different
band orderings.

Statements like "This method must be more simple." get under my skin.  I am
willing to do alot to make GDAL operate effectively and usefully.  However,
there are limits to what I am going do to make up for screwball data products
and there are also limits to what I can accomplish with regard to GRASS from
a single import program (r.in.gdal).  I don't appreciate people telling me
what I must do, not even my wife!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From lorenzo.moretti at bologna.enea.it  Wed Mar  3 13:55:14 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <4045E607.3090801@pobox.com>
References: <40438562.30702@pobox.com>
 <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com>
 <a06020401bc6b712fcf47@[192.107.62.86]> <4045E607.3090801@pobox.com>
Message-ID: <a06020402bc6bd8730384@[192.107.62.86]>

>
>I do not believe that GDAL is reading the bands in the wrong order.  It is
>reading the bands in the order they occur in the original file.  The original
>file is also marked as RGB photometric interpretation if it is like the other
>quickbird files I have encountered.  The problem is that the original files
>are not setup for proper identification of band mappings.
>
>If you have a full GDAL installation then my method would work fine.  If not
>then use GRASS methods to reorder the bands.  I believe that the bands are
>imported as seperate raster layers, and a composite image object created
>for them.  It should be possible to create a new image object with different
>band orderings.
>
>Statements like "This method must be more simple." get under my skin.  I am
>willing to do alot to make GDAL operate effectively and usefully.  However,
>there are limits to what I am going do to make up for screwball data products
>and there are also limits to what I can accomplish with regard to GRASS from
>a single import program (r.in.gdal).  I don't appreciate people telling me
>what I must do, not even my wife!
>


OK Excuse me for method but I want to understand.

In old gdal 1.1.8 I had the tiff files with number suffix
filetiff.1
filetiff.2
filetiff.3
filetiff.4

and after I choose the order for my BGR (blue-red-green for 
quickbird). I choose 321 for my output.

 From gdal 1.1.9 the tiff file have a color suffix.
filetiff.red
filetiff.green
filetiff.blue
filetiff.alpha

and I must change the name of 2 files.
I read the QuickBird specification and the bands are blue, green, red.

With the number suffix I worked with GDAL and GRASS like  ENVI for 
RGB images...

Thanx

-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot              Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________

From warmerdam at pobox.com  Wed Mar  3 14:29:14 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <a06020402bc6bd8730384@[192.107.62.86]>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com> <a06020401bc6b712fcf47@[192.107.62.86]> <4045E607.3090801@pobox.com> <a06020402bc6bd8730384@[192.107.62.86]>
Message-ID: <4046320A.7090905@pobox.com>

Lorenzo Moretti wrote:
> OK Excuse me for method but I want to understand.
> 
> In old gdal 1.1.8 I had the tiff files with number suffix
> filetiff.1
> filetiff.2
> filetiff.3
> filetiff.4
> 
> and after I choose the order for my BGR (blue-red-green for quickbird). 
> I choose 321 for my output.
> 
>  From gdal 1.1.9 the tiff file have a color suffix.
> filetiff.red
> filetiff.green
> filetiff.blue
> filetiff.alpha

Lorenzo,

As a convenience someone changed r.in.gdal to use band names derived
from the apparent photometric interpretation.  I believe the photometric
interpretation improved between GDAL 1.1.8 and 1.1.9 which is why
changing gets the altered names.

> and I must change the name of 2 files.
> I read the QuickBird specification and the bands are blue, green, red.

But what does it say in the TIFF file?  It doesn't really matter what it
says in the quickbird specficiation if they produce confusing TIFF files.
What is the "tiffinfo" report for the files in question?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Stephanie.Choi at ec.gc.ca  Wed Mar  3 14:29:51 2004
From: Stephanie.Choi at ec.gc.ca (Choi,Stephanie [Ontario])
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Gdal-cvs compile error
Message-ID: <79D8CC9C0F21D611A0C900805FBBC3AC03D502B0@mgtserver3.ontario.int.ec.gc.ca>

Hi all,

I am running into a problem when building GDAL-CVS version.

My configure line is as follow:

./configure --prefix=/usr/local/gdal \
                --without-python	 \
	    --with-ogr		 \ 
	    --with-odbc=/usr/local/easysoft/include \
	  --with-xerces	\ 
	  --with-xerces-inc=/usr/local/xercesc/include
	  --with-xerces-lib=/usr/local/xercesc/lib/libxerces_c1_6_0.so

It was compiled okay; however I got the following error when I did a make:

  g++ -Wall -O2 -I/usr/local/easysoft -I/usr/local/easysoft/include
-Iogrsf_frmts -I. -I../port -I../gcore -I../og
r -I../port -c ogrinfo.cpp  -fPIC -DPIC -o .libs/ogrinfo.o
 g++ -Wall -O2 -I/usr/local/easysoft -I/usr/local/easysoft/include
-Iogrsf_frmts -I. -I../port -I../gcore -I../og
r -I../port -c ogrinfo.cpp -o ogrinfo.o >/dev/null 2>&1
/bin/sh ../libtool --mode=link  g++  ogrinfo.o ../libgdal.la -o ogrinfo
g++ ogrinfo.o -o .libs/ogrinfo  ../.libs/libgdal.so -L/usr/local/easysoft
-L/usr/local/easysoft/lib -lodbc /usr/l
ib/libjpeg.so -lpng -lz -ldl -L/usr/local/pgsql/lib -lpq -Wl,--rpath
-Wl,/usr/local/gdal/lib
../.libs/libgdal.so: undefined reference to
`SAXParseException::~SAXParseException(void)'
../.libs/libgdal.so: undefined reference to
`SAX2XMLReaderImpl::SAX2XMLReaderImpl(void)'
../.libs/libgdal.so: undefined reference to `XMLString::transcode(char const
*)'
../.libs/libgdal.so: undefined reference to
`XMLPlatformUtils::Initialize(void)'
../.libs/libgdal.so: undefined reference to
`SAXParseException::SAXParseException(SAXParseException const &)'
../.libs/libgdal.so: undefined reference to `XMLException type_info
function'
../.libs/libgdal.so: undefined reference to `SAXParseException type_info
function'
collect2: ld returned 1 exit status
make[1]: *** [ogrinfo] Error 1
make[1]: Leaving directory `/tmp/autotmp7/mapserver/gdal-cvs-040129/ogr'
make: *** [ogr-apps] Error 2

Could anyone help me on this problem ?  Any help would be greatly
appreciated :

Thanks in advance,

Stephanie


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040303/f56113a6/attachment.html
From neteler at itc.it  Wed Mar  3 15:04:10 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <a06020401bc6b712fcf47@[192.107.62.86]>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com> <a06020401bc6b712fcf47@[192.107.62.86]>
Message-ID: <20040303200410.GC12564@thuille.itc.it>

On Wed, Mar 03, 2004 at 12:42:00PM +0100, Lorenzo Moretti wrote:
> >>I have QUICK BIRD image files:
> >>
> >>
> >>Is it possible to fix this error ??
> >
> >If you want to reorder the bands it is possible to do so with some tricky
> >steps.
[...]

All Quickbird I have seen so far had wrong names for the bands
(red/blue reverted). It seems not to be a problem of
GDAL, neither GRASS, but simply wrong Quickbird GeoTIFF files
(so just complain to the data provider).

> OK for this tip but I use Grass and r.in.gdal and this method is not 
> applicable for user.  The module r.in.gdal read the band in wrong 
> mode.

It's reading what it finds in the data set.

> It's difficult for the user to use gdal_translate for creating 4 tiff 
> files before and after to go to Grass and import these tiff files. 
> This method must be more simple. Why is it impossible to import bands 
> in right sequence?

As explained above. An easy solution is to use "g.rename" in
GRASS and rename the red and blue channel (exchange their names).
Then it works well.

Cheers

 Markus Neteler

From lorenzo.moretti at bologna.enea.it  Thu Mar  4 05:36:17 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <4046320A.7090905@pobox.com>
References: <40438562.30702@pobox.com>
 <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com>
 <a06020401bc6b712fcf47@[192.107.62.86]> <4045E607.3090801@pobox.com>
 <a06020402bc6bd8730384@[192.107.62.86]> <4046320A.7090905@pobox.com>
Message-ID: <a06020405bc6cb1e8fb45@[192.107.62.86]>

>Lorenzo,
>
>As a convenience someone changed r.in.gdal to use band names derived
>from the apparent photometric interpretation.  I believe the photometric
>interpretation improved between GDAL 1.1.8 and 1.1.9 which is why
>changing gets the altered names.
>
>>and I must change the name of 2 files.
>>I read the QuickBird specification and the bands are blue, green, red.
>
>But what does it say in the TIFF file?  It doesn't really matter what it
>says in the quickbird specficiation if they produce confusing TIFF files.
>What is the "tiffinfo" report for the files in question?
>
>Best regards,

Frank

 From tiffinfo (from libtiff)

[lor:/] lor% /usr/local/grasslib/bin/tiffinfo 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF
TIFFReadDirectory: Warning, 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF: 
unknown field with tag 33550 (0x830e) encountered.
TIFFReadDirectory: Warning, 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF: 
unknown field with tag 33922 (0x8482) encountered.
TIFFReadDirectory: Warning, 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF: 
unknown field with tag 34735 (0x87af) encountered.
TIFFReadDirectory: Warning, 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF: 
unknown field with tag 34736 (0x87b0) encountered.
TIFFReadDirectory: Warning, 
/Volumes/ESTERNO/cartografia/file_esterni/QB/PALE/PAN+MS/scena_destra/03MAY19095313-M2AS_R1C1-000000040462_01_P002.TIF: 
unknown field with tag 34737 (0x87b1) encountered.
TIFF Directory at offset 0x2000018
   Image Width: 2048 Image Length: 2048
   Bits/Sample: 16
   Sample Format: unsigned integer
   Compression Scheme: None
   Photometric Interpretation: RGB color
   Extra Samples: 1<unspecified>
   Date & Time: "2003:05:29 03:22:32"
   Copyright: "(C) COPYRIGHT 2002 EarthWatch Incorporated, Longmont CO 
USA 80501-6700"
   Image Description: "{\n  bandList = \n  [\n    1;\n    2;\n    
3;\n    4;\n  ]\n}"
   Orientation: row 0 top, col 0 lhs
   Samples/Pixel: 4
   Rows/Strip: 256
   Min Sample Value: 0
   Max Sample Value: 2006
   Planar Configuration: separate image planes
[lor:/] lor%

 From .IMD file (image meta data file) of my .TIF file of QUICBIRD I have:

version = "N";
generationTime = 2003-05-29T03:23:37.000000Z;
productOrderId = "000000040462_01_P002";
imageDescriptor = "Standard2A";
bandId = "Multi";
panSharpenAlgorithm = "None";
numRows = 5955;
numColumns = 5943;
productLevel = "LV2A";
radiometricLevel = "Corrected";
bitsPerPixel = 16;
compressionType = "None";
BEGIN_GROUP = BAND_B
	ULLon =   12.74969287;
	ULLat =   43.05077675;
	ULHAE =     0.00;
	URLon =   12.95384508;
	URLat =   43.05461067;
	URHAE =     0.00;
	LRLon =   12.95881598;
	LRLat =   42.90458014;
	LRHAE =     0.00;
	LLLon =   12.75515876;
	LLLat =   42.90076616;
	LLHAE =     0.00;
	absCalFactor = 1.431000e-02;
END_GROUP = BAND_B;
BEGIN_GROUP = BAND_G
	ULLon =   12.74969287;
	ULLat =   43.05077675;
	ULHAE =     0.00;
	URLon =   12.95384508;
	URLat =   43.05461067;
	URHAE =     0.00;
	LRLon =   12.95881598;
	LRLat =   42.90458014;
	LRHAE =     0.00;
	LLLon =   12.75515876;
	LLLat =   42.90076616;
	LLHAE =     0.00;
	absCalFactor = 1.045000e-02;
END_GROUP = BAND_G;
BEGIN_GROUP = BAND_R
	ULLon =   12.74969287;
	ULLat =   43.05077675;
	ULHAE =     0.00;
	URLon =   12.95384508;
	URLat =   43.05461067;
	URHAE =     0.00;
	LRLon =   12.95881598;
	LRLat =   42.90458014;
	LRHAE =     0.00;
	LLLon =   12.75515876;
	LLLat =   42.90076616;
	LLHAE =     0.00;
	absCalFactor = 9.680000e-03;
END_GROUP = BAND_R;
BEGIN_GROUP = BAND_N
	ULLon =   12.74969287;
	ULLat =   43.05077675;
	ULHAE =     0.00;
	URLon =   12.95384508;
	URLat =   43.05461067;
	URHAE =     0.00;
	LRLon =   12.95881598;
	LRLat =   42.90458014;
	LRHAE =     0.00;
	LLLon =   12.75515876;
	LLLat =   42.90076616;
	LLHAE =     0.00;
	absCalFactor = 1.568000e-02;
END_GROUP = BAND_N;
outputFormat = "GeoTIFF";
BEGIN_GROUP = IMAGE_1
	satId = "QB02";
	CatId = "1010010001E96F02";
	SceneID = "2";
	collectedRowGSD =   2.545;
	collectedColGSD =   2.517;
	meanCollectedGSD =   2.531;
	rowUncertainty =  623.81;
	colUncertainty =  113.51;
	sunAz = 141.197;
	sunEl = 62.4302;
	satAz = 170.133;
	satEl = 77.3454;
	inTrackViewAngle = -10.9489;
	crossTrackViewAngle = 3.93044;
	offNadirViewAngle = 11.5137;
	autoCloudCover = 0.04;
	manualCloudCover = 0.1125;
	PNIIRS = 2.8;
	imageQuality = "Excellent";
	TDILevel = 13;
	positionKnowledgeSrc = "R";
	attitudeKnowledgeSrc = "R";
	revNumber = 8888;
END_GROUP = IMAGE_1;
BEGIN_GROUP = MAP_PROJECTED_PRODUCT
	earliestAcqTime = 2003-05-19T09:53:13.207882Z;
	latestAcqTime = 2003-05-19T09:53:13.207882Z;
	datumName = "WE";
	semiMajorAxis = 6378137.0000;
	inverseFlattening = 298.257223563;
	datumOffset = (
	     0.000,
	     0.000,
	     0.000 );
	mapProjName = "UTM";
	mapProjCode = 1;
	mapZone = 33;
	mapHemi = "N";
	mapProjParam = (
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000,
	  0.000000000 );
	productUnits = "M";
	originX =     316728.99995154;
	originY =    4768910.99999898;
	orientationAngle =    0.0;
	resamplingKernel = "NN";
	productGSD =  2.80;
	colSpacing =  2.80;
	rowSpacing =  2.80;
	ULX =  316728.99995154;
	ULY = 4768910.99999898;
	ULH =       0.00;
	URX =  333366.59997505;
	URY = 4768910.99999922;
	URH =       0.00;
	LRX =  333366.59997550;
	LRY = 4752239.79999924;
	LRH =       0.00;
	LLX =  316728.99995242;
	LLY = 4752239.79999899;
	LLH =       0.00;
	DEMCorrection = "none";
	numGCP = 0;
END_GROUP = MAP_PROJECTED_PRODUCT
END;

YOU see the bands:
1st band is BAND_B (BLUE)
2nd band is BAND_G (GREEN)
3th band is BAND_R (RED)
4th band is BAND_N (NEAR IR)

Quick Bird has this format but gdal and grass read only .TIF files 
without reading .IMD file.
The BAND_B for gdal is BAND_RED and BAND_R is BAND_BLUE. This is wrong



-- 
________________________________________________________________________
||      Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|  ENEA prot              Web: http://wwwamb.bologna.enea.it/    
||   |  via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (ris.)
~~~~~~  40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040304/95a5d24c/attachment.html
From warmerdam at pobox.com  Thu Mar  4 09:37:22 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <a06020405bc6cb1e8fb45@[192.107.62.86]>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com> <a06020401bc6b712fcf47@[192.107.62.86]> <4045E607.3090801@pobox.com> <a06020402bc6bd8730384@[192.107.62.86]> <4046320A.7090905@pobox.com> <a06020405bc6cb1e8fb45@[192.107.62.86]>
Message-ID: <40473F22.8060308@pobox.com>

Lorenzo Moretti wrote:
> YOU see the bands:
> 1st band is BAND_B (BLUE)
> 2nd band is BAND_G (GREEN)
> 3th band is BAND_R (RED)
> 4th band is BAND_N (NEAR IR)
> 
> Quick Bird has this format but gdal and grass read only .TIF files 
> without reading .IMD file.
> The BAND_B for gdal is BAND_RED and BAND_R is BAND_BLUE. 

Lorenzo,

You are correct that the GDAL TIFF reader does not attempt to read the
QuickBird specific .imd file.  I would like to stress that the .imd file
is *not* part of the TIFF standard, or even a widely used convention in
the geospatial world.  It is a QuickBird specific metadata file.

QuickBird has chosen to write out a TIFF file with a photometric interpretation
contrary to what their metadata says.  That's their business, but it isn't
really reasonable to expect GDAL or other products to always go digging
around for this .imd file just to see if this is a backwards quickbird file.

 > This is wrong

It is wrong that GDAL doesn't read the .imd file, or the interpretation of
the band colors is wrong?  The final result is wrong, but it is quite
arguable whether what GDAL does is wrong or not.  However, I am not really
prepared to argue about it anymore.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From neteler at itc.it  Thu Mar  4 09:56:31 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Beta Release - Error
In-Reply-To: <4046320A.7090905@pobox.com>
References: <40438562.30702@pobox.com> <a06020400bc6a56f5a928@[192.107.62.86]> <4044B0AF.3070109@pobox.com> <a06020401bc6b712fcf47@[192.107.62.86]> <4045E607.3090801@pobox.com> <a06020402bc6bd8730384@[192.107.62.86]> <4046320A.7090905@pobox.com>
Message-ID: <20040304145631.GG15778@thuille.itc.it>

On Wed, Mar 03, 2004 at 02:29:14PM -0500, Frank Warmerdam wrote:
> Lorenzo Moretti wrote:
> >OK Excuse me for method but I want to understand.
> >
> >In old gdal 1.1.8 I had the tiff files with number suffix
> >filetiff.1
> >filetiff.2
> >filetiff.3
> >filetiff.4
> >
> >and after I choose the order for my BGR (blue-red-green for quickbird). 
> >I choose 321 for my output.
> >
> > From gdal 1.1.9 the tiff file have a color suffix.
> >filetiff.red
> >filetiff.green
> >filetiff.blue
> >filetiff.alpha
> 
> Lorenzo,
> 
> As a convenience someone changed r.in.gdal to use band names derived
> from the apparent photometric interpretation. 

I did. Works except for Quickbird.
The names are fetched via GDAL.
Maybe ENVI contains a trick such as "if Quickbird, flip red/blue names"?

> I believe the photometric
> interpretation improved between GDAL 1.1.8 and 1.1.9 which is why
> changing gets the altered names.

r.in.gdal ChangeLog:
 2003-03-13 13:49  markus
        * main.c (1.19): grey_scale_colors for Byte data, color name
        support for known color names (Red, Green, Blue)

Markus


From spyke555 at yahoo.ca  Thu Mar  4 09:58:36 2004
From: spyke555 at yahoo.ca (Sandy Pyke)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Looking for some guidance...
Message-ID: <007201c401f9$2c641ee0$6f0aa8c0@sandy>

Hello all,

I am working on a project where I have multiple large raster maps as my
data source. The output of the project is to be a map scaled to a
certain size covering a certain area. The output map may need data from
1 to 4 of the larger maps to generate the output map.

So far I have worked around converting my raster maps to GeoTIFF with
the proper georeferencing applied, loading bounding boxes for these maps
as well as the file names into a PostGIS database, calculating the
desired map coverage, and extracting the relevant file names of the
required output maps from the PostGIS database. I now know which files I
need for my source data, I need to create the output map.

These output maps will be 1280 x 1024 x 8 maps and use a GCS of WGS84.

I have been able to get this to work on the command line using the
following commands:

gdalwarptest -te -73.61837 45.38504 -73.32745 45.54867 \
             -tr 1280 1024 inputfile1.tif outputfile.tif

gdalwarptest -srcnodata 0 inputfile2.tif outputfile.tif
gdalwarptest -srcnodata 0 inputfile3.tif outputfile.tif
gdalwarptest -srcnodata 0 inputfile4.tif outputfile.tif

gdal_translate outputfile.tif compressedoutput.png

I essentially want to get the same result, but in C / C++ code.

Conceptually I want to do the following:

- Generate the output dataset in memory
- Warp the source image(s) to the memory dataset
- Translate the memory dataset to a compressed image file

The API tutorials do make mention of the ability to create "in-memory"
datasets but no information is given on how to do this. Can anyone offer
some insight on this? Specifically, what driver should I use?

Also, if anyone can offer some insight on how I would go about
implementing my desired functionality I would appreciate it.

Thank you.

Sandy Pyke

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.596 / Virus Database: 379 - Release Date: 2/26/2004
 


From warmerdam at pobox.com  Thu Mar  4 10:12:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Looking for some guidance...
In-Reply-To: <007201c401f9$2c641ee0$6f0aa8c0@sandy>
References: <007201c401f9$2c641ee0$6f0aa8c0@sandy>
Message-ID: <4047475E.4030509@pobox.com>

Sandy Pyke wrote:
> Hello all,
> 
> I am working on a project where I have multiple large raster maps as my
> data source. The output of the project is to be a map scaled to a
> certain size covering a certain area. The output map may need data from
> 1 to 4 of the larger maps to generate the output map.
> 
> So far I have worked around converting my raster maps to GeoTIFF with
> the proper georeferencing applied, loading bounding boxes for these maps
> as well as the file names into a PostGIS database, calculating the
> desired map coverage, and extracting the relevant file names of the
> required output maps from the PostGIS database. I now know which files I
> need for my source data, I need to create the output map.
> 
> These output maps will be 1280 x 1024 x 8 maps and use a GCS of WGS84.
> 
> I have been able to get this to work on the command line using the
> following commands:
> 
> gdalwarptest -te -73.61837 45.38504 -73.32745 45.54867 \
>              -tr 1280 1024 inputfile1.tif outputfile.tif
> 
> gdalwarptest -srcnodata 0 inputfile2.tif outputfile.tif
> gdalwarptest -srcnodata 0 inputfile3.tif outputfile.tif
> gdalwarptest -srcnodata 0 inputfile4.tif outputfile.tif
> 
> gdal_translate outputfile.tif compressedoutput.png
> 
> I essentially want to get the same result, but in C / C++ code.
> 
> Conceptually I want to do the following:
> 
> - Generate the output dataset in memory
> - Warp the source image(s) to the memory dataset
> - Translate the memory dataset to a compressed image file
> 
> The API tutorials do make mention of the ability to create "in-memory"
> datasets but no information is given on how to do this. Can anyone offer
> some insight on this? Specifically, what driver should I use?
> 
> Also, if anyone can offer some insight on how I would go about
> implementing my desired functionality I would appreciate it.

Sandy,

All the steps are reproducable in C++ code of course.  You might want to
scan the gdalwarptest to see how it does it.   I would note that if you
are using gdalwarptest still you are using an older GDAL.  Giving various
advances on the warping code, I would encourage you to update.  There is
a 1.2.0 beta available on the ftp site now.

Second, on the issues of doing the work in memory.  When you create your
"working" dataset, use the driver name "MEM" instead of "GTiff" and you should
be OK.  The warping will all occur to this in memory raster, and then you can
use the CreateCopy() method on the PNG driver to turn this into a PNG file
when you are done.

I suppose I ought to document the MEM driver.  I haven't been so keen on it in
the past in part because I think it will be confusing to "normal" users.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ben at vterrain.org  Thu Mar  4 22:00:49 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <017101c3fd05$3170dd90$f400fe0a@TOPP2>
Message-ID: <008201c4025e$10cfed20$f400fe0a@TOPP2>

This evening i was trying to read a TIF file from a data agency, here:

ftp://keone.soest.hawaii.edu/pub/coastal_ftp/Imagery/Oahu/GeoTiffs/kaenapt.z
ip

It crashes GDAL (assert failure) down inside the TIF code.  This got me
thinking, why do we use assert() this way in GDAL?  It effectively crashes
the calling app, which then has no way to inform the user of the problem or
continue gracefully.

It was fixable by changing the assert:

fmts/gtiff/libtiff.c, line 606
< 	assert(sp->cinfo.comm.is_decompressor);
----
> 	if (sp->cinfo.comm.is_decompressor == 0) {
>		TIFFError("JPEGSetupDecode", "JPEG is not decompressor");
>		return (0);
>	}

1. Perhaps there is some way to trap these assert() failures in an app
calling GDAL?
2. Perhaps assert() should be used only to detect cases of a logical flaw in
the code, rather than unexpected input data?

Thanks,
Ben


From MChapman at sanz.com  Fri Mar  5 00:51:08 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9514@mailman.san.com>

Ben,

I was able to open this file using GDAL fine.  What problem were you
having?

Martin

-----Original Message-----
From: Ben Discoe [mailto:ben@vterrain.org] 
Sent: Thursday, March 04, 2004 8:01 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] Use of assert() on troublesome files



This evening i was trying to read a TIF file from a data agency, here:

ftp://keone.soest.hawaii.edu/pub/coastal_ftp/Imagery/Oahu/GeoTiffs/kaena
pt.z
ip

It crashes GDAL (assert failure) down inside the TIF code.  This got me
thinking, why do we use assert() this way in GDAL?  It effectively
crashes the calling app, which then has no way to inform the user of the
problem or continue gracefully.

It was fixable by changing the assert:

fmts/gtiff/libtiff.c, line 606
< 	assert(sp->cinfo.comm.is_decompressor);
----
> 	if (sp->cinfo.comm.is_decompressor == 0) {
>		TIFFError("JPEGSetupDecode", "JPEG is not
decompressor");
>		return (0);
>	}

1. Perhaps there is some way to trap these assert() failures in an app
calling GDAL? 2. Perhaps assert() should be used only to detect cases of
a logical flaw in the code, rather than unexpected input data?

Thanks,
Ben

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar  5 01:14:59 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <008201c4025e$10cfed20$f400fe0a@TOPP2>
References: <008201c4025e$10cfed20$f400fe0a@TOPP2>
Message-ID: <40481AE3.7010203@pobox.com>

Ben Discoe wrote:
> It was fixable by changing the assert:
> 
> fmts/gtiff/libtiff.c, line 606
> < 	assert(sp->cinfo.comm.is_decompressor);
> ----
> 
>>	if (sp->cinfo.comm.is_decompressor == 0) {
>>		TIFFError("JPEGSetupDecode", "JPEG is not decompressor");
>>		return (0);
>>	}

Ben,

I assume you are referring to tif_jpeg.c?  My understanding is that
control should never get into JPEGSetupDecode() with the object not setup
in decompressor mode.  What I mean is, I think this is indicative of a logical
flaw in the code.  The sort of thing that might be suitably handled via an
assert().  There have been changes in this area.  Is it possible you are
using libtiff code that is a few months out of date?

> 1. Perhaps there is some way to trap these assert() failures in an app
> calling GDAL?

There isn't really much that can be done about asserts() at runtime.
In GDAL level code I normally use CPLAssert() which could in theory be
hooked to escape death via a setjmp()/longjmp() call or a C++ exception
but things wouldn't be properly cleaned up so it would still be very dangerous.

> 2. Perhaps assert() should be used only to detect cases of a logical flaw in
> the code, rather than unexpected input data?

I completely agree.  Assert() is only appropriate for identifying error
conditions that a user or bad data should not be able to cause.  But rather
to verify that preconditions expected at a particular location are being met.
In fact, in production builds the assert() is normally compiled out completely
so it is useless as a general error handler.

Assert should be used to help identify code problems close to the source
but are not a real "error handling" construct.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ben at vterrain.org  Fri Mar  5 01:23:17 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9514@mailman.san.com>
Message-ID: <009101c4027a$596148b0$f400fe0a@TOPP2>

I was trying to read it with GDALOpen, but i can demonstrate the problem
from the command-line as well.  This is with GDAL 1.2.0a (a few days ago) on
Windows XP:

> gdalwarp kaena_pt.tif kaena_pt2.tif
Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
"XMLPacket"; tag ignored
Creating output file is that 5371P x 3251L.
Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
"XMLPacket"; tag ignored
ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 464,
caller expects 432
Assertion failed: sp->cinfo.comm.is_decompressor, file tif_jpeg.c, line 606

This application has requested the Runtime to terminate it in an unusual
way.
Please contact the application's support team for more information.

-Ben

> -----Original Message-----
> From: Chapman, Martin
> Sent: Friday, March 05, 2004 12:51 AM
> To: gdal-dev@remotesensing.org
> Subject: RE: [Gdal-dev] Use of assert() on troublesome files
> 
> Ben,
> 
> I was able to open this file using GDAL fine.  What problem 
> were you having?
> 
> Martin
> 
> -----Original Message-----
> From: Ben Discoe [mailto:ben@vterrain.org] 
> Sent: Thursday, March 04, 2004 8:01 PM
> To: gdal-dev@remotesensing.org
> Subject: [Gdal-dev] Use of assert() on troublesome files
> 
> This evening i was trying to read a TIF file from a data agency, here:
> 
>
ftp://keone.soest.hawaii.edu/pub/coastal_ftp/Imagery/Oahu/GeoTiffs/kaenapt.z
ip
>
> It crashes GDAL (assert failure) down inside the TIF code.


From ben at vterrain.org  Fri Mar  5 01:30:24 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <40481AE3.7010203@pobox.com>
Message-ID: <009201c4027b$57bbb990$f400fe0a@TOPP2>

> From: Frank Warmerdam
> 
> I assume you are referring to tif_jpeg.c?

Ooops, yes.

> I think this is indicative of a logical
> flaw in the code.  [..] Is it possible you are
> using libtiff code that is a few months out of date?

The Changelog on my GDAL says 2004-02-19.  I could try it again with the CVS
version if that helps?  Or you could try the TIF file..?
(ftp://keone.soest.hawaii.edu/pub/coastal_ftp/Imagery/Oahu/GeoTiffs/kaenapt.
zip)  Using gdalwarp causes the same assert problem that i get by calling
GDALOpen.

> > 2. Perhaps assert() should be used only to detect cases of 
> > a logical flaw in the code, rather than unexpected input data?
> 
> I completely agree.

Oh good! :)

-Ben


From dron at ak4719.spb.edu  Fri Mar  5 02:31:12 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <009101c4027a$596148b0$f400fe0a@TOPP2>
References: <ED3A48B9840E594890A2BC172D119465FB9514@mailman.san.com> <009101c4027a$596148b0$f400fe0a@TOPP2>
Message-ID: <20040305073112.GA7508@ak4719.spb.edu>

On Fri, Mar 05, 2004 at 01:23:17AM -0500, Ben Discoe wrote:
> > gdalwarp kaena_pt.tif kaena_pt2.tif
> Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
> "XMLPacket"; tag ignored
> Creating output file is that 5371P x 3251L.
> Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
> "XMLPacket"; tag ignored
> ERROR 1: JPEGLib:JPEG parameter struct mismatch: library thinks size is 464,
> caller expects 432

The most interesting thing here is that we still have troubles with the
size of boolean datatype. Ben, do you using external libtiff and libjpeg
libraries? If yes, what version of libtiff?

					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From ben at vterrain.org  Fri Mar  5 02:40:30 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <20040305073112.GA7508@ak4719.spb.edu>
Message-ID: <009601c40285$22b1f390$f400fe0a@TOPP2>

> The most interesting thing here is that we still have 
> troubles with the size of boolean datatype. Ben, do you
> using external libtiff and libjpeg libraries? If yes,
> what version of libtiff?
> 					Andrey

In my nmake.opt, there are lines like "if using an external library
uncomment the following lines," and i haven't uncommented any of them for
JPEG, PNG, TIFF, GEOTIFF.  So i am left to assume that GDAL is using the
internal versions for all of these.

Compiler is MSVC 7.1 on Windows XP.

-Ben


From dron at ak4719.spb.edu  Fri Mar  5 03:52:05 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <009601c40285$22b1f390$f400fe0a@TOPP2>
References: <20040305073112.GA7508@ak4719.spb.edu> <009601c40285$22b1f390$f400fe0a@TOPP2>
Message-ID: <20040305085205.GA15809@ak4719.spb.edu>

On Fri, Mar 05, 2004 at 02:40:30AM -0500, Ben Discoe wrote:
> > The most interesting thing here is that we still have 
> > troubles with the size of boolean datatype. Ben, do you
> > using external libtiff and libjpeg libraries? If yes,
> > what version of libtiff?
> In my nmake.opt, there are lines like "if using an external library
> uncomment the following lines," and i haven't uncommented any of them for
> JPEG, PNG, TIFF, GEOTIFF.  So i am left to assume that GDAL is using the
> internal versions for all of these.
> Compiler is MSVC 7.1 on Windows XP.

It seems that I have made a mistake when fixing that problem. Please,
try the following patch against tif_jpeg.c and see if problem with
"JPEGLib: JPEG parameter struct mismatch" disappeared:


--- tif_jpeg.c.bak	2004-03-05 11:47:34.000000000 +0300
+++ tif_jpeg.c	2004-03-05 11:47:43.000000000 +0300
@@ -69,8 +69,8 @@
 #if defined(__WIN32__)
 # ifndef __RPCNDR_H__            /* don't conflict if rpcndr.h already read */
    typedef unsigned char boolean;
-# endif
 # define HAVE_BOOLEAN            /* prevent jmorecfg.h from redefining it */
+# endif
 #endif
 
 #include "jpeglib.h"


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From dacianliu at hotmail.com  Fri Mar  5 12:20:58 2004
From: dacianliu at hotmail.com (=?gb2312?B?wfUgx+y7qg==?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <Law10-F96yhJzqNwiGn00003fdc@hotmail.com>

hi, all
i am new to GDAL. it is great. and i would like to know how to visualize 
the images on Windows with Windows GDI.
any suggestions would be very appreciated.
thanks in advance

_________________________________________________________________
 MSN Explorer:   http://explorer.msn.com/lccn  


From bclay at ball.com  Fri Mar  5 13:10:20 2004
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <E4394C8445EFCC4AA136A1C305E4C9280153EF5F@APPMSG2.AERO.BALL.COM>

Check out Demeter.  It used GDAL and OpenSceneGraph.  OpenSceneGraph will have direct support as soon as Robert is finished with his plugins


-----Original Message-----
From: dacianliu@hotmail.com [mailto:dacianliu@hotmail.com] 
Sent: Friday, March 05, 2004 12:21 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] how to draw images on Windows


hi, all
i am new to GDAL. it is great. and i would like to know how to visualize 
the images on Windows with Windows GDI.
any suggestions would be very appreciated.
thanks in advance

_________________________________________________________________
 MSN Explorer:   http://explorer.msn.com/lccn  

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar  5 13:11:04 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
In-Reply-To: <Law10-F96yhJzqNwiGn00003fdc@hotmail.com>
References: <Law10-F96yhJzqNwiGn00003fdc@hotmail.com>
Message-ID: <4048C2B8.90706@pobox.com>

  wrote:
> hi, all
> i am new to GDAL. it is great. and i would like to know how to visualize 
> the images on Windows with Windows GDI.
> any suggestions would be very appreciated.
> thanks in advance

 ,

There is no built-in support for display within the GDAL library.  It may
be that someone will volunteer some suggestions on how to do this, but
I wouldn't hold my breath.

Generally, you can just read up on how GDI image drawing is done.  You
will need to load the raster data into a "DIB" (I think that is the
right terminology), which is a raster image in memory.  You have to
create all the DIB headers yourself, but the data can be loaded into
the raster array itself directly using GDAL's RasterIO() functions.

Be carefuly about band mappings and image orientation.  I think DIBs
are upside down (the first line in the buffer is the bottom of the image)
and that they are in BGRA or perhaps ABGR order instead of the RGB or
RGBA you would normally get from GDAL supported raster files.

If you find your getting an upside image, or one with red and blue
mixed up you might want to ask here how to remap these sorts of things
using the GDAL RasterIO() calls.  Till then, good luck with GDI.  I
certainly don't want to touch it again!

Good luck,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Mar  5 13:24:23 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] EPSG 6.5 and extended Dictionary lookups
Message-ID: <4048C5D7.1090205@pobox.com>

Folks,

As part of the GDAL 1.2.0 release I updated to EPSG 6.5 coordinate systems.
That should be in the beta snapshot.

I have also (in CVS) added support for reading coordinate system dicionaries.
This mechanism basically allows coordinate system codes to be looked up in
a text file (from the GDAL data directory), where the code is corresponded
to a WKT representation of the coordinate system.

I am currently using these dictionary files to hold a bunch of "non-standard"
EPSG coordinate systems. Basically a bunch of special codes uses in the WMS
world (and harvested from a CubeWerx dictionary in a similar format) and
from all the non-EPSG ESRI coordinate systems normally found in their "epsg"
directory.

The dictionary files are just simple text files, following the following
rules:
  o Empty lines, or lines starting with "#" are ignored (comments).
  o Lines starting with "include " can name an additional file that will
    be searched.
  o data lines should be a code seperated from the WKT representation by a
    comma.

eg.

include cubewerx_extra.wkt
#
#  OGC-defined "AUTO" codes
#  http://www.digitalearth.gov/wmt/auto.html
#
42001,PROJCS["WGS 84 / Auto UTM%s",GEOGCS[...]]
42002,PROJCS["WGS 84 / Auto Tr. Mercator",...]

A new method, OGRSpatialReference::importFromDict() has been added supporting
the dictionaries.  As well the SetFromUserInput() now supports the funky format
"DICT:filename,code" as a way of requesting an arbitrary dictionary entry.
Also, the importFromEPSG() method will now search the epsg.wkt dictionary
(which includes the cubewerx and esri definitions) *if* the coordinate system
isn't found in the pcs.csv or gcs.csv files.

Other than providing a heads up, I am writing to see if there is anyone
interested in coordinate system use through GDAL that would like a crack
at testing this *before* the 1.2.0 release.  If so, please grab a nightly
snapshot and give it a spin.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ed at topozone.com  Fri Mar  5 13:58:37 2004
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] EPSG 6.5 and extended Dictionary lookups
Message-ID: <13858AA1A74F30419F319ACB66A9D1224E3EBF@mercator.topozone.com>

Frank -

Thanks for this change; although it hasn't been a HUGE problem, I really
don't like polluting my epsg files with various other coordinate
systems.  This will certainly help in the maintenance department!

	- Ed

Ed McNierney
President and Chief Mapmaker
TopoZone.com / Maps a la carte, Inc.
73 Princeton Street, Suite 305
North Chelmsford, MA  01863
ed@topozone.com
(978) 251-4242  

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, March 05, 2004 1:24 PM
To: gdal-dev
Subject: [Gdal-dev] EPSG 6.5 and extended Dictionary lookups

Folks,

As part of the GDAL 1.2.0 release I updated to EPSG 6.5 coordinate
systems.
That should be in the beta snapshot.

I have also (in CVS) added support for reading coordinate system
dicionaries.
This mechanism basically allows coordinate system codes to be looked up
in a text file (from the GDAL data directory), where the code is
corresponded to a WKT representation of the coordinate system.

I am currently using these dictionary files to hold a bunch of
"non-standard"
EPSG coordinate systems. Basically a bunch of special codes uses in the
WMS world (and harvested from a CubeWerx dictionary in a similar format)
and from all the non-EPSG ESRI coordinate systems normally found in
their "epsg"
directory.

The dictionary files are just simple text files, following the following
rules:
  o Empty lines, or lines starting with "#" are ignored (comments).
  o Lines starting with "include " can name an additional file that will
    be searched.
  o data lines should be a code seperated from the WKT representation by
a
    comma.

eg.

include cubewerx_extra.wkt
#
#  OGC-defined "AUTO" codes
#  http://www.digitalearth.gov/wmt/auto.html
#
42001,PROJCS["WGS 84 / Auto UTM%s",GEOGCS[...]] 42002,PROJCS["WGS 84 /
Auto Tr. Mercator",...]

A new method, OGRSpatialReference::importFromDict() has been added
supporting the dictionaries.  As well the SetFromUserInput() now
supports the funky format "DICT:filename,code" as a way of requesting an
arbitrary dictionary entry.
Also, the importFromEPSG() method will now search the epsg.wkt
dictionary (which includes the cubewerx and esri definitions) *if* the
coordinate system isn't found in the pcs.csv or gcs.csv files.

Other than providing a heads up, I am writing to see if there is anyone
interested in coordinate system use through GDAL that would like a crack
at testing this *before* the 1.2.0 release.  If so, please grab a
nightly snapshot and give it a spin.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev


From warmerdam at pobox.com  Fri Mar  5 14:16:59 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] EPSG 6.5 and extended Dictionary lookups
In-Reply-To: <13858AA1A74F30419F319ACB66A9D1224E3EBF@mercator.topozone.com>
References: <13858AA1A74F30419F319ACB66A9D1224E3EBF@mercator.topozone.com>
Message-ID: <4048D22B.2070104@pobox.com>

Ed McNierney wrote:
> Frank -
> 
> Thanks for this change; although it hasn't been a HUGE problem, I really
> don't like polluting my epsg files with various other coordinate
> systems.  This will certainly help in the maintenance department!

Ed,

I should clarify that this doesn't affect PROJ.4.  Proj.4 has similar concepts
of dictionary lookup (with the include concept) but what I am talking about
really is at the OGRSpatialReference object level in GDAL.  OGR has pretty
much its own coordinate system handling logic built around OGC Well Known
Text format.  It still uses PROJ.4 to do transformations, but just converts
the WKT format to PROJ.4 strings "at the last moment".

Part of the reasoning here is that PROJ.4 coordinate system definitions
strings aren't really as comprehensive as WKT (more so in the past ... some
of the missing information has been creeping into PROJ.4).

Now, the epsg and other lookup dictionaries for PROJ.4 are built by looking
up things on the OGRSpatialReference, so I hope my changes will make it
easier to build and maintain PROJ.4 dictionaries in the future.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Fri Mar  5 14:48:17 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <ED3A48B9840E594890A2BC172D119465E63ABE@mailman.san.com>

Dude,

I know exactly how to do this.  Piece of cake.  I will send you the code in a bit when I get a chance.  Renders every raster GDAL can dish up.  The big issue is realigning the bits to meet a windows bit restriction in the row width of a DIB (Device Independent bitmap).  Like frank said, then you have to flip the image by reversing the y sign to negative.  I'll send the code shortly.  It's VC++ and uses the GDI and is fast as snot.

Martin

-----Original Message-----
From: dacianliu@hotmail.com [mailto:dacianliu@hotmail.com] 
Sent: Friday, March 05, 2004 10:21 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] how to draw images on Windows


hi, all
i am new to GDAL. it is great. and i would like to know how to visualize 
the images on Windows with Windows GDI.
any suggestions would be very appreciated.
thanks in advance

_________________________________________________________________
 MSN Explorer:   http://explorer.msn.com/lccn  

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org http://remotesensing.org/mailman/listinfo/gdal-dev

From matt.wilkie at gov.yk.ca  Fri Mar  5 16:43:23 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63ABE@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63ABE@mailman.san.com>
Message-ID: <4048F47B.4090802@gov.yk.ca>

> I know exactly how to do this.  Piece of cake.  I will send you the
[...]
> sign to negative. I'll send the code shortly.  It's VC++ and uses the
> GDI and is fast as snot.

Sounds intriguing Martin, is there an end-user app in the works?

-matt


From MChapman at sanz.com  Fri Mar  5 17:05:16 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9516@mailman.san.com>

All,

1. First of all you need the attached helper class which represents a windows DIB Section, add this class to your application.  

2. You need to open the image with GDAL and get the 3 bands you want to use as rgb (three pointers, or an array of pointers to the band buffers).  There is good sample code out there to open a file with GDAL and get a pointer to each band buffer.

3. You need to bit interleave each raster band buffer.  That basically means that instead of having each band buffer contain all values for a band, such as red, green or blue, you need one big band buffer that contains the the the rgb as interleaved, ie... Bit format = r,g,b,r,g,b,r,g,b,r,g,b.... And so on rather than band1 = r,r,r,r,r,r,r,r,r, band 2 = g,g,g,g,g,g,g,g,g, band 3 = b,b,b,b,b,b,b,b,b,b.  The following code snippet shows how to do it fast (I use memcpy because arrays and vectors are way to slow for this operation).  Notice also, that it does it differently depending on whether it's raster data or elevation data.  File tye 2 = raster (unsigned char raster data), and file type 3 = elevation data (short and float raster data).  The pCombinedBytes pointer holds all three bands after they are interleaved.  File type 2 also uses the GDAL color table for unsigned char raster data to get it's color values.  nSize is how many bands, which will always be 3 for windows (rgb).  nWidth and nHeight are the width and height of the image (or area of interest within the image that you want, get this from GDALRasterBand->GetBandX(), ...->GetBandY() ...or some method like that).  pBandBuffer is an array of pointers to the raster band data retrieved from GDALRasterBand->RasterIO().  m_DataType is the image data type, obtained from GDALRasterBand->->GetRasterDataType().


unsigned char* pCombinedBytes = (unsigned char*) CPLMalloc(sizeof(unsigned char) * nWidth * nHeight * nSize);

for (long i = 0, long j = 0; i < (nWidth * nHeight * nSize); i += nSize, j++)
{
	int k = i;

	if (m_nFileType == 2)
	{
		for (int m = nSize - 1; m >= 0; m--, k++)
		{
			unsigned char* pBytes = (unsigned char*) pBandBuffer[m];
			ptr_dest = pCombinedBytes + k;
			unsigned char b = pBytes[j];

			if (pCT != NULL)
			{
				GDALColorEntry ce;
				unsigned int c = (unsigned int) b;
				c = pCT->GetColorEntryAsRGB(c, &ce);
				if (m == 0) c = ce.c1;
				if (m == 1) c = ce.c2;
				if (m == 2) c = ce.c3;
				b = (unsigned char) c;
			}

			ptr_src = &b;
			memcpy(ptr_dest, ptr_src, 1);
		}
	}
	else
	{
		if (m_DataType == GDT_Int16 || m_DataType == GDT_Byte)
		{
			for (int m = nSize - 1; m >= 0; m--, k++)
			{
				short* pBytes = (short*) pBandBuffer[m];
				ptr_dest = pCombinedBytes + k;
				short nVal = pBytes[j];
				unsigned char uc = (nVal & 0xffff) >> 4;
				ptr_src = &uc;
				memcpy(ptr_dest, ptr_src, 1);
			}
		}
		else
		{
			for (int m = nSize - 1; m >= 0; m--, k++)
			{
				float* pBytes = (float*) pBandBuffer[m];
				ptr_dest = pCombinedBytes + k;
				float nVal = pBytes[j];
				unsigned char uc = (unsigned char) nVal >> 8;
				ptr_src = &uc;
				memcpy(ptr_dest, ptr_src, 1);
			}
		}
	}
}


4. Then you need to realign the bytes for the windows DIB Section.  This code, uses the CDIBSection class and loads it's byte array (the image data) by re-aligning the bytes to the windows width restriction.  Note, the issue of flipping the y value that Frank mentioned is taken care of in the CDIBSection class by multiplying the y value by negative one.  You can refer to the CDIBSection class to see the implementation of that.

if ((nWidth > 0) && (nHeight > 0))
{
	if (m_pDIBSection) delete m_pDIBSection;
		m_pDIBSection = new CDIBSection;

	if (m_pDIBSection)
	{
		m_pDIBSection->Create(nWidth ,nHeight, 24);
		unsigned int dibwidth = m_pDIBSection->GetTotalWidth();

		GByte* dest = (GByte*) m_pDIBSection->GetBits();
		GByte* src = (GByte*) pCombinedBytes;

		for (int row = 0; row < nHeight; row++)
		{
			ptr_dest = dest + row * dibwidth * nSize;
			ptr_src = src + row * nWidth * nSize;
					memcpy(ptr_dest, ptr_src, nWidth * nSize);
		}
	}
}

5.  Lastly, you need to display the m_pDIBSection in your Cview window.  To do this override the CView's OnPaint() function and call the CDIBSection's Draw() method like so:

void CMyView::OnPaint() 
{
	try
	{
		CPaintDC dc(this);
		CMemDC pDC(&dc);

		if (m_pDIBSection)
		{
			m_pDIBSection->Draw(&pDC, 0, 0);	
		}
	}
	catch(...)
	{
		//
	}
}

Thi works great for me on all rasters that GDAL supports.  Plus it can be used for any other raster not obtained from GDAL.  Just need to remove the GDAL specific stuff like the color table.  Let me know whether you have problems or questions.

Martin Chapman

P.S.  I hope this will work for anyone interested in using GDAL on windows.  Maybe I will post a sample MFC app in the future so you can see the whole thing in action.


-----Original Message-----
From: dacianliu@hotmail.com [mailto:dacianliu@hotmail.com] 
Sent: Friday, March 05, 2004 10:21 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] how to draw images on Windows


hi, all
i am new to GDAL. it is great. and i would like to know how to visualize 
the images on Windows with Windows GDI.
any suggestions would be very appreciated.
thanks in advance

_________________________________________________________________
 MSN Explorer:   http://explorer.msn.com/lccn  

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org http://remotesensing.org/mailman/listinfo/gdal-dev
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CDIBSection.zip
Type: application/x-zip-compressed
Size: 1712 bytes
Desc: CDIBSection.zip
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040305/59876418/CDIBSection.bin
From MChapman at sanz.com  Fri Mar  5 17:06:12 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9517@mailman.san.com>

Matt,

Yes there is, would you like some screen shots?

Martin

-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 05, 2004 2:43 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] how to draw images on Windows


> I know exactly how to do this.  Piece of cake.  I will send you the
[...]
> sign to negative. I'll send the code shortly.  It's VC++ and uses the 
> GDI and is fast as snot.

Sounds intriguing Martin, is there an end-user app in the works?

-matt

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From ben at vterrain.org  Fri Mar  5 17:09:49 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
Message-ID: <012a01c402fe$93cc6050$f400fe0a@TOPP2>

Andrey,

I re-read your message, and you said to replace the jconfig.h AND don't
change the order of the # define HAVE_BOOLEAN in tif_jpeg.c.  So, i tried
that, and rebuilt GDAL.

Now, the major problem is fixed!  Wonderful!  Only a couple warnings are
left, but no crash:

C:\APIs\gdal120a\bin>gdalwarp kaena_pt.tif kaena_pt2.tif
Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
"XMLPacket"; tag ignored
Creating output file is that 5371P x 3251L.
Warning 1: TIFFReadDirectory:kaena_pt.tif: wrong data type 1 for
"XMLPacket"; tag ignored
:0...10...20...30...40...50...60...70...80...90...100 - done.

Thanks,
Ben

> -----Original Message-----
> From: Ben Discoe [mailto:ben@vterrain.org] 
> Sent: Friday, March 05, 2004 5:03 PM
> To: 'Andrey Kiselev'
> Subject: RE: [Gdal-dev] Use of assert() on troublesome files
> 
> Andrey,
> 
> I replaced my jconfig.h with your file.  That got GDAL to 
> compile cleanly.
> 
> However, when i run the resulting DLL with gdalwarp on my TIF 
> file, i still get these same errors:


From ben at vterrain.org  Fri Mar  5 17:19:31 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9516@mailman.san.com>
Message-ID: <012b01c402ff$eefed290$f400fe0a@TOPP2>

Just as a point of reference, the open-source application VTBuilder, in the
free VTP software, uses exactly this approach to read GDAL files and render
them as DIBSections on Windows, and has been available for years.

And yes, it is "fast as snot" on Win32  :)

The frustrating thing is on Linux, there are no DIBSections so it is
painfully slow to scroll around large images...

-Ben
http://vterrain.org/

> -----Original Message-----
> From: Chapman, Martin
> Sent: Friday, March 05, 2004 5:05 PM
> To: gdal-dev@remotesensing.org
> Subject: RE: [Gdal-dev] how to draw images on Windows
>
> All,
>
> 1. First of all you need the attached helper class which
> represents a windows DIB Section, add this class to your
> application. 
>
> 2. You need to open the image with GDAL and get the 3 bands
> you want to use as rgb [...] 


From nhv at cape.com  Fri Mar  5 17:44:59 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
In-Reply-To: <012b01c402ff$eefed290$f400fe0a@TOPP2>
Message-ID: <EKEJIKAILPONGGENMBGAMELAGKAA.nhv@cape.com>

Ben Discoe writes:
> 
> Just as a point of reference, the open-source application VTBuilder, in the
> free VTP software, uses exactly this approach to read GDAL files and render
> them as DIBSections on Windows, and has been available for years.
> 
> And yes, it is "fast as snot" on Win32  :)
> 
> The frustrating thing is on Linux, there are no DIBSections so it is
> painfully slow to scroll around large images...

FYI
I have always found using an in-memory tiling such as is done in TIFF overviews
and then using a tiled based drawing approach "fast as snot" on all the systems 
I have tried it on since the days when a '286' was king :-)

Cheers

Norman

From MChapman at sanz.com  Fri Mar  5 18:03:11 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] how to draw images on Windows
Message-ID: <ED3A48B9840E594890A2BC172D119465E63AC0@mailman.san.com>

Norman,

How do you do a tiled based drawing approach?  Is that better than what
I'm doing with the DIB Section?   

Martin


-----Original Message-----
From: Norman Vine [mailto:nhv@cape.com] 
Sent: Friday, March 05, 2004 3:45 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] how to draw images on Windows


Ben Discoe writes:
> 
> Just as a point of reference, the open-source application VTBuilder, 
> in the free VTP software, uses exactly this approach to read GDAL 
> files and render them as DIBSections on Windows, and has been 
> available for years.
> 
> And yes, it is "fast as snot" on Win32  :)
> 
> The frustrating thing is on Linux, there are no DIBSections so it is 
> painfully slow to scroll around large images...

FYI
I have always found using an in-memory tiling such as is done in TIFF
overviews and then using a tiled based drawing approach "fast as snot"
on all the systems 
I have tried it on since the days when a '286' was king :-)

Cheers

Norman
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From dron at ak4719.spb.edu  Sat Mar  6 07:24:59 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Use of assert() on troublesome files
In-Reply-To: <012a01c402fe$93cc6050$f400fe0a@TOPP2>
References: <012a01c402fe$93cc6050$f400fe0a@TOPP2>
Message-ID: <20040306122459.GA2915@ak4719.spb.edu>

On Fri, Mar 05, 2004 at 05:09:49PM -0500, Ben Discoe wrote:
> I re-read your message, and you said to replace the jconfig.h AND
> don't change the order of the # define HAVE_BOOLEAN in tif_jpeg.c.
> So, i tried that, and rebuilt GDAL.
> 
> Now, the major problem is fixed!  Wonderful!  Only a couple warnings
> are left, but no crash:

Well, this is fine and this is meant my workaround for boolean datatype
in tif_jpeg.c still doesn't work. Very bad... I shall try to come with
more comprehensive hack for that problem.

						Regards,
						Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From support at geoimage.fr  Mon Mar  8 06:35:54 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu>
Message-ID: <055301c40501$84f37370$e32346c0@pili>

Hello,
I have tested with the new configure script (from cvs) :

./configure --prefix=`pwd`/RELEASE \
--with-libtiff=$PORTAGE/LIBRAIRIES/libTIFF/src/SOLARIS2_6 \
--with-geotiff=$PORTAGE/LIBRAIRIES/libGEOTIFF/src/SOLARIS2_6 \
--with-local=$PORTAGE/LIBRAIRIES/libHDF/src/SOLARIS \
--with-threads="-lposix4 -lnsl" \
--with-hdf4=$PORTAGE/LIBRAIRIES/libHDF/src/SOLARIS \
--without-jasper --with-jpeg=internal --with-libz=internal \
--with-png=internal --without-libtool --without-ld-shared \
--with-static-proj4=/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libPROJ/src/SOLARIS2_6

Where /home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libPROJ/src/SOLARIS2_6 is the installation
directory of Proj4 created by 'make install'.

The content of this directory :
  bin:     cs2cs geod invgeod invproj nad2bin nad2nad proj
  include:    nad_list.h proj_api.h projects.h
  lib: libproj.a libproj.la
  man:man1 man3
  share:proj

But configure returns :

   Statically link PROJ.4: no

In the file GDAL.make.opt :
--------------------------------------------------------------------------------
#
# PROJ.4 stuff
#
PROJ_STATIC = no
ifeq ($(PROJ_STATIC),yes)
PROJ_FLAGS = -DPROJ_STATIC
endif
PROJ_INCLUDE = -I/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libPROJ/src/SOLARIS2_6/include
GDAL_LIBS = $(GDAL_LIB)
ifeq ($(OGR_ENABLED),yes)
GDAL_LIBS := $(GDAL_LIB) $(PG_LIB) $(OCI_LIB) $(GDAL_LIBS)
endif
--------------------------------------------------------------------------------

It seems that find the include but not the library...
In the file "config.log", the "src" sub-directory is tested :

--------------------------------------------------------------------------------
configure:23474: checking how to link PROJ.4 library
configure:23493: result: link statically.
configure:23573: checking for pj_init in -lproj
configure:23603: gcc -o
conftest -g -O2 -I/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libHDF/src/SOLARIS/include -DCPL_MULTIPROC_PTHREAD -I/home/l
isbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libHDF/src/SOLARIS/include
conftest.c -lproj -L/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libPROJ/src/SOLARIS2
_6/src -lproj -L/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libHDF/src/SOLARIS/lib -lmfhdf -ldf -L/home/lisbonne/1/GEOIMAGE
_SRC/LIBRAIRIES/libGEOTI
FF/src/SOLARIS2_6 -lgeotiff -L/home/lisbonne/1/GEOIMAGE_SRC/LIBRAIRIES/libTIFF/src/SOLARIS2_6 -ltiff -lposix4 -lnsl -lm 
-ldl -L/home/lisbonne/1
/GEOIMAGE_SRC/LIBRAIRIES/libHDF/src/SOLARIS/lib >&5
ld: fatal: library -lproj: not found
ld: fatal: library -lproj: not found
ld: fatal: File processing errors. No output written to conftest
collect2: ld returned 1 exit status
configure:23609: $? = 1
configure: failed program was:
| /* confdefs.h. */
|
| #define PACKAGE_NAME ""
| #define PACKAGE_TARNAME ""
| #define PACKAGE_VERSION ""
| #define PACKAGE_STRING ""
| #define PACKAGE_BUGREPORT ""
| #define STDC_HEADERS 1
| #define HAVE_SYS_TYPES_H 1
| #define HAVE_SYS_STAT_H 1
| #define HAVE_STDLIB_H 1
| #define HAVE_STRING_H 1
| #define HAVE_MEMORY_H 1
| #define HAVE_STRINGS_H 1
| #define HAVE_INTTYPES_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_DLFCN_H 1
| #define HAVE_LIBDL 1
| #define HAVE_LIBM 1
| #define STDC_HEADERS 1
| #define HAVE_FCNTL_H 1
| #define HAVE_UNISTD_H 1
| #define HAVE_DLFCN_H 1
| #define HAVE_LIMITS_H 1
| #define HAVE_LOCALE_H 1
| #define WORDS_BIGENDIAN 1
| #define HAVE_VPRINTF 1
| #define HAVE_DOPRNT 1
| #define HAVE_VSNPRINTF 1
| #define HAVE_SNPRINTF 1
| #define HAVE_LONG_LONG 1
| #define UNIX_STDIO_64 1
| #define VSI_LARGE_API_SUPPORTED 1
| #define VSI_FTELL64 ftello64
| #define VSI_FSEEK64 fseeko64
| /* end confdefs.h. */
|
| /* Override any gcc2 internal prototype to avoid an error. */
| #ifdef __cplusplus
| extern "C"
| #endif
| /* We use char because int might match the return type of a gcc2
| builtin and then its argument prototype would still apply. */
| char pj_init ();
| int
| main ()
| {
| pj_init ();
| ;
| return 0;
| }
configure:23634: result: no
configure:23955: checking GDAL version
configure:23975: result: 1.2.0

--------------------------------------------------------------------------------

But it seems that the others candidate directories are not tested...
Oh, I just see something in configure.in :

--------------------------------------------------------------------------------
if test "PROJ_STATIC" = "no"; then
LIBS="-L$with_static_proj4/lib $PROJ_LIB $ORIG_LIBS"
AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
fi
--------------------------------------------------------------------------------

It seems that the $ is missing before PROJ_STATIC...and so the test is always
false and the other directories are never tested...
What does i need to recreate configure from configure.in ?
Thanks in advance,
Frederic.

----- Original Message ----- 
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: <gdal-dev@remotesensing.org>
Sent: Wednesday, March 03, 2004 12:54 PM
Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build


> On Tue, Mar 02, 2004 at 05:22:44PM +0100, Fr?d?ric Trastour wrote:
> > The problem is that "/src" is automatically appended to the specified
> > directory. The "make install" command in the PROJ4 build tree doesn't
> > create a src dir in the install tree ( only include, lib, bin and
> > share - and it's ok). So I have to create an 'src' in the PROJ
> > installation tree and link the libproj.a library from lib to src.
>
> I have commited a few tweaks for --with-static-proj4 test, could you
> test this again?
>
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From roger at beardandsandals.co.uk  Mon Mar  8 12:17:03 2004
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
Message-ID: <000001c40531$2dc4dff0$fe0ba8c0@lancaster.beardandsandals.co.uk>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_vc7.zip
Type: application/octet-stream
Size: 19463 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040308/ecffda79/gdal_vc7.obj
From warmerdam at pobox.com  Mon Mar  8 12:41:47 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <000001c40531$2dc4dff0$fe0ba8c0@lancaster.beardandsandals.co.uk>
References: <000001c40531$2dc4dff0$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <404CB05B.2020308@pobox.com>

Roger James wrote:
> Frank,
> 
>  
> 
> I have hacked up a build solution for gdal under vc7. Just uncompress 
> that attached zip at the top level of the build tree. The only thing 
> that may need changing is the location of the xerces includes in the 
> additional include directories section of pre-processor section of the 
> gdal projects and the xerces lib in the additional libraries section of 
> the linker properties of the gdal dll project and statically linked 
> utitlities projects. This should work alongside the normal nmake based 
> build procedure. If you or anyone else wants to use/modify this, feel 
> free to do so, on the understanding that I take no responsibility for it!

Roger,

Thanks. I'm not going to put it in CVS since there wouldn't be anyone
maintaining it, but at least it will be in the Email archive if someone
wants to grab it and update it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jason.hughes at elantech-inc.com  Mon Mar  8 13:40:14 2004
From: jason.hughes at elantech-inc.com (Jason R Hughes)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
References: <000001c40531$2dc4dff0$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <003801c4053c$cbdc8520$1da8a8c0@machamp>

Thanks that came in handy.
  ----- Original Message ----- 
  From: Roger James 
  To: gdal-dev@remotesensing.org 
  Sent: Monday, March 08, 2004 12:17 PM
  Subject: [Gdal-dev] A build solution for VC7


  Frank,



  I have hacked up a build solution for gdal under vc7. Just uncompress that attached zip at the top level of the build tree. The only thing that may need changing is the location of the xerces includes in the additional include directories section of pre-processor section of the gdal projects and the xerces lib in the additional libraries section of the linker properties of the gdal dll project and statically linked utitlities projects. This should work alongside the normal nmake based build procedure. If you or anyone else wants to use/modify this, feel free to do so, on the understanding that I take no responsibility for it!



  Roger
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040308/fb7c9e16/attachment.html
From dron at ak4719.spb.edu  Mon Mar  8 13:36:35 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <055301c40501$84f37370$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili>
Message-ID: <20040308183635.GA22121@ak4719.spb.edu>

On Mon, Mar 08, 2004 at 12:35:54PM +0100, Fr?d?ric Trastour wrote:
> if test "PROJ_STATIC" = "no"; then
> 
> It seems that the $ is missing before PROJ_STATIC...and so the test is
> always false and the other directories are never tested...

That's it! Fixed in CVS (finally, I hope). Thank you for finding that
problem.

> What does i need to recreate configure from configure.in ?

You need GNU autoconf tool.

					Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From shadow at dementia.org  Mon Mar  8 17:32:15 2004
From: shadow at dementia.org (Derrick J Brashear)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] EPSG 6.5 and extended Dictionary lookups
In-Reply-To: <4048C5D7.1090205@pobox.com>
References: <4048C5D7.1090205@pobox.com>
Message-ID: <Pine.GSO.4.58-035.0403081730160.19616@johnstown.andrew.cmu.edu>

On Fri, 5 Mar 2004, Frank Warmerdam wrote:

> Folks,
>
> As part of the GDAL 1.2.0 release I updated to EPSG 6.5 coordinate systems.
> That should be in the beta snapshot.
>
> I have also (in CVS) added support for reading coordinate system dicionaries.
> This mechanism basically allows coordinate system codes to be looked up in
> a text file (from the GDAL data directory), where the code is corresponded
> to a WKT representation of the coordinate system.

would it be worthwhile to provide a way to compile these in like the rest
of the epsg tables can be (at compile time, of course)?

actually, i assume not.


From ben at vterrain.org  Tue Mar  9 04:17:35 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <000001c40531$2dc4dff0$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <002001c405b7$5c1d13a0$f400fe0a@TOPP2>


First, thanks Roger for doing this.  I didn't think it was possible!
It tried out the VC7 project files tonight on a fresh gdal from CVS.  It
works.  Only a few minor issues.

1. The Xerces include path, as you mentioned, will vary from machine to
machine - perhaps better to let the developer put it on their VC7 standard
include path and leave it out of the project completely.

2. The recent 'ogr_srs_dist.cpp' module needed to be added.

3. Project files were missing for ogrinfo and ogr2ogr.

4. The 'Release' builds still had Debug-Info output enabled.

5. The output folders were inconsistent; 'Release' and 'Release_DLL' both
appeared for the Release_DLL configuration.

I've fixed all these issues; result is the attached zip.

-Ben

> -----Original Message-----
> From: gdal-dev-admin@remotesensing.org 
> [mailto:gdal-dev-admin@remotesensing.org] On Behalf Of Roger James
> Sent: Monday, March 08, 2004 12:17 PM
> To: gdal-dev@remotesensing.org
> Subject: [Gdal-dev] A build solution for VC7
> 
> Frank,
> 
> I have hacked up a build solution for gdal under vc7. Just 
> uncompress that attached zip at the top level of the build 
> tree. The only thing that may need changing is the location 
> of the xerces includes [..]
-------------- next part --------------
A non-text attachment was scrubbed...
Name: VisualStudio.zip
Type: application/x-zip-compressed
Size: 21830 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040309/601a8b3e/VisualStudio.bin
From roger at beardandsandals.co.uk  Tue Mar  9 06:30:22 2004
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <002001c405b7$5c1d13a0$f400fe0a@TOPP2>
Message-ID: <000501c405c9$ea1e34b0$fe0ba8c0@lancaster.beardandsandals.co.uk>

Thanks Ben,

My next question is. Is there an easy way to get rid of all those size_t
warnings!

Roger

> 
> I've fixed all these issues; result is the attached zip.
> 
> -Ben
> 



From roger at beardandsandals.co.uk  Tue Mar  9 16:12:05 2004
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <000501c405c9$ea1e34b0$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <000001c4061b$2d77b500$fe0ba8c0@lancaster.beardandsandals.co.uk>


A few minor tweaks.

I have removed the xerces directory stuff as per Ben's suggestion,
cleaned some redundant configs from the solution and added some more
configs to ogrinfo and ogr2ogr.

Roger
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal_vc7.zip
Type: application/octet-stream
Size: 21965 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040309/4d23f9da/gdal_vc7.obj
From ben at vterrain.org  Wed Mar 10 01:08:15 2004
From: ben at vterrain.org (Ben Discoe)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <000501c405c9$ea1e34b0$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <001801c40666$136b81a0$f400fe0a@TOPP2>

> -----Original Message-----
> From: Roger James
> 
> My next question is. Is there an easy way to get rid of all 
> those size_t warnings!

Easy way?  Well, the right way would be to fix 'em.  I tried swabbing out
bunches of them this evening.  It's a big task.  Worth it, in my opinion.
Code that compiles cleanly w/o hundreds of warnings is code you can feel
good about.  But that's up to the GDAL team to decide.

Sure, we could disable warning C4267, but there's not much point in a
cosmetic solution.

> A few minor tweaks.
> I have removed the xerces directory stuff as per Ben's suggestion,

Hmmm, i though i already took 'em out.  Maybe i missed some.

-Ben


From support at geoimage.fr  Wed Mar 10 07:23:43 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu>
Message-ID: <10a901c4069a$8746a260$e32346c0@pili>

Hello,

I have always the same problem with proj static linking : the configure script try to locate successively
the proj library in sereval directories : src, lib, .libs, ...

The problem is that when the first test fails, the result is "cached" - in a variable - and the others tests are not
done.

Perhaps there is a simple way to disable the caching mecanism used by AC_CHECK_LIB ?

Best regards,

Fr?d?ric.


----- Original Message ----- 
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: <gdal-dev@remotesensing.org>
Sent: Monday, March 08, 2004 7:36 PM
Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build


> On Mon, Mar 08, 2004 at 12:35:54PM +0100, Fr?d?ric Trastour wrote:
> > if test "PROJ_STATIC" = "no"; then
> >
> > It seems that the $ is missing before PROJ_STATIC...and so the test is
> > always false and the other directories are never tested...
>
> That's it! Fixed in CVS (finally, I hope). Thank you for finding that
> problem.
>
> > What does i need to recreate configure from configure.in ?
>
> You need GNU autoconf tool.
>
> Andrey
>
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Wed Mar 10 09:36:24 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <001801c40666$136b81a0$f400fe0a@TOPP2>
References: <001801c40666$136b81a0$f400fe0a@TOPP2>
Message-ID: <404F27E8.7070502@pobox.com>

Ben Discoe wrote:
> Easy way?  Well, the right way would be to fix 'em.  I tried swabbing out
> bunches of them this evening.  It's a big task.  Worth it, in my opinion.
> Code that compiles cleanly w/o hundreds of warnings is code you can feel
> good about.  But that's up to the GDAL team to decide.

Folks,

I'm not too sure what size_t warnings are being referred to.   Could someone
quote an example?

> Sure, we could disable warning C4267, but there's not much point in a
> cosmetic solution.

I disagree Ben.  There is a very good reason for a "cosmetic" solution that
disables a common warning.  It ensures that any other warnings will stick out.

The point of cleaning up non-dangerous warnings isn't to make us feel good
about the code.  It isn't because the thing in question is dangerous in itself.
It is because if we have lots of "junk" warnings we won't notice the ones we
should be keeping an eye out for, and then they won't help us.

When I build with NMAKE on VC7 I normally disable warnings 4706, 4127 and 4100.
With those supressions in place, I thought I was getting a fairly clean build.

I am interested in having clean builds though there are a few caveats.
  o There is some stuff in libtiff that I have reviewed but am hesitant to
    fiddle with even though it gives warnings on most compilers.
  o VC7 has raised the bar substantially in "pickyness" compared to VC6.  Given
    that I rarely work in this environment, there is a limit to how much work I
    will do to get clean builds in it.  My standard build environment is Linux
    GCC with -Wall (all warnings).

I am coming around to feel that it might be wise to include the Visual Studio
projects in future releases since there is obviously quite a bit of interest.
Is there a way of including the list of object files for a visual studio project
from an extra file?   It would be much easier to maintain the visual studio
projects if they could use the same list of source files as the NMAKE based
build and the Unix builds.  For instance, if I could have a "file.lst" in
each directory that assigns the list of .obj files for that directory to an
OBJ macro.  This could be used in the NMAKE files, and I could also use them
on unix since GNUmakefiles can easily transform the file list (converting .obj
to .o for instance).  If I could use the same file lists for a project file, it
would be (potentially) worth the effort to maintain it.

Of course, I just know people will start using the project files and then
start asking me all sorts of annoying questions I can't answer.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From gdal at warped-space.de  Wed Mar 10 11:05:13 2004
From: gdal at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] goode homolosine projection
Message-ID: <200403101705.13251.gdal@warped-space.de>

Hello,

Attached is a small patch to add OGR support for the goode homolosine
projection. 

Unfortunately, proj.4 does only support the uninterrupted form of the goode
projection,  so a reprojection won't work on global datasets in interrupted
form.
However, in a local context, you can adjust false easting and central
meridian values for the different zones. For a listing of false easting and
central meridian values used in the interrupted form, refer to Table 1 of
http://edcdaac.usgs.gov/1KM/goodesarticle.asp.

To reproject e.g. a MODIS dataset of North America
(ftp://ftp.glcf.umiacs.umd.edu/modis/500m/North_America/Goodes.NA.2003321/),
you could use the command-line:

gdalwarp <input> -s_srs '+proj=goode +ellps=sphere +lon_0=100w 
+x_0=-11119487.43'  <output options>

cheers,

	Manuel
-------------- next part --------------
A non-text attachment was scrubbed...
Name: goode_projection.diff
Type: text/x-diff
Size: 6971 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040310/29ab12fe/goode_projection.bin
From warmerdam at pobox.com  Wed Mar 10 12:20:53 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] goode homolosine projection
In-Reply-To: <200403101705.13251.gdal@warped-space.de>
References: <200403101705.13251.gdal@warped-space.de>
Message-ID: <404F4E75.80606@pobox.com>

Manuel Massing wrote:
> Hello,
> 
> Attached is a small patch to add OGR support for the goode homolosine
> projection. 
> 
> Unfortunately, proj.4 does only support the uninterrupted form of the goode
> projection,  so a reprojection won't work on global datasets in interrupted
> form.
> However, in a local context, you can adjust false easting and central
> meridian values for the different zones. For a listing of false easting and
> central meridian values used in the interrupted form, refer to Table 1 of
> http://edcdaac.usgs.gov/1KM/goodesarticle.asp.
> 
> To reproject e.g. a MODIS dataset of North America
> (ftp://ftp.glcf.umiacs.umd.edu/modis/500m/North_America/Goodes.NA.2003321/),
> you could use the command-line:
> 
> gdalwarp <input> -s_srs '+proj=goode +ellps=sphere +lon_0=100w 
> +x_0=-11119487.43'  <output options>

Manuel,

Would you mind submitting the patch via bugzilla?  I generally hate to add new
projection forms to OGR (thereby setting a WKT representation in stone) till
I have also reviewed ESRI and other WKT sources to see if they already have
a format for that projection.  Handling it through bugzilla will give me the
time to review and look at other sources before doing anything.

I would add that the interrupted form is what I really want to (as far as
I understand it).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Wed Mar 10 12:32:40 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <10a901c4069a$8746a260$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu> <10a901c4069a$8746a260$e32346c0@pili>
Message-ID: <20040310173240.GB5037@ak4719.spb.edu>

On Wed, Mar 10, 2004 at 01:23:43PM +0100, Fr?d?ric Trastour wrote:
> The problem is that when the first test fails, the result is "cached"
> - in a variable - and the others tests are not done.
> 
> Perhaps there is a simple way to disable the caching mecanism used by
> AC_CHECK_LIB ?

There is an attempt to disable caching at the start of the configure.in
script... seems it don't work for you. Autoconf manual contains the
following section, where described, how to disable cahcing. Could you
try whether the using .autom4te.cfg file in the GDAL root directory
helps you? If so I shall add that file to the repository.

Customizing `autom4te'
----------------------

One can customize `autom4te' via `~/.autom4te.cfg' (i.e., as found in
the user home directory), and `./.autom4te.cfg' (i.e., as found in the
directory from which `autom4te' is run).  The order is first reading
`autom4te.cfg', then `~/.autom4te.cfg', then `./.autom4te.cfg', and
finally the command line arguments.

   In these text files, comments are introduced with `#', and empty
lines are ignored.  Customization is performed on a per-language basis,
wrapped in between a `begin-language: "LANGUAGE"', `end-language: 
"LANGUAGE"' pair.

   Customizing a language stands for appending options (*note autom4te 
Invocation::) to the current definition of the language.  Options, and
more generally arguments, are introduced by `args: ARGUMENTS'.  You may
use the traditional shell syntax to quote the ARGUMENTS.

   As an example, to disable Autoconf caches (`autom4te.cache')
globally, include the following lines in `~/.autom4te.cfg':


## ------------------ ##
## User Preferences.  ##
## ------------------ ##

begin-language: "Autoconf"
args: --no-cache
end-language: "Autoconf"

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From roger at beardandsandals.co.uk  Wed Mar 10 12:45:23 2004
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] A build solution for VC7
In-Reply-To: <404F27E8.7070502@pobox.com>
Message-ID: <000001c406c7$77b92f20$fe0ba8c0@lancaster.beardandsandals.co.uk>

Frank,


> Folks,
> 
> I'm not too sure what size_t warnings are being referred to.   Could
> someone
> quote an example?
>

The problem is that at some point the size_t typedef on windows became
an unsigned int. I think it is something to do with 64 bit
compatability. C4267 is definitely a very bad warning to disable. I for
one am very much in the "every warning masks a potential error" camp. I
have mailed you a build log separately.
 
> I am coming around to feel that it might be wise to include the Visual
> Studio
> projects in future releases since there is obviously quite a bit of
> interest.
> Is there a way of including the list of object files for a visual
studio
> project
> from an extra file?

Not that I am aware of but maybe somebody else knows. I do not think it
would be beyond possibility (but beyond my own knowledge and timetable)
to make a perl script to edit the vcproj files. However, I am happy to
keep the files reasonably up to date and send you updates. My comments
on not wanting responsibility were of the legalistic nature seeing as
the files did not have any disclaimer associated with them. I did not
mean to wash my hands of them completely.

> 
> Of course, I just know people will start using the project files and
then
> start asking me all sorts of annoying questions I can't answer.
> 
That's what the rest of the lurkers on the list are for :-).

Roger



From support at geoimage.fr  Wed Mar 10 13:22:13 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu> <10a901c4069a$8746a260$e32346c0@pili> <20040310173240.GB5037@ak4719.spb.edu>
Message-ID: <110e01c406cc$9c301b70$e32346c0@pili>

Hello,

> There is an attempt to disable caching at the start of the configure.in
> script... seems it don't work for you. Autoconf manual contains the
> following section, where described, how to disable cahcing. Could you
> try whether the using .autom4te.cfg file in the GDAL root directory
> helps you? If so I shall add that file to the repository.
>
> Customizing `autom4te'
> ----------------------
>
> One can customize `autom4te' via `~/.autom4te.cfg' (i.e., as found in
> the user home directory), and `./.autom4te.cfg' (i.e., as found in the
> directory from which `autom4te' is run).  The order is first reading
> `autom4te.cfg', then `~/.autom4te.cfg', then `./.autom4te.cfg', and
> finally the command line arguments.
>
>    In these text files, comments are introduced with `#', and empty
> lines are ignored.  Customization is performed on a per-language basis,
> wrapped in between a `begin-language: "LANGUAGE"', `end-language:
> "LANGUAGE"' pair.
>
>    Customizing a language stands for appending options (*note autom4te
> Invocation::) to the current definition of the language.  Options, and
> more generally arguments, are introduced by `args: ARGUMENTS'.  You may
> use the traditional shell syntax to quote the ARGUMENTS.
>
>    As an example, to disable Autoconf caches (`autom4te.cache')
> globally, include the following lines in `~/.autom4te.cfg':
>
>
> ## ------------------ ##
> ## User Preferences.  ##
> ## ------------------ ##
>
> begin-language: "Autoconf"
> args: --no-cache
> end-language: "Autoconf"
>

I will try this... but i have to get autoconf and built it ( my version is outdated ) and also m4 and perl and...

Perhaps there is a solution directly from configure.in :

    the caching mecanism for "symbol in library" is based on shell variable.
    Perhaps it is possible to reset the concerned 'cache' variable ( ac_cv_lib_proj_pj_init ) to the
    unknown value when the symbol is not found, in the else part of the AC_CHECK_LIB :

    I mean something like :

            AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no;ac_cv_lib_proj_pj_init=unset,)

    I don't i it possible to put several instructions in the AC_CHECK_LIB macro.
    I will try if I get a working autoconf.

Thanks for your effort,

Fr?d?ric.


----- Original Message ----- 
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: <gdal-dev@remotesensing.org>
Sent: Wednesday, March 10, 2004 6:32 PM
Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build


> On Wed, Mar 10, 2004 at 01:23:43PM +0100, Fr?d?ric Trastour wrote:
> > The problem is that when the first test fails, the result is "cached"
> > - in a variable - and the others tests are not done.
> >
> > Perhaps there is a simple way to disable the caching mecanism used by
> > AC_CHECK_LIB ?
>
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Wed Mar 10 13:27:06 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Re: VC7 build log
In-Reply-To: <000101c406c8$0bad7740$fe0ba8c0@lancaster.beardandsandals.co.uk>
References: <000101c406c8$0bad7740$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <404F5DFA.9060500@pobox.com>

Roger (or others),

\Vterrain\APIs\gdal\alg\gdalwarpoperation.cpp(637) : warning C4312:
'type cast' : conversion from 'long' to 'void *' of greater size

This code looks like:
     ((void **) pThreadData)[2] = (void *) (long) eErr;

Given that I want to convert an enumerated error code into a pointer is
there any more "proper" way of doing it than this?

> \Vterrain\APIs\gdal\frmts\envisat\envisatdataset.cpp(546) : warning 
> C4267: '=' : conversion from 'size_t' to 'int', possible loss of data


Ahh yes, all these.  Very annoying.  I have generally used "int" as
equivelent to size_t and it is warning every time there is a cast back
or forth.   This does not cause a complain under gcc -Wall and I am not
inclined to make a comprehensive pass through fixing it at this time.

I would note that a non-trivial number of the warnings are in libpng, libjpeg,
and libz which I don't have any influence over.  If I fix the copy in GDAL
then the changes will just be lost on my next upgrade.

 > The problem is that at some point the size_t typedef on windows became
 > an unsigned int. I think it is something to do with 64 bit
 > compatability. C4267 is definitely a very bad warning to disable. I for
 > one am very much in the "every warning masks a potential error" camp. I
 > have mailed you a build log separately.

Death to C4267!  Err, I mean, I give up on it for now.

Re: file.lst files:
 > Not that I am aware of but maybe somebody else knows.I do not think it
 > would be beyond possibility (but beyond my own knowledge and timetable)
 > to make a perl script to edit the vcproj files. However, I am happy to
 > keep the files reasonably up to date and send you updates. My comments
 > on not wanting responsibility were of the legalistic nature seeing as
 > the files did not have any disclaimer associated with them. I did not
 > mean to wash my hands of them completely.

Well, I am not keen on update scripts.  I will commit the project files
to CVS, and I would be happy to offer you CVS commit access if you would
like to update them (and even fix warnings carefully).

Also, please don't mind my crankiness too much.  I am having a frustrating
time keeping on top of actual paying work as well as the many requests for
help, bug fixes and so forth on my many libraries.  My days often have a
peak frustration around noon, when I am pretty much dug out of overnight
requests for help, and ready to start on real work.  Less than half the
requests for help I get come via public mailing lists where others can help
out, and of course there are a number of other projects I am involved beside
GDAL itself.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Wed Mar 10 13:51:13 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Re: VC7 build log
Message-ID: <ED3A48B9840E594890A2BC172D119465E63AC3@mailman.san.com>

All,

Here's what MS says (below).  I don't think turning the compiler warning
off is a big deal if you don't need 64bit compatibility. Just turn off
the /WP64 switch or use a pragma on the warning.  It's only a
compatibility warning....right?  Are you using 64bit?

From MChapman at sanz.com  Wed Mar 10 13:55:48 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Re: VC7 build log
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9528@mailman.san.com>

Frank,

You will only lose precision if what's in the size_t is bigger than an
int.  Are you storing anything bigger than that in the size_t?  If not,
turn off the warning.  If so, perhaps you can shift the bits manually
from a size_t to the int where needed.  Then you could keep the warning
turned on and convert it cleanly.  Again, this warning is not applicable
in your case it sounds like and that's why it's a warning and not an
error.

Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Wednesday, March 10, 2004 11:27 AM
To: Roger James
Cc: gdal-dev
Subject: [Gdal-dev] Re: VC7 build log



Roger (or others),

\Vterrain\APIs\gdal\alg\gdalwarpoperation.cpp(637) : warning C4312:
'type cast' : conversion from 'long' to 'void *' of greater size

This code looks like:
     ((void **) pThreadData)[2] = (void *) (long) eErr;

Given that I want to convert an enumerated error code into a pointer is
there any more "proper" way of doing it than this?

> \Vterrain\APIs\gdal\frmts\envisat\envisatdataset.cpp(546) : warning
> C4267: '=' : conversion from 'size_t' to 'int', possible loss of data


Ahh yes, all these.  Very annoying.  I have generally used "int" as
equivelent to size_t and it is warning every time there is a cast back
or forth.   This does not cause a complain under gcc -Wall and I am not
inclined to make a comprehensive pass through fixing it at this time.

I would note that a non-trivial number of the warnings are in libpng,
libjpeg,
and libz which I don't have any influence over.  If I fix the copy in
GDAL
then the changes will just be lost on my next upgrade.

 > The problem is that at some point the size_t typedef on windows
became
 > an unsigned int. I think it is something to do with 64 bit
 > compatability. C4267 is definitely a very bad warning to disable. I
for
 > one am very much in the "every warning masks a potential error" camp.
I
 > have mailed you a build log separately.

Death to C4267!  Err, I mean, I give up on it for now.

Re: file.lst files:
 > Not that I am aware of but maybe somebody else knows.I do not think
it
 > would be beyond possibility (but beyond my own knowledge and
timetable)
 > to make a perl script to edit the vcproj files. However, I am happy
to
 > keep the files reasonably up to date and send you updates. My
comments
 > on not wanting responsibility were of the legalistic nature seeing as
 > the files did not have any disclaimer associated with them. I did not
 > mean to wash my hands of them completely.

Well, I am not keen on update scripts.  I will commit the project files
to CVS, and I would be happy to offer you CVS commit access if you would
like to update them (and even fix warnings carefully).

Also, please don't mind my crankiness too much.  I am having a
frustrating
time keeping on top of actual paying work as well as the many requests
for
help, bug fixes and so forth on my many libraries.  My days often have a
peak frustration around noon, when I am pretty much dug out of overnight
requests for help, and ready to start on real work.  Less than half the
requests for help I get come via public mailing lists where others can
help
out, and of course there are a number of other projects I am involved
beside
GDAL itself.

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From roger at beardandsandals.co.uk  Wed Mar 10 14:10:11 2004
From: roger at beardandsandals.co.uk (Roger James)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Re: VC7 build log
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63AC3@mailman.san.com>
Message-ID: <000001c406d3$50757e80$fe0ba8c0@lancaster.beardandsandals.co.uk>

Wonderful,

Now that's the kind of fix I like.

Thanks Martin.

Roger

> Here's what MS says (below).  I don't think turning the compiler
warning
> off is a big deal if you don't need 64bit compatibility. Just turn off
> the /WP64 switch or use a pragma on the warning.  It's only a
> compatibility warning....right?  Are you using 64bit?
> =



From warmerdam at pobox.com  Wed Mar 10 15:29:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] Re: VC7 build log
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9528@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465FB9528@mailman.san.com>
Message-ID: <404F7A99.4050000@pobox.com>

Chapman, Martin wrote:
> Frank,
> 
> You will only lose precision if what's in the size_t is bigger than an
> int.  Are you storing anything bigger than that in the size_t?  If not,
> turn off the warning.  If so, perhaps you can shift the bits manually
> from a size_t to the int where needed.  Then you could keep the warning
> turned on and convert it cleanly.  Again, this warning is not applicable
> in your case it sounds like and that's why it's a warning and not an
> error.

Folks,

OK, Roger's project will be without the 64 bit compatability checking.

I would note that I am generally aware of 64 bit issues.  GDAL works fine
on several different 64bit operating systems (Solaris, IRIX, OSF/1) and
there is a special 64 bit file access API.

I have every intention of working on Windows systems on 64 bit architectures
when they become common enough for me to get access (Itanium?  AMD's 64 bit
chip?).  However, things will be limited to accessing chunks of no more than
2GB at a time as long as I use int's for size_t but access to very large
files is still fine.  Offsets via the large file API uses a type that is
64 bit on appropriate architectures for instance.

Thanks for digging up the notes Martin.  It helps explain why I didn't run
into these warnings with my makefiles too.  One thing that bugs me about
project files is that so many users of them are blissfully unaware of the
compiler options they are using.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From robert at openscenegraph.com  Wed Mar 10 18:16:11 2004
From: robert at openscenegraph.com (Robert Osfield)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] gdalwarp + nosrcdata
Message-ID: <200403102316.11315.robert@openscenegraph.com>

Hi,

I have been using the GDAL Warp API successful for a while without filtering 
out no source data.  I now am using a dataset that I'd like to manage the no 
source data, and the API appears to support this, but as yet I haven't been 
able to get it to work.  I'm setting up both the padfSrcNoDataReal/Imag and 
padfDstNoDataReal/Img, but none of these settings appear to make any 
difference to the final resultant image.  

I haven't found anything in the docs or warp tutorial to clarify all the 
details, but looking at the gdalwap app source it looks like my 
implementation shouldn't be too far off the mark. 

I have tried out the gdalwap app as well, and still see the same problem with 
no source data making its way into the final warp image.

I'm not sure what to expect from gdalwarp, so a few pointers of what to expect 
to be able to do, and how to go about it would be great.  I've pasted details 
on what I've tried just in case this helps pinpoint the what steps I'm 
missing.

Thanks for any help that you provide,
Robert.

---------------------------------------------------------------------------------------------------------------

Here's the gdalinfo report for the source data:

Driver: DTED/DTED Elevation Raster
Size is 3601, 3601
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433]]
Origin = (104.999861,-9.999861)
Pixel Size = (0.00027778,-0.00027778)
Metadata:
  DTED_VerticalAccuracy_UHL=  NA
  DTED_VerticalAccuracy_ACC=  NA
  DTED_SecurityCode_UHL=U
  DTED_SecurityCode_DSI=U
  DTED_UniqueRef_UHL=
  DTED_UniqueRef_DSI=000000000000000
  DTED_DataEdition=01
  DTED_MatchMergeVersion=A
  DTED_MaintenanceDate=0000
  DTED_MatchMergeDate=0000
  DTED_MaintenanceDescription=0000
  DTED_Producer=
  DTED_VerticalDatum=MSL
  DTED_DigitizingSystem=  ARC/INFO
  DTED_CompilationDate=0210
  DTED_HorizontalAccuracy=  NA
  DTED_RelHorizontalAccuracy=  NA
  DTED_RelVerticalAccuracy=  NA
Corner Coordinates:
Upper Left  ( 104.9998611,  -9.9998611) (104d59'59.50"E,  9d59'59.50"S)
Lower Left  ( 104.9998611, -11.0001389) (104d59'59.50"E, 11d 0'0.50"S)
Upper Right ( 106.0001389,  -9.9998611) (106d 0'0.50"E,  9d59'59.50"S)
Lower Right ( 106.0001389, -11.0001389) (106d 0'0.50"E, 11d 0'0.50"S)
Center      ( 105.5000000, -10.5000000) (105d30'0.00"E, 10d30'0.00"S)
Band 1 Block=1x3601 Type=Int16, ColorInterp=Undefined
    Computed Min/Max=0.000,334.000
  NoData Value=-32767

---------------------------------------------------------------------------------------------------------------

The gdalwarp options that I used to convert:

gdalwarp -t_srs '+proj=utm +zone=47 +datum=WGS84' -srcnodata -32767  
s11e105.dt2 warped.tif

---------------------------------------------------------------------------------------------------------------

The gdalinfo of the final warped.tif:

Driver: GTiff/GeoTIFF
Size is 3657, 3693
Coordinate System is:
PROJCS["WGS 84 / UTM zone 47N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.2572235629972,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",99],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","32647"]]
Origin = (1156568.438741,-1111402.317524)
Pixel Size = (30.74708996,-30.74708996)
Corner Coordinates:
Upper Left  ( 1156568.439,-1111402.318) (104d58'49.94"E, 10d 0'0.76"S)
Lower Left  ( 1156568.439,-1224951.321) (105d 0'1.07"E, 11d 1'17.53"S)
Upper Right ( 1269010.547,-1111402.318) (105d59'59.47"E,  9d58'48.96"S)
Lower Right ( 1269010.547,-1224951.321) (106d 1'22.49"E, 10d59'58.24"S)
Center      ( 1212789.493,-1168176.819) (105d30'3.22"E, 10d30'2.88"S)
Band 1 Block=3657x1 Type=Int16, ColorInterp=Gray
    Computed Min/Max=-32767.000,320.000

---------------------------------------------------------------------------------------------------------------

In my own code I've tried using a destination no data value of 0.0, but its 
always overwritten by the -32767 no data value.

The relevant code is (note bits #if def'd out are experiements at trying to 
get things to function):
    // check to see if no value values exist in source datasets.
    int numNoDataValues = 0;
    for(i = 0; i < _sourceData->_gdalDataSet->GetRasterCount(); i++ )
    {
        int success = 0;
        GDALRasterBand* band = _sourceData->_gdalDataSet->GetRasterBand(i+1);
        band->GetNoDataValue(&success);
        if (success) ++numNoDataValues;
    }
    
    if (numNoDataValues)
    {
        // no data values exist, so populate the no data arrays.
        
        psWO->padfSrcNoDataReal = (double*) 
CPLMalloc(psWO->nBandCount*sizeof(double));
        psWO->padfSrcNoDataImag = (double*) 
CPLMalloc(psWO->nBandCount*sizeof(double));
        
        psWO->padfDstNoDataReal = (double*) 
CPLMalloc(psWO->nBandCount*sizeof(double));
        psWO->padfDstNoDataImag = (double*) 
CPLMalloc(psWO->nBandCount*sizeof(double));
        
        for(i = 0; i < _sourceData->_gdalDataSet->GetRasterCount(); i++ )
        {
            int success = 0;
            GDALRasterBand* band = _sourceData->_gdalDataSet->GetRasterBand(i
+1);
            double noDataValue = band->GetNoDataValue(&success);
            double new_noDataValue = 0.0;
            if (success)
            {
                std::cout<<"\tassinging no data value "<<noDataValue<<" to 
band "<<i+1<<std::endl;
            
                psWO->padfSrcNoDataReal[i] = noDataValue;
                psWO->padfSrcNoDataImag[i] = 0.0;
                psWO->padfDstNoDataReal[i] = new_noDataValue;
                psWO->padfDstNoDataImag[i] = 0.0;
                
                GDALRasterBandH band = GDALGetRasterBand(hDstDS,i+1);
                GDALSetRasterNoDataValue( band, new_noDataValue);
            }
        }    

#if 0        
        psWO->papszWarpOptions = (char**)CPLMalloc(2*sizeof(char*));
        psWO->papszWarpOptions[0] = strdup("INIT_DEST=NO_DATA");
        psWO->papszWarpOptions[1] = 0;
#endif

#if 0        
        psWO->pfnSrcValidityMaskFunc = (GDALMaskFunc)GDALWarpNoDataMasker;
#endif        
    }

---------------------------------------------------------------------------------------------------------------




From warmerdam at pobox.com  Wed Mar 10 19:36:35 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] gdalwarp + nosrcdata
In-Reply-To: <200403102316.11315.robert@openscenegraph.com>
References: <200403102316.11315.robert@openscenegraph.com>
Message-ID: <404FB493.80504@pobox.com>

Robert Osfield wrote:
> Hi,
> 
> I have been using the GDAL Warp API successful for a while without filtering 
> out no source data.  I now am using a dataset that I'd like to manage the no 
> source data, and the API appears to support this, but as yet I haven't been 
> able to get it to work.  I'm setting up both the padfSrcNoDataReal/Imag and 
> padfDstNoDataReal/Img, but none of these settings appear to make any 
> difference to the final resultant image.  
> 
> I haven't found anything in the docs or warp tutorial to clarify all the 
> details, but looking at the gdalwap app source it looks like my 
> implementation shouldn't be too far off the mark. 
> 
> I have tried out the gdalwap app as well, and still see the same problem with 
> no source data making its way into the final warp image.
> 
> I'm not sure what to expect from gdalwarp, so a few pointers of what to expect 
> to be able to do, and how to go about it would be great.  I've pasted details 
> on what I've tried just in case this helps pinpoint the what steps I'm 
> missing.

Robert,

It looks like you are on the right track. I am not sure why it isn't working.

I tried the command "gdalwarp -srcnodata -32768 nzdem500 out.tif" to warp
a dem in ESRI Grid format to a tiff file, and it correctly ignore the -32768
values leaving the default value of 0 in the output file.

Is it possible you are working with an older version of the Warp API?

I think the comparisons are being done as floating point, so I am a bit
concerned that there may be floating point roundoff issues representing some
values properly.  I don't know if that is what might be happening here.

So, first verify you are using current code.  (1.2.0a/b or a recently
nightly snapshot) If it still doesn't work with a commandline form like the
above, then send me the DEM privately and I will see if I can reproduce the
problem.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From schut at sarvision.com  Thu Mar 11 02:56:38 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] goode homolosine projection
In-Reply-To: <404F4E75.80606@pobox.com>
References: <200403101705.13251.gdal@warped-space.de> <404F4E75.80606@pobox.com>
Message-ID: <200403110856.38478.schut@sarvision.com>

Manuel, Frank,

I just want to say thank you, this is what I have been waiting for :-)
Till now I tried reprojecting modis datasets from goode's homolosine by 
cutting the image into pieces which I seperately reprojected using either a 
sinusoidal or a mollweide projection, using the parameters from 
http://gis.esri.com/library/userconf/proc98/PROCEED/TO850/PAP844/P844.HTM. 
This patch will make my life easier...

One question though, because you mention reprojecting modis datasets. I read 
somewhere on the proj mailinglist 
(http://remotesensing.org/lists/proj_archive/msg03772.html) that for 
reprojecting from different ellipses (sphere -> WGS84), one needs to specify 
the '+towgs84=0,0,0' parameter too. Do you know it this is correct and still 
necessary? I think the correct phrase to reproject modis from goode's 
homolosine (sphere) to longlat WGS84 then will be something like:

gdalwarp <input> -s_srs '+proj=goode +ellps=sphere +towgs84=0,0,0 +lon_0=100w 
+x_0=-11119487.43'  <output options>

Needless to say I hope this patch will be in cvs soon... But I'll apply the 
patch locally and test it a bit on my modis data of Indonesia, and keep you 
informed on the results (no news is good news is an applicable dutch saying 
here).

Regards,
Vincent Schut.


On Wednesday 10 March 2004 18:20, Frank Warmerdam wrote:
> Manuel Massing wrote:
> > Hello,
> >
> > Attached is a small patch to add OGR support for the goode homolosine
> > projection.
> >
> > Unfortunately, proj.4 does only support the uninterrupted form of the
> > goode projection,  so a reprojection won't work on global datasets in
> > interrupted form.
> > However, in a local context, you can adjust false easting and central
> > meridian values for the different zones. For a listing of false easting
> > and central meridian values used in the interrupted form, refer to Table
> > 1 of http://edcdaac.usgs.gov/1KM/goodesarticle.asp.
> >
> > To reproject e.g. a MODIS dataset of North America
> > (ftp://ftp.glcf.umiacs.umd.edu/modis/500m/North_America/Goodes.NA.2003321
> >/), you could use the command-line:
> >
> > gdalwarp <input> -s_srs '+proj=goode +ellps=sphere +lon_0=100w
> > +x_0=-11119487.43'  <output options>
>
> Manuel,
>
> Would you mind submitting the patch via bugzilla?  I generally hate to add
> new projection forms to OGR (thereby setting a WKT representation in stone)
> till I have also reviewed ESRI and other WKT sources to see if they already
> have a format for that projection.  Handling it through bugzilla will give
> me the time to review and look at other sources before doing anything.
>
> I would add that the interrupted form is what I really want to (as far as
> I understand it).
>
> Best regards,

-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From support at geoimage.fr  Thu Mar 11 06:13:33 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu> <10a901c4069a$8746a260$e32346c0@pili> <20040310173240.GB5037@ak4719.spb.edu>
Message-ID: <002a01c40759$ead30c00$e32346c0@pili>

Hello,

I think there is a simple solution to the caching problem of AC_CHECK_LIB.

I have tested this solution with a modified configure script and it worked for me.

Here is a proposed change to configure.in ( not tested as I can't generate configure
from configure.in, but I hope to be able to do it today ) :

__________________________________________________________________________________________

dnl ---------------------------------------------------------------------------
dnl PROJ.4 related stuff.
dnl ---------------------------------------------------------------------------

AC_MSG_CHECKING([how to link PROJ.4 library])

AC_ARG_WITH(static_proj4,[  --with-static-proj4=ARG Compile with PROJ.4 statically (ARG=no or path)],,)

if test "x$with_static_proj4" = "xno" -o "x$with_static_proj4" = "x"; then

  PROJ_STATIC=no
  AC_MSG_RESULT([link dynamically.])

else

  PROJ_STATIC=yes
  AC_MSG_RESULT([link statically.])

  ORIG_LIBS="$LIBS"
  PROJ_LIB="-lproj"

  if test "x$with_static_proj4" = "xyes" ; then
    LIBS="$PROJ_LIB $ORIG_LIBS"
    AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
  else

    LIBS="-L$with_static_proj4/src $PROJ_LIB $ORIG_LIBS"
    AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)

    if test "$PROJ_STATIC" = "no"; then

      dnl Disable previous value cached by the previous AC_CHECK_LIB test :
      dnl AC_CHECK_LIB caches the result value for a couple (function, library)
      dnl in a variable named "ac_cv_lib_<library name>_<function name>".
      dnl In order to try to locate the library in different locations, using
      dnl different values of LIBS, we have to 'unset' this variable after
      dnl each negative test.

      unset ac_cv_lib_proj_pj_init

      LIBS="-L$with_static_proj4/lib $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="-L$with_static_proj4/src/.libs $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="-L$with_static_proj4 $PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

    if test "$PROJ_STATIC" = "no"; then
      unset ac_cv_lib_proj_pj_init
      LIBS="$PROJ_LIB $ORIG_LIBS"
      AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
    fi

  fi

  if test "$PROJ_STATIC" = "no"; then
    LIBS="$ORIG_LIBS"
  fi

  if test -r "$with_static_proj4/src/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4/src"
  elif test -r "$with_static_proj4/include/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4/include"
  elif test -r "$with_static_proj4/proj_api.h" ; then
    PROJ_INCLUDE="-I$with_static_proj4"
  fi

fi

AC_SUBST(PROJ_STATIC)
AC_SUBST(PROJ_INCLUDE)

_________________________________________________________________________________________________________

Regards,

Fr?d?ric.

----- Original Message ----- 
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: <gdal-dev@remotesensing.org>
Sent: Wednesday, March 10, 2004 6:32 PM
Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build


> On Wed, Mar 10, 2004 at 01:23:43PM +0100, Fr?d?ric Trastour wrote:
> > The problem is that when the first test fails, the result is "cached"
> > - in a variable - and the others tests are not done.
> >
> > Perhaps there is a simple way to disable the caching mecanism used by
> > AC_CHECK_LIB ?
>
> There is an attempt to disable caching at the start of the configure.in
> script... seems it don't work for you. Autoconf manual contains the
> following section, where described, how to disable cahcing. Could you
> try whether the using .autom4te.cfg file in the GDAL root directory
> helps you? If so I shall add that file to the repository.
>
> Customizing `autom4te'
> ----------------------
>
> One can customize `autom4te' via `~/.autom4te.cfg' (i.e., as found in
> the user home directory), and `./.autom4te.cfg' (i.e., as found in the
> directory from which `autom4te' is run).  The order is first reading
> `autom4te.cfg', then `~/.autom4te.cfg', then `./.autom4te.cfg', and
> finally the command line arguments.
>
>    In these text files, comments are introduced with `#', and empty
> lines are ignored.  Customization is performed on a per-language basis,
> wrapped in between a `begin-language: "LANGUAGE"', `end-language:
> "LANGUAGE"' pair.
>
>    Customizing a language stands for appending options (*note autom4te
> Invocation::) to the current definition of the language.  Options, and
> more generally arguments, are introduced by `args: ARGUMENTS'.  You may
> use the traditional shell syntax to quote the ARGUMENTS.
>
>    As an example, to disable Autoconf caches (`autom4te.cache')
> globally, include the following lines in `~/.autom4te.cfg':
>
>
> ## ------------------ ##
> ## User Preferences.  ##
> ## ------------------ ##
>
> begin-language: "Autoconf"
> args: --no-cache
> end-language: "Autoconf"
>
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From robert at openscenegraph.com  Thu Mar 11 07:26:01 2004
From: robert at openscenegraph.com (Robert Osfield)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] gdalwarp + nosrcdata
In-Reply-To: <404FB493.80504@pobox.com>
References: <200403102316.11315.robert@openscenegraph.com> <404FB493.80504@pobox.com>
Message-ID: <200403111226.01724.robert@openscenegraph.com>

Hi Frank,

On Thursday 11 March 2004 00:36, Frank Warmerdam wrote:
> So, first verify you are using current code.  (1.2.0a/b or a recently
> nightly snapshot) If it still doesn't work with a commandline form like the
> above, then send me the DEM privately and I will see if I can reproduce the
> problem.

I have just done a clean check out of the GDAL version in CVS and this fixes 
the problem.  Horahhh :-)

Thanks,
Robert.




From support at geoimage.fr  Thu Mar 11 08:52:00 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu> <10a901c4069a$8746a260$e32346c0@pili> <20040310173240.GB5037@ak4719.spb.edu> <002a01c40759$ead30c00$e32346c0@pili>
Message-ID: <006e01c40770$071d5170$e32346c0@pili>

Hello,

I have tested the configure script generated by autoconf (v 2.59) from the modified configure.in
( with unset ) and it worked fine ( proj library detected in the second alternate location ) on my
solaris 2.7 system.

Do you will add ( Andrey ) the change to the configure.in script in cvs ?

ps : I have just a little doubt on the portablity of the 'unset' shell command : some parts of the
script use '$as_unset' instead of 'unset' but some other parts use 'unset' directly.

Fr?d?ric

----- Original Message ----- 
From: "Fr?d?ric Trastour" <support@geoimage.fr>
To: <gdal-dev@remotesensing.org>
Sent: Thursday, March 11, 2004 12:13 PM
Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build


> Hello,
>
> I think there is a simple solution to the caching problem of AC_CHECK_LIB.
>
> I have tested this solution with a modified configure script and it worked for me.
>
> Here is a proposed change to configure.in ( not tested as I can't generate configure
> from configure.in, but I hope to be able to do it today ) :
>
> __________________________________________________________________________________________
>
> dnl ---------------------------------------------------------------------------
> dnl PROJ.4 related stuff.
> dnl ---------------------------------------------------------------------------
>
> AC_MSG_CHECKING([how to link PROJ.4 library])
>
> AC_ARG_WITH(static_proj4,[  --with-static-proj4=ARG Compile with PROJ.4 statically (ARG=no or path)],,)
>
> if test "x$with_static_proj4" = "xno" -o "x$with_static_proj4" = "x"; then
>
>   PROJ_STATIC=no
>   AC_MSG_RESULT([link dynamically.])
>
> else
>
>   PROJ_STATIC=yes
>   AC_MSG_RESULT([link statically.])
>
>   ORIG_LIBS="$LIBS"
>   PROJ_LIB="-lproj"
>
>   if test "x$with_static_proj4" = "xyes" ; then
>     LIBS="$PROJ_LIB $ORIG_LIBS"
>     AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>   else
>
>     LIBS="-L$with_static_proj4/src $PROJ_LIB $ORIG_LIBS"
>     AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>
>     if test "$PROJ_STATIC" = "no"; then
>
>       dnl Disable previous value cached by the previous AC_CHECK_LIB test :
>       dnl AC_CHECK_LIB caches the result value for a couple (function, library)
>       dnl in a variable named "ac_cv_lib_<library name>_<function name>".
>       dnl In order to try to locate the library in different locations, using
>       dnl different values of LIBS, we have to 'unset' this variable after
>       dnl each negative test.
>
>       unset ac_cv_lib_proj_pj_init
>
>       LIBS="-L$with_static_proj4/lib $PROJ_LIB $ORIG_LIBS"
>       AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>     fi
>
>     if test "$PROJ_STATIC" = "no"; then
>       unset ac_cv_lib_proj_pj_init
>       LIBS="-L$with_static_proj4/src/.libs $PROJ_LIB $ORIG_LIBS"
>       AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>     fi
>
>     if test "$PROJ_STATIC" = "no"; then
>       unset ac_cv_lib_proj_pj_init
>       LIBS="-L$with_static_proj4 $PROJ_LIB $ORIG_LIBS"
>       AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>     fi
>
>     if test "$PROJ_STATIC" = "no"; then
>       unset ac_cv_lib_proj_pj_init
>       LIBS="$PROJ_LIB $ORIG_LIBS"
>       AC_CHECK_LIB(proj,pj_init,PROJ_STATIC=yes,PROJ_STATIC=no,)
>     fi
>
>   fi
>
>   if test "$PROJ_STATIC" = "no"; then
>     LIBS="$ORIG_LIBS"
>   fi
>
>   if test -r "$with_static_proj4/src/proj_api.h" ; then
>     PROJ_INCLUDE="-I$with_static_proj4/src"
>   elif test -r "$with_static_proj4/include/proj_api.h" ; then
>     PROJ_INCLUDE="-I$with_static_proj4/include"
>   elif test -r "$with_static_proj4/proj_api.h" ; then
>     PROJ_INCLUDE="-I$with_static_proj4"
>   fi
>
> fi
>
> AC_SUBST(PROJ_STATIC)
> AC_SUBST(PROJ_INCLUDE)
>
> _________________________________________________________________________________________________________
>
> Regards,
>
> Fr?d?ric.
>
> ----- Original Message ----- 
> From: "Andrey Kiselev" <dron@ak4719.spb.edu>
> To: <gdal-dev@remotesensing.org>
> Sent: Wednesday, March 10, 2004 6:32 PM
> Subject: Re: [Gdal-dev] GDAL 1.2.0 Solaris build
>
>
> > On Wed, Mar 10, 2004 at 01:23:43PM +0100, Fr?d?ric Trastour wrote:
> > > The problem is that when the first test fails, the result is "cached"
> > > - in a variable - and the others tests are not done.
> > >
> > > Perhaps there is a simple way to disable the caching mecanism used by
> > > AC_CHECK_LIB ?
> >
> > There is an attempt to disable caching at the start of the configure.in
> > script... seems it don't work for you. Autoconf manual contains the
> > following section, where described, how to disable cahcing. Could you
> > try whether the using .autom4te.cfg file in the GDAL root directory
> > helps you? If so I shall add that file to the repository.
> >
> > Customizing `autom4te'
> > ----------------------
> >
> > One can customize `autom4te' via `~/.autom4te.cfg' (i.e., as found in
> > the user home directory), and `./.autom4te.cfg' (i.e., as found in the
> > directory from which `autom4te' is run).  The order is first reading
> > `autom4te.cfg', then `~/.autom4te.cfg', then `./.autom4te.cfg', and
> > finally the command line arguments.
> >
> >    In these text files, comments are introduced with `#', and empty
> > lines are ignored.  Customization is performed on a per-language basis,
> > wrapped in between a `begin-language: "LANGUAGE"', `end-language:
> > "LANGUAGE"' pair.
> >
> >    Customizing a language stands for appending options (*note autom4te
> > Invocation::) to the current definition of the language.  Options, and
> > more generally arguments, are introduced by `args: ARGUMENTS'.  You may
> > use the traditional shell syntax to quote the ARGUMENTS.
> >
> >    As an example, to disable Autoconf caches (`autom4te.cache')
> > globally, include the following lines in `~/.autom4te.cfg':
> >
> >
> > ## ------------------ ##
> > ## User Preferences.  ##
> > ## ------------------ ##
> >
> > begin-language: "Autoconf"
> > args: --no-cache
> > end-language: "Autoconf"
> >
> > -- 
> > Andrey V. Kiselev
> > Home phone:  +7 812 5274898  ICQ# 26871517
> > _______________________________________________
> > Gdal-dev mailing list
> > Gdal-dev@remotesensing.org
> > http://remotesensing.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From schut at sarvision.com  Thu Mar 11 08:53:17 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] goode homolosine projection
In-Reply-To: <200403110856.38478.schut@sarvision.com>
References: <200403101705.13251.gdal@warped-space.de> <404F4E75.80606@pobox.com> <200403110856.38478.schut@sarvision.com>
Message-ID: <200403111453.17343.schut@sarvision.com>

On Thursday 11 March 2004 08:56, Vincent Schut wrote:
> Manuel, Frank,
>
> I just want to say thank you, this is what I have been waiting for :-)
> Till now I tried reprojecting modis datasets from goode's homolosine by
> cutting the image into pieces which I seperately reprojected using either a
> sinusoidal or a mollweide projection, using the parameters from
> http://gis.esri.com/library/userconf/proc98/PROCEED/TO850/PAP844/P844.HTM.
> This patch will make my life easier...
>
> One question though, because you mention reprojecting modis datasets. I
> read somewhere on the proj mailinglist
> (http://remotesensing.org/lists/proj_archive/msg03772.html) that for
> reprojecting from different ellipses (sphere -> WGS84), one needs to
> specify the '+towgs84=0,0,0' parameter too. Do you know it this is correct
> and still necessary? I think the correct phrase to reproject modis from
> goode's homolosine (sphere) to longlat WGS84 then will be something like:
>
> gdalwarp <input> -s_srs '+proj=goode +ellps=sphere +towgs84=0,0,0
> +lon_0=100w +x_0=-11119487.43'  <output options>
>
> Needless to say I hope this patch will be in cvs soon... But I'll apply the
> patch locally and test it a bit on my modis data of Indonesia, and keep you
> informed on the results (no news is good news is an applicable dutch saying
> here).

Results of some quick testing: Things seem to work correctly when using an 
additional '+datum=sphere +towgs84=0,0,0' for projection modis 32 day 
composites from goode's to latlong. NB when omitting the datum/towgs thing 
there is an erronous shift along the equator, which gets visible when warping 
a scene that is both on the northern and southern hemisphere (in my case: 
Kalimantan, Indonesia), probably due to lack of/bad datum/sphere transform?

Cheers,
Vincent.


-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From warmerdam at pobox.com  Thu Mar 11 09:15:33 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
Message-ID: <40507485.30007@pobox.com>

Folks,

I have released GDAL 1.2.0 final (hopefully).  It is available at:

   ftp://ftp.remotesensing.org/gdal/gdal-1.2.0.tar.gz
   ftp://ftp.remotesensing.org/gdal/gdal120.zip

I would especially like to think Alessandro Amici who did all the libtool
related support for this release despite my ackward requirement that we
still be able to build without libtool, and my avoidance of automake.

I also want to thank Andrey Kiselev, my GDAL co-maintainer who is
responsible for many of the new developments and improvements in this
release.   These include the new PCIDSK, and MrSID driver.

I also owe a debt to the GDAL community who have given back many fixes
and improvements, and perhaps most of all to the many corporate sponsors
who have funded improvements over the last year.  This include (but are
not limited to) Safe Software, DM Solutions Group, i-cubed, AUG Signals,
Keyhole, Applied Coherent Technology, Atlantis Scientific, SRC and
GeoTango.

I am including the improvements since 1.1.9 from the NEWS file below.
If no one reports any major problems in the next few hours I will announce
the release in a few other venues and on freshmeat.net.


GDAL 1.2.0 - Overview of Changes
--------------------------------

Configuration:
     - Libtool used by default with Unix style builds.  Use --without-libtool
       to avoid this.
     - PROJ.4 can now be linked statically using --with-static-proj4.
     - Added --without-bsb option for those averse to legal risk.

DODS/OPeNDAP Driver:
     - Preliminary DODS (OPeNDAP) driver implemented (James Gallagher @ URI).

PCIDSK Driver:
     - PCIDSK read/write raster driver implemented (Andrey).

Erdas Imagine / HFA Driver:
     - Support recent Imagine versions (data dictionary changes).
     - Better logic to search for .rrd file locally.
     - Support creating files in the 2GB to 4GB size range.

GIF Driver:
     - Updated to libungif 4.1.0.
     - Various hacks to try and identify transparent colors better.

BMP Driver:
     - Handle 32bit BMPs properly.

HDF4 Driver:
     - Added proper support for multi-sample GR datasets.
     - Various fixes and improvements for specific product types.

GeoTIFF Driver:
     - Added PHOTOMETRIC option to control photometric interp of new files.

JPEG2000/Kakadu Driver:
     - Support reading/creating lossless 16bit files.
     - Updated to support Kakadu 4.1 library.

NITF Driver:
     - Implement support for IGEOLO="U" (MGRS/UTM) coordinates.
     - Added overview (as external GeoTIFF file) support.

MrSID Driver:
     - Support DSDK 4.2.x.

PNG Driver:
     - Support required byte swapping of 16bit PNG data.

FAST Driver:
     - lots of fixes, supports more datums and ellipsoids.

NetCDF Driver:
     - New driver implemented for netCDF support.
     - Pretty much tied to form of netCDF used in GMT for now.

VTerrain .bt Driver:
     - New driver for VTerrain .bt elevation format.

ECW Driver:
     - support supersampled reads efficiently.
     - special case for dataset level RasterIO() implemented for much better
       performance in some applications.

ESRI BIL (EHdr) Driver:
     - Support world files.

VRT Driver:
     - Implement filtering support.

GIO (Arc/Info Binary Grid via avgridio.dll):
    - Driver disabled ... to undependable.


Python:
     - Preliminary support for numarray in addition to numpy (Numeric).

Contouring:
     - New gdal_contour utility program implementing contour generation.
     - Underlying algorithm in gdal/alg.

Warping:
     - Improved support in GDALSuggestedWarpOutput() for "world" sized
       files that are only partially transformable.
     - Bicubic resampler improved.
     - What was gdalwarptest is now gdalwarp, and the old gdalwarp is now
       gdalwarpsimple.  The sophisticated warper is now the default.

Man Pages:
     - Man pages for GDAL utilities now being maintained and installed (Silke).



OGR 1.2.0 - Overview of Changes
-------------------------------

OGRSpatialReference:
    - Added methods for converting to/from GCTP representation.
    - Added HOM 2 points on centerline variant.

DODS (OPeNDAP) Driver:
    - Preliminary implementation.

TIGER/Line Driver:
    - Added support for GDT ASCII TIGER-like format.
    - Support TIGER/Line 2003 format.

S-57 Driver:
    - Preliminary export support implemented.
    - Support capture of FFPT (feature to feature) linkages.
    - Support capture of TOPI from VRPT.
    - Support capture of primitives as additional layers.

Shapefile Driver:
    - gdal/frmts/shapelib removed from GDAL source tree, now just a
      copy of required shapelib files are kept in gdal/ogr/ogrsf_frmts/shape.
    - Attempt identify polygons that are really multi-polygons and convert them
      into multi-polygons properly (Radim Blazek).
    - Create FID attribute in .dbf file if no attribute added by application.

GML Driver:
    - Lots of fixes and improvements for reading and writing.
    - Now writes a schema file by default.
    - Field types are set now when reading based on data found on first pass.
    - Added support for the various kinds of geometry collections.

DGN Driver:
    - Now using dgnlib 1.9 - this carries with it various new element types
      and some important bug fixes.

ODBC Driver:
    - New ODBC driver implemented.  Build by default on Windows, and buildable
      on Unix (with unixodbc).

VRT Driver:
    - New "virtual" OGR Datasource format implemented.
    - Configuration stored in XML control file.

Oracle (OCI) Driver:
    - support reading views.

OGR Core:
    - Added support for WKT EMPTY geometry objects (like "MULTIPOINT(EMPTY)").
    - Added DeleteFeature() method on OGRLayer class.

NTF Driver:
    - Support CHG_TYPE attribute for landline plus product.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Mar 11 09:32:14 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL 1.2.0 Solaris build
In-Reply-To: <006e01c40770$071d5170$e32346c0@pili>
References: <087101c4006b$93980250$e32346c0@pili> <4044AE8F.4070702@pobox.com> <089601c40072$97e697c0$e32346c0@pili> <20040303115428.GA3796@ak4719.spb.edu> <055301c40501$84f37370$e32346c0@pili> <20040308183635.GA22121@ak4719.spb.edu> <10a901c4069a$8746a260$e32346c0@pili> <20040310173240.GB5037@ak4719.spb.edu> <002a01c40759$ead30c00$e32346c0@pili> <006e01c40770$071d5170$e32346c0@pili>
Message-ID: <4050786E.4040702@pobox.com>

Folks,

I just wanted to note the configure changes related to the static proj4
support and the Goodes Homolosine changes did not make it into the GDAL 1.2.0
release.  With luck there will be a 1.2.1 release in a couple of months.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From alexamici at fastwebnet.it  Thu Mar 11 09:38:49 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
In-Reply-To: <40507485.30007@pobox.com>
References: <40507485.30007@pobox.com>
Message-ID: <200403111538.49835.alexamici@fastwebnet.it>

silke,

On Thursday 11 March 2004 15:15, Frank Warmerdam wrote:
> Folks,
>
> I have released GDAL 1.2.0 final (hopefully).  It is available at:
>
>    ftp://ftp.remotesensing.org/gdal/gdal-1.2.0.tar.gz
>    ftp://ftp.remotesensing.org/gdal/gdal120.zip
>

oops! i didn't see any new stuff in cvs under debian. did you miss it? :(

cheers,
alessandro


From warmerdam at pobox.com  Thu Mar 11 09:57:37 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
In-Reply-To: <200403111538.49835.alexamici@fastwebnet.it>
References: <40507485.30007@pobox.com> <200403111538.49835.alexamici@fastwebnet.it>
Message-ID: <40507E61.7030606@pobox.com>

Alessandro Amici wrote:
> silke,
> 
> On Thursday 11 March 2004 15:15, Frank Warmerdam wrote:
> 
>>Folks,
>>
>>I have released GDAL 1.2.0 final (hopefully).  It is available at:
>>
>>   ftp://ftp.remotesensing.org/gdal/gdal-1.2.0.tar.gz
>>   ftp://ftp.remotesensing.org/gdal/gdal120.zip
>>
> 
> 
> oops! i didn't see any new stuff in cvs under debian. did you miss it? :(

Alessandro,

It was snapped yesterday about noon.   It took me all afternoon to do various
test builds.

I guess that means I missed the changes.

Later,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Silke.Reimer at intevation.de  Thu Mar 11 10:14:43 2004
From: Silke.Reimer at intevation.de (Silke Reimer)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
In-Reply-To: <40507E61.7030606@pobox.com>
References: <40507485.30007@pobox.com> <200403111538.49835.alexamici@fastwebnet.it> <40507E61.7030606@pobox.com>
Message-ID: <20040311151443.GB20504@intevation.de>

On Thu, Mar 11, 2004 at 09:57:37AM -0500, Frank Warmerdam wrote:
> Alessandro Amici wrote:
> >silke,
> >
> >On Thursday 11 March 2004 15:15, Frank Warmerdam wrote:
> >
> >>Folks,
> >>
> >>I have released GDAL 1.2.0 final (hopefully).  It is available at:
> >>
> >>  ftp://ftp.remotesensing.org/gdal/gdal-1.2.0.tar.gz
> >>  ftp://ftp.remotesensing.org/gdal/gdal120.zip
> >>
> >
> >
> >oops! i didn't see any new stuff in cvs under debian. did you miss it? :(
> 
> Alessandro,
> 
> It was snapped yesterday about noon.   It took me all afternoon to do 
> various
> test builds.
> 
> I guess that means I missed the changes.

No, you didn't miss the changes because I didn't find time to make a
last check on my new debian package. I didn't want to check in
changes without having checked them carefully.

Sorry for the delay. But since my changes are only debian specific it
is not so serious in my opinion. 

Greetings,

	Silke

-- 
Silke Reimer

Intevation GmbH                      http://intevation.de/
FreeGIS                                http://freegis.org/

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 189 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040311/eb94f00d/attachment.bin
From alexamici at fastwebnet.it  Thu Mar 11 11:40:50 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:05 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
In-Reply-To: <20040311151443.GB20504@intevation.de>
References: <40507485.30007@pobox.com> <40507E61.7030606@pobox.com> <20040311151443.GB20504@intevation.de>
Message-ID: <200403111740.50926.alexamici@fastwebnet.it>

On Thursday 11 March 2004 16:14, Silke Reimer wrote:
> No, you didn't miss the changes because I didn't find time to make a
> last check on my new debian package. I didn't want to check in
> changes without having checked them carefully.
>
> Sorry for the delay. But since my changes are only debian specific it
> is not so serious in my opinion.

and i just double checked that what is in the1.2.0 release produces a 
reasonable debian package (builds and install fine).

so i agree, no big deal.

cheers,
alessandro

From nhv at cape.com  Thu Mar 11 12:15:09 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] GDAL/OGR 1.2.0 Released
In-Reply-To: <40507485.30007@pobox.com>
Message-ID: <EKEJIKAILPONGGENMBGAIEKMGLAA.nhv@cape.com>

Frank Warmerdam writes:
> 
> Folks,
> 
> I have released GDAL 1.2.0 final (hopefully).  It is available at:
> 
>    ftp://ftp.remotesensing.org/gdal/gdal-1.2.0.tar.gz
>    ftp://ftp.remotesensing.org/gdal/gdal120.zip
> 

> If no one reports any major problems in the next few hours I will announce
> the release in a few other venues and on freshmeat.net.

Not a major problem but ....

When building with Cygwin and MingW32 and --without-libtool a DLL is built
but it is not used because the assosciated 'link lib' is not built

The following snippet from GNUMakefile seems to build the appropriate lib

$(GDAL_SLIB):	$(GDAL_OBJ)
	$(LD_SHARED) -Wl,--out-implib=libgdal.dll.a  $(GDAL_OBJ) $(GDAL_LIBS) $(LIBS) \
		-o $(GDAL_SLIB)

Also the DLL that is created is installed into /usr/local/lib and not /usr/local/bin
and it does not appear as if the .a file is installed at all

Note the 'link lib' the .dll.a file created by the above 'make rule' should also
be installed into $(prefix)/lib

I haven't tried the libtool build as it fails to build a DLL for when using the extensions
that I need to use

FYI - I don't think that this is a reason to delay the release as it is easy
enough to have 'special' instructions for using gcc and the --without-libtool
option on Windows platforms

Cheers

Norman


From chen at yinyue123.com  Fri Mar 12 07:49:02 2004
From: chen at yinyue123.com (Fu Chen)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Write with overview updated
In-Reply-To: <000001c4061b$2d77b500$fe0ba8c0@lancaster.beardandsandals.co.uk>
Message-ID: <HLENLPCAGDEHMNMNLIDJCEFKCBAA.chen@yinyue123.com>

Hi!
I recently use GDAL to update a part of large geotiff file but find the overview doesn't be updated. I must rebuild overviews of whole file.
How about add this feature in the GDAL?

From warmerdam at pobox.com  Fri Mar 12 10:39:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Write with overview updated
In-Reply-To: <HLENLPCAGDEHMNMNLIDJCEFKCBAA.chen@yinyue123.com>
References: <HLENLPCAGDEHMNMNLIDJCEFKCBAA.chen@yinyue123.com>
Message-ID: <4051D99B.7070001@pobox.com>

Fu Chen wrote:
> Hi!
> I recently use GDAL to update a part of large geotiff file but find 
 > the overview doesn't be updated. I must rebuild overviews of whole file.
> How about add this feature in the GDAL?

Fu Chen,

I gather you are asking that the overviews be updated automatically whenever
data is written to the file, is that right?  I am very hesitant to do that
for performance, and complexity reasons.  However, it is supposed to be
possible to update the overviews "in place" with gdaladdo.  Just request
the existing overview levels, and it should force them to be regenerated.
Let me know if you find otherwise.

When I was at PCI, I didn't update overviews automatically either, but I
did mark them as invalid if raster data was written to a base layer of a
raster with overviews.  I might try something similar in GDAL at some
point.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.wilkie at gov.yk.ca  Fri Mar 12 14:23:45 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <40520E41.9030203@gov.yk.ca>

Hi Listers,

What is the optimum number of overviews versus file size when stored in 
geotiffs? And if the end goal is viewing perfomance, as measured by an 
application like ArcMap? Mapserver?

The gdal_utilities web page[0] gives "2 4 8 16" as an example, however 
significant file size savings can be realized if we use just 4-16. What 
is sacrificed by dropping 2?

Are powers of two just convenience? Would 3 9 18 36 work just as well?

And does the size of the image determine how many overview levels are 
useful? For example a 100mb image might not benefit much from an upper 
overview of 16, while a 3gb image might need to go all the way up 128 or 
more.

Are there any guidelines for choosing overview levels?


[0] http://www.remotesensing.org/gdal/gdal_utilities.html

thanks for your time,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From MChapman at sanz.com  Fri Mar 12 14:48:42 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9530@mailman.san.com>

Matt,

You can create whatever overviews you want in an ovr file, but they
definitely must be a power of two, so you can have 1, 2, 4, 8, 16, 32
,64 ,128 , 256, 512, 1024, 2048, 4096...ect...or 2, 16, 4096, or just 8.
Basically, each pyramid level is 1/4 the size of the pyramid level below
it and 4x the size of the pyramid level above it.  There is a point
though that when an image is scaled to 2x2, it makes no sense to reduce
it further.  You can dynamically figure out what pyramids make sense at
run time by using the width and height of the image in pixels.  Big
images may require smaller thumbnails to scale them down to something
small, whereas small images may not need to reduced that much.

I usually always create 12 pyramids because the further you go, the time
to create the pyramid is reduced by an order of magnitude.  So creating
anything past 8 or 16 is going to fast (usually).  The reason for all
the pyramids in my case is to handle scaling very large images down to
small thumbnails.  It really depends on your app, but definitely need to
be power of 2. 

Martin Chapman

-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 12, 2004 12:24 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] optimum overview settings?


Hi Listers,

What is the optimum number of overviews versus file size when stored in 
geotiffs? And if the end goal is viewing perfomance, as measured by an 
application like ArcMap? Mapserver?

The gdal_utilities web page[0] gives "2 4 8 16" as an example, however 
significant file size savings can be realized if we use just 4-16. What 
is sacrificed by dropping 2?

Are powers of two just convenience? Would 3 9 18 36 work just as well?

And does the size of the image determine how many overview levels are 
useful? For example a 100mb image might not benefit much from an upper 
overview of 16, while a 3gb image might need to go all the way up 128 or

more.

Are there any guidelines for choosing overview levels?


[0] http://www.remotesensing.org/gdal/gdal_utilities.html

thanks for your time,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From MChapman at sanz.com  Fri Mar 12 14:57:12 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com>

Matt,

Also, be aware that if you are writing an ovr file, and an ovr file with
the same name exists, the gdal lib will append to the file, resulting in
a file with more ovr's than you expect.  Moral of the story...delete the
other ovr first.  I ran into this when I implemented ovr functionality
in my app.  Maybe it was my bad code, but it threw me for a loop for a
few hours.

Martin

-----Original Message-----
From: Chapman, Martin 
Sent: Friday, March 12, 2004 12:49 PM
To: gdal-dev@remotesensing.org
Subject: RE: [Gdal-dev] optimum overview settings?


Matt,

You can create whatever overviews you want in an ovr file, but they
definitely must be a power of two, so you can have 1, 2, 4, 8, 16, 32
,64 ,128 , 256, 512, 1024, 2048, 4096...ect...or 2, 16, 4096, or just 8.
Basically, each pyramid level is 1/4 the size of the pyramid level below
it and 4x the size of the pyramid level above it.  There is a point
though that when an image is scaled to 2x2, it makes no sense to reduce
it further.  You can dynamically figure out what pyramids make sense at
run time by using the width and height of the image in pixels.  Big
images may require smaller thumbnails to scale them down to something
small, whereas small images may not need to reduced that much.

I usually always create 12 pyramids because the further you go, the time
to create the pyramid is reduced by an order of magnitude.  So creating
anything past 8 or 16 is going to fast (usually).  The reason for all
the pyramids in my case is to handle scaling very large images down to
small thumbnails.  It really depends on your app, but definitely need to
be power of 2. 

Martin Chapman

-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 12, 2004 12:24 PM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] optimum overview settings?


Hi Listers,

What is the optimum number of overviews versus file size when stored in 
geotiffs? And if the end goal is viewing perfomance, as measured by an 
application like ArcMap? Mapserver?

The gdal_utilities web page[0] gives "2 4 8 16" as an example, however 
significant file size savings can be realized if we use just 4-16. What 
is sacrificed by dropping 2?

Are powers of two just convenience? Would 3 9 18 36 work just as well?

And does the size of the image determine how many overview levels are 
useful? For example a 100mb image might not benefit much from an upper 
overview of 16, while a 3gb image might need to go all the way up 128 or

more.

Are there any guidelines for choosing overview levels?


[0] http://www.remotesensing.org/gdal/gdal_utilities.html

thanks for your time,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From matt.wilkie at gov.yk.ca  Fri Mar 12 15:27:00 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com>
Message-ID: <40521D14.3070100@gov.yk.ca>

Chapman, Martin wrote:

> Matt,
> 
> Also, be aware that if you are writing an ovr file, and an ovr file with
> the same name exists, the gdal lib will append to the file, resulting in
> a file with more ovr's than you expect.  Moral of the story...delete the
> other ovr first.  

What happens with geotiffs, where the overviews are embedded?

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From MChapman at sanz.com  Fri Mar 12 15:43:39 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9532@mailman.san.com>

The new pyramids just got added to the end of the file...so if you had
an ovr file with 2, 4, 8, and you generated a new levels 2, 4, 8, 16 ...
You would end up with a file of overviews like 2, 4, 8, 2, 4, 8, 16.

Martin

-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 12, 2004 1:27 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Chapman, Martin wrote:

> Matt,
> 
> Also, be aware that if you are writing an ovr file, and an ovr file 
> with the same name exists, the gdal lib will append to the file, 
> resulting in a file with more ovr's than you expect.  Moral of the 
> story...delete the other ovr first.

What happens with geotiffs, where the overviews are embedded?

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From matt.wilkie at gov.yk.ca  Fri Mar 12 15:46:03 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9530@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465FB9530@mailman.san.com>
Message-ID: <4052218B.9080300@gov.yk.ca>

Thanks for your insight Martin, it helps. :)

Are ESRI's pyramid files (.rrd) compatible with gdal's (.ovr)?
It'd be cool if I could generate pyramids from the command line for all 
our images at once rather than at first load time by ArcMap/Catalog.


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From MChapman at sanz.com  Fri Mar 12 15:53:17 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9533@mailman.san.com>

Matt,

Are you using a command line util or the API?

Martin

-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 12, 2004 1:27 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Chapman, Martin wrote:

> Matt,
> 
> Also, be aware that if you are writing an ovr file, and an ovr file 
> with the same name exists, the gdal lib will append to the file, 
> resulting in a file with more ovr's than you expect.  Moral of the 
> story...delete the other ovr first.

What happens with geotiffs, where the overviews are embedded?

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar 12 16:08:40 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <40520E41.9030203@gov.yk.ca>
References: <40520E41.9030203@gov.yk.ca>
Message-ID: <405226D8.50800@pobox.com>

Matt Wilkie wrote:
> Hi Listers,
> 
> What is the optimum number of overviews versus file size when stored in 
> geotiffs? And if the end goal is viewing perfomance, as measured by an 
> application like ArcMap? Mapserver?
> 
> The gdal_utilities web page[0] gives "2 4 8 16" as an example, however 
> significant file size savings can be realized if we use just 4-16. What 
> is sacrificed by dropping 2?
> 
> Are powers of two just convenience? Would 3 9 18 36 work just as well?
> 
> And does the size of the image determine how many overview levels are 
> useful? For example a 100mb image might not benefit much from an upper 
> overview of 16, while a 3gb image might need to go all the way up 128 or 
> more.
> 
> Are there any guidelines for choosing overview levels?

Matt,

"Optimum number of overviews versus file size" does not compute.  If you
are just opitmizing for file size then the optimum number of overviews is
none.  Powers of 3 should be fine, and at PCI I used 3 9 27 81 243 as the
default set of overviews to build.  Powers of 2 are more traditional.

Skipping the x2, x4 and x8 overviews will results in substantially slower
loads of regions at between x2 and x16 resolution.  In some applications
this may be significant (ie. MapServer) while in others it won't matter
much.

Chapman, Martin wrote:
 > Matt,
 >
 > You can create whatever overviews you want in an ovr file, but they
 > definitely must be a power of two, so you can have 1, 2, 4, 8, 16, 32
 > ,64 ,128 , 256, 512, 1024, 2048, 4096...ect...or 2, 16, 4096, or just 8.

I am not aware of a requirement that the overviews be powers of 2.  If you
can document a bug with non-powers-of-2 overview levels I would like to
know (via bugzilla).  There may be a requirement for integer overview levels.
I'm not too sure about that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Fri Mar 12 16:10:33 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <40521D14.3070100@gov.yk.ca>
References: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com> <40521D14.3070100@gov.yk.ca>
Message-ID: <40522749.2080801@pobox.com>

Matt Wilkie wrote:
> Chapman, Martin wrote:
> 
>> Matt,
>>
>> Also, be aware that if you are writing an ovr file, and an ovr file with
>> the same name exists, the gdal lib will append to the file, resulting in
>> a file with more ovr's than you expect.  Moral of the story...delete the
>> other ovr first.   

Martin / Matt,

Martin is right that you have to be wary about existing overviews.  gdaladdo
attempts to add requested overview levels to existing levels or recreate
existing levels if they match requested levels.

> What happens with geotiffs, where the overviews are embedded?

They cannot be easily deleted (like external files) so if you really want
to get rid of them you pretty much have to gdal_translate the file to a new
file which won't have the overviews.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Fri Mar 12 16:10:14 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9534@mailman.san.com>

Matt, 

I don't think so.  I renamed an .rrd file to .ovr and then tried to open
it with gdal and it didn't work.  But, you could always dynamically
create them (.rrd) with ArcMap code.  See the attached files to build
rrd files from c++ in ArcMap 9.  You just need the arcobjects developer
kit to do it.  I think it is easily obtainable though, if you have
ArcMap.

Martin



-----Original Message-----
From: Matt Wilkie [mailto:matt.wilkie@gov.yk.ca] 
Sent: Friday, March 12, 2004 1:46 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Thanks for your insight Martin, it helps. :)

Are ESRI's pyramid files (.rrd) compatible with gdal's (.ovr)? It'd be
cool if I could generate pyramids from the command line for all 
our images at once rather than at first load time by ArcMap/Catalog.


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Cpp.zip
Type: application/x-zip-compressed
Size: 5182 bytes
Desc: Cpp.zip
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040312/937c4103/Cpp.bin
From MChapman at sanz.com  Fri Mar 12 16:15:36 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9535@mailman.san.com>

Frank,

Hummm, I thought I didn't get any output when I tried ovr's other than
power of 2.  Maybe I had something else wrong in my code at the time.  I
will try it again.  That would be great if that's the case.

Thanks Frank,

Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, March 12, 2004 2:09 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Matt Wilkie wrote:
> Hi Listers,
> 
> What is the optimum number of overviews versus file size when stored 
> in
> geotiffs? And if the end goal is viewing perfomance, as measured by an

> application like ArcMap? Mapserver?
> 
> The gdal_utilities web page[0] gives "2 4 8 16" as an example, however
> significant file size savings can be realized if we use just 4-16.
What 
> is sacrificed by dropping 2?
> 
> Are powers of two just convenience? Would 3 9 18 36 work just as well?
> 
> And does the size of the image determine how many overview levels are
> useful? For example a 100mb image might not benefit much from an upper

> overview of 16, while a 3gb image might need to go all the way up 128
or 
> more.
> 
> Are there any guidelines for choosing overview levels?

Matt,

"Optimum number of overviews versus file size" does not compute.  If you
are just opitmizing for file size then the optimum number of overviews
is none.  Powers of 3 should be fine, and at PCI I used 3 9 27 81 243 as
the default set of overviews to build.  Powers of 2 are more
traditional.

Skipping the x2, x4 and x8 overviews will results in substantially
slower loads of regions at between x2 and x16 resolution.  In some
applications this may be significant (ie. MapServer) while in others it
won't matter much.

Chapman, Martin wrote:
 > Matt,
 >
 > You can create whatever overviews you want in an ovr file, but they
> definitely must be a power of two, so you can have 1, 2, 4, 8, 16, 32
> ,64 ,128 , 256, 512, 1024, 2048, 4096...ect...or 2, 16, 4096, or just
8.

I am not aware of a requirement that the overviews be powers of 2.  If
you can document a bug with non-powers-of-2 overview levels I would like
to know (via bugzilla).  There may be a requirement for integer overview
levels. I'm not too sure about that.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar 12 16:19:49 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <4052218B.9080300@gov.yk.ca>
References: <ED3A48B9840E594890A2BC172D119465FB9530@mailman.san.com> <4052218B.9080300@gov.yk.ca>
Message-ID: <40522975.7010508@pobox.com>

Matt Wilkie wrote:
> Thanks for your insight Martin, it helps. :)
> 
> Are ESRI's pyramid files (.rrd) compatible with gdal's (.ovr)?
> It'd be cool if I could generate pyramids from the command line for all 
> our images at once rather than at first load time by ArcMap/Catalog.

Matt,

The .rrd files used by ArcGIS are Erdas Imagine files.  GDAL won't currently
generate the correct variation of these to use as overviews though it could
be implemented without a huge amount of trouble.  However, I don't have any
software now that I could use to test the result  and of course it isn't a
feature of any great importance to me.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.wilkie at gov.yk.ca  Fri Mar 12 16:17:38 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9533@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465FB9533@mailman.san.com>
Message-ID: <405228F2.20307@gov.yk.ca>

> Are you using a command line util or the API?

command line, on windows.

-matt


From matt.wilkie at gov.yk.ca  Fri Mar 12 16:28:38 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <405226D8.50800@pobox.com>
References: <405226D8.50800@pobox.com>
Message-ID: <40522B86.3060408@gov.yk.ca>

> "Optimum number of overviews versus file size" does not compute.  

That was badly worded, no wonder it doesn't compute. What I'm trying to 
discover is where is the balance point between improving performance by 
adding more overviews is outweighed by the gain in storage requirements, 
and thereby time to transfer to/from disk.

Maybe there just isn't one, and I'm chasing wil'o'wisps.

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From zhang at aero.und.edu  Fri Mar 12 16:27:15 2004
From: zhang at aero.und.edu (Xiaodong Zhang)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <40522749.2080801@pobox.com>
References: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com> <40521D
	 14.3070100@gov.yk.ca> <40522749.2080801@pobox.com>
Message-ID: <1079126835.40522b33a37e3@webmail.aero.und.edu>

Hi Frank,

Hope you don't mind my jumping into this discussion. Just want to double check
with you. I run overview at 2 4 8 16 for all the images using crontab. I noticed
the crontab did not run for a period of time and I don't know which images have
or not have overview. So I just run the overview again to all the images with
the same overview scheme 2 4 8 16. Will this create a duplicate overview of 2 4
8 16 2 4 8 16 as suggested by Martin, or as you have indicated it will simply
replace the existing matching overview layer.

Thanks
Xiaodong

Quoting Frank Warmerdam <warmerdam@pobox.com>:

> Matt Wilkie wrote:
> > Chapman, Martin wrote:
> > 
> >> Matt,
> >>
> >> Also, be aware that if you are writing an ovr file, and an ovr file with
> >> the same name exists, the gdal lib will append to the file, resulting in
> >> a file with more ovr's than you expect.  Moral of the story...delete the
> >> other ovr first.   
> 
> Martin / Matt,
> 
> Martin is right that you have to be wary about existing overviews.  gdaladdo
> attempts to add requested overview levels to existing levels or recreate
> existing levels if they match requested levels.
> 
> > What happens with geotiffs, where the overviews are embedded?
> 
> They cannot be easily deleted (like external files) so if you really want
> to get rid of them you pretty much have to gdal_translate the file to a new
> file which won't have the overviews.
> 
> Best regards,
> -- 
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev
> 



From MChapman at sanz.com  Fri Mar 12 16:35:50 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9536@mailman.san.com>

Frank and Matt,

Frank is correct, 3, 9, 18, 36 worked fine.  I must have had something
else screwed up.  Thanks for the clarification Frank.

Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, March 12, 2004 2:09 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Matt Wilkie wrote:
> Hi Listers,
> 
> What is the optimum number of overviews versus file size when stored 
> in
> geotiffs? And if the end goal is viewing perfomance, as measured by an

> application like ArcMap? Mapserver?
> 
> The gdal_utilities web page[0] gives "2 4 8 16" as an example, however
> significant file size savings can be realized if we use just 4-16.
What 
> is sacrificed by dropping 2?
> 
> Are powers of two just convenience? Would 3 9 18 36 work just as well?
> 
> And does the size of the image determine how many overview levels are
> useful? For example a 100mb image might not benefit much from an upper

> overview of 16, while a 3gb image might need to go all the way up 128
or 
> more.
> 
> Are there any guidelines for choosing overview levels?

Matt,

"Optimum number of overviews versus file size" does not compute.  If you
are just opitmizing for file size then the optimum number of overviews
is none.  Powers of 3 should be fine, and at PCI I used 3 9 27 81 243 as
the default set of overviews to build.  Powers of 2 are more
traditional.

Skipping the x2, x4 and x8 overviews will results in substantially
slower loads of regions at between x2 and x16 resolution.  In some
applications this may be significant (ie. MapServer) while in others it
won't matter much.

Chapman, Martin wrote:
 > Matt,
 >
 > You can create whatever overviews you want in an ovr file, but they
> definitely must be a power of two, so you can have 1, 2, 4, 8, 16, 32
> ,64 ,128 , 256, 512, 1024, 2048, 4096...ect...or 2, 16, 4096, or just
8.

I am not aware of a requirement that the overviews be powers of 2.  If
you can document a bug with non-powers-of-2 overview levels I would like
to know (via bugzilla).  There may be a requirement for integer overview
levels. I'm not too sure about that.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar 12 16:45:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <ED3A48B9840E594890A2BC172D119465FB9532@mailman.san.com>
References: <ED3A48B9840E594890A2BC172D119465FB9532@mailman.san.com>
Message-ID: <40522F7A.1010607@pobox.com>

Chapman, Martin wrote:
> The new pyramids just got added to the end of the file...so if you had
> an ovr file with 2, 4, 8, and you generated a new levels 2, 4, 8, 16 ...
> You would end up with a file of overviews like 2, 4, 8, 2, 4, 8, 16.

Martin,

Hmm, that isn't supposed to happen.  I just tried this with a small file and
had no problem:

gdaladdo utm.tif 2 4
gdaladdo utm.tif 2 4
gdalinfo utm.tif
...
Band 1 Block=512x16 Type=Byte, ColorInterp=Gray
   Overviews: 256x256, 128x128

I also verified with tiffinfo that there were no extra overviews created.

I then did a test with a .bt file that uses external overviews and things
seemed to work fine with it.

So, if you can reproduce the error you mention with 1.2.0 then please
report via bugzilla and I will look into it.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From MChapman at sanz.com  Fri Mar 12 17:24:56 2004
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
Message-ID: <ED3A48B9840E594890A2BC172D119465FB9539@mailman.san.com>

Frank,

I will try.

Martin

-----Original Message-----
From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
Sent: Friday, March 12, 2004 2:46 PM
To: gdal-dev@remotesensing.org
Subject: Re: [Gdal-dev] optimum overview settings?


Chapman, Martin wrote:
> The new pyramids just got added to the end of the file...so if you had

> an ovr file with 2, 4, 8, and you generated a new levels 2, 4, 8, 16 
> ... You would end up with a file of overviews like 2, 4, 8, 2, 4, 8, 
> 16.

Martin,

Hmm, that isn't supposed to happen.  I just tried this with a small file
and had no problem:

gdaladdo utm.tif 2 4
gdaladdo utm.tif 2 4
gdalinfo utm.tif
...
Band 1 Block=512x16 Type=Byte, ColorInterp=Gray
   Overviews: 256x256, 128x128

I also verified with tiffinfo that there were no extra overviews
created.

I then did a test with a .bt file that uses external overviews and
things seemed to work fine with it.

So, if you can reproduce the error you mention with 1.2.0 then please
report via bugzilla and I will look into it.

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Fri Mar 12 20:34:22 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] optimum overview settings?
In-Reply-To: <1079126835.40522b33a37e3@webmail.aero.und.edu>
References: <ED3A48B9840E594890A2BC172D119465E63AC9@mailman.san.com> <40521D	 14.3070100@gov.yk.ca> <40522749.2080801@pobox.com> <1079126835.40522b33a37e3@webmail.aero.und.edu>
Message-ID: <4052651E.40400@pobox.com>

Xiaodong Zhang wrote:
> Hi Frank,
> 
> Hope you don't mind my jumping into this discussion. Just want to double check
> with you. I run overview at 2 4 8 16 for all the images using crontab. I noticed
> the crontab did not run for a period of time and I don't know which images have
> or not have overview. So I just run the overview again to all the images with
> the same overview scheme 2 4 8 16. Will this create a duplicate overview of 2 4
> 8 16 2 4 8 16 as suggested by Martin, or as you have indicated it will simply
> replace the existing matching overview layer.

Zhang,

It should be fine to run gdaladdo on all the files, and it should just overwrite
existing overviews if they are there.  It worked for me.  But it is possible
that in older versions of GDAL or for some particular arrangements it will
be broken.  I would suggest experimenting.

Note that gdalinfo will report the overviews that existing down in the
per-band area.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From stanimura-ngs at umin.ac.jp  Fri Mar 12 22:35:31 2004
From: stanimura-ngs at umin.ac.jp (Susumu TANIMURA)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>
Message-ID: <20040313123531.43303131.stanimura-ngs@umin.ac.jp>

Hi, there.

Compilation with gdal 1.2.0 was failed on VineLinux2.6r4.
Dose anyone give me some advices?

The version of compilor is:
gcc-2.95.3-2vl22
gcc-cpp-2.95.3-2vl22
gcc-c++-2.95.3-2vl22

The error messages are followed.

g++ -Wall -O2 -m486 -fno-strength-reduce -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I../port -I../gcore -I../ogr -I../port -c gdal_misc.cpp  -fPIC -DPIC -DPIC -o gdal_misc.o
gdal_misc.cpp: In function `double GDALPackedDMSToDec(double)':
gdal_misc.cpp:1543: implicit declaration of function `int CPLPackedDMSToDec(...)'
gdal_misc.cpp: In function `double GDALDecToPackedDMS(double)':
gdal_misc.cpp:1559: implicit declaration of function `int CPLDecToPackedDMS(...)'
make[1]: *** [gdal_misc.o] Error 1
make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/gcore'
make: *** [core-target] Error 2
Bad exit status from /var/tmp/rpm-tmp.71895 (%build)

Since I joined this mailing-list today, I apologize if there is
something imperfect.  When further information is required, please
tell me.

From warmerdam at pobox.com  Fri Mar 12 23:32:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <20040313123531.43303131.stanimura-ngs@umin.ac.jp>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com> <20040313123531.43303131.stanimura-ngs@umin.ac.jp>
Message-ID: <40528ED1.5010104@pobox.com>

Susumu TANIMURA wrote:
> Hi, there.
> 
> Compilation with gdal 1.2.0 was failed on VineLinux2.6r4.
> Dose anyone give me some advices?
> 
> The version of compilor is:
> gcc-2.95.3-2vl22
> gcc-cpp-2.95.3-2vl22
> gcc-c++-2.95.3-2vl22
> 
> The error messages are followed.
> 
> g++ -Wall -O2 -m486 -fno-strength-reduce -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I../port -I../gcore -I../ogr -I../port -c gdal_misc.cpp  -fPIC -DPIC -DPIC -o gdal_misc.o
> gdal_misc.cpp: In function `double GDALPackedDMSToDec(double)':
> gdal_misc.cpp:1543: implicit declaration of function `int CPLPackedDMSToDec(...)'
> gdal_misc.cpp: In function `double GDALDecToPackedDMS(double)':
> gdal_misc.cpp:1559: implicit declaration of function `int CPLDecToPackedDMS(...)'
> make[1]: *** [gdal_misc.o] Error 1
> make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/gcore'
> make: *** [core-target] Error 2
> Bad exit status from /var/tmp/rpm-tmp.71895 (%build)
> 
> Since I joined this mailing-list today, I apologize if there is
> something imperfect.  When further information is required, please
> tell me.

Susumu,

It would appear you have an older gdal.h in /usr/local/include and that
is being used in preference to the copy in the ../gcore.  Hmm, when I build
the include path looks like " -I../port -I../gcore -I../ogr -I../port".  I
wonder how all that extra stuff about -I/usr/include and so forth got in
there.  Anything special about how you configured?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From stanimura-ngs at umin.ac.jp  Sat Mar 13 19:10:46 2004
From: stanimura-ngs at umin.ac.jp (Susumu TANIMURA)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <40528ED1.5010104@pobox.com>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>
	<20040313123531.43303131.stanimura-ngs@umin.ac.jp>
	<40528ED1.5010104@pobox.com>
Message-ID: <20040314091046.5e12af4d.stanimura-ngs@umin.ac.jp>

Hi Frank,

Thank you for reply. 

> It would appear you have an older gdal.h in /usr/local/include and
> that is being used in preference to the copy in the ../gcore.  Hmm,
> when I build the include path looks like " -I../port -I../gcore
> -I../ogr -I../port".  I wonder how all that extra stuff about
> -I/usr/include and so forth got in there.  Anything special about
> how you configured?

There is gdal.h v 1.70 in /usr/include and gdal.h v 1.77 in
/home/hoge/rpm/BUILD/gdal-1.2.0/gcore/ in which I tried build rpm
package of gdal 1.2.0.

Here are my configure options in log message.

+ ./configure i386-vine-linux --prefix=/usr --exec-prefix=/usr
--bindir=/usr/bin --sbindir=/usr/sbin --sysconfdir=/etc
--datadir=/usr/share --includedir=/usr/include --libdir=/usr/lib
--libexecdir=/usr/libexec --localstatedir=/var/lib
--sharedstatedir=/usr/share --mandir=/usr/share/man
--infodir=/usr/info --with-libz=/usr/include --with-png=/usr/include
--with-gif=/usr/include --with-geotiff=internal
--with-jpeg=/usr/include --with-libtiff=internal
--with--pymodir=/usr/lib/python2.1/site-packages

The versions of external libraries are followed.
$ rpm -q lib{png,tiff,ungif,jpeg}-devel zlib-devel
libpng-devel-1.0.12-0vl3
libtiff-devel-3.5.7-6vl1
libungif-devel-4.1.0-9vl1
libjpeg-devel-6b-15vl1
zlib-devel-1.1.4-0vl2

If further information needed, please tell me.


From stanimura-ngs at umin.ac.jp  Sat Mar 13 19:33:47 2004
From: stanimura-ngs at umin.ac.jp (Susumu TANIMURA)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <40528ED1.5010104@pobox.com>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>
	<20040313123531.43303131.stanimura-ngs@umin.ac.jp>
	<40528ED1.5010104@pobox.com>
Message-ID: <20040314093347.4350a1e7.stanimura-ngs@umin.ac.jp>

Thank Frank, I got pass the compile error with removing
/usr/include/gdal.h, but still I could not complete the compilation.

Another error was given as followed.

g++ -Wall -O2 -m486 -fno-strength-reduce -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include -I../../port -I../../gcore -I../../ogr -Ilibgeotiff -Ilibtiff -I../../port -c geotiff.cpp  -fP IC -DPIC -DPIC -o ../o/geotiff.o
geotiff.cpp: In function `struct TIFF * GTiffCreate(const char *, int, int, int, GDALDataType, char **)':
geotiff.cpp:2732: `PHOTOMETRIC_ICCLAB' undeclared (first use this function)
geotiff.cpp:2732: (Each undeclared identifier is reported only once
geotiff.cpp:2732: for each function it appears in.)
geotiff.cpp: In function `void GTiffTagExtender(TIFF *)':
geotiff.cpp:3609: ANSI C++ forbids declaration `TIFFFieldInfo' with no type
geotiff.cpp:3609: uninitialized const `TIFFFieldInfo'
geotiff.cpp:3609: parse error before `['
geotiff.cpp:3609: warning: unused variable `const int TIFFFieldInfo'
geotiff.cpp: At top level:
geotiff.cpp:3619: `tif' was not declared in this scope
geotiff.cpp:3619: `xtiffFieldInfo' was not declared in this scope
geotiff.cpp:3620: `xtiffFieldInfo' was not declared in this scope
geotiff.cpp:3620: `xtiffFieldInfo' was not declared in this scope
geotiff.cpp:3620: ANSI C++ forbids declaration `TIFFMergeFieldInfo' with no typegeotiff.cpp:3620: initializer list being treated as compound expression
geotiff.cpp:3621: parse error before `}'
make[2]: *** [../o/geotiff.o] Error 1
make[2]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/frmts/gtiff'
make[1]: *** [gtiff-install-obj] Error 2
make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/frmts'
make: *** [frmts-target] Error 2
Bad exit status from /var/tmp/rpm-tmp.35260 (%build)


From warmerdam at pobox.com  Mon Mar 15 03:30:24 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <20040314091046.5e12af4d.stanimura-ngs@umin.ac.jp>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>	<20040313123531.43303131.stanimura-ngs@umin.ac.jp>	<40528ED1.5010104@pobox.com> <20040314091046.5e12af4d.stanimura-ngs@umin.ac.jp>
Message-ID: <405569A0.9070900@pobox.com>

Susumu TANIMURA wrote:
> Hi Frank,
> 
> Thank you for reply. 
> 
> 
>>It would appear you have an older gdal.h in /usr/local/include and
>>that is being used in preference to the copy in the ../gcore.  Hmm,
>>when I build the include path looks like " -I../port -I../gcore
>>-I../ogr -I../port".  I wonder how all that extra stuff about
>>-I/usr/include and so forth got in there.  Anything special about
>>how you configured?
> 
> 
> There is gdal.h v 1.70 in /usr/include and gdal.h v 1.77 in
> /home/hoge/rpm/BUILD/gdal-1.2.0/gcore/ in which I tried build rpm
> package of gdal 1.2.0.
> 
> Here are my configure options in log message.
> 
> + ./configure i386-vine-linux --prefix=/usr --exec-prefix=/usr
> --bindir=/usr/bin --sbindir=/usr/sbin --sysconfdir=/etc
> --datadir=/usr/share --includedir=/usr/include --libdir=/usr/lib
> --libexecdir=/usr/libexec --localstatedir=/var/lib
> --sharedstatedir=/usr/share --mandir=/usr/share/man
> --infodir=/usr/info --with-libz=/usr/include --with-png=/usr/include
> --with-gif=/usr/include --with-geotiff=internal
> --with-jpeg=/usr/include --with-libtiff=internal
> --with--pymodir=/usr/lib/python2.1/site-packages

Hi,

A few notes:

Directives like --with-jpeg, --with-gif, and --with-png should
be pointing to the whole tree, not just the include files.  So a
more appropriate form would be --with-gif=/usr.  And since this is
in the default path, it is likely sufficient to build with --with-gif
with no argument.

You are geting lots of "-I/usr/include/include" because of the wrong
arguments to the various --with options.

Also, you should use "--with-pymoddir", not "--with--pymodir".

> The versions of external libraries are followed.
> $ rpm -q lib{png,tiff,ungif,jpeg}-devel zlib-devel
> libpng-devel-1.0.12-0vl3
> libtiff-devel-3.5.7-6vl1
> libungif-devel-4.1.0-9vl1
> libjpeg-devel-6b-15vl1
> zlib-devel-1.1.4-0vl2
...

 > Thank Frank, I got pass the compile error with removing
 > /usr/include/gdal.h, but still I could not complete the compilation.
 >
 > Another error was given as followed.
 >
 > g++ -Wall -O2 -m486 -fno-strength-reduce -I/usr/include -I/usr/include/include -I/usr/include -I/usr/include/include 
-I/usr/include -I/usr/include/include -I../../port -I../../gcore -I../../ogr -Ilibgeotiff -Ilibtiff -I../../port -c 
geotiff.cpp  -fP IC -DPIC -DPIC -o ../o/geotiff.o
 > geotiff.cpp: In function `struct TIFF * GTiffCreate(const char *, int, int, int, GDALDataType, char **)':
 > geotiff.cpp:2732: `PHOTOMETRIC_ICCLAB' undeclared (first use this function)
 > geotiff.cpp:2732: (Each undeclared identifier is reported only once
 > geotiff.cpp:2732: for each function it appears in.)
 > geotiff.cpp: In function `void GTiffTagExtender(TIFF *)':
 > geotiff.cpp:3609: ANSI C++ forbids declaration `TIFFFieldInfo' with no type
 > geotiff.cpp:3609: uninitialized const `TIFFFieldInfo'
 > geotiff.cpp:3609: parse error before `['
 > geotiff.cpp:3609: warning: unused variable `const int TIFFFieldInfo'
 > geotiff.cpp: At top level:
 > geotiff.cpp:3619: `tif' was not declared in this scope
 > geotiff.cpp:3619: `xtiffFieldInfo' was not declared in this scope
 > geotiff.cpp:3620: `xtiffFieldInfo' was not declared in this scope
 > geotiff.cpp:3620: `xtiffFieldInfo' was not declared in this scope
 > geotiff.cpp:3620: ANSI C++ forbids declaration `TIFFMergeFieldInfo' with no typegeotiff.cpp:3620: initializer list 
being treated as compound expression
 > geotiff.cpp:3621: parse error before `}'
 > make[2]: *** [../o/geotiff.o] Error 1
 > make[2]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/frmts/gtiff'
 > make[1]: *** [gtiff-install-obj] Error 2
 > make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/frmts'
 > make: *** [frmts-target] Error 2
 > Bad exit status from /var/tmp/rpm-tmp.35260 (%build)

The problem, once again is that you are getting the wrong include
files. In this case you are getting your global libtiff include files
instead of the ones contained within the GDAL distribution.  GDAL depends
on at least libtiff 3.6.0 or newer. I see you have (appropriately)
configured with the internal libtiff but the -I/usr/include is getting
inserted because of your many configure options pointing to that area.

In theory, when we want to reference local directories we should be
ensuring those includes take preference over global includes.  I am
a bit surprised that isn't happening.  If you wouldn't mind filing a bug
with the configure, and compile information I would appreciate it.  In
particular the compile line should list "-Ilibtiff" ahead of all the
-I/usr/include type stuff.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.gregory at oregonstate.edu  Mon Mar 15 17:05:17 2004
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] advice on multiple band formats
Message-ID: <EC3C5F40BC462C4C84E6A1F92C2424D3070C98@thuja>

I am developing an app where it is important that I be able to write
Imagine and AI Grid formats (using the HFA and GIO drivers).  At
present, I am running a spatial model and writing data to a temporary
Imagine image.  At the conclusion I use CreateCopy() to write to the
desired format.  

If I want to write to AI Grid (which doesn't support multiple-band
images), is there a way of going directly from a multiple-band Imagine
image to multiple Grid images?  The approach I was going to take was to
create a std::vector of single-band Imagine files for temporary use.  If
the user wanted grids, this would be a straight-forward CreateCopy()
from HFA to GIO.  If the user wanted an Imagine file, the bands could be
stacked from the individual temp Imagine files.  I'm sure somebody has
dealt with this and come up with a much more elegant solution.

An ancillary question is whether it is better to use the MEM driver to
store the temporary information.  If this is the case, could someone
post a simple example of how the use this driver?  I'm not quite getting
it from the online example.

Thanks for any advice.

matt

Matt Gregory
Faculty Research Assistant
Department of Forest Science
Oregon State University
541.750.7285
matt.gregory@orst.edu

  

From schut at sarvision.com  Tue Mar 16 03:48:46 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] vrt format and absolute/relative paths
Message-ID: <200403160948.46470.schut@sarvision.com>

I'm starting to use (and like!) the vrt format more and more. However, when I 
thought I would use standard vrt files as templates for multiple directories 
that contain the same kind of data (like spot vegetation data for multiple 
dates), I found out that the vrt file loader uses the current working dir as 
path prefix for the SourceFilename, which effectively keeps me from using 
one .vrt file with relative filenames as SourceFilename and linking/copying 
that into each directory. E.g. I would like to have a vrt file that has the 
files 0001_B0.HDF, 0001_B2.HDF, 0001_B3.HDF and 0001_MIR.HDF as bands 1-4, 
and than I put that vrt file in each of my Spot Vegetation directories and if 
I then load one of the vrt files, it gives me the four HDF files from the 
directory where the vrt file is located. However, the current behaviour is 
different: it gives me the HDF files from the current directory. So if I 
issue a gdalinfo command on a vrt file from a different directory:
vincent@lowresbox spotgetation/s10$ gdalinfo 
Asian-Islands.20020601/spectral.vrt
gdal tries to load the referenced raster sources from the current directory 
(spotvegetation/s10/), and not from the local directory of the vrt file 
(spotvegetation/s10/Asian-Islands.20020601/). So in this example I would get 
an error, as there are no Spot Vegetation raster files in 
spotvegetation/s10/.

Is this behaviour intended?
If not, if would greatly help me if it could be changed so that gdal always 
uses the home directory of the current vrt file to look for the vrt raster 
source files.

Thanks,
-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From schut at sarvision.com  Tue Mar 16 04:01:38 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] vrt format and absolute/relative paths
In-Reply-To: <200403160948.46470.schut@sarvision.com>
References: <200403160948.46470.schut@sarvision.com>
Message-ID: <200403161001.38980.schut@sarvision.com>

Adding to myself:

note that also gdal_translate creates vrt files with relative filenames for 
the rastersources. When trying to load the created vrt file using a program 
that has been started from a different working dir, loading will give an 
error because gdal looks for the rastersources in the wrong dir. Or, even 
worse, you will not get an error but the wrong raster data if raster files 
with the same name as those mentioned in the vrt file are also present in the 
cwd...

On Tuesday 16 March 2004 09:48, Vincent Schut wrote:
> I'm starting to use (and like!) the vrt format more and more. However, when
> I thought I would use standard vrt files as templates for multiple
> directories that contain the same kind of data (like spot vegetation data
> for multiple dates), I found out that the vrt file loader uses the current
> working dir as path prefix for the SourceFilename, which effectively keeps
> me from using one .vrt file with relative filenames as SourceFilename and
> linking/copying that into each directory. E.g. I would like to have a vrt
> file that has the files 0001_B0.HDF, 0001_B2.HDF, 0001_B3.HDF and
> 0001_MIR.HDF as bands 1-4, and than I put that vrt file in each of my Spot
> Vegetation directories and if I then load one of the vrt files, it gives me
> the four HDF files from the directory where the vrt file is located.
> However, the current behaviour is different: it gives me the HDF files from
> the current directory. So if I issue a gdalinfo command on a vrt file from
> a different directory: vincent@lowresbox spotgetation/s10$ gdalinfo
> Asian-Islands.20020601/spectral.vrt
> gdal tries to load the referenced raster sources from the current directory
> (spotvegetation/s10/), and not from the local directory of the vrt file
> (spotvegetation/s10/Asian-Islands.20020601/). So in this example I would
> get an error, as there are no Spot Vegetation raster files in
> spotvegetation/s10/.
>
> Is this behaviour intended?
> If not, if would greatly help me if it could be changed so that gdal always
> uses the home directory of the current vrt file to look for the vrt raster
> source files.
>
> Thanks,

-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From chen at yinyue123.com  Tue Mar 16 05:32:46 2004
From: chen at yinyue123.com (Fu Chen)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] new bug in FAST format
In-Reply-To: <200403161001.38980.schut@sarvision.com>
Message-ID: <HLENLPCAGDEHMNMNLIDJMEGECBAA.chen@yinyue123.com>

Hi!
I test one of my old program. But find GDAL120b has some problems in parsing the FAST format.

#include "gdal_priv.h"
#include "cpl_conv.h"

int main ( int argc, char ** argv)
{
    GDALAllRegister();
	GDALDataset * poDataset= (GDALDataset *) GDALOpen( "h:\\chinagisdata\\landsatdata\\L71118038_03820020111_HPN.FST", GA_ReadOnly );
	const char * sDriverDesc = poDataset->GetProjectionRef();
	printf(sDriverDesc);
}

gdal119 output:

PROJCS["unnamed",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.
257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","632
6"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292519
9433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EP
SG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0]
,PARAMETER["central_meridian",123],PARAMETER["scale_factor",1],PARAMETER["false_
easting",500000],PARAMETER["false_northing",0],UNIT["Meter",1]]

gdal120b output:

PROJCS["unnamed",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.
257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","632
6"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.017453292519
9433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EP
SG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0]
,PARAMETER["central_meridian",0],PARAMETER["scale_factor",1],PARAMETER["false_ea
sting",0],PARAMETER["false_northing",0],UNIT["Meter",1]]

You can see in central_meridian false_easting are not correctly interpreted in 120b. What's change in the new version on the FAST format? 

any idea?
-------------- next part --------------
A non-text attachment was scrubbed...
Name: L71118038_03820020111_HPN.FST
Type: application/octet-stream
Size: 4608 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040316/7119dcb4/L71118038_03820020111_HPN.obj
From warmerdam at pobox.com  Tue Mar 16 13:39:10 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] vrt format and absolute/relative paths
In-Reply-To: <200403161001.38980.schut@sarvision.com>
References: <200403160948.46470.schut@sarvision.com> <200403161001.38980.schut@sarvision.com>
Message-ID: <405749CE.5080803@pobox.com>

Vincent Schut wrote:
>>Is this behaviour intended?
>>If not, if would greatly help me if it could be changed so that gdal always
>>uses the home directory of the current vrt file to look for the vrt raster
>>source files.

Vincent,

I have modified the VRT code in CVS so that it will check for a relativeToVRT
attribute on the SourceFilename element.  If it is set to a non-zero value then
the SourceFilename will be treated relative to the virtual file.   For example:

<VRTDataset rasterXSize="512" rasterYSize="512">
   <VRTRasterBand dataType="Byte" band="1">
     <ColorInterp>Gray</ColorInterp>
     <SimpleSource>
       <SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
       <SourceBand>1</SourceBand>
       <SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
       <DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
     </SimpleSource>
   </VRTRasterBand>
</VRTDataset>

Currently CreateCopy() does not attempt to set this, and relativize the path
though it might at some point in the future.

In general, even when doing a gdal_translate the .vrt may be put somewhere
completely unrelated to the actual files in which case it is hard to make
the SourceFilename relative to the .vrt.  While it has some significant
problems the code (for the time being) will just literally place whatever
filename you give it for the the input file into the SourceFilename element.

However, with a minor hand edit to your .vrt files you should now be able to
use them as desired.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jhayes at lizardtech.com  Tue Mar 16 16:13:21 2004
From: jhayes at lizardtech.com (John Hayes)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] GDAL fails when I try to open a large number of files.
Message-ID: <B78A4DC4AD9EE14FB014E9444BD2D30E051406@sea-srv-ms1.lizardtech.com>

Hi,
	I'm trying to mosaic +1500 TIFF files and GDAL fails to open the 1414 file.  I'm using my own mosaiking code that opens all the files first and keeps around the GDALDataset objects.  It looks like it is running out of file handles.  I would prefer not to create and delete a GDALDataset object for each strip of the image I read.

Is there a way to control if the file handle is left open between read calls? 

John Hayes

From warmerdam at pobox.com  Tue Mar 16 16:52:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] GDAL fails when I try to open a large number of files.
In-Reply-To: <B78A4DC4AD9EE14FB014E9444BD2D30E051406@sea-srv-ms1.lizardtech.com>
References: <B78A4DC4AD9EE14FB014E9444BD2D30E051406@sea-srv-ms1.lizardtech.com>
Message-ID: <40577729.5060801@pobox.com>

John Hayes wrote:
> Hi,
> 	I'm trying to mosaic +1500 TIFF files and GDAL fails to open the 1414 
 > file.  I'm using my own mosaiking code that opens all the files first and keeps
 >around the GDALDataset objects.  It looks like it is running out of file handles.
 >I would prefer not to create and delete a GDALDataset object for each strip of
 >the image I read.
> 
> Is there a way to control if the file handle is left open between read calls? 


John,

Currently the GeoTIFF driver does not open and close files dynamically.  If
you are on Unix or Linux I would suggest you look into the limit or ulimit
commands to control the maximum number of open files supported in a session.
It can usually be increased.

If that fails, you will need to find some other approach to managing the number
of open files yourself.




-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From starged at videotron.ca  Tue Mar 16 18:44:05 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
Message-ID: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>

Hi,

Is there something wrong with gdalwarp resampling algorithms? I have done some tests and got strange
results which I put here: http://pages.infinit.net/starged/gdal/resampling.html

For comparison, I have put an image processed in Paint Shop Pro 7 using bilinear resampling. It's
also strange that cubic spline give almost the same results.

I am using GDAL 1.2.0

Thanks for your attention.
--
Mario B.
My Landsat images:
http://pages.infinit.net/starged/landsat/home.html

From warmerdam at pobox.com  Tue Mar 16 18:58:27 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>
Message-ID: <405794A3.8040008@pobox.com>

Mario Beauchamp wrote:
> Hi,
> 
> Is there something wrong with gdalwarp resampling algorithms? I have done some tests and got strange
> results which I put here: http://pages.infinit.net/starged/gdal/resampling.html
> 
> For comparison, I have put an image processed in Paint Shop Pro 7 using bilinear resampling. It's
> also strange that cubic spline give almost the same results.

Mario,

At the macro level (looking at a whole image) I would expect bilinear and
cubic convolution to be hard to differentiate unless a great deal of
resolution magnification is taking place.

I looked at the images, and it does appear that there are some differences
from the results in Paint Shop Pro, but it is impossible for me to tell
what might be causing the differences.   If you can provide the input
files, and arguments you used to process them, and the raw results from
Paint Shop Pro I could try and compare.  However, there isn't anything I
do with jpeg files since the "corruption" of the data due to jpeg
compression will in many ways dominate the effects of different resampling
algorithms.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From cgn at globexplorer.com  Tue Mar 16 22:46:10 2004
From: cgn at globexplorer.com (Chris G. Nicholas)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
Message-ID: <71E37EF6B7DCC1499CEA0316A256832801473083@loki.wc.globexplorer.net>

The real test is, as always, change detection. :-)

And I think (scientists out there, please correct me!) nearest-neighbor is as reasonable as anything. 

Now, it would be interesting if GDAL could have a flag where one could take the time/computation hit and do the transformation matrix for *every* pixel... (like the MODIS reproject tool; see:  http://lpdaac2.usgs.gov/landdaac/tools/ modis/info/MRT_Users_Manual.pdf)

Chris

-----Original Message-----
From:	Frank Warmerdam [mailto:warmerdam@pobox.com]
Sent:	Tue 3/16/2004 3:58 PM
To:	gdal-dev@remotesensing.org
Cc:	
Subject:	Re: [Gdal-dev] Resampling with gdalwarp
Mario Beauchamp wrote:
> Hi,
> 
> Is there something wrong with gdalwarp resampling algorithms? I have done some tests and got strange
> results which I put here: http://pages.infinit.net/starged/gdal/resampling.html
> 
> For comparison, I have put an image processed in Paint Shop Pro 7 using bilinear resampling. It's
> also strange that cubic spline give almost the same results.

Mario,

At the macro level (looking at a whole image) I would expect bilinear and
cubic convolution to be hard to differentiate unless a great deal of
resolution magnification is taking place.

I looked at the images, and it does appear that there are some differences
from the results in Paint Shop Pro, but it is impossible for me to tell
what might be causing the differences.   If you can provide the input
files, and arguments you used to process them, and the raw results from
Paint Shop Pro I could try and compare.  However, there isn't anything I
do with jpeg files since the "corruption" of the data due to jpeg
compression will in many ways dominate the effects of different resampling
algorithms.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev





From starged at videotron.ca  Tue Mar 16 23:28:40 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <405794A3.8040008@pobox.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>
 <405794A3.8040008@pobox.com>
Message-ID: <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com>

Hi Frank,

On Tue, 16 Mar 2004 18:58:27 -0500, Frank Warmerdam <warmerdam@pobox.com> wrote:

>> Is there something wrong with gdalwarp resampling algorithms? I have done some tests and got strange
>> results which I put here: http://pages.infinit.net/starged/gdal/resampling.html
>
>At the macro level (looking at a whole image) I would expect bilinear and
>cubic convolution to be hard to differentiate unless a great deal of
>resolution magnification is taking place.

I don't know much about resampling algorithms... all I know is to use bilinear when you reduce and
cubic when you enlarge. Is that correct?

Works like that in PSP anywhow, and in fact using "Cubic" when reducing does not work well.

>I looked at the images, and it does appear that there are some differences
>from the results in Paint Shop Pro, but it is impossible for me to tell
>what might be causing the differences.   If you can provide the input
>files, and arguments you used to process them, and the raw results from
>Paint Shop Pro I could try and compare.

Here's the raw PSP image http://pages.infinit.net/starged/gdal/test-psp.tif

The test image is 1779KB... and I don't think I have that much space left on my site so here's a
cropped version: http://pages.infinit.net/starged/gdal/test-gwarp.tif

Note that there is nothing special about that image. I chose it because it was a good example. I get
pretty much the same results with any image that has roads or railways (ie, they are jagged or
chopped).

I simply used: gdalwarp -tr 120 120 -rb
There is no special arguments for PSP, we simply select "Bilinear" in the resize image dialog. The
exact algorithm used is not documented.

Also, the OSSIM bilinear resampling looks about the same as the PSP image. But it has some other
problems so I chose not to include it.

>However, there isn't anything I do with jpeg files since the "corruption" of the data due to jpeg
>compression will in many ways dominate the effects of different resampling algorithms.

These are actually copies of the original images and I used "quality=95" when I converted to jpeg
and used 1% trim linear stretch to enhance. I can tell you there is no noticeable difference between
the jpegs and the tiffs at 1:1.

Thanks.

--
Mario B.
Mes images Landsat:
http://pages.infinit.net/starged/landsat/index.html

From warmerdam at pobox.com  Wed Mar 17 01:09:46 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <71E37EF6B7DCC1499CEA0316A256832801473083@loki.wc.globexplorer.net>
References: <71E37EF6B7DCC1499CEA0316A256832801473083@loki.wc.globexplorer.net>
Message-ID: <4057EBAA.9070206@pobox.com>

Chris G. Nicholas wrote:
> The real test is, as always, change detection. :-)
> 
> And I think (scientists out there, please correct me!) nearest-neighbor is as reasonable as anything. 
> 
> Now, it would be interesting if GDAL could have a flag where one could take 
 > the time/computation hit and do the transformation matrix for *every* pixel...
 > (like the MODIS reproject tool; see:
 > http://lpdaac2.usgs.gov/landdaac/tools/ modis/info/MRT_Users_Manual.pdf)

Chris,

When you talk about doing the transformation exactly, are you talking
about resampling or the geometric transformation?  The geometric transformation
can be done exactly for each pixel (as far as the underlying transform goes)
if the error threshold is set to zero.

I am not sure what it would mean to do a resampling transformation exactly.
Would this mean using a convolution matrix as large as the image?  I am not
really very savvy about convolution kernels.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Mar 17 01:40:39 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com> <405794A3.8040008@pobox.com> <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com>
Message-ID: <4057F2E7.4040200@pobox.com>

Mario Beauchamp wrote:
> I don't know much about resampling algorithms... all I know is to use bilinear when you reduce and
> cubic when you enlarge. Is that correct?

Mario,

I am not familiar with that rule of thumb.

> I simply used: gdalwarp -tr 120 120 -rb
> There is no special arguments for PSP, we simply select "Bilinear" in the resize image dialog. The
> exact algorithm used is not documented.
> 
> Also, the OSSIM bilinear resampling looks about the same as the PSP image. But it has some other
> problems so I chose not to include it.

I have done some quick tests but they aren't exactly conclusive.  There
are definate differences.

I am including attached to this 3 smallish pngs of a small area of the image.
I picked this small area because it has a linear feature appiximately 1 pixel
across and the PSP and GDAL results are substantially different in this area.
The regions of the swatches are appoximately the same, but not exactly by any
means.  The original data is 4 times the resolution (in each direction) of the
downsampled data.  I ensured they all use the same simple linear stretch
to visualize the data, and I only show band 1 to simplify the situation.

The main thing to note is that the PSP downsampled image essentially preserves
the thin linear features, especially the thin nearly horizonal road.  The GDAL
image however "butchers" the road.  It is as if the road drops right out every
couple of pixels, and then comes back a couple pixels later.  That effect is not
seen in the PSP version.

Now while the GDAL result is unappealing, I would claim it is doing what I
would expect my concept of a 2x2 bilinear resampling kernel should do in a 4x4
downsampling case.  In the GDAL version, each output pixel is computed from a 2x2
neighbour of the input image but it is essentially representing a 4x4 area of the
input.  Very thin linear features, such as a 1 pixel wide road will often be
completely missed by the 2x2 kernel, while at other times if if the sample point
falls dead on the line it make come through at full brightness.

The PSP version is preserving the line well, though damped down substantially as
it is mixed with other non-road pixels.

I don't know what the formal definition of "bilinear resampling" is.  I suspect
that name can apply to a variety of techniques.  Let me explain what GDAL does.

1) It takes the center point of the output pixel, and geometrically transforms it
    to a location on the input pixel (with subpixel resolution).

2) The four pixels closest to the input sampling location are used in the kernel,
    and the proximity of the sampling location to the center of each input pixel
    determines it's contribution in a bilinear fashion.

Some implications to note:
  o Regardless of what amount of downsampling (or upsampling for that matter) is being
    done, each output pixel is determined from only 4 pixels.
  o If the transformed sampling point happens to fall very close to the center of an
    input pixel, then the other 3 input pixels in the kernel will have virtually no
    contribution. This means, depending on the vagarities of the resampling some output
    pixels may be dominated by one or two input pixels while others are a mix of all
    four.
  o In cases of integer decimation factors (such as exact 4x4 downsampling of images
    that have a size that is a multiple of 4x4) the sampling location should fall
    in the center of the 4x4 input block and so the center 2x2 pixels would make
    a contribution.  If there are rounding or other slight variations making the
    downsampling not exactly 4x4 to 1 then various kinds of odd sampling effects can
    take place.

Frankly, I think that PSP is just doing some form of averaging where all pixels from
the source 4x4 rectangle are giving equal contributions.  I *think* GDAL is doing what
I intended though it isn't a particularly good algorithm for downsampling ... especially
downsampling by more than 2x2.

Keep in mind that these resampling kernels are primarily intended for cases of
non-linear geometric transformations (ie. reprojection) where the output image is
appoximately the same resolution as the input.

I am interested in others input on typical meanings of bilinear resampling in
image processing.  However, I don't (so far) see any error in what GDAL's
algorithm is doing.  It just may be insufficient clear to call it only
bilinear resampling.

For the kind of downsampling you seem to want to do, I think the averaging is
the best approach.  Unfortunately, that is not currently offered by gdalwarp,
and because of the non-linear (in general) nature of the geometric
transformations in gdalwarp, it would be hard to implement "averaging"
appropriate.  It is however available in the overviewing building code and
as an option in the virtual file driver.  Perhaps I should have a convenient
way of downsampling images with averaging via a GDAL utility ... perhaps
gdal_translate or a custom algorithm.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

-------------- next part --------------
A non-text attachment was scrubbed...
Name: orig.png
Type: image/png
Size: 16371 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040317/5d0994a5/orig.png
-------------- next part --------------
A non-text attachment was scrubbed...
Name: psp.png
Type: image/png
Size: 3053 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040317/5d0994a5/psp.png
-------------- next part --------------
A non-text attachment was scrubbed...
Name: gdal.png
Type: image/png
Size: 3311 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040317/5d0994a5/gdal.png
From dron at ak4719.spb.edu  Wed Mar 17 02:46:06 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] new bug in FAST format
In-Reply-To: <HLENLPCAGDEHMNMNLIDJMEGECBAA.chen@yinyue123.com>
References: <200403161001.38980.schut@sarvision.com> <HLENLPCAGDEHMNMNLIDJMEGECBAA.chen@yinyue123.com>
Message-ID: <20040317074606.GA9489@ak4719.spb.edu>

On Tue, Mar 16, 2004 at 06:32:46PM +0800, Fu Chen wrote:
> I test one of my old program. But find GDAL120b has some problems in
> parsing the FAST format.
> 
> You can see in central_meridian false_easting are not correctly
> interpreted in 120b. What's change in the new version on the FAST
> format? 

Well, there was many changes in the FAST driver to support the wide
range of broken mind data distributors. I have found your problem and it
should be fixed in the CVS now.

					Thank you for report,
					Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From schut at sarvision.com  Wed Mar 17 02:56:41 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] vrt format and absolute/relative paths
In-Reply-To: <405749CE.5080803@pobox.com>
References: <200403160948.46470.schut@sarvision.com> <200403161001.38980.schut@sarvision.com> <405749CE.5080803@pobox.com>
Message-ID: <200403170856.41715.schut@sarvision.com>

Frank,

thank you very much for this elegant solution.

Regards,
Vincent Schut.

On Tuesday 16 March 2004 19:39, Frank Warmerdam wrote:
> Vincent Schut wrote:
> >>Is this behaviour intended?
> >>If not, if would greatly help me if it could be changed so that gdal
> >> always uses the home directory of the current vrt file to look for the
> >> vrt raster source files.
>
> Vincent,
>
> I have modified the VRT code in CVS so that it will check for a
> relativeToVRT attribute on the SourceFilename element.  If it is set to a
> non-zero value then the SourceFilename will be treated relative to the
> virtual file.   For example:
>
> <VRTDataset rasterXSize="512" rasterYSize="512">
>    <VRTRasterBand dataType="Byte" band="1">
>      <ColorInterp>Gray</ColorInterp>
>      <SimpleSource>
>        <SourceFilename relativeToVRT="1">utm.tif</SourceFilename>
>        <SourceBand>1</SourceBand>
>        <SrcRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>        <DstRect xOff="0" yOff="0" xSize="512" ySize="512"/>
>      </SimpleSource>
>    </VRTRasterBand>
> </VRTDataset>
>
> Currently CreateCopy() does not attempt to set this, and relativize the
> path though it might at some point in the future.
>
> In general, even when doing a gdal_translate the .vrt may be put somewhere
> completely unrelated to the actual files in which case it is hard to make
> the SourceFilename relative to the .vrt.  While it has some significant
> problems the code (for the time being) will just literally place whatever
> filename you give it for the the input file into the SourceFilename
> element.
>
> However, with a minor hand edit to your .vrt files you should now be able
> to use them as desired.
>
> Best regards,

-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From stanimura-ngs at umin.ac.jp  Wed Mar 17 05:45:05 2004
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Compliation error with 1.2.0 on Linux
In-Reply-To: <405569A0.9070900@pobox.com>
References: <20040313031233.17957.64049.Mailman@yoda.imagelinks.com>
	<20040313123531.43303131.stanimura-ngs@umin.ac.jp>
	<40528ED1.5010104@pobox.com>
	<20040314091046.5e12af4d.stanimura-ngs@umin.ac.jp>
	<405569A0.9070900@pobox.com>
Message-ID: <20040317194505.28a26461.stanimura-ngs@umin.ac.jp>

Hi Frank,

Thank you for your notes.  I succeeded the compilation after editing my
spec file form

%configure  \
	--with-libz=%{_includedir} \
	--with-png=%{_includedir} \
	--with-gif=%{_includedir} \
	--with-geotiff=internal \
	--with-jpeg=%{_includedir} \
	--with-libtiff=internal \
  --with-pymodir=/usr/lib/python2.1/site-packages

to

%configure --with-libz --with-png --with-gif --with-geotiff --with-jpeg --with-libtiff \
  --with-pymodir=/usr/lib/python2.1/site-packages

that was followed your advice.  Then I got new problem in installation
part, but I will try to overcome.  If it is not solved with my effort,
I would like to ask in the mail-list again.


From stanimura-ngs at umin.ac.jp  Wed Mar 17 08:39:37 2004
From: stanimura-ngs at umin.ac.jp (Susumu Tanimura)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem in RPM packaging
Message-ID: <20040317223937.36916cfb.stanimura-ngs@umin.ac.jp>

Hi, there.

I have a problem with spec file for gdal, especially at the install
part.  

In the spec file, I wrote

%setup -q
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' port/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' gcore/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' ogr/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' apps/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' alg/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' pymod/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' man/GNUmakefile
%{__perl} -p -i -e 's|\$\(INST_|\$\(DESTDIR\)\$\(INST_|' frmts/GNUmakefile

[snip]

%install
%{__make} install DESTDIR=$RPM_BUILD_ROOT

However, it resulted that

[snip]

+ make prefix=/var/tmp/gdal-1.2.0-root/usr
exec_prefix=/var/tmp/gdal-1.2.0-root/usr
bindir=/var/tmp/gdal-1.2.0-root/usr/bin
sbindir=/var/tmp/gdal-1.2.0-root/usr/sbin
sysconfdir=/var/tmp/gdal-1.2.0-root/etc
datadir=/var/tmp/gdal-1.2.0-root/usr/share
includedir=/var/tmp/gdal-1.2.0-root/usr/include
libdir=/var/tmp/gdal-1.2.0-root/usr/lib
libexecdir=/var/tmp/gdal-1.2.0-root/usr/libexec
localstatedir=/var/tmp/gdal-1.2.0-root/var/lib
sharedstatedir=/var/tmp/gdal-1.2.0-root/usr/share
mandir=/var/tmp/gdal-1.2.0-root/usr/share/man
infodir=/var/tmp/gdal-1.2.0-root/usr/info install
INST_PREFIX=/var/tmp/gdal-1.2.0-root
GNUmakefile:43: warning: overriding commands for target `libgdal.la'
GNUmakefile:39: warning: ignoring old commands for target `libgdal.la'
(cd port; make)
make[1]: Entering directory `/home/hoge/rpm/BUILD/gdal-1.2.0/port'
make[1]: Nothing to be done for `default'.
make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/port'
(cd gcore; make)

[snip]

(cd apps; make)
make[1]: Entering directory `/home/hoge/rpm/BUILD/gdal-1.2.0/apps'
make[1]: Nothing to be done for `default'.
make[1]: Leaving directory `/home/hoge/rpm/BUILD/gdal-1.2.0/apps'
./install-sh -d /usr/lib
for f in ./libgdal.la ; do /bin/sh ./libtool --mode=install ./install-sh -c $f /usr/lib ; done
./install-sh -c ./.libs/libgdal.1.2.0 /usr/lib/libgdal.1.2.0
cp: cannot create regular file `/usr/lib/#inst.14434#': Permission denied
make: *** [install-lib] Error 1
Bad exit status from /var/tmp/rpm-tmp.7004 (%install)

So, even though I set prefix as /var/tmp/gdal-1.2.0-root/usr, it was
ignored and used /usr.

Dose anyone give me some advice?  I found someone wrote gdal.spec at
http://cvs.pld.org.pl/SPECS/gdal.spec?rev=1.2 but I do not have those
patches.  Especially, %{name}-DESTDIR.patch seems to be essential one.

--
Susumu Tanimura








From spyke555 at yahoo.ca  Wed Mar 17 09:22:19 2004
From: spyke555 at yahoo.ca (Sandy Pyke)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <4057F2E7.4040200@pobox.com>
Message-ID: <008001c40c2b$41ca71d0$6f0aa8c0@sandy>

Hi Frank,

I've also noticed the same thing in my application. Here are a few
sample images:

http://halibut.aquilamsl.com/~spyke/resampling 

I resampled the images with both GraphicsMagik and GDALWarp. The GDAL
result shows breaks in many of the small features and even the loss of
some data entirely. The resulting map is usable, but not ideal.

In my case I am only making a correction to the map's aspect ratio going
from a source image size of 3200 x 1600 to a destination image size of
2640 x 1879 which means downsampling (82.5%) in one direction and
upsampling (117.4%) in the other. This is so I can adjust the pixels
from being square in lon / lat values to being square in meters, which
falls closer into what you expected GDALWarp to do as I understand. Even
so, I am seeing a loss of data. Best case, I loose a bit of data, worst
case the data get mis-interpreted (ie: solid lines become dashed lines).

I would also like to see some improvement in this re-sampling algorithm.
There are a few algorithm switches available in the GDALWarp command
line options, but the documentation mentions that only the bilinear
re-sampling is available. Is this still the case in 1.2.0?

Sandy Pyke

> -----Original Message-----
> From: gdal-dev-admin@remotesensing.org 
> [mailto:gdal-dev-admin@remotesensing.org] On Behalf Of Frank Warmerdam
> Sent: Wednesday, March 17, 2004 1:41 AM
> To: gdal-dev@remotesensing.org
> Subject: Re: [Gdal-dev] Resampling with gdalwarp
> 
> 
> Mario Beauchamp wrote:
> > I don't know much about resampling algorithms... all I know 
> is to use 
> > bilinear when you reduce and cubic when you enlarge. Is 
> that correct?
> 
> Mario,
> 
> I am not familiar with that rule of thumb.
> 
> > I simply used: gdalwarp -tr 120 120 -rb
> > There is no special arguments for PSP, we simply select 
> "Bilinear" in 
> > the resize image dialog. The exact algorithm used is not documented.
> > 
> > Also, the OSSIM bilinear resampling looks about the same as the PSP 
> > image. But it has some other problems so I chose not to include it.
> 
> I have done some quick tests but they aren't exactly 
> conclusive.  There are definate differences.
> 
> I am including attached to this 3 smallish pngs of a small 
> area of the image. I picked this small area because it has a 
> linear feature appiximately 1 pixel across and the PSP and 
> GDAL results are substantially different in this area. The 
> regions of the swatches are appoximately the same, but not 
> exactly by any means.  The original data is 4 times the 
> resolution (in each direction) of the downsampled data.  I 
> ensured they all use the same simple linear stretch to 
> visualize the data, and I only show band 1 to simplify the situation.
> 
> The main thing to note is that the PSP downsampled image 
> essentially preserves the thin linear features, especially 
> the thin nearly horizonal road.  The GDAL image however 
> "butchers" the road.  It is as if the road drops right out 
> every couple of pixels, and then comes back a couple pixels 
> later.  That effect is not seen in the PSP version.
> 
> Now while the GDAL result is unappealing, I would claim it is 
> doing what I would expect my concept of a 2x2 bilinear 
> resampling kernel should do in a 4x4 downsampling case.  In 
> the GDAL version, each output pixel is computed from a 2x2 
> neighbour of the input image but it is essentially 
> representing a 4x4 area of the input.  Very thin linear 
> features, such as a 1 pixel wide road will often be 
> completely missed by the 2x2 kernel, while at other times if 
> if the sample point falls dead on the line it make come 
> through at full brightness.
> 
> The PSP version is preserving the line well, though damped 
> down substantially as it is mixed with other non-road pixels.
> 
> I don't know what the formal definition of "bilinear 
> resampling" is.  I suspect that name can apply to a variety 
> of techniques.  Let me explain what GDAL does.
> 
> 1) It takes the center point of the output pixel, and 
> geometrically transforms it
>     to a location on the input pixel (with subpixel resolution).
> 
> 2) The four pixels closest to the input sampling location are 
> used in the kernel,
>     and the proximity of the sampling location to the center 
> of each input pixel
>     determines it's contribution in a bilinear fashion.
> 
> Some implications to note:
>   o Regardless of what amount of downsampling (or upsampling 
> for that matter) is being
>     done, each output pixel is determined from only 4 pixels.
>   o If the transformed sampling point happens to fall very 
> close to the center of an
>     input pixel, then the other 3 input pixels in the kernel 
> will have virtually no
>     contribution. This means, depending on the vagarities of 
> the resampling some output
>     pixels may be dominated by one or two input pixels while 
> others are a mix of all
>     four.
>   o In cases of integer decimation factors (such as exact 4x4 
> downsampling of images
>     that have a size that is a multiple of 4x4) the sampling 
> location should fall
>     in the center of the 4x4 input block and so the center 
> 2x2 pixels would make
>     a contribution.  If there are rounding or other slight 
> variations making the
>     downsampling not exactly 4x4 to 1 then various kinds of 
> odd sampling effects can
>     take place.
> 
> Frankly, I think that PSP is just doing some form of 
> averaging where all pixels from the source 4x4 rectangle are 
> giving equal contributions.  I *think* GDAL is doing what I 
> intended though it isn't a particularly good algorithm for 
> downsampling ... especially downsampling by more than 2x2.
> 
> Keep in mind that these resampling kernels are primarily 
> intended for cases of non-linear geometric transformations 
> (ie. reprojection) where the output image is appoximately the 
> same resolution as the input.
> 
> I am interested in others input on typical meanings of 
> bilinear resampling in image processing.  However, I don't 
> (so far) see any error in what GDAL's algorithm is doing.  It 
> just may be insufficient clear to call it only bilinear resampling.
> 
> For the kind of downsampling you seem to want to do, I think 
> the averaging is the best approach.  Unfortunately, that is 
> not currently offered by gdalwarp, and because of the 
> non-linear (in general) nature of the geometric 
> transformations in gdalwarp, it would be hard to implement 
> "averaging" appropriate.  It is however available in the 
> overviewing building code and as an option in the virtual 
> file driver.  Perhaps I should have a convenient way of 
> downsampling images with averaging via a GDAL utility ... 
> perhaps gdal_translate or a custom algorithm.
> 
> Best regards,
> -- 
> ---------------------------------------+----------------------
> ----------
> ---------------------------------------+------
> I set the clouds in motion - turn up   | Frank Warmerdam, 
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial 
> Programmer for Rent
> 
> 
> ---
> Incoming mail is certified Virus Free.
> Checked by AVG anti-virus system (http://www.grisoft.com).
> Version: 6.0.596 / Virus Database: 379 - Release Date: 2/26/2004
>  
>       
> 

---
Outgoing mail is certified Virus Free.
Checked by AVG anti-virus system (http://www.grisoft.com).
Version: 6.0.596 / Virus Database: 379 - Release Date: 2/26/2004
 


From warmerdam at pobox.com  Wed Mar 17 11:04:02 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem in RPM packaging
In-Reply-To: <20040317223937.36916cfb.stanimura-ngs@umin.ac.jp>
References: <20040317223937.36916cfb.stanimura-ngs@umin.ac.jp>
Message-ID: <405876F2.20403@pobox.com>

Susumu Tanimura wrote:
> Hi, there.
> 
> I have a problem with spec file for gdal, especially at the install
> part.  

Susumu,

I am afraid I have no advice on spec files.  Usually Silke from Intevation
preps the spec files, but more on the schedule of freegis CD releases than
GDAL releases.  I just wanted you to know not to expect a useful answer from
me.  Someone else might have advice.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From ldjohn at usgs.gov  Wed Mar 17 12:06:44 2004
From: ldjohn at usgs.gov (Lowell Johnson)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <4057F2E7.4040200@pobox.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com> <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com> <4057F2E7.4040200@pobox.com>
Message-ID: <200403171106.44004.ldjohn@usgs.gov>

On Wednesday 17 March 2004 12:40 am, Frank Warmerdam wrote:
[snip]
> I don't know what the formal definition of "bilinear resampling" is. 
> I suspect that name can apply to a variety of techniques.  Let me
> explain what GDAL does.
>
> 1) It takes the center point of the output pixel, and geometrically
> transforms it to a location on the input pixel (with subpixel
> resolution).
>
> 2) The four pixels closest to the input sampling location are used in
> the kernel, and the proximity of the sampling location to the center
> of each input pixel determines it's contribution in a bilinear
> fashion.

Yes, this sounds like the definition of bilinear resampling that I'm 
familiar with.  Here's a quick illustration (use fixed fonts to get 
ASCII image to display properly):

  o     = projection input location of output pixel center
  d1-d4 = 4 input pixel DN values
  px,py = input pixel dimensions
  dx,dy = line, sample offset of 'o' from first pixel center
  DN    = bilinear resampled DN for 'o'

                           |  px   |
                         dx| |     |
                       +-------+-------+
                       |   d1  |   d2  |   2x2 input space pixels
                  -----|   +   |   +   |
                   dy--|     o |       |
                  py   +-------+-------+
                       |   d3  |   d4  |
                  -----|   +   |   +   |
                       |       |       |
                       +-------+-------+

  Let u = dx/px, v = dy/py.

  DN = d1*(1 - u)*(1 - v) + d2*u*(1 - v) + d3*(1 - u)*v + d4*u*v

> Some implications to note:
[snip remainder]

I agree with Frank's comments regarding the (mis)use of bilinear 
resampling for downsampling, at least by my definition of "bilinear 
resampling". :)  Some sort of averaging does sound like a better method 
although I haven't much experience with image scaling issues.

    Lowell


From support at geoimage.fr  Wed Mar 17 12:18:38 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem with external tiff/geotiff.
Message-ID: <01b301c40c43$e388ec00$e32346c0@pili>

Hello,

I use GDAL on Win32.
GDAL is configured to use external Tiff and GEOtiff libraries ( V3.6.0 and V1.2.1 ).

Everything works fine execpting that  I have a crash in  gt_wkt_srs.cpp.

the problem is the following :

------------------------------------------------------------------------------------------------------
    in char *GTIFGetOGISDefn( GTIFDefn * psDefn )

    ...

    if( psDefn->SemiMajor == 0.0 )
    {
        pszSpheroidName = CPLStrdup("unretrievable - using WGS84");
        dfSemiMajor = SRS_WGS84_SEMIMAJOR;
        dfInvFlattening = SRS_WGS84_INVFLATTENING;
    }
    ...

    GTIFFreeMemory( pszPMName );
    GTIFFreeMemory( pszSpheroidName );
    GTIFFreeMemory( pszAngularUnits );

------------------------------------------------------------------------------------------------------

pszSpheroidName is allocated with CPLStrdup ( based on VSIStrdup based on strdup )
then liberated using  GTIFFreeMemory based on the libTIFF allocator which use on windows,
functions like GlobalAlloc, GlobalFree... (in tif_win32.c).

It looks like strdup isn't based on the same allocator.
I can replace the GTIFFreeMemory( pszSpheroidName ) call manually but perhaps there are other
similar problems in Gtiff stuff, and it is not very easy to check everything.

What is your opinion about that ?

Are there other users with the same config (external tiff and geotiff on win32) with the
same problems ?

Thanks in advance,
Fr?d?ric.

_______________________________________________________________
Fr?d?ric Trastour - SpacEyes - dev@spaceyes.fr



From nhv at cape.com  Wed Mar 17 12:28:38 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem with external tiff/geotiff.
In-Reply-To: <01b301c40c43$e388ec00$e32346c0@pili>
Message-ID: <EKEJIKAILPONGGENMBGAIEJOGMAA.nhv@cape.com>

Fr?d?ric Trastour writes:
>
> I use GDAL on Win32.
> GDAL is configured to use external Tiff and GEOtiff libraries ( V3.6.0 and V1.2.1 ).
>
> Everything works fine execpting that  I have a crash in  gt_wkt_srs.cpp.

I *strongly* reccomend using the internal tiff and geotiff libraries

Cheers

Norman



From dron at ak4719.spb.edu  Wed Mar 17 13:02:29 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem with external tiff/geotiff.
In-Reply-To: <01b301c40c43$e388ec00$e32346c0@pili>
References: <01b301c40c43$e388ec00$e32346c0@pili>
Message-ID: <20040317180229.GA16141@ak4719.spb.edu>

On Wed, Mar 17, 2004 at 06:18:38PM +0100, Fr?d?ric Trastour wrote:
> GDAL is configured to use external Tiff and GEOtiff libraries ( V3.6.0
> and V1.2.1 ).
> 
> Everything works fine execpting that  I have a crash in
> gt_wkt_srs.cpp.
> 
> the problem is the following :
...
> pszSpheroidName is allocated with CPLStrdup ( based on VSIStrdup based
> on strdup ) then liberated using  GTIFFreeMemory based on the libTIFF
> allocator which use on windows, functions like GlobalAlloc,
> GlobalFree... (in tif_win32.c).

It looks like a bug. Please, try the following patch against the
gt_wkt_srs.cpp:

--- gt_wkt_srs.cpp.bak	2004-03-17 20:55:42.000000000 +0300
+++ gt_wkt_srs.cpp	2004-03-17 20:58:25.000000000 +0300
@@ -165,9 +165,9 @@
  *
  */
 
-#include "cpl_port.h"
-#include "cpl_csv.h"
-#define CPL_SERV_H_INCLUDED
+#include "cpl_serv.h"
+#include "geo_tiffp.h"
+#define _CPL_ERROR_H_INCLUDED_
 
 #include "geo_normalize.h"
 #include "geovalues.h"


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From m.massing at warped-space.de  Wed Mar 17 14:10:55 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <200403171106.44004.ldjohn@usgs.gov>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com> <4057F2E7.4040200@pobox.com> <200403171106.44004.ldjohn@usgs.gov>
Message-ID: <200403172010.55399.m.massing@warped-space.de>

Hi,

> I agree with Frank's comments regarding the (mis)use of bilinear
> resampling for downsampling, at least by my definition of "bilinear
> resampling". :)  Some sort of averaging does sound like a better method
> although I haven't much experience with image scaling issues.

To my knowledge, in cases where great scalability is required (texture
mapping), both downsampling and bilinear resampling are combined by
"mipmapping filtering". In this approach, a mip-map level (in essence the
level of a factor 2 image pyramid) is choosen according to the reprojected
pixel footprint (i.e. the projected area of the destination pixel onto the 
source dataset), which is then used for the bilinear interpolation. This
works well for isotropic downsampling, as the source footprint is approximated
by a square. Trilinear filtering additionally interpolates bilinear samples
between the two nearest MIP-map levels. Anisotropic cases are normally 
handled by taking multiple (usually trilinear) samples along the axis of
anisotropy ...

Given the fact that most modern GPUs implement these resampling features
in hardware, it might be worthwhile to add e.g. OpenGL texture mapping as a
resampling mechanism - this could, depending on the underlying hardware, yield
a high performance & high quality resampling implementation - though probably 
with some constraints regarding component resolution.

bye,

	Manuel

From alexamici at fastwebnet.it  Wed Mar 17 14:54:56 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem in RPM packaging
In-Reply-To: <20040317223937.36916cfb.stanimura-ngs@umin.ac.jp>
References: <20040317223937.36916cfb.stanimura-ngs@umin.ac.jp>
Message-ID: <200403172054.56978.alexamici@fastwebnet.it>

Susumu,

On Wednesday 17 March 2004 14:39, Susumu Tanimura wrote:
> I have a problem with spec file for gdal, especially at the install
> part.

i have no experience on building an rpm package (no idea on what a spec file 
is), but i did quite some work for the deb package.

> + make prefix=/var/tmp/gdal-1.2.0-root/usr

this looks like almost the right command line to me. you only need to add an 
INST_PYMOD variable.

the debian/rules file uses:
	make install prefix=$USR_TMPDIR INST_PYMOD=$PYTHON_TMPDIR

that should be sufficient.

> ./install-sh -d /usr/lib
> for f in ./libgdal.la ; do /bin/sh ./libtool --mode=install ./install-sh -c
> $f /usr/lib ; done ./install-sh -c ./.libs/libgdal.1.2.0
> /usr/lib/libgdal.1.2.0
> cp: cannot create regular file `/usr/lib/#inst.14434#': Permission denied
> make: *** [install-lib] Error 1
> Bad exit status from /var/tmp/rpm-tmp.7004 (%install)
>
> So, even though I set prefix as /var/tmp/gdal-1.2.0-root/usr, it was
> ignored and used /usr.

i don't understand. this works using 'make prefix=$USR_TMPSRC' from the 
command line. are you sure that the rpm build tool uses the right make 
command line?

cheers,
alessandro

From starged at videotron.ca  Wed Mar 17 15:09:26 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling algorithms
Message-ID: <egbh50prv7udg01bar7qrr62dpmos6a4vo@4ax.com>

Hi,

I researched the subject a bit and I came up with some interesting links:

The OSSIM resampling algs are based on ImageMagick http://imagemagick.sourceforge.net/

More on resizing is found there: http://www.imagemagick.org/www/api/resize.html

Like they say, it's based on Paul Heckbert's zoom program:
http://www.xmission.com/~legalize/zoom.html

And it's true what is mentionned here: http://www.imagemagick.org/www/api/types.html#FilterTypes
that Lanczos provides the best results (even better than CC when upsampling) as I found out myself
testing it in OSSIM.

Hope this helps a bit.
--
Mario B.
My Landsat images:
http://pages.infinit.net/starged/landsat/home.html

From starged at videotron.ca  Wed Mar 17 23:06:47 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <4057F2E7.4040200@pobox.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>
 <405794A3.8040008@pobox.com> <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com>
 <4057F2E7.4040200@pobox.com>
Message-ID: <925i50lt194076v1bmgr625g4mmhho5595@4ax.com>

Hi Frank,

On Wed, 17 Mar 2004 01:40:39 -0500, Frank Warmerdam <warmerdam@pobox.com> wrote:

>> ... all I know is to use bilinear when you reduce and cubic when you enlarge. Is that correct?
>
>I am not familiar with that rule of thumb.

It comes from PSP help. Seems to work.

>The main thing to note is that the PSP downsampled image essentially preserves
>the thin linear features, especially the thin nearly horizonal road.  The GDAL
>image however "butchers" the road.  It is as if the road drops right out every
>couple of pixels, and then comes back a couple pixels later.  That effect is not
>seen in the PSP version.

Before GDAL, I used to reduce my images by 25% in PSP and then georeference them using the geotiffcp
utility. When I started using gdalwarp to resize my images and compared them to the ones previously
done with PSP, that "butchered" roads effect struck me. 

>Keep in mind that these resampling kernels are primarily intended for cases of
>non-linear geometric transformations (ie. reprojection) where the output image is
>appoximately the same resolution as the input.

It's true that they work well for reprojecting. I was impressed too by the Cubic Spline. Not sure
exactly which one to use in what circumstances but it's for me to find out...

I noticed that "problem" a few weeks ago and I didn't want to bother anyone with that while the GDAL
1.2.0 was about to be released. Now that you tell me it was not intended for resizing, I understand
better why I wasn't getting the expected results. 
 
>I am interested in others input on typical meanings of bilinear resampling in
>image processing.  However, I don't (so far) see any error in what GDAL's
>algorithm is doing.  It just may be insufficient clear to call it only
>bilinear resampling.

It may be just another example of confusing terminology (ImageMagick calls it "Triangle", for
instance). I myself have difficulties with some terms used on this list sometimes :)

>For the kind of downsampling you seem to want to do, I think the averaging is
>the best approach.  Unfortunately, that is not currently offered by gdalwarp,
>and because of the non-linear (in general) nature of the geometric
>transformations in gdalwarp, it would be hard to implement "averaging"
>appropriate.  It is however available in the overviewing building code and
>as an option in the virtual file driver.  Perhaps I should have a convenient
>way of downsampling images with averaging via a GDAL utility ... perhaps
>gdal_translate or a custom algorithm.

I was aware of the overviews approach however, most of my Landsat images are on CDs so I chose to
keep a 1/4 res copy of all images on disk instead of building overviews. But when you mentioned it,
I built overviews with gdaladdo -r average 4 and indeed, the resulting 1/4 res image looks much
better. But I didn't find how I could put the overview in another file... if for example, I want to
build overviews for all images on CDs and put the overview images on hard disk.

But don't lose any sleep on that, it's not that important. And maybe I can try to figure it all out
by myself and learn the GDAL API at the same time...

Thanks for your explanations.
--
Mario B.
My Landsat images:
http://pages.infinit.net/starged/landsat/home.html

From dron at ak4719.spb.edu  Thu Mar 18 03:23:52 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <925i50lt194076v1bmgr625g4mmhho5595@4ax.com>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com> <405794A3.8040008@pobox.com> <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com> <4057F2E7.4040200@pobox.com> <925i50lt194076v1bmgr625g4mmhho5595@4ax.com>
Message-ID: <20040318082352.GA15245@ak4719.spb.edu>

On Wed, Mar 17, 2004 at 11:06:47PM -0500, Mario Beauchamp wrote:
> It's true that they work well for reprojecting. I was impressed too by
> the Cubic Spline. Not sure exactly which one to use in what
> circumstances but it's for me to find out...

I have attached several images to clarify a bit GDAL interpolation
methods. Cubic B-spline in fact implements approximation, it has
advantages over other methods on high upsampling rates.


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bilinear.tif
Type: image/tiff
Size: 16706 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/bilinear.tif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cubic.tif
Type: image/tiff
Size: 16706 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/cubic.tif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: interpolations.png
Type: image/png
Size: 10921 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/interpolations.png
-------------- next part --------------
A non-text attachment was scrubbed...
Name: nearest.tif
Type: image/tiff
Size: 16706 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/nearest.tif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: orig.tif
Type: image/tiff
Size: 736 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/orig.tif
-------------- next part --------------
A non-text attachment was scrubbed...
Name: spline.tif
Type: image/tiff
Size: 16706 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040318/ed14debc/spline.tif
From support at geoimage.fr  Thu Mar 18 04:41:07 2004
From: support at geoimage.fr (=?iso-8859-1?Q?Fr=E9d=E9ric_Trastour?=)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem with external tiff/geotiff.
References: <01b301c40c43$e388ec00$e32346c0@pili> <20040317180229.GA16141@ak4719.spb.edu>
Message-ID: <023701c40ccd$23ba56e0$e32346c0@pili>

Hello,

thanks a lot, this works fine now !

Fr?d?ric.

----- Original Message ----- 
From: "Andrey Kiselev" <dron@ak4719.spb.edu>
To: <gdal-dev@remotesensing.org>
Sent: Wednesday, March 17, 2004 7:02 PM
Subject: Re: [Gdal-dev] Problem with external tiff/geotiff.


> On Wed, Mar 17, 2004 at 06:18:38PM +0100, Fr?d?ric Trastour wrote:
> > GDAL is configured to use external Tiff and GEOtiff libraries ( V3.6.0
> > and V1.2.1 ).
> >
> > Everything works fine execpting that  I have a crash in
> > gt_wkt_srs.cpp.
> >
> > the problem is the following :
> ...
> > pszSpheroidName is allocated with CPLStrdup ( based on VSIStrdup based
> > on strdup ) then liberated using  GTIFFreeMemory based on the libTIFF
> > allocator which use on windows, functions like GlobalAlloc,
> > GlobalFree... (in tif_win32.c).
>
> It looks like a bug. Please, try the following patch against the
> gt_wkt_srs.cpp:
>
> --- gt_wkt_srs.cpp.bak 2004-03-17 20:55:42.000000000 +0300
> +++ gt_wkt_srs.cpp 2004-03-17 20:58:25.000000000 +0300
> @@ -165,9 +165,9 @@
>   *
>   */
>
> -#include "cpl_port.h"
> -#include "cpl_csv.h"
> -#define CPL_SERV_H_INCLUDED
> +#include "cpl_serv.h"
> +#include "geo_tiffp.h"
> +#define _CPL_ERROR_H_INCLUDED_
>
>  #include "geo_normalize.h"
>  #include "geovalues.h"
>
>
> -- 
> Andrey V. Kiselev
> Home phone:  +7 812 5274898  ICQ# 26871517
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@remotesensing.org
> http://remotesensing.org/mailman/listinfo/gdal-dev



From dron at ak4719.spb.edu  Thu Mar 18 04:58:25 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Problem with external tiff/geotiff.
In-Reply-To: <023701c40ccd$23ba56e0$e32346c0@pili>
References: <01b301c40c43$e388ec00$e32346c0@pili> <20040317180229.GA16141@ak4719.spb.edu> <023701c40ccd$23ba56e0$e32346c0@pili>
Message-ID: <20040318095825.GA26980@ak4719.spb.edu>

On Thu, Mar 18, 2004 at 10:41:07AM +0100, Fr?d?ric Trastour wrote:
> thanks a lot, this works fine now !

Ok, now applied in CVS.


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From neteler at itc.it  Thu Mar 18 09:41:05 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
Message-ID: <20040318144105.GS4135@thuille.itc.it>

Hi,

merging 398 ArcBinaryGrids with 'gdal_merge.py'
(GDAL 1.2 from CVS, python 2.2,  --with-libtiff=internal,
 --with-geotiff=internal, Redhat 9)
into a big GeoTIFF file went ok without problems.

But, then, I got some troubles (never seen before):

A) Importing this big file into GRASS:

GRASS:~ > r.in.gdal /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif out=lom
ERROR 1: /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif:0: Invalid strip byte count, strip 7500
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 7500
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 7500
ERROR 1: /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif:0: Invalid strip byte count, strip 7501
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 7501
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 7501
ERROR 1: /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif:0: Invalid strip byte count, strip 7502
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 7502
[...]
ERROR 1: IReadBlock failed at X offset 0, Y offset 8748
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 8748
ERROR 1: /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif:0: Invalid strip byte count, strip 8749
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 8749
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 8749
 100%
CREATING SUPPORT FILES FOR lom

B) Simply trying to use GDAL itself:

gdal_translate /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif lom.tif
Input file size is 9200, 11250
0...10...20...30...40...50...60..ERROR 1: /nfsmnt/levi0/ssi/neteler/lombardia_dem20.tif:0: Invalid strip byte count, strip 7500
ERROR 1: TIFFReadEncodedStrip() failed.

ERROR 1: IReadBlock failed at X offset 0, Y offset 7500
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 7500

I have no clue what's wrong. File size: 380MB.

Looks a bit like this:
http://bugzilla.remotesensing.org/show_bug.cgi?id=329

Question: Is the created file corrupted or is there a problem
reading it? Any help is welcome.

Best regards
 Markus Neteler


From warmerdam at pobox.com  Thu Mar 18 10:59:38 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <20040318144105.GS4135@thuille.itc.it>
References: <20040318144105.GS4135@thuille.itc.it>
Message-ID: <4059C76A.8080401@pobox.com>

Markus Neteler wrote:
> Looks a bit like this:
> http://bugzilla.remotesensing.org/show_bug.cgi?id=329
> 
> Question: Is the created file corrupted or is there a problem
> reading it? Any help is welcome.

Markus,

I'm not too sure what is going on, though presumably the file is corrupt or
at least incomplete.  I have asked Andrey to review bug 329.  Could you
do a "tiffinfo" and "tiffdump -m 10000" on your file?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From m.massing at warped-space.de  Thu Mar 18 11:23:14 2004
From: m.massing at warped-space.de (Manuel Massing)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <20040318144105.GS4135@thuille.itc.it>
References: <20040318144105.GS4135@thuille.itc.it>
Message-ID: <200403181723.14331.m.massing@warped-space.de>

Hello Markus,

I had the same problem when creating a TIFF file and
merging datasets which did not cover the entire domain. The problem 
seems to stem from uninitialised sections of the output file,
so a workaround is to first initialise the whole dataset with e.g. 
nodata or zero values, and then proceed with merging.

I am not sure if this occurs only with tiled datasets, but it might
be an index initialisation bug of some sort? 

regards,

	Manuel

From neteler at itc.it  Thu Mar 18 12:11:30 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <200403181723.14331.m.massing@warped-space.de>
References: <20040318144105.GS4135@thuille.itc.it> <200403181723.14331.m.massing@warped-space.de>
Message-ID: <20040318171130.GA1165@thuille.itc.it>

Hello Manuel,

On Thu, Mar 18, 2004 at 05:23:14PM +0100, Manuel Massing wrote:
> Hello Markus,
> 
> I had the same problem when creating a TIFF file and
> merging datasets which did not cover the entire domain. The problem 
> seems to stem from uninitialised sections of the output file,
> so a workaround is to first initialise the whole dataset with e.g. 
> nodata or zero values, and then proceed with merging.
> 
> I am not sure if this occurs only with tiled datasets, but it might
> be an index initialisation bug of some sort? 

In fact there are no data areas in the final mosaic as the
tiles do not cover the entire region. So maybe the problem
is as you describe (unfortunately I have no idea how to change
gdal_merge.py to first initialise the whole dataset).

Regards,

 Markus


From warmerdam at pobox.com  Thu Mar 18 12:39:36 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <20040318171130.GA1165@thuille.itc.it>
References: <20040318144105.GS4135@thuille.itc.it> <200403181723.14331.m.massing@warped-space.de> <20040318171130.GA1165@thuille.itc.it>
Message-ID: <4059DED8.9030004@pobox.com>

Markus Neteler wrote:
> Hello Manuel,
> 
> On Thu, Mar 18, 2004 at 05:23:14PM +0100, Manuel Massing wrote:
> 
>>Hello Markus,
>>
>>I had the same problem when creating a TIFF file and
>>merging datasets which did not cover the entire domain. The problem 
>>seems to stem from uninitialised sections of the output file,
>>so a workaround is to first initialise the whole dataset with e.g. 
>>nodata or zero values, and then proceed with merging.
>>
>>I am not sure if this occurs only with tiled datasets, but it might
>>be an index initialisation bug of some sort? 
> 
> 
> In fact there are no data areas in the final mosaic as the
> tiles do not cover the entire region. So maybe the problem
> is as you describe (unfortunately I have no idea how to change
> gdal_merge.py to first initialise the whole dataset).

Markus,

It had been my intention that GDAL would gracefully handle strips or
tiles that have an offset and size of zero as "auto-nodata".  Apparently
I did not complete that properly.   I will look into this.  Currently
preinitializing to zero should resolve the problem but I realize that is
not so easy to do.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From robert at openscenegraph.com  Thu Mar 18 16:44:29 2004
From: robert at openscenegraph.com (Robert Osfield)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Scaling of heights in gdaladdo
Message-ID: <200403182144.29649.robert@openscenegraph.com>

Hi All,

I have been testing out my 3D database generation codes on some sample 
datasets and have found a few issues with generation of/and using overviews.  
The problem can be seen when looking at the min max values before and after 
running gdaladdo.  For the test below the min/max values start of as 0 and 
43929.00 and end up being 0 and 18039 respectively.  I would expect a certain 
amount rounding, but not reduction by 2.4 times.

The test dataset ps_height_4k.png from the Puget Sound dataset  

	http://www.cc.gatech.edu/projects/large_models/ps.html

The tests were done with CVS version of gdal, just ater the 1.2 release.

The steps I took are first to convert ps_height_4k.png to a tif to allow 
overviews to be generated:

	> gdal_translate ps_height_4k.png ps_height_4k.tif

Then check the min max:

	> gdalinfo ps_height_4k.tif -mm
	Driver: GTiff/GeoTIFF
	Size is 4097, 4097
	Coordinate System is `'
	Corner Coordinates:
	Upper Left  (    0.0,    0.0)
	Lower Left  (    0.0, 4097.0)
	Upper Right ( 4097.0,    0.0)
	Lower Right ( 4097.0, 4097.0)
	Center      ( 2048.5, 2048.5)
	Band 1 Block=4097x1 Type=UInt16, ColorInterp=Gray
	    Computed Min/Max=0.000,43929.000

Then generate the a single overview

	> gdaladdo -r average ps_height_4k.tif 2

Then check the min max once more:

	> gdalinfo ps_height_4k.tif -mm

	Driver: GTiff/GeoTIFF
	Size is 4097, 4097
	Coordinate System is `'
	Corner Coordinates:
	Upper Left  (    0.0,    0.0)
	Lower Left  (    0.0, 4097.0)
	Upper Right ( 4097.0,    0.0)
	Lower Right ( 4097.0, 4097.0)
	Center      ( 2048.5, 2048.5)
	Band 1 Block=4097x1 Type=UInt16, ColorInterp=Gray
	    Computed Min/Max=0.000,18039.000
	  Overviews: 2049x2049

Is this a bug, feature, something I've done wrong at my end?

Thanks for any help you can provide,
Robert.



From sy at perkins.net  Thu Mar 18 19:10:23 2004
From: sy at perkins.net (Simon Perkins)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <4059DED8.9030004@pobox.com>
References: <20040318144105.GS4135@thuille.itc.it>
	 <200403181723.14331.m.massing@warped-space.de>
	 <20040318171130.GA1165@thuille.itc.it>  <4059DED8.9030004@pobox.com>
Message-ID: <1079655023.9341.31.camel@afreet.lanl.gov>

On Thu, 2004-03-18 at 10:39, Frank Warmerdam wrote:

> It had been my intention that GDAL would gracefully handle strips or
> tiles that have an offset and size of zero as "auto-nodata".  Apparently
> I did not complete that properly.   I will look into this.  Currently
> preinitializing to zero should resolve the problem but I realize that is
> not so easy to do.

I've only just joined this discussion so I might have missed something,
but the GDAL C API does contain a GDALFillRaster() function which allows
you to fill a band with a particular constant value. There's a
corresponding GDALRasterBand::Fill() C++ method as well.

I don't know if there are any python bindings for this function though
if that's what you need..

Cheers,

Sy



From warmerdam at pobox.com  Fri Mar 19 01:36:14 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Scaling of heights in gdaladdo
In-Reply-To: <200403182144.29649.robert@openscenegraph.com>
References: <200403182144.29649.robert@openscenegraph.com>
Message-ID: <405A94DE.9090900@pobox.com>

Robert Osfield wrote:
> Hi All,
> 
> I have been testing out my 3D database generation codes on some sample 
> datasets and have found a few issues with generation of/and using overviews.  
> The problem can be seen when looking at the min max values before and after 
> running gdaladdo.  For the test below the min/max values start of as 0 and 
> 43929.00 and end up being 0 and 18039 respectively.  I would expect a certain 
> amount rounding, but not reduction by 2.4 times.

Robert,

I have reproduced your problem.  The reason is that the "-mm" switch for
gdalinfo invokes GDALComputeRasterMinMax() and passes the "bApproxOK" flag
in as TRUE.  When bApproxOK is true, only a subset of file blocks are read
to compute the min and max.

As it happens, GDAL normally creates overviews as tile files (128x128 tiles)
and it just so happens that the set of blocks uses for computing the min/max
happens to not include any of the few extreme peaks in your data that
go above 18039.

Since "-mm" is not the default reporting option in gdalinfo, I have changed
it to force an exact computation of the min/max. But beware.  Some applications
may use GDALComputeRasterMinMax() with bApproxOK=TRUE to get scaling values.
This can result in significant errors as is the case with your dataset.

PS. you can generate overviews for .png files, but they are stored in an
external .ovr file (which is really a GeoTIFF file).

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From robert at openscenegraph.com  Fri Mar 19 10:59:32 2004
From: robert at openscenegraph.com (Robert Osfield)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Scaling of heights in gdaladdo
In-Reply-To: <405A94DE.9090900@pobox.com>
References: <200403182144.29649.robert@openscenegraph.com> <405A94DE.9090900@pobox.com>
Message-ID: <200403191559.33016.robert@openscenegraph.com>

Hi Frank,

On Friday 19 March 2004 06:36, Frank Warmerdam wrote:
> Since "-mm" is not the default reporting option in gdalinfo, I have changed
> it to force an exact computation of the min/max. But beware.  Some
> applications may use GDALComputeRasterMinMax() with bApproxOK=TRUE to get
> scaling values. This can result in significant errors as is the case with
> your dataset.

Thanks for this change, it certainly has solved the problem I was seeing :-)

Cheers,
Robert.


From doug at jdgis.com  Fri Mar 19 13:48:00 2004
From: doug at jdgis.com (J Douglas Gough)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] PNG Heightfield
Message-ID: <007d01c40de2$b4c0f110$6401a8c0@dougpc>

I would like to create a heightfield from an ArcInfo grid.  So far, I have successfully converted an elevation grid to a 16 bit grayscale PNG using gdal_translate.  I can see the difference in brightness correleates to height, but I'm stuck here.  I'm thinking I'll need to create a pallette and lookup table so there are 65,536 possible values.  That should give me plenty of room to account for -5000 to +5000 meters or some other range that covers the min/max elevation in meters for any given point.  Just looking for some tips or examples.  

Thanks,

Doug.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040319/f43998a3/attachment.html
From shadow at dementia.org  Fri Mar 19 19:02:10 2004
From: shadow at dementia.org (Derrick J Brashear)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] GDALmake.opt.in patch and explanation
Message-ID: <Pine.GSO.4.58-035.0403191857590.6180@johnstown.andrew.cmu.edu>

I need the following patch on MacOS in order to insure that gdal gets its
own headers and not headers from elsewhere on the system needed for
dependancies; I need to build with external tiff/geotiff in order that
linker reordering not give me problems with mismatched interfaces (Xastir
uses libtiff and libgeotiff directly, as well as using GDAL for vector
stuff, only, at the moment) and doing so causes conflicts this patch is
needed to correct.

--- GDALmake.opt.in.orig        Fri Mar 19 18:47:48 2004
+++ GDALmake.opt.in     Fri Mar 19 18:50:20 2004
@@ -79,8 +79,8 @@
 endif

 CPPFLAGS       = @CPPFLAGS@ -I$(GDAL_ROOT)/port
-CFLAGS         = @C_WFLAGS@ @C_PIC@ $(C_ODFLAGS) @EXTRA_INCLUDES@ $(USER_DEFS)
-CXXFLAGS       = @CXX_WFLAGS@ @CXX_PIC@ $(CXX_ODFLAGS) \
+CFLAGS         = @C_WFLAGS@ @C_PIC@ $(GDAL_INCLUDE) $(C_ODFLAGS) @EXTRA_INCLUDES@ $(USER_DEFS)
+CXXFLAGS       = @CXX_WFLAGS@ @CXX_PIC@ $(GDAL_INCLUDE) $(CXX_ODFLAGS) \
                  @EXTRA_INCLUDES@ $(USER_DEFS)

 RANLIB         =       @RANLIB@


From warmerdam at pobox.com  Fri Mar 19 21:25:48 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] GDALmake.opt.in patch and explanation
In-Reply-To: <Pine.GSO.4.58-035.0403191857590.6180@johnstown.andrew.cmu.edu>
References: <Pine.GSO.4.58-035.0403191857590.6180@johnstown.andrew.cmu.edu>
Message-ID: <405BABAC.3050804@pobox.com>

Derrick J Brashear wrote:
> I need the following patch on MacOS in order to insure that gdal gets its
> own headers and not headers from elsewhere on the system needed for
> dependancies; I need to build with external tiff/geotiff in order that
> linker reordering not give me problems with mismatched interfaces (Xastir
> uses libtiff and libgeotiff directly, as well as using GDAL for vector
> stuff, only, at the moment) and doing so causes conflicts this patch is
> needed to correct.
> 
> --- GDALmake.opt.in.orig        Fri Mar 19 18:47:48 2004
> +++ GDALmake.opt.in     Fri Mar 19 18:50:20 2004
> @@ -79,8 +79,8 @@
>  endif
> 
>  CPPFLAGS       = @CPPFLAGS@ -I$(GDAL_ROOT)/port
> -CFLAGS         = @C_WFLAGS@ @C_PIC@ $(C_ODFLAGS) @EXTRA_INCLUDES@ $(USER_DEFS)
> -CXXFLAGS       = @CXX_WFLAGS@ @CXX_PIC@ $(CXX_ODFLAGS) \
> +CFLAGS         = @C_WFLAGS@ @C_PIC@ $(GDAL_INCLUDE) $(C_ODFLAGS) @EXTRA_INCLUDES@ $(USER_DEFS)
> +CXXFLAGS       = @CXX_WFLAGS@ @CXX_PIC@ $(GDAL_INCLUDE) $(CXX_ODFLAGS) \
>                   @EXTRA_INCLUDES@ $(USER_DEFS)
> 
>  RANLIB         =       @RANLIB@

Derrick,

Most of the makefiles modify CPPFLAGS to include GDAL_INCLUDE if they need it.
It seems to me your change will cause the GDAL_INCLUDE directives to appear
multiple times on the compile line and lead to further confusion.  I would
prefer if you could submit this issue via bugzilla, along with the build
lines that appeared to be causing you problems.

In particular, I am wondering why we are adjusting CPPFLAGS to include
GDAL_INCLUDE in the various GNUmakefiles, when some of the include paths
are embedded directly in CFLAGS and CXXFLAGS.  One of the generic compile rules
is as follows which you can see puts CPPFLAGS after CXXFLAGS.

../o/%.o:	%.cpp
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c -o $@ $<

Perhaps I need to move *all* includes out of CXXFLAGS into CPPFLAGS, and then
just ensure that all appropriate GNUmakefiles apply adjustments as is already
done in some (most?).  For instance, gda/frmts/png/GNUmakefile does this to
ensure that the GDAL includes are ahead of other include directives expected
to be in CPPFLAGS.

CPPFLAGS	:=	$(XTRA_OPT) $(GDAL_INCLUDE) $(CPPFLAGS)

This is an area that Andrey has already done a bunch of work on a month or
two ago.  It may be that just a few subtle improvements are still needed.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.wilkie at gov.yk.ca  Fri Mar 19 14:12:13 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Cyclic projection and error propagation
Message-ID: <405B460D.40305@gov.yk.ca>

Hello People,
(at least I think you are all people, please correct me if I'm wrong...)

I've posted a new page to the yukongis website trying to find out just 
how much we should or shouldn't be worried about the errors involved in 
repeated projection cycles.

If you have any insight to share, please do! (and make sure you read the 
ESRI user forum thread)

http://yukongis.ca/bin/view/Main/CyclicProjection

take care,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040319/165f4008/CyclicProjectionskinplain.htm
From doug at jdgis.com  Sat Mar 20 16:03:24 2004
From: doug at jdgis.com (J Douglas Gough)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] PNG Heightfield
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc>
Message-ID: <00e701c40ebe$cc1eeb50$6401a8c0@dougpc>

I guess that question isn't really appropriate for this list.  Sorry 'bout
that.

----- Original Message ----- 
From: J Douglas Gough
To: gdal-dev@remotesensing.org
Sent: Friday, March 19, 2004 10:48 AM
Subject: [Gdal-dev] PNG Heightfield


I would like to create a heightfield from an ArcInfo grid.  So far, I have
successfully converted an elevation grid to a 16 bit grayscale PNG using
gdal_translate.  I can see the difference in brightness correleates to
height, but I'm stuck here.  I'm thinking I'll need to create a pallette and
lookup table so there are 65,536 possible values.  That should give me
plenty of room to account for -5000 to +5000 meters or some other range that
covers the min/max elevation in meters for any given point.  Just looking
for some tips or examples.

Thanks,

Doug.


From starged at videotron.ca  Sat Mar 20 21:14:54 2004
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <20040318082352.GA15245@ak4719.spb.edu>
References: <mp2f50toeltv0am0hmg9lt9r9adcirofoa@4ax.com>
 <405794A3.8040008@pobox.com> <sshf50d1jj7ma62kvgu03eb816677tq6at@4ax.com>
 <4057F2E7.4040200@pobox.com> <925i50lt194076v1bmgr625g4mmhho5595@4ax.com>
 <20040318082352.GA15245@ak4719.spb.edu>
Message-ID: <5htp50lru2qgqtpqgqq11mh303j557b3s2@4ax.com>

Hi Andrey,

On Thu, 18 Mar 2004 11:23:52 +0300, Andrey Kiselev <dron@ak4719.spb.edu> wrote:

>I have attached several images to clarify a bit GDAL interpolation
>methods. Cubic B-spline in fact implements approximation, it has
>advantages over other methods on high upsampling rates.

I really would like to tell you it clarified but I can't :)

I guess I see things more in a practical way than analytically or in theory. For example, are some
methods better suited for some reprojections and/or resampling? And what about elevation data? For
example, the DEMs I have are in geographic projection and I need to reproject them to the
appropriate UTM zone to match the Landsat imagery of the same region. Since Landsat resolution is
30m, is it necessary to specify "-tr 30 30" or let gdalwarp figure that out?

It's the kind of questions I have :)

Thanks.
--
Mario B.
My Landsat images:
http://pages.infinit.net/starged/landsat/home.html

From neteler at itc.it  Mon Mar 22 09:21:26 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] OGR C API question
Message-ID: <20040322142126.GN16740@thuille.itc.it>

Dear list members,

inspired by
 gdal/ogr/ogr_capi_test.c

I had implemented a spatial filter in v.in.ogr (GRASS 5.7).
This was functional last year, but testing it with the current
GDAL-CVS, it doesn't work any longer. It always imports the
full map.


Code snippet below, if needed, the full C code is here:
http://freegis.org/cgi-bin/viewcvs.cgi/grass51/vector/v.in.ogr/main.c?rev=1.31&content-type=text/vnd.viewcvs-markup

The variables xmin, ymin, xmax, ymax are defined (checked with
debug output).

[... main.c ...]

        OGRGeometryH Ogr_oRing=NULL, poSpatialFilter=NULL;

[...]
    if ( spat_opt->answer ) {
[...]
        G_debug( 2, "cut out with boundaries: %f %f %f %f",xmin,ymin,xmax,ymax);

	poSpatialFilter = OGR_G_CreateGeometry( wkbPolygon );
	Ogr_oRing = OGR_G_CreateGeometry( wkbLineString );
        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
        OGR_G_AddPoint(Ogr_oRing, xmin, ymax, 0);
        OGR_G_AddPoint(Ogr_oRing, xmax, ymax, 0);
        OGR_G_AddPoint(Ogr_oRing, xmax, ymin, 0);
        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
        OGR_G_AddGeometryDirectly(poSpatialFilter, Ogr_oRing);
	
        OGR_L_SetSpatialFilter(Ogr_layer, poSpatialFilter );

Does anyone see why this doesn't work any longer? The spatial filter is
simply ignored.

Thanks in advance

 Markus


From warmerdam at pobox.com  Mon Mar 22 09:53:21 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] OGR C API question
In-Reply-To: <20040322142126.GN16740@thuille.itc.it>
References: <20040322142126.GN16740@thuille.itc.it>
Message-ID: <405EFDE1.1070400@pobox.com>

Markus Neteler wrote:
> 	poSpatialFilter = OGR_G_CreateGeometry( wkbPolygon );
> 	Ogr_oRing = OGR_G_CreateGeometry( wkbLineString );
>         OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
>         OGR_G_AddPoint(Ogr_oRing, xmin, ymax, 0);
>         OGR_G_AddPoint(Ogr_oRing, xmax, ymax, 0);
>         OGR_G_AddPoint(Ogr_oRing, xmax, ymin, 0);
>         OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
>         OGR_G_AddGeometryDirectly(poSpatialFilter, Ogr_oRing);
> 	
>         OGR_L_SetSpatialFilter(Ogr_layer, poSpatialFilter );
> 
> Does anyone see why this doesn't work any longer? The spatial filter is
> simply ignored.

Markus,

The wkbLineString should be wkbLinearRing. It looks like the
AddGeometryDirectly() method returns OGRERR_UNSUPPORTED_GEOMETRY_TYPE if
you pass anything other than a wkbLinearRing to add to a polygon.   The
checking may have been added after the initial implementation though I see
nothing obvious in the change logs.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Mar 22 10:56:05 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] PNG Heightfield
In-Reply-To: <00e701c40ebe$cc1eeb50$6401a8c0@dougpc>
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc> <00e701c40ebe$cc1eeb50$6401a8c0@dougpc>
Message-ID: <405F0C95.5090809@pobox.com>

J Douglas Gough wrote:
> I guess that question isn't really appropriate for this list.  Sorry 'bout
> that.

Doug,

Any particular reason you think your question is inappropriate for the GDAL
list?   I don't think it is quite dead-on, but it isn't unreasonable.

> ----- Original Message ----- 
> From: J Douglas Gough
> To: gdal-dev@remotesensing.org
> Sent: Friday, March 19, 2004 10:48 AM
> Subject: [Gdal-dev] PNG Heightfield
> 
> 
> I would like to create a heightfield from an ArcInfo grid.  So far, I have
> successfully converted an elevation grid to a 16 bit grayscale PNG using
> gdal_translate.  I can see the difference in brightness correleates to
> height, but I'm stuck here.  I'm thinking I'll need to create a pallette and
> lookup table so there are 65,536 possible values.  That should give me
> plenty of room to account for -5000 to +5000 meters or some other range that
> covers the min/max elevation in meters for any given point.  Just looking
> for some tips or examples.

In theory GDAL supports large palettes (palettes larger than 256 colours)
but in practice this doesn't work with many formats, and there are few
applications that will properly take advantage of them.  So before, launching
into this approach you might want to consider other approachs such as scaling
to 8bit and then applying a color table, or using a display application that
can apply color tables to raw 16bit heightfields.

There are various kinds of color ramps used for elevation data, but I don't
have any particular sage advice on what to use.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Mar 22 11:34:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Cyclic projection and error propagation
In-Reply-To: <405B460D.40305@gov.yk.ca>
References: <405B460D.40305@gov.yk.ca>
Message-ID: <405F1584.5030004@pobox.com>

Matt Wilkie wrote:
>   Repeated Projection and Error Propagation
> 
>     * How much error is involved in projection?
>     * How many projection cycles are "safe"?
>     * Which softwares have the lowest error propagation rate?
>     * Are the answers different for raster and vector data?
> 
> For example, one of our data providers' native storage format is UTM. 
> However they only distribute data in geographic decimal degrees. So when 
> they send data to us they project it first. Now of course when we 
> receive the data the first thing we do is reproject it into Albers to 
> match the rest of our data.
> 
> So before we do any analysis at all the data has been projected twice to 
> three different coordinate systems. Chances are that when *our* upstream 
> provider was compiling the data, they started with data from an existing 
> source, which was likely in a different coordinate system.

Matt,

I am sure there are formal descriptions of the information loss that can
occur depending on the characteristics of the reprojection/resampling
steps, but I don't have a strong enough theoretical background to point
them out.

However, the general answer is that every reprojection/resampling there
will be data degredation and the the "damage" will be affected by a number
of factors, including the resampling kernel used and the information
density of the image.

The higher the information density of your data, the more damage that
will result from a resampling step.  So, for instance, if you had DEM
data stored at 100 m resolution and it resulted from actually going out
in the field and sampling every 100m in rough terrain with a GPS then
you would suffer substantial loss of information to reproject at the
same resolution in another projection.  However, if you work with a 10m
DEM derived by some method from samplings at 100m, then a reprojection
step will cause relatively little data loss.  Of course, if you data
area was also quite uniform then the data loss would be relatively small.

The same issues would presumably apply to spectral image data.

When taking into account information density and loss, you should also
only worry about the information that matters to you.  If you have
airphotos with 100cm resolution that show quite a bit of detail of trees
and other fine features, but you only want to use the data for rough
mapping of transportation networks, then your features of interest
effectively have a resolution of a couple meters and some smearing of
tree features wouldn't matter much.

So, in general:
  o try to minimize the number of resampling steps.
  o consider working internally at a higher resolution than the source
    data.
  o don't worry too much if the source data is effectively low resolution
    anyways (as might be the case with many DEMs produced in remote areas).
  o don't worry too much if the source data is already much higher
    resolution than you need for your purposes.

Note, my comments are mostly based on common sense, and not a strong
theoretical background, or even much real experience in the production
environments.  So take it mostly as an "in my humble opinion".

>     * Proj4 <http://remotesensing.org/proj/> mailing list (appears to
>       have been spammed into oblivion)

The PROJ.4 list is active. It is mostly the archive that has been spammed
into oblivion as far as I can tell.  However, I didn't see your message there.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jluis at ualg.pt  Mon Mar 22 12:12:19 2004
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] PNG Heightfield
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc> <00e701c40ebe$cc1eeb50$6401a8c0@dougpc> <405F0C95.5090809@pobox.com>
Message-ID: <405F1E73.CC76615B@ualg.pt>


Frank Warmerdam wrote:

> J Douglas Gough wrote:
> > I guess that question isn't really appropriate for this list.  Sorry 'bout
> > that.
>
> Doug,
>
> Any particular reason you think your question is inappropriate for the GDAL
> list?   I don't think it is quite dead-on, but it isn't unreasonable.

That made me remind that I have alternative to offer.
I have (a somewhat old) code that transforms gmt grids into tga (not png)
heighfields.
For running, it has to be compiled with gmt (it means that gmt has to be
installed).
Interested?

J. Luis



From matt.wilkie at gov.yk.ca  Mon Mar 22 12:03:56 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] PNG Heightfield
In-Reply-To: <007d01c40de2$b4c0f110$6401a8c0@dougpc>
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc>
Message-ID: <405F1C7C.3000105@gov.yk.ca>

J Douglas Gough wrote:

> I would like to create a heightfield from an ArcInfo grid.  So far, I
> have successfully converted an elevation grid to a 16 bit grayscale PNG
> using gdal_translate.  I can see the difference in brightness
> correleates to height, but I'm stuck here.  I'm thinking I'll need to
> create a pallette and lookup table so there are 65,536 possible values.
> That should give me plenty of room to account for -5000 to +5000 meters
> or some other range that covers the min/max elevation in meters for any
> given point.  Just looking for some tips or examples.  

What program(s) are going to use the png-heightfield? Something like 
Virtual Terrain Project or World Construction Set can use them as-is 
where-is (there are probably others, these are just the ones I've used 
16bit images as DEMs with). If this for a program you are developing the 
source code for VTP should help.

cheers,

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------


From matt.wilkie at gov.yk.ca  Mon Mar 22 16:16:04 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] [off topic] Cyclic projection and Error propagation
Message-ID: <405F5794.3020201@gov.yk.ca>

Hello Listers,

I've posted these question to a variety of discussion forums, and have 
received disappointingly few responses. Please indulge me while I reach 
a little further for some learned thoughts; do you have some to share?

thanks,

-matt

----------
( http://yukongis.ca/bin/view/Main/CyclicProjection )

  Repeated Projection and Error Propagation

     * How much error is involved in projection?
     * How many projection cycles are "safe"?
     * Which softwares have the lowest error propagation rate?
     * Are the answers different for raster and vector data?

For example, one of our data providers' native storage format is UTM. 
However they only distribute data in geographic decimal degrees. So when 
they send data to us they project it first. Now of course when we 
receive the data the first thing we do is reproject it into Albers to 
match the rest of our data.

So before we do any analysis at all the data has been projected twice to 
three different coordinate systems. Chances are that when our upstream 
provider was compiling the data, they started with data from an existing 
source, which was likely in a different coordinate system.

We do something with the data which results in a new theme. Other people 
are interested in the data so we project to a popular coordinate system 
for distribution, which is probably decimal degrees again. The 
downstream users' first item on the agenda will likely be to project to 
match their favourite projection. And on we go.

Over the course of time this cycle will get repeated many times by many 
people with various software. At what point, if ever, should we be 
concerned?


Other places this discussion might be happening:

     * ESRI user forum on Projection Engine good info here!
     * ESRI Customer support (no response yet)
     * SAFE Software tech support (no response yet)
     * news:comp.infosystems.gis, Google Groups gateway (no response yet)
     * Proj4 mailing list (appears to have been spammed into oblivion :( )


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From neteler at itc.it  Mon Mar 22 17:38:46 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] OGR C API question
In-Reply-To: <405EFDE1.1070400@pobox.com>
References: <20040322142126.GN16740@thuille.itc.it> <405EFDE1.1070400@pobox.com>
Message-ID: <20040322223846.GA24470@thuille.itc.it>

On Mon, Mar 22, 2004 at 09:53:21AM -0500, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >	poSpatialFilter = OGR_G_CreateGeometry( wkbPolygon );
> >	Ogr_oRing = OGR_G_CreateGeometry( wkbLineString );
> >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> >        OGR_G_AddPoint(Ogr_oRing, xmin, ymax, 0);
> >        OGR_G_AddPoint(Ogr_oRing, xmax, ymax, 0);
> >        OGR_G_AddPoint(Ogr_oRing, xmax, ymin, 0);
> >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> >        OGR_G_AddGeometryDirectly(poSpatialFilter, Ogr_oRing);
> >	
> >        OGR_L_SetSpatialFilter(Ogr_layer, poSpatialFilter );
> >
> >Does anyone see why this doesn't work any longer? The spatial filter is
> >simply ignored.
> 
> Markus,
> 
> The wkbLineString should be wkbLinearRing. It looks like the
> AddGeometryDirectly() method returns OGRERR_UNSUPPORTED_GEOMETRY_TYPE if
> you pass anything other than a wkbLinearRing to add to a polygon.   The
> checking may have been added after the initial implementation though I see
> nothing obvious in the change logs.

Great, now it works smoothly (tried with SHAPE, hope it does as well
with PostGIS data).

Thanks,
 
 Markus


From matt.wilkie at gov.yk.ca  Mon Mar 22 19:35:31 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] test
Message-ID: <405F8653.4000200@gov.yk.ca>

testing... please ignore. (my last couple of posts seem to have 
disapeared in transit)


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------



From matt.wilkie at gov.yk.ca  Mon Mar 22 19:42:21 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] [off topic] Cyclic projection and Error propagation
Message-ID: <405F87ED.2000702@gov.yk.ca>

(mailing attempt #3)

Hello Listers,

I've posted these question to a variety of discussion forums, and have
received disappointingly few responses. Please indulge me while I reach
a little further for some learned thoughts; do you have some to share?

thanks,

-matt

----------
( http://yukongis.ca/bin/view/Main/CyclicProjection )

  Repeated Projection and Error Propagation

     * How much error is involved in projection?
     * How many projection cycles are "safe"?
     * Which softwares have the lowest error propagation rate?
     * Are the answers different for raster and vector data?

For example, one of our data providers' native storage format is UTM.
However they only distribute data in geographic decimal degrees. So when
they send data to us they project it first. Now of course when we
receive the data the first thing we do is reproject it into Albers to
match the rest of our data.

So before we do any analysis at all the data has been projected twice to
three different coordinate systems. Chances are that when our upstream
provider was compiling the data, they started with data from an existing
source, which was likely in a different coordinate system.

We do something with the data which results in a new theme. Other people
are interested in the data so we project to a popular coordinate system
for distribution, which is probably decimal degrees again. The
downstream users' first item on the agenda will likely be to project to
match their favourite projection. And on we go.

Over the course of time this cycle will get repeated many times by many
people with various software. At what point, if ever, should we be
concerned?


Other places this discussion might be happening:

     * ESRI user forum on Projection Engine good info here!
     * ESRI Customer support (no response yet)
     * SAFE Software tech support (no response yet)
     * news:comp.infosystems.gis, Google Groups gateway (no response yet)
     * Proj4 mailing list (appears to have been spammed into oblivion :( )


-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------





From matt.wilkie at gov.yk.ca  Mon Mar 22 19:48:03 2004
From: matt.wilkie at gov.yk.ca (Matt Wilkie)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] test revisited (projection and error propagation)
Message-ID: <405F8943.6050601@gov.yk.ca>

hmm, three separate mailing attempts have failed to get through.

The gist of them are: I need learned opinions on how much projection is 
too much projection. Details at 
http://yukongis.ca/bin/view/Main/CyclicProjection

thanks

-- 
matt wilkie
--------------------------------------------
Geographic Information,
Information Management and Technology,
Yukon Department of Environment
10 Burns Road * Whitehorse, Yukon * Y1A 4Y9
867-667-8133 Tel * 867-393-7003 Fax
--------------------------------------------





From dem at acri-st.fr  Tue Mar 23 06:16:13 2004
From: dem at acri-st.fr (julien demaria)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] OGR dataset default feature style
Message-ID: <200403231116.i2NBGDf18697@mail.acri.fr>

Hi,


OGR - Feature Style Specifications :

"There are actually 2 levels at which style information can be found: 

At the dataset level:
  - A dataset can have a default style that applies to all features. 
  - It can also have a table of pre-defined styles that can then be referred to 
    by the layers or by the individual features. 
    The mechanism for that is defined further down in this document.
..."

Is dataset default style implemented in OGR ?

I understand in specifications that this informations are stored in the "Styles Table Format" which is stored in an external .ofs file for formats that don't support styles table. I want use "ESRI Shapefile" driver, are .ofs file implemented for it ?

Does the dataset default style mechanism allow "styles union" ? For example if we define a global color at the dataset level : PEN(c:#ff0000), can we suppose that a local feature with only width : PEN(w:5) inherit from global color ? ( ===> PEN(c:#ff0000,w:5) )

Thanks in advance,

Julien
From sebastien.grignard at archivideo.com  Tue Mar 23 06:49:41 2004
From: sebastien.grignard at archivideo.com (=?ISO-8859-1?Q?S=E9bastien_Grignard?=)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
Message-ID: <40602455.9090207@archivideo.com>

Hello All,
I am assembling a couple of RGB Tiff images in one big PAux using the 
gdal_merge.py utility, but the output image is incorrect. I suspect this 
is due to its huge size : 133000x88000. I have already looked a bit in 
the paux/raw driver code and changed the offset types to long long 
without success...
Do you have any idea of what could cause this ?

-- 
Sebastien Grignard
R&D Project Manager
Archivideo
40, rue des Veyettes - 35000 Rennes
Tel: (+033) 2 99 86 30 20 - Fax: +(033) 2 99 86 30 21


From warmerdam at pobox.com  Tue Mar 23 10:05:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
In-Reply-To: <40602455.9090207@archivideo.com>
References: <40602455.9090207@archivideo.com>
Message-ID: <40605246.3060106@pobox.com>

S?bastien Grignard wrote:
> Hello All,
> I am assembling a couple of RGB Tiff images in one big PAux using the 
> gdal_merge.py utility, but the output image is incorrect. I suspect this 
> is due to its huge size : 133000x88000. I have already looked a bit in 
> the paux/raw driver code and changed the offset types to long long 
> without success...
> Do you have any idea of what could cause this ?


S?bastien,

I have briefly reviewed the PAux driver and no band can start after the 2GB
mark since signed 32bit integers are used  for the offset to the beginning
of the band data.

Since GDAL currently always creates band interleaved files, this is likely
your problem.  One solution would be to allow the band offset to be large;
however, I am a bit nervous about how to portably format, and atoi() large
integers.  I don't want alot of hassles with platform specific solutions
to this problem.  The other approach would be to add creation options to the
PAux driver so that you can create a line interleaved or pixel interleaved
data file.  Even though larger than 4GB the bands would start within the
first 2GB so there should be no problem.

Let me know if you would like a patch for this.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Mar 23 10:08:21 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] OGR dataset default feature style
In-Reply-To: <200403231116.i2NBGDf18697@mail.acri.fr>
References: <200403231116.i2NBGDf18697@mail.acri.fr>
Message-ID: <406052E5.3030004@pobox.com>

julien demaria wrote:
> Hi,
> 
> 
> OGR - Feature Style Specifications :
> 
> "There are actually 2 levels at which style information can be found: 
> 
> At the dataset level:
>   - A dataset can have a default style that applies to all features. 
>   - It can also have a table of pre-defined styles that can then be referred to 
>     by the layers or by the individual features. 
>     The mechanism for that is defined further down in this document.
> ..."
> 
> Is dataset default style implemented in OGR ?
> 
> I understand in specifications that this informations are stored in the 
 > "Styles Table Format" which is stored in an external .ofs file for formats
 > that don't support styles table. I want use "ESRI Shapefile" driver, are
 >.ofs file implemented for it ?
> 
> Does the dataset default style mechanism allow "styles union" ? For example 
 >if we define a global color at the dataset level : PEN(c:#ff0000), can we suppose
 > that a local feature with only width : PEN(w:5) inherit from global color ?
 >( ===> PEN(c:#ff0000,w:5) )

Julien,

To the best of my knowledge none of the "default at the layer" part of the
spec has been implemented - at least not in the format drivers.  There might
be style information in the OGRLayer object.

Likewise OpenEV does not currently look for OGRFS style information at the
layer level when reading.

However, that doesn't mean we couldn't work towards this design ... just that
not much of this aspect exists in code now.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dron at ak4719.spb.edu  Tue Mar 23 10:06:15 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
In-Reply-To: <40602455.9090207@archivideo.com>
References: <40602455.9090207@archivideo.com>
Message-ID: <20040323150615.GB30107@ak4719.spb.edu>

On Tue, Mar 23, 2004 at 12:49:41PM +0100, S?bastien Grignard wrote:
> I am assembling a couple of RGB Tiff images in one big PAux using the
> gdal_merge.py utility, but the output image is incorrect. I suspect
> this is due to its huge size : 133000x88000. I have already looked a
> bit in the paux/raw driver code and changed the offset types to long
> long without success...

It should be fixed now in CVS. Please, test.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From warmerdam at pobox.com  Tue Mar 23 10:31:18 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
In-Reply-To: <20040323150615.GB30107@ak4719.spb.edu>
References: <40602455.9090207@archivideo.com> <20040323150615.GB30107@ak4719.spb.edu>
Message-ID: <40605846.9040605@pobox.com>

Andrey Kiselev wrote:
> On Tue, Mar 23, 2004 at 12:49:41PM +0100, S?bastien Grignard wrote:
> 
>>I am assembling a couple of RGB Tiff images in one big PAux using the
>>gdal_merge.py utility, but the output image is incorrect. I suspect
>>this is due to its huge size : 133000x88000. I have already looked a
>>bit in the paux/raw driver code and changed the offset types to long
>>long without success...
> 
> 
> It should be fixed now in CVS. Please, test.

Andrey,

Could you move the logic for converting 64 bit integers to/from string
format down into CPL?  We don't want to have stuff like this in too many
places!


#if defined(WIN32) && defined(_MSC_VER)
         pszFormatString = "ChanDefinition-%d: %s %I64d %d %d %s\n";
# elif HAVE_LONG_LONG
         pszFormatString = "ChanDefinition-%d: %s %Ld %d %d %s\n";
#else
         pszFormatString = "ChanDefinition-%d: %s %ld %d %d %s\n";
#endif

#if defined(WIN32) && defined(_MSC_VER)
	nImgOffset = _atoi64( papszTokens[1] );
# elif HAVE_ATOLL
	nImgOffset = atoll( papszTokens[1] );
#else
	nImgOffset = atol( papszTokens[1] );
#endif

Perhaps a CPLAToBigI() and CPLBigIToA().

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From hientb24 at yahoo.com  Tue Mar 23 21:00:46 2004
From: hientb24 at yahoo.com (hien thu)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] How do These numbers mean
Message-ID: <20040324020046.59633.qmail@web20729.mail.yahoo.com>

Hello !

I have some questions..
1.  I want to display a raster layer ( an image format .tif).
  But I alway get error :"Internal SerVer Error :The server encountered an internal error or misconfiguration and was unable to complete your request.
Please contact the server administrator, root@localhost and inform them of the time the error occurred, and anything you might have done that may have caused the error.
More information about this error may be available in the server error log."
 
  My map : tif.map:

MAP
IMAGETYPE      PNG24
EXTENT         201621.496941 -294488.285333 1425518.020722 498254.511514 
SIZE             400 300
SHAPEPATH      "data"
SYMBOLSET      "symbols/symbols35.sym"
FONTSET        "fonts/fonts.list"
WEB
  IMAGEPATH '/var/www/html/tmp/'
  IMAGEURL  '/tmp/'
END
PROJECTION
#  "init=epsg:4326"
#  "proj=laea"
#  "ellps=clrk66"
#  "lat_0=45"
#  "lon_0=-100"
#
# Alternatively, you can specify an EPSG code.
 "init=epsg:2163"
#
END
# Start of LAYER DEFINITIONS ---------------------------------------------

LAYER # MODIS raster layer begins here
  NAME         modis
  DATA         "raster/example.tif"
  STATUS       default
  TYPE         RASTER
  PROCESSING   "BANDS=1,2,3"
  OFFSITE      71 74 65
  PROJECTION
    "init=epsg:4269"
  END
END # MODIS raster layer ends here
 
# End of LAYER DEFINITIONS -------------------------------
END # end of map file
 
2. I have a map file :
 
I display this file but  no image can create ( white image and no error) 

MAP
  IMAGETYPE      PNG                                                      
  EXTENT              ???  Help me ??       
 
#  I used   Extent:  4.931450  -10.330521     14.607994    -2.691144
    but  still get same result

  SIZE           400 300
  SHAPEPATH      "data"
  IMAGECOLOR      255 255 255
  SYMBOLSET "symbols/symbols35.sym"
  FONTSET    "fonts/fonts.list"
  PROJECTION
    "proj=laea"
    "ellps=clrk66"
    "lat_0=45"
    "lon_0=-100"
  #
  # Alternatively, you can specify an EPSG code.
  # "init=epsg:2163"
  #
  END
#---------------------------------------------
LAYER
  NAME a1
  TYPE POINT
  DATA a1
  STATUS default
  PROJECTION
    "init=epsg:4326"
  END
  CLASS
    COLOR 255 0 0
    SYMBOL 'star'
    SIZE 10
  END
END
#-------------------------------------------------
LAYER # Display name
  NAME         a1
  DATA         a1
  STATUS       default
  TYPE         ANNOTATION
  PROJECTION
    "init=epsg:4326"
  END
  LABELITEM    "TEN"
  CLASS
    COLOR      -1 -1 -1
    LABEL
      COLOR 132 31 31
      SHADOWCOLOR 218 218 218
      SHADOWSIZE 2 2
      TYPE TRUETYPE
      FONT arial-bold
      SIZE 12
      ANTIALIAS TRUE
      POSITION UC
      PARTIALS FALSE
      MINDISTANCE 300
      BUFFER 4
    END # end of label
  END # end of class
 END # States label layer ends here
#-------------------------------------------------
END # end of mapfile
 
I use ArcView 3.0 to creare shapefiles : a1.dbf ; a1.shx ; a1.shp
 
a1.dbf :
 
INFO: Open of `a1.dbf'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
a1.shx:
 
INFO: Open of `a1.shx'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
  TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
a1.shp :

INFO: Open of `a1.shp'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
 TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
 
 
3. I have two images as the same properties  ( img1.tif ; img2.tif )
    
  File Type    Tagged Information File Format (Tiff)
  Width        3480
  Height       1740
  HorizontalR    1
  VerticalRes    1
  Bit Depth      24
  Color Repre    True color RGB
  Comprestion    uncompressed   
 
 But when I open them by ArcView 3.0 , I see some differences between them : 
 
( Defination)
    img1.tif:
            Left : -97.374337     Right   -80.903299
            Bottom  41.180399     Top      49.415915
    img2.tif:
            -0.005208     36.223958
             -18.119792    0.005208
   How do These numbers mean ? Can I change img2.tif same as img1.tif ?

 
I am very worry because althougt I try again but  still ....
 
Hepl me !
 
Thanks a lot !
 


Do you Yahoo!?
Yahoo! Finance Tax Center - File online. File on time.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040323/15c9f620/attachment.html
From hientb24 at yahoo.com  Tue Mar 23 21:02:40 2004
From: hientb24 at yahoo.com (hien thu)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] display a raster lyaer
Message-ID: <20040324020240.97034.qmail@web20728.mail.yahoo.com>

Hello !

I have some questions..
1.  I want to display a raster layer ( an image format .tif).
  But I alway get error :"Internal SerVer Error :The server encountered an internal error or misconfiguration and was unable to complete your request.
Please contact the server administrator, root@localhost and inform them of the time the error occurred, and anything you might have done that may have caused the error.
More information about this error may be available in the server error log."
 
  My map : tif.map:

MAP
IMAGETYPE      PNG24
EXTENT         201621.496941 -294488.285333 1425518.020722 498254.511514 
SIZE             400 300
SHAPEPATH      "data"
SYMBOLSET      "symbols/symbols35.sym"
FONTSET        "fonts/fonts.list"
WEB
  IMAGEPATH '/var/www/html/tmp/'
  IMAGEURL  '/tmp/'
END
PROJECTION
#  "init=epsg:4326"
#  "proj=laea"
#  "ellps=clrk66"
#  "lat_0=45"
#  "lon_0=-100"
#
# Alternatively, you can specify an EPSG code.
 "init=epsg:2163"
#
END
# Start of LAYER DEFINITIONS ---------------------------------------------

LAYER # MODIS raster layer begins here
  NAME         modis
  DATA         "raster/example.tif"
  STATUS       default
  TYPE         RASTER
  PROCESSING   "BANDS=1,2,3"
  OFFSITE      71 74 65
  PROJECTION
    "init=epsg:4269"
  END
END # MODIS raster layer ends here
 
# End of LAYER DEFINITIONS -------------------------------
END # end of map file
 
2. I have a map file :
 
I display this file but  no image can create ( white image and no error) 

MAP
  IMAGETYPE      PNG                                                      
  EXTENT              ???  Help me ??       
 
#  I used   Extent:  4.931450  -10.330521     14.607994    -2.691144
    but  still get same result

  SIZE           400 300
  SHAPEPATH      "data"
  IMAGECOLOR      255 255 255
  SYMBOLSET "symbols/symbols35.sym"
  FONTSET    "fonts/fonts.list"
  PROJECTION
    "proj=laea"
    "ellps=clrk66"
    "lat_0=45"
    "lon_0=-100"
  #
  # Alternatively, you can specify an EPSG code.
  # "init=epsg:2163"
  #
  END
#---------------------------------------------
LAYER
  NAME a1
  TYPE POINT
  DATA a1
  STATUS default
  PROJECTION
    "init=epsg:4326"
  END
  CLASS
    COLOR 255 0 0
    SYMBOL 'star'
    SIZE 10
  END
END
#-------------------------------------------------
LAYER # Display name
  NAME         a1
  DATA         a1
  STATUS       default
  TYPE         ANNOTATION
  PROJECTION
    "init=epsg:4326"
  END
  LABELITEM    "TEN"
  CLASS
    COLOR      -1 -1 -1
    LABEL
      COLOR 132 31 31
      SHADOWCOLOR 218 218 218
      SHADOWSIZE 2 2
      TYPE TRUETYPE
      FONT arial-bold
      SIZE 12
      ANTIALIAS TRUE
      POSITION UC
      PARTIALS FALSE
      MINDISTANCE 300
      BUFFER 4
    END # end of label
  END # end of class
 END # States label layer ends here
#-------------------------------------------------
END # end of mapfile
 
I use ArcView 3.0 to creare shapefiles : a1.dbf ; a1.shx ; a1.shp
 
a1.dbf :
 
INFO: Open of `a1.dbf'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
a1.shx:
 
INFO: Open of `a1.shx'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
  TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
a1.shp :

INFO: Open of `a1.shp'
using driver `ESRI Shapefile' successful.
Layer name: a1
Geometry: Point
Feature Count: 3
Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
Layer SRS WKT:
(unknown)
ID: Integer (8.0)
TEN: String (16.0)
OGRFeature(a1):0
  ID (Integer) = 0
  TEN (String) = buon
  POINT (13.84405618 -2.69114417)
OGRFeature(a1):1
  ID (Integer) = 0
  TEN (String) = vui
  POINT (14.60799388 -9.43926052)
OGRFeature(a1):2
  ID (Integer) = 0
 TEN (String) = daukho
  POINT (4.93144968 -10.33052117)
 
 
 
3. I have two images as the same properties  ( img1.tif ; img2.tif )
    
  File Type    Tagged Information File Format (Tiff)
  Width        3480
  Height       1740
  HorizontalR    1
  VerticalRes    1
  Bit Depth      24
  Color Repre    True color RGB
  Comprestion    uncompressed   
 
 But when I open them by ArcView 3.0 , I see some differences between them : 
 
( Defination)
    img1.tif:
            Left : -97.374337     Right   -80.903299
            Bottom  41.180399     Top      49.415915
    img2.tif:
            -0.005208     36.223958
             -18.119792    0.005208
   How do These numbers mean ? Can I change img2.tif same as img1.tif ?

 
I am very worry because althougt I try again but  still ....
 
Hepl me !
 
Thanks a lot !
 


Do you Yahoo!?
Yahoo! Finance Tax Center - File online. File on time.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040323/3a3a8080/attachment.html
From schut at sarvision.com  Wed Mar 24 03:14:04 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] How do These numbers mean
In-Reply-To: <20040324020046.59633.qmail@web20729.mail.yahoo.com>
References: <20040324020046.59633.qmail@web20729.mail.yahoo.com>
Message-ID: <200403240914.04529.schut@sarvision.com>

Hien,

I think you will have a better chance of getting these questions answered by 
posting them to the mapserver-users mail list. The error you are getting is 
probably purely mapserver related, and has next to nothing to do with GDAL...

For your convenience I will send this to the mapserver list too, so you don't 
have to post it again.

Cheers,
Vincent.

On Wednesday 24 March 2004 03:00, hien thu wrote:
> Hello !
>
> I have some questions..
> 1.  I want to display a raster layer ( an image format .tif).
>   But I alway get error :"Internal SerVer Error :The server encountered an
> internal error or misconfiguration and was unable to complete your request.
> Please contact the server administrator, root@localhost and inform them of
> the time the error occurred, and anything you might have done that may have
> caused the error. More information about this error may be available in the
> server error log."
>
>   My map : tif.map:
>
> MAP
> IMAGETYPE      PNG24
> EXTENT         201621.496941 -294488.285333 1425518.020722 498254.511514
> SIZE             400 300
> SHAPEPATH      "data"
> SYMBOLSET      "symbols/symbols35.sym"
> FONTSET        "fonts/fonts.list"
> WEB
>   IMAGEPATH '/var/www/html/tmp/'
>   IMAGEURL  '/tmp/'
> END
> PROJECTION
> #  "init=epsg:4326"
> #  "proj=laea"
> #  "ellps=clrk66"
> #  "lat_0=45"
> #  "lon_0=-100"
> #
> # Alternatively, you can specify an EPSG code.
>  "init=epsg:2163"
> #
> END
> # Start of LAYER DEFINITIONS ---------------------------------------------
>
> LAYER # MODIS raster layer begins here
>   NAME         modis
>   DATA         "raster/example.tif"
>   STATUS       default
>   TYPE         RASTER
>   PROCESSING   "BANDS=1,2,3"
>   OFFSITE      71 74 65
>   PROJECTION
>     "init=epsg:4269"
>   END
> END # MODIS raster layer ends here
>
> # End of LAYER DEFINITIONS -------------------------------
> END # end of map file
>
> 2. I have a map file :
>
> I display this file but  no image can create ( white image and no error)
>
> MAP
>   IMAGETYPE      PNG
>   EXTENT              ???  Help me ??
>
> #  I used   Extent:  4.931450  -10.330521     14.607994    -2.691144
>     but  still get same result
>
>   SIZE           400 300
>   SHAPEPATH      "data"
>   IMAGECOLOR      255 255 255
>   SYMBOLSET "symbols/symbols35.sym"
>   FONTSET    "fonts/fonts.list"
>   PROJECTION
>     "proj=laea"
>     "ellps=clrk66"
>     "lat_0=45"
>     "lon_0=-100"
>   #
>   # Alternatively, you can specify an EPSG code.
>   # "init=epsg:2163"
>   #
>   END
> #---------------------------------------------
> LAYER
>   NAME a1
>   TYPE POINT
>   DATA a1
>   STATUS default
>   PROJECTION
>     "init=epsg:4326"
>   END
>   CLASS
>     COLOR 255 0 0
>     SYMBOL 'star'
>     SIZE 10
>   END
> END
> #-------------------------------------------------
> LAYER # Display name
>   NAME         a1
>   DATA         a1
>   STATUS       default
>   TYPE         ANNOTATION
>   PROJECTION
>     "init=epsg:4326"
>   END
>   LABELITEM    "TEN"
>   CLASS
>     COLOR      -1 -1 -1
>     LABEL
>       COLOR 132 31 31
>       SHADOWCOLOR 218 218 218
>       SHADOWSIZE 2 2
>       TYPE TRUETYPE
>       FONT arial-bold
>       SIZE 12
>       ANTIALIAS TRUE
>       POSITION UC
>       PARTIALS FALSE
>       MINDISTANCE 300
>       BUFFER 4
>     END # end of label
>   END # end of class
>  END # States label layer ends here
> #-------------------------------------------------
> END # end of mapfile
>
> I use ArcView 3.0 to creare shapefiles : a1.dbf ; a1.shx ; a1.shp
>
> a1.dbf :
>
> INFO: Open of `a1.dbf'
> using driver `ESRI Shapefile' successful.
> Layer name: a1
> Geometry: Point
> Feature Count: 3
> Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
> Layer SRS WKT:
> (unknown)
> ID: Integer (8.0)
> TEN: String (16.0)
> OGRFeature(a1):0
>   ID (Integer) = 0
>   TEN (String) = buon
>   POINT (13.84405618 -2.69114417)
> OGRFeature(a1):1
>   ID (Integer) = 0
>   TEN (String) = vui
>   POINT (14.60799388 -9.43926052)
> OGRFeature(a1):2
>   ID (Integer) = 0
> TEN (String) = daukho
>   POINT (4.93144968 -10.33052117)
>
> a1.shx:
>
> INFO: Open of `a1.shx'
> using driver `ESRI Shapefile' successful.
> Layer name: a1
> Geometry: Point
> Feature Count: 3
> Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
> Layer SRS WKT:
> (unknown)
> ID: Integer (8.0)
> TEN: String (16.0)
> OGRFeature(a1):0
>   ID (Integer) = 0
>   TEN (String) = buon
>   POINT (13.84405618 -2.69114417)
> OGRFeature(a1):1
>   ID (Integer) = 0
>   TEN (String) = vui
>   POINT (14.60799388 -9.43926052)
> OGRFeature(a1):2
>   ID (Integer) = 0
>   TEN (String) = daukho
>   POINT (4.93144968 -10.33052117)
>
> a1.shp :
>
> INFO: Open of `a1.shp'
> using driver `ESRI Shapefile' successful.
> Layer name: a1
> Geometry: Point
> Feature Count: 3
> Extent: (4.931450, -10.330521) - (14.607994, -2.691144)
> Layer SRS WKT:
> (unknown)
> ID: Integer (8.0)
> TEN: String (16.0)
> OGRFeature(a1):0
>   ID (Integer) = 0
>   TEN (String) = buon
>   POINT (13.84405618 -2.69114417)
> OGRFeature(a1):1
>   ID (Integer) = 0
>   TEN (String) = vui
>   POINT (14.60799388 -9.43926052)
> OGRFeature(a1):2
>   ID (Integer) = 0
>  TEN (String) = daukho
>   POINT (4.93144968 -10.33052117)
>
>
>
> 3. I have two images as the same properties  ( img1.tif ; img2.tif )
>
>   File Type    Tagged Information File Format (Tiff)
>   Width        3480
>   Height       1740
>   HorizontalR    1
>   VerticalRes    1
>   Bit Depth      24
>   Color Repre    True color RGB
>   Comprestion    uncompressed
>
>  But when I open them by ArcView 3.0 , I see some differences between them
> :
>
> ( Defination)
>     img1.tif:
>             Left : -97.374337     Right   -80.903299
>             Bottom  41.180399     Top      49.415915
>     img2.tif:
>             -0.005208     36.223958
>              -18.119792    0.005208
>    How do These numbers mean ? Can I change img2.tif same as img1.tif ?
>
>
> I am very worry because althougt I try again but  still ....
>
> Hepl me !
>
> Thanks a lot !
>
>
>
> Do you Yahoo!?
> Yahoo! Finance Tax Center - File online. File on time.

-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From dron at ak4719.spb.edu  Wed Mar 24 04:10:09 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
In-Reply-To: <40605846.9040605@pobox.com>
References: <40602455.9090207@archivideo.com> <20040323150615.GB30107@ak4719.spb.edu> <40605846.9040605@pobox.com>
Message-ID: <20040324091008.GA4577@ak4719.spb.edu>

On Tue, Mar 23, 2004 at 10:31:18AM -0500, Frank Warmerdam wrote:
> Could you move the logic for converting 64 bit integers to/from string
> format down into CPL?  We don't want to have stuff like this in too
> many places!

Ok, done.


-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From sebastien.grignard at archivideo.com  Wed Mar 24 09:30:23 2004
From: sebastien.grignard at archivideo.com (=?ISO-8859-1?Q?S=E9bastien_Grignard?=)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Maximum image size with PAux driver
In-Reply-To: <20040323150615.GB30107@ak4719.spb.edu>
References: <40602455.9090207@archivideo.com> <20040323150615.GB30107@ak4719.spb.edu>
Message-ID: <40619B7F.5070102@archivideo.com>

It works perfectly with the CVS changes.

Thank you very much !!

-- 
S?bastien Grignard
Ing?nieur R&D
Archivid?o
40, rue des Veyettes - 35000 Rennes
T?l: 02 99 86 30 20 - Fax: 02 99 86 30 21


From jluis at ualg.pt  Wed Mar 24 13:19:08 2004
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] How can I initialize the GDALDataset structures without calling GDALOpen
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc> <00e701c40ebe$cc1eeb50$6401a8c0@dougpc> <405F0C95.5090809@pobox.com> <405F1E73.CC76615B@ualg.pt>
Message-ID: <4061D11C.FF791F53@ualg.pt>

Hi,
I hope this not a very idiot question.
I want to write Matlab mex files that mimic the functionality of gdal_translate
and gdalwarp. The problem is that I already have the image data (and the
corresponding
info) in memory, and they where not obtained by a call to GDALOpen. As such, the
GDALDataset structures were not initialized and the rest of the code won't work.
My question is, how can I handle this situation?
Has someone solved this before? That is, is there any code that I can use as an
example?

Thanks

Joaquim Luis


From warmerdam at pobox.com  Wed Mar 24 13:57:37 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org> <4061B4F5.4030900@pobox.com> <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org>
Message-ID: <4061DA21.4090005@pobox.com>

Jeroen Ticheler wrote:
> Hi,
> Thanks for the quick response!
> 
> The location of the package is at:
>  ftp://ftp.ncsa.uiuc.edu/HDF/HDF/HDF4.2r0/bin/macosx

Jeroen,

I tried downloading the HDF4.2r0 for linux and ran into what I presume
are similar problem.  It seems the library uses a function called
"szip_compress_memory" that is not included with the libraries and is
not part of libz or anything else I can find.   I presume it comes from:

   http://www.compressconsult.com/szip/

However, this has gotten quite a bit more complicated than I want to deal
with.  I would suggest that you either:

   Get the HDF4.1r5 package for MacOS and try that.

or

   Submit a bug in the GDAL bugzilla and I will have Andrey look into it when
   he gets a chance.

or

   both.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Mar 24 14:06:07 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] How can I initialize the GDALDataset structures without
 calling GDALOpen
In-Reply-To: <4061D11C.FF791F53@ualg.pt>
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc> <00e701c40ebe$cc1eeb50$6401a8c0@dougpc> <405F0C95.5090809@pobox.com> <405F1E73.CC76615B@ualg.pt> <4061D11C.FF791F53@ualg.pt>
Message-ID: <4061DC1F.4080802@pobox.com>

Joaquim Luis wrote:
> Hi,
> I hope this not a very idiot question.
> I want to write Matlab mex files that mimic the functionality of gdal_translate
> and gdalwarp. The problem is that I already have the image data (and the
> corresponding
> info) in memory, and they where not obtained by a call to GDALOpen. As such, the
> GDALDataset structures were not initialized and the rest of the code won't work.
> My question is, how can I handle this situation?
> Has someone solved this before? That is, is there any code that I can use as an
> example?

Joachim,

I'm not exactly clear on what you are doing.  Are you wanting to do a memory
to memory warp?  A memory to disk write?

I think you should read over the information about the "In Memory" format.
This is a GDAL driver that allows you to describe an array in memory as a
GDAL dataset.  This is often used as a pre-step to using GDALCreateCopy()
to create a copy of the image on disk.

   http://www.remotesensing.org/gdal/frmt_mem.html

Basically, you will constuct an esoteric string "dataset name" describing
the memory array, and then call GDALOpen() on that to create a dataset handle
for a memory array.  Then you can attach metadata, georeferencing and so on
normally and use the dataset handle with other GDAL functions like the warper
or GDALCreateCopy().

Once you have made an effort at this feel free to ask for more detail on parts
that are giving you problems ... but some more specific context would be helpful.

Good luck,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jason.hughes at elantech-inc.com  Wed Mar 24 15:04:25 2004
From: jason.hughes at elantech-inc.com (Jason R Hughes)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Creation of geotiff files with gdalwarp that have a transparent background
References: <Pine.LNX.4.44.0403011818480.16752-100000@cusco.gsfc.nasa.gov>
Message-ID: <01bb01c411db$38236410$1da8a8c0@machamp>

> The underlying Warp API does contain mechanisms whereby an application
> might be able to maintain an alpha band properly, but the gdalwarp
> program has no mechanism to take advantage of it.  Furthermore, this
> hasn't really be used in the warp api so there may be issues I didn't
> anticipate.
> 
> Currently, the gdalwarp assumption is that nodata pixel values will be
> used to mark unset areas.  So that might involve picking a "background"
> value, like 0, to mark all unset areas.  INIT_DEST could be used to
> pre-apply this to the output file if a non-zero value were used.  Then
> the warper would replace all pixels for which a value exists.   No mechanism
> exists to ensure that the nodata value doesn't existing in the valid image
> data though.
> 
> I think it would make sense to modify gdalwarp to explicitly support
> transparency layers.  Some common forms I could imagine are:
> 
>   o An extra output band used to hold transparency.  Normally this would
>     be assigned 0 to unset pixels and 255 for set pixels.

This feature would be extremely useful for my situation as well.  I do not necessarily need the first more difficult option (the ability to create an additional transparent band) as I would only need the ability to filter out the aformentioned "nodata" value in the image.  Both methods would work for my situation though.  I could write the necessary code if need be.  I was thinking the most consistant to your way of doing things was to add another option in papszWarpOptions called REPLACE = TRUE or FALSE.

Then after the rasterdata is fetched in WarpRegionToBuffer() from the source file I would loop through the source data doing the following:

for(i = 0; i < (nWordSize * nSrcXSize * nSrcYSize); i++)
{

    BOOL noData = FALSE;

    for (int j = 0; j<psOptions->nBandCount; j++)
    {
        if(oWK.papabySrcImage[0][i + j * (nSrcXSize * nSrcYSize)] == initDest[j])
            noData = TRUE;
        else 
        {
            noData = FALSE;
            break;
        }
    }

    if(noData)
        for (int j = 0; j<psOptions->nBandCount; j++)
            oWK.papabySrcImage[0][i + j * (nSrcXSize * nSrcYSize)]++;
}


If this method seems utterly inefficient let me know.

Thanks,
Jason R. Hughes
Elantech, Inc. 
6411 Ivy Lane, Suite 300
Greenbelt, MD 20770
Phone: 301-486-0600
jason.hughes@elantech-inc.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040324/44304b15/attachment.html
From dron at ak4719.spb.edu  Wed Mar 24 16:39:51 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <4061DA21.4090005@pobox.com>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org> <4061B4F5.4030900@pobox.com> <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org> <4061DA21.4090005@pobox.com>
Message-ID: <20040324213951.GA19747@ak4719.spb.edu>

On Wed, Mar 24, 2004 at 01:57:37PM -0500, Frank Warmerdam wrote:
> I tried downloading the HDF4.2r0 for linux and ran into what I presume
> are similar problem.  It seems the library uses a function called
> "szip_compress_memory" that is not included with the libraries and is
> not part of libz or anything else I can find.

szip is a non-free additional compression method, used in HDF library.
I'm always recompile libhdf without support for szip.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From imd_listuser at comcast.net  Wed Mar 24 20:03:25 2004
From: imd_listuser at comcast.net (IMD Listuser)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data...
Message-ID: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net>

Greetings all

I would like to be able to use a global bathymetric data set stored in a
format which I am unfamiliar with and wondering if GDAL supports it.

The url to the data set is:
ftp://topex.ucsd.edu/pub/global_topo_2min/

The file is topo_8.2.img and there appears to be a header
topo_8.2.img.ers which refers to an ERStaorage format. Ive tried using
gdalinfo to retrieve info about the file, but I receive an error to the
effect of 'not an HFA file'.

Ideally I would like to move this data into GeoTIFF format.

Any ideas, suggestions, or advice.

Thanks

Charlie

Charlie Van Dusen
IM Design
charlie@im-design.net
+1 781.389.0343


From nhv at cape.com  Wed Mar 24 21:13:10 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data...
In-Reply-To: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net>
Message-ID: <EKEJIKAILPONGGENMBGAMEBFGOAA.nhv@cape.com>

IMD Listuser writes:
> 
> I would like to be able to use a global bathymetric data set stored in a
> format which I am unfamiliar with and wondering if GDAL supports it.
> 
> The url to the data set is:
> ftp://topex.ucsd.edu/pub/global_topo_2min/
> 
> The file is topo_8.2.img and there appears to be a header
> topo_8.2.img.ers which refers to an ERStaorage format. Ive tried using
> gdalinfo to retrieve info about the file, but I receive an error to the
> effect of 'not an HFA file'.
> 
> Ideally I would like to move this data into GeoTIFF format.

Use this program to translate into a latlon netcdf file
ftp://topex.ucsd.edu/pub/global_topo_2min/src_gmt/img2latlongrd.c

and then use gdaltranslate 

Norman

From imd_listuser at comcast.net  Wed Mar 24 21:43:56 2004
From: imd_listuser at comcast.net (IMD Listuser)
Date: Wed Nov 21 11:49:06 2007
Subject: [SPAM] - RE: [Gdal-dev] Bathymetry data... - Email found in subject
Message-ID: <90264B8395BF154DB2CB12B068DFFAE903AF8F@westward.im-design.net>

Which format does img2latlongrd.c produce? Netcdf?

I don't believe that gdal_translate supports netcdf? Does it?

Im running a recent version of gdal. Here is some output:

GDAL 1.1.9.0, released 2003/06/27

The following format drivers are configured and support output:
  VRT: Virtual Raster
  GTiff: GeoTIFF
  NITF: National Imagery Transmission Format
  HFA: Erdas Imagine Images (.img)
  ELAS: ELAS
  AAIGrid: Arc/Info ASCII Grid
  DTED: DTED Elevation Raster
  PNG: Portable Network Graphics
  JPEG: JPEG JFIF
  MEM: In Memory Raster
  GIF: Graphics Interchange Format (.gif)
  BSB: Maptech BSB Nautical Charts
  XPM: X11 PixMap Format
  BMP: MS Windows Device Independent Bitmap
  PCIDSK: PCIDSK Database File
  PNM: Portable Pixmap Format (netpbm)
  ENVI: ENVI .hdr Labelled
  EHdr: ESRI .hdr Labelled
  PAux: PCI .aux Labelled
  MFF: Atlantis MFF Raster
  MFF2: Atlantis MFF2 (HKV) Raster
  BT: VTP .bt (Binary Terrain) 1.3 Format
  FIT: FIT Image

Any ideas where netcdf fits?

Thanks 


Charlie Van Dusen
charlie@im-design.net

-----Original Message-----
From: gdal-dev-admin@remotesensing.org
[mailto:gdal-dev-admin@remotesensing.org] On Behalf Of Norman Vine
Sent: Wednesday, March 24, 2004 9:13 PM
To: gdal-dev@remotesensing.org
Subject: [SPAM] - RE: [Gdal-dev] Bathymetry data... - Email found in
subject

IMD Listuser writes:
> 
> I would like to be able to use a global bathymetric data set stored in

> a format which I am unfamiliar with and wondering if GDAL supports it.
> 
> The url to the data set is:
> ftp://topex.ucsd.edu/pub/global_topo_2min/
> 
> The file is topo_8.2.img and there appears to be a header 
> topo_8.2.img.ers which refers to an ERStaorage format. Ive tried using

> gdalinfo to retrieve info about the file, but I receive an error to 
> the effect of 'not an HFA file'.
> 
> Ideally I would like to move this data into GeoTIFF format.

Use this program to translate into a latlon netcdf file
ftp://topex.ucsd.edu/pub/global_topo_2min/src_gmt/img2latlongrd.c

and then use gdaltranslate 

Norman
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev



From nhv at cape.com  Wed Mar 24 22:10:36 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:06 2007
Subject: [SPAM] - RE: [Gdal-dev] Bathymetry data... - Email found in subject
In-Reply-To: <90264B8395BF154DB2CB12B068DFFAE903AF8F@westward.im-design.net>
Message-ID: <EKEJIKAILPONGGENMBGAMEBIGOAA.nhv@cape.com>

MD Listuser writes:
> 
> Which format does img2latlongrd.c produce? Netcdf?
> 
> I don't believe that gdal_translate supports netcdf? Does it?
> 
> Im running a recent version of gdal. Here is some output:
> 
> GDAL 1.1.9.0, released 2003/06/27

You will need to update your GDAL installation and probably 
explicitly configure the netcdf support

HTH

Norman

From imd_listuser at comcast.net  Thu Mar 25 06:28:54 2004
From: imd_listuser at comcast.net (IMD Listuser)
Date: Wed Nov 21 11:49:06 2007
Subject: [SPAM] - RE: [SPAM] - RE: [Gdal-dev] Bathymetry data... - Email found in subject - Email found in subject
Message-ID: <90264B8395BF154DB2CB12B068DFFAE903AF91@westward.im-design.net>

One more question:

-How do I know when I have netcdf support? Do I use the --versions
argument to gdal_translate (as I thought)?

Reason I ask is that I did just rebuild gdal with the netcdf libraries
(uncommented in the nmake.opt file) but I still see no change in the
list titled: 'The following format drivers are configured and support
output:'

TIA

Charlie


Charlie Van Dusen
charlie@im-design.net

-----Original Message-----
From: gdal-dev-admin@remotesensing.org
[mailto:gdal-dev-admin@remotesensing.org] On Behalf Of Norman Vine
Sent: Wednesday, March 24, 2004 10:11 PM
To: gdal-dev@remotesensing.org
Subject: [SPAM] - RE: [SPAM] - RE: [Gdal-dev] Bathymetry data... - Email
found in subject - Email found in subject

MD Listuser writes:
> 
> Which format does img2latlongrd.c produce? Netcdf?
> 
> I don't believe that gdal_translate supports netcdf? Does it?
> 
> Im running a recent version of gdal. Here is some output:
> 
> GDAL 1.1.9.0, released 2003/06/27

You will need to update your GDAL installation and probably explicitly
configure the netcdf support

HTH

Norman
_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev



From warmerdam at pobox.com  Thu Mar 25 09:17:08 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data...
In-Reply-To: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net>
References: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net>
Message-ID: <4062E9E4.5070506@pobox.com>

IMD Listuser wrote:
> Greetings all
> 
> I would like to be able to use a global bathymetric data set stored in a
> format which I am unfamiliar with and wondering if GDAL supports it.
> 
> The url to the data set is:
> ftp://topex.ucsd.edu/pub/global_topo_2min/
> 
> The file is topo_8.2.img and there appears to be a header
> topo_8.2.img.ers which refers to an ERStaorage format. Ive tried using
> gdalinfo to retrieve info about the file, but I receive an error to the
> effect of 'not an HFA file'.
> 
> Ideally I would like to move this data into GeoTIFF format.

Charlie,

The suggestions with regard to converting to netcdf format and then accessing
via GDAL would likely work but may be a bit of a hassle.  The README_V8.2
says:

"""
The gridded data are stored in an integer*2 format without any
header or record information.

*.img              A 6336 by 10800 grid of 2-byte integers = 136,857,600 bytes.
                    Byte order is big_endian.
                    The topography is meters above sea level. An even
                    value signifies the cell does not have a ship or coastline
                    measurement while an odd value signifies that it does.
                    The Mercator projected image spans longitudes from 0 E to
                    360 E and latitudes from 72.006 N to -72.006 N.
                    A spherical earth is used for the Mercator projection.
                    The center of the upper left grid cell (i.e. the first
                    integer in the file) is located at 72.0009 N, .01667 E.
                    Longtiudes increase with a 1/30 degree spacing.  The
                    The center of the last integer in the file is located
                    at -72.0009 N, 359.933 E.  Note the latitude spacing is
                    1/30 degree at the equator but decreases as 1/cos(latitude)
                    according to a Mercator projection on a sphere.
"""

So, I think the easiest thing would just be to write a .aux file for this.
Likely something like:

--- start of topo_8.2.aux ---
AuxilaryTarget: topo_8.2.img
RawDefinition: 10800 6336 1
ChanDefinition-1: 16U 0 2 21600 Unswapped
--- end of .aux file ---

I found the projection information kind of confusing, so I didn't try to
replicate that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Mar 25 10:03:19 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data...
In-Reply-To: <4062E9E4.5070506@pobox.com>
References: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net> <4062E9E4.5070506@pobox.com>
Message-ID: <4062F4B7.4080902@pobox.com>

Frank Warmerdam wrote:
> So, I think the easiest thing would just be to write a .aux file for this.
> Likely something like:
> 
> --- start of topo_8.2.aux ---
> AuxilaryTarget: topo_8.2.img
> RawDefinition: 10800 6336 1
> ChanDefinition-1: 16U 0 2 21600 Unswapped
> --- end of .aux file ---
> 
> I found the projection information kind of confusing, so I didn't try to
> replicate that.

Folks,

Following up my own post, I found the data is actually signed so you need to
use 16S instead of 16U for the data type.  Also, I added the map information
and it seems to sort of work.  Not sure if it is accurate though.

AuxilaryTarget: topo_8.2.img
RawDefinition: 10800 6336 1
ChanDefinition-1: 16S 0 2 21600 Unswapped
UpLeftX: 0
UpLeftY: 72.006
LoRightX: 360
LoRightY: -72.006
MapUnits: LAT D000

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From jluis at ualg.pt  Thu Mar 25 10:17:09 2004
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] How can I initialize the GDALDataset structures 
 withoutcalling GDALOpen
References: <007d01c40de2$b4c0f110$6401a8c0@dougpc> <00e701c40ebe$cc1eeb50$6401a8c0@dougpc> <405F0C95.5090809@pobox.com> <405F1E73.CC76615B@ualg.pt> <4061D11C.FF791F53@ualg.pt> <4061DC1F.4080802@pobox.com>
Message-ID: <4062F7F5.85F7F35C@ualg.pt>


Frank Warmerdam wrote:

> I'm not exactly clear on what you are doing.  Are you wanting to do a memory
> to memory warp?  A memory to disk write?
>
> I think you should read over the information about the "In Memory" format.
> This is a GDAL driver that allows you to describe an array in memory as a
> GDAL dataset.  This is often used as a pre-step to using GDALCreateCopy()
> to create a copy of the image on disk.
>
>    http://www.remotesensing.org/gdal/frmt_mem.html
>
> Basically, you will constuct an esoteric string "dataset name" describing
> the memory array, and then call GDALOpen() on that to create a dataset handle
> for a memory array.  Then you can attach metadata, georeferencing and so on
> normally and use the dataset handle with other GDAL functions like the warper
> or GDALCreateCopy().
>
> Once you have made an effort at this feel free to ask for more detail on parts
> that are giving you problems ... but some more specific context would be helpful.
>

Frank,
Thanks for your answer. I'll try to be more specific.
Matlab provides a mechanism by which we can write interfaces between existing C code
and the Matlab engine.
Namely, a function called the Matlab gateway has the following form
void mexFunction(int nlhs, mxArray *plhs[], int nrhs, mxArray *prhs[]);
To simplify lets just say that nrhs is the number of input arguments and prhs contains

whatever data we want to transmit to this function.
With this I can transmit, for example, a 3D matrix containing an image data (3D to
account
for the number of Bands) and other pertinent information like pixel size,
georeferencing information, etc...

Its now that GDAL comes in. So I want to do either a memory to memory warp (case in
which
the result will be returned to my Matlab code) or a memory to disk write (save the
transformed
data into a file).
I already used this facility to write a "gdalread" and it's a kind of "gdalwrite" that
I'm after.

I was not aware on the existence of the MEM driver. The man pages I have on my
computer are
from the OpenEV_FW distribution, and they do not refer that driver. It would be nice
if the most
updated html man pages were included with the GDAL distro (the html directory in it is
empty).

Now, I'm willing to make all efforts I can, but I need an extra help for starting. I
am not a c++
programer and I got confused on how to use the MEM driver. You mentioned the need to
"construct an esoteric string "dataset name" describing the memory array"
but I don't see how I can do it. The MEM example in the page you point me to does not
seam
to return any "dataset name" (but as I said I don't know c++). And because GDALOpen
needs
a dataset name in input I am stuck.

If you want to see what is this for, please take a look at
w3.ualg.pt/~jluis/Mirone

Thanks

Joaquim


From imd_listuser at comcast.net  Thu Mar 25 10:23:37 2004
From: imd_listuser at comcast.net (IMD Listuser)
Date: Wed Nov 21 11:49:06 2007
Subject: [SPAM] - Re: [Gdal-dev] Bathymetry data... - Email found in subject
Message-ID: <90264B8395BF154DB2CB12B068DFFAE903AF98@westward.im-design.net>

Thanks for the tip Frank,

I am unfamiliar with the .aux format. How will it help me move the data
to geotiff?

Thanks 


Charlie Van Dusen
charlie@im-design.net

-----Original Message-----
From: gdal-dev-admin@remotesensing.org
[mailto:gdal-dev-admin@remotesensing.org] On Behalf Of Frank Warmerdam
Sent: Thursday, March 25, 2004 10:03 AM
To: gdal-dev@remotesensing.org
Subject: [SPAM] - Re: [Gdal-dev] Bathymetry data... - Email found in
subject

Frank Warmerdam wrote:
> So, I think the easiest thing would just be to write a .aux file for
this.
> Likely something like:
> 
> --- start of topo_8.2.aux ---
> AuxilaryTarget: topo_8.2.img
> RawDefinition: 10800 6336 1
> ChanDefinition-1: 16U 0 2 21600 Unswapped
> --- end of .aux file ---
> 
> I found the projection information kind of confusing, so I didn't try 
> to replicate that.

Folks,

Following up my own post, I found the data is actually signed so you
need to use 16S instead of 16U for the data type.  Also, I added the map
information and it seems to sort of work.  Not sure if it is accurate
though.

AuxilaryTarget: topo_8.2.img
RawDefinition: 10800 6336 1
ChanDefinition-1: 16S 0 2 21600 Unswapped
UpLeftX: 0
UpLeftY: 72.006
LoRightX: 360
LoRightY: -72.006
MapUnits: LAT D000

Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

_______________________________________________
Gdal-dev mailing list
Gdal-dev@remotesensing.org
http://remotesensing.org/mailman/listinfo/gdal-dev



From jluis at ualg.pt  Thu Mar 25 10:35:26 2004
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data...
References: <90264B8395BF154DB2CB12B068DFFAE903AF8E@westward.im-design.net> <4062E9E4.5070506@pobox.com>
Message-ID: <4062FC3E.C43DD696@ualg.pt>

That file (in some other formats) can also be found at
http://dss.ucar.edu/datasets/ds759.3/data/
There is a product called arcgmt that transforms GMT grids into arcinfo ascii
grids.
However, given the size of this file I don't know if it is practicable to have it
transformed into ascii.
I made a very nice figure with that data that you can get from
ftp.ualg.pt/users/jluis/m_gmt/etopo2.jpg
It is in jpeg, but if you write a tfw file you can transform it to GeoTIFF.


From geoffreyfw at yahoo.com  Thu Mar 25 11:34:07 2004
From: geoffreyfw at yahoo.com (Geoffrey Williams)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] problems loading LandScan (ESRI GRID) with r.in.gdal
Message-ID: <20040325163407.3437.qmail@web20807.mail.yahoo.com>

I have been working with r.in.gdal in Grass5 and am
having an odd problem:

I am working with the LandScan dataset
(http://www.ornl.gov/sci/gist/landscan/) , and all
sections have been loading fine with r.in.gdal, with
the exception of part of India, where I get a "rip"
across part of the data. Specifically, a rectangle
roughly from 76:00 East to 78:08 East and from 28:40
North to 28:36 North loads as null (since the LandScan
data is at 30''x30'' this is about 8 by 256 squares by
my count). 

I get an error message when r.in.gdal is loading the
LandScan data set:
"Warning 1: Unsupported Arc/Info Binary Grid tile of
type 0x20 encountered. This and subsequent unsupported
tile types set to no data value"

I am in contact with Oak Ridge (who prepare the
LandScan data set). They are being very helpful, but
they have no trouble loading it and have never heard
of this problem.

I sent an earlier version of this message to the Grass
users mailing list and was advised to use hexdump to
look through the file for "20"s.  I've tried that, but
the overall Asia file has nearly 100,000  instances of
"20" (I get this using grep -c).  

Is there some way to distinguish which of the "20"s is
causing the trouble? Perhaps some of them are
coordinates and some of them are data? Is there any
way to either hand edit the file to remove the
offending tiles or alternatively, is there some way to
tell r.in.gdal to accept the data?

Thank you,

Geoffrey Williams

From imd_listuser at comcast.net  Thu Mar 25 12:06:30 2004
From: imd_listuser at comcast.net (IMD Listuser)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Transforming geographic coords from 0_360 to -180_180?
Message-ID: <90264B8395BF154DB2CB12B068DFFAE903AF99@westward.im-design.net>

Greesting again list

I was able to use gdal_translate to create a GeoTIFF once I recompiled
gdal with the support for netCDF and the recently updated nmake.opt and
makefile(s). Thanks to Norman and Frank ;)

Now I have follow-on question(s)

-Is it possible to control the color depth of the output geotiff using
gdal_translate. I am not able to open the file in photoshop. The error
it throws is something like unsupported color depth.

-Can gdal_translate produce a world file along with the geotiff?

-The original bounds of the netCDF data are expressed in decimal degrees
from 0 to 360. What is the best way for me to convert to standard
hemispheric decimal degrees (-180 to 0 then 0 to 180)?

TIA

Charlie

Charlie Van Dusen
IM Design
charlie@im-design.net
+1 781.389.0343


From warmerdam at pobox.com  Thu Mar 25 12:35:47 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:06 2007
Subject: [Gdal-dev] Bathymetry data... - Email found in subject
In-Reply-To: <90264B8395BF154DB2CB12B068DFFAE903AF98@westward.im-design.net>
References: <90264B8395BF154DB2CB12B068DFFAE903AF98@westward.im-design.net>
Message-ID: <40631873.1070009@pobox.com>

IMD Listuser wrote:
> Thanks for the tip Frank,
> 
> I am unfamiliar with the .aux format. How will it help me move the data
> to geotiff?

Charlie,

The .aux format (PCI .aux labelled raw raster) is a simple header file for
describing raw datasets.  It is supported in GDAL, so once you write a .aux
file for an otherwise unsupported file, you should be able to refer to the
original raw file, and GDAL will pick up the .aux file automatically to
determine the data format.  So, once you have the appropriate .aux file
you can just do something like:

gdal_translate topo_8.2.img topo_8.2.tif

I would note the error message about not being HFA does not occur in modern
GDAL builds.  While .aux format is support in GDAL 1.1.8 you may find you need
to upgrade to 1.2.0 if it continues to complain about being HFA format (or
rename the file topo_8.2.notimg ... that would do the trick to. :-)

PS. I am partial to the .aux format beause I designed it while at PCI.  However,
there are other similar mechanisms such as the .ers file distributed with the
data.  It's just that they aren't necessarily supported by GDAL.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Thu Mar 25 12:53:43 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Transforming geographic coords from 0_360 to -180_180?
In-Reply-To: <90264B8395BF154DB2CB12B068DFFAE903AF99@westward.im-design.net>
References: <90264B8395BF154DB2CB12B068DFFAE903AF99@westward.im-design.net>
Message-ID: <40631CA7.5090804@pobox.com>

IMD Listuser wrote:
> Greesting again list
> 
> I was able to use gdal_translate to create a GeoTIFF once I recompiled
> gdal with the support for netCDF and the recently updated nmake.opt and
> makefile(s). Thanks to Norman and Frank ;)

Charlie,

Cool, I'm glad the netcdf route worked.

> Now I have follow-on question(s)
> 
> -Is it possible to control the color depth of the output geotiff using
> gdal_translate. I am not able to open the file in photoshop. The error
> it throws is something like unsupported color depth.

The gdal_translate utility has a -ot switch which you can use to set
the pixel type of the output file.  For example the following command
would convert a file to 8bit unsigned. However, it does it by truncating
all values outside the range 0-255 (les than 0 to 0, greater than 255 to 255).

gdal_translate -ot Byte in.tif out.tif

To actually scale the data, you can use the -scale switch.  There are
various configurations, but often the default (auto scaling) is fine.

   gdal_translate -scale -ot Byte in.tif out.tif

See the gdal_translate usage message for a full list of output data types.

> -Can gdal_translate produce a world file along with the geotiff?

If you read the GeoTIFF format driver docs, you will see there is creation
option for this.  You could use it like this:

   gdal_translate -co TFW=YES in.tif out.tif

The resulting file would have an out.tfw file.

> -The original bounds of the netCDF data are expressed in decimal degrees
> from 0 to 360. What is the best way for me to convert to standard
> hemispheric decimal degrees (-180 to 0 then 0 to 180)?

This is a bit tricky because you effectively need to swap the sides of the
image.  You could split the file into two hemispheres like this:

   gdal_translate -srcwin 0 0 5400 6336 in.tif    east.tif
   gdal_translate -of PAux -srcwin 5400 0 5400 6336 in.tif west.raw

Now, I made the west side into a PAux file so I could easily edit the
georeferencing.  Just edit west.aux and change the map x coordinates to
look like this:

AuxilaryTarget: west.raw
RawDefinition: 5400 6336 1
ChanDefinition-1: 16S 0 2 10800 Swapped
UpLeftX: -180.000000000000
UpLeftY: 72.006000000000
LoRightX: 0.000000000000
LoRightY: -72.006000000000

Now, if you have a full GDAL system, with python, you could use the
gdal_merge.py script to merge the east and west side into one file again:


   python ~/gdal/pymod/gdal_merge.py -o merged.tif east.tif west.raw

Of course there are other ways of accomplishing the same thing, but hopefully
this is helpful.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From lorenzo.moretti at bologna.enea.it  Fri Mar 26 07:35:12 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <20040324213951.GA19747@ak4719.spb.edu>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org>
 <4061B4F5.4030900@pobox.com>
 <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org>
 <4061DA21.4090005@pobox.com> <20040324213951.GA19747@ak4719.spb.edu>
Message-ID: <a06100403bc8898128015@[192.107.62.86]>

I have GDAL 1.2.0 for OS X built with HDF 4.2r0 support in my GRASS 
LIBRARIES for OS X version (see below for site)

This version is built from HDF version in
ftp://ftp.ncsa.uiuc.edu/HDF/HDF/HDF4.2r0/bin/macosx

Grass does not import HDF directly from r.in.gdal but you have to 
convert to tif with GDAL. (Is it true Andrey ?)

 From my Grass_Libraries

Importing ASTER Level1A and B (HDF files)
HDF version 5 is incompatible with HDF version 4. Aster Level 1A and 
Level 1B are in HDF-EOS format (version 4 of HDF library).
You must convert HDF files in GeoTiff for importing HDF in other 
programs like GRASS. Now it's impossible to import directly HDF.
You must use gdalwarp utility.This is the method:

[lor:~] lor% /usr/local/grasslib/bin/gdalwarp -t_srs 
'projection_of_output' name_of_subdataset_of_hdf name_of_output_file

In this example I convert HDF files to geotiff file in utm zone 33 projection.

Open Terminal and enter

[lor:~] lor% /usr/local/grasslib/bin/gdalwarp -t_srs '+proj=utm 
+zone=33 +datum=WGS84' 
HDF4_SDS:ASTER_L1B:"/file_ASTER/AST_L1B_003_01102002101254_05222002150244.hdf":2 
/aster_tif/aster1.tif

.... and so on for all subdataset.

One geotiff file for any subdatasets: in Aster level_1B I have 15 Geotiff files


Some new HDF files have new szip compression

Bye

-- 
________________________________________________________________________
||       Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|   ENEA prot/idr          Web: http://wwwamb.bologna.enea.it/    
||   |   via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (res.)
~~~~~~   40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
			Download GRASS for MAC OS X:    
	           http://wwwamb.bologna.enea.it/forgrass/
________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040326/d818b5bc/attachment.html
From dron at ak4719.spb.edu  Fri Mar 26 08:15:20 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <a06100403bc8898128015@[192.107.62.86]>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org> <4061B4F5.4030900@pobox.com> <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org> <4061DA21.4090005@pobox.com> <20040324213951.GA19747@ak4719.spb.edu> <a06100403bc8898128015@[192.107.62.86]>
Message-ID: <20040326131520.GA3376@ak4719.spb.edu>

On Fri, Mar 26, 2004 at 01:35:12PM +0100, Lorenzo Moretti wrote:
> Grass does not import HDF directly from r.in.gdal but you have to 
> convert to tif with GDAL. (Is it true Andrey ?)

No. If you can convert HDF file using GDAL then you can import that file
with r.in.gdal. Just use name of subdataset on input.

> You must convert HDF files in GeoTiff for importing HDF in other 
> programs like GRASS. Now it's impossible to import directly HDF.
> You must use gdalwarp utility.This is the method:
> 
> [lor:~] lor% /usr/local/grasslib/bin/gdalwarp -t_srs 
> 'projection_of_output' name_of_subdataset_of_hdf name_of_output_file

It is not converting, it is warping. You will get completely different
image on output, because input scene will be rotated. If you want
just convert HDF subdataset into GeoTIFF you should use gdal_translate.

> One geotiff file for any subdatasets: in Aster level_1B I have 15 Geotiff 
> files

Yes, that's true. Note, that subdatasets from the same instrument can be
combined in the single multiband file (using simple Python script).

> Some new HDF files have new szip compression

Please, tell me what data uses szip? Never seen that before. Usually
data distributers don't use any compression at all.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From lorenzo.moretti at bologna.enea.it  Fri Mar 26 09:32:40 2004
From: lorenzo.moretti at bologna.enea.it (Lorenzo Moretti)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <20040326131520.GA3376@ak4719.spb.edu>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org>
 <4061B4F5.4030900@pobox.com>
 <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org>
 <4061DA21.4090005@pobox.com> <20040324213951.GA19747@ak4719.spb.edu>
 <a06100403bc8898128015@[192.107.62.86]>
 <20040326131520.GA3376@ak4719.spb.edu>
Message-ID: <a06100402bc89eacb4144@[192.107.62.86]>

>On Fri, Mar 26, 2004 at 01:35:12PM +0100, Lorenzo Moretti wrote:
>>  Grass does not import HDF directly from r.in.gdal but you have to
>>  convert to tif with GDAL. (Is it true Andrey ?)
>
>No. If you can convert HDF file using GDAL then you can import that file
>with r.in.gdal. Just use name of subdataset on input.

Andrey

I have enter in r.in.gdal box (GIS file input) subdataset file:

HDF4_SDS:ASTER_L1B:"/file_ASTER//AST_L1B_003_01102002101254_05222002150244.hdf":2

but I have this error in output:

ERROR: Input map is rotated - cannot import. You may use 'gdalwarp' to
        transform the map to North-up.

This error does not permit me to import HDF file into GRASS but I 
must use gdalwarp in terminal.
Is this correct?

>  > You must convert HDF files in GeoTiff for importing HDF in other
>>  programs like GRASS. Now it's impossible to import directly HDF.
>>  You must use gdalwarp utility.This is the method:
>>
>>  [lor:~] lor% /usr/local/grasslib/bin/gdalwarp -t_srs
>>  'projection_of_output' name_of_subdataset_of_hdf name_of_output_file
>
>It is not converting, it is warping. You will get completely different
>image on output, because input scene will be rotated. If you want
>just convert HDF subdataset into GeoTIFF you should use gdal_translate.

Ok it is warping but this method creates a geotiff file: I don't use 
gdal_translate.
I enter in terminal:

[lor:~] lor% /usr/local/grasslib/bin/gdalwarp -t_srs '+proj=utm 
+zone=33 +datum=WGS84' 
HDF4_SDS:ASTER_L1B:"/file_ASTER/AST_L1B_003_01102002101254_05222002150244.hdf":2 
/aster_tif/aster1.tif

I write at the end aster1.tif and I have a geotif output.

Is this wrong ?

>  > One geotiff file for any subdatasets: in Aster level_1B I have 15 Geotiff
>>  files
>
>Yes, that's true. Note, that subdatasets from the same instrument can be
>combined in the single multiband file (using simple Python script).

OK. I have 15 geotiff

>Some new HDF files have new szip compression
>Please, tell me what data uses szip? Never seen that before. Usually
>data distributers don't use any compression at all.
>
>						Andrey

I read this information in one small note in a web page (I don't 
remember in what site) for this format but like you I have not seen 
until now this method. HDF from distributor is without compression 
but I suspect that new HDF format will be much greater in size and 
perhaps this szip compression is for the future. I don't know it: 
it's only my opinion.

Bye

-- 
________________________________________________________________________
||       Lorenzo Moretti        e-mail: lorenzo.moretti@bologna.enea.it     
||/|/|   ENEA prot/idr          Web: http://wwwamb.bologna.enea.it/    
||   |   via Don Fiammelli, 2   FTP: ftp://ftpamb.bologna.enea.it/ (res.)
~~~~~~   40128 BOLOGNA - ITALY  Ph: +39-0516098086  Fax: +39-0516098131
			Download GRASS for MAC OS X:    
	           http://wwwamb.bologna.enea.it/forgrass/
________________________________________________________________________
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040326/9c9da83f/attachment.html
From dron at ak4719.spb.edu  Fri Mar 26 09:55:06 2004
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: GDAL with HDF on OSX
In-Reply-To: <a06100402bc89eacb4144@[192.107.62.86]>
References: <B5A28DC2-7DAA-11D8-98E0-000A95D05840@fao.org> <4061B4F5.4030900@pobox.com> <E3F947FA-7DB1-11D8-98E0-000A95D05840@fao.org> <4061DA21.4090005@pobox.com> <20040324213951.GA19747@ak4719.spb.edu> <a06100403bc8898128015@[192.107.62.86]> <20040326131520.GA3376@ak4719.spb.edu> <a06100402bc89eacb4144@[192.107.62.86]>
Message-ID: <20040326145506.GA15698@ak4719.spb.edu>

On Fri, Mar 26, 2004 at 03:32:40PM +0100, Lorenzo Moretti wrote:
> I have enter in r.in.gdal box (GIS file input) subdataset file:
> 
> HDF4_SDS:ASTER_L1B:"/file_ASTER//AST_L1B_003_01102002101254_05222002150244.hdf":2
> 
> but I have this error in output:
> 
> ERROR: Input map is rotated - cannot import. You may use 'gdalwarp' to
>        transform the map to North-up.
> 
> This error does not permit me to import HDF file into GRASS but I 
> must use gdalwarp in terminal.

Ah, yes, r.in.gdal wants rotated dataset. Then your approach is right,
you should process the input dataset with gdalwarp. But remember, this
is valid for that particular data type only, not for HDF files in
general.

						Andrey

-- 
Andrey V. Kiselev
Home phone:  +7 812 5274898  ICQ# 26871517

From neteler at itc.it  Fri Mar 26 10:46:51 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <1079655023.9341.31.camel@afreet.lanl.gov>
References: <20040318144105.GS4135@thuille.itc.it> <200403181723.14331.m.massing@warped-space.de> <20040318171130.GA1165@thuille.itc.it> <4059DED8.9030004@pobox.com> <1079655023.9341.31.camel@afreet.lanl.gov>
Message-ID: <20040326154651.GP17194@thuille.itc.it>

On Thu, Mar 18, 2004 at 05:10:23PM -0700, Simon Perkins wrote:
> On Thu, 2004-03-18 at 10:39, Frank Warmerdam wrote:
> 
> > It had been my intention that GDAL would gracefully handle strips or
> > tiles that have an offset and size of zero as "auto-nodata".  Apparently
> > I did not complete that properly.   I will look into this.  Currently
> > preinitializing to zero should resolve the problem but I realize that is
> > not so easy to do.

Sorry to be ignorant, but how to preinitialize to zero?

I was using:

 gdal_merge.py -f GTiff -n -9999 -o lomb20m.tif \
    `find /cdimage/DEM/grid | grep w001001x`

to do the mosaiking.
 
> I've only just joined this discussion so I might have missed something,
> but the GDAL C API does contain a GDALFillRaster() function which allows
> you to fill a band with a particular constant value. There's a
> corresponding GDALRasterBand::Fill() C++ method as well.
> 
> I don't know if there are any python bindings for this function though
> if that's what you need..
> 
> Cheers,
> 
> Sy

Still appreciating help :-)

 Markus


From warmerdam at pobox.com  Fri Mar 26 12:14:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <20040326154651.GP17194@thuille.itc.it>
References: <20040318144105.GS4135@thuille.itc.it> <200403181723.14331.m.massing@warped-space.de> <20040318171130.GA1165@thuille.itc.it> <4059DED8.9030004@pobox.com> <1079655023.9341.31.camel@afreet.lanl.gov> <20040326154651.GP17194@thuille.itc.it>
Message-ID: <406464E4.5020204@pobox.com>

Markus Neteler wrote:
> On Thu, Mar 18, 2004 at 05:10:23PM -0700, Simon Perkins wrote:
> 
>>On Thu, 2004-03-18 at 10:39, Frank Warmerdam wrote:
>>
>>
>>>It had been my intention that GDAL would gracefully handle strips or
>>>tiles that have an offset and size of zero as "auto-nodata".  Apparently
>>>I did not complete that properly.   I will look into this.  Currently
>>>preinitializing to zero should resolve the problem but I realize that is
>>>not so easy to do.
> 
> 
> Sorry to be ignorant, but how to preinitialize to zero?
> 
> I was using:
> 
>  gdal_merge.py -f GTiff -n -9999 -o lomb20m.tif \
>     `find /cdimage/DEM/grid | grep w001001x`
> 
> to do the mosaiking.

Markus,

There is currently no way to pre-initialize the file with gdal_merge.py.

... ten minutes pass ...

OK, if you update from CVS there is now a -init commandline option to
gdal_merge.py that will write a given value to all pixels before it starts
merging stuff in.

eg.
   gdal_merge.py -init 0 -f GTiff -n -9999 -o lomb20m.tif \
      `find /cdimage/DEM/grid | grep w001001x`

But there is some sort of underlying problem in the GeoTIFF driver that I
really need to dig into.

PS. I added the Python wrapper for the Fill() method and used that.
Thanks Simon!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From matt.gregory at oregonstate.edu  Fri Mar 26 13:26:43 2004
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] citing GDAL
Message-ID: <EC3C5F40BC462C4C84E6A1F92C2424D3070D14@thuja>

A quick question.  Is there a proper cite for GDAL for inclusion in a
poster or journal article?  I'm currently using the following, but I'm
not sure it recognizes the different contributors to GDAL :

Warmerdam, F.  2004.  GDAL - Geospatial Data Abstraction Library.
http://remotesensing.org/gdal/index.html.

thanks, matt

Matt Gregory
Faculty Research Assistant
Department of Forest Science
Oregon State University
541.750.7285
matt.gregory@orst.edu

From mjd at mars.asu.edu  Fri Mar 26 15:18:56 2004
From: mjd at mars.asu.edu (Michael Darweesh)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] User Question: creating a geotiff from pnm
Message-ID: <40649030.3000304@mars.asu.edu>

I'm new to the gdal lib and mapping and trying to come up to speed as 
fast as I can, newbie help is appreciated.

I'm trying to do this.

I have an in-memory (pnm) raster projected in swiss oblique (EPSG:9814 I 
believe) and I have the data which would be put into a world file in 
memory too. What's the right way to package this image up into a 
geotiff? I'd like to do this all in mempory since I'll be outputting the 
geotiff as an http response. But, I could probably get away with dumping 
it to disk if necessary.

Thanks,
Mike
ps. Is the gdal_translate.c sample code intentionally not showing or am 
I browsing wrong?


From warmerdam at pobox.com  Fri Mar 26 15:38:40 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] User Question: creating a geotiff from pnm
In-Reply-To: <40649030.3000304@mars.asu.edu>
References: <40649030.3000304@mars.asu.edu>
Message-ID: <406494D0.7050701@pobox.com>

Michael Darweesh wrote:
> I'm new to the gdal lib and mapping and trying to come up to speed as 
> fast as I can, newbie help is appreciated.
> 
> I'm trying to do this.
> 
> I have an in-memory (pnm) raster projected in swiss oblique (EPSG:9814 I 
> believe) and I have the data which would be put into a world file in 
> memory too. What's the right way to package this image up into a 
> geotiff? I'd like to do this all in mempory since I'll be outputting the 
> geotiff as an http response. But, I could probably get away with dumping 
> it to disk if necessary.

Michael,

OK, doing this in memory is pretty trick.

On the output side, there is no application accessable support for output
GeoTIFF "in memory".  If you want to do this - as things stands you would
basically have to avoid using the GDAL GeoTIFF driver and call into the
libtiff API yourself.

There is some example code that does something like this in
gdal/frmts/gtiff/gt_wkt_srs.cpp (see GTIFMemBufFromWkt()).  This code is
used to produce degenerate GeoTIFFs with georeferencing info in them that
can be embedded in JP2 files without having to write them temporarily to disk.

We could also look at changing the code driver to support in memory output
under some circumstances but that could be fairly involved.  I would encourage
you to just write to a temporary file and then spool it to stdout.  That is
what I did in a similar situation in MapServer even though I would really like
to have avoided the extra trip to disk.

On the input side, once again, the PNM driver has no support for reading
from memory.  However, the PNM format is pretty simple, so you could manage
it yourself.

At this point we should take a step back and review.  If you are going to
write your own custom code to write to GeoTIFF using libtiff and libgeotiff
(so as to avoid writing to disk), then you don't really need to use GDAL at
all.

However, if you are going to write to disk, then you could parse the PNM
header "manually" and then create a "memory dataset" referencing the data
portion of the PNM file in memory.  This is a bit involved too, so I won't
try and describe it till you decide how you want to go.  If you do want to
use it, try reviewing the "In Memory Format" (MEM) on the web site first.

All in all, GDAL isn't not well organized to handle in-memory images of
files.  If this was needed "in general", then I think the best approach would
be a custom reimplementation of the VSI file io layer used to access files.
With approriate implementation it could support reading and writing memory
or disk.  This might be of use for other purposes as well.  I would certainly
like it for MapServer.

Also, a client is interested in making it possible to embed as the required
GDAL support files within the DLL and one approach to that would be to
virtualize access at the VSI layer.

However, if you just need a quick custom hack for this one situation, I
would suggest writing custom PNM-in-memory to GeoTIFF-in-memory code and
using the GTIFMemBufFromWKt() and related code as a bit of guide.

> Thanks,
> Mike
> ps. Is the gdal_translate.c sample code intentionally not showing or am 
> I browsing wrong?

It is called gdal_translate.cpp, perhaps that is why your not finding it?

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From mjd at mars.asu.edu  Fri Mar 26 16:07:56 2004
From: mjd at mars.asu.edu (Michael Darweesh)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] User Question: creating a geotiff from pnm
In-Reply-To: <406494D0.7050701@pobox.com>
References: <40649030.3000304@mars.asu.edu> <406494D0.7050701@pobox.com>
Message-ID: <40649BAC.8050901@mars.asu.edu>

Thanks for the quick reply, Frank.

It sounds like I'm thinking about this the wrong way. Perhaps I should 
just try gdal_translate and see if that meets my needs before I go 
writing a specialized solution. Then, if it's too slow or not producing 
what I want, then we should talk further. Does that sound sane?


Also, the gdal_translate.c I was typing about was the one on 
http://www.remotesensing.org/gdal/gdal_translate.c.html, not the one in 
the tarball. just maybe a broken link on the website.

-Mike


Frank Warmerdam wrote:

> Michael Darweesh wrote:
>
>> I'm new to the gdal lib and mapping and trying to come up to speed as 
>> fast as I can, newbie help is appreciated.
>>
>> I'm trying to do this.
>>
>> I have an in-memory (pnm) raster projected in swiss oblique 
>> (EPSG:9814 I believe) and I have the data which would be put into a 
>> world file in memory too. What's the right way to package this image 
>> up into a geotiff? I'd like to do this all in mempory since I'll be 
>> outputting the geotiff as an http response. But, I could probably get 
>> away with dumping it to disk if necessary.
>
>
> Michael,
>
> OK, doing this in memory is pretty trick.
>
> On the output side, there is no application accessable support for output
> GeoTIFF "in memory".  If you want to do this - as things stands you would
> basically have to avoid using the GDAL GeoTIFF driver and call into the
> libtiff API yourself.
>
> There is some example code that does something like this in
> gdal/frmts/gtiff/gt_wkt_srs.cpp (see GTIFMemBufFromWkt()).  This code is
> used to produce degenerate GeoTIFFs with georeferencing info in them that
> can be embedded in JP2 files without having to write them temporarily 
> to disk.
>
> We could also look at changing the code driver to support in memory 
> output
> under some circumstances but that could be fairly involved.  I would 
> encourage
> you to just write to a temporary file and then spool it to stdout.  
> That is
> what I did in a similar situation in MapServer even though I would 
> really like
> to have avoided the extra trip to disk.
>
> On the input side, once again, the PNM driver has no support for reading
> from memory.  However, the PNM format is pretty simple, so you could 
> manage
> it yourself.
>
> At this point we should take a step back and review.  If you are going to
> write your own custom code to write to GeoTIFF using libtiff and 
> libgeotiff
> (so as to avoid writing to disk), then you don't really need to use 
> GDAL at
> all.
>
> However, if you are going to write to disk, then you could parse the PNM
> header "manually" and then create a "memory dataset" referencing the data
> portion of the PNM file in memory.  This is a bit involved too, so I 
> won't
> try and describe it till you decide how you want to go.  If you do 
> want to
> use it, try reviewing the "In Memory Format" (MEM) on the web site first.
>
> All in all, GDAL isn't not well organized to handle in-memory images of
> files.  If this was needed "in general", then I think the best 
> approach would
> be a custom reimplementation of the VSI file io layer used to access 
> files.
> With approriate implementation it could support reading and writing 
> memory
> or disk.  This might be of use for other purposes as well.  I would 
> certainly
> like it for MapServer.
>
> Also, a client is interested in making it possible to embed as the 
> required
> GDAL support files within the DLL and one approach to that would be to
> virtualize access at the VSI layer.
>
> However, if you just need a quick custom hack for this one situation, I
> would suggest writing custom PNM-in-memory to GeoTIFF-in-memory code and
> using the GTIFMemBufFromWKt() and related code as a bit of guide.
>
>> Thanks,
>> Mike
>> ps. Is the gdal_translate.c sample code intentionally not showing or 
>> am I browsing wrong?
>
>
> It is called gdal_translate.cpp, perhaps that is why your not finding it?
>
> Best regards,



From warmerdam at pobox.com  Fri Mar 26 16:19:13 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] User Question: creating a geotiff from pnm
In-Reply-To: <40649BAC.8050901@mars.asu.edu>
References: <40649030.3000304@mars.asu.edu> <406494D0.7050701@pobox.com> <40649BAC.8050901@mars.asu.edu>
Message-ID: <40649E51.2080502@pobox.com>

Michael Darweesh wrote:
> Thanks for the quick reply, Frank.
> 
> It sounds like I'm thinking about this the wrong way. Perhaps I should 
> just try gdal_translate and see if that meets my needs before I go 
> writing a specialized solution. Then, if it's too slow or not producing 
> what I want, then we should talk further. Does that sound sane?

Michael,

Yes.

> Also, the gdal_translate.c I was typing about was the one on 
> http://www.remotesensing.org/gdal/gdal_translate.c.html, not the one in 
> the tarball. just maybe a broken link on the website.

Ahh, I see.  The examples documentation has been broken in this regard
for a while I think.   I have removed the gdal_translate from the set of
example code.  It is far to complex as a simple writing example
anyways.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From admin at landsat.com  Sat Mar 27 11:48:18 2004
From: admin at landsat.com (admin@landsat.com)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal_merge w/ ECW output?
Message-ID: <20040327164818.99322.qmail@host146.ipowerweb.com>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040327/6715ecb5/attachment.html
From admin at landsat.com  Sat Mar 27 12:00:57 2004
From: admin at landsat.com (admin@landsat.com)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal_merge w/ ECW output? -plain text
Message-ID: <20040327170057.17228.qmail@host146.ipowerweb.com>

Hi,

I am trying to use gdal_merge and output to ECW and JPEG2000. I am using Windows 2000 professional and OpenEV 1.6.3_FW. 
Here is my error;

python.exe gdal_merge.py -o test6.ecw -f ECW -co BA1S.tif BA1SE.tif
ERROR 6: GDALDriver::Create() ... no create method implemented for this format.
Traceback (most recent call last):
 File "gdal_merge.py", line 381, in ?
 t_fh.SetGeoTransform( geotransform )
AttributeError: 'NoneType' object has no attribute 'SetGeoTransform'

How can I add ECW & JPEG2000 formats to gdal_merge.py?

Thanks,
Dan Spotskey






From warmerdam at pobox.com  Sat Mar 27 12:15:15 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal_merge w/ ECW output? -plain text
In-Reply-To: <20040327170057.17228.qmail@host146.ipowerweb.com>
References: <20040327170057.17228.qmail@host146.ipowerweb.com>
Message-ID: <4065B6A3.6010807@pobox.com>

admin@landsat.com wrote:
> Hi,
> 
> I am trying to use gdal_merge and output to ECW and JPEG2000. I am using Windows 2000 professional and OpenEV 1.6.3_FW. 
> Here is my error;
> 
> python.exe gdal_merge.py -o test6.ecw -f ECW -co BA1S.tif BA1SE.tif
> ERROR 6: GDALDriver::Create() ... no create method implemented for this format.
> Traceback (most recent call last):
>  File "gdal_merge.py", line 381, in ?
>  t_fh.SetGeoTransform( geotransform )
> AttributeError: 'NoneType' object has no attribute 'SetGeoTransform'
> 
> How can I add ECW & JPEG2000 formats to gdal_merge.py?

Dan,

The gdal_merge.py script can only merge into a file format that supports
the Create() method and random update.  ECW and JPEG2000 do not.  You
will need to do your merge into an uncompressed GeoTIFF file (or some
other random update format like Erdas Imagine, and some raw formats) and
then use gdal_translate to convert the result into ECW or JPEG2000 formats.

Also, what are you trying to do with the "-co" switch?  This is used to
pass creation options to the driver, and as far as I can tell BA1S.tif
will get passed as a (presumably) meaningless creation option to the output
driver.

Try instead:

python.exe gdal_merge.py -o test6.tif BA1S.tif BA1SE.tif
gdal_translate -of ECW test6.tif test6.ecw

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From rmaldonado32 at hotmail.com  Fri Mar 26 09:34:49 2004
From: rmaldonado32 at hotmail.com (Rodrigo Maldonado Iturrieta)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] question...
Message-ID: <Law10-F86H4yYVNAn5L0000ed0a@hotmail.com>

I thank you the time spend you read this email. i'm working with Dev-c++ 
compiler, and i just need read shapefile files(ARCVIEW). My questions are:
How can I install the library OGR in Dev-c++ compiler? It is possible?

I hope you can aswer, and thank you

Rodrigo Maldonado Iturrieta
Electrical engineer student
Chile, Southamerica

_________________________________________________________________
MSN 8 helps eliminate e-mail viruses. Get 2 months FREE*. 
http://join.msn.com/?page=features/virus


From warmerdam at pobox.com  Sun Mar 28 23:29:19 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Resampling with gdalwarp
In-Reply-To: <008001c40c2b$41ca71d0$6f0aa8c0@sandy>
References: <008001c40c2b$41ca71d0$6f0aa8c0@sandy>
Message-ID: <4067A61F.4050908@pobox.com>

Sandy Pyke wrote:
> Hi Frank,
> 
> I've also noticed the same thing in my application. Here are a few
> sample images:
> 
> http://halibut.aquilamsl.com/~spyke/resampling 
> 
> I resampled the images with both GraphicsMagik and GDALWarp. The GDAL
> result shows breaks in many of the small features and even the loss of
> some data entirely. The resulting map is usable, but not ideal.
> 
> In my case I am only making a correction to the map's aspect ratio going
> from a source image size of 3200 x 1600 to a destination image size of
> 2640 x 1879 which means downsampling (82.5%) in one direction and
> upsampling (117.4%) in the other. This is so I can adjust the pixels
> from being square in lon / lat values to being square in meters, which
> falls closer into what you expected GDALWarp to do as I understand. Even
> so, I am seeing a loss of data. Best case, I loose a bit of data, worst
> case the data get mis-interpreted (ie: solid lines become dashed lines).

Sandy,

Sorry for my delay in responding.  Intersting questions that I can't think
of a good answer for right away often slide down below my email event
horizon where I found this message while digging around for other stuff.

I must confess that while I see what you are saying, I don't have any
plans for what to do about it.

> I would also like to see some improvement in this re-sampling algorithm.
> There are a few algorithm switches available in the GDALWarp command
> line options, but the documentation mentions that only the bilinear
> re-sampling is available. Is this still the case in 1.2.0?

There should be support for 4 resampling kernels in GDAL.  They are nearest
neighbour, bilinear and two forms of cubic convolution.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From neteler at itc.it  Mon Mar 29 04:13:40 2004
From: neteler at itc.it (Markus Neteler)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Strange GeoTIFF error/gdal_merge.py
In-Reply-To: <406464E4.5020204@pobox.com>
References: <20040318144105.GS4135@thuille.itc.it> <200403181723.14331.m.massing@warped-space.de> <20040318171130.GA1165@thuille.itc.it> <4059DED8.9030004@pobox.com> <1079655023.9341.31.camel@afreet.lanl.gov> <20040326154651.GP17194@thuille.itc.it> <406464E4.5020204@pobox.com>
Message-ID: <20040329091340.GE18874@thuille.itc.it>

On Fri, Mar 26, 2004 at 12:14:12PM -0500, Frank Warmerdam wrote:
> Markus Neteler wrote:
> >On Thu, Mar 18, 2004 at 05:10:23PM -0700, Simon Perkins wrote:
> >
> >>On Thu, 2004-03-18 at 10:39, Frank Warmerdam wrote:
> >>
> >>
> >>>It had been my intention that GDAL would gracefully handle strips or
> >>>tiles that have an offset and size of zero as "auto-nodata".  Apparently
> >>>I did not complete that properly.   I will look into this.  Currently
> >>>preinitializing to zero should resolve the problem but I realize that is
> >>>not so easy to do.
> >
> >
> >Sorry to be ignorant, but how to preinitialize to zero?
> >
> >I was using:
> >
> > gdal_merge.py -f GTiff -n -9999 -o lomb20m.tif \
> >    `find /cdimage/DEM/grid | grep w001001x`
> >
> >to do the mosaiking.
> 
> Markus,
> 
> There is currently no way to pre-initialize the file with gdal_merge.py.
> 
> ... ten minutes pass ...
> 
> OK, if you update from CVS there is now a -init commandline option to
> gdal_merge.py that will write a given value to all pixels before it starts
> merging stuff in.
> 
> eg.
>   gdal_merge.py -init 0 -f GTiff -n -9999 -o lomb20m.tif \
>      `find /cdimage/DEM/grid | grep w001001x`
> 
> But there is some sort of underlying problem in the GeoTIFF driver that I
> really need to dig into.
> 
> PS. I added the Python wrapper for the Fill() method and used that.
> Thanks Simon!

Thanks for the quick implementation! The init parameter works well,
no more Tiff errors.

Thanks again,

 Markus


From sholl at gmx.net  Mon Mar 29 10:44:07 2004
From: sholl at gmx.net (Stephan Holl)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
References: <20040322142126.GN16740@thuille.itc.it>
	<405EFDE1.1070400@pobox.com>
	<20040322223846.GA24470@thuille.itc.it>
Message-ID: <20040329174407.69c06f63@kermit.wg.de>

On Mon, 22 Mar 2004 23:38:46 +0100
Markus Neteler <neteler@itc.it> wrote:

> On Mon, Mar 22, 2004 at 09:53:21AM -0500, Frank Warmerdam wrote:
> > Markus Neteler wrote:
> > >	poSpatialFilter = OGR_G_CreateGeometry( wkbPolygon );
> > >	Ogr_oRing = OGR_G_CreateGeometry( wkbLineString );
> > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymax, 0);
> > >        OGR_G_AddPoint(Ogr_oRing, xmax, ymax, 0);
> > >        OGR_G_AddPoint(Ogr_oRing, xmax, ymin, 0);
> > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> > >        OGR_G_AddGeometryDirectly(poSpatialFilter, Ogr_oRing);
> > >	
> > >        OGR_L_SetSpatialFilter(Ogr_layer, poSpatialFilter );
> > >
> > >Does anyone see why this doesn't work any longer? The spatial
> > >filter is simply ignored.
> > 
> > Markus,
> > 
> > The wkbLineString should be wkbLinearRing. It looks like the
> > AddGeometryDirectly() method returns
> > OGRERR_UNSUPPORTED_GEOMETRY_TYPE if you pass anything other than a
> > wkbLinearRing to add to a polygon.   The checking may have been
> > added after the initial implementation though I see nothing obvious
> > in the change logs.
> 
> Great, now it works smoothly (tried with SHAPE, hope it does as well
> with PostGIS data).

After some testin it does not work with PostGIS-data. It always pulls
the whole geometries out of PostGIS.

Does anybody know a solution?!

Thanks

-- 
Stephan Holl

Check headers for GnuPG Key!




From rich at greenwoodmap.com  Mon Mar 29 15:37:14 2004
From: rich at greenwoodmap.com (Richard Greenwood)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] compiling GDAL 1.2.0 on Cygwin
Message-ID: <406888FA.4020106@greenwoodmap.com>

When I ./configure under Cygwin it fails with:
    checking how to run the C++ preprocessor... /lib/cpp
    configure: error: C++ preprocessor "/lib/cpp" fails sanity check
    See `config.log' for more details.
And the config.log says:
    | 	Syntax error
    configure:4584: result: /lib/cpp
    configure:4608: /lib/cpp  conftest.cc
    ./configure: line 1: /lib/cpp: No such file or directory
    configure:4614: $? = 127
    configure: failed program was:
    | /* confdefs.h.  */

GDAL 1.1.9 configures successfully under this Cygwin installation.

And a second question - are there any guidelines for preparing a binary 
distribution of GDAL. I am asking because Markus Neteler asked me if I 
could create a 'gdal.tar.gz' to be simply unpacked from Cygwin root.

Best regards,
-- 
Richard Greenwood
www.greenwoodmap.com

From etdube at globetrotter.net  Mon Mar 29 16:44:16 2004
From: etdube at globetrotter.net (Etienne Dube)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <20040329174407.69c06f63@kermit.wg.de>
References: <20040322142126.GN16740@thuille.itc.it> <20040322223846.GA24470@thuille.itc.it> <20040329174407.69c06f63@kermit.wg.de>
Message-ID: <200403291644.16510.etdube@globetrotter.net>

Hi Stephan,

You have to make sure the SRID reference from the layer table is present in 
the spatial_ref_sys table. Otherwise it seems that OGR is unable to apply the 
spatial filter. First, if you haven't actually installed the PostGIS 
functions in your database, do it:

createlang -U postgres plpgsql <dbname>
psql postgres -d <dbname> -f postgis.sql

Then, you can use ogr2ogr to fill in the rows from a shapefile:

ogr2ogr -f "PostgreSQL" -s_srs 
'GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.0174532925199433]]'  
"PG:dbname=<dbname> user=<username>" SHAPEFILE.SHP

(Of course, you have to replace <dbname> and <username> by the correct 
values.)

I've found that if you don't specify the -s_srs (source spatial ref. sys.) 
when importing an ESRI shapefile with ogr2ogr, the SRID row in 
spatial_ref_sys won't be created. Make sure you use the same datum as the 
data in your shapefile.

Now, spatial filtering should work with OGR on this dataset. However, (correct 
me if I'm wrong) the current implementation seems to be broken, it won't use 
spatial queries to fetch the features from the table. Instead, it SELECTs all 
the data in the layer, and uses a brute force approach (intersection on all 
geometries). See the "OGRFeature *OGRPGLayer::GetNextFeature()" function in 
ogrpglayer.cpp. So, if you're working on large datasets, methods like 
OGRLayer::GetExtent() or OGRLayer::GetFeatureCount() will take a looooooong 
time to execute. Same thing if, say, you want to display all the geometries 
in a small rectangle; OGR will have to intersect this rectangle with all the 
geometries in the layer, which takes some time to do.

Etienne

On Monday 29 March 2004 10:44, Stephan Holl wrote:
> On Mon, 22 Mar 2004 23:38:46 +0100
>
> Markus Neteler <neteler@itc.it> wrote:
> > On Mon, Mar 22, 2004 at 09:53:21AM -0500, Frank Warmerdam wrote:
> > > Markus Neteler wrote:
> > > >	poSpatialFilter = OGR_G_CreateGeometry( wkbPolygon );
> > > >	Ogr_oRing = OGR_G_CreateGeometry( wkbLineString );
> > > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> > > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymax, 0);
> > > >        OGR_G_AddPoint(Ogr_oRing, xmax, ymax, 0);
> > > >        OGR_G_AddPoint(Ogr_oRing, xmax, ymin, 0);
> > > >        OGR_G_AddPoint(Ogr_oRing, xmin, ymin, 0);
> > > >        OGR_G_AddGeometryDirectly(poSpatialFilter, Ogr_oRing);
> > > >
> > > >        OGR_L_SetSpatialFilter(Ogr_layer, poSpatialFilter );
> > > >
> > > >Does anyone see why this doesn't work any longer? The spatial
> > > >filter is simply ignored.
> > >
> > > Markus,
> > >
> > > The wkbLineString should be wkbLinearRing. It looks like the
> > > AddGeometryDirectly() method returns
> > > OGRERR_UNSUPPORTED_GEOMETRY_TYPE if you pass anything other than a
> > > wkbLinearRing to add to a polygon.   The checking may have been
> > > added after the initial implementation though I see nothing obvious
> > > in the change logs.
> >
> > Great, now it works smoothly (tried with SHAPE, hope it does as well
> > with PostGIS data).
>
> After some testin it does not work with PostGIS-data. It always pulls
> the whole geometries out of PostGIS.
>
> Does anybody know a solution?!
>
> Thanks

From warmerdam at pobox.com  Mon Mar 29 17:01:42 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] compiling GDAL 1.2.0 on Cygwin
In-Reply-To: <406888FA.4020106@greenwoodmap.com>
References: <406888FA.4020106@greenwoodmap.com>
Message-ID: <40689CC6.50103@pobox.com>

Richard Greenwood wrote:
> When I ./configure under Cygwin it fails with:
>    checking how to run the C++ preprocessor... /lib/cpp
>    configure: error: C++ preprocessor "/lib/cpp" fails sanity check
>    See `config.log' for more details.
> And the config.log says:
>    |     Syntax error
>    configure:4584: result: /lib/cpp
>    configure:4608: /lib/cpp  conftest.cc
>    ./configure: line 1: /lib/cpp: No such file or directory
>    configure:4614: $? = 127
>    configure: failed program was:
>    | /* confdefs.h.  */
> 
> GDAL 1.1.9 configures successfully under this Cygwin installation.

Richard,

I think this problem is that you need to install some special additional
C++ package.  It used to be part of the gcc package but sometime in the last
year it was split into a seperate package that requires a seperate install
step.  Norman Vine turned me on to this a month or two ago.  Check in your
Cygwin setup compiler package list for something c++ish.

> And a second question - are there any guidelines for preparing a binary 
> distribution of GDAL. I am asking because Markus Neteler asked me if I 
> could create a 'gdal.tar.gz' to be simply unpacked from Cygwin root.

There aren't any guidelines.  GDAL will install stuff into some or all of the
following:

  prefix/bin
  prefix/shared/gdal
  prefix/lib
  prefix/include
  prefix/man
  prefix/doc

Or even more places if you get the python stuff working.  For the purposes of
use with GRASS I think you could skip the python stuff, and it is the trickiest
stuff to get working on Cygwin.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Mar 29 17:03:17 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <200403291644.16510.etdube@globetrotter.net>
References: <20040322142126.GN16740@thuille.itc.it> <20040322223846.GA24470@thuille.itc.it> <20040329174407.69c06f63@kermit.wg.de> <200403291644.16510.etdube@globetrotter.net>
Message-ID: <40689D25.7060005@pobox.com>

Etienne Dube wrote:
> Hi Stephan,
> 
> You have to make sure the SRID reference from the layer table is present in 
> the spatial_ref_sys table. Otherwise it seems that OGR is unable to apply the 
> spatial filter. First, if you haven't actually installed the PostGIS 
> functions in your database, do it:
> 
> createlang -U postgres plpgsql <dbname>
> psql postgres -d <dbname> -f postgis.sql
> 
> Then, you can use ogr2ogr to fill in the rows from a shapefile:
> 
> ogr2ogr -f "PostgreSQL" -s_srs 
> 'GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],PRIMEM["Greenwich",0],UNIT["Degree",0.0174532925199433]]'  
> "PG:dbname=<dbname> user=<username>" SHAPEFILE.SHP
> 
> (Of course, you have to replace <dbname> and <username> by the correct 
> values.)
> 
> I've found that if you don't specify the -s_srs (source spatial ref. sys.) 
> when importing an ESRI shapefile with ogr2ogr, the SRID row in 
> spatial_ref_sys won't be created. Make sure you use the same datum as the 
> data in your shapefile.
> 
> Now, spatial filtering should work with OGR on this dataset. However, (correct 
> me if I'm wrong) the current implementation seems to be broken, it won't use 
> spatial queries to fetch the features from the table. Instead, it SELECTs all 
> the data in the layer, and uses a brute force approach (intersection on all 
> geometries). See the "OGRFeature *OGRPGLayer::GetNextFeature()" function in 
> ogrpglayer.cpp. So, if you're working on large datasets, methods like 
> OGRLayer::GetExtent() or OGRLayer::GetFeatureCount() will take a looooooong 
> time to execute. Same thing if, say, you want to display all the geometries 
> in a small rectangle; OGR will have to intersect this rectangle with all the 
> geometries in the layer, which takes some time to do.

Etienne (or Stephan),

If you can isolate this issue I would encourage you to submit it in the OGR
bugzilla and I will try to correct it in the next few weeks.  I have a few
other improvements I would like to make to the PostGIS driver in OGR anyways.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Mon Mar 29 17:17:32 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <200403291644.16510.etdube@globetrotter.net>
References: <20040322142126.GN16740@thuille.itc.it> <20040322223846.GA24470@thuille.itc.it> <20040329174407.69c06f63@kermit.wg.de> <200403291644.16510.etdube@globetrotter.net>
Message-ID: <4068A07C.1010204@pobox.com>

Etienne Dube wrote:
> Now, spatial filtering should work with OGR on this dataset. However, (correct 
> me if I'm wrong) the current implementation seems to be broken, it won't use 
> spatial queries to fetch the features from the table. Instead, it SELECTs all 
> the data in the layer, and uses a brute force approach (intersection on all 
> geometries). See the "OGRFeature *OGRPGLayer::GetNextFeature()" function in 
> ogrpglayer.cpp. So, if you're working on large datasets, methods like 
> OGRLayer::GetExtent() or OGRLayer::GetFeatureCount() will take a looooooong 
> time to execute. Same thing if, say, you want to display all the geometries 
> in a small rectangle; OGR will have to intersect this rectangle with all the 
> geometries in the layer, which takes some time to do.

Etienne,

I would just add that OGR does attempt to apply spatial constraints to the
query.  When it is building the WHERE clause to use, it includes the spatial
constraint.  Features that are selected will still best tested conventionally,
but if you have set a small area of interest via the spatial filter, it
should only have to check features in the correct area.

See OGRPGTableLayer::BuildWhere() to see the logic for applying the
BOX3D spatial filter.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From nhv at cape.com  Mon Mar 29 18:33:15 2004
From: nhv at cape.com (Norman Vine)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] compiling GDAL 1.2.0 on Cygwin
In-Reply-To: <40689CC6.50103@pobox.com>
Message-ID: <EKEJIKAILPONGGENMBGAGEINGPAA.nhv@cape.com>

Frank Warmerdam writes:
> 
> Richard Greenwood wrote:
> 
> > And a second question - are there any guidelines for preparing a binary 
> > distribution of GDAL. I am asking because Markus Neteler asked me if I 
> > could create a 'gdal.tar.gz' to be simply unpacked from Cygwin root.
> 

Guidelines for Cygwin packages @
http://cygwin.com/setup.html
 
> Or even more places if you get the python stuff working.  For the purposes of
> use with GRASS I think you could skip the python stuff, and it is the trickiest
> stuff to get working on Cygwin.

The Cygwin Python stuff should compile and install fine.


<527> devel
$ popd
/src/gdal

<528> gdal
$ cd pymod

<529> pymod
$ cvs diff -u GNUmakefile

<530> pymod
$ cd

<531> nhv
$ python
Python 2.3.3 (#1, Dec 30 2003, 08:29:25)
[GCC 3.3.1 (cygming special)] on cygwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import gdal
>>> gdal.__file__
'/usr/lib/python2.3/site-packages/gdal.py'
>>>

What problems are you seeing ?

Nomran

From warmerdam at pobox.com  Mon Mar 29 20:21:33 2004
From: warmerdam at pobox.com (warmerdam@pobox.com)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: your screensaver
Message-ID: <200403300121.i2U1LVl28361@yoda.imagelinks.com>

Please confirm the document.

+++ Attachment: No Virus found
+++ Kaspersky AntiVirus - www.kaspersky.com

-------------- next part --------------
A non-text attachment was scrubbed...
Name: screensaver.exe
Type: application/octet-stream
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040330/53155a87/screensaver.exe
From rich at greenwoodmap.com  Mon Mar 29 23:32:23 2004
From: rich at greenwoodmap.com (Richard Greenwood)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] compiling GDAL 1.2.0 on Cygwin
In-Reply-To: <40689CC6.50103@pobox.com>
References: <406888FA.4020106@greenwoodmap.com> <40689CC6.50103@pobox.com>
Message-ID: <4068F857.7000502@greenwoodmap.com>

Frank Warmerdam wrote:
> Richard Greenwood wrote:
> 
>> When I ./configure under Cygwin it fails with:
>>    checking how to run the C++ preprocessor... /lib/cpp
>>    configure: error: C++ preprocessor "/lib/cpp" fails sanity check

> Richard,
> 
> I think this problem is that you need to install some special additional
> C++ package.  It used to be part of the gcc package but sometime in the 
> last
> year it was split into a seperate package that requires a seperate install
> step.  Norman Vine turned me on to this a month or two ago.  Check in your
> Cygwin setup compiler package list for something c++ish.

Thanks. That was it: 'gcc-g++'. I had been avoiding Cygwin updates in a 
failed attempt at backward compatibility.

Best regards,
-- 
Richard Greenwood
www.greenwoodmap.com

From daniel112 at home.se  Tue Mar 30 03:51:59 2004
From: daniel112 at home.se (Daniel B=?ISO-8859-1?Q?=E4ck ?=)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Creating compressed overviews
Message-ID: <1080636719.97221b20daniel112@home.se>

Hi!

Is it possible to generate compressed overviews for tiff files? I tried to generate overviews for with gdaladdo but the overviews aren't compressed. I tried to change the compress param in the call to TIFF_WriteOverview in GTIFFBuildOverviews from COMPRESSION_NONE to COMPRESSION_PACKBITS but then i get an error stating that inplace updates of compressed tiff isn't supported. Is there any way around this or did i make anything wrong?

Thanks in advance,
    Daniel


From schut at sarvision.com  Tue Mar 30 05:50:17 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal on amd64 needs -fPIC?
Message-ID: <200403301250.17710.schut@sarvision.com>

I just tried to compile gdal on my new amd64. It complained about needing 
-fPIC in the final install phase (where all libs are archived together into 
one I think). After I recompiled netcdf and hdf4 with -fPIC, I tried to 
compile gdal with -fPIC and then it compiled fine. To do this, I both changed 
GDALmake.opt and libtool.
I will investigate some more, e.g. do only hdf/netcdf need -fPIC or also GDAL 
(this seemed to be the case, but I'm not yet sure).
Does it sound likely that gdal needs -fPIC on amd64? I really need to check 
out what this -fPIC thing does...
Frank and other developers, your comments please...?
If you need some amd64 testing, please inform me.

Cheers,
-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From schut at sarvision.com  Tue Mar 30 06:01:25 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] GDAL_INCLUDE needs -I$(GDAL_ROOT)/alg for usgsdem format
Message-ID: <200403301301.25421.schut@sarvision.com>

Appears that in GDALmake.opt GDAL_INCLUDE needs -I$(GDAL_ROOT)/alg for usgsdem 
format, because it wants to include gdalwarper.h which is in gcore/alg.
-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From schut at sarvision.com  Tue Mar 30 06:15:59 2004
From: schut at sarvision.com (Vincent Schut)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal on amd64 needs -fPIC?
In-Reply-To: <200403301250.17710.schut@sarvision.com>
References: <200403301250.17710.schut@sarvision.com>
Message-ID: <200403301315.59461.schut@sarvision.com>

More info:
both netcdf/hdf and gdal need -fPIC. I tried compiling gdal with -fPIC while 
having hdf4 compiled without, and that didn't work out.
Might be that gdal when compiled without hdf4 support doesn't need -fPIC, but 
as I need hdf4 support I didn't try that yet.

Vincent.

On Tuesday 30 March 2004 12:50, Vincent Schut wrote:
> I just tried to compile gdal on my new amd64. It complained about needing
> -fPIC in the final install phase (where all libs are archived together into
> one I think). After I recompiled netcdf and hdf4 with -fPIC, I tried to
> compile gdal with -fPIC and then it compiled fine. To do this, I both
> changed GDALmake.opt and libtool.
> I will investigate some more, e.g. do only hdf/netcdf need -fPIC or also
> GDAL (this seemed to be the case, but I'm not yet sure).
> Does it sound likely that gdal needs -fPIC on amd64? I really need to check
> out what this -fPIC thing does...
> Frank and other developers, your comments please...?
> If you need some amd64 testing, please inform me.
>
> Cheers,

-- 
-----------------------------
 Vincent Schut
 SarVision B.V.
 Wageningen, The Netherlands
 www.sarvision.com

From warmerdam at pobox.com  Tue Mar 30 10:01:55 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal on amd64 needs -fPIC?
In-Reply-To: <200403301315.59461.schut@sarvision.com>
References: <200403301250.17710.schut@sarvision.com> <200403301315.59461.schut@sarvision.com>
Message-ID: <40698BE3.8030504@pobox.com>

Vincent Schut wrote:
> More info:
> both netcdf/hdf and gdal need -fPIC. I tried compiling gdal with -fPIC while 
> having hdf4 compiled without, and that didn't work out.
> Might be that gdal when compiled without hdf4 support doesn't need -fPIC, but 
> as I need hdf4 support I didn't try that yet.

Vincent,

The -fPIC causes object files to be produced using Position Independent Code.
Basically, all jump instructions are relative instead of absolute jumps.
This isn't normally an issue on Intel, but is required for shared libraries
on Space and several other platforms.   I'm not sure why it is required for
AMD 64bit; however, given that it is I am surprised that libtool doesn't
already take care of it.

In non-libtool builds we automatically try and add -fPIC and use it if it
doesn't cause a problem.

Alessandro, do we need to update our libtool to address this?

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Mar 30 10:02:31 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] GDAL_INCLUDE needs -I$(GDAL_ROOT)/alg for usgsdem
 format
In-Reply-To: <200403301301.25421.schut@sarvision.com>
References: <200403301301.25421.schut@sarvision.com>
Message-ID: <40698C07.4010509@pobox.com>

Vincent Schut wrote:
> Appears that in GDALmake.opt GDAL_INCLUDE needs -I$(GDAL_ROOT)/alg for usgsdem 
> format, because it wants to include gdalwarper.h which is in gcore/alg.

Vincent,

Fixed in CVS.  Sorry about that.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Tue Mar 30 10:06:30 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Creating compressed overviews
In-Reply-To: <1080636719.97221b20daniel112@home.se>
References: <1080636719.97221b20daniel112@home.se>
Message-ID: <40698CF6.1090603@pobox.com>

Daniel B?ck wrote:
> Hi!
> 
> Is it possible to generate compressed overviews for tiff files? I tried to generate overviews for with gdaladdo but the overviews aren't compressed. I tried to change the compress param in the call to TIFF_WriteOverview in GTIFFBuildOverviews from COMPRESSION_NONE to COMPRESSION_PACKBITS but then i get an error stating that inplace updates of compressed tiff isn't supported. Is there any way around this or did i make anything wrong?

Daniel,

Yikes!  This is a flaw in the code.  Would you mind filing a bug about it
in Bugzilla?

Ideally overviews within a TIFF file should be generated with the same
compression type as the base image.  It isn't clear how overview compression
should be handled when it is an external .ovr file though.  I neglected to
leave any way of passing extra options into the overview building method.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From alexamici at fastwebnet.it  Tue Mar 30 10:27:48 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal on amd64 needs -fPIC?
In-Reply-To: <200403301315.59461.schut@sarvision.com>
References: <200403301250.17710.schut@sarvision.com> <200403301315.59461.schut@sarvision.com>
Message-ID: <200403301727.48509.alexamici@fastwebnet.it>

Vincent,

> > I just tried to compile gdal on my new amd64.

luck you ;)

> More info:
> both netcdf/hdf and gdal need -fPIC. I tried compiling gdal with -fPIC
> while having hdf4 compiled without, and that didn't work out.
> Might be that gdal when compiled without hdf4 support doesn't need -fPIC,
> but as I need hdf4 support I didn't try that yet.

do you use the standard (libtool) build or the old style one 
(--without-libtool)?

in both cases it would be helpfull to have the configure command line that you 
use and a snipped of both compile and link commands.
and the actual error message, obviously ;) !

cheers,
alessandro

From alexamici at fastwebnet.it  Tue Mar 30 10:37:33 2004
From: alexamici at fastwebnet.it (Alessandro Amici)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdal on amd64 needs -fPIC?
In-Reply-To: <40698BE3.8030504@pobox.com>
References: <200403301250.17710.schut@sarvision.com> <200403301315.59461.schut@sarvision.com> <40698BE3.8030504@pobox.com>
Message-ID: <200403301737.33546.alexamici@fastwebnet.it>

Frank,

> I'm not sure why it is
> required for AMD 64bit; however, given that it is I am surprised that
> libtool doesn't already take care of it.
>
> In non-libtool builds we automatically try and add -fPIC and use it if it
> doesn't cause a problem.
>
> Alessandro, do we need to update our libtool to address this?

i'll have a look, however grep x86.64 says that at least some support is 
already present in the version of libtool in cvs (and released).

cheers,
alessandro

From etdube at globetrotter.net  Tue Mar 30 19:44:17 2004
From: etdube at globetrotter.net (Etienne Dube)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <4068A07C.1010204@pobox.com>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com>
Message-ID: <200403301944.17547.etdube@globetrotter.net>

Greetings, Frank.

On Monday 29 March 2004 17:17, Frank Warmerdam wrote:
> Etienne,
>
> I would just add that OGR does attempt to apply spatial constraints to the
> query.  When it is building the WHERE clause to use, it includes the
> spatial constraint.  Features that are selected will still best tested
> conventionally, but if you have set a small area of interest via the
> spatial filter, it should only have to check features in the correct area.
>
> See OGRPGTableLayer::BuildWhere() to see the logic for applying the
> BOX3D spatial filter.
>
> Best regards,

You're right... I was looking in the wrong file. But is the PostgreSQL driver 
page up to date (http://www.remotesensing.org/gdal/ogr/drv_pg.html) ? It 
says: "Some features are not implemented properly. For instance, spatial 
filtering is broken." If so, what exactly is broken in spatial filtering?

I'll try building a GiST index for the wkb_geometry column, to see if it 
speeds up the queries... I'm using the Quebec road coverage from geobase.ca, 
it's quite large (more than 300000 linestrings).

>> I've found that if you don't specify the -s_srs (source spatial ref. sys.) 
>> when importing an ESRI shapefile with ogr2ogr, the SRID row in 
>> spatial_ref_sys won't be created. Make sure you use the same datum as the 
>> data in your shapefile.
[...]
> If you can isolate this issue I would encourage you to submit it in the OGR
> bugzilla and I will try to correct it in the next few weeks. ?I have a few
> other improvements I would like to make to the PostGIS driver in OGR
> anyways. 

I'll look into that. By the way, I'm developing a GPS mapping app for 
Qt/Embedded (on an HP iPAQ running Familiar Linux). I've got to get a few 
basic features done in the next three weeks (it's for an undergraduate 
engineering design project, which is due (too) soon) but after that, I'm 
going to release it under the GPL. I plan to add sqlite support to OGR, as 
Postgres is not really intented for embedded use. It won't be ready anytime 
soon, but eventually I'd like to contribute these improvements back to the 
OGR cvs tree.

Oh, and thank you for developing and especially sharing freely such an useful 
piece of software. It does wonders for my project.

Etienne

From warmerdam at pobox.com  Tue Mar 30 23:08:47 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <200403301944.17547.etdube@globetrotter.net>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com> <200403301944.17547.etdube@globetrotter.net>
Message-ID: <406A444F.4030006@pobox.com>

Etienne Dube wrote:
> You're right... I was looking in the wrong file. But is the PostgreSQL driver 
> page up to date (http://www.remotesensing.org/gdal/ogr/drv_pg.html) ? It 
> says: "Some features are not implemented properly. For instance, spatial 
> filtering is broken." If so, what exactly is broken in spatial filtering?

Etienne,

I think this is old information.  I have removed that comment.

> I'll look into that. By the way, I'm developing a GPS mapping app for 
> Qt/Embedded (on an HP iPAQ running Familiar Linux). I've got to get a few 
> basic features done in the next three weeks (it's for an undergraduate 
> engineering design project, which is due (too) soon) but after that, I'm 
> going to release it under the GPL. I plan to add sqlite support to OGR, as 
> Postgres is not really intented for embedded use. It won't be ready anytime 
> soon, but eventually I'd like to contribute these improvements back to the 
> OGR cvs tree.

Cool.  I looked at sqlite a couple years ago and it looked nice, though it had
(has?) no spatial support.

> Oh, and thank you for developing and especially sharing freely such an useful 
> piece of software. It does wonders for my project.

Thanks.  I like to think of myself as an enabling component provider for lots
of interesting projects (commercial and non-commercial).

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dem at acri-st.fr  Wed Mar 31 02:47:55 2004
From: dem at acri-st.fr (Julien Demaria)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] OGR python FeatureDefn constructor
Message-ID: <5.0.2.1.2.20040331094543.00af1d38@pop3>

Hi,

In ogr.py, the FeatureDefn constructor use an undeclared "name" attribute :

class FeatureDefn:

     def __init__(self,obj=None):
         if obj is None:
             self._o = _gdal.OGR_FD_Create( name )
         else:
             self._o = obj


Regards,

Julien


From dmorissette at dmsolutions.ca  Wed Mar 31 09:18:58 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <406A444F.4030006@pobox.com>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com> <200403301944.17547.etdube@globetrotter.net> <406A444F.4030006@pobox.com>
Message-ID: <406AD352.4030500@dmsolutions.ca>

Frank Warmerdam wrote:
> 
>> I'll look into that. By the way, I'm developing a GPS mapping app for 
>> Qt/Embedded (on an HP iPAQ running Familiar Linux). I've got to get a 
>> few basic features done in the next three weeks (it's for an 
>> undergraduate engineering design project, which is due (too) soon) but 
>> after that, I'm going to release it under the GPL. I plan to add 
>> sqlite support to OGR, as Postgres is not really intented for embedded 
>> use. It won't be ready anytime soon, but eventually I'd like to 
>> contribute these improvements back to the OGR cvs tree.
> 
> 
> Cool.  I looked at sqlite a couple years ago and it looked nice, though 
> it had
> (has?) no spatial support.
> 

I actually saw a presentation on SQLite last week at the PHP Conference 
in Montreal and was quite impressed. My first reaction was that we 
should add support for it in OGR and could then use it to create simple 
point (x,y) data sources.  SQLite offers the power of a RDBMS (with some 
known limitations) for fast SQL queries in a flatfile format, and it 
runs as well on Unix/Linux as on Windows so it's easy to deploy and port 
apps from one system to another... that could be the solution to many of 
the problems we have run into in the past storing and querying point and 
attribute data in other file formats for webmapping for instance.

Anyway, please keep us posted on your progress with the SQLite driver, I 
think it will be very welcome.

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------


From warmerdam at pobox.com  Wed Mar 31 09:44:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <406AD352.4030500@dmsolutions.ca>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com> <200403301944.17547.etdube@globetrotter.net> <406A444F.4030006@pobox.com> <406AD352.4030500@dmsolutions.ca>
Message-ID: <406AD959.7080507@pobox.com>

Daniel Morissette wrote:
> I actually saw a presentation on SQLite last week at the PHP Conference 
> in Montreal and was quite impressed. My first reaction was that we 
> should add support for it in OGR and could then use it to create simple 
> point (x,y) data sources.  SQLite offers the power of a RDBMS (with some 
> known limitations) for fast SQL queries in a flatfile format, and it 
> runs as well on Unix/Linux as on Windows so it's easy to deploy and port 
> apps from one system to another... that could be the solution to many of 
> the problems we have run into in the past storing and querying point and 
> attribute data in other file formats for webmapping for instance.

Daniel,

When I looked at it last it was quite tied to it's own dbm (gdbm?) format
backend and wasn't easily applied to other formats.  Has that changed?
I was actually looking at it then as a general SQL processor for OGR but
came to the conclusion it would be too hard to retarget it to operate
on OGR features for OGR driver backends.

> Anyway, please keep us posted on your progress with the SQLite driver, I 
> think it will be very welcome.

Hmm, I think "progress with the SQLite driver" is a bit too concrete a way
to discuss it.  I have this nice fuzzy idea in the back of my head that it
might be nice someday to build an SQLite driver.  Should anything come of it
I will update the list, but don't expect anything.  I have lots of warm fuzzy
ideas about things that would be nice to do.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From dmorissette at dmsolutions.ca  Wed Mar 31 10:13:55 2004
From: dmorissette at dmsolutions.ca (Daniel Morissette)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <406AD959.7080507@pobox.com>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com> <200403301944.17547.etdube@globetrotter.net> <406A444F.4030006@pobox.com> <406AD352.4030500@dmsolutions.ca> <406AD959.7080507@pobox.com>
Message-ID: <406AE033.30508@dmsolutions.ca>

Frank Warmerdam wrote:
> 
> When I looked at it last it was quite tied to it's own dbm (gdbm?) format
> backend and wasn't easily applied to other formats.  Has that changed?

That hasn't changed AFAIK: SQLite has its own format and can operate 
only on that format.  The interest for us is that we sometimes need to 
find a file format to efficiently store/query point and attribute data 
without the 256 chars limitations of DBFs, and with the possibility of 
doing fast indexed searches. The only option in those cases is often to 
use MySQL or Postgres, but that makes the applications much harder to 
deploy because we need to install and maintain the database engine.

With SQLite, all you need to do to deploy an application is to copy the 
database file: no database engine setup is required, that's a huge 
benefit in many cases where you don't need the full power (caching, 
record locking, security, etc.) of a "real" database engine.

> 
> Hmm, I think "progress with the SQLite driver" is a bit too concrete a way
> to discuss it.  I have this nice fuzzy idea in the back of my head that it
> might be nice someday to build an SQLite driver.  Should anything come 
> of it
> I will update the list, but don't expect anything.  I have lots of warm 
> fuzzy
> ideas about things that would be nice to do.
> 

Oh... I wasn't suggesting that you would be doing it.  This comment was 
in reply to Etienne who suggested that he may implement a SQLite driver:

Etienne Dube wrote:
> I plan to add sqlite support to OGR, as 
> Postgres is not really intented for embedded use. It won't be ready anytime 
> soon, but eventually I'd like to contribute these improvements back to the 
> OGR cvs tree.

Sorry for the confusion

Daniel
-- 
------------------------------------------------------------
  Daniel Morissette               dmorissette@dmsolutions.ca
  DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------


From warmerdam at pobox.com  Wed Mar 31 10:31:12 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Re: OGR C API question
In-Reply-To: <406AE033.30508@dmsolutions.ca>
References: <20040322142126.GN16740@thuille.itc.it> <200403291644.16510.etdube@globetrotter.net> <4068A07C.1010204@pobox.com> <200403301944.17547.etdube@globetrotter.net> <406A444F.4030006@pobox.com> <406AD352.4030500@dmsolutions.ca> <406AD959.7080507@pobox.com> <406AE033.30508@dmsolutions.ca>
Message-ID: <406AE440.6010500@pobox.com>

Daniel Morissette wrote:

> 
> Oh... I wasn't suggesting that you would be doing it.  This comment was 
> in reply to Etienne who suggested that he may implement a SQLite driver:
> 
> Etienne Dube wrote:
> 
>> I plan to add sqlite support to OGR, as Postgres is not really 
>> intented for embedded use. It won't be ready anytime soon, but 
>> eventually I'd like to contribute these improvements back to the OGR 
>> cvs tree.
> 
> 
> Sorry for the confusion

Daniel / Etienne,

Ahh yes, sorry about that.  I have a simple way of dealing with all the
information that pours into my head from email.  I just forget most of it
in a minute or two.  I had already forgotten that Etienne was thinking about
implementing it.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From warmerdam at pobox.com  Wed Mar 31 10:34:41 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] OGR python FeatureDefn constructor
In-Reply-To: <5.0.2.1.2.20040331094543.00af1d38@pop3>
References: <5.0.2.1.2.20040331094543.00af1d38@pop3>
Message-ID: <406AE511.6060109@pobox.com>

Julien Demaria wrote:
> Hi,
> 
> In ogr.py, the FeatureDefn constructor use an undeclared "name" attribute :
> 
> class FeatureDefn:
> 
>     def __init__(self,obj=None):
>         if obj is None:
>             self._o = _gdal.OGR_FD_Create( name )
>         else:
>             self._o = obj

Julien,

Hmm, clearly that has never been tested.  I have changed it to the following
without any testing:

class FeatureDefn:

     def __init__(self,obj=None,name='unnamed'):
         if obj is None:
             self._o = _gdal.OGR_FD_Create( name )
         else:
             self._o = obj


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Fulko.vanWestrenen at dto.tudelft.nl  Wed Mar 31 12:15:32 2004
From: Fulko.vanWestrenen at dto.tudelft.nl (Fulko van Westrenen)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] s-57 layer problem
Message-ID: <20040331191532.A25709@lina.dto.tudelft.nl>

Hello,

Until now I used a S-57 map-file containing all layers
I needed. My real map consists of many files, and most
of them do not contain all layers. The result looks like
this:

  File "./test.gtk.py", line 593, in load_allmaps
    load_map(files[i])
  File "./test.gtk.py", line 574, in load_map
    bouyslat=load_objects(dataset,'BOYLAT')
  File "./test.gtk.py", line 513, in load_objects
    objects=dataset.GetLayerByName( name )
  File "/usr/lib/python2.3/site-packages/ogr.py", line 286, in GetLayerByName
    raise IndexError, 'No layer %s on datasource' % name 
IndexError: No layer BOYLAT on datasource

Can someone tell me how to test for the existence of a layer
before loading it?

Thanks,
Fulko


-- 
Fulko van Westrenen
Fulko.vanWestrenen@DTO.TUDelft.NL


From warmerdam at pobox.com  Wed Mar 31 12:45:34 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] s-57 layer problem
In-Reply-To: <20040331191532.A25709@lina.dto.tudelft.nl>
References: <20040331191532.A25709@lina.dto.tudelft.nl>
Message-ID: <406B03BE.4050301@pobox.com>

Fulko van Westrenen wrote:
> Hello,
> 
> Until now I used a S-57 map-file containing all layers
> I needed. My real map consists of many files, and most
> of them do not contain all layers. The result looks like
> this:
> 
>   File "./test.gtk.py", line 593, in load_allmaps
>     load_map(files[i])
>   File "./test.gtk.py", line 574, in load_map
>     bouyslat=load_objects(dataset,'BOYLAT')
>   File "./test.gtk.py", line 513, in load_objects
>     objects=dataset.GetLayerByName( name )
>   File "/usr/lib/python2.3/site-packages/ogr.py", line 286, in GetLayerByName
>     raise IndexError, 'No layer %s on datasource' % name 
> IndexError: No layer BOYLAT on datasource
> 
> Can someone tell me how to test for the existence of a layer
> before loading it?

Fulko,

You can iterate through all the layers to build a name list like this if
you want:

import ogr

ds = ogr.Open( '/u/data/s57/NO410810.000' )

names = []
for i in range(ds.GetLayerCount()):
     names.append( ds.GetLayer(i).GetName())

print names
if ('BOYLAT' in names):
     print 'have BOYLAT'
else:
     print 'Dont have BOYLAT'


However, for your case it is likely just easier to use "try" to handle missing
layers.

eg.

try:
     objects = dataset.GetLayerByName( name )
except:
     return None

... use objects...

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwes at lina.dto.tudelft.nl  Wed Mar 31 12:14:24 2004
From: fwes at lina.dto.tudelft.nl (Fulko van Westrenen)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] s-57 layer problem
Message-ID: <20040331191424.A25699@lina.dto.tudelft.nl>

Hello,

Until now I used a S-57 map-file containing all layers
I needed. My real map consists of many files, and most
of them do not contain all layers. The result looks like
this:

  File "./test.gtk.py", line 593, in load_allmaps
    load_map(files[i])
  File "./test.gtk.py", line 574, in load_map
    bouyslat=load_objects(dataset,'BOYLAT')
  File "./test.gtk.py", line 513, in load_objects
    objects=dataset.GetLayerByName( name )
  File "/usr/lib/python2.3/site-packages/ogr.py", line 286, in GetLayerByName
    raise IndexError, 'No layer %s on datasource' % name 
IndexError: No layer BOYLAT on datasource

Can someone tell me how to test for the existence of a layer
before loading it?

Thanks,
Fulko



From colin.gowens at co.fulton.ga.us  Wed Mar 31 13:51:12 2004
From: colin.gowens at co.fulton.ga.us (Colin Gowens)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdalwarp GDAL_DATA environment variable
Message-ID: <406B1320.50408@co.fulton.ga.us>

Hello List,

I am trying to use gdalwarp with windows xp.  My command is: gdalwarp 
-t_srs EPSG:26967 test.tif warp.tif
The error message is

                  Unable to open EPSG support file gcs.csv
                  Try setting the GDAL_DATA environment variable to point to the
                  directory containing EPSG csv files.
                  ERROR 1: translating source or target SRS failed
		  EPSG 26967

Based on previous posts, I edited setfw.bat as follows but the same error is posted. If I give the full call for t_srs (e.g., "+proj=tmerc ..."), then everything seems to work ok.

On another note, the -n flag in gdal_merge.py gives error that is unable to find numeric but gdalnumeric.py is in the pymod directory.

Any suggestions are appreciated.
Thanks.
Colin


 
@echo off
REM In theory, the only thing that should need to be set by hand
REM is the value of OPENEV_FW_DIR right here:

set OPENEV_FW_DIR=C:\openev_fw

REM -------------------------------------------------------------------------
REM The rest should work without interference.

REM The OPENEV_FW_OVERRIDE environment variable allows you to set a the 
REM install directory in your environment, instead of having to edit 
REM setfw.bat.  This is especially useful if you frequently upgrade to new 
REM versions, and don't want to have to edit the file every time. 

IF exist %OPENEV_FW_OVERRIDE%\setfw.bat SET OPENEV_FW_DIR=%OPENEV_FW_OVERRIDE%

IF exist %OPENEV_FW_DIR%\setfw.bat goto skip_err

echo OPENEV_FW_DIR not set properly in setfw.bat, please fix and rerun.
goto ALL_DONE

:SKIP_ERR

PATH=%OPENEV_FW_DIR%\bin;%OPENEV_FW_DIR%\python;%PATH%
set PYTHONPATH=%OPENEV_FW_DIR%\pymod;%OPENEV_FW_DIR%\numpy
set PROJ_LIB=%OPENEV_FW_DIR%\proj_lib
set GEOTIFF_CSV=%OPENEV_FW_DIR%\data
set GDAL_DATA=%OPENEV_FW_DIR%\data

:ALL_DONE




From warmerdam at pobox.com  Wed Mar 31 14:34:56 2004
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdalwarp GDAL_DATA environment variable
In-Reply-To: <406B1320.50408@co.fulton.ga.us>
References: <406B1320.50408@co.fulton.ga.us>
Message-ID: <406B1D60.1040305@pobox.com>

Colin Gowens wrote:
> Hello List,
> 
> I am trying to use gdalwarp with windows xp.  My command is: gdalwarp 
> -t_srs EPSG:26967 test.tif warp.tif
> The error message is
> 
>                  Unable to open EPSG support file gcs.csv
>                  Try setting the GDAL_DATA environment variable to point 
> to the
>                  directory containing EPSG csv files.
>                  ERROR 1: translating source or target SRS failed
>           EPSG 26967
> 
> Based on previous posts, I edited setfw.bat as follows but the same 
> error is posted. If I give the full call for t_srs (e.g., "+proj=tmerc 
> ..."), then everything seems to work ok.
> 
> On another note, the -n flag in gdal_merge.py gives error that is unable 
> to find numeric but gdalnumeric.py is in the pymod directory.

Colin,

I am afraid I have been unable to reproduce any of these problems.  I
download OpenEV_FW 1.6.3, and working from a stripped down environment was
able to expand EPSG:26967 (I used "testepsg EPSG:26967"), and to use
gdal_merge.py with the -n flag.

Is it possible you have other stuff setting the PYTHONPATH environment
variable, GDAL_DATA or other related environment variables?  What does your
"set" output look like after running setfw.bat?

Sometimes it seems so hard to get a clean binary distribution for windows
that works for everyone!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From carl.anderson at co.fulton.ga.us  Wed Mar 31 15:52:54 2004
From: carl.anderson at co.fulton.ga.us (Carl Anderson)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] gdalwarp GDAL_DATA environment variable
In-Reply-To: <406B1320.50408@co.fulton.ga.us>
References: <406B1320.50408@co.fulton.ga.us>
Message-ID: <406B2FA6.9070903@co.fulton.ga.us>

Colin Gowens wrote:
> Hello List,
> 
> I am trying to use gdalwarp with windows xp.  My command is: gdalwarp 
> -t_srs EPSG:26967 test.tif warp.tif
> The error message is
> 
>                  Unable to open EPSG support file gcs.csv
>                  Try setting the GDAL_DATA environment variable to point 
> to the
> 
> Any suggestions are appreciated.
> Thanks.
> Colin
> 

I manually set GDAL_DATA on Colin's workstation and had no problems with 
gdalwarp -t_srs EPSG:26967.



-- 
Carl Anderson
GIS Manager, Fulton County E&CD
404.730.8026
carl.anderson@co.fulton.ga.us


From gagant at hotmail.com  Wed Mar 31 18:01:05 2004
From: gagant at hotmail.com (Gagan Tandon)
Date: Wed Nov 21 11:49:07 2007
Subject: [Gdal-dev] Problems with building GDAL on solaris
Message-ID: <BAY8-F125hjJ8uT6Ssu0001cb8d@hotmail.com>

An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20040401/ef6ac2ae/attachment.html
