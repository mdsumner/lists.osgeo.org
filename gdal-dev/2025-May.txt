From fengting.chen at oracle.com  Thu May  1 05:11:02 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 1 May 2025 12:11:02 +0000
Subject: [gdal-dev] [External] : Re: Build failed with "cannot deduce
 template arguments" error
In-Reply-To: <a74b1d55-8258-4053-affe-f0ea575ea06c@spatialys.com>
References: <PH0PR10MB70616DD21AC2D687C06F6AE193802@PH0PR10MB7061.namprd10.prod.outlook.com>
 <11f84255-dad8-4820-a734-86c5c0ab8448@spatialys.com>
 <PH0PR10MB7061D51CCF43E006A8F9B85393832@PH0PR10MB7061.namprd10.prod.outlook.com>
 <a74b1d55-8258-4053-affe-f0ea575ea06c@spatialys.com>
Message-ID: <PH0PR10MB7061BED647252DB38B53CDCD93822@PH0PR10MB7061.namprd10.prod.outlook.com>

Verified that your change worked for my compiler. Thank you!

From: Even Rouault <even.rouault at spatialys.com>
Date: Wednesday, April 30, 2025 at 6:17?AM
To: Fengting Chen <fengting.chen at oracle.com>, gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [External] : Re: [gdal-dev] Build failed with "cannot deduce template arguments" error

GCC 8 release notes indicate that C++17 support is still be a bit experimental for the standard library. Anyway, can you try https://github.com/OSGeo/gdal/pull/12231<https://urldefense.com/v3/__https:/github.com/OSGeo/gdal/pull/12231__;!!ACWV5N9M2RV99hQ!LLypbO_HDg16BnOo4IDARi1zrLUzkmyWhmjNTbwBoT0ieGdQEl9YHkmMpYB1ld6UKWExDemX6KdmuKiu28xp8Ye6fs7T$> ? I don't have access to your compiler so I couldn't check with it, but I'd assume it should make template deduction easier for the compiler.
Le 30/04/2025 ? 05:10, Fengting Chen a ?crit :
I am using ?c++ (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18.0.6)? which is supposed to support C++17.

From: Even Rouault <even.rouault at spatialys.com><mailto:even.rouault at spatialys.com>
Date: Tuesday, April 29, 2025 at 6:10?PM
To: Fengting Chen <fengting.chen at oracle.com><mailto:fengting.chen at oracle.com>, gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org><mailto:gdal-dev at lists.osgeo.org>
Subject: [External] : Re: [gdal-dev] Build failed with "cannot deduce template arguments" error

Which compiler and compiler version do you use ? It is likely it is too old and doesn't fully support C++17
Le 29/04/2025 ? 23:18, Fengting Chen via gdal-dev a ?crit :
Hi, I am trying to build GDAL from the master branch, but got the following error:

[ 46%] Building CXX object alg/CMakeFiles/alg.dir/gdal_interpolateatpoint.cpp.o
In file included from /scratch/gdal/gdal/alg/gdal_interpolateatpoint.cpp:20:
/scratch/gdal/gdal/gcore/gdal_vectorx.h: In member function ?~@~Xgdal::         VectorX<T, N>::self_type gdal::VectorX<T, N>::operator+(T) const?~@~Y:
/scratch/gdal/gdal/gcore/gdal_vectorx.h:173:44: error: cannot deduce template   arguments for ?~@~Xplus?~@~Y from ()
          return operatorImpl(arg, std::plus());
                                             ^

My configuration is:
--   Target system:             Linux
--   Installation directory:    /usr/local
--   C++ Compiler type:         GNU
--   C compile command line:     /bin/cc
--   C++ compile command line:   /bin/c++
--
--   CMAKE_C_FLAGS:               -fvisibility=hidden
--   CMAKE_CXX_FLAGS:               -fvisibility=hidden
--   CMAKE_CXX17_STANDARD_COMPILE_OPTION:              -std=c++17
--   CMAKE_CXX17_EXTENSION_COMPILE_OPTION:              -std=gnu++17
--   CMAKE_EXE_LINKER_FLAGS:
--   CMAKE_MODULE_LINKER_FLAGS:               -Wl,--no-undefined
--   CMAKE_SHARED_LINKER_FLAGS:               -Wl,--no-undefined
--   CMAKE_STATIC_LINKER_FLAGS:

Any idea on how to fix the error?

Thanks!


_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!OOJ0fjd1DRqARN5Zwu2h2bUnGxx24Gm7BRrjicc_T6TOWw47z1fKS1DmrwT_3UWuTnrn2lyb2-GqSG_ErtSHw1UapGVT$>

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!OOJ0fjd1DRqARN5Zwu2h2bUnGxx24Gm7BRrjicc_T6TOWw47z1fKS1DmrwT_3UWuTnrn2lyb2-GqSG_ErtSHw2hmL07K$>

My software is free, but my time generally not.

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!LLypbO_HDg16BnOo4IDARi1zrLUzkmyWhmjNTbwBoT0ieGdQEl9YHkmMpYB1ld6UKWExDemX6KdmuKiu28xp8WvOW-ur$>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250501/4cce0550/attachment-0001.htm>

From andrew.bell.ia at gmail.com  Fri May  2 08:11:36 2025
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 2 May 2025 11:11:36 -0400
Subject: [gdal-dev] Search This Mailing List?
Message-ID: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>

Hi,

Is there an easy way to search the archives of this mailing list?

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250502/aa6cadf8/attachment.htm>

From dbaston at gmail.com  Fri May  2 08:25:03 2025
From: dbaston at gmail.com (Daniel Baston)
Date: Fri, 2 May 2025 11:25:03 -0400
Subject: [gdal-dev] Search This Mailing List?
In-Reply-To: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
References: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
Message-ID: <CA+K_q_rHp-EzCFWy8J6LbjGQVSTOmW_+EKtNWYKKVB2KMrfj2g@mail.gmail.com>

Hi Andrew,

Some ideas are discussed in this thread:
https://lists.osgeo.org/pipermail/gdal-dev/2024-August/059331.html

I wish it were easier.

Dan

On Fri, May 2, 2025 at 11:11?AM Andrew Bell via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi,
>
> Is there an easy way to search the archives of this mailing list?
>
> Thanks,
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250502/8dec2aa1/attachment.htm>

From jmckenna at gatewaygeomatics.com  Fri May  2 09:24:15 2025
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 2 May 2025 13:24:15 -0300
Subject: [gdal-dev] Search This Mailing List?
In-Reply-To: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
References: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
Message-ID: <254032b8-164f-4c47-9b55-b6f696d9ca9b@gatewaygeomatics.com>

Hi Andrew,

If my memory is correct, Matt & I enabled this archive search back in 
2021-ish: https://www.mail-archive.com/gdal-dev at lists.osgeo.org/

-jeff



-- 
Jeff McKenna
GatewayGeo: Developers of MS4W, & offering MapServer Consulting/Dev
co-founder of FOSS4G
http://gatewaygeo.com/




On 2025-05-02 12:11 p.m., Andrew Bell via gdal-dev wrote:
> Hi,
> 
> Is there an easy way to search the archives of this mailing list?
> 
> Thanks,
> 
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com <mailto:andrew.bell.ia at gmail.com>
>

From matt.gregory at oregonstate.edu  Fri May  2 09:57:27 2025
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Fri, 2 May 2025 16:57:27 +0000
Subject: [gdal-dev] setting PYTHONSO correctly on Windows for VRT pixel
 functions
Message-ID: <SJ0P222MB0487074C8A64653D482B62AB988D2@SJ0P222MB0487.NAMP222.PROD.OUTLOOK.COM>

Hi all,

I'm following the instructions for using Python pixel functions to create derived VRT bands here (https://gdal.org/en/stable/drivers/raster/vrt.html#using-derived-bands-with-pixel-functions-in-python).  

Based on the section for "Linking mechanism to a Python interpreter", I've tried the following:

  set PYTHONSO=python312.dll

and 

  set PYTHONSO=C:\Users\xxx\AppData\Local\Programs\Python\Python312\python312.dll

(Note that C:\Users\xxx\AppData\Local\Programs\Python\Python312 in in my PATH, so I thought the first would work).

Neither of these worked and I'm getting this message when running "gdalinfo -stats test.vrt"

ERROR 1: Cannot load C:\Users\gregorma\AppData\Local\Programs\Python\Python312\python312.dll

If I run this without PYTHONSO being set, I get:

ERROR 1: Cannot find python/libpython. You can set the PYTHONSO configuration option to point to the a python .so/.dll/.dylib

One possible complication is that I'm running this in a virtual environment, but as far as I'm aware the virtual environment has no separate DLL associated with it and relies on the base Python's DLL.  

Thanks for any advice on getting this set up correctly.

matt

From andrew.bell.ia at gmail.com  Fri May  2 12:21:27 2025
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Fri, 2 May 2025 15:21:27 -0400
Subject: [gdal-dev] OSX Dev Build
Message-ID: <CACJ51z3k1gvhYGQ4fFROKK4BvWesijEtmTgd4H5WAP56JDBDrw@mail.gmail.com>

Hi,

I'm trying to get an OSX dev build going against the current master branch
with test support. When I try to run the import as is being done by the CI
script, I get an error. It fails when trying to resolve
_CPLQuietWarningsErrorHandler, which I see is a new function. That function
is contained in the built libgdal.dylib:

(gdal.2) [issue-11533] $ nm libgdal.dylib | grep
_CPLQuietWarningsErrorHandler
00000000000292d0 T _CPLQuietWarningsErrorHandler

Any suggestions on resolution would be appreciated.

Here is the error:

(gdal.2) [issue-11533] $ DYLD_LIBRARY_PATH=/Users/abell/gdal/build
PYTHONPATH=/Users/abell/gdal/build/swig/python python3 -c "from osgeo
import gdal"
Traceback (most recent call last):
  File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 30, in
swig_import_helper
    return importlib.import_module(mname)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File
"/Users/abell/miniconda3/envs/gdal.2/lib/python3.13/importlib/__init__.py",
line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in
_find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 921, in _load_unlocked
  File "<frozen importlib._bootstrap>", line 813, in module_from_spec
  File "<frozen importlib._bootstrap_external>", line 1320, in create_module
  File "<frozen importlib._bootstrap>", line 488, in
_call_with_frames_removed
ImportError: dlopen(/Users/abell/gdal/build/swig/python/osgeo/_
gdal.cpython-313-darwin.so, 0x0002): symbol not found in flat namespace
'_CPLQuietWarningsErrorHandler'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<string>", line 1, in <module>
    from osgeo import gdal
  File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 35, in
<module>
    _gdal = swig_import_helper()
  File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 32, in
swig_import_helper
    return importlib.import_module('_gdal')
           ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File
"/Users/abell/miniconda3/envs/gdal.2/lib/python3.13/importlib/__init__.py",
line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ModuleNotFoundError: No module named '_gdal'

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250502/7c2c1c98/attachment.htm>

From even.rouault at spatialys.com  Fri May  2 15:15:42 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 3 May 2025 00:15:42 +0200
Subject: [gdal-dev] OSX Dev Build
In-Reply-To: <CACJ51z3k1gvhYGQ4fFROKK4BvWesijEtmTgd4H5WAP56JDBDrw@mail.gmail.com>
References: <CACJ51z3k1gvhYGQ4fFROKK4BvWesijEtmTgd4H5WAP56JDBDrw@mail.gmail.com>
Message-ID: <2a05f1cd-d91f-4c9d-8563-5158099130da@spatialys.com>

Andrew,

check the output of "otool -L 
/Users/abell/gdal/build/swig/python/osgeo/_gdal.cpython-313-darwin.so" 
to verify that it links against the libgdal.dylib you've built. M y 
assumption is that it links against an older version. The SONAME of 
libgdal has been bumped to 37 when 3.11beta1 has been cut, 2 weeks ago.

Even

Le 02/05/2025 ? 21:21, Andrew Bell via gdal-dev a ?crit?:
> Hi,
>
> I'm trying to get an OSX?dev build going against the current master 
> branch with test support. When I try to run the import as is being 
> done by the CI script, I get an error. It fails when trying to resolve 
> _CPLQuietWarningsErrorHandler, which I see is a new function. That 
> function is contained?in the built libgdal.dylib:
>
> (gdal.2) [issue-11533] $ nm libgdal.dylib | grep 
> _CPLQuietWarningsErrorHandler
> 00000000000292d0 T _CPLQuietWarningsErrorHandler
>
> Any suggestions on resolution would be appreciated.
>
> Here is the error:
>
> (gdal.2) [issue-11533] $ DYLD_LIBRARY_PATH=/Users/abell/gdal/build 
> PYTHONPATH=/Users/abell/gdal/build/swig/python python3 -c "from osgeo 
> import gdal"
> Traceback (most recent call last):
> ? File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 
> 30, in swig_import_helper
> ? ? return importlib.import_module(mname)
> ? ? ? ? ? ?~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
> ? File 
> "/Users/abell/miniconda3/envs/gdal.2/lib/python3.13/importlib/__init__.py", 
> line 88, in import_module
> ? ? return _bootstrap._gcd_import(name[level:], package, level)
> ?~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> ? File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
> ? File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
> ? File "<frozen importlib._bootstrap>", line 1331, in 
> _find_and_load_unlocked
> ? File "<frozen importlib._bootstrap>", line 921, in _load_unlocked
> ? File "<frozen importlib._bootstrap>", line 813, in module_from_spec
> ? File "<frozen importlib._bootstrap_external>", line 1320, in 
> create_module
> ? File "<frozen importlib._bootstrap>", line 488, in 
> _call_with_frames_removed
> ImportError: 
> dlopen(/Users/abell/gdal/build/swig/python/osgeo/_gdal.cpython-313-darwin.so 
> <http://gdal.cpython-313-darwin.so>, 0x0002): symbol not found in flat 
> namespace '_CPLQuietWarningsErrorHandler'
>
> During handling of the above exception, another exception occurred:
>
> Traceback (most recent call last):
> ? File "<string>", line 1, in <module>
> ? ? from osgeo import gdal
> ? File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 
> 35, in <module>
> ? ? _gdal = swig_import_helper()
> ? File "/Users/abell/gdal/build/swig/python/osgeo/__init__.py", line 
> 32, in swig_import_helper
> ? ? return importlib.import_module('_gdal')
> ? ? ? ? ? ?~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
> ? File 
> "/Users/abell/miniconda3/envs/gdal.2/lib/python3.13/importlib/__init__.py", 
> line 88, in import_module
> ? ? return _bootstrap._gcd_import(name[level:], package, level)
> ?~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> ModuleNotFoundError: No module named '_gdal'
>
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250503/a4e9960c/attachment.htm>

From mdsumner at gmail.com  Sat May  3 20:09:15 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 4 May 2025 13:09:15 +1000
Subject: [gdal-dev] Search This Mailing List?
In-Reply-To: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
References: <CACJ51z1sX+4qYE_HTgAu2qLOrtnDhxF9hs_gGM=j5Fa7KLyC5g@mail.gmail.com>
Message-ID: <CAAcGz9-6Gn=buO2hz_Z+qn+V9xppt2uEvGg4ebg-XFgcLxt65A@mail.gmail.com>

This archive is searchable, updates once a month I think:

https://github.com/mdsumner/lists.osgeo.org

On Sat, May 3, 2025, 01:25 Andrew Bell via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Hi,
>
> Is there an easy way to search the archives of this mailing list?
>
> Thanks,
>
> --
> Andrew Bell
> andrew.bell.ia at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
Michael Sumner
Research Software Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250504/47a1a4f4/attachment.htm>

From even.rouault at spatialys.com  Mon May  5 08:27:30 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 May 2025 17:27:30 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
Message-ID: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>

Hi,

I have prepared a GDAL/OGR 3.11.0 release candidate.

I'll call for a vote promoting it later this week if no serious problems are
reported before.

NEWS at:

 ? https://github.com/OSGeo/gdal/blob/v3.11.0RC1/NEWS.md

Pick up an archive among the following ones (by ascending size):

 ? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc1.tar.xz
 ? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc1.tar.gz
 ? https://download.osgeo.org/gdal/3.11.0/gdal3110rc1.zip

A snapshot of the gdalautotest suite is also available :

https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc1.tar.gz
https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc1.zip

A snapshot of the documentation is at:

 ? https://download.osgeo.org/gdal/3.11.0/gdal3110doc.zip

The following changes have been done since beta1:

Impacting packaging (new/renamed .man pages, build changes):
* Add 'gdal vsi move'
* Add 'gdal vsi sync'
* Add 'gdal raster sieve' (#12219)
* Add 'gdal raster pixel-info' (port of gdallocationinfo)
* Add 'gdal raster tile' (port of gdal2tiles)
* Add 'gdal raster reclassify' command (#12257)
* Rename 'gdal raster fillnodata' as 'gdal raster fill-nodata'
* Rename 'gdal raster astype' to gdal raster set-type' (#12250)
* Add data/leaflet_template.html
* Build: enable ExprTk if found on the system to avoid setting 
-DGDAL_USE_EXPRTK=ON

Other changes:
* Python bindings: Accept CRS definition in osr.SpatialReference constructor
* Fix build issues with isnan() on GFloat16
* Leveller: Changed type of class member from size_t to int, to fix 
problem with driver only working on 32-bit platforms. (#12166)
* Python bindings: Add Dataset.ReadAsMaskedArray
* gdalwarp: speed-up warping to COG with heavy transformers (TPS / 
geoloc) by avoiding to instantiate it twice (#12170)
* Internal libtiff: resync with upstream
* Python bindings: fix compatibility issue with SWIG 4.3.1 and 
PYTHONWARNINGS=error
* MRF: DeflateBlock(): avoid potential buffer overrun
* SWIG: Add Driver.CreateVector
* Leveller: Increased highest supported document version number from 9 
to 12. (#12191)
* Fix warning with Arrow 20.0
* overview.cpp: fix build on ARM32 (#12192)
* BMP: fix reading files with BITMAPV4 or BITMAPV5 headers (3.4 
regression) (#12196)
* gdalwarp: Emit error on invalid -srcnodata, -dstnodata
* gdalwarp: Guard against numeric parsing failures in INIT_DEST
* gdal_rasterize: fix/simplify vertical/horizontal detection
* gdal vector pipeline: make sure read step opens in vector mode
* gdal convert: better error message if input file cannot be opened (#12204)
* Add OGRPolygon::OGRPolygon(const OGREnvelope &envelope) constructor
* gdal raster clip: add options from vector clip
* Fix ComputeRasterMinMax() and ComputeStatistics() on a raster with all 
values to infinity
* gdal info: fix on a raster netCDF file (#12207)
* HTTP driver: Avoid warning with 'ogr2ogr out http://example.com/in.gpkg'
* Python bindings: avoid deprecation warning with setuptools >= 77.0.3
* CMake: Export GDAL library targets
* Python bindings: Add mask_resample_alg arg to ReadAsArray methods
* GeoJSON: do not advertize ODsCMeasuredGeometries, 
OLCMeasuredGeometries and ODsCMeasuredGeometries
* TopoJSON: do not advertize Z capabilities
* TopoJSON: read a top level 'crs' member (#12216)
* GDALComputeOvFactor(): try to return a power-of-two value when 
possible, to fix generation of overviews on GPKG with 
GoogleMapsCompatible (#12227)
* gdal raster fillnodata - optimization (#12215)
* gdal_vectorx.h: fix compatibility with gcc 8.5.0
* gdal cli: improve tokenization of creation options to avoid detecting 
FOO=BAR,BAZ as 2 options
* gdal raster polygonize: change --connectedness to 
--connect-diagonal-pixels (consistent with gdal raster sieve)
* gdal vector geom set-type: replace dimension flags with single option
* VRTDerivedRasterBand: Add reclassify pixel function (#12232)
* Register KEA deferred plugin before HDF5
* Improve error messages when creating a file with a known (deferred 
loading) driver but not installed
* gdal2tiles: fix wrong .kml file name and content at base resolution 
when --xyz is used
* infback9: Fix potential vulnerable cloned functions. (#12244, 
CVE-2016-9840)
* GDALDriverManager::RegisterDriver(): fix memleak if 
registering/unregistering/registering the MEM driver (master only)
* Add VSIMove()
* VSIMkdirRecursive(): fix VSIMdirRecursive('dir_name') (without slash)
* gdal cli: accept '-' filename as the UNIX alias for stdin/stdout
* tilematrixset: add definitions of WorldMercatorWGS84Quad, 
PseudoTMS_GlobalMercator, GoogleCRS84Quad
* gdal CLI: make --version only available to top 'gdal'
* gdal CLI: make --drivers only available to top 'gdal', 'gdal raster', 
'gdal vector', 'gdal mdim') (#12253)
* gdal cli: add hyphens to separate composite-word argument names (#12255)
* gdal raster resize: allow to specify size as percentage
* gdal raster calc: add --output-data-type
* gdal raster calc: add support for GDALG output
* PDF: Fix build against Poppler 2025.05.0
* CPLStrdod(): fix setting *endptr for values *starting* with 
inf/nan/etc. special values
* GDALAlgorithm: various enhancements and fixes
* CPLGreatestCommonDivisor(): harden, and avoid Coverity Scan warning
* GDALDriver::QuietDelete(): allow removing directories, except for 
containers of MapInfo and shapefiles

Best regards,

Even--

http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Mon May  5 08:35:39 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 May 2025 17:35:39 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
Message-ID: <ce06417f-54fe-4ff2-99f2-c387f91d0ada@spatialys.com>

and the release/3.11 branch has now been created.? master is open for 
3.12dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From howard at hobu.co  Mon May  5 11:17:00 2025
From: howard at hobu.co (Howard Butler)
Date: Mon, 5 May 2025 13:17:00 -0500
Subject: [gdal-dev] GDAL Maintainers Meeting Minutes
Message-ID: <E1C54D4F-BD33-451E-8777-B63D0AFB21E7@hobu.co>

Howard Butler, Dan Baston, Alessandro Pasotti, Mike Smith, Chris Toney and Javier Jimenez Shaw held the monthly GDAL Maintainers Meeting on 04/24/2025. The following items were discussed and reported upon:

Project News
----------------------------

* GDAL initiated purchase of an annual subscription of ReadTheDocs Gold for both GDAL and PROJ. Besides providing support to RTD, this new subscription provides more builders for both CI builders
* GDAL 3.11.0 release is imminent. See https://github.com/OSGeo/gdal/blob/v3.11.0RC1/NEWS.md for news and updates.
* The maintainers team is planning a recorded webinar about the new GDAL CLI being first released in GDAL 3.11. Look for an announcement about "GDAL Command Line Interface Modernization" later in May, with the webinar to take place in the latter half of June.
* Some members of the community will be sprinting again at BiDS in late September. See https://www.bigdatafromspace2025.org/ for details.

Maintenance activities update
------------------------------------------

Alessandro

* PR reviews
* gdal raster fill-nodata implementation

Dan

Dan provided the following report items:

> *Allow VRT pixel functions to add a constant value to a band, or multiply it by a constant factor (#12069)
> *Allow gdallocationinfo to query raster corner points (#12087)
> *Expose options to Python to produce an error when the requested window of a dataset is not entirely within the dataset (#12128)
> *Make it easier to construct vector datasets (#12199) and spatial reference systems (#12162) in Python
> *Add Python method to read from a dataset into a masked array (#12172)
> 
> *Add Python API documentation for ApplyGeoTransform and InvGeoTransform (#12078)
> *Edits to documentation of gdalwarp (#12088) and gdal_translate (#12161)
> 
> *Ensure that requested window is fully covered by gdal_translate output (#12105, #12127)
> *Make gdalwarp produce an error when a requested NoData value or buffer initialization value cannot be parsed (#12198)
> *Prevent precision loss in netCDF geotransform (#12047)
> 
> *Allow test suite to run with pytest < 8.2 (#12086)
> *Improve coverage of gdal_translate error cases (#12130)
> *Update instructions for installing GDAL development version with conda (#12125)
> *Skip some failing tests if external URLs cannot be accessed (#12200)
> 
> *PR reviews
> *Clarify handling of subwindows in gdal_translate code (#12131)

Even

Even was not able to attend and provided the following report items:

> * Add "gdal geom vector make-valid/segmentize/simplify/buffer"
> * Add "gdal raster hillshade/aspect/slope/color-map/tpi/tri" (port of gdaldem)
> * Add "gdal vector grid" (port of gdal_grid)
> * Add "gdal raster footprint" (port of gdal_footrpint)
> * Add "gdal raster clean-collar" (port of nearblack)
> * Add "gdal raster viewshed" (port of gdal_viewshed)
> * Add "gdal vector concat" (port of ogrmerge)
> * Add "gdal raster polygonize" (port of gdal_polygonize)
> * Add a mechanism to register external algorithms, in particular for drivers (compatible with deferred loading)
> * Add "gdal driver geopackage/openfilegdb repack"
> * Add "gdal driver pdf list-layers"
> * Add "gdal vsi list/copy/delete" (port of Python sample scripts gdal_ls/gdal_cp/gdal_rm)
> * Add "gdal vsi sozip create/optimize/list/validate" (port of sozip)
> * Add "gdal raster index" and "gdal driver gti create" (ports of gdaltindex)
> * Improvements in Python bindings for user-friendliness of invokation of "gdal" algorithms, in particular gdal.Run()
> * Merge raster/multidim 'MEM' and vector 'Memory' drivers into a single 'MEM' driver
> * gdal CLI: add suggestion for bad algorithm/argument name based on Damerau-Levenshtein distance
> * GDAL 3.10.3 release
> * GDAL 3.11.0beta1 snapshot preparation
> * Various bug fixes and reviews of pull requests

Javier

* Attended the virtual NGS & CGS Binational Geospatial Software Developers Summit in support of PROJ
* Developed additional/alternative databases for PROJ in support of new North America dynamic height regimes being provided by NGS and CGS so they can be used alongside support information provided by these agencies.


The next GDAL Maintainers Meeting is 05/22/2024 at 13:00 UTC. GDAL PSC members and Pull Request contributors are welcome to join by reaching out to me for an invite.

Howard



From sebastic at xs4all.nl  Mon May  5 12:02:27 2025
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Mon, 5 May 2025 21:02:27 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
Message-ID: <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl>

On 5/5/25 5:27 PM, Even Rouault via gdal-dev wrote:
> * Add 'gdal raster tile' (port of gdal2tiles)

This seems to have caused breakage on some architectures where -latomic is needed explicitly, as it now fails to build on armel & powerpc:

  https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=armel&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746471518&raw=0
  https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=powerpc&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746467435&raw=0

Kind Regards,

Bas

-- 
  GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Mon May  5 12:54:09 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 5 May 2025 21:54:09 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
 <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl>
Message-ID: <475191f8-d030-4aa5-b0e9-a7a447c6602d@spatialys.com>

Bas,

can you give a try at https://github.com/OSGeo/gdal/pull/12275 ?

Even

Le 05/05/2025 ? 21:02, Sebastiaan Couwenberg via gdal-dev a ?crit?:
> On 5/5/25 5:27 PM, Even Rouault via gdal-dev wrote:
>> * Add 'gdal raster tile' (port of gdal2tiles)
>
> This seems to have caused breakage on some architectures where 
> -latomic is needed explicitly, as it now fails to build on armel & 
> powerpc:
>
> ?https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=armel&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746471518&raw=0 
>
> ?https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=powerpc&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746467435&raw=0 
>
>
> Kind Regards,
>
> Bas
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From gdt at lexort.com  Mon May  5 14:15:33 2025
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 05 May 2025 17:15:33 -0400
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl> (Sebastiaan
 Couwenberg via gdal-dev's message of "Mon, 5 May 2025 21:02:27 +0200")
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
 <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl>
Message-ID: <rmiikmeoj2i.fsf@s1.lexort.com>

Sebastiaan Couwenberg via gdal-dev <gdal-dev at lists.osgeo.org> writes:

> This seems to have caused breakage on some architectures where -latomic is needed explicitly, as it now fails to build on armel & powerpc:
>
>  https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=armel&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746471518&raw=0
>  https://buildd.debian.org/status/fetch.php?pkg=gdal&arch=powerpc&ver=3.11.0%7Erc1%2Bdfsg-1%7Eexp1&stamp=1746467435&raw=0

Thanks; I'm adding "atomic64.mk" to the pkgsrc entry, which pulls in
libatomic for 64-bit ops on most systems that otherwise lack them, and
for i386 bumps compiler flags to presume a cpu new enough (we otherwise
can build for i486).

Probably this needs a NEWS entry as it seems like a prereq change.


From sebastic at xs4all.nl  Mon May  5 22:02:35 2025
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Tue, 6 May 2025 07:02:35 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <475191f8-d030-4aa5-b0e9-a7a447c6602d@spatialys.com>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
 <fc53452d-22bb-458c-8ff4-d2619ca5daa4@xs4all.nl>
 <475191f8-d030-4aa5-b0e9-a7a447c6602d@spatialys.com>
Message-ID: <0d2720fd-9f9d-4e09-ae76-87a2afa01cad@xs4all.nl>

On 5/5/25 9:54 PM, Even Rouault via gdal-dev wrote:
> can you give a try at https://github.com/OSGeo/gdal/pull/12275 ?

Thanks for the quick fix, that resolves the failure on armel & powerpc:

  https://buildd.debian.org/status/package.php?p=gdal&suite=experimental

m68k had the same failure, but that build needs several more hours at time of writing.

Kind Regards,

Bas

-- 
  GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From edzer.pebesma at uni-muenster.de  Tue May  6 02:03:50 2025
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Tue, 6 May 2025 11:03:50 +0200
Subject: [gdal-dev] GDAL 3.11.0 release candidate available
In-Reply-To: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
Message-ID: <752c65f6-34c6-4b6d-bb13-529d2da894fe@uni-muenster.de>

I checked against R packages sf, terra and stars and found nothing 
unexpected.

I didn't do further reverse dependency checks against the 1000+ revdeps, 
which Roger did until recently, as this takes longer than a few days on 
my laptop; I will try to set things up somewhere such that this can be 
done in shorter time.

Many regards,

On 05/05/2025 17:27, Even Rouault via gdal-dev wrote:
> Hi,
> 
> I have prepared a GDAL/OGR 3.11.0 release candidate.
> 
> I'll call for a vote promoting it later this week if no serious problems 
> are
> reported before.
> 
> NEWS at:
> 
>  ? https://github.com/OSGeo/gdal/blob/v3.11.0RC1/NEWS.md
> 
> Pick up an archive among the following ones (by ascending size):
> 
>  ? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc1.tar.xz
>  ? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc1.tar.gz
>  ? https://download.osgeo.org/gdal/3.11.0/gdal3110rc1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
> https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc1.tar.gz
> https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc1.zip
> 
> A snapshot of the documentation is at:
> 
>  ? https://download.osgeo.org/gdal/3.11.0/gdal3110doc.zip
> 
> The following changes have been done since beta1:
> 
> Impacting packaging (new/renamed .man pages, build changes):
> * Add 'gdal vsi move'
> * Add 'gdal vsi sync'
> * Add 'gdal raster sieve' (#12219)
> * Add 'gdal raster pixel-info' (port of gdallocationinfo)
> * Add 'gdal raster tile' (port of gdal2tiles)
> * Add 'gdal raster reclassify' command (#12257)
> * Rename 'gdal raster fillnodata' as 'gdal raster fill-nodata'
> * Rename 'gdal raster astype' to gdal raster set-type' (#12250)
> * Add data/leaflet_template.html
> * Build: enable ExprTk if found on the system to avoid setting - 
> DGDAL_USE_EXPRTK=ON
> 
> Other changes:
> * Python bindings: Accept CRS definition in osr.SpatialReference 
> constructor
> * Fix build issues with isnan() on GFloat16
> * Leveller: Changed type of class member from size_t to int, to fix 
> problem with driver only working on 32-bit platforms. (#12166)
> * Python bindings: Add Dataset.ReadAsMaskedArray
> * gdalwarp: speed-up warping to COG with heavy transformers (TPS / 
> geoloc) by avoiding to instantiate it twice (#12170)
> * Internal libtiff: resync with upstream
> * Python bindings: fix compatibility issue with SWIG 4.3.1 and 
> PYTHONWARNINGS=error
> * MRF: DeflateBlock(): avoid potential buffer overrun
> * SWIG: Add Driver.CreateVector
> * Leveller: Increased highest supported document version number from 9 
> to 12. (#12191)
> * Fix warning with Arrow 20.0
> * overview.cpp: fix build on ARM32 (#12192)
> * BMP: fix reading files with BITMAPV4 or BITMAPV5 headers (3.4 
> regression) (#12196)
> * gdalwarp: Emit error on invalid -srcnodata, -dstnodata
> * gdalwarp: Guard against numeric parsing failures in INIT_DEST
> * gdal_rasterize: fix/simplify vertical/horizontal detection
> * gdal vector pipeline: make sure read step opens in vector mode
> * gdal convert: better error message if input file cannot be opened 
> (#12204)
> * Add OGRPolygon::OGRPolygon(const OGREnvelope &envelope) constructor
> * gdal raster clip: add options from vector clip
> * Fix ComputeRasterMinMax() and ComputeStatistics() on a raster with all 
> values to infinity
> * gdal info: fix on a raster netCDF file (#12207)
> * HTTP driver: Avoid warning with 'ogr2ogr out http://example.com/in.gpkg'
> * Python bindings: avoid deprecation warning with setuptools >= 77.0.3
> * CMake: Export GDAL library targets
> * Python bindings: Add mask_resample_alg arg to ReadAsArray methods
> * GeoJSON: do not advertize ODsCMeasuredGeometries, 
> OLCMeasuredGeometries and ODsCMeasuredGeometries
> * TopoJSON: do not advertize Z capabilities
> * TopoJSON: read a top level 'crs' member (#12216)
> * GDALComputeOvFactor(): try to return a power-of-two value when 
> possible, to fix generation of overviews on GPKG with 
> GoogleMapsCompatible (#12227)
> * gdal raster fillnodata - optimization (#12215)
> * gdal_vectorx.h: fix compatibility with gcc 8.5.0
> * gdal cli: improve tokenization of creation options to avoid detecting 
> FOO=BAR,BAZ as 2 options
> * gdal raster polygonize: change --connectedness to --connect-diagonal- 
> pixels (consistent with gdal raster sieve)
> * gdal vector geom set-type: replace dimension flags with single option
> * VRTDerivedRasterBand: Add reclassify pixel function (#12232)
> * Register KEA deferred plugin before HDF5
> * Improve error messages when creating a file with a known (deferred 
> loading) driver but not installed
> * gdal2tiles: fix wrong .kml file name and content at base resolution 
> when --xyz is used
> * infback9: Fix potential vulnerable cloned functions. (#12244, 
> CVE-2016-9840)
> * GDALDriverManager::RegisterDriver(): fix memleak if registering/ 
> unregistering/registering the MEM driver (master only)
> * Add VSIMove()
> * VSIMkdirRecursive(): fix VSIMdirRecursive('dir_name') (without slash)
> * gdal cli: accept '-' filename as the UNIX alias for stdin/stdout
> * tilematrixset: add definitions of WorldMercatorWGS84Quad, 
> PseudoTMS_GlobalMercator, GoogleCRS84Quad
> * gdal CLI: make --version only available to top 'gdal'
> * gdal CLI: make --drivers only available to top 'gdal', 'gdal raster', 
> 'gdal vector', 'gdal mdim') (#12253)
> * gdal cli: add hyphens to separate composite-word argument names (#12255)
> * gdal raster resize: allow to specify size as percentage
> * gdal raster calc: add --output-data-type
> * gdal raster calc: add support for GDALG output
> * PDF: Fix build against Poppler 2025.05.0
> * CPLStrdod(): fix setting *endptr for values *starting* with inf/nan/ 
> etc. special values
> * GDALAlgorithm: various enhancements and fixes
> * CPLGreatestCommonDivisor(): harden, and avoid Coverity Scan warning
> * GDALDriver::QuietDelete(): allow removing directories, except for 
> containers of MapInfo and shapefiles
> 
> Best regards,
> 
> Even--
> 
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Edzer Pebesma (he/him)
Universit?t M?nster, Institute for Geoinformatics
Heisenbergstrasse 2, 48149 M?nster, Germany
Phone: +49 251 8333081


From Jon.Morris at jbarisk.com  Tue May  6 09:35:16 2025
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Tue, 6 May 2025 16:35:16 +0000
Subject: [gdal-dev] Vector VRT with OGRVRTUnionLayer
Message-ID: <CWLP123MB68764C66B974AAA7E125A1B28289A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>

Hello all,

I'm trying to write a tool to create vector VRTs and need a bit of clarification with OGRVRTUnionLayers.

Is it possible to have a union layer when the input layers have different geometry types? Currently I'm trying Polygon and Multipolygon and I'm not clear whether this should make a valid VRT or if I need to convert one of my input layers so the geometry types are the same.

Also, I want to support Shapefile, FileGDB, and PostGIS input layers - the geometry field names are different for each of these. The example in the doc shows that fields can be renamed - `<GeometryField name="vrt_geom_field_2" field="pg_geom_field_2">` but Shapefiles don't appear to have a geometry field name. Trying `field=""` does not work.

Here's an example VRT that I have created (using GDAL test data autotest/ogr/data/poly.shp and autotest/ogr/data/filegdb/curves.gdb):

<OGRVRTDataSource>
    <Metadata />
    <OGRVRTUnionLayer name="merged">
        <SourceLayerFieldName>Input layer</SourceLayerFieldName>
        <OGRVRTLayer name="poly">
            <SrcDataSource relativeToVRT="1">poly.shp</SrcDataSource>
            <SrcLayer>poly</SrcLayer>
        </OGRVRTLayer>
        <OGRVRTLayer name="polygon">
            <SrcDataSource relativeToVRT="1">curves.gdb</SrcDataSource>
            <SrcLayer>polygon</SrcLayer>
        </OGRVRTLayer>
        <ExtentXMin>3.339061908000076</ExtentXMin>
        <ExtentYMin>38.30604436200008</ExtentYMin>
        <ExtentXMax>481645.3125</ExtentXMax>
        <ExtentYMax>4765610.5</ExtentYMax>
    </OGRVRTUnionLayer>
</OGRVRTDataSource>

Ogrinfo shows separate entries for geometry, extent, wkt, and geometry column. How can I get the union layer to only show one of each?

$ ogrinfo -al -so test.vrt
INFO: Open of `test.vrt'
      using driver `OGR_VRT' successful.

Layer name: merged
Geometry (): Polygon
Geometry (SHAPE): Multi Polygon
Feature Count: 15
Extent (): (3.339062, 38.306044) - (481645.312500, 4765610.500000)
Extent (SHAPE): (3.339062, 38.306044) - (12.092784, 49.244892)
SRS WKT ():
PROJCRS["OSGB36 / British National Grid",
    BASEGEOGCRS["OSGB36",
        DATUM["Ordnance Survey of Great Britain 1936",
            ELLIPSOID["Airy 1830",6377563.396,299.3249646,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433]],
        ID["EPSG",4277]],
    CONVERSION["British National Grid",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",49,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",-2,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.9996012717,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",400000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",-100000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    USAGE[
        SCOPE["Engineering survey, topographic mapping."],
        AREA["United Kingdom (UK) - offshore to boundary of UKCS within 49?45'N to 61?N and 9?W to 2?E; onshore Great Britain (England, Wales and Scotland). Isle of Man onshore."],
        BBOX[49.75,-9,61.01,2.01]],
    ID["EPSG",27700]]
Data axis to CRS axis mapping: 1,2
SRS WKT (SHAPE):
GEOGCRS["WGS 84",
    ENSEMBLE["World Geodetic System 1984 ensemble",
        MEMBER["World Geodetic System 1984 (Transit)"],
        MEMBER["World Geodetic System 1984 (G730)"],
        MEMBER["World Geodetic System 1984 (G873)"],
        MEMBER["World Geodetic System 1984 (G1150)"],
        MEMBER["World Geodetic System 1984 (G1674)"],
        MEMBER["World Geodetic System 1984 (G1762)"],
        MEMBER["World Geodetic System 1984 (G2139)"],
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]],
        ENSEMBLEACCURACY[2.0]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    USAGE[
        SCOPE["Horizontal component of 3D system."],
        AREA["World."],
        BBOX[-90,-180,90,180]],
    ID["EPSG",4326]]
Data axis to CRS axis mapping: 2,1
Geometry Column 1 =
Geometry Column 2 = SHAPE
Input layer: String (0.0)
AREA: Real (12.3)
EAS_ID: Integer64 (11.0)
PRFEDEA: String (16.0)
SHAPE_Length: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_LENGTH
SHAPE_Area: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_AREA



When I open the VRT programmatically and iterate through the features, FIDs 10-14 (i.e. those from the FGDB layer) have no geometry. Do I need to add something like `<GeometryField name="SHAPE" />` to each layer so the geometry fields are found?

Thanks,

Jon



Jon Morris
Software Developer
--


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250506/5bb07f7b/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image670191.png
Type: image/png
Size: 7388 bytes
Desc: image670191.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250506/5bb07f7b/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image526410.png
Type: image/png
Size: 5172 bytes
Desc: image526410.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250506/5bb07f7b/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image877390.png
Type: image/png
Size: 774 bytes
Desc: image877390.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250506/5bb07f7b/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image078618.png
Type: image/png
Size: 797 bytes
Desc: image078618.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250506/5bb07f7b/attachment-0007.png>

From even.rouault at spatialys.com  Tue May  6 09:50:40 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 6 May 2025 18:50:40 +0200
Subject: [gdal-dev] GDAL 3.11.0RC2 is available (Re: GDAL 3.11.0 release
 candidate available)
In-Reply-To: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
References: <520ec718-86e8-4e5a-a82c-8341dd3209c7@spatialys.com>
Message-ID: <44132cda-3fe1-4ff1-bc0e-20296d82540b@spatialys.com>

Hi,

I've prepared a GDAL 3.11.0 RC2

Sources:

-? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc2.tar.xz
-? https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0rc2.tar.gz
-? https://download.osgeo.org/gdal/3.11.0/gdal3110rc2.zip

Autotest suite:
- https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc2.tar.gz
- https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0rc2.zip

Changes since RC1:

- S57: fix nullptr deref on invalid file when S57 data resource files 
are missing
- GDALG driver: implement GetFileList() so that --overwrite onto 
existing .gdalg.json file works
- Fix linking std::atomic<uint64_t> on 32-bit architectures that lack 
native 64-bit atomic operations
- gdal raster/vector pipeline to .gdalg.json: add 'gdal_version' member
- ogr2ogr --help: display metavar for --clipsrc and --clipdst
- gdal raster tile: do not generate mapml file in raster mode
- gdal raster tile: add --kml option
- KML: when reassembling multi-line text content, use newline character 
instead of space (#12278)
- GPKG: call sqlite3_errmsg() in error messages (#12247)
- Doc: various enhancements regarding "gdal" CLI documentation

Even


-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jukka.rahkonen at maanmittauslaitos.fi  Tue May  6 13:36:13 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Tue, 6 May 2025 20:36:13 +0000
Subject: [gdal-dev] Vector VRT with OGRVRTUnionLayer
In-Reply-To: <CWLP123MB68764C66B974AAA7E125A1B28289A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
References: <CWLP123MB68764C66B974AAA7E125A1B28289A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <DB9PR09MB6887FBB00242BA5E89ECB593FD89A@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

Partial answer based on editing the example https://gdal.org/en/stable/drivers/vector/vrt.html#example-union-layer

Sources: polygon shapefile and point shapefile
Output: one layer with unknown/any geometry type

unionlayer.vrt
========
<OGRVRTDataSource>
    <OGRVRTUnionLayer name="unionLayer">
        <OGRVRTLayer name="poly">
            <SrcDataSource>poly.shp</SrcDataSource>
            <GeometryType>wkbUnknown</GeometryType>
        </OGRVRTLayer>
        <OGRVRTLayer name="point">
            <SrcDataSource>point.shp</SrcDataSource>
            <GeometryType>wkbUnknown</GeometryType>
        </OGRVRTLayer>
    </OGRVRTUnionLayer>
</OGRVRTDataSource>

ogrinfo unionlayer.vrt -al
INFO: Open of `unionlayer.vrt'
      using driver `OGR_VRT' successful.

Layer name: unionLayer
Geometry: Unknown (any)
Feature Count: 2
Extent: (258.000000, 176.000000) - (507.000000, 345.000000)
Layer SRS WKT:
(unknown)
OGRFeature(unionLayer):0
  POLYGON ((365 311,507 281,332 176,258 237,365 311))

OGRFeature(unionLayer):1
  POINT (282 345)

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jon Morris via gdal-dev puolesta
L?hetetty: Tiistai 6. toukokuuta 2025 19.35
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Vector VRT with OGRVRTUnionLayer

Hello all,?I?m trying to write a tool to create vector VRTs and need a bit of clarification with OGRVRTUnionLayers. ?Is it possible to have a union layer when the input layers have different geometry types? Currently I?m trying Polygon and Multipolygon and I?m not clear whether this should make a valid VRT or if I need to convert one of my input layers so the geometry types are the same.?Also, I want to support Shapefile, FileGDB, and PostGIS input layers ? the geometry field names are different for each of these. The example in the doc shows that fields can be renamed - `<GeometryField name="vrt_geom_field_2" field="pg_geom_field_2">` but Shapefiles don?t appear to have a geometry field name. Trying `field=??` does not work.?Here?s an example VRT that I have created (using GDAL test data autotest/ogr/data/poly.shp and autotest/ogr/data/filegdb/curves.gdb):?<OGRVRTDataSource>??? <Metadata />??? <OGRVRTUnionLayer name="merged">??? ????<SourceLayerFieldName>Input layer</SourceLayerFieldName>??? ????<OGRVRTLayer name="poly">??? ????????<SrcDataSource relativeToVRT="1">poly.shp</SrcDataSource>??? ????????<SrcLayer>poly</SrcLayer>??? ????</OGRVRTLayer>??? ????<OGRVRTLayer name="polygon">??? ????????<SrcDataSource relativeToVRT="1">curves.gdb</SrcDataSource>??? ????????<SrcLayer>polygon</SrcLayer>??? ????</OGRVRTLayer>??? ????<ExtentXMin>3.339061908000076</ExtentXMin>??? ????<ExtentYMin>38.30604436200008</ExtentYMin>??? ????<ExtentXMax>481645.3125</ExtentXMax>??? ????<ExtentYMax>4765610.5</ExtentYMax>??? </OGRVRTUnionLayer></OGRVRTDataSource>?Ogrinfo shows separate entries for geometry, extent, wkt, and geometry column. How can I get the union layer to only show one of each??$ ogrinfo -al -so test.vrtINFO: Open of `test.vrt'????? using driver `OGR_VRT' successful.?Layer name: mergedGeometry (): PolygonGeometry (SHAPE): Multi PolygonFeature Count: 15Extent (): (3.339062, 38.306044) - (481645.312500, 4765610.500000)Extent (SHAPE): (3.339062, 38.306044) - (12.092784, 49.244892)SRS WKT ():PROJCRS["OSGB36 / British National Grid",??? BASEGEOGCRS["OSGB36",??????? DATUM["Ordnance Survey of Great Britain 1936",??????????? ELLIPSOID["Airy 1830",6377563.396,299.3249646,??????????????? LENGTHUNIT["metre",1]]],??????? PRIMEM["Greenwich",0,??????????? ANGLEUNIT["degree",0.0174532925199433]],??????? ID["EPSG",4277]],??? CONVERSION["British National Grid",??????? METHOD["Transverse Mercator",??????????? ID["EPSG",9807]],??????? PARAMETER["Latitude of natural origin",49,??????????? ANGLEUNIT["degree",0.0174532925199433],??????????? ID["EPSG",8801]],??????? PARAMETER["Longitude of natural origin",-2,??????????? ANGLEUNIT["degree",0.0174532925199433],??????????? ID["EPSG",8802]],??????? PARAMETER["Scale factor at natural origin",0.9996012717,??????????? SCALEUNIT["unity",1],??????????? ID["EPSG",8805]],??????? PARAMETER["False easting",400000,??????????? LENGTHUNIT["metre",1],??????????? ID["EPSG",8806]],??????? PARAMETER["False northing",-100000,??????????? LENGTHUNIT["metre",1],??????????? ID["EPSG",8807]]],??? CS[Cartesian,2],??????? AXIS["(E)",east,??????????? ORDER[1],??????????? LENGTHUNIT["metre",1]],??????? AXIS["(N)",north,??????????? ORDER[2],??????????? LENGTHUNIT["metre",1]],??? USAGE[??????? SCOPE["Engineering survey, topographic mapping."],??????? AREA["United Kingdom (UK) - offshore to boundary of UKCS within 49?45'N to 61?N and 9?W to 2?E; onshore Great Britain (England, Wales and Scotland). Isle of Man onshore."],??????? BBOX[49.75,-9,61.01,2.01]],??? ID["EPSG",27700]]Data axis to CRS axis mapping: 1,2SRS WKT (SHAPE):GEOGCRS["WGS 84",??? ENSEMBLE["World Geodetic System 1984 ensemble",??????? MEMBER["World Geodetic System 1984 (Transit)"],??????? MEMBER["World Geodetic System 1984 (G730)"],??????? MEMBER["World Geodetic System 1984 (G873)"],??????? MEMBER["World Geodetic System 1984 (G1150)"],??????? MEMBER["World Geodetic System 1984 (G1674)"],??????? MEMBER["World Geodetic System 1984 (G1762)"],??????? MEMBER["World Geodetic System 1984 (G2139)"],??????? ELLIPSOID["WGS 84",6378137,298.257223563,??????????? LENGTHUNIT["metre",1]],??????? ENSEMBLEACCURACY[2.0]],??? PRIMEM["Greenwich",0,??????? ANGLEUNIT["degree",0.0174532925199433]],??? CS[ellipsoidal,2],??????? AXIS["geodetic latitude (Lat)",north,??????????? ORDER[1],??????????? ANGLEUNIT["degree",0.0174532925199433]],??????? AXIS["geodetic longitude (Lon)",east,??????????? ORDER[2],??????????? ANGLEUNIT["degree",0.0174532925199433]],??? USAGE[??????? SCOPE["Horizontal component of 3D system."],??????? AREA["World."],??????? BBOX[-90,-180,90,180]],??? ID["EPSG",4326]]Data axis to CRS axis mapping: 2,1Geometry Column 1 =Geometry Column 2 = SHAPEInput layer: String (0.0)AREA: Real (12.3)EAS_ID: Integer64 (11.0)PRFEDEA: String (16.0)SHAPE_Length: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_LENGTHSHAPE_Area: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_AREA???When I open the VRT programmatically and iterate through the features, FIDs 10-14 (i.e. those from the FGDB layer) have no geometry. Do I need to add something like `<GeometryField name="SHAPE" />` to each layer so the geometry fields are found??Thanks,?Jon???Jon MorrisSoftware Developer--?e:?Jon.Morris at jbarisk.comd:+44?(0)1756?587229t:?+44?(0)1756?799919www.jbarisk.com[X][X][X][X]???All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.????

From mlebihan29 at gmail.com  Tue May  6 20:40:22 2025
From: mlebihan29 at gmail.com (Marc Le Bihan)
Date: Wed, 7 May 2025 05:40:22 +0200
Subject: [gdal-dev] An attempt to switch Vagrantfile base box from Ubuntu 22
 to Debian 12, and open jdk from 11 to 17
Message-ID: <5e288b9d-d0fd-4761-b1e9-74b730aa5148@gmail.com>

Hello,

 ??? I'm posting this trial, this experience for information.
 ??? I'm searching to migrate few projects from Java JDK 11 to 17 (at 
least) to avoid a trap where recent operating systems haven't (and 
cannot anymore install) Java 11 on them. This involving upgrading some 
of their dependencies, by the way.

 ??? The long explanation of my motives is here 
<https://opensource.stackexchange.com/questions/15474/should-projects-with-dependencies-too-old-programming-languages-version-becomin>, 
and I was especially in need of that for gdal, for my own interest of 
studying it deeply.
 ??? For that, I was willing to get its convenient Vagrantfile, add 
locally for my own use a GNOME to it, and then install my CLion and 
others IDE there to work with it.

 ??? I encountered few troubles when generating the Vagrant VM that I 
took from master, but Stack Overflow community helped me to solve them. 
I've explained what happened to me here 
<https://stackoverflow.com/questions/79607954/a-project-is-built-from-a-vagrantfile-and-im-switching-its-base-box-now-a-vagr>. 


 ??? To resume: I've switched from Ubuntu 22 LTS Vagrant base box to a 
Debian 12 one, JDK 11 to 17, add to remove mold alternate linker mention 
to make everything build.
 ??? Now, everything can be built and tested, as changes allowing 96% of 
ctests to run still, and for pytest ones it's 16070 passed, 1 xpassed, 
268 failed. (I wasn't expecting everything could work like a charm 
immediately).

 ??? Your comments are welcome.

Regards,

Marc Le Bihan

For python tests failing ones are these ones, for either Runtime Error, 
Assertion Error or expected output file missing:

ogr/ogr_basic_test.py::test_ogr_basic_test_future_warning_exceptions
ogr/ogr_csv.py::test_ogr_csv_write_to_stdout
ogr/ogr_virtualogr.py::test_ogr_virtualogr_3
gcore/basic_test.py::test_basic_test_8
gcore/basic_test.py::test_basic_test_UseExceptions
gcore/basic_test.py::test_basic_test_UseExceptions_ogr_open
gcore/basic_test.py::test_basic_test_DontUseExceptions
gcore/misc.py::test_misc_quiet_errors[quiet_errors]
gcore/misc.py::test_misc_quiet_errors[quiet_warnings]
gcore/pam.py::test_pam_11
gcore/vsicurl_streaming.py::test_vsicurl_streaming_real_resource
gdrivers/bag.py::test_bag_force_opening_no_match
gdrivers/gdalhttp.py::test_http_6
gdrivers/netcdf_multidim.py::test_netcdf_multidim_cache_pamproxydb
gdrivers/wms.py::test_wms_data_via_mrf
osr/osr_basic.py::test_osr_basic_warning_exceptions
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_simple
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_zoom_option
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_resampling_option[average, near, bilinear, cubic, cubicspline, lanczos, mode, max, min, med, q1, q3]
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_xyz/te
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_invalid_srs
pyscripts/test_gdal2tiles.py::test_handle_utf8_filename
pyscripts/test_gdal2tiles.py::test_exclude_transparent_tiles
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_profile_raster
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_profile_raster_oversample
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_profile_raster_xyz
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_profile_geodetic_tmscompatible_xyz
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_mapml
pyscripts/test_gdal2tiles.py::test_gdal2tiles_excluded_values
pyscripts/test_gdal2tiles.py::test_gdal2tiles_nodata_values_pct_threshold
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_jpeg_3band_input[average-expected_stats_z00-expected_s
pyscripts/test_gdal2tiles.py::test_gdal2tiles_py_jpeg_1band_input[average-expected_stats_z140-expected_
pyscripts/test_gdal2xyz.py::test_gdal2xyz_py_2
pyscripts/test_gdal2xyz.py::test_gdal2xyz_py_3
pyscripts/test_gdal2xyz.py::test_gdal2xyz_py_srcnodata_dstnodata
pyscripts/test_gdal2xyz.py::test_gdal2xyz_py_vsistdout
pyscripts/test_gdal_calc.py::test_gdal_calc_py_1/test_g
pyscripts/test_gdal_calc.py::test_gdal_calc_py_1b/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_1c/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_2a/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_2b/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_2c/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_3/test_g
pyscripts/test_gdal_calc.py::test_gdal_calc_py_4a/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_4b/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_7a[--optfile ]
pyscripts/test_gdal_calc.py::test_gdal_calc_py_7a[@]/te
pyscripts/test_gdal_calc.py::test_gdal_calc_py_7b/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_7c/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_7d/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_8/test_g
pyscripts/test_gdal_calc.py::test_gdal_calc_py_10/test_
pyscripts/test_gdal_calc.py::test_gdal_calc_py_multiple_inputs_same_alpha
pyscripts/test_gdal_edit.py::test_gdal_edit_py_1[True]
pyscripts/test_gdal_edit.py::test_gdal_edit_py_1[False]
pyscripts/test_gdal_edit.py::test_gdal_edit_py_1b, 2 to 8
pyscripts/test_gdal_edit.py::test_gdal_edit_py_unsetrpc
pyscripts/test_gdal_edit.py::test_gdal_edit_py_epoch
pyscripts/test_gdal_fillnodata.py::test_gdal_fillnodata_1
pyscripts/test_gdal_fillnodata.py::test_gdal_fillnodata_2
pyscripts/test_gdal_fillnodata.py::test_gdal_fillnodata_smoothing
pyscripts/test_gdal_fillnodata.py::test_gdal_fillnodata_nearest
pyscripts/test_gdal_merge.py::test_gdal_merge_[1 to 5]/test_gd
pyscripts/test_gdal_pansharpen.py::test_gdal_pansharpen_1
pyscripts/test_gdal_pansharpen.py::test_gdal_pansharpen_2
pyscripts/test_gdal_polygonize.py::test_gdal_polygonize_[1 to 4]
pyscripts/test_gdal_polygonize.py::test_gdal_polygonize_4bis
pyscripts/test_gdal_polygonize.py::test_gdal_polygonize_minus_8
pyscripts/test_gdal_polygonize.py::test_gdal_polygonize_overwrite[geojson]
pyscripts/test_gdal_polygonize.py::test_gdal_polygonize_overwrite[gpkg]
pyscripts/test_gdal_proximity.py::test_gdal_proximity_[1 to 3]
pyscripts/test_gdal_retile.py::test_gdal_retile_[2 to 5]/test_
pyscripts/test_gdal_retile.py::test_gdal_retile_non_contigous
pyscripts/test_gdal_retile.py::test_gdal_retile_png/tes
pyscripts/test_gdal_retile.py::test_gdal_retile_rotational_geotransform
pyscripts/test_gdal_retile.py::test_gdal_retile_different_srs[32631-32632-has
pyscripts/test_gdal_retile.py::test_gdal_retile_different_srs[32631-None-has
pyscripts/test_gdal_retile.py::test_gdal_retile_different_srs[None-32631-has
pyscripts/test_gdal_sieve.py::test_gdal_sieve_1
pyscripts/test_gdal_sieve.py::test_gdal_sieve_src_without_nodata
pyscripts/test_gdal_utils_retcodes.py::test_script[input0 to 75]
pyscripts/test_gdalattachpct.py::test_gdalattachpct_basic
pyscripts/test_gdalattachpct.py::test_gdalattachpct_vrt_output p
pyscripts/test_gdalbuildvrtofvrt.py::test_gdalbuildvrtofvrt_basic an
pyscripts/test_gdalbuildvrtofvrt.py::test_gdalbuildvrtofvrt_intermediate_vrt_path
pyscripts/test_gdalbuildvrtofvrt.py::test_gdalbuildvrtofvrt_intermediate_vrt_path_specified_ovr_factors
pyscripts/test_gdalcompare.py::test_gdalcompare_same
pyscripts/test_gdalcompare.py::test_gdalcompare_different_type
pyscripts/test_gdalinfo_py.py::test_gdalinfo_py_[1 to 10]
pyscripts/test_gdallocationinfo_py.py::test_gdallocationinfo_py_1
pyscripts/test_gdallocationinfo_py.py::test_gdallocationinfo_py_3
pyscripts/test_gdallocationinfo_py.py::test_gdallocationinfo_py_4
pyscripts/test_gdallocationinfo_py.py::test_gdallocationinfo_py_6
pyscripts/test_gdallocationinfo_py.py::test_gdallocationinfo_py_wgs84
pyscripts/test_gdalmove.py::test_gdalmove_1
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_intersection
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_union
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_symdifference
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_identity
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_update
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_clip
pyscripts/test_ogr_layer_algebra.py::test_ogr_layer_algebra_erase
pyscripts/test_ogrinfo_py.py::test_ogrinfo_py_[1 to 11, 22 and 23]
pyscripts/test_ogrmerge.py::test_ogrmerge_[1 to 7]/test_ogrmer
pyscripts/test_ogrmerge.py::test_ogrmerge_7a/test_ogrme
pyscripts/test_ogrmerge.py::test_ogrmerge_7b/test_ogrme
pyscripts/test_ogrmerge.py::test_ogrmerge_7c/test_ogrme
pyscripts/test_ogrmerge.py::test_ogrmerge_[8 to 12]/test_ogrmer
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-True-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-False-True-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[False-True-True-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[False-False-True-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-None-None-None0]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-False-False-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[False-True-False-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[False-False-False-None-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-None-None-None1]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-EPSG:32631-None-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-None-EPSG:32631-None]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-None-None-EPSG:32631]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg[True-True-False-None-EPSG:32631-EPSG:4326]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg_non_spatial[True]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg_non_spatial[False]
pyscripts/test_ogrmerge.py::test_ogrmerge_gpkg_curve_geom_in_generic_layer
pyscripts/test_pct.py::test_rgb2pct_1/tmp7/test_rgb2pct
pyscripts/test_pct.py::test_pct2rgb_1/test_pct2rgb_10/t
pyscripts/test_pct.py::test_rgb2pct_2/tmp8/test_rgb2pct
pyscripts/test_pct.py::test_rgb2pct_creation_option/tes
pyscripts/test_pct.py::test_rgb2pct_3/test_rgb2pct_30/t
pyscripts/test_pct.py::test_pct2rgb_4/test_pct2rgb_40/t
pyscripts/test_pct.py::test_gdalattachpct_1
pyscripts/test_validate_geoparquet.py::test_validate_geoparquet_not_parquet_file
pyscripts/test_validate_geoparquet.py::test_validate_geoparquet_ok


For ctest, the failing ones are these ones :

 ???? 44 - test-virtual-memory (Failed)
 ???? 59 - autotest_gdrivers (Failed)

(but I had few more failing at a previous attempt. I think : 5 of them)

Here are the changes I've experienced for this attempt on the gdal 
Vagrantfile :

diff --git a/Vagrantfile b/Vagrantfile
index dd1ec6019d..ac7203d4ba 100644
--- a/Vagrantfile
+++ b/Vagrantfile
@@ -8,10 +8,11 @@ VAGRANTFILE_API_VERSION = "2"
  
  Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
    # specify memory size in MiB
-  vm_ram = ENV['VAGRANT_VM_RAM'] || 4096
-  vm_cpu = ENV['VAGRANT_VM_CPU'] || 2
+  vm_ram = ENV['VAGRANT_VM_RAM'] || 8192
+  vm_cpu = ENV['VAGRANT_VM_CPU'] || 8
    vm_ram_bytes = vm_ram * 1024 * 1024
  
+  config.vm.synced_folder "./", "/vagrant"
    config.vm.hostname = "gdal-vagrant"
    config.vm.host_name = "gdal-vagrant"
  
@@ -34,16 +35,25 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
    # Seehttps://bugs.launchpad.net/cloud-images/+bug/1969664
    # Ubuntu 22.04 no longer accepts RSA keys, which causes issues with older Vagrant
    # The below location has a jammy64 image that accepts RSA keys
-  config.vm.box_url ="https://people.canonical.com/~jchittum/vagrant-testing/ubuntu-jammy-vagrant-TESTING-20220419.box"
-  config.vm.box = "ubuntu/jammy64"
+  config.vm.box = "generic/debian12"
+  config.vm.box_version = "4.3.12"
  
    config.vm.provider :virtualbox do |vb|
       vb.customize ["modifyvm", :id, "--memory", vm_ram]
       vb.customize ["modifyvm", :id, "--cpus", vm_cpu]
       vb.customize ["modifyvm", :id, "--ioapic", "on"]
       vb.name = "gdal-vagrant"
+
+     # vb.gui = true
    end
  
+  config.vm.provision "shell", inline: <<-SHELL
+     sudo apt install gnupg2
+     sh -c 'echo "debhttp://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'
+     curl -fsSLhttps://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo gpg --dearmor -o /etc/apt/trusted.gpg.d/postgresql.gpg
+     apt-get update && DEBIAN_FRONTEND=noninteractive apt-get upgrade -y
+  SHELL
+
    #config.vm.provider :lxc do |lxc,ovrd|
    #  ovrd.vm.box = "cultuurnet/ubuntu-14.04-64-puppet"
    #  lxc.backingstore = 'dir'
@@ -77,15 +87,6 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
        }
    end
  
-  # Unless explicitly declined, use the VM host's file system to cache
-  # .deb files to avoid repeated downloads on each vagrant up
-  unless File.exists?("../.no_apt_cache")
-    cache_dir = "../apt-cache/#{config.vm.box}"
-    FileUtils.mkdir_p(cache_dir) unless Dir.exists?(cache_dir)
-    puts "Using local apt cache, #{cache_dir}"
-    config.vm.synced_folder cache_dir, "/var/cache/apt/archives"
-  end
-
    ppaRepos = [
    ]
  
@@ -115,7 +116,7 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
      "bash-completion",
      "swig",
      "ant",
-    "openjdk-11-jdk",
+    "openjdk-17-jdk",
      "mono-mcs",
      "mono-runtime",
      "libmono-system-drawing4.0-cil", @@ -124,8 +125,8 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do 
|config| "python3-setuptools",
      "python3-pip",
      "postgis",
-    "postgresql",
-    "postgresql-postgis",
+    "postgresql-14",
+    "postgresql-14-postgis-3",
      "gpsbabel",
      "doxygen",
      "libproj-dev", @@ -159,7 +160,7 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do 
|config| "libcrypto++-dev",
      "libfyba-dev",
      "libkml-dev",
-    "libmysqlclient-dev",
+    "libmariadb-dev",
      "libogdi-dev",
      "libcfitsio-dev",
      "libzstd-dev", @@ -177,6 +178,7 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do 
|config| "libqhull-dev",
      "libjson-c-dev",
      "libtiff5-dev",
+    "libgtest-dev",
    ];
  
    config.ssh.forward_agent = true
@@ -191,7 +193,8 @@ Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|
      # install packages we need
      pkg_cmd << "apt-get update -qq; "
      pkg_cmd << "apt-get --no-install-recommends install -q -y " + packageList.join(" ") << " ; "
-
+    pkg_cmd << "pip install pytest filelock lxml --break-system-package; "
+
      # setup environment when we log in
      pkg_cmd << "echo 'CCACHE_DIR=/vagrant/ccache_vagrant' >> /etc/environment; "
      pkg_cmd << "echo 'cd /vagrant/build_vagrant; source /vagrant/scripts/setdevenv.sh' >> /home/vagrant/.bashrc; "
diff --git a/scripts/vagrant/gdal.sh b/scripts/vagrant/gdal.sh
index 5a5dc6bf02..725e2712cb 100755
--- a/scripts/vagrant/gdal.sh
+++ b/scripts/vagrant/gdal.sh
@@ -26,9 +26,8 @@ cmake .. \
    -GNinja \
    -DCMAKE_INSTALL_PREFIX=/opt/gdal-dev \
    -DUSE_CCACHE=ON \
-  -DUSE_ALTERNATE_LINKER:STRING=mold \
    -DCMAKE_BUILD_TYPE=Debug
  ninja -j6
  sudo ninja install
  
-PYTHON_CMD=python3 && $PYTHON_CMD -m pip install -r ../autotest/requirements.txt
+PYTHON_CMD=python3 && $PYTHON_CMD -m pip install -r ../autotest/requirements.txt --break-system-packages
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/3b99c484/attachment-0001.htm>

From a.pau at creaf.cat  Tue May  6 22:24:47 2025
From: a.pau at creaf.cat (Abel Pau)
Date: Wed, 7 May 2025 05:24:47 +0000
Subject: [gdal-dev] =?windows-1252?q?A_new_driver_to_support_MiraMon=92s_?=
 =?windows-1252?q?raster_data_format?=
Message-ID: <PAXPR07MB7775F4328A575210959F91E1FA88A@PAXPR07MB7775.eurprd07.prod.outlook.com>

Hi,
I leave an Issue to explain our intentions about continuing the work done with MiraMonVector and the possibility of creating a a new MiraMonRaster driver.

A new driver to support MiraMon?s raster data format ? Issue #12293 ? OSGeo/gdal<https://github.com/OSGeo/gdal/issues/12293>
[https://opengraph.githubassets.com/b3baeeba697ac5df9c2966f718db60af0b27d4d31c71dd75ffb787b7ba5ef8a5/OSGeo/gdal/issues/12293]<https://github.com/OSGeo/gdal/issues/12293>
A new driver to support MiraMon?s raster data format ? Issue #12293 ? OSGeo/gdal<https://github.com/OSGeo/gdal/issues/12293>
Feature description Dear all, Following the integration of the MiraMonVector driver in GDAL 3.9, which provides support for the vector format of the MiraMon GIS, we are now willing to integrate the...
github.com
I'll be pleased to answer any question might appear.
Thanks!



Abel Pau Garcia<https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia> <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia>
[https://www.creaf.cat/sites/default/files/2024-10/logo-creaf-small.jpg] <https://www.creaf.cat/>
MiraMon Technical Lead <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia> <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia>
a.pau at creaf.cat<mailto:a.pau at creaf.cat> <mailto:a.pau at creaf.cat>
[https://www.creaf.cat/sites/default/files/cap_0.png]
Let's chat on Teams!<https://teams.microsoft.com/l/chat/0/0?users=a.pau at creaf.cat> <https://teams.microsoft.com/l/chat/0/0?users=a.pau at creaf.cat>
Tel. +34
[https://www.creaf.cat/sites/default/files/2024-10/x_30.png] <https://twitter.com/CREAF_ecologia> [https://www.creaf.cat/sites/default/files/2024-10/linkedin_30.png]  <https://www.linkedin.com/company/creaf/> [https://www.creaf.cat/sites/default/files/2024-10/youtube_30.png]  <https://www.youtube.com/c/creafecologia> [https://www.creaf.cat/sites/default/files/2024-10/instagram_30.png]  <https://www.instagram.com/CREAF_ecologia/>
<http://www.creaf.cat>www.creaf.cat<http://www.creaf.cat> <http://www.creaf.cat>  | <https://www.creaf.cat/en/news-and-agenda/news> Latest news<https://www.creaf.cat/en/news-and-agenda/news> <https://www.creaf.cat/en/news-and-agenda/news>
CREAF. Campus UAB. Edifici C. 08193 Bellaterra (Barcelona) <https://www.openstreetmap.org/way/123379060>

<https://www.creaf.cat/privacy-policy>Privacy policy<https://www.creaf.cat/privacy-policy> <https://www.creaf.cat/privacy-policy>
[https://www.creaf.cat/sites/default/files/2024-10/corner_right_0.png]
Before printing this electronic message, think about the environment.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/43744b17/attachment.htm>

From Jon.Morris at jbarisk.com  Wed May  7 01:07:17 2025
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Wed, 7 May 2025 08:07:17 +0000
Subject: [gdal-dev] Vector VRT with OGRVRTUnionLayer
In-Reply-To: <DB9PR09MB6887FBB00242BA5E89ECB593FD89A@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <CWLP123MB68764C66B974AAA7E125A1B28289A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
 <DB9PR09MB6887FBB00242BA5E89ECB593FD89A@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <CWLP123MB6876A9AF8A90554B8AE3CBB38288A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>

Awesome! Thanks Jukka, that has fixed it. I didn't know wkbUnknown could also be used as a wildcard, but with that tag I don't need to set geometry fields, GDAL manages to find everything and make it appear as if everything is in one layer.

Jon


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-----Original Message-----
From: Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi> 
Sent: 06 May 2025 21:36
To: gdal-dev at lists.osgeo.org; Jon Morris <Jon.Morris at jbarisk.com>
Subject: Re: Vector VRT with OGRVRTUnionLayer

CAUTION: This email originated from outside of JBA and contains one or more links. DO NOT click links unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.

Hi,

Partial answer based on editing the example https://gdal.org/en/stable/drivers/vector/vrt.html#example-union-layer

Sources: polygon shapefile and point shapefile
Output: one layer with unknown/any geometry type

unionlayer.vrt
========
<OGRVRTDataSource>
    <OGRVRTUnionLayer name="unionLayer">
        <OGRVRTLayer name="poly">
            <SrcDataSource>poly.shp</SrcDataSource>
            <GeometryType>wkbUnknown</GeometryType>
        </OGRVRTLayer>
        <OGRVRTLayer name="point">
            <SrcDataSource>point.shp</SrcDataSource>
            <GeometryType>wkbUnknown</GeometryType>
        </OGRVRTLayer>
    </OGRVRTUnionLayer>
</OGRVRTDataSource>

ogrinfo unionlayer.vrt -al
INFO: Open of `unionlayer.vrt'
      using driver `OGR_VRT' successful.

Layer name: unionLayer
Geometry: Unknown (any)
Feature Count: 2
Extent: (258.000000, 176.000000) - (507.000000, 345.000000) Layer SRS WKT:
(unknown)
OGRFeature(unionLayer):0
  POLYGON ((365 311,507 281,332 176,258 237,365 311))

OGRFeature(unionLayer):1
  POINT (282 345)

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jon Morris via gdal-dev puolesta
L?hetetty: Tiistai 6. toukokuuta 2025 19.35
Vastaanottaja: gdal-dev at lists.osgeo.org
Aihe: [gdal-dev] Vector VRT with OGRVRTUnionLayer

Hello all, I'm trying to write a tool to create vector VRTs and need a bit of clarification with OGRVRTUnionLayers.  Is it possible to have a union layer when the input layers have different geometry types? Currently I'm trying Polygon and Multipolygon and I'm not clear whether this should make a valid VRT or if I need to convert one of my input layers so the geometry types are the same. Also, I want to support Shapefile, FileGDB, and PostGIS input layers - the geometry field names are different for each of these. The example in the doc shows that fields can be renamed - `<GeometryField name="vrt_geom_field_2" field="pg_geom_field_2">` but Shapefiles don't appear to have a geometry field name. Trying `field=""` does not work. Here's an example VRT that I have created (using GDAL test data autotest/ogr/data/poly.shp and autotest/ogr/data/filegdb/curves.gdb): <OGRVRTDataSource>??? <Metadata />??? <OGRVRTUnionLayer name="merged">???     <SourceLayerFieldName>Input layer</SourceLayerFieldName>???     <OGRVRTLayer name="poly">???         <SrcDataSource relativeToVRT="1">poly.shp</SrcDataSource>???         <SrcLayer>poly</SrcLayer>???     </OGRVRTLayer>???     <OGRVRTLayer name="polygon">???         <SrcDataSource relativeToVRT="1">curves.gdb</SrcDataSource>???         <SrcLayer>polygon</SrcLayer>???     </OGRVRTLayer>???     <ExtentXMin>3.339061908000076</ExtentXMin>???     <ExtentYMin>38.30604436200008</ExtentYMin>???     <ExtentXMax>481645.3125</ExtentXMax>???     <ExtentYMax>4765610.5</ExtentYMax>??? </OGRVRTUnionLayer></OGRVRTDataSource>?Ogrinfo shows separate entries for geometry, extent, wkt, and geometry column. How can I get the union layer to only show one of each? $ ogrinfo -al -so test.vrtINFO: Open of `test.vrt'      using driver `OGR_VRT' successful. Layer name: mergedGeometry (): PolygonGeometry (SHAPE): Multi PolygonFeature Count: 15Extent (): (3.339062, 38.306044) - (481645.312500, 4765610.500000)Extent (SHAPE): (3.339062, 38.306044) - (12.092784, 49.244892)SRS WKT ():PROJCRS["OSGB36 / British National Grid",    BASEGEOGCRS["OSGB36",        DATUM["Ordnance Survey of Great Britain 1936",            ELLIPSOID["Airy 1830",6377563.396,299.3249646,                LENGTHUNIT["metre",1]]],        PRIMEM["Greenwich",0,            ANGLEUNIT["degree",0.0174532925199433]],        ID["EPSG",4277]],    CONVERSION["British National Grid",        METHOD["Transverse Mercator",            ID["EPSG",9807]],        PARAMETER["Latitude of natural origin",49,            ANGLEUNIT["degree",0.0174532925199433],            ID["EPSG",8801]],        PARAMETER["Longitude of natural origin",-2,            ANGLEUNIT["degree",0.0174532925199433],            ID["EPSG",8802]],        PARAMETER["Scale factor at natural origin",0.9996012717,            SCALEUNIT["unity",1],            ID["EPSG",8805]],        PARAMETER["False easting",400000,            LENGTHUNIT["metre",1],            ID["EPSG",8806]],        PARAMETER["False northing",-100000,            LENGTHUNIT["metre",1],            ID["EPSG",8807]]],    CS[Cartesian,2],        AXIS["(E)",east,            ORDER[1],            LENGTHUNIT["metre",1]],        AXIS["(N)",north,            ORDER[2],            LENGTHUNIT["metre",1]],    USAGE[??????? SCOPE["Engineering survey, topographic mapping."],        AREA["United Kingdom (UK) - offshore to boundary of UKCS within 49?45'N to 61?N and 9?W to 2?E; onshore Great Britain (England, Wales and Scotland). Isle of Man onshore."],        BBOX[49.75,-9,61.01,2.01]],    ID["EPSG",27700]]Data axis to CRS axis mapping: 1,2SRS WKT (SHAPE):GEOGCRS["WGS 84",    ENSEMBLE["World Geodetic System 1984 ensemble",        MEMBER["World Geodetic System 1984 (Transit)"],        MEMBER["World Geodetic System 1984 (G730)"],        MEMBER["World Geodetic System 1984 (G873)"],        MEMBER["World Geodetic System 1984 (G1150)"],        MEMBER["World Geodetic System 1984 (G1674)"],        MEMBER["World Geodetic System 1984 (G1762)"],        MEMBER["World Geodetic System 1984 (G2139)"],        ELLIPSOID["WGS 84",6378137,298.257223563,            LENGTHUNIT["metre",1]],        ENSEMBLEACCURACY[2.0]],    PRIMEM["Greenwich",0,        ANGLEUNIT["degree",0.0174532925199433]],    CS[ellipsoidal,2],        AXIS["geodetic latitude (Lat)",north,            ORDER[1],            ANGLEUNIT["degree",0.0174532925199433]],        AXIS["geodetic longitude (Lon)",east,            ORDER[2],            ANGLEUNIT["degree",0.0174532925199433]],    USAGE[??????? SCOPE["Horizontal component of 3D system."],        AREA["World."],        BBOX[-90,-180,90,180]],    ID["EPSG",4326]]Data axis to CRS axis mapping: 2,1Geometry Column 1 =Geometry Column 2 = SHAPEInput layer: String (0.0)AREA: Real (12.3)EAS_ID: Integer64 (11.0)PRFEDEA: String (16.0)SHAPE_Length: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_LENGTHSHAPE_Area: Real (0.0) DEFAULT FILEGEODATABASE_SHAPE_AREA   When I open the VRT programmatically and iterate through the features, FIDs 10-14 (i.e. those from the FGDB layer) have no geometry. Do I need to add something like `<GeometryField name="SHAPE" />` to each layer so the geometry fields are found? Thanks, Jon   Jon MorrisSoftware Developer-- e: Jon.Morris at jbarisk.comd:+44 (0)1756 587229t: +44 (0)1756 799919www.jbarisk.com[X][X][X][X]???All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/5182154e/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image343512.png
Type: image/png
Size: 7388 bytes
Desc: image343512.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/5182154e/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image702488.png
Type: image/png
Size: 5172 bytes
Desc: image702488.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/5182154e/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image335066.png
Type: image/png
Size: 774 bytes
Desc: image335066.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/5182154e/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image702485.png
Type: image/png
Size: 797 bytes
Desc: image702485.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/5182154e/attachment-0007.png>

From jan.heckman at gmail.com  Wed May  7 04:47:34 2025
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 7 May 2025 13:47:34 +0200
Subject: [gdal-dev] Compoundcurve to DXF
Message-ID: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>

Hi list,
I am trying to convert a geopackage layer with compoundcurve geometry to
autocad, hoping to get ARCS or bulging (LW)POLYLINE, without tesselation.
I can do this in QGis by exporting the project to DXF, but not by saving
the layer as DXF.
Moreover, the produced XY geometries get garbled with nan's.
Direct attempt with ogr2ogr had the same result:
*ogr2ogr -f DXF rott.dxf GPKG:rotterdam_land24_2.gpkg -nlt compoundcurve
-sql "SELECT layer AS Layer, geom FROM land_24_2"*
-nlt compoundcurve was accepted, but apparently not applied.
Is this expected? Have I overlooked something? If not, is there a plan to
add this functionality?
The data (104 kb) can be downloaded from this dropbox link
<https://www.dropbox.com/scl/fi/hdxvw0e74q96ljfeapg9a/rotterdam_land24_2.gpkg?rlkey=ba3xdcvbtmyxr2mtcw9q0ri7c&dl=0>
.
Best regards,
Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/ddca8ebc/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Wed May  7 04:55:59 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 7 May 2025 11:55:59 +0000
Subject: [gdal-dev] Compoundcurve to DXF
In-Reply-To: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
References: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
Message-ID: <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

By reading https://gdal.org/en/stable/drivers/vector/dxf.html this feels clear and expected:

"CIRCLE, ELLIPSE, ARC, SPLINE,HELIX: Translated as a LINESTRING, tessellating the curve into line segments"
and
"The OGR_ARC_STEPSIZE and OGR_ARC_MAX_GAP configurations options control the approximation of arcs, ellipses, circles and rounded polylines as linestrings"

I fear that all you have overlooked was the documentation.

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jan Heckman via gdal-dev puolesta
L?hetetty: Keskiviikko 7. toukokuuta 2025 14.47
Vastaanottaja: gdal
Aihe: [gdal-dev] Compoundcurve to DXF

Hi list,I am trying to convert a geopackage layer with compoundcurve geometry to autocad, hoping to get ARCS or bulging (LW)POLYLINE, without tesselation.I can do this in QGis by exporting the project to DXF, but not by saving the layer as DXF.Moreover, the produced XY geometries get garbled with nan's.Direct attempt with ogr2ogr had the same result:ogr2ogr -f DXF rott.dxf GPKG:rotterdam_land24_2.gpkg -nlt compoundcurve -sql "SELECT layer AS Layer, geom FROM?land_24_2"-nlt compoundcurve was accepted, but apparently not applied.Is this expected? Have I overlooked something? If not, is there a plan to add this functionality?The data (104 kb) can be downloaded from this dropbox link.Best regards,Jan

From jan.heckman at gmail.com  Wed May  7 06:11:46 2025
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 7 May 2025 15:11:46 +0200
Subject: [gdal-dev] Compoundcurve to DXF
In-Reply-To: <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
 <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <CAKMUAtAo2jHcKW=EBvfarh05OmPGCEvVMQ-oAp62w6GPq0L0Uw@mail.gmail.com>

Hi Jukka,
You are right, excuses. My question was a bit rhetorical, though.
Will you please answer the 2nd question too?
I get the impression that there is no intention yet to convert curves to
DXF arcs.
I hope you change your mind, you can look to QGis to see some details, I
believe.
Jan

On Wed, May 7, 2025 at 1:56?PM Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> By reading https://gdal.org/en/stable/drivers/vector/dxf.html this feels
> clear and expected:
>
> "CIRCLE, ELLIPSE, ARC, SPLINE,HELIX: Translated as a LINESTRING,
> tessellating the curve into line segments"
> and
> "The OGR_ARC_STEPSIZE and OGR_ARC_MAX_GAP configurations options control
> the approximation of arcs, ellipses, circles and rounded polylines as
> linestrings"
>
> I fear that all you have overlooked was the documentation.
>
> -Jukka Rahkonen-
>
> ________________________________________
> L?hett?j?: gdal-dev k?ytt?j?n Jan Heckman via gdal-dev puolesta
> L?hetetty: Keskiviikko 7. toukokuuta 2025 14.47
> Vastaanottaja: gdal
> Aihe: [gdal-dev] Compoundcurve to DXF
>
> Hi list,I am trying to convert a geopackage layer with compoundcurve
> geometry to autocad, hoping to get ARCS or bulging (LW)POLYLINE, without
> tesselation.I can do this in QGis by exporting the project to DXF, but not
> by saving the layer as DXF.Moreover, the produced XY geometries get garbled
> with nan's.Direct attempt with ogr2ogr had the same result:ogr2ogr -f DXF
> rott.dxf GPKG:rotterdam_land24_2.gpkg -nlt compoundcurve -sql "SELECT layer
> AS Layer, geom FROM land_24_2"-nlt compoundcurve was accepted, but
> apparently not applied.Is this expected? Have I overlooked something? If
> not, is there a plan to add this functionality?The data (104 kb) can be
> downloaded from this dropbox link.Best regards,Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/6b671ae7/attachment.htm>

From even.rouault at spatialys.com  Wed May  7 07:53:21 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 7 May 2025 16:53:21 +0200
Subject: [gdal-dev] Compoundcurve to DXF
In-Reply-To: <CAKMUAtAo2jHcKW=EBvfarh05OmPGCEvVMQ-oAp62w6GPq0L0Uw@mail.gmail.com>
References: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
 <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAKMUAtAo2jHcKW=EBvfarh05OmPGCEvVMQ-oAp62w6GPq0L0Uw@mail.gmail.com>
Message-ID: <12a3118d-f1ef-43ba-b6d3-b97dba0b4aad@spatialys.com>


Le 07/05/2025 ? 15:11, Jan Heckman via gdal-dev a ?crit?:
> Hi Jukka,
> You are right, excuses. My question was a bit rhetorical, though.
> Will you please answer the 2nd question too?
> I get the impression that there is no intention yet to convert curves 
> to DXF arcs.
> I hope you change your mind, you can look to QGis to see some details, 
> I believe.

This is not a question of "mind". Just someone has to make the effort to 
code support for writing curves

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/b278683e/attachment.htm>

From even.rouault at spatialys.com  Wed May  7 08:53:54 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 7 May 2025 17:53:54 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
Message-ID: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>

+1 Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From j1 at jimenezshaw.com  Wed May  7 09:02:30 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Wed, 7 May 2025 18:02:30 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <CADRrdKtgE9Cs9-NARznsaXR9B6u8-zqst=VaEcgMU3AdT5PwFA@mail.gmail.com>

+1 Javier

On Wed, 7 May 2025 at 17:54, Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> +1 Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/413df0e5/attachment.htm>

From michael.smith.erdc at gmail.com  Wed May  7 09:14:20 2025
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Wed, 07 May 2025 12:14:20 -0400
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <EC93DC73-0B0D-473F-8A03-12E6DF6B2024@gmail.com>

+1 Mike



?On 5/7/25, 11:54 AM, "gdal-dev on behalf of Even Rouault via gdal-dev" <gdal-dev-bounces at lists.osgeo.org <mailto:gdal-dev-bounces at lists.osgeo.org> on behalf of gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>> wrote:


+1 Even


-- 
http://www.spatialys.com <http://www.spatialys.com>
My software is free, but my time generally not.


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://lists.osgeo.org/mailman/listinfo/gdal-dev>





From sean.gillies at gmail.com  Wed May  7 09:24:34 2025
From: sean.gillies at gmail.com (Sean Gillies)
Date: Wed, 7 May 2025 10:24:34 -0600
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <CAOodmJqfAQBqoaPFELcHaMN=NP9HYF-sCCcygHFHFeX9f965RA@mail.gmail.com>

Rasterio's tests are broken by changes coming in GDAL 3.11.0, but for known
and understood reasons. I'm fine with the release.

On Wed, May 7, 2025 at 10:05?AM Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> +1 Even
>
>
-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/05c10236/attachment.htm>

From bdezonia at gmail.com  Wed May  7 10:10:00 2025
From: bdezonia at gmail.com (Barry DeZonia)
Date: Wed, 7 May 2025 12:10:00 -0500
Subject: [gdal-dev] Compoundcurve to DXF
In-Reply-To: <12a3118d-f1ef-43ba-b6d3-b97dba0b4aad@spatialys.com>
References: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
 <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAKMUAtAo2jHcKW=EBvfarh05OmPGCEvVMQ-oAp62w6GPq0L0Uw@mail.gmail.com>
 <12a3118d-f1ef-43ba-b6d3-b97dba0b4aad@spatialys.com>
Message-ID: <CAKcvfuRG2NMrvzbtsODvyETv251ZbE3muy2swsCw8Bg2XgsVJw@mail.gmail.com>

I am not volunteering at the moment but maybe I could someday.

- Long ago I used to write 2d and 3d geometry translators for DXF files.
- I am good at math.
- I have contributed to gdal (some changes to the Java bindings).
- I used to be a C++ developer.

In order to do this I would need to learn a lot about which parts of
gdal need to be touched and I'd need modern specs for the DXF format.
I also would need someone to chime in on how big a job this is. If
qGis had a reference implementation of code that would simplify things
a lot. Finally I'd need the free time to work on this which I just
don't have at the moment. Maybe in the winter.

On Wed, May 7, 2025 at 9:53?AM Even Rouault via gdal-dev
<gdal-dev at lists.osgeo.org> wrote:
>
>
> Le 07/05/2025 ? 15:11, Jan Heckman via gdal-dev a ?crit :
>
> Hi Jukka,
> You are right, excuses. My question was a bit rhetorical, though.
> Will you please answer the 2nd question too?
> I get the impression that there is no intention yet to convert curves to DXF arcs.
> I hope you change your mind, you can look to QGis to see some details, I believe.
>
> This is not a question of "mind". Just someone has to make the effort to code support for writing curves
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jef at norbit.de  Wed May  7 11:55:14 2025
From: jef at norbit.de (=?utf-8?Q?J=C3=BCrgen_E=2E?= Fischer)
Date: Wed, 7 May 2025 20:55:14 +0200
Subject: [gdal-dev] Compoundcurve to DXF
In-Reply-To: <CAKcvfuRG2NMrvzbtsODvyETv251ZbE3muy2swsCw8Bg2XgsVJw@mail.gmail.com>
References: <CAKMUAtDD1fQHK8VJCV8x9DW8iBPrHqYGTjCxYb_j_6wUwtF-DQ@mail.gmail.com>
 <DB9PR09MB6887DA3A48B7E43CAB460680FD88A@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CAKMUAtAo2jHcKW=EBvfarh05OmPGCEvVMQ-oAp62w6GPq0L0Uw@mail.gmail.com>
 <12a3118d-f1ef-43ba-b6d3-b97dba0b4aad@spatialys.com>
 <CAKcvfuRG2NMrvzbtsODvyETv251ZbE3muy2swsCw8Bg2XgsVJw@mail.gmail.com>
Message-ID: <20250507185514.ca7waoar3jm64ryk@norbit.de>

On Wed, 07. May 2025 at 12:10:00 -0500, Barry DeZonia via gdal-dev wrote:
> I am not volunteering at the moment but maybe I could someday.
> 
> - Long ago I used to write 2d and 3d geometry translators for DXF files.
> - I am good at math.
> - I have contributed to gdal (some changes to the Java bindings).
> - I used to be a C++ developer.
> 
> In order to do this I would need to learn a lot about which parts of
> gdal need to be touched and I'd need modern specs for the DXF format.
> I also would need someone to chime in on how big a job this is. If
> qGis had a reference implementation of code that would simplify things
> a lot. Finally I'd need the free time to work on this which I just
> don't have at the moment. Maybe in the winter.

On the QGIS side: https://github.com/qgis/QGIS/blob/master/src/core/dxf/qgsdxfexport.cpp (links
to the (but not the latest) at the top) and the output of polylines in 
QgsDxfExport::writePolyline esp. the variant with QgsCurve.


J?rgen

-- 
J?rgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstra?e 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden            https://www.norbit.de
QGIS release manager (PSC)  Germany                 IRC: jef on Libera|OFTC
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 833 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250507/4fb3c17b/attachment.sig>

From howard at hobu.co  Thu May  8 04:19:33 2025
From: howard at hobu.co (Howard Butler)
Date: Thu, 8 May 2025 06:19:33 -0500
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <90D1C0F7-E3C4-4782-AC19-7EB8D0D3C353@hobu.co>

+1 Howard

> On May 7, 2025, at 10:54?AM, Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org> wrote:
> 
> ?+1 Even
> 
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Thu May  8 04:27:37 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 8 May 2025 11:27:37 +0000
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <90D1C0F7-E3C4-4782-AC19-7EB8D0D3C353@hobu.co>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
 <90D1C0F7-E3C4-4782-AC19-7EB8D0D3C353@hobu.co>
Message-ID: <DB9PR09MB6887C8E43C45D53BE7A75B1EFD8BA@DB9PR09MB6887.eurprd09.prod.outlook.com>

+1

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Howard Butler via gdal-dev puolesta
L?hetetty: Torstai 8. toukokuuta 2025 14.19
Vastaanottaja: Rouault Even
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release


+1 Howard

> On May 7, 2025, at 10:54?AM, Even Rouault via gdal-dev <gdal-dev at lists.osgeo.org> wrote:
>
> ?+1 Even
>
> --
> http://www.spatialys.com/
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev



From dbaston at gmail.com  Thu May  8 07:20:37 2025
From: dbaston at gmail.com (Daniel Baston)
Date: Thu, 8 May 2025 10:20:37 -0400
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <CA+K_q_oeX6hdF2Kdi2y4h=1HJ+zvVM1AFVZWsG1uLimmBnpWsQ@mail.gmail.com>

+1 Dan

On Wed, May 7, 2025 at 3:25?PM Even Rouault via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> +1 Even
>
> --
> http://www.spatialys.com
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/da2fb5fa/attachment.htm>

From fengting.chen at oracle.com  Thu May  8 10:15:36 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 8 May 2025 17:15:36 +0000
Subject: [gdal-dev] GDAL 3.10.3 build questions regarding to CURL and ARROW
Message-ID: <PH0PR10MB7061473FA16278BDB73346B1938BA@PH0PR10MB7061.namprd10.prod.outlook.com>

I have a couple questions regarding to building GDAL 3.10.3:


  1.  Error about CURL:

Could NOT find CURL: Found unsuitable version "7.61.1", but required is at   least "7.68" (found /usr/lib64/libcurl.so, )



Any reason that curl 7.68 and higher is required?



  1.  In the build of GDAL 3.10.3,  GDAL_USE_ARROW, GDAL_USE_ARROWDATASET and GDAL_USE_PARQUET are on. The Arrow_ROOT, Parquet_ROOT and ArrowDataset_ROOT are set to the installation of arrow. But the build gave error:

In file included from /?./gdal/3.10. 3/ogr/ogrsf_frmts/parquet/../arrow_common/ogr_arrow.h:22,
                  from /?./gdal/3.10. 3/ogr/ogrsf_frmts/parquet/ogr_parquet.h:23,
                  from /?./gdal/3.10. 3/ogr/ogrsf_frmts/parquet/ogrparquetdriver.cpp:20:
/?./gdal/3.10.3/ogr/ogrsf_frmts/parquet/../arrow_common/ogr_include_arrow.h:29:10: fatal error: arrow/array.h:  No such file or directory
  #include "arrow/array.h"
           ^~~~~~~~~~~~~~~
compilation terminated.

The ?arrow/array.h? is located at the arrow installation include directory. Any suggestion on how to fix this error?

Thanks!

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/65b2ac61/attachment-0001.htm>

From even.rouault at spatialys.com  Thu May  8 10:39:16 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 8 May 2025 19:39:16 +0200
Subject: [gdal-dev] GDAL 3.10.3 build questions regarding to CURL and
 ARROW
In-Reply-To: <PH0PR10MB7061473FA16278BDB73346B1938BA@PH0PR10MB7061.namprd10.prod.outlook.com>
References: <PH0PR10MB7061473FA16278BDB73346B1938BA@PH0PR10MB7061.namprd10.prod.outlook.com>
Message-ID: <91bd9d4c-a156-4508-81fc-5ed9f289ab7c@spatialys.com>


Le 08/05/2025 ? 19:15, Fengting Chen via gdal-dev a ?crit?:
>
> I have a couple questions regarding to building GDAL 3.10.3:
>
>  1. Error about CURL:
>
> Could NOT find CURL: Found unsuitable version "7.61.1", but required 
> is at?? least "7.68" (found /usr/lib64/libcurl.so, )
>
> Any reason that curl 7.68 and higher is required?
>
Cf 
https://gdal.org/en/stable/development/rfc/rfc98_build_requirements_gdal_3_9.html 
. Maybe you can modify the minimum version to 7.61.1 but that isn't 
tested in CI.


>  2. In the build of GDAL 3.10.3, ?GDAL_USE_ARROW,
>     GDAL_USE_ARROWDATASET and GDAL_USE_PARQUET are on. The Arrow_ROOT,
>     Parquet_ROOT and ArrowDataset_ROOT are set to the installation of
>     arrow. But the build gave error:
>
I doubt those variables are honored. Try setting CMAKE_PREFIX_PATH? to 
the installation prefix of libarrow, or set Arrow_DIR, Parquet_DIR, 
ArrowDataset_DIR and ArrowAcero_DIR similar to below:

ArrowAcero_DIR=/home/even/install-arrow-20.0.0/lib/cmake/ArrowAcero
ArrowDataset_DIR=/home/even/install-arrow-20.0.0/lib/cmake/ArrowDataset
Arrow_DIR=/home/even/install-arrow-20.0.0/lib/cmake/Arrow
Parquet_DIR=/home/even/install-arrow-20.0.0/lib/cmake/Parquet

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/2542e6ef/attachment.htm>

From jason.roberts at duke.edu  Thu May  8 14:01:47 2025
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu, 8 May 2025 17:01:47 -0400
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
Message-ID: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>

Hi GDAL team,

I'm working with the GDAL Python API. I have some HFA (.img) files that 
are float32 and that use nan as their NoData value. As far as I can 
tell, using nan is allowed but I could be wrong. When I open them, I get 
"Warning 1: NaN converted to INT_MAX." Everything seems to work fine 
after that. Is this message something I need to worry about? If not, may 
I suggest you remove it from the HFA driver if possible?

Here's some code demonstrating the message. If need be, I can provide an 
example file, or write some code to generate one.

 >>> import numpy as np
 >>> from osgeo import gdal
 >>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 
3.4, but I don't think the version matters
'3.9.2e'
 >>> ds = 
gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
gdal.GA_ReadOnly)
Warning 1: NaN converted to INT_MAX.
 >>> band = ds.GetRasterBand(1)
 >>> gdal.GetDataTypeName(band.DataType)
'Float32'
 >>> band.GetNoDataValue()
nan
 >>> arr = band.ReadAsArray()?? # the data look ok:
 >>> np.isnan(arr).sum()
86788
 >>> (~np.isnan(arr)).sum()
142985
 >>> np.max(arr)
nan
 >>> np.nanmax(arr)
27.078554

As far as I can tell, the warning comes from this code in 
gdal/frmts/hfa/hfafield.cpp:

 ??????????????? else if (std::isnan(dfDoubleRet))
 ??????????????? {
 ??????????????????? CPLError(CE_Warning, CPLE_AppDefined,
 ???????????????????????????? "NaN converted to INT_MAX.");
 ??????????????????? nIntRet = nMax;
 ??????????????? }

But I don't know if there are any negative ramifications that will result.

Thank you for your help. And, as always, thank you very much for 
developing and maintaining GDAL.

Jason
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/a42b00ee/attachment.htm>

From fengting.chen at oracle.com  Thu May  8 14:40:46 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 8 May 2025 21:40:46 +0000
Subject: [gdal-dev] [External] : Re: GDAL 3.10.3 build questions
 regarding to CURL and ARROW
In-Reply-To: <91bd9d4c-a156-4508-81fc-5ed9f289ab7c@spatialys.com>
References: <PH0PR10MB7061473FA16278BDB73346B1938BA@PH0PR10MB7061.namprd10.prod.outlook.com>
 <91bd9d4c-a156-4508-81fc-5ed9f289ab7c@spatialys.com>
Message-ID: <PH0PR10MB7061882BAF8D1CDB05ED4048938BA@PH0PR10MB7061.namprd10.prod.outlook.com>

Thanks for the reply. The CURL is temporarily resolved. But the build on ARROW still has problem.

Setting Arrow_DIR didn?t work as GDAL cmake cannot find arrow anymore. Setting Arrow_ROOT allows GDAL cmake to find arrow, just the compilation failed. The same Arrow_ROOT setting works for the build of GDAL 3.8.4, but not 3.10.3. Not sure if there is anything changed between the two versions that caused the compilation failure.

From: Even Rouault <even.rouault at spatialys.com>
Date: Thursday, May 8, 2025 at 1:39?PM
To: Fengting Chen <fengting.chen at oracle.com>, gdal-dev <gdal-dev at lists.osgeo.org>
Subject: [External] : Re: [gdal-dev] GDAL 3.10.3 build questions regarding to CURL and ARROW


Le 08/05/2025 ? 19:15, Fengting Chen via gdal-dev a ?crit :
I have a couple questions regarding to building GDAL 3.10.3:


  1.  Error about CURL:

Could NOT find CURL: Found unsuitable version "7.61.1", but required is at   least "7.68" (found /usr/lib64/libcurl.so, )



Any reason that curl 7.68 and higher is required?

Cf https://gdal.org/en/stable/development/rfc/rfc98_build_requirements_gdal_3_9.html<https://urldefense.com/v3/__https:/gdal.org/en/stable/development/rfc/rfc98_build_requirements_gdal_3_9.html__;!!ACWV5N9M2RV99hQ!Ogh2I513LdvztVcK6Y1ytzMbeH2ZyHRKHAUQajL7253eDXqVXLNpeOLC5DIohBHzHXLGfiqtJjjAheNqC2gUqbzNKzJ9$>  . Maybe you can modify the minimum version to 7.61.1 but that isn't tested in CI.





  1.  In the build of GDAL 3.10.3,  GDAL_USE_ARROW, GDAL_USE_ARROWDATASET and GDAL_USE_PARQUET are on. The Arrow_ROOT, Parquet_ROOT and ArrowDataset_ROOT are set to the installation of arrow. But the build gave error:


I doubt those variables are honored. Try setting CMAKE_PREFIX_PATH  to the installation prefix of libarrow, or set Arrow_DIR, Parquet_DIR, ArrowDataset_DIR and ArrowAcero_DIR similar to below:

ArrowAcero_DIR=/home/even/install-arrow-20.0.0/lib/cmake/ArrowAcero
ArrowDataset_DIR=/home/even/install-arrow-20.0.0/lib/cmake/ArrowDataset
Arrow_DIR=/home/even/install-arrow-20.0.0/lib/cmake/Arrow
Parquet_DIR=/home/even/install-arrow-20.0.0/lib/cmake/Parquet

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!Ogh2I513LdvztVcK6Y1ytzMbeH2ZyHRKHAUQajL7253eDXqVXLNpeOLC5DIohBHzHXLGfiqtJjjAheNqC2gUqYXqWzDM$>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/70dd236b/attachment-0001.htm>

From jluis at ualg.pt  Thu May  8 14:48:41 2025
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Thu, 8 May 2025 21:48:41 +0000
Subject: [gdal-dev] vsicurl and --range byte-range
Message-ID: <AM6PR04MB6440A420C08B621FC8DCAAC0A68BA@AM6PR04MB6440.eurprd04.prod.outlook.com>

Hi,

I'm writing a tool to download ECMWF forecast data in gring2 format. But since those files have > 150 bands and most of times I'm only interested in a couple of them, I'm using the only documented mechanism that I found [1], which is the "curl -range start-stop". That works fine but what I would really like is to be able to use

gdal_translate /vsicurl/...

because then I should be able to save the result directly in netCDF and even get only a sub-region. But I'm not able to find a way to use both /vsicurl/ and a (equivalent) -range option. Is that possible and I didn't find how to, or we simple cannot do it?

Thanks

Joaquim

[1] https://confluence.ecmwf.int/display/DAC/ECMWF+open+data%3A+real-time+forecasts+from+IFS+and+AIFS#ECMWFopendata:realtimeforecastsfromIFSandAIFS-DownloadASingleFieldWithWget
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/01ce86c4/attachment.htm>

From even.rouault at spatialys.com  Thu May  8 14:51:30 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 8 May 2025 23:51:30 +0200
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
Message-ID: <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>

Jason,

It looks like something in the code asks a float64 field to be returned 
as a int32, and thus NaN has to be turned into something else. That's 
perhaps fine in the context where that happens with your file and could 
potentially be silenced, but access to the file would be needed to 
investigate

Even

Le 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:
> Hi GDAL team,
>
> I'm working with the GDAL Python API. I have some HFA (.img) files 
> that are float32 and that use nan as their NoData value. As far as I 
> can tell, using nan is allowed but I could be wrong. When I open them, 
> I get "Warning 1: NaN converted to INT_MAX." Everything seems to work 
> fine after that. Is this message something I need to worry about? If 
> not, may I suggest you remove it from the HFA driver if possible?
>
> Here's some code demonstrating the message. If need be, I can provide 
> an example file, or write some code to generate one.
>
> >>> import numpy as np
> >>> from osgeo import gdal
> >>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 
> 3.4, but I don't think the version matters
> '3.9.2e'
> >>> ds = 
> gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
> gdal.GA_ReadOnly)
> Warning 1: NaN converted to INT_MAX.
> >>> band = ds.GetRasterBand(1)
> >>> gdal.GetDataTypeName(band.DataType)
> 'Float32'
> >>> band.GetNoDataValue()
> nan
> >>> arr = band.ReadAsArray()?? # the data look ok:
> >>> np.isnan(arr).sum()
> 86788
> >>> (~np.isnan(arr)).sum()
> 142985
> >>> np.max(arr)
> nan
> >>> np.nanmax(arr)
> 27.078554
>
> As far as I can tell, the warning comes from this code in 
> gdal/frmts/hfa/hfafield.cpp:
>
> ??????????????? else if (std::isnan(dfDoubleRet))
> ??????????????? {
> ??????????????????? CPLError(CE_Warning, CPLE_AppDefined,
> ???????????????????????????? "NaN converted to INT_MAX.");
> ??????????????????? nIntRet = nMax;
> ??????????????? }
>
> But I don't know if there are any negative ramifications that will result.
>
> Thank you for your help. And, as always, thank you very much for 
> developing and maintaining GDAL.
>
> Jason
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/0f6d0d56/attachment.htm>

From even.rouault at spatialys.com  Thu May  8 15:04:17 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 9 May 2025 00:04:17 +0200
Subject: [gdal-dev] vsicurl and --range byte-range
In-Reply-To: <AM6PR04MB6440A420C08B621FC8DCAAC0A68BA@AM6PR04MB6440.eurprd04.prod.outlook.com>
References: <AM6PR04MB6440A420C08B621FC8DCAAC0A68BA@AM6PR04MB6440.eurprd04.prod.outlook.com>
Message-ID: <9e0d2d8a-5f81-4950-9585-7b0e981d2e76@spatialys.com>

Joaquim,

You can combine /vsisubfile/ 
(https://gdal.org/en/stable/user/virtual_file_systems.html#vsisubfile-portions-of-files) 
and /vsicurl/

/vsisubfile/${offset}_${length}/vsicurl/${url}

e.g.

$ gdalinfo 
/vsisubfile/802533_508958,/vsicurl/https://ecmwf-forecasts.s3.eu-central-1.amazonaws.com/20240301/00z/ifs/0p25/oper/20240301000000-24h-oper-fc.grib2 
--debug on

[...]
Band 1 Block=1440x1 Type=Float64, ColorInterp=Undefined
 ? Description = 92500[Pa] ISBL="Isobaric surface"
 ? Metadata:
 ??? GRIB_UNIT=[%]
 ??? GRIB_COMMENT=Relative humidity [%]
 ??? GRIB_ELEMENT=RH
 ??? GRIB_SHORT_NAME=92500-ISBL
 ??? GRIB_REF_TIME=1709251200
 ??? GRIB_VALID_TIME=1709337600
 ??? GRIB_FORECAST_SECONDS=86400
 ??? GRIB_DISCIPLINE=0(Meteorological)
 ??? GRIB_IDS=CENTER=98(ECMWF) SUBCENTER=0 MASTER_TABLE=27 LOCAL_TABLE=0 
SIGNF_REF_TIME=1(Start_of_Forecast) REF_TIME=2024-03-01T00:00:00Z 
PROD_STATUS=0(Operational) TYPE=1(Forecast)
 ??? GRIB_PDS_PDTN=0
 ??? GRIB_PDS_TEMPLATE_NUMBERS=1 1 2 255 154 0 0 0 1 0 0 0 24 100 0 0 1 
105 84 255 255 255 255 255 255
 ??? GRIB_PDS_TEMPLATE_ASSEMBLED_VALUES=1 1 2 255 154 0 0 1 24 100 0 
92500 255 -127 -2147483647

Even

Le 08/05/2025 ? 23:48, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit?:
>
> Hi,
>
> I?m writing a tool to download ECMWF forecast data in gring2 format. 
> But since those files have > 150 bands and most of times I?m only 
> interested in a couple of them, I?m using the only documented 
> mechanism that I found [1], which is the ?curl ?range start-stop?. 
> That works fine but what I would really like is to be able to use
>
> gdal_translate /vsicurl/?
>
> because then I should be able to save the result directly in netCDF 
> and even get only a sub-region. But I?m not able to find a way to use 
> both /vsicurl/ and a (equivalent) ?range option. Is that possible and 
> I didn?t find how to, or we simple cannot do it?
>
> Thanks
>
> Joaquim
>
> [1] 
> https://confluence.ecmwf.int/display/DAC/ECMWF+open+data%3A+real-time+forecasts+from+IFS+and+AIFS#ECMWFopendata:realtimeforecastsfromIFSandAIFS-DownloadASingleFieldWithWget
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250509/2adc775a/attachment-0001.htm>

From jluis at ualg.pt  Thu May  8 15:16:21 2025
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 8 May 2025 22:16:21 +0000
Subject: [gdal-dev] vsicurl and --range byte-range
In-Reply-To: <9e0d2d8a-5f81-4950-9585-7b0e981d2e76@spatialys.com>
References: <AM6PR04MB6440A420C08B621FC8DCAAC0A68BA@AM6PR04MB6440.eurprd04.prod.outlook.com>
 <9e0d2d8a-5f81-4950-9585-7b0e981d2e76@spatialys.com>
Message-ID: <AM6PR04MB64402E148E7FE87D54D3095BA68BA@AM6PR04MB6440.eurprd04.prod.outlook.com>

Fantastic Even. Thanks a lot.
(and ofc I meant to say grib2, not ?gring2?)

Joaquim

From: Even Rouault <even.rouault at spatialys.com>
Sent: Thursday, May 8, 2025 11:04 PM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] vsicurl and --range byte-range


Joaquim,

You can combine /vsisubfile/  (https://gdal.org/en/stable/user/virtual_file_systems.html#vsisubfile-portions-of-files) and /vsicurl/

/vsisubfile/${offset}_${length}/vsicurl/${url}

e.g.

$ gdalinfo /vsisubfile/802533_508958,/vsicurl/https://ecmwf-forecasts.s3.eu-central-1.amazonaws.com/20240301/00z/ifs/0p25/oper/20240301000000-24h-oper-fc.grib2 --debug on

[...]
Band 1 Block=1440x1 Type=Float64, ColorInterp=Undefined
  Description = 92500[Pa] ISBL="Isobaric surface"
  Metadata:
    GRIB_UNIT=[%]
    GRIB_COMMENT=Relative humidity [%]
    GRIB_ELEMENT=RH
    GRIB_SHORT_NAME=92500-ISBL
    GRIB_REF_TIME=1709251200
    GRIB_VALID_TIME=1709337600
    GRIB_FORECAST_SECONDS=86400
    GRIB_DISCIPLINE=0(Meteorological)
    GRIB_IDS=CENTER=98(ECMWF) SUBCENTER=0 MASTER_TABLE=27 LOCAL_TABLE=0 SIGNF_REF_TIME=1(Start_of_Forecast) REF_TIME=2024-03-01T00:00:00Z PROD_STATUS=0(Operational) TYPE=1(Forecast)
    GRIB_PDS_PDTN=0
    GRIB_PDS_TEMPLATE_NUMBERS=1 1 2 255 154 0 0 0 1 0 0 0 24 100 0 0 1 105 84 255 255 255 255 255 255
    GRIB_PDS_TEMPLATE_ASSEMBLED_VALUES=1 1 2 255 154 0 0 1 24 100 0 92500 255 -127 -2147483647

Even
Le 08/05/2025 ? 23:48, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit :
Hi,

I?m writing a tool to download ECMWF forecast data in gring2 format. But since those files have > 150 bands and most of times I?m only interested in a couple of them, I?m using the only documented mechanism that I found [1], which is the ?curl ?range start-stop?. That works fine but what I would really like is to be able to use

gdal_translate /vsicurl/?

because then I should be able to save the result directly in netCDF and even get only a sub-region. But I?m not able to find a way to use both /vsicurl/ and a (equivalent) ?range option. Is that possible and I didn?t find how to, or we simple cannot do it?

Thanks

Joaquim

[1] https://confluence.ecmwf.int/display/DAC/ECMWF+open+data%3A+real-time+forecasts+from+IFS+and+AIFS#ECMWFopendata:realtimeforecastsfromIFSandAIFS-DownloadASingleFieldWithWget



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/a0af2103/attachment.htm>

From jason.roberts at duke.edu  Thu May  8 15:35:50 2025
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu, 8 May 2025 18:35:50 -0400
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
Message-ID: <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>

Hi Even,

Thanks. I can silence this with a custom error handler (I tested it, and 
it works). But the part that is confusing to me, as a user of the Python 
API, is that I did not ask the API to do anything with int32s. All I did 
was open the dataset using the default parameters of gdal.Open(). I 
would not expect a warning to be reported in that circumstance, unless 
opening .img files that use nan as the NoData value was problematic for 
GDAL in some way. That is why I was suggesting that the warning be removed.

Jason

On 5/8/25 17:51, Even Rouault wrote:
>
> Jason,
>
> It looks like something in the code asks a float64 field to be 
> returned as a int32, and thus NaN has to be turned into something 
> else. That's perhaps fine in the context where that happens with your 
> file and could potentially be silenced, but access to the file would 
> be needed to investigate
>
> Even
>
> Le 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:
>> Hi GDAL team,
>>
>> I'm working with the GDAL Python API. I have some HFA (.img) files 
>> that are float32 and that use nan as their NoData value. As far as I 
>> can tell, using nan is allowed but I could be wrong. When I open 
>> them, I get "Warning 1: NaN converted to INT_MAX." Everything seems 
>> to work fine after that. Is this message something I need to worry 
>> about? If not, may I suggest you remove it from the HFA driver if 
>> possible?
>>
>> Here's some code demonstrating the message. If need be, I can provide 
>> an example file, or write some code to generate one.
>>
>> >>> import numpy as np
>> >>> from osgeo import gdal
>> >>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 
>> 3.4, but I don't think the version matters
>> '3.9.2e'
>> >>> ds = 
>> gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
>> gdal.GA_ReadOnly)
>> Warning 1: NaN converted to INT_MAX.
>> >>> band = ds.GetRasterBand(1)
>> >>> gdal.GetDataTypeName(band.DataType)
>> 'Float32'
>> >>> band.GetNoDataValue()
>> nan
>> >>> arr = band.ReadAsArray()?? # the data look ok:
>> >>> np.isnan(arr).sum()
>> 86788
>> >>> (~np.isnan(arr)).sum()
>> 142985
>> >>> np.max(arr)
>> nan
>> >>> np.nanmax(arr)
>> 27.078554
>>
>> As far as I can tell, the warning comes from this code in 
>> gdal/frmts/hfa/hfafield.cpp:
>>
>> ??????????????? else if (std::isnan(dfDoubleRet))
>> ??????????????? {
>> ??????????????????? CPLError(CE_Warning, CPLE_AppDefined,
>> ???????????????????????????? "NaN converted to INT_MAX.");
>> ??????????????????? nIntRet = nMax;
>> ??????????????? }
>>
>> But I don't know if there are any negative ramifications that will 
>> result.
>>
>> Thank you for your help. And, as always, thank you very much for 
>> developing and maintaining GDAL.
>>
>> Jason
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> -- 
> http://www.spatialys.com/
> My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/bbbcd251/attachment-0001.htm>

From even.rouault at spatialys.com  Thu May  8 15:39:35 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 9 May 2025 00:39:35 +0200
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
 <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
Message-ID: <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>

There are metadata fields that the HFA driver opens. That must come from 
that. Always shutting down the warning could be inappropriate, but 
perhaps in the context where the warning is emitted the driver could 
avoid emitting it. But we need to have access to the file to better 
understand the call path.

Le 09/05/2025 ? 00:35, Jason Roberts a ?crit?:
> Hi Even,
>
> Thanks. I can silence this with a custom error handler (I tested it, 
> and it works). But the part that is confusing to me, as a user of the 
> Python API, is that I did not ask the API to do anything with int32s. 
> All I did was open the dataset using the default parameters of 
> gdal.Open(). I would not expect a warning to be reported in that 
> circumstance, unless opening .img files that use nan as the NoData 
> value was problematic for GDAL in some way. That is why I was 
> suggesting that the warning be removed.
>
> Jason
>
> On 5/8/25 17:51, Even Rouault wrote:
>>
>> Jason,
>>
>> It looks like something in the code asks a float64 field to be 
>> returned as a int32, and thus NaN has to be turned into something 
>> else. That's perhaps fine in the context where that happens with your 
>> file and could potentially be silenced, but access to the file would 
>> be needed to investigate
>>
>> Even
>>
>> Le 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:
>>> Hi GDAL team,
>>>
>>> I'm working with the GDAL Python API. I have some HFA (.img) files 
>>> that are float32 and that use nan as their NoData value. As far as I 
>>> can tell, using nan is allowed but I could be wrong. When I open 
>>> them, I get "Warning 1: NaN converted to INT_MAX." Everything seems 
>>> to work fine after that. Is this message something I need to worry 
>>> about? If not, may I suggest you remove it from the HFA driver if 
>>> possible?
>>>
>>> Here's some code demonstrating the message. If need be, I can 
>>> provide an example file, or write some code to generate one.
>>>
>>> >>> import numpy as np
>>> >>> from osgeo import gdal
>>> >>> gdal.__version__?????? # this version is packaged with ArcGIS 
>>> Pro 3.4, but I don't think the version matters
>>> '3.9.2e'
>>> >>> ds = 
>>> gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
>>> gdal.GA_ReadOnly)
>>> Warning 1: NaN converted to INT_MAX.
>>> >>> band = ds.GetRasterBand(1)
>>> >>> gdal.GetDataTypeName(band.DataType)
>>> 'Float32'
>>> >>> band.GetNoDataValue()
>>> nan
>>> >>> arr = band.ReadAsArray()?? # the data look ok:
>>> >>> np.isnan(arr).sum()
>>> 86788
>>> >>> (~np.isnan(arr)).sum()
>>> 142985
>>> >>> np.max(arr)
>>> nan
>>> >>> np.nanmax(arr)
>>> 27.078554
>>>
>>> As far as I can tell, the warning comes from this code in 
>>> gdal/frmts/hfa/hfafield.cpp:
>>>
>>> ??????????????? else if (std::isnan(dfDoubleRet))
>>> ??????????????? {
>>> ??????????????????? CPLError(CE_Warning, CPLE_AppDefined,
>>> ???????????????????????????? "NaN converted to INT_MAX.");
>>> ??????????????????? nIntRet = nMax;
>>> ??????????????? }
>>>
>>> But I don't know if there are any negative ramifications that will 
>>> result.
>>>
>>> Thank you for your help. And, as always, thank you very much for 
>>> developing and maintaining GDAL.
>>>
>>> Jason
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> -- 
>> http://www.spatialys.com
>> My software is free, but my time generally not.
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250509/78551b42/attachment.htm>

From jason.roberts at duke.edu  Thu May  8 16:04:03 2025
From: jason.roberts at duke.edu (Jason Roberts)
Date: Thu, 8 May 2025 19:04:03 -0400
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
 <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
 <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>
Message-ID: <4dc40ddc-82ae-4499-a25b-60aed6f2f359@duke.edu>

Thank you. I can help you repro it if you want to take a look.

I'm having trouble attaching a .img file to email. My email system 
doesn't want to allow it, even if I put it in a zip. But here is a 
simple way to repro it by creating the file with GDAL itself. (In this 
example, I used float64 and the same warning occurs.) You could use this 
to produce a test file. If you'd prefer I send a file I can post it to a 
file exchange service.

 >>> import numpy as np
 >>>
 >>> from osgeo import gdal
 >>> print(gdal.__version__)
3.9.2e
 >>> gdal.UseExceptions()
 >>>
 >>> # Create the dataset as float64 with 1 band
 >>> f = 'has_nans.img'
 >>> drv = gdal.GetDriverByName('HFA')
 >>> ds = drv.Create(f, 100, 100, 1, gdal.GDT_Float64)
 >>>
 >>> # Make some fake data; set some cells to nan, although this is not 
necessary to repro the warning
 >>> data = np.arange(100*100, dtype=float).reshape(100,100)
 >>> data[0:20,0:30] = float('nan')
 >>>
 >>> # Write the data to the band
 >>> band = ds.GetRasterBand(1)
 >>> band.SetNoDataValue(float('nan'))
0
 >>> band.WriteArray(data, 0, 0)
0
 >>>
 >>> # Close the dataset
 >>> del band, ds
 >>>
 >>> # Open it again - warning happens here
 >>> ds = gdal.Open(f, gdal.GA_ReadOnly)
Warning 1: NaN converted to INT_MAX.

Jason

On 5/8/25 18:39, Even Rouault wrote:
>
> There are metadata fields that the HFA driver opens. That must come 
> from that. Always shutting down the warning could be inappropriate, 
> but perhaps in the context where the warning is emitted the driver 
> could avoid emitting it. But we need to have access to the file to 
> better understand the call path.
>
> Le 09/05/2025 ? 00:35, Jason Roberts a ?crit?:
>> Hi Even,
>>
>> Thanks. I can silence this with a custom error handler (I tested it, 
>> and it works). But the part that is confusing to me, as a user of the 
>> Python API, is that I did not ask the API to do anything with int32s. 
>> All I did was open the dataset using the default parameters of 
>> gdal.Open(). I would not expect a warning to be reported in that 
>> circumstance, unless opening .img files that use nan as the NoData 
>> value was problematic for GDAL in some way. That is why I was 
>> suggesting that the warning be removed.
>>
>> Jason
>>
>> On 5/8/25 17:51, Even Rouault wrote:
>>>
>>> Jason,
>>>
>>> It looks like something in the code asks a float64 field to be 
>>> returned as a int32, and thus NaN has to be turned into something 
>>> else. That's perhaps fine in the context where that happens with 
>>> your file and could potentially be silenced, but access to the file 
>>> would be needed to investigate
>>>
>>> Even
>>>
>>> Le 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:
>>>> Hi GDAL team,
>>>>
>>>> I'm working with the GDAL Python API. I have some HFA (.img) files 
>>>> that are float32 and that use nan as their NoData value. As far as 
>>>> I can tell, using nan is allowed but I could be wrong. When I open 
>>>> them, I get "Warning 1: NaN converted to INT_MAX." Everything seems 
>>>> to work fine after that. Is this message something I need to worry 
>>>> about? If not, may I suggest you remove it from the HFA driver if 
>>>> possible?
>>>>
>>>> Here's some code demonstrating the message. If need be, I can 
>>>> provide an example file, or write some code to generate one.
>>>>
>>>> >>> import numpy as np
>>>> >>> from osgeo import gdal
>>>> >>> gdal.__version__?????? # this version is packaged with ArcGIS 
>>>> Pro 3.4, but I don't think the version matters
>>>> '3.9.2e'
>>>> >>> ds = 
>>>> gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
>>>> gdal.GA_ReadOnly)
>>>> Warning 1: NaN converted to INT_MAX.
>>>> >>> band = ds.GetRasterBand(1)
>>>> >>> gdal.GetDataTypeName(band.DataType)
>>>> 'Float32'
>>>> >>> band.GetNoDataValue()
>>>> nan
>>>> >>> arr = band.ReadAsArray()?? # the data look ok:
>>>> >>> np.isnan(arr).sum()
>>>> 86788
>>>> >>> (~np.isnan(arr)).sum()
>>>> 142985
>>>> >>> np.max(arr)
>>>> nan
>>>> >>> np.nanmax(arr)
>>>> 27.078554
>>>>
>>>> As far as I can tell, the warning comes from this code in 
>>>> gdal/frmts/hfa/hfafield.cpp:
>>>>
>>>> ??????????????? else if (std::isnan(dfDoubleRet))
>>>> ??????????????? {
>>>> ??????????????????? CPLError(CE_Warning, CPLE_AppDefined,
>>>> ???????????????????????????? "NaN converted to INT_MAX.");
>>>> ??????????????????? nIntRet = nMax;
>>>> ??????????????? }
>>>>
>>>> But I don't know if there are any negative ramifications that will 
>>>> result.
>>>>
>>>> Thank you for your help. And, as always, thank you very much for 
>>>> developing and maintaining GDAL.
>>>>
>>>> Jason
>>>>
>>>>
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> -- 
>>> http://www.spatialys.com/
>>> My software is free, but my time generally not.
>>
> -- 
> http://www.spatialys.com/
> My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250508/d64eb055/attachment-0001.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Thu May  8 22:56:22 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Fri, 9 May 2025 05:56:22 +0000
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <4dc40ddc-82ae-4499-a25b-60aed6f2f359@duke.edu>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
 <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
 <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>
 <4dc40ddc-82ae-4499-a25b-60aed6f2f359@duke.edu>
Message-ID: <DB9PR09MB6887F06C719A4A95A76ADD82FD8AA@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

Another method to reproduce without Python by using gdal_create:

gdal_create -outsize 100 100 -ot float32 -a_nodata nan -of hfa nan.img

C:\data\000\gdaltest>gdalinfo nan.img
Warning 1: NaN converted to INT_MAX.
Driver: HFA/Erdas Imagine Images (.img)
Files: nan.img
Size is 100, 100
...
Band 1 Block=64x64 Type=Float32, ColorInterp=Undefined
  Description = Layer_1
  NoData Value=nan
  Metadata:
    LAYER_TYPE=athematic

If I convert nan.img into GeoTIFF with "gdal_translate nan.img nan.tif", I do see the warning, but the new GeoTIFF still has NoData Value=nsn. I wonder what is the real meaning of the warning.

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jason Roberts via gdal-dev puolesta
L?hetetty: Perjantai 9. toukokuuta 2025 2.04
Vastaanottaja: Even Rouault; gdal dev
Aihe: Re: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to INT_MAX when float raster has nan as the NoData value

Thank you. I can help you repro it if you want to take a look.I'm having trouble attaching a .img file to email. My email system doesn't want to allow it, even if I put it in a zip. But here is a simple way to repro it by creating the file with GDAL itself. (In this example, I used float64 and the same warning occurs.) You could use this to produce a test file. If you'd prefer I send a file I can post it to a file exchange service.>>> import numpy as np>>>>>> from osgeo import gdal>>> print(gdal.__version__)3.9.2e>>> gdal.UseExceptions()>>>>>> # Create the dataset as float64 with 1 band>>> f = 'has_nans.img'>>> drv = gdal.GetDriverByName('HFA')>>> ds = drv.Create(f, 100, 100, 1, gdal.GDT_Float64)>>>>>> # Make some fake data; set some cells to nan, although this is not necessary to repro the warning>>> data = np.arange(100*100, dtype=float).reshape(100,100)>>> data[0:20,0:30] = float('nan')>>>>>> # Write the data to the band>>> band = ds.GetRasterBand(1)>>> band.SetNoDataValue(float('nan'))0>>> band.WriteArray(data, 0, 0)0>>>>>> # Close the dataset>>> del band, ds>>>>>> # Open it again - warning happens here>>> ds = gdal.Open(f, gdal.GA_ReadOnly)Warning 1: NaN converted to INT_MAX.JasonOn 5/8/25 18:39, Even Rouault wrote:There are metadata fields that the HFA driver opens. That must come from that. Always shutting down the warning could be inappropriate, but perhaps in the context where the warning is emitted the driver could avoid emitting it. But we need to have access to the file to better understand the call path.Le 09/05/2025 ? 00:35, Jason Roberts a ?crit?:Hi Even,Thanks. I can silence this with a custom error handler (I tested it, and it works). But the part that is confusing to me, as a user of the Python API, is that I did not ask the API to do anything with int32s. All I did was open the dataset using the default parameters of gdal.Open(). I would not expect a warning to be reported in that circumstance, unless opening .img files that use nan as the NoData value was problematic for GDAL in some way. That is why I was suggesting that the warning be removed.JasonOn 5/8/25 17:51, Even Rouault wrote:Jason,It looks like something in the code asks a float64 field to be returned as a int32, and thus NaN has to be turned into something else. That's perhaps fine in the context where that happens with your file and could potentially be silenced, but access to the file would be needed to investigateEvenLe 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:Hi GDAL team,I'm working with the GDAL Python API. I have some HFA (.img) files that are float32 and that use nan as their NoData value. As far as I can tell, using nan is allowed but I could be wrong. When I open them, I get "Warning 1: NaN converted to INT_MAX." Everything seems to work fine after that. Is this message something I need to worry about? If not, may I suggest you remove it from the HFA driver if possible?Here's some code demonstrating the message. If need be, I can provide an example file, or write some code to generate one.>>> import numpy as np>>> from osgeo import gdal>>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 3.4, but I don't think the version matters'3.9.2e'>>> ds = gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', gdal.GA_ReadOnly)Warning 1: NaN converted to INT_MAX.>>> band = ds.GetRasterBand(1)>>> gdal.GetDataTypeName(band.DataType)'Float32'>>> band.GetNoDataValue()nan>>> arr = band.ReadAsArray()?? # the data look ok:>>> np.isnan(arr).sum()86788>>> (~np.isnan(arr)).sum()142985>>> np.max(arr)nan>>> np.nanmax(arr)27.078554As far as I can tell, the warning comes from this code in gdal/frmts/hfa/hfafield.cpp:??????????????? else if (std::isnan(dfDoubleRet))??????????????? {??????????????????? CPLError(CE_Warning, CPLE_AppDefined,???????????????????????????? "NaN converted to INT_MAX.");??????????????????? nIntRet = nMax;??????????????? }But I don't know if there are any negative ramifications that will result.Thank you for your help. And, as always, thank you very much for developing and maintaining GDAL.Jason _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-- 
http://www.spatialys.com
My software is free, but my time generally not.-- 
http://www.spatialys.com
My software is free, but my time generally not.

From even.rouault at spatialys.com  Fri May  9 03:04:53 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 9 May 2025 12:04:53 +0200
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <DB9PR09MB6887F06C719A4A95A76ADD82FD8AA@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
 <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
 <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>
 <4dc40ddc-82ae-4499-a25b-60aed6f2f359@duke.edu>
 <DB9PR09MB6887F06C719A4A95A76ADD82FD8AA@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <878ac53d-666d-4f04-9128-3a8c595110c5@spatialys.com>

Will be fixed per https://github.com/OSGeo/gdal/pull/12323

Le 09/05/2025 ? 07:56, Rahkonen Jukka a ?crit?:
> Hi,
>
> Another method to reproduce without Python by using gdal_create:
>
> gdal_create -outsize 100 100 -ot float32 -a_nodata nan -of hfa nan.img
>
> C:\data\000\gdaltest>gdalinfo nan.img
> Warning 1: NaN converted to INT_MAX.
> Driver: HFA/Erdas Imagine Images (.img)
> Files: nan.img
> Size is 100, 100
> ...
> Band 1 Block=64x64 Type=Float32, ColorInterp=Undefined
>    Description = Layer_1
>    NoData Value=nan
>    Metadata:
>      LAYER_TYPE=athematic
>
> If I convert nan.img into GeoTIFF with "gdal_translate nan.img nan.tif", I do see the warning, but the new GeoTIFF still has NoData Value=nsn. I wonder what is the real meaning of the warning.
>
> -Jukka Rahkonen-
>
> ________________________________________
> L?hett?j?: gdal-dev k?ytt?j?n Jason Roberts via gdal-dev puolesta
> L?hetetty: Perjantai 9. toukokuuta 2025 2.04
> Vastaanottaja: Even Rouault; gdal dev
> Aihe: Re: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to INT_MAX when float raster has nan as the NoData value
>
> Thank you. I can help you repro it if you want to take a look.I'm having trouble attaching a .img file to email. My email system doesn't want to allow it, even if I put it in a zip. But here is a simple way to repro it by creating the file with GDAL itself. (In this example, I used float64 and the same warning occurs.) You could use this to produce a test file. If you'd prefer I send a file I can post it to a file exchange service.>>> import numpy as np>>>>>> from osgeo import gdal>>> print(gdal.__version__)3.9.2e>>> gdal.UseExceptions()>>>>>> # Create the dataset as float64 with 1 band>>> f = 'has_nans.img'>>> drv = gdal.GetDriverByName('HFA')>>> ds = drv.Create(f, 100, 100, 1, gdal.GDT_Float64)>>>>>> # Make some fake data; set some cells to nan, although this is not necessary to repro the warning>>> data = np.arange(100*100, dtype=float).reshape(100,100)>>> data[0:20,0:30] = float('nan')>>>>>> # Write the data to the band>>> band = ds.GetRasterBand(1)>>> band.SetNoDataValue(float('nan'))0>>> band.WriteArray(data, 0, 0)0>>>>>> # Close the dataset>>> del band, ds>>>>>> # Open it again - warning happens here>>> ds = gdal.Open(f, gdal.GA_ReadOnly)Warning 1: NaN converted to INT_MAX.JasonOn 5/8/25 18:39, Even Rouault wrote:There are metadata fields that the HFA driver opens. That must come from that. Always shutting down the warning could be inappropriate, but perhaps in the context where the warning is emitted the driver could avoid emitting it. But we need to have access to the file to better understand the call path.Le 09/05/2025 ? 00:35, Jason Roberts a ?crit?:Hi Even,Thanks. I can silence this with a custom error handler (I tested it, and it works). But the part that is confusing to me, as a user of the Python API, is that I did not ask the API to do anything with int32s. All I did was open the dataset using the default parameters of gdal.Open(). I would not expect a warning to be reported in that circumstance, unless opening .img files that use nan as the NoData value was problematic for GDAL in some way. That is why I was suggesting that the warning be removed.JasonOn 5/8/25 17:51, Even Rouault wrote:Jason,It looks like something in the code asks a float64 field to be returned as a int32, and thus NaN has to be turned into something else. That's perhaps fine in the context where that happens with your file and could potentially be silenced, but access to the file would be needed to investigateEvenLe 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a ?crit?:Hi GDAL team,I'm working with the GDAL Python API. I have some HFA (.img) files that are float32 and that use nan as their NoData value. As far as I can tell, using nan is allowed but I could be wrong. When I open them, I get "Warning 1: NaN converted to INT_MAX." Everything seems to work fine after that. Is this message something I need to worry about? If not, may I suggest you remove it from the HFA driver if possible?Here's some code demonstrating the message. If need be, I can provide an example file, or write some code to generate one.>>> import numpy as np>>> from osgeo import gdal>>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 3.4, but I don't think the version matters'3.9.2e'>>> ds = gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', gdal.GA_ReadOnly)Warning 1: NaN converted to INT_MAX.>>> band = ds.GetRasterBand(1)>>> gdal.GetDataTypeName(band.DataType)'Float32'>>> band.GetNoDataValue()nan>>> arr = band.ReadAsArray()?? # the data look ok:>>> np.isnan(arr).sum()86788>>> (~np.isnan(arr)).sum()142985>>> np.max(arr)nan>>> np.nanmax(arr)27.078554As far as I can tell, the warning comes from this code in gdal/frmts/hfa/hfafield.cpp:??????????????? else if (std::isnan(dfDoubleRet))??????????????? {??????????????????? CPLError(CE_Warning, CPLE_AppDefined,???????????????????????????? "NaN converted to INT_MAX.");??????????????????? nIntRet = nMax;??????????????? }But I don't know if there are any negative ramifications that will result.Thank you for your help. And, as always, thank you very much for developing and maintaining GDAL.Jason _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From jason.roberts at duke.edu  Fri May  9 05:43:28 2025
From: jason.roberts at duke.edu (Jason Roberts)
Date: Fri, 9 May 2025 08:43:28 -0400
Subject: [gdal-dev] HFA (.img) driver prints Warning 1: NaN converted to
 INT_MAX when float raster has nan as the NoData value
In-Reply-To: <878ac53d-666d-4f04-9128-3a8c595110c5@spatialys.com>
References: <2d66b13b-34e6-460d-a687-90e0a4196eda@duke.edu>
 <7f77f6f0-caea-4e70-9ed2-c3c8848bb00f@spatialys.com>
 <8d468679-aad9-4d65-8f9f-62551b414e2e@duke.edu>
 <196c2174-3430-4216-a3d4-4ac7a760b697@spatialys.com>
 <4dc40ddc-82ae-4499-a25b-60aed6f2f359@duke.edu>
 <DB9PR09MB6887F06C719A4A95A76ADD82FD8AA@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <878ac53d-666d-4f04-9128-3a8c595110c5@spatialys.com>
Message-ID: <063b17fc-6f06-482f-a547-24706788e372@duke.edu>

Thank you!

Jason

On 5/9/25 06:04, Even Rouault wrote:
> Will be fixed per 
> https://github.com/OSGeo/gdal/pull/12323
>
> Le 09/05/2025 ? 07:56, Rahkonen Jukka a ?crit?:
>> Hi,
>>
>> Another method to reproduce without Python by using gdal_create:
>>
>> gdal_create -outsize 100 100 -ot float32 -a_nodata nan -of hfa nan.img
>>
>> C:\data\000\gdaltest>gdalinfo nan.img
>> Warning 1: NaN converted to INT_MAX.
>> Driver: HFA/Erdas Imagine Images (.img)
>> Files: nan.img
>> Size is 100, 100
>> ...
>> Band 1 Block=64x64 Type=Float32, ColorInterp=Undefined
>> ?? Description = Layer_1
>> ?? NoData Value=nan
>> ?? Metadata:
>> ???? LAYER_TYPE=athematic
>>
>> If I convert nan.img into GeoTIFF with "gdal_translate nan.img 
>> nan.tif", I do see the warning, but the new GeoTIFF still has NoData 
>> Value=nsn. I wonder what is the real meaning of the warning.
>>
>> -Jukka Rahkonen-
>>
>> ________________________________________
>> L?hett?j?: gdal-dev k?ytt?j?n Jason Roberts via gdal-dev puolesta
>> L?hetetty: Perjantai 9. toukokuuta 2025 2.04
>> Vastaanottaja: Even Rouault; gdal dev
>> Aihe: Re: [gdal-dev] HFA (.img) driver prints Warning 1: NaN 
>> converted to INT_MAX when float raster has nan as the NoData value
>>
>> Thank you. I can help you repro it if you want to take a look.I'm 
>> having trouble attaching a .img file to email. My email system 
>> doesn't want to allow it, even if I put it in a zip. But here is a 
>> simple way to repro it by creating the file with GDAL itself. (In 
>> this example, I used float64 and the same warning occurs.) You could 
>> use this to produce a test file. If you'd prefer I send a file I can 
>> post it to a file exchange service.>>> import numpy as np>>>>>> from 
>> osgeo import gdal>>> print(gdal.__version__)3.9.2e>>> 
>> gdal.UseExceptions()>>>>>> # Create the dataset as float64 with 1 
>> band>>> f = 'has_nans.img'>>> drv = gdal.GetDriverByName('HFA')>>> ds 
>> = drv.Create(f, 100, 100, 1, gdal.GDT_Float64)>>>>>> # Make some fake 
>> data; set some cells to nan, although this is not necessary to repro 
>> the warning>>> data = np.arange(100*100, 
>> dtype=float).reshape(100,100)>>> data[0:20,0:30] = float('nan')>>>>>> 
>> # Write the data to the band>>> band = ds.GetRasterBand(1)>>> 
>> band.SetNoDataValue(float('nan'))0>>> band.WriteArray(data, 0, 
>> 0)0>>>>>> # Close the dataset>>> del band, ds>>>>>> # Open it again - 
>> warning happens here>>> ds = gdal.Open(f, gdal.GA_ReadOnly)Warning 1: 
>> NaN converted to INT_MAX.JasonOn 5/8/25 18:39, Even Rouault 
>> wrote:There are metadata fields that the HFA driver opens. That must 
>> come from that. Always shutting down the warning could be 
>> inappropriate, but perhaps in the context where the warning is 
>> emitted the driver could avoid emitting it. But we need to have 
>> access to the file to better understand the call path.Le 09/05/2025 ? 
>> 00:35, Jason Roberts a ?crit?:Hi Even,Thanks. I can silence this with 
>> a custom error handler (I tested it, and it works). But the part that 
>> is confusing to me, as a user of the Python API, is that I did not 
>> ask the API to do anything with int32s. All I did was open the 
>> dataset using the default parameters of gdal.Open(). I would not 
>> expect a warning to be reported in that circumstance, unless opening 
>> .img files that use nan as the NoData value was problematic for GDAL 
>> in some way. That is why I was suggesting that the warning be 
>> removed.JasonOn 5/8/25 17:51, Even Rouault wrote:Jason,It looks like 
>> something in the code asks a float64 field to be returned as a int32, 
>> and thus NaN has to be turned into something else. That's perhaps 
>> fine in the context where that happens with your file and could 
>> potentially be silenced, but access to the file would be needed to 
>> investigateEvenLe 08/05/2025 ? 23:01, Jason Roberts via gdal-dev a 
>> ?crit?:Hi GDAL team,I'm working with the GDAL Python API. I have some 
>> HFA (.img) files that are float32 and that use nan as their NoData 
>> value. As far as I can tell, using nan is allowed but I could be 
>> wrong. When I open them, I get "Warning 1: NaN converted to INT_MAX." 
>> Everything seems to work fine after that. Is this message something I 
>> need to worry about? If not, may I suggest you remove it from the HFA 
>> driver if possible?Here's some code demonstrating the message. If 
>> need be, I can provide an example file, or write some code to 
>> generate one.>>> import numpy as np>>> from osgeo import gdal>>> 
>> gdal.__version__?????? # this version is packaged with ArcGIS Pro 
>> 3.4, but I don't think the version matters'3.9.2e'>>> ds = 
>> gdal.Open(r'\\conch\denmod\Covariates\NARW25\CMEMS_GLORYS\SST\1999\SST_199901.img', 
>> gdal.GA_ReadOnly)Warning 1: NaN converted to INT_MAX.>>> band = 
>> ds.GetRasterBand(1)>>> 
>> gdal.GetDataTypeName(band.DataType)'Float32'>>> 
>> band.GetNoDataValue()nan>>> arr = band.ReadAsArray() # the data look 
>> ok:>>> np.isnan(arr).sum()86788>>> (~np.isnan(arr)).sum()142985>>> 
>> np.max(arr)nan>>> np.nanmax(arr)27.078554As far as I can tell, the 
>> warning comes from this code in 
>> gdal/frmts/hfa/hfafield.cpp:??????????????? else if 
>> (std::isnan(dfDoubleRet))??????????????? { CPLError(CE_Warning, 
>> CPLE_AppDefined,???????????????????????????? "NaN converted to 
>> INT_MAX.");??????????????????? nIntRet = nMax; }But I don't know if 
>> there are any negative ramifications that will result.Thank you for 
>> your help. And, as always, thank you very much for developing and 
>> maintaining GDAL.Jason _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev 
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250509/114612d9/attachment-0001.htm>

From even.rouault at spatialys.com  Fri May  9 09:02:31 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 9 May 2025 18:02:31 +0200
Subject: [gdal-dev] Motion: approve GDAL 3.11.0RC2 as final release
In-Reply-To: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
References: <12267f94-de66-49e4-8989-65cd088a30ef@spatialys.com>
Message-ID: <ad4dbfda-b4fc-455e-b735-bb5119ecad4f@spatialys.com>

Approved with +1 from PSC members JavierJS, MikeS, KurtS, HowardB, 
JukkaR, DanB and me.

Le 07/05/2025 ? 17:53, Even Rouault via gdal-dev a ?crit?:
> +1 Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From even.rouault at spatialys.com  Fri May  9 09:34:01 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 9 May 2025 18:34:01 +0200
Subject: [gdal-dev] GDAL 3.11.0 "Eganville" is released
Message-ID: <ada4728f-611d-46b6-bacb-6dbfde002e6f@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team and community, I am pleased 
to announce the release of GDAL/OGR 3.11.0. GDAL/OGR is a C++ geospatial 
data access library for raster and vector file formats, databases and 
web services. It includes bindings for several languages, and a variety 
of command line tools.

http://gdal.org/

The 3.11.0 release is a new feature release with the following highlights:

* [RFC 
104](https://gdal.org/en/latest/development/rfc/rfc104_gdal_cli.html): 
<b>Adding a "gdal" front-end command line interface</b>.
 ? - See the [list of 
commands](https://gdal.org/en/latest/programs/index.html#gdal-application)
 ? - Includes new "gdal raster calc" and "gdal raster resclassify" 
utilities.
 ? - "gdal raster tile", C++ port of gdal2tiles, runs faster (3x to 6x 
in some cases)
 ? - Includes "gdal vsi list/copy/delete/move/sync" (ports of Python 
sample scripts)
 ? - Includes "gdal driver {driver_name}" for driver-specific commands.
 ? - Includes smart Bash autocompletion
 ? - Includes C, C++, Python API
* Add [GDALG](https://gdal.org/en/latest/drivers/vector/gdalg.html) 
(GDAL Streamed Algorithm Format) driver: reading of on-the-fly / 
streamed vector dataset replaying compatible "gdal" command lines (kind 
of VRT).

Other topics

* [RFC 
100](https://gdal.org/en/latest/development/rfc/rfc100_float16_support.html): 
Support float16 type
* [RFC 
102](https://gdal.org/en/latest/development/rfc/rfc102_embedded_resources.html): 
Embedding resource files into libgdal
* [RFC 
103](https://gdal.org/en/latest/development/rfc/rfc103_schema_open_option.html): 
Add a OGR_SCHEMA open option to selected OGR drivers
* [RFC 
105](https://gdal.org/en/latest/development/rfc/rfc105_safe_path_manipulation_functions.html): 
Add and use safe path manipulation functions
* [RFC 
106](https://gdal.org/en/latest/development/rfc/rfc106_update_metadata.html): 
Metadata items to reflect driver update capabilities
* [RFC 
107](https://gdal.org/en/latest/development/rfc/rfc107_igetextent_isetspatialfilter.html): 
Add OGRLayer::IGetExtent() and OGRLayer::ISetSpatialFilter()
* Add read-only [OGR 
ADBC](https://gdal.org/en/latest/drivers/vector/adbc.html) (Arrow 
Database Connectivity) driver, in particular
 ? with support for DuckDB or Parquet datasets (if libduckdb also installed)
* Add 
[LIBERTIFF](https://gdal.org/en/latest/drivers/raster/libertiff.html) 
driver: native thread-safe read-only GeoTIFF reader
* Add read-only 
[RCM](https://gdal.org/en/latest/drivers/raster/rcm.html) (Radarsat 
Constellation Mission) raster driver
* Add read-only AIVector (Artificial intelligence powered vector) driver
* VRT Pixel Functions: Add function to evaluate arbitrary expression 
(#11209)
* Substantially improved drivers: 
[ZARR](https://gdal.org/en/latest/drivers/raster/zarr.html), with 
support for Kerchunk JSON and Parquet reference stores
* GeoPackage: change default version to GeoPackage 1.4 on creation (#7870)
* [RFC 
108](https://gdal.org/en/latest/development/rfc/rfc108_driver_removal_3_11.html):
 ? - Removed raster drivers: BLX, BT, CTable2, ELAS, FIT, GSAG (Golden 
Software ASCII grid),? GSBG (Golden Software 6.0 binary grid), JP2Lura, 
OZI OZF2/OZFX3,? Rasterlite (v1), R object data store (.rda), RDB, SDTS, 
SGI, XPM, DIPex
 ? - Removed vector drivers: Geoconcept Export, OGDI (VPF/VMAP support), 
SDTS, SVG, Tiger, UK. NTF
 ? - Removed write support in following drivers: Interlis 1, Interlis 2, 
ADRG,? PAux, MFF, MFF2/HKV, LAN, NTv2, BYN, USGSDEM, ISIS2
* Removed OpenCL warper
* OGR "Memory" driver deprecated, and aliased to the "MEM" driver. Its 
functionality is merged into the "MEM" driver that has raster, vector
 ? and multidimensional support.
* Various code linting, static code analyzer fixes, etc.
* Bump of shared lib major version

New optional dependencies:

* [muparser](https://github.com/beltoforion/muparser) is *strongly* 
recommended to be added as a build and runtime dependency, to provide 
nominal support for C++ VRT expressions.
* [exprtk](https://github.com/ArashPartow/exprtk) may be added as a 
build dependency (this is a header-only library) to provide support for 
advanced C++ VRT expressions. Note that it causes an increase in libgdal 
size of about 8 MB. exprtk support is recommended to be an addition to 
muparser support, not as a replacement.

More complete information on the new features and fixes in the 3.11.0 
release can be found at:

https://github.com/OSGeo/gdal/blob/v3.11.0/NEWS.md

Please also consult the migration guide when updating from prior releases:

https://github.com/OSGeo/gdal/blob/v3.11.0/MIGRATION_GUIDE.TXT

The release can be downloaded from:
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz - source 
as .tar.gz
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz.md5 - md5sum
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz.sig - 
signature
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz - source 
as .tar.xz
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz.md5 - md5sum
 ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz.sig - 
signature
 ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip - source as a zip
 ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip.md5 - md5sum
 ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip.sig - signature
 ? * https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0.tar.gz - 
test suite
 ? * https://download.osgeo.org/gdal/3.11.0/gdal3110doc.zip - 
documentation / website

Docker images are currently cooking and should be ready in one day or so.

Best regards,

Even

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From mdsumner at gmail.com  Sat May 10 15:20:28 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 11 May 2025 08:20:28 +1000
Subject: [gdal-dev] replacing a dataset in C++
Message-ID: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>

Hello, I have a question about safely re-casting a dataset to another, I
want to use Multidim to re-orient an MDArray as a classic 2D raster. I was
a bit surprised that this works (I just overwrite poSrcDS with the
classic form):

I'm passing in 'osFilename', 'osArrayName' and two dimension indexes
'index_x' and 'index_y', the first "Open()" line is a literal copy from
vrtdataset.cpp:


//  I've removed all the nullptr checks from this code
auto poSrcDS = std::unique_ptr<GDALDataset, GDALDatasetUniquePtrReleaser>(
         GDALDataset::Open(osFilename, GDAL_OF_RASTER |
GDAL_OF_VERBOSE_ERROR,
                          aosAllowedDrivers.List(), aosOpenOptions.List(),
                          nullptr));
// now open in mdim mode, and get the specified MDArray in Classic form
with index_x,index_y
auto poMDimDS = std::unique_ptr<GDALDataset>(GDALDataset::Open(osFilename,
GDAL_OF_MULTIDIM_RASTER));
auto poMdimGroup = poMDimDS->GetRootGroup();
auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osFilename);
auto poClassicDS = poArrayDS->AsClassicDataset(index_x, index_y);

// FIXME how to safely swap poSrcDS with poClassicDS
poSrcDS = std::unique_ptr<GDALDataset,
GDALDatasetUniquePtrReleaser>(poClassicDS);

My question is about the last line where poClassic "replaces" poSrcDS: what
am I responsible for to make that safe?

Thanks!


-- 
Michael Sumner
Research Software Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/e2464af5/attachment.htm>

From mdsumner at gmail.com  Sat May 10 15:24:00 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 11 May 2025 08:24:00 +1000
Subject: [gdal-dev] replacing a dataset in C++
In-Reply-To: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>
References: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>
Message-ID: <CAAcGz9-VOFPL1VxtWpVAAX5ZkL51V369RH7R1kGnB6vY+ertjQ@mail.gmail.com>

Ugh, sorry made a mistake in the code, fixed for osArrayName:

auto poSrcDS = std::unique_ptr<GDALDataset, GDALDatasetUniquePtrReleaser>(
         GDALDataset::Open(osFilename, GDAL_OF_RASTER |
GDAL_OF_VERBOSE_ERROR,
                          aosAllowedDrivers.List(), aosOpenOptions.List(),
                          nullptr));
// now open in mdim mode, and get the specified MDArray in Classic form
with index_x,index_y
auto poMDimDS = std::unique_ptr<GDALDataset>(GDALDataset::Open(osFilename,
GDAL_OF_MULTIDIM_RASTER));
auto poMdimGroup = poMDimDS->GetRootGroup();
// ---auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osFilename);
// +++auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osArrayName);
auto poClassicDS = poArrayDS->AsClassicDataset(index_x, index_y);

// FIXME how to safely swap poSrcDS with poClassicDS
poSrcDS = std::unique_ptr<GDALDataset,
GDALDatasetUniquePtrReleaser>(poClassicDS);


On Sun, May 11, 2025 at 8:20?AM Michael Sumner <mdsumner at gmail.com> wrote:

> Hello, I have a question about safely re-casting a dataset to another, I
> want to use Multidim to re-orient an MDArray as a classic 2D raster. I was
> a bit surprised that this works (I just overwrite poSrcDS with the
> classic form):
>
> I'm passing in 'osFilename', 'osArrayName' and two dimension indexes
> 'index_x' and 'index_y', the first "Open()" line is a literal copy from
> vrtdataset.cpp:
>
>
> //  I've removed all the nullptr checks from this code
> auto poSrcDS = std::unique_ptr<GDALDataset, GDALDatasetUniquePtrReleaser>(
>          GDALDataset::Open(osFilename, GDAL_OF_RASTER |
> GDAL_OF_VERBOSE_ERROR,
>                           aosAllowedDrivers.List(), aosOpenOptions.List(),
>                           nullptr));
> // now open in mdim mode, and get the specified MDArray in Classic form
> with index_x,index_y
> auto poMDimDS = std::unique_ptr<GDALDataset>(GDALDataset::Open(osFilename,
> GDAL_OF_MULTIDIM_RASTER));
> auto poMdimGroup = poMDimDS->GetRootGroup();
> auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osFilename);
> auto poClassicDS = poArrayDS->AsClassicDataset(index_x, index_y);
>
> // FIXME how to safely swap poSrcDS with poClassicDS
> poSrcDS = std::unique_ptr<GDALDataset,
> GDALDatasetUniquePtrReleaser>(poClassicDS);
>
> My question is about the last line where poClassic "replaces" poSrcDS:
> what am I responsible for to make that safe?
>
> Thanks!
>
>
> --
> Michael Sumner
> Research Software Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>


-- 
Michael Sumner
Research Software Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/2c2cc9e4/attachment.htm>

From even.rouault at spatialys.com  Sat May 10 15:29:40 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 11 May 2025 00:29:40 +0200
Subject: [gdal-dev] replacing a dataset in C++
In-Reply-To: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>
References: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>
Message-ID: <31b68184-5174-4476-8dfd-4866ed51d964@spatialys.com>


Le 11/05/2025 ? 00:20, Michael Sumner via gdal-dev a ?crit?:
> Hello, I have a question about safely re-casting a dataset to another, 
> I want to use Multidim to re-orient?an MDArray as a classic 2D raster. 
> I was a bit surprised that this works (I just overwrite poSrcDS with 
> the classic?form):
>
> I'm passing in 'osFilename', 'osArrayName' and two dimension indexes 
> 'index_x' and 'index_y', the first "Open()" line is a literal copy 
> from vrtdataset.cpp:
>
>
> // I've removed all the nullptr checks from this code
> auto poSrcDS = std::unique_ptr<GDALDataset, GDALDatasetUniquePtrReleaser>(
> ? ? ? ? ?GDALDataset::Open(osFilename, GDAL_OF_RASTER | 
> GDAL_OF_VERBOSE_ERROR,
> ? ? ? ? ? ? ? ? ? ? ? ? ? aosAllowedDrivers.List(), aosOpenOptions.List(),
> ? ? ? ? ? ? ? ? ? ? ? ? ? nullptr));
> // now open in mdim mode, and get the specified MDArray in Classic 
> form with index_x,index_y
> auto poMDimDS = 
> std::unique_ptr<GDALDataset>(GDALDataset::Open(osFilename, 
> GDAL_OF_MULTIDIM_RASTER));
> auto poMdimGroup = poMDimDS->GetRootGroup();
> auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osFilename);
> auto poClassicDS = poArrayDS->AsClassicDataset(index_x, index_y);
>
> // FIXME how to safely swap poSrcDS with poClassicDS
> poSrcDS = std::unique_ptr<GDALDataset, 
> GDALDatasetUniquePtrReleaser>(poClassicDS);
>
> My question is about the last line where poClassic "replaces" poSrcDS: 
> what am I responsible for to make that safe?

That's perfectly fine. In the mdim API, objects returned by 
GetRootGroup(), OpenMDArray(), AsClassicDataset(), etc. , keep the 
necessary parent objects alive through shared_ptr mechanism. Furthermore 
in your example, there is no relationship between poSrcDS et 
poClassicDS, so even if that wasn't the case, your final assignment 
would be still safe.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/b4729a37/attachment.htm>

From mdsumner at gmail.com  Sat May 10 15:34:13 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 11 May 2025 08:34:13 +1000
Subject: [gdal-dev] replacing a dataset in C++
In-Reply-To: <31b68184-5174-4476-8dfd-4866ed51d964@spatialys.com>
References: <CAAcGz9_zW6jK9H2ABcLvU_9p7ORGu87m3eC9wVEjdXtDPsXVyg@mail.gmail.com>
 <31b68184-5174-4476-8dfd-4866ed51d964@spatialys.com>
Message-ID: <CAAcGz98gAdwLByQ908+-2QUGnA7pnNtRdTPUJjhknkr4Oiw41w@mail.gmail.com>

Awesome, thanks so much.


Cheers, Mike.

On Sun, May 11, 2025 at 8:29?AM Even Rouault <even.rouault at spatialys.com>
wrote:

>
> Le 11/05/2025 ? 00:20, Michael Sumner via gdal-dev a ?crit :
>
> Hello, I have a question about safely re-casting a dataset to another, I
> want to use Multidim to re-orient an MDArray as a classic 2D raster. I was
> a bit surprised that this works (I just overwrite poSrcDS with the
> classic form):
>
> I'm passing in 'osFilename', 'osArrayName' and two dimension indexes
> 'index_x' and 'index_y', the first "Open()" line is a literal copy from
> vrtdataset.cpp:
>
>
> //  I've removed all the nullptr checks from this code
> auto poSrcDS = std::unique_ptr<GDALDataset, GDALDatasetUniquePtrReleaser>(
>          GDALDataset::Open(osFilename, GDAL_OF_RASTER |
> GDAL_OF_VERBOSE_ERROR,
>                           aosAllowedDrivers.List(), aosOpenOptions.List(),
>                           nullptr));
> // now open in mdim mode, and get the specified MDArray in Classic form
> with index_x,index_y
> auto poMDimDS = std::unique_ptr<GDALDataset>(GDALDataset::Open(osFilename,
> GDAL_OF_MULTIDIM_RASTER));
> auto poMdimGroup = poMDimDS->GetRootGroup();
> auto poArrayDS = poMdimGroup->OpenMDArrayFromFullname(osFilename);
> auto poClassicDS = poArrayDS->AsClassicDataset(index_x, index_y);
>
> // FIXME how to safely swap poSrcDS with poClassicDS
> poSrcDS = std::unique_ptr<GDALDataset,
> GDALDatasetUniquePtrReleaser>(poClassicDS);
>
> My question is about the last line where poClassic "replaces" poSrcDS:
> what am I responsible for to make that safe?
>
> That's perfectly fine. In the mdim API, objects returned by
> GetRootGroup(), OpenMDArray(), AsClassicDataset(), etc. , keep the
> necessary parent objects alive through shared_ptr mechanism.   Furthermore
> in your example, there is no relationship between poSrcDS et poClassicDS,
> so even if that wasn't the case, your final assignment would be still safe.
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>

-- 
Michael Sumner
Research Software Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/b28b76f5/attachment-0001.htm>

From jluis at ualg.pt  Sun May 11 16:04:31 2025
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sun, 11 May 2025 23:04:31 +0000
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
Message-ID: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>

Hi,

I'm afraid this one is not going to be easy, and I don't know how much help I can provide to find the issue. The think is that https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) broke my Julia wrapper.

For example, this used to write a png image but now it errors with

julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
ERROR 1: Cannot guess driver for lixo.png

But maybe more concrete is this failure where it tries to extract info from a gdal dataset (a pointer )


Gdal.GDALGetRasterYSize(dataset.ptr)
49
Gdal.GDALGetRasterCount(dataset.ptr)
1
Gdal.GDALDatasetGetLayerCount(dataset.ptr)
0

Here, first two are correct be the third is now wrong.

As I said above, I don't know how to provide more help on this and given the amount of cpp files changed I have no idea what to try.

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/00d7708c/attachment.htm>

From jluis at ualg.pt  Sun May 11 16:14:44 2025
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sun, 11 May 2025 23:14:44 +0000
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
In-Reply-To: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
References: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
Message-ID: <AM6PR04MB6440331E61227C32E97206FBA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>

BTW, the "dataset" in previous message is created as

ds = Gdal.create("", driver=getdriver("MEM"), width=width, height=height, nbands=size(GI,3), dtype=eltype(GI[1]))
https://github.com/GenericMappingTools/GMT.jl/blob/master/src/gdal_utils.jl#L530

where "G" is a 2D grid and size(GI,3) = 1

and the Gdal.create is defined in

https://github.com/GenericMappingTools/GMT.jl/blob/master/src/gdal.jl#L1194

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Joaquim Manuel Freire Lu?s via gdal-dev
Sent: Monday, May 12, 2025 12:05 AM
To: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper

Hi,

I'm afraid this one is not going to be easy, and I don't know how much help I can provide to find the issue. The think is that https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) broke my Julia wrapper.

For example, this used to write a png image but now it errors with

julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
ERROR 1: Cannot guess driver for lixo.png

But maybe more concrete is this failure where it tries to extract info from a gdal dataset (a pointer )


Gdal.GDALGetRasterYSize(dataset.ptr)
49
Gdal.GDALGetRasterCount(dataset.ptr)
1
Gdal.GDALDatasetGetLayerCount(dataset.ptr)
0

Here, first two are correct be the third is now wrong.

As I said above, I don't know how to provide more help on this and given the amount of cpp files changed I have no idea what to try.

Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/dbb51fb8/attachment.htm>

From even.rouault at spatialys.com  Sun May 11 16:15:22 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 May 2025 01:15:22 +0200
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
In-Reply-To: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
References: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
Message-ID: <df2a9167-8b05-4d90-8645-1113a51f5c27@spatialys.com>


Le 12/05/2025 ? 01:04, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit?:
>
> Hi,
>
> I?m afraid this one is not going to be easy, and I don?t know how much 
> help I can provide to find the issue. The think is that 
> https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) 
> broke my Julia wrapper.
>
> For example, this used to write a png image but now it errors with
>
> julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
>
> ERROR 1: Cannot guess driver for lixo.png
>
> But maybe more concrete is this failure where it tries to extract info 
> from a gdal dataset (a pointer )
>
>
> Gdal.GDALGetRasterYSize(dataset.ptr)
>
> 49
>
> Gdal.GDALGetRasterCount(dataset.ptr)
>
> 1
>
> Gdal.GDALDatasetGetLayerCount(dataset.ptr)
>
> 0
>
> Here, first two are correct be the third is now wrong.
>
Why is GDALDatasetGetLayerCount() == 0 wrong on a raster dataset ? It 
looks like the expected result

If I'm looking at the correct source code 
https://github.com/GenericMappingTools/GMT.jl/blob/94649db2b48d3223c8b8628b6fac4d3df60b8938/src/gdal_utils.jl#L859 
, then this line is fragile. Rather than testing if OGRGetDriverByName() 
returns a non null pointer to guess if that dataset is raster or vector, 
you could indeed test GDALGetRasterCount() != 0 to infer this is a 
raster dataset.

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/de2f0453/attachment-0001.htm>

From jluis at ualg.pt  Sun May 11 16:33:32 2025
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Sun, 11 May 2025 23:33:32 +0000
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
In-Reply-To: <df2a9167-8b05-4d90-8645-1113a51f5c27@spatialys.com>
References: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
 <df2a9167-8b05-4d90-8645-1113a51f5c27@spatialys.com>
Message-ID: <AM6PR04MB644092ED9976DCFC4612A39AA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>

Right. But I do that I get another error that I?m not sure how to interpret. It comes from some Julia internal

ccall((:GDALGetRasterCount, libgdal), Cint, (Ptr{Cvoid},), ds)
Internal Error: MethodError: no method matching unsafe_convert(::Type{Ptr{Nothing}}, ::GMT.Gdal.IDataset)


From: Even Rouault <even.rouault at spatialys.com>
Sent: Monday, May 12, 2025 12:15 AM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; gdal-dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper



Le 12/05/2025 ? 01:04, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit :
Hi,

I?m afraid this one is not going to be easy, and I don?t know how much help I can provide to find the issue. The think is that https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) broke my Julia wrapper.

For example, this used to write a png image but now it errors with

julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
ERROR 1: Cannot guess driver for lixo.png

But maybe more concrete is this failure where it tries to extract info from a gdal dataset (a pointer )


Gdal.GDALGetRasterYSize(dataset.ptr)
49
Gdal.GDALGetRasterCount(dataset.ptr)
1
Gdal.GDALDatasetGetLayerCount(dataset.ptr)
0

Here, first two are correct be the third is now wrong.

Why is GDALDatasetGetLayerCount() == 0 wrong on a raster dataset ? It looks like the expected result

If I'm looking at the correct source code https://github.com/GenericMappingTools/GMT.jl/blob/94649db2b48d3223c8b8628b6fac4d3df60b8938/src/gdal_utils.jl#L859 , then this line is fragile. Rather than testing if OGRGetDriverByName() returns a non null pointer to guess if that dataset is raster or vector, you could indeed test GDALGetRasterCount() != 0 to infer this is a raster dataset.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/bd02365f/attachment.htm>

From jluis at ualg.pt  Sun May 11 16:38:36 2025
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Sun, 11 May 2025 23:38:36 +0000
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
In-Reply-To: <AM6PR04MB644092ED9976DCFC4612A39AA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
References: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
 <df2a9167-8b05-4d90-8645-1113a51f5c27@spatialys.com>
 <AM6PR04MB644092ED9976DCFC4612A39AA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
Message-ID: <AM6PR04MB644087299CD8ED16DCBF9C6DA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>

Sorry, forgot to pass the pointer. Also here it says the layer count is zero

ccall((:GDALDatasetGetLayerCount, libgdal), Cint, (Ptr{Cvoid},), ds.ptr)
0



From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Joaquim Manuel Freire Lu?s via gdal-dev
Sent: Monday, May 12, 2025 12:34 AM
To: Even Rouault <even.rouault at spatialys.com>; gdal-dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper

Right. But I do that I get another error that I?m not sure how to interpret. It comes from some Julia internal

ccall((:GDALGetRasterCount, libgdal), Cint, (Ptr{Cvoid},), ds)
Internal Error: MethodError: no method matching unsafe_convert(::Type{Ptr{Nothing}}, ::GMT.Gdal.IDataset)


From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Sent: Monday, May 12, 2025 12:15 AM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt<mailto:jluis at ualg.pt>>; gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper



Le 12/05/2025 ? 01:04, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit :
Hi,

I?m afraid this one is not going to be easy, and I don?t know how much help I can provide to find the issue. The think is that https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) broke my Julia wrapper.

For example, this used to write a png image but now it errors with

julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
ERROR 1: Cannot guess driver for lixo.png

But maybe more concrete is this failure where it tries to extract info from a gdal dataset (a pointer )


Gdal.GDALGetRasterYSize(dataset.ptr)
49
Gdal.GDALGetRasterCount(dataset.ptr)
1
Gdal.GDALDatasetGetLayerCount(dataset.ptr)
0

Here, first two are correct be the third is now wrong.

Why is GDALDatasetGetLayerCount() == 0 wrong on a raster dataset ? It looks like the expected result

If I'm looking at the correct source code https://github.com/GenericMappingTools/GMT.jl/blob/94649db2b48d3223c8b8628b6fac4d3df60b8938/src/gdal_utils.jl#L859 , then this line is fragile. Rather than testing if OGRGetDriverByName() returns a non null pointer to guess if that dataset is raster or vector, you could indeed test GDALGetRasterCount() != 0 to infer this is a raster dataset.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250511/0101b545/attachment-0001.htm>

From jluis at ualg.pt  Sun May 11 17:26:57 2025
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Mon, 12 May 2025 00:26:57 +0000
Subject: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper
In-Reply-To: <AM6PR04MB644087299CD8ED16DCBF9C6DA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
References: <AM6PR04MB6440581BDF29BCED52E44FD7A694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
 <df2a9167-8b05-4d90-8645-1113a51f5c27@spatialys.com>
 <AM6PR04MB644092ED9976DCFC4612A39AA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
 <AM6PR04MB644087299CD8ED16DCBF9C6DA694A@AM6PR04MB6440.eurprd04.prod.outlook.com>
Message-ID: <AM6PR04MB644021297D76730A99951880A697A@AM6PR04MB6440.eurprd04.prod.outlook.com>

OK, with the help of your GDALGetRasterCount() hint I fixed it. The problem was that before #12124<https://github.com/OSGeo/gdal/pull/12124>

Gdal.OGRGetDriverByName(Gdal.shortname(getdriver(dataset))) returned NULL for raster types, but from #12124 on it returns a non-NULL pointer, and the code flow went to wrong branches.

Uff, that tricky. Thanks

From: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>
Sent: Monday, May 12, 2025 12:39 AM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt>; Even Rouault <even.rouault at spatialys.com>; gdal-dev <gdal-dev at lists.osgeo.org>
Subject: RE: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper

Sorry, forgot to pass the pointer. Also here it says the layer count is zero

ccall((:GDALDatasetGetLayerCount, libgdal), Cint, (Ptr{Cvoid},), ds.ptr)
0



From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Joaquim Manuel Freire Lu?s via gdal-dev
Sent: Monday, May 12, 2025 12:34 AM
To: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>; gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper

Right. But I do that I get another error that I?m not sure how to interpret. It comes from some Julia internal

ccall((:GDALGetRasterCount, libgdal), Cint, (Ptr{Cvoid},), ds)
Internal Error: MethodError: no method matching unsafe_convert(::Type{Ptr{Nothing}}, ::GMT.Gdal.IDataset)


From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Sent: Monday, May 12, 2025 12:15 AM
To: Joaquim Manuel Freire Lu?s <jluis at ualg.pt<mailto:jluis at ualg.pt>>; gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] GDAL 3.11 broke part of the Julia wrapper



Le 12/05/2025 ? 01:04, Joaquim Manuel Freire Lu?s via gdal-dev a ?crit :
Hi,

I?m afraid this one is not going to be easy, and I don?t know how much help I can provide to find the issue. The think is that https://github.com/OSGeo/gdal/pull/12124 (which is a very big PR) broke my Julia wrapper.

For example, this used to write a png image but now it errors with

julia> gdalwrite("lixo.png", mat2img(UInt8.([1 2 3; 4 5 6; 7 8 9])))
ERROR 1: Cannot guess driver for lixo.png

But maybe more concrete is this failure where it tries to extract info from a gdal dataset (a pointer )


Gdal.GDALGetRasterYSize(dataset.ptr)
49
Gdal.GDALGetRasterCount(dataset.ptr)
1
Gdal.GDALDatasetGetLayerCount(dataset.ptr)
0

Here, first two are correct be the third is now wrong.

Why is GDALDatasetGetLayerCount() == 0 wrong on a raster dataset ? It looks like the expected result

If I'm looking at the correct source code https://github.com/GenericMappingTools/GMT.jl/blob/94649db2b48d3223c8b8628b6fac4d3df60b8938/src/gdal_utils.jl#L859 , then this line is fragile. Rather than testing if OGRGetDriverByName() returns a non null pointer to guess if that dataset is raster or vector, you could indeed test GDALGetRasterCount() != 0 to infer this is a raster dataset.

--

http://www.spatialys.com

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/da6b0871/attachment.htm>

From j1 at jimenezshaw.com  Mon May 12 03:01:04 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 12 May 2025 12:01:04 +0200
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
Message-ID: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>

Hi

I am trying to clean the overviews from a GeoTIFF, but gdaladdo does not
allow me.
Is that an expected behaviour? Maybe I am missing more options. (there is
no opposite of "-ro")

$ gdaladdo --debug on -clean out/test.tif
GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.
GTiff: ScanDirectories()
GTiff: Opened 6978x5110 overview.
GTiff: Opened 3489x2555 overview.
GTiff: Opened 1744x1277 overview.
GTiff: Opened 872x638 overview.
GTiff: Opened 436x319 overview.
GTiff: File open for read-only accessing, creating overviews externally.
ERROR 6: test.tif: Cannot add external overviews when there are
already internal overviews
Cleaning overviews failed.
GDAL: GDALClose(out/test.tif, this=0x133058e00)

$ gdaladdo --version
GDAL 3.11.0 "Eganville", released 2025/05/06


I am running it on a Mac.

Cheers,

Javier.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/1453fbd7/attachment-0001.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 12 03:39:54 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 12 May 2025 10:39:54 +0000
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
Message-ID: <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>

Hi,

Tested with GDAL 3.12.0dev-8130fe444e, released 2025/04/28 (OSGeo4W) on Windows.

gdaladdo addo.tif -clean --debug on
...
GDAL: GDALOpen(addo.tif, this=000002E622185320) succeeds as GTiff.
GTiff: ScanDirectories()
GTiff: Opened 6000x6000 overview.
GTiff: Opened 3000x3000 overview.
GTiff: Opened 1500x1500 overview.
GTiff: Opened 750x750 overview.
GTiff: Opened 375x375 overview.
GTiff: Opened 188x188 overview.
GDAL: GDALClose(addo.tif, this=000002E622185320)

However, if I set the test file "addo.tif" into read-only with file manager, I get the same messages than you do. Could it be that simple?

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Javier Jimenez Shaw via gdal-dev puolesta
L?hetetty: Maanantai 12. toukokuuta 2025 13.01
Vastaanottaja: gdal dev
Aihe: [gdal-dev] I cannot clean overviews from GeoTIFF

HiI am trying to clean the overviews from a GeoTIFF, but gdaladdo does not allow me.Is that an expected behaviour? Maybe I am missing more options. (there is no opposite of "-ro")$ gdaladdo --debug on -clean out/test.tif GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.GTiff: ScanDirectories()GTiff: Opened 6978x5110 overview.GTiff: Opened 3489x2555 overview.GTiff: Opened 1744x1277 overview.GTiff: Opened 872x638 overview.GTiff: Opened 436x319 overview.GTiff: File open for read-only accessing, creating overviews externally.ERROR 6: test.tif: Cannot add external overviews when there are already internal overviewsCleaning overviews failed.GDAL: GDALClose(out/test.tif, this=0x133058e00)$ gdaladdo --versionGDAL 3.11.0 "Eganville", released 2025/05/06I am running it on a Mac.Cheers,Javier.

From j1 at jimenezshaw.com  Mon May 12 04:28:16 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 12 May 2025 13:28:16 +0200
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
 <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
Message-ID: <CADRrdKvsXfxZHrha5QAOOxCDgwsMSVbx=QmSFVG6uhtxaE_mOA@mail.gmail.com>

Thanks Jukka. That was my first guess.

However before sending the email I checked it. "ls -l" is telling me this
(I understand I can modify it)

$ ls -l out/test.tif
-rw-r--r--  1 jshaw  staff  1356600907 May 12 11:38 out/test.tif



On Mon, 12 May 2025 at 12:40, Rahkonen Jukka <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> Tested with GDAL 3.12.0dev-8130fe444e, released 2025/04/28 (OSGeo4W) on
> Windows.
>
> gdaladdo addo.tif -clean --debug on
> ...
> GDAL: GDALOpen(addo.tif, this=000002E622185320) succeeds as GTiff.
> GTiff: ScanDirectories()
> GTiff: Opened 6000x6000 overview.
> GTiff: Opened 3000x3000 overview.
> GTiff: Opened 1500x1500 overview.
> GTiff: Opened 750x750 overview.
> GTiff: Opened 375x375 overview.
> GTiff: Opened 188x188 overview.
> GDAL: GDALClose(addo.tif, this=000002E622185320)
>
> However, if I set the test file "addo.tif" into read-only with file
> manager, I get the same messages than you do. Could it be that simple?
>
> -Jukka Rahkonen-
>
> ________________________________________
> L?hett?j?: gdal-dev k?ytt?j?n Javier Jimenez Shaw via gdal-dev puolesta
> L?hetetty: Maanantai 12. toukokuuta 2025 13.01
> Vastaanottaja: gdal dev
> Aihe: [gdal-dev] I cannot clean overviews from GeoTIFF
>
> HiI am trying to clean the overviews from a GeoTIFF, but gdaladdo does not
> allow me.Is that an expected behaviour? Maybe I am missing more options.
> (there is no opposite of "-ro")$ gdaladdo --debug on -clean out/test.tif
> GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.GTiff:
> ScanDirectories()GTiff: Opened 6978x5110 overview.GTiff: Opened 3489x2555
> overview.GTiff: Opened 1744x1277 overview.GTiff: Opened 872x638
> overview.GTiff: Opened 436x319 overview.GTiff: File open for read-only
> accessing, creating overviews externally.ERROR 6: test.tif: Cannot add
> external overviews when there are already internal overviewsCleaning
> overviews failed.GDAL: GDALClose(out/test.tif, this=0x133058e00)$ gdaladdo
> --versionGDAL 3.11.0 "Eganville", released 2025/05/06I am running it on a
> Mac.Cheers,Javier.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/5ef44d93/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 12 05:30:58 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 12 May 2025 12:30:58 +0000
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <CADRrdKvsXfxZHrha5QAOOxCDgwsMSVbx=QmSFVG6uhtxaE_mOA@mail.gmail.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
 <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CADRrdKvsXfxZHrha5QAOOxCDgwsMSVbx=QmSFVG6uhtxaE_mOA@mail.gmail.com>
Message-ID: <AS5PR09MB68979BCB68050B5D27D715C8FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>

Hi,

Can you reproduce even with these three commands:

gdal_create -outsize 1000 1000 test.tif
gdaladdo test.tif
gdaladdo -clean test.tif

If you can I fear the only solution is to say goodbye to Mac and switch to Windows ;)

-Jukka Rahkonen-
________________________________________
L?hett?j?: Javier Jimenez Shaw
L?hetetty: Maanantai 12. toukokuuta 2025 14.28
Vastaanottaja: Rahkonen Jukka
Kopio: gdal dev
Aihe: Re: [gdal-dev] I cannot clean overviews from GeoTIFF

Thanks Jukka. That was my first guess.However before sending the email I checked it. "ls -l" is telling me this (I understand I can modify it)$ ls -l out/test.tif -rw-r--r-- ?1 jshaw ?staff ?1356600907 May 12 11:38 out/test.tifOn Mon, 12 May 2025 at 12:40, Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi> wrote:Hi,Tested with GDAL 3.12.0dev-8130fe444e, released 2025/04/28 (OSGeo4W) on Windows.gdaladdo addo.tif -clean --debug on...GDAL: GDALOpen(addo.tif, this=000002E622185320) succeeds as GTiff.GTiff: ScanDirectories()GTiff: Opened 6000x6000 overview.GTiff: Opened 3000x3000 overview.GTiff: Opened 1500x1500 overview.GTiff: Opened 750x750 overview.GTiff: Opened 375x375 overview.GTiff: Opened 188x188 overview.GDAL: GDALClose(addo.tif, this=000002E622185320)However, if I set the test file "addo.tif" into read-only with file manager, I get the same messages than you do. Could it be that simple?-Jukka Rahkonen-________________________________________L?hett?j?: gdal-dev k?ytt?j?n Javier Jimenez Shaw via gdal-dev puolestaL?hetetty: Maanantai 12. toukokuuta 2025 13.01Vastaanottaja: gdal devAihe: [gdal-dev] I cannot clean overviews from GeoTIFFHiI am trying to clean the overviews from a GeoTIFF, but gdaladdo does not allow me.Is that an expected behaviour? Maybe I am missing more options. (there is no opposite of "-ro")$ gdaladdo --debug on -clean out/test.tif GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.GTiff: ScanDirectories()GTiff: Opened 6978x5110 overview.GTiff: Opened 3489x2555 overview.GTiff: Opened 1744x1277 overview.GTiff: Opened 872x638 overview.GTiff: Opened 436x319 overview.GTiff: File open for read-only accessing, creating overviews externally.ERROR 6: test.tif: Cannot add external overviews when there are already internal overviewsCleaning overviews failed.GDAL: GDALClose(out/test.tif, this=0x133058e00)$ gdaladdo --versionGDAL 3.11.0 "Eganville", released 2025/05/06I am running it on a Mac.Cheers,Javier.

From j1 at jimenezshaw.com  Mon May 12 06:48:58 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 12 May 2025 15:48:58 +0200
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <AS5PR09MB68979BCB68050B5D27D715C8FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
 <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CADRrdKvsXfxZHrha5QAOOxCDgwsMSVbx=QmSFVG6uhtxaE_mOA@mail.gmail.com>
 <AS5PR09MB68979BCB68050B5D27D715C8FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
Message-ID: <CADRrdKtO3rS-=ift82y2ABnmODZQCX2z+qwx8e98HZZWoGHgmg@mail.gmail.com>

Apparently it is related with COG:

$ gdal_translate -of COG foo.tif foo.cog.tif
Input file size is 1000, 1000
0...10...20...30...40...50...60...70...80...90...100 - done.

$ gdaladdo -clean --debug ON foo.cog.tif
GDAL: GDALOpen(foo.cog.tif, this=0x15900ae00) succeeds as GTiff.
GTiff: ScanDirectories()
GTiff: Opened 500x500 overview.
GTiff: File open for read-only accessing, creating overviews externally.
ERROR 6: foo.cog.tif: Cannot add external overviews when there are
already internal overviews
Cleaning overviews failed.
GDAL: GDALClose(foo.cog.tif, this=0x15900ae00)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/59dbb57c/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 12 07:20:07 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Mon, 12 May 2025 14:20:07 +0000
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <CADRrdKtO3rS-=ift82y2ABnmODZQCX2z+qwx8e98HZZWoGHgmg@mail.gmail.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
 <AS5PR09MB6897C0E44E41E5A043801A04FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CADRrdKvsXfxZHrha5QAOOxCDgwsMSVbx=QmSFVG6uhtxaE_mOA@mail.gmail.com>
 <AS5PR09MB68979BCB68050B5D27D715C8FD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>
 <CADRrdKtO3rS-=ift82y2ABnmODZQCX2z+qwx8e98HZZWoGHgmg@mail.gmail.com>
Message-ID: <AS5PR09MB68978498B910036488A7243BFD97A@AS5PR09MB6897.eurprd09.prod.outlook.com>

Hi,

So now we have the right question: how to remove overviews from cloud optimized GeoTIFF.

First confirm your findings:

gdal_create -of cog -outsize 1000 1000 cog.tif
0...10...20...30...40...50...60...70...80...90...100 - done.

test1:
gdaladdo cog.tif
ERROR 6: cog.tif: Cannot add external overviews when there are already internal overviews
Overview building failed.

test2
gdaladdo -clean cog.tif
ERROR 6: cog.tif: Cannot add external overviews when there are already internal overviews
Cleaning overviews failed.

All right, COG is a GeoTIFF and only metadata tells that it is also COG

Image Structure Metadata:
  LAYOUT=COG
  COMPRESSION=LZW
  INTERLEAVE=BAND

So, let's try to remove the metadata. No success but an interesting message:

gdal_edit -unsetmd cog.tif
File cog.tif has C(loud) O(ptimized) G(eoTIFF) layout. Updating it will generally result in losing part of the optimizations (but will still produce a valid GeoTIFF file). If this is acceptable, open the file with the IGNORE_COG_LAYOUT_BREAK open option set to YES.

Let's try the suggested option:

gdaladdo -clean cog.tif -oo IGNORE_COG_LAYOUT_BREAK=yes

Success!

Now it is your turn to suggest improvements to COG driver manual page and to the error messages of gdaladdo.

-Jukka Rahkonen-

________________________________________
L?hett?j?: Javier Jimenez Shaw
L?hetetty: Maanantai 12. toukokuuta 2025 16.48
Vastaanottaja: Rahkonen Jukka
Kopio: gdal dev
Aihe: Re: [gdal-dev] I cannot clean overviews from GeoTIFF

Apparently it is related with COG:$ gdal_translate -of COG foo.tif foo.cog.tifInput file size is 1000, 10000...10...20...30...40...50...60...70...80...90...100 - done.$ gdaladdo -clean --debug ON foo.cog.tif GDAL: GDALOpen(foo.cog.tif, this=0x15900ae00) succeeds as GTiff.GTiff: ScanDirectories()GTiff: Opened 500x500 overview.GTiff: File open for read-only accessing, creating overviews externally.ERROR 6: foo.cog.tif: Cannot add external overviews when there are already internal overviewsCleaning overviews failed.GDAL: GDALClose(foo.cog.tif, this=0x15900ae00)

From even.rouault at spatialys.com  Mon May 12 08:02:40 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 May 2025 17:02:40 +0200
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
Message-ID: <26ea6b91-4d03-487b-84d4-d21d65a45b3e@spatialys.com>

Fix in https://github.com/OSGeo/gdal/pull/12351

You can workaround the issue by adding -oo IGNORE_COG_LAYOUT_BREAK=YES 
(actually not needed for cleaning as this doesn't break the layout, but 
definitely needed for adding to a COG)

Le 12/05/2025 ? 12:01, Javier Jimenez Shaw via gdal-dev a ?crit?:
> Hi
>
> I am trying to clean the overviews from a GeoTIFF, but gdaladdo does 
> not allow me.
> Is that an expected behaviour? Maybe I am missing more options. (there 
> is no opposite of "-ro")
>
> $ gdaladdo --debug on -clean out/test.tif
> GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.
> GTiff: ScanDirectories()
> GTiff: Opened 6978x5110 overview.
> GTiff: Opened 3489x2555 overview.
> GTiff: Opened 1744x1277 overview.
> GTiff: Opened 872x638 overview.
> GTiff: Opened 436x319 overview.
> GTiff: File open for read-only accessing, creating overviews externally.
> ERROR 6: test.tif: Cannot add external overviews when there are already internal overviews
> Cleaning overviews failed.
> GDAL: GDALClose(out/test.tif, this=0x133058e00)
>
> $ gdaladdo --version
> GDAL 3.11.0 "Eganville", released 2025/05/06
>
> I am running it on a Mac.
> Cheers,
> Javier.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/ba6d2fb6/attachment.htm>

From j1 at jimenezshaw.com  Mon May 12 08:31:19 2025
From: j1 at jimenezshaw.com (Javier Jimenez Shaw)
Date: Mon, 12 May 2025 17:31:19 +0200
Subject: [gdal-dev] I cannot clean overviews from GeoTIFF
In-Reply-To: <26ea6b91-4d03-487b-84d4-d21d65a45b3e@spatialys.com>
References: <CADRrdKuJ5Vyh2BwpqvQRexhJ-dVTYmK6=PqtZXJe4dCAT3b31g@mail.gmail.com>
 <26ea6b91-4d03-487b-84d4-d21d65a45b3e@spatialys.com>
Message-ID: <CADRrdKv6HZLU8qLExNoaa-GwYocD97Bs=9bk8-eO9vyaK4rgZA@mail.gmail.com>

Thank you Even and Jukka!

On Mon, 12 May 2025 at 17:02, Even Rouault <even.rouault at spatialys.com>
wrote:

> Fix in https://github.com/OSGeo/gdal/pull/12351
>
> You can workaround the issue by adding -oo IGNORE_COG_LAYOUT_BREAK=YES
> (actually not needed for cleaning as this doesn't break the layout, but
> definitely needed for adding to a COG)
> Le 12/05/2025 ? 12:01, Javier Jimenez Shaw via gdal-dev a ?crit :
>
> Hi
>
> I am trying to clean the overviews from a GeoTIFF, but gdaladdo does not
> allow me.
> Is that an expected behaviour? Maybe I am missing more options. (there is
> no opposite of "-ro")
>
> $ gdaladdo --debug on -clean out/test.tif
> GDAL: GDALOpen(out/test.tif, this=0x133058e00) succeeds as GTiff.
> GTiff: ScanDirectories()
> GTiff: Opened 6978x5110 overview.
> GTiff: Opened 3489x2555 overview.
> GTiff: Opened 1744x1277 overview.
> GTiff: Opened 872x638 overview.
> GTiff: Opened 436x319 overview.
> GTiff: File open for read-only accessing, creating overviews externally.
> ERROR 6: test.tif: Cannot add external overviews when there are already internal overviews
> Cleaning overviews failed.
> GDAL: GDALClose(out/test.tif, this=0x133058e00)
>
> $ gdaladdo --version
> GDAL 3.11.0 "Eganville", released 2025/05/06
>
>
>
> I am running it on a Mac.
>
>
> Cheers,
>
> Javier.
>
>
>
> _______________________________________________
> gdal-dev mailing listgdal-dev at lists.osgeo.orghttps://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> -- http://www.spatialys.com
> My software is free, but my time generally not.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/224fc5fd/attachment-0001.htm>

From fengting.chen at oracle.com  Mon May 12 08:55:00 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Mon, 12 May 2025 15:55:00 +0000
Subject: [gdal-dev] GDAL 3.10.3 build question on Windows
Message-ID: <PH0PR10MB7061CD78321D90AAD5AD3B109397A@PH0PR10MB7061.namprd10.prod.outlook.com>

I am trying to build GDAL 3.10.3 on windows. There were no errors during the build, but somehow the python bindings were not installed to the specified directory (CMAKE_INSTALL_PREFIX). all other files are installed as expected.

Here is the part of the makefile:

build_gdal_binary:
                $(SILENT)$(ECHO) "Executing 'build_gdal'"
                $(CD) $(GDAL_HOME) \
                && $(RMRF) build; $(MKDIR) build \
                && $(CD) build \
                && $(CMAKE) .. -C ../$(GDAL_CMAKE_CONFIG) \
                && $(CMAKE) --build . --config Release \
                && $(CMAKE) --build . --config Release --target install

Where GDAL_CMAKE_CONFIG has the CMAKE_INSTALL_PREFIX and Python_ROOT set and BUILD_PYTHON_BINDINGS on.

Did I miss anything?

Thanks for your help!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250512/db4b2493/attachment.htm>

From howard at hobu.co  Mon May 12 09:16:31 2025
From: howard at hobu.co (Howard Butler)
Date: Mon, 12 May 2025 11:16:31 -0500
Subject: [gdal-dev] GDAL CLI Modernization Webinar June 3rd at 1400 UTC
Message-ID: <4EBF95F5-8CC2-4E01-83D3-CBA8B8393055@hobu.co>

The GDAL Project Steering Committee was pleased to announce the release of GDAL 3.11.0 on May 9th, 2025. The 2024 GDAL User Survey [1] showed the GDAL Command Line Interface (CLI) to be in need of modernization, and GDAL 3.11.0 is the first release to provide a substantial refactoring of the common interaction point of many with the nearly 27 year old software project. 

The new CLI, driven by sub-commands of the 'gdal' main program [2], is more convenient, consistent, predictable, and capable. It provides a GDAL spin on CLI concepts from rasterio, git, and others. Existing GDAL CLIs will continue to be supported as-is, but we hope the new CLI will make it easier to explore, learn, and reason about GDAL while manipulating geospatial data. In celebration of the release, Even Rouault, Dan Baston, Mike Smith, and Howard Butler of the GDAL project will be hosting a webinar to provide a deep dive into the new CLI on June 3rd at 1400 UTC.

The webinar will be recorded, but we hope you can join us live by registering at https://numfocus-org.zoom.us/webinar/register/WN_oW6mA6DNSKe8FUTm1-tkRQ

[1] https://gdal.org/en/stable/community/user_survey_2024.html
[2] https://gdal.org/en/latest/programs/index.html#gdal-application


From Matt.Wilkie at yukon.ca  Mon May 12 09:33:16 2025
From: Matt.Wilkie at yukon.ca (Matt.Wilkie)
Date: Mon, 12 May 2025 16:33:16 +0000
Subject: [gdal-dev] GDAL CLI Modernization Webinar June 3rd at 1400 UTC
In-Reply-To: <4EBF95F5-8CC2-4E01-83D3-CBA8B8393055@hobu.co>
References: <4EBF95F5-8CC2-4E01-83D3-CBA8B8393055@hobu.co>
Message-ID: <YT3PR01MB559049F1EF422E348C14B2E08797A@YT3PR01MB5590.CANPRD01.PROD.OUTLOOK.COM>

> The GDAL Project Steering Committee was pleased to announce the release of GDAL 3.11.0 on May 9th, 2025. The 2024 GDAL User Survey [1] showed the GDAL Command Line Interface (CLI) to be in need of modernization, and GDAL 3.11.0 is the first release to provide a substantial refactoring of the common interaction point of many with the nearly 27 year old software project. 
>
>The new CLI, driven by sub-commands of the 'gdal' main program [2], is more convenient, consistent, predictable, and capable.

This is absolutely awesome news. I'm so glad to hear of it! I will happily shred my n-pages of notes on gdal cli changes I've made for "someday when I have time (and skill)". Unfortunately on webinar day I will be travelling but will certainly come back for the recording later.

Go team GDAL!

Matt?Wilkie
Geomatics Developer and Administrator | Environment | T 867-667-8133 | Yukon.ca?

From even.rouault at spatialys.com  Tue May 13 11:55:20 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 May 2025 20:55:20 +0200
Subject: [gdal-dev] GDAL 3.11.0 "Eganville" is released
In-Reply-To: <ada4728f-611d-46b6-bacb-6dbfde002e6f@spatialys.com>
References: <ada4728f-611d-46b6-bacb-6dbfde002e6f@spatialys.com>
Message-ID: <d560aa7c-94cc-44ca-9b64-21e7a849f393@spatialys.com>

Hi,

quick update:

- GDAL in conda-forge channel has just?been updated to 3.11.0

- Docker images of 3.11.0 are available: 
https://github.com/OSGeo/gdal/tree/master/docker#images-of-releases

Even

Le 09/05/2025 ? 18:34, Even Rouault via gdal-dev a ?crit?:
> Hi,
>
> On behalf of the GDAL/OGR development team and community, I am pleased 
> to announce the release of GDAL/OGR 3.11.0. GDAL/OGR is a C++ 
> geospatial data access library for raster and vector file formats, 
> databases and web services. It includes bindings for several 
> languages, and a variety of command line tools.
>
> http://gdal.org/
>
> The 3.11.0 release is a new feature release with the following 
> highlights:
>
> * [RFC 
> 104](https://gdal.org/en/latest/development/rfc/rfc104_gdal_cli.html): 
> <b>Adding a "gdal" front-end command line interface</b>.
> ? - See the [list of 
> commands](https://gdal.org/en/latest/programs/index.html#gdal-application)
> ? - Includes new "gdal raster calc" and "gdal raster resclassify" 
> utilities.
> ? - "gdal raster tile", C++ port of gdal2tiles, runs faster (3x to 6x 
> in some cases)
> ? - Includes "gdal vsi list/copy/delete/move/sync" (ports of Python 
> sample scripts)
> ? - Includes "gdal driver {driver_name}" for driver-specific commands.
> ? - Includes smart Bash autocompletion
> ? - Includes C, C++, Python API
> * Add [GDALG](https://gdal.org/en/latest/drivers/vector/gdalg.html) 
> (GDAL Streamed Algorithm Format) driver: reading of on-the-fly / 
> streamed vector dataset replaying compatible "gdal" command lines 
> (kind of VRT).
>
> Other topics
>
> * [RFC 
> 100](https://gdal.org/en/latest/development/rfc/rfc100_float16_support.html): 
> Support float16 type
> * [RFC 
> 102](https://gdal.org/en/latest/development/rfc/rfc102_embedded_resources.html): 
> Embedding resource files into libgdal
> * [RFC 
> 103](https://gdal.org/en/latest/development/rfc/rfc103_schema_open_option.html): 
> Add a OGR_SCHEMA open option to selected OGR drivers
> * [RFC 
> 105](https://gdal.org/en/latest/development/rfc/rfc105_safe_path_manipulation_functions.html): 
> Add and use safe path manipulation functions
> * [RFC 
> 106](https://gdal.org/en/latest/development/rfc/rfc106_update_metadata.html): 
> Metadata items to reflect driver update capabilities
> * [RFC 
> 107](https://gdal.org/en/latest/development/rfc/rfc107_igetextent_isetspatialfilter.html): 
> Add OGRLayer::IGetExtent() and OGRLayer::ISetSpatialFilter()
> * Add read-only [OGR 
> ADBC](https://gdal.org/en/latest/drivers/vector/adbc.html) (Arrow 
> Database Connectivity) driver, in particular
> ? with support for DuckDB or Parquet datasets (if libduckdb also 
> installed)
> * Add 
> [LIBERTIFF](https://gdal.org/en/latest/drivers/raster/libertiff.html) 
> driver: native thread-safe read-only GeoTIFF reader
> * Add read-only 
> [RCM](https://gdal.org/en/latest/drivers/raster/rcm.html) (Radarsat 
> Constellation Mission) raster driver
> * Add read-only AIVector (Artificial intelligence powered vector) driver
> * VRT Pixel Functions: Add function to evaluate arbitrary expression 
> (#11209)
> * Substantially improved drivers: 
> [ZARR](https://gdal.org/en/latest/drivers/raster/zarr.html), with 
> support for Kerchunk JSON and Parquet reference stores
> * GeoPackage: change default version to GeoPackage 1.4 on creation 
> (#7870)
> * [RFC 
> 108](https://gdal.org/en/latest/development/rfc/rfc108_driver_removal_3_11.html):
> ? - Removed raster drivers: BLX, BT, CTable2, ELAS, FIT, GSAG (Golden 
> Software ASCII grid),? GSBG (Golden Software 6.0 binary grid), 
> JP2Lura, OZI OZF2/OZFX3,? Rasterlite (v1), R object data store (.rda), 
> RDB, SDTS, SGI, XPM, DIPex
> ? - Removed vector drivers: Geoconcept Export, OGDI (VPF/VMAP 
> support), SDTS, SVG, Tiger, UK. NTF
> ? - Removed write support in following drivers: Interlis 1, Interlis 
> 2, ADRG,? PAux, MFF, MFF2/HKV, LAN, NTv2, BYN, USGSDEM, ISIS2
> * Removed OpenCL warper
> * OGR "Memory" driver deprecated, and aliased to the "MEM" driver. Its 
> functionality is merged into the "MEM" driver that has raster, vector
> ? and multidimensional support.
> * Various code linting, static code analyzer fixes, etc.
> * Bump of shared lib major version
>
> New optional dependencies:
>
> * [muparser](https://github.com/beltoforion/muparser) is *strongly* 
> recommended to be added as a build and runtime dependency, to provide 
> nominal support for C++ VRT expressions.
> * [exprtk](https://github.com/ArashPartow/exprtk) may be added as a 
> build dependency (this is a header-only library) to provide support 
> for advanced C++ VRT expressions. Note that it causes an increase in 
> libgdal size of about 8 MB. exprtk support is recommended to be an 
> addition to muparser support, not as a replacement.
>
> More complete information on the new features and fixes in the 3.11.0 
> release can be found at:
>
> https://github.com/OSGeo/gdal/blob/v3.11.0/NEWS.md
>
> Please also consult the migration guide when updating from prior 
> releases:
>
> https://github.com/OSGeo/gdal/blob/v3.11.0/MIGRATION_GUIDE.TXT
>
> The release can be downloaded from:
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz - source 
> as .tar.gz
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz.md5 - 
> md5sum
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.gz.sig - 
> signature
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz - source 
> as .tar.xz
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz.md5 - 
> md5sum
> ? * https://download.osgeo.org/gdal/3.11.0/gdal-3.11.0.tar.xz.sig - 
> signature
> ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip - source as a zip
> ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip.md5 - md5sum
> ? * https://download.osgeo.org/gdal/3.11.0/gdal3110.zip.sig - signature
> ? * https://download.osgeo.org/gdal/3.11.0/gdalautotest-3.11.0.tar.gz 
> - test suite
> ? * https://download.osgeo.org/gdal/3.11.0/gdal3110doc.zip - 
> documentation / website
>
> Docker images are currently cooking and should be ready in one day or so.
>
> Best regards,
>
> Even
>
-- 
http://www.spatialys.com
My software is free, but my time generally not.


From andrew.bell.ia at gmail.com  Wed May 14 10:45:52 2025
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 14 May 2025 13:45:52 -0400
Subject: [gdal-dev] RFCs
Message-ID: <CACJ51z1mdTGiv6qZPw-wjdaWUs0SPaFRa_yT858wY03Kp=MUuA@mail.gmail.com>

Hi,

I was wondering if some of the RFCs should be placed somewhere other than
on the web site because they are obsolete/superseded. I think this would
make it easier to find relevant current information. Some of the RFCs are
marked as superseded, but from the standpoint of a web search, the more
there is to read through, the less likely that I'll find the correct
information that I'm looking for.

Thoughts?

-- 
Andrew Bell
andrew.bell.ia at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/f37af493/attachment.htm>

From even.rouault at spatialys.com  Wed May 14 10:54:06 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 May 2025 19:54:06 +0200
Subject: [gdal-dev] RFCs
In-Reply-To: <CACJ51z1mdTGiv6qZPw-wjdaWUs0SPaFRa_yT858wY03Kp=MUuA@mail.gmail.com>
References: <CACJ51z1mdTGiv6qZPw-wjdaWUs0SPaFRa_yT858wY03Kp=MUuA@mail.gmail.com>
Message-ID: <379eb688-554e-4373-b88c-d66e743c93cd@spatialys.com>

Hi Andrew,

Can you be more specific about which RFCs ?? Quick grep shows RFC9 
superseded per RFC83 and RFC68 superseded per RFC98.

If that can help, we could potentially keep in master a mostly empty 
document for superseded RFCs that would contain just a link to the new 
RFC and a link to the supersed text pointing at 
https://gdal.org/en/release-{last-one-with-the-full-text}/development/rfc/rfc-XXXX.html

Even

Le 14/05/2025 ? 19:45, Andrew Bell via gdal-dev a ?crit?:
> Hi,
>
> I was wondering if some of the RFCs should be placed somewhere other 
> than on the web site because they are obsolete/superseded. I think 
> this would make it easier to find relevant current information. Some 
> of the RFCs are marked as superseded, but from the standpoint of a web 
> search, the more there is to read through, the less likely that I'll 
> find the correct information that I'm looking for.
>
> Thoughts?
>
> -- 
> Andrew Bell
> andrew.bell.ia at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/95eb778a/attachment.htm>

From fengting.chen at oracle.com  Wed May 14 13:58:10 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Wed, 14 May 2025 20:58:10 +0000
Subject: [gdal-dev] libgdal.so.36 refers to sqlite library with full path
Message-ID: <PH0PR10MB70619ED0A7A9E69272C6C9739391A@PH0PR10MB7061.namprd10.prod.outlook.com>

Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was successful on linux. But there are two entries of reference to sqlite3, and one of it has the absolution path.

> ldd libgdal.so.36 | grep sqlite
ldd: warning: you do not have execution permission for `./libgdal.so.36'
        /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7e08168000)
        libsqlite3.so => / scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7dfb00e000)

Why is above listing having a full path of libsqlite3.so built in the libgdal.so.36?

The configuration for the cmake for GDAL is:

set (SQLite3_INCLUDE_DIR          "$(SQLITE3_DIST_DIR)/         include" CACHE PATH "" FORCE)
set (SQLite3_LIBRARY              "$(SQLITE3_DIST_DIR)/lib/     $(LIBSQLITE3)" CACHE PATH "" FORCE)

At the sqlite lib directory, it has:
libsqlite3.a    libsqlite3.so.0@       pkgconfig/
libsqlite3.so@  libsqlite3.so.3.49.2*

Is this sqlite3 build issue or GDAL build issue?

Thanks.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/41950190/attachment.htm>

From even.rouault at spatialys.com  Wed May 14 14:03:21 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 May 2025 23:03:21 +0200
Subject: [gdal-dev] libgdal.so.36 refers to sqlite library with full path
In-Reply-To: <PH0PR10MB70619ED0A7A9E69272C6C9739391A@PH0PR10MB7061.namprd10.prod.outlook.com>
References: <PH0PR10MB70619ED0A7A9E69272C6C9739391A@PH0PR10MB7061.namprd10.prod.outlook.com>
Message-ID: <0cc12358-be6e-4619-b2b5-3915837e0802@spatialys.com>

Maybe another library that GDAL is depending on is linked against the 
system sqlite3 and not your custom build ? That could be PROJ typically

Le 14/05/2025 ? 22:58, Fengting Chen via gdal-dev a ?crit?:
>
> Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was 
> successful on linux. But there are two entries of reference to 
> sqlite3, and one of it has the absolution path.
>
> > ldd libgdal.so.36 | grep sqlite
>
> ldd: warning: you do not have execution permission for `./libgdal.so.36'
>
> /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so 
> (0x00007f7e08168000)
>
> libsqlite3.so => / 
> scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so 
> (0x00007f7dfb00e000)
>
> *Why is above listing having a full path of libsqlite3.so built in the 
> libgdal.so.36? *
>
> The configuration for the cmake for GDAL is:
>
> set (SQLite3_INCLUDE_DIR????????? "$(SQLITE3_DIST_DIR)/ include" CACHE 
> PATH "" FORCE)
>
> set (SQLite3_LIBRARY????????????? "$(SQLITE3_DIST_DIR)/lib/ 
> $(LIBSQLITE3)" CACHE PATH "" FORCE)
>
> At the sqlite lib directory, it has:
>
> libsqlite3.a libsqlite3.so.0@?????? pkgconfig/
>
> libsqlite3.so@ libsqlite3.so.3.49.2*
>
> Is this sqlite3 build issue or GDAL build issue?
>
> Thanks.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/412e9e77/attachment.htm>

From fengting.chen at oracle.com  Wed May 14 15:10:19 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Wed, 14 May 2025 22:10:19 +0000
Subject: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite
 library with full path
In-Reply-To: <0cc12358-be6e-4619-b2b5-3915837e0802@spatialys.com>
References: <PH0PR10MB70619ED0A7A9E69272C6C9739391A@PH0PR10MB7061.namprd10.prod.outlook.com>
 <0cc12358-be6e-4619-b2b5-3915837e0802@spatialys.com>
Message-ID: <PH0PR10MB7061BC2F194587684E836EE49391A@PH0PR10MB7061.namprd10.prod.outlook.com>

Both GDAL and PROJ refer to my custom build sqlite3 library. The sqlite3 entry in PROJ library looks normal, that is, just the library name without path.

My concern is that libgdal.so has libsqlite3.so with full path. How could this happen? How do I remove this?

From: Even Rouault <even.rouault at spatialys.com>
Date: Wednesday, May 14, 2025 at 5:04?PM
To: Fengting Chen <fengting.chen at oracle.com>, gdal-dev <gdal-dev at lists.osgeo.org>
Subject: [External] : Re: [gdal-dev] libgdal.so.36 refers to sqlite library with full path

Maybe another library that GDAL is depending on is linked against the system sqlite3 and not your custom build ? That could be PROJ typically
Le 14/05/2025 ? 22:58, Fengting Chen via gdal-dev a ?crit :
Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was successful on linux. But there are two entries of reference to sqlite3, and one of it has the absolution path.

> ldd libgdal.so.36 | grep sqlite
ldd: warning: you do not have execution permission for `./libgdal.so.36'
        /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7e08168000)
        libsqlite3.so => / scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7dfb00e000)

Why is above listing having a full path of libsqlite3.so built in the libgdal.so.36?

The configuration for the cmake for GDAL is:

set (SQLite3_INCLUDE_DIR          "$(SQLITE3_DIST_DIR)/         include" CACHE PATH "" FORCE)
set (SQLite3_LIBRARY              "$(SQLITE3_DIST_DIR)/lib/     $(LIBSQLITE3)" CACHE PATH "" FORCE)

At the sqlite lib directory, it has:
libsqlite3.a    libsqlite3.so.0@       pkgconfig/
libsqlite3.so@  libsqlite3.so.3.49.2*

Is this sqlite3 build issue or GDAL build issue?

Thanks.




_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i14PHNK2$>

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i4kI3dZu$>

My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/3dcb10b3/attachment-0001.htm>

From andrew.bell.ia at gmail.com  Wed May 14 15:46:33 2025
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 14 May 2025 18:46:33 -0400
Subject: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite
 library with full path
In-Reply-To: <PH0PR10MB7061BC2F194587684E836EE49391A@PH0PR10MB7061.namprd10.prod.outlook.com>
References: <PH0PR10MB70619ED0A7A9E69272C6C9739391A@PH0PR10MB7061.namprd10.prod.outlook.com>
 <0cc12358-be6e-4619-b2b5-3915837e0802@spatialys.com>
 <PH0PR10MB7061BC2F194587684E836EE49391A@PH0PR10MB7061.namprd10.prod.outlook.com>
Message-ID: <CACJ51z29RZDffDUHutH7j7_APKbe+2onBU=jqx6dSEcNFjDBoQ@mail.gmail.com>

You can use patchelf or a similar program to modify dependencies.

--
Andrew Bell
andrew.bell.ia at gmail.com

On Wed, May 14, 2025, 6:10?PM Fengting Chen via gdal-dev <
gdal-dev at lists.osgeo.org> wrote:

> Both GDAL and PROJ refer to my custom build sqlite3 library. The sqlite3
> entry in PROJ library looks normal, that is, just the library name without
> path.
>
>
>
> My concern is that libgdal.so has libsqlite3.so with full path. How could
> this happen? How do I remove this?
>
>
>
> *From: *Even Rouault <even.rouault at spatialys.com>
> *Date: *Wednesday, May 14, 2025 at 5:04?PM
> *To: *Fengting Chen <fengting.chen at oracle.com>, gdal-dev <
> gdal-dev at lists.osgeo.org>
> *Subject: *[External] : Re: [gdal-dev] libgdal.so.36 refers to sqlite
> library with full path
>
> Maybe another library that GDAL is depending on is linked against the
> system sqlite3 and not your custom build ? That could be PROJ typically
>
> Le 14/05/2025 ? 22:58, Fengting Chen via gdal-dev a ?crit :
>
> Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was
> successful on linux. But there are two entries of reference to sqlite3, and
> one of it has the absolution path.
>
>
>
> > ldd libgdal.so.36 | grep sqlite
>
> ldd: warning: you do not have execution permission for `./libgdal.so.36'
>
>         /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so
> (0x00007f7e08168000)
>
>         libsqlite3.so => /
> scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so
> (0x00007f7dfb00e000)
>
>
>
> *Why is above listing having a full path of libsqlite3.so built in the
> libgdal.so.36? *
>
>
>
> The configuration for the cmake for GDAL is:
>
>
>
> set (SQLite3_INCLUDE_DIR          "$(SQLITE3_DIST_DIR)/         include"
> CACHE PATH "" FORCE)
>
> set (SQLite3_LIBRARY              "$(SQLITE3_DIST_DIR)/lib/
> $(LIBSQLITE3)" CACHE PATH "" FORCE)
>
>
>
> At the sqlite lib directory, it has:
>
> libsqlite3.a    libsqlite3.so.0@       pkgconfig/
>
> libsqlite3.so@  libsqlite3.so.3.49.2*
>
>
>
> Is this sqlite3 build issue or GDAL build issue?
>
>
>
> Thanks.
>
>
>
>
>
> _______________________________________________
>
> gdal-dev mailing list
>
> gdal-dev at lists.osgeo.org
>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i14PHNK2$>
>
> --
>
> http://www.spatialys.com <https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i4kI3dZu$>
>
> My software is free, but my time generally not.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250514/dcadd08d/attachment.htm>

From shawn.fox at baesystems.us  Wed May 14 17:54:28 2025
From: shawn.fox at baesystems.us (Fox, Shawn D (US))
Date: Thu, 15 May 2025 00:54:28 +0000
Subject: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite
 library with full path
In-Reply-To: <CACJ51z29RZDffDUHutH7j7_APKbe+2onBU=jqx6dSEcNFjDBoQ@mail.gmail.com>
Message-ID: <BNAP110MB19347CF28C47871AD4A0777FFE90A@BNAP110MB1934.NAMP110.PROD.OUTLOOK.COM>

I reported the same problem recently, but I determined in my case that the problem was my build of libsqlite3 which for some reason was missing the SONAME attribute from the binary. This had the effect of the CMAKE build of GDAL containing the absolute path of libsqlite3 in the libgdal.so file.

Try this to test whether you are having a similar problem. This was done on my rebuilt libsqlite3 library and the attribute is present.  If it is missing in yours then that could cause the problem.  I?m not exactly sure why, but troubleshooting the cmake build is awfully difficult.

objdump -p libsqlite3.so | grep SONAME
  SONAME               libsqlite3.so.0

To fix it, I rebuilt my libsqlite3 binary, but you could patch that file to add in the attribute or rebuild it with the correct compiler options to create the attribute. You could also patch the gdal library after the build.

To use patchelf to add a SONAME. ?patchelf --set-soname libsqlite3.so.3 libsqlite3.so?

The line in my Makefile for RHEL8 to build it with the soname looks like this, $(CC) $(CFLAGS) -shared sqlite3.o -Wl,-soname,libsqlite3.so.0 -o $(LIBS)/libsqlite3.so

After doing that and rebuilding GDAL the libgdal.so file was as I expected with no absolute path to libsqlite3.so.  I preferred to fix the root cause and stored the corrected libsqlite3 binary in our local repository so that I don?t have to keep patching libgdal after every build.

ldd libgdal.so | grep libsqlite3
libsqlite3.so.0 => /lib64/libsqlite3.so.0 (0x00007fcdab1d7000)

I hope that helps you.  That is how I solved the same kind of problem in my case while building GDAL 3.7.0.

Thanks,
Shawn Fox

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Andrew Bell via gdal-dev
Sent: Wednesday, May 14, 2025 3:47 PM
To: Fengting Chen <fengting.chen at oracle.com>
Cc: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite library with full path

External Email Alert
This email has been sent from an account outside of the BAE Systems network.
Please treat the email with caution, especially if you are requested to click on a link, decrypt/open an attachment, or enable macros.  For further information on how to spot phishing, access ?Cybersecurity OneSpace Page? and report phishing by clicking the button ?Report Phishing? on the Outlook toolbar.

You can use patchelf or a similar program to modify dependencies.

--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>

On Wed, May 14, 2025, 6:10?PM Fengting Chen via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> wrote:
Both GDAL and PROJ refer to my custom build sqlite3 library. The sqlite3 entry in PROJ library looks normal, that is, just the library name without path.

My concern is that libgdal.so has libsqlite3.so with full path. How could this happen? How do I remove this?

From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Date: Wednesday, May 14, 2025 at 5:04?PM
To: Fengting Chen <fengting.chen at oracle.com<mailto:fengting.chen at oracle.com>>, gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: [External] : Re: [gdal-dev] libgdal.so.36 refers to sqlite library with full path

Maybe another library that GDAL is depending on is linked against the system sqlite3 and not your custom build ? That could be PROJ typically
Le 14/05/2025 ? 22:58, Fengting Chen via gdal-dev a ?crit :
Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was successful on linux. But there are two entries of reference to sqlite3, and one of it has the absolution path.

> ldd libgdal.so.36 | grep sqlite
ldd: warning: you do not have execution permission for `./libgdal.so.36'
        /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7e08168000)
        libsqlite3.so => / scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7dfb00e000)

Why is above listing having a full path of libsqlite3.so built in the libgdal.so.36?

The configuration for the cmake for GDAL is:

set (SQLite3_INCLUDE_DIR          "$(SQLITE3_DIST_DIR)/         include" CACHE PATH "" FORCE)
set (SQLite3_LIBRARY              "$(SQLITE3_DIST_DIR)/lib/     $(LIBSQLITE3)" CACHE PATH "" FORCE)

At the sqlite lib directory, it has:
libsqlite3.a    libsqlite3.so.0@       pkgconfig/
libsqlite3.so@  libsqlite3.so.3.49.2*

Is this sqlite3 build issue or GDAL build issue?

Thanks.



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i14PHNK2$>

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i4kI3dZu$>

My software is free, but my time generally not.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/27b4576e/attachment-0001.htm>

From shawn.fox at baesystems.us  Wed May 14 18:00:16 2025
From: shawn.fox at baesystems.us (Fox, Shawn D (US))
Date: Thu, 15 May 2025 01:00:16 +0000
Subject: [gdal-dev] How can I avoid absolute path to shared libraries in
 libgdal.so
In-Reply-To: <CACJ51z2C1tg5pezKQwEbCu96VNqkzu+P10P20bFZXvpveeUhwQ@mail.gmail.com>
Message-ID: <BNAP110MB1934E652921A15D2EBB3E06DFE90A@BNAP110MB1934.NAMP110.PROD.OUTLOOK.COM>

I determined in my case that the problem was my build of libsqlite3 which for some reason was missing the SONAME attribute from the binary. This had the effect of the CMAKE build of GDAL containing the absolute path of libsqlite3 in the libgdal.so file.  I thought I?d share the details of how I fixed the issue for my situation in case it will help someone else in the future who searches the archives.

Try this to test whether you are having a similar problem. This was done on my rebuilt libsqlite3 library and the attribute is present as it should be.  If it is missing in yours then that could cause the problem.

objdump -p libsqlite3.so | grep SONAME
  SONAME               libsqlite3.so.0

To fix it, I rebuilt my libsqlite3 binary, but you could patch that file to add in the attribute or rebuild it with the correct compiler options to create the attribute. You could also patch the gdal library after the build.

To use patchelf to add a SONAME. ?patchelf --set-soname libsqlite3.so.3 libsqlite3.so?

The line in my Makefile for RHEL8 to build it with the soname looks like this, $(CC) $(CFLAGS) -shared sqlite3.o -Wl,-soname,libsqlite3.so.0 -o $(LIBS)/libsqlite3.so

After doing that and rebuilding GDAL the libgdal.so file was as I expected with no absolute path to libsqlite3.so.  I preferred to fix the root cause and stored the corrected libsqlite3 binary in our local repository so that I don?t have to keep patching libgdal after every build.

ldd libgdal.so | grep libsqlite3
libsqlite3.so.0 => /lib64/libsqlite3.so.0 (0x00007fcdab1d7000)

I?ve no idea why that issue with the libsqlite3 library would affect the cmake build of gdal, but it did.

Thanks,
Shawn Fox

From: Andrew Bell <andrew.bell.ia at gmail.com>
Sent: Wednesday, April 30, 2025 11:59 AM
To: Fox, Shawn D (US) <shawn.fox at baesystems.us>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] How can I avoid absolute path to shared libraries in libgdal.so

External Email Alert
This email has been sent from an account outside of the BAE Systems network.
Please treat the email with caution, especially if you are requested to click on a link, decrypt/open an attachment, or enable macros.  For further information on how to spot phishing, access ?Cybersecurity OneSpace Page? and report phishing by clicking the button ?Report Phishing? on the Outlook toolbar.

Shawn,

Without details on your build configuration, it's not going to be easy to figure out what's up. I wouldn't spend time looking at cmake-generated makefiles. cmake works, so if you've having issues, it's because you haven't properly told cmake where to find things in a way that generates the library in a way that you're happy with. In general, if your dependencies are in some common location, you can just set CMAKE_PREFIX_PATH to that location to tell cmake where to find things, but if your dependencies are in various places on the system, you may need to add multiple directories or, as your doing, specify each separately. I would advise against using LD_LIBRARY_PATH since it's outside the cmake configuration process (I think).

That said, you can use a tool like `patchelf` to modify the DT_NEEDED entries of a library in any way you like.

Best,

On Wed, Apr 30, 2025 at 1:43?PM Fox, Shawn D (US) via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> wrote:
Greg, I appreciate the reply, but this is not windows specific.  The subject line is referring to libgdal.so which would not be the library name produced on a windows 10 system.  I used powershell because I also build GDAL for Windows and writing powershell commands allows me to write very similar commands across platforms. This problem I've described is only happening on the Linux platform using Red Hat Enterprise Linux version 8. I'm sure a lot of people have opinions about the concept of rpath vs using LD_LIBRARY_PATH.  I'm not interested in discussing that.  Our team does have a complicated application build and distribution process, and it isn't useful to try and explain that.  The only thing that really matters is that I have to build libgdal.so with no absolute paths to any dependency baked into libgdal.so, and I'm asking  for some help to accomplish that with this new cmake build system.  So far I haven't found anything at gdal.org<http://gdal.org> that helps to explain the behavior I'm obser
 ving, and the generated build files are awfully difficult to read. So if anyone has had similar issues since the build system changed to cmake or has any advice on how to read through the generated build files to find the commands being used for linking I'd appreciate any tips. At this point I'm using grep on the build output to search for clues, and I haven't found any yet.

Evidently, the -DSQLite3_LIBRARY="$SQLITE_LIB" has to have the full path to the library file in the variable, otherwise a build failure occurs.  Yet if I put the full path into it as required then the GDAL build system bakes it into libgdal.so.  That behavior does not occur for any other dependency. My guess is that the build system is generating the dash upper and lower case linker options differently for sqlite but I can't figure out why or what I need to do to manipulate it to generate what I need.

I set up the cmake commands using examples from the website and then read the build instructions to set the paths to all dependencies that I need just as the instructions state that I should. According to it, there are specific variables for each plugin that have to be set in the cmake command to generate the build system so my cmake command sare modeled with those instructions.
https://gdal.org/en/stable/development/building_from_source.html

The GDAL build will not succeed for me on RHEL8 without specifying all of the library paths within LD_LIBRARY_PATH, and that is in addition to putting the full path into all of the variables used in the first cmake command to generate the build system.  It seems to be necessary in order for the linking to succeed.

Thanks

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> On Behalf Of Greg Troxel via gdal-dev
Sent: Tuesday, April 29, 2025 4:23 PM
To: Fox, Shawn D (US) via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] How can I avoid absolute path to shared libraries in libgdal.so

External Email Alert

This email has been sent from an account outside of the BAE Systems network.

Please treat the email with caution, especially if you are requested to click on a link, decrypt/open an attachment, or enable macros.  For further information on how to spot phishing, access "Cybersecurity OneSpace Page" and report phishing by clicking the button "Report Phishing" on the Outlook toolbar.


"Fox, Shawn D (US) via gdal-dev" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> writes:

> ldd libgdal.so
>         linux-vdso.so.1 (0x00007ffe0e3f7000)
>         libdl.so.2 => /lib64/libdl.so.2 (0x00007feaca6a6000)
>         libcurl.so.4 => /lib64/libcurl.so.4 (0x00007feaca417000)
>         libproj.so.22 => not found
>         libexpat.so.1 => /lib64/libexpat.so.1 (0x00007feaca1db000)
>         libxerces-c-3.1.so<http://libxerces-c-3.1.so> => not found
>
> /data/third_party_unzip/exp/SQLite/SQLite-3.23.1/lib/libsqlite3.so =>
> not found

[incorrect line wrapping fixed]

I am puzzled by your approach and problems.   Normally you would either
expect

  dependencies to be provided by a packaging system (such as a
  "distribution"), and then expect to have to have that set of packages
  installed, resulting in the same files at the same paths

or

  construct your own packaging where you build those deps first and then
  gdal, to some prefix


but it seems like you have built gdal on one system and are trying to run it on a system with different contents.

> Notice that the only absolute path is for sqlite3.  I had to specify

That is odd.  I'd expect that this is the result of

  -l/data/third_party_unzip/exp/SQLite/SQLite-3.23.1/lib/libsqlite3.so

being passed tot he linker.

> the full path to all dependencies but only the full path to sqlite is
> embedded into the .so file. This is a major problem since now GDAL
> will not load at run-time unless libsqlite exists on the system at
> that exact location. I'm supplying absolute paths to the location of
> all dependencies in the cmake command to generate the build directory.
> Does anyone know why sqlite would be linked differently? So far I'm
> searching through the build directory for references but I haven't
> found a reason or the behavior yet.  The build instructions at
> gdal.org<http://gdal.org> seem straightforward so I don't see anything on that site
> that explains the behavior.  I'm guessing it relates to how the build
> files are generated by the gdal build system. I don't want the
> absolute path to anything baked into libgdal.so.

Generally one needs -L and -R for the dirs that have the libs, and -l for libnames.

> My Cmake command to generate the build looks like this, and I'm also
> putting path to all dependencies into LD_LIBRARY_PATH first. I didn't
> think it would help to show all of the paths since they'd be different
> on other Linux systems.  Bases on this I'm failing to understand why
> the dependencies are not linked in consistently.  I'm building GDAL
> using powershell commands.
>
> $Env:LD_LIBRARY_PATH="${CURL_LIB_DIR}:${SQLITE_LIB_DIR}:${EXPAT_LIB_DIR}:${PROJ_LIB_DIR}:${XERCES_LIB_DIR}:${OPENSSL_LIB_DIR}:${Env:LD_LIBRARY_PATH}"

I don't think it's good to use LD_LIBRARY_PATH.  That's working around -L/-R not being correct.

> cmake -S . -B ../build/$CONFIGL -DCMAKE_INSTALL_PREFIX="../install/$CONFIGL" -DCMAKE_BUILD_TYPE="$CONFIG" `
>   -DGDAL_USE_OPENSSL=OFF -DGDAL_USE_EXTERNAL_LIBS:BOOL=OFF `
>   -DOPENSSL_ROOT_DIR="$OPENSSL_ROOT_DIR" `
>   -DPROJ_INCLUDE_DIR="$PROJ_INCLUDE" -DPROJ_LIBRARY_RELEASE="$PROJ_LIB" `
>   -DGDAL_USE_CURL=ON -DCURL_INCLUDE_DIR="$CURL_INCLUDE" -DCURL_LIBRARY_RELEASE="$CURL_LIB" `
>   -DGDAL_USE_XERCESC=ON -DXercesC_INCLUDE_DIR="$XERCES_INCLUDE" -DXercesC_LIBRARY="$XERCES_LIB" `
>   -DGDAL_USE_EXPAT=ON -DEXPAT_INCLUDE_DIR="$EXPAT_INCLUDE" -DEXPAT_LIBRARY="$EXPAT_LIB" `
>   -DGDAL_USE_SQLITE3=ON -DSQLite3_INCLUDE_DIR="$SQLITE_INCLUDE" -DSQLite3_LIBRARY="$SQLITE_LIB" `
>   -DACCEPT_MISSING_SQLITE3_MUTEX_ALLOC:BOOL=ON -DACCEPT_MISSING_SQLITE3_RTREE:BOOL=ON `
>   2>&1 | tee cmake_configure_${PLATFORM}_${TOOLSET}_${CONFIGL}.txt

I find that cmake tends to hide the actual build lines by default, and that one needs to remediate this with some kind of verbose option, and then you can see what the values of cmake variables are and what the actual compiler/linker flags are.

It could be that you are running into Windows-specific trouble, about which I know very little.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/f6c507ea/attachment-0001.htm>

From fengting.chen at oracle.com  Wed May 14 21:03:10 2025
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 15 May 2025 04:03:10 +0000
Subject: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite
 library with full path
In-Reply-To: <BNAP110MB19347CF28C47871AD4A0777FFE90A@BNAP110MB1934.NAMP110.PROD.OUTLOOK.COM>
References: <CACJ51z29RZDffDUHutH7j7_APKbe+2onBU=jqx6dSEcNFjDBoQ@mail.gmail.com>
 <BNAP110MB19347CF28C47871AD4A0777FFE90A@BNAP110MB1934.NAMP110.PROD.OUTLOOK.COM>
Message-ID: <PH0PR10MB7061EAEC0309769E8CB6AA7D9390A@PH0PR10MB7061.namprd10.prod.outlook.com>

Thanks a lot for Shawn?s reply. Yes, you pointed out the root cause for it. I added ?--soname=legacy? to the sqlite3 configure command line and it created libsqlite3.so with SONAME. I did try to add this soname option earlier but didn?t delete the .o files and there was nothing changed.  Your detailed reply made me realize that this flag also affects the compilation.    Thanks again!

I also want to thank other repliers for your help!

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Fox, Shawn D (US) via gdal-dev <gdal-dev at lists.osgeo.org>
Date: Wednesday, May 14, 2025 at 8:54?PM
To: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite library with full path
I reported the same problem recently, but I determined in my case that the problem was my build of libsqlite3 which for some reason was missing the SONAME attribute from the binary. This had the effect of the CMAKE build of GDAL containing the absolute path of libsqlite3 in the libgdal.so file.

Try this to test whether you are having a similar problem. This was done on my rebuilt libsqlite3 library and the attribute is present.  If it is missing in yours then that could cause the problem.  I?m not exactly sure why, but troubleshooting the cmake build is awfully difficult.

objdump -p libsqlite3.so | grep SONAME
  SONAME               libsqlite3.so.0

To fix it, I rebuilt my libsqlite3 binary, but you could patch that file to add in the attribute or rebuild it with the correct compiler options to create the attribute. You could also patch the gdal library after the build.

To use patchelf to add a SONAME. ?patchelf --set-soname libsqlite3.so.3 libsqlite3.so?

The line in my Makefile for RHEL8 to build it with the soname looks like this, $(CC) $(CFLAGS) -shared sqlite3.o -Wl,-soname,libsqlite3.so.0 -o $(LIBS)/libsqlite3.so

After doing that and rebuilding GDAL the libgdal.so file was as I expected with no absolute path to libsqlite3.so.  I preferred to fix the root cause and stored the corrected libsqlite3 binary in our local repository so that I don?t have to keep patching libgdal after every build.

ldd libgdal.so | grep libsqlite3
libsqlite3.so.0 => /lib64/libsqlite3.so.0 (0x00007fcdab1d7000)

I hope that helps you.  That is how I solved the same kind of problem in my case while building GDAL 3.7.0.

Thanks,
Shawn Fox

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Andrew Bell via gdal-dev
Sent: Wednesday, May 14, 2025 3:47 PM
To: Fengting Chen <fengting.chen at oracle.com>
Cc: gdal-dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] [External] : Re: libgdal.so.36 refers to sqlite library with full path

External Email Alert
This email has been sent from an account outside of the BAE Systems network.
Please treat the email with caution, especially if you are requested to click on a link, decrypt/open an attachment, or enable macros.  For further information on how to spot phishing, access ?Cybersecurity OneSpace Page? and report phishing by clicking the button ?Report Phishing? on the Outlook toolbar.

You can use patchelf or a similar program to modify dependencies.

--
Andrew Bell
andrew.bell.ia at gmail.com<mailto:andrew.bell.ia at gmail.com>

On Wed, May 14, 2025, 6:10?PM Fengting Chen via gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>> wrote:
Both GDAL and PROJ refer to my custom build sqlite3 library. The sqlite3 entry in PROJ library looks normal, that is, just the library name without path.

My concern is that libgdal.so has libsqlite3.so with full path. How could this happen? How do I remove this?

From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
Date: Wednesday, May 14, 2025 at 5:04?PM
To: Fengting Chen <fengting.chen at oracle.com<mailto:fengting.chen at oracle.com>>, gdal-dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: [External] : Re: [gdal-dev] libgdal.so.36 refers to sqlite library with full path

Maybe another library that GDAL is depending on is linked against the system sqlite3 and not your custom build ? That could be PROJ typically
Le 14/05/2025 ? 22:58, Fengting Chen via gdal-dev a ?crit :
Hi, I am trying to build GDAL 3.10.3 with sqlite 3.49.2. The build was successful on linux. But there are two entries of reference to sqlite3, and one of it has the absolution path.

> ldd libgdal.so.36 | grep sqlite
ldd: warning: you do not have execution permission for `./libgdal.so.36'
        /scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7e08168000)
        libsqlite3.so => / scratch/gdal_dir/SDK/sqlite/3.49.2/dist/lib/libsqlite3.so (0x00007f7dfb00e000)

Why is above listing having a full path of libsqlite3.so built in the libgdal.so.36?

The configuration for the cmake for GDAL is:

set (SQLite3_INCLUDE_DIR          "$(SQLITE3_DIST_DIR)/         include" CACHE PATH "" FORCE)
set (SQLite3_LIBRARY              "$(SQLITE3_DIST_DIR)/lib/     $(LIBSQLITE3)" CACHE PATH "" FORCE)

At the sqlite lib directory, it has:
libsqlite3.a    libsqlite3.so.0@       pkgconfig/
libsqlite3.so@  libsqlite3.so.3.49.2*

Is this sqlite3 build issue or GDAL build issue?

Thanks.



_______________________________________________

gdal-dev mailing list

gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i14PHNK2$>

--

http://www.spatialys.com<https://urldefense.com/v3/__http:/www.spatialys.com__;!!ACWV5N9M2RV99hQ!IYTAe90PeRIf_wj9IWwRo5D25Ll_Dqjy6ZUwhS1joyPnRj0waH4uKmjh0GN2-UVNert2VyP1mnq_6fU7q1t4i4kI3dZu$>

My software is free, but my time generally not.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://urldefense.com/v3/__https:/lists.osgeo.org/mailman/listinfo/gdal-dev__;!!ACWV5N9M2RV99hQ!Lw10Up9tLBGiVtEh_mAlusRrrL5SxKFEqvRvw893tnMezleCo0hUzotNcEJfXaWCa0fIhyL5Qa6vqypT-G4gnI1n$>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/e4b98b2b/attachment-0001.htm>

From Jon.Morris at jbarisk.com  Thu May 15 03:37:49 2025
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 15 May 2025 10:37:49 +0000
Subject: [gdal-dev] Building GDAL with rtree support
Message-ID: <CWLP123MB6876DEC8E618D9BB885CED458290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>

Hello all,

I'm trying to build GDAL python wheels and am having some autotest fails that is preventing the build. I think most if not all of these fails are due to rtree not being available in sqlite. AFAIK I've done everything needed but the build recipe must be missing something.

The dockerfile contents are below and I run it with the command `DOCKER_BUILDKIT=0 docker build -f Dockerfile -t gdal-wheelbuilder`. It gets as far as `ctest -V` then exits with the following test fails:
         46 - autotest_gdrivers (Failed)
         48 - autotest_ogr (Failed)
         50 - autotest_pyscripts (Failed)

Thanks,

Jon

FROM quay.io/pypa/manylinux_2_28_x86_64

# Arrow install instructions from https://arrow.apache.org/install/
RUN dnf update -y \
    && dnf groupinstall -y "Development Tools" \
    && dnf install -y epel-release \
    && dnf install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1).noarch.rpm \
    && dnf install -y https://packages.apache.org/artifactory/arrow/almalinux/$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1)/apache-arrow-release-latest.rpm \
    && dnf config-manager --set-enabled epel \
    && dnf config-manager --set-enabled powertools \
    && dnf install -y arrow-devel \
    && dnf install -y arrow-dataset-devel \
    && dnf install -y parquet-devel
RUN dnf install -y \
        ant \
        autoconf \
        automake \
        bash-completion \
        cmake \
        ca-certificates \
        ccache \
        clang \
        cmake \
        curl-devel \
        doxygen \
        git \
        gnupg \
        gpsbabel \
        lcov \
        hdf5-devel \
        json-devel \
        json-c-devel \
        libaec-devel \
        libdeflate-devel \
        libjpeg-devel \
        libkml-devel \
        libpng-devel \
        libpq-devel \
        libtiff-devel \
        libtool \
        libwebp-devel \
        libxml2-devel \
        libzstd-devel \
        make \
        minizip-devel \
        numactl \
        openssl-devel \
        openjpeg2-devel \
        pkg-config \
        poppler-devel \
        postgresql \
        postgresql-contrib \
        python3-devel \
        python38-devel \
        python3-lxml \
        python3-numpy \
        python3-pip \
        python3-pytest \
        python3-setuptools \
        python3-virtualenv \
        swig \
        unzip \
        wget \
        zip \
        zlib-devel

# Install geos
RUN mkdir -p /src \
    && cd /src \
    && curl -f -L -O https://download.osgeo.org/geos/geos-3.13.0.tar.bz2 \
    && tar jxf geos-3.13.0.tar.bz2 \
    && cd /src/geos-3.13.0 \
    && mkdir build  \
    && cd build \
    && cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. \
    && make -j$(nproc) \
    && make install \
    && cd / \
    && rm -rf /src

# Build a SQLite version with -DSQLITE_TRUSTED_SCHEMA=0
RUN mkdir sqlite \
    && wget -q https://sqlite.org/2023/sqlite-autoconf-3430100.tar.gz -O - \
        | tar xz -C sqlite --strip-components=1 \
    && cd sqlite \
    && CFLAGS="-O2 -DSQLITE_TRUSTED_SCHEMA=0 -DSQLITE_ENABLE_COLUMN_METADATA -DSQLITE_ENABLE_RTREE" ./configure --prefix=/usr/local/install-sqlite-trusted-schema-off \
    && make -j$(nproc) \
    && make -j$(nproc) install \
    && cd .. \
    && rm -rf sqlite

# Fix proj version
RUN mkdir -p /src \
    && cd /src \
    && curl -f -L -O https://download.osgeo.org/proj/proj-9.1.1.tar.gz \
    && tar xzf proj-9.1.1.tar.gz \
    && cd /src/proj-9.1.1 \
    && mkdir build  \
    && cd build \
    && cmake -DEXE_SQLITE3=/usr/local/install-sqlite-trusted-schema-off/bin/sqlite3 .. \
    && cmake --build . \
    && cmake --build . --target install \
    && rm -rf /src

# Build libgeotiff (system libgeotiff pulls in system libproj as a dependency)
RUN mkdir -p /src \
    && cd /src \
    && curl -f -L -O https://github.com/OSGeo/libgeotiff/releases/download/1.7.3/libgeotiff-1.7.3.tar.gz \
    && tar xzf libgeotiff-1.7.3.tar.gz \
    && cd libgeotiff-1.7.3 \
    && mkdir build_autoconf \
    && cd build_autoconf \
    && export LD_LIBRARY_PATH=/usr/local/lib64:/usr/local/lib:/usr/lib:/lib \
    && CFLAGS="-Wall -Wextra -Werror" ../configure \
    && make -j$(nproc) \
    && make check \
    && cd .. \
    && mkdir build_cmake \
    && cd build_cmake \
    && cmake -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_C_FLAGS="-Wall -Wextra -Werror" .. \
    && make -j$(nproc) \
    && rm -rf /src

# Build freexl (spatialite dependency)
RUN mkdir -p /src \
    && cd /src \
    && curl -f -L -O https://www.gaia-gis.it/gaia-sins/freexl-2.0.0.tar.gz \
    && tar xzf freexl-2.0.0.tar.gz \
    && cd /src/freexl-2.0.0 \
    && ./configure \
    && make -j$(nproc) \
    && make install \
    && rm -rf /src

# Build spatialite so it uses correct PROJ and sqlite3
RUN mkdir -p /src \
    && cd /src \
    && curl -f -L -O https://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.1.0.tar.gz \
    && tar xzf libspatialite-5.1.0.tar.gz \
    && cd /src/libspatialite-5.1.0 \
    && SQLITE3_CFLAGS="-I/usr/local/install-sqlite-trusted-schema-off/include/" SQLITE3_LIBS="-Wl,--enable-new-dtags,-rpath=/usr/local/install-sqlite-trusted-schema-off/lib -L/usr/local/install-sqlite-trusted-schema-off/lib -lsqlite3" ./configure --disable-rttopo \
    && make -j$(nproc) \
    && make install \
    && rm -rf /src

# configure shared libraries
RUN ldconfig -v

# Add GDAL source to container
# and checkout current branch and commit (see README.md).
# Also patch in commits https://github.com/OSGeo/gdal/commit/b36072fa1539b8ac97ea7864071d3468ac5b49ab
# and https://github.com/OSGeo/gdal/commit/222e1c111437f9fd6e43eb384f0903684735750b to get rid of
# arrow/parquet deprecation warnings
ARG GITHUB_WORKSPACE=/src

RUN mkdir -p $GITHUB_WORKSPACE \
    && cd $GITHUB_WORKSPACE \
    && git config --global user.email you at example.com<mailto:you at example.com> \
    && git config --global user.name "Your Name" \
    && git clone -b release/3.10 https://github.com/OSGeo/gdal.git superbuild \
    && cd superbuild \
    && git checkout 9b7a7c8 \
    && git cherry-pick b36072fa \
    && git cherry-pick 222e1c11

# Install test requirements
RUN python3.8 -m pip install -U pip setuptools numpy importlib_metadata \
    && python3.8 -m pip install -r $GITHUB_WORKSPACE/superbuild/autotest/requirements.txt

## This section based on build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ##

ARG CMAKE_UNITY_BUILD=OFF

# - name: Configure
RUN set -eu \
    && cd $GITHUB_WORKSPACE/superbuild \
    && export CXXFLAGS="-march=native -O2 -Wodr -flto-odr-type-merging -Werror" \
    && export CFLAGS="-O2 -march=native -Werror" \
    && mkdir build \
    && cd build \
    && cmake .. \
        -Werror=dev \
        -DCMAKE_INSTALL_PREFIX=$GITHUB_WORKSPACE/install-gdal \
        -DCMAKE_UNITY_BUILD=${CMAKE_UNITY_BUILD} \
        -DGDAL_USE_PUBLICDECOMPWT:BOOL=ON \
        -DPUBLICDECOMPWT_URL=https://github.com/rouault/PublicDecompWT \
        -DWERROR_DEV_FLAG="-Werror=dev" \
        -DPython_LOOKUP_VERSION=3.8 \
        -DUSE_CCACHE=OFF \
        -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON \
        -DGDAL_USE_TIFF_INTERNAL=ON \
        -DGDAL_USE_GEOTIFF_INTERNAL=ON \
        -DSQLite3_INCLUDE_DIR=/usr/local/install-sqlite-trusted-schema-off/include \
        -DSQLite3_LIBRARY=/usr/local/install-sqlite-trusted-schema-off/lib/libsqlite3.so \
        -DBUILD_CSHARP_BINDINGS:BOOL=OFF \
    && unset CXXFLAGS \
    && unset CFLAGS

# - name: Build
RUN GIT_LFS_SKIP_SMUDGE=1 cmake --build $GITHUB_WORKSPACE/superbuild/build -- -j$(nproc)

# - name: test (with command targets)
RUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target quicktest -- -j$(nproc)

# - name: test (with ctest)
RUN cd $GITHUB_WORKSPACE/superbuild/build \
    && ctest -V

# - name: install
RUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target install -- -j$(nproc)

## END build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ##



Jon Morris
Software Developer
--


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/9b765d6c/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image958650.png
Type: image/png
Size: 7388 bytes
Desc: image958650.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/9b765d6c/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image748490.png
Type: image/png
Size: 5172 bytes
Desc: image748490.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/9b765d6c/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image252124.png
Type: image/png
Size: 774 bytes
Desc: image252124.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/9b765d6c/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image442173.png
Type: image/png
Size: 797 bytes
Desc: image442173.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/9b765d6c/attachment-0007.png>

From jukka.rahkonen at maanmittauslaitos.fi  Thu May 15 04:15:45 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Thu, 15 May 2025 11:15:45 +0000
Subject: [gdal-dev] Building GDAL with rtree support
In-Reply-To: <CWLP123MB6876DEC8E618D9BB885CED458290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
References: <CWLP123MB6876DEC8E618D9BB885CED458290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <DB9PR09MB6887A7470E10C9AB01CDE449FD90A@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

If you suppose that rtree is missing, compile only SQLite and then run this in SQLite

pragma compile_options;

It should show "ENABLE_RTREE".

If that is ok then the error happens in some other place.

-Jukka-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jon Morris via gdal-dev puolesta
L?hetetty: Torstai 15. toukokuuta 2025 13.37
Vastaanottaja: gdal dev
Aihe: [gdal-dev] Building GDAL with rtree support

Hello all,?I?m trying to build GDAL python wheels and am having some autotest fails that is preventing the build. I think most if not all of these fails are due to rtree not being available in sqlite. AFAIK I?ve done everything needed but the build recipe must be missing something.?The dockerfile contents are below and I run it with the command `DOCKER_BUILDKIT=0 docker build -f Dockerfile -t gdal-wheelbuilder`. It gets as far as `ctest -V` then exits with the following test fails:???????? 46 - autotest_gdrivers (Failed)???????? 48 - autotest_ogr (Failed)???????? 50 - autotest_pyscripts (Failed)?Thanks,?Jon?FROM quay.io/pypa/manylinux_2_28_x86_64?# Arrow install instructions from https://arrow.apache.org/install/RUN dnf update -y \??? && dnf groupinstall -y "Development Tools" \??? && dnf install -y epel-release \??? && dnf install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1).noarch.rpm \??? && dnf install -y https://packages.apache.org/artifactory/arrow/almalinux/$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1)/apache-arrow-release-latest.rpm \??? && dnf config-manager --set-enabled epel \??? && dnf config-manager --set-enabled powertools \??? && dnf install -y arrow-devel \??? && dnf install -y arrow-dataset-devel \??? && dnf install -y parquet-develRUN dnf install -y \??????? ant \??????? autoconf \??????? automake \??????? bash-completion \??????? cmake \??????? ca-certificates \??????? ccache \??????? clang \??????? cmake \??????? curl-devel \??????? doxygen \??????? git \??????? gnupg \??????? gpsbabel \??????? lcov \??????? hdf5-devel \??????? json-devel \??????? json-c-devel \??????? libaec-devel \??????? libdeflate-devel \??????? libjpeg-devel \??????? libkml-devel \??????? libpng-devel \??????? libpq-devel \??????? libtiff-devel \??????? libtool \??????? libwebp-devel \??????? libxml2-devel \??????? libzstd-devel \??????? make \??????? minizip-devel \??????? numactl \??????? openssl-devel \??????? openjpeg2-devel \??????? pkg-config \??????? poppler-devel \??????? postgresql \??????? postgresql-contrib \??????? python3-devel \??????? python38-devel \??????? python3-lxml \??????? python3-numpy \??????? python3-pip \??????? python3-pytest \??????? python3-setuptools \??????? python3-virtualenv \??????? swig \??????? unzip \??????? wget \??????? zip \??????? zlib-devel?# Install geosRUN mkdir -p /src \??? && cd /src \??? && curl -f -L -O https://download.osgeo.org/geos/geos-3.13.0.tar.bz2 \??? && tar jxf geos-3.13.0.tar.bz2 \??? && cd /src/geos-3.13.0 \??? && mkdir build? \??? && cd build \??? && cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. \??? && make -j$(nproc) \??? && make install \??? && cd / \??? && rm -rf /src?# Build a SQLite version with -DSQLITE_TRUSTED_SCHEMA=0RUN mkdir sqlite \??? && wget -q https://sqlite.org/2023/sqlite-autoconf-3430100.tar.gz -O - \??????? | tar xz -C sqlite --strip-components=1 \??? && cd sqlite \??? && CFLAGS="-O2 -DSQLITE_TRUSTED_SCHEMA=0 -DSQLITE_ENABLE_COLUMN_METADATA -DSQLITE_ENABLE_RTREE" ./configure --prefix=/usr/local/install-sqlite-trusted-schema-off \??? && make -j$(nproc) \??? && make -j$(nproc) install \??? && cd .. \??? && rm -rf sqlite?# Fix proj versionRUN mkdir -p /src \??? && cd /src \??? && curl -f -L -O https://download.osgeo.org/proj/proj-9.1.1.tar.gz \??? && tar xzf proj-9.1.1.tar.gz \??? && cd /src/proj-9.1.1 \??? && mkdir build? \??? && cd build \??? && cmake -DEXE_SQLITE3=/usr/local/install-sqlite-trusted-schema-off/bin/sqlite3 .. \??? && cmake --build . \??? && cmake --build . --target install \??? && rm -rf /src?# Build libgeotiff (system libgeotiff pulls in system libproj as a dependency)RUN mkdir -p /src \??? && cd /src \??? && curl -f -L -O https://github.com/OSGeo/libgeotiff/releases/download/1.7.3/libgeotiff-1.7.3.tar.gz \??? && tar xzf libgeotiff-1.7.3.tar.gz \??? && cd libgeotiff-1.7.3 \??? && mkdir build_autoconf \??? && cd build_autoconf \??? && export LD_LIBRARY_PATH=/usr/local/lib64:/usr/local/lib:/usr/lib:/lib \??? && CFLAGS="-Wall -Wextra -Werror" ../configure \??? && make -j$(nproc) \??? && make check \??? && cd .. \??? && mkdir build_cmake \??? && cd build_cmake \??? && cmake -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_C_FLAGS="-Wall -Wextra -Werror" .. \??? && make -j$(nproc) \??? && rm -rf /src?# Build freexl (spatialite dependency)RUN mkdir -p /src \??? && cd /src \??? && curl -f -L -O https://www.gaia-gis.it/gaia-sins/freexl-2.0.0.tar.gz \??? && tar xzf freexl-2.0.0.tar.gz \??? && cd /src/freexl-2.0.0 \??? && ./configure \??? && make -j$(nproc) \??? && make install \??? && rm -rf /src?# Build spatialite so it uses correct PROJ and sqlite3RUN mkdir -p /src \??? && cd /src \??? && curl -f -L -O https://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.1.0.tar.gz \??? && tar xzf libspatialite-5.1.0.tar.gz \??? && cd /src/libspatialite-5.1.0 \??? && SQLITE3_CFLAGS="-I/usr/local/install-sqlite-trusted-schema-off/include/" SQLITE3_LIBS="-Wl,--enable-new-dtags,-rpath=/usr/local/install-sqlite-trusted-schema-off/lib -L/usr/local/install-sqlite-trusted-schema-off/lib -lsqlite3" ./configure --disable-rttopo \??? && make -j$(nproc) \??? && make install \??? && rm -rf /src?# configure shared librariesRUN ldconfig -v?# Add GDAL source to container# and checkout current branch and commit (see README.md).# Also patch in commits https://github.com/OSGeo/gdal/commit/b36072fa1539b8ac97ea7864071d3468ac5b49ab# and https://github.com/OSGeo/gdal/commit/222e1c111437f9fd6e43eb384f0903684735750b to get rid of# arrow/parquet deprecation warningsARG GITHUB_WORKSPACE=/src?RUN mkdir -p $GITHUB_WORKSPACE \??? && cd $GITHUB_WORKSPACE \??? && git config --global user.email you at example.com \??? && git config --global user.name "Your Name" \??? && git clone -b release/3.10 https://github.com/OSGeo/gdal.git superbuild \??? && cd superbuild \??? && git checkout 9b7a7c8 \??? && git cherry-pick b36072fa \??? && git cherry-pick 222e1c11?# Install test requirementsRUN python3.8 -m pip install -U pip setuptools numpy importlib_metadata \??? && python3.8 -m pip install -r $GITHUB_WORKSPACE/superbuild/autotest/requirements.txt?## This section based on build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ##?ARG CMAKE_UNITY_BUILD=OFF?# - name: ConfigureRUN set -eu \??? && cd $GITHUB_WORKSPACE/superbuild \??? && export CXXFLAGS="-march=native -O2 -Wodr -flto-odr-type-merging -Werror" \??? && export CFLAGS="-O2 -march=native -Werror" \??? && mkdir build \??? && cd build \??? && cmake .. \??????? -Werror=dev \??????? -DCMAKE_INSTALL_PREFIX=$GITHUB_WORKSPACE/install-gdal \??????? -DCMAKE_UNITY_BUILD=${CMAKE_UNITY_BUILD} \??????? -DGDAL_USE_PUBLICDECOMPWT:BOOL=ON \??????? -DPUBLICDECOMPWT_URL=https://github.com/rouault/PublicDecompWT \??????? -DWERROR_DEV_FLAG="-Werror=dev" \??????? -DPython_LOOKUP_VERSION=3.8 \??????? -DUSE_CCACHE=OFF \??????? -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON \??????? -DGDAL_USE_TIFF_INTERNAL=ON \??????? -DGDAL_USE_GEOTIFF_INTERNAL=ON \??????? -DSQLite3_INCLUDE_DIR=/usr/local/install-sqlite-trusted-schema-off/include \??????? -DSQLite3_LIBRARY=/usr/local/install-sqlite-trusted-schema-off/lib/libsqlite3.so \??????? -DBUILD_CSHARP_BINDINGS:BOOL=OFF \??? && unset CXXFLAGS \??? && unset CFLAGS?# - name: BuildRUN GIT_LFS_SKIP_SMUDGE=1 cmake --build $GITHUB_WORKSPACE/superbuild/build -- -j$(nproc)?# - name: test (with command targets)RUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target quicktest -- -j$(nproc)?# - name: test (with ctest)RUN cd $GITHUB_WORKSPACE/superbuild/build \??? && ctest -V?# - name: installRUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target install -- -j$(nproc)?## END build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ##???Jon MorrisSoftware Developer--?e:?Jon.Morris at jbarisk.comd:+44?(0)1756?587229t:?+44?(0)1756?799919www.jbarisk.com[X][X][X][X]???All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.????

From Jon.Morris at jbarisk.com  Thu May 15 04:24:40 2025
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 15 May 2025 11:24:40 +0000
Subject: [gdal-dev] Building GDAL with rtree support
In-Reply-To: <DB9PR09MB6887A7470E10C9AB01CDE449FD90A@DB9PR09MB6887.eurprd09.prod.outlook.com>
References: <CWLP123MB6876DEC8E618D9BB885CED458290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
 <DB9PR09MB6887A7470E10C9AB01CDE449FD90A@DB9PR09MB6887.eurprd09.prod.outlook.com>
Message-ID: <CWLP123MB68761C60893353AEFCC1BDBB8290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>

Hi Jukka,

If I just run sqlite3 on the command line (/usr/local/bin/sqlite3) then ENABLE_RTREE is not there, but if I run the version I compiled, /usr/local/install-sqlite-trusted-schema-off/bin/sqlite3, then it is.

I suspect one of the downstream dependencies is using the wrong version of sqlite but I'm pretty sure I've specified the correct one for proj, spatialite, and gdal. 

The sqlite build step has been copied from https://github.com/OSGeo/gdal/blob/master/.github/workflows/ubuntu_20.04/Dockerfile.ci#L247 - is there a good reason to configure with --prefix=/usr/local/install-sqlite-trusted-schema-off rather than just replacing the sqlite in /usr/local/bin?

Jon


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-----Original Message-----
From: Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi> 
Sent: 15 May 2025 12:16
To: gdal dev <gdal-dev at lists.osgeo.org>; Jon Morris <Jon.Morris at jbarisk.com>
Subject: Re: Building GDAL with rtree support

CAUTION: This email originated from outside of JBA and contains one or more links. DO NOT click links unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.

Hi,

If you suppose that rtree is missing, compile only SQLite and then run this in SQLite

pragma compile_options;

It should show "ENABLE_RTREE".

If that is ok then the error happens in some other place.

-Jukka-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jon Morris via gdal-dev puolesta
L?hetetty: Torstai 15. toukokuuta 2025 13.37
Vastaanottaja: gdal dev
Aihe: [gdal-dev] Building GDAL with rtree support

Hello all, I'm trying to build GDAL python wheels and am having some autotest fails that is preventing the build. I think most if not all of these fails are due to rtree not being available in sqlite. AFAIK I've done everything needed but the build recipe must be missing something. The dockerfile contents are below and I run it with the command `DOCKER_BUILDKIT=0 docker build -f Dockerfile -t gdal-wheelbuilder`. It gets as far as `ctest -V` then exits with the following test fails:         46 - autotest_gdrivers (Failed)         48 - autotest_ogr (Failed)         50 - autotest_pyscripts (Failed) Thanks, Jon FROM quay.io/pypa/manylinux_2_28_x86_64 # Arrow install instructions from https://arrow.apache.org/install/RUN dnf update -y \    && dnf groupinstall -y "Development Tools" \    && dnf install -y epel-release \    && dnf install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1).noarch.rpm \    && dnf install -y https://packages.apache.org/artifactory/arrow/almalinux/$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1)/apache-arrow-release-latest.rpm \    && dnf config-manager --set-enabled epel \    && dnf config-manager --set-enabled powertools \    && dnf install -y arrow-devel \    && dnf install -y arrow-dataset-devel \    && dnf install -y parquet-develRUN dnf install -y \        ant \        autoconf \        automake \        bash-completion \        cmake \        ca-certificates \        ccache \        clang \        cmake \        curl-devel \        doxygen \        git \        gnupg \        gpsbabel \        lcov \        hdf5-devel \        json-devel \        json-c-devel \        libaec-devel \        libdeflate-devel \        libjpeg-devel \        libkml-devel \        libpng-devel \        libpq-devel \        libtiff-devel \        libtool \        libwebp-devel \        libxml2-devel \        libzstd-devel \        make \        minizip-devel \        numactl \        openssl-devel \        openjpeg2-devel \        pkg-config \        poppler-devel \        postgresql \        postgresql-contrib \        python3-devel \        python38-devel \        python3-lxml \        python3-numpy \        python3-pip \        python3-pytest \        python3-setuptools \        python3-virtualenv \        swig \        unzip \        wget \        zip \        zlib-devel # Install geosRUN mkdir -p /src \    && cd /src \    && curl -f -L -O https://download.osgeo.org/geos/geos-3.13.0.tar.bz2 \    && tar jxf geos-3.13.0.tar.bz2 \    && cd /src/geos-3.13.0 \    && mkdir build  \    && cd build \    && cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. \    && make -j$(nproc) \    && make install \    && cd / \    && rm -rf /src # Build a SQLite version with -DSQLITE_TRUSTED_SCHEMA=0RUN mkdir sqlite \    && wget -q https://sqlite.org/2023/sqlite-autoconf-3430100.tar.gz -O - \        | tar xz -C sqlite --strip-components=1 \    && cd sqlite \    && CFLAGS="-O2 -DSQLITE_TRUSTED_SCHEMA=0 -DSQLITE_ENABLE_COLUMN_METADATA -DSQLITE_ENABLE_RTREE" ./configure --prefix=/usr/local/install-sqlite-trusted-schema-off \    && make -j$(nproc) \    && make -j$(nproc) install \    && cd .. \    && rm -rf sqlite # Fix proj versionRUN mkdir -p /src \    && cd /src \    && curl -f -L -O https://download.osgeo.org/proj/proj-9.1.1.tar.gz \    && tar xzf proj-9.1.1.tar.gz \    && cd /src/proj-9.1.1 \    && mkdir build  \    && cd build \    && cmake -DEXE_SQLITE3=/usr/local/install-sqlite-trusted-schema-off/bin/sqlite3 .. \    && cmake --build . \    && cmake --build . --target install \    && rm -rf /src # Build libgeotiff (system libgeotiff pulls in system libproj as a dependency)RUN mkdir -p /src \    && cd /src \    && curl -f -L -O https://github.com/OSGeo/libgeotiff/releases/download/1.7.3/libgeotiff-1.7.3.tar.gz \    && tar xzf libgeotiff-1.7.3.tar.gz \    && cd libgeotiff-1.7.3 \    && mkdir build_autoconf \    && cd build_autoconf \    && export LD_LIBRARY_PATH=/usr/local/lib64:/usr/local/lib:/usr/lib:/lib \    && CFLAGS="-Wall -Wextra -Werror" ../configure \    && make -j$(nproc) \    && make check \    && cd .. \    && mkdir build_cmake \    && cd build_cmake \    && cmake -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_C_FLAGS="-Wall -Wextra -Werror" .. \    && make -j$(nproc) \    && rm -rf /src # Build freexl (spatialite dependency)RUN mkdir -p /src \    && cd /src \    && curl -f -L -O https://www.gaia-gis.it/gaia-sins/freexl-2.0.0.tar.gz \    && tar xzf freexl-2.0.0.tar.gz \    && cd /src/freexl-2.0.0 \    && ./configure \    && make -j$(nproc) \    && make install \    && rm -rf /src # Build spatialite so it uses correct PROJ and sqlite3RUN mkdir -p /src \    && cd /src \    && curl -f -L -O https://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.1.0.tar.gz \    && tar xzf libspatialite-5.1.0.tar.gz \    && cd /src/libspatialite-5.1.0 \    && SQLITE3_CFLAGS="-I/usr/local/install-sqlite-trusted-schema-off/include/" SQLITE3_LIBS="-Wl,--enable-new-dtags,-rpath=/usr/local/install-sqlite-trusted-schema-off/lib -L/usr/local/install-sqlite-trusted-schema-off/lib -lsqlite3" ./configure --disable-rttopo \    && make -j$(nproc) \    && make install \    && rm -rf /src # configure shared librariesRUN ldconfig -v # Add GDAL source to container# and checkout current branch and commit (see README.md).# Also patch in commits https://github.com/OSGeo/gdal/commit/b36072fa1539b8ac97ea7864071d3468ac5b49ab# and https://github.com/OSGeo/gdal/commit/222e1c111437f9fd6e43eb384f0903684735750b to get rid of# arrow/parquet deprecation warningsARG GITHUB_WORKSPACE=/src RUN mkdir -p $GITHUB_WORKSPACE \    && cd $GITHUB_WORKSPACE \    && git config --global user.email you at example.com \    && git config --global user.name "Your Name" \    && git clone -b release/3.10 https://github.com/OSGeo/gdal.git superbuild \    && cd superbuild \    && git checkout 9b7a7c8 \    && git cherry-pick b36072fa \    && git cherry-pick 222e1c11 # Install test requirementsRUN python3.8 -m pip install -U pip setuptools numpy importlib_metadata \    && python3.8 -m pip install -r $GITHUB_WORKSPACE/superbuild/autotest/requirements.txt ## This section based on build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ## ARG CMAKE_UNITY_BUILD=OFF # - name: ConfigureRUN set -eu \    && cd $GITHUB_WORKSPACE/superbuild \    && export CXXFLAGS="-march=native -O2 -Wodr -flto-odr-type-merging -Werror" \    && export CFLAGS="-O2 -march=native -Werror" \    && mkdir build \    && cd build \    && cmake .. \        -Werror=dev \        -DCMAKE_INSTALL_PREFIX=$GITHUB_WORKSPACE/install-gdal \        -DCMAKE_UNITY_BUILD=${CMAKE_UNITY_BUILD} \        -DGDAL_USE_PUBLICDECOMPWT:BOOL=ON \        -DPUBLICDECOMPWT_URL=https://github.com/rouault/PublicDecompWT \        -DWERROR_DEV_FLAG="-Werror=dev" \        -DPython_LOOKUP_VERSION=3.8 \        -DUSE_CCACHE=OFF \        -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON \        -DGDAL_USE_TIFF_INTERNAL=ON \        -DGDAL_USE_GEOTIFF_INTERNAL=ON \        -DSQLite3_INCLUDE_DIR=/usr/local/install-sqlite-trusted-schema-off/include \        -DSQLite3_LIBRARY=/usr/local/install-sqlite-trusted-schema-off/lib/libsqlite3.so \        -DBUILD_CSHARP_BINDINGS:BOOL=OFF \    && unset CXXFLAGS \    && unset CFLAGS # - name: BuildRUN GIT_LFS_SKIP_SMUDGE=1 cmake --build $GITHUB_WORKSPACE/superbuild/build -- -j$(nproc) # - name: test (with command targets)RUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target quicktest -- -j$(nproc) # - name: test (with ctest)RUN cd $GITHUB_WORKSPACE/superbuild/build \    && ctest -V # - name: installRUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target install -- -j$(nproc) ## END build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ##   Jon MorrisSoftware Developer-- e: Jon.Morris at jbarisk.comd:+44 (0)1756 587229t: +44 (0)1756 799919www.jbarisk.com[X][X][X][X]???All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/a455623a/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image937652.png
Type: image/png
Size: 7388 bytes
Desc: image937652.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/a455623a/attachment-0004.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image179869.png
Type: image/png
Size: 5172 bytes
Desc: image179869.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/a455623a/attachment-0005.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image359385.png
Type: image/png
Size: 774 bytes
Desc: image359385.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/a455623a/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image691696.png
Type: image/png
Size: 797 bytes
Desc: image691696.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/a455623a/attachment-0007.png>

From Jon.Morris at jbarisk.com  Thu May 15 07:58:27 2025
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 15 May 2025 14:58:27 +0000
Subject: [gdal-dev] Building GDAL with rtree support
In-Reply-To: <CWLP123MB68761C60893353AEFCC1BDBB8290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
References: <CWLP123MB6876DEC8E618D9BB885CED458290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
 <DB9PR09MB6887A7470E10C9AB01CDE449FD90A@DB9PR09MB6887.eurprd09.prod.outlook.com>
 <CWLP123MB68761C60893353AEFCC1BDBB8290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CWLP123MB6876F3E7DCF2DF5817111A988290A@CWLP123MB6876.GBRP123.PROD.OUTLOOK.COM>

Confirming that installing sqlite to /usr/local instead of /usr/local/install-sqlite-trusted-schema-off and just overwriting the system sqlite fixes the problem.

Jon


e: Jon.Morris at jbarisk.com
d:+44 (0)1756 587229
t: +44 (0)1756 799919
www.jbarisk.com
All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. 
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jon Morris via gdal-dev
Sent: 15 May 2025 12:25
To: gdal dev <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Building GDAL with rtree support

CAUTION: This email originated from outside of JBA and contains one or more links and one or more attachments. DO NOT click links or open attachments unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.
WARNING: This email contains one or more attachments with links within the attachment(s). Please take extra care when handling the attachments.
Hi Jukka,

If I just run sqlite3 on the command line (/usr/local/bin/sqlite3) then ENABLE_RTREE is not there, but if I run the version I compiled, /usr/local/install-sqlite-trusted-schema-off/bin/sqlite3, then it is.

I suspect one of the downstream dependencies is using the wrong version of sqlite but I'm pretty sure I've specified the correct one for proj, spatialite, and gdal.

The sqlite build step has been copied from https://github.com/OSGeo/gdal/blob/master/.github/workflows/ubuntu_20.04/Dockerfile.ci#L247 - is there a good reason to configure with --prefix=/usr/local/install-sqlite-trusted-schema-off rather than just replacing the sqlite in /usr/local/bin?

Jon
e:
Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>
d:
+44 (0)1756 587229
t:
+44 (0)1756 799919<tel:+44%20(0)1756%20799919>
www.jbarisk.com<http://www.jbarisk.com/>
[cid:image001.png at 01DBC5B2.31357880]
[cid:image002.png at 01DBC5B2.31357880]
[cid:image003.png at 01DBC5B2.31357880]<https://www.linkedin.com/company/jba-risk-management/>
[cid:image004.png at 01DBC5B2.31357880]<https://www.youtube.com/channel/UC0iatom2jYbW96voW0rlpCw>



All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.

-----Original Message-----
From: Rahkonen Jukka <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Sent: 15 May 2025 12:16
To: gdal dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>; Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>>
Subject: Re: Building GDAL with rtree support

CAUTION: This email originated from outside of JBA and contains one or more links. DO NOT click links unless you recognise the sender's email address and are absolutely certain that the content is safe.
See the Phishing page on IMS on SP for more information about how to spot and report suspicious messages.

Hi,

If you suppose that rtree is missing, compile only SQLite and then run this in SQLite

pragma compile_options;

It should show "ENABLE_RTREE".

If that is ok then the error happens in some other place.

-Jukka-

________________________________________
L?hett?j?: gdal-dev k?ytt?j?n Jon Morris via gdal-dev puolesta
L?hetetty: Torstai 15. toukokuuta 2025 13.37
Vastaanottaja: gdal dev
Aihe: [gdal-dev] Building GDAL with rtree support

Hello all, I'm trying to build GDAL python wheels and am having some autotest fails that is preventing the build. I think most if not all of these fails are due to rtree not being available in sqlite. AFAIK I've done everything needed but the build recipe must be missing something. The dockerfile contents are below and I run it with the command `DOCKER_BUILDKIT=0 docker build -f Dockerfile -t gdal-wheelbuilder`. It gets as far as `ctest -V` then exits with the following test fails: 46 - autotest_gdrivers (Failed) 48 - autotest_ogr (Failed) 50 - autotest_pyscripts (Failed) Thanks, Jon FROM quay.io/pypa/manylinux_2_28_x86_64 # Arrow install instructions from https://arrow.apache.org/install/RUN dnf update -y \ && dnf groupinstall -y "Development Tools" \ && dnf install -y epel-release \ && dnf install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1).noarch.rpm \ && dnf install -y https://packages.apache.org/artifactory/arrow/almalinux/$(cut -d: -f5 /etc/system-release-cpe | cut -d. -f1)/apache-arrow-release-latest.rpm \ && dnf config-manager --set-enabled epel \ && dnf config-manager --set-enabled powertools \ && dnf install -y arrow-devel \ && dnf install -y arrow-dataset-devel \ && dnf install -y parquet-develRUN dnf install -y \ ant \ autoconf \ automake \ bash-completion \ cmake \ ca-certificates \ ccache \ clang \ cmake \ curl-devel \ doxygen \ git \ gnupg \ gpsbabel \ lcov \ hdf5-devel \ json-devel \ json-c-devel \ libaec-devel \ libdeflate-devel \ libjpeg-devel \ libkml-devel \ libpng-devel \ libpq-devel \ libtiff-devel \ libtool \ libwebp-devel \ libxml2-devel \ libzstd-devel \ make \ minizip-devel \ numactl \ openssl-devel \ openjpeg2-devel \ pkg-config \ poppler-devel \ postgresql \ postgresql-contrib \ python3-devel \ python38-devel \ python3-lxml \ python3-numpy \ python3-pip \ python3-pytest \ python3-setuptools \ python3-virtualenv \ swig \ unzip \ wget \ zip \ zlib-devel # Install geosRUN mkdir -p /src \ && cd /src \ && curl -f -L -O https://download.osgeo.org/geos/geos-3.13.0.tar.bz2 \ && tar jxf geos-3.13.0.tar.bz2 \ && cd /src/geos-3.13.0 \ && mkdir build \ && cd build \ && cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_TESTING=OFF -DCMAKE_BUILD_TYPE=Release .. \ && make -j$(nproc) \ && make install \ && cd / \ && rm -rf /src # Build a SQLite version with -DSQLITE_TRUSTED_SCHEMA=0RUN mkdir sqlite \ && wget -q https://sqlite.org/2023/sqlite-autoconf-3430100.tar.gz -O - \ | tar xz -C sqlite --strip-components=1 \ && cd sqlite \ && CFLAGS="-O2 -DSQLITE_TRUSTED_SCHEMA=0 -DSQLITE_ENABLE_COLUMN_METADATA -DSQLITE_ENABLE_RTREE" ./configure --prefix=/usr/local/install-sqlite-trusted-schema-off \ && make -j$(nproc) \ && make -j$(nproc) install \ && cd .. \ && rm -rf sqlite # Fix proj versionRUN mkdir -p /src \ && cd /src \ && curl -f -L -O https://download.osgeo.org/proj/proj-9.1.1.tar.gz \ && tar xzf proj-9.1.1.tar.gz \ && cd /src/proj-9.1.1 \ && mkdir build \ && cd build \ && cmake -DEXE_SQLITE3=/usr/local/install-sqlite-trusted-schema-off/bin/sqlite3 .. \ && cmake --build . \ && cmake --build . --target install \ && rm -rf /src # Build libgeotiff (system libgeotiff pulls in system libproj as a dependency)RUN mkdir -p /src \ && cd /src \ && curl -f -L -O https://github.com/OSGeo/libgeotiff/releases/download/1.7.3/libgeotiff-1.7.3.tar.gz \ && tar xzf libgeotiff-1.7.3.tar.gz \ && cd libgeotiff-1.7.3 \ && mkdir build_autoconf \ && cd build_autoconf \ && export LD_LIBRARY_PATH=/usr/local/lib64:/usr/local/lib:/usr/lib:/lib \ && CFLAGS="-Wall -Wextra -Werror" ../configure \ && make -j$(nproc) \ && make check \ && cd .. \ && mkdir build_cmake \ && cd build_cmake \ && cmake -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_C_FLAGS="-Wall -Wextra -Werror" .. \ && make -j$(nproc) \ && rm -rf /src # Build freexl (spatialite dependency)RUN mkdir -p /src \ && cd /src \ && curl -f -L -O https://www.gaia-gis.it/gaia-sins/freexl-2.0.0.tar.gz \ && tar xzf freexl-2.0.0.tar.gz \ && cd /src/freexl-2.0.0 \ && ./configure \ && make -j$(nproc) \ && make install \ && rm -rf /src # Build spatialite so it uses correct PROJ and sqlite3RUN mkdir -p /src \ && cd /src \ && curl -f -L -O https://www.gaia-gis.it/gaia-sins/libspatialite-sources/libspatialite-5.1.0.tar.gz \ && tar xzf libspatialite-5.1.0.tar.gz \ && cd /src/libspatialite-5.1.0 \ && SQLITE3_CFLAGS="-I/usr/local/install-sqlite-trusted-schema-off/include/" SQLITE3_LIBS="-Wl,--enable-new-dtags,-rpath=/usr/local/install-sqlite-trusted-schema-off/lib -L/usr/local/install-sqlite-trusted-schema-off/lib -lsqlite3" ./configure --disable-rttopo \ && make -j$(nproc) \ && make install \ && rm -rf /src # configure shared librariesRUN ldconfig -v # Add GDAL source to container# and checkout current branch and commit (see README.md).# Also patch in commits https://github.com/OSGeo/gdal/commit/b36072fa1539b8ac97ea7864071d3468ac5b49ab# and https://github.com/OSGeo/gdal/commit/222e1c111437f9fd6e43eb384f0903684735750b to get rid of# arrow/parquet deprecation warningsARG GITHUB_WORKSPACE=/src RUN mkdir -p $GITHUB_WORKSPACE \ && cd $GITHUB_WORKSPACE \ && git config --global user.email you at example.com<mailto:you at example.com> \ && git config --global user.name "Your Name" \ && git clone -b release/3.10 https://github.com/OSGeo/gdal.git superbuild \ && cd superbuild \ && git checkout 9b7a7c8 \ && git cherry-pick b36072fa \ && git cherry-pick 222e1c11 # Install test requirementsRUN python3.8 -m pip install -U pip setuptools numpy importlib_metadata \ && python3.8 -m pip install -r $GITHUB_WORKSPACE/superbuild/autotest/requirements.txt ## This section based on build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ## ARG CMAKE_UNITY_BUILD=OFF # - name: ConfigureRUN set -eu \ && cd $GITHUB_WORKSPACE/superbuild \ && export CXXFLAGS="-march=native -O2 -Wodr -flto-odr-type-merging -Werror" \ && export CFLAGS="-O2 -march=native -Werror" \ && mkdir build \ && cd build \ && cmake .. \ -Werror=dev \ -DCMAKE_INSTALL_PREFIX=$GITHUB_WORKSPACE/install-gdal \ -DCMAKE_UNITY_BUILD=${CMAKE_UNITY_BUILD} \ -DGDAL_USE_PUBLICDECOMPWT:BOOL=ON \ -DPUBLICDECOMPWT_URL=https://github.com/rouault/PublicDecompWT \ -DWERROR_DEV_FLAG="-Werror=dev" \ -DPython_LOOKUP_VERSION=3.8 \ -DUSE_CCACHE=OFF \ -DCMAKE_INTERPROCEDURAL_OPTIMIZATION=ON \ -DGDAL_USE_TIFF_INTERNAL=ON \ -DGDAL_USE_GEOTIFF_INTERNAL=ON \ -DSQLite3_INCLUDE_DIR=/usr/local/install-sqlite-trusted-schema-off/include \ -DSQLite3_LIBRARY=/usr/local/install-sqlite-trusted-schema-off/lib/libsqlite3.so \ -DBUILD_CSHARP_BINDINGS:BOOL=OFF \ && unset CXXFLAGS \ && unset CFLAGS # - name: BuildRUN GIT_LFS_SKIP_SMUDGE=1 cmake --build $GITHUB_WORKSPACE/superbuild/build -- -j$(nproc) # - name: test (with command targets)RUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target quicktest -- -j$(nproc) # - name: test (with ctest)RUN cd $GITHUB_WORKSPACE/superbuild/build \ && ctest -V # - name: installRUN cmake --build $GITHUB_WORKSPACE/superbuild/build --target install -- -j$(nproc) ## END build-linux-ubuntu-focal job in .github/workflows/cmake_builds.yml ## Jon MorrisSoftware Developer-- e: Jon.Morris at jbarisk.comd:+44<mailto:Jon.Morris at jbarisk.comd:+44> (0)1756 587229t: +44 (0)1756 799919www.jbarisk.com[X][X][X][X]   All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system. JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, England.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0001.htm>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 7388 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 5172 bytes
Desc: image002.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0009.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image003.png
Type: image/png
Size: 774 bytes
Desc: image003.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image004.png
Type: image/png
Size: 797 bytes
Desc: image004.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0011.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image017610.png
Type: image/png
Size: 7388 bytes
Desc: image017610.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0012.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image639965.png
Type: image/png
Size: 5172 bytes
Desc: image639965.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0013.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image116692.png
Type: image/png
Size: 774 bytes
Desc: image116692.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0014.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image104301.png
Type: image/png
Size: 797 bytes
Desc: image104301.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250515/5de8bb98/attachment-0015.png>

From jluis at ualg.pt  Sat May 17 03:02:03 2025
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Sat, 17 May 2025 10:02:03 +0000
Subject: [gdal-dev] How to set the _FillValue with CreateCopy?
Message-ID: <AM6PR04MB6440BF9B28401A4051477CCAA692A@AM6PR04MB6440.eurprd04.prod.outlook.com>

In Julia I use this function to create data cubes.  It works fine
https://github.com/GenericMappingTools/GMT.jl/blob/master/src/gdal_utils.jl#L866

but all my attempts to set the _FillValue (and the 'actual_range' btw) have failed. Last attempt shows up still as commented lines.
So my question is how to set them.

Thanks

Joaquim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250517/e155b889/attachment.htm>

From mdsumner at gmail.com  Mon May 19 17:38:36 2025
From: mdsumner at gmail.com (Michael Sumner)
Date: Tue, 20 May 2025 10:38:36 +1000
Subject: [gdal-dev] tmp files writing to object storage
Message-ID: <CAAcGz9_+qQmvt6YEweY1Cc+c--dfVERqmaUxSV9F24=mtaa0gg@mail.gmail.com>

When I write a COG to object storage, I see the external overview being
created in CPL_TMPDIR, but there is a .tif.tmp.tif file that then isn't
cleaned up. This is on a custom endpoint. I see

gdalwarp test_me.tif /vsis3/ideatest/sometest6.tif -of COG -co
SPARSE_OK=YES -ts 14400 7200 -overwrite
Creating output file that is 14400P x 7200L.
Using internal nodata values (e.g. -999) for image test_me.tif.
Copying nodata values from source test_me.tif to destination
/vsis3/ideatest/sometest6.tif.tmp.tif.
0...10...20...30...40...50...60...70...80...90...100 - done in 00:00:15.
ERROR 1: Delete of /vsis3/ideatest/sometest6.tif.tmp.tif failed
ERROR 1: Deleting /vsis3/ideatest/sometest6.tif.tmp.tif failed:
Success

In CPL_TMPDIR I see this file transiently listed as expected:

[1] "sometest6_2305026_3.ovr.tmp"


Is there something else I need to do to have that sometest6.tif.tmp.tif
written to CPL_TMPDIR?

To use the custom endpoint I have the following settings:

AWS_ACCESS_KEY_ID=...
AWS_SECRET_ACCESS_KEY=...
AWS_S3_ENDPOINT=https:///...
AWS_VIRTUAL_HOSTING=FALSE
CPL_VSIS3_CREATE_DIR_OBJECT=TRUE
CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE=YES
CPL_TMPDIR=$MYSCRATCH/tmp

Thanks, Mike


-- 
Michael Sumner
Research Software Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250520/ffe98b87/attachment.htm>

From even.rouault at spatialys.com  Tue May 20 02:43:16 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 20 May 2025 11:43:16 +0200
Subject: [gdal-dev] tmp files writing to object storage
In-Reply-To: <CAAcGz9_+qQmvt6YEweY1Cc+c--dfVERqmaUxSV9F24=mtaa0gg@mail.gmail.com>
References: <CAAcGz9_+qQmvt6YEweY1Cc+c--dfVERqmaUxSV9F24=mtaa0gg@mail.gmail.com>
Message-ID: <41f6d7ea-4ed0-4f9f-a0ac-8d8020b4d7cf@spatialys.com>

Michael,

I couldn't reproduce your error (the temp file gets deleted for me), but 
the creation of a temporary file on /vsis3/ was certainly a bug. I've 
addressed this per https://github.com/OSGeo/gdal/pull/12421

Even

Le 20/05/2025 ? 02:38, Michael Sumner via gdal-dev a ?crit?:
> When I write a COG to object storage, I see the external overview 
> being created in CPL_TMPDIR, but there is a .tif.tmp.tif file that 
> then isn't cleaned up. This is on a custom endpoint. I see
>
> gdalwarp test_me.tif /vsis3/ideatest/sometest6.tif -of COG -co 
> SPARSE_OK=YES -ts 14400 7200 -overwrite
> Creating output file that is 14400P x 7200L.
> Using internal nodata values (e.g. -999) for image test_me.tif.
> Copying nodata values from source test_me.tif to destination 
> /vsis3/ideatest/sometest6.tif.tmp.tif.
> 0...10...20...30...40...50...60...70...80...90...100 - done in 00:00:15.
> ERROR 1: Delete of /vsis3/ideatest/sometest6.tif.tmp.tif failed
> ERROR 1: Deleting /vsis3/ideatest/sometest6.tif.tmp.tif failed:
> Success
>
> In CPL_TMPDIR I see this file transiently listed as expected:
>
> [1] "sometest6_2305026_3.ovr.tmp"
>
>
> Is there something else I need to do to have that 
> sometest6.tif.tmp.tif written to CPL_TMPDIR?
>
> To use the custom endpoint I have the following settings:
>
> AWS_ACCESS_KEY_ID=...
> AWS_SECRET_ACCESS_KEY=...
> AWS_S3_ENDPOINT=https:///...
> AWS_VIRTUAL_HOSTING=FALSE
> CPL_VSIS3_CREATE_DIR_OBJECT=TRUE
> CPL_VSIL_USE_TEMP_FILE_FOR_RANDOM_WRITE=YES
> CPL_TMPDIR=$MYSCRATCH/tmp
>
> Thanks, Mike
>
>
> -- 
> Michael Sumner
> Research Software Engineer
> Australian Antarctic Division
> Hobart, Australia
> e-mail: mdsumner at gmail.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250520/b8053c94/attachment.htm>

From gdt at lexort.com  Tue May 20 04:28:00 2025
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 20 May 2025 07:28:00 -0400
Subject: [gdal-dev] float16 woes on solaris
Message-ID: <rmia577ed33.fsf@s1.lexort.com>

The pkgsrc package isn't building on SmartOS (which is illumos, which is
OpenSolaris, more or less).

Full build at the last link:

  https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/meta/report.html
  https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/gdal-lib-3.11.0/configure.log
  https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/gdal-lib-3.11.0/build.log

but the key points are:

  configure:
    -- Performing Test HAVE_STD_FLOAT16_T
    -- Performing Test HAVE_STD_FLOAT16_T - Failed

  build:
    [ 94%] Linking CXX shared library libgdal.so
    Undefined			first referenced
     symbol  			    in file
    __extendhfsf2                       port/CMakeFiles/cpl.dir/cpl_json_streaming_writer.cpp.o
    __extendhfxf2                       /home/pbulk/build/geography/gdal-lib/work/.buildlink/lib/libhdf5.so.310
    __extendhfdf2                       port/CMakeFiles/cpl.dir/cpl_json_streaming_writer.cpp.o
    __truncdfhf2                        alg/CMakeFiles/alg.dir/gdalrasterize.cpp.o
    __truncxfhf2                        gcore/CMakeFiles/gcore.dir/rasterio.cpp.o
    __truncsfhf2                        gcore/CMakeFiles/gcore.dir/gdalrasterband.cpp.o
    __eqhf2                             alg/CMakeFiles/alg.dir/gdalwarpkernel.cpp.o
    __nehf2                             alg/CMakeFiles/alg.dir/gdalwarpkernel.cpp.o
    ld: fatal: symbol referencing errors. No output written to libgdal.so.37.3.11.0

I think this is:

  https://github.com/llvm/llvm-project/issues/105181

Looking in gdal 3.11.0's CMakeLists.txt, the test for Float16 is

  # Check whether std::float16_t is available and is working
  include(CheckCXXSourceCompiles)
  check_cxx_source_compiles(
    "
      #include <cmath>
      #include <stdfloat>
      int main() {
        std::float16_t x = 0;
        using std::nextafter;
        std::float16_t y = nextafter(x, x);
        return y == 0 ? 0 : 1;
      }
    "
    HAVE_STD_FLOAT16_T
  )

It fails, whcih is good because it seems this platform has troubled
float16.

But somehow, float16 functions get added to to link.

Has anyone built/tested gdal on Solaris-ish?


From gdt at lexort.com  Tue May 20 05:22:00 2025
From: gdt at lexort.com (Greg Troxel)
Date: Tue, 20 May 2025 08:22:00 -0400
Subject: [gdal-dev] float16 woes on solaris
In-Reply-To: <rmia577ed33.fsf@s1.lexort.com> (Greg Troxel via gdal-dev's
 message of "Tue, 20 May 2025 07:28:00 -0400")
References: <rmia577ed33.fsf@s1.lexort.com>
Message-ID: <rmi1psjeal3.fsf@s1.lexort.com>

The build I posted was gcc 13.

This might be a gcc bug:

  https://gcc.gnu.org/bugzilla/show_bug.cgi?id=117321




From even.rouault at spatialys.com  Tue May 20 06:12:07 2025
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 20 May 2025 15:12:07 +0200
Subject: [gdal-dev] float16 woes on solaris
In-Reply-To: <rmia577ed33.fsf@s1.lexort.com>
References: <rmia577ed33.fsf@s1.lexort.com>
Message-ID: <feb3a106-1dda-4ae0-850e-0fe5908c2711@spatialys.com>

Greg,

HAVE_STD_FLOAT16_T tests only the C++ part of Float16 support. Later in 
the log I can see:

-- Performing Test HAVE__FLOAT16
-- Performing Test HAVE__FLOAT16 - Success

which is this test in cmake/helpers/configure.cmake


# Check whether the type `_Float16` exists, and whether type
# conversions work (there might be linker problems)
check_cxx_source_compiles(
 ??? "
 ????? #ifdef GDAL_DISABLE_FLOAT16
 ??????? Explicitly disable _Float16 support
 ????? #endif
 ????? int main() {
 ??????? _Float16 h = 1;
 ??????? float f = h;
 ??????? double d = h;
 ??????? return f != 0 && d != 0 ? 0 : 1;
 ????? }
 ??? "
 ??? HAVE__FLOAT16)

I've no idea how to fix linking issues on Solaris'ish systems, but you 
may just add -DGDAL_DISABLE_FLOAT16 in? CMAKE_C_FLAGS / CMAKE_CXX_FLAGS 
to prevent GDAL from using the builtin _Float16 C type.

Even

Le 20/05/2025 ? 13:28, Greg Troxel via gdal-dev a ?crit?:
> The pkgsrc package isn't building on SmartOS (which is illumos, which is
> OpenSolaris, more or less).
>
> Full build at the last link:
>
>    https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/meta/report.html
>    https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/gdal-lib-3.11.0/configure.log
>    https://reports.pkgci.org/SmartOS/upstream/trunk/20250518.2249/gdal-lib-3.11.0/build.log
>
> but the key points are:
>
>    configure:
>      -- Performing Test HAVE_STD_FLOAT16_T
>      -- Performing Test HAVE_STD_FLOAT16_T - Failed
>
>    build:
>      [ 94%] Linking CXX shared library libgdal.so
>      Undefined			first referenced
>       symbol  			    in file
>      __extendhfsf2                       port/CMakeFiles/cpl.dir/cpl_json_streaming_writer.cpp.o
>      __extendhfxf2                       /home/pbulk/build/geography/gdal-lib/work/.buildlink/lib/libhdf5.so.310
>      __extendhfdf2                       port/CMakeFiles/cpl.dir/cpl_json_streaming_writer.cpp.o
>      __truncdfhf2                        alg/CMakeFiles/alg.dir/gdalrasterize.cpp.o
>      __truncxfhf2                        gcore/CMakeFiles/gcore.dir/rasterio.cpp.o
>      __truncsfhf2                        gcore/CMakeFiles/gcore.dir/gdalrasterband.cpp.o
>      __eqhf2                             alg/CMakeFiles/alg.dir/gdalwarpkernel.cpp.o
>      __nehf2                             alg/CMakeFiles/alg.dir/gdalwarpkernel.cpp.o
>      ld: fatal: symbol referencing errors. No output written to libgdal.so.37.3.11.0
>
> I think this is:
>
>    https://github.com/llvm/llvm-project/issues/105181
>
> Looking in gdal 3.11.0's CMakeLists.txt, the test for Float16 is
>
>    # Check whether std::float16_t is available and is working
>    include(CheckCXXSourceCompiles)
>    check_cxx_source_compiles(
>      "
>        #include <cmath>
>        #include <stdfloat>
>        int main() {
>          std::float16_t x = 0;
>          using std::nextafter;
>          std::float16_t y = nextafter(x, x);
>          return y == 0 ? 0 : 1;
>        }
>      "
>      HAVE_STD_FLOAT16_T
>    )
>
> It fails, whcih is good because it seems this platform has troubled
> float16.
>
> But somehow, float16 functions get added to to link.
>
> Has anyone built/tested gdal on Solaris-ish?
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
http://www.spatialys.com
My software is free, but my time generally not.


From a.pau at creaf.cat  Tue May 20 23:46:40 2025
From: a.pau at creaf.cat (Abel Pau)
Date: Wed, 21 May 2025 06:46:40 +0000
Subject: [gdal-dev] NODATA values in diferents bands in a DataSet
Message-ID: <PAXPR07MB777503F110D43E498D33AC66FA9EA@PAXPR07MB7775.eurprd07.prod.outlook.com>

Hello,
I am implementing a driver that allows different NODATA values for each band in a dataset.
>From what I understand in the documentation, I should use the NODATA_VALUES metadata item to document these values. However, I don't see a clear way to indicate that a specific band has no NODATA value within the tuple.
On the other hand, the documentation also suggests that NODATA_VALUES is not widely honoured, which is not very encouraging.
Therefore, would you consider it good practice to separate bands with different NODATA values into separate subdatasets instead?
Thank you very much for the clarification.

Abel Pau Garcia<https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia> <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia>
[https://www.creaf.cat/sites/default/files/2024-10/logo-creaf-small.jpg] <https://www.creaf.cat/>
MiraMon Technical Lead <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia> <https://www.creaf.cat/en/about-us/our-people/abel-pau-garcia>
a.pau at creaf.cat<mailto:a.pau at creaf.cat> <mailto:a.pau at creaf.cat>
[https://www.creaf.cat/sites/default/files/cap_0.png]
Let's chat on Teams!<https://teams.microsoft.com/l/chat/0/0?users=a.pau at creaf.cat> <https://teams.microsoft.com/l/chat/0/0?users=a.pau at creaf.cat>
Tel. +34
[https://www.creaf.cat/sites/default/files/2024-10/x_30.png] <https://twitter.com/CREAF_ecologia> [https://www.creaf.cat/sites/default/files/2024-10/linkedin_30.png]  <https://www.linkedin.com/company/creaf/> [https://www.creaf.cat/sites/default/files/2024-10/youtube_30.png]  <https://www.youtube.com/c/creafecologia> [https://www.creaf.cat/sites/default/files/2024-10/instagram_30.png]  <https://www.instagram.com/CREAF_ecologia/>
<http://www.creaf.cat>www.creaf.cat<http://www.creaf.cat> <http://www.creaf.cat>  | <https://www.creaf.cat/en/news-and-agenda/news> Latest news<https://www.creaf.cat/en/news-and-agenda/news> <https://www.creaf.cat/en/news-and-agenda/news>
CREAF. Campus UAB. Edifici C. 08193 Bellaterra (Barcelona) <https://www.openstreetmap.org/way/123379060>

<https://www.creaf.cat/privacy-policy>Privacy policy<https://www.creaf.cat/privacy-policy> <https://www.creaf.cat/privacy-policy>
[https://www.creaf.cat/sites/default/files/2024-10/corner_right_0.png]
Before printing this electronic message, think about the environment.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20250521/4a1bf0d8/attachment.htm>

From jukka.rahkonen at maanmittauslaitos.fi  Wed May 21 01:04:44 2025
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka)
Date: Wed, 21 May 2025 08:04:44 +0000
Subject: [gdal-dev] NODATA values in diferents bands in a DataSet
In-Reply-To: <PAXPR07MB777503F110D43E498D33AC66FA9EA@PAXPR07MB7775.eurprd07.prod.outlook.com>
References: <PAXPR07MB777503F110D43E498D33AC66FA9EA@PAXPR07MB7775.eurprd07.prod.outlook.com>
Message-ID: <DB9PR09MB68870823C468BEFA88947AF6FD9EA@DB9PR09MB6887.eurprd09.prod.outlook.com>

Hi,

On writing side nodata=none seems to work.

gdalwarp -of VRT -dstnodata "0 none 0" p4433h.tif nodata.vrt

gdalinfo nodata.vrt
...
Band 1 Block=512x128 Type=Byte, ColorInterp=Red
  NoData Value=0
  Overviews: 6000x6000, 3000x3000, 1500x1500, 750x750, 375x375, 188x188
Band 2 Block=512x128 Type=Byte, ColorInterp=Green
  Overviews: 6000x6000, 3000x3000, 1500x1500, 750x750, 375x375, 188x188
Band 3 Block=512x128 Type=Byte, ColorInterp=Blue
  NoData Value=0
  Overviews: 6000x6000, 3000x3000, 1500x1500, 750x750, 375x375, 188x188

VRT supports bandwise nodata but I do not know any other format that does. It does not mean that they do not exist, I am just unaware.

-Jukka Rahkonen-

________________________________________
L?hett?j?: gdal-dev <gdal-dev-bounces at lists.osgeo.org> k?ytt?j?n Abel Pau via gdal-dev <gdal-dev at lists.osgeo.org> puolesta
L?hetetty: Keskiviikko 21. toukokuuta 2025 9.46
Vastaanottaja: gdal-dev <gdal-dev at lists.osgeo.org>
Aihe: [gdal-dev] NODATA values in diferents bands in a DataSet

Hello,I am implementing a driver that allows different NODATA values for each band in a dataset.From what I understand in the documentation, I should use the NODATA_VALUES?metadata item to document these values. However, I don't see a clear way to indicate that a specific band has no NODATA?value within the tuple.On the other hand, the documentation also suggests that NODATA_VALUES?is not widely honoured, which is not very encouraging.Therefore, would you consider it good practice to separate bands with different NODATA values into separate subdatasets instead?Thank you very much for the clarification.Abel Pau Garcia [X] MiraMon Technical Lead a.pau at creaf.cat [X] Let's chat on Teams! Tel. +34 [X] [X] [X] [X] www.creaf.cat ?| Latest news CREAF. Campus UAB. Edifici C. 08193 Bellaterra (Barcelona) Privacy policy [X] Before printing this electronic message, think about the environment. 

